<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#fff">


  <meta name="baidu-site-verification" content="d5sacIPNJl">



<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">

<style>
    .pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style>



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">










  <meta name="baidu-site-verification" content="true">







  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/wenwu.jpg?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/wenwu.jpg?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/wenwu.jpg?v=5.1.4">


  <link rel="mask-icon" href="/images/wenwu.jpg?v=5.1.4" color="#fff">





  <meta name="keywords" content="GIS,openlayer,">





  <link rel="alternate" href="/atom.xml" title="偷得浮生半日闲" type="application/atom+xml">






<meta name="description" content="折腾了好久，终于把地图聚合给做出来了，这还得感谢杨姐姐最终的指点（不对，是帮助了很多）。下面我就直接贴代码了。 代码的主目录是这样的：   cluster.html  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626">
<meta name="keywords" content="GIS,openlayer">
<meta property="og:type" content="article">
<meta property="og:title" content="ol2实现地图聚合功能">
<meta property="og:url" content="http://www.xpshuai.cn/ol2实现地图效果/index.html">
<meta property="og:site_name" content="偷得浮生半日闲">
<meta property="og:description" content="折腾了好久，终于把地图聚合给做出来了，这还得感谢杨姐姐最终的指点（不对，是帮助了很多）。下面我就直接贴代码了。 代码的主目录是这样的：   cluster.html  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://pqpog12fm.bkt.clouddn.com/%E8%81%9A%E5%90%88%E4%B8%BB%E7%9B%AE%E5%BD%95.png">
<meta property="og:image" content="http://pqpog12fm.bkt.clouddn.com/%E8%81%9A%E5%90%88%E6%9B%BF%E6%8D%A2%E6%95%B0%E6%8D%AE.png">
<meta property="og:updated_time" content="2020-02-20T10:13:37.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ol2实现地图聚合功能">
<meta name="twitter:description" content="折腾了好久，终于把地图聚合给做出来了，这还得感谢杨姐姐最终的指点（不对，是帮助了很多）。下面我就直接贴代码了。 代码的主目录是这样的：   cluster.html  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626">
<meta name="twitter:image" content="http://pqpog12fm.bkt.clouddn.com/%E8%81%9A%E5%90%88%E4%B8%BB%E7%9B%AE%E5%BD%95.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.xpshuai.cn/ol2实现地图效果/">





  <title>ol2实现地图聚合功能 | 偷得浮生半日闲</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">偷得浮生半日闲</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">再偷浮生两吊钱</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            我的主页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            文章标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            文章分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档时光
          </a>
        </li>
      
        
        <li class="menu-item menu-item-life">
          <a href="/life/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-camera-retro"></i> <br>
            
            记录美好生活
          </a>
        </li>
      
        
        <li class="menu-item menu-item-guestbook">
          <a href="/guestbook/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-pencil"></i> <br>
            
            留言板
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于作者
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索本站
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>

<!-- tq -->
<script type="text/javascript">WIDGET = {FID: 'a5qxJi5vKF'}</script>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.xpshuai.cn/ol2实现地图效果/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="浮生">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="偷得浮生半日闲">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">ol2实现地图聚合功能</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-09T08:44:55+08:00">
                2019-05-09
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GIS/" itemprop="url" rel="index">
                    <span itemprop="name">GIS </span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/ol2实现地图效果/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/ol2实现地图效果/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>  阅读数
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  144.6k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  903  分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>折腾了好久，终于把地图聚合给做出来了，这还得感谢杨姐姐最终的指点（不对，是帮助了很多）。下面我就直接贴代码了。</p>
<p>代码的主目录是这样的：</p>
<p><img src="http://pqpog12fm.bkt.clouddn.com/%E8%81%9A%E5%90%88%E4%B8%BB%E7%9B%AE%E5%BD%95.png" alt></p>
<blockquote>
<p>cluster.html</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>OpenLayers Control/SelectCluster<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"style.css"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"OpenLayers.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"Cluster.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"SelectCluster.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">	<span class="keyword">var</span> map, clayer, ctrl; </span></span><br><span class="line"><span class="javascript">	<span class="function"><span class="keyword">function</span> <span class="title">initMap</span>(<span class="params"></span>)                        // 初始化地图，可以拿来放到自己对应的位置</span></span></span><br><span class="line"><span class="actionscript">	&#123;	<span class="comment">// Nouvelle carte</span></span></span><br><span class="line"><span class="actionscript">		map = <span class="keyword">new</span> OpenLayers.Map(<span class="string">"map"</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">		<span class="comment">// OSM</span></span></span><br><span class="line"><span class="actionscript">		map.addLayer ( <span class="keyword">new</span> OpenLayers.Layer.OSM() );</span></span><br><span class="line"><span class="undefined">		</span></span><br><span class="line"><span class="actionscript">		<span class="comment">// Ajouter un controle pour les couches</span></span></span><br><span class="line"><span class="actionscript">		map.addControl(<span class="keyword">new</span> OpenLayers.Control.LayerSwitcher());</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">		<span class="comment">// Centrer la carte</span></span></span><br><span class="line"><span class="actionscript">		<span class="keyword">var</span> WGS84 = <span class="keyword">new</span> OpenLayers.Projection(<span class="string">'EPSG:4326'</span>);</span></span><br><span class="line"><span class="actionscript">		map.setCenter(<span class="keyword">new</span> OpenLayers.LonLat(<span class="number">2.424</span>, <span class="number">48.845</span>).transform(WGS84, map.getProjectionObject()), <span class="number">13</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">		<span class="comment">// Cluster layer's style</span></span></span><br><span class="line"><span class="actionscript">		<span class="keyword">var</span> style = <span class="keyword">new</span> OpenLayers.Style</span></span><br><span class="line"><span class="undefined">		(&#123;	pointRadius: 12,</span></span><br><span class="line"><span class="actionscript">			externalGraphic: <span class="string">"img/pins.png"</span>,</span></span><br><span class="line"><span class="actionscript">			backgroundGraphic: <span class="string">"img/pinsback.png"</span>,</span></span><br><span class="line"><span class="undefined">			graphicYOffset:-24,</span></span><br><span class="line"><span class="undefined">			backgroundXOffset: 0,</span></span><br><span class="line"><span class="undefined">			backgroundYOffset: -16,</span></span><br><span class="line"><span class="undefined">			graphicZIndex: 11,</span></span><br><span class="line"><span class="undefined">			backgroundGraphicZIndex: 10,</span></span><br><span class="line"><span class="actionscript">			fillColor: <span class="string">"$&#123;fcolor&#125;"</span>, <span class="comment">//"#F0C20C",</span></span></span><br><span class="line"><span class="undefined">			fillOpacity: 1,</span></span><br><span class="line"><span class="actionscript">			strokeColor: <span class="string">"#333"</span>,</span></span><br><span class="line"><span class="undefined">			strokeWidth: 2,</span></span><br><span class="line"><span class="undefined">			strokeOpacity: 1,</span></span><br><span class="line"><span class="actionscript">			labelSelect: <span class="literal">false</span>,</span></span><br><span class="line"><span class="actionscript">			<span class="comment">//label: "$&#123;label&#125;",</span></span></span><br><span class="line"><span class="actionscript">			<span class="comment">//labelYOffset: "$&#123;labelOffset&#125;",</span></span></span><br><span class="line"><span class="actionscript">			fontFamily: <span class="string">'"Luxi sans","Lucida Grande",Lucida,"Lucida Sans Unicode",sans-serif'</span>,</span></span><br><span class="line"><span class="actionscript">			fontSize: <span class="string">"$&#123;fSize&#125;"</span>,</span></span><br><span class="line"><span class="actionscript">			fontWeight : <span class="string">"bold"</span>,</span></span><br><span class="line"><span class="actionscript">			cursor:<span class="string">"pointer"</span></span></span><br><span class="line"><span class="undefined">		&#125;,</span></span><br><span class="line"><span class="undefined">		&#123;	context:</span></span><br><span class="line"><span class="actionscript">			&#123;	label: <span class="function"><span class="keyword">function</span><span class="params">(f)</span> </span></span></span><br><span class="line"><span class="actionscript">				&#123;	<span class="keyword">if</span> (f.cluster) <span class="keyword">return</span> f.cluster.length ? f.cluster[<span class="number">0</span>].attributes.n : <span class="string">""</span>;</span></span><br><span class="line"><span class="actionscript">					<span class="keyword">return</span> f.attributes.n;</span></span><br><span class="line"><span class="undefined">				&#125;,</span></span><br><span class="line"><span class="actionscript">				labelOffset: <span class="function"><span class="keyword">function</span><span class="params">(f)</span> </span></span></span><br><span class="line"><span class="actionscript">				&#123;	<span class="keyword">return</span> (f.cluster &amp;&amp; f.cluster.length&gt;<span class="number">1</span>) ? <span class="string">""</span> : <span class="number">-8</span>;</span></span><br><span class="line"><span class="undefined">				&#125;,</span></span><br><span class="line"><span class="actionscript">				fSize: <span class="function"><span class="keyword">function</span><span class="params">(f)</span> </span></span></span><br><span class="line"><span class="actionscript">				&#123;	<span class="keyword">return</span> (f.cluster &amp;&amp; f.cluster.length&gt;<span class="number">1</span>) ? <span class="number">12</span> : <span class="number">8</span>;</span></span><br><span class="line"><span class="undefined">				&#125;,</span></span><br><span class="line"><span class="actionscript">				fcolor: <span class="function"><span class="keyword">function</span><span class="params">(f)</span></span></span></span><br><span class="line"><span class="actionscript">				&#123;	<span class="keyword">if</span> (!f.cluster) <span class="keyword">return</span> <span class="string">"#F0C20C"</span>;</span></span><br><span class="line"><span class="actionscript">					<span class="keyword">if</span> (f.cluster.length&lt;<span class="number">8</span>) <span class="keyword">return</span> <span class="string">"#AF7"</span>;</span></span><br><span class="line"><span class="actionscript">					<span class="keyword">if</span> (f.cluster.length&lt;<span class="number">16</span>) <span class="keyword">return</span> <span class="string">"#FD5"</span>;</span></span><br><span class="line"><span class="actionscript">					<span class="keyword">return</span> <span class="string">"#F97"</span>;</span></span><br><span class="line"><span class="undefined">				&#125;</span></span><br><span class="line"><span class="undefined">			&#125;</span></span><br><span class="line"><span class="undefined">		&#125;);</span></span><br><span class="line"><span class="actionscript">		<span class="comment">// New cluster Layer</span></span></span><br><span class="line"><span class="actionscript">		clayer = <span class="keyword">new</span> OpenLayers.Layer.Cluster (<span class="string">"Clusters"</span>, </span></span><br><span class="line"><span class="actionscript">				&#123;	rendererOptions: &#123;yOrdering: <span class="literal">true</span>&#125;,</span></span><br><span class="line"><span class="actionscript">					styleMap: <span class="keyword">new</span> OpenLayers.StyleMap</span></span><br><span class="line"><span class="actionscript">					(&#123;	<span class="string">"default"</span>: style,</span></span><br><span class="line"><span class="actionscript">						<span class="string">"select"</span>: &#123;	pointRadius: <span class="number">18</span> &#125;</span></span><br><span class="line"><span class="undefined">					&#125;)</span></span><br><span class="line"><span class="undefined">				&#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">		<span class="comment">// Add 200 features to cluster</span></span></span><br><span class="line"><span class="actionscript">		<span class="keyword">var</span> b = map.calculateBounds();</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> features = <span class="keyword">new</span> <span class="built_in">Array</span>();</span></span><br><span class="line"><span class="actionscript">		<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">200</span>; i++)    <span class="comment">// 测试数据，替换为自己拿到的xy坐标</span></span></span><br><span class="line"><span class="javascript">		&#123;	<span class="keyword">var</span> r1 = <span class="built_in">Math</span>.random();</span></span><br><span class="line"><span class="javascript">			<span class="keyword">var</span> r2 = <span class="built_in">Math</span>.random();</span></span><br><span class="line"><span class="actionscript">			<span class="keyword">var</span> px = b.left + (b.right-b.left) *r1 ; </span></span><br><span class="line"><span class="actionscript">			<span class="keyword">var</span> py = b.bottom + (b.top-b.bottom) *r2 ; </span></span><br><span class="line"><span class="actionscript">			<span class="keyword">var</span> f = <span class="keyword">new</span> OpenLayers.Feature.Vector( <span class="keyword">new</span> OpenLayers.Geometry.Point(px, py), &#123;n:i&#125; );</span></span><br><span class="line"><span class="undefined">			features.push(f);</span></span><br><span class="line"><span class="undefined">		&#125;</span></span><br><span class="line"><span class="undefined">		</span></span><br><span class="line"><span class="undefined">		map.addLayer(clayer);</span></span><br><span class="line"><span class="undefined">		clayer.addFeatures(features);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">		<span class="comment">// Select control</span></span></span><br><span class="line"><span class="actionscript">		ctrl = <span class="keyword">new</span> OpenLayers.Control.SelectCluster (clayer, </span></span><br><span class="line"><span class="actionscript">				&#123;	hover:<span class="literal">false</span>, </span></span><br><span class="line"><span class="undefined">					pointRadius:12,</span></span><br><span class="line"><span class="actionscript">					animate:<span class="literal">true</span>, </span></span><br><span class="line"><span class="actionscript">					connect:<span class="literal">false</span>,</span></span><br><span class="line"><span class="actionscript">					onSelect: <span class="function"><span class="keyword">function</span><span class="params">(feature)</span> </span></span></span><br><span class="line"><span class="actionscript">					&#123;	<span class="keyword">if</span> (feature.cluster) feature = feature.cluster[<span class="number">0</span>];</span></span><br><span class="line"><span class="actionscript">						showStatus(<span class="string">"selected feature "</span>+feature.attributes.n+<span class="string">" ("</span>+feature.id+<span class="string">")"</span>);</span></span><br><span class="line"><span class="undefined">					&#125;,</span></span><br><span class="line"><span class="actionscript">					onUnselect: <span class="function"><span class="keyword">function</span><span class="params">(feature)</span> </span></span></span><br><span class="line"><span class="actionscript">					&#123;	showStatus(<span class="string">""</span>);</span></span><br><span class="line"><span class="undefined">					&#125;,</span></span><br><span class="line"><span class="undefined">				&#125;);</span></span><br><span class="line"><span class="undefined">		map.addControl (ctrl);</span></span><br><span class="line"><span class="undefined">		ctrl.activate();</span></span><br><span class="line"><span class="undefined">		</span></span><br><span class="line"><span class="undefined">	&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">	<span class="function"><span class="keyword">function</span> <span class="title">showStatus</span><span class="params">(text)</span> </span></span></span><br><span class="line"><span class="javascript">	&#123;	<span class="built_in">document</span>.getElementById(<span class="string">"status"</span>).innerHTML = text;            </span></span><br><span class="line"><span class="undefined">	&#125;</span></span><br><span class="line"><span class="undefined">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">		<span class="selector-tag">body</span> &#123; <span class="attribute">font</span>:<span class="number">1em</span> Helvetica,Arial,sans-serif; &#125;</span></span><br><span class="line"><span class="css">		<span class="selector-tag">h1</span> &#123; <span class="attribute">color</span>:<span class="number">#369</span>; <span class="attribute">margin</span>:<span class="number">0.5em</span> <span class="number">0</span> <span class="number">0.2em</span> &#125;</span></span><br><span class="line"><span class="css">		<span class="selector-id">#tags</span> &#123; <span class="attribute">color</span>:<span class="number">#69F</span>; <span class="attribute">font-size</span>:<span class="number">0.9em</span>; &#125;</span></span><br><span class="line"><span class="css">		<span class="selector-tag">p</span> &#123; <span class="attribute">margin</span>: <span class="number">0.5em</span> <span class="number">0</span>; &#125;</span></span><br><span class="line"><span class="css">		<span class="selector-tag">p</span><span class="selector-class">.title</span> &#123; <span class="attribute">color</span>:<span class="number">#369</span>; <span class="attribute">font-weight</span>:bold; &#125;</span></span><br><span class="line"><span class="css">		<span class="selector-id">#map</span> &#123; <span class="attribute">background</span>:<span class="number">#fff</span>; <span class="attribute">float</span>:left; &#125;</span></span><br><span class="line"><span class="css">		<span class="selector-id">#options</span> &#123; <span class="attribute">margin</span>:<span class="number">0.5em</span>; <span class="attribute">float</span>:left; &#125;</span></span><br><span class="line"><span class="css">		<span class="selector-id">#options</span> <span class="selector-tag">p</span> &#123; <span class="attribute">margin</span>:<span class="number">0</span> <span class="number">0</span> <span class="number">1em</span>; &#125;</span></span><br><span class="line"><span class="css">		<span class="selector-id">#docs</span> &#123; <span class="attribute">background</span>:<span class="number">#e3e6e9</span>; <span class="attribute">padding</span>:<span class="number">0.5em</span>; <span class="attribute">margin</span>:<span class="number">0.5em</span> <span class="number">0</span>; &#125;</span></span><br><span class="line"><span class="css">		<span class="selector-class">.olControlAttribution</span></span></span><br><span class="line"><span class="css">		&#123;	<span class="attribute">bottom</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="css">			<span class="selector-tag">background</span><span class="selector-pseudo">:rgba(255</span>,255,255,0<span class="selector-class">.6</span>);</span></span><br><span class="line"><span class="css">			<span class="selector-tag">padding</span>: 0 0<span class="selector-class">.5em</span>;</span></span><br><span class="line"><span class="undefined">		&#125;</span></span><br><span class="line"><span class="css">		<span class="selector-id">#status</span> &#123; <span class="attribute">display</span>:block; <span class="attribute">clear</span>:both; &#125;</span></span><br><span class="line"><span class="undefined">	</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">"initMap()"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- DIV pour la carte --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"map"</span> <span class="attr">style</span>=<span class="string">"width:600px; height:400px;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"status"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://pqpog12fm.bkt.clouddn.com/%E8%81%9A%E5%90%88%E6%9B%BF%E6%8D%A2%E6%95%B0%E6%8D%AE.png" alt></p>
<p><strong>但是由于业务需求，需要再改动一下</strong></p>
<p>添加：点击地图要素，弹出其信息，点击其他区域，上一个弹窗消失：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadJuhe</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="comment">// Cluster layer's style</span></span><br><span class="line">	<span class="keyword">var</span> style = <span class="keyword">new</span> OpenLayers.Style</span><br><span class="line">	(&#123;	<span class="attr">pointRadius</span>: <span class="number">12</span>,</span><br><span class="line">		externalGraphic: <span class="string">"../../../otherlibs/ol2/img/pins.png"</span>,   <span class="comment">// 要素图标，我贴在后面，也可以用自己的</span></span><br><span class="line">		backgroundGraphic: <span class="string">"../../../otherlibs/ol2/img/pinsback.png"</span>,</span><br><span class="line">		graphicYOffset:<span class="number">-24</span>,</span><br><span class="line">		backgroundXOffset: <span class="number">0</span>,</span><br><span class="line">		backgroundYOffset: <span class="number">-16</span>,</span><br><span class="line">		graphicZIndex: <span class="number">11</span>,</span><br><span class="line">		backgroundGraphicZIndex: <span class="number">10</span>,</span><br><span class="line">		fillColor: <span class="string">"$&#123;fcolor&#125;"</span>, <span class="comment">//"#F0C20C",</span></span><br><span class="line">		fillOpacity: <span class="number">1</span>,</span><br><span class="line">		strokeColor: <span class="string">"#333"</span>,</span><br><span class="line">		strokeWidth: <span class="number">2</span>,</span><br><span class="line">		strokeOpacity: <span class="number">1</span>,</span><br><span class="line">		labelSelect: <span class="literal">false</span>,</span><br><span class="line">		<span class="comment">//label: "$&#123;label&#125;",</span></span><br><span class="line">		<span class="comment">//labelYOffset: "$&#123;labelOffset&#125;",</span></span><br><span class="line">		fontFamily: <span class="string">'"Luxi sans","Lucida Grande",Lucida,"Lucida Sans Unicode",sans-serif'</span>,</span><br><span class="line">		fontSize: <span class="string">"$&#123;fSize&#125;"</span>,</span><br><span class="line">		fontWeight : <span class="string">"bold"</span>,</span><br><span class="line">		cursor:<span class="string">"pointer"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;	<span class="attr">context</span>:</span><br><span class="line">		&#123;	<span class="attr">label</span>: <span class="function"><span class="keyword">function</span>(<span class="params">f</span>) </span></span><br><span class="line"><span class="function">			</span>&#123;	<span class="keyword">if</span> (f.cluster) <span class="keyword">return</span> f.cluster.length ? f.cluster[<span class="number">0</span>].attributes.n : <span class="string">""</span>;</span><br><span class="line">				<span class="keyword">return</span> f.attributes.n;</span><br><span class="line">			&#125;,</span><br><span class="line">			labelOffset: <span class="function"><span class="keyword">function</span>(<span class="params">f</span>) </span></span><br><span class="line"><span class="function">			</span>&#123;	<span class="keyword">return</span> (f.cluster &amp;&amp; f.cluster.length&gt;<span class="number">1</span>) ? <span class="string">""</span> : <span class="number">-8</span>;</span><br><span class="line">			&#125;,</span><br><span class="line">			fSize: <span class="function"><span class="keyword">function</span>(<span class="params">f</span>) </span></span><br><span class="line"><span class="function">			</span>&#123;	<span class="keyword">return</span> (f.cluster &amp;&amp; f.cluster.length&gt;<span class="number">1</span>) ? <span class="number">12</span> : <span class="number">8</span>;</span><br><span class="line">			&#125;,</span><br><span class="line">			fcolor: <span class="function"><span class="keyword">function</span>(<span class="params">f</span>)</span></span><br><span class="line"><span class="function">			</span>&#123;	<span class="keyword">if</span> (!f.cluster) <span class="keyword">return</span> <span class="string">"#F0C20C"</span>;</span><br><span class="line">				<span class="keyword">if</span> (f.cluster.length&lt;<span class="number">8</span>) <span class="keyword">return</span> <span class="string">"#AF7"</span>;</span><br><span class="line">				<span class="keyword">if</span> (f.cluster.length&lt;<span class="number">16</span>) <span class="keyword">return</span> <span class="string">"#FD5"</span>;</span><br><span class="line">				<span class="keyword">return</span> <span class="string">"#F97"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">	<span class="comment">// New cluster Layer</span></span><br><span class="line">	clayer = <span class="keyword">new</span> OpenLayers.Layer.Cluster (<span class="string">"Clusters"</span>, </span><br><span class="line">			&#123;	<span class="attr">rendererOptions</span>: &#123;<span class="attr">yOrdering</span>: <span class="literal">true</span>&#125;,</span><br><span class="line">				styleMap: <span class="keyword">new</span> OpenLayers.StyleMap</span><br><span class="line">				(&#123;	<span class="string">"default"</span>: style,</span><br><span class="line">					<span class="string">"select"</span>: &#123;	<span class="attr">pointRadius</span>: <span class="number">18</span> &#125;</span><br><span class="line">				&#125;)</span><br><span class="line">			&#125;);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Add 200 features to cluster</span></span><br><span class="line">	<span class="keyword">var</span> b = map.calculateBounds();</span><br><span class="line">	<span class="keyword">var</span> features = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">	<span class="comment">// $iframes.videodata</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; $iframes.videodata.length; i++)   <span class="comment">//$iframes.videsdata是我从后台拿到的数据</span></span><br><span class="line">	&#123;	</span><br><span class="line">		<span class="keyword">var</span> f = <span class="keyword">new</span> OpenLayers.Feature.Vector( <span class="keyword">new</span> OpenLayers.Geometry.Point($iframes.videodata[i][<span class="string">'x'</span>], $iframes.videodata[i][<span class="string">'y'</span>]),</span><br><span class="line">				&#123;<span class="attr">n</span>:i, <span class="attr">itemdata</span> : $iframes.videodata[i]&#125; );  <span class="comment">//itemdata 是每一项的数据</span></span><br><span class="line">		features.push(f);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	map.addLayer(clayer);</span><br><span class="line">	clayer.addFeatures(features);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Select control</span></span><br><span class="line">	ctrl = <span class="keyword">new</span> OpenLayers.Control.SelectCluster (clayer, </span><br><span class="line">			&#123;	<span class="attr">hover</span>:<span class="literal">false</span>, </span><br><span class="line">				pointRadius:<span class="number">12</span>,</span><br><span class="line">				animate:<span class="literal">true</span>, </span><br><span class="line">				connect:<span class="literal">false</span>,</span><br><span class="line">				onSelect: <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>)    // 弹窗</span></span><br><span class="line"><span class="function">				</span>&#123;	</span><br><span class="line">					<span class="keyword">if</span> (feature.cluster) feature = feature.cluster[<span class="number">0</span>];</span><br><span class="line">					ctrl.onUnselect();</span><br><span class="line">					<span class="keyword">var</span> popupContentHTML=<span class="string">""</span>;    <span class="comment">//弹窗的页面元素</span></span><br><span class="line">					popupContentHTML += <span class="string">'&lt;div id="showTradeInfo" style="width:320px;background-color:rgb(255, 255, 255);height: auto;position:relative;"&gt;'</span>;</span><br><span class="line">					<span class="keyword">var</span> data = feature.data.itemdata;  <span class="comment">// 后台数据的每一项</span></span><br><span class="line"></span><br><span class="line">							popupContentHTML  += <span class="string">'&lt;div style="height:auto;line-height:36px;font-size: 14px; color: #4d4d4d;padding-left:10px;padding-right:10px; font-weight: 700;border-bottom:1px solid #ccc;"&gt;'</span></span><br><span class="line">							popupContentHTML  += <span class="string">'&lt;label style="margin-bottom:0px;"&gt;名称&lt;/label&gt;：&lt;label style="margin-bottom:0px;font-weight:500;"&gt;'</span>+data[<span class="string">'name'</span>]+<span class="string">'&lt;/label&gt;'</span></span><br><span class="line">							popupContentHTML  += <span class="string">'&lt;/div&gt;'</span>;</span><br><span class="line">							</span><br><span class="line">							popupContentHTML  += <span class="string">'&lt;div style="height:auto;line-height:36px;font-size: 14px; color: #4d4d4d;padding-left:10px;padding-right:10px; font-weight: 700;border-bottom:1px solid #ccc;"&gt;'</span></span><br><span class="line">							popupContentHTML  += <span class="string">'&lt;label style="margin-bottom:0px;"&gt;地址&lt;/label&gt;：&lt;label style="margin-bottom:0px;font-weight:500;"&gt;'</span>+data[<span class="string">"address"</span>]+<span class="string">'&lt;/label&gt;'</span></span><br><span class="line">							popupContentHTML  += <span class="string">'&lt;/div&gt;'</span>;</span><br><span class="line">						</span><br><span class="line"></span><br><span class="line">					popupContentHTML += <span class="string">'&lt;/div&gt;'</span>;</span><br><span class="line">					<span class="keyword">var</span> popup = <span class="keyword">new</span> OpenLayers.Popup.CSSFramedCloud(<span class="string">"MyFavorites"</span>, </span><br><span class="line">							feature.geometry.getBounds().getCenterLonLat(),<span class="comment">// 坐标</span></span><br><span class="line">							<span class="literal">null</span>,<span class="comment">// popup大小</span></span><br><span class="line">							popupContentHTML,<span class="comment">// html内容</span></span><br><span class="line">							<span class="literal">null</span>,<span class="comment">// 锚点</span></span><br><span class="line">							<span class="literal">true</span>,<span class="comment">// 是否显示关闭按钮</span></span><br><span class="line">							<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;<span class="comment">// 关闭弹窗触发该回调函数</span></span><br><span class="line"><span class="comment">//						specialmap.removePopup(feature.popup);</span></span><br><span class="line">						feature.popup.destroy();</span><br><span class="line">						feature.popup = <span class="literal">null</span>;</span><br><span class="line">					&#125;);</span><br><span class="line">					popup.autoSize = <span class="literal">true</span>;</span><br><span class="line">					feature.popup = popup;</span><br><span class="line">					map.addPopup(popup); </span><br><span class="line"></span><br><span class="line">					</span><br><span class="line">				&#125;,</span><br><span class="line">				onUnselect: <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>)    // 取消弹窗没写</span></span><br><span class="line"><span class="function">				</span>&#123;	</span><br><span class="line">		        		<span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>; j&lt;map.popups.length; j++)&#123;</span><br><span class="line">		        			map.removePopup(map.popups[j]);</span><br><span class="line">		        			j--;</span><br><span class="line">		        		&#125;</span><br><span class="line"><span class="comment">//		        	$("#clocePop").click(function()&#123;</span></span><br><span class="line"><span class="comment">//		        		removePopup();</span></span><br><span class="line"><span class="comment">//		        	&#125;);</span></span><br><span class="line"></span><br><span class="line">				</span><br><span class="line">				&#125;,</span><br><span class="line">			&#125;);</span><br><span class="line">	map.addControl (ctrl);</span><br><span class="line">	ctrl.activate();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下面几个文件直接引用即可，直接贴出来</p>
<blockquote>
<p>cluster.js</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Copyright (c) 2014 by Jean-Marc.Viglino [at]ign.fr</span></span><br><span class="line"><span class="comment">* Dual-licensed under the CeCILL-B Licence (http://www.cecill.info/)</span></span><br><span class="line"><span class="comment">* and the Beerware license (http://en.wikipedia.org/wiki/Beerware), </span></span><br><span class="line"><span class="comment">* feel free to use and abuse it in your projects (the code, not the beer ;-). </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Class: OpenLayers.Layer.Cluster</span></span><br><span class="line"><span class="comment">* OpenLayers.Layer.Cluster is a OpenLayers.Layer.Vector with cluster stragegy and styling</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* Inherits from:</span></span><br><span class="line"><span class="comment">* - &lt;OpenLayers.Layer.Vector&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">OpenLayers.Layer.Cluster = OpenLayers.Class(OpenLayers.Layer.Vector, </span><br><span class="line">&#123;</span><br><span class="line">		</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* APIProperty: startegyParam </span></span><br><span class="line"><span class="comment">	* Properties for OpenLayers.Strategy.Cluster </span></span><br><span class="line"><span class="comment">	* and OpenLayers.Strategy.AnimatedCluster if included</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	startegyParam:</span><br><span class="line">	&#123;	<span class="comment">/**</span></span><br><span class="line"><span class="comment">		* APIProperty: distance</span></span><br><span class="line"><span class="comment">		* &#123;Integer&#125; Pixel distance between features that should be considered a</span></span><br><span class="line"><span class="comment">		* single cluster. Default is 45 pixels.</span></span><br><span class="line"><span class="comment">		*/</span></span><br><span class="line">		distance: <span class="number">45</span>,</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		* APIProperty: animationMethod for animated cluster if included</span></span><br><span class="line"><span class="comment">		* https://github.com/acanimal/AnimatedCluster</span></span><br><span class="line"><span class="comment">		*/</span></span><br><span class="line">		animationMethod: OpenLayers.Easing.Expo.easeOut,</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		* APIProperty: animationDuration for animated cluster if included</span></span><br><span class="line"><span class="comment">		* https://github.com/acanimal/AnimatedCluster</span></span><br><span class="line"><span class="comment">		*/</span></span><br><span class="line">		animationDuration: <span class="number">30</span></span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	* Constructor: OpenLayers.Layer.Cluster</span></span><br><span class="line"><span class="comment">	* Create a new cluster layer</span></span><br><span class="line"><span class="comment">	*</span></span><br><span class="line"><span class="comment">	* Parameters:</span></span><br><span class="line"><span class="comment">	* name - &#123;String&#125; A name for the layer</span></span><br><span class="line"><span class="comment">	* options - &#123;Object&#125; Optional object with non-default properties to set on</span></span><br><span class="line"><span class="comment">	* the layer. Use options.startegyParam to setup cluster strategy properties.</span></span><br><span class="line"><span class="comment">	*</span></span><br><span class="line"><span class="comment">	* Returns:</span></span><br><span class="line"><span class="comment">	* &#123;&lt;OpenLayers.Layer.Vector&gt;&#125; A new vector layer</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	initialize: <span class="function"><span class="keyword">function</span>(<span class="params">name, options</span>) </span></span><br><span class="line"><span class="function">	</span>&#123;   <span class="keyword">if</span> (!options) options=&#123;&#125;;</span><br><span class="line">		<span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">		<span class="comment">// </span></span><br><span class="line">		<span class="keyword">var</span> smap = options.styleMap;</span><br><span class="line">		<span class="keyword">if</span> (!smap) </span><br><span class="line">		&#123;	options.styleMap = smap = <span class="keyword">new</span> OpenLayers.StyleMap (OpenLayers.Util.extend(&#123;&#125;,OpenLayers.Feature.Vector.style));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!smap.styles[<span class="string">"default"</span>].context) smap.styles[<span class="string">"default"</span>].context=&#123;&#125;;</span><br><span class="line">		<span class="comment">// Overload a style</span></span><br><span class="line">		<span class="function"><span class="keyword">function</span> <span class="title">overrideStyle</span> (<span class="params">s,f</span>)</span></span><br><span class="line"><span class="function">		</span>&#123;	<span class="keyword">var</span> f0, v0;</span><br><span class="line">			<span class="comment">// is a value</span></span><br><span class="line">			v0 = smap.styles[<span class="string">"default"</span>].defaultStyle[s];</span><br><span class="line">			<span class="comment">// is a function</span></span><br><span class="line">			<span class="keyword">if</span> (v0 &amp;&amp; v0.match) f0 = v0.match(<span class="regexp">/^\$\&#123;(.*)\&#125;$/</span>);</span><br><span class="line">			<span class="keyword">if</span> (f0) f0 = smap.styles[<span class="string">"default"</span>].context[f0[<span class="number">1</span>]];</span><br><span class="line">			<span class="comment">// Override</span></span><br><span class="line">			smap.styles[<span class="string">"default"</span>].defaultStyle[s] = <span class="string">"$&#123;"</span>+s+<span class="string">"&#125;"</span>;</span><br><span class="line">			smap.styles[<span class="string">"default"</span>].context[s] = <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>)</span></span><br><span class="line"><span class="function">				</span>&#123;	<span class="keyword">if</span> (feature.cluster &amp;&amp; self.countFeaturesInCluster(feature)&gt;<span class="number">1</span>) <span class="keyword">return</span> f(feature);</span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">return</span> f0 ? f0(feature) : v0 ? v0 : <span class="string">""</span>;</span><br><span class="line">				&#125;;</span><br><span class="line">			smap.styles[<span class="string">"default"</span>].propertyStyles[s] = <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// Overload pointRadius</span></span><br><span class="line">		<span class="keyword">var</span> pointRadius = smap.styles[<span class="string">"default"</span>].defaultStyle.pointRadius || <span class="number">3</span>;</span><br><span class="line">		<span class="keyword">var</span> minRadius = smap.styles[<span class="string">"default"</span>].defaultStyle.minRadius || <span class="number">6</span>;</span><br><span class="line">		<span class="keyword">var</span> maxRadius = smap.styles[<span class="string">"default"</span>].defaultStyle.maxRadius || <span class="number">30</span>;</span><br><span class="line">		<span class="keyword">var</span> facRadius = smap.styles[<span class="string">"default"</span>].defaultStyle.facRadius || <span class="number">1</span>;</span><br><span class="line"><span class="comment">//		overrideStyle ("pointRadius", function(feature) &#123; return Math.min(minRadius + (feature.attributes.count-1)*facRadius,maxRadius);&#125;);</span></span><br><span class="line">		overrideStyle (<span class="string">"pointRadius"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">Math</span>.min(minRadius + (self.countFeaturesInCluster(feature)<span class="number">-1</span>)*facRadius,maxRadius);&#125;);</span><br><span class="line">		<span class="comment">// Overload strokeWidth</span></span><br><span class="line">		overrideStyle (<span class="string">"strokeWidth"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>) </span>&#123; <span class="keyword">return</span> <span class="number">10</span>; &#125;);</span><br><span class="line">		<span class="comment">// Overload strokeOpacity</span></span><br><span class="line">		overrideStyle (<span class="string">"strokeOpacity"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>) </span>&#123; <span class="keyword">return</span> <span class="number">0.5</span>; &#125;);</span><br><span class="line">		<span class="comment">// Overload strokeColor</span></span><br><span class="line">		<span class="keyword">var</span> fillColor = smap.styles[<span class="string">"default"</span>].defaultStyle.fillColor;</span><br><span class="line">		<span class="keyword">var</span> fillColorFunction = <span class="literal">null</span>;</span><br><span class="line">		<span class="keyword">if</span> (fillColor &amp;&amp; fillColor.match) </span><br><span class="line">		&#123;	fillColorFunction = fillColor.match(<span class="regexp">/^\$\&#123;(.*)\&#125;$/</span>);</span><br><span class="line">			<span class="keyword">if</span> (fillColorFunction) fillColorFunction = smap.styles[<span class="string">"default"</span>].context[fillColorFunction[<span class="number">1</span>]];</span><br><span class="line">		&#125;</span><br><span class="line">		overrideStyle (<span class="string">"strokeColor"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>) </span></span><br><span class="line"><span class="function">		</span>&#123;	<span class="keyword">return</span> fillColorFunction ? fillColorFunction(feature) : fillColor; </span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="comment">// Overload fillOpacity</span></span><br><span class="line">		overrideStyle (<span class="string">"fillOpacity"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>) </span>&#123; <span class="keyword">return</span> <span class="number">1</span>; &#125;);</span><br><span class="line">		<span class="comment">// Overload externalGraphic</span></span><br><span class="line">		overrideStyle (<span class="string">"externalGraphic"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>) </span>&#123; <span class="keyword">return</span> <span class="string">""</span>; &#125;);</span><br><span class="line">		<span class="comment">// Overload externalGraphic</span></span><br><span class="line">		overrideStyle (<span class="string">"backgroundGraphic"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>) </span>&#123; <span class="keyword">return</span> <span class="string">""</span>; &#125;);</span><br><span class="line">		<span class="comment">// Overload label</span></span><br><span class="line">		overrideStyle (<span class="string">"label"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>) </span>&#123; <span class="keyword">return</span> self.countFeaturesInCluster(feature); &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="keyword">var</span> strategy;</span><br><span class="line">		<span class="keyword">if</span> (OpenLayers.Strategy.AnimatedCluster) strategy = OpenLayers.Strategy.AnimatedCluster</span><br><span class="line">		<span class="keyword">else</span> strategy = OpenLayers.Strategy.Cluster;</span><br><span class="line">		<span class="keyword">var</span> strategy_clusters = <span class="keyword">new</span> strategy (&#123;</span><br><span class="line">				distance: <span class="keyword">this</span>.startegyParam.distance,</span><br><span class="line">				animationMethod: <span class="keyword">this</span>.startegyParam.animationMethod,</span><br><span class="line">				animationDuration: <span class="keyword">this</span>.startegyParam.animationDuration</span><br><span class="line">			&#125;);</span><br><span class="line">		<span class="keyword">this</span>.strategy_clusters = strategy_clusters;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (options.strategies) options.strategies.push(strategy_clusters);</span><br><span class="line">		<span class="keyword">else</span> options.strategies = [strategy_clusters];</span><br><span class="line"></span><br><span class="line">		OpenLayers.Layer.Vector.prototype.initialize.apply(<span class="keyword">this</span>, [name, options]);</span><br><span class="line">	&#125;,</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/** Add new feature : the standard method remove existing features</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	addFeatures: <span class="function"><span class="keyword">function</span> (<span class="params">features</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;	<span class="keyword">if</span> (!<span class="keyword">this</span>.strategy_clusters.clustering)</span><br><span class="line">		&#123;	<span class="keyword">var</span> f = <span class="keyword">this</span>.strategy_clusters.features;</span><br><span class="line">			<span class="keyword">if</span> (f) features = features.concat(f);</span><br><span class="line">		&#125;</span><br><span class="line">		OpenLayers.Layer.Vector.prototype.addFeatures.apply(<span class="keyword">this</span>, [features]);</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Refresh the layer : re-calculate the clusters</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	refresh: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;	<span class="comment">//this.strategy_clusters.clusters=null;</span></span><br><span class="line">		<span class="keyword">this</span>.strategy_clusters.resolution = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">this</span>.strategy_clusters.cluster();</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Compact features at the same coords in a cluster to minimze number of features</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	compact: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;	<span class="keyword">if</span> (<span class="keyword">this</span>.isCompact) <span class="keyword">return</span>;</span><br><span class="line">		<span class="keyword">var</span> features = <span class="keyword">this</span>.strategy_clusters.features;</span><br><span class="line">		<span class="keyword">var</span> clusters = [];</span><br><span class="line">		<span class="keyword">var</span> clustered;</span><br><span class="line">		<span class="comment">// Cluster features at the same coord</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;features.length; i++)</span><br><span class="line">		&#123;	feature = features[i];</span><br><span class="line">			<span class="keyword">if</span>(feature.geometry) </span><br><span class="line">			&#123;	clustered = <span class="literal">false</span>;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">var</span> j=clusters.length<span class="number">-1</span>; j&gt;=<span class="number">0</span>; --j) </span><br><span class="line">				&#123;	cluster = clusters[j];</span><br><span class="line">					<span class="keyword">if</span>(feature.geometry.getBounds().getCenterLonLat().equals(cluster.geometry.getBounds().getCenterLonLat())) </span><br><span class="line">					&#123;	cluster.cluster.push(feature);</span><br><span class="line">						cluster.attributes.count += <span class="number">1</span>;</span><br><span class="line">						clustered = <span class="literal">true</span>;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (!clustered) </span><br><span class="line">				&#123;	<span class="keyword">var</span> center = feature.geometry.getBounds().getCenterLonLat();</span><br><span class="line">					<span class="keyword">var</span> cluster = <span class="keyword">new</span> OpenLayers.Feature.Vector(</span><br><span class="line">						<span class="keyword">new</span> OpenLayers.Geometry.Point(center.lon, center.lat),</span><br><span class="line">						&#123;<span class="attr">count</span>: <span class="number">1</span>&#125;</span><br><span class="line">					);</span><br><span class="line">					cluster.cluster = [feature];</span><br><span class="line">					clusters.push(cluster);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		features = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">		<span class="keyword">var</span> l = clusters.length;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;l; i++)</span><br><span class="line">		&#123;	<span class="keyword">if</span> (clusters[i].cluster &amp;&amp; clusters[i].attributes.count==<span class="number">1</span>) features.push(clusters[i].cluster[<span class="number">0</span>]);</span><br><span class="line">			<span class="keyword">else</span> features.push(clusters[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// Add the new features</span></span><br><span class="line">		OpenLayers.Layer.Vector.prototype.addFeatures.apply(<span class="keyword">this</span>, [features]);</span><br><span class="line">		<span class="keyword">this</span>.isCompact = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">this</span>.refresh();</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Count number of feature in a cluster</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	countFeaturesInCluster: <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;	<span class="keyword">if</span> (feature.layer != <span class="keyword">this</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (feature.cluster)</span><br><span class="line">		&#123;	<span class="comment">// Normal cluster</span></span><br><span class="line">			<span class="keyword">if</span> (!<span class="keyword">this</span>.isCompact) <span class="keyword">return</span> feature.attributes.count;</span><br><span class="line">			<span class="keyword">var</span> c = <span class="number">0</span>;</span><br><span class="line">			<span class="comment">// Compact Cluster &gt; count cluster of cluster</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;feature.cluster.length; i++)</span><br><span class="line">			&#123;	c += feature.cluster[i].cluster ? feature.cluster[i].attributes.count : <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> c;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// No cluster</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Get the features in a cluster</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	getFeaturesInCluster: <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;	<span class="keyword">if</span> (feature.layer != <span class="keyword">this</span>) <span class="keyword">return</span> [feature];</span><br><span class="line">		<span class="keyword">if</span> (feature.cluster)</span><br><span class="line">		&#123;	<span class="comment">// Normal cluster</span></span><br><span class="line">			<span class="keyword">if</span> (!<span class="keyword">this</span>.isCompact) <span class="keyword">return</span> feature.cluster;</span><br><span class="line">			<span class="keyword">var</span> f=<span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">			<span class="comment">// Compact Cluster &gt; count cluster of cluster</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;feature.cluster.length; i++)</span><br><span class="line">			&#123;	<span class="keyword">if</span> (feature.cluster[i].cluster) </span><br><span class="line">				&#123;	<span class="keyword">for</span> (k=<span class="number">0</span>; k&lt;feature.cluster[i].cluster.length; k++) </span><br><span class="line">						f.push( feature.cluster[i].cluster[k] )</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> f.push( feature.cluster[i] );</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> f;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// No cluster</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">return</span> [feature];</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Cluster layer */</span></span><br><span class="line">	CLASS_NAME: <span class="string">"OpenLayers.Layer.Cluster"</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>selectcluster.js</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Copyright (c) 2014 by Jean-Marc.Viglino [at]ign.fr</span></span><br><span class="line"><span class="comment">* Dual-licensed under the CeCILL-B Licence (http://www.cecill.info/)</span></span><br><span class="line"><span class="comment">* and the Beerware license (http://en.wikipedia.org/wiki/Beerware), </span></span><br><span class="line"><span class="comment">* feel free to use and abuse it in your projects (the code, not the beer ;-). </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Class: OpenLayers.Control.SelectCluster</span></span><br><span class="line"><span class="comment">* The SelectCluster control selects vector features from a given </span></span><br><span class="line"><span class="comment">* cluster layer on click or hover.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* Inherits from:</span></span><br><span class="line"><span class="comment">* - &lt;OpenLayers.Control.SelectFeature&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">OpenLayers.Control.SelectCluster = OpenLayers.Class(OpenLayers.Control.SelectFeature, </span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* APIProperty: connect</span></span><br><span class="line"><span class="comment">	* &#123;Boolean&#125; Draw connection lines to the cluster. Default is false.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	connect: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* APIProperty: animate</span></span><br><span class="line"><span class="comment">	* &#123;Boolean&#125; Play an animation. Default is false.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	animate:<span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* APIProperty: animationDuration</span></span><br><span class="line"><span class="comment">	* &#123;Integer&#125; The number of steps to be passed to the OpenLayers.Tween.start() </span></span><br><span class="line"><span class="comment">	* method when the clusters are animated.</span></span><br><span class="line"><span class="comment">	* Default is 40.	</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	animationDuration: <span class="number">40</span>,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* APIProperty: pointRadius</span></span><br><span class="line"><span class="comment">	* &#123;Number&#125; Radius of the points in the cluster. Default is 12.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	pointRadius: <span class="number">12</span>,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* APIProperty: circleMaxObject</span></span><br><span class="line"><span class="comment">	* &#123;Integer&#125; Number of points to be drawn on a circle. Default is 10</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	circleMaxObject: <span class="number">10</span>,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* APIProperty: spiral</span></span><br><span class="line"><span class="comment">	* &#123;Boolean&#125; Allow to draw point on a spiral when more than circleMaxObject. Default is true</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	spiral: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* APIProperty: maxPoint</span></span><br><span class="line"><span class="comment">	* &#123;Boolean&#125; Number of points to be drawn on a spiral. Default is 60</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	maxPoint: <span class="number">60</span>,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* Property: animationTween</span></span><br><span class="line"><span class="comment">	* &#123;OpenLayers.Tween&#125; Tween for animation.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	animationTween: <span class="keyword">new</span> OpenLayers.Tween(OpenLayers.Easing.Expo.easeOut),</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Initialize the SelectCluster control</span></span><br><span class="line">    initialize: <span class="function"><span class="keyword">function</span>(<span class="params">layers, options</span>) </span></span><br><span class="line"><span class="function">	</span>&#123;	<span class="keyword">if</span> (!layers.length) layers = [layers];</span><br><span class="line">		<span class="keyword">var</span> smap = layers[<span class="number">0</span>].styleMap;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// Add a new layer to store selection</span></span><br><span class="line">		<span class="keyword">this</span>.selLayer = <span class="keyword">new</span> OpenLayers.Layer.Vector(<span class="string">"Selection"</span>,</span><br><span class="line">				&#123;	<span class="attr">displayInLayerSwitcher</span>: <span class="literal">false</span>,</span><br><span class="line">					visibility:<span class="literal">false</span>,</span><br><span class="line">					<span class="comment">// Get the yOrdering for shadow on marker</span></span><br><span class="line">					rendererOptions: layers[<span class="number">0</span>].rendererOptions,</span><br><span class="line">					styleMap: smap</span><br><span class="line">				&#125;);</span><br><span class="line">		<span class="comment">// Add this layer to selection</span></span><br><span class="line">		layers.push(<span class="keyword">this</span>.selLayer);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// No box selection</span></span><br><span class="line">		<span class="keyword">if</span> (options) options.box = <span class="literal">false</span>;</span><br><span class="line">	</span><br><span class="line">		OpenLayers.Control.SelectFeature.prototype.initialize.apply(<span class="keyword">this</span>, [layers, options]);</span><br><span class="line"></span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* Method: setMap</span></span><br><span class="line"><span class="comment">	* Set the map property for the control.</span></span><br><span class="line"><span class="comment">	*</span></span><br><span class="line"><span class="comment">	* Parameters:</span></span><br><span class="line"><span class="comment">	* map - &#123;&lt;OpenLayers.Map&gt;&#125;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">    setMap: <span class="function"><span class="keyword">function</span>(<span class="params">map</span>) </span></span><br><span class="line"><span class="function">	</span>&#123;   OpenLayers.Control.SelectFeature.prototype.setMap.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">		</span><br><span class="line">		map.addLayer(<span class="keyword">this</span>.selLayer);</span><br><span class="line">		map.events.register(<span class="string">'movestart'</span>, <span class="keyword">this</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span></span><br><span class="line"><span class="function">		</span>&#123;	<span class="comment">//if(e.zoomChanged)</span></span><br><span class="line">			&#123;	<span class="keyword">this</span>.unselectAll(); </span><br><span class="line">				<span class="keyword">this</span>.selLayer.setVisibility(<span class="literal">false</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">		map.events.register(<span class="string">'changelayer'</span>, <span class="keyword">this</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span></span><br><span class="line"><span class="function">		</span>&#123;	<span class="keyword">if</span> (	e.property == <span class="string">"visibility"</span> </span><br><span class="line">				&amp;&amp;	e.layer != <span class="keyword">this</span>.selLayer </span><br><span class="line">				&amp;&amp;	OpenLayers.Util.indexOf(<span class="keyword">this</span>.layers,e.layer) &gt; <span class="number">-1</span> </span><br><span class="line">				) </span><br><span class="line">				<span class="keyword">this</span>.selLayer.setVisibility(<span class="literal">false</span>);</span><br><span class="line">		&#125;);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* Method: select</span></span><br><span class="line"><span class="comment">	* If the feature is a cluster spread it out in selLayer.</span></span><br><span class="line"><span class="comment">	* Otherwise, do default action.</span></span><br><span class="line"><span class="comment">	*</span></span><br><span class="line"><span class="comment">	* Parameters:</span></span><br><span class="line"><span class="comment">	* feature - &#123;&lt;OpenLayers.Feature.Vector&gt;&#125;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">    select: <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>) </span></span><br><span class="line"><span class="function">	</span>&#123;	<span class="comment">// Don't spread twice</span></span><br><span class="line">		<span class="keyword">if</span> (feature == <span class="keyword">this</span>.lastCluster &amp;&amp; <span class="keyword">this</span>.selLayer.getVisibility()) <span class="keyword">return</span>;</span><br><span class="line">		<span class="keyword">var</span> count=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">var</span> layer = feature.layer;</span><br><span class="line">		<span class="comment">// Spread the cluster out</span></span><br><span class="line">		<span class="keyword">if</span> (feature.cluster) </span><br><span class="line">		&#123;	<span class="keyword">this</span>.lastCluster = feature;</span><br><span class="line">			<span class="comment">// Clear the Layer</span></span><br><span class="line">			<span class="keyword">this</span>.selLayer.removeAllFeatures();</span><br><span class="line">			<span class="keyword">this</span>.selLayer.setVisibility(<span class="literal">true</span>);</span><br><span class="line">			<span class="keyword">if</span> (layer &amp;&amp; layer.countFeaturesInCluster) count = layer.countFeaturesInCluster(feature);</span><br><span class="line">			<span class="keyword">else</span> count = feature.cluster.attributes.count;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (count&gt;<span class="number">1</span>)</span><br><span class="line">		&#123;	</span><br><span class="line">			<span class="comment">// Pixel size in map unit</span></span><br><span class="line">			<span class="keyword">var</span> pix = feature.layer.map.resolution;</span><br><span class="line">			<span class="keyword">var</span> cluster = <span class="keyword">new</span> <span class="built_in">Array</span>();;</span><br><span class="line">			<span class="keyword">if</span> (layer &amp;&amp; layer.getFeaturesInCluster)</span><br><span class="line">			&#123;	cluster = layer.getFeaturesInCluster(feature);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> cluster = feature.cluster;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// Draw on a circle</span></span><br><span class="line">			<span class="keyword">if</span> (!<span class="keyword">this</span>.spiral || cluster.length &lt;= <span class="keyword">this</span>.circleMaxObject)</span><br><span class="line">			&#123;	<span class="keyword">var</span> r = pix * <span class="keyword">this</span>.pointRadius * (<span class="number">0.5</span> + cluster.length / <span class="number">4</span>);</span><br><span class="line">				<span class="keyword">var</span> features = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">				<span class="keyword">var</span> links = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">				<span class="keyword">var</span> max = <span class="built_in">Math</span>.min(cluster.length, <span class="keyword">this</span>.circleMaxObject);</span><br><span class="line">				<span class="comment">// Features on a circle</span></span><br><span class="line">				<span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;max; i++)</span><br><span class="line">				&#123;	<span class="comment">// New feature</span></span><br><span class="line">					<span class="keyword">var</span> f = cluster[i].clone();</span><br><span class="line">					<span class="keyword">var</span> a = <span class="number">2</span>*<span class="built_in">Math</span>.PI*i/max;</span><br><span class="line">					<span class="keyword">if</span> (max==<span class="number">2</span> || max == <span class="number">4</span>) a += <span class="built_in">Math</span>.PI/<span class="number">4</span>;</span><br><span class="line">					<span class="keyword">if</span> (<span class="keyword">this</span>.animate)</span><br><span class="line">					&#123;	f.dataAnimate = </span><br><span class="line">							&#123;	<span class="attr">x0</span>:feature.geometry.x, <span class="attr">y0</span>:feature.geometry.y,</span><br><span class="line">								x1:feature.geometry.x+r*<span class="built_in">Math</span>.sin(a), <span class="attr">y1</span>:feature.geometry.y+r*<span class="built_in">Math</span>.cos(a) </span><br><span class="line">							&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span> f.geometry = <span class="keyword">new</span> OpenLayers.Geometry.Point (feature.geometry.x+r*<span class="built_in">Math</span>.sin(a), feature.geometry.y+r*<span class="built_in">Math</span>.cos(a));</span><br><span class="line">					<span class="comment">// Draw connection</span></span><br><span class="line">					<span class="keyword">if</span> (<span class="keyword">this</span>.connect)</span><br><span class="line">					&#123;	<span class="keyword">var</span> f2 = cluster[i].clone();</span><br><span class="line">						f2.geometry = <span class="keyword">new</span> OpenLayers.Geometry.LineString (</span><br><span class="line">							[	f.geometry ,</span><br><span class="line">								feature.geometry</span><br><span class="line">							]);</span><br><span class="line">						links.push(f2);</span><br><span class="line">					&#125;</span><br><span class="line">					features.push(f);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (<span class="keyword">this</span>.connect) <span class="keyword">this</span>.selLayer.addFeatures(links);</span><br><span class="line">				<span class="keyword">this</span>.selLayer.addFeatures(features);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// Draw on a spiral</span></span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;	<span class="comment">// Angle de depart</span></span><br><span class="line">				<span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">var</span> r;</span><br><span class="line">				<span class="keyword">var</span> d = <span class="number">2</span>*<span class="keyword">this</span>.pointRadius;</span><br><span class="line">				<span class="keyword">var</span> features = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">				<span class="keyword">var</span> links = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">				<span class="keyword">var</span> max = <span class="built_in">Math</span>.min (<span class="keyword">this</span>.maxPoint, cluster.length);</span><br><span class="line">				<span class="comment">// Feature on a spiral</span></span><br><span class="line">				<span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;max; i++)</span><br><span class="line">				&#123;	<span class="comment">// Nouveau rayon</span></span><br><span class="line">					r = d/<span class="number">2</span> + d*a/(<span class="number">2</span>*<span class="built_in">Math</span>.PI);</span><br><span class="line">					<span class="comment">// Angle</span></span><br><span class="line">					a = a + (d+<span class="number">0.1</span>)/r;</span><br><span class="line">					<span class="keyword">var</span> dx = pix*r*<span class="built_in">Math</span>.sin(a)</span><br><span class="line">					<span class="keyword">var</span> dy = pix*r*<span class="built_in">Math</span>.cos(a)</span><br><span class="line">					<span class="comment">// New Feature</span></span><br><span class="line">					<span class="keyword">var</span> f = cluster[i].clone();</span><br><span class="line">					<span class="keyword">if</span> (<span class="keyword">this</span>.animate)</span><br><span class="line">					&#123;	f.dataAnimate = </span><br><span class="line">							&#123;	<span class="attr">x0</span>:feature.geometry.x, <span class="attr">y0</span>:feature.geometry.y,</span><br><span class="line">								x1:feature.geometry.x+dx, <span class="attr">y1</span>:feature.geometry.y+dy </span><br><span class="line">							&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span> f.geometry = <span class="keyword">new</span> OpenLayers.Geometry.Point (feature.geometry.x+dx, feature.geometry.y+dy);</span><br><span class="line">					features.push(f);</span><br><span class="line">					<span class="comment">// Draw connection</span></span><br><span class="line">					<span class="keyword">if</span> (<span class="keyword">this</span>.connect)</span><br><span class="line">					&#123;	<span class="keyword">var</span> f2 = cluster[i].clone();</span><br><span class="line">						f2.geometry = <span class="keyword">new</span> OpenLayers.Geometry.LineString (</span><br><span class="line">							[	f.geometry ,</span><br><span class="line">								feature.geometry</span><br><span class="line">							]);</span><br><span class="line">						links.push (f2);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (<span class="keyword">this</span>.connect) <span class="keyword">this</span>.selLayer.addFeatures(links);</span><br><span class="line">				<span class="keyword">this</span>.selLayer.addFeatures(features);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">this</span>.animate)</span><br><span class="line">			&#123;	<span class="comment">// Animation</span></span><br><span class="line">				<span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">				<span class="keyword">this</span>.animationTween.start ( &#123;<span class="attr">pos</span>:<span class="number">0.0</span>&#125;, &#123;<span class="attr">pos</span>:<span class="number">1.0</span>&#125;, <span class="keyword">this</span>.animationDuration, </span><br><span class="line">					&#123;   <span class="attr">callbacks</span>: </span><br><span class="line">						&#123;	<span class="attr">eachStep</span>: <span class="function"><span class="keyword">function</span> (<span class="params">delta</span>) </span>&#123; self.doAnimation(delta); &#125;,</span><br><span class="line">							done: <span class="function"><span class="keyword">function</span> (<span class="params">delta</span>) </span>&#123; self.doAnimation(delta, <span class="literal">true</span>); &#125;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;	OpenLayers.Control.SelectFeature.prototype.select.apply(<span class="keyword">this</span>, [feature]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* Method: doAnimation</span></span><br><span class="line"><span class="comment">	* Calculate animation on the features in the layer.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	doAnimation: <span class="function"><span class="keyword">function</span> (<span class="params">delta, last</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;	<span class="keyword">var</span> pos = delta.pos;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="keyword">this</span>.selLayer.features.length; i++) </span><br><span class="line">		&#123;	<span class="keyword">var</span> f = <span class="keyword">this</span>.selLayer.features[i];</span><br><span class="line">			<span class="keyword">if</span> (f.dataAnimate)</span><br><span class="line">			&#123;	f.geometry.x = f.dataAnimate.x0 + (f.dataAnimate.x1 - f.dataAnimate.x0) *pos;</span><br><span class="line">				f.geometry.y = f.dataAnimate.y0 + (f.dataAnimate.y1 - f.dataAnimate.y0) *pos;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (pos==<span class="number">1.0</span>) f.geometry.calculateBounds();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.selLayer.redraw();</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* Method: clickoutFeature</span></span><br><span class="line"><span class="comment">	* Called on click outside a previously clicked (selected) feature.</span></span><br><span class="line"><span class="comment">	* Only responds if this.hover is false.</span></span><br><span class="line"><span class="comment">	*</span></span><br><span class="line"><span class="comment">	* Parameters:</span></span><br><span class="line"><span class="comment">	* feature - &#123;&lt;OpenLayers.Vector.Feature&gt;&#125;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	clickoutFeature: <span class="function"><span class="keyword">function</span>(<span class="params">feature</span>) </span></span><br><span class="line"><span class="function">	</span>&#123;	<span class="keyword">if</span>(!<span class="keyword">this</span>.hover &amp;&amp; <span class="keyword">this</span>.clickout) </span><br><span class="line">		&#123;	<span class="keyword">this</span>.selLayer.setVisibility(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">this</span>.unselectAll();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	* Method: getSelection</span></span><br><span class="line"><span class="comment">	* Return the selected features.</span></span><br><span class="line"><span class="comment">	*</span></span><br><span class="line"><span class="comment">	* Parameters:</span></span><br><span class="line"><span class="comment">	* cluster - &#123;Boolean&#125; Get cluster features or original features (pay attention original features may have inconsistent layer). Default is false.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	getSelection: <span class="function"><span class="keyword">function</span>(<span class="params">cluster</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;	<span class="keyword">var</span> i, j;</span><br><span class="line">		<span class="keyword">var</span> sel = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">		<span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="keyword">this</span>.layers.length; i++)</span><br><span class="line">		&#123;	<span class="keyword">var</span> s = <span class="keyword">this</span>.layers[i].selectedFeatures;</span><br><span class="line">			<span class="keyword">for</span> (j=<span class="number">0</span>; j&lt;s.length; j++)</span><br><span class="line">			&#123;	<span class="keyword">if</span> (!cluster)</span><br><span class="line">				&#123;	<span class="keyword">if</span> (!s[j].cluster) sel.push(s[j]);</span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span> (s[j].cluster.length == <span class="number">1</span>) sel.push(s[j].cluster[<span class="number">0</span>]);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> sel.push(s[j]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> sel;</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	CLASS_NAME: <span class="string">"OpenLayers.Layer.SelectCluster"</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>OpenLayers.js  官方库，也可以自行下载 ，很长，但是还是放到这里吧</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  OpenLayers.js -- OpenLayers Map Viewer Library</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  Copyright (c) 2006-2013 by OpenLayers Contributors</span></span><br><span class="line"><span class="comment">  Published under the 2-clause BSD license.</span></span><br><span class="line"><span class="comment">  See http://openlayers.org/dev/license.txt for the full text of the license, and http://openlayers.org/dev/authors.txt for full list of contributors.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  Includes compressed code under the following licenses:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  (For uncompressed versions of the code used, please see the</span></span><br><span class="line"><span class="comment">  OpenLayers Github repository: &lt;https://github.com/openlayers/openlayers&gt;)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Contains XMLHttpRequest.js &lt;http://code.google.com/p/xmlhttprequest/&gt;</span></span><br><span class="line"><span class="comment"> * Copyright 2007 Sergey Ilinsky (http://www.ilinsky.com)</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Licensed under the Apache License, Version 2.0 (the "License");</span></span><br><span class="line"><span class="comment"> * you may not use this file except in compliance with the License.</span></span><br><span class="line"><span class="comment"> * You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment"> * http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * OpenLayers.Util.pagePosition is based on Yahoo's getXY method, which is</span></span><br><span class="line"><span class="comment"> * Copyright (c) 2006, Yahoo! Inc.</span></span><br><span class="line"><span class="comment"> * All rights reserved.</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * Redistribution and use of this software in source and binary forms, with or</span></span><br><span class="line"><span class="comment"> * without modification, are permitted provided that the following conditions</span></span><br><span class="line"><span class="comment"> * are met:</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * * Redistributions of source code must retain the above copyright notice,</span></span><br><span class="line"><span class="comment"> *   this list of conditions and the following disclaimer.</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * * Redistributions in binary form must reproduce the above copyright notice,</span></span><br><span class="line"><span class="comment"> *   this list of conditions and the following disclaimer in the documentation</span></span><br><span class="line"><span class="comment"> *   and/or other materials provided with the distribution.</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * * Neither the name of Yahoo! Inc. nor the names of its contributors may be</span></span><br><span class="line"><span class="comment"> *   used to endorse or promote products derived from this software without</span></span><br><span class="line"><span class="comment"> *   specific prior written permission of Yahoo! Inc.</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"</span></span><br><span class="line"><span class="comment"> * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span></span><br><span class="line"><span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span></span><br><span class="line"><span class="comment"> * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE</span></span><br><span class="line"><span class="comment"> * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span></span><br><span class="line"><span class="comment"> * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span></span><br><span class="line"><span class="comment"> * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span></span><br><span class="line"><span class="comment"> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span></span><br><span class="line"><span class="comment"> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span></span><br><span class="line"><span class="comment"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE </span></span><br><span class="line"><span class="comment"> * POSSIBILITY OF SUCH DAMAGE.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> OpenLayers=&#123;<span class="attr">VERSION_NUMBER</span>:<span class="string">"Release 2.13.1"</span>,<span class="attr">singleFile</span>:!<span class="number">0</span>,<span class="attr">_getScriptLocation</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="regexp">/(^|(.*?\/))(OpenLayers[^\/]*?\.js)(\?|$)/</span>,b=<span class="built_in">document</span>.getElementsByTagName(<span class="string">"script"</span>),c,d=<span class="string">""</span>,e=<span class="number">0</span>,f=b.length;e&lt;f;e++)<span class="keyword">if</span>(c=b[e].getAttribute(<span class="string">"src"</span>))<span class="keyword">if</span>(c=c.match(a))&#123;d=c[<span class="number">1</span>];<span class="keyword">break</span>&#125;<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> d&#125;&#125;(),<span class="attr">ImgPath</span>:<span class="string">""</span>&#125;;OpenLayers.Class=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="built_in">arguments</span>.length,b=<span class="built_in">arguments</span>[<span class="number">0</span>],c=<span class="built_in">arguments</span>[a<span class="number">-1</span>],d=<span class="string">"function"</span>==<span class="keyword">typeof</span> c.initialize?c.initialize:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;b.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;;<span class="number">1</span>&lt;a?(a=[d,b].concat(<span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>).slice(<span class="number">1</span>,a<span class="number">-1</span>),c),OpenLayers.inherit.apply(<span class="literal">null</span>,a)):d.prototype=c;<span class="keyword">return</span> d&#125;;</span><br><span class="line">OpenLayers.inherit=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;c.prototype=b.prototype;a.prototype=<span class="keyword">new</span> c;<span class="keyword">var</span> d,e,c=<span class="number">2</span>;<span class="keyword">for</span>(d=<span class="built_in">arguments</span>.length;c&lt;d;c++)e=<span class="built_in">arguments</span>[c],<span class="string">"function"</span>===<span class="keyword">typeof</span> e&amp;&amp;(e=e.prototype),OpenLayers.Util.extend(a.prototype,e)&#125;;OpenLayers.Util=OpenLayers.Util||&#123;&#125;;OpenLayers.Util.extend=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a=a||&#123;&#125;;<span class="keyword">if</span>(b)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c <span class="keyword">in</span> b)&#123;<span class="keyword">var</span> d=b[c];<span class="keyword">void</span> <span class="number">0</span>!==d&amp;&amp;(a[c]=d)&#125;<span class="string">"function"</span>==<span class="keyword">typeof</span> <span class="built_in">window</span>.Event&amp;&amp;b <span class="keyword">instanceof</span> <span class="built_in">window</span>.Event||(!b.hasOwnProperty||!b.hasOwnProperty(<span class="string">"toString"</span>))||(a.toString=b.toString)&#125;<span class="keyword">return</span> a&#125;;OpenLayers.String=&#123;<span class="attr">startsWith</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="number">0</span>==a.indexOf(b)&#125;,<span class="attr">contains</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span><span class="number">-1</span>!=a.indexOf(b)&#125;,<span class="attr">trim</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a.replace(<span class="regexp">/^\s\s*/</span>,<span class="string">""</span>).replace(<span class="regexp">/\s\s*$/</span>,<span class="string">""</span>)&#125;,<span class="attr">camelize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.split(<span class="string">"-"</span>);<span class="keyword">for</span>(<span class="keyword">var</span> b=a[<span class="number">0</span>],c=<span class="number">1</span>,d=a.length;c&lt;d;c++)<span class="keyword">var</span> e=a[c],b=b+(e.charAt(<span class="number">0</span>).toUpperCase()+e.substring(<span class="number">1</span>));<span class="keyword">return</span> b&#125;,<span class="attr">format</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;b||(b=<span class="built_in">window</span>);<span class="keyword">return</span> a.replace(OpenLayers.String.tokenRegEx,<span class="function"><span class="keyword">function</span>(<span class="params">a,e</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> f,g=e.split(<span class="regexp">/\.+/</span>),h=<span class="number">0</span>;h&lt;g.length;h++)&#123;<span class="number">0</span>==h&amp;&amp;(f=b);<span class="keyword">if</span>(<span class="keyword">void</span> <span class="number">0</span>===f)<span class="keyword">break</span>;</span><br><span class="line">f=f[g[h]]&#125;<span class="string">"function"</span>==<span class="keyword">typeof</span> f&amp;&amp;(f=c?f.apply(<span class="literal">null</span>,c):f());<span class="keyword">return</span><span class="string">"undefined"</span>==<span class="keyword">typeof</span> f?<span class="string">"undefined"</span>:f&#125;)&#125;,<span class="attr">tokenRegEx</span>:<span class="regexp">/\$\&#123;([\w.]+?)\&#125;/g</span>,<span class="attr">numberRegEx</span>:<span class="regexp">/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/</span>,<span class="attr">isNumeric</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> OpenLayers.String.numberRegEx.test(a)&#125;,<span class="attr">numericIf</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a;!<span class="number">0</span>===b&amp;&amp;(<span class="literal">null</span>!=a&amp;&amp;a.replace)&amp;&amp;(a=a.replace(<span class="regexp">/^\s*|\s*$/g</span>,<span class="string">""</span>));<span class="keyword">return</span> OpenLayers.String.isNumeric(a)?<span class="built_in">parseFloat</span>(a):c&#125;&#125;;</span><br><span class="line">OpenLayers.Number=&#123;<span class="attr">decimalSeparator</span>:<span class="string">"."</span>,<span class="attr">thousandsSeparator</span>:<span class="string">","</span>,<span class="attr">limitSigDigs</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="number">0</span>;<span class="number">0</span>&lt;b&amp;&amp;(c=<span class="built_in">parseFloat</span>(a.toPrecision(b)));<span class="keyword">return</span> c&#125;,<span class="attr">format</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;b=<span class="string">"undefined"</span>!=<span class="keyword">typeof</span> b?b:<span class="number">0</span>;c=<span class="string">"undefined"</span>!=<span class="keyword">typeof</span> c?c:OpenLayers.Number.thousandsSeparator;d=<span class="string">"undefined"</span>!=<span class="keyword">typeof</span> d?d:OpenLayers.Number.decimalSeparator;<span class="literal">null</span>!=b&amp;&amp;(a=<span class="built_in">parseFloat</span>(a.toFixed(b)));<span class="keyword">var</span> e=a.toString().split(<span class="string">"."</span>);<span class="number">1</span>==e.length&amp;&amp;<span class="literal">null</span>==b&amp;&amp;(b=<span class="number">0</span>);a=e[<span class="number">0</span>];<span class="keyword">if</span>(c)<span class="keyword">for</span>(<span class="keyword">var</span> f=<span class="regexp">/(-?[0-9]+)([0-9]&#123;3&#125;)/</span>;f.test(a);)a=a.replace(f,<span class="string">"$1"</span>+c+<span class="string">"$2"</span>);</span><br><span class="line"><span class="number">0</span>==b?b=a:(c=<span class="number">1</span>&lt;e.length?e[<span class="number">1</span>]:<span class="string">"0"</span>,<span class="literal">null</span>!=b&amp;&amp;(c+=<span class="built_in">Array</span>(b-c.length+<span class="number">1</span>).join(<span class="string">"0"</span>)),b=a+d+c);<span class="keyword">return</span> b&#125;,<span class="attr">zeroPad</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">for</span>(a=a.toString(c||<span class="number">10</span>);a.length&lt;b;)a=<span class="string">"0"</span>+a;<span class="keyword">return</span> a&#125;&#125;;</span><br><span class="line">OpenLayers.Function=&#123;<span class="attr">bind</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="built_in">Array</span>.prototype.slice.apply(<span class="built_in">arguments</span>,[<span class="number">2</span>]);<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> d=c.concat(<span class="built_in">Array</span>.prototype.slice.apply(<span class="built_in">arguments</span>,[<span class="number">0</span>]));<span class="keyword">return</span> a.apply(b,d)&#125;&#125;,<span class="attr">bindAsEventListener</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">c</span>)</span>&#123;<span class="keyword">return</span> a.call(b,c||<span class="built_in">window</span>.event)&#125;&#125;,<span class="attr">False</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">True</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">Void</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;&#125;;</span><br><span class="line">OpenLayers.Array=&#123;<span class="attr">filter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=[];<span class="keyword">if</span>(<span class="built_in">Array</span>.prototype.filter)d=a.filter(b,c);<span class="keyword">else</span>&#123;<span class="keyword">var</span> e=a.length;<span class="keyword">if</span>(<span class="string">"function"</span>!=<span class="keyword">typeof</span> b)<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>;<span class="keyword">for</span>(<span class="keyword">var</span> f=<span class="number">0</span>;f&lt;e;f++)<span class="keyword">if</span>(f <span class="keyword">in</span> a)&#123;<span class="keyword">var</span> g=a[f];b.call(c,g,f,a)&amp;&amp;d.push(g)&#125;&#125;<span class="keyword">return</span> d&#125;&#125;;OpenLayers.Bounds=OpenLayers.Class(&#123;<span class="attr">left</span>:<span class="literal">null</span>,<span class="attr">bottom</span>:<span class="literal">null</span>,<span class="attr">right</span>:<span class="literal">null</span>,<span class="attr">top</span>:<span class="literal">null</span>,<span class="attr">centerLonLat</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;OpenLayers.Util.isArray(a)&amp;&amp;(d=a[<span class="number">3</span>],c=a[<span class="number">2</span>],b=a[<span class="number">1</span>],a=a[<span class="number">0</span>]);<span class="literal">null</span>!=a&amp;&amp;(<span class="keyword">this</span>.left=OpenLayers.Util.toFloat(a));<span class="literal">null</span>!=b&amp;&amp;(<span class="keyword">this</span>.bottom=OpenLayers.Util.toFloat(b));<span class="literal">null</span>!=c&amp;&amp;(<span class="keyword">this</span>.right=OpenLayers.Util.toFloat(c));<span class="literal">null</span>!=d&amp;&amp;(<span class="keyword">this</span>.top=OpenLayers.Util.toFloat(d))&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Bounds(<span class="keyword">this</span>.left,<span class="keyword">this</span>.bottom,<span class="keyword">this</span>.right,<span class="keyword">this</span>.top)&#125;,<span class="attr">equals</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;<span class="literal">null</span>!=</span><br><span class="line">a&amp;&amp;(b=<span class="keyword">this</span>.left==a.left&amp;&amp;<span class="keyword">this</span>.right==a.right&amp;&amp;<span class="keyword">this</span>.top==a.top&amp;&amp;<span class="keyword">this</span>.bottom==a.bottom);<span class="keyword">return</span> b&#125;,<span class="attr">toString</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>[<span class="keyword">this</span>.left,<span class="keyword">this</span>.bottom,<span class="keyword">this</span>.right,<span class="keyword">this</span>.top].join()&#125;,<span class="attr">toArray</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span>!<span class="number">0</span>===a?[<span class="keyword">this</span>.bottom,<span class="keyword">this</span>.left,<span class="keyword">this</span>.top,<span class="keyword">this</span>.right]:[<span class="keyword">this</span>.left,<span class="keyword">this</span>.bottom,<span class="keyword">this</span>.right,<span class="keyword">this</span>.top]&#125;,<span class="attr">toBBOX</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="number">6</span>);<span class="keyword">var</span> c=<span class="built_in">Math</span>.pow(<span class="number">10</span>,a),d=<span class="built_in">Math</span>.round(<span class="keyword">this</span>.left*c)/c,e=<span class="built_in">Math</span>.round(<span class="keyword">this</span>.bottom*c)/c,f=<span class="built_in">Math</span>.round(<span class="keyword">this</span>.right*c)/c,c=<span class="built_in">Math</span>.round(<span class="keyword">this</span>.top*c)/c;<span class="keyword">return</span>!<span class="number">0</span>===b?e+<span class="string">","</span>+d+<span class="string">","</span>+c+<span class="string">","</span>+f:d+</span><br><span class="line"><span class="string">","</span>+e+<span class="string">","</span>+f+<span class="string">","</span>+c&#125;,<span class="attr">toGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.Polygon([<span class="keyword">new</span> OpenLayers.Geometry.LinearRing([<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="keyword">this</span>.left,<span class="keyword">this</span>.bottom),<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="keyword">this</span>.right,<span class="keyword">this</span>.bottom),<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="keyword">this</span>.right,<span class="keyword">this</span>.top),<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="keyword">this</span>.left,<span class="keyword">this</span>.top)])])&#125;,<span class="attr">getWidth</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.right-<span class="keyword">this</span>.left&#125;,<span class="attr">getHeight</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.top-<span class="keyword">this</span>.bottom&#125;,<span class="attr">getSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Size(<span class="keyword">this</span>.getWidth(),<span class="keyword">this</span>.getHeight())&#125;,</span><br><span class="line">getCenterPixel:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Pixel((<span class="keyword">this</span>.left+<span class="keyword">this</span>.right)/<span class="number">2</span>,(<span class="keyword">this</span>.bottom+<span class="keyword">this</span>.top)/<span class="number">2</span>)&#125;,<span class="attr">getCenterLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.centerLonLat||(<span class="keyword">this</span>.centerLonLat=<span class="keyword">new</span> OpenLayers.LonLat((<span class="keyword">this</span>.left+<span class="keyword">this</span>.right)/<span class="number">2</span>,(<span class="keyword">this</span>.bottom+<span class="keyword">this</span>.top)/<span class="number">2</span>));<span class="keyword">return</span> <span class="keyword">this</span>.centerLonLat&#125;,<span class="attr">scale</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="literal">null</span>==b&amp;&amp;(b=<span class="keyword">this</span>.getCenterLonLat());<span class="keyword">var</span> c,d;<span class="string">"OpenLayers.LonLat"</span>==b.CLASS_NAME?(c=b.lon,d=b.lat):(c=b.x,d=b.y);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Bounds((<span class="keyword">this</span>.left-c)*a+c,(<span class="keyword">this</span>.bottom-d)*a+d,(<span class="keyword">this</span>.right-c)*a+c,(<span class="keyword">this</span>.top-d)*a+</span><br><span class="line">d)&#125;,<span class="attr">add</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>==a||<span class="literal">null</span>==b)<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Bounds.add cannot receive null values"</span>);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Bounds(<span class="keyword">this</span>.left+a,<span class="keyword">this</span>.bottom+b,<span class="keyword">this</span>.right+a,<span class="keyword">this</span>.top+b)&#125;,<span class="attr">extend</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a)<span class="keyword">switch</span>(a.CLASS_NAME)&#123;<span class="keyword">case</span> <span class="string">"OpenLayers.LonLat"</span>:<span class="keyword">this</span>.extendXY(a.lon,a.lat);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Point"</span>:<span class="keyword">this</span>.extendXY(a.x,a.y);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Bounds"</span>:<span class="keyword">this</span>.centerLonLat=<span class="literal">null</span>;<span class="keyword">if</span>(<span class="literal">null</span>==<span class="keyword">this</span>.left||a.left&lt;<span class="keyword">this</span>.left)<span class="keyword">this</span>.left=a.left;<span class="keyword">if</span>(<span class="literal">null</span>==<span class="keyword">this</span>.bottom||a.bottom&lt;<span class="keyword">this</span>.bottom)<span class="keyword">this</span>.bottom=</span><br><span class="line">a.bottom;<span class="keyword">if</span>(<span class="literal">null</span>==<span class="keyword">this</span>.right||a.right&gt;<span class="keyword">this</span>.right)<span class="keyword">this</span>.right=a.right;<span class="keyword">if</span>(<span class="literal">null</span>==<span class="keyword">this</span>.top||a.top&gt;<span class="keyword">this</span>.top)<span class="keyword">this</span>.top=a.top&#125;&#125;,<span class="attr">extendXY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.centerLonLat=<span class="literal">null</span>;<span class="keyword">if</span>(<span class="literal">null</span>==<span class="keyword">this</span>.left||a&lt;<span class="keyword">this</span>.left)<span class="keyword">this</span>.left=a;<span class="keyword">if</span>(<span class="literal">null</span>==<span class="keyword">this</span>.bottom||b&lt;<span class="keyword">this</span>.bottom)<span class="keyword">this</span>.bottom=b;<span class="keyword">if</span>(<span class="literal">null</span>==<span class="keyword">this</span>.right||a&gt;<span class="keyword">this</span>.right)<span class="keyword">this</span>.right=a;<span class="keyword">if</span>(<span class="literal">null</span>==<span class="keyword">this</span>.top||b&gt;<span class="keyword">this</span>.top)<span class="keyword">this</span>.top=b&#125;,<span class="attr">containsLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="string">"boolean"</span>===<span class="keyword">typeof</span> b&amp;&amp;(b=&#123;<span class="attr">inclusive</span>:b&#125;);b=b||&#123;&#125;;<span class="keyword">var</span> c=<span class="keyword">this</span>.contains(a.lon,a.lat,b.inclusive),d=b.worldBounds;d&amp;&amp;!c&amp;&amp;(c=d.getWidth(),</span><br><span class="line">d=<span class="built_in">Math</span>.round((a.lon-(d.left+d.right)/<span class="number">2</span>)/c),c=<span class="keyword">this</span>.containsLonLat(&#123;<span class="attr">lon</span>:a.lon-d*c,<span class="attr">lat</span>:a.lat&#125;,&#123;<span class="attr">inclusive</span>:b.inclusive&#125;));<span class="keyword">return</span> c&#125;,<span class="attr">containsPixel</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.contains(a.x,a.y,b)&#125;,<span class="attr">contains</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="literal">null</span>==c&amp;&amp;(c=!<span class="number">0</span>);<span class="keyword">if</span>(<span class="literal">null</span>==a||<span class="literal">null</span>==b)<span class="keyword">return</span>!<span class="number">1</span>;a=OpenLayers.Util.toFloat(a);b=OpenLayers.Util.toFloat(b);<span class="keyword">var</span> d=!<span class="number">1</span>;<span class="keyword">return</span> d=c?a&gt;=<span class="keyword">this</span>.left&amp;&amp;a&lt;=<span class="keyword">this</span>.right&amp;&amp;b&gt;=<span class="keyword">this</span>.bottom&amp;&amp;b&lt;=<span class="keyword">this</span>.top:a&gt;<span class="keyword">this</span>.left&amp;&amp;a&lt;<span class="keyword">this</span>.right&amp;&amp;b&gt;<span class="keyword">this</span>.bottom&amp;&amp;b&lt;<span class="keyword">this</span>.top&#125;,<span class="attr">intersectsBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="string">"boolean"</span>===<span class="keyword">typeof</span> b&amp;&amp;(b=</span><br><span class="line">&#123;<span class="attr">inclusive</span>:b&#125;);b=b||&#123;&#125;;<span class="keyword">if</span>(b.worldBounds)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.wrapDateLine(b.worldBounds);a=a.wrapDateLine(b.worldBounds)&#125;<span class="keyword">else</span> c=<span class="keyword">this</span>;<span class="literal">null</span>==b.inclusive&amp;&amp;(b.inclusive=!<span class="number">0</span>);<span class="keyword">var</span> d=!<span class="number">1</span>,e=c.left==a.right||c.right==a.left||c.top==a.bottom||c.bottom==a.top;<span class="keyword">if</span>(b.inclusive||!e)<span class="keyword">var</span> d=a.top&gt;=c.bottom&amp;&amp;a.top&lt;=c.top||c.top&gt;a.bottom&amp;&amp;c.top&lt;a.top,e=a.left&gt;=c.left&amp;&amp;a.left&lt;=c.right||c.left&gt;=a.left&amp;&amp;c.left&lt;=a.right,f=a.right&gt;=c.left&amp;&amp;a.right&lt;=c.right||c.right&gt;=a.left&amp;&amp;c.right&lt;=a.right,d=(a.bottom&gt;=c.bottom&amp;&amp;a.bottom&lt;=c.top||c.bottom&gt;=</span><br><span class="line">a.bottom&amp;&amp;c.bottom&lt;=a.top||d)&amp;&amp;(e||f);<span class="keyword">if</span>(b.worldBounds&amp;&amp;!d)&#123;<span class="keyword">var</span> g=b.worldBounds,e=g.getWidth(),f=!g.containsBounds(c),g=!g.containsBounds(a);f&amp;&amp;!g?(a=a.add(-e,<span class="number">0</span>),d=c.intersectsBounds(a,&#123;<span class="attr">inclusive</span>:b.inclusive&#125;)):g&amp;&amp;!f&amp;&amp;(c=c.add(-e,<span class="number">0</span>),d=a.intersectsBounds(c,&#123;<span class="attr">inclusive</span>:b.inclusive&#125;))&#125;<span class="keyword">return</span> d&#125;,<span class="attr">containsBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="literal">null</span>==b&amp;&amp;(b=!<span class="number">1</span>);<span class="literal">null</span>==c&amp;&amp;(c=!<span class="number">0</span>);<span class="keyword">var</span> d=<span class="keyword">this</span>.contains(a.left,a.bottom,c),e=<span class="keyword">this</span>.contains(a.right,a.bottom,c),f=<span class="keyword">this</span>.contains(a.left,a.top,c);a=<span class="keyword">this</span>.contains(a.right,a.top,c);<span class="keyword">return</span> b?</span><br><span class="line">d||e||f||a:d&amp;&amp;e&amp;&amp;f&amp;&amp;a&#125;,<span class="attr">determineQuadrant</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="string">""</span>,c=<span class="keyword">this</span>.getCenterLonLat(),b=b+(a.lat&lt;c.lat?<span class="string">"b"</span>:<span class="string">"t"</span>);<span class="keyword">return</span> b+=a.lon&lt;c.lon?<span class="string">"l"</span>:<span class="string">"r"</span>&#125;,<span class="attr">transform</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.centerLonLat=<span class="literal">null</span>;<span class="keyword">var</span> c=OpenLayers.Projection.transform(&#123;<span class="attr">x</span>:<span class="keyword">this</span>.left,<span class="attr">y</span>:<span class="keyword">this</span>.bottom&#125;,a,b),d=OpenLayers.Projection.transform(&#123;<span class="attr">x</span>:<span class="keyword">this</span>.right,<span class="attr">y</span>:<span class="keyword">this</span>.bottom&#125;,a,b),e=OpenLayers.Projection.transform(&#123;<span class="attr">x</span>:<span class="keyword">this</span>.left,<span class="attr">y</span>:<span class="keyword">this</span>.top&#125;,a,b),f=OpenLayers.Projection.transform(&#123;<span class="attr">x</span>:<span class="keyword">this</span>.right,<span class="attr">y</span>:<span class="keyword">this</span>.top&#125;,a,b);<span class="keyword">this</span>.left=<span class="built_in">Math</span>.min(c.x,e.x);<span class="keyword">this</span>.bottom=<span class="built_in">Math</span>.min(c.y,</span><br><span class="line">d.y);<span class="keyword">this</span>.right=<span class="built_in">Math</span>.max(d.x,f.x);<span class="keyword">this</span>.top=<span class="built_in">Math</span>.max(e.y,f.y);<span class="keyword">return</span> <span class="keyword">this</span>&#125;,<span class="attr">wrapDateLine</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=b||&#123;&#125;;<span class="keyword">var</span> c=b.leftTolerance||<span class="number">0</span>,d=b.rightTolerance||<span class="number">0</span>,e=<span class="keyword">this</span>.clone();<span class="keyword">if</span>(a)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> f=a.getWidth();e.left&lt;a.left&amp;&amp;e.right-d&lt;=a.left;)e=e.add(f,<span class="number">0</span>);<span class="keyword">for</span>(;e.left+c&gt;=a.right&amp;&amp;e.right&gt;a.right;)e=e.add(-f,<span class="number">0</span>);c=e.left+c;c&lt;a.right&amp;&amp;(c&gt;a.left&amp;&amp;e.right-d&gt;a.right)&amp;&amp;(e=e.add(-f,<span class="number">0</span>))&#125;<span class="keyword">return</span> e&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Bounds"</span>&#125;);</span><br><span class="line">OpenLayers.Bounds.fromString=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.split(<span class="string">","</span>);<span class="keyword">return</span> OpenLayers.Bounds.fromArray(c,b)&#125;;OpenLayers.Bounds.fromArray=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span>!<span class="number">0</span>===b?<span class="keyword">new</span> OpenLayers.Bounds(a[<span class="number">1</span>],a[<span class="number">0</span>],a[<span class="number">3</span>],a[<span class="number">2</span>]):<span class="keyword">new</span> OpenLayers.Bounds(a[<span class="number">0</span>],a[<span class="number">1</span>],a[<span class="number">2</span>],a[<span class="number">3</span>])&#125;;OpenLayers.Bounds.fromSize=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Bounds(<span class="number">0</span>,a.h,a.w,<span class="number">0</span>)&#125;;OpenLayers.Bounds.oppositeQuadrant=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;b=<span class="string">""</span>+(<span class="string">"t"</span>==a.charAt(<span class="number">0</span>)?<span class="string">"b"</span>:<span class="string">"t"</span>);<span class="keyword">return</span> b+=<span class="string">"l"</span>==a.charAt(<span class="number">1</span>)?<span class="string">"r"</span>:<span class="string">"l"</span>&#125;;OpenLayers.Element=&#123;<span class="attr">visible</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span><span class="string">"none"</span>!=OpenLayers.Util.getElement(a).style.display&#125;,<span class="attr">toggle</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="built_in">arguments</span>.length;a&lt;b;a++)&#123;<span class="keyword">var</span> c=OpenLayers.Util.getElement(<span class="built_in">arguments</span>[a]),d=OpenLayers.Element.visible(c)?<span class="string">"none"</span>:<span class="string">""</span>;c.style.display=d&#125;&#125;,<span class="attr">remove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.getElement(a);a.parentNode.removeChild(a)&#125;,<span class="attr">getHeight</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.getElement(a);<span class="keyword">return</span> a.offsetHeight&#125;,<span class="attr">hasClass</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.className;<span class="keyword">return</span>!!c&amp;&amp;<span class="built_in">RegExp</span>(<span class="string">"(^|\\s)"</span>+b+<span class="string">"(\\s|$)"</span>).test(c)&#125;,</span><br><span class="line">addClass:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Element.hasClass(a,b)||(a.className+=(a.className?<span class="string">" "</span>:<span class="string">""</span>)+b);<span class="keyword">return</span> a&#125;,<span class="attr">removeClass</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.className;c&amp;&amp;(a.className=OpenLayers.String.trim(c.replace(<span class="built_in">RegExp</span>(<span class="string">"(^|\\s+)"</span>+b+<span class="string">"(\\s+|$)"</span>),<span class="string">" "</span>)));<span class="keyword">return</span> a&#125;,<span class="attr">toggleClass</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Element.hasClass(a,b)?OpenLayers.Element.removeClass(a,b):OpenLayers.Element.addClass(a,b);<span class="keyword">return</span> a&#125;,<span class="attr">getStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a=OpenLayers.Util.getElement(a);<span class="keyword">var</span> c=<span class="literal">null</span>;<span class="keyword">if</span>(a&amp;&amp;a.style)&#123;c=a.style[OpenLayers.String.camelize(b)];</span><br><span class="line">c||(<span class="built_in">document</span>.defaultView&amp;&amp;<span class="built_in">document</span>.defaultView.getComputedStyle?c=(c=<span class="built_in">document</span>.defaultView.getComputedStyle(a,<span class="literal">null</span>))?c.getPropertyValue(b):<span class="literal">null</span>:a.currentStyle&amp;&amp;(c=a.currentStyle[OpenLayers.String.camelize(b)]));<span class="keyword">var</span> d=[<span class="string">"left"</span>,<span class="string">"top"</span>,<span class="string">"right"</span>,<span class="string">"bottom"</span>];<span class="built_in">window</span>.opera&amp;&amp;(<span class="number">-1</span>!=OpenLayers.Util.indexOf(d,b)&amp;&amp;<span class="string">"static"</span>==OpenLayers.Element.getStyle(a,<span class="string">"position"</span>))&amp;&amp;(c=<span class="string">"auto"</span>)&#125;<span class="keyword">return</span><span class="string">"auto"</span>==c?<span class="literal">null</span>:c&#125;&#125;;OpenLayers.LonLat=OpenLayers.Class(&#123;<span class="attr">lon</span>:<span class="number">0</span>,<span class="attr">lat</span>:<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Util.isArray(a)&amp;&amp;(b=a[<span class="number">1</span>],a=a[<span class="number">0</span>]);<span class="keyword">this</span>.lon=OpenLayers.Util.toFloat(a);<span class="keyword">this</span>.lat=OpenLayers.Util.toFloat(b)&#125;,<span class="attr">toString</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">"lon="</span>+<span class="keyword">this</span>.lon+<span class="string">",lat="</span>+<span class="keyword">this</span>.lat&#125;,<span class="attr">toShortString</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.lon+<span class="string">", "</span>+<span class="keyword">this</span>.lat&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.LonLat(<span class="keyword">this</span>.lon,<span class="keyword">this</span>.lat)&#125;,<span class="attr">add</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>==a||<span class="literal">null</span>==b)<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"LonLat.add cannot receive null values"</span>);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.LonLat(<span class="keyword">this</span>.lon+</span><br><span class="line">OpenLayers.Util.toFloat(a),<span class="keyword">this</span>.lat+OpenLayers.Util.toFloat(b))&#125;,<span class="attr">equals</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;<span class="literal">null</span>!=a&amp;&amp;(b=<span class="keyword">this</span>.lon==a.lon&amp;&amp;<span class="keyword">this</span>.lat==a.lat||<span class="built_in">isNaN</span>(<span class="keyword">this</span>.lon)&amp;&amp;<span class="built_in">isNaN</span>(<span class="keyword">this</span>.lat)&amp;&amp;<span class="built_in">isNaN</span>(a.lon)&amp;&amp;<span class="built_in">isNaN</span>(a.lat));<span class="keyword">return</span> b&#125;,<span class="attr">transform</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Projection.transform(&#123;<span class="attr">x</span>:<span class="keyword">this</span>.lon,<span class="attr">y</span>:<span class="keyword">this</span>.lat&#125;,a,b);<span class="keyword">this</span>.lon=c.x;<span class="keyword">this</span>.lat=c.y;<span class="keyword">return</span> <span class="keyword">this</span>&#125;,<span class="attr">wrapDateLine</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.clone();<span class="keyword">if</span>(a)&#123;<span class="keyword">for</span>(;b.lon&lt;a.left;)b.lon+=a.getWidth();<span class="keyword">for</span>(;b.lon&gt;a.right;)b.lon-=a.getWidth()&#125;<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.LonLat"</span>&#125;);</span><br><span class="line">OpenLayers.LonLat.fromString=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.split(<span class="string">","</span>);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.LonLat(a[<span class="number">0</span>],a[<span class="number">1</span>])&#125;;OpenLayers.LonLat.fromArray=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Util.isArray(a);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.LonLat(b&amp;&amp;a[<span class="number">0</span>],b&amp;&amp;a[<span class="number">1</span>])&#125;;OpenLayers.Pixel=OpenLayers.Class(&#123;<span class="attr">x</span>:<span class="number">0</span>,<span class="attr">y</span>:<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.x=<span class="built_in">parseFloat</span>(a);<span class="keyword">this</span>.y=<span class="built_in">parseFloat</span>(b)&#125;,<span class="attr">toString</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">"x="</span>+<span class="keyword">this</span>.x+<span class="string">",y="</span>+<span class="keyword">this</span>.y&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Pixel(<span class="keyword">this</span>.x,<span class="keyword">this</span>.y)&#125;,<span class="attr">equals</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;<span class="literal">null</span>!=a&amp;&amp;(b=<span class="keyword">this</span>.x==a.x&amp;&amp;<span class="keyword">this</span>.y==a.y||<span class="built_in">isNaN</span>(<span class="keyword">this</span>.x)&amp;&amp;<span class="built_in">isNaN</span>(<span class="keyword">this</span>.y)&amp;&amp;<span class="built_in">isNaN</span>(a.x)&amp;&amp;<span class="built_in">isNaN</span>(a.y));<span class="keyword">return</span> b&#125;,<span class="attr">distanceTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(<span class="keyword">this</span>.x-a.x,<span class="number">2</span>)+<span class="built_in">Math</span>.pow(<span class="keyword">this</span>.y-a.y,<span class="number">2</span>))&#125;,<span class="attr">add</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>==a||<span class="literal">null</span>==b)<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Pixel.add cannot receive null values"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Pixel(<span class="keyword">this</span>.x+a,<span class="keyword">this</span>.y+b)&#125;,<span class="attr">offset</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.clone();a&amp;&amp;(b=<span class="keyword">this</span>.add(a.x,a.y));<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Pixel"</span>&#125;);OpenLayers.Size=OpenLayers.Class(&#123;<span class="attr">w</span>:<span class="number">0</span>,<span class="attr">h</span>:<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.w=<span class="built_in">parseFloat</span>(a);<span class="keyword">this</span>.h=<span class="built_in">parseFloat</span>(b)&#125;,<span class="attr">toString</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">"w="</span>+<span class="keyword">this</span>.w+<span class="string">",h="</span>+<span class="keyword">this</span>.h&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Size(<span class="keyword">this</span>.w,<span class="keyword">this</span>.h)&#125;,<span class="attr">equals</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;<span class="literal">null</span>!=a&amp;&amp;(b=<span class="keyword">this</span>.w==a.w&amp;&amp;<span class="keyword">this</span>.h==a.h||<span class="built_in">isNaN</span>(<span class="keyword">this</span>.w)&amp;&amp;<span class="built_in">isNaN</span>(<span class="keyword">this</span>.h)&amp;&amp;<span class="built_in">isNaN</span>(a.w)&amp;&amp;<span class="built_in">isNaN</span>(a.h));<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Size"</span>&#125;);OpenLayers.Console=&#123;<span class="attr">log</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">debug</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">info</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">warn</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">error</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">userError</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;alert(a)&#125;,<span class="attr">assert</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">dir</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">dirxml</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">trace</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">group</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">groupEnd</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">time</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">timeEnd</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">profile</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">profileEnd</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">count</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Console"</span>&#125;;</span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="built_in">document</span>.getElementsByTagName(<span class="string">"script"</span>),b=<span class="number">0</span>,c=a.length;b&lt;c;++b)<span class="keyword">if</span>(<span class="number">-1</span>!=a[b].src.indexOf(<span class="string">"firebug.js"</span>)&amp;&amp;<span class="built_in">console</span>)&#123;OpenLayers.Util.extend(OpenLayers.Console,<span class="built_in">console</span>);<span class="keyword">break</span>&#125;&#125;)();OpenLayers.Lang=&#123;<span class="attr">code</span>:<span class="literal">null</span>,<span class="attr">defaultCode</span>:<span class="string">"en"</span>,<span class="attr">getCode</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Lang.code||OpenLayers.Lang.setCode();<span class="keyword">return</span> OpenLayers.Lang.code&#125;,<span class="attr">setCode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;a||(a=<span class="string">"msie"</span>==OpenLayers.BROWSER_NAME?navigator.userLanguage:navigator.language);a=a.split(<span class="string">"-"</span>);a[<span class="number">0</span>]=a[<span class="number">0</span>].toLowerCase();<span class="string">"object"</span>==<span class="keyword">typeof</span> OpenLayers.Lang[a[<span class="number">0</span>]]&amp;&amp;(b=a[<span class="number">0</span>]);<span class="keyword">if</span>(a[<span class="number">1</span>])&#123;<span class="keyword">var</span> c=a[<span class="number">0</span>]+<span class="string">"-"</span>+a[<span class="number">1</span>].toUpperCase();<span class="string">"object"</span>==<span class="keyword">typeof</span> OpenLayers.Lang[c]&amp;&amp;(b=c)&#125;b||(OpenLayers.Console.warn(<span class="string">"Failed to find OpenLayers.Lang."</span>+a.join(<span class="string">"-"</span>)+<span class="string">" dictionary, falling back to default language"</span>),</span><br><span class="line">b=OpenLayers.Lang.defaultCode);OpenLayers.Lang.code=b&#125;,<span class="attr">translate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Lang[OpenLayers.Lang.getCode()];(c=c&amp;&amp;c[a])||(c=a);b&amp;&amp;(c=OpenLayers.String.format(c,b));<span class="keyword">return</span> c&#125;&#125;;OpenLayers.i18n=OpenLayers.Lang.translate;OpenLayers.Util=OpenLayers.Util||&#123;&#125;;OpenLayers.Util.getElement=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=[],b=<span class="number">0</span>,c=<span class="built_in">arguments</span>.length;b&lt;c;b++)&#123;<span class="keyword">var</span> d=<span class="built_in">arguments</span>[b];<span class="string">"string"</span>==<span class="keyword">typeof</span> d&amp;&amp;(d=<span class="built_in">document</span>.getElementById(d));<span class="keyword">if</span>(<span class="number">1</span>==<span class="built_in">arguments</span>.length)<span class="keyword">return</span> d;a.push(d)&#125;<span class="keyword">return</span> a&#125;;OpenLayers.Util.isElement=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span>!(!a||<span class="number">1</span>!==a.nodeType)&#125;;OpenLayers.Util.isArray=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span><span class="string">"[object Array]"</span>===<span class="built_in">Object</span>.prototype.toString.call(a)&#125;;OpenLayers.Util.removeItem=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=a.length<span class="number">-1</span>;<span class="number">0</span>&lt;=c;c--)a[c]==b&amp;&amp;a.splice(c,<span class="number">1</span>);<span class="keyword">return</span> a&#125;;</span><br><span class="line">OpenLayers.Util.indexOf=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(<span class="string">"function"</span>==<span class="keyword">typeof</span> a.indexOf)<span class="keyword">return</span> a.indexOf(b);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;c++)<span class="keyword">if</span>(a[c]==b)<span class="keyword">return</span> c;<span class="keyword">return</span><span class="number">-1</span>&#125;;OpenLayers.Util.dotless=<span class="regexp">/\./g</span>;</span><br><span class="line">OpenLayers.Util.modifyDOMElement=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e,f,g,h</span>)</span>&#123;b&amp;&amp;(a.id=b.replace(OpenLayers.Util.dotless,<span class="string">"_"</span>));c&amp;&amp;(a.style.left=c.x+<span class="string">"px"</span>,a.style.top=c.y+<span class="string">"px"</span>);d&amp;&amp;(a.style.width=d.w+<span class="string">"px"</span>,a.style.height=d.h+<span class="string">"px"</span>);e&amp;&amp;(a.style.position=e);f&amp;&amp;(a.style.border=f);g&amp;&amp;(a.style.overflow=g);<span class="number">0</span>&lt;=<span class="built_in">parseFloat</span>(h)&amp;&amp;<span class="number">1</span>&gt;<span class="built_in">parseFloat</span>(h)?(a.style.filter=<span class="string">"alpha(opacity="</span>+<span class="number">100</span>*h+<span class="string">")"</span>,a.style.opacity=h):<span class="number">1</span>==<span class="built_in">parseFloat</span>(h)&amp;&amp;(a.style.filter=<span class="string">""</span>,a.style.opacity=<span class="string">""</span>)&#125;;</span><br><span class="line">OpenLayers.Util.createDiv=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e,f,g,h</span>)</span>&#123;<span class="keyword">var</span> k=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);d&amp;&amp;(k.style.backgroundImage=<span class="string">"url("</span>+d+<span class="string">")"</span>);a||(a=OpenLayers.Util.createUniqueID(<span class="string">"OpenLayersDiv"</span>));e||(e=<span class="string">"absolute"</span>);OpenLayers.Util.modifyDOMElement(k,a,b,c,e,f,g,h);<span class="keyword">return</span> k&#125;;</span><br><span class="line">OpenLayers.Util.createImage=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e,f,g,h</span>)</span>&#123;<span class="keyword">var</span> k=<span class="built_in">document</span>.createElement(<span class="string">"img"</span>);a||(a=OpenLayers.Util.createUniqueID(<span class="string">"OpenLayersDiv"</span>));e||(e=<span class="string">"relative"</span>);OpenLayers.Util.modifyDOMElement(k,a,b,c,e,f,<span class="literal">null</span>,g);h&amp;&amp;(k.style.display=<span class="string">"none"</span>,b=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;k.style.display=<span class="string">""</span>;OpenLayers.Event.stopObservingElement(k)&#125;,OpenLayers.Event.observe(k,<span class="string">"load"</span>,b),OpenLayers.Event.observe(k,<span class="string">"error"</span>,b));k.style.alt=a;k.galleryImg=<span class="string">"no"</span>;d&amp;&amp;(k.src=d);<span class="keyword">return</span> k&#125;;OpenLayers.IMAGE_RELOAD_ATTEMPTS=<span class="number">0</span>;</span><br><span class="line">OpenLayers.Util.alphaHackNeeded=<span class="literal">null</span>;OpenLayers.Util.alphaHack=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>==OpenLayers.Util.alphaHackNeeded)&#123;<span class="keyword">var</span> a=navigator.appVersion.split(<span class="string">"MSIE"</span>),a=<span class="built_in">parseFloat</span>(a[<span class="number">1</span>]),b=!<span class="number">1</span>;<span class="keyword">try</span>&#123;b=!!<span class="built_in">document</span>.body.filters&#125;<span class="keyword">catch</span>(c)&#123;&#125;OpenLayers.Util.alphaHackNeeded=b&amp;&amp;<span class="number">5.5</span>&lt;=a&amp;&amp;<span class="number">7</span>&gt;a&#125;<span class="keyword">return</span> OpenLayers.Util.alphaHackNeeded&#125;;</span><br><span class="line">OpenLayers.Util.modifyAlphaImageDiv=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e,f,g,h,k</span>)</span>&#123;OpenLayers.Util.modifyDOMElement(a,b,c,d,f,<span class="literal">null</span>,<span class="literal">null</span>,k);b=a.childNodes[<span class="number">0</span>];e&amp;&amp;(b.src=e);OpenLayers.Util.modifyDOMElement(b,a.id+<span class="string">"_innerImage"</span>,<span class="literal">null</span>,d,<span class="string">"relative"</span>,g);OpenLayers.Util.alphaHack()&amp;&amp;(<span class="string">"none"</span>!=a.style.display&amp;&amp;(a.style.display=<span class="string">"inline-block"</span>),<span class="literal">null</span>==h&amp;&amp;(h=<span class="string">"scale"</span>),a.style.filter=<span class="string">"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"</span>+b.src+<span class="string">"', sizingMethod='"</span>+h+<span class="string">"')"</span>,<span class="number">0</span>&lt;=<span class="built_in">parseFloat</span>(a.style.opacity)&amp;&amp;<span class="number">1</span>&gt;<span class="built_in">parseFloat</span>(a.style.opacity)&amp;&amp;</span><br><span class="line">(a.style.filter+=<span class="string">" alpha(opacity="</span>+<span class="number">100</span>*a.style.opacity+<span class="string">")"</span>),b.style.filter=<span class="string">"alpha(opacity=0)"</span>)&#125;;OpenLayers.Util.createAlphaImageDiv=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e,f,g,h,k</span>)</span>&#123;<span class="keyword">var</span> l=OpenLayers.Util.createDiv();k=OpenLayers.Util.createImage(<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,k);k.className=<span class="string">"olAlphaImg"</span>;l.appendChild(k);OpenLayers.Util.modifyAlphaImageDiv(l,a,b,c,d,e,f,g,h);<span class="keyword">return</span> l&#125;;OpenLayers.Util.upperCaseObject=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;&#125;,c;<span class="keyword">for</span>(c <span class="keyword">in</span> a)b[c.toUpperCase()]=a[c];<span class="keyword">return</span> b&#125;;</span><br><span class="line">OpenLayers.Util.applyDefaults=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a=a||&#123;&#125;;<span class="keyword">var</span> c=<span class="string">"function"</span>==<span class="keyword">typeof</span> <span class="built_in">window</span>.Event&amp;&amp;b <span class="keyword">instanceof</span> <span class="built_in">window</span>.Event,d;<span class="keyword">for</span>(d <span class="keyword">in</span> b)<span class="keyword">if</span>(<span class="keyword">void</span> <span class="number">0</span>===a[d]||!c&amp;&amp;b.hasOwnProperty&amp;&amp;b.hasOwnProperty(d)&amp;&amp;!a.hasOwnProperty(d))a[d]=b[d];!c&amp;&amp;(b&amp;&amp;b.hasOwnProperty&amp;&amp;b.hasOwnProperty(<span class="string">"toString"</span>)&amp;&amp;!a.hasOwnProperty(<span class="string">"toString"</span>))&amp;&amp;(a.toString=b.toString);<span class="keyword">return</span> a&#125;;</span><br><span class="line">OpenLayers.Util.getParameterString=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=[],c;<span class="keyword">for</span>(c <span class="keyword">in</span> a)&#123;<span class="keyword">var</span> d=a[c];<span class="keyword">if</span>(<span class="literal">null</span>!=d&amp;&amp;<span class="string">"function"</span>!=<span class="keyword">typeof</span> d)&#123;<span class="keyword">if</span>(<span class="string">"object"</span>==<span class="keyword">typeof</span> d&amp;&amp;d.constructor==<span class="built_in">Array</span>)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> e=[],f,g=<span class="number">0</span>,h=d.length;g&lt;h;g++)f=d[g],e.push(<span class="built_in">encodeURIComponent</span>(<span class="literal">null</span>===f||<span class="keyword">void</span> <span class="number">0</span>===f?<span class="string">""</span>:f));d=e.join(<span class="string">","</span>)&#125;<span class="keyword">else</span> d=<span class="built_in">encodeURIComponent</span>(d);b.push(<span class="built_in">encodeURIComponent</span>(c)+<span class="string">"="</span>+d)&#125;&#125;<span class="keyword">return</span> b.join(<span class="string">"&amp;"</span>)&#125;;OpenLayers.Util.urlAppend=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a;<span class="keyword">if</span>(b)<span class="keyword">var</span> d=(a+<span class="string">" "</span>).split(<span class="regexp">/[?&amp;]/</span>),c=c+(<span class="string">" "</span>===d.pop()?b:d.length?<span class="string">"&amp;"</span>+b:<span class="string">"?"</span>+b);<span class="keyword">return</span> c&#125;;</span><br><span class="line">OpenLayers.Util.getImagesLocation=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.ImgPath||OpenLayers._getScriptLocation()+<span class="string">"img/"</span>&#125;;OpenLayers.Util.getImageLocation=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Util.getImagesLocation()+a&#125;;OpenLayers.Util.Try=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="literal">null</span>,b=<span class="number">0</span>,c=<span class="built_in">arguments</span>.length;b&lt;c;b++)&#123;<span class="keyword">var</span> d=<span class="built_in">arguments</span>[b];<span class="keyword">try</span>&#123;a=d();<span class="keyword">break</span>&#125;<span class="keyword">catch</span>(e)&#123;&#125;&#125;<span class="keyword">return</span> a&#125;;</span><br><span class="line">OpenLayers.Util.getXmlNodeValue=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;OpenLayers.Util.Try(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;b=a.text;b||(b=a.textContent);b||(b=a.firstChild.nodeValue)&#125;,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;b=a.textContent&#125;);<span class="keyword">return</span> b&#125;;OpenLayers.Util.mouseLeft=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=a.relatedTarget?a.relatedTarget:a.toElement;c!=b&amp;&amp;<span class="literal">null</span>!=c;)c=c.parentNode;<span class="keyword">return</span> c!=b&#125;;OpenLayers.Util.DEFAULT_PRECISION=<span class="number">14</span>;OpenLayers.Util.toFloat=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="literal">null</span>==b&amp;&amp;(b=OpenLayers.Util.DEFAULT_PRECISION);<span class="string">"number"</span>!==<span class="keyword">typeof</span> a&amp;&amp;(a=<span class="built_in">parseFloat</span>(a));<span class="keyword">return</span> <span class="number">0</span>===b?a:<span class="built_in">parseFloat</span>(a.toPrecision(b))&#125;;</span><br><span class="line">OpenLayers.Util.rad=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a*<span class="built_in">Math</span>.PI/<span class="number">180</span>&#125;;OpenLayers.Util.deg=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="number">180</span>*a/<span class="built_in">Math</span>.PI&#125;;OpenLayers.Util.VincentyConstants=&#123;<span class="attr">a</span>:<span class="number">6378137</span>,<span class="attr">b</span>:<span class="number">6356752.3142</span>,<span class="attr">f</span>:<span class="number">1</span>/<span class="number">298.257223563</span>&#125;;</span><br><span class="line">OpenLayers.Util.distVincenty=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=OpenLayers.Util.VincentyConstants,d=c.a,e=c.b,c=c.f,f=OpenLayers.Util.rad(b.lon-a.lon),g=<span class="built_in">Math</span>.atan((<span class="number">1</span>-c)*<span class="built_in">Math</span>.tan(OpenLayers.Util.rad(a.lat))),h=<span class="built_in">Math</span>.atan((<span class="number">1</span>-c)*<span class="built_in">Math</span>.tan(OpenLayers.Util.rad(b.lat))),k=<span class="built_in">Math</span>.sin(g),g=<span class="built_in">Math</span>.cos(g),l=<span class="built_in">Math</span>.sin(h),h=<span class="built_in">Math</span>.cos(h),m=f,n=<span class="number">2</span>*<span class="built_in">Math</span>.PI,p=<span class="number">20</span>;<span class="number">1E-12</span>&lt;<span class="built_in">Math</span>.abs(m-n)&amp;&amp;<span class="number">0</span>&lt;--p;)&#123;<span class="keyword">var</span> q=<span class="built_in">Math</span>.sin(m),r=<span class="built_in">Math</span>.cos(m),s=<span class="built_in">Math</span>.sqrt(h*q*h*q+(g*l-k*h*r)*(g*l-k*h*r));<span class="keyword">if</span>(<span class="number">0</span>==s)<span class="keyword">return</span> <span class="number">0</span>;<span class="keyword">var</span> r=k*l+g*h*r,t=<span class="built_in">Math</span>.atan2(s,r),u=<span class="built_in">Math</span>.asin(g*h*</span><br><span class="line">q/s),v=<span class="built_in">Math</span>.cos(u)*<span class="built_in">Math</span>.cos(u),q=r<span class="number">-2</span>*k*l/v,w=c/<span class="number">16</span>*v*(<span class="number">4</span>+c*(<span class="number">4</span><span class="number">-3</span>*v)),n=m,m=f+(<span class="number">1</span>-w)*c*<span class="built_in">Math</span>.sin(u)*(t+w*s*(q+w*r*(<span class="number">-1</span>+<span class="number">2</span>*q*q)))&#125;<span class="keyword">if</span>(<span class="number">0</span>==p)<span class="keyword">return</span> <span class="literal">NaN</span>;d=v*(d*d-e*e)/(e*e);c=d/<span class="number">1024</span>*(<span class="number">256</span>+d*(<span class="number">-128</span>+d*(<span class="number">74</span><span class="number">-47</span>*d)));<span class="keyword">return</span>(e*(<span class="number">1</span>+d/<span class="number">16384</span>*(<span class="number">4096</span>+d*(<span class="number">-768</span>+d*(<span class="number">320</span><span class="number">-175</span>*d))))*(t-c*s*(q+c/<span class="number">4</span>*(r*(<span class="number">-1</span>+<span class="number">2</span>*q*q)-c/<span class="number">6</span>*q*(<span class="number">-3</span>+<span class="number">4</span>*s*s)*(<span class="number">-3</span>+<span class="number">4</span>*q*q))))).toFixed(<span class="number">3</span>)/<span class="number">1E3</span>&#125;;</span><br><span class="line">OpenLayers.Util.destinationVincenty=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=OpenLayers.Util,e=d.VincentyConstants,f=e.a,g=e.b,h=e.f,e=a.lon;a=a.lat;<span class="keyword">var</span> k=d.rad(b);b=<span class="built_in">Math</span>.sin(k);k=<span class="built_in">Math</span>.cos(k);a=(<span class="number">1</span>-h)*<span class="built_in">Math</span>.tan(d.rad(a));<span class="keyword">var</span> l=<span class="number">1</span>/<span class="built_in">Math</span>.sqrt(<span class="number">1</span>+a*a),m=a*l,n=<span class="built_in">Math</span>.atan2(a,k);a=l*b;<span class="keyword">for</span>(<span class="keyword">var</span> p=<span class="number">1</span>-a*a,f=p*(f*f-g*g)/(g*g),q=<span class="number">1</span>+f/<span class="number">16384</span>*(<span class="number">4096</span>+f*(<span class="number">-768</span>+f*(<span class="number">320</span><span class="number">-175</span>*f))),r=f/<span class="number">1024</span>*(<span class="number">256</span>+f*(<span class="number">-128</span>+f*(<span class="number">74</span><span class="number">-47</span>*f))),f=c/(g*q),s=<span class="number">2</span>*<span class="built_in">Math</span>.PI;<span class="number">1E-12</span>&lt;<span class="built_in">Math</span>.abs(f-s);)<span class="keyword">var</span> t=<span class="built_in">Math</span>.cos(<span class="number">2</span>*n+f),u=<span class="built_in">Math</span>.sin(f),v=<span class="built_in">Math</span>.cos(f),w=r*u*(t+r/<span class="number">4</span>*(v*(<span class="number">-1</span>+<span class="number">2</span>*t*t)-r/<span class="number">6</span>*t*(<span class="number">-3</span>+<span class="number">4</span>*</span><br><span class="line">u*u)*(<span class="number">-3</span>+<span class="number">4</span>*t*t))),s=f,f=c/(g*q)+w;c=m*u-l*v*k;g=<span class="built_in">Math</span>.atan2(m*v+l*u*k,(<span class="number">1</span>-h)*<span class="built_in">Math</span>.sqrt(a*a+c*c));b=<span class="built_in">Math</span>.atan2(u*b,l*v-m*u*k);k=h/<span class="number">16</span>*p*(<span class="number">4</span>+h*(<span class="number">4</span><span class="number">-3</span>*p));t=b-(<span class="number">1</span>-k)*h*a*(f+k*u*(t+k*v*(<span class="number">-1</span>+<span class="number">2</span>*t*t)));<span class="built_in">Math</span>.atan2(a,-c);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.LonLat(e+d.deg(t),d.deg(g))&#125;;</span><br><span class="line">OpenLayers.Util.getParameters=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=b||&#123;&#125;;a=<span class="literal">null</span>===a||<span class="keyword">void</span> <span class="number">0</span>===a?<span class="built_in">window</span>.location.href:a;<span class="keyword">var</span> c=<span class="string">""</span>;<span class="keyword">if</span>(OpenLayers.String.contains(a,<span class="string">"?"</span>))<span class="keyword">var</span> d=a.indexOf(<span class="string">"?"</span>)+<span class="number">1</span>,c=OpenLayers.String.contains(a,<span class="string">"#"</span>)?a.indexOf(<span class="string">"#"</span>):a.length,c=a.substring(d,c);<span class="keyword">for</span>(<span class="keyword">var</span> d=&#123;&#125;,c=c.split(<span class="regexp">/[&amp;;]/</span>),e=<span class="number">0</span>,f=c.length;e&lt;f;++e)&#123;<span class="keyword">var</span> g=c[e].split(<span class="string">"="</span>);<span class="keyword">if</span>(g[<span class="number">0</span>])&#123;<span class="keyword">var</span> h=g[<span class="number">0</span>];<span class="keyword">try</span>&#123;h=<span class="built_in">decodeURIComponent</span>(h)&#125;<span class="keyword">catch</span>(k)&#123;h=<span class="built_in">unescape</span>(h)&#125;g=(g[<span class="number">1</span>]||<span class="string">""</span>).replace(<span class="regexp">/\+/g</span>,<span class="string">" "</span>);<span class="keyword">try</span>&#123;g=<span class="built_in">decodeURIComponent</span>(g)&#125;<span class="keyword">catch</span>(l)&#123;g=<span class="built_in">unescape</span>(g)&#125;!<span class="number">1</span>!==b.splitArgs&amp;&amp;(g=g.split(<span class="string">","</span>));</span><br><span class="line"><span class="number">1</span>==g.length&amp;&amp;(g=g[<span class="number">0</span>]);d[h]=g&#125;&#125;<span class="keyword">return</span> d&#125;;OpenLayers.Util.lastSeqID=<span class="number">0</span>;OpenLayers.Util.createUniqueID=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="literal">null</span>==a?<span class="string">"id_"</span>:a.replace(OpenLayers.Util.dotless,<span class="string">"_"</span>);OpenLayers.Util.lastSeqID+=<span class="number">1</span>;<span class="keyword">return</span> a+OpenLayers.Util.lastSeqID&#125;;OpenLayers.INCHES_PER_UNIT=&#123;<span class="attr">inches</span>:<span class="number">1</span>,<span class="attr">ft</span>:<span class="number">12</span>,<span class="attr">mi</span>:<span class="number">63360</span>,<span class="attr">m</span>:<span class="number">39.37</span>,<span class="attr">km</span>:<span class="number">39370</span>,<span class="attr">dd</span>:<span class="number">4374754</span>,<span class="attr">yd</span>:<span class="number">36</span>&#125;;OpenLayers.INCHES_PER_UNIT[<span class="string">"in"</span>]=OpenLayers.INCHES_PER_UNIT.inches;OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT.nmi=<span class="number">1852</span>*OpenLayers.INCHES_PER_UNIT.m;</span><br><span class="line">OpenLayers.METERS_PER_INCH=<span class="number">0.0254000508001016</span>;</span><br><span class="line">OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,&#123;<span class="attr">Inch</span>:OpenLayers.INCHES_PER_UNIT.inches,<span class="attr">Meter</span>:<span class="number">1</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Foot</span>:<span class="number">0.3048006096012192</span>/OpenLayers.METERS_PER_INCH,<span class="attr">IFoot</span>:<span class="number">0.3048</span>/OpenLayers.METERS_PER_INCH,<span class="attr">ClarkeFoot</span>:<span class="number">0.3047972651151</span>/OpenLayers.METERS_PER_INCH,<span class="attr">SearsFoot</span>:<span class="number">0.30479947153867626</span>/OpenLayers.METERS_PER_INCH,<span class="attr">GoldCoastFoot</span>:<span class="number">0.3047997101815088</span>/OpenLayers.METERS_PER_INCH,<span class="attr">IInch</span>:<span class="number">0.0254</span>/OpenLayers.METERS_PER_INCH,<span class="attr">MicroInch</span>:<span class="number">2.54E-5</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Mil</span>:<span class="number">2.54E-8</span>/OpenLayers.METERS_PER_INCH,</span><br><span class="line">Centimeter:<span class="number">0.01</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Kilometer</span>:<span class="number">1E3</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Yard</span>:<span class="number">0.9144018288036576</span>/OpenLayers.METERS_PER_INCH,<span class="attr">SearsYard</span>:<span class="number">0.914398414616029</span>/OpenLayers.METERS_PER_INCH,<span class="attr">IndianYard</span>:<span class="number">0.9143985307444408</span>/OpenLayers.METERS_PER_INCH,<span class="attr">IndianYd37</span>:<span class="number">0.91439523</span>/OpenLayers.METERS_PER_INCH,<span class="attr">IndianYd62</span>:<span class="number">0.9143988</span>/OpenLayers.METERS_PER_INCH,<span class="attr">IndianYd75</span>:<span class="number">0.9143985</span>/OpenLayers.METERS_PER_INCH,<span class="attr">IndianFoot</span>:<span class="number">0.30479951</span>/OpenLayers.METERS_PER_INCH,<span class="attr">IndianFt37</span>:<span class="number">0.30479841</span>/OpenLayers.METERS_PER_INCH,<span class="attr">IndianFt62</span>:<span class="number">0.3047996</span>/</span><br><span class="line">OpenLayers.METERS_PER_INCH,<span class="attr">IndianFt75</span>:<span class="number">0.3047995</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Mile</span>:<span class="number">1609.3472186944373</span>/OpenLayers.METERS_PER_INCH,<span class="attr">IYard</span>:<span class="number">0.9144</span>/OpenLayers.METERS_PER_INCH,<span class="attr">IMile</span>:<span class="number">1609.344</span>/OpenLayers.METERS_PER_INCH,<span class="attr">NautM</span>:<span class="number">1852</span>/OpenLayers.METERS_PER_INCH,<span class="string">"Lat-66"</span>:<span class="number">110943.31648893273</span>/OpenLayers.METERS_PER_INCH,<span class="string">"Lat-83"</span>:<span class="number">110946.25736872235</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Decimeter</span>:<span class="number">0.1</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Millimeter</span>:<span class="number">0.001</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Dekameter</span>:<span class="number">10</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Decameter</span>:<span class="number">10</span>/OpenLayers.METERS_PER_INCH,</span><br><span class="line">Hectometer:<span class="number">100</span>/OpenLayers.METERS_PER_INCH,<span class="attr">GermanMeter</span>:<span class="number">1.0000135965</span>/OpenLayers.METERS_PER_INCH,<span class="attr">CaGrid</span>:<span class="number">0.999738</span>/OpenLayers.METERS_PER_INCH,<span class="attr">ClarkeChain</span>:<span class="number">20.1166194976</span>/OpenLayers.METERS_PER_INCH,<span class="attr">GunterChain</span>:<span class="number">20.11684023368047</span>/OpenLayers.METERS_PER_INCH,<span class="attr">BenoitChain</span>:<span class="number">20.116782494375872</span>/OpenLayers.METERS_PER_INCH,<span class="attr">SearsChain</span>:<span class="number">20.11676512155</span>/OpenLayers.METERS_PER_INCH,<span class="attr">ClarkeLink</span>:<span class="number">0.201166194976</span>/OpenLayers.METERS_PER_INCH,<span class="attr">GunterLink</span>:<span class="number">0.2011684023368047</span>/OpenLayers.METERS_PER_INCH,<span class="attr">BenoitLink</span>:<span class="number">0.20116782494375873</span>/OpenLayers.METERS_PER_INCH,</span><br><span class="line">SearsLink:<span class="number">0.2011676512155</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Rod</span>:<span class="number">5.02921005842012</span>/OpenLayers.METERS_PER_INCH,<span class="attr">IntnlChain</span>:<span class="number">20.1168</span>/OpenLayers.METERS_PER_INCH,<span class="attr">IntnlLink</span>:<span class="number">0.201168</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Perch</span>:<span class="number">5.02921005842012</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Pole</span>:<span class="number">5.02921005842012</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Furlong</span>:<span class="number">201.1684023368046</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Rood</span>:<span class="number">3.778266898</span>/OpenLayers.METERS_PER_INCH,<span class="attr">CapeFoot</span>:<span class="number">0.3047972615</span>/OpenLayers.METERS_PER_INCH,<span class="attr">Brealey</span>:<span class="number">375</span>/OpenLayers.METERS_PER_INCH,<span class="attr">ModAmFt</span>:<span class="number">0.304812252984506</span>/</span><br><span class="line">OpenLayers.METERS_PER_INCH,<span class="attr">Fathom</span>:<span class="number">1.8288</span>/OpenLayers.METERS_PER_INCH,<span class="string">"NautM-UK"</span>:<span class="number">1853.184</span>/OpenLayers.METERS_PER_INCH,<span class="string">"50kilometers"</span>:<span class="number">5E4</span>/OpenLayers.METERS_PER_INCH,<span class="string">"150kilometers"</span>:<span class="number">15E4</span>/OpenLayers.METERS_PER_INCH&#125;);</span><br><span class="line">OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,&#123;<span class="attr">mm</span>:OpenLayers.INCHES_PER_UNIT.Meter/<span class="number">1E3</span>,<span class="attr">cm</span>:OpenLayers.INCHES_PER_UNIT.Meter/<span class="number">100</span>,<span class="attr">dm</span>:<span class="number">100</span>*OpenLayers.INCHES_PER_UNIT.Meter,<span class="attr">km</span>:<span class="number">1E3</span>*OpenLayers.INCHES_PER_UNIT.Meter,<span class="attr">kmi</span>:OpenLayers.INCHES_PER_UNIT.nmi,<span class="attr">fath</span>:OpenLayers.INCHES_PER_UNIT.Fathom,<span class="attr">ch</span>:OpenLayers.INCHES_PER_UNIT.IntnlChain,<span class="attr">link</span>:OpenLayers.INCHES_PER_UNIT.IntnlLink,<span class="string">"us-in"</span>:OpenLayers.INCHES_PER_UNIT.inches,<span class="string">"us-ft"</span>:OpenLayers.INCHES_PER_UNIT.Foot,<span class="string">"us-yd"</span>:OpenLayers.INCHES_PER_UNIT.Yard,<span class="string">"us-ch"</span>:OpenLayers.INCHES_PER_UNIT.GunterChain,</span><br><span class="line"><span class="string">"us-mi"</span>:OpenLayers.INCHES_PER_UNIT.Mile,<span class="string">"ind-yd"</span>:OpenLayers.INCHES_PER_UNIT.IndianYd37,<span class="string">"ind-ft"</span>:OpenLayers.INCHES_PER_UNIT.IndianFt37,<span class="string">"ind-ch"</span>:<span class="number">20.11669506</span>/OpenLayers.METERS_PER_INCH&#125;);OpenLayers.DOTS_PER_INCH=<span class="number">72</span>;OpenLayers.Util.normalizeScale=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="number">1</span>&lt;a?<span class="number">1</span>/a:a&#125;;OpenLayers.Util.getResolutionFromScale=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c;a&amp;&amp;(<span class="literal">null</span>==b&amp;&amp;(b=<span class="string">"degrees"</span>),c=<span class="number">1</span>/(OpenLayers.Util.normalizeScale(a)*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH));<span class="keyword">return</span> c&#125;;</span><br><span class="line">OpenLayers.Util.getScaleFromResolution=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="literal">null</span>==b&amp;&amp;(b=<span class="string">"degrees"</span>);<span class="keyword">return</span> a*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH&#125;;</span><br><span class="line">OpenLayers.Util.pagePosition=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=[<span class="number">0</span>,<span class="number">0</span>],c=OpenLayers.Util.getViewportElement();<span class="keyword">if</span>(!a||a==<span class="built_in">window</span>||a==c)<span class="keyword">return</span> b;<span class="keyword">var</span> d=OpenLayers.IS_GECKO&amp;&amp;<span class="built_in">document</span>.getBoxObjectFor&amp;&amp;<span class="string">"absolute"</span>==OpenLayers.Element.getStyle(a,<span class="string">"position"</span>)&amp;&amp;(<span class="string">""</span>==a.style.top||<span class="string">""</span>==a.style.left),e=<span class="literal">null</span>;<span class="keyword">if</span>(a.getBoundingClientRect)a=a.getBoundingClientRect(),e=<span class="built_in">window</span>.pageYOffset||c.scrollTop,b[<span class="number">0</span>]=a.left+(<span class="built_in">window</span>.pageXOffset||c.scrollLeft),b[<span class="number">1</span>]=a.top+e;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">document</span>.getBoxObjectFor&amp;&amp;!d)a=<span class="built_in">document</span>.getBoxObjectFor(a),c=<span class="built_in">document</span>.getBoxObjectFor(c),</span><br><span class="line">b[<span class="number">0</span>]=a.screenX-c.screenX,b[<span class="number">1</span>]=a.screenY-c.screenY;<span class="keyword">else</span>&#123;b[<span class="number">0</span>]=a.offsetLeft;b[<span class="number">1</span>]=a.offsetTop;e=a.offsetParent;<span class="keyword">if</span>(e!=a)<span class="keyword">for</span>(;e;)b[<span class="number">0</span>]+=e.offsetLeft,b[<span class="number">1</span>]+=e.offsetTop,e=e.offsetParent;c=OpenLayers.BROWSER_NAME;<span class="keyword">if</span>(<span class="string">"opera"</span>==c||<span class="string">"safari"</span>==c&amp;&amp;<span class="string">"absolute"</span>==OpenLayers.Element.getStyle(a,<span class="string">"position"</span>))b[<span class="number">1</span>]-=<span class="built_in">document</span>.body.offsetTop;<span class="keyword">for</span>(e=a.offsetParent;e&amp;&amp;e!=<span class="built_in">document</span>.body;)&#123;b[<span class="number">0</span>]-=e.scrollLeft;<span class="keyword">if</span>(<span class="string">"opera"</span>!=c||<span class="string">"TR"</span>!=e.tagName)b[<span class="number">1</span>]-=e.scrollTop;e=e.offsetParent&#125;&#125;<span class="keyword">return</span> b&#125;;</span><br><span class="line">OpenLayers.Util.getViewportElement=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="built_in">arguments</span>.callee.viewportElement;<span class="keyword">void</span> <span class="number">0</span>==a&amp;&amp;(a=<span class="string">"msie"</span>==OpenLayers.BROWSER_NAME&amp;&amp;<span class="string">"CSS1Compat"</span>!=<span class="built_in">document</span>.compatMode?<span class="built_in">document</span>.body:<span class="built_in">document</span>.documentElement,<span class="built_in">arguments</span>.callee.viewportElement=a);<span class="keyword">return</span> a&#125;;</span><br><span class="line">OpenLayers.Util.isEquivalentUrl=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;c=c||&#123;&#125;;OpenLayers.Util.applyDefaults(c,&#123;<span class="attr">ignoreCase</span>:!<span class="number">0</span>,<span class="attr">ignorePort80</span>:!<span class="number">0</span>,<span class="attr">ignoreHash</span>:!<span class="number">0</span>,<span class="attr">splitArgs</span>:!<span class="number">1</span>&#125;);a=OpenLayers.Util.createUrlObject(a,c);b=OpenLayers.Util.createUrlObject(b,c);<span class="keyword">for</span>(<span class="keyword">var</span> d <span class="keyword">in</span> a)<span class="keyword">if</span>(<span class="string">"args"</span>!==d&amp;&amp;a[d]!=b[d])<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">for</span>(d <span class="keyword">in</span> a.args)&#123;<span class="keyword">if</span>(a.args[d]!=b.args[d])<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">delete</span> b.args[d]&#125;<span class="keyword">for</span>(d <span class="keyword">in</span> b.args)<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">return</span>!<span class="number">0</span>&#125;;</span><br><span class="line">OpenLayers.Util.createUrlObject=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=b||&#123;&#125;;<span class="keyword">if</span>(!<span class="regexp">/^\w+:\/\//</span>.test(a))&#123;<span class="keyword">var</span> c=<span class="built_in">window</span>.location,d=c.port?<span class="string">":"</span>+c.port:<span class="string">""</span>,d=c.protocol+<span class="string">"//"</span>+c.host.split(<span class="string">":"</span>).shift()+d;<span class="number">0</span>===a.indexOf(<span class="string">"/"</span>)?a=d+a:(c=c.pathname.split(<span class="string">"/"</span>),c.pop(),a=d+c.join(<span class="string">"/"</span>)+<span class="string">"/"</span>+a)&#125;b.ignoreCase&amp;&amp;(a=a.toLowerCase());c=<span class="built_in">document</span>.createElement(<span class="string">"a"</span>);c.href=a;d=&#123;&#125;;d.host=c.host.split(<span class="string">":"</span>).shift();d.protocol=c.protocol;d.port=b.ignorePort80?<span class="string">"80"</span>==c.port||<span class="string">"0"</span>==c.port?<span class="string">""</span>:c.port:<span class="string">""</span>==c.port||<span class="string">"0"</span>==c.port?<span class="string">"80"</span>:c.port;d.hash=b.ignoreHash||<span class="string">"#"</span>===</span><br><span class="line">c.hash?<span class="string">""</span>:c.hash;<span class="keyword">var</span> e=c.search;e||(e=a.indexOf(<span class="string">"?"</span>),e=<span class="number">-1</span>!=e?a.substr(e):<span class="string">""</span>);d.args=OpenLayers.Util.getParameters(e,&#123;<span class="attr">splitArgs</span>:b.splitArgs&#125;);d.pathname=<span class="string">"/"</span>==c.pathname.charAt(<span class="number">0</span>)?c.pathname:<span class="string">"/"</span>+c.pathname;<span class="keyword">return</span> d&#125;;OpenLayers.Util.removeTail=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>,b=a.indexOf(<span class="string">"?"</span>),c=a.indexOf(<span class="string">"#"</span>);<span class="keyword">return</span> b=<span class="number">-1</span>==b?<span class="number">-1</span>!=c?a.substr(<span class="number">0</span>,c):a:<span class="number">-1</span>!=c?a.substr(<span class="number">0</span>,<span class="built_in">Math</span>.min(b,c)):a.substr(<span class="number">0</span>,b)&#125;;OpenLayers.IS_GECKO=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=navigator.userAgent.toLowerCase();<span class="keyword">return</span><span class="number">-1</span>==a.indexOf(<span class="string">"webkit"</span>)&amp;&amp;<span class="number">-1</span>!=a.indexOf(<span class="string">"gecko"</span>)&#125;();</span><br><span class="line">OpenLayers.CANVAS_SUPPORTED=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="built_in">document</span>.createElement(<span class="string">"canvas"</span>);<span class="keyword">return</span>!(!a.getContext||!a.getContext(<span class="string">"2d"</span>))&#125;();OpenLayers.BROWSER_NAME=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="string">""</span>,b=navigator.userAgent.toLowerCase();<span class="number">-1</span>!=b.indexOf(<span class="string">"opera"</span>)?a=<span class="string">"opera"</span>:<span class="number">-1</span>!=b.indexOf(<span class="string">"msie"</span>)?a=<span class="string">"msie"</span>:<span class="number">-1</span>!=b.indexOf(<span class="string">"safari"</span>)?a=<span class="string">"safari"</span>:<span class="number">-1</span>!=b.indexOf(<span class="string">"mozilla"</span>)&amp;&amp;(a=<span class="number">-1</span>!=b.indexOf(<span class="string">"firefox"</span>)?<span class="string">"firefox"</span>:<span class="string">"mozilla"</span>);<span class="keyword">return</span> a&#125;();OpenLayers.Util.getBrowserName=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.BROWSER_NAME&#125;;</span><br><span class="line">OpenLayers.Util.getRenderedDimensions=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d,e,f=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);f.style.visibility=<span class="string">"hidden"</span>;<span class="keyword">for</span>(<span class="keyword">var</span> g=c&amp;&amp;c.containerElement?c.containerElement:<span class="built_in">document</span>.body,h=!<span class="number">1</span>,k=<span class="literal">null</span>,l=g;l&amp;&amp;<span class="string">"body"</span>!=l.tagName.toLowerCase();)&#123;<span class="keyword">var</span> m=OpenLayers.Element.getStyle(l,<span class="string">"position"</span>);<span class="keyword">if</span>(<span class="string">"absolute"</span>==m)&#123;h=!<span class="number">0</span>;<span class="keyword">break</span>&#125;<span class="keyword">else</span> <span class="keyword">if</span>(m&amp;&amp;<span class="string">"static"</span>!=m)<span class="keyword">break</span>;l=l.parentNode&#125;!h||<span class="number">0</span>!==g.clientHeight&amp;&amp;<span class="number">0</span>!==g.clientWidth||(k=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>),k.style.visibility=<span class="string">"hidden"</span>,k.style.position=<span class="string">"absolute"</span>,k.style.overflow=</span><br><span class="line"><span class="string">"visible"</span>,k.style.width=<span class="built_in">document</span>.body.clientWidth+<span class="string">"px"</span>,k.style.height=<span class="built_in">document</span>.body.clientHeight+<span class="string">"px"</span>,k.appendChild(f));f.style.position=<span class="string">"absolute"</span>;b&amp;&amp;(b.w?(d=b.w,f.style.width=d+<span class="string">"px"</span>):b.h&amp;&amp;(e=b.h,f.style.height=e+<span class="string">"px"</span>));c&amp;&amp;c.displayClass&amp;&amp;(f.className=c.displayClass);b=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);b.innerHTML=a;b.style.overflow=<span class="string">"visible"</span>;<span class="keyword">if</span>(b.childNodes)<span class="keyword">for</span>(a=<span class="number">0</span>,c=b.childNodes.length;a&lt;c;a++)b.childNodes[a].style&amp;&amp;(b.childNodes[a].style.overflow=<span class="string">"visible"</span>);f.appendChild(b);k?g.appendChild(k):g.appendChild(f);</span><br><span class="line">d||(d=<span class="built_in">parseInt</span>(b.scrollWidth),f.style.width=d+<span class="string">"px"</span>);e||(e=<span class="built_in">parseInt</span>(b.scrollHeight));f.removeChild(b);k?(k.removeChild(f),g.removeChild(k)):g.removeChild(f);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Size(d,e)&#125;;</span><br><span class="line">OpenLayers.Util.getScrollbarWidth=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Util._scrollbarWidth;<span class="keyword">if</span>(<span class="literal">null</span>==a)&#123;<span class="keyword">var</span> b=<span class="literal">null</span>,c=<span class="literal">null</span>,b=a=<span class="number">0</span>,b=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);b.style.position=<span class="string">"absolute"</span>;b.style.top=<span class="string">"-1000px"</span>;b.style.left=<span class="string">"-1000px"</span>;b.style.width=<span class="string">"100px"</span>;b.style.height=<span class="string">"50px"</span>;b.style.overflow=<span class="string">"hidden"</span>;c=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);c.style.width=<span class="string">"100%"</span>;c.style.height=<span class="string">"200px"</span>;b.appendChild(c);<span class="built_in">document</span>.body.appendChild(b);a=c.offsetWidth;b.style.overflow=<span class="string">"scroll"</span>;b=c.offsetWidth;<span class="built_in">document</span>.body.removeChild(<span class="built_in">document</span>.body.lastChild);</span><br><span class="line">OpenLayers.Util._scrollbarWidth=a-b;a=OpenLayers.Util._scrollbarWidth&#125;<span class="keyword">return</span> a&#125;;</span><br><span class="line">OpenLayers.Util.getFormattedLonLat=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;c||(c=<span class="string">"dms"</span>);a=(a+<span class="number">540</span>)%<span class="number">360</span><span class="number">-180</span>;<span class="keyword">var</span> d=<span class="built_in">Math</span>.abs(a),e=<span class="built_in">Math</span>.floor(d),f=d=(d-e)/(<span class="number">1</span>/<span class="number">60</span>),d=<span class="built_in">Math</span>.floor(d),f=<span class="built_in">Math</span>.round(<span class="number">10</span>*((f-d)/(<span class="number">1</span>/<span class="number">60</span>))),f=f/<span class="number">10</span>;<span class="number">60</span>&lt;=f&amp;&amp;(f-=<span class="number">60</span>,d+=<span class="number">1</span>,<span class="number">60</span>&lt;=d&amp;&amp;(d-=<span class="number">60</span>,e+=<span class="number">1</span>));<span class="number">10</span>&gt;e&amp;&amp;(e=<span class="string">"0"</span>+e);e+=<span class="string">"\u00b0"</span>;<span class="number">0</span>&lt;=c.indexOf(<span class="string">"dm"</span>)&amp;&amp;(<span class="number">10</span>&gt;d&amp;&amp;(d=<span class="string">"0"</span>+d),e+=d+<span class="string">"'"</span>,<span class="number">0</span>&lt;=c.indexOf(<span class="string">"dms"</span>)&amp;&amp;(<span class="number">10</span>&gt;f&amp;&amp;(f=<span class="string">"0"</span>+f),e+=f+<span class="string">'"'</span>));<span class="keyword">return</span> e=<span class="string">"lon"</span>==b?e+(<span class="number">0</span>&gt;a?OpenLayers.i18n(<span class="string">"W"</span>):OpenLayers.i18n(<span class="string">"E"</span>)):e+(<span class="number">0</span>&gt;a?OpenLayers.i18n(<span class="string">"S"</span>):OpenLayers.i18n(<span class="string">"N"</span>))&#125;;OpenLayers.Format=OpenLayers.Class(&#123;<span class="attr">options</span>:<span class="literal">null</span>,<span class="attr">externalProjection</span>:<span class="literal">null</span>,<span class="attr">internalProjection</span>:<span class="literal">null</span>,<span class="attr">data</span>:<span class="literal">null</span>,<span class="attr">keepData</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,a);<span class="keyword">this</span>.options=a&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"Read not implemented."</span>);&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"Write not implemented."</span>);&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format"</span>&#125;);OpenLayers.Format.CSWGetRecords=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.CSWGetRecords.DEFAULTS);<span class="keyword">var</span> b=OpenLayers.Format.CSWGetRecords[<span class="string">"v"</span>+a.version.replace(<span class="regexp">/\./g</span>,<span class="string">"_"</span>)];<span class="keyword">if</span>(!b)<span class="keyword">throw</span><span class="string">"Unsupported CSWGetRecords version: "</span>+a.version;<span class="keyword">return</span> <span class="keyword">new</span> b(a)&#125;;OpenLayers.Format.CSWGetRecords.DEFAULTS=&#123;<span class="attr">version</span>:<span class="string">"2.0.2"</span>&#125;;OpenLayers.Control=OpenLayers.Class(&#123;<span class="attr">id</span>:<span class="literal">null</span>,<span class="attr">map</span>:<span class="literal">null</span>,<span class="attr">div</span>:<span class="literal">null</span>,<span class="attr">type</span>:<span class="literal">null</span>,<span class="attr">allowSelection</span>:!<span class="number">1</span>,<span class="attr">displayClass</span>:<span class="string">""</span>,<span class="attr">title</span>:<span class="string">""</span>,<span class="attr">autoActivate</span>:!<span class="number">1</span>,<span class="attr">active</span>:<span class="literal">null</span>,<span class="attr">handlerOptions</span>:<span class="literal">null</span>,<span class="attr">handler</span>:<span class="literal">null</span>,<span class="attr">eventListeners</span>:<span class="literal">null</span>,<span class="attr">events</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.displayClass=<span class="keyword">this</span>.CLASS_NAME.replace(<span class="string">"OpenLayers."</span>,<span class="string">"ol"</span>).replace(<span class="regexp">/\./g</span>,<span class="string">""</span>);OpenLayers.Util.extend(<span class="keyword">this</span>,a);<span class="keyword">this</span>.events=<span class="keyword">new</span> OpenLayers.Events(<span class="keyword">this</span>);<span class="keyword">if</span>(<span class="keyword">this</span>.eventListeners <span class="keyword">instanceof</span> <span class="built_in">Object</span>)<span class="keyword">this</span>.events.on(<span class="keyword">this</span>.eventListeners);<span class="literal">null</span>==<span class="keyword">this</span>.id&amp;&amp;(<span class="keyword">this</span>.id=OpenLayers.Util.createUniqueID(<span class="keyword">this</span>.CLASS_NAME+</span><br><span class="line"><span class="string">"_"</span>))&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.events&amp;&amp;(<span class="keyword">this</span>.eventListeners&amp;&amp;<span class="keyword">this</span>.events.un(<span class="keyword">this</span>.eventListeners),<span class="keyword">this</span>.events.destroy(),<span class="keyword">this</span>.events=<span class="literal">null</span>);<span class="keyword">this</span>.eventListeners=<span class="literal">null</span>;<span class="keyword">this</span>.handler&amp;&amp;(<span class="keyword">this</span>.handler.destroy(),<span class="keyword">this</span>.handler=<span class="literal">null</span>);<span class="keyword">if</span>(<span class="keyword">this</span>.handlers)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a <span class="keyword">in</span> <span class="keyword">this</span>.handlers)<span class="keyword">this</span>.handlers.hasOwnProperty(a)&amp;&amp;<span class="string">"function"</span>==<span class="keyword">typeof</span> <span class="keyword">this</span>.handlers[a].destroy&amp;&amp;<span class="keyword">this</span>.handlers[a].destroy();<span class="keyword">this</span>.handlers=<span class="literal">null</span>&#125;<span class="keyword">this</span>.map&amp;&amp;(<span class="keyword">this</span>.map.removeControl(<span class="keyword">this</span>),<span class="keyword">this</span>.map=<span class="literal">null</span>);<span class="keyword">this</span>.div=<span class="literal">null</span>&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.map=a;<span class="keyword">this</span>.handler&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.handler.setMap(a)&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==<span class="keyword">this</span>.div&amp;&amp;(<span class="keyword">this</span>.div=OpenLayers.Util.createDiv(<span class="keyword">this</span>.id),<span class="keyword">this</span>.div.className=<span class="keyword">this</span>.displayClass,<span class="keyword">this</span>.allowSelection||(<span class="keyword">this</span>.div.className+=<span class="string">" olControlNoSelect"</span>,<span class="keyword">this</span>.div.setAttribute(<span class="string">"unselectable"</span>,<span class="string">"on"</span>,<span class="number">0</span>),<span class="keyword">this</span>.div.onselectstart=OpenLayers.Function.False),<span class="string">""</span>!=<span class="keyword">this</span>.title&amp;&amp;(<span class="keyword">this</span>.div.title=<span class="keyword">this</span>.title));<span class="literal">null</span>!=a&amp;&amp;(<span class="keyword">this</span>.position=a.clone());<span class="keyword">this</span>.moveTo(<span class="keyword">this</span>.position);<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>!=a&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.div&amp;&amp;(<span class="keyword">this</span>.div.style.left=a.x+<span class="string">"px"</span>,<span class="keyword">this</span>.div.style.top=</span><br><span class="line">a.y+<span class="string">"px"</span>)&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.active)<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">this</span>.handler&amp;&amp;<span class="keyword">this</span>.handler.activate();<span class="keyword">this</span>.active=!<span class="number">0</span>;<span class="keyword">this</span>.map&amp;&amp;OpenLayers.Element.addClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="keyword">this</span>.displayClass.replace(<span class="regexp">/ /g</span>,<span class="string">""</span>)+<span class="string">"Active"</span>);<span class="keyword">this</span>.events.triggerEvent(<span class="string">"activate"</span>);<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.active?(<span class="keyword">this</span>.handler&amp;&amp;<span class="keyword">this</span>.handler.deactivate(),<span class="keyword">this</span>.active=!<span class="number">1</span>,<span class="keyword">this</span>.map&amp;&amp;OpenLayers.Element.removeClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="keyword">this</span>.displayClass.replace(<span class="regexp">/ /g</span>,<span class="string">""</span>)+<span class="string">"Active"</span>),<span class="keyword">this</span>.events.triggerEvent(<span class="string">"deactivate"</span>),</span><br><span class="line">!<span class="number">0</span>):!<span class="number">1</span>&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control"</span>&#125;);OpenLayers.Control.TYPE_BUTTON=<span class="number">1</span>;OpenLayers.Control.TYPE_TOGGLE=<span class="number">2</span>;OpenLayers.Control.TYPE_TOOL=<span class="number">3</span>;OpenLayers.Event=&#123;<span class="attr">observers</span>:!<span class="number">1</span>,<span class="attr">KEY_SPACE</span>:<span class="number">32</span>,<span class="attr">KEY_BACKSPACE</span>:<span class="number">8</span>,<span class="attr">KEY_TAB</span>:<span class="number">9</span>,<span class="attr">KEY_RETURN</span>:<span class="number">13</span>,<span class="attr">KEY_ESC</span>:<span class="number">27</span>,<span class="attr">KEY_LEFT</span>:<span class="number">37</span>,<span class="attr">KEY_UP</span>:<span class="number">38</span>,<span class="attr">KEY_RIGHT</span>:<span class="number">39</span>,<span class="attr">KEY_DOWN</span>:<span class="number">40</span>,<span class="attr">KEY_DELETE</span>:<span class="number">46</span>,<span class="attr">element</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a.target||a.srcElement&#125;,<span class="attr">isSingleTouch</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a.touches&amp;&amp;<span class="number">1</span>==a.touches.length&#125;,<span class="attr">isMultiTouch</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a.touches&amp;&amp;<span class="number">1</span>&lt;a.touches.length&#125;,<span class="attr">isLeftClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a.which&amp;&amp;<span class="number">1</span>==a.which||a.button&amp;&amp;<span class="number">1</span>==a.button&#125;,<span class="attr">isRightClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a.which&amp;&amp;<span class="number">3</span>==a.which||a.button&amp;&amp;<span class="number">2</span>==a.button&#125;,<span class="attr">stop</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b||OpenLayers.Event.preventDefault(a);a.stopPropagation?a.stopPropagation():a.cancelBubble=!<span class="number">0</span>&#125;,<span class="attr">preventDefault</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.preventDefault?a.preventDefault():a.returnValue=!<span class="number">1</span>&#125;,<span class="attr">findElement</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=OpenLayers.Event.element(a);c.parentNode&amp;&amp;(!c.tagName||c.tagName.toUpperCase()!=b.toUpperCase());)c=c.parentNode;<span class="keyword">return</span> c&#125;,<span class="attr">observe</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;a=OpenLayers.Util.getElement(a);d=d||!<span class="number">1</span>;<span class="string">"keypress"</span>==b&amp;&amp;(navigator.appVersion.match(<span class="regexp">/Konqueror|Safari|KHTML/</span>)||a.attachEvent)&amp;&amp;(b=<span class="string">"keydown"</span>);</span><br><span class="line"><span class="keyword">this</span>.observers||(<span class="keyword">this</span>.observers=&#123;&#125;);<span class="keyword">if</span>(!a._eventCacheID)&#123;<span class="keyword">var</span> e=<span class="string">"eventCacheID_"</span>;a.id&amp;&amp;(e=a.id+<span class="string">"_"</span>+e);a._eventCacheID=OpenLayers.Util.createUniqueID(e)&#125;e=a._eventCacheID;<span class="keyword">this</span>.observers[e]||(<span class="keyword">this</span>.observers[e]=[]);<span class="keyword">this</span>.observers[e].push(&#123;<span class="attr">element</span>:a,<span class="attr">name</span>:b,<span class="attr">observer</span>:c,<span class="attr">useCapture</span>:d&#125;);a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&amp;&amp;a.attachEvent(<span class="string">"on"</span>+b,c)&#125;,<span class="attr">stopObservingElement</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.getElement(a)._eventCacheID;<span class="keyword">this</span>._removeElementObservers(OpenLayers.Event.observers[a])&#125;,</span><br><span class="line">_removeElementObservers:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a)<span class="keyword">for</span>(<span class="keyword">var</span> b=a.length<span class="number">-1</span>;<span class="number">0</span>&lt;=b;b--)&#123;<span class="keyword">var</span> c=a[b];OpenLayers.Event.stopObserving.apply(<span class="keyword">this</span>,[c.element,c.name,c.observer,c.useCapture])&#125;&#125;,<span class="attr">stopObserving</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;d=d||!<span class="number">1</span>;a=OpenLayers.Util.getElement(a);<span class="keyword">var</span> e=a._eventCacheID;<span class="string">"keypress"</span>==b&amp;&amp;(navigator.appVersion.match(<span class="regexp">/Konqueror|Safari|KHTML/</span>)||a.detachEvent)&amp;&amp;(b=<span class="string">"keydown"</span>);<span class="keyword">var</span> f=!<span class="number">1</span>,g=OpenLayers.Event.observers[e];<span class="keyword">if</span>(g)<span class="keyword">for</span>(<span class="keyword">var</span> h=<span class="number">0</span>;!f&amp;&amp;h&lt;g.length;)&#123;<span class="keyword">var</span> k=g[h];<span class="keyword">if</span>(k.name==b&amp;&amp;k.observer==c&amp;&amp;k.useCapture==d)&#123;g.splice(h,</span><br><span class="line"><span class="number">1</span>);<span class="number">0</span>==g.length&amp;&amp;<span class="keyword">delete</span> OpenLayers.Event.observers[e];f=!<span class="number">0</span>;<span class="keyword">break</span>&#125;h++&#125;f&amp;&amp;(a.removeEventListener?a.removeEventListener(b,c,d):a&amp;&amp;a.detachEvent&amp;&amp;a.detachEvent(<span class="string">"on"</span>+b,c));<span class="keyword">return</span> f&#125;,<span class="attr">unloadCache</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(OpenLayers.Event&amp;&amp;OpenLayers.Event.observers)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a <span class="keyword">in</span> OpenLayers.Event.observers)OpenLayers.Event._removeElementObservers.apply(<span class="keyword">this</span>,[OpenLayers.Event.observers[a]]);OpenLayers.Event.observers=!<span class="number">1</span>&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Event"</span>&#125;;</span><br><span class="line">OpenLayers.Event.observe(<span class="built_in">window</span>,<span class="string">"unload"</span>,OpenLayers.Event.unloadCache,!<span class="number">1</span>);</span><br><span class="line">OpenLayers.Events=OpenLayers.Class(&#123;<span class="attr">BROWSER_EVENTS</span>:<span class="string">"mouseover mouseout mousedown mouseup mousemove click dblclick rightclick dblrightclick resize focus blur touchstart touchmove touchend keydown"</span>.split(<span class="string">" "</span>),<span class="attr">listeners</span>:<span class="literal">null</span>,<span class="attr">object</span>:<span class="literal">null</span>,<span class="attr">element</span>:<span class="literal">null</span>,<span class="attr">eventHandler</span>:<span class="literal">null</span>,<span class="attr">fallThrough</span>:<span class="literal">null</span>,<span class="attr">includeXY</span>:!<span class="number">1</span>,<span class="attr">extensions</span>:<span class="literal">null</span>,<span class="attr">extensionCount</span>:<span class="literal">null</span>,<span class="attr">clearMouseListener</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,e);<span class="keyword">this</span>.object=a;<span class="keyword">this</span>.fallThrough=d;<span class="keyword">this</span>.listeners=&#123;&#125;;<span class="keyword">this</span>.extensions=&#123;&#125;;<span class="keyword">this</span>.extensionCount=</span><br><span class="line">&#123;&#125;;<span class="keyword">this</span>._msTouches=[];<span class="literal">null</span>!=b&amp;&amp;<span class="keyword">this</span>.attachToElement(b)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a <span class="keyword">in</span> <span class="keyword">this</span>.extensions)<span class="string">"boolean"</span>!==<span class="keyword">typeof</span> <span class="keyword">this</span>.extensions[a]&amp;&amp;<span class="keyword">this</span>.extensions[a].destroy();<span class="keyword">this</span>.extensions=<span class="literal">null</span>;<span class="keyword">this</span>.element&amp;&amp;(OpenLayers.Event.stopObservingElement(<span class="keyword">this</span>.element),<span class="keyword">this</span>.element.hasScrollEvent&amp;&amp;OpenLayers.Event.stopObserving(<span class="built_in">window</span>,<span class="string">"scroll"</span>,<span class="keyword">this</span>.clearMouseListener));<span class="keyword">this</span>.eventHandler=<span class="keyword">this</span>.fallThrough=<span class="keyword">this</span>.object=<span class="keyword">this</span>.listeners=<span class="keyword">this</span>.element=<span class="literal">null</span>&#125;,<span class="attr">addEventType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">attachToElement</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.element?</span><br><span class="line">OpenLayers.Event.stopObservingElement(<span class="keyword">this</span>.element):(<span class="keyword">this</span>.eventHandler=OpenLayers.Function.bindAsEventListener(<span class="keyword">this</span>.handleBrowserEvent,<span class="keyword">this</span>),<span class="keyword">this</span>.clearMouseListener=OpenLayers.Function.bind(<span class="keyword">this</span>.clearMouseCache,<span class="keyword">this</span>));<span class="keyword">this</span>.element=a;<span class="keyword">for</span>(<span class="keyword">var</span> b=!!<span class="built_in">window</span>.navigator.msMaxTouchPoints,c,d=<span class="number">0</span>,e=<span class="keyword">this</span>.BROWSER_EVENTS.length;d&lt;e;d++)c=<span class="keyword">this</span>.BROWSER_EVENTS[d],OpenLayers.Event.observe(a,c,<span class="keyword">this</span>.eventHandler),b&amp;&amp;<span class="number">0</span>===c.indexOf(<span class="string">"touch"</span>)&amp;&amp;<span class="keyword">this</span>.addMsTouchListener(a,c,<span class="keyword">this</span>.eventHandler);OpenLayers.Event.observe(a,<span class="string">"dragstart"</span>,</span><br><span class="line">OpenLayers.Event.stop)&#125;,<span class="attr">on</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b <span class="keyword">in</span> a)<span class="string">"scope"</span>!=b&amp;&amp;a.hasOwnProperty(b)&amp;&amp;<span class="keyword">this</span>.register(b,a.scope,a[b])&#125;,<span class="attr">register</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;a <span class="keyword">in</span> OpenLayers.Events&amp;&amp;!<span class="keyword">this</span>.extensions[a]&amp;&amp;(<span class="keyword">this</span>.extensions[a]=<span class="keyword">new</span> OpenLayers.Events[a](<span class="keyword">this</span>));<span class="keyword">if</span>(<span class="literal">null</span>!=c)&#123;<span class="literal">null</span>==b&amp;&amp;(b=<span class="keyword">this</span>.object);<span class="keyword">var</span> e=<span class="keyword">this</span>.listeners[a];e||(e=[],<span class="keyword">this</span>.listeners[a]=e,<span class="keyword">this</span>.extensionCount[a]=<span class="number">0</span>);b=&#123;<span class="attr">obj</span>:b,<span class="attr">func</span>:c&#125;;d?(e.splice(<span class="keyword">this</span>.extensionCount[a],<span class="number">0</span>,b),<span class="string">"object"</span>===<span class="keyword">typeof</span> d&amp;&amp;d.extension&amp;&amp;<span class="keyword">this</span>.extensionCount[a]++):e.push(b)&#125;&#125;,<span class="attr">registerPriority</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b,c</span>)</span>&#123;<span class="keyword">this</span>.register(a,b,c,!<span class="number">0</span>)&#125;,<span class="attr">un</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b <span class="keyword">in</span> a)<span class="string">"scope"</span>!=b&amp;&amp;a.hasOwnProperty(b)&amp;&amp;<span class="keyword">this</span>.unregister(b,a.scope,a[b])&#125;,<span class="attr">unregister</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="literal">null</span>==b&amp;&amp;(b=<span class="keyword">this</span>.object);a=<span class="keyword">this</span>.listeners[a];<span class="keyword">if</span>(<span class="literal">null</span>!=a)<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e=a.length;d&lt;e;d++)<span class="keyword">if</span>(a[d].obj==b&amp;&amp;a[d].func==c)&#123;a.splice(d,<span class="number">1</span>);<span class="keyword">break</span>&#125;&#125;,<span class="attr">remove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>!=<span class="keyword">this</span>.listeners[a]&amp;&amp;(<span class="keyword">this</span>.listeners[a]=[])&#125;,<span class="attr">triggerEvent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.listeners[a];<span class="keyword">if</span>(c&amp;&amp;<span class="number">0</span>!=c.length)&#123;<span class="literal">null</span>==b&amp;&amp;(b=&#123;&#125;);b.object=<span class="keyword">this</span>.object;b.element=<span class="keyword">this</span>.element;b.type||(b.type=</span><br><span class="line">a);<span class="keyword">for</span>(<span class="keyword">var</span> c=c.slice(),d,e=<span class="number">0</span>,f=c.length;e&lt;f&amp;&amp;(d=c[e],d=d.func.apply(d.obj,[b]),<span class="keyword">void</span> <span class="number">0</span>==d||!<span class="number">1</span>!=d);e++);<span class="keyword">this</span>.fallThrough||OpenLayers.Event.stop(b,!<span class="number">0</span>);<span class="keyword">return</span> d&#125;&#125;,<span class="attr">handleBrowserEvent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.type,c=<span class="keyword">this</span>.listeners[b];<span class="keyword">if</span>(c&amp;&amp;<span class="number">0</span>!=c.length)&#123;<span class="keyword">if</span>((c=a.touches)&amp;&amp;c[<span class="number">0</span>])&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e=<span class="number">0</span>,f=c.length,g,h=<span class="number">0</span>;h&lt;f;++h)g=<span class="keyword">this</span>.getTouchClientXY(c[h]),d+=g.clientX,e+=g.clientY;a.clientX=d/f;a.clientY=e/f&#125;<span class="keyword">this</span>.includeXY&amp;&amp;(a.xy=<span class="keyword">this</span>.getMousePosition(a));<span class="keyword">this</span>.triggerEvent(b,a)&#125;&#125;,<span class="attr">getTouchClientXY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="built_in">window</span>.olMockWin||</span><br><span class="line"><span class="built_in">window</span>,c=b.pageXOffset,b=b.pageYOffset,d=a.clientX,e=a.clientY;<span class="keyword">if</span>(<span class="number">0</span>===a.pageY&amp;&amp;<span class="built_in">Math</span>.floor(e)&gt;<span class="built_in">Math</span>.floor(a.pageY)||<span class="number">0</span>===a.pageX&amp;&amp;<span class="built_in">Math</span>.floor(d)&gt;<span class="built_in">Math</span>.floor(a.pageX))d-=c,e-=b;<span class="keyword">else</span> <span class="keyword">if</span>(e&lt;a.pageY-b||d&lt;a.pageX-c)d=a.pageX-c,e=a.pageY-b;a.olClientX=d;a.olClientY=e;<span class="keyword">return</span>&#123;<span class="attr">clientX</span>:d,<span class="attr">clientY</span>:e&#125;&#125;,<span class="attr">clearMouseCache</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.element.scrolls=<span class="literal">null</span>;<span class="keyword">this</span>.element.lefttop=<span class="literal">null</span>;<span class="keyword">this</span>.element.offsets=<span class="literal">null</span>&#125;,<span class="attr">getMousePosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.includeXY?<span class="keyword">this</span>.element.hasScrollEvent||(OpenLayers.Event.observe(<span class="built_in">window</span>,<span class="string">"scroll"</span>,</span><br><span class="line"><span class="keyword">this</span>.clearMouseListener),<span class="keyword">this</span>.element.hasScrollEvent=!<span class="number">0</span>):<span class="keyword">this</span>.clearMouseCache();<span class="keyword">if</span>(!<span class="keyword">this</span>.element.scrolls)&#123;<span class="keyword">var</span> b=OpenLayers.Util.getViewportElement();<span class="keyword">this</span>.element.scrolls=[<span class="built_in">window</span>.pageXOffset||b.scrollLeft,<span class="built_in">window</span>.pageYOffset||b.scrollTop]&#125;<span class="keyword">this</span>.element.lefttop||(<span class="keyword">this</span>.element.lefttop=[<span class="built_in">document</span>.documentElement.clientLeft||<span class="number">0</span>,<span class="built_in">document</span>.documentElement.clientTop||<span class="number">0</span>]);<span class="keyword">this</span>.element.offsets||(<span class="keyword">this</span>.element.offsets=OpenLayers.Util.pagePosition(<span class="keyword">this</span>.element));<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Pixel(a.clientX+<span class="keyword">this</span>.element.scrolls[<span class="number">0</span>]-</span><br><span class="line"><span class="keyword">this</span>.element.offsets[<span class="number">0</span>]-<span class="keyword">this</span>.element.lefttop[<span class="number">0</span>],a.clientY+<span class="keyword">this</span>.element.scrolls[<span class="number">1</span>]-<span class="keyword">this</span>.element.offsets[<span class="number">1</span>]-<span class="keyword">this</span>.element.lefttop[<span class="number">1</span>])&#125;,<span class="attr">addMsTouchListener</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params">a</span>)</span>&#123;c(OpenLayers.Util.applyDefaults(&#123;<span class="attr">stopPropagation</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=e.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;--a)e[a].stopPropagation()&#125;,<span class="attr">preventDefault</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=e.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;--a)e[a].preventDefault()&#125;,<span class="attr">type</span>:b&#125;,a))&#125;<span class="keyword">var</span> e=<span class="keyword">this</span>._msTouches;<span class="keyword">switch</span>(b)&#123;<span class="keyword">case</span> <span class="string">"touchstart"</span>:<span class="keyword">return</span> <span class="keyword">this</span>.addMsTouchListenerStart(a,b,d);<span class="keyword">case</span> <span class="string">"touchend"</span>:<span class="keyword">return</span> <span class="keyword">this</span>.addMsTouchListenerEnd(a,</span><br><span class="line">b,d);<span class="keyword">case</span> <span class="string">"touchmove"</span>:<span class="keyword">return</span> <span class="keyword">this</span>.addMsTouchListenerMove(a,b,d);<span class="keyword">default</span>:<span class="keyword">throw</span><span class="string">"Unknown touch event type"</span>;&#125;&#125;,<span class="attr">addMsTouchListenerStart</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>._msTouches;OpenLayers.Event.observe(a,<span class="string">"MSPointerDown"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=!<span class="number">1</span>,g=<span class="number">0</span>,h=d.length;g&lt;h;++g)<span class="keyword">if</span>(d[g].pointerId==a.pointerId)&#123;b=!<span class="number">0</span>;<span class="keyword">break</span>&#125;b||d.push(a);a.touches=d.slice();c(a)&#125;);OpenLayers.Event.observe(a,<span class="string">"MSPointerUp"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=d.length;b&lt;c;++b)<span class="keyword">if</span>(d[b].pointerId==a.pointerId)&#123;d.splice(b,<span class="number">1</span>);<span class="keyword">break</span>&#125;&#125;)&#125;,<span class="attr">addMsTouchListenerMove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b,c</span>)</span>&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>._msTouches;OpenLayers.Event.observe(a,<span class="string">"MSPointerMove"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a.pointerType!=a.MSPOINTER_TYPE_MOUSE||<span class="number">0</span>!=a.buttons)<span class="keyword">if</span>(<span class="number">1</span>!=d.length||d[<span class="number">0</span>].pageX!=a.pageX||d[<span class="number">0</span>].pageY!=a.pageY)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,g=d.length;b&lt;g;++b)<span class="keyword">if</span>(d[b].pointerId==a.pointerId)&#123;d[b]=a;<span class="keyword">break</span>&#125;a.touches=d.slice();c(a)&#125;&#125;)&#125;,<span class="attr">addMsTouchListenerEnd</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>._msTouches;OpenLayers.Event.observe(a,<span class="string">"MSPointerUp"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,g=d.length;b&lt;g;++b)<span class="keyword">if</span>(d[b].pointerId==a.pointerId)&#123;d.splice(b,<span class="number">1</span>);<span class="keyword">break</span>&#125;a.touches=</span><br><span class="line">d.slice();c(a)&#125;)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Events"</span>&#125;);OpenLayers.Events.buttonclick=OpenLayers.Class(&#123;<span class="attr">target</span>:<span class="literal">null</span>,<span class="attr">events</span>:<span class="string">"mousedown mouseup click dblclick touchstart touchmove touchend keydown"</span>.split(<span class="string">" "</span>),<span class="attr">startRegEx</span>:<span class="regexp">/^mousedown|touchstart$/</span>,<span class="attr">cancelRegEx</span>:<span class="regexp">/^touchmove$/</span>,<span class="attr">completeRegEx</span>:<span class="regexp">/^mouseup|touchend$/</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.target=a;<span class="keyword">for</span>(a=<span class="keyword">this</span>.events.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;--a)<span class="keyword">this</span>.target.register(<span class="keyword">this</span>.events[a],<span class="keyword">this</span>,<span class="keyword">this</span>.buttonClick,&#123;<span class="attr">extension</span>:!<span class="number">0</span>&#125;)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.events.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;--a)<span class="keyword">this</span>.target.unregister(<span class="keyword">this</span>.events[a],<span class="keyword">this</span>,<span class="keyword">this</span>.buttonClick);</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">this</span>.target&#125;,<span class="attr">getPressedButton</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="number">3</span>,c;<span class="keyword">do</span>&#123;<span class="keyword">if</span>(OpenLayers.Element.hasClass(a,<span class="string">"olButton"</span>))&#123;c=a;<span class="keyword">break</span>&#125;a=a.parentNode&#125;<span class="keyword">while</span>(<span class="number">0</span>&lt;--b&amp;&amp;a);<span class="keyword">return</span> c&#125;,<span class="attr">ignore</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="number">3</span>,c=!<span class="number">1</span>;<span class="keyword">do</span>&#123;<span class="keyword">if</span>(<span class="string">"a"</span>===a.nodeName.toLowerCase())&#123;c=!<span class="number">0</span>;<span class="keyword">break</span>&#125;a=a.parentNode&#125;<span class="keyword">while</span>(<span class="number">0</span>&lt;--b&amp;&amp;a);<span class="keyword">return</span> c&#125;,<span class="attr">buttonClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">0</span>,c=OpenLayers.Event.element(a);<span class="keyword">if</span>(c&amp;&amp;(OpenLayers.Event.isLeftClick(a)||!~a.type.indexOf(<span class="string">"mouse"</span>)))<span class="keyword">if</span>(c=<span class="keyword">this</span>.getPressedButton(c))&#123;<span class="keyword">if</span>(<span class="string">"keydown"</span>===a.type)<span class="keyword">switch</span>(a.keyCode)&#123;<span class="keyword">case</span> OpenLayers.Event.KEY_RETURN:<span class="keyword">case</span> OpenLayers.Event.KEY_SPACE:<span class="keyword">this</span>.target.triggerEvent(<span class="string">"buttonclick"</span>,</span><br><span class="line">&#123;<span class="attr">buttonElement</span>:c&#125;),OpenLayers.Event.stop(a),b=!<span class="number">1</span>&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.startEvt)&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.completeRegEx.test(a.type))&#123;<span class="keyword">var</span> b=OpenLayers.Util.pagePosition(c),d=OpenLayers.Util.getViewportElement(),e=<span class="built_in">window</span>.pageYOffset||d.scrollTop;b[<span class="number">0</span>]-=<span class="built_in">window</span>.pageXOffset||d.scrollLeft;b[<span class="number">1</span>]-=e;<span class="keyword">this</span>.target.triggerEvent(<span class="string">"buttonclick"</span>,&#123;<span class="attr">buttonElement</span>:c,<span class="attr">buttonXY</span>:&#123;<span class="attr">x</span>:<span class="keyword">this</span>.startEvt.clientX-b[<span class="number">0</span>],<span class="attr">y</span>:<span class="keyword">this</span>.startEvt.clientY-b[<span class="number">1</span>]&#125;&#125;)&#125;<span class="keyword">this</span>.cancelRegEx.test(a.type)&amp;&amp;<span class="keyword">delete</span> <span class="keyword">this</span>.startEvt;OpenLayers.Event.stop(a);b=!<span class="number">1</span>&#125;<span class="keyword">this</span>.startRegEx.test(a.type)&amp;&amp;</span><br><span class="line">(<span class="keyword">this</span>.startEvt=a,OpenLayers.Event.stop(a),b=!<span class="number">1</span>)&#125;<span class="keyword">else</span> b=!<span class="keyword">this</span>.ignore(OpenLayers.Event.element(a)),<span class="keyword">delete</span> <span class="keyword">this</span>.startEvt;<span class="keyword">return</span> b&#125;&#125;);OpenLayers.Util=OpenLayers.Util||&#123;&#125;;</span><br><span class="line">OpenLayers.Util.vendorPrefix=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a?a.replace(<span class="regexp">/([A-Z])/g</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span><span class="string">"-"</span>+a.toLowerCase()&#125;).replace(<span class="regexp">/^ms-/</span>,<span class="string">"-ms-"</span>):<span class="literal">null</span>&#125;<span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">void</span> <span class="number">0</span>===g[b])&#123;<span class="keyword">var</span> c,e=<span class="number">0</span>,f=d.length,p=<span class="string">"undefined"</span>!==<span class="keyword">typeof</span> a.cssText;<span class="keyword">for</span>(g[b]=<span class="literal">null</span>;e&lt;f;e++)<span class="keyword">if</span>((c=d[e])?(p||(c=c.toLowerCase()),c=c+b.charAt(<span class="number">0</span>).toUpperCase()+b.slice(<span class="number">1</span>)):c=b,<span class="keyword">void</span> <span class="number">0</span>!==a[c])&#123;g[b]=c;<span class="keyword">break</span>&#125;&#125;<span class="keyword">return</span> g[b]&#125;<span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> b(e,a)&#125;<span class="keyword">var</span> d=[<span class="string">""</span>,<span class="string">"O"</span>,<span class="string">"ms"</span>,<span class="string">"Moz"</span>,<span class="string">"Webkit"</span>],e=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>).style,f=&#123;&#125;,g=&#123;&#125;;<span class="keyword">return</span>&#123;<span class="attr">css</span>:<span class="function"><span class="keyword">function</span>(<span class="params">b</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">void</span> <span class="number">0</span>===</span><br><span class="line">f[b])&#123;<span class="keyword">var</span> d=b.replace(<span class="regexp">/(-[\s\S])/g</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a.charAt(<span class="number">1</span>).toUpperCase()&#125;),d=c(d);f[b]=a(d)&#125;<span class="keyword">return</span> f[b]&#125;,<span class="attr">js</span>:b,<span class="attr">style</span>:c,<span class="attr">cssCache</span>:f,<span class="attr">jsCache</span>:g&#125;&#125;();OpenLayers.Animation=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Util.vendorPrefix.js(a,<span class="string">"requestAnimationFrame"</span>),c=!!b,d=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> c=a[b]||<span class="function"><span class="keyword">function</span>(<span class="params">b,c</span>)</span>&#123;a.setTimeout(b,<span class="number">16</span>)&#125;;<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">b,d</span>)</span>&#123;c.apply(a,[b,d])&#125;&#125;(),e=<span class="number">0</span>,f=&#123;&#125;;<span class="keyword">return</span>&#123;<span class="attr">isNative</span>:c,<span class="attr">requestFrame</span>:d,<span class="attr">start</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;b=<span class="number">0</span>&lt;b?b:<span class="built_in">Number</span>.POSITIVE_INFINITY;<span class="keyword">var</span> l=++e,m=+<span class="keyword">new</span> <span class="built_in">Date</span>;f[l]=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;f[l]&amp;&amp;+<span class="keyword">new</span> <span class="built_in">Date</span>-m&lt;=b?(a(),f[l]&amp;&amp;d(f[l],c)):<span class="keyword">delete</span> f[l]&#125;;d(f[l],c);<span class="keyword">return</span> l&#125;,<span class="attr">stop</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">delete</span> f[a]&#125;&#125;&#125;(<span class="built_in">window</span>);OpenLayers.Tween=OpenLayers.Class(&#123;<span class="attr">easing</span>:<span class="literal">null</span>,<span class="attr">begin</span>:<span class="literal">null</span>,<span class="attr">finish</span>:<span class="literal">null</span>,<span class="attr">duration</span>:<span class="literal">null</span>,<span class="attr">callbacks</span>:<span class="literal">null</span>,<span class="attr">time</span>:<span class="literal">null</span>,<span class="attr">minFrameRate</span>:<span class="literal">null</span>,<span class="attr">startTime</span>:<span class="literal">null</span>,<span class="attr">animationId</span>:<span class="literal">null</span>,<span class="attr">playing</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.easing=a?a:OpenLayers.Easing.Expo.easeOut&#125;,<span class="attr">start</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">this</span>.playing=!<span class="number">0</span>;<span class="keyword">this</span>.begin=a;<span class="keyword">this</span>.finish=b;<span class="keyword">this</span>.duration=c;<span class="keyword">this</span>.callbacks=d.callbacks;<span class="keyword">this</span>.minFrameRate=d.minFrameRate||<span class="number">30</span>;<span class="keyword">this</span>.time=<span class="number">0</span>;<span class="keyword">this</span>.startTime=(<span class="keyword">new</span> <span class="built_in">Date</span>).getTime();OpenLayers.Animation.stop(<span class="keyword">this</span>.animationId);<span class="keyword">this</span>.animationId=<span class="literal">null</span>;</span><br><span class="line"><span class="keyword">this</span>.callbacks&amp;&amp;<span class="keyword">this</span>.callbacks.start&amp;&amp;<span class="keyword">this</span>.callbacks.start.call(<span class="keyword">this</span>,<span class="keyword">this</span>.begin);<span class="keyword">this</span>.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(<span class="keyword">this</span>.play,<span class="keyword">this</span>))&#125;,<span class="attr">stop</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.playing&amp;&amp;(<span class="keyword">this</span>.callbacks&amp;&amp;<span class="keyword">this</span>.callbacks.done&amp;&amp;<span class="keyword">this</span>.callbacks.done.call(<span class="keyword">this</span>,<span class="keyword">this</span>.finish),OpenLayers.Animation.stop(<span class="keyword">this</span>.animationId),<span class="keyword">this</span>.animationId=<span class="literal">null</span>,<span class="keyword">this</span>.playing=!<span class="number">1</span>)&#125;,<span class="attr">play</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=&#123;&#125;,b;<span class="keyword">for</span>(b <span class="keyword">in</span> <span class="keyword">this</span>.begin)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.begin[b],d=<span class="keyword">this</span>.finish[b];<span class="keyword">if</span>(<span class="literal">null</span>==c||<span class="literal">null</span>==d||<span class="built_in">isNaN</span>(c)||<span class="built_in">isNaN</span>(d))<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"invalid value for Tween"</span>);</span><br><span class="line">a[b]=<span class="keyword">this</span>.easing.apply(<span class="keyword">this</span>,[<span class="keyword">this</span>.time,c,d-c,<span class="keyword">this</span>.duration])&#125;<span class="keyword">this</span>.time++;<span class="keyword">this</span>.callbacks&amp;&amp;<span class="keyword">this</span>.callbacks.eachStep&amp;&amp;((<span class="keyword">new</span> <span class="built_in">Date</span>).getTime()-<span class="keyword">this</span>.startTime)/<span class="keyword">this</span>.time&lt;=<span class="number">1E3</span>/<span class="keyword">this</span>.minFrameRate&amp;&amp;<span class="keyword">this</span>.callbacks.eachStep.call(<span class="keyword">this</span>,a);<span class="keyword">this</span>.time&gt;<span class="keyword">this</span>.duration&amp;&amp;<span class="keyword">this</span>.stop()&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Tween"</span>&#125;);OpenLayers.Easing=&#123;<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Easing"</span>&#125;;OpenLayers.Easing.Linear=&#123;<span class="attr">easeIn</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">return</span> c*a/d+b&#125;,<span class="attr">easeOut</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">return</span> c*a/d+b&#125;,<span class="attr">easeInOut</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">return</span> c*a/d+b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Easing.Linear"</span>&#125;;</span><br><span class="line">OpenLayers.Easing.Expo=&#123;<span class="attr">easeIn</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">return</span> <span class="number">0</span>==a?b:c*<span class="built_in">Math</span>.pow(<span class="number">2</span>,<span class="number">10</span>*(a/d<span class="number">-1</span>))+b&#125;,<span class="attr">easeOut</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">return</span> a==d?b+c:c*(-<span class="built_in">Math</span>.pow(<span class="number">2</span>,<span class="number">-10</span>*a/d)+<span class="number">1</span>)+b&#125;,<span class="attr">easeInOut</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">return</span> <span class="number">0</span>==a?b:a==d?b+c:<span class="number">1</span>&gt;(a/=d/<span class="number">2</span>)?c/<span class="number">2</span>*<span class="built_in">Math</span>.pow(<span class="number">2</span>,<span class="number">10</span>*(a<span class="number">-1</span>))+b:c/<span class="number">2</span>*(-<span class="built_in">Math</span>.pow(<span class="number">2</span>,<span class="number">-10</span>*--a)+<span class="number">2</span>)+b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Easing.Expo"</span>&#125;;</span><br><span class="line">OpenLayers.Easing.Quad=&#123;<span class="attr">easeIn</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">return</span> c*(a/=d)*a+b&#125;,<span class="attr">easeOut</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">return</span>-c*(a/=d)*(a<span class="number">-2</span>)+b&#125;,<span class="attr">easeInOut</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">return</span> <span class="number">1</span>&gt;(a/=d/<span class="number">2</span>)?c/<span class="number">2</span>*a*a+b:-c/<span class="number">2</span>*(--a*(a<span class="number">-2</span>)<span class="number">-1</span>)+b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Easing.Quad"</span>&#125;;OpenLayers.Projection=OpenLayers.Class(&#123;<span class="attr">proj</span>:<span class="literal">null</span>,<span class="attr">projCode</span>:<span class="literal">null</span>,<span class="attr">titleRegEx</span>:<span class="regexp">/\+title=[^\+]*/</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,b);<span class="keyword">this</span>.projCode=a;<span class="string">"object"</span>==<span class="keyword">typeof</span> Proj4js&amp;&amp;(<span class="keyword">this</span>.proj=<span class="keyword">new</span> Proj4js.Proj(a))&#125;,<span class="attr">getCode</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.proj?<span class="keyword">this</span>.proj.srsCode:<span class="keyword">this</span>.projCode&#125;,<span class="attr">getUnits</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.proj?<span class="keyword">this</span>.proj.units:<span class="literal">null</span>&#125;,<span class="attr">toString</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.getCode()&#125;,<span class="attr">equals</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;a&amp;&amp;(a <span class="keyword">instanceof</span> OpenLayers.Projection||(a=<span class="keyword">new</span> OpenLayers.Projection(a)),<span class="string">"object"</span>==</span><br><span class="line"><span class="keyword">typeof</span> Proj4js&amp;&amp;<span class="keyword">this</span>.proj.defData&amp;&amp;a.proj.defData?b=<span class="keyword">this</span>.proj.defData.replace(<span class="keyword">this</span>.titleRegEx,<span class="string">""</span>)==a.proj.defData.replace(<span class="keyword">this</span>.titleRegEx,<span class="string">""</span>):a.getCode&amp;&amp;(b=<span class="keyword">this</span>.getCode(),a=a.getCode(),b=b==a||!!OpenLayers.Projection.transforms[b]&amp;&amp;OpenLayers.Projection.transforms[b][a]===OpenLayers.Projection.nullTransform));<span class="keyword">return</span> b&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">delete</span> <span class="keyword">this</span>.proj;<span class="keyword">delete</span> <span class="keyword">this</span>.projCode&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Projection"</span>&#125;);OpenLayers.Projection.transforms=&#123;&#125;;</span><br><span class="line">OpenLayers.Projection.defaults=&#123;<span class="string">"EPSG:4326"</span>:&#123;<span class="attr">units</span>:<span class="string">"degrees"</span>,<span class="attr">maxExtent</span>:[<span class="number">-180</span>,<span class="number">-90</span>,<span class="number">180</span>,<span class="number">90</span>],<span class="attr">yx</span>:!<span class="number">0</span>&#125;,<span class="string">"CRS:84"</span>:&#123;<span class="attr">units</span>:<span class="string">"degrees"</span>,<span class="attr">maxExtent</span>:[<span class="number">-180</span>,<span class="number">-90</span>,<span class="number">180</span>,<span class="number">90</span>]&#125;,<span class="string">"EPSG:900913"</span>:&#123;<span class="attr">units</span>:<span class="string">"m"</span>,<span class="attr">maxExtent</span>:[<span class="number">-2.003750834E7</span>,<span class="number">-2.003750834E7</span>,<span class="number">2.003750834E7</span>,<span class="number">2.003750834E7</span>]&#125;&#125;;</span><br><span class="line">OpenLayers.Projection.addTransform=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">if</span>(c===OpenLayers.Projection.nullTransform)&#123;<span class="keyword">var</span> d=OpenLayers.Projection.defaults[a];d&amp;&amp;!OpenLayers.Projection.defaults[b]&amp;&amp;(OpenLayers.Projection.defaults[b]=d)&#125;OpenLayers.Projection.transforms[a]||(OpenLayers.Projection.transforms[a]=&#123;&#125;);OpenLayers.Projection.transforms[a][b]=c&#125;;</span><br><span class="line">OpenLayers.Projection.transform=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">if</span>(b&amp;&amp;c)<span class="keyword">if</span>(b <span class="keyword">instanceof</span> OpenLayers.Projection||(b=<span class="keyword">new</span> OpenLayers.Projection(b)),c <span class="keyword">instanceof</span> OpenLayers.Projection||(c=<span class="keyword">new</span> OpenLayers.Projection(c)),b.proj&amp;&amp;c.proj)a=Proj4js.transform(b.proj,c.proj,a);<span class="keyword">else</span>&#123;b=b.getCode();c=c.getCode();<span class="keyword">var</span> d=OpenLayers.Projection.transforms;<span class="keyword">if</span>(d[b]&amp;&amp;d[b][c])d[b][c](a)&#125;<span class="keyword">return</span> a&#125;;OpenLayers.Projection.nullTransform=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a&#125;;</span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">a</span>)</span>&#123;a.x=<span class="number">180</span>*a.x/d;a.y=<span class="number">180</span>/<span class="built_in">Math</span>.PI*(<span class="number">2</span>*<span class="built_in">Math</span>.atan(<span class="built_in">Math</span>.exp(a.y/d*<span class="built_in">Math</span>.PI))-<span class="built_in">Math</span>.PI/<span class="number">2</span>);<span class="keyword">return</span> a&#125;<span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params">a</span>)</span>&#123;a.x=a.x*d/<span class="number">180</span>;<span class="keyword">var</span> b=<span class="built_in">Math</span>.log(<span class="built_in">Math</span>.tan((<span class="number">90</span>+a.y)*<span class="built_in">Math</span>.PI/<span class="number">360</span>))/<span class="built_in">Math</span>.PI*d;a.y=<span class="built_in">Math</span>.max(<span class="number">-2.003750834E7</span>,<span class="built_in">Math</span>.min(b,<span class="number">2.003750834E7</span>));<span class="keyword">return</span> a&#125;<span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params">c,d</span>)</span>&#123;<span class="keyword">var</span> e=OpenLayers.Projection.addTransform,f=OpenLayers.Projection.nullTransform,g,p,q,r,s;g=<span class="number">0</span>;<span class="keyword">for</span>(p=d.length;g&lt;p;++g)<span class="keyword">for</span>(q=d[g],e(c,q,b),e(q,c,a),s=g+<span class="number">1</span>;s&lt;p;++s)r=d[s],e(q,r,f),e(r,q,f)&#125;<span class="keyword">var</span> d=<span class="number">2.003750834E7</span>,e=[<span class="string">"EPSG:900913"</span>,<span class="string">"EPSG:3857"</span>,</span><br><span class="line"><span class="string">"EPSG:102113"</span>,<span class="string">"EPSG:102100"</span>],f=[<span class="string">"CRS:84"</span>,<span class="string">"urn:ogc:def:crs:EPSG:6.6:4326"</span>,<span class="string">"EPSG:4326"</span>],g;<span class="keyword">for</span>(g=e.length<span class="number">-1</span>;<span class="number">0</span>&lt;=g;--g)c(e[g],f);<span class="keyword">for</span>(g=f.length<span class="number">-1</span>;<span class="number">0</span>&lt;=g;--g)c(f[g],e)&#125;)();OpenLayers.Map=OpenLayers.Class(&#123;<span class="attr">Z_INDEX_BASE</span>:&#123;<span class="attr">BaseLayer</span>:<span class="number">100</span>,<span class="attr">Overlay</span>:<span class="number">325</span>,<span class="attr">Feature</span>:<span class="number">725</span>,<span class="attr">Popup</span>:<span class="number">750</span>,<span class="attr">Control</span>:<span class="number">1E3</span>&#125;,<span class="attr">id</span>:<span class="literal">null</span>,<span class="attr">fractionalZoom</span>:!<span class="number">1</span>,<span class="attr">events</span>:<span class="literal">null</span>,<span class="attr">allOverlays</span>:!<span class="number">1</span>,<span class="attr">div</span>:<span class="literal">null</span>,<span class="attr">dragging</span>:!<span class="number">1</span>,<span class="attr">size</span>:<span class="literal">null</span>,<span class="attr">viewPortDiv</span>:<span class="literal">null</span>,<span class="attr">layerContainerOrigin</span>:<span class="literal">null</span>,<span class="attr">layerContainerDiv</span>:<span class="literal">null</span>,<span class="attr">layers</span>:<span class="literal">null</span>,<span class="attr">controls</span>:<span class="literal">null</span>,<span class="attr">popups</span>:<span class="literal">null</span>,<span class="attr">baseLayer</span>:<span class="literal">null</span>,<span class="attr">center</span>:<span class="literal">null</span>,<span class="attr">resolution</span>:<span class="literal">null</span>,<span class="attr">zoom</span>:<span class="number">0</span>,<span class="attr">panRatio</span>:<span class="number">1.5</span>,<span class="attr">options</span>:<span class="literal">null</span>,<span class="attr">tileSize</span>:<span class="literal">null</span>,<span class="attr">projection</span>:<span class="string">"EPSG:4326"</span>,<span class="attr">units</span>:<span class="literal">null</span>,<span class="attr">resolutions</span>:<span class="literal">null</span>,<span class="attr">maxResolution</span>:<span class="literal">null</span>,<span class="attr">minResolution</span>:<span class="literal">null</span>,<span class="attr">maxScale</span>:<span class="literal">null</span>,<span class="attr">minScale</span>:<span class="literal">null</span>,</span><br><span class="line">maxExtent:<span class="literal">null</span>,<span class="attr">minExtent</span>:<span class="literal">null</span>,<span class="attr">restrictedExtent</span>:<span class="literal">null</span>,<span class="attr">numZoomLevels</span>:<span class="number">16</span>,<span class="attr">theme</span>:<span class="literal">null</span>,<span class="attr">displayProjection</span>:<span class="literal">null</span>,<span class="attr">fallThrough</span>:!<span class="number">1</span>,<span class="attr">autoUpdateSize</span>:!<span class="number">0</span>,<span class="attr">eventListeners</span>:<span class="literal">null</span>,<span class="attr">panTween</span>:<span class="literal">null</span>,<span class="attr">panMethod</span>:OpenLayers.Easing.Expo.easeOut,<span class="attr">panDuration</span>:<span class="number">50</span>,<span class="attr">zoomTween</span>:<span class="literal">null</span>,<span class="attr">zoomMethod</span>:OpenLayers.Easing.Quad.easeOut,<span class="attr">zoomDuration</span>:<span class="number">20</span>,<span class="attr">paddingForPopups</span>:<span class="literal">null</span>,<span class="attr">layerContainerOriginPx</span>:<span class="literal">null</span>,<span class="attr">minPx</span>:<span class="literal">null</span>,<span class="attr">maxPx</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="number">1</span>===<span class="built_in">arguments</span>.length&amp;&amp;<span class="string">"object"</span>===<span class="keyword">typeof</span> a&amp;&amp;(a=(b=a)&amp;&amp;b.div);<span class="keyword">this</span>.tileSize=<span class="keyword">new</span> OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,</span><br><span class="line">OpenLayers.Map.TILE_HEIGHT);<span class="keyword">this</span>.paddingForPopups=<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">15</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="number">15</span>);<span class="keyword">this</span>.theme=OpenLayers._getScriptLocation()+<span class="string">"theme/default/style.css"</span>;<span class="keyword">this</span>.options=OpenLayers.Util.extend(&#123;&#125;,b);OpenLayers.Util.extend(<span class="keyword">this</span>,b);OpenLayers.Util.applyDefaults(<span class="keyword">this</span>,OpenLayers.Projection.defaults[<span class="keyword">this</span>.projection <span class="keyword">instanceof</span> OpenLayers.Projection?<span class="keyword">this</span>.projection.projCode:<span class="keyword">this</span>.projection]);!<span class="keyword">this</span>.maxExtent||<span class="keyword">this</span>.maxExtent <span class="keyword">instanceof</span> OpenLayers.Bounds||(<span class="keyword">this</span>.maxExtent=<span class="keyword">new</span> OpenLayers.Bounds(<span class="keyword">this</span>.maxExtent));</span><br><span class="line">!<span class="keyword">this</span>.minExtent||<span class="keyword">this</span>.minExtent <span class="keyword">instanceof</span> OpenLayers.Bounds||(<span class="keyword">this</span>.minExtent=<span class="keyword">new</span> OpenLayers.Bounds(<span class="keyword">this</span>.minExtent));!<span class="keyword">this</span>.restrictedExtent||<span class="keyword">this</span>.restrictedExtent <span class="keyword">instanceof</span> OpenLayers.Bounds||(<span class="keyword">this</span>.restrictedExtent=<span class="keyword">new</span> OpenLayers.Bounds(<span class="keyword">this</span>.restrictedExtent));!<span class="keyword">this</span>.center||<span class="keyword">this</span>.center <span class="keyword">instanceof</span> OpenLayers.LonLat||(<span class="keyword">this</span>.center=<span class="keyword">new</span> OpenLayers.LonLat(<span class="keyword">this</span>.center));<span class="keyword">this</span>.layers=[];<span class="keyword">this</span>.id=OpenLayers.Util.createUniqueID(<span class="string">"OpenLayers.Map_"</span>);<span class="keyword">this</span>.div=OpenLayers.Util.getElement(a);<span class="keyword">this</span>.div||(<span class="keyword">this</span>.div=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>),</span><br><span class="line"><span class="keyword">this</span>.div.style.height=<span class="string">"1px"</span>,<span class="keyword">this</span>.div.style.width=<span class="string">"1px"</span>);OpenLayers.Element.addClass(<span class="keyword">this</span>.div,<span class="string">"olMap"</span>);<span class="keyword">var</span> c=<span class="keyword">this</span>.id+<span class="string">"_OpenLayers_ViewPort"</span>;<span class="keyword">this</span>.viewPortDiv=OpenLayers.Util.createDiv(c,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="string">"relative"</span>,<span class="literal">null</span>,<span class="string">"hidden"</span>);<span class="keyword">this</span>.viewPortDiv.style.width=<span class="string">"100%"</span>;<span class="keyword">this</span>.viewPortDiv.style.height=<span class="string">"100%"</span>;<span class="keyword">this</span>.viewPortDiv.className=<span class="string">"olMapViewport"</span>;<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.viewPortDiv);<span class="keyword">this</span>.events=<span class="keyword">new</span> OpenLayers.Events(<span class="keyword">this</span>,<span class="keyword">this</span>.viewPortDiv,<span class="literal">null</span>,<span class="keyword">this</span>.fallThrough,&#123;<span class="attr">includeXY</span>:!<span class="number">0</span>&#125;);OpenLayers.TileManager&amp;&amp;<span class="literal">null</span>!==</span><br><span class="line"><span class="keyword">this</span>.tileManager&amp;&amp;(<span class="keyword">this</span>.tileManager <span class="keyword">instanceof</span> OpenLayers.TileManager||(<span class="keyword">this</span>.tileManager=<span class="keyword">new</span> OpenLayers.TileManager(<span class="keyword">this</span>.tileManager)),<span class="keyword">this</span>.tileManager.addMap(<span class="keyword">this</span>));c=<span class="keyword">this</span>.id+<span class="string">"_OpenLayers_Container"</span>;<span class="keyword">this</span>.layerContainerDiv=OpenLayers.Util.createDiv(c);<span class="keyword">this</span>.layerContainerDiv.style.zIndex=<span class="keyword">this</span>.Z_INDEX_BASE.Popup<span class="number">-1</span>;<span class="keyword">this</span>.layerContainerOriginPx=&#123;<span class="attr">x</span>:<span class="number">0</span>,<span class="attr">y</span>:<span class="number">0</span>&#125;;<span class="keyword">this</span>.applyTransform();<span class="keyword">this</span>.viewPortDiv.appendChild(<span class="keyword">this</span>.layerContainerDiv);<span class="keyword">this</span>.updateSize();<span class="keyword">if</span>(<span class="keyword">this</span>.eventListeners <span class="keyword">instanceof</span> <span class="built_in">Object</span>)<span class="keyword">this</span>.events.on(<span class="keyword">this</span>.eventListeners);</span><br><span class="line">!<span class="number">0</span>===<span class="keyword">this</span>.autoUpdateSize&amp;&amp;(<span class="keyword">this</span>.updateSizeDestroy=OpenLayers.Function.bind(<span class="keyword">this</span>.updateSize,<span class="keyword">this</span>),OpenLayers.Event.observe(<span class="built_in">window</span>,<span class="string">"resize"</span>,<span class="keyword">this</span>.updateSizeDestroy));<span class="keyword">if</span>(<span class="keyword">this</span>.theme)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=!<span class="number">0</span>,d=<span class="built_in">document</span>.getElementsByTagName(<span class="string">"link"</span>),e=<span class="number">0</span>,f=d.length;e&lt;f;++e)<span class="keyword">if</span>(OpenLayers.Util.isEquivalentUrl(d.item(e).href,<span class="keyword">this</span>.theme))&#123;c=!<span class="number">1</span>;<span class="keyword">break</span>&#125;c&amp;&amp;(c=<span class="built_in">document</span>.createElement(<span class="string">"link"</span>),c.setAttribute(<span class="string">"rel"</span>,<span class="string">"stylesheet"</span>),c.setAttribute(<span class="string">"type"</span>,<span class="string">"text/css"</span>),c.setAttribute(<span class="string">"href"</span>,<span class="keyword">this</span>.theme),<span class="built_in">document</span>.getElementsByTagName(<span class="string">"head"</span>)[<span class="number">0</span>].appendChild(c))&#125;<span class="literal">null</span>==</span><br><span class="line"><span class="keyword">this</span>.controls&amp;&amp;(<span class="keyword">this</span>.controls=[],<span class="literal">null</span>!=OpenLayers.Control&amp;&amp;(OpenLayers.Control.Navigation?<span class="keyword">this</span>.controls.push(<span class="keyword">new</span> OpenLayers.Control.Navigation):OpenLayers.Control.TouchNavigation&amp;&amp;<span class="keyword">this</span>.controls.push(<span class="keyword">new</span> OpenLayers.Control.TouchNavigation),OpenLayers.Control.Zoom?<span class="keyword">this</span>.controls.push(<span class="keyword">new</span> OpenLayers.Control.Zoom):OpenLayers.Control.PanZoom&amp;&amp;<span class="keyword">this</span>.controls.push(<span class="keyword">new</span> OpenLayers.Control.PanZoom),OpenLayers.Control.ArgParser&amp;&amp;<span class="keyword">this</span>.controls.push(<span class="keyword">new</span> OpenLayers.Control.ArgParser),OpenLayers.Control.Attribution&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.controls.push(<span class="keyword">new</span> OpenLayers.Control.Attribution)));e=<span class="number">0</span>;<span class="keyword">for</span>(f=<span class="keyword">this</span>.controls.length;e&lt;f;e++)<span class="keyword">this</span>.addControlToMap(<span class="keyword">this</span>.controls[e]);<span class="keyword">this</span>.popups=[];<span class="keyword">this</span>.unloadDestroy=OpenLayers.Function.bind(<span class="keyword">this</span>.destroy,<span class="keyword">this</span>);OpenLayers.Event.observe(<span class="built_in">window</span>,<span class="string">"unload"</span>,<span class="keyword">this</span>.unloadDestroy);b&amp;&amp;b.layers&amp;&amp;(<span class="keyword">delete</span> <span class="keyword">this</span>.center,<span class="keyword">delete</span> <span class="keyword">this</span>.zoom,<span class="keyword">this</span>.addLayers(b.layers),b.center&amp;&amp;!<span class="keyword">this</span>.getCenter()&amp;&amp;<span class="keyword">this</span>.setCenter(b.center,b.zoom));<span class="keyword">this</span>.panMethod&amp;&amp;(<span class="keyword">this</span>.panTween=<span class="keyword">new</span> OpenLayers.Tween(<span class="keyword">this</span>.panMethod));<span class="keyword">this</span>.zoomMethod&amp;&amp;<span class="keyword">this</span>.applyTransform.transform&amp;&amp;</span><br><span class="line">(<span class="keyword">this</span>.zoomTween=<span class="keyword">new</span> OpenLayers.Tween(<span class="keyword">this</span>.zoomMethod))&#125;,<span class="attr">getViewport</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.viewPortDiv&#125;,<span class="attr">render</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.div=OpenLayers.Util.getElement(a);OpenLayers.Element.addClass(<span class="keyword">this</span>.div,<span class="string">"olMap"</span>);<span class="keyword">this</span>.viewPortDiv.parentNode.removeChild(<span class="keyword">this</span>.viewPortDiv);<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.viewPortDiv);<span class="keyword">this</span>.updateSize()&#125;,<span class="attr">unloadDestroy</span>:<span class="literal">null</span>,<span class="attr">updateSizeDestroy</span>:<span class="literal">null</span>,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.unloadDestroy)<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">this</span>.panTween&amp;&amp;(<span class="keyword">this</span>.panTween.stop(),<span class="keyword">this</span>.panTween=<span class="literal">null</span>);<span class="keyword">this</span>.zoomTween&amp;&amp;(<span class="keyword">this</span>.zoomTween.stop(),</span><br><span class="line"><span class="keyword">this</span>.zoomTween=<span class="literal">null</span>);OpenLayers.Event.stopObserving(<span class="built_in">window</span>,<span class="string">"unload"</span>,<span class="keyword">this</span>.unloadDestroy);<span class="keyword">this</span>.unloadDestroy=<span class="literal">null</span>;<span class="keyword">this</span>.updateSizeDestroy&amp;&amp;OpenLayers.Event.stopObserving(<span class="built_in">window</span>,<span class="string">"resize"</span>,<span class="keyword">this</span>.updateSizeDestroy);<span class="keyword">this</span>.paddingForPopups=<span class="literal">null</span>;<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.controls)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.controls.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;--a)<span class="keyword">this</span>.controls[a].destroy();<span class="keyword">this</span>.controls=<span class="literal">null</span>&#125;<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.layers)&#123;<span class="keyword">for</span>(a=<span class="keyword">this</span>.layers.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;--a)<span class="keyword">this</span>.layers[a].destroy(!<span class="number">1</span>);<span class="keyword">this</span>.layers=<span class="literal">null</span>&#125;<span class="keyword">this</span>.viewPortDiv&amp;&amp;<span class="keyword">this</span>.viewPortDiv.parentNode&amp;&amp;<span class="keyword">this</span>.viewPortDiv.parentNode.removeChild(<span class="keyword">this</span>.viewPortDiv);</span><br><span class="line"><span class="keyword">this</span>.viewPortDiv=<span class="literal">null</span>;<span class="keyword">this</span>.tileManager&amp;&amp;(<span class="keyword">this</span>.tileManager.removeMap(<span class="keyword">this</span>),<span class="keyword">this</span>.tileManager=<span class="literal">null</span>);<span class="keyword">this</span>.eventListeners&amp;&amp;(<span class="keyword">this</span>.events.un(<span class="keyword">this</span>.eventListeners),<span class="keyword">this</span>.eventListeners=<span class="literal">null</span>);<span class="keyword">this</span>.events.destroy();<span class="keyword">this</span>.options=<span class="keyword">this</span>.events=<span class="literal">null</span>&#125;,<span class="attr">setOptions</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.minPx&amp;&amp;a.restrictedExtent!=<span class="keyword">this</span>.restrictedExtent;OpenLayers.Util.extend(<span class="keyword">this</span>,a);b&amp;&amp;<span class="keyword">this</span>.moveTo(<span class="keyword">this</span>.getCachedCenter(),<span class="keyword">this</span>.zoom,&#123;<span class="attr">forceZoomChange</span>:!<span class="number">0</span>&#125;)&#125;,<span class="attr">getTileSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.tileSize&#125;,<span class="attr">getBy</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=<span class="string">"function"</span>==</span><br><span class="line"><span class="keyword">typeof</span> c.test;<span class="keyword">return</span> OpenLayers.Array.filter(<span class="keyword">this</span>[a],<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a[b]==c||d&amp;&amp;c.test(a[b])&#125;)&#125;,<span class="attr">getLayersBy</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.getBy(<span class="string">"layers"</span>,a,b)&#125;,<span class="attr">getLayersByName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.getLayersBy(<span class="string">"name"</span>,a)&#125;,<span class="attr">getLayersByClass</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.getLayersBy(<span class="string">"CLASS_NAME"</span>,a)&#125;,<span class="attr">getControlsBy</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.getBy(<span class="string">"controls"</span>,a,b)&#125;,<span class="attr">getControlsByClass</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.getControlsBy(<span class="string">"CLASS_NAME"</span>,a)&#125;,<span class="attr">getLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="literal">null</span>,c=<span class="number">0</span>,d=<span class="keyword">this</span>.layers.length;c&lt;d;c++)&#123;<span class="keyword">var</span> e=</span><br><span class="line"><span class="keyword">this</span>.layers[c];<span class="keyword">if</span>(e.id==a)&#123;b=e;<span class="keyword">break</span>&#125;&#125;<span class="keyword">return</span> b&#125;,<span class="attr">setLayerZIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.setZIndex(<span class="keyword">this</span>.Z_INDEX_BASE[a.isBaseLayer?<span class="string">"BaseLayer"</span>:<span class="string">"Overlay"</span>]+<span class="number">5</span>*b)&#125;,<span class="attr">resetLayersZIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="keyword">this</span>.layers.length;a&lt;b;a++)<span class="keyword">this</span>.setLayerZIndex(<span class="keyword">this</span>.layers[a],a)&#125;,<span class="attr">addLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="keyword">this</span>.layers.length;b&lt;c;b++)<span class="keyword">if</span>(<span class="keyword">this</span>.layers[b]==a)<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">if</span>(!<span class="number">1</span>===<span class="keyword">this</span>.events.triggerEvent(<span class="string">"preaddlayer"</span>,&#123;<span class="attr">layer</span>:a&#125;))<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">this</span>.allOverlays&amp;&amp;(a.isBaseLayer=!<span class="number">1</span>);a.div.className=<span class="string">"olLayerDiv"</span>;a.div.style.overflow=</span><br><span class="line"><span class="string">""</span>;<span class="keyword">this</span>.setLayerZIndex(a,<span class="keyword">this</span>.layers.length);a.isFixed?<span class="keyword">this</span>.viewPortDiv.appendChild(a.div):<span class="keyword">this</span>.layerContainerDiv.appendChild(a.div);<span class="keyword">this</span>.layers.push(a);a.setMap(<span class="keyword">this</span>);a.isBaseLayer||<span class="keyword">this</span>.allOverlays&amp;&amp;!<span class="keyword">this</span>.baseLayer?<span class="literal">null</span>==<span class="keyword">this</span>.baseLayer?<span class="keyword">this</span>.setBaseLayer(a):a.setVisibility(!<span class="number">1</span>):a.redraw();<span class="keyword">this</span>.events.triggerEvent(<span class="string">"addlayer"</span>,&#123;<span class="attr">layer</span>:a&#125;);a.events.triggerEvent(<span class="string">"added"</span>,&#123;<span class="attr">map</span>:<span class="keyword">this</span>,<span class="attr">layer</span>:a&#125;);a.afterAdd();<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">addLayers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=a.length;b&lt;c;b++)<span class="keyword">this</span>.addLayer(a[b])&#125;,<span class="attr">removeLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">if</span>(!<span class="number">1</span>!==<span class="keyword">this</span>.events.triggerEvent(<span class="string">"preremovelayer"</span>,&#123;<span class="attr">layer</span>:a&#125;))&#123;<span class="literal">null</span>==b&amp;&amp;(b=!<span class="number">0</span>);a.isFixed?<span class="keyword">this</span>.viewPortDiv.removeChild(a.div):<span class="keyword">this</span>.layerContainerDiv.removeChild(a.div);OpenLayers.Util.removeItem(<span class="keyword">this</span>.layers,a);a.removeMap(<span class="keyword">this</span>);a.map=<span class="literal">null</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.baseLayer==a&amp;&amp;(<span class="keyword">this</span>.baseLayer=<span class="literal">null</span>,b))<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.layers.length;c&lt;d;c++)&#123;<span class="keyword">var</span> e=<span class="keyword">this</span>.layers[c];<span class="keyword">if</span>(e.isBaseLayer||<span class="keyword">this</span>.allOverlays)&#123;<span class="keyword">this</span>.setBaseLayer(e);<span class="keyword">break</span>&#125;&#125;<span class="keyword">this</span>.resetLayersZIndex();<span class="keyword">this</span>.events.triggerEvent(<span class="string">"removelayer"</span>,&#123;<span class="attr">layer</span>:a&#125;);a.events.triggerEvent(<span class="string">"removed"</span>,</span><br><span class="line">&#123;<span class="attr">map</span>:<span class="keyword">this</span>,<span class="attr">layer</span>:a&#125;)&#125;&#125;,<span class="attr">getNumLayers</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.layers.length&#125;,<span class="attr">getLayerIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Util.indexOf(<span class="keyword">this</span>.layers,a)&#125;,<span class="attr">setLayerIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getLayerIndex(a);<span class="number">0</span>&gt;b?b=<span class="number">0</span>:b&gt;<span class="keyword">this</span>.layers.length&amp;&amp;(b=<span class="keyword">this</span>.layers.length);<span class="keyword">if</span>(c!=b)&#123;<span class="keyword">this</span>.layers.splice(c,<span class="number">1</span>);<span class="keyword">this</span>.layers.splice(b,<span class="number">0</span>,a);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.layers.length;c&lt;d;c++)<span class="keyword">this</span>.setLayerZIndex(<span class="keyword">this</span>.layers[c],c);<span class="keyword">this</span>.events.triggerEvent(<span class="string">"changelayer"</span>,&#123;<span class="attr">layer</span>:a,<span class="attr">property</span>:<span class="string">"order"</span>&#125;);<span class="keyword">this</span>.allOverlays&amp;&amp;(<span class="number">0</span>===b?<span class="keyword">this</span>.setBaseLayer(a):</span><br><span class="line"><span class="keyword">this</span>.baseLayer!==<span class="keyword">this</span>.layers[<span class="number">0</span>]&amp;&amp;<span class="keyword">this</span>.setBaseLayer(<span class="keyword">this</span>.layers[<span class="number">0</span>]))&#125;&#125;,<span class="attr">raiseLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getLayerIndex(a)+b;<span class="keyword">this</span>.setLayerIndex(a,c)&#125;,<span class="attr">setBaseLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a!=<span class="keyword">this</span>.baseLayer&amp;&amp;<span class="number">-1</span>!=OpenLayers.Util.indexOf(<span class="keyword">this</span>.layers,a))&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getCachedCenter(),c=OpenLayers.Util.getResolutionFromScale(<span class="keyword">this</span>.getScale(),a.units);<span class="literal">null</span>==<span class="keyword">this</span>.baseLayer||<span class="keyword">this</span>.allOverlays||<span class="keyword">this</span>.baseLayer.setVisibility(!<span class="number">1</span>);<span class="keyword">this</span>.baseLayer=a;<span class="keyword">if</span>(!<span class="keyword">this</span>.allOverlays||<span class="keyword">this</span>.baseLayer.visibility)<span class="keyword">this</span>.baseLayer.setVisibility(!<span class="number">0</span>),</span><br><span class="line">!<span class="number">1</span>===<span class="keyword">this</span>.baseLayer.inRange&amp;&amp;<span class="keyword">this</span>.baseLayer.redraw();<span class="literal">null</span>!=b&amp;&amp;(a=<span class="keyword">this</span>.getZoomForResolution(c||<span class="keyword">this</span>.resolution,!<span class="number">0</span>),<span class="keyword">this</span>.setCenter(b,a,!<span class="number">1</span>,!<span class="number">0</span>));<span class="keyword">this</span>.events.triggerEvent(<span class="string">"changebaselayer"</span>,&#123;<span class="attr">layer</span>:<span class="keyword">this</span>.baseLayer&#125;)&#125;&#125;,<span class="attr">addControl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.controls.push(a);<span class="keyword">this</span>.addControlToMap(a,b)&#125;,<span class="attr">addControls</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">1</span>===<span class="built_in">arguments</span>.length?[]:b,d=<span class="number">0</span>,e=a.length;d&lt;e;d++)<span class="keyword">this</span>.addControl(a[d],c[d]?c[d]:<span class="literal">null</span>)&#125;,<span class="attr">addControlToMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.outsideViewport=<span class="literal">null</span>!=a.div;<span class="keyword">this</span>.displayProjection&amp;&amp;!a.displayProjection&amp;&amp;</span><br><span class="line">(a.displayProjection=<span class="keyword">this</span>.displayProjection);a.setMap(<span class="keyword">this</span>);<span class="keyword">var</span> c=a.draw(b);c&amp;&amp;!a.outsideViewport&amp;&amp;(c.style.zIndex=<span class="keyword">this</span>.Z_INDEX_BASE.Control+<span class="keyword">this</span>.controls.length,<span class="keyword">this</span>.viewPortDiv.appendChild(c));a.autoActivate&amp;&amp;a.activate()&#125;,<span class="attr">getControl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="literal">null</span>,c=<span class="number">0</span>,d=<span class="keyword">this</span>.controls.length;c&lt;d;c++)&#123;<span class="keyword">var</span> e=<span class="keyword">this</span>.controls[c];<span class="keyword">if</span>(e.id==a)&#123;b=e;<span class="keyword">break</span>&#125;&#125;<span class="keyword">return</span> b&#125;,<span class="attr">removeControl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a&amp;&amp;a==<span class="keyword">this</span>.getControl(a.id)&amp;&amp;(a.div&amp;&amp;a.div.parentNode==<span class="keyword">this</span>.viewPortDiv&amp;&amp;<span class="keyword">this</span>.viewPortDiv.removeChild(a.div),OpenLayers.Util.removeItem(<span class="keyword">this</span>.controls,</span><br><span class="line">a))&#125;,<span class="attr">addPopup</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(b)<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="keyword">this</span>.popups.length<span class="number">-1</span>;<span class="number">0</span>&lt;=c;--c)<span class="keyword">this</span>.removePopup(<span class="keyword">this</span>.popups[c]);a.map=<span class="keyword">this</span>;<span class="keyword">this</span>.popups.push(a);<span class="keyword">if</span>(c=a.draw())c.style.zIndex=<span class="keyword">this</span>.Z_INDEX_BASE.Popup+<span class="keyword">this</span>.popups.length,<span class="keyword">this</span>.layerContainerDiv.appendChild(c)&#125;,<span class="attr">removePopup</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.removeItem(<span class="keyword">this</span>.popups,a);<span class="keyword">if</span>(a.div)<span class="keyword">try</span>&#123;<span class="keyword">this</span>.layerContainerDiv.removeChild(a.div)&#125;<span class="keyword">catch</span>(b)&#123;&#125;a.map=<span class="literal">null</span>&#125;,<span class="attr">getSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.size&amp;&amp;(a=<span class="keyword">this</span>.size.clone());<span class="keyword">return</span> a&#125;,<span class="attr">updateSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.getCurrentSize();</span><br><span class="line"><span class="keyword">if</span>(a&amp;&amp;!<span class="built_in">isNaN</span>(a.h)&amp;&amp;!<span class="built_in">isNaN</span>(a.w))&#123;<span class="keyword">this</span>.events.clearMouseCache();<span class="keyword">var</span> b=<span class="keyword">this</span>.getSize();<span class="literal">null</span>==b&amp;&amp;(<span class="keyword">this</span>.size=b=a);<span class="keyword">if</span>(!a.equals(b))&#123;<span class="keyword">this</span>.size=a;a=<span class="number">0</span>;<span class="keyword">for</span>(b=<span class="keyword">this</span>.layers.length;a&lt;b;a++)<span class="keyword">this</span>.layers[a].onMapResize();a=<span class="keyword">this</span>.getCachedCenter();<span class="literal">null</span>!=<span class="keyword">this</span>.baseLayer&amp;&amp;<span class="literal">null</span>!=a&amp;&amp;(b=<span class="keyword">this</span>.getZoom(),<span class="keyword">this</span>.zoom=<span class="literal">null</span>,<span class="keyword">this</span>.setCenter(a,b))&#125;&#125;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"updatesize"</span>)&#125;,<span class="attr">getCurrentSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">new</span> OpenLayers.Size(<span class="keyword">this</span>.div.clientWidth,<span class="keyword">this</span>.div.clientHeight);<span class="keyword">if</span>(<span class="number">0</span>==a.w&amp;&amp;<span class="number">0</span>==a.h||<span class="built_in">isNaN</span>(a.w)&amp;&amp;<span class="built_in">isNaN</span>(a.h))a.w=<span class="keyword">this</span>.div.offsetWidth,</span><br><span class="line">a.h=<span class="keyword">this</span>.div.offsetHeight;<span class="keyword">if</span>(<span class="number">0</span>==a.w&amp;&amp;<span class="number">0</span>==a.h||<span class="built_in">isNaN</span>(a.w)&amp;&amp;<span class="built_in">isNaN</span>(a.h))a.w=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.div.style.width),a.h=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.div.style.height);<span class="keyword">return</span> a&#125;,<span class="attr">calculateBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">this</span>.getCachedCenter());<span class="literal">null</span>==b&amp;&amp;(b=<span class="keyword">this</span>.getResolution());<span class="keyword">if</span>(<span class="literal">null</span>!=a&amp;&amp;<span class="literal">null</span>!=b)<span class="keyword">var</span> c=<span class="keyword">this</span>.size.w*b/<span class="number">2</span>,d=<span class="keyword">this</span>.size.h*b/<span class="number">2</span>,c=<span class="keyword">new</span> OpenLayers.Bounds(a.lon-c,a.lat-d,a.lon+c,a.lat+d);<span class="keyword">return</span> c&#125;,<span class="attr">getCenter</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="literal">null</span>,b=<span class="keyword">this</span>.getCachedCenter();b&amp;&amp;(a=b.clone());<span class="keyword">return</span> a&#125;,<span class="attr">getCachedCenter</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;!<span class="keyword">this</span>.center&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.size&amp;&amp;(<span class="keyword">this</span>.center=<span class="keyword">this</span>.getLonLatFromViewPortPx(&#123;<span class="attr">x</span>:<span class="keyword">this</span>.size.w/<span class="number">2</span>,<span class="attr">y</span>:<span class="keyword">this</span>.size.h/<span class="number">2</span>&#125;));<span class="keyword">return</span> <span class="keyword">this</span>.center&#125;,<span class="attr">getZoom</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.zoom&#125;,<span class="attr">pan</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;c=OpenLayers.Util.applyDefaults(c,&#123;<span class="attr">animate</span>:!<span class="number">0</span>,<span class="attr">dragging</span>:!<span class="number">1</span>&#125;);<span class="keyword">if</span>(c.dragging)<span class="number">0</span>==a&amp;&amp;<span class="number">0</span>==b||<span class="keyword">this</span>.moveByPx(a,b);<span class="keyword">else</span>&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.getViewPortPxFromLonLat(<span class="keyword">this</span>.getCachedCenter());a=d.add(a,b);<span class="keyword">if</span>(<span class="keyword">this</span>.dragging||!a.equals(d))d=<span class="keyword">this</span>.getLonLatFromViewPortPx(a),c.animate?<span class="keyword">this</span>.panTo(d):(<span class="keyword">this</span>.moveTo(d),<span class="keyword">this</span>.dragging&amp;&amp;(<span class="keyword">this</span>.dragging=!<span class="number">1</span>,<span class="keyword">this</span>.events.triggerEvent(<span class="string">"moveend"</span>)))&#125;&#125;,</span><br><span class="line">panTo:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.panTween&amp;&amp;<span class="keyword">this</span>.getExtent().scale(<span class="keyword">this</span>.panRatio).containsLonLat(a))&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getCachedCenter();<span class="keyword">if</span>(!a.equals(b))&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getPixelFromLonLat(b),c=<span class="keyword">this</span>.getPixelFromLonLat(a),d=<span class="number">0</span>,e=<span class="number">0</span>;<span class="keyword">this</span>.panTween.start(&#123;<span class="attr">x</span>:<span class="number">0</span>,<span class="attr">y</span>:<span class="number">0</span>&#125;,&#123;<span class="attr">x</span>:c.x-b.x,<span class="attr">y</span>:c.y-b.y&#125;,<span class="keyword">this</span>.panDuration,&#123;<span class="attr">callbacks</span>:&#123;<span class="attr">eachStep</span>:OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.moveByPx(a.x-d,a.y-e);d=<span class="built_in">Math</span>.round(a.x);e=<span class="built_in">Math</span>.round(a.y)&#125;,<span class="keyword">this</span>),<span class="attr">done</span>:OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params">b</span>)</span>&#123;<span class="keyword">this</span>.moveTo(a);<span class="keyword">this</span>.dragging=!<span class="number">1</span>;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"moveend"</span>)&#125;,</span><br><span class="line"><span class="keyword">this</span>)&#125;&#125;)&#125;&#125;<span class="keyword">else</span> <span class="keyword">this</span>.setCenter(a)&#125;,<span class="attr">setCenter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">this</span>.panTween&amp;&amp;<span class="keyword">this</span>.panTween.stop();<span class="keyword">this</span>.zoomTween&amp;&amp;<span class="keyword">this</span>.zoomTween.stop();<span class="keyword">this</span>.moveTo(a,b,&#123;<span class="attr">dragging</span>:c,<span class="attr">forceZoomChange</span>:d&#125;)&#125;,<span class="attr">moveByPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.size.w/<span class="number">2</span>,d=<span class="keyword">this</span>.size.h/<span class="number">2</span>,e=c+a,f=d+b,g=<span class="keyword">this</span>.baseLayer.wrapDateLine,h=<span class="number">0</span>,k=<span class="number">0</span>;<span class="keyword">this</span>.restrictedExtent&amp;&amp;(h=c,k=d,g=!<span class="number">1</span>);a=g||e&lt;=<span class="keyword">this</span>.maxPx.x-h&amp;&amp;e&gt;=<span class="keyword">this</span>.minPx.x+h?<span class="built_in">Math</span>.round(a):<span class="number">0</span>;b=f&lt;=<span class="keyword">this</span>.maxPx.y-k&amp;&amp;f&gt;=<span class="keyword">this</span>.minPx.y+k?<span class="built_in">Math</span>.round(b):<span class="number">0</span>;<span class="keyword">if</span>(a||b)&#123;<span class="keyword">this</span>.dragging||(<span class="keyword">this</span>.dragging=!<span class="number">0</span>,<span class="keyword">this</span>.events.triggerEvent(<span class="string">"movestart"</span>));</span><br><span class="line"><span class="keyword">this</span>.center=<span class="literal">null</span>;a&amp;&amp;(<span class="keyword">this</span>.layerContainerOriginPx.x-=a,<span class="keyword">this</span>.minPx.x-=a,<span class="keyword">this</span>.maxPx.x-=a);b&amp;&amp;(<span class="keyword">this</span>.layerContainerOriginPx.y-=b,<span class="keyword">this</span>.minPx.y-=b,<span class="keyword">this</span>.maxPx.y-=b);<span class="keyword">this</span>.applyTransform();d=<span class="number">0</span>;<span class="keyword">for</span>(e=<span class="keyword">this</span>.layers.length;d&lt;e;++d)c=<span class="keyword">this</span>.layers[d],c.visibility&amp;&amp;(c===<span class="keyword">this</span>.baseLayer||c.inRange)&amp;&amp;(c.moveByPx(a,b),c.events.triggerEvent(<span class="string">"move"</span>));<span class="keyword">this</span>.events.triggerEvent(<span class="string">"move"</span>)&#125;&#125;,<span class="attr">adjustZoom</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.baseLayer&amp;&amp;<span class="keyword">this</span>.baseLayer.wrapDateLine)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.baseLayer.resolutions,c=<span class="keyword">this</span>.getMaxExtent().getWidth()/<span class="keyword">this</span>.size.w;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">this</span>.getResolutionForZoom(a)&gt;c)<span class="keyword">if</span>(<span class="keyword">this</span>.fractionalZoom)a=<span class="keyword">this</span>.getZoomForResolution(c);<span class="keyword">else</span> <span class="keyword">for</span>(<span class="keyword">var</span> d=a|<span class="number">0</span>,e=b.length;d&lt;e;++d)<span class="keyword">if</span>(b[d]&lt;=c)&#123;a=d;<span class="keyword">break</span>&#125;&#125;<span class="keyword">return</span> a&#125;,<span class="attr">getMinZoom</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.adjustZoom(<span class="number">0</span>)&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="literal">null</span>==a||a <span class="keyword">instanceof</span> OpenLayers.LonLat||(a=<span class="keyword">new</span> OpenLayers.LonLat(a));c||(c=&#123;&#125;);<span class="literal">null</span>!=b&amp;&amp;(b=<span class="built_in">parseFloat</span>(b),<span class="keyword">this</span>.fractionalZoom||(b=<span class="built_in">Math</span>.round(b)));<span class="keyword">var</span> d=b;b=<span class="keyword">this</span>.adjustZoom(b);b!==d&amp;&amp;(a=<span class="keyword">this</span>.getCenter());<span class="keyword">var</span> d=c.dragging||<span class="keyword">this</span>.dragging,e=c.forceZoomChange;<span class="keyword">this</span>.getCachedCenter()||</span><br><span class="line"><span class="keyword">this</span>.isValidLonLat(a)||(a=<span class="keyword">this</span>.maxExtent.getCenterLonLat(),<span class="keyword">this</span>.center=a.clone());<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.restrictedExtent)&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">this</span>.center);<span class="literal">null</span>==b&amp;&amp;(b=<span class="keyword">this</span>.getZoom());<span class="keyword">var</span> f=<span class="keyword">this</span>.getResolutionForZoom(b),f=<span class="keyword">this</span>.calculateBounds(a,f);<span class="keyword">if</span>(!<span class="keyword">this</span>.restrictedExtent.containsBounds(f))&#123;<span class="keyword">var</span> g=<span class="keyword">this</span>.restrictedExtent.getCenterLonLat();f.getWidth()&gt;<span class="keyword">this</span>.restrictedExtent.getWidth()?a=<span class="keyword">new</span> OpenLayers.LonLat(g.lon,a.lat):f.left&lt;<span class="keyword">this</span>.restrictedExtent.left?a=a.add(<span class="keyword">this</span>.restrictedExtent.left-f.left,<span class="number">0</span>):f.right&gt;<span class="keyword">this</span>.restrictedExtent.right&amp;&amp;</span><br><span class="line">(a=a.add(<span class="keyword">this</span>.restrictedExtent.right-f.right,<span class="number">0</span>));f.getHeight()&gt;<span class="keyword">this</span>.restrictedExtent.getHeight()?a=<span class="keyword">new</span> OpenLayers.LonLat(a.lon,g.lat):f.bottom&lt;<span class="keyword">this</span>.restrictedExtent.bottom?a=a.add(<span class="number">0</span>,<span class="keyword">this</span>.restrictedExtent.bottom-f.bottom):f.top&gt;<span class="keyword">this</span>.restrictedExtent.top&amp;&amp;(a=a.add(<span class="number">0</span>,<span class="keyword">this</span>.restrictedExtent.top-f.top))&#125;&#125;e=e||<span class="keyword">this</span>.isValidZoomLevel(b)&amp;&amp;b!=<span class="keyword">this</span>.getZoom();f=<span class="keyword">this</span>.isValidLonLat(a)&amp;&amp;!a.equals(<span class="keyword">this</span>.center);<span class="keyword">if</span>(e||f||d)&#123;d||<span class="keyword">this</span>.events.triggerEvent(<span class="string">"movestart"</span>,&#123;<span class="attr">zoomChanged</span>:e&#125;);f&amp;&amp;(!e&amp;&amp;<span class="keyword">this</span>.center&amp;&amp;<span class="keyword">this</span>.centerLayerContainer(a),</span><br><span class="line"><span class="keyword">this</span>.center=a.clone());a=e?<span class="keyword">this</span>.getResolutionForZoom(b):<span class="keyword">this</span>.getResolution();<span class="keyword">if</span>(e||<span class="literal">null</span>==<span class="keyword">this</span>.layerContainerOrigin)&#123;<span class="keyword">this</span>.layerContainerOrigin=<span class="keyword">this</span>.getCachedCenter();<span class="keyword">this</span>.layerContainerOriginPx.x=<span class="number">0</span>;<span class="keyword">this</span>.layerContainerOriginPx.y=<span class="number">0</span>;<span class="keyword">this</span>.applyTransform();<span class="keyword">var</span> f=<span class="keyword">this</span>.getMaxExtent(&#123;<span class="attr">restricted</span>:!<span class="number">0</span>&#125;),h=f.getCenterLonLat(),g=<span class="keyword">this</span>.center.lon-h.lon,h=h.lat-<span class="keyword">this</span>.center.lat,k=<span class="built_in">Math</span>.round(f.getWidth()/a),l=<span class="built_in">Math</span>.round(f.getHeight()/a);<span class="keyword">this</span>.minPx=&#123;<span class="attr">x</span>:(<span class="keyword">this</span>.size.w-k)/<span class="number">2</span>-g/a,<span class="attr">y</span>:(<span class="keyword">this</span>.size.h-l)/<span class="number">2</span>-h/a&#125;;<span class="keyword">this</span>.maxPx=&#123;<span class="attr">x</span>:<span class="keyword">this</span>.minPx.x+</span><br><span class="line"><span class="built_in">Math</span>.round(f.getWidth()/a),<span class="attr">y</span>:<span class="keyword">this</span>.minPx.y+<span class="built_in">Math</span>.round(f.getHeight()/a)&#125;&#125;e&amp;&amp;(<span class="keyword">this</span>.zoom=b,<span class="keyword">this</span>.resolution=a);a=<span class="keyword">this</span>.getExtent();<span class="keyword">this</span>.baseLayer.visibility&amp;&amp;(<span class="keyword">this</span>.baseLayer.moveTo(a,e,c.dragging),c.dragging||<span class="keyword">this</span>.baseLayer.events.triggerEvent(<span class="string">"moveend"</span>,&#123;<span class="attr">zoomChanged</span>:e&#125;));a=<span class="keyword">this</span>.baseLayer.getExtent();<span class="keyword">for</span>(b=<span class="keyword">this</span>.layers.length<span class="number">-1</span>;<span class="number">0</span>&lt;=b;--b)f=<span class="keyword">this</span>.layers[b],f===<span class="keyword">this</span>.baseLayer||f.isBaseLayer||(g=f.calculateInRange(),f.inRange!=g&amp;&amp;((f.inRange=g)||f.display(!<span class="number">1</span>),<span class="keyword">this</span>.events.triggerEvent(<span class="string">"changelayer"</span>,&#123;<span class="attr">layer</span>:f,<span class="attr">property</span>:<span class="string">"visibility"</span>&#125;)),</span><br><span class="line">g&amp;&amp;f.visibility&amp;&amp;(f.moveTo(a,e,c.dragging),c.dragging||f.events.triggerEvent(<span class="string">"moveend"</span>,&#123;<span class="attr">zoomChanged</span>:e&#125;)));<span class="keyword">this</span>.events.triggerEvent(<span class="string">"move"</span>);d||<span class="keyword">this</span>.events.triggerEvent(<span class="string">"moveend"</span>);<span class="keyword">if</span>(e)&#123;b=<span class="number">0</span>;<span class="keyword">for</span>(c=<span class="keyword">this</span>.popups.length;b&lt;c;b++)<span class="keyword">this</span>.popups[b].updatePosition();<span class="keyword">this</span>.events.triggerEvent(<span class="string">"zoomend"</span>)&#125;&#125;&#125;,<span class="attr">centerLayerContainer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getViewPortPxFromLonLat(<span class="keyword">this</span>.layerContainerOrigin),c=<span class="keyword">this</span>.getViewPortPxFromLonLat(a);<span class="keyword">if</span>(<span class="literal">null</span>!=b&amp;&amp;<span class="literal">null</span>!=c)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.layerContainerOriginPx.x;a=<span class="keyword">this</span>.layerContainerOriginPx.y;</span><br><span class="line"><span class="keyword">var</span> e=<span class="built_in">Math</span>.round(b.x-c.x),b=<span class="built_in">Math</span>.round(b.y-c.y);<span class="keyword">this</span>.applyTransform(<span class="keyword">this</span>.layerContainerOriginPx.x=e,<span class="keyword">this</span>.layerContainerOriginPx.y=b);d-=e;a-=b;<span class="keyword">this</span>.minPx.x-=d;<span class="keyword">this</span>.maxPx.x-=d;<span class="keyword">this</span>.minPx.y-=a;<span class="keyword">this</span>.maxPx.y-=a&#125;&#125;,<span class="attr">isValidZoomLevel</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="literal">null</span>!=a&amp;&amp;<span class="number">0</span>&lt;=a&amp;&amp;a&lt;<span class="keyword">this</span>.getNumZoomLevels()&#125;,<span class="attr">isValidLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;<span class="literal">null</span>!=a&amp;&amp;(b=<span class="keyword">this</span>.getMaxExtent(),b=b.containsLonLat(a,&#123;<span class="attr">worldBounds</span>:<span class="keyword">this</span>.baseLayer.wrapDateLine&amp;&amp;b&#125;));<span class="keyword">return</span> b&#125;,<span class="attr">getProjection</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.getProjectionObject();<span class="keyword">return</span> a?a.getCode():</span><br><span class="line"><span class="literal">null</span>&#125;,<span class="attr">getProjectionObject</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.baseLayer&amp;&amp;(a=<span class="keyword">this</span>.baseLayer.projection);<span class="keyword">return</span> a&#125;,<span class="attr">getMaxResolution</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.baseLayer&amp;&amp;(a=<span class="keyword">this</span>.baseLayer.maxResolution);<span class="keyword">return</span> a&#125;,<span class="attr">getMaxExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;a&amp;&amp;a.restricted&amp;&amp;<span class="keyword">this</span>.restrictedExtent?b=<span class="keyword">this</span>.restrictedExtent:<span class="literal">null</span>!=<span class="keyword">this</span>.baseLayer&amp;&amp;(b=<span class="keyword">this</span>.baseLayer.maxExtent);<span class="keyword">return</span> b&#125;,<span class="attr">getNumZoomLevels</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.baseLayer&amp;&amp;(a=<span class="keyword">this</span>.baseLayer.numZoomLevels);<span class="keyword">return</span> a&#125;,<span class="attr">getExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=</span><br><span class="line"><span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.baseLayer&amp;&amp;(a=<span class="keyword">this</span>.baseLayer.getExtent());<span class="keyword">return</span> a&#125;,<span class="attr">getResolution</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.baseLayer?a=<span class="keyword">this</span>.baseLayer.getResolution():!<span class="number">0</span>===<span class="keyword">this</span>.allOverlays&amp;&amp;<span class="number">0</span>&lt;<span class="keyword">this</span>.layers.length&amp;&amp;(a=<span class="keyword">this</span>.layers[<span class="number">0</span>].getResolution());<span class="keyword">return</span> a&#125;,<span class="attr">getUnits</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.baseLayer&amp;&amp;(a=<span class="keyword">this</span>.baseLayer.units);<span class="keyword">return</span> a&#125;,<span class="attr">getScale</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.baseLayer&amp;&amp;(a=<span class="keyword">this</span>.getResolution(),a=OpenLayers.Util.getScaleFromResolution(a,<span class="keyword">this</span>.baseLayer.units));<span class="keyword">return</span> a&#125;,<span class="attr">getZoomForExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.baseLayer&amp;&amp;(c=<span class="keyword">this</span>.baseLayer.getZoomForExtent(a,b));<span class="keyword">return</span> c&#125;,<span class="attr">getResolutionForZoom</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="keyword">this</span>.baseLayer&amp;&amp;(b=<span class="keyword">this</span>.baseLayer.getResolutionForZoom(a));<span class="keyword">return</span> b&#125;,<span class="attr">getZoomForResolution</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.baseLayer&amp;&amp;(c=<span class="keyword">this</span>.baseLayer.getZoomForResolution(a,b));<span class="keyword">return</span> c&#125;,<span class="attr">zoomTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>;<span class="keyword">if</span>(c.isValidZoomLevel(a))<span class="keyword">if</span>(c.baseLayer.wrapDateLine&amp;&amp;(a=c.adjustZoom(a)),c.zoomTween)&#123;<span class="keyword">var</span> d=c.getResolution(),e=c.getResolutionForZoom(a),f=&#123;<span class="attr">scale</span>:<span class="number">1</span>&#125;,</span><br><span class="line">d=&#123;<span class="attr">scale</span>:d/e&#125;;c.zoomTween.playing&amp;&amp;c.zoomTween.duration&lt;<span class="number">3</span>*c.zoomDuration?c.zoomTween.finish=&#123;<span class="attr">scale</span>:c.zoomTween.finish.scale*d.scale&#125;:(b||(e=c.getSize(),b=&#123;<span class="attr">x</span>:e.w/<span class="number">2</span>,<span class="attr">y</span>:e.h/<span class="number">2</span>&#125;),c.zoomTween.start(f,d,c.zoomDuration,&#123;<span class="attr">minFrameRate</span>:<span class="number">50</span>,<span class="attr">callbacks</span>:&#123;<span class="attr">eachStep</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> d=c.layerContainerOriginPx;a=a.scale;c.applyTransform(d.x+((a<span class="number">-1</span>)*(d.x-b.x)|<span class="number">0</span>),d.y+((a<span class="number">-1</span>)*(d.y-b.y)|<span class="number">0</span>),a)&#125;,<span class="attr">done</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;c.applyTransform();a=c.getResolution()/a.scale;<span class="keyword">var</span> d=c.getZoomForResolution(a,!<span class="number">0</span>);c.moveTo(c.getZoomTargetCenter(b,</span><br><span class="line">a),d,!<span class="number">0</span>)&#125;&#125;&#125;))&#125;<span class="keyword">else</span> f=b?c.getZoomTargetCenter(b,c.getResolutionForZoom(a)):<span class="literal">null</span>,c.setCenter(f,a)&#125;,<span class="attr">zoomIn</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.zoomTo(<span class="keyword">this</span>.getZoom()+<span class="number">1</span>)&#125;,<span class="attr">zoomOut</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.zoomTo(<span class="keyword">this</span>.getZoom()<span class="number">-1</span>)&#125;,<span class="attr">zoomToExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a <span class="keyword">instanceof</span> OpenLayers.Bounds||(a=<span class="keyword">new</span> OpenLayers.Bounds(a));<span class="keyword">var</span> c=a.getCenterLonLat();<span class="keyword">if</span>(<span class="keyword">this</span>.baseLayer.wrapDateLine)&#123;c=<span class="keyword">this</span>.getMaxExtent();<span class="keyword">for</span>(a=a.clone();a.right&lt;a.left;)a.right+=c.getWidth();c=a.getCenterLonLat().wrapDateLine(c)&#125;<span class="keyword">this</span>.setCenter(c,<span class="keyword">this</span>.getZoomForExtent(a,b))&#125;,</span><br><span class="line">zoomToMaxExtent:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.getMaxExtent(&#123;<span class="attr">restricted</span>:a?a.restricted:!<span class="number">0</span>&#125;);<span class="keyword">this</span>.zoomToExtent(a)&#125;,<span class="attr">zoomToScale</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Util.getResolutionFromScale(a,<span class="keyword">this</span>.baseLayer.units),d=<span class="keyword">this</span>.size.w*c/<span class="number">2</span>,c=<span class="keyword">this</span>.size.h*c/<span class="number">2</span>,e=<span class="keyword">this</span>.getCachedCenter(),d=<span class="keyword">new</span> OpenLayers.Bounds(e.lon-d,e.lat-c,e.lon+d,e.lat+c);<span class="keyword">this</span>.zoomToExtent(d,b)&#125;,<span class="attr">getLonLatFromViewPortPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.baseLayer&amp;&amp;(b=<span class="keyword">this</span>.baseLayer.getLonLatFromViewPortPx(a));<span class="keyword">return</span> b&#125;,<span class="attr">getViewPortPxFromLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.baseLayer&amp;&amp;(b=<span class="keyword">this</span>.baseLayer.getViewPortPxFromLonLat(a));<span class="keyword">return</span> b&#125;,<span class="attr">getZoomTargetCenter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>,d=<span class="keyword">this</span>.getSize(),e=d.w/<span class="number">2</span>-a.x,d=a.y-d.h/<span class="number">2</span>,f=<span class="keyword">this</span>.getLonLatFromPixel(a);f&amp;&amp;(c=<span class="keyword">new</span> OpenLayers.LonLat(f.lon+e*b,f.lat+d*b));<span class="keyword">return</span> c&#125;,<span class="attr">getLonLatFromPixel</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.getLonLatFromViewPortPx(a)&#125;,<span class="attr">getPixelFromLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.getViewPortPxFromLonLat(a);a.x=<span class="built_in">Math</span>.round(a.x);a.y=<span class="built_in">Math</span>.round(a.y);<span class="keyword">return</span> a&#125;,<span class="attr">getGeodesicPixelSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a?<span class="keyword">this</span>.getLonLatFromPixel(a):</span><br><span class="line"><span class="keyword">this</span>.getCachedCenter()||<span class="keyword">new</span> OpenLayers.LonLat(<span class="number">0</span>,<span class="number">0</span>),c=<span class="keyword">this</span>.getResolution();a=b.add(-c/<span class="number">2</span>,<span class="number">0</span>);<span class="keyword">var</span> d=b.add(c/<span class="number">2</span>,<span class="number">0</span>),e=b.add(<span class="number">0</span>,-c/<span class="number">2</span>),b=b.add(<span class="number">0</span>,c/<span class="number">2</span>),c=<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>),f=<span class="keyword">this</span>.getProjectionObject()||c;f.equals(c)||(a.transform(f,c),d.transform(f,c),e.transform(f,c),b.transform(f,c));<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Size(OpenLayers.Util.distVincenty(a,d),OpenLayers.Util.distVincenty(e,b))&#125;,<span class="attr">getViewPortPxFromLayerPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="literal">null</span>!=a&amp;&amp;(b=a.add(<span class="keyword">this</span>.layerContainerOriginPx.x,<span class="keyword">this</span>.layerContainerOriginPx.y));</span><br><span class="line"><span class="keyword">return</span> b&#125;,<span class="attr">getLayerPxFromViewPortPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="literal">null</span>!=a&amp;&amp;(b=a.add(-<span class="keyword">this</span>.layerContainerOriginPx.x,-<span class="keyword">this</span>.layerContainerOriginPx.y),<span class="built_in">isNaN</span>(b.x)||<span class="built_in">isNaN</span>(b.y))&amp;&amp;(b=<span class="literal">null</span>);<span class="keyword">return</span> b&#125;,<span class="attr">getLonLatFromLayerPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.getViewPortPxFromLayerPx(a);<span class="keyword">return</span> <span class="keyword">this</span>.getLonLatFromViewPortPx(a)&#125;,<span class="attr">getLayerPxFromLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.getPixelFromLonLat(a);<span class="keyword">return</span> <span class="keyword">this</span>.getLayerPxFromViewPortPx(a)&#125;,<span class="attr">applyTransform</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;c=c||<span class="number">1</span>;<span class="keyword">var</span> d=<span class="keyword">this</span>.layerContainerOriginPx,e=<span class="number">1</span>!==c;a=a||d.x;b=b||d.y;<span class="keyword">var</span> f=<span class="keyword">this</span>.layerContainerDiv.style,</span><br><span class="line">g=<span class="keyword">this</span>.applyTransform.transform,h=<span class="keyword">this</span>.applyTransform.template;<span class="keyword">if</span>(<span class="keyword">void</span> <span class="number">0</span>===g&amp;&amp;(g=OpenLayers.Util.vendorPrefix.style(<span class="string">"transform"</span>),<span class="keyword">this</span>.applyTransform.transform=g))&#123;<span class="keyword">var</span> k=OpenLayers.Element.getStyle(<span class="keyword">this</span>.viewPortDiv,OpenLayers.Util.vendorPrefix.css(<span class="string">"transform"</span>));k&amp;&amp;<span class="string">"none"</span>===k||(h=[<span class="string">"translate3d("</span>,<span class="string">",0) "</span>,<span class="string">"scale3d("</span>,<span class="string">",1)"</span>],f[g]=[h[<span class="number">0</span>],<span class="string">"0,0"</span>,h[<span class="number">1</span>]].join(<span class="string">""</span>));h&amp;&amp;~f[g].indexOf(h[<span class="number">0</span>])||(h=[<span class="string">"translate("</span>,<span class="string">") "</span>,<span class="string">"scale("</span>,<span class="string">")"</span>]);<span class="keyword">this</span>.applyTransform.template=h&#125;<span class="literal">null</span>===g||<span class="string">"translate3d("</span>!==h[<span class="number">0</span>]&amp;&amp;!<span class="number">0</span>!==e?(f.left=a+<span class="string">"px"</span>,f.top=</span><br><span class="line">b+<span class="string">"px"</span>,<span class="literal">null</span>!==g&amp;&amp;(f[g]=<span class="string">""</span>)):(!<span class="number">0</span>===e&amp;&amp;<span class="string">"translate("</span>===h[<span class="number">0</span>]&amp;&amp;(a-=d.x,b-=d.y,f.left=d.x+<span class="string">"px"</span>,f.top=d.y+<span class="string">"px"</span>),f[g]=[h[<span class="number">0</span>],a,<span class="string">"px,"</span>,b,<span class="string">"px"</span>,h[<span class="number">1</span>],h[<span class="number">2</span>],c,<span class="string">","</span>,c,h[<span class="number">3</span>]].join(<span class="string">""</span>))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Map"</span>&#125;);OpenLayers.Map.TILE_WIDTH=<span class="number">256</span>;OpenLayers.Map.TILE_HEIGHT=<span class="number">256</span>;OpenLayers.Handler=OpenLayers.Class(&#123;<span class="attr">id</span>:<span class="literal">null</span>,<span class="attr">control</span>:<span class="literal">null</span>,<span class="attr">map</span>:<span class="literal">null</span>,<span class="attr">keyMask</span>:<span class="literal">null</span>,<span class="attr">active</span>:!<span class="number">1</span>,<span class="attr">evt</span>:<span class="literal">null</span>,<span class="attr">touch</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,c);<span class="keyword">this</span>.control=a;<span class="keyword">this</span>.callbacks=b;(a=<span class="keyword">this</span>.map||a.map)&amp;&amp;<span class="keyword">this</span>.setMap(a);<span class="keyword">this</span>.id=OpenLayers.Util.createUniqueID(<span class="keyword">this</span>.CLASS_NAME+<span class="string">"_"</span>)&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.map=a&#125;,<span class="attr">checkModifiers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="literal">null</span>==<span class="keyword">this</span>.keyMask?!<span class="number">0</span>:((a.shiftKey?OpenLayers.Handler.MOD_SHIFT:<span class="number">0</span>)|(a.ctrlKey?OpenLayers.Handler.MOD_CTRL:<span class="number">0</span>)|(a.altKey?OpenLayers.Handler.MOD_ALT:</span><br><span class="line"><span class="number">0</span>)|(a.metaKey?OpenLayers.Handler.MOD_META:<span class="number">0</span>))==<span class="keyword">this</span>.keyMask&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.active)<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">for</span>(<span class="keyword">var</span> a=OpenLayers.Events.prototype.BROWSER_EVENTS,b=<span class="number">0</span>,c=a.length;b&lt;c;b++)<span class="keyword">this</span>[a[b]]&amp;&amp;<span class="keyword">this</span>.register(a[b],<span class="keyword">this</span>[a[b]]);<span class="keyword">return</span> <span class="keyword">this</span>.active=!<span class="number">0</span>&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.active)<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">for</span>(<span class="keyword">var</span> a=OpenLayers.Events.prototype.BROWSER_EVENTS,b=<span class="number">0</span>,c=a.length;b&lt;c;b++)<span class="keyword">this</span>[a[b]]&amp;&amp;<span class="keyword">this</span>.unregister(a[b],<span class="keyword">this</span>[a[b]]);<span class="keyword">this</span>.active=<span class="keyword">this</span>.touch=!<span class="number">1</span>;<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">startTouch</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.touch)&#123;<span class="keyword">this</span>.touch=!<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="string">"mousedown mouseup mousemove click dblclick mouseout"</span>.split(<span class="string">" "</span>),b=<span class="number">0</span>,c=a.length;b&lt;c;b++)<span class="keyword">this</span>[a[b]]&amp;&amp;<span class="keyword">this</span>.unregister(a[b],<span class="keyword">this</span>[a[b]])&#125;&#125;,<span class="attr">callback</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a&amp;&amp;<span class="keyword">this</span>.callbacks[a]&amp;&amp;<span class="keyword">this</span>.callbacks[a].apply(<span class="keyword">this</span>.control,b)&#125;,<span class="attr">register</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.map.events.registerPriority(a,<span class="keyword">this</span>,b);<span class="keyword">this</span>.map.events.registerPriority(a,<span class="keyword">this</span>,<span class="keyword">this</span>.setEvent)&#125;,<span class="attr">unregister</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.map.events.unregister(a,<span class="keyword">this</span>,b);<span class="keyword">this</span>.map.events.unregister(a,<span class="keyword">this</span>,<span class="keyword">this</span>.setEvent)&#125;,<span class="attr">setEvent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.evt=a;<span class="keyword">return</span>!<span class="number">0</span>&#125;,</span><br><span class="line">destroy:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.deactivate();<span class="keyword">this</span>.control=<span class="keyword">this</span>.map=<span class="literal">null</span>&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Handler"</span>&#125;);OpenLayers.Handler.MOD_NONE=<span class="number">0</span>;OpenLayers.Handler.MOD_SHIFT=<span class="number">1</span>;OpenLayers.Handler.MOD_CTRL=<span class="number">2</span>;OpenLayers.Handler.MOD_ALT=<span class="number">4</span>;OpenLayers.Handler.MOD_META=<span class="number">8</span>;OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,&#123;<span class="attr">delay</span>:<span class="number">300</span>,<span class="attr">single</span>:!<span class="number">0</span>,<span class="string">"double"</span>:!<span class="number">1</span>,<span class="attr">pixelTolerance</span>:<span class="number">0</span>,<span class="attr">dblclickTolerance</span>:<span class="number">13</span>,<span class="attr">stopSingle</span>:!<span class="number">1</span>,<span class="attr">stopDouble</span>:!<span class="number">1</span>,<span class="attr">timerId</span>:<span class="literal">null</span>,<span class="attr">down</span>:<span class="literal">null</span>,<span class="attr">last</span>:<span class="literal">null</span>,<span class="attr">first</span>:<span class="literal">null</span>,<span class="attr">rightclickTimerId</span>:<span class="literal">null</span>,<span class="attr">touchstart</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.startTouch();<span class="keyword">this</span>.down=<span class="keyword">this</span>.getEventInfo(a);<span class="keyword">this</span>.last=<span class="keyword">this</span>.getEventInfo(a);<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">touchmove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.last=<span class="keyword">this</span>.getEventInfo(a);<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">touchend</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.down&amp;&amp;(a.xy=<span class="keyword">this</span>.last.xy,a.lastTouches=<span class="keyword">this</span>.last.touches,<span class="keyword">this</span>.handleSingle(a),</span><br><span class="line"><span class="keyword">this</span>.down=<span class="literal">null</span>);<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">mousedown</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.down=<span class="keyword">this</span>.getEventInfo(a);<span class="keyword">this</span>.last=<span class="keyword">this</span>.getEventInfo(a);<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">mouseup</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">0</span>;<span class="keyword">this</span>.checkModifiers(a)&amp;&amp;(<span class="keyword">this</span>.control.handleRightClicks&amp;&amp;OpenLayers.Event.isRightClick(a))&amp;&amp;(b=<span class="keyword">this</span>.rightclick(a));<span class="keyword">return</span> b&#125;,<span class="attr">rightclick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.passesTolerance(a))&#123;<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.rightclickTimerId)<span class="keyword">return</span> <span class="keyword">this</span>.clearTimer(),<span class="keyword">this</span>.callback(<span class="string">"dblrightclick"</span>,[a]),!<span class="keyword">this</span>.stopDouble;a=<span class="keyword">this</span>[<span class="string">"double"</span>]?OpenLayers.Util.extend(&#123;&#125;,a):<span class="keyword">this</span>.callback(<span class="string">"rightclick"</span>,</span><br><span class="line">[a]);a=OpenLayers.Function.bind(<span class="keyword">this</span>.delayedRightCall,<span class="keyword">this</span>,a);<span class="keyword">this</span>.rightclickTimerId=<span class="built_in">window</span>.setTimeout(a,<span class="keyword">this</span>.delay)&#125;<span class="keyword">return</span>!<span class="keyword">this</span>.stopSingle&#125;,<span class="attr">delayedRightCall</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.rightclickTimerId=<span class="literal">null</span>;a&amp;&amp;<span class="keyword">this</span>.callback(<span class="string">"rightclick"</span>,[a])&#125;,<span class="attr">click</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.last||(<span class="keyword">this</span>.last=<span class="keyword">this</span>.getEventInfo(a));<span class="keyword">this</span>.handleSingle(a);<span class="keyword">return</span>!<span class="keyword">this</span>.stopSingle&#125;,<span class="attr">dblclick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.handleDouble(a);<span class="keyword">return</span>!<span class="keyword">this</span>.stopDouble&#125;,<span class="attr">handleDouble</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.passesDblclickTolerance(a)&amp;&amp;(<span class="keyword">this</span>[<span class="string">"double"</span>]&amp;&amp;<span class="keyword">this</span>.callback(<span class="string">"dblclick"</span>,</span><br><span class="line">[a]),<span class="keyword">this</span>.clearTimer())&#125;,<span class="attr">handleSingle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.passesTolerance(a)&amp;&amp;(<span class="literal">null</span>!=<span class="keyword">this</span>.timerId?(<span class="keyword">this</span>.last.touches&amp;&amp;<span class="number">1</span>===<span class="keyword">this</span>.last.touches.length&amp;&amp;(<span class="keyword">this</span>[<span class="string">"double"</span>]&amp;&amp;OpenLayers.Event.preventDefault(a),<span class="keyword">this</span>.handleDouble(a)),<span class="keyword">this</span>.last.touches&amp;&amp;<span class="number">2</span>===<span class="keyword">this</span>.last.touches.length||<span class="keyword">this</span>.clearTimer()):(<span class="keyword">this</span>.first=<span class="keyword">this</span>.getEventInfo(a),a=<span class="keyword">this</span>.single?OpenLayers.Util.extend(&#123;&#125;,a):<span class="literal">null</span>,<span class="keyword">this</span>.queuePotentialClick(a)))&#125;,<span class="attr">queuePotentialClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.timerId=<span class="built_in">window</span>.setTimeout(OpenLayers.Function.bind(<span class="keyword">this</span>.delayedCall,</span><br><span class="line"><span class="keyword">this</span>,a),<span class="keyword">this</span>.delay)&#125;,<span class="attr">passesTolerance</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">0</span>;<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.pixelTolerance&amp;&amp;<span class="keyword">this</span>.down&amp;&amp;<span class="keyword">this</span>.down.xy&amp;&amp;(b=<span class="keyword">this</span>.pixelTolerance&gt;=<span class="keyword">this</span>.down.xy.distanceTo(a.xy))&amp;&amp;<span class="keyword">this</span>.touch&amp;&amp;<span class="keyword">this</span>.down.touches.length===<span class="keyword">this</span>.last.touches.length)&#123;a=<span class="number">0</span>;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="keyword">this</span>.down.touches.length;a&lt;c;++a)<span class="keyword">if</span>(<span class="keyword">this</span>.getTouchDistance(<span class="keyword">this</span>.down.touches[a],<span class="keyword">this</span>.last.touches[a])&gt;<span class="keyword">this</span>.pixelTolerance)&#123;b=!<span class="number">1</span>;<span class="keyword">break</span>&#125;&#125;<span class="keyword">return</span> b&#125;,<span class="attr">getTouchDistance</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(a.clientX-b.clientX,<span class="number">2</span>)+<span class="built_in">Math</span>.pow(a.clientY-b.clientY,</span><br><span class="line"><span class="number">2</span>))&#125;,<span class="attr">passesDblclickTolerance</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=!<span class="number">0</span>;<span class="keyword">this</span>.down&amp;&amp;<span class="keyword">this</span>.first&amp;&amp;(a=<span class="keyword">this</span>.down.xy.distanceTo(<span class="keyword">this</span>.first.xy)&lt;=<span class="keyword">this</span>.dblclickTolerance);<span class="keyword">return</span> a&#125;,<span class="attr">clearTimer</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="literal">null</span>!=<span class="keyword">this</span>.timerId&amp;&amp;(<span class="built_in">window</span>.clearTimeout(<span class="keyword">this</span>.timerId),<span class="keyword">this</span>.timerId=<span class="literal">null</span>);<span class="literal">null</span>!=<span class="keyword">this</span>.rightclickTimerId&amp;&amp;(<span class="built_in">window</span>.clearTimeout(<span class="keyword">this</span>.rightclickTimerId),<span class="keyword">this</span>.rightclickTimerId=<span class="literal">null</span>)&#125;,<span class="attr">delayedCall</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.timerId=<span class="literal">null</span>;a&amp;&amp;<span class="keyword">this</span>.callback(<span class="string">"click"</span>,[a])&#125;,<span class="attr">getEventInfo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;<span class="keyword">if</span>(a.touches)&#123;<span class="keyword">var</span> c=a.touches.length;b=<span class="built_in">Array</span>(c);<span class="keyword">for</span>(<span class="keyword">var</span> d,</span><br><span class="line">e=<span class="number">0</span>;e&lt;c;e++)d=a.touches[e],b[e]=&#123;<span class="attr">clientX</span>:d.olClientX,<span class="attr">clientY</span>:d.olClientY&#125;&#125;<span class="keyword">return</span>&#123;<span class="attr">xy</span>:a.xy,<span class="attr">touches</span>:b&#125;&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;OpenLayers.Handler.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&amp;&amp;(<span class="keyword">this</span>.clearTimer(),<span class="keyword">this</span>.last=<span class="keyword">this</span>.first=<span class="keyword">this</span>.down=<span class="literal">null</span>,a=!<span class="number">0</span>);<span class="keyword">return</span> a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Handler.Click"</span>&#125;);OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,&#123;<span class="attr">started</span>:!<span class="number">1</span>,<span class="attr">stopDown</span>:!<span class="number">0</span>,<span class="attr">dragging</span>:!<span class="number">1</span>,<span class="attr">last</span>:<span class="literal">null</span>,<span class="attr">start</span>:<span class="literal">null</span>,<span class="attr">lastMoveEvt</span>:<span class="literal">null</span>,<span class="attr">oldOnselectstart</span>:<span class="literal">null</span>,<span class="attr">interval</span>:<span class="number">0</span>,<span class="attr">timeoutId</span>:<span class="literal">null</span>,<span class="attr">documentDrag</span>:!<span class="number">1</span>,<span class="attr">documentEvents</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Handler.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">if</span>(!<span class="number">0</span>===<span class="keyword">this</span>.documentDrag)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>;<span class="keyword">this</span>._docMove=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;d.mousemove(&#123;<span class="attr">xy</span>:&#123;<span class="attr">x</span>:a.clientX,<span class="attr">y</span>:a.clientY&#125;,<span class="attr">element</span>:<span class="built_in">document</span>&#125;)&#125;;<span class="keyword">this</span>._docUp=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;d.mouseup(&#123;<span class="attr">xy</span>:&#123;<span class="attr">x</span>:a.clientX,<span class="attr">y</span>:a.clientY&#125;&#125;)&#125;&#125;&#125;,</span><br><span class="line">dragstart:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">0</span>;<span class="keyword">this</span>.dragging=!<span class="number">1</span>;<span class="keyword">this</span>.checkModifiers(a)&amp;&amp;(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))?(<span class="keyword">this</span>.started=!<span class="number">0</span>,<span class="keyword">this</span>.last=<span class="keyword">this</span>.start=a.xy,OpenLayers.Element.addClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olDragDown"</span>),<span class="keyword">this</span>.down(a),<span class="keyword">this</span>.callback(<span class="string">"down"</span>,[a.xy]),OpenLayers.Event.preventDefault(a),<span class="keyword">this</span>.oldOnselectstart||(<span class="keyword">this</span>.oldOnselectstart=<span class="built_in">document</span>.onselectstart?<span class="built_in">document</span>.onselectstart:OpenLayers.Function.True),<span class="built_in">document</span>.onselectstart=OpenLayers.Function.False,b=!<span class="keyword">this</span>.stopDown):</span><br><span class="line">(<span class="keyword">this</span>.started=!<span class="number">1</span>,<span class="keyword">this</span>.last=<span class="keyword">this</span>.start=<span class="literal">null</span>);<span class="keyword">return</span> b&#125;,<span class="attr">dragmove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.lastMoveEvt=a;!<span class="keyword">this</span>.started||(<span class="keyword">this</span>.timeoutId||a.xy.x==<span class="keyword">this</span>.last.x&amp;&amp;a.xy.y==<span class="keyword">this</span>.last.y)||(!<span class="number">0</span>===<span class="keyword">this</span>.documentDrag&amp;&amp;<span class="keyword">this</span>.documentEvents&amp;&amp;(a.element===<span class="built_in">document</span>?(<span class="keyword">this</span>.adjustXY(a),<span class="keyword">this</span>.setEvent(a)):<span class="keyword">this</span>.removeDocumentEvents()),<span class="number">0</span>&lt;<span class="keyword">this</span>.interval&amp;&amp;(<span class="keyword">this</span>.timeoutId=setTimeout(OpenLayers.Function.bind(<span class="keyword">this</span>.removeTimeout,<span class="keyword">this</span>),<span class="keyword">this</span>.interval)),<span class="keyword">this</span>.dragging=!<span class="number">0</span>,<span class="keyword">this</span>.move(a),<span class="keyword">this</span>.callback(<span class="string">"move"</span>,[a.xy]),<span class="keyword">this</span>.oldOnselectstart||(<span class="keyword">this</span>.oldOnselectstart=</span><br><span class="line"><span class="built_in">document</span>.onselectstart,<span class="built_in">document</span>.onselectstart=OpenLayers.Function.False),<span class="keyword">this</span>.last=a.xy);<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">dragend</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.started)&#123;!<span class="number">0</span>===<span class="keyword">this</span>.documentDrag&amp;&amp;<span class="keyword">this</span>.documentEvents&amp;&amp;(<span class="keyword">this</span>.adjustXY(a),<span class="keyword">this</span>.removeDocumentEvents());<span class="keyword">var</span> b=<span class="keyword">this</span>.start!=<span class="keyword">this</span>.last;<span class="keyword">this</span>.dragging=<span class="keyword">this</span>.started=!<span class="number">1</span>;OpenLayers.Element.removeClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olDragDown"</span>);<span class="keyword">this</span>.up(a);<span class="keyword">this</span>.callback(<span class="string">"up"</span>,[a.xy]);b&amp;&amp;<span class="keyword">this</span>.callback(<span class="string">"done"</span>,[a.xy]);<span class="built_in">document</span>.onselectstart=<span class="keyword">this</span>.oldOnselectstart&#125;<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">down</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">move</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,</span><br><span class="line">up:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">out</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">mousedown</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.dragstart(a)&#125;,<span class="attr">touchstart</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.startTouch();<span class="keyword">return</span> <span class="keyword">this</span>.dragstart(a)&#125;,<span class="attr">mousemove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.dragmove(a)&#125;,<span class="attr">touchmove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.dragmove(a)&#125;,<span class="attr">removeTimeout</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.timeoutId=<span class="literal">null</span>;<span class="keyword">this</span>.dragging&amp;&amp;<span class="keyword">this</span>.mousemove(<span class="keyword">this</span>.lastMoveEvt)&#125;,<span class="attr">mouseup</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.dragend(a)&#125;,<span class="attr">touchend</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.xy=<span class="keyword">this</span>.last;<span class="keyword">return</span> <span class="keyword">this</span>.dragend(a)&#125;,<span class="attr">mouseout</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.started&amp;&amp;OpenLayers.Util.mouseLeft(a,</span><br><span class="line"><span class="keyword">this</span>.map.viewPortDiv))<span class="keyword">if</span>(!<span class="number">0</span>===<span class="keyword">this</span>.documentDrag)<span class="keyword">this</span>.addDocumentEvents();<span class="keyword">else</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.start!=<span class="keyword">this</span>.last;<span class="keyword">this</span>.dragging=<span class="keyword">this</span>.started=!<span class="number">1</span>;OpenLayers.Element.removeClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olDragDown"</span>);<span class="keyword">this</span>.out(a);<span class="keyword">this</span>.callback(<span class="string">"out"</span>,[]);b&amp;&amp;<span class="keyword">this</span>.callback(<span class="string">"done"</span>,[a.xy]);<span class="built_in">document</span>.onselectstart&amp;&amp;(<span class="built_in">document</span>.onselectstart=<span class="keyword">this</span>.oldOnselectstart)&#125;<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">click</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.start==<span class="keyword">this</span>.last&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;OpenLayers.Handler.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&amp;&amp;(<span class="keyword">this</span>.dragging=</span><br><span class="line">!<span class="number">1</span>,a=!<span class="number">0</span>);<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;OpenLayers.Handler.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&amp;&amp;(<span class="keyword">this</span>.dragging=<span class="keyword">this</span>.started=!<span class="number">1</span>,<span class="keyword">this</span>.last=<span class="keyword">this</span>.start=<span class="literal">null</span>,a=!<span class="number">0</span>,OpenLayers.Element.removeClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olDragDown"</span>));<span class="keyword">return</span> a&#125;,<span class="attr">adjustXY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Util.pagePosition(<span class="keyword">this</span>.map.viewPortDiv);a.xy.x-=b[<span class="number">0</span>];a.xy.y-=b[<span class="number">1</span>]&#125;,<span class="attr">addDocumentEvents</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Element.addClass(<span class="built_in">document</span>.body,<span class="string">"olDragDown"</span>);<span class="keyword">this</span>.documentEvents=!<span class="number">0</span>;OpenLayers.Event.observe(<span class="built_in">document</span>,<span class="string">"mousemove"</span>,</span><br><span class="line"><span class="keyword">this</span>._docMove);OpenLayers.Event.observe(<span class="built_in">document</span>,<span class="string">"mouseup"</span>,<span class="keyword">this</span>._docUp)&#125;,<span class="attr">removeDocumentEvents</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Element.removeClass(<span class="built_in">document</span>.body,<span class="string">"olDragDown"</span>);<span class="keyword">this</span>.documentEvents=!<span class="number">1</span>;OpenLayers.Event.stopObserving(<span class="built_in">document</span>,<span class="string">"mousemove"</span>,<span class="keyword">this</span>._docMove);OpenLayers.Event.stopObserving(<span class="built_in">document</span>,<span class="string">"mouseup"</span>,<span class="keyword">this</span>._docUp)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Handler.Drag"</span>&#125;);OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">element</span>:<span class="literal">null</span>,<span class="attr">ovmap</span>:<span class="literal">null</span>,<span class="attr">size</span>:&#123;<span class="attr">w</span>:<span class="number">180</span>,<span class="attr">h</span>:<span class="number">90</span>&#125;,<span class="attr">layers</span>:<span class="literal">null</span>,<span class="attr">minRectSize</span>:<span class="number">15</span>,<span class="attr">minRectDisplayClass</span>:<span class="string">"RectReplacement"</span>,<span class="attr">minRatio</span>:<span class="number">8</span>,<span class="attr">maxRatio</span>:<span class="number">32</span>,<span class="attr">mapOptions</span>:<span class="literal">null</span>,<span class="attr">autoPan</span>:!<span class="number">1</span>,<span class="attr">handlers</span>:<span class="literal">null</span>,<span class="attr">resolutionFactor</span>:<span class="number">1</span>,<span class="attr">maximized</span>:!<span class="number">1</span>,<span class="attr">maximizeTitle</span>:<span class="string">""</span>,<span class="attr">minimizeTitle</span>:<span class="string">""</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.layers=[];<span class="keyword">this</span>.handlers=&#123;&#125;;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.mapDiv&amp;&amp;(<span class="keyword">this</span>.handlers.click&amp;&amp;<span class="keyword">this</span>.handlers.click.destroy(),</span><br><span class="line"><span class="keyword">this</span>.handlers.drag&amp;&amp;<span class="keyword">this</span>.handlers.drag.destroy(),<span class="keyword">this</span>.ovmap&amp;&amp;<span class="keyword">this</span>.ovmap.viewPortDiv.removeChild(<span class="keyword">this</span>.extentRectangle),<span class="keyword">this</span>.extentRectangle=<span class="literal">null</span>,<span class="keyword">this</span>.rectEvents&amp;&amp;(<span class="keyword">this</span>.rectEvents.destroy(),<span class="keyword">this</span>.rectEvents=<span class="literal">null</span>),<span class="keyword">this</span>.ovmap&amp;&amp;(<span class="keyword">this</span>.ovmap.destroy(),<span class="keyword">this</span>.ovmap=<span class="literal">null</span>),<span class="keyword">this</span>.element.removeChild(<span class="keyword">this</span>.mapDiv),<span class="keyword">this</span>.mapDiv=<span class="literal">null</span>,<span class="keyword">this</span>.div.removeChild(<span class="keyword">this</span>.element),<span class="keyword">this</span>.element=<span class="literal">null</span>,<span class="keyword">this</span>.maximizeDiv&amp;&amp;(<span class="keyword">this</span>.div.removeChild(<span class="keyword">this</span>.maximizeDiv),<span class="keyword">this</span>.maximizeDiv=<span class="literal">null</span>),<span class="keyword">this</span>.minimizeDiv&amp;&amp;(<span class="keyword">this</span>.div.removeChild(<span class="keyword">this</span>.minimizeDiv),</span><br><span class="line"><span class="keyword">this</span>.minimizeDiv=<span class="literal">null</span>),<span class="keyword">this</span>.map.events.un(&#123;<span class="attr">buttonclick</span>:<span class="keyword">this</span>.onButtonClick,<span class="attr">moveend</span>:<span class="keyword">this</span>.update,<span class="attr">changebaselayer</span>:<span class="keyword">this</span>.baseLayerDraw,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;),OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>))&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Control.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">if</span>(<span class="number">0</span>===<span class="keyword">this</span>.layers.length)<span class="keyword">if</span>(<span class="keyword">this</span>.map.baseLayer)<span class="keyword">this</span>.layers=[<span class="keyword">this</span>.map.baseLayer.clone()];<span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">this</span>.map.events.register(<span class="string">"changebaselayer"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.baseLayerDraw),<span class="keyword">this</span>.div;<span class="keyword">this</span>.element=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);<span class="keyword">this</span>.element.className=</span><br><span class="line"><span class="keyword">this</span>.displayClass+<span class="string">"Element"</span>;<span class="keyword">this</span>.element.style.display=<span class="string">"none"</span>;<span class="keyword">this</span>.mapDiv=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);<span class="keyword">this</span>.mapDiv.style.width=<span class="keyword">this</span>.size.w+<span class="string">"px"</span>;<span class="keyword">this</span>.mapDiv.style.height=<span class="keyword">this</span>.size.h+<span class="string">"px"</span>;<span class="keyword">this</span>.mapDiv.style.position=<span class="string">"relative"</span>;<span class="keyword">this</span>.mapDiv.style.overflow=<span class="string">"hidden"</span>;<span class="keyword">this</span>.mapDiv.id=OpenLayers.Util.createUniqueID(<span class="string">"overviewMap"</span>);<span class="keyword">this</span>.extentRectangle=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);<span class="keyword">this</span>.extentRectangle.style.position=<span class="string">"absolute"</span>;<span class="keyword">this</span>.extentRectangle.style.zIndex=<span class="number">1E3</span>;<span class="keyword">this</span>.extentRectangle.className=<span class="keyword">this</span>.displayClass+</span><br><span class="line"><span class="string">"ExtentRectangle"</span>;<span class="keyword">this</span>.element.appendChild(<span class="keyword">this</span>.mapDiv);<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.element);<span class="keyword">if</span>(<span class="keyword">this</span>.outsideViewport)<span class="keyword">this</span>.element.style.display=<span class="string">""</span>;<span class="keyword">else</span>&#123;<span class="keyword">this</span>.div.className+=<span class="string">" "</span>+<span class="keyword">this</span>.displayClass+<span class="string">"Container"</span>;<span class="keyword">var</span> a=OpenLayers.Util.getImageLocation(<span class="string">"layer-switcher-maximize.png"</span>);<span class="keyword">this</span>.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(<span class="keyword">this</span>.displayClass+<span class="string">"MaximizeButton"</span>,<span class="literal">null</span>,<span class="literal">null</span>,a,<span class="string">"absolute"</span>);<span class="keyword">this</span>.maximizeDiv.style.display=<span class="string">"none"</span>;<span class="keyword">this</span>.maximizeDiv.className=<span class="keyword">this</span>.displayClass+<span class="string">"MaximizeButton olButton"</span>;<span class="keyword">this</span>.maximizeTitle&amp;&amp;</span><br><span class="line">(<span class="keyword">this</span>.maximizeDiv.title=<span class="keyword">this</span>.maximizeTitle);<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.maximizeDiv);a=OpenLayers.Util.getImageLocation(<span class="string">"layer-switcher-minimize.png"</span>);<span class="keyword">this</span>.minimizeDiv=OpenLayers.Util.createAlphaImageDiv(<span class="string">"OpenLayers_Control_minimizeDiv"</span>,<span class="literal">null</span>,<span class="literal">null</span>,a,<span class="string">"absolute"</span>);<span class="keyword">this</span>.minimizeDiv.style.display=<span class="string">"none"</span>;<span class="keyword">this</span>.minimizeDiv.className=<span class="keyword">this</span>.displayClass+<span class="string">"MinimizeButton olButton"</span>;<span class="keyword">this</span>.minimizeTitle&amp;&amp;(<span class="keyword">this</span>.minimizeDiv.title=<span class="keyword">this</span>.minimizeTitle);<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.minimizeDiv);<span class="keyword">this</span>.minimizeControl()&#125;<span class="keyword">this</span>.map.getExtent()&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.update();<span class="keyword">this</span>.map.events.on(&#123;<span class="attr">buttonclick</span>:<span class="keyword">this</span>.onButtonClick,<span class="attr">moveend</span>:<span class="keyword">this</span>.update,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">this</span>.maximized&amp;&amp;<span class="keyword">this</span>.maximizeControl();<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">baseLayerDraw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.draw();<span class="keyword">this</span>.map.events.unregister(<span class="string">"changebaselayer"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.baseLayerDraw)&#125;,<span class="attr">rectDrag</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.handlers.drag.last.x-a.x,c=<span class="keyword">this</span>.handlers.drag.last.y-a.y;<span class="keyword">if</span>(<span class="number">0</span>!=b||<span class="number">0</span>!=c)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.rectPxBounds.top,e=<span class="keyword">this</span>.rectPxBounds.left;a=<span class="built_in">Math</span>.abs(<span class="keyword">this</span>.rectPxBounds.getHeight());<span class="keyword">var</span> f=<span class="keyword">this</span>.rectPxBounds.getWidth(),c=<span class="built_in">Math</span>.max(<span class="number">0</span>,</span><br><span class="line">d-c),c=<span class="built_in">Math</span>.min(c,<span class="keyword">this</span>.ovmap.size.h-<span class="keyword">this</span>.hComp-a),b=<span class="built_in">Math</span>.max(<span class="number">0</span>,e-b),b=<span class="built_in">Math</span>.min(b,<span class="keyword">this</span>.ovmap.size.w-<span class="keyword">this</span>.wComp-f);<span class="keyword">this</span>.setRectPxBounds(<span class="keyword">new</span> OpenLayers.Bounds(b,c+a,b+f,c))&#125;&#125;,<span class="attr">mapDivClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.rectPxBounds.getCenterPixel(),c=a.xy.x-b.x,d=a.xy.y-b.y,e=<span class="keyword">this</span>.rectPxBounds.top,f=<span class="keyword">this</span>.rectPxBounds.left;a=<span class="built_in">Math</span>.abs(<span class="keyword">this</span>.rectPxBounds.getHeight());b=<span class="keyword">this</span>.rectPxBounds.getWidth();d=<span class="built_in">Math</span>.max(<span class="number">0</span>,e+d);d=<span class="built_in">Math</span>.min(d,<span class="keyword">this</span>.ovmap.size.h-a);c=<span class="built_in">Math</span>.max(<span class="number">0</span>,f+c);c=<span class="built_in">Math</span>.min(c,<span class="keyword">this</span>.ovmap.size.w-b);<span class="keyword">this</span>.setRectPxBounds(<span class="keyword">new</span> OpenLayers.Bounds(c,</span><br><span class="line">d+a,c+b,d));<span class="keyword">this</span>.updateMapToRect()&#125;,<span class="attr">onButtonClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.buttonElement===<span class="keyword">this</span>.minimizeDiv?<span class="keyword">this</span>.minimizeControl():a.buttonElement===<span class="keyword">this</span>.maximizeDiv&amp;&amp;<span class="keyword">this</span>.maximizeControl()&#125;,<span class="attr">maximizeControl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.element.style.display=<span class="string">""</span>;<span class="keyword">this</span>.showToggle(!<span class="number">1</span>);<span class="literal">null</span>!=a&amp;&amp;OpenLayers.Event.stop(a)&#125;,<span class="attr">minimizeControl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.element.style.display=<span class="string">"none"</span>;<span class="keyword">this</span>.showToggle(!<span class="number">0</span>);<span class="literal">null</span>!=a&amp;&amp;OpenLayers.Event.stop(a)&#125;,<span class="attr">showToggle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.maximizeDiv&amp;&amp;(<span class="keyword">this</span>.maximizeDiv.style.display=a?<span class="string">""</span>:<span class="string">"none"</span>);<span class="keyword">this</span>.minimizeDiv&amp;&amp;</span><br><span class="line">(<span class="keyword">this</span>.minimizeDiv.style.display=a?<span class="string">"none"</span>:<span class="string">""</span>)&#125;,<span class="attr">update</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="literal">null</span>==<span class="keyword">this</span>.ovmap&amp;&amp;<span class="keyword">this</span>.createMap();!<span class="keyword">this</span>.autoPan&amp;&amp;<span class="keyword">this</span>.isSuitableOverview()||<span class="keyword">this</span>.updateOverview();<span class="keyword">this</span>.updateRectToMap()&#125;,<span class="attr">isSuitableOverview</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getExtent(),b=<span class="keyword">this</span>.map.getMaxExtent(),a=<span class="keyword">new</span> OpenLayers.Bounds(<span class="built_in">Math</span>.max(a.left,b.left),<span class="built_in">Math</span>.max(a.bottom,b.bottom),<span class="built_in">Math</span>.min(a.right,b.right),<span class="built_in">Math</span>.min(a.top,b.top));<span class="keyword">this</span>.ovmap.getProjection()!=<span class="keyword">this</span>.map.getProjection()&amp;&amp;(a=a.transform(<span class="keyword">this</span>.map.getProjectionObject(),<span class="keyword">this</span>.ovmap.getProjectionObject()));</span><br><span class="line">b=<span class="keyword">this</span>.ovmap.getResolution()/<span class="keyword">this</span>.map.getResolution();<span class="keyword">return</span> b&gt;<span class="keyword">this</span>.minRatio&amp;&amp;b&lt;=<span class="keyword">this</span>.maxRatio&amp;&amp;<span class="keyword">this</span>.ovmap.getExtent().containsBounds(a)&#125;,<span class="attr">updateOverview</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getResolution(),b=<span class="keyword">this</span>.ovmap.getResolution(),c=b/a;c&gt;<span class="keyword">this</span>.maxRatio?b=<span class="keyword">this</span>.minRatio*a:c&lt;=<span class="keyword">this</span>.minRatio&amp;&amp;(b=<span class="keyword">this</span>.maxRatio*a);<span class="keyword">this</span>.ovmap.getProjection()!=<span class="keyword">this</span>.map.getProjection()?(a=<span class="keyword">this</span>.map.center.clone(),a.transform(<span class="keyword">this</span>.map.getProjectionObject(),<span class="keyword">this</span>.ovmap.getProjectionObject())):a=<span class="keyword">this</span>.map.center;<span class="keyword">this</span>.ovmap.setCenter(a,</span><br><span class="line"><span class="keyword">this</span>.ovmap.getZoomForResolution(b*<span class="keyword">this</span>.resolutionFactor));<span class="keyword">this</span>.updateRectToMap()&#125;,<span class="attr">createMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Util.extend(&#123;<span class="attr">controls</span>:[],<span class="attr">maxResolution</span>:<span class="string">"auto"</span>,<span class="attr">fallThrough</span>:!<span class="number">1</span>&#125;,<span class="keyword">this</span>.mapOptions);<span class="keyword">this</span>.ovmap=<span class="keyword">new</span> OpenLayers.Map(<span class="keyword">this</span>.mapDiv,a);<span class="keyword">this</span>.ovmap.viewPortDiv.appendChild(<span class="keyword">this</span>.extentRectangle);OpenLayers.Event.stopObserving(<span class="built_in">window</span>,<span class="string">"unload"</span>,<span class="keyword">this</span>.ovmap.unloadDestroy);<span class="keyword">this</span>.ovmap.addLayers(<span class="keyword">this</span>.layers);<span class="keyword">this</span>.ovmap.zoomToMaxExtent();<span class="keyword">this</span>.wComp=(<span class="keyword">this</span>.wComp=<span class="built_in">parseInt</span>(OpenLayers.Element.getStyle(<span class="keyword">this</span>.extentRectangle,</span><br><span class="line"><span class="string">"border-left-width"</span>))+<span class="built_in">parseInt</span>(OpenLayers.Element.getStyle(<span class="keyword">this</span>.extentRectangle,<span class="string">"border-right-width"</span>)))?<span class="keyword">this</span>.wComp:<span class="number">2</span>;<span class="keyword">this</span>.hComp=(<span class="keyword">this</span>.hComp=<span class="built_in">parseInt</span>(OpenLayers.Element.getStyle(<span class="keyword">this</span>.extentRectangle,<span class="string">"border-top-width"</span>))+<span class="built_in">parseInt</span>(OpenLayers.Element.getStyle(<span class="keyword">this</span>.extentRectangle,<span class="string">"border-bottom-width"</span>)))?<span class="keyword">this</span>.hComp:<span class="number">2</span>;<span class="keyword">this</span>.handlers.drag=<span class="keyword">new</span> OpenLayers.Handler.Drag(<span class="keyword">this</span>,&#123;<span class="attr">move</span>:<span class="keyword">this</span>.rectDrag,<span class="attr">done</span>:<span class="keyword">this</span>.updateMapToRect&#125;,&#123;<span class="attr">map</span>:<span class="keyword">this</span>.ovmap&#125;);<span class="keyword">this</span>.handlers.click=<span class="keyword">new</span> OpenLayers.Handler.Click(<span class="keyword">this</span>,&#123;<span class="attr">click</span>:<span class="keyword">this</span>.mapDivClick&#125;,</span><br><span class="line">&#123;<span class="attr">single</span>:!<span class="number">0</span>,<span class="string">"double"</span>:!<span class="number">1</span>,<span class="attr">stopSingle</span>:!<span class="number">0</span>,<span class="attr">stopDouble</span>:!<span class="number">0</span>,<span class="attr">pixelTolerance</span>:<span class="number">1</span>,<span class="attr">map</span>:<span class="keyword">this</span>.ovmap&#125;);<span class="keyword">this</span>.handlers.click.activate();<span class="keyword">this</span>.rectEvents=<span class="keyword">new</span> OpenLayers.Events(<span class="keyword">this</span>,<span class="keyword">this</span>.extentRectangle,<span class="literal">null</span>,!<span class="number">0</span>);<span class="keyword">this</span>.rectEvents.register(<span class="string">"mouseover"</span>,<span class="keyword">this</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.handlers.drag.active||<span class="keyword">this</span>.map.dragging||<span class="keyword">this</span>.handlers.drag.activate()&#125;);<span class="keyword">this</span>.rectEvents.register(<span class="string">"mouseout"</span>,<span class="keyword">this</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.handlers.drag.dragging||<span class="keyword">this</span>.handlers.drag.deactivate()&#125;);<span class="keyword">if</span>(<span class="keyword">this</span>.ovmap.getProjection()!=<span class="keyword">this</span>.map.getProjection())&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getProjectionObject().getUnits()||</span><br><span class="line"><span class="keyword">this</span>.map.units||<span class="keyword">this</span>.map.baseLayer.units,b=<span class="keyword">this</span>.ovmap.getProjectionObject().getUnits()||<span class="keyword">this</span>.ovmap.units||<span class="keyword">this</span>.ovmap.baseLayer.units;<span class="keyword">this</span>.resolutionFactor=a&amp;&amp;b?OpenLayers.INCHES_PER_UNIT[a]/OpenLayers.INCHES_PER_UNIT[b]:<span class="number">1</span>&#125;&#125;,<span class="attr">updateRectToMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a;a=<span class="keyword">this</span>.ovmap.getProjection()!=<span class="keyword">this</span>.map.getProjection()?<span class="keyword">this</span>.map.getExtent().transform(<span class="keyword">this</span>.map.getProjectionObject(),<span class="keyword">this</span>.ovmap.getProjectionObject()):<span class="keyword">this</span>.map.getExtent();(a=<span class="keyword">this</span>.getRectBoundsFromMapBounds(a))&amp;&amp;<span class="keyword">this</span>.setRectPxBounds(a)&#125;,<span class="attr">updateMapToRect</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=</span><br><span class="line"><span class="keyword">this</span>.getMapBoundsFromRectBounds(<span class="keyword">this</span>.rectPxBounds);<span class="keyword">this</span>.ovmap.getProjection()!=<span class="keyword">this</span>.map.getProjection()&amp;&amp;(a=a.transform(<span class="keyword">this</span>.ovmap.getProjectionObject(),<span class="keyword">this</span>.map.getProjectionObject()));<span class="keyword">this</span>.map.panTo(a.getCenterLonLat())&#125;,<span class="attr">setRectPxBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="built_in">Math</span>.max(a.top,<span class="number">0</span>),c=<span class="built_in">Math</span>.max(a.left,<span class="number">0</span>),d=<span class="built_in">Math</span>.min(a.top+<span class="built_in">Math</span>.abs(a.getHeight()),<span class="keyword">this</span>.ovmap.size.h-<span class="keyword">this</span>.hComp);a=<span class="built_in">Math</span>.min(a.left+a.getWidth(),<span class="keyword">this</span>.ovmap.size.w-<span class="keyword">this</span>.wComp);<span class="keyword">var</span> e=<span class="built_in">Math</span>.max(a-c,<span class="number">0</span>),f=<span class="built_in">Math</span>.max(d-b,<span class="number">0</span>);e&lt;<span class="keyword">this</span>.minRectSize||f&lt;<span class="keyword">this</span>.minRectSize?</span><br><span class="line">(<span class="keyword">this</span>.extentRectangle.className=<span class="keyword">this</span>.displayClass+<span class="keyword">this</span>.minRectDisplayClass,e=c+e/<span class="number">2</span>-<span class="keyword">this</span>.minRectSize/<span class="number">2</span>,<span class="keyword">this</span>.extentRectangle.style.top=<span class="built_in">Math</span>.round(b+f/<span class="number">2</span>-<span class="keyword">this</span>.minRectSize/<span class="number">2</span>)+<span class="string">"px"</span>,<span class="keyword">this</span>.extentRectangle.style.left=<span class="built_in">Math</span>.round(e)+<span class="string">"px"</span>,<span class="keyword">this</span>.extentRectangle.style.height=<span class="keyword">this</span>.minRectSize+<span class="string">"px"</span>,<span class="keyword">this</span>.extentRectangle.style.width=<span class="keyword">this</span>.minRectSize+<span class="string">"px"</span>):(<span class="keyword">this</span>.extentRectangle.className=<span class="keyword">this</span>.displayClass+<span class="string">"ExtentRectangle"</span>,<span class="keyword">this</span>.extentRectangle.style.top=<span class="built_in">Math</span>.round(b)+<span class="string">"px"</span>,<span class="keyword">this</span>.extentRectangle.style.left=<span class="built_in">Math</span>.round(c)+</span><br><span class="line"><span class="string">"px"</span>,<span class="keyword">this</span>.extentRectangle.style.height=<span class="built_in">Math</span>.round(f)+<span class="string">"px"</span>,<span class="keyword">this</span>.extentRectangle.style.width=<span class="built_in">Math</span>.round(e)+<span class="string">"px"</span>);<span class="keyword">this</span>.rectPxBounds=<span class="keyword">new</span> OpenLayers.Bounds(<span class="built_in">Math</span>.round(c),<span class="built_in">Math</span>.round(d),<span class="built_in">Math</span>.round(a),<span class="built_in">Math</span>.round(b))&#125;,<span class="attr">getRectBoundsFromMapBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getOverviewPxFromLonLat(&#123;<span class="attr">lon</span>:a.left,<span class="attr">lat</span>:a.bottom&#125;);a=<span class="keyword">this</span>.getOverviewPxFromLonLat(&#123;<span class="attr">lon</span>:a.right,<span class="attr">lat</span>:a.top&#125;);<span class="keyword">var</span> c=<span class="literal">null</span>;b&amp;&amp;a&amp;&amp;(c=<span class="keyword">new</span> OpenLayers.Bounds(b.x,b.y,a.x,a.y));<span class="keyword">return</span> c&#125;,<span class="attr">getMapBoundsFromRectBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getLonLatFromOverviewPx(&#123;<span class="attr">x</span>:a.left,</span><br><span class="line">y:a.bottom&#125;);a=<span class="keyword">this</span>.getLonLatFromOverviewPx(&#123;<span class="attr">x</span>:a.right,<span class="attr">y</span>:a.top&#125;);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat)&#125;,<span class="attr">getLonLatFromOverviewPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.ovmap.size,c=<span class="keyword">this</span>.ovmap.getResolution(),d=<span class="keyword">this</span>.ovmap.getExtent().getCenterLonLat();<span class="keyword">return</span>&#123;<span class="attr">lon</span>:d.lon+(a.x-b.w/<span class="number">2</span>)*c,<span class="attr">lat</span>:d.lat-(a.y-b.h/<span class="number">2</span>)*c&#125;&#125;,<span class="attr">getOverviewPxFromLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.ovmap.getResolution(),c=<span class="keyword">this</span>.ovmap.getExtent();<span class="keyword">if</span>(c)<span class="keyword">return</span>&#123;<span class="attr">x</span>:<span class="built_in">Math</span>.round(<span class="number">1</span>/b*(a.lon-c.left)),<span class="attr">y</span>:<span class="built_in">Math</span>.round(<span class="number">1</span>/b*(c.top-a.lat))&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.OverviewMap"</span>&#125;);OpenLayers.Layer=OpenLayers.Class(&#123;<span class="attr">id</span>:<span class="literal">null</span>,<span class="attr">name</span>:<span class="literal">null</span>,<span class="attr">div</span>:<span class="literal">null</span>,<span class="attr">opacity</span>:<span class="number">1</span>,<span class="attr">alwaysInRange</span>:<span class="literal">null</span>,<span class="attr">RESOLUTION_PROPERTIES</span>:<span class="string">"scales resolutions maxScale minScale maxResolution minResolution numZoomLevels maxZoomLevel"</span>.split(<span class="string">" "</span>),<span class="attr">events</span>:<span class="literal">null</span>,<span class="attr">map</span>:<span class="literal">null</span>,<span class="attr">isBaseLayer</span>:!<span class="number">1</span>,<span class="attr">alpha</span>:!<span class="number">1</span>,<span class="attr">displayInLayerSwitcher</span>:!<span class="number">0</span>,<span class="attr">visibility</span>:!<span class="number">0</span>,<span class="attr">attribution</span>:<span class="literal">null</span>,<span class="attr">inRange</span>:!<span class="number">1</span>,<span class="attr">imageSize</span>:<span class="literal">null</span>,<span class="attr">options</span>:<span class="literal">null</span>,<span class="attr">eventListeners</span>:<span class="literal">null</span>,<span class="attr">gutter</span>:<span class="number">0</span>,<span class="attr">projection</span>:<span class="literal">null</span>,<span class="attr">units</span>:<span class="literal">null</span>,<span class="attr">scales</span>:<span class="literal">null</span>,<span class="attr">resolutions</span>:<span class="literal">null</span>,<span class="attr">maxExtent</span>:<span class="literal">null</span>,<span class="attr">minExtent</span>:<span class="literal">null</span>,<span class="attr">maxResolution</span>:<span class="literal">null</span>,<span class="attr">minResolution</span>:<span class="literal">null</span>,</span><br><span class="line">numZoomLevels:<span class="literal">null</span>,<span class="attr">minScale</span>:<span class="literal">null</span>,<span class="attr">maxScale</span>:<span class="literal">null</span>,<span class="attr">displayOutsideMaxExtent</span>:!<span class="number">1</span>,<span class="attr">wrapDateLine</span>:!<span class="number">1</span>,<span class="attr">metadata</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.metadata=&#123;&#125;;b=OpenLayers.Util.extend(&#123;&#125;,b);<span class="literal">null</span>!=<span class="keyword">this</span>.alwaysInRange&amp;&amp;(b.alwaysInRange=<span class="keyword">this</span>.alwaysInRange);<span class="keyword">this</span>.addOptions(b);<span class="keyword">this</span>.name=a;<span class="keyword">if</span>(<span class="literal">null</span>==<span class="keyword">this</span>.id&amp;&amp;(<span class="keyword">this</span>.id=OpenLayers.Util.createUniqueID(<span class="keyword">this</span>.CLASS_NAME+<span class="string">"_"</span>),<span class="keyword">this</span>.div=OpenLayers.Util.createDiv(<span class="keyword">this</span>.id),<span class="keyword">this</span>.div.style.width=<span class="string">"100%"</span>,<span class="keyword">this</span>.div.style.height=<span class="string">"100%"</span>,<span class="keyword">this</span>.div.dir=<span class="string">"ltr"</span>,<span class="keyword">this</span>.events=<span class="keyword">new</span> OpenLayers.Events(<span class="keyword">this</span>,</span><br><span class="line"><span class="keyword">this</span>.div),<span class="keyword">this</span>.eventListeners <span class="keyword">instanceof</span> <span class="built_in">Object</span>))<span class="keyword">this</span>.events.on(<span class="keyword">this</span>.eventListeners)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=!<span class="number">0</span>);<span class="literal">null</span>!=<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.removeLayer(<span class="keyword">this</span>,a);<span class="keyword">this</span>.options=<span class="keyword">this</span>.div=<span class="keyword">this</span>.name=<span class="keyword">this</span>.map=<span class="keyword">this</span>.projection=<span class="literal">null</span>;<span class="keyword">this</span>.events&amp;&amp;(<span class="keyword">this</span>.eventListeners&amp;&amp;<span class="keyword">this</span>.events.un(<span class="keyword">this</span>.eventListeners),<span class="keyword">this</span>.events.destroy());<span class="keyword">this</span>.events=<span class="keyword">this</span>.eventListeners=<span class="literal">null</span>&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer(<span class="keyword">this</span>.name,<span class="keyword">this</span>.getOptions()));OpenLayers.Util.applyDefaults(a,<span class="keyword">this</span>);a.map=<span class="literal">null</span>;<span class="keyword">return</span> a&#125;,</span><br><span class="line">getOptions:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=&#123;&#125;,b;<span class="keyword">for</span>(b <span class="keyword">in</span> <span class="keyword">this</span>.options)a[b]=<span class="keyword">this</span>[b];<span class="keyword">return</span> a&#125;,<span class="attr">setName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a!=<span class="keyword">this</span>.name&amp;&amp;(<span class="keyword">this</span>.name=a,<span class="literal">null</span>!=<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.triggerEvent(<span class="string">"changelayer"</span>,&#123;<span class="attr">layer</span>:<span class="keyword">this</span>,<span class="attr">property</span>:<span class="string">"name"</span>&#125;))&#125;,<span class="attr">addOptions</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="literal">null</span>==<span class="keyword">this</span>.options&amp;&amp;(<span class="keyword">this</span>.options=&#123;&#125;);a&amp;&amp;(<span class="string">"string"</span>==<span class="keyword">typeof</span> a.projection&amp;&amp;(a.projection=<span class="keyword">new</span> OpenLayers.Projection(a.projection)),a.projection&amp;&amp;OpenLayers.Util.applyDefaults(a,OpenLayers.Projection.defaults[a.projection.getCode()]),!a.maxExtent||a.maxExtent <span class="keyword">instanceof</span></span><br><span class="line">OpenLayers.Bounds||(a.maxExtent=<span class="keyword">new</span> OpenLayers.Bounds(a.maxExtent)),!a.minExtent||a.minExtent <span class="keyword">instanceof</span> OpenLayers.Bounds||(a.minExtent=<span class="keyword">new</span> OpenLayers.Bounds(a.minExtent)));OpenLayers.Util.extend(<span class="keyword">this</span>.options,a);OpenLayers.Util.extend(<span class="keyword">this</span>,a);<span class="keyword">this</span>.projection&amp;&amp;<span class="keyword">this</span>.projection.getUnits()&amp;&amp;(<span class="keyword">this</span>.units=<span class="keyword">this</span>.projection.getUnits());<span class="keyword">if</span>(<span class="keyword">this</span>.map)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.map.getResolution(),d=<span class="keyword">this</span>.RESOLUTION_PROPERTIES.concat([<span class="string">"projection"</span>,<span class="string">"units"</span>,<span class="string">"minExtent"</span>,<span class="string">"maxExtent"</span>]),e;<span class="keyword">for</span>(e <span class="keyword">in</span> a)<span class="keyword">if</span>(a.hasOwnProperty(e)&amp;&amp;<span class="number">0</span>&lt;=OpenLayers.Util.indexOf(d,</span><br><span class="line">e))&#123;<span class="keyword">this</span>.initResolutions();b&amp;&amp;<span class="keyword">this</span>.map.baseLayer===<span class="keyword">this</span>&amp;&amp;(<span class="keyword">this</span>.map.setCenter(<span class="keyword">this</span>.map.getCenter(),<span class="keyword">this</span>.map.getZoomForResolution(c),!<span class="number">1</span>,!<span class="number">0</span>),<span class="keyword">this</span>.map.events.triggerEvent(<span class="string">"changebaselayer"</span>,&#123;<span class="attr">layer</span>:<span class="keyword">this</span>&#125;));<span class="keyword">break</span>&#125;&#125;&#125;,<span class="attr">onMapResize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">redraw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.map)&#123;<span class="keyword">this</span>.inRange=<span class="keyword">this</span>.calculateInRange();<span class="keyword">var</span> b=<span class="keyword">this</span>.getExtent();b&amp;&amp;(<span class="keyword">this</span>.inRange&amp;&amp;<span class="keyword">this</span>.visibility)&amp;&amp;(<span class="keyword">this</span>.moveTo(b,!<span class="number">0</span>,!<span class="number">1</span>),<span class="keyword">this</span>.events.triggerEvent(<span class="string">"moveend"</span>,&#123;<span class="attr">zoomChanged</span>:!<span class="number">0</span>&#125;),a=!<span class="number">0</span>)&#125;<span class="keyword">return</span> a&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;a=<span class="keyword">this</span>.visibility;</span><br><span class="line"><span class="keyword">this</span>.isBaseLayer||(a=a&amp;&amp;<span class="keyword">this</span>.inRange);<span class="keyword">this</span>.display(a)&#125;,<span class="attr">moveByPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==<span class="keyword">this</span>.map&amp;&amp;(<span class="keyword">this</span>.map=a,<span class="keyword">this</span>.maxExtent=<span class="keyword">this</span>.maxExtent||<span class="keyword">this</span>.map.maxExtent,<span class="keyword">this</span>.minExtent=<span class="keyword">this</span>.minExtent||<span class="keyword">this</span>.map.minExtent,<span class="keyword">this</span>.projection=<span class="keyword">this</span>.projection||<span class="keyword">this</span>.map.projection,<span class="string">"string"</span>==<span class="keyword">typeof</span> <span class="keyword">this</span>.projection&amp;&amp;(<span class="keyword">this</span>.projection=<span class="keyword">new</span> OpenLayers.Projection(<span class="keyword">this</span>.projection)),<span class="keyword">this</span>.units=<span class="keyword">this</span>.projection.getUnits()||<span class="keyword">this</span>.units||<span class="keyword">this</span>.map.units,<span class="keyword">this</span>.initResolutions(),<span class="keyword">this</span>.isBaseLayer||(<span class="keyword">this</span>.inRange=<span class="keyword">this</span>.calculateInRange(),</span><br><span class="line"><span class="keyword">this</span>.div.style.display=<span class="keyword">this</span>.visibility&amp;&amp;<span class="keyword">this</span>.inRange?<span class="string">""</span>:<span class="string">"none"</span>),<span class="keyword">this</span>.setTileSize())&#125;,<span class="attr">afterAdd</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">removeMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">getImageSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.imageSize||<span class="keyword">this</span>.tileSize&#125;,<span class="attr">setTileSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.tileSize=a=a?a:<span class="keyword">this</span>.tileSize?<span class="keyword">this</span>.tileSize:<span class="keyword">this</span>.map.getTileSize();<span class="keyword">this</span>.gutter&amp;&amp;(<span class="keyword">this</span>.imageSize=<span class="keyword">new</span> OpenLayers.Size(a.w+<span class="number">2</span>*<span class="keyword">this</span>.gutter,a.h+<span class="number">2</span>*<span class="keyword">this</span>.gutter))&#125;,<span class="attr">getVisibility</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.visibility&#125;,<span class="attr">setVisibility</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a!=<span class="keyword">this</span>.visibility&amp;&amp;(<span class="keyword">this</span>.visibility=a,<span class="keyword">this</span>.display(a),</span><br><span class="line"><span class="keyword">this</span>.redraw(),<span class="literal">null</span>!=<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.triggerEvent(<span class="string">"changelayer"</span>,&#123;<span class="attr">layer</span>:<span class="keyword">this</span>,<span class="attr">property</span>:<span class="string">"visibility"</span>&#125;),<span class="keyword">this</span>.events.triggerEvent(<span class="string">"visibilitychanged"</span>))&#125;,<span class="attr">display</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a!=(<span class="string">"none"</span>!=<span class="keyword">this</span>.div.style.display)&amp;&amp;(<span class="keyword">this</span>.div.style.display=a&amp;&amp;<span class="keyword">this</span>.calculateInRange()?<span class="string">"block"</span>:<span class="string">"none"</span>)&#125;,<span class="attr">calculateInRange</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;<span class="keyword">this</span>.alwaysInRange?a=!<span class="number">0</span>:<span class="keyword">this</span>.map&amp;&amp;(a=<span class="keyword">this</span>.map.getResolution(),a=a&gt;=<span class="keyword">this</span>.minResolution&amp;&amp;a&lt;=<span class="keyword">this</span>.maxResolution);<span class="keyword">return</span> a&#125;,<span class="attr">setIsBaseLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a!=<span class="keyword">this</span>.isBaseLayer&amp;&amp;(<span class="keyword">this</span>.isBaseLayer=</span><br><span class="line">a,<span class="literal">null</span>!=<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.triggerEvent(<span class="string">"changebaselayer"</span>,&#123;<span class="attr">layer</span>:<span class="keyword">this</span>&#125;))&#125;,<span class="attr">initResolutions</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a,b,c,d=&#123;&#125;,e=!<span class="number">0</span>;a=<span class="number">0</span>;<span class="keyword">for</span>(b=<span class="keyword">this</span>.RESOLUTION_PROPERTIES.length;a&lt;b;a++)c=<span class="keyword">this</span>.RESOLUTION_PROPERTIES[a],d[c]=<span class="keyword">this</span>.options[c],e&amp;&amp;<span class="keyword">this</span>.options[c]&amp;&amp;(e=!<span class="number">1</span>);<span class="literal">null</span>==<span class="keyword">this</span>.options.alwaysInRange&amp;&amp;(<span class="keyword">this</span>.alwaysInRange=e);<span class="literal">null</span>==d.resolutions&amp;&amp;(d.resolutions=<span class="keyword">this</span>.resolutionsFromScales(d.scales));<span class="literal">null</span>==d.resolutions&amp;&amp;(d.resolutions=<span class="keyword">this</span>.calculateResolutions(d));<span class="keyword">if</span>(<span class="literal">null</span>==d.resolutions)&#123;a=<span class="number">0</span>;<span class="keyword">for</span>(b=<span class="keyword">this</span>.RESOLUTION_PROPERTIES.length;a&lt;</span><br><span class="line">b;a++)c=<span class="keyword">this</span>.RESOLUTION_PROPERTIES[a],d[c]=<span class="literal">null</span>!=<span class="keyword">this</span>.options[c]?<span class="keyword">this</span>.options[c]:<span class="keyword">this</span>.map[c];<span class="literal">null</span>==d.resolutions&amp;&amp;(d.resolutions=<span class="keyword">this</span>.resolutionsFromScales(d.scales));<span class="literal">null</span>==d.resolutions&amp;&amp;(d.resolutions=<span class="keyword">this</span>.calculateResolutions(d))&#125;<span class="keyword">var</span> f;<span class="keyword">this</span>.options.maxResolution&amp;&amp;<span class="string">"auto"</span>!==<span class="keyword">this</span>.options.maxResolution&amp;&amp;(f=<span class="keyword">this</span>.options.maxResolution);<span class="keyword">this</span>.options.minScale&amp;&amp;(f=OpenLayers.Util.getResolutionFromScale(<span class="keyword">this</span>.options.minScale,<span class="keyword">this</span>.units));<span class="keyword">var</span> g;<span class="keyword">this</span>.options.minResolution&amp;&amp;<span class="string">"auto"</span>!==<span class="keyword">this</span>.options.minResolution&amp;&amp;</span><br><span class="line">(g=<span class="keyword">this</span>.options.minResolution);<span class="keyword">this</span>.options.maxScale&amp;&amp;(g=OpenLayers.Util.getResolutionFromScale(<span class="keyword">this</span>.options.maxScale,<span class="keyword">this</span>.units));d.resolutions&amp;&amp;(d.resolutions.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> b-a&#125;),f||(f=d.resolutions[<span class="number">0</span>]),g||(g=d.resolutions[d.resolutions.length<span class="number">-1</span>]));<span class="keyword">if</span>(<span class="keyword">this</span>.resolutions=d.resolutions)&#123;b=<span class="keyword">this</span>.resolutions.length;<span class="keyword">this</span>.scales=<span class="built_in">Array</span>(b);<span class="keyword">for</span>(a=<span class="number">0</span>;a&lt;b;a++)<span class="keyword">this</span>.scales[a]=OpenLayers.Util.getScaleFromResolution(<span class="keyword">this</span>.resolutions[a],<span class="keyword">this</span>.units);<span class="keyword">this</span>.numZoomLevels=b&#125;<span class="keyword">if</span>(<span class="keyword">this</span>.minResolution=g)<span class="keyword">this</span>.maxScale=</span><br><span class="line">OpenLayers.Util.getScaleFromResolution(g,<span class="keyword">this</span>.units);<span class="keyword">if</span>(<span class="keyword">this</span>.maxResolution=f)<span class="keyword">this</span>.minScale=OpenLayers.Util.getScaleFromResolution(f,<span class="keyword">this</span>.units)&#125;,<span class="attr">resolutionsFromScales</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>!=a)&#123;<span class="keyword">var</span> b,c,d;d=a.length;b=<span class="built_in">Array</span>(d);<span class="keyword">for</span>(c=<span class="number">0</span>;c&lt;d;c++)b[c]=OpenLayers.Util.getResolutionFromScale(a[c],<span class="keyword">this</span>.units);<span class="keyword">return</span> b&#125;&#125;,<span class="attr">calculateResolutions</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c,d=a.maxResolution;<span class="literal">null</span>!=a.minScale?d=OpenLayers.Util.getResolutionFromScale(a.minScale,<span class="keyword">this</span>.units):<span class="string">"auto"</span>==d&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.maxExtent&amp;&amp;(b=<span class="keyword">this</span>.map.getSize(),</span><br><span class="line">c=<span class="keyword">this</span>.maxExtent.getWidth()/b.w,b=<span class="keyword">this</span>.maxExtent.getHeight()/b.h,d=<span class="built_in">Math</span>.max(c,b));c=a.minResolution;<span class="literal">null</span>!=a.maxScale?c=OpenLayers.Util.getResolutionFromScale(a.maxScale,<span class="keyword">this</span>.units):<span class="string">"auto"</span>==a.minResolution&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.minExtent&amp;&amp;(b=<span class="keyword">this</span>.map.getSize(),c=<span class="keyword">this</span>.minExtent.getWidth()/b.w,b=<span class="keyword">this</span>.minExtent.getHeight()/b.h,c=<span class="built_in">Math</span>.max(c,b));<span class="string">"number"</span>!==<span class="keyword">typeof</span> d&amp;&amp;(<span class="string">"number"</span>!==<span class="keyword">typeof</span> c&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.maxExtent)&amp;&amp;(d=<span class="keyword">this</span>.map.getTileSize(),d=<span class="built_in">Math</span>.max(<span class="keyword">this</span>.maxExtent.getWidth()/d.w,<span class="keyword">this</span>.maxExtent.getHeight()/d.h));b=a.maxZoomLevel;</span><br><span class="line">a=a.numZoomLevels;<span class="string">"number"</span>===<span class="keyword">typeof</span> c&amp;&amp;<span class="string">"number"</span>===<span class="keyword">typeof</span> d&amp;&amp;<span class="keyword">void</span> <span class="number">0</span>===a?a=<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.log(d/c)/<span class="built_in">Math</span>.log(<span class="number">2</span>))+<span class="number">1</span>:<span class="keyword">void</span> <span class="number">0</span>===a&amp;&amp;<span class="literal">null</span>!=b&amp;&amp;(a=b+<span class="number">1</span>);<span class="keyword">if</span>(!(<span class="string">"number"</span>!==<span class="keyword">typeof</span> a||<span class="number">0</span>&gt;=a||<span class="string">"number"</span>!==<span class="keyword">typeof</span> d&amp;&amp;<span class="string">"number"</span>!==<span class="keyword">typeof</span> c))&#123;b=<span class="built_in">Array</span>(a);<span class="keyword">var</span> e=<span class="number">2</span>;<span class="string">"number"</span>==<span class="keyword">typeof</span> c&amp;&amp;<span class="string">"number"</span>==<span class="keyword">typeof</span> d&amp;&amp;(e=<span class="built_in">Math</span>.pow(d/c,<span class="number">1</span>/(a<span class="number">-1</span>)));<span class="keyword">var</span> f;<span class="keyword">if</span>(<span class="string">"number"</span>===<span class="keyword">typeof</span> d)<span class="keyword">for</span>(f=<span class="number">0</span>;f&lt;a;f++)b[f]=d/<span class="built_in">Math</span>.pow(e,f);<span class="keyword">else</span> <span class="keyword">for</span>(f=<span class="number">0</span>;f&lt;a;f++)b[a<span class="number">-1</span>-f]=c*<span class="built_in">Math</span>.pow(e,f);<span class="keyword">return</span> b&#125;&#125;,<span class="attr">getResolution</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getZoom();<span class="keyword">return</span> <span class="keyword">this</span>.getResolutionForZoom(a)&#125;,</span><br><span class="line">getExtent:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.map.calculateBounds()&#125;,<span class="attr">getZoomForExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.map.getSize(),c=<span class="built_in">Math</span>.max(a.getWidth()/c.w,a.getHeight()/c.h);<span class="keyword">return</span> <span class="keyword">this</span>.getZoomForResolution(c,b)&#125;,<span class="attr">getDataExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">getResolutionForZoom</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="built_in">Math</span>.max(<span class="number">0</span>,<span class="built_in">Math</span>.min(a,<span class="keyword">this</span>.resolutions.length<span class="number">-1</span>));<span class="keyword">if</span>(<span class="keyword">this</span>.map.fractionalZoom)&#123;<span class="keyword">var</span> b=<span class="built_in">Math</span>.floor(a),c=<span class="built_in">Math</span>.ceil(a);a=<span class="keyword">this</span>.resolutions[b]-(a-b)*(<span class="keyword">this</span>.resolutions[b]-<span class="keyword">this</span>.resolutions[c])&#125;<span class="keyword">else</span> a=<span class="keyword">this</span>.resolutions[<span class="built_in">Math</span>.round(a)];<span class="keyword">return</span> a&#125;,<span class="attr">getZoomForResolution</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">var</span> c,d;<span class="keyword">if</span>(<span class="keyword">this</span>.map.fractionalZoom)&#123;<span class="keyword">var</span> e=<span class="number">0</span>,f=<span class="keyword">this</span>.resolutions[e],g=<span class="keyword">this</span>.resolutions[<span class="keyword">this</span>.resolutions.length<span class="number">-1</span>],h;c=<span class="number">0</span>;<span class="keyword">for</span>(d=<span class="keyword">this</span>.resolutions.length;c&lt;d;++c)<span class="keyword">if</span>(h=<span class="keyword">this</span>.resolutions[c],h&gt;=a&amp;&amp;(f=h,e=c),h&lt;=a)&#123;g=h;<span class="keyword">break</span>&#125;c=f-g;c=<span class="number">0</span>&lt;c?e+(f-a)/c:e&#125;<span class="keyword">else</span>&#123;f=<span class="built_in">Number</span>.POSITIVE_INFINITY;c=<span class="number">0</span>;<span class="keyword">for</span>(d=<span class="keyword">this</span>.resolutions.length;c&lt;d;c++)<span class="keyword">if</span>(b)&#123;e=<span class="built_in">Math</span>.abs(<span class="keyword">this</span>.resolutions[c]-a);<span class="keyword">if</span>(e&gt;f)<span class="keyword">break</span>;f=e&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.resolutions[c]&lt;a)<span class="keyword">break</span>;c=<span class="built_in">Math</span>.max(<span class="number">0</span>,c<span class="number">-1</span>)&#125;<span class="keyword">return</span> c&#125;,<span class="attr">getLonLatFromViewPortPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>,c=<span class="keyword">this</span>.map;<span class="keyword">if</span>(<span class="literal">null</span>!=</span><br><span class="line">a&amp;&amp;c.minPx)&#123;<span class="keyword">var</span> b=c.getResolution(),d=c.getMaxExtent(&#123;<span class="attr">restricted</span>:!<span class="number">0</span>&#125;),b=<span class="keyword">new</span> OpenLayers.LonLat((a.x-c.minPx.x)*b+d.left,(c.minPx.y-a.y)*b+d.top);<span class="keyword">this</span>.wrapDateLine&amp;&amp;(b=b.wrapDateLine(<span class="keyword">this</span>.maxExtent))&#125;<span class="keyword">return</span> b&#125;,<span class="attr">getViewPortPxFromLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>;<span class="literal">null</span>!=a&amp;&amp;(b=b||<span class="keyword">this</span>.map.getResolution(),c=<span class="keyword">this</span>.map.calculateBounds(<span class="literal">null</span>,b),c=<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">1</span>/b*(a.lon-c.left),<span class="number">1</span>/b*(c.top-a.lat)));<span class="keyword">return</span> c&#125;,<span class="attr">setOpacity</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a!=<span class="keyword">this</span>.opacity)&#123;<span class="keyword">this</span>.opacity=a;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.div.childNodes,c=<span class="number">0</span>,d=b.length;c&lt;</span><br><span class="line">d;++c)&#123;<span class="keyword">var</span> e=b[c].firstChild||b[c],f=b[c].lastChild;f&amp;&amp;<span class="string">"iframe"</span>===f.nodeName.toLowerCase()&amp;&amp;(e=f.parentNode);OpenLayers.Util.modifyDOMElement(e,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,a)&#125;<span class="literal">null</span>!=<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.triggerEvent(<span class="string">"changelayer"</span>,&#123;<span class="attr">layer</span>:<span class="keyword">this</span>,<span class="attr">property</span>:<span class="string">"opacity"</span>&#125;)&#125;&#125;,<span class="attr">getZIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.div.style.zIndex&#125;,<span class="attr">setZIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.div.style.zIndex=a&#125;,<span class="attr">adjustBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.gutter)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.gutter*<span class="keyword">this</span>.map.getResolution();a=<span class="keyword">new</span> OpenLayers.Bounds(a.left-b,a.bottom-b,a.right+</span><br><span class="line">b,a.top+b)&#125;<span class="keyword">this</span>.wrapDateLine&amp;&amp;(b=&#123;<span class="attr">rightTolerance</span>:<span class="keyword">this</span>.getResolution(),<span class="attr">leftTolerance</span>:<span class="keyword">this</span>.getResolution()&#125;,a=a.wrapDateLine(<span class="keyword">this</span>.maxExtent,b));<span class="keyword">return</span> a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer"</span>&#125;);OpenLayers.Layer.SphericalMercator=&#123;<span class="attr">getExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="literal">null</span>;<span class="keyword">return</span> a=<span class="keyword">this</span>.sphericalMercator?<span class="keyword">this</span>.map.calculateBounds():OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(<span class="keyword">this</span>)&#125;,<span class="attr">getLonLatFromViewPortPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">getViewPortPxFromLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">initMercatorParameters</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.RESOLUTIONS=[];<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>;a&lt;=<span class="keyword">this</span>.MAX_ZOOM_LEVEL;++a)<span class="keyword">this</span>.RESOLUTIONS[a]=</span><br><span class="line"><span class="number">156543.03390625</span>/<span class="built_in">Math</span>.pow(<span class="number">2</span>,a);<span class="keyword">this</span>.units=<span class="string">"m"</span>;<span class="keyword">this</span>.projection=<span class="keyword">this</span>.projection||<span class="string">"EPSG:900913"</span>&#125;,<span class="attr">forwardMercator</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>),b=<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:900913"</span>);<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">c,d</span>)</span>&#123;<span class="keyword">var</span> e=OpenLayers.Projection.transform(&#123;<span class="attr">x</span>:c,<span class="attr">y</span>:d&#125;,a,b);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.LonLat(e.x,e.y)&#125;&#125;(),<span class="attr">inverseMercator</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>),b=<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:900913"</span>);<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">c,d</span>)</span>&#123;<span class="keyword">var</span> e=OpenLayers.Projection.transform(&#123;<span class="attr">x</span>:c,</span><br><span class="line">y:d&#125;,b,a);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.LonLat(e.x,e.y)&#125;&#125;()&#125;;OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,&#123;<span class="attr">smoothDragPan</span>:!<span class="number">0</span>,<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">isFixed</span>:!<span class="number">0</span>,<span class="attr">pane</span>:<span class="literal">null</span>,<span class="attr">mapObject</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Layer.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="literal">null</span>==<span class="keyword">this</span>.pane&amp;&amp;(<span class="keyword">this</span>.pane=OpenLayers.Util.createDiv(<span class="keyword">this</span>.div.id+<span class="string">"_EventPane"</span>))&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.pane=<span class="keyword">this</span>.mapObject=<span class="literal">null</span>;OpenLayers.Layer.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Layer.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.pane.style.zIndex=</span><br><span class="line"><span class="built_in">parseInt</span>(<span class="keyword">this</span>.div.style.zIndex)+<span class="number">1</span>;<span class="keyword">this</span>.pane.style.display=<span class="keyword">this</span>.div.style.display;<span class="keyword">this</span>.pane.style.width=<span class="string">"100%"</span>;<span class="keyword">this</span>.pane.style.height=<span class="string">"100%"</span>;<span class="string">"msie"</span>==OpenLayers.BROWSER_NAME&amp;&amp;(<span class="keyword">this</span>.pane.style.background=<span class="string">"url("</span>+OpenLayers.Util.getImageLocation(<span class="string">"blank.gif"</span>)+<span class="string">")"</span>);<span class="keyword">this</span>.isFixed?<span class="keyword">this</span>.map.viewPortDiv.appendChild(<span class="keyword">this</span>.pane):<span class="keyword">this</span>.map.layerContainerDiv.appendChild(<span class="keyword">this</span>.pane);<span class="keyword">this</span>.loadMapObject();<span class="literal">null</span>==<span class="keyword">this</span>.mapObject&amp;&amp;<span class="keyword">this</span>.loadWarningMessage()&#125;,<span class="attr">removeMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.pane&amp;&amp;<span class="keyword">this</span>.pane.parentNode&amp;&amp;<span class="keyword">this</span>.pane.parentNode.removeChild(<span class="keyword">this</span>.pane);</span><br><span class="line">OpenLayers.Layer.prototype.removeMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">loadWarningMessage</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.div.style.backgroundColor=<span class="string">"darkblue"</span>;<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getSize(),b=<span class="built_in">Math</span>.min(a.w,<span class="number">300</span>),c=<span class="built_in">Math</span>.min(a.h,<span class="number">200</span>),b=<span class="keyword">new</span> OpenLayers.Size(b,c),a=(<span class="keyword">new</span> OpenLayers.Pixel(a.w/<span class="number">2</span>,a.h/<span class="number">2</span>)).add(-b.w/<span class="number">2</span>,-b.h/<span class="number">2</span>),a=OpenLayers.Util.createDiv(<span class="keyword">this</span>.name+<span class="string">"_warning"</span>,a,b,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="string">"auto"</span>);a.style.padding=<span class="string">"7px"</span>;a.style.backgroundColor=<span class="string">"yellow"</span>;a.innerHTML=<span class="keyword">this</span>.getWarningHTML();<span class="keyword">this</span>.div.appendChild(a)&#125;,<span class="attr">getWarningHTML</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">""</span>&#125;,</span><br><span class="line">display:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Layer.prototype.display.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.pane.style.display=<span class="keyword">this</span>.div.style.display&#125;,<span class="attr">setZIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Layer.prototype.setZIndex.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.pane.style.zIndex=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.div.style.zIndex)+<span class="number">1</span>&#125;,<span class="attr">moveByPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Layer.prototype.moveByPx.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.dragPanMapObject?<span class="keyword">this</span>.dragPanMapObject(a,-b):<span class="keyword">this</span>.moveTo(<span class="keyword">this</span>.map.getCachedCenter())&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Layer.prototype.moveTo.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>);<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.mapObject)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.map.getCenter(),e=<span class="keyword">this</span>.map.getZoom();<span class="keyword">if</span>(<span class="literal">null</span>!=d)&#123;<span class="keyword">var</span> f=<span class="keyword">this</span>.getMapObjectCenter(),f=<span class="keyword">this</span>.getOLLonLatFromMapObjectLonLat(f),g=<span class="keyword">this</span>.getMapObjectZoom(),g=<span class="keyword">this</span>.getOLZoomFromMapObjectZoom(g);d.equals(f)&amp;&amp;e==g||(!b&amp;&amp;f&amp;&amp;<span class="keyword">this</span>.dragPanMapObject&amp;&amp;<span class="keyword">this</span>.smoothDragPan?(e=<span class="keyword">this</span>.map.getViewPortPxFromLonLat(f),d=<span class="keyword">this</span>.map.getViewPortPxFromLonLat(d),<span class="keyword">this</span>.dragPanMapObject(d.x-e.x,e.y-d.y)):(d=<span class="keyword">this</span>.getMapObjectLonLatFromOLLonLat(d),e=<span class="keyword">this</span>.getMapObjectZoomFromOLZoom(e),<span class="keyword">this</span>.setMapObjectCenter(d,</span><br><span class="line">e,c)))&#125;&#125;&#125;,<span class="attr">getLonLatFromViewPortPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.mapObject&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.getMapObjectCenter()&amp;&amp;(a=<span class="keyword">this</span>.getMapObjectPixelFromOLPixel(a),a=<span class="keyword">this</span>.getMapObjectLonLatFromMapObjectPixel(a),b=<span class="keyword">this</span>.getOLLonLatFromMapObjectLonLat(a));<span class="keyword">return</span> b&#125;,<span class="attr">getViewPortPxFromLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.mapObject&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.getMapObjectCenter()&amp;&amp;(a=<span class="keyword">this</span>.getMapObjectLonLatFromOLLonLat(a),a=<span class="keyword">this</span>.getMapObjectPixelFromMapObjectLonLat(a),b=<span class="keyword">this</span>.getOLPixelFromMapObjectPixel(a));<span class="keyword">return</span> b&#125;,<span class="attr">getOLLonLatFromMapObjectLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="literal">null</span>;<span class="literal">null</span>!=a&amp;&amp;(b=<span class="keyword">this</span>.getLongitudeFromMapObjectLonLat(a),a=<span class="keyword">this</span>.getLatitudeFromMapObjectLonLat(a),b=<span class="keyword">new</span> OpenLayers.LonLat(b,a));<span class="keyword">return</span> b&#125;,<span class="attr">getMapObjectLonLatFromOLLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="literal">null</span>!=a&amp;&amp;(b=<span class="keyword">this</span>.getMapObjectLonLatFromLonLat(a.lon,a.lat));<span class="keyword">return</span> b&#125;,<span class="attr">getOLPixelFromMapObjectPixel</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="literal">null</span>!=a&amp;&amp;(b=<span class="keyword">this</span>.getXFromMapObjectPixel(a),a=<span class="keyword">this</span>.getYFromMapObjectPixel(a),b=<span class="keyword">new</span> OpenLayers.Pixel(b,a));<span class="keyword">return</span> b&#125;,<span class="attr">getMapObjectPixelFromOLPixel</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="literal">null</span>!=a&amp;&amp;(b=<span class="keyword">this</span>.getMapObjectPixelFromXY(a.x,</span><br><span class="line">a.y));<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.EventPane"</span>&#125;);OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class(&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">initResolutions</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=[<span class="string">"minZoomLevel"</span>,<span class="string">"maxZoomLevel"</span>,<span class="string">"numZoomLevels"</span>],b=<span class="number">0</span>,c=a.length;b&lt;c;b++)&#123;<span class="keyword">var</span> d=a[b];<span class="keyword">this</span>[d]=<span class="literal">null</span>!=<span class="keyword">this</span>.options[d]?<span class="keyword">this</span>.options[d]:<span class="keyword">this</span>.map[d]&#125;<span class="keyword">if</span>(<span class="literal">null</span>==<span class="keyword">this</span>.minZoomLevel||<span class="keyword">this</span>.minZoomLevel&lt;<span class="keyword">this</span>.MIN_ZOOM_LEVEL)<span class="keyword">this</span>.minZoomLevel=<span class="keyword">this</span>.MIN_ZOOM_LEVEL;a=<span class="keyword">this</span>.MAX_ZOOM_LEVEL-<span class="keyword">this</span>.minZoomLevel+<span class="number">1</span>;b=<span class="literal">null</span>==<span class="keyword">this</span>.options.numZoomLevels&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.options.maxZoomLevel||<span class="literal">null</span>==<span class="keyword">this</span>.numZoomLevels&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.maxZoomLevel?</span><br><span class="line"><span class="keyword">this</span>.maxZoomLevel-<span class="keyword">this</span>.minZoomLevel+<span class="number">1</span>:<span class="keyword">this</span>.numZoomLevels;<span class="keyword">this</span>.numZoomLevels=<span class="literal">null</span>!=b?<span class="built_in">Math</span>.min(b,a):a;<span class="keyword">this</span>.maxZoomLevel=<span class="keyword">this</span>.minZoomLevel+<span class="keyword">this</span>.numZoomLevels<span class="number">-1</span>;<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.RESOLUTIONS)&#123;a=<span class="number">0</span>;<span class="keyword">this</span>.resolutions=[];<span class="keyword">for</span>(b=<span class="keyword">this</span>.minZoomLevel;b&lt;=<span class="keyword">this</span>.maxZoomLevel;b++)<span class="keyword">this</span>.resolutions[a++]=<span class="keyword">this</span>.RESOLUTIONS[b];<span class="keyword">this</span>.maxResolution=<span class="keyword">this</span>.resolutions[<span class="number">0</span>];<span class="keyword">this</span>.minResolution=<span class="keyword">this</span>.resolutions[<span class="keyword">this</span>.resolutions.length<span class="number">-1</span>]&#125;&#125;,<span class="attr">getResolution</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.resolutions)<span class="keyword">return</span> OpenLayers.Layer.prototype.getResolution.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>);<span class="keyword">var</span> a=<span class="literal">null</span>,b=<span class="keyword">this</span>.map.getSize(),c=<span class="keyword">this</span>.getExtent();<span class="literal">null</span>!=b&amp;&amp;<span class="literal">null</span>!=c&amp;&amp;(a=<span class="built_in">Math</span>.max(c.getWidth()/b.w,c.getHeight()/b.h));<span class="keyword">return</span> a&#125;,<span class="attr">getExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getSize(),b=<span class="keyword">this</span>.getLonLatFromViewPortPx(&#123;<span class="attr">x</span>:<span class="number">0</span>,<span class="attr">y</span>:<span class="number">0</span>&#125;),a=<span class="keyword">this</span>.getLonLatFromViewPortPx(&#123;<span class="attr">x</span>:a.w,<span class="attr">y</span>:a.h&#125;);<span class="keyword">return</span> <span class="literal">null</span>!=b&amp;&amp;<span class="literal">null</span>!=a?<span class="keyword">new</span> OpenLayers.Bounds(b.lon,a.lat,a.lon,b.lat):<span class="literal">null</span>&#125;,<span class="attr">getZoomForResolution</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.resolutions)<span class="keyword">return</span> OpenLayers.Layer.prototype.getZoomForResolution.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">var</span> b=OpenLayers.Layer.prototype.getExtent.apply(<span class="keyword">this</span>,</span><br><span class="line">[]);<span class="keyword">return</span> <span class="keyword">this</span>.getZoomForExtent(b)&#125;,<span class="attr">getOLZoomFromMapObjectZoom</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="literal">null</span>!=a&amp;&amp;(b=a-<span class="keyword">this</span>.minZoomLevel,<span class="keyword">this</span>.map.baseLayer!==<span class="keyword">this</span>&amp;&amp;(b=<span class="keyword">this</span>.map.baseLayer.getZoomForResolution(<span class="keyword">this</span>.getResolutionForZoom(b))));<span class="keyword">return</span> b&#125;,<span class="attr">getMapObjectZoomFromOLZoom</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="literal">null</span>!=a&amp;&amp;(b=a+<span class="keyword">this</span>.minZoomLevel,<span class="keyword">this</span>.map.baseLayer!==<span class="keyword">this</span>&amp;&amp;(b=<span class="keyword">this</span>.getZoomForResolution(<span class="keyword">this</span>.map.baseLayer.getResolutionForZoom(b))));<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.FixedZoomLevels"</span>&#125;);OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,&#123;<span class="attr">MIN_ZOOM_LEVEL</span>:<span class="number">0</span>,<span class="attr">MAX_ZOOM_LEVEL</span>:<span class="number">21</span>,<span class="attr">RESOLUTIONS</span>:[<span class="number">1.40625</span>,<span class="number">0.703125</span>,<span class="number">0.3515625</span>,<span class="number">0.17578125</span>,<span class="number">0.087890625</span>,<span class="number">0.0439453125</span>,<span class="number">0.02197265625</span>,<span class="number">0.010986328125</span>,<span class="number">0.0054931640625</span>,<span class="number">0.00274658203125</span>,<span class="number">0.001373291015625</span>,<span class="number">6.866455078125E-4</span>,<span class="number">3.4332275390625E-4</span>,<span class="number">1.71661376953125E-4</span>,<span class="number">8.58306884765625E-5</span>,<span class="number">4.291534423828125E-5</span>,<span class="number">2.145767211914062E-5</span>,<span class="number">1.072883605957031E-5</span>,<span class="number">5.36441802978515E-6</span>,<span class="number">2.68220901489257E-6</span>,<span class="number">1.341104507446289E-6</span>,<span class="number">6.705522537231445E-7</span>],</span><br><span class="line">type:<span class="literal">null</span>,<span class="attr">wrapDateLine</span>:!<span class="number">0</span>,<span class="attr">sphericalMercator</span>:!<span class="number">1</span>,<span class="attr">version</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=b||&#123;&#125;;b.version||(b.version=<span class="string">"function"</span>===<span class="keyword">typeof</span> GMap2?<span class="string">"2"</span>:<span class="string">"3"</span>);<span class="keyword">var</span> c=OpenLayers.Layer.Google[<span class="string">"v"</span>+b.version.replace(<span class="regexp">/\./g</span>,<span class="string">"_"</span>)];<span class="keyword">if</span>(c)OpenLayers.Util.applyDefaults(b,c);<span class="keyword">else</span> <span class="keyword">throw</span><span class="string">"Unsupported Google Maps API version: "</span>+b.version;OpenLayers.Util.applyDefaults(b,c.DEFAULTS);b.maxExtent&amp;&amp;(b.maxExtent=b.maxExtent.clone());OpenLayers.Layer.EventPane.prototype.initialize.apply(<span class="keyword">this</span>,[a,b]);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(<span class="keyword">this</span>,</span><br><span class="line">[a,b]);<span class="keyword">this</span>.sphericalMercator&amp;&amp;(OpenLayers.Util.extend(<span class="keyword">this</span>,OpenLayers.Layer.SphericalMercator),<span class="keyword">this</span>.initMercatorParameters())&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Layer.Google(<span class="keyword">this</span>.name,<span class="keyword">this</span>.getOptions())&#125;,<span class="attr">setVisibility</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>==<span class="keyword">this</span>.opacity?<span class="number">1</span>:<span class="keyword">this</span>.opacity;OpenLayers.Layer.EventPane.prototype.setVisibility.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.setOpacity(b)&#125;,<span class="attr">display</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>._dragging||<span class="keyword">this</span>.setGMapVisibility(a);OpenLayers.Layer.EventPane.prototype.display.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b,c</span>)</span>&#123;<span class="keyword">this</span>._dragging=c;OpenLayers.Layer.EventPane.prototype.moveTo.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">delete</span> <span class="keyword">this</span>._dragging&#125;,<span class="attr">setOpacity</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a!==<span class="keyword">this</span>.opacity&amp;&amp;(<span class="literal">null</span>!=<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.triggerEvent(<span class="string">"changelayer"</span>,&#123;<span class="attr">layer</span>:<span class="keyword">this</span>,<span class="attr">property</span>:<span class="string">"opacity"</span>&#125;),<span class="keyword">this</span>.opacity=a);<span class="keyword">if</span>(<span class="keyword">this</span>.getVisibility())&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getMapContainer();OpenLayers.Util.modifyDOMElement(b,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,a)&#125;&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.map)&#123;<span class="keyword">this</span>.setGMapVisibility(!<span class="number">1</span>);<span class="keyword">var</span> a=OpenLayers.Layer.Google.cache[<span class="keyword">this</span>.map.id];a&amp;&amp;<span class="number">1</span>&gt;=a.count&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.removeGMapElements()&#125;OpenLayers.Layer.EventPane.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">removeGMapElements</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Layer.Google.cache[<span class="keyword">this</span>.map.id];<span class="keyword">if</span>(a)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.mapObject&amp;&amp;<span class="keyword">this</span>.getMapContainer();b&amp;&amp;b.parentNode&amp;&amp;b.parentNode.removeChild(b);(b=a.termsOfUse)&amp;&amp;b.parentNode&amp;&amp;b.parentNode.removeChild(b);(a=a.poweredBy)&amp;&amp;a.parentNode&amp;&amp;a.parentNode.removeChild(a);<span class="keyword">this</span>.mapObject&amp;&amp;(<span class="built_in">window</span>.google&amp;&amp;google.maps&amp;&amp;google.maps.event&amp;&amp;google.maps.event.clearListeners)&amp;&amp;google.maps.event.clearListeners(<span class="keyword">this</span>.mapObject,</span><br><span class="line"><span class="string">"tilesloaded"</span>)&#125;&#125;,<span class="attr">removeMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.visibility&amp;&amp;<span class="keyword">this</span>.mapObject&amp;&amp;<span class="keyword">this</span>.setGMapVisibility(!<span class="number">1</span>);<span class="keyword">var</span> b=OpenLayers.Layer.Google.cache[a.id];b&amp;&amp;(<span class="number">1</span>&gt;=b.count?(<span class="keyword">this</span>.removeGMapElements(),<span class="keyword">delete</span> OpenLayers.Layer.Google.cache[a.id]):--b.count);<span class="keyword">delete</span> <span class="keyword">this</span>.termsOfUse;<span class="keyword">delete</span> <span class="keyword">this</span>.poweredBy;<span class="keyword">delete</span> <span class="keyword">this</span>.mapObject;<span class="keyword">delete</span> <span class="keyword">this</span>.dragObject;OpenLayers.Layer.EventPane.prototype.removeMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">getOLBoundsFromMapObjectBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="literal">null</span>!=a&amp;&amp;(b=a.getSouthWest(),a=a.getNorthEast(),<span class="keyword">this</span>.sphericalMercator?</span><br><span class="line">(b=<span class="keyword">this</span>.forwardMercator(b.lng(),b.lat()),a=<span class="keyword">this</span>.forwardMercator(a.lng(),a.lat())):(b=<span class="keyword">new</span> OpenLayers.LonLat(b.lng(),b.lat()),a=<span class="keyword">new</span> OpenLayers.LonLat(a.lng(),a.lat())),b=<span class="keyword">new</span> OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat));<span class="keyword">return</span> b&#125;,<span class="attr">getWarningHTML</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.i18n(<span class="string">"googleWarning"</span>)&#125;,<span class="attr">getMapObjectCenter</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.mapObject.getCenter()&#125;,<span class="attr">getMapObjectZoom</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.mapObject.getZoom()&#125;,<span class="attr">getLongitudeFromMapObjectLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.sphericalMercator?<span class="keyword">this</span>.forwardMercator(a.lng(),</span><br><span class="line">a.lat()).lon:a.lng()&#125;,<span class="attr">getLatitudeFromMapObjectLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.sphericalMercator?<span class="keyword">this</span>.forwardMercator(a.lng(),a.lat()).lat:a.lat()&#125;,<span class="attr">getXFromMapObjectPixel</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a.x&#125;,<span class="attr">getYFromMapObjectPixel</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a.y&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.Google"</span>&#125;);OpenLayers.Layer.Google.cache=&#123;&#125;;</span><br><span class="line">OpenLayers.Layer.Google.v2=&#123;<span class="attr">termsOfUse</span>:<span class="literal">null</span>,<span class="attr">poweredBy</span>:<span class="literal">null</span>,<span class="attr">dragObject</span>:<span class="literal">null</span>,<span class="attr">loadMapObject</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.type||(<span class="keyword">this</span>.type=G_NORMAL_MAP);<span class="keyword">var</span> a,b,c,d=OpenLayers.Layer.Google.cache[<span class="keyword">this</span>.map.id];<span class="keyword">if</span>(d)a=d.mapObject,b=d.termsOfUse,c=d.poweredBy,++d.count;<span class="keyword">else</span>&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.map.viewPortDiv,e=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);e.id=<span class="keyword">this</span>.map.id+<span class="string">"_GMap2Container"</span>;e.style.position=<span class="string">"absolute"</span>;e.style.width=<span class="string">"100%"</span>;e.style.height=<span class="string">"100%"</span>;d.appendChild(e);<span class="keyword">try</span>&#123;a=<span class="keyword">new</span> GMap2(e),b=e.lastChild,d.appendChild(b),b.style.zIndex=</span><br><span class="line"><span class="string">"1100"</span>,b.style.right=<span class="string">""</span>,b.style.bottom=<span class="string">""</span>,b.className=<span class="string">"olLayerGoogleCopyright"</span>,c=e.lastChild,d.appendChild(c),c.style.zIndex=<span class="string">"1100"</span>,c.style.right=<span class="string">""</span>,c.style.bottom=<span class="string">""</span>,c.className=<span class="string">"olLayerGooglePoweredBy gmnoprint"</span>&#125;<span class="keyword">catch</span>(f)&#123;<span class="keyword">throw</span> f;&#125;OpenLayers.Layer.Google.cache[<span class="keyword">this</span>.map.id]=&#123;<span class="attr">mapObject</span>:a,<span class="attr">termsOfUse</span>:b,<span class="attr">poweredBy</span>:c,<span class="attr">count</span>:<span class="number">1</span>&#125;&#125;<span class="keyword">this</span>.mapObject=a;<span class="keyword">this</span>.termsOfUse=b;<span class="keyword">this</span>.poweredBy=c;<span class="number">-1</span>===OpenLayers.Util.indexOf(<span class="keyword">this</span>.mapObject.getMapTypes(),<span class="keyword">this</span>.type)&amp;&amp;<span class="keyword">this</span>.mapObject.addMapType(<span class="keyword">this</span>.type);<span class="string">"function"</span>==<span class="keyword">typeof</span> a.getDragObject?</span><br><span class="line"><span class="keyword">this</span>.dragObject=a.getDragObject():<span class="keyword">this</span>.dragPanMapObject=<span class="literal">null</span>;!<span class="number">1</span>===<span class="keyword">this</span>.isBaseLayer&amp;&amp;<span class="keyword">this</span>.setGMapVisibility(<span class="string">"none"</span>!==<span class="keyword">this</span>.div.style.display)&#125;,<span class="attr">onMapResize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.visibility&amp;&amp;<span class="keyword">this</span>.mapObject.isLoaded())<span class="keyword">this</span>.mapObject.checkResize();<span class="keyword">else</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>._resized)<span class="keyword">var</span> a=<span class="keyword">this</span>,b=GEvent.addListener(<span class="keyword">this</span>.mapObject,<span class="string">"load"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;GEvent.removeListener(b);<span class="keyword">delete</span> a._resized;a.mapObject.checkResize();a.moveTo(a.map.getCenter(),a.map.getZoom())&#125;);<span class="keyword">this</span>._resized=!<span class="number">0</span>&#125;&#125;,<span class="attr">setGMapVisibility</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Layer.Google.cache[<span class="keyword">this</span>.map.id];</span><br><span class="line"><span class="keyword">if</span>(b)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.mapObject.getContainer();!<span class="number">0</span>===a?(<span class="keyword">this</span>.mapObject.setMapType(<span class="keyword">this</span>.type),c.style.display=<span class="string">""</span>,<span class="keyword">this</span>.termsOfUse.style.left=<span class="string">""</span>,<span class="keyword">this</span>.termsOfUse.style.display=<span class="string">""</span>,<span class="keyword">this</span>.poweredBy.style.display=<span class="string">""</span>,b.displayed=<span class="keyword">this</span>.id):(b.displayed===<span class="keyword">this</span>.id&amp;&amp;<span class="keyword">delete</span> b.displayed,b.displayed||(c.style.display=<span class="string">"none"</span>,<span class="keyword">this</span>.termsOfUse.style.display=<span class="string">"none"</span>,<span class="keyword">this</span>.termsOfUse.style.left=<span class="string">"-9999px"</span>,<span class="keyword">this</span>.poweredBy.style.display=<span class="string">"none"</span>))&#125;&#125;,<span class="attr">getMapContainer</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.mapObject.getContainer()&#125;,<span class="attr">getMapObjectBoundsFromOLBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="literal">null</span>;<span class="literal">null</span>!=a&amp;&amp;(b=<span class="keyword">this</span>.sphericalMercator?<span class="keyword">this</span>.inverseMercator(a.bottom,a.left):<span class="keyword">new</span> OpenLayers.LonLat(a.bottom,a.left),a=<span class="keyword">this</span>.sphericalMercator?<span class="keyword">this</span>.inverseMercator(a.top,a.right):<span class="keyword">new</span> OpenLayers.LonLat(a.top,a.right),b=<span class="keyword">new</span> GLatLngBounds(<span class="keyword">new</span> GLatLng(b.lat,b.lon),<span class="keyword">new</span> GLatLng(a.lat,a.lon)));<span class="keyword">return</span> b&#125;,<span class="attr">setMapObjectCenter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.mapObject.setCenter(a,b)&#125;,<span class="attr">dragPanMapObject</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.dragObject.moveBy(<span class="keyword">new</span> GSize(-a,b))&#125;,<span class="attr">getMapObjectLonLatFromMapObjectPixel</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.mapObject.fromContainerPixelToLatLng(a)&#125;,</span><br><span class="line">getMapObjectPixelFromMapObjectLonLat:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.mapObject.fromLatLngToContainerPixel(a)&#125;,<span class="attr">getMapObjectZoomFromMapObjectBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.mapObject.getBoundsZoomLevel(a)&#125;,<span class="attr">getMapObjectLonLatFromLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c;<span class="keyword">this</span>.sphericalMercator?(c=<span class="keyword">this</span>.inverseMercator(a,b),c=<span class="keyword">new</span> GLatLng(c.lat,c.lon)):c=<span class="keyword">new</span> GLatLng(b,a);<span class="keyword">return</span> c&#125;,<span class="attr">getMapObjectPixelFromXY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> GPoint(a,b)&#125;&#125;;OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,&#123;<span class="attr">namespaces</span>:<span class="literal">null</span>,<span class="attr">namespaceAlias</span>:<span class="literal">null</span>,<span class="attr">defaultPrefix</span>:<span class="literal">null</span>,<span class="attr">readers</span>:&#123;&#125;,<span class="attr">writers</span>:&#123;&#125;,<span class="attr">xmldom</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="built_in">window</span>.ActiveXObject&amp;&amp;(<span class="keyword">this</span>.xmldom=<span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLDOM"</span>));OpenLayers.Format.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.namespaces=OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>.namespaces);<span class="keyword">this</span>.namespaceAlias=&#123;&#125;;<span class="keyword">for</span>(<span class="keyword">var</span> b <span class="keyword">in</span> <span class="keyword">this</span>.namespaces)<span class="keyword">this</span>.namespaceAlias[<span class="keyword">this</span>.namespaces[b]]=b&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.xmldom=<span class="literal">null</span>;OpenLayers.Format.prototype.destroy.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>)&#125;,<span class="attr">setNamespace</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.namespaces[a]=b;<span class="keyword">this</span>.namespaceAlias[b]=a&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.indexOf(<span class="string">"&lt;"</span>);<span class="number">0</span>&lt;b&amp;&amp;(a=a.substring(b));b=OpenLayers.Util.Try(OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> b;b=<span class="built_in">window</span>.ActiveXObject&amp;&amp;!<span class="keyword">this</span>.xmldom?<span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLDOM"</span>):<span class="keyword">this</span>.xmldom;b.loadXML(a);<span class="keyword">return</span> b&#125;,<span class="keyword">this</span>),<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>(<span class="keyword">new</span> DOMParser).parseFromString(a,<span class="string">"text/xml"</span>)&#125;,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">new</span> XMLHttpRequest;b.open(<span class="string">"GET"</span>,<span class="string">"data:text/xml;charset=utf-8,"</span>+<span class="built_in">encodeURIComponent</span>(a),!<span class="number">1</span>);b.overrideMimeType&amp;&amp;</span><br><span class="line">b.overrideMimeType(<span class="string">"text/xml"</span>);b.send(<span class="literal">null</span>);<span class="keyword">return</span> b.responseXML&#125;);<span class="keyword">this</span>.keepData&amp;&amp;(<span class="keyword">this</span>.data=b);<span class="keyword">return</span> b&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.xmldom)a=a.xml;<span class="keyword">else</span>&#123;<span class="keyword">var</span> b=<span class="keyword">new</span> XMLSerializer;<span class="keyword">if</span>(<span class="number">1</span>==a.nodeType)&#123;<span class="keyword">var</span> c=<span class="built_in">document</span>.implementation.createDocument(<span class="string">""</span>,<span class="string">""</span>,<span class="literal">null</span>);c.importNode&amp;&amp;(a=c.importNode(a,!<span class="number">0</span>));c.appendChild(a);a=b.serializeToString(c)&#125;<span class="keyword">else</span> a=b.serializeToString(a)&#125;<span class="keyword">return</span> a&#125;,<span class="attr">createElementNS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.xmldom?<span class="string">"string"</span>==<span class="keyword">typeof</span> a?<span class="keyword">this</span>.xmldom.createNode(<span class="number">1</span>,b,a):<span class="keyword">this</span>.xmldom.createNode(<span class="number">1</span>,b,<span class="string">""</span>):<span class="built_in">document</span>.createElementNS(a,</span><br><span class="line">b)&#125;,<span class="attr">createDocumentFragment</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.xmldom?<span class="keyword">this</span>.xmldom.createDocumentFragment():<span class="built_in">document</span>.createDocumentFragment()&#125;,<span class="attr">createTextNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>!==<span class="keyword">typeof</span> a&amp;&amp;(a=<span class="built_in">String</span>(a));<span class="keyword">return</span> <span class="keyword">this</span>.xmldom?<span class="keyword">this</span>.xmldom.createTextNode(a):<span class="built_in">document</span>.createTextNode(a)&#125;,<span class="attr">getElementsByTagNameNS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=[];<span class="keyword">if</span>(a.getElementsByTagNameNS)d=a.getElementsByTagNameNS(b,c);<span class="keyword">else</span>&#123;a=a.getElementsByTagName(<span class="string">"*"</span>);<span class="keyword">for</span>(<span class="keyword">var</span> e,f,g=<span class="number">0</span>,h=a.length;g&lt;h;++g)<span class="keyword">if</span>(e=a[g],f=e.prefix?e.prefix+<span class="string">":"</span>+c:c,<span class="string">"*"</span>==c||f==e.nodeName)<span class="string">"*"</span>!=</span><br><span class="line">b&amp;&amp;b!=e.namespaceURI||d.push(e)&#125;<span class="keyword">return</span> d&#125;,<span class="attr">getAttributeNodeNS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=<span class="literal">null</span>;<span class="keyword">if</span>(a.getAttributeNodeNS)d=a.getAttributeNodeNS(b,c);<span class="keyword">else</span>&#123;a=a.attributes;<span class="keyword">for</span>(<span class="keyword">var</span> e,f,g=<span class="number">0</span>,h=a.length;g&lt;h;++g)<span class="keyword">if</span>(e=a[g],e.namespaceURI==b&amp;&amp;(f=e.prefix?e.prefix+<span class="string">":"</span>+c:c,f==e.nodeName))&#123;d=e;<span class="keyword">break</span>&#125;&#125;<span class="keyword">return</span> d&#125;,<span class="attr">getAttributeNS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=<span class="string">""</span>;<span class="keyword">if</span>(a.getAttributeNS)d=a.getAttributeNS(b,c)||<span class="string">""</span>;<span class="keyword">else</span> <span class="keyword">if</span>(a=<span class="keyword">this</span>.getAttributeNodeNS(a,b,c))d=a.nodeValue;<span class="keyword">return</span> d&#125;,<span class="attr">getChildValue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=b||<span class="string">""</span>;<span class="keyword">if</span>(a)<span class="keyword">for</span>(<span class="keyword">var</span> d=a.firstChild;d;d=</span><br><span class="line">d.nextSibling)<span class="keyword">switch</span>(d.nodeType)&#123;<span class="keyword">case</span> <span class="number">3</span>:<span class="keyword">case</span> <span class="number">4</span>:c+=d.nodeValue&#125;<span class="keyword">return</span> c&#125;,<span class="attr">isSimpleContent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">0</span>;<span class="keyword">for</span>(a=a.firstChild;a;a=a.nextSibling)<span class="keyword">if</span>(<span class="number">1</span>===a.nodeType)&#123;b=!<span class="number">1</span>;<span class="keyword">break</span>&#125;<span class="keyword">return</span> b&#125;,<span class="attr">contentType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>,c=!<span class="number">1</span>,d=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY;<span class="keyword">for</span>(a=a.firstChild;a;a=a.nextSibling)&#123;<span class="keyword">switch</span>(a.nodeType)&#123;<span class="keyword">case</span> <span class="number">1</span>:c=!<span class="number">0</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">8</span>:<span class="keyword">break</span>;<span class="keyword">default</span>:b=!<span class="number">0</span>&#125;<span class="keyword">if</span>(c&amp;&amp;b)<span class="keyword">break</span>&#125;<span class="keyword">if</span>(c&amp;&amp;b)d=OpenLayers.Format.XML.CONTENT_TYPE.MIXED;<span class="keyword">else</span>&#123;<span class="keyword">if</span>(c)<span class="keyword">return</span> OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX;<span class="keyword">if</span>(b)<span class="keyword">return</span> OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE&#125;<span class="keyword">return</span> d&#125;,</span><br><span class="line">hasAttributeNS:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=!<span class="number">1</span>;<span class="keyword">return</span> d=a.hasAttributeNS?a.hasAttributeNS(b,c):!!<span class="keyword">this</span>.getAttributeNodeNS(a,b,c)&#125;,<span class="attr">setAttributeNS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">if</span>(a.setAttributeNS)a.setAttributeNS(b,c,d);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.xmldom)b?(b=a.ownerDocument.createNode(<span class="number">2</span>,c,b),b.nodeValue=d,a.setAttributeNode(b)):a.setAttribute(c,d);<span class="keyword">else</span> <span class="keyword">throw</span><span class="string">"setAttributeNS not implemented"</span>;&#125;,<span class="attr">createElementNSPlus</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=b||&#123;&#125;;<span class="keyword">var</span> c=b.uri||<span class="keyword">this</span>.namespaces[b.prefix];c||(c=a.indexOf(<span class="string">":"</span>),c=<span class="keyword">this</span>.namespaces[a.substring(<span class="number">0</span>,c)]);c||</span><br><span class="line">(c=<span class="keyword">this</span>.namespaces[<span class="keyword">this</span>.defaultPrefix]);c=<span class="keyword">this</span>.createElementNS(c,a);b.attributes&amp;&amp;<span class="keyword">this</span>.setAttributes(c,b.attributes);<span class="keyword">var</span> d=b.value;<span class="literal">null</span>!=d&amp;&amp;c.appendChild(<span class="keyword">this</span>.createTextNode(d));<span class="keyword">return</span> c&#125;,<span class="attr">setAttributes</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c,d,e;<span class="keyword">for</span>(e <span class="keyword">in</span> b)<span class="literal">null</span>!=b[e]&amp;&amp;b[e].toString&amp;&amp;(c=b[e].toString(),d=<span class="keyword">this</span>.namespaces[e.substring(<span class="number">0</span>,e.indexOf(<span class="string">":"</span>))]||<span class="literal">null</span>,<span class="keyword">this</span>.setAttributeNS(a,d,e,c))&#125;,<span class="attr">readNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b||(b=&#123;&#125;);<span class="keyword">var</span> c=<span class="keyword">this</span>.readers[a.namespaceURI?<span class="keyword">this</span>.namespaceAlias[a.namespaceURI]:<span class="keyword">this</span>.defaultPrefix];<span class="keyword">if</span>(c)&#123;<span class="keyword">var</span> d=</span><br><span class="line">a.localName||a.nodeName.split(<span class="string">":"</span>).pop();(c=c[d]||c[<span class="string">"*"</span>])&amp;&amp;c.apply(<span class="keyword">this</span>,[a,b])&#125;<span class="keyword">return</span> b&#125;,<span class="attr">readChildNodes</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b||(b=&#123;&#125;);<span class="keyword">for</span>(<span class="keyword">var</span> c=a.childNodes,d,e=<span class="number">0</span>,f=c.length;e&lt;f;++e)d=c[e],<span class="number">1</span>==d.nodeType&amp;&amp;<span class="keyword">this</span>.readNode(d,b);<span class="keyword">return</span> b&#125;,<span class="attr">writeNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d,e=a.indexOf(<span class="string">":"</span>);<span class="number">0</span>&lt;e?(d=a.substring(<span class="number">0</span>,e),a=a.substring(e+<span class="number">1</span>)):d=c?<span class="keyword">this</span>.namespaceAlias[c.namespaceURI]:<span class="keyword">this</span>.defaultPrefix;b=<span class="keyword">this</span>.writers[d][a].apply(<span class="keyword">this</span>,[b]);c&amp;&amp;c.appendChild(b);<span class="keyword">return</span> b&#125;,<span class="attr">getChildEl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">return</span> a&amp;&amp;<span class="keyword">this</span>.getThisOrNextEl(a.firstChild,</span><br><span class="line">b,c)&#125;,<span class="attr">getNextEl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">return</span> a&amp;&amp;<span class="keyword">this</span>.getThisOrNextEl(a.nextSibling,b,c)&#125;,<span class="attr">getThisOrNextEl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;a:<span class="keyword">for</span>(;a;a=a.nextSibling)<span class="keyword">switch</span>(a.nodeType)&#123;<span class="keyword">case</span> <span class="number">1</span>:<span class="keyword">if</span>(!(b&amp;&amp;b!==(a.localName||a.nodeName.split(<span class="string">":"</span>).pop())||c&amp;&amp;c!==a.namespaceURI))<span class="keyword">break</span> a;a=<span class="literal">null</span>;<span class="keyword">break</span> a;<span class="keyword">case</span> <span class="number">3</span>:<span class="keyword">if</span>(<span class="regexp">/^\s*$/</span>.test(a.nodeValue))<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">4</span>:<span class="keyword">case</span> <span class="number">6</span>:<span class="keyword">case</span> <span class="number">12</span>:<span class="keyword">case</span> <span class="number">10</span>:<span class="keyword">case</span> <span class="number">11</span>:a=<span class="literal">null</span>;<span class="keyword">break</span> a&#125;<span class="keyword">return</span> a||<span class="literal">null</span>&#125;,<span class="attr">lookupNamespaceURI</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>;<span class="keyword">if</span>(a)<span class="keyword">if</span>(a.lookupNamespaceURI)c=a.lookupNamespaceURI(b);<span class="keyword">else</span> a:<span class="keyword">switch</span>(a.nodeType)&#123;<span class="keyword">case</span> <span class="number">1</span>:<span class="keyword">if</span>(<span class="literal">null</span>!==</span><br><span class="line">a.namespaceURI&amp;&amp;a.prefix===b)&#123;c=a.namespaceURI;<span class="keyword">break</span> a&#125;<span class="keyword">if</span>(c=a.attributes.length)<span class="keyword">for</span>(<span class="keyword">var</span> d,e=<span class="number">0</span>;e&lt;c;++e)<span class="keyword">if</span>(d=a.attributes[e],<span class="string">"xmlns"</span>===d.prefix&amp;&amp;d.name===<span class="string">"xmlns:"</span>+b)&#123;c=d.value||<span class="literal">null</span>;<span class="keyword">break</span> a&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"xmlns"</span>===d.name&amp;&amp;<span class="literal">null</span>===b)&#123;c=d.value||<span class="literal">null</span>;<span class="keyword">break</span> a&#125;c=<span class="keyword">this</span>.lookupNamespaceURI(a.parentNode,b);<span class="keyword">break</span> a;<span class="keyword">case</span> <span class="number">2</span>:c=<span class="keyword">this</span>.lookupNamespaceURI(a.ownerElement,b);<span class="keyword">break</span> a;<span class="keyword">case</span> <span class="number">9</span>:c=<span class="keyword">this</span>.lookupNamespaceURI(a.documentElement,b);<span class="keyword">break</span> a;<span class="keyword">case</span> <span class="number">6</span>:<span class="keyword">case</span> <span class="number">12</span>:<span class="keyword">case</span> <span class="number">10</span>:<span class="keyword">case</span> <span class="number">11</span>:<span class="keyword">break</span> a;<span class="keyword">default</span>:c=<span class="keyword">this</span>.lookupNamespaceURI(a.parentNode,</span><br><span class="line">b)&#125;<span class="keyword">return</span> c&#125;,<span class="attr">getXMLDoc</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Format.XML.document||<span class="keyword">this</span>.xmldom||(<span class="built_in">document</span>.implementation&amp;&amp;<span class="built_in">document</span>.implementation.createDocument?OpenLayers.Format.XML.document=<span class="built_in">document</span>.implementation.createDocument(<span class="string">""</span>,<span class="string">""</span>,<span class="literal">null</span>):!<span class="keyword">this</span>.xmldom&amp;&amp;<span class="built_in">window</span>.ActiveXObject&amp;&amp;(<span class="keyword">this</span>.xmldom=<span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLDOM"</span>)));<span class="keyword">return</span> OpenLayers.Format.XML.document||<span class="keyword">this</span>.xmldom&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.XML"</span>&#125;);OpenLayers.Format.XML.CONTENT_TYPE=&#123;<span class="attr">EMPTY</span>:<span class="number">0</span>,<span class="attr">SIMPLE</span>:<span class="number">1</span>,<span class="attr">COMPLEX</span>:<span class="number">2</span>,<span class="attr">MIXED</span>:<span class="number">3</span>&#125;;</span><br><span class="line">OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype);OpenLayers.Format.XML.document=<span class="literal">null</span>;OpenLayers.Format.WFST=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.WFST.DEFAULTS);<span class="keyword">var</span> b=OpenLayers.Format.WFST[<span class="string">"v"</span>+a.version.replace(<span class="regexp">/\./g</span>,<span class="string">"_"</span>)];<span class="keyword">if</span>(!b)<span class="keyword">throw</span><span class="string">"Unsupported WFST version: "</span>+a.version;<span class="keyword">return</span> <span class="keyword">new</span> b(a)&#125;;OpenLayers.Format.WFST.DEFAULTS=&#123;<span class="attr">version</span>:<span class="string">"1.0.0"</span>&#125;;OpenLayers.Feature=OpenLayers.Class(&#123;<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">id</span>:<span class="literal">null</span>,<span class="attr">lonlat</span>:<span class="literal">null</span>,<span class="attr">data</span>:<span class="literal">null</span>,<span class="attr">marker</span>:<span class="literal">null</span>,<span class="attr">popupClass</span>:<span class="literal">null</span>,<span class="attr">popup</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">this</span>.layer=a;<span class="keyword">this</span>.lonlat=b;<span class="keyword">this</span>.data=<span class="literal">null</span>!=c?c:&#123;&#125;;<span class="keyword">this</span>.id=OpenLayers.Util.createUniqueID(<span class="keyword">this</span>.CLASS_NAME+<span class="string">"_"</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="literal">null</span>!=<span class="keyword">this</span>.layer&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.layer.map&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.popup&amp;&amp;<span class="keyword">this</span>.layer.map.removePopup(<span class="keyword">this</span>.popup);<span class="literal">null</span>!=<span class="keyword">this</span>.layer&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.marker&amp;&amp;<span class="keyword">this</span>.layer.removeMarker(<span class="keyword">this</span>.marker);<span class="keyword">this</span>.data=<span class="keyword">this</span>.lonlat=<span class="keyword">this</span>.id=<span class="keyword">this</span>.layer=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.marker&amp;&amp;</span><br><span class="line">(<span class="keyword">this</span>.destroyMarker(<span class="keyword">this</span>.marker),<span class="keyword">this</span>.marker=<span class="literal">null</span>);<span class="literal">null</span>!=<span class="keyword">this</span>.popup&amp;&amp;(<span class="keyword">this</span>.destroyPopup(<span class="keyword">this</span>.popup),<span class="keyword">this</span>.popup=<span class="literal">null</span>)&#125;,<span class="attr">onScreen</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.layer&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.layer.map&amp;&amp;(a=<span class="keyword">this</span>.layer.map.getExtent().containsLonLat(<span class="keyword">this</span>.lonlat));<span class="keyword">return</span> a&#125;,<span class="attr">createMarker</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="literal">null</span>!=<span class="keyword">this</span>.lonlat&amp;&amp;(<span class="keyword">this</span>.marker=<span class="keyword">new</span> OpenLayers.Marker(<span class="keyword">this</span>.lonlat,<span class="keyword">this</span>.data.icon));<span class="keyword">return</span> <span class="keyword">this</span>.marker&#125;,<span class="attr">destroyMarker</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.marker.destroy()&#125;,<span class="attr">createPopup</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>!=<span class="keyword">this</span>.lonlat&amp;&amp;(<span class="keyword">this</span>.popup||(<span class="keyword">this</span>.popup=<span class="keyword">new</span> (<span class="keyword">this</span>.popupClass?</span><br><span class="line"><span class="keyword">this</span>.popupClass:OpenLayers.Popup.Anchored)(<span class="keyword">this</span>.id+<span class="string">"_popup"</span>,<span class="keyword">this</span>.lonlat,<span class="keyword">this</span>.data.popupSize,<span class="keyword">this</span>.data.popupContentHTML,<span class="keyword">this</span>.marker?<span class="keyword">this</span>.marker.icon:<span class="literal">null</span>,a)),<span class="literal">null</span>!=<span class="keyword">this</span>.data.overflow&amp;&amp;(<span class="keyword">this</span>.popup.contentDiv.style.overflow=<span class="keyword">this</span>.data.overflow),<span class="keyword">this</span>.popup.feature=<span class="keyword">this</span>);<span class="keyword">return</span> <span class="keyword">this</span>.popup&#125;,<span class="attr">destroyPopup</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.popup&amp;&amp;(<span class="keyword">this</span>.popup.feature=<span class="literal">null</span>,<span class="keyword">this</span>.popup.destroy(),<span class="keyword">this</span>.popup=<span class="literal">null</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Feature"</span>&#125;);OpenLayers.State=&#123;<span class="attr">UNKNOWN</span>:<span class="string">"Unknown"</span>,<span class="attr">INSERT</span>:<span class="string">"Insert"</span>,<span class="attr">UPDATE</span>:<span class="string">"Update"</span>,<span class="attr">DELETE</span>:<span class="string">"Delete"</span>&#125;;</span><br><span class="line">OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,&#123;<span class="attr">fid</span>:<span class="literal">null</span>,<span class="attr">geometry</span>:<span class="literal">null</span>,<span class="attr">attributes</span>:<span class="literal">null</span>,<span class="attr">bounds</span>:<span class="literal">null</span>,<span class="attr">state</span>:<span class="literal">null</span>,<span class="attr">style</span>:<span class="literal">null</span>,<span class="attr">url</span>:<span class="literal">null</span>,<span class="attr">renderIntent</span>:<span class="string">"default"</span>,<span class="attr">modified</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Feature.prototype.initialize.apply(<span class="keyword">this</span>,[<span class="literal">null</span>,<span class="literal">null</span>,b]);<span class="keyword">this</span>.lonlat=<span class="literal">null</span>;<span class="keyword">this</span>.geometry=a?a:<span class="literal">null</span>;<span class="keyword">this</span>.state=<span class="literal">null</span>;<span class="keyword">this</span>.attributes=&#123;&#125;;b&amp;&amp;(<span class="keyword">this</span>.attributes=OpenLayers.Util.extend(<span class="keyword">this</span>.attributes,b));<span class="keyword">this</span>.style=c?c:<span class="literal">null</span>&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.layer&amp;&amp;(<span class="keyword">this</span>.layer.removeFeatures(<span class="keyword">this</span>),<span class="keyword">this</span>.layer=</span><br><span class="line"><span class="literal">null</span>);<span class="keyword">this</span>.modified=<span class="keyword">this</span>.geometry=<span class="literal">null</span>;OpenLayers.Feature.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">this</span>.geometry?<span class="keyword">this</span>.geometry.clone():<span class="literal">null</span>,<span class="keyword">this</span>.attributes,<span class="keyword">this</span>.style)&#125;,<span class="attr">onScreen</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;<span class="keyword">this</span>.layer&amp;&amp;<span class="keyword">this</span>.layer.map&amp;&amp;(b=<span class="keyword">this</span>.layer.map.getExtent(),a?(a=<span class="keyword">this</span>.geometry.getBounds(),b=b.intersectsBounds(a)):b=b.toGeometry().intersects(<span class="keyword">this</span>.geometry));<span class="keyword">return</span> b&#125;,<span class="attr">getVisibility</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>!(<span class="keyword">this</span>.style&amp;&amp;<span class="string">"none"</span>==<span class="keyword">this</span>.style.display||!<span class="keyword">this</span>.layer||</span><br><span class="line"><span class="keyword">this</span>.layer&amp;&amp;<span class="keyword">this</span>.layer.styleMap&amp;&amp;<span class="string">"none"</span>==<span class="keyword">this</span>.layer.styleMap.createSymbolizer(<span class="keyword">this</span>,<span class="keyword">this</span>.renderIntent).display||<span class="keyword">this</span>.layer&amp;&amp;!<span class="keyword">this</span>.layer.getVisibility())&#125;,<span class="attr">createMarker</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="literal">null</span>&#125;,<span class="attr">destroyMarker</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">createPopup</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="literal">null</span>&#125;,<span class="attr">atPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=!<span class="number">1</span>;<span class="keyword">this</span>.geometry&amp;&amp;(d=<span class="keyword">this</span>.geometry.atPoint(a,b,c));<span class="keyword">return</span> d&#125;,<span class="attr">destroyPopup</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">move</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.layer&amp;&amp;<span class="keyword">this</span>.geometry.move)&#123;a=<span class="string">"OpenLayers.LonLat"</span>==a.CLASS_NAME?<span class="keyword">this</span>.layer.getViewPortPxFromLonLat(a):a;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.layer.getViewPortPxFromLonLat(<span class="keyword">this</span>.geometry.getBounds().getCenterLonLat()),c=<span class="keyword">this</span>.layer.map.getResolution();<span class="keyword">this</span>.geometry.move(c*(a.x-b.x),c*(b.y-a.y));<span class="keyword">this</span>.layer.drawFeature(<span class="keyword">this</span>);<span class="keyword">return</span> b&#125;&#125;,<span class="attr">toState</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a==OpenLayers.State.UPDATE)<span class="keyword">switch</span>(<span class="keyword">this</span>.state)&#123;<span class="keyword">case</span> OpenLayers.State.UNKNOWN:<span class="keyword">case</span> OpenLayers.State.DELETE:<span class="keyword">this</span>.state=a&#125;<span class="keyword">else</span> <span class="keyword">if</span>(a==OpenLayers.State.INSERT)<span class="keyword">switch</span>(<span class="keyword">this</span>.state)&#123;<span class="keyword">case</span> OpenLayers.State.UNKNOWN:<span class="keyword">break</span>;<span class="keyword">default</span>:<span class="keyword">this</span>.state=a&#125;<span class="keyword">else</span> <span class="keyword">if</span>(a==OpenLayers.State.DELETE)<span class="keyword">switch</span>(<span class="keyword">this</span>.state)&#123;<span class="keyword">case</span> OpenLayers.State.UNKNOWN:<span class="keyword">case</span> OpenLayers.State.UPDATE:<span class="keyword">this</span>.state=</span><br><span class="line">a&#125;<span class="keyword">else</span> a==OpenLayers.State.UNKNOWN&amp;&amp;(<span class="keyword">this</span>.state=a)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Feature.Vector"</span>&#125;);</span><br><span class="line">OpenLayers.Feature.Vector.style=&#123;<span class="string">"default"</span>:&#123;<span class="attr">fillColor</span>:<span class="string">"#ee9900"</span>,<span class="attr">fillOpacity</span>:<span class="number">0.4</span>,<span class="attr">hoverFillColor</span>:<span class="string">"white"</span>,<span class="attr">hoverFillOpacity</span>:<span class="number">0.8</span>,<span class="attr">strokeColor</span>:<span class="string">"#ee9900"</span>,<span class="attr">strokeOpacity</span>:<span class="number">1</span>,<span class="attr">strokeWidth</span>:<span class="number">1</span>,<span class="attr">strokeLinecap</span>:<span class="string">"round"</span>,<span class="attr">strokeDashstyle</span>:<span class="string">"solid"</span>,<span class="attr">hoverStrokeColor</span>:<span class="string">"red"</span>,<span class="attr">hoverStrokeOpacity</span>:<span class="number">1</span>,<span class="attr">hoverStrokeWidth</span>:<span class="number">0.2</span>,<span class="attr">pointRadius</span>:<span class="number">6</span>,<span class="attr">hoverPointRadius</span>:<span class="number">1</span>,<span class="attr">hoverPointUnit</span>:<span class="string">"%"</span>,<span class="attr">pointerEvents</span>:<span class="string">"visiblePainted"</span>,<span class="attr">cursor</span>:<span class="string">"inherit"</span>,<span class="attr">fontColor</span>:<span class="string">"#000000"</span>,<span class="attr">labelAlign</span>:<span class="string">"cm"</span>,<span class="attr">labelOutlineColor</span>:<span class="string">"white"</span>,<span class="attr">labelOutlineWidth</span>:<span class="number">3</span>&#125;,<span class="attr">select</span>:&#123;<span class="attr">fillColor</span>:<span class="string">"blue"</span>,<span class="attr">fillOpacity</span>:<span class="number">0.4</span>,</span><br><span class="line">hoverFillColor:<span class="string">"white"</span>,<span class="attr">hoverFillOpacity</span>:<span class="number">0.8</span>,<span class="attr">strokeColor</span>:<span class="string">"blue"</span>,<span class="attr">strokeOpacity</span>:<span class="number">1</span>,<span class="attr">strokeWidth</span>:<span class="number">2</span>,<span class="attr">strokeLinecap</span>:<span class="string">"round"</span>,<span class="attr">strokeDashstyle</span>:<span class="string">"solid"</span>,<span class="attr">hoverStrokeColor</span>:<span class="string">"red"</span>,<span class="attr">hoverStrokeOpacity</span>:<span class="number">1</span>,<span class="attr">hoverStrokeWidth</span>:<span class="number">0.2</span>,<span class="attr">pointRadius</span>:<span class="number">6</span>,<span class="attr">hoverPointRadius</span>:<span class="number">1</span>,<span class="attr">hoverPointUnit</span>:<span class="string">"%"</span>,<span class="attr">pointerEvents</span>:<span class="string">"visiblePainted"</span>,<span class="attr">cursor</span>:<span class="string">"pointer"</span>,<span class="attr">fontColor</span>:<span class="string">"#000000"</span>,<span class="attr">labelAlign</span>:<span class="string">"cm"</span>,<span class="attr">labelOutlineColor</span>:<span class="string">"white"</span>,<span class="attr">labelOutlineWidth</span>:<span class="number">3</span>&#125;,<span class="attr">temporary</span>:&#123;<span class="attr">fillColor</span>:<span class="string">"#66cccc"</span>,<span class="attr">fillOpacity</span>:<span class="number">0.2</span>,<span class="attr">hoverFillColor</span>:<span class="string">"white"</span>,<span class="attr">hoverFillOpacity</span>:<span class="number">0.8</span>,<span class="attr">strokeColor</span>:<span class="string">"#66cccc"</span>,<span class="attr">strokeOpacity</span>:<span class="number">1</span>,</span><br><span class="line">strokeLinecap:<span class="string">"round"</span>,<span class="attr">strokeWidth</span>:<span class="number">2</span>,<span class="attr">strokeDashstyle</span>:<span class="string">"solid"</span>,<span class="attr">hoverStrokeColor</span>:<span class="string">"red"</span>,<span class="attr">hoverStrokeOpacity</span>:<span class="number">1</span>,<span class="attr">hoverStrokeWidth</span>:<span class="number">0.2</span>,<span class="attr">pointRadius</span>:<span class="number">6</span>,<span class="attr">hoverPointRadius</span>:<span class="number">1</span>,<span class="attr">hoverPointUnit</span>:<span class="string">"%"</span>,<span class="attr">pointerEvents</span>:<span class="string">"visiblePainted"</span>,<span class="attr">cursor</span>:<span class="string">"inherit"</span>,<span class="attr">fontColor</span>:<span class="string">"#000000"</span>,<span class="attr">labelAlign</span>:<span class="string">"cm"</span>,<span class="attr">labelOutlineColor</span>:<span class="string">"white"</span>,<span class="attr">labelOutlineWidth</span>:<span class="number">3</span>&#125;,<span class="string">"delete"</span>:&#123;<span class="attr">display</span>:<span class="string">"none"</span>&#125;&#125;;OpenLayers.Style=OpenLayers.Class(&#123;<span class="attr">id</span>:<span class="literal">null</span>,<span class="attr">name</span>:<span class="literal">null</span>,<span class="attr">title</span>:<span class="literal">null</span>,<span class="attr">description</span>:<span class="literal">null</span>,<span class="attr">layerName</span>:<span class="literal">null</span>,<span class="attr">isDefault</span>:!<span class="number">1</span>,<span class="attr">rules</span>:<span class="literal">null</span>,<span class="attr">context</span>:<span class="literal">null</span>,<span class="attr">defaultStyle</span>:<span class="literal">null</span>,<span class="attr">defaultsPerSymbolizer</span>:!<span class="number">1</span>,<span class="attr">propertyStyles</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,b);<span class="keyword">this</span>.rules=[];b&amp;&amp;b.rules&amp;&amp;<span class="keyword">this</span>.addRules(b.rules);<span class="keyword">this</span>.setDefaultStyle(a||OpenLayers.Feature.Vector.style[<span class="string">"default"</span>]);<span class="keyword">this</span>.id=OpenLayers.Util.createUniqueID(<span class="keyword">this</span>.CLASS_NAME+<span class="string">"_"</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="keyword">this</span>.rules.length;a&lt;b;a++)<span class="keyword">this</span>.rules[a].destroy(),</span><br><span class="line"><span class="keyword">this</span>.rules[a]=<span class="literal">null</span>;<span class="keyword">this</span>.defaultStyle=<span class="keyword">this</span>.rules=<span class="literal">null</span>&#125;,<span class="attr">createSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.defaultsPerSymbolizer?&#123;&#125;:<span class="keyword">this</span>.createLiterals(OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>.defaultStyle),a),c=<span class="keyword">this</span>.rules,d,e=[],f=!<span class="number">1</span>,g=<span class="number">0</span>,h=c.length;g&lt;h;g++)d=c[g],d.evaluate(a)&amp;&amp;(d <span class="keyword">instanceof</span> OpenLayers.Rule&amp;&amp;d.elseFilter?e.push(d):(f=!<span class="number">0</span>,<span class="keyword">this</span>.applySymbolizer(d,b,a)));<span class="keyword">if</span>(!<span class="number">1</span>==f&amp;&amp;<span class="number">0</span>&lt;e.length)<span class="keyword">for</span>(f=!<span class="number">0</span>,g=<span class="number">0</span>,h=e.length;g&lt;h;g++)<span class="keyword">this</span>.applySymbolizer(e[g],b,a);<span class="number">0</span>&lt;c.length&amp;&amp;!<span class="number">1</span>==f&amp;&amp;(b.display=<span class="string">"none"</span>);<span class="literal">null</span>!=b.label&amp;&amp;<span class="string">"string"</span>!==<span class="keyword">typeof</span> b.label&amp;&amp;</span><br><span class="line">(b.label=<span class="built_in">String</span>(b.label));<span class="keyword">return</span> b&#125;,<span class="attr">applySymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=c.geometry?<span class="keyword">this</span>.getSymbolizerPrefix(c.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[<span class="number">0</span>];a=a.symbolizer[d]||a.symbolizer;!<span class="number">0</span>===<span class="keyword">this</span>.defaultsPerSymbolizer&amp;&amp;(d=<span class="keyword">this</span>.defaultStyle,OpenLayers.Util.applyDefaults(a,&#123;<span class="attr">pointRadius</span>:d.pointRadius&#125;),!<span class="number">0</span>!==a.stroke&amp;&amp;!<span class="number">0</span>!==a.graphic||OpenLayers.Util.applyDefaults(a,&#123;<span class="attr">strokeWidth</span>:d.strokeWidth,<span class="attr">strokeColor</span>:d.strokeColor,<span class="attr">strokeOpacity</span>:d.strokeOpacity,<span class="attr">strokeDashstyle</span>:d.strokeDashstyle,<span class="attr">strokeLinecap</span>:d.strokeLinecap&#125;),</span><br><span class="line">!<span class="number">0</span>!==a.fill&amp;&amp;!<span class="number">0</span>!==a.graphic||OpenLayers.Util.applyDefaults(a,&#123;<span class="attr">fillColor</span>:d.fillColor,<span class="attr">fillOpacity</span>:d.fillOpacity&#125;),!<span class="number">0</span>===a.graphic&amp;&amp;OpenLayers.Util.applyDefaults(a,&#123;<span class="attr">pointRadius</span>:<span class="keyword">this</span>.defaultStyle.pointRadius,<span class="attr">externalGraphic</span>:<span class="keyword">this</span>.defaultStyle.externalGraphic,<span class="attr">graphicName</span>:<span class="keyword">this</span>.defaultStyle.graphicName,<span class="attr">graphicOpacity</span>:<span class="keyword">this</span>.defaultStyle.graphicOpacity,<span class="attr">graphicWidth</span>:<span class="keyword">this</span>.defaultStyle.graphicWidth,<span class="attr">graphicHeight</span>:<span class="keyword">this</span>.defaultStyle.graphicHeight,<span class="attr">graphicXOffset</span>:<span class="keyword">this</span>.defaultStyle.graphicXOffset,<span class="attr">graphicYOffset</span>:<span class="keyword">this</span>.defaultStyle.graphicYOffset&#125;));</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.createLiterals(OpenLayers.Util.extend(b,a),c)&#125;,<span class="attr">createLiterals</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Util.extend(&#123;&#125;,b.attributes||b.data);OpenLayers.Util.extend(c,<span class="keyword">this</span>.context);<span class="keyword">for</span>(<span class="keyword">var</span> d <span class="keyword">in</span> <span class="keyword">this</span>.propertyStyles)a[d]=OpenLayers.Style.createLiteral(a[d],c,b,d);<span class="keyword">return</span> a&#125;,<span class="attr">findPropertyStyles</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=&#123;&#125;;<span class="keyword">this</span>.addPropertyStyles(a,<span class="keyword">this</span>.defaultStyle);<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.rules,c,d,e=<span class="number">0</span>,f=b.length;e&lt;f;e++)&#123;c=b[e].symbolizer;<span class="keyword">for</span>(<span class="keyword">var</span> g <span class="keyword">in</span> c)<span class="keyword">if</span>(d=c[g],<span class="string">"object"</span>==<span class="keyword">typeof</span> d)<span class="keyword">this</span>.addPropertyStyles(a,d);<span class="keyword">else</span>&#123;<span class="keyword">this</span>.addPropertyStyles(a,</span><br><span class="line">c);<span class="keyword">break</span>&#125;&#125;<span class="keyword">return</span> a&#125;,<span class="attr">addPropertyStyles</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c,d;<span class="keyword">for</span>(d <span class="keyword">in</span> b)c=b[d],<span class="string">"string"</span>==<span class="keyword">typeof</span> c&amp;&amp;c.match(<span class="regexp">/\$\&#123;\w+\&#125;/</span>)&amp;&amp;(a[d]=!<span class="number">0</span>);<span class="keyword">return</span> a&#125;,<span class="attr">addRules</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="built_in">Array</span>.prototype.push.apply(<span class="keyword">this</span>.rules,a);<span class="keyword">this</span>.propertyStyles=<span class="keyword">this</span>.findPropertyStyles()&#125;,<span class="attr">setDefaultStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.defaultStyle=a;<span class="keyword">this</span>.propertyStyles=<span class="keyword">this</span>.findPropertyStyles()&#125;,<span class="attr">getSymbolizerPrefix</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=OpenLayers.Style.SYMBOLIZER_PREFIXES,c=<span class="number">0</span>,d=b.length;c&lt;d;c++)<span class="keyword">if</span>(<span class="number">-1</span>!=a.CLASS_NAME.indexOf(b[c]))<span class="keyword">return</span> b[c]&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=</span><br><span class="line">OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>);<span class="keyword">if</span>(<span class="keyword">this</span>.rules)&#123;a.rules=[];<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="keyword">this</span>.rules.length;b&lt;c;++b)a.rules.push(<span class="keyword">this</span>.rules[b].clone())&#125;a.context=<span class="keyword">this</span>.context&amp;&amp;OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>.context);b=OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>.defaultStyle);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Style(b,a)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Style"</span>&#125;);OpenLayers.Style.createLiteral=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;<span class="number">-1</span>!=a.indexOf(<span class="string">"$&#123;"</span>)&amp;&amp;(a=OpenLayers.String.format(a,b,[c,d]),a=<span class="built_in">isNaN</span>(a)||!a?a:<span class="built_in">parseFloat</span>(a));<span class="keyword">return</span> a&#125;;</span><br><span class="line">OpenLayers.Style.SYMBOLIZER_PREFIXES=[<span class="string">"Point"</span>,<span class="string">"Line"</span>,<span class="string">"Polygon"</span>,<span class="string">"Text"</span>,<span class="string">"Raster"</span>];OpenLayers.Filter=OpenLayers.Class(&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,a)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">evaluate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="literal">null</span>&#125;,<span class="attr">toString</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Format&amp;&amp;OpenLayers.Format.CQL?OpenLayers.Format.CQL.prototype.write(<span class="keyword">this</span>):<span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">this</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Filter"</span>&#125;);OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,&#123;<span class="attr">type</span>:<span class="literal">null</span>,<span class="attr">property</span>:<span class="literal">null</span>,<span class="attr">value</span>:<span class="literal">null</span>,<span class="attr">distance</span>:<span class="literal">null</span>,<span class="attr">distanceUnits</span>:<span class="literal">null</span>,<span class="attr">evaluate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;<span class="keyword">switch</span>(<span class="keyword">this</span>.type)&#123;<span class="keyword">case</span> OpenLayers.Filter.Spatial.BBOX:<span class="keyword">case</span> OpenLayers.Filter.Spatial.INTERSECTS:<span class="keyword">if</span>(a.geometry)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.value;<span class="string">"OpenLayers.Bounds"</span>==<span class="keyword">this</span>.value.CLASS_NAME&amp;&amp;(c=<span class="keyword">this</span>.value.toGeometry());a.geometry.intersects(c)&amp;&amp;(b=!<span class="number">0</span>)&#125;<span class="keyword">break</span>;<span class="keyword">default</span>:<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"evaluate is not implemented for this filter type."</span>);&#125;<span class="keyword">return</span> b&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=</span><br><span class="line">OpenLayers.Util.applyDefaults(&#123;<span class="attr">value</span>:<span class="keyword">this</span>.value&amp;&amp;<span class="keyword">this</span>.value.clone&amp;&amp;<span class="keyword">this</span>.value.clone()&#125;,<span class="keyword">this</span>);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Filter.Spatial(a)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Filter.Spatial"</span>&#125;);OpenLayers.Filter.Spatial.BBOX=<span class="string">"BBOX"</span>;OpenLayers.Filter.Spatial.INTERSECTS=<span class="string">"INTERSECTS"</span>;OpenLayers.Filter.Spatial.DWITHIN=<span class="string">"DWITHIN"</span>;OpenLayers.Filter.Spatial.WITHIN=<span class="string">"WITHIN"</span>;OpenLayers.Filter.Spatial.CONTAINS=<span class="string">"CONTAINS"</span>;OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,&#123;<span class="attr">fids</span>:<span class="literal">null</span>,<span class="attr">type</span>:<span class="string">"FID"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.fids=[];OpenLayers.Filter.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">evaluate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="keyword">this</span>.fids.length;b&lt;c;b++)<span class="keyword">if</span>((a.fid||a.id)==<span class="keyword">this</span>.fids[b])<span class="keyword">return</span>!<span class="number">0</span>;<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">new</span> OpenLayers.Filter.FeatureId;OpenLayers.Util.extend(a,<span class="keyword">this</span>);a.fids=<span class="keyword">this</span>.fids.slice();<span class="keyword">return</span> a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Filter.FeatureId"</span>&#125;);OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>,<span class="attr">wfs</span>:<span class="string">"http://www.opengis.net/wfs"</span>,<span class="attr">gml</span>:<span class="string">"http://www.opengis.net/gml"</span>,<span class="attr">ogc</span>:<span class="string">"http://www.opengis.net/ogc"</span>,<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows"</span>&#125;,<span class="attr">defaultPrefix</span>:<span class="string">"wfs"</span>,<span class="attr">version</span>:<span class="literal">null</span>,<span class="attr">schemaLocations</span>:<span class="literal">null</span>,<span class="attr">srsName</span>:<span class="literal">null</span>,<span class="attr">extractAttributes</span>:!<span class="number">0</span>,<span class="attr">xy</span>:!<span class="number">0</span>,<span class="attr">stateName</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.stateName=&#123;&#125;;<span class="keyword">this</span>.stateName[OpenLayers.State.INSERT]=<span class="string">"wfs:Insert"</span>;<span class="keyword">this</span>.stateName[OpenLayers.State.UPDATE]=</span><br><span class="line"><span class="string">"wfs:Update"</span>;<span class="keyword">this</span>.stateName[OpenLayers.State.DELETE]=<span class="string">"wfs:Delete"</span>;OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">getSrsName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=b&amp;&amp;b.srsName;c||(c=a&amp;&amp;a.layer?a.layer.projection.getCode():<span class="keyword">this</span>.srsName);<span class="keyword">return</span> c&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=b||&#123;&#125;;OpenLayers.Util.applyDefaults(b,&#123;<span class="attr">output</span>:<span class="string">"features"</span>&#125;);<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> c=&#123;&#125;;a&amp;&amp;<span class="keyword">this</span>.readNode(a,c,!<span class="number">0</span>);c.features&amp;&amp;<span class="string">"features"</span>===b.output&amp;&amp;</span><br><span class="line">(c=c.features);<span class="keyword">return</span> c&#125;,<span class="attr">readers</span>:&#123;<span class="attr">wfs</span>:&#123;<span class="attr">FeatureCollection</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.features=[];<span class="keyword">this</span>.readChildNodes(a,b)&#125;&#125;&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.writeNode(<span class="string">"wfs:Transaction"</span>,&#123;<span class="attr">features</span>:a,<span class="attr">options</span>:b&#125;),d=<span class="keyword">this</span>.schemaLocationAttr();d&amp;&amp;<span class="keyword">this</span>.setAttributeNS(c,<span class="keyword">this</span>.namespaces.xsi,<span class="string">"xsi:schemaLocation"</span>,d);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[c])&#125;,<span class="attr">writers</span>:&#123;<span class="attr">wfs</span>:&#123;<span class="attr">GetFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:GetFeature"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">service</span>:<span class="string">"WFS"</span>,<span class="attr">version</span>:<span class="keyword">this</span>.version,<span class="attr">handle</span>:a&amp;&amp;a.handle,</span><br><span class="line">outputFormat:a&amp;&amp;a.outputFormat,<span class="attr">maxFeatures</span>:a&amp;&amp;a.maxFeatures,<span class="string">"xsi:schemaLocation"</span>:<span class="keyword">this</span>.schemaLocationAttr(a)&#125;&#125;);<span class="keyword">if</span>(<span class="string">"string"</span>==<span class="keyword">typeof</span> <span class="keyword">this</span>.featureType)<span class="keyword">this</span>.writeNode(<span class="string">"Query"</span>,a,b);<span class="keyword">else</span> <span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.featureType.length;c&lt;d;c++)a.featureType=<span class="keyword">this</span>.featureType[c],<span class="keyword">this</span>.writeNode(<span class="string">"Query"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">Transaction</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||&#123;&#125;;<span class="keyword">var</span> b=a.options||&#123;&#125;,c=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:Transaction"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">service</span>:<span class="string">"WFS"</span>,<span class="attr">version</span>:<span class="keyword">this</span>.version,<span class="attr">handle</span>:b.handle&#125;&#125;),d,e=a.features;<span class="keyword">if</span>(e)&#123;!<span class="number">0</span>===b.multi&amp;&amp;OpenLayers.Util.extend(<span class="keyword">this</span>.geometryTypes,</span><br><span class="line">&#123;<span class="string">"OpenLayers.Geometry.Point"</span>:<span class="string">"MultiPoint"</span>,<span class="string">"OpenLayers.Geometry.LineString"</span>:!<span class="number">0</span>===<span class="keyword">this</span>.multiCurve?<span class="string">"MultiCurve"</span>:<span class="string">"MultiLineString"</span>,<span class="string">"OpenLayers.Geometry.Polygon"</span>:!<span class="number">0</span>===<span class="keyword">this</span>.multiSurface?<span class="string">"MultiSurface"</span>:<span class="string">"MultiPolygon"</span>&#125;);<span class="keyword">var</span> f,g;a=<span class="number">0</span>;<span class="keyword">for</span>(d=e.length;a&lt;d;++a)g=e[a],(f=<span class="keyword">this</span>.stateName[g.state])&amp;&amp;<span class="keyword">this</span>.writeNode(f,&#123;<span class="attr">feature</span>:g,<span class="attr">options</span>:b&#125;,c);!<span class="number">0</span>===b.multi&amp;&amp;<span class="keyword">this</span>.setGeometryTypes()&#125;<span class="keyword">if</span>(b.nativeElements)<span class="keyword">for</span>(a=<span class="number">0</span>,d=b.nativeElements.length;a&lt;d;++a)<span class="keyword">this</span>.writeNode(<span class="string">"wfs:Native"</span>,b.nativeElements[a],c);<span class="keyword">return</span> c&#125;,<span class="attr">Native</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:Native"</span>,</span><br><span class="line">&#123;<span class="attr">attributes</span>:&#123;<span class="attr">vendorId</span>:a.vendorId,<span class="attr">safeToIgnore</span>:a.safeToIgnore&#125;,<span class="attr">value</span>:a.value&#125;)&#125;,<span class="attr">Insert</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.feature;a=a.options;a=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:Insert"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">handle</span>:a&amp;&amp;a.handle&#125;&#125;);<span class="keyword">this</span>.srsName=<span class="keyword">this</span>.getSrsName(b);<span class="keyword">this</span>.writeNode(<span class="string">"feature:_typeName"</span>,b,a);<span class="keyword">return</span> a&#125;,<span class="attr">Update</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.feature;a=a.options;a=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:Update"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">handle</span>:a&amp;&amp;a.handle,<span class="attr">typeName</span>:(<span class="keyword">this</span>.featureNS?<span class="keyword">this</span>.featurePrefix+<span class="string">":"</span>:<span class="string">""</span>)+<span class="keyword">this</span>.featureType&#125;&#125;);<span class="keyword">this</span>.featureNS&amp;&amp;a.setAttribute(<span class="string">"xmlns:"</span>+</span><br><span class="line"><span class="keyword">this</span>.featurePrefix,<span class="keyword">this</span>.featureNS);<span class="keyword">var</span> c=b.modified;<span class="literal">null</span>===<span class="keyword">this</span>.geometryName||c&amp;&amp;<span class="keyword">void</span> <span class="number">0</span>===c.geometry||(<span class="keyword">this</span>.srsName=<span class="keyword">this</span>.getSrsName(b),<span class="keyword">this</span>.writeNode(<span class="string">"Property"</span>,&#123;<span class="attr">name</span>:<span class="keyword">this</span>.geometryName,<span class="attr">value</span>:b.geometry&#125;,a));<span class="keyword">for</span>(<span class="keyword">var</span> d <span class="keyword">in</span> b.attributes)<span class="keyword">void</span> <span class="number">0</span>===b.attributes[d]||c&amp;&amp;c.attributes&amp;&amp;(!c.attributes||<span class="keyword">void</span> <span class="number">0</span>===c.attributes[d])||<span class="keyword">this</span>.writeNode(<span class="string">"Property"</span>,&#123;<span class="attr">name</span>:d,<span class="attr">value</span>:b.attributes[d]&#125;,a);<span class="keyword">this</span>.writeNode(<span class="string">"ogc:Filter"</span>,<span class="keyword">new</span> OpenLayers.Filter.FeatureId(&#123;<span class="attr">fids</span>:[b.fid]&#125;),a);<span class="keyword">return</span> a&#125;,<span class="attr">Property</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:Property"</span>);</span><br><span class="line"><span class="keyword">this</span>.writeNode(<span class="string">"Name"</span>,a.name,b);<span class="literal">null</span>!==a.value&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Value"</span>,a.value,b);<span class="keyword">return</span> b&#125;,<span class="attr">Name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:Name"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">Value</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;a <span class="keyword">instanceof</span> OpenLayers.Geometry?(b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:Value"</span>),a=<span class="keyword">this</span>.writeNode(<span class="string">"feature:_geometry"</span>,a).firstChild,b.appendChild(a)):b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:Value"</span>,&#123;<span class="attr">value</span>:a&#125;);<span class="keyword">return</span> b&#125;,<span class="attr">Delete</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.feature;a=a.options;a=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:Delete"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">handle</span>:a&amp;&amp;</span><br><span class="line">a.handle,<span class="attr">typeName</span>:(<span class="keyword">this</span>.featureNS?<span class="keyword">this</span>.featurePrefix+<span class="string">":"</span>:<span class="string">""</span>)+<span class="keyword">this</span>.featureType&#125;&#125;);<span class="keyword">this</span>.featureNS&amp;&amp;a.setAttribute(<span class="string">"xmlns:"</span>+<span class="keyword">this</span>.featurePrefix,<span class="keyword">this</span>.featureNS);<span class="keyword">this</span>.writeNode(<span class="string">"ogc:Filter"</span>,<span class="keyword">new</span> OpenLayers.Filter.FeatureId(&#123;<span class="attr">fids</span>:[b.fid]&#125;),a);<span class="keyword">return</span> a&#125;&#125;&#125;,<span class="attr">schemaLocationAttr</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.extend(&#123;<span class="attr">featurePrefix</span>:<span class="keyword">this</span>.featurePrefix,<span class="attr">schema</span>:<span class="keyword">this</span>.schema&#125;,a);<span class="keyword">var</span> b=OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>.schemaLocations);a.schema&amp;&amp;(b[a.featurePrefix]=a.schema);a=[];<span class="keyword">var</span> c,d;<span class="keyword">for</span>(d <span class="keyword">in</span> b)(c=<span class="keyword">this</span>.namespaces[d])&amp;&amp;</span><br><span class="line">a.push(c+<span class="string">" "</span>+b[d]);<span class="keyword">return</span> a.join(<span class="string">" "</span>)||<span class="keyword">void</span> <span class="number">0</span>&#125;,<span class="attr">setFilterProperty</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a.filters)<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=a.filters.length;b&lt;c;++b)OpenLayers.Format.WFST.v1.prototype.setFilterProperty.call(<span class="keyword">this</span>,a.filters[b]);<span class="keyword">else</span> a <span class="keyword">instanceof</span> OpenLayers.Filter.Spatial&amp;&amp;!a.property&amp;&amp;(a.property=<span class="keyword">this</span>.geometryName)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WFST.v1"</span>&#125;);OpenLayers.Format.OGCExceptionReport=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">ogc</span>:<span class="string">"http://www.opengis.net/ogc"</span>&#125;,<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">defaultPrefix</span>:<span class="string">"ogc"</span>,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));<span class="keyword">var</span> b=&#123;<span class="attr">exceptionReport</span>:<span class="literal">null</span>&#125;;a.documentElement&amp;&amp;(<span class="keyword">this</span>.readChildNodes(a,b),<span class="literal">null</span>===b.exceptionReport&amp;&amp;(b=(<span class="keyword">new</span> OpenLayers.Format.OWSCommon).read(a)));<span class="keyword">return</span> b&#125;,<span class="attr">readers</span>:&#123;<span class="attr">ogc</span>:&#123;<span class="attr">ServiceExceptionReport</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.exceptionReport=&#123;<span class="attr">exceptions</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.exceptionReport)&#125;,<span class="attr">ServiceException</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">code</span>:a.getAttribute(<span class="string">"code"</span>),<span class="attr">locator</span>:a.getAttribute(<span class="string">"locator"</span>),<span class="attr">text</span>:<span class="keyword">this</span>.getChildValue(a)&#125;;b.exceptions.push(c)&#125;&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.OGCExceptionReport"</span>&#125;);OpenLayers.Format.XML.VersionedOGC=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">defaultVersion</span>:<span class="literal">null</span>,<span class="attr">version</span>:<span class="literal">null</span>,<span class="attr">profile</span>:<span class="literal">null</span>,<span class="attr">allowFallback</span>:!<span class="number">1</span>,<span class="attr">name</span>:<span class="literal">null</span>,<span class="attr">stringifyOutput</span>:!<span class="number">1</span>,<span class="attr">parser</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[a]);a=<span class="keyword">this</span>.CLASS_NAME;<span class="keyword">this</span>.name=a.substring(a.lastIndexOf(<span class="string">"."</span>)+<span class="number">1</span>)&#125;,<span class="attr">getVersion</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c;a?(c=<span class="keyword">this</span>.version,c||(c=a.getAttribute(<span class="string">"version"</span>),c||(c=<span class="keyword">this</span>.defaultVersion))):c=b&amp;&amp;b.version||<span class="keyword">this</span>.version||<span class="keyword">this</span>.defaultVersion;<span class="keyword">return</span> c&#125;,<span class="attr">getParser</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=</span><br><span class="line">a||<span class="keyword">this</span>.defaultVersion;<span class="keyword">var</span> b=<span class="keyword">this</span>.profile?<span class="string">"_"</span>+<span class="keyword">this</span>.profile:<span class="string">""</span>;<span class="keyword">if</span>(!<span class="keyword">this</span>.parser||<span class="keyword">this</span>.parser.VERSION!=a)&#123;<span class="keyword">var</span> c=OpenLayers.Format[<span class="keyword">this</span>.name][<span class="string">"v"</span>+a.replace(<span class="regexp">/\./g</span>,<span class="string">"_"</span>)+b];<span class="keyword">if</span>(!c&amp;&amp;(<span class="string">""</span>!==b&amp;&amp;<span class="keyword">this</span>.allowFallback&amp;&amp;(b=<span class="string">""</span>,c=OpenLayers.Format[<span class="keyword">this</span>.name][<span class="string">"v"</span>+a.replace(<span class="regexp">/\./g</span>,<span class="string">"_"</span>)]),!c))<span class="keyword">throw</span><span class="string">"Can't find a "</span>+<span class="keyword">this</span>.name+<span class="string">" parser for version "</span>+a+b;<span class="keyword">this</span>.parser=<span class="keyword">new</span> c(<span class="keyword">this</span>.options)&#125;<span class="keyword">return</span> <span class="keyword">this</span>.parser&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getVersion(<span class="literal">null</span>,b);<span class="keyword">this</span>.parser=<span class="keyword">this</span>.getParser(c);c=<span class="keyword">this</span>.parser.write(a,b);<span class="keyword">return</span>!<span class="number">1</span>===<span class="keyword">this</span>.stringifyOutput?</span><br><span class="line">c:OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[c])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));<span class="keyword">var</span> c=<span class="keyword">this</span>.getVersion(a.documentElement);<span class="keyword">this</span>.parser=<span class="keyword">this</span>.getParser(c);<span class="keyword">var</span> d=<span class="keyword">this</span>.parser.read(a,b),e=<span class="keyword">this</span>.parser.errorProperty||<span class="literal">null</span>;<span class="literal">null</span>!==e&amp;&amp;<span class="keyword">void</span> <span class="number">0</span>===d[e]&amp;&amp;(e=<span class="keyword">new</span> OpenLayers.Format.OGCExceptionReport,d.error=e.read(a));d.version=c;<span class="keyword">return</span> d&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.XML.VersionedOGC"</span>&#125;);OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,&#123;<span class="attr">filters</span>:<span class="literal">null</span>,<span class="attr">type</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.filters=[];OpenLayers.Filter.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.filters=<span class="literal">null</span>;OpenLayers.Filter.prototype.destroy.apply(<span class="keyword">this</span>)&#125;,<span class="attr">evaluate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c;<span class="keyword">switch</span>(<span class="keyword">this</span>.type)&#123;<span class="keyword">case</span> OpenLayers.Filter.Logical.AND:b=<span class="number">0</span>;<span class="keyword">for</span>(c=<span class="keyword">this</span>.filters.length;b&lt;c;b++)<span class="keyword">if</span>(!<span class="number">1</span>==<span class="keyword">this</span>.filters[b].evaluate(a))<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">return</span>!<span class="number">0</span>;<span class="keyword">case</span> OpenLayers.Filter.Logical.OR:b=<span class="number">0</span>;<span class="keyword">for</span>(c=<span class="keyword">this</span>.filters.length;b&lt;</span><br><span class="line">c;b++)<span class="keyword">if</span>(!<span class="number">0</span>==<span class="keyword">this</span>.filters[b].evaluate(a))<span class="keyword">return</span>!<span class="number">0</span>;<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">case</span> OpenLayers.Filter.Logical.NOT:<span class="keyword">return</span>!<span class="keyword">this</span>.filters[<span class="number">0</span>].evaluate(a)&#125;&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=[],b=<span class="number">0</span>,c=<span class="keyword">this</span>.filters.length;b&lt;c;++b)a.push(<span class="keyword">this</span>.filters[b].clone());<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Filter.Logical(&#123;<span class="attr">type</span>:<span class="keyword">this</span>.type,<span class="attr">filters</span>:a&#125;)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Filter.Logical"</span>&#125;);OpenLayers.Filter.Logical.AND=<span class="string">"&amp;&amp;"</span>;OpenLayers.Filter.Logical.OR=<span class="string">"||"</span>;OpenLayers.Filter.Logical.NOT=<span class="string">"!"</span>;OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,&#123;<span class="attr">type</span>:<span class="literal">null</span>,<span class="attr">property</span>:<span class="literal">null</span>,<span class="attr">value</span>:<span class="literal">null</span>,<span class="attr">matchCase</span>:!<span class="number">0</span>,<span class="attr">lowerBoundary</span>:<span class="literal">null</span>,<span class="attr">upperBoundary</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Filter.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.type===OpenLayers.Filter.Comparison.LIKE&amp;&amp;<span class="keyword">void</span> <span class="number">0</span>===a.matchCase&amp;&amp;(<span class="keyword">this</span>.matchCase=<span class="literal">null</span>)&#125;,<span class="attr">evaluate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a <span class="keyword">instanceof</span> OpenLayers.Feature.Vector&amp;&amp;(a=a.attributes);<span class="keyword">var</span> b=!<span class="number">1</span>;a=a[<span class="keyword">this</span>.property];<span class="keyword">switch</span>(<span class="keyword">this</span>.type)&#123;<span class="keyword">case</span> OpenLayers.Filter.Comparison.EQUAL_TO:b=<span class="keyword">this</span>.value;</span><br><span class="line">b=<span class="keyword">this</span>.matchCase||<span class="string">"string"</span>!=<span class="keyword">typeof</span> a||<span class="string">"string"</span>!=<span class="keyword">typeof</span> b?a==b:a.toUpperCase()==b.toUpperCase();<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Filter.Comparison.NOT_EQUAL_TO:b=<span class="keyword">this</span>.value;b=<span class="keyword">this</span>.matchCase||<span class="string">"string"</span>!=<span class="keyword">typeof</span> a||<span class="string">"string"</span>!=<span class="keyword">typeof</span> b?a!=b:a.toUpperCase()!=b.toUpperCase();<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Filter.Comparison.LESS_THAN:b=a&lt;<span class="keyword">this</span>.value;<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Filter.Comparison.GREATER_THAN:b=a&gt;<span class="keyword">this</span>.value;<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:b=a&lt;=<span class="keyword">this</span>.value;<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:b=</span><br><span class="line">a&gt;=<span class="keyword">this</span>.value;<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Filter.Comparison.BETWEEN:b=a&gt;=<span class="keyword">this</span>.lowerBoundary&amp;&amp;a&lt;=<span class="keyword">this</span>.upperBoundary;<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Filter.Comparison.LIKE:b=<span class="built_in">RegExp</span>(<span class="keyword">this</span>.value,<span class="string">"gi"</span>).test(a);<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Filter.Comparison.IS_NULL:b=<span class="literal">null</span>===a&#125;<span class="keyword">return</span> b&#125;,<span class="attr">value2regex</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">if</span>(<span class="string">"."</span>==a)<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison"</span>);a=a?a:<span class="string">"*"</span>;b=b?b:<span class="string">"."</span>;<span class="keyword">this</span>.value=<span class="keyword">this</span>.value.replace(<span class="built_in">RegExp</span>(<span class="string">"\\"</span>+(c?c:<span class="string">"!"</span>)+<span class="string">"(.|$)"</span>,<span class="string">"g"</span>),<span class="string">"\\$1"</span>);<span class="keyword">this</span>.value=<span class="keyword">this</span>.value.replace(<span class="built_in">RegExp</span>(<span class="string">"\\"</span>+</span><br><span class="line">b,<span class="string">"g"</span>),<span class="string">"."</span>);<span class="keyword">this</span>.value=<span class="keyword">this</span>.value.replace(<span class="built_in">RegExp</span>(<span class="string">"\\"</span>+a,<span class="string">"g"</span>),<span class="string">".*"</span>);<span class="keyword">this</span>.value=<span class="keyword">this</span>.value.replace(<span class="built_in">RegExp</span>(<span class="string">"\\\\.\\*"</span>,<span class="string">"g"</span>),<span class="string">"\\"</span>+a);<span class="keyword">return</span> <span class="keyword">this</span>.value=<span class="keyword">this</span>.value.replace(<span class="built_in">RegExp</span>(<span class="string">"\\\\\\."</span>,<span class="string">"g"</span>),<span class="string">"\\"</span>+b)&#125;,<span class="attr">regex2value</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.value,a=a.replace(<span class="regexp">/!/g</span>,<span class="string">"!!"</span>),a=a.replace(<span class="regexp">/(\\)?\\\./g</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a,c</span>)</span>&#123;<span class="keyword">return</span> c?a:<span class="string">"!."</span>&#125;),a=a.replace(<span class="regexp">/(\\)?\\\*/g</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a,c</span>)</span>&#123;<span class="keyword">return</span> c?a:<span class="string">"!*"</span>&#125;),a=a.replace(<span class="regexp">/\\\\/g</span>,<span class="string">"\\"</span>);<span class="keyword">return</span> a=a.replace(<span class="regexp">/\.\*/g</span>,<span class="string">"*"</span>)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Util.extend(<span class="keyword">new</span> OpenLayers.Filter.Comparison,</span><br><span class="line"><span class="keyword">this</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Filter.Comparison"</span>&#125;);OpenLayers.Filter.Comparison.EQUAL_TO=<span class="string">"=="</span>;OpenLayers.Filter.Comparison.NOT_EQUAL_TO=<span class="string">"!="</span>;OpenLayers.Filter.Comparison.LESS_THAN=<span class="string">"&lt;"</span>;OpenLayers.Filter.Comparison.GREATER_THAN=<span class="string">"&gt;"</span>;OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO=<span class="string">"&lt;="</span>;OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=<span class="string">"&gt;="</span>;OpenLayers.Filter.Comparison.BETWEEN=<span class="string">".."</span>;OpenLayers.Filter.Comparison.LIKE=<span class="string">"~"</span>;OpenLayers.Filter.Comparison.IS_NULL=<span class="string">"NULL"</span>;OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,&#123;<span class="attr">defaultVersion</span>:<span class="string">"1.0.0"</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.Filter"</span>&#125;);OpenLayers.Filter.Function=OpenLayers.Class(OpenLayers.Filter,&#123;<span class="attr">name</span>:<span class="literal">null</span>,<span class="attr">params</span>:<span class="literal">null</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Filter.Function"</span>&#125;);OpenLayers.Date=&#123;<span class="attr">dateRegEx</span>:<span class="regexp">/^(?:(\d&#123;4&#125;)(?:-(\d&#123;2&#125;)(?:-(\d&#123;2&#125;))?)?)?(?:(?:T(\d&#123;1,2&#125;):(\d&#123;2&#125;):(\d&#123;2&#125;(?:\.\d+)?)(Z|(?:[+-]\d&#123;1,2&#125;(?::(\d&#123;2&#125;))?)))|Z)?$/</span>,<span class="attr">toISOString</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">"toISOString"</span><span class="keyword">in</span> <span class="built_in">Date</span>.prototype?<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a.toISOString()&#125;:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">isNaN</span>(a.getTime())?<span class="string">"Invalid Date"</span>:a.getUTCFullYear()+<span class="string">"-"</span>+OpenLayers.Number.zeroPad(a.getUTCMonth()+<span class="number">1</span>,<span class="number">2</span>)+<span class="string">"-"</span>+OpenLayers.Number.zeroPad(a.getUTCDate(),<span class="number">2</span>)+<span class="string">"T"</span>+OpenLayers.Number.zeroPad(a.getUTCHours(),<span class="number">2</span>)+<span class="string">":"</span>+OpenLayers.Number.zeroPad(a.getUTCMinutes(),</span><br><span class="line"><span class="number">2</span>)+<span class="string">":"</span>+OpenLayers.Number.zeroPad(a.getUTCSeconds(),<span class="number">2</span>)+<span class="string">"."</span>+OpenLayers.Number.zeroPad(a.getUTCMilliseconds(),<span class="number">3</span>)+<span class="string">"Z"</span>&#125;&#125;(),<span class="attr">parse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;<span class="keyword">if</span>((a=a.match(<span class="keyword">this</span>.dateRegEx))&amp;&amp;(a[<span class="number">1</span>]||a[<span class="number">7</span>]))&#123;b=<span class="built_in">parseInt</span>(a[<span class="number">1</span>],<span class="number">10</span>)||<span class="number">0</span>;<span class="keyword">var</span> c=<span class="built_in">parseInt</span>(a[<span class="number">2</span>],<span class="number">10</span>)<span class="number">-1</span>||<span class="number">0</span>,d=<span class="built_in">parseInt</span>(a[<span class="number">3</span>],<span class="number">10</span>)||<span class="number">1</span>;b=<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.UTC(b,c,d));<span class="keyword">if</span>(c=a[<span class="number">7</span>])&#123;<span class="keyword">var</span> d=<span class="built_in">parseInt</span>(a[<span class="number">4</span>],<span class="number">10</span>),e=<span class="built_in">parseInt</span>(a[<span class="number">5</span>],<span class="number">10</span>),f=<span class="built_in">parseFloat</span>(a[<span class="number">6</span>]),g=f|<span class="number">0</span>,f=<span class="built_in">Math</span>.round(<span class="number">1E3</span>*(f-g));b.setUTCHours(d,e,g,f);<span class="string">"Z"</span>!==c&amp;&amp;(c=<span class="built_in">parseInt</span>(c,<span class="number">10</span>),a=<span class="built_in">parseInt</span>(a[<span class="number">8</span>],<span class="number">10</span>)||<span class="number">0</span>,a=<span class="number">-1E3</span>*(<span class="number">60</span>*<span class="number">60</span>*c+<span class="number">60</span>*a),b=<span class="keyword">new</span> <span class="built_in">Date</span>(b.getTime()+</span><br><span class="line">a))&#125;&#125;<span class="keyword">else</span> b=<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">"invalid"</span>);<span class="keyword">return</span> b&#125;&#125;;OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">ogc</span>:<span class="string">"http://www.opengis.net/ogc"</span>,<span class="attr">gml</span>:<span class="string">"http://www.opengis.net/gml"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&#125;,<span class="attr">defaultPrefix</span>:<span class="string">"ogc"</span>,<span class="attr">schemaLocation</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;&#125;;<span class="keyword">this</span>.readers.ogc.Filter.apply(<span class="keyword">this</span>,[a,b]);<span class="keyword">return</span> b.filter&#125;,<span class="attr">readers</span>:&#123;<span class="attr">ogc</span>:&#123;<span class="attr">_expression</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="string">""</span>,c=a.firstChild;c;c=</span><br><span class="line">c.nextSibling)<span class="keyword">switch</span>(c.nodeType)&#123;<span class="keyword">case</span> <span class="number">1</span>:a=<span class="keyword">this</span>.readNode(c);a.property?b+=<span class="string">"$&#123;"</span>+a.property+<span class="string">"&#125;"</span>:<span class="keyword">void</span> <span class="number">0</span>!==a.value&amp;&amp;(b+=a.value);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">3</span>:<span class="keyword">case</span> <span class="number">4</span>:b+=c.nodeValue&#125;<span class="keyword">return</span> b&#125;,<span class="attr">Filter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">fids</span>:[],<span class="attr">filters</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,c);<span class="number">0</span>&lt;c.fids.length?b.filter=<span class="keyword">new</span> OpenLayers.Filter.FeatureId(&#123;<span class="attr">fids</span>:c.fids&#125;):<span class="number">0</span>&lt;c.filters.length&amp;&amp;(b.filter=c.filters[<span class="number">0</span>])&#125;,<span class="attr">FeatureId</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.getAttribute(<span class="string">"fid"</span>);c&amp;&amp;b.fids.push(c)&#125;,<span class="attr">And</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Logical(&#123;<span class="attr">type</span>:OpenLayers.Filter.Logical.AND&#125;);</span><br><span class="line"><span class="keyword">this</span>.readChildNodes(a,c);b.filters.push(c)&#125;,<span class="attr">Or</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Logical(&#123;<span class="attr">type</span>:OpenLayers.Filter.Logical.OR&#125;);<span class="keyword">this</span>.readChildNodes(a,c);b.filters.push(c)&#125;,<span class="attr">Not</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Logical(&#123;<span class="attr">type</span>:OpenLayers.Filter.Logical.NOT&#125;);<span class="keyword">this</span>.readChildNodes(a,c);b.filters.push(c)&#125;,<span class="attr">PropertyIsLessThan</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">type</span>:OpenLayers.Filter.Comparison.LESS_THAN&#125;);<span class="keyword">this</span>.readChildNodes(a,c);b.filters.push(c)&#125;,<span class="attr">PropertyIsGreaterThan</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">type</span>:OpenLayers.Filter.Comparison.GREATER_THAN&#125;);<span class="keyword">this</span>.readChildNodes(a,c);b.filters.push(c)&#125;,<span class="attr">PropertyIsLessThanOrEqualTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">type</span>:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO&#125;);<span class="keyword">this</span>.readChildNodes(a,c);b.filters.push(c)&#125;,<span class="attr">PropertyIsGreaterThanOrEqualTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">type</span>:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO&#125;);<span class="keyword">this</span>.readChildNodes(a,c);b.filters.push(c)&#125;,</span><br><span class="line">PropertyIsBetween:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">type</span>:OpenLayers.Filter.Comparison.BETWEEN&#125;);<span class="keyword">this</span>.readChildNodes(a,c);b.filters.push(c)&#125;,<span class="attr">Literal</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.value=OpenLayers.String.numericIf(<span class="keyword">this</span>.getChildValue(a),!<span class="number">0</span>)&#125;,<span class="attr">PropertyName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.property=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">LowerBoundary</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.lowerBoundary=OpenLayers.String.numericIf(<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,a),!<span class="number">0</span>)&#125;,<span class="attr">UpperBoundary</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.upperBoundary=OpenLayers.String.numericIf(<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,</span><br><span class="line">a),!<span class="number">0</span>)&#125;,<span class="attr">Intersects</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readSpatial(a,b,OpenLayers.Filter.Spatial.INTERSECTS)&#125;,<span class="attr">Within</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readSpatial(a,b,OpenLayers.Filter.Spatial.WITHIN)&#125;,<span class="attr">Contains</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readSpatial(a,b,OpenLayers.Filter.Spatial.CONTAINS)&#125;,<span class="attr">DWithin</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readSpatial(a,b,OpenLayers.Filter.Spatial.DWITHIN)&#125;,<span class="attr">Distance</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.distance=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.getChildValue(a));b.distanceUnits=a.getAttribute(<span class="string">"units"</span>)&#125;,<span class="attr">Function</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">PropertyIsNull</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">type</span>:OpenLayers.Filter.Comparison.IS_NULL&#125;);</span><br><span class="line"><span class="keyword">this</span>.readChildNodes(a,c);b.filters.push(c)&#125;&#125;&#125;,<span class="attr">readSpatial</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;c=<span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:c&#125;);<span class="keyword">this</span>.readChildNodes(a,c);c.value=c.components[<span class="number">0</span>];<span class="keyword">delete</span> c.components;b.filters.push(c)&#125;,<span class="attr">encodeLiteral</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a <span class="keyword">instanceof</span> <span class="built_in">Date</span>&amp;&amp;(a=OpenLayers.Date.toISOString(a));<span class="keyword">return</span> a&#125;,<span class="attr">writeOgcExpression</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a <span class="keyword">instanceof</span> OpenLayers.Filter.Function?<span class="keyword">this</span>.writeNode(<span class="string">"Function"</span>,a,b):<span class="keyword">this</span>.writeNode(<span class="string">"Literal"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.writers.ogc.Filter.apply(<span class="keyword">this</span>,[a])&#125;,</span><br><span class="line">writers:&#123;<span class="attr">ogc</span>:&#123;<span class="attr">Filter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:Filter"</span>);<span class="keyword">this</span>.writeNode(<span class="keyword">this</span>.getFilterType(a),a,b);<span class="keyword">return</span> b&#125;,<span class="attr">_featureIds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createDocumentFragment(),c=<span class="number">0</span>,d=a.fids.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"ogc:FeatureId"</span>,a.fids[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">FeatureId</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:FeatureId"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">fid</span>:a&#125;&#125;)&#125;,<span class="attr">And</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:And"</span>),c,d=<span class="number">0</span>,e=a.filters.length;d&lt;e;++d)c=a.filters[d],<span class="keyword">this</span>.writeNode(<span class="keyword">this</span>.getFilterType(c),</span><br><span class="line">c,b);<span class="keyword">return</span> b&#125;,<span class="attr">Or</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:Or"</span>),c,d=<span class="number">0</span>,e=a.filters.length;d&lt;e;++d)c=a.filters[d],<span class="keyword">this</span>.writeNode(<span class="keyword">this</span>.getFilterType(c),c,b);<span class="keyword">return</span> b&#125;,<span class="attr">Not</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:Not"</span>);a=a.filters[<span class="number">0</span>];<span class="keyword">this</span>.writeNode(<span class="keyword">this</span>.getFilterType(a),a,b);<span class="keyword">return</span> b&#125;,<span class="attr">PropertyIsLessThan</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyIsLessThan"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">this</span>.writeOgcExpression(a.value,b);<span class="keyword">return</span> b&#125;,<span class="attr">PropertyIsGreaterThan</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyIsGreaterThan"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">this</span>.writeOgcExpression(a.value,b);<span class="keyword">return</span> b&#125;,<span class="attr">PropertyIsLessThanOrEqualTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyIsLessThanOrEqualTo"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">this</span>.writeOgcExpression(a.value,b);<span class="keyword">return</span> b&#125;,<span class="attr">PropertyIsGreaterThanOrEqualTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyIsGreaterThanOrEqualTo"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">this</span>.writeOgcExpression(a.value,b);</span><br><span class="line"><span class="keyword">return</span> b&#125;,<span class="attr">PropertyIsBetween</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyIsBetween"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">this</span>.writeNode(<span class="string">"LowerBoundary"</span>,a,b);<span class="keyword">this</span>.writeNode(<span class="string">"UpperBoundary"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">PropertyName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyName"</span>,&#123;<span class="attr">value</span>:a.property&#125;)&#125;,<span class="attr">Literal</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:Literal"</span>,&#123;<span class="attr">value</span>:(<span class="keyword">this</span>.encodeLiteral||OpenLayers.Format.Filter.v1.prototype.encodeLiteral)(a)&#125;)&#125;,<span class="attr">LowerBoundary</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:LowerBoundary"</span>);</span><br><span class="line"><span class="keyword">this</span>.writeOgcExpression(a.lowerBoundary,b);<span class="keyword">return</span> b&#125;,<span class="attr">UpperBoundary</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:UpperBoundary"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"Literal"</span>,a.upperBoundary,b);<span class="keyword">return</span> b&#125;,<span class="attr">INTERSECTS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.writeSpatial(a,<span class="string">"Intersects"</span>)&#125;,<span class="attr">WITHIN</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.writeSpatial(a,<span class="string">"Within"</span>)&#125;,<span class="attr">CONTAINS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.writeSpatial(a,<span class="string">"Contains"</span>)&#125;,<span class="attr">DWITHIN</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.writeSpatial(a,<span class="string">"DWithin"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"Distance"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">Distance</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:Distance"</span>,</span><br><span class="line">&#123;<span class="attr">attributes</span>:&#123;<span class="attr">units</span>:a.distanceUnits&#125;,<span class="attr">value</span>:a.distance&#125;)&#125;,<span class="attr">Function</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:Function"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">name</span>:a.name&#125;&#125;);a=a.params;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;c++)<span class="keyword">this</span>.writeOgcExpression(a[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">PropertyIsNull</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyIsNull"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">return</span> b&#125;&#125;&#125;,<span class="attr">getFilterType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.filterMap[a.type];<span class="keyword">if</span>(!b)<span class="keyword">throw</span><span class="string">"Filter writing not supported for rule type: "</span>+a.type;<span class="keyword">return</span> b&#125;,<span class="attr">filterMap</span>:&#123;<span class="string">"&amp;&amp;"</span>:<span class="string">"And"</span>,</span><br><span class="line"><span class="string">"||"</span>:<span class="string">"Or"</span>,<span class="string">"!"</span>:<span class="string">"Not"</span>,<span class="string">"=="</span>:<span class="string">"PropertyIsEqualTo"</span>,<span class="string">"!="</span>:<span class="string">"PropertyIsNotEqualTo"</span>,<span class="string">"&lt;"</span>:<span class="string">"PropertyIsLessThan"</span>,<span class="string">"&gt;"</span>:<span class="string">"PropertyIsGreaterThan"</span>,<span class="string">"&lt;="</span>:<span class="string">"PropertyIsLessThanOrEqualTo"</span>,<span class="string">"&gt;="</span>:<span class="string">"PropertyIsGreaterThanOrEqualTo"</span>,<span class="string">".."</span>:<span class="string">"PropertyIsBetween"</span>,<span class="string">"~"</span>:<span class="string">"PropertyIsLike"</span>,<span class="attr">NULL</span>:<span class="string">"PropertyIsNull"</span>,<span class="attr">BBOX</span>:<span class="string">"BBOX"</span>,<span class="attr">DWITHIN</span>:<span class="string">"DWITHIN"</span>,<span class="attr">WITHIN</span>:<span class="string">"WITHIN"</span>,<span class="attr">CONTAINS</span>:<span class="string">"CONTAINS"</span>,<span class="attr">INTERSECTS</span>:<span class="string">"INTERSECTS"</span>,<span class="attr">FID</span>:<span class="string">"_featureIds"</span>&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.Filter.v1"</span>&#125;);OpenLayers.Geometry=OpenLayers.Class(&#123;<span class="attr">id</span>:<span class="literal">null</span>,<span class="attr">parent</span>:<span class="literal">null</span>,<span class="attr">bounds</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.id=OpenLayers.Util.createUniqueID(<span class="keyword">this</span>.CLASS_NAME+<span class="string">"_"</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.bounds=<span class="keyword">this</span>.id=<span class="literal">null</span>&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry&#125;,<span class="attr">setBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a&amp;&amp;(<span class="keyword">this</span>.bounds=a.clone())&#125;,<span class="attr">clearBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.bounds=<span class="literal">null</span>;<span class="keyword">this</span>.parent&amp;&amp;<span class="keyword">this</span>.parent.clearBounds()&#125;,<span class="attr">extendBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.getBounds()?<span class="keyword">this</span>.bounds.extend(a):<span class="keyword">this</span>.setBounds(a)&#125;,<span class="attr">getBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="literal">null</span>==<span class="keyword">this</span>.bounds&amp;&amp;<span class="keyword">this</span>.calculateBounds();</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.bounds&#125;,<span class="attr">calculateBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">distanceTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">getVertices</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">atPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=!<span class="number">1</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.getBounds()&amp;&amp;<span class="literal">null</span>!=a&amp;&amp;(b=<span class="literal">null</span>!=b?b:<span class="number">0</span>,c=<span class="literal">null</span>!=c?c:<span class="number">0</span>,d=(<span class="keyword">new</span> OpenLayers.Bounds(<span class="keyword">this</span>.bounds.left-b,<span class="keyword">this</span>.bounds.bottom-c,<span class="keyword">this</span>.bounds.right+b,<span class="keyword">this</span>.bounds.top+c)).containsLonLat(a));<span class="keyword">return</span> d&#125;,<span class="attr">getLength</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="number">0</span>&#125;,<span class="attr">getArea</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="number">0</span>&#125;,<span class="attr">getCentroid</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="literal">null</span>&#125;,<span class="attr">toString</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Format&amp;&amp;OpenLayers.Format.WKT?OpenLayers.Format.WKT.prototype.write(<span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">this</span>)):</span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">this</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Geometry"</span>&#125;);OpenLayers.Geometry.fromWKT=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;<span class="keyword">if</span>(OpenLayers.Format&amp;&amp;OpenLayers.Format.WKT)&#123;<span class="keyword">var</span> c=OpenLayers.Geometry.fromWKT.format;c||(c=<span class="keyword">new</span> OpenLayers.Format.WKT,OpenLayers.Geometry.fromWKT.format=c);a=c.read(a);<span class="keyword">if</span>(a <span class="keyword">instanceof</span> OpenLayers.Feature.Vector)b=a.geometry;<span class="keyword">else</span> <span class="keyword">if</span>(OpenLayers.Util.isArray(a))&#123;b=a.length;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="built_in">Array</span>(b),d=<span class="number">0</span>;d&lt;b;++d)c[d]=a[d].geometry;b=<span class="keyword">new</span> OpenLayers.Geometry.Collection(c)&#125;&#125;<span class="keyword">return</span> b&#125;;</span><br><span class="line">OpenLayers.Geometry.segmentsIntersect=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=c&amp;&amp;c.point;c=c&amp;&amp;c.tolerance;<span class="keyword">var</span> e=!<span class="number">1</span>,f=a.x1-b.x1,g=a.y1-b.y1,h=a.x2-a.x1,k=a.y2-a.y1,l=b.y2-b.y1,m=b.x2-b.x1,n=l*h-m*k,l=m*g-l*f,g=h*g-k*f;<span class="number">0</span>==n?<span class="number">0</span>==l&amp;&amp;<span class="number">0</span>==g&amp;&amp;(e=!<span class="number">0</span>):(f=l/n,n=g/n,<span class="number">0</span>&lt;=f&amp;&amp;(<span class="number">1</span>&gt;=f&amp;&amp;<span class="number">0</span>&lt;=n&amp;&amp;<span class="number">1</span>&gt;=n)&amp;&amp;(d?(h=a.x1+f*h,n=a.y1+f*k,e=<span class="keyword">new</span> OpenLayers.Geometry.Point(h,n)):e=!<span class="number">0</span>));<span class="keyword">if</span>(c)<span class="keyword">if</span>(e)&#123;<span class="keyword">if</span>(d)a:<span class="keyword">for</span>(a=[a,b],b=<span class="number">0</span>;<span class="number">2</span>&gt;b;++b)<span class="keyword">for</span>(f=a[b],k=<span class="number">1</span>;<span class="number">3</span>&gt;k;++k)<span class="keyword">if</span>(h=f[<span class="string">"x"</span>+k],n=f[<span class="string">"y"</span>+k],d=<span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(h-e.x,<span class="number">2</span>)+<span class="built_in">Math</span>.pow(n-e.y,<span class="number">2</span>)),d&lt;c)&#123;e.x=h;e.y=n;<span class="keyword">break</span> a&#125;&#125;<span class="keyword">else</span> a:<span class="keyword">for</span>(a=</span><br><span class="line">[a,b],b=<span class="number">0</span>;<span class="number">2</span>&gt;b;++b)<span class="keyword">for</span>(h=a[b],n=a[(b+<span class="number">1</span>)%<span class="number">2</span>],k=<span class="number">1</span>;<span class="number">3</span>&gt;k;++k)<span class="keyword">if</span>(f=&#123;<span class="attr">x</span>:h[<span class="string">"x"</span>+k],<span class="attr">y</span>:h[<span class="string">"y"</span>+k]&#125;,g=OpenLayers.Geometry.distanceToSegment(f,n),g.distance&lt;c)&#123;e=d?<span class="keyword">new</span> OpenLayers.Geometry.Point(f.x,f.y):!<span class="number">0</span>;<span class="keyword">break</span> a&#125;<span class="keyword">return</span> e&#125;;OpenLayers.Geometry.distanceToSegment=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Geometry.distanceSquaredToSegment(a,b);c.distance=<span class="built_in">Math</span>.sqrt(c.distance);<span class="keyword">return</span> c&#125;;</span><br><span class="line">OpenLayers.Geometry.distanceSquaredToSegment=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.x,d=a.y,e=b.x1,f=b.y1,g=b.x2,h=b.y2,k=g-e,l=h-f,m=(k*(c-e)+l*(d-f))/(<span class="built_in">Math</span>.pow(k,<span class="number">2</span>)+<span class="built_in">Math</span>.pow(l,<span class="number">2</span>));<span class="number">0</span>&gt;=m||(<span class="number">1</span>&lt;=m?(e=g,f=h):(e+=m*k,f+=m*l));<span class="keyword">return</span>&#123;<span class="attr">distance</span>:<span class="built_in">Math</span>.pow(e-c,<span class="number">2</span>)+<span class="built_in">Math</span>.pow(f-d,<span class="number">2</span>),<span class="attr">x</span>:e,<span class="attr">y</span>:f,<span class="attr">along</span>:m&#125;&#125;;OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,&#123;<span class="attr">x</span>:<span class="literal">null</span>,<span class="attr">y</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Geometry.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.x=<span class="built_in">parseFloat</span>(a);<span class="keyword">this</span>.y=<span class="built_in">parseFloat</span>(b)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="keyword">this</span>.x,<span class="keyword">this</span>.y));OpenLayers.Util.applyDefaults(a,<span class="keyword">this</span>);<span class="keyword">return</span> a&#125;,<span class="attr">calculateBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.bounds=<span class="keyword">new</span> OpenLayers.Bounds(<span class="keyword">this</span>.x,<span class="keyword">this</span>.y,<span class="keyword">this</span>.x,<span class="keyword">this</span>.y)&#125;,<span class="attr">distanceTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=!(b&amp;&amp;!<span class="number">1</span>===b.edge)&amp;&amp;b&amp;&amp;b.details,d,e,f,g,h;a <span class="keyword">instanceof</span></span><br><span class="line">OpenLayers.Geometry.Point?(e=<span class="keyword">this</span>.x,f=<span class="keyword">this</span>.y,g=a.x,h=a.y,d=<span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(e-g,<span class="number">2</span>)+<span class="built_in">Math</span>.pow(f-h,<span class="number">2</span>)),d=c?&#123;<span class="attr">x0</span>:e,<span class="attr">y0</span>:f,<span class="attr">x1</span>:g,<span class="attr">y1</span>:h,<span class="attr">distance</span>:d&#125;:d):(d=a.distanceTo(<span class="keyword">this</span>,b),c&amp;&amp;(d=&#123;<span class="attr">x0</span>:d.x1,<span class="attr">y0</span>:d.y1,<span class="attr">x1</span>:d.x0,<span class="attr">y1</span>:d.y0,<span class="attr">distance</span>:d.distance&#125;));<span class="keyword">return</span> d&#125;,<span class="attr">equals</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;<span class="literal">null</span>!=a&amp;&amp;(b=<span class="keyword">this</span>.x==a.x&amp;&amp;<span class="keyword">this</span>.y==a.y||<span class="built_in">isNaN</span>(<span class="keyword">this</span>.x)&amp;&amp;<span class="built_in">isNaN</span>(<span class="keyword">this</span>.y)&amp;&amp;<span class="built_in">isNaN</span>(a.x)&amp;&amp;<span class="built_in">isNaN</span>(a.y));<span class="keyword">return</span> b&#125;,<span class="attr">toShortString</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.x+<span class="string">", "</span>+<span class="keyword">this</span>.y&#125;,<span class="attr">move</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.x+=a;<span class="keyword">this</span>.y+=b;<span class="keyword">this</span>.clearBounds()&#125;,<span class="attr">rotate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a*=</span><br><span class="line"><span class="built_in">Math</span>.PI/<span class="number">180</span>;<span class="keyword">var</span> c=<span class="keyword">this</span>.distanceTo(b),d=a+<span class="built_in">Math</span>.atan2(<span class="keyword">this</span>.y-b.y,<span class="keyword">this</span>.x-b.x);<span class="keyword">this</span>.x=b.x+c*<span class="built_in">Math</span>.cos(d);<span class="keyword">this</span>.y=b.y+c*<span class="built_in">Math</span>.sin(d);<span class="keyword">this</span>.clearBounds()&#125;,<span class="attr">getCentroid</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="keyword">this</span>.x,<span class="keyword">this</span>.y)&#125;,<span class="attr">resize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">this</span>.x=b.x+a*(<span class="keyword">void</span> <span class="number">0</span>==c?<span class="number">1</span>:c)*(<span class="keyword">this</span>.x-b.x);<span class="keyword">this</span>.y=b.y+a*(<span class="keyword">this</span>.y-b.y);<span class="keyword">this</span>.clearBounds();<span class="keyword">return</span> <span class="keyword">this</span>&#125;,<span class="attr">intersects</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;<span class="keyword">return</span> b=<span class="string">"OpenLayers.Geometry.Point"</span>==a.CLASS_NAME?<span class="keyword">this</span>.equals(a):a.intersects(<span class="keyword">this</span>)&#125;,<span class="attr">transform</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a&amp;&amp;b&amp;&amp;(OpenLayers.Projection.transform(<span class="keyword">this</span>,</span><br><span class="line">a,b),<span class="keyword">this</span>.bounds=<span class="literal">null</span>);<span class="keyword">return</span> <span class="keyword">this</span>&#125;,<span class="attr">getVertices</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span>[<span class="keyword">this</span>]&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Geometry.Point"</span>&#125;);OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,&#123;<span class="attr">components</span>:<span class="literal">null</span>,<span class="attr">componentTypes</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Geometry.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.components=[];<span class="literal">null</span>!=a&amp;&amp;<span class="keyword">this</span>.addComponents(a)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.components.length=<span class="number">0</span>;<span class="keyword">this</span>.components=<span class="literal">null</span>;OpenLayers.Geometry.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="built_in">eval</span>(<span class="string">"new "</span>+<span class="keyword">this</span>.CLASS_NAME+<span class="string">"()"</span>),b=<span class="number">0</span>,c=<span class="keyword">this</span>.components.length;b&lt;c;b++)a.addComponent(<span class="keyword">this</span>.components[b].clone());</span><br><span class="line">OpenLayers.Util.applyDefaults(a,<span class="keyword">this</span>);<span class="keyword">return</span> a&#125;,<span class="attr">getComponentsString</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=[],b=<span class="number">0</span>,c=<span class="keyword">this</span>.components.length;b&lt;c;b++)a.push(<span class="keyword">this</span>.components[b].toShortString());<span class="keyword">return</span> a.join(<span class="string">","</span>)&#125;,<span class="attr">calculateBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.bounds=<span class="literal">null</span>;<span class="keyword">var</span> a=<span class="keyword">new</span> OpenLayers.Bounds,b=<span class="keyword">this</span>.components;<span class="keyword">if</span>(b)<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=b.length;c&lt;d;c++)a.extend(b[c].getBounds());<span class="literal">null</span>!=a.left&amp;&amp;(<span class="literal">null</span>!=a.bottom&amp;&amp;<span class="literal">null</span>!=a.right&amp;&amp;<span class="literal">null</span>!=a.top)&amp;&amp;<span class="keyword">this</span>.setBounds(a)&#125;,<span class="attr">addComponents</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.isArray(a)||(a=[a]);<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=a.length;b&lt;</span><br><span class="line">c;b++)<span class="keyword">this</span>.addComponent(a[b])&#125;,<span class="attr">addComponent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=!<span class="number">1</span>;<span class="keyword">if</span>(a&amp;&amp;(<span class="literal">null</span>==<span class="keyword">this</span>.componentTypes||<span class="number">-1</span>&lt;OpenLayers.Util.indexOf(<span class="keyword">this</span>.componentTypes,a.CLASS_NAME)))&#123;<span class="keyword">if</span>(<span class="literal">null</span>!=b&amp;&amp;b&lt;<span class="keyword">this</span>.components.length)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.components.slice(<span class="number">0</span>,b),d=<span class="keyword">this</span>.components.slice(b,<span class="keyword">this</span>.components.length);c.push(a);<span class="keyword">this</span>.components=c.concat(d)&#125;<span class="keyword">else</span> <span class="keyword">this</span>.components.push(a);a.parent=<span class="keyword">this</span>;<span class="keyword">this</span>.clearBounds();c=!<span class="number">0</span>&#125;<span class="keyword">return</span> c&#125;,<span class="attr">removeComponents</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;OpenLayers.Util.isArray(a)||(a=[a]);<span class="keyword">for</span>(<span class="keyword">var</span> c=a.length<span class="number">-1</span>;<span class="number">0</span>&lt;=c;--c)b=</span><br><span class="line"><span class="keyword">this</span>.removeComponent(a[c])||b;<span class="keyword">return</span> b&#125;,<span class="attr">removeComponent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.removeItem(<span class="keyword">this</span>.components,a);<span class="keyword">this</span>.clearBounds();<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">getLength</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="number">0</span>,c=<span class="keyword">this</span>.components.length;b&lt;c;b++)a+=<span class="keyword">this</span>.components[b].getLength();<span class="keyword">return</span> a&#125;,<span class="attr">getArea</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="number">0</span>,c=<span class="keyword">this</span>.components.length;b&lt;c;b++)a+=<span class="keyword">this</span>.components[b].getArea();<span class="keyword">return</span> a&#125;,<span class="attr">getGeodesicArea</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="number">0</span>,d=<span class="keyword">this</span>.components.length;c&lt;d;c++)b+=<span class="keyword">this</span>.components[c].getGeodesicArea(a);<span class="keyword">return</span> b&#125;,<span class="attr">getCentroid</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!a)<span class="keyword">return</span> <span class="keyword">this</span>.components.length&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.components[<span class="number">0</span>].getCentroid();a=<span class="keyword">this</span>.components.length;<span class="keyword">if</span>(!a)<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=[],d=<span class="number">0</span>,e=<span class="built_in">Number</span>.MAX_VALUE,f,g=<span class="number">0</span>;g&lt;a;++g)&#123;f=<span class="keyword">this</span>.components[g];<span class="keyword">var</span> h=f.getArea();f=f.getCentroid(!<span class="number">0</span>);<span class="built_in">isNaN</span>(h)||(<span class="built_in">isNaN</span>(f.x)||<span class="built_in">isNaN</span>(f.y))||(b.push(h),d+=h,e=h&lt;e&amp;&amp;<span class="number">0</span>&lt;h?h:e,c.push(f))&#125;a=b.length;<span class="keyword">if</span>(<span class="number">0</span>===d)&#123;<span class="keyword">for</span>(g=<span class="number">0</span>;g&lt;a;++g)b[g]=<span class="number">1</span>;d=b.length&#125;<span class="keyword">else</span>&#123;<span class="keyword">for</span>(g=<span class="number">0</span>;g&lt;a;++g)b[g]/=e;d/=e&#125;<span class="keyword">for</span>(<span class="keyword">var</span> k=e=<span class="number">0</span>,g=<span class="number">0</span>;g&lt;a;++g)f=c[g],h=b[g],e+=f.x*h,k+=f.y*h;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.Point(e/d,k/d)&#125;,<span class="attr">getGeodesicLength</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,</span><br><span class="line">c=<span class="number">0</span>,d=<span class="keyword">this</span>.components.length;c&lt;d;c++)b+=<span class="keyword">this</span>.components[c].getGeodesicLength(a);<span class="keyword">return</span> b&#125;,<span class="attr">move</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.components.length;c&lt;d;c++)<span class="keyword">this</span>.components[c].move(a,b)&#125;,<span class="attr">rotate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.components.length;c&lt;d;++c)<span class="keyword">this</span>.components[c].rotate(a,b)&#125;,<span class="attr">resize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>;d&lt;<span class="keyword">this</span>.components.length;++d)<span class="keyword">this</span>.components[d].resize(a,b,c);<span class="keyword">return</span> <span class="keyword">this</span>&#125;,<span class="attr">distanceTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=!(b&amp;&amp;!<span class="number">1</span>===b.edge)&amp;&amp;b&amp;&amp;b.details,d,e,f,g=<span class="built_in">Number</span>.POSITIVE_INFINITY,h=<span class="number">0</span>,k=<span class="keyword">this</span>.components.length;h&lt;</span><br><span class="line">k&amp;&amp;!(d=<span class="keyword">this</span>.components[h].distanceTo(a,b),f=c?d.distance:d,f&lt;g&amp;&amp;(g=f,e=d,<span class="number">0</span>==g));++h);<span class="keyword">return</span> e&#125;,<span class="attr">equals</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">0</span>;<span class="keyword">if</span>(a&amp;&amp;a.CLASS_NAME&amp;&amp;<span class="keyword">this</span>.CLASS_NAME==a.CLASS_NAME)<span class="keyword">if</span>(OpenLayers.Util.isArray(a.components)&amp;&amp;a.components.length==<span class="keyword">this</span>.components.length)<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.components.length;c&lt;d;++c)&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.components[c].equals(a.components[c]))&#123;b=!<span class="number">1</span>;<span class="keyword">break</span>&#125;&#125;<span class="keyword">else</span> b=!<span class="number">1</span>;<span class="keyword">else</span> b=!<span class="number">1</span>;<span class="keyword">return</span> b&#125;,<span class="attr">transform</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(a&amp;&amp;b)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.components.length;c&lt;d;c++)<span class="keyword">this</span>.components[c].transform(a,</span><br><span class="line">b);<span class="keyword">this</span>.bounds=<span class="literal">null</span>&#125;<span class="keyword">return</span> <span class="keyword">this</span>&#125;,<span class="attr">intersects</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=!<span class="number">1</span>,c=<span class="number">0</span>,d=<span class="keyword">this</span>.components.length;c&lt;d&amp;&amp;!(b=a.intersects(<span class="keyword">this</span>.components[c]));++c);<span class="keyword">return</span> b&#125;,<span class="attr">getVertices</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>,d=<span class="keyword">this</span>.components.length;c&lt;d;++c)<span class="built_in">Array</span>.prototype.push.apply(b,<span class="keyword">this</span>.components[c].getVertices(a));<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Geometry.Collection"</span>&#125;);OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,&#123;<span class="attr">componentTypes</span>:[<span class="string">"OpenLayers.Geometry.Point"</span>],<span class="attr">addPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.addComponent(a,b)&#125;,<span class="attr">removePoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.removeComponent(a)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Geometry.MultiPoint"</span>&#125;);OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,&#123;<span class="attr">componentTypes</span>:[<span class="string">"OpenLayers.Geometry.Point"</span>],<span class="attr">getLength</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="number">0</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.components&amp;&amp;<span class="number">1</span>&lt;<span class="keyword">this</span>.components.length)<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">1</span>,c=<span class="keyword">this</span>.components.length;b&lt;c;b++)a+=<span class="keyword">this</span>.components[b<span class="number">-1</span>].distanceTo(<span class="keyword">this</span>.components[b]);<span class="keyword">return</span> a&#125;,<span class="attr">getGeodesicLength</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>;<span class="keyword">if</span>(a)&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>);c.equals(a)||(b=<span class="keyword">this</span>.clone().transform(a,c))&#125;a=<span class="number">0</span>;<span class="keyword">if</span>(b.components&amp;&amp;<span class="number">1</span>&lt;b.components.length)<span class="keyword">for</span>(<span class="keyword">var</span> d,e=<span class="number">1</span>,f=b.components.length;e&lt;</span><br><span class="line">f;e++)c=b.components[e<span class="number">-1</span>],d=b.components[e],a+=OpenLayers.Util.distVincenty(&#123;<span class="attr">lon</span>:c.x,<span class="attr">lat</span>:c.y&#125;,&#123;<span class="attr">lon</span>:d.x,<span class="attr">lat</span>:d.y&#125;);<span class="keyword">return</span> <span class="number">1E3</span>*a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Geometry.Curve"</span>&#125;);OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,&#123;<span class="attr">removeComponent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.components&amp;&amp;<span class="number">2</span>&lt;<span class="keyword">this</span>.components.length;b&amp;&amp;OpenLayers.Geometry.Collection.prototype.removeComponent.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">return</span> b&#125;,<span class="attr">intersects</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>,c=a.CLASS_NAME;<span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.LineString"</span>==c||<span class="string">"OpenLayers.Geometry.LinearRing"</span>==c||<span class="string">"OpenLayers.Geometry.Point"</span>==c)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.getSortedSegments();a=<span class="string">"OpenLayers.Geometry.Point"</span>==c?[&#123;<span class="attr">x1</span>:a.x,<span class="attr">y1</span>:a.y,<span class="attr">x2</span>:a.x,<span class="attr">y2</span>:a.y&#125;]:a.getSortedSegments();</span><br><span class="line"><span class="keyword">var</span> e,f,g,h,k,l,m,n=<span class="number">0</span>,p=d.length;a:<span class="keyword">for</span>(;n&lt;p;++n)&#123;c=d[n];e=c.x1;f=c.x2;g=c.y1;h=c.y2;<span class="keyword">var</span> q=<span class="number">0</span>,r=a.length;<span class="keyword">for</span>(;q&lt;r;++q)&#123;k=a[q];<span class="keyword">if</span>(k.x1&gt;f)<span class="keyword">break</span>;<span class="keyword">if</span>(!(k.x2&lt;e||(l=k.y1,m=k.y2,<span class="built_in">Math</span>.min(l,m)&gt;<span class="built_in">Math</span>.max(g,h)||<span class="built_in">Math</span>.max(l,m)&lt;<span class="built_in">Math</span>.min(g,h)||!OpenLayers.Geometry.segmentsIntersect(c,k))))&#123;b=!<span class="number">0</span>;<span class="keyword">break</span> a&#125;&#125;&#125;&#125;<span class="keyword">else</span> b=a.intersects(<span class="keyword">this</span>);<span class="keyword">return</span> b&#125;,<span class="attr">getSortedSegments</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.components.length<span class="number">-1</span>,b=<span class="built_in">Array</span>(a),c,d,e=<span class="number">0</span>;e&lt;a;++e)c=<span class="keyword">this</span>.components[e],d=<span class="keyword">this</span>.components[e+<span class="number">1</span>],b[e]=c.x&lt;d.x?&#123;<span class="attr">x1</span>:c.x,<span class="attr">y1</span>:c.y,<span class="attr">x2</span>:d.x,<span class="attr">y2</span>:d.y&#125;:</span><br><span class="line">&#123;<span class="attr">x1</span>:d.x,<span class="attr">y1</span>:d.y,<span class="attr">x2</span>:c.x,<span class="attr">y2</span>:c.y&#125;;<span class="keyword">return</span> b.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> a.x1-b.x1&#125;)&#125;,<span class="attr">splitWithSegment</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=!(b&amp;&amp;!<span class="number">1</span>===b.edge),d=b&amp;&amp;b.tolerance,e=[],f=<span class="keyword">this</span>.getVertices(),g=[],h=[],k=!<span class="number">1</span>,l,m,n,p=&#123;<span class="attr">point</span>:!<span class="number">0</span>,<span class="attr">tolerance</span>:d&#125;,q=<span class="literal">null</span>,r=<span class="number">0</span>,s=f.length<span class="number">-2</span>;r&lt;=s;++r)<span class="keyword">if</span>(d=f[r],g.push(d.clone()),l=f[r+<span class="number">1</span>],m=&#123;<span class="attr">x1</span>:d.x,<span class="attr">y1</span>:d.y,<span class="attr">x2</span>:l.x,<span class="attr">y2</span>:l.y&#125;,m=OpenLayers.Geometry.segmentsIntersect(a,m,p),m <span class="keyword">instanceof</span> OpenLayers.Geometry.Point&amp;&amp;((n=m.x===a.x1&amp;&amp;m.y===a.y1||m.x===a.x2&amp;&amp;m.y===a.y2||m.equals(d)||m.equals(l)?!<span class="number">0</span>:!<span class="number">1</span>)||c))m.equals(h[h.length-</span><br><span class="line"><span class="number">1</span>])||h.push(m.clone()),<span class="number">0</span>===r&amp;&amp;m.equals(d)||m.equals(l)||(k=!<span class="number">0</span>,m.equals(d)||g.push(m),e.push(<span class="keyword">new</span> OpenLayers.Geometry.LineString(g)),g=[m.clone()]);k&amp;&amp;(g.push(l.clone()),e.push(<span class="keyword">new</span> OpenLayers.Geometry.LineString(g)));<span class="keyword">if</span>(<span class="number">0</span>&lt;h.length)<span class="keyword">var</span> t=a.x1&lt;a.x2?<span class="number">1</span>:<span class="number">-1</span>,u=a.y1&lt;a.y2?<span class="number">1</span>:<span class="number">-1</span>,q=&#123;<span class="attr">lines</span>:e,<span class="attr">points</span>:h.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> t*a.x-t*b.x||u*a.y-u*b.y&#125;)&#125;;<span class="keyword">return</span> q&#125;,<span class="attr">split</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>,d=b&amp;&amp;b.mutual,e,f,g,h;<span class="keyword">if</span>(a <span class="keyword">instanceof</span> OpenLayers.Geometry.LineString)&#123;<span class="keyword">var</span> k=<span class="keyword">this</span>.getVertices(),l,m,n,p,q,r=[];g=[];<span class="keyword">for</span>(<span class="keyword">var</span> s=</span><br><span class="line"><span class="number">0</span>,t=k.length<span class="number">-2</span>;s&lt;=t;++s)&#123;l=k[s];m=k[s+<span class="number">1</span>];n=&#123;<span class="attr">x1</span>:l.x,<span class="attr">y1</span>:l.y,<span class="attr">x2</span>:m.x,<span class="attr">y2</span>:m.y&#125;;h=h||[a];d&amp;&amp;r.push(l.clone());<span class="keyword">for</span>(<span class="keyword">var</span> u=<span class="number">0</span>;u&lt;h.length;++u)<span class="keyword">if</span>(p=h[u].splitWithSegment(n,b))<span class="keyword">if</span>(q=p.lines,<span class="number">0</span>&lt;q.length&amp;&amp;(q.unshift(u,<span class="number">1</span>),<span class="built_in">Array</span>.prototype.splice.apply(h,q),u+=q.length<span class="number">-2</span>),d)<span class="keyword">for</span>(<span class="keyword">var</span> v=<span class="number">0</span>,w=p.points.length;v&lt;w;++v)q=p.points[v],q.equals(l)||(r.push(q),g.push(<span class="keyword">new</span> OpenLayers.Geometry.LineString(r)),r=q.equals(m)?[]:[q.clone()])&#125;d&amp;&amp;(<span class="number">0</span>&lt;g.length&amp;&amp;<span class="number">0</span>&lt;r.length)&amp;&amp;(r.push(m.clone()),g.push(<span class="keyword">new</span> OpenLayers.Geometry.LineString(r)))&#125;<span class="keyword">else</span> c=</span><br><span class="line">a.splitWith(<span class="keyword">this</span>,b);h&amp;&amp;<span class="number">1</span>&lt;h.length?f=!<span class="number">0</span>:h=[];g&amp;&amp;<span class="number">1</span>&lt;g.length?e=!<span class="number">0</span>:g=[];<span class="keyword">if</span>(f||e)c=d?[g,h]:h;<span class="keyword">return</span> c&#125;,<span class="attr">splitWith</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> a.split(<span class="keyword">this</span>,b)&#125;,<span class="attr">getVertices</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span>!<span class="number">0</span>===a?[<span class="keyword">this</span>.components[<span class="number">0</span>],<span class="keyword">this</span>.components[<span class="keyword">this</span>.components.length<span class="number">-1</span>]]:!<span class="number">1</span>===a?<span class="keyword">this</span>.components.slice(<span class="number">1</span>,<span class="keyword">this</span>.components.length<span class="number">-1</span>):<span class="keyword">this</span>.components.slice()&#125;,<span class="attr">distanceTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=!(b&amp;&amp;!<span class="number">1</span>===b.edge)&amp;&amp;b&amp;&amp;b.details,d,e=&#123;&#125;,f=<span class="built_in">Number</span>.POSITIVE_INFINITY;<span class="keyword">if</span>(a <span class="keyword">instanceof</span> OpenLayers.Geometry.Point)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> g=<span class="keyword">this</span>.getSortedSegments(),</span><br><span class="line">h=a.x,k=a.y,l,m=<span class="number">0</span>,n=g.length;m&lt;n;++m)<span class="keyword">if</span>(l=g[m],d=OpenLayers.Geometry.distanceToSegment(a,l),d.distance&lt;f)&#123;<span class="keyword">if</span>(f=d.distance,e=d,<span class="number">0</span>===f)<span class="keyword">break</span>&#125;<span class="keyword">else</span> <span class="keyword">if</span>(l.x2&gt;h&amp;&amp;(k&gt;l.y1&amp;&amp;k&lt;l.y2||k&lt;l.y1&amp;&amp;k&gt;l.y2))<span class="keyword">break</span>;e=c?&#123;<span class="attr">distance</span>:e.distance,<span class="attr">x0</span>:e.x,<span class="attr">y0</span>:e.y,<span class="attr">x1</span>:h,<span class="attr">y1</span>:k&#125;:e.distance&#125;<span class="keyword">else</span> <span class="keyword">if</span>(a <span class="keyword">instanceof</span> OpenLayers.Geometry.LineString)&#123;<span class="keyword">var</span> g=<span class="keyword">this</span>.getSortedSegments(),h=a.getSortedSegments(),p,q,r=h.length,s=&#123;<span class="attr">point</span>:!<span class="number">0</span>&#125;,m=<span class="number">0</span>,n=g.length;a:<span class="keyword">for</span>(;m&lt;n;++m)&#123;k=g[m];l=k.x1;q=k.y1;<span class="keyword">for</span>(<span class="keyword">var</span> t=<span class="number">0</span>;t&lt;r;++t)<span class="keyword">if</span>(d=h[t],p=OpenLayers.Geometry.segmentsIntersect(k,</span><br><span class="line">d,s))&#123;f=<span class="number">0</span>;e=&#123;<span class="attr">distance</span>:<span class="number">0</span>,<span class="attr">x0</span>:p.x,<span class="attr">y0</span>:p.y,<span class="attr">x1</span>:p.x,<span class="attr">y1</span>:p.y&#125;;<span class="keyword">break</span> a&#125;<span class="keyword">else</span> d=OpenLayers.Geometry.distanceToSegment(&#123;<span class="attr">x</span>:l,<span class="attr">y</span>:q&#125;,d),d.distance&lt;f&amp;&amp;(f=d.distance,e=&#123;<span class="attr">distance</span>:f,<span class="attr">x0</span>:l,<span class="attr">y0</span>:q,<span class="attr">x1</span>:d.x,<span class="attr">y1</span>:d.y&#125;)&#125;c||(e=e.distance);<span class="number">0</span>!==f&amp;&amp;k&amp;&amp;(d=a.distanceTo(<span class="keyword">new</span> OpenLayers.Geometry.Point(k.x2,k.y2),b),m=c?d.distance:d,m&lt;f&amp;&amp;(e=c?&#123;<span class="attr">distance</span>:f,<span class="attr">x0</span>:d.x1,<span class="attr">y0</span>:d.y1,<span class="attr">x1</span>:d.x0,<span class="attr">y1</span>:d.y0&#125;:m))&#125;<span class="keyword">else</span> e=a.distanceTo(<span class="keyword">this</span>,b),c&amp;&amp;(e=&#123;<span class="attr">distance</span>:e.distance,<span class="attr">x0</span>:e.x1,<span class="attr">y0</span>:e.y1,<span class="attr">x1</span>:e.x0,<span class="attr">y1</span>:e.y0&#125;);<span class="keyword">return</span> e&#125;,<span class="attr">simplify</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>&amp;&amp;<span class="literal">null</span>!==<span class="keyword">this</span>)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getVertices();</span><br><span class="line"><span class="keyword">if</span>(<span class="number">3</span>&gt;b.length)<span class="keyword">return</span> <span class="keyword">this</span>;<span class="keyword">var</span> c=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,d,k</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> l=<span class="number">0</span>,m=<span class="number">0</span>,n=b,p;n&lt;d;n++)&#123;p=a[b];<span class="keyword">var</span> q=a[d],r=a[n],r=<span class="built_in">Math</span>.abs(<span class="number">0.5</span>*(p.x*q.y+q.x*r.y+r.x*p.y-q.x*p.y-r.x*q.y-p.x*r.y));p=<span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(p.x-q.x,<span class="number">2</span>)+<span class="built_in">Math</span>.pow(p.y-q.y,<span class="number">2</span>));p=<span class="number">2</span>*(r/p);p&gt;l&amp;&amp;(l=p,m=n)&#125;l&gt;k&amp;&amp;m!=b&amp;&amp;(e.push(m),c(a,b,m,k),c(a,m,d,k))&#125;,d=b.length<span class="number">-1</span>,e=[];e.push(<span class="number">0</span>);<span class="keyword">for</span>(e.push(d);b[<span class="number">0</span>].equals(b[d]);)d--,e.push(d);c(b,<span class="number">0</span>,d,a);a=[];e.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> a-b&#125;);<span class="keyword">for</span>(d=<span class="number">0</span>;d&lt;e.length;d++)a.push(b[e[d]]);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.LineString(a)&#125;<span class="keyword">return</span> <span class="keyword">this</span>&#125;,</span><br><span class="line">CLASS_NAME:<span class="string">"OpenLayers.Geometry.LineString"</span>&#125;);OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,&#123;<span class="attr">componentTypes</span>:[<span class="string">"OpenLayers.Geometry.LineString"</span>],<span class="attr">split</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="literal">null</span>,d=b&amp;&amp;b.mutual,e,f,g,h,k=[],l=[a],m=<span class="number">0</span>,n=<span class="keyword">this</span>.components.length;m&lt;n;++m)&#123;f=<span class="keyword">this</span>.components[m];g=!<span class="number">1</span>;<span class="keyword">for</span>(<span class="keyword">var</span> p=<span class="number">0</span>;p&lt;l.length;++p)<span class="keyword">if</span>(e=f.split(l[p],b))&#123;<span class="keyword">if</span>(d)&#123;g=e[<span class="number">0</span>];<span class="keyword">for</span>(<span class="keyword">var</span> q=<span class="number">0</span>,r=g.length;q&lt;r;++q)<span class="number">0</span>===q&amp;&amp;k.length?k[k.length<span class="number">-1</span>].addComponent(g[q]):k.push(<span class="keyword">new</span> OpenLayers.Geometry.MultiLineString([g[q]]));g=!<span class="number">0</span>;e=e[<span class="number">1</span>]&#125;<span class="keyword">if</span>(e.length)&#123;e.unshift(p,</span><br><span class="line"><span class="number">1</span>);<span class="built_in">Array</span>.prototype.splice.apply(l,e);<span class="keyword">break</span>&#125;&#125;g||(k.length?k[k.length<span class="number">-1</span>].addComponent(f.clone()):k=[<span class="keyword">new</span> OpenLayers.Geometry.MultiLineString(f.clone())])&#125;k&amp;&amp;<span class="number">1</span>&lt;k.length?g=!<span class="number">0</span>:k=[];l&amp;&amp;<span class="number">1</span>&lt;l.length?h=!<span class="number">0</span>:l=[];<span class="keyword">if</span>(g||h)c=d?[k,l]:l;<span class="keyword">return</span> c&#125;,<span class="attr">splitWith</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>,d=b&amp;&amp;b.mutual,e,f,g,h,k,l;<span class="keyword">if</span>(a <span class="keyword">instanceof</span> OpenLayers.Geometry.LineString)&#123;l=[];k=[a];<span class="keyword">for</span>(<span class="keyword">var</span> m=<span class="number">0</span>,n=<span class="keyword">this</span>.components.length;m&lt;n;++m)&#123;g=!<span class="number">1</span>;f=<span class="keyword">this</span>.components[m];<span class="keyword">for</span>(<span class="keyword">var</span> p=<span class="number">0</span>;p&lt;k.length;++p)<span class="keyword">if</span>(e=k[p].split(f,b))&#123;d&amp;&amp;(g=e[<span class="number">0</span>],g.length&amp;&amp;(g.unshift(p,</span><br><span class="line"><span class="number">1</span>),<span class="built_in">Array</span>.prototype.splice.apply(k,g),p+=g.length<span class="number">-2</span>),e=e[<span class="number">1</span>],<span class="number">0</span>===e.length&amp;&amp;(e=[f.clone()]));g=<span class="number">0</span>;<span class="keyword">for</span>(<span class="keyword">var</span> q=e.length;g&lt;q;++g)<span class="number">0</span>===g&amp;&amp;l.length?l[l.length<span class="number">-1</span>].addComponent(e[g]):l.push(<span class="keyword">new</span> OpenLayers.Geometry.MultiLineString([e[g]]));g=!<span class="number">0</span>&#125;g||(l.length?l[l.length<span class="number">-1</span>].addComponent(f.clone()):l=[<span class="keyword">new</span> OpenLayers.Geometry.MultiLineString([f.clone()])])&#125;&#125;<span class="keyword">else</span> c=a.split(<span class="keyword">this</span>);k&amp;&amp;<span class="number">1</span>&lt;k.length?h=!<span class="number">0</span>:k=[];l&amp;&amp;<span class="number">1</span>&lt;l.length?g=!<span class="number">0</span>:l=[];<span class="keyword">if</span>(h||g)c=d?[k,l]:l;<span class="keyword">return</span> c&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Geometry.MultiLineString"</span>&#125;);OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,&#123;<span class="attr">componentTypes</span>:[<span class="string">"OpenLayers.Geometry.Point"</span>],<span class="attr">addComponent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=!<span class="number">1</span>,d=<span class="keyword">this</span>.components.pop();<span class="literal">null</span>==b&amp;&amp;a.equals(d)||(c=OpenLayers.Geometry.Collection.prototype.addComponent.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>));OpenLayers.Geometry.Collection.prototype.addComponent.apply(<span class="keyword">this</span>,[<span class="keyword">this</span>.components[<span class="number">0</span>]]);<span class="keyword">return</span> c&#125;,<span class="attr">removeComponent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.components&amp;&amp;<span class="number">3</span>&lt;<span class="keyword">this</span>.components.length;b&amp;&amp;(<span class="keyword">this</span>.components.pop(),OpenLayers.Geometry.Collection.prototype.removeComponent.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>),OpenLayers.Geometry.Collection.prototype.addComponent.apply(<span class="keyword">this</span>,[<span class="keyword">this</span>.components[<span class="number">0</span>]]));<span class="keyword">return</span> b&#125;,<span class="attr">move</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.components.length;c&lt;d<span class="number">-1</span>;c++)<span class="keyword">this</span>.components[c].move(a,b)&#125;,<span class="attr">rotate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.components.length;c&lt;d<span class="number">-1</span>;++c)<span class="keyword">this</span>.components[c].rotate(a,b)&#125;,<span class="attr">resize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e=<span class="keyword">this</span>.components.length;d&lt;e<span class="number">-1</span>;++d)<span class="keyword">this</span>.components[d].resize(a,b,c);<span class="keyword">return</span> <span class="keyword">this</span>&#125;,<span class="attr">transform</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(a&amp;&amp;b)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.components.length;c&lt;d<span class="number">-1</span>;c++)<span class="keyword">this</span>.components[c].transform(a,</span><br><span class="line">b);<span class="keyword">this</span>.bounds=<span class="literal">null</span>&#125;<span class="keyword">return</span> <span class="keyword">this</span>&#125;,<span class="attr">getCentroid</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.components)&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.components.length;<span class="keyword">if</span>(<span class="number">0</span>&lt;a&amp;&amp;<span class="number">2</span>&gt;=a)<span class="keyword">return</span> <span class="keyword">this</span>.components[<span class="number">0</span>].clone();<span class="keyword">if</span>(<span class="number">2</span>&lt;a)&#123;<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="number">0</span>,d=<span class="keyword">this</span>.components[<span class="number">0</span>].x,e=<span class="keyword">this</span>.components[<span class="number">0</span>].y,f=<span class="number">-1</span>*<span class="keyword">this</span>.getArea();<span class="keyword">if</span>(<span class="number">0</span>!=f)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> g=<span class="number">0</span>;g&lt;a<span class="number">-1</span>;g++)<span class="keyword">var</span> h=<span class="keyword">this</span>.components[g],k=<span class="keyword">this</span>.components[g+<span class="number">1</span>],b=b+(h.x+k.x<span class="number">-2</span>*d)*((h.x-d)*(k.y-e)-(k.x-d)*(h.y-e)),c=c+(h.y+k.y<span class="number">-2</span>*e)*((h.x-d)*(k.y-e)-(k.x-d)*(h.y-e));b=d+b/(<span class="number">6</span>*f);a=e+c/(<span class="number">6</span>*f)&#125;<span class="keyword">else</span>&#123;<span class="keyword">for</span>(g=<span class="number">0</span>;g&lt;a<span class="number">-1</span>;g++)b+=<span class="keyword">this</span>.components[g].x,c+=<span class="keyword">this</span>.components[g].y;</span><br><span class="line">b/=a<span class="number">-1</span>;a=c/(a<span class="number">-1</span>)&#125;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.Point(b,a)&#125;<span class="keyword">return</span> <span class="literal">null</span>&#125;&#125;,<span class="attr">getArea</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="number">0</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.components&amp;&amp;<span class="number">2</span>&lt;<span class="keyword">this</span>.components.length)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=a=<span class="number">0</span>,c=<span class="keyword">this</span>.components.length;b&lt;c<span class="number">-1</span>;b++)<span class="keyword">var</span> d=<span class="keyword">this</span>.components[b],e=<span class="keyword">this</span>.components[b+<span class="number">1</span>],a=a+(d.x+e.x)*(e.y-d.y);a=-a/<span class="number">2</span>&#125;<span class="keyword">return</span> a&#125;,<span class="attr">getGeodesicArea</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>;<span class="keyword">if</span>(a)&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>);c.equals(a)||(b=<span class="keyword">this</span>.clone().transform(a,c))&#125;a=<span class="number">0</span>;c=b.components&amp;&amp;b.components.length;<span class="keyword">if</span>(<span class="number">2</span>&lt;c)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d,e,f=<span class="number">0</span>;f&lt;c<span class="number">-1</span>;f++)d=b.components[f],</span><br><span class="line">e=b.components[f+<span class="number">1</span>],a+=OpenLayers.Util.rad(e.x-d.x)*(<span class="number">2</span>+<span class="built_in">Math</span>.sin(OpenLayers.Util.rad(d.y))+<span class="built_in">Math</span>.sin(OpenLayers.Util.rad(e.y)));a=<span class="number">40680631590769</span>*a/<span class="number">2</span>&#125;<span class="keyword">return</span> a&#125;,<span class="attr">containsPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Number.limitSigDigs,c=b(a.x,<span class="number">14</span>);a=b(a.y,<span class="number">14</span>);<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="keyword">this</span>.components.length<span class="number">-1</span>,e,f,g,h,k,l=<span class="number">0</span>,m=<span class="number">0</span>;m&lt;d;++m)<span class="keyword">if</span>(e=<span class="keyword">this</span>.components[m],g=b(e.x,<span class="number">14</span>),e=b(e.y,<span class="number">14</span>),f=<span class="keyword">this</span>.components[m+<span class="number">1</span>],h=b(f.x,<span class="number">14</span>),f=b(f.y,<span class="number">14</span>),e==f)&#123;<span class="keyword">if</span>(a==e&amp;&amp;(g&lt;=h&amp;&amp;c&gt;=g&amp;&amp;c&lt;=h||g&gt;=h&amp;&amp;c&lt;=g&amp;&amp;c&gt;=h))&#123;l=<span class="number">-1</span>;<span class="keyword">break</span>&#125;&#125;<span class="keyword">else</span>&#123;k=b((a-f)*((h-g)/(f-e))+h,<span class="number">14</span>);<span class="keyword">if</span>(k==</span><br><span class="line">c&amp;&amp;(e&lt;f&amp;&amp;a&gt;=e&amp;&amp;a&lt;=f||e&gt;f&amp;&amp;a&lt;=e&amp;&amp;a&gt;=f))&#123;l=<span class="number">-1</span>;<span class="keyword">break</span>&#125;k&lt;=c||g!=h&amp;&amp;(k&lt;<span class="built_in">Math</span>.min(g,h)||k&gt;<span class="built_in">Math</span>.max(g,h))||(e&lt;f&amp;&amp;a&gt;=e&amp;&amp;a&lt;f||e&gt;f&amp;&amp;a&lt;e&amp;&amp;a&gt;=f)&amp;&amp;++l&#125;<span class="keyword">return</span><span class="number">-1</span>==l?<span class="number">1</span>:!!(l&amp;<span class="number">1</span>)&#125;,<span class="attr">intersects</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;<span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.Point"</span>==a.CLASS_NAME)b=<span class="keyword">this</span>.containsPoint(a);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.LineString"</span>==a.CLASS_NAME)b=a.intersects(<span class="keyword">this</span>);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.LinearRing"</span>==a.CLASS_NAME)b=OpenLayers.Geometry.LineString.prototype.intersects.apply(<span class="keyword">this</span>,[a]);<span class="keyword">else</span> <span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.components.length;c&lt;</span><br><span class="line">d&amp;&amp;!(b=a.components[c].intersects(<span class="keyword">this</span>));++c);<span class="keyword">return</span> b&#125;,<span class="attr">getVertices</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span>!<span class="number">0</span>===a?[]:<span class="keyword">this</span>.components.slice(<span class="number">0</span>,<span class="keyword">this</span>.components.length<span class="number">-1</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Geometry.LinearRing"</span>&#125;);OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,&#123;<span class="attr">componentTypes</span>:[<span class="string">"OpenLayers.Geometry.LinearRing"</span>],<span class="attr">getArea</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="number">0</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.components&amp;&amp;<span class="number">0</span>&lt;<span class="keyword">this</span>.components.length)<span class="keyword">for</span>(<span class="keyword">var</span> a=a+<span class="built_in">Math</span>.abs(<span class="keyword">this</span>.components[<span class="number">0</span>].getArea()),b=<span class="number">1</span>,c=<span class="keyword">this</span>.components.length;b&lt;c;b++)a-=<span class="built_in">Math</span>.abs(<span class="keyword">this</span>.components[b].getArea());<span class="keyword">return</span> a&#125;,<span class="attr">getGeodesicArea</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="number">0</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.components&amp;&amp;<span class="number">0</span>&lt;<span class="keyword">this</span>.components.length)<span class="keyword">for</span>(<span class="keyword">var</span> b=b+<span class="built_in">Math</span>.abs(<span class="keyword">this</span>.components[<span class="number">0</span>].getGeodesicArea(a)),c=<span class="number">1</span>,d=<span class="keyword">this</span>.components.length;c&lt;</span><br><span class="line">d;c++)b-=<span class="built_in">Math</span>.abs(<span class="keyword">this</span>.components[c].getGeodesicArea(a));<span class="keyword">return</span> b&#125;,<span class="attr">containsPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.components.length,c=!<span class="number">1</span>;<span class="keyword">if</span>(<span class="number">0</span>&lt;b&amp;&amp;(c=<span class="keyword">this</span>.components[<span class="number">0</span>].containsPoint(a),<span class="number">1</span>!==c&amp;&amp;c&amp;&amp;<span class="number">1</span>&lt;b))<span class="keyword">for</span>(<span class="keyword">var</span> d,e=<span class="number">1</span>;e&lt;b;++e)<span class="keyword">if</span>(d=<span class="keyword">this</span>.components[e].containsPoint(a))&#123;c=<span class="number">1</span>===d?<span class="number">1</span>:!<span class="number">1</span>;<span class="keyword">break</span>&#125;<span class="keyword">return</span> c&#125;,<span class="attr">intersects</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>,c,d;<span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.Point"</span>==a.CLASS_NAME)b=<span class="keyword">this</span>.containsPoint(a);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.LineString"</span>==a.CLASS_NAME||<span class="string">"OpenLayers.Geometry.LinearRing"</span>==a.CLASS_NAME)&#123;c=<span class="number">0</span>;<span class="keyword">for</span>(d=</span><br><span class="line"><span class="keyword">this</span>.components.length;c&lt;d&amp;&amp;!(b=a.intersects(<span class="keyword">this</span>.components[c]));++c);<span class="keyword">if</span>(!b)<span class="keyword">for</span>(c=<span class="number">0</span>,d=a.components.length;c&lt;d&amp;&amp;!(b=<span class="keyword">this</span>.containsPoint(a.components[c]));++c);&#125;<span class="keyword">else</span> <span class="keyword">for</span>(c=<span class="number">0</span>,d=a.components.length;c&lt;d&amp;&amp;!(b=<span class="keyword">this</span>.intersects(a.components[c]));++c);<span class="keyword">if</span>(!b&amp;&amp;<span class="string">"OpenLayers.Geometry.Polygon"</span>==a.CLASS_NAME)&#123;<span class="keyword">var</span> e=<span class="keyword">this</span>.components[<span class="number">0</span>];c=<span class="number">0</span>;<span class="keyword">for</span>(d=e.components.length;c&lt;d&amp;&amp;!(b=a.containsPoint(e.components[c]));++c);&#125;<span class="keyword">return</span> b&#125;,<span class="attr">distanceTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> b&amp;&amp;!<span class="number">1</span>===b.edge&amp;&amp;<span class="keyword">this</span>.intersects(a)?<span class="number">0</span>:OpenLayers.Geometry.Collection.prototype.distanceTo.apply(<span class="keyword">this</span>,</span><br><span class="line">[a,b])&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Geometry.Polygon"</span>&#125;);OpenLayers.Geometry.Polygon.createRegularPolygon=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">var</span> e=<span class="built_in">Math</span>.PI*(<span class="number">1</span>/c<span class="number">-0.5</span>);d&amp;&amp;(e+=d/<span class="number">180</span>*<span class="built_in">Math</span>.PI);<span class="keyword">for</span>(<span class="keyword">var</span> f,g=[],h=<span class="number">0</span>;h&lt;c;++h)f=e+<span class="number">2</span>*h*<span class="built_in">Math</span>.PI/c,d=a.x+b*<span class="built_in">Math</span>.cos(f),f=a.y+b*<span class="built_in">Math</span>.sin(f),g.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(d,f));a=<span class="keyword">new</span> OpenLayers.Geometry.LinearRing(g);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.Polygon([a])&#125;;OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,&#123;<span class="attr">componentTypes</span>:[<span class="string">"OpenLayers.Geometry.Polygon"</span>],<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Geometry.MultiPolygon"</span>&#125;);OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">featureNS</span>:<span class="string">"http://mapserver.gis.umn.edu/mapserver"</span>,<span class="attr">featurePrefix</span>:<span class="string">"feature"</span>,<span class="attr">featureName</span>:<span class="string">"featureMember"</span>,<span class="attr">layerName</span>:<span class="string">"features"</span>,<span class="attr">geometryName</span>:<span class="string">"geometry"</span>,<span class="attr">collectionName</span>:<span class="string">"FeatureCollection"</span>,<span class="attr">gmlns</span>:<span class="string">"http://www.opengis.net/gml"</span>,<span class="attr">extractAttributes</span>:!<span class="number">0</span>,<span class="attr">xy</span>:!<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.regExes=&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;;OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==</span><br><span class="line"><span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a=<span class="keyword">this</span>.getElementsByTagNameNS(a.documentElement,<span class="keyword">this</span>.gmlns,<span class="keyword">this</span>.featureName);<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>;c&lt;a.length;c++)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.parseFeature(a[c]);d&amp;&amp;b.push(d)&#125;<span class="keyword">return</span> b&#125;,<span class="attr">parseFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="string">"MultiPolygon Polygon MultiLineString LineString MultiPoint Point Envelope"</span>.split(<span class="string">" "</span>),c,d,e,f=<span class="number">0</span>;f&lt;b.length;++f)<span class="keyword">if</span>(c=b[f],d=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.gmlns,c),<span class="number">0</span>&lt;d.length)&#123;<span class="keyword">if</span>(e=<span class="keyword">this</span>.parseGeometry[c.toLowerCase()])e=e.apply(<span class="keyword">this</span>,</span><br><span class="line">[d[<span class="number">0</span>]]),<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection&amp;&amp;e.transform(<span class="keyword">this</span>.externalProjection,<span class="keyword">this</span>.internalProjection);<span class="keyword">else</span> <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Unsupported geometry type: "</span>+c);<span class="keyword">break</span>&#125;<span class="keyword">var</span> g;c=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.gmlns,<span class="string">"Box"</span>);<span class="keyword">for</span>(f=<span class="number">0</span>;f&lt;c.length;++f)b=c[f],d=<span class="keyword">this</span>.parseGeometry.box.apply(<span class="keyword">this</span>,[b]),b=b.parentNode,<span class="string">"boundedBy"</span>===(b.localName||b.nodeName.split(<span class="string">":"</span>).pop())?g=d:e=d.toGeometry();<span class="keyword">var</span> h;<span class="keyword">this</span>.extractAttributes&amp;&amp;(h=<span class="keyword">this</span>.parseAttributes(a));h=<span class="keyword">new</span> OpenLayers.Feature.Vector(e,h);h.bounds=</span><br><span class="line">g;h.gml=&#123;<span class="attr">featureType</span>:a.firstChild.nodeName.split(<span class="string">":"</span>)[<span class="number">1</span>],<span class="attr">featureNS</span>:a.firstChild.namespaceURI,<span class="attr">featureNSPrefix</span>:a.firstChild.prefix&#125;;a=a.firstChild;<span class="keyword">for</span>(<span class="keyword">var</span> k;a&amp;&amp;(<span class="number">1</span>!=a.nodeType||!(k=a.getAttribute(<span class="string">"fid"</span>)||a.getAttribute(<span class="string">"id"</span>)));)a=a.nextSibling;h.fid=k;<span class="keyword">return</span> h&#125;,<span class="attr">parseGeometry</span>:&#123;<span class="attr">point</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c;c=[];b=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.gmlns,<span class="string">"pos"</span>);<span class="number">0</span>&lt;b.length&amp;&amp;(c=b[<span class="number">0</span>].firstChild.nodeValue,c=c.replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>),c=c.split(<span class="keyword">this</span>.regExes.splitSpace));<span class="number">0</span>==c.length&amp;&amp;(b=<span class="keyword">this</span>.getElementsByTagNameNS(a,</span><br><span class="line"><span class="keyword">this</span>.gmlns,<span class="string">"coordinates"</span>),<span class="number">0</span>&lt;b.length&amp;&amp;(c=b[<span class="number">0</span>].firstChild.nodeValue,c=c.replace(<span class="keyword">this</span>.regExes.removeSpace,<span class="string">""</span>),c=c.split(<span class="string">","</span>)));<span class="number">0</span>==c.length&amp;&amp;(b=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.gmlns,<span class="string">"coord"</span>),<span class="number">0</span>&lt;b.length&amp;&amp;(a=<span class="keyword">this</span>.getElementsByTagNameNS(b[<span class="number">0</span>],<span class="keyword">this</span>.gmlns,<span class="string">"X"</span>),b=<span class="keyword">this</span>.getElementsByTagNameNS(b[<span class="number">0</span>],<span class="keyword">this</span>.gmlns,<span class="string">"Y"</span>),<span class="number">0</span>&lt;a.length&amp;&amp;<span class="number">0</span>&lt;b.length&amp;&amp;(c=[a[<span class="number">0</span>].firstChild.nodeValue,b[<span class="number">0</span>].firstChild.nodeValue])));<span class="number">2</span>==c.length&amp;&amp;(c[<span class="number">2</span>]=<span class="literal">null</span>);<span class="keyword">return</span> <span class="keyword">this</span>.xy?<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">0</span>],c[<span class="number">1</span>],c[<span class="number">2</span>]):<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">1</span>],</span><br><span class="line">c[<span class="number">0</span>],c[<span class="number">2</span>])&#125;,<span class="attr">multipoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.gmlns,<span class="string">"Point"</span>);<span class="keyword">var</span> b=[];<span class="keyword">if</span>(<span class="number">0</span>&lt;a.length)<span class="keyword">for</span>(<span class="keyword">var</span> c,d=<span class="number">0</span>;d&lt;a.length;++d)(c=<span class="keyword">this</span>.parseGeometry.point.apply(<span class="keyword">this</span>,[a[d]]))&amp;&amp;b.push(c);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.MultiPoint(b)&#125;,<span class="attr">linestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c,d;d=[];<span class="keyword">var</span> e=[];c=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.gmlns,<span class="string">"posList"</span>);<span class="keyword">if</span>(<span class="number">0</span>&lt;c.length)&#123;d=<span class="keyword">this</span>.getChildValue(c[<span class="number">0</span>]);d=d.replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>);d=d.split(<span class="keyword">this</span>.regExes.splitSpace);<span class="keyword">var</span> f=<span class="built_in">parseInt</span>(c[<span class="number">0</span>].getAttribute(<span class="string">"dimension"</span>)),</span><br><span class="line">g,h,k;<span class="keyword">for</span>(c=<span class="number">0</span>;c&lt;d.length/f;++c)g=c*f,h=d[g],k=d[g+<span class="number">1</span>],g=<span class="number">2</span>==f?<span class="literal">null</span>:d[g+<span class="number">2</span>],<span class="keyword">this</span>.xy?e.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(h,k,g)):e.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(k,h,g))&#125;<span class="keyword">if</span>(<span class="number">0</span>==d.length&amp;&amp;(c=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.gmlns,<span class="string">"coordinates"</span>),<span class="number">0</span>&lt;c.length))<span class="keyword">for</span>(d=<span class="keyword">this</span>.getChildValue(c[<span class="number">0</span>]),d=d.replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>),d=d.replace(<span class="keyword">this</span>.regExes.trimComma,<span class="string">","</span>),f=d.split(<span class="keyword">this</span>.regExes.splitSpace),c=<span class="number">0</span>;c&lt;f.length;++c)d=f[c].split(<span class="string">","</span>),<span class="number">2</span>==d.length&amp;&amp;(d[<span class="number">2</span>]=<span class="literal">null</span>),<span class="keyword">this</span>.xy?e.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(d[<span class="number">0</span>],</span><br><span class="line">d[<span class="number">1</span>],d[<span class="number">2</span>])):e.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(d[<span class="number">1</span>],d[<span class="number">0</span>],d[<span class="number">2</span>]));d=<span class="literal">null</span>;<span class="number">0</span>!=e.length&amp;&amp;(d=b?<span class="keyword">new</span> OpenLayers.Geometry.LinearRing(e):<span class="keyword">new</span> OpenLayers.Geometry.LineString(e));<span class="keyword">return</span> d&#125;,<span class="attr">multilinestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.gmlns,<span class="string">"LineString"</span>);<span class="keyword">var</span> b=[];<span class="keyword">if</span>(<span class="number">0</span>&lt;a.length)<span class="keyword">for</span>(<span class="keyword">var</span> c,d=<span class="number">0</span>;d&lt;a.length;++d)(c=<span class="keyword">this</span>.parseGeometry.linestring.apply(<span class="keyword">this</span>,[a[d]]))&amp;&amp;b.push(c);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.MultiLineString(b)&#125;,<span class="attr">polygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.gmlns,<span class="string">"LinearRing"</span>);</span><br><span class="line"><span class="keyword">var</span> b=[];<span class="keyword">if</span>(<span class="number">0</span>&lt;a.length)<span class="keyword">for</span>(<span class="keyword">var</span> c,d=<span class="number">0</span>;d&lt;a.length;++d)(c=<span class="keyword">this</span>.parseGeometry.linestring.apply(<span class="keyword">this</span>,[a[d],!<span class="number">0</span>]))&amp;&amp;b.push(c);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.Polygon(b)&#125;,<span class="attr">multipolygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.gmlns,<span class="string">"Polygon"</span>);<span class="keyword">var</span> b=[];<span class="keyword">if</span>(<span class="number">0</span>&lt;a.length)<span class="keyword">for</span>(<span class="keyword">var</span> c,d=<span class="number">0</span>;d&lt;a.length;++d)(c=<span class="keyword">this</span>.parseGeometry.polygon.apply(<span class="keyword">this</span>,[a[d]]))&amp;&amp;b.push(c);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.MultiPolygon(b)&#125;,<span class="attr">envelope</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=[],c,d,e=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.gmlns,<span class="string">"lowerCorner"</span>);<span class="keyword">if</span>(<span class="number">0</span>&lt;e.length)&#123;c=</span><br><span class="line">[];<span class="number">0</span>&lt;e.length&amp;&amp;(c=e[<span class="number">0</span>].firstChild.nodeValue,c=c.replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>),c=c.split(<span class="keyword">this</span>.regExes.splitSpace));<span class="number">2</span>==c.length&amp;&amp;(c[<span class="number">2</span>]=<span class="literal">null</span>);<span class="keyword">var</span> f=<span class="keyword">this</span>.xy?<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">0</span>],c[<span class="number">1</span>],c[<span class="number">2</span>]):<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">1</span>],c[<span class="number">0</span>],c[<span class="number">2</span>])&#125;a=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.gmlns,<span class="string">"upperCorner"</span>);<span class="keyword">if</span>(<span class="number">0</span>&lt;a.length)&#123;c=[];<span class="number">0</span>&lt;a.length&amp;&amp;(c=a[<span class="number">0</span>].firstChild.nodeValue,c=c.replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>),c=c.split(<span class="keyword">this</span>.regExes.splitSpace));<span class="number">2</span>==c.length&amp;&amp;(c[<span class="number">2</span>]=<span class="literal">null</span>);<span class="keyword">var</span> g=<span class="keyword">this</span>.xy?<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">0</span>],</span><br><span class="line">c[<span class="number">1</span>],c[<span class="number">2</span>]):<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">1</span>],c[<span class="number">0</span>],c[<span class="number">2</span>])&#125;f&amp;&amp;g&amp;&amp;(b.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(f.x,f.y)),b.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(g.x,f.y)),b.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(g.x,g.y)),b.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(f.x,g.y)),b.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(f.x,f.y)),b=<span class="keyword">new</span> OpenLayers.Geometry.LinearRing(b),d=<span class="keyword">new</span> OpenLayers.Geometry.Polygon([b]));<span class="keyword">return</span> d&#125;,<span class="attr">box</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.gmlns,<span class="string">"coordinates"</span>),c=a=<span class="literal">null</span>;<span class="number">0</span>&lt;b.length&amp;&amp;(b=b[<span class="number">0</span>].firstChild.nodeValue,</span><br><span class="line">b=b.split(<span class="string">" "</span>),<span class="number">2</span>==b.length&amp;&amp;(a=b[<span class="number">0</span>].split(<span class="string">","</span>),c=b[<span class="number">1</span>].split(<span class="string">","</span>)));<span class="keyword">if</span>(<span class="literal">null</span>!==a&amp;&amp;<span class="literal">null</span>!==c)<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Bounds(<span class="built_in">parseFloat</span>(a[<span class="number">0</span>]),<span class="built_in">parseFloat</span>(a[<span class="number">1</span>]),<span class="built_in">parseFloat</span>(c[<span class="number">0</span>]),<span class="built_in">parseFloat</span>(c[<span class="number">1</span>]))&#125;&#125;,<span class="attr">parseAttributes</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;&#125;;a=a.firstChild;<span class="keyword">for</span>(<span class="keyword">var</span> c,d,e;a;)&#123;<span class="keyword">if</span>(<span class="number">1</span>==a.nodeType)&#123;a=a.childNodes;<span class="keyword">for</span>(c=<span class="number">0</span>;c&lt;a.length;++c)<span class="keyword">if</span>(d=a[c],<span class="number">1</span>==d.nodeType)<span class="keyword">if</span>(e=d.childNodes,<span class="number">1</span>==e.length)&#123;<span class="keyword">if</span>(e=e[<span class="number">0</span>],<span class="number">3</span>==e.nodeType||<span class="number">4</span>==e.nodeType)d=d.prefix?d.nodeName.split(<span class="string">":"</span>)[<span class="number">1</span>]:d.nodeName,e=e.nodeValue.replace(<span class="keyword">this</span>.regExes.trimSpace,</span><br><span class="line"><span class="string">""</span>),b[d]=e&#125;<span class="keyword">else</span> b[d.nodeName.split(<span class="string">":"</span>).pop()]=<span class="literal">null</span>;<span class="keyword">break</span>&#125;a=a.nextSibling&#125;<span class="keyword">return</span> b&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.isArray(a)||(a=[a]);<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="string">"http://www.opengis.net/wfs"</span>,<span class="string">"wfs:"</span>+<span class="keyword">this</span>.collectionName),c=<span class="number">0</span>;c&lt;a.length;c++)b.appendChild(<span class="keyword">this</span>.createFeatureXML(a[c]));<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[b])&#125;,<span class="attr">createFeatureXML</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.buildGeometryNode(a.geometry),c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.featureNS,<span class="keyword">this</span>.featurePrefix+<span class="string">":"</span>+<span class="keyword">this</span>.geometryName);c.appendChild(b);</span><br><span class="line"><span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,<span class="string">"gml:"</span>+<span class="keyword">this</span>.featureName),d=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.featureNS,<span class="keyword">this</span>.featurePrefix+<span class="string">":"</span>+<span class="keyword">this</span>.layerName);d.setAttribute(<span class="string">"fid"</span>,a.fid||a.id);d.appendChild(c);<span class="keyword">for</span>(<span class="keyword">var</span> e <span class="keyword">in</span> a.attributes)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.createTextNode(a.attributes[e]),f=e.substring(e.lastIndexOf(<span class="string">":"</span>)+<span class="number">1</span>),f=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.featureNS,<span class="keyword">this</span>.featurePrefix+<span class="string">":"</span>+f);f.appendChild(c);d.appendChild(f)&#125;b.appendChild(d);<span class="keyword">return</span> b&#125;,<span class="attr">buildGeometryNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.externalProjection&amp;&amp;<span class="keyword">this</span>.internalProjection&amp;&amp;</span><br><span class="line">(a=a.clone(),a.transform(<span class="keyword">this</span>.internalProjection,<span class="keyword">this</span>.externalProjection));<span class="keyword">var</span> b=a.CLASS_NAME,b=b.substring(b.lastIndexOf(<span class="string">"."</span>)+<span class="number">1</span>);<span class="keyword">return</span> <span class="keyword">this</span>.buildGeometry[b.toLowerCase()].apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">buildGeometry</span>:&#123;<span class="attr">point</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,<span class="string">"gml:Point"</span>);b.appendChild(<span class="keyword">this</span>.buildCoordinatesNode(a));<span class="keyword">return</span> b&#125;,<span class="attr">multipoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,<span class="string">"gml:MultiPoint"</span>);a=a.components;<span class="keyword">for</span>(<span class="keyword">var</span> c,d,e=<span class="number">0</span>;e&lt;a.length;e++)c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,<span class="string">"gml:pointMember"</span>),</span><br><span class="line">d=<span class="keyword">this</span>.buildGeometry.point.apply(<span class="keyword">this</span>,[a[e]]),c.appendChild(d),b.appendChild(c);<span class="keyword">return</span> b&#125;,<span class="attr">linestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,<span class="string">"gml:LineString"</span>);b.appendChild(<span class="keyword">this</span>.buildCoordinatesNode(a));<span class="keyword">return</span> b&#125;,<span class="attr">multilinestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,<span class="string">"gml:MultiLineString"</span>);a=a.components;<span class="keyword">for</span>(<span class="keyword">var</span> c,d,e=<span class="number">0</span>;e&lt;a.length;++e)c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,<span class="string">"gml:lineStringMember"</span>),d=<span class="keyword">this</span>.buildGeometry.linestring.apply(<span class="keyword">this</span>,[a[e]]),c.appendChild(d),b.appendChild(c);</span><br><span class="line"><span class="keyword">return</span> b&#125;,<span class="attr">linearring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,<span class="string">"gml:LinearRing"</span>);b.appendChild(<span class="keyword">this</span>.buildCoordinatesNode(a));<span class="keyword">return</span> b&#125;,<span class="attr">polygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,<span class="string">"gml:Polygon"</span>);a=a.components;<span class="keyword">for</span>(<span class="keyword">var</span> c,d,e=<span class="number">0</span>;e&lt;a.length;++e)c=<span class="number">0</span>==e?<span class="string">"outerBoundaryIs"</span>:<span class="string">"innerBoundaryIs"</span>,c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,<span class="string">"gml:"</span>+c),d=<span class="keyword">this</span>.buildGeometry.linearring.apply(<span class="keyword">this</span>,[a[e]]),c.appendChild(d),b.appendChild(c);<span class="keyword">return</span> b&#125;,<span class="attr">multipolygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,</span><br><span class="line"><span class="string">"gml:MultiPolygon"</span>);a=a.components;<span class="keyword">for</span>(<span class="keyword">var</span> c,d,e=<span class="number">0</span>;e&lt;a.length;++e)c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,<span class="string">"gml:polygonMember"</span>),d=<span class="keyword">this</span>.buildGeometry.polygon.apply(<span class="keyword">this</span>,[a[e]]),c.appendChild(d),b.appendChild(c);<span class="keyword">return</span> b&#125;,<span class="attr">bounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,<span class="string">"gml:Box"</span>);b.appendChild(<span class="keyword">this</span>.buildCoordinatesNode(a));<span class="keyword">return</span> b&#125;&#125;,<span class="attr">buildCoordinatesNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.gmlns,<span class="string">"gml:coordinates"</span>);b.setAttribute(<span class="string">"decimal"</span>,<span class="string">"."</span>);b.setAttribute(<span class="string">"cs"</span>,<span class="string">","</span>);b.setAttribute(<span class="string">"ts"</span>,</span><br><span class="line"><span class="string">" "</span>);<span class="keyword">var</span> c=[];<span class="keyword">if</span>(a <span class="keyword">instanceof</span> OpenLayers.Bounds)c.push(a.left+<span class="string">","</span>+a.bottom),c.push(a.right+<span class="string">","</span>+a.top);<span class="keyword">else</span>&#123;a=a.components?a.components:[a];<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>;d&lt;a.length;d++)c.push(a[d].x+<span class="string">","</span>+a[d].y)&#125;c=<span class="keyword">this</span>.createTextNode(c.join(<span class="string">" "</span>));b.appendChild(c);<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.GML"</span>&#125;);OpenLayers.Format.GML||(OpenLayers.Format.GML=&#123;&#125;);</span><br><span class="line">OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">gml</span>:<span class="string">"http://www.opengis.net/gml"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>,<span class="attr">wfs</span>:<span class="string">"http://www.opengis.net/wfs"</span>&#125;,<span class="attr">defaultPrefix</span>:<span class="string">"gml"</span>,<span class="attr">schemaLocation</span>:<span class="literal">null</span>,<span class="attr">featureType</span>:<span class="literal">null</span>,<span class="attr">featureNS</span>:<span class="literal">null</span>,<span class="attr">geometryName</span>:<span class="string">"geometry"</span>,<span class="attr">extractAttributes</span>:!<span class="number">0</span>,<span class="attr">srsName</span>:<span class="literal">null</span>,<span class="attr">xy</span>:!<span class="number">0</span>,<span class="attr">geometryTypes</span>:<span class="literal">null</span>,<span class="attr">singleFeatureType</span>:<span class="literal">null</span>,<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>,<span class="attr">featureMember</span>:<span class="regexp">/^(.*:)?featureMembers?$/</span>&#125;,</span><br><span class="line">initialize:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.setGeometryTypes();a&amp;&amp;a.featureNS&amp;&amp;<span class="keyword">this</span>.setNamespace(<span class="string">"feature"</span>,a.featureNS);<span class="keyword">this</span>.singleFeatureType=!a||<span class="string">"string"</span>===<span class="keyword">typeof</span> a.featureType&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> b=[];<span class="keyword">this</span>.readNode(a,&#123;<span class="attr">features</span>:b&#125;,!<span class="number">0</span>);<span class="keyword">if</span>(<span class="number">0</span>==b.length)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.namespaces.gml,<span class="string">"featureMember"</span>);<span class="keyword">if</span>(c.length)&#123;a=</span><br><span class="line"><span class="number">0</span>;<span class="keyword">for</span>(<span class="keyword">var</span> d=c.length;a&lt;d;++a)<span class="keyword">this</span>.readNode(c[a],&#123;<span class="attr">features</span>:b&#125;,!<span class="number">0</span>)&#125;<span class="keyword">else</span> c=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.namespaces.gml,<span class="string">"featureMembers"</span>),c.length&amp;&amp;<span class="keyword">this</span>.readNode(c[<span class="number">0</span>],&#123;<span class="attr">features</span>:b&#125;,!<span class="number">0</span>)&#125;<span class="keyword">return</span> b&#125;,<span class="attr">readNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;!<span class="number">0</span>===c&amp;&amp;!<span class="number">0</span>===<span class="keyword">this</span>.autoConfig&amp;&amp;(<span class="keyword">this</span>.featureType=<span class="literal">null</span>,<span class="keyword">delete</span> <span class="keyword">this</span>.namespaceAlias[<span class="keyword">this</span>.featureNS],<span class="keyword">delete</span> <span class="keyword">this</span>.namespaces.feature,<span class="keyword">this</span>.featureNS=<span class="literal">null</span>);<span class="keyword">this</span>.featureNS||(a.prefix <span class="keyword">in</span> <span class="keyword">this</span>.namespaces||a.parentNode.namespaceURI!=<span class="keyword">this</span>.namespaces.gml||!<span class="keyword">this</span>.regExes.featureMember.test(a.parentNode.nodeName))||</span><br><span class="line">(<span class="keyword">this</span>.featureType=a.nodeName.split(<span class="string">":"</span>).pop(),<span class="keyword">this</span>.setNamespace(<span class="string">"feature"</span>,a.namespaceURI),<span class="keyword">this</span>.featureNS=a.namespaceURI,<span class="keyword">this</span>.autoConfig=!<span class="number">0</span>);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.readNode.apply(<span class="keyword">this</span>,[a,b])&#125;,<span class="attr">readers</span>:&#123;<span class="attr">gml</span>:&#123;<span class="attr">_inherit</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;&#125;,<span class="attr">featureMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">featureMembers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.name=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">boundedBy</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);c.components&amp;&amp;<span class="number">0</span>&lt;c.components.length&amp;&amp;</span><br><span class="line">(b.bounds=c.components[<span class="number">0</span>])&#125;,<span class="attr">Point</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">points</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.components||(b.components=[]);b.components.push(c.points[<span class="number">0</span>])&#125;,<span class="attr">coordinates</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a).replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>),c=c.replace(<span class="keyword">this</span>.regExes.trimComma,<span class="string">","</span>),c=c.split(<span class="keyword">this</span>.regExes.splitSpace),d,e=c.length,f=<span class="built_in">Array</span>(e),g=<span class="number">0</span>;g&lt;e;++g)d=c[g].split(<span class="string">","</span>),f[g]=<span class="keyword">this</span>.xy?<span class="keyword">new</span> OpenLayers.Geometry.Point(d[<span class="number">0</span>],d[<span class="number">1</span>],d[<span class="number">2</span>]):<span class="keyword">new</span> OpenLayers.Geometry.Point(d[<span class="number">1</span>],d[<span class="number">0</span>],d[<span class="number">2</span>]);b.points=f&#125;,<span class="attr">coord</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.points||(b.points=[]);b.points.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(c.x,c.y,c.z))&#125;,<span class="attr">X</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.x=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Y</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.y=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Z</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.z=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">MultiPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">components</span>:[]&#125;;<span class="keyword">this</span>.readers.gml._inherit.apply(<span class="keyword">this</span>,[a,c,b]);<span class="keyword">this</span>.readChildNodes(a,c);b.components=[<span class="keyword">new</span> OpenLayers.Geometry.MultiPoint(c.components)]&#125;,<span class="attr">pointMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">LineString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readers.gml._inherit.apply(<span class="keyword">this</span>,[a,c,b]);<span class="keyword">this</span>.readChildNodes(a,c);b.components||(b.components=[]);b.components.push(<span class="keyword">new</span> OpenLayers.Geometry.LineString(c.points))&#125;,<span class="attr">MultiLineString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">components</span>:[]&#125;;<span class="keyword">this</span>.readers.gml._inherit.apply(<span class="keyword">this</span>,[a,c,b]);<span class="keyword">this</span>.readChildNodes(a,c);b.components=[<span class="keyword">new</span> OpenLayers.Geometry.MultiLineString(c.components)]&#125;,<span class="attr">lineStringMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Polygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">outer</span>:<span class="literal">null</span>,<span class="attr">inner</span>:[]&#125;;<span class="keyword">this</span>.readers.gml._inherit.apply(<span class="keyword">this</span>,</span><br><span class="line">[a,c,b]);<span class="keyword">this</span>.readChildNodes(a,c);c.inner.unshift(c.outer);b.components||(b.components=[]);b.components.push(<span class="keyword">new</span> OpenLayers.Geometry.Polygon(c.inner))&#125;,<span class="attr">LinearRing</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readers.gml._inherit.apply(<span class="keyword">this</span>,[a,c]);<span class="keyword">this</span>.readChildNodes(a,c);b.components=[<span class="keyword">new</span> OpenLayers.Geometry.LinearRing(c.points)]&#125;,<span class="attr">MultiPolygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">components</span>:[]&#125;;<span class="keyword">this</span>.readers.gml._inherit.apply(<span class="keyword">this</span>,[a,c,b]);<span class="keyword">this</span>.readChildNodes(a,c);b.components=[<span class="keyword">new</span> OpenLayers.Geometry.MultiPolygon(c.components)]&#125;,</span><br><span class="line">polygonMember:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">GeometryCollection</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">components</span>:[]&#125;;<span class="keyword">this</span>.readers.gml._inherit.apply(<span class="keyword">this</span>,[a,c,b]);<span class="keyword">this</span>.readChildNodes(a,c);b.components=[<span class="keyword">new</span> OpenLayers.Geometry.Collection(c.components)]&#125;,<span class="attr">geometryMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;&#125;,<span class="attr">feature</span>:&#123;<span class="string">"*"</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c,d=a.localName||a.nodeName.split(<span class="string">":"</span>).pop();b.features?<span class="keyword">this</span>.singleFeatureType||<span class="number">-1</span>===OpenLayers.Util.indexOf(<span class="keyword">this</span>.featureType,d)?d===<span class="keyword">this</span>.featureType&amp;&amp;(c=<span class="string">"_typeName"</span>):c=</span><br><span class="line"><span class="string">"_typeName"</span>:<span class="number">0</span>==a.childNodes.length||<span class="number">1</span>==a.childNodes.length&amp;&amp;<span class="number">3</span>==a.firstChild.nodeType?<span class="keyword">this</span>.extractAttributes&amp;&amp;(c=<span class="string">"_attribute"</span>):c=<span class="string">"_geometry"</span>;c&amp;&amp;<span class="keyword">this</span>.readers.feature[c].apply(<span class="keyword">this</span>,[a,b])&#125;,<span class="attr">_typeName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">components</span>:[],<span class="attr">attributes</span>:&#123;&#125;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);c.name&amp;&amp;(c.attributes.name=c.name);<span class="keyword">var</span> d=<span class="keyword">new</span> OpenLayers.Feature.Vector(c.components[<span class="number">0</span>],c.attributes);<span class="keyword">this</span>.singleFeatureType||(d.type=a.nodeName.split(<span class="string">":"</span>).pop(),d.namespace=a.namespaceURI);<span class="keyword">var</span> e=a.getAttribute(<span class="string">"fid"</span>)||<span class="keyword">this</span>.getAttributeNS(a,</span><br><span class="line"><span class="keyword">this</span>.namespaces.gml,<span class="string">"id"</span>);e&amp;&amp;(d.fid=e);<span class="keyword">this</span>.internalProjection&amp;&amp;(<span class="keyword">this</span>.externalProjection&amp;&amp;d.geometry)&amp;&amp;d.geometry.transform(<span class="keyword">this</span>.externalProjection,<span class="keyword">this</span>.internalProjection);c.bounds&amp;&amp;(d.bounds=c.bounds);b.features.push(d)&#125;,<span class="attr">_geometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.geometryName||(<span class="keyword">this</span>.geometryName=a.nodeName.split(<span class="string">":"</span>).pop());<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">_attribute</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.localName||a.nodeName.split(<span class="string">":"</span>).pop(),d=<span class="keyword">this</span>.getChildValue(a);b.attributes[c]=d&#125;&#125;,<span class="attr">wfs</span>:&#123;<span class="attr">FeatureCollection</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,</span><br><span class="line">b)&#125;&#125;&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;b=OpenLayers.Util.isArray(a)?<span class="string">"featureMembers"</span>:<span class="string">"featureMember"</span>;a=<span class="keyword">this</span>.writeNode(<span class="string">"gml:"</span>+b,a);<span class="keyword">this</span>.setAttributeNS(a,<span class="keyword">this</span>.namespaces.xsi,<span class="string">"xsi:schemaLocation"</span>,<span class="keyword">this</span>.schemaLocation);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">writers</span>:&#123;<span class="attr">gml</span>:&#123;<span class="attr">featureMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:featureMember"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"feature:_typeName"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">MultiPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:MultiPoint"</span>);a=a.components||[a];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"pointMember"</span>,a[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">pointMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:pointMember"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"Point"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">MultiLineString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:MultiLineString"</span>);a=a.components||[a];<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"lineStringMember"</span>,a[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">lineStringMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:lineStringMember"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"LineString"</span>,a,b);<span class="keyword">return</span> b&#125;,</span><br><span class="line">MultiPolygon:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:MultiPolygon"</span>);a=a.components||[a];<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"polygonMember"</span>,a[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">polygonMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:polygonMember"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"Polygon"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">GeometryCollection</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:GeometryCollection"</span>),c=<span class="number">0</span>,d=a.components.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"geometryMember"</span>,a.components[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">geometryMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:geometryMember"</span>);a=<span class="keyword">this</span>.writeNode(<span class="string">"feature:_geometry"</span>,a);b.appendChild(a.firstChild);<span class="keyword">return</span> b&#125;&#125;,<span class="attr">feature</span>:&#123;<span class="attr">_typeName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"feature:"</span>+<span class="keyword">this</span>.featureType,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">fid</span>:a.fid&#125;&#125;);a.geometry&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"feature:_geometry"</span>,a.geometry,b);<span class="keyword">for</span>(<span class="keyword">var</span> c <span class="keyword">in</span> a.attributes)&#123;<span class="keyword">var</span> d=a.attributes[c];<span class="literal">null</span>!=d&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"feature:_attribute"</span>,&#123;<span class="attr">name</span>:c,<span class="attr">value</span>:d&#125;,b)&#125;<span class="keyword">return</span> b&#125;,<span class="attr">_geometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.externalProjection&amp;&amp;<span class="keyword">this</span>.internalProjection&amp;&amp;(a=</span><br><span class="line">a.clone().transform(<span class="keyword">this</span>.internalProjection,<span class="keyword">this</span>.externalProjection));<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"feature:"</span>+<span class="keyword">this</span>.geometryName);a=<span class="keyword">this</span>.writeNode(<span class="string">"gml:"</span>+<span class="keyword">this</span>.geometryTypes[a.CLASS_NAME],a,b);<span class="keyword">this</span>.srsName&amp;&amp;a.setAttribute(<span class="string">"srsName"</span>,<span class="keyword">this</span>.srsName);<span class="keyword">return</span> b&#125;,<span class="attr">_attribute</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"feature:"</span>+a.name,&#123;<span class="attr">value</span>:a.value&#125;)&#125;&#125;,<span class="attr">wfs</span>:&#123;<span class="attr">FeatureCollection</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:FeatureCollection"</span>),c=<span class="number">0</span>,d=a.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"gml:featureMember"</span>,</span><br><span class="line">a[c],b);<span class="keyword">return</span> b&#125;&#125;&#125;,<span class="attr">setGeometryTypes</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.geometryTypes=&#123;<span class="string">"OpenLayers.Geometry.Point"</span>:<span class="string">"Point"</span>,<span class="string">"OpenLayers.Geometry.MultiPoint"</span>:<span class="string">"MultiPoint"</span>,<span class="string">"OpenLayers.Geometry.LineString"</span>:<span class="string">"LineString"</span>,<span class="string">"OpenLayers.Geometry.MultiLineString"</span>:<span class="string">"MultiLineString"</span>,<span class="string">"OpenLayers.Geometry.Polygon"</span>:<span class="string">"Polygon"</span>,<span class="string">"OpenLayers.Geometry.MultiPolygon"</span>:<span class="string">"MultiPolygon"</span>,<span class="string">"OpenLayers.Geometry.Collection"</span>:<span class="string">"GeometryCollection"</span>&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.GML.Base"</span>&#125;);OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,&#123;<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd"</span>,<span class="attr">curve</span>:!<span class="number">1</span>,<span class="attr">multiCurve</span>:!<span class="number">0</span>,<span class="attr">surface</span>:!<span class="number">1</span>,<span class="attr">multiSurface</span>:!<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.GML.Base.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">readers</span>:&#123;<span class="attr">gml</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">_inherit</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">if</span>(a=<span class="built_in">parseInt</span>(a.getAttribute(<span class="string">"srsDimension"</span>),<span class="number">10</span>)||c&amp;&amp;c.srsDimension)b.srsDimension=a&#125;,<span class="attr">featureMembers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Curve</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">points</span>:[]&#125;;<span class="keyword">this</span>.readers.gml._inherit.apply(<span class="keyword">this</span>,[a,c,b]);<span class="keyword">this</span>.readChildNodes(a,c);b.components||(b.components=[]);b.components.push(<span class="keyword">new</span> OpenLayers.Geometry.LineString(c.points))&#125;,<span class="attr">segments</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">LineStringSegment</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);c.points&amp;&amp;<span class="built_in">Array</span>.prototype.push.apply(b.points,c.points)&#125;,<span class="attr">pos</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a).replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>).split(<span class="keyword">this</span>.regExes.splitSpace),</span><br><span class="line">c=<span class="keyword">this</span>.xy?<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">0</span>],c[<span class="number">1</span>],c[<span class="number">2</span>]):<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">1</span>],c[<span class="number">0</span>],c[<span class="number">2</span>]);b.points=[c]&#125;,<span class="attr">posList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a).replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>).split(<span class="keyword">this</span>.regExes.splitSpace),d=b.srsDimension||<span class="built_in">parseInt</span>(a.getAttribute(<span class="string">"srsDimension"</span>)||a.getAttribute(<span class="string">"dimension"</span>),<span class="number">10</span>)||<span class="number">2</span>,e,f,g,h=<span class="built_in">Array</span>(c.length/d),k=<span class="number">0</span>,l=c.length;k&lt;l;k+=d)e=c[k],f=c[k+<span class="number">1</span>],g=<span class="number">2</span>==d?<span class="keyword">void</span> <span class="number">0</span>:c[k+<span class="number">2</span>],h[k/d]=<span class="keyword">this</span>.xy?<span class="keyword">new</span> OpenLayers.Geometry.Point(e,f,g):<span class="keyword">new</span> OpenLayers.Geometry.Point(f,</span><br><span class="line">e,g);b.points=h&#125;,<span class="attr">Surface</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">patches</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">PolygonPatch</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readers.gml.Polygon.apply(<span class="keyword">this</span>,[a,b])&#125;,<span class="attr">exterior</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.outer=c.components[<span class="number">0</span>]&#125;,<span class="attr">interior</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.inner.push(c.components[<span class="number">0</span>])&#125;,<span class="attr">MultiCurve</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">components</span>:[]&#125;;<span class="keyword">this</span>.readers.gml._inherit.apply(<span class="keyword">this</span>,[a,c,b]);<span class="keyword">this</span>.readChildNodes(a,c);<span class="number">0</span>&lt;c.components.length&amp;&amp;(b.components=</span><br><span class="line">[<span class="keyword">new</span> OpenLayers.Geometry.MultiLineString(c.components)])&#125;,<span class="attr">curveMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">MultiSurface</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">components</span>:[]&#125;;<span class="keyword">this</span>.readers.gml._inherit.apply(<span class="keyword">this</span>,[a,c,b]);<span class="keyword">this</span>.readChildNodes(a,c);<span class="number">0</span>&lt;c.components.length&amp;&amp;(b.components=[<span class="keyword">new</span> OpenLayers.Geometry.MultiPolygon(c.components)])&#125;,<span class="attr">surfaceMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">surfaceMembers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">pointMembers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">lineStringMembers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">polygonMembers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">geometryMembers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Envelope</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">points</span>:<span class="built_in">Array</span>(<span class="number">2</span>)&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.components||(b.components=[]);<span class="keyword">var</span> d=c.points[<span class="number">0</span>],c=c.points[<span class="number">1</span>];b.components.push(<span class="keyword">new</span> OpenLayers.Bounds(d.x,d.y,c.x,c.y))&#125;,<span class="attr">lowerCorner</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readers.gml.pos.apply(<span class="keyword">this</span>,[a,c]);b.points[<span class="number">0</span>]=c.points[<span class="number">0</span>]&#125;,<span class="attr">upperCorner</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readers.gml.pos.apply(<span class="keyword">this</span>,</span><br><span class="line">[a,c]);b.points[<span class="number">1</span>]=c.points[<span class="number">0</span>]&#125;&#125;,OpenLayers.Format.GML.Base.prototype.readers.gml),<span class="attr">feature</span>:OpenLayers.Format.GML.Base.prototype.readers.feature,<span class="attr">wfs</span>:OpenLayers.Format.GML.Base.prototype.readers.wfs&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;b=OpenLayers.Util.isArray(a)?<span class="string">"featureMembers"</span>:<span class="string">"featureMember"</span>;a=<span class="keyword">this</span>.writeNode(<span class="string">"gml:"</span>+b,a);<span class="keyword">this</span>.setAttributeNS(a,<span class="keyword">this</span>.namespaces.xsi,<span class="string">"xsi:schemaLocation"</span>,<span class="keyword">this</span>.schemaLocation);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">writers</span>:&#123;<span class="attr">gml</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">featureMembers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:featureMembers"</span>),c=<span class="number">0</span>,d=a.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"feature:_typeName"</span>,a[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">Point</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:Point"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"pos"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">pos</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:pos"</span>,&#123;<span class="attr">value</span>:<span class="keyword">this</span>.xy?a.x+<span class="string">" "</span>+a.y:a.y+<span class="string">" "</span>+a.x&#125;)&#125;,<span class="attr">LineString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:LineString"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"posList"</span>,a.components,b);<span class="keyword">return</span> b&#125;,<span class="attr">Curve</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:Curve"</span>);</span><br><span class="line"><span class="keyword">this</span>.writeNode(<span class="string">"segments"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">segments</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:segments"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"LineStringSegment"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">LineStringSegment</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:LineStringSegment"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"posList"</span>,a.components,b);<span class="keyword">return</span> b&#125;,<span class="attr">posList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=a.length,c=<span class="built_in">Array</span>(b),d,e=<span class="number">0</span>;e&lt;b;++e)d=a[e],c[e]=<span class="keyword">this</span>.xy?d.x+<span class="string">" "</span>+d.y:d.y+<span class="string">" "</span>+d.x;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:posList"</span>,&#123;<span class="attr">value</span>:c.join(<span class="string">" "</span>)&#125;)&#125;,<span class="attr">Surface</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:Surface"</span>);</span><br><span class="line"><span class="keyword">this</span>.writeNode(<span class="string">"patches"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">patches</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:patches"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"PolygonPatch"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">PolygonPatch</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:PolygonPatch"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">interpolation</span>:<span class="string">"planar"</span>&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"exterior"</span>,a.components[<span class="number">0</span>],b);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">1</span>,d=a.components.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"interior"</span>,a.components[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">Polygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:Polygon"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"exterior"</span>,a.components[<span class="number">0</span>],</span><br><span class="line">b);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">1</span>,d=a.components.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"interior"</span>,a.components[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">exterior</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:exterior"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"LinearRing"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">interior</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:interior"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"LinearRing"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">LinearRing</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:LinearRing"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"posList"</span>,a.components,b);<span class="keyword">return</span> b&#125;,<span class="attr">MultiCurve</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:MultiCurve"</span>);</span><br><span class="line">a=a.components||[a];<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"curveMember"</span>,a[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">curveMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:curveMember"</span>);<span class="keyword">this</span>.curve?<span class="keyword">this</span>.writeNode(<span class="string">"Curve"</span>,a,b):<span class="keyword">this</span>.writeNode(<span class="string">"LineString"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">MultiSurface</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:MultiSurface"</span>);a=a.components||[a];<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"surfaceMember"</span>,a[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">surfaceMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:surfaceMember"</span>);</span><br><span class="line"><span class="keyword">this</span>.surface?<span class="keyword">this</span>.writeNode(<span class="string">"Surface"</span>,a,b):<span class="keyword">this</span>.writeNode(<span class="string">"Polygon"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">Envelope</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:Envelope"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"lowerCorner"</span>,a,b);<span class="keyword">this</span>.writeNode(<span class="string">"upperCorner"</span>,a,b);<span class="keyword">this</span>.srsName&amp;&amp;b.setAttribute(<span class="string">"srsName"</span>,<span class="keyword">this</span>.srsName);<span class="keyword">return</span> b&#125;,<span class="attr">lowerCorner</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:lowerCorner"</span>,&#123;<span class="attr">value</span>:<span class="keyword">this</span>.xy?a.left+<span class="string">" "</span>+a.bottom:a.bottom+<span class="string">" "</span>+a.left&#125;)&#125;,<span class="attr">upperCorner</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:upperCorner"</span>,&#123;<span class="attr">value</span>:<span class="keyword">this</span>.xy?</span><br><span class="line">a.right+<span class="string">" "</span>+a.top:a.top+<span class="string">" "</span>+a.right&#125;)&#125;&#125;,OpenLayers.Format.GML.Base.prototype.writers.gml),<span class="attr">feature</span>:OpenLayers.Format.GML.Base.prototype.writers.feature,<span class="attr">wfs</span>:OpenLayers.Format.GML.Base.prototype.writers.wfs&#125;,<span class="attr">setGeometryTypes</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.geometryTypes=&#123;<span class="string">"OpenLayers.Geometry.Point"</span>:<span class="string">"Point"</span>,<span class="string">"OpenLayers.Geometry.MultiPoint"</span>:<span class="string">"MultiPoint"</span>,<span class="string">"OpenLayers.Geometry.LineString"</span>:!<span class="number">0</span>===<span class="keyword">this</span>.curve?<span class="string">"Curve"</span>:<span class="string">"LineString"</span>,<span class="string">"OpenLayers.Geometry.MultiLineString"</span>:!<span class="number">1</span>===<span class="keyword">this</span>.multiCurve?<span class="string">"MultiLineString"</span>:<span class="string">"MultiCurve"</span>,<span class="string">"OpenLayers.Geometry.Polygon"</span>:!<span class="number">0</span>===</span><br><span class="line"><span class="keyword">this</span>.surface?<span class="string">"Surface"</span>:<span class="string">"Polygon"</span>,<span class="string">"OpenLayers.Geometry.MultiPolygon"</span>:!<span class="number">1</span>===<span class="keyword">this</span>.multiSurface?<span class="string">"MultiPolygon"</span>:<span class="string">"MultiSurface"</span>,<span class="string">"OpenLayers.Geometry.Collection"</span>:<span class="string">"GeometryCollection"</span>&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.GML.v3"</span>&#125;);OpenLayers.Format.Filter.v1_1_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.Filter.v1,&#123;<span class="attr">VERSION</span>:<span class="string">"1.1.0"</span>,<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/ogc/filter/1.1.0/filter.xsd"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.GML.v3.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">readers</span>:&#123;<span class="attr">ogc</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">PropertyIsEqualTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.getAttribute(<span class="string">"matchCase"</span>),c=<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">type</span>:OpenLayers.Filter.Comparison.EQUAL_TO,<span class="attr">matchCase</span>:!(<span class="string">"false"</span>===c||<span class="string">"0"</span>===c)&#125;);<span class="keyword">this</span>.readChildNodes(a,</span><br><span class="line">c);b.filters.push(c)&#125;,<span class="attr">PropertyIsNotEqualTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.getAttribute(<span class="string">"matchCase"</span>),c=<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">type</span>:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,<span class="attr">matchCase</span>:!(<span class="string">"false"</span>===c||<span class="string">"0"</span>===c)&#125;);<span class="keyword">this</span>.readChildNodes(a,c);b.filters.push(c)&#125;,<span class="attr">PropertyIsLike</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">type</span>:OpenLayers.Filter.Comparison.LIKE&#125;);<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">var</span> d=a.getAttribute(<span class="string">"wildCard"</span>),e=a.getAttribute(<span class="string">"singleChar"</span>),f=a.getAttribute(<span class="string">"escapeChar"</span>);c.value2regex(d,e,</span><br><span class="line">f);b.filters.push(c)&#125;&#125;,OpenLayers.Format.Filter.v1.prototype.readers.ogc),<span class="attr">gml</span>:OpenLayers.Format.GML.v3.prototype.readers.gml,<span class="attr">feature</span>:OpenLayers.Format.GML.v3.prototype.readers.feature&#125;,<span class="attr">writers</span>:&#123;<span class="attr">ogc</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">PropertyIsEqualTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyIsEqualTo"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">matchCase</span>:a.matchCase&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">this</span>.writeOgcExpression(a.value,b);<span class="keyword">return</span> b&#125;,<span class="attr">PropertyIsNotEqualTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyIsNotEqualTo"</span>,</span><br><span class="line">&#123;<span class="attr">attributes</span>:&#123;<span class="attr">matchCase</span>:a.matchCase&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">this</span>.writeOgcExpression(a.value,b);<span class="keyword">return</span> b&#125;,<span class="attr">PropertyIsLike</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyIsLike"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">matchCase</span>:a.matchCase,<span class="attr">wildCard</span>:<span class="string">"*"</span>,<span class="attr">singleChar</span>:<span class="string">"."</span>,<span class="attr">escapeChar</span>:<span class="string">"!"</span>&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">this</span>.writeNode(<span class="string">"Literal"</span>,a.regex2value(),b);<span class="keyword">return</span> b&#125;,<span class="attr">BBOX</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:BBOX"</span>);a.property&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">var</span> c=<span class="keyword">this</span>.writeNode(<span class="string">"gml:Envelope"</span>,</span><br><span class="line">a.value);a.projection&amp;&amp;c.setAttribute(<span class="string">"srsName"</span>,a.projection);b.appendChild(c);<span class="keyword">return</span> b&#125;,<span class="attr">SortBy</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:SortBy"</span>),c=<span class="number">0</span>,d=a.length;c&lt;d;c++)<span class="keyword">this</span>.writeNode(<span class="string">"ogc:SortProperty"</span>,a[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">SortProperty</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:SortProperty"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"ogc:PropertyName"</span>,a,b);<span class="keyword">this</span>.writeNode(<span class="string">"ogc:SortOrder"</span>,<span class="string">"DESC"</span>==a.order?<span class="string">"DESC"</span>:<span class="string">"ASC"</span>,b);<span class="keyword">return</span> b&#125;,<span class="attr">SortOrder</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:SortOrder"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;&#125;,</span><br><span class="line">OpenLayers.Format.Filter.v1.prototype.writers.ogc),<span class="attr">gml</span>:OpenLayers.Format.GML.v3.prototype.writers.gml,<span class="attr">feature</span>:OpenLayers.Format.GML.v3.prototype.writers.feature&#125;,<span class="attr">writeSpatial</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:"</span>+b);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,c);<span class="keyword">if</span>(a.value <span class="keyword">instanceof</span> OpenLayers.Filter.Function)<span class="keyword">this</span>.writeNode(<span class="string">"Function"</span>,a.value,c);<span class="keyword">else</span>&#123;<span class="keyword">var</span> d;d=a.value <span class="keyword">instanceof</span> OpenLayers.Geometry?<span class="keyword">this</span>.writeNode(<span class="string">"feature:_geometry"</span>,a.value).firstChild:<span class="keyword">this</span>.writeNode(<span class="string">"gml:Envelope"</span>,a.value);a.projection&amp;&amp;</span><br><span class="line">d.setAttribute(<span class="string">"srsName"</span>,a.projection);c.appendChild(d)&#125;<span class="keyword">return</span> c&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.Filter.v1_1_0"</span>&#125;);OpenLayers.Format.OWSCommon=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,&#123;<span class="attr">defaultVersion</span>:<span class="string">"1.0.0"</span>,<span class="attr">getVersion</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.version;<span class="keyword">if</span>(!c)&#123;<span class="keyword">var</span> d=a.getAttribute(<span class="string">"xmlns:ows"</span>);d&amp;&amp;<span class="string">"1.1"</span>===d.substring(d.lastIndexOf(<span class="string">"/"</span>)+<span class="number">1</span>)&amp;&amp;(c=<span class="string">"1.1.0"</span>);c||(c=<span class="keyword">this</span>.defaultVersion)&#125;<span class="keyword">return</span> c&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.OWSCommon"</span>&#125;);OpenLayers.Format.OWSCommon.v1=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Util.applyDefaults(b,<span class="keyword">this</span>.options);<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">return</span> c&#125;,<span class="attr">readers</span>:&#123;<span class="attr">ows</span>:&#123;<span class="attr">Exception</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">code</span>:a.getAttribute(<span class="string">"exceptionCode"</span>),<span class="attr">locator</span>:a.getAttribute(<span class="string">"locator"</span>),<span class="attr">texts</span>:[]&#125;;b.exceptions.push(c);<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">ExceptionText</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);b.texts.push(c)&#125;,</span><br><span class="line">ServiceIdentification:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.serviceIdentification=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.serviceIdentification)&#125;,<span class="attr">Title</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.title=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Abstract</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b[<span class="string">"abstract"</span>]=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Keywords</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.keywords=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.keywords)&#125;,<span class="attr">Keyword</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b[<span class="keyword">this</span>.getChildValue(a)]=!<span class="number">0</span>&#125;,<span class="attr">ServiceType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.serviceType=&#123;<span class="attr">codeSpace</span>:a.getAttribute(<span class="string">"codeSpace"</span>),<span class="attr">value</span>:<span class="keyword">this</span>.getChildValue(a)&#125;&#125;,<span class="attr">ServiceTypeVersion</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.serviceTypeVersion=</span><br><span class="line"><span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Fees</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.fees=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">AccessConstraints</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.accessConstraints=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">ServiceProvider</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.serviceProvider=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.serviceProvider)&#125;,<span class="attr">ProviderName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.providerName=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">ProviderSite</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.providerSite=<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.xlink,<span class="string">"href"</span>)&#125;,<span class="attr">ServiceContact</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.serviceContact=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.serviceContact)&#125;,<span class="attr">IndividualName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.individualName=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">PositionName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.positionName=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">ContactInfo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.contactInfo=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.contactInfo)&#125;,<span class="attr">Phone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.phone=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.phone)&#125;,<span class="attr">Voice</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.voice=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Address</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.address=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.address)&#125;,<span class="attr">DeliveryPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.deliveryPoint=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">City</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.city=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">AdministrativeArea</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.administrativeArea=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">PostalCode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.postalCode=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Country</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.country=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">ElectronicMailAddress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.electronicMailAddress=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Role</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.role=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">OperationsMetadata</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.operationsMetadata=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.operationsMetadata)&#125;,<span class="attr">Operation</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.getAttribute(<span class="string">"name"</span>);b[c]=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b[c])&#125;,<span class="attr">DCP</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.dcp=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.dcp)&#125;,<span class="attr">HTTP</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.http=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.http)&#125;,<span class="attr">Get</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.get||(b.get=[]);<span class="keyword">var</span> c=&#123;<span class="attr">url</span>:<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.xlink,<span class="string">"href"</span>)&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.get.push(c)&#125;,<span class="attr">Post</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.post||(b.post=[]);<span class="keyword">var</span> c=&#123;<span class="attr">url</span>:<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.xlink,<span class="string">"href"</span>)&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.post.push(c)&#125;,<span class="attr">Parameter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.parameters||(b.parameters=&#123;&#125;);<span class="keyword">var</span> c=a.getAttribute(<span class="string">"name"</span>);b.parameters[c]=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,</span><br><span class="line">b.parameters[c])&#125;,<span class="attr">Constraint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.constraints||(b.constraints=&#123;&#125;);<span class="keyword">var</span> c=a.getAttribute(<span class="string">"name"</span>);b.constraints[c]=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.constraints[c])&#125;,<span class="attr">Value</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b[<span class="keyword">this</span>.getChildValue(a)]=!<span class="number">0</span>&#125;,<span class="attr">OutputFormat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.formats.push(&#123;<span class="attr">value</span>:<span class="keyword">this</span>.getChildValue(a)&#125;);<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">WGS84BoundingBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;c.crs=a.getAttribute(<span class="string">"crs"</span>);b.BoundingBox?b.BoundingBox.push(c):(b.projection=c.crs,c=b);<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">BoundingBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readers.ows.WGS84BoundingBox.apply(<span class="keyword">this</span>,</span><br><span class="line">[a,b])&#125;,<span class="attr">LowerCorner</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a).replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>),c=c.replace(<span class="keyword">this</span>.regExes.trimComma,<span class="string">","</span>),c=c.split(<span class="keyword">this</span>.regExes.splitSpace);b.left=c[<span class="number">0</span>];b.bottom=c[<span class="number">1</span>]&#125;,<span class="attr">UpperCorner</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a).replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>),c=c.replace(<span class="keyword">this</span>.regExes.trimComma,<span class="string">","</span>),c=c.split(<span class="keyword">this</span>.regExes.splitSpace);b.right=c[<span class="number">0</span>];b.top=c[<span class="number">1</span>];b.bounds=<span class="keyword">new</span> OpenLayers.Bounds(b.left,b.bottom,b.right,b.top);<span class="keyword">delete</span> b.left;<span class="keyword">delete</span> b.bottom;<span class="keyword">delete</span> b.right;<span class="keyword">delete</span> b.top&#125;,</span><br><span class="line">Language:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.language=<span class="keyword">this</span>.getChildValue(a)&#125;&#125;&#125;,<span class="attr">writers</span>:&#123;<span class="attr">ows</span>:&#123;<span class="attr">BoundingBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementNSPlus(b||<span class="string">"ows:BoundingBox"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">crs</span>:a.projection&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"ows:LowerCorner"</span>,a,c);<span class="keyword">this</span>.writeNode(<span class="string">"ows:UpperCorner"</span>,a,c);<span class="keyword">return</span> c&#125;,<span class="attr">LowerCorner</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ows:LowerCorner"</span>,&#123;<span class="attr">value</span>:a.bounds.left+<span class="string">" "</span>+a.bounds.bottom&#125;)&#125;,<span class="attr">UpperCorner</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ows:UpperCorner"</span>,&#123;<span class="attr">value</span>:a.bounds.right+<span class="string">" "</span>+a.bounds.top&#125;)&#125;,</span><br><span class="line">Identifier:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ows:Identifier"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">Title</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ows:Title"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">Abstract</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ows:Abstract"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">OutputFormat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ows:OutputFormat"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.OWSCommon.v1"</span>&#125;);OpenLayers.Format.OWSCommon.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>&#125;,<span class="attr">readers</span>:&#123;<span class="attr">ows</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">ExceptionReport</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.success=!<span class="number">1</span>;b.exceptionReport=&#123;<span class="attr">version</span>:a.getAttribute(<span class="string">"version"</span>),<span class="attr">language</span>:a.getAttribute(<span class="string">"language"</span>),<span class="attr">exceptions</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.exceptionReport)&#125;&#125;,OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)&#125;,<span class="attr">writers</span>:&#123;<span class="attr">ows</span>:OpenLayers.Format.OWSCommon.v1.prototype.writers.ows&#125;,</span><br><span class="line">CLASS_NAME:<span class="string">"OpenLayers.Format.OWSCommon.v1_0_0"</span>&#125;);OpenLayers.Format.WFST.v1_1_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0,OpenLayers.Format.WFST.v1,&#123;<span class="attr">version</span>:<span class="string">"1.1.0"</span>,<span class="attr">schemaLocations</span>:&#123;<span class="attr">wfs</span>:<span class="string">"http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"</span>&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(<span class="keyword">this</span>,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">readNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Format.GML.v3.prototype.readNode.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">readers</span>:&#123;<span class="attr">wfs</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">FeatureCollection</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.numberOfFeatures=<span class="built_in">parseInt</span>(a.getAttribute(<span class="string">"numberOfFeatures"</span>));OpenLayers.Format.WFST.v1.prototype.readers.wfs.FeatureCollection.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">TransactionResponse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.insertIds=[];b.success=!<span class="number">1</span>;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">TransactionSummary</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.success=!<span class="number">0</span>&#125;,<span class="attr">InsertResults</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Feature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">fids</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.insertIds.push(c.fids[<span class="number">0</span>])&#125;&#125;,OpenLayers.Format.WFST.v1.prototype.readers.wfs),<span class="attr">gml</span>:OpenLayers.Format.GML.v3.prototype.readers.gml,</span><br><span class="line">feature:OpenLayers.Format.GML.v3.prototype.readers.feature,<span class="attr">ogc</span>:OpenLayers.Format.Filter.v1_1_0.prototype.readers.ogc,<span class="attr">ows</span>:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows&#125;,<span class="attr">writers</span>:&#123;<span class="attr">wfs</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">GetFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Format.WFST.v1.prototype.writers.wfs.GetFeature.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);a&amp;&amp;<span class="keyword">this</span>.setAttributes(b,&#123;<span class="attr">resultType</span>:a.resultType,<span class="attr">startIndex</span>:a.startIndex,<span class="attr">count</span>:a.count&#125;);<span class="keyword">return</span> b&#125;,<span class="attr">Query</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.extend(&#123;<span class="attr">featureNS</span>:<span class="keyword">this</span>.featureNS,</span><br><span class="line">featurePrefix:<span class="keyword">this</span>.featurePrefix,<span class="attr">featureType</span>:<span class="keyword">this</span>.featureType,<span class="attr">srsName</span>:<span class="keyword">this</span>.srsName&#125;,a);<span class="keyword">var</span> b=a.featurePrefix,c=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:Query"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">typeName</span>:(b?b+<span class="string">":"</span>:<span class="string">""</span>)+a.featureType,<span class="attr">srsName</span>:a.srsName&#125;&#125;);a.featureNS&amp;&amp;c.setAttribute(<span class="string">"xmlns:"</span>+b,a.featureNS);<span class="keyword">if</span>(a.propertyNames)<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,d=a.propertyNames.length;b&lt;d;b++)<span class="keyword">this</span>.writeNode(<span class="string">"wfs:PropertyName"</span>,&#123;<span class="attr">property</span>:a.propertyNames[b]&#125;,c);a.filter&amp;&amp;(OpenLayers.Format.WFST.v1_1_0.prototype.setFilterProperty.call(<span class="keyword">this</span>,a.filter),<span class="keyword">this</span>.writeNode(<span class="string">"ogc:Filter"</span>,</span><br><span class="line">a.filter,c));<span class="keyword">return</span> c&#125;,<span class="attr">PropertyName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:PropertyName"</span>,&#123;<span class="attr">value</span>:a.property&#125;)&#125;&#125;,OpenLayers.Format.WFST.v1.prototype.writers.wfs),<span class="attr">gml</span>:OpenLayers.Format.GML.v3.prototype.writers.gml,<span class="attr">feature</span>:OpenLayers.Format.GML.v3.prototype.writers.feature,<span class="attr">ogc</span>:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WFST.v1_1_0"</span>&#125;);OpenLayers.Protocol=OpenLayers.Class(&#123;<span class="attr">format</span>:<span class="literal">null</span>,<span class="attr">options</span>:<span class="literal">null</span>,<span class="attr">autoDestroy</span>:!<span class="number">0</span>,<span class="attr">defaultFilter</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||&#123;&#125;;OpenLayers.Util.extend(<span class="keyword">this</span>,a);<span class="keyword">this</span>.options=a&#125;,<span class="attr">mergeWithDefaultFilter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a&amp;&amp;<span class="keyword">this</span>.defaultFilter?<span class="keyword">new</span> OpenLayers.Filter.Logical(&#123;<span class="attr">type</span>:OpenLayers.Filter.Logical.AND,<span class="attr">filters</span>:[<span class="keyword">this</span>.defaultFilter,a]&#125;):a||<span class="keyword">this</span>.defaultFilter||<span class="keyword">void</span> <span class="number">0</span>&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.format=<span class="keyword">this</span>.options=<span class="literal">null</span>&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||&#123;&#125;;a.filter=<span class="keyword">this</span>.mergeWithDefaultFilter(a.filter)&#125;,<span class="attr">create</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">update:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="string">"delete"</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">commit</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">abort</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">createCallback</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;a.apply(<span class="keyword">this</span>,[b,c])&#125;,<span class="keyword">this</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Protocol"</span>&#125;);OpenLayers.Protocol.Response=OpenLayers.Class(&#123;<span class="attr">code</span>:<span class="literal">null</span>,<span class="attr">requestType</span>:<span class="literal">null</span>,<span class="attr">last</span>:!<span class="number">0</span>,<span class="attr">features</span>:<span class="literal">null</span>,<span class="attr">data</span>:<span class="literal">null</span>,<span class="attr">reqFeatures</span>:<span class="literal">null</span>,<span class="attr">priv</span>:<span class="literal">null</span>,<span class="attr">error</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,a)&#125;,<span class="attr">success</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="number">0</span>&lt;<span class="keyword">this</span>.code&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Protocol.Response"</span>&#125;);</span><br><span class="line">OpenLayers.Protocol.Response.SUCCESS=<span class="number">1</span>;OpenLayers.Protocol.Response.FAILURE=<span class="number">0</span>;OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,&#123;<span class="attr">indent</span>:<span class="string">"    "</span>,<span class="attr">space</span>:<span class="string">" "</span>,<span class="attr">newline</span>:<span class="string">"\n"</span>,<span class="attr">level</span>:<span class="number">0</span>,<span class="attr">pretty</span>:!<span class="number">1</span>,<span class="attr">nativeJSON</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>!(!<span class="built_in">window</span>.JSON||<span class="string">"function"</span>!=<span class="keyword">typeof</span> <span class="built_in">JSON</span>.parse||<span class="string">"function"</span>!=<span class="keyword">typeof</span> <span class="built_in">JSON</span>.stringify)&#125;(),<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c;<span class="keyword">if</span>(<span class="keyword">this</span>.nativeJSON)c=<span class="built_in">JSON</span>.parse(a,b);<span class="keyword">else</span> <span class="keyword">try</span>&#123;<span class="keyword">if</span>(<span class="regexp">/^[\],:&#123;&#125;\s]*$/</span>.test(a.replace(<span class="regexp">/\\["\\\/bfnrtu]/g</span>,<span class="string">"@"</span>).replace(<span class="regexp">/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g</span>,<span class="string">"]"</span>).replace(<span class="regexp">/(?:^|:|,)(?:\s*\[)+/g</span>,<span class="string">""</span>))&amp;&amp;(c=<span class="built_in">eval</span>(<span class="string">"("</span>+a+<span class="string">")"</span>),<span class="string">"function"</span>===</span><br><span class="line"><span class="keyword">typeof</span> b))&#123;<span class="keyword">var</span> d=<span class="function"><span class="keyword">function</span>(<span class="params">a,c</span>)</span>&#123;<span class="keyword">if</span>(c&amp;&amp;<span class="string">"object"</span>===<span class="keyword">typeof</span> c)<span class="keyword">for</span>(<span class="keyword">var</span> e <span class="keyword">in</span> c)c.hasOwnProperty(e)&amp;&amp;(c[e]=d(e,c[e]));<span class="keyword">return</span> b(a,c)&#125;;c=d(<span class="string">""</span>,c)&#125;&#125;<span class="keyword">catch</span>(e)&#123;&#125;<span class="keyword">this</span>.keepData&amp;&amp;(<span class="keyword">this</span>.data=c);<span class="keyword">return</span> c&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.pretty=!!b;<span class="keyword">var</span> c=<span class="literal">null</span>,d=<span class="keyword">typeof</span> a;<span class="keyword">if</span>(<span class="keyword">this</span>.serialize[d])<span class="keyword">try</span>&#123;c=!<span class="keyword">this</span>.pretty&amp;&amp;<span class="keyword">this</span>.nativeJSON?<span class="built_in">JSON</span>.stringify(a):<span class="keyword">this</span>.serialize[d].apply(<span class="keyword">this</span>,[a])&#125;<span class="keyword">catch</span>(e)&#123;OpenLayers.Console.error(<span class="string">"Trouble serializing: "</span>+e)&#125;<span class="keyword">return</span> c&#125;,<span class="attr">writeIndent</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=[];<span class="keyword">if</span>(<span class="keyword">this</span>.pretty)<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>;b&lt;<span class="keyword">this</span>.level;++b)a.push(<span class="keyword">this</span>.indent);</span><br><span class="line"><span class="keyword">return</span> a.join(<span class="string">""</span>)&#125;,<span class="attr">writeNewline</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.pretty?<span class="keyword">this</span>.newline:<span class="string">""</span>&#125;,<span class="attr">writeSpace</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.pretty?<span class="keyword">this</span>.space:<span class="string">""</span>&#125;,<span class="attr">serialize</span>:&#123;<span class="attr">object</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>==a)<span class="keyword">return</span><span class="string">"null"</span>;<span class="keyword">if</span>(a.constructor==<span class="built_in">Date</span>)<span class="keyword">return</span> <span class="keyword">this</span>.serialize.date.apply(<span class="keyword">this</span>,[a]);<span class="keyword">if</span>(a.constructor==<span class="built_in">Array</span>)<span class="keyword">return</span> <span class="keyword">this</span>.serialize.array.apply(<span class="keyword">this</span>,[a]);<span class="keyword">var</span> b=[<span class="string">"&#123;"</span>];<span class="keyword">this</span>.level+=<span class="number">1</span>;<span class="keyword">var</span> c,d,e,f=!<span class="number">1</span>;<span class="keyword">for</span>(c <span class="keyword">in</span> a)a.hasOwnProperty(c)&amp;&amp;(d=OpenLayers.Format.JSON.prototype.write.apply(<span class="keyword">this</span>,[c,<span class="keyword">this</span>.pretty]),e=OpenLayers.Format.JSON.prototype.write.apply(<span class="keyword">this</span>,</span><br><span class="line">[a[c],<span class="keyword">this</span>.pretty]),<span class="literal">null</span>!=d&amp;&amp;<span class="literal">null</span>!=e&amp;&amp;(f&amp;&amp;b.push(<span class="string">","</span>),b.push(<span class="keyword">this</span>.writeNewline(),<span class="keyword">this</span>.writeIndent(),d,<span class="string">":"</span>,<span class="keyword">this</span>.writeSpace(),e),f=!<span class="number">0</span>));<span class="keyword">this</span>.level-=<span class="number">1</span>;b.push(<span class="keyword">this</span>.writeNewline(),<span class="keyword">this</span>.writeIndent(),<span class="string">"&#125;"</span>);<span class="keyword">return</span> b.join(<span class="string">""</span>)&#125;,<span class="attr">array</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c=[<span class="string">"["</span>];<span class="keyword">this</span>.level+=<span class="number">1</span>;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e=a.length;d&lt;e;++d)b=OpenLayers.Format.JSON.prototype.write.apply(<span class="keyword">this</span>,[a[d],<span class="keyword">this</span>.pretty]),<span class="literal">null</span>!=b&amp;&amp;(<span class="number">0</span>&lt;d&amp;&amp;c.push(<span class="string">","</span>),c.push(<span class="keyword">this</span>.writeNewline(),<span class="keyword">this</span>.writeIndent(),b));<span class="keyword">this</span>.level-=<span class="number">1</span>;c.push(<span class="keyword">this</span>.writeNewline(),<span class="keyword">this</span>.writeIndent(),</span><br><span class="line"><span class="string">"]"</span>);<span class="keyword">return</span> c.join(<span class="string">""</span>)&#125;,<span class="attr">string</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;<span class="string">"\b"</span>:<span class="string">"\\b"</span>,<span class="string">"\t"</span>:<span class="string">"\\t"</span>,<span class="string">"\n"</span>:<span class="string">"\\n"</span>,<span class="string">"\f"</span>:<span class="string">"\\f"</span>,<span class="string">"\r"</span>:<span class="string">"\\r"</span>,<span class="string">'"'</span>:<span class="string">'\\"'</span>,<span class="string">"\\"</span>:<span class="string">"\\\\"</span>&#125;;<span class="keyword">return</span><span class="regexp">/["\\\x00-\x1f]/</span>.test(a)?<span class="string">'"'</span>+a.replace(<span class="regexp">/([\x00-\x1f\\"])/g</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a,d</span>)</span>&#123;<span class="keyword">var</span> e=b[d];<span class="keyword">if</span>(e)<span class="keyword">return</span> e;e=d.charCodeAt();<span class="keyword">return</span><span class="string">"\\u00"</span>+<span class="built_in">Math</span>.floor(e/<span class="number">16</span>).toString(<span class="number">16</span>)+(e%<span class="number">16</span>).toString(<span class="number">16</span>)&#125;)+<span class="string">'"'</span>:<span class="string">'"'</span>+a+<span class="string">'"'</span>&#125;,<span class="attr">number</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">isFinite</span>(a)?<span class="built_in">String</span>(a):<span class="string">"null"</span>&#125;,<span class="string">"boolean"</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">String</span>(a)&#125;,<span class="attr">date</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="number">10</span>&gt;a?<span class="string">"0"</span>+a:a&#125;<span class="keyword">return</span><span class="string">'"'</span>+a.getFullYear()+</span><br><span class="line"><span class="string">"-"</span>+b(a.getMonth()+<span class="number">1</span>)+<span class="string">"-"</span>+b(a.getDate())+<span class="string">"T"</span>+b(a.getHours())+<span class="string">":"</span>+b(a.getMinutes())+<span class="string">":"</span>+b(a.getSeconds())+<span class="string">'"'</span>&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.JSON"</span>&#125;);OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,&#123;<span class="attr">ignoreExtraDims</span>:!<span class="number">1</span>,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;b=b?b:<span class="string">"FeatureCollection"</span>;<span class="keyword">var</span> d=<span class="literal">null</span>,e=<span class="literal">null</span>,e=<span class="string">"string"</span>==<span class="keyword">typeof</span> a?OpenLayers.Format.JSON.prototype.read.apply(<span class="keyword">this</span>,[a,c]):a;<span class="keyword">if</span>(!e)OpenLayers.Console.error(<span class="string">"Bad JSON: "</span>+a);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"string"</span>!=<span class="keyword">typeof</span> e.type)OpenLayers.Console.error(<span class="string">"Bad GeoJSON - no type: "</span>+a);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.isValidType(e,b))<span class="keyword">switch</span>(b)&#123;<span class="keyword">case</span> <span class="string">"Geometry"</span>:<span class="keyword">try</span>&#123;d=<span class="keyword">this</span>.parseGeometry(e)&#125;<span class="keyword">catch</span>(f)&#123;OpenLayers.Console.error(f)&#125;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"Feature"</span>:<span class="keyword">try</span>&#123;d=</span><br><span class="line"><span class="keyword">this</span>.parseFeature(e),d.type=<span class="string">"Feature"</span>&#125;<span class="keyword">catch</span>(g)&#123;OpenLayers.Console.error(g)&#125;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"FeatureCollection"</span>:<span class="keyword">switch</span>(d=[],e.type)&#123;<span class="keyword">case</span> <span class="string">"Feature"</span>:<span class="keyword">try</span>&#123;d.push(<span class="keyword">this</span>.parseFeature(e))&#125;<span class="keyword">catch</span>(h)&#123;d=<span class="literal">null</span>,OpenLayers.Console.error(h)&#125;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"FeatureCollection"</span>:a=<span class="number">0</span>;<span class="keyword">for</span>(b=e.features.length;a&lt;b;++a)<span class="keyword">try</span>&#123;d.push(<span class="keyword">this</span>.parseFeature(e.features[a]))&#125;<span class="keyword">catch</span>(k)&#123;d=<span class="literal">null</span>,OpenLayers.Console.error(k)&#125;<span class="keyword">break</span>;<span class="keyword">default</span>:<span class="keyword">try</span>&#123;<span class="keyword">var</span> l=<span class="keyword">this</span>.parseGeometry(e);d.push(<span class="keyword">new</span> OpenLayers.Feature.Vector(l))&#125;<span class="keyword">catch</span>(m)&#123;d=<span class="literal">null</span>,OpenLayers.Console.error(m)&#125;&#125;&#125;<span class="keyword">return</span> d&#125;,</span><br><span class="line">isValidType:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=!<span class="number">1</span>;<span class="keyword">switch</span>(b)&#123;<span class="keyword">case</span> <span class="string">"Geometry"</span>:<span class="number">-1</span>==OpenLayers.Util.indexOf(<span class="string">"Point MultiPoint LineString MultiLineString Polygon MultiPolygon Box GeometryCollection"</span>.split(<span class="string">" "</span>),a.type)?OpenLayers.Console.error(<span class="string">"Unsupported geometry type: "</span>+a.type):c=!<span class="number">0</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"FeatureCollection"</span>:c=!<span class="number">0</span>;<span class="keyword">break</span>;<span class="keyword">default</span>:a.type==b?c=!<span class="number">0</span>:OpenLayers.Console.error(<span class="string">"Cannot convert types from "</span>+a.type+<span class="string">" to "</span>+b)&#125;<span class="keyword">return</span> c&#125;,<span class="attr">parseFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c,d;c=a.properties?a.properties:&#123;&#125;;d=a.geometry&amp;&amp;a.geometry.bbox||</span><br><span class="line">a.bbox;<span class="keyword">try</span>&#123;b=<span class="keyword">this</span>.parseGeometry(a.geometry)&#125;<span class="keyword">catch</span>(e)&#123;<span class="keyword">throw</span> e;&#125;b=<span class="keyword">new</span> OpenLayers.Feature.Vector(b,c);d&amp;&amp;(b.bounds=OpenLayers.Bounds.fromArray(d));a.id&amp;&amp;(b.fid=a.id);<span class="keyword">return</span> b&#125;,<span class="attr">parseGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>==a)<span class="keyword">return</span> <span class="literal">null</span>;<span class="keyword">var</span> b,c=!<span class="number">1</span>;<span class="keyword">if</span>(<span class="string">"GeometryCollection"</span>==a.type)&#123;<span class="keyword">if</span>(!OpenLayers.Util.isArray(a.geometries))<span class="keyword">throw</span><span class="string">"GeometryCollection must have geometries array: "</span>+a;b=a.geometries.length;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="built_in">Array</span>(b),d=<span class="number">0</span>;d&lt;b;++d)c[d]=<span class="keyword">this</span>.parseGeometry.apply(<span class="keyword">this</span>,[a.geometries[d]]);b=<span class="keyword">new</span> OpenLayers.Geometry.Collection(c);</span><br><span class="line">c=!<span class="number">0</span>&#125;<span class="keyword">else</span>&#123;<span class="keyword">if</span>(!OpenLayers.Util.isArray(a.coordinates))<span class="keyword">throw</span><span class="string">"Geometry must have coordinates array: "</span>+a;<span class="keyword">if</span>(!<span class="keyword">this</span>.parseCoords[a.type.toLowerCase()])<span class="keyword">throw</span><span class="string">"Unsupported geometry type: "</span>+a.type;<span class="keyword">try</span>&#123;b=<span class="keyword">this</span>.parseCoords[a.type.toLowerCase()].apply(<span class="keyword">this</span>,[a.coordinates])&#125;<span class="keyword">catch</span>(e)&#123;<span class="keyword">throw</span> e;&#125;&#125;<span class="keyword">this</span>.internalProjection&amp;&amp;(<span class="keyword">this</span>.externalProjection&amp;&amp;!c)&amp;&amp;b.transform(<span class="keyword">this</span>.externalProjection,<span class="keyword">this</span>.internalProjection);<span class="keyword">return</span> b&#125;,<span class="attr">parseCoords</span>:&#123;<span class="attr">point</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!<span class="number">1</span>==<span class="keyword">this</span>.ignoreExtraDims&amp;&amp;<span class="number">2</span>!=a.length)<span class="keyword">throw</span><span class="string">"Only 2D points are supported: "</span>+</span><br><span class="line">a;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.Point(a[<span class="number">0</span>],a[<span class="number">1</span>])&#125;,<span class="attr">multipoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="literal">null</span>,d=<span class="number">0</span>,e=a.length;d&lt;e;++d)&#123;<span class="keyword">try</span>&#123;c=<span class="keyword">this</span>.parseCoords.point.apply(<span class="keyword">this</span>,[a[d]])&#125;<span class="keyword">catch</span>(f)&#123;<span class="keyword">throw</span> f;&#125;b.push(c)&#125;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.MultiPoint(b)&#125;,<span class="attr">linestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="literal">null</span>,d=<span class="number">0</span>,e=a.length;d&lt;e;++d)&#123;<span class="keyword">try</span>&#123;c=<span class="keyword">this</span>.parseCoords.point.apply(<span class="keyword">this</span>,[a[d]])&#125;<span class="keyword">catch</span>(f)&#123;<span class="keyword">throw</span> f;&#125;b.push(c)&#125;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.LineString(b)&#125;,<span class="attr">multilinestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="literal">null</span>,d=<span class="number">0</span>,e=a.length;d&lt;e;++d)&#123;<span class="keyword">try</span>&#123;c=</span><br><span class="line"><span class="keyword">this</span>.parseCoords.linestring.apply(<span class="keyword">this</span>,[a[d]])&#125;<span class="keyword">catch</span>(f)&#123;<span class="keyword">throw</span> f;&#125;b.push(c)&#125;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.MultiLineString(b)&#125;,<span class="attr">polygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c,d,e=<span class="number">0</span>,f=a.length;e&lt;f;++e)&#123;<span class="keyword">try</span>&#123;d=<span class="keyword">this</span>.parseCoords.linestring.apply(<span class="keyword">this</span>,[a[e]])&#125;<span class="keyword">catch</span>(g)&#123;<span class="keyword">throw</span> g;&#125;c=<span class="keyword">new</span> OpenLayers.Geometry.LinearRing(d.components);b.push(c)&#125;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.Polygon(b)&#125;,<span class="attr">multipolygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="literal">null</span>,d=<span class="number">0</span>,e=a.length;d&lt;e;++d)&#123;<span class="keyword">try</span>&#123;c=<span class="keyword">this</span>.parseCoords.polygon.apply(<span class="keyword">this</span>,[a[d]])&#125;<span class="keyword">catch</span>(f)&#123;<span class="keyword">throw</span> f;&#125;b.push(c)&#125;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.MultiPolygon(b)&#125;,</span><br><span class="line">box:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="number">2</span>!=a.length)<span class="keyword">throw</span><span class="string">"GeoJSON box coordinates must have 2 elements"</span>;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.Polygon([<span class="keyword">new</span> OpenLayers.Geometry.LinearRing([<span class="keyword">new</span> OpenLayers.Geometry.Point(a[<span class="number">0</span>][<span class="number">0</span>],a[<span class="number">0</span>][<span class="number">1</span>]),<span class="keyword">new</span> OpenLayers.Geometry.Point(a[<span class="number">1</span>][<span class="number">0</span>],a[<span class="number">0</span>][<span class="number">1</span>]),<span class="keyword">new</span> OpenLayers.Geometry.Point(a[<span class="number">1</span>][<span class="number">0</span>],a[<span class="number">1</span>][<span class="number">1</span>]),<span class="keyword">new</span> OpenLayers.Geometry.Point(a[<span class="number">0</span>][<span class="number">0</span>],a[<span class="number">1</span>][<span class="number">1</span>]),<span class="keyword">new</span> OpenLayers.Geometry.Point(a[<span class="number">0</span>][<span class="number">0</span>],a[<span class="number">0</span>][<span class="number">1</span>])])])&#125;&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">type</span>:<span class="literal">null</span>&#125;;<span class="keyword">if</span>(OpenLayers.Util.isArray(a))&#123;c.type=<span class="string">"FeatureCollection"</span>;<span class="keyword">var</span> d=</span><br><span class="line">a.length;c.features=<span class="built_in">Array</span>(d);<span class="keyword">for</span>(<span class="keyword">var</span> e=<span class="number">0</span>;e&lt;d;++e)&#123;<span class="keyword">var</span> f=a[e];<span class="keyword">if</span>(!f <span class="keyword">instanceof</span> OpenLayers.Feature.Vector)<span class="keyword">throw</span><span class="string">"FeatureCollection only supports collections of features: "</span>+f;c.features[e]=<span class="keyword">this</span>.extract.feature.apply(<span class="keyword">this</span>,[f])&#125;&#125;<span class="keyword">else</span> <span class="number">0</span>==a.CLASS_NAME.indexOf(<span class="string">"OpenLayers.Geometry"</span>)?c=<span class="keyword">this</span>.extract.geometry.apply(<span class="keyword">this</span>,[a]):a <span class="keyword">instanceof</span> OpenLayers.Feature.Vector&amp;&amp;(c=<span class="keyword">this</span>.extract.feature.apply(<span class="keyword">this</span>,[a]),a.layer&amp;&amp;a.layer.projection&amp;&amp;(c.crs=<span class="keyword">this</span>.createCRSObject(a)));<span class="keyword">return</span> OpenLayers.Format.JSON.prototype.write.apply(<span class="keyword">this</span>,</span><br><span class="line">[c,b])&#125;,<span class="attr">createCRSObject</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.layer.projection.toString();<span class="keyword">var</span> b=&#123;&#125;;a.match(<span class="regexp">/epsg:/i</span>)&amp;&amp;(a=<span class="built_in">parseInt</span>(a.substring(a.indexOf(<span class="string">":"</span>)+<span class="number">1</span>)),b=<span class="number">4326</span>==a?&#123;<span class="attr">type</span>:<span class="string">"name"</span>,<span class="attr">properties</span>:&#123;<span class="attr">name</span>:<span class="string">"urn:ogc:def:crs:OGC:1.3:CRS84"</span>&#125;&#125;:&#123;<span class="attr">type</span>:<span class="string">"name"</span>,<span class="attr">properties</span>:&#123;<span class="attr">name</span>:<span class="string">"EPSG:"</span>+a&#125;&#125;);<span class="keyword">return</span> b&#125;,<span class="attr">extract</span>:&#123;<span class="attr">feature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.extract.geometry.apply(<span class="keyword">this</span>,[a.geometry]),b=&#123;<span class="attr">type</span>:<span class="string">"Feature"</span>,<span class="attr">properties</span>:a.attributes,<span class="attr">geometry</span>:b&#125;;<span class="literal">null</span>!=a.fid&amp;&amp;(b.id=a.fid);<span class="keyword">return</span> b&#125;,<span class="attr">geometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>==a)<span class="keyword">return</span> <span class="literal">null</span>;<span class="keyword">this</span>.internalProjection&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.externalProjection&amp;&amp;(a=a.clone(),a.transform(<span class="keyword">this</span>.internalProjection,<span class="keyword">this</span>.externalProjection));<span class="keyword">var</span> b=a.CLASS_NAME.split(<span class="string">"."</span>)[<span class="number">2</span>];a=<span class="keyword">this</span>.extract[b.toLowerCase()].apply(<span class="keyword">this</span>,[a]);<span class="keyword">return</span><span class="string">"Collection"</span>==b?&#123;<span class="attr">type</span>:<span class="string">"GeometryCollection"</span>,<span class="attr">geometries</span>:a&#125;:&#123;<span class="attr">type</span>:b,<span class="attr">coordinates</span>:a&#125;&#125;,<span class="attr">point</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span>[a.x,a.y]&#125;,<span class="attr">multipoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>,d=a.components.length;c&lt;d;++c)b.push(<span class="keyword">this</span>.extract.point.apply(<span class="keyword">this</span>,[a.components[c]]));<span class="keyword">return</span> b&#125;,<span class="attr">linestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>,d=a.components.length;c&lt;</span><br><span class="line">d;++c)b.push(<span class="keyword">this</span>.extract.point.apply(<span class="keyword">this</span>,[a.components[c]]));<span class="keyword">return</span> b&#125;,<span class="attr">multilinestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>,d=a.components.length;c&lt;d;++c)b.push(<span class="keyword">this</span>.extract.linestring.apply(<span class="keyword">this</span>,[a.components[c]]));<span class="keyword">return</span> b&#125;,<span class="attr">polygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>,d=a.components.length;c&lt;d;++c)b.push(<span class="keyword">this</span>.extract.linestring.apply(<span class="keyword">this</span>,[a.components[c]]));<span class="keyword">return</span> b&#125;,<span class="attr">multipolygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>,d=a.components.length;c&lt;d;++c)b.push(<span class="keyword">this</span>.extract.polygon.apply(<span class="keyword">this</span>,[a.components[c]]));<span class="keyword">return</span> b&#125;,<span class="attr">collection</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=</span><br><span class="line">a.components.length,c=<span class="built_in">Array</span>(b),d=<span class="number">0</span>;d&lt;b;++d)c[d]=<span class="keyword">this</span>.extract.geometry.apply(<span class="keyword">this</span>,[a.components[d]]);<span class="keyword">return</span> c&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.GeoJSON"</span>&#125;);OpenLayers.Protocol.Script=OpenLayers.Class(OpenLayers.Protocol,&#123;<span class="attr">url</span>:<span class="literal">null</span>,<span class="attr">params</span>:<span class="literal">null</span>,<span class="attr">callback</span>:<span class="literal">null</span>,<span class="attr">callbackTemplate</span>:<span class="string">"OpenLayers.Protocol.Script.registry.$&#123;id&#125;"</span>,<span class="attr">callbackKey</span>:<span class="string">"callback"</span>,<span class="attr">callbackPrefix</span>:<span class="string">""</span>,<span class="attr">scope</span>:<span class="literal">null</span>,<span class="attr">format</span>:<span class="literal">null</span>,<span class="attr">pendingRequests</span>:<span class="literal">null</span>,<span class="attr">srsInBBOX</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||&#123;&#125;;<span class="keyword">this</span>.params=&#123;&#125;;<span class="keyword">this</span>.pendingRequests=&#123;&#125;;OpenLayers.Protocol.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.format||(<span class="keyword">this</span>.format=<span class="keyword">new</span> OpenLayers.Format.GeoJSON);<span class="keyword">if</span>(!<span class="keyword">this</span>.filterToParams&amp;&amp;OpenLayers.Format.QueryStringFilter)&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">new</span> OpenLayers.Format.QueryStringFilter(&#123;<span class="attr">srsInBBOX</span>:<span class="keyword">this</span>.srsInBBOX&#125;);<span class="keyword">this</span>.filterToParams=<span class="function"><span class="keyword">function</span>(<span class="params">a,d</span>)</span>&#123;<span class="keyword">return</span> b.write(a,d)&#125;&#125;&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Protocol.prototype.read.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);a=OpenLayers.Util.applyDefaults(a,<span class="keyword">this</span>.options);a.params=OpenLayers.Util.applyDefaults(a.params,<span class="keyword">this</span>.options.params);a.filter&amp;&amp;<span class="keyword">this</span>.filterToParams&amp;&amp;(a.params=<span class="keyword">this</span>.filterToParams(a.filter,a.params));<span class="keyword">var</span> b=<span class="keyword">new</span> OpenLayers.Protocol.Response(&#123;<span class="attr">requestType</span>:<span class="string">"read"</span>&#125;),c=<span class="keyword">this</span>.createRequest(a.url,a.params,OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params">c</span>)</span>&#123;b.data=</span><br><span class="line">c;<span class="keyword">this</span>.handleRead(b,a)&#125;,<span class="keyword">this</span>));b.priv=c;<span class="keyword">return</span> b&#125;,<span class="attr">createRequest</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;c=OpenLayers.Protocol.Script.register(c);<span class="keyword">var</span> d=OpenLayers.String.format(<span class="keyword">this</span>.callbackTemplate,&#123;<span class="attr">id</span>:c&#125;);b=OpenLayers.Util.extend(&#123;&#125;,b);b[<span class="keyword">this</span>.callbackKey]=<span class="keyword">this</span>.callbackPrefix+d;a=OpenLayers.Util.urlAppend(a,OpenLayers.Util.getParameterString(b));b=<span class="built_in">document</span>.createElement(<span class="string">"script"</span>);b.type=<span class="string">"text/javascript"</span>;b.src=a;b.id=<span class="string">"OpenLayers_Protocol_Script_"</span>+c;<span class="keyword">this</span>.pendingRequests[b.id]=b;<span class="built_in">document</span>.getElementsByTagName(<span class="string">"head"</span>)[<span class="number">0</span>].appendChild(b);</span><br><span class="line"><span class="keyword">return</span> b&#125;,<span class="attr">destroyRequest</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Protocol.Script.unregister(a.id.split(<span class="string">"_"</span>).pop());<span class="keyword">delete</span> <span class="keyword">this</span>.pendingRequests[a.id];a.parentNode&amp;&amp;a.parentNode.removeChild(a)&#125;,<span class="attr">handleRead</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.handleResponse(a,b)&#125;,<span class="attr">handleResponse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.callback&amp;&amp;(a.data?(a.features=<span class="keyword">this</span>.parseFeatures(a.data),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE,<span class="keyword">this</span>.destroyRequest(a.priv),b.callback.call(b.scope,a))&#125;,<span class="attr">parseFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.format.read(a)&#125;,</span><br><span class="line">abort:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a)<span class="keyword">this</span>.destroyRequest(a.priv);<span class="keyword">else</span> <span class="keyword">for</span>(<span class="keyword">var</span> b <span class="keyword">in</span> <span class="keyword">this</span>.pendingRequests)<span class="keyword">this</span>.destroyRequest(<span class="keyword">this</span>.pendingRequests[b])&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.abort();<span class="keyword">delete</span> <span class="keyword">this</span>.params;<span class="keyword">delete</span> <span class="keyword">this</span>.format;OpenLayers.Protocol.prototype.destroy.apply(<span class="keyword">this</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Protocol.Script"</span>&#125;);(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Protocol.Script,b=<span class="number">0</span>;a.registry=&#123;&#125;;a.register=<span class="function"><span class="keyword">function</span>(<span class="params">c</span>)</span>&#123;<span class="keyword">var</span> d=<span class="string">"c"</span>+ ++b;a.registry[d]=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;c.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;;<span class="keyword">return</span> d&#125;;a.unregister=<span class="function"><span class="keyword">function</span>(<span class="params">b</span>)</span>&#123;<span class="keyword">delete</span> a.registry[b]&#125;&#125;)();OpenLayers.Format.EncodedPolyline=OpenLayers.Class(OpenLayers.Format,&#123;<span class="attr">geometryType</span>:<span class="string">"linestring"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;<span class="keyword">if</span>(<span class="string">"linestring"</span>==<span class="keyword">this</span>.geometryType)b=OpenLayers.Geometry.LineString;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"linearring"</span>==<span class="keyword">this</span>.geometryType)b=OpenLayers.Geometry.LinearRing;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"multipoint"</span>==<span class="keyword">this</span>.geometryType)b=OpenLayers.Geometry.MultiPoint;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"point"</span>!=<span class="keyword">this</span>.geometryType&amp;&amp;<span class="string">"polygon"</span>!=<span class="keyword">this</span>.geometryType)<span class="keyword">return</span> <span class="literal">null</span>;a=<span class="keyword">this</span>.decodeDeltas(a,</span><br><span class="line"><span class="number">2</span>);<span class="keyword">for</span>(<span class="keyword">var</span> c=a.length,d=[],e=<span class="number">0</span>;e+<span class="number">1</span>&lt;c;)&#123;<span class="keyword">var</span> f=a[e++],g=a[e++];d.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(g,f))&#125;<span class="keyword">return</span><span class="string">"point"</span>==<span class="keyword">this</span>.geometryType?<span class="keyword">new</span> OpenLayers.Feature.Vector(d[<span class="number">0</span>]):<span class="string">"polygon"</span>==<span class="keyword">this</span>.geometryType?<span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.Polygon([<span class="keyword">new</span> OpenLayers.Geometry.LinearRing(d)])):<span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> b(d))&#125;,<span class="attr">decode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;a=<span class="keyword">this</span>.decodeDeltas(a,b,c||<span class="number">1E5</span>);c=a.length;<span class="keyword">for</span>(<span class="keyword">var</span> d=[],e=<span class="number">0</span>;e+(b<span class="number">-1</span>)&lt;c;)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> f=[],g=<span class="number">0</span>;g&lt;b;++g)f.push(a[e++]);d.push(f)&#125;<span class="keyword">return</span> d&#125;,</span><br><span class="line">write:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=(a.constructor==<span class="built_in">Array</span>?a[<span class="number">0</span>]:a).geometry;<span class="keyword">var</span> b=a.CLASS_NAME.split(<span class="string">"."</span>)[<span class="number">2</span>].toLowerCase();<span class="keyword">if</span>(<span class="string">"point"</span>==b)a=<span class="built_in">Array</span>(a);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"linestring"</span>==b||<span class="string">"linearring"</span>==b||<span class="string">"multipoint"</span>==b)a=a.components;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"polygon"</span>==b)a=a.components[<span class="number">0</span>].components;<span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">null</span>;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=a.length,d=<span class="number">0</span>;d&lt;c;++d)&#123;<span class="keyword">var</span> e=a[d];b.push(e.y);b.push(e.x)&#125;<span class="keyword">return</span> <span class="keyword">this</span>.encodeDeltas(b,<span class="number">2</span>)&#125;,<span class="attr">encode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;c=c||<span class="number">1E5</span>;<span class="keyword">for</span>(<span class="keyword">var</span> d=[],e=a.length,f=<span class="number">0</span>;f&lt;e;++f)<span class="keyword">for</span>(<span class="keyword">var</span> g=a[f],h=<span class="number">0</span>;h&lt;b;++h)d.push(g[h]);<span class="keyword">return</span> <span class="keyword">this</span>.encodeDeltas(d,</span><br><span class="line">b,c)&#125;,<span class="attr">encodeDeltas</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d,e=<span class="built_in">Array</span>(b);<span class="keyword">for</span>(d=<span class="number">0</span>;d&lt;b;++d)e[d]=<span class="number">0</span>;<span class="keyword">for</span>(<span class="keyword">var</span> f=a.length,g=<span class="number">0</span>;g&lt;f;)<span class="keyword">for</span>(d=<span class="number">0</span>;d&lt;b;++d,++g)&#123;<span class="keyword">var</span> h=a[g],k=h-e[d];e[d]=h;a[g]=k&#125;<span class="keyword">return</span> <span class="keyword">this</span>.encodeFloats(a,c||<span class="number">1E5</span>)&#125;,<span class="attr">decodeDeltas</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d,e=<span class="built_in">Array</span>(b);<span class="keyword">for</span>(d=<span class="number">0</span>;d&lt;b;++d)e[d]=<span class="number">0</span>;a=<span class="keyword">this</span>.decodeFloats(a,c||<span class="number">1E5</span>);c=a.length;<span class="keyword">for</span>(<span class="keyword">var</span> f=<span class="number">0</span>;f&lt;c;)<span class="keyword">for</span>(d=<span class="number">0</span>;d&lt;b;++d,++f)e[d]+=a[f],a[f]=e[d];<span class="keyword">return</span> a&#125;,<span class="attr">encodeFloats</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=b||<span class="number">1E5</span>,d=a.length,e=<span class="number">0</span>;e&lt;d;++e)a[e]=<span class="built_in">Math</span>.round(a[e]*c);<span class="keyword">return</span> <span class="keyword">this</span>.encodeSignedIntegers(a)&#125;,<span class="attr">decodeFloats</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=b||<span class="number">1E5</span>,d=<span class="keyword">this</span>.decodeSignedIntegers(a),e=d.length,f=<span class="number">0</span>;f&lt;e;++f)d[f]/=c;<span class="keyword">return</span> d&#125;,<span class="attr">encodeSignedIntegers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=a.length,c=<span class="number">0</span>;c&lt;b;++c)&#123;<span class="keyword">var</span> d=a[c],e=d&lt;&lt;<span class="number">1</span>;<span class="number">0</span>&gt;d&amp;&amp;(e=~e);a[c]=e&#125;<span class="keyword">return</span> <span class="keyword">this</span>.encodeUnsignedIntegers(a)&#125;,<span class="attr">decodeSignedIntegers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.decodeUnsignedIntegers(a);<span class="keyword">for</span>(<span class="keyword">var</span> b=a.length,c=<span class="number">0</span>;c&lt;b;++c)&#123;<span class="keyword">var</span> d=a[c];a[c]=d&amp;<span class="number">1</span>?~(d&gt;&gt;<span class="number">1</span>):d&gt;&gt;<span class="number">1</span>&#125;<span class="keyword">return</span> a&#125;,<span class="attr">encodeUnsignedIntegers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="string">""</span>,c=a.length,d=<span class="number">0</span>;d&lt;c;++d)b+=<span class="keyword">this</span>.encodeUnsignedInteger(a[d]);<span class="keyword">return</span> b&#125;,<span class="attr">decodeUnsignedIntegers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=</span><br><span class="line">[],c=<span class="number">0</span>,d=<span class="number">0</span>,e=a.length,f=<span class="number">0</span>;f&lt;e;++f)&#123;<span class="keyword">var</span> g=a.charCodeAt(f)<span class="number">-63</span>,c=c|(g&amp;<span class="number">31</span>)&lt;&lt;d;<span class="number">32</span>&gt;g?(b.push(c),d=c=<span class="number">0</span>):d+=<span class="number">5</span>&#125;<span class="keyword">return</span> b&#125;,<span class="attr">encodeFloat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a=<span class="built_in">Math</span>.round(a*(b||<span class="number">1E5</span>));<span class="keyword">return</span> <span class="keyword">this</span>.encodeSignedInteger(a)&#125;,<span class="attr">decodeFloat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.decodeSignedInteger(a)/(b||<span class="number">1E5</span>)&#125;,<span class="attr">encodeSignedInteger</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a&lt;&lt;<span class="number">1</span>;<span class="number">0</span>&gt;a&amp;&amp;(b=~b);<span class="keyword">return</span> <span class="keyword">this</span>.encodeUnsignedInteger(b)&#125;,<span class="attr">decodeSignedInteger</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.decodeUnsignedInteger(a);<span class="keyword">return</span> a&amp;<span class="number">1</span>?~(a&gt;&gt;<span class="number">1</span>):a&gt;&gt;<span class="number">1</span>&#125;,<span class="attr">encodeUnsignedInteger</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b,c=<span class="string">""</span>;<span class="number">32</span>&lt;=</span><br><span class="line">a;)b=(<span class="number">32</span>|a&amp;<span class="number">31</span>)+<span class="number">63</span>,c+=<span class="built_in">String</span>.fromCharCode(b),a&gt;&gt;=<span class="number">5</span>;<span class="keyword">return</span> c+=<span class="built_in">String</span>.fromCharCode(a+<span class="number">63</span>)&#125;,<span class="attr">decodeUnsignedInteger</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="number">0</span>,d=a.length,e=<span class="number">0</span>;e&lt;d;++e)&#123;<span class="keyword">var</span> f=a.charCodeAt(e)<span class="number">-63</span>,b=b|(f&amp;<span class="number">31</span>)&lt;&lt;c;<span class="keyword">if</span>(<span class="number">32</span>&gt;f)<span class="keyword">break</span>;c+=<span class="number">5</span>&#125;<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.EncodedPolyline"</span>&#125;);OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">controls</span>:<span class="literal">null</span>,<span class="attr">autoActivate</span>:!<span class="number">0</span>,<span class="attr">defaultControl</span>:<span class="literal">null</span>,<span class="attr">saveState</span>:!<span class="number">1</span>,<span class="attr">allowDepress</span>:!<span class="number">1</span>,<span class="attr">activeState</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.controls=[];<span class="keyword">this</span>.activeState=&#123;&#125;&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.unregister(<span class="string">"buttonclick"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onButtonClick);OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">for</span>(<span class="keyword">var</span> a,b=<span class="keyword">this</span>.controls.length<span class="number">-1</span>;<span class="number">0</span>&lt;=b;b--)a=<span class="keyword">this</span>.controls[b],a.events&amp;&amp;</span><br><span class="line">a.events.un(&#123;<span class="attr">activate</span>:<span class="keyword">this</span>.iconOn,<span class="attr">deactivate</span>:<span class="keyword">this</span>.iconOff&#125;),a.panel_div=<span class="literal">null</span>;<span class="keyword">this</span>.activeState=<span class="literal">null</span>&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(OpenLayers.Control.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>))&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a,b=<span class="number">0</span>,c=<span class="keyword">this</span>.controls.length;b&lt;c;b++)a=<span class="keyword">this</span>.controls[b],(a===<span class="keyword">this</span>.defaultControl||<span class="keyword">this</span>.saveState&amp;&amp;<span class="keyword">this</span>.activeState[a.id])&amp;&amp;a.activate();!<span class="number">0</span>===<span class="keyword">this</span>.saveState&amp;&amp;(<span class="keyword">this</span>.defaultControl=<span class="literal">null</span>);<span class="keyword">this</span>.redraw();<span class="keyword">return</span>!<span class="number">0</span>&#125;<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(OpenLayers.Control.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>))&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a,</span><br><span class="line">b=<span class="number">0</span>,c=<span class="keyword">this</span>.controls.length;b&lt;c;b++)a=<span class="keyword">this</span>.controls[b],<span class="keyword">this</span>.activeState[a.id]=a.deactivate();<span class="keyword">this</span>.redraw();<span class="keyword">return</span>!<span class="number">0</span>&#125;<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Control.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.outsideViewport?(<span class="keyword">this</span>.events.attachToElement(<span class="keyword">this</span>.div),<span class="keyword">this</span>.events.register(<span class="string">"buttonclick"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onButtonClick)):<span class="keyword">this</span>.map.events.register(<span class="string">"buttonclick"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onButtonClick);<span class="keyword">this</span>.addControlsToMap(<span class="keyword">this</span>.controls);<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">redraw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.div.childNodes.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;a--)<span class="keyword">this</span>.div.removeChild(<span class="keyword">this</span>.div.childNodes[a]);</span><br><span class="line"><span class="keyword">this</span>.div.innerHTML=<span class="string">""</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.active)<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="keyword">this</span>.controls.length;a&lt;b;a++)<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.controls[a].panel_div)&#125;,<span class="attr">activateControl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.active)<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">if</span>(a.type==OpenLayers.Control.TYPE_BUTTON)a.trigger();<span class="keyword">else</span> <span class="keyword">if</span>(a.type==OpenLayers.Control.TYPE_TOGGLE)a.active?a.deactivate():a.activate();<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.allowDepress&amp;&amp;a.active)a.deactivate();<span class="keyword">else</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b,c=<span class="number">0</span>,d=<span class="keyword">this</span>.controls.length;c&lt;d;c++)b=<span class="keyword">this</span>.controls[c],b==a||b.type!==OpenLayers.Control.TYPE_TOOL&amp;&amp;<span class="literal">null</span>!=b.type||b.deactivate();</span><br><span class="line">a.activate()&#125;&#125;,<span class="attr">addControls</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.isArray(a)||(a=[a]);<span class="keyword">this</span>.controls=<span class="keyword">this</span>.controls.concat(a);<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=a.length;b&lt;c;b++)&#123;<span class="keyword">var</span> d=a[b],e=<span class="keyword">this</span>.createControlMarkup(d);OpenLayers.Element.addClass(e,d.displayClass+<span class="string">"ItemInactive"</span>);OpenLayers.Element.addClass(e,<span class="string">"olButton"</span>);<span class="string">""</span>==d.title||e.title||(e.title=d.title);d.panel_div=e&#125;<span class="keyword">this</span>.map&amp;&amp;(<span class="keyword">this</span>.addControlsToMap(a),<span class="keyword">this</span>.redraw())&#125;,<span class="attr">createControlMarkup</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">document</span>.createElement(<span class="string">"div"</span>)&#125;,<span class="attr">addControlsToMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b,</span><br><span class="line">c=<span class="number">0</span>,d=a.length;c&lt;d;c++)b=a[c],!<span class="number">0</span>===b.autoActivate?(b.autoActivate=!<span class="number">1</span>,<span class="keyword">this</span>.map.addControl(b),b.autoActivate=!<span class="number">0</span>):(<span class="keyword">this</span>.map.addControl(b),b.deactivate()),b.events.on(&#123;<span class="attr">activate</span>:<span class="keyword">this</span>.iconOn,<span class="attr">deactivate</span>:<span class="keyword">this</span>.iconOff&#125;)&#125;,<span class="attr">iconOn</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.panel_div;a.className=a.className.replace(<span class="built_in">RegExp</span>(<span class="string">"\\b("</span>+<span class="keyword">this</span>.displayClass+<span class="string">"Item)Inactive\\b"</span>),<span class="string">"$1Active"</span>)&#125;,<span class="attr">iconOff</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.panel_div;a.className=a.className.replace(<span class="built_in">RegExp</span>(<span class="string">"\\b("</span>+<span class="keyword">this</span>.displayClass+<span class="string">"Item)Active\\b"</span>),<span class="string">"$1Inactive"</span>)&#125;,<span class="attr">onButtonClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.controls;a=a.buttonElement;<span class="keyword">for</span>(<span class="keyword">var</span> c=b.length<span class="number">-1</span>;<span class="number">0</span>&lt;=c;--c)<span class="keyword">if</span>(b[c].panel_div===a)&#123;<span class="keyword">this</span>.activateControl(b[c]);<span class="keyword">break</span>&#125;&#125;,<span class="attr">getControlsBy</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="string">"function"</span>==<span class="keyword">typeof</span> b.test;<span class="keyword">return</span> OpenLayers.Array.filter(<span class="keyword">this</span>.controls,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;<span class="keyword">return</span> d[a]==b||c&amp;&amp;b.test(d[a])&#125;)&#125;,<span class="attr">getControlsByName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.getControlsBy(<span class="string">"name"</span>,a)&#125;,<span class="attr">getControlsByClass</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.getControlsBy(<span class="string">"CLASS_NAME"</span>,a)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.Panel"</span>&#125;);OpenLayers.Control.Button=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">type</span>:OpenLayers.Control.TYPE_BUTTON,<span class="attr">trigger</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.Button"</span>&#125;);OpenLayers.Control.ZoomIn=OpenLayers.Class(OpenLayers.Control.Button,&#123;<span class="attr">trigger</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.zoomIn()&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.ZoomIn"</span>&#125;);OpenLayers.Control.ZoomOut=OpenLayers.Class(OpenLayers.Control.Button,&#123;<span class="attr">trigger</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.zoomOut()&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.ZoomOut"</span>&#125;);OpenLayers.Control.ZoomToMaxExtent=OpenLayers.Class(OpenLayers.Control.Button,&#123;<span class="attr">trigger</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.zoomToMaxExtent()&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.ZoomToMaxExtent"</span>&#125;);OpenLayers.Control.ZoomPanel=OpenLayers.Class(OpenLayers.Control.Panel,&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.Panel.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.addControls([<span class="keyword">new</span> OpenLayers.Control.ZoomIn,<span class="keyword">new</span> OpenLayers.Control.ZoomToMaxExtent,<span class="keyword">new</span> OpenLayers.Control.ZoomOut])&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.ZoomPanel"</span>&#125;);OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,&#123;<span class="attr">URL_HASH_FACTOR</span>:(<span class="built_in">Math</span>.sqrt(<span class="number">5</span>)<span class="number">-1</span>)/<span class="number">2</span>,<span class="attr">url</span>:<span class="literal">null</span>,<span class="attr">params</span>:<span class="literal">null</span>,<span class="attr">reproject</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;OpenLayers.Layer.prototype.initialize.apply(<span class="keyword">this</span>,[a,d]);<span class="keyword">this</span>.url=b;<span class="keyword">this</span>.params||(<span class="keyword">this</span>.params=OpenLayers.Util.extend(&#123;&#125;,c))&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.params=<span class="keyword">this</span>.url=<span class="literal">null</span>;OpenLayers.Layer.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.HTTPRequest(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.params,<span class="keyword">this</span>.getOptions()));</span><br><span class="line"><span class="keyword">return</span> a=OpenLayers.Layer.prototype.clone.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">setUrl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.url=a&#125;,<span class="attr">mergeNewParams</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.params=OpenLayers.Util.extend(<span class="keyword">this</span>.params,a);a=<span class="keyword">this</span>.redraw();<span class="literal">null</span>!=<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.triggerEvent(<span class="string">"changelayer"</span>,&#123;<span class="attr">layer</span>:<span class="keyword">this</span>,<span class="attr">property</span>:<span class="string">"params"</span>&#125;);<span class="keyword">return</span> a&#125;,<span class="attr">redraw</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a?<span class="keyword">this</span>.mergeNewParams(&#123;<span class="attr">_olSalt</span>:<span class="built_in">Math</span>.random()&#125;):OpenLayers.Layer.prototype.redraw.apply(<span class="keyword">this</span>,[])&#125;,<span class="attr">selectUrl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">1</span>,d=<span class="number">0</span>,e=a.length;d&lt;e;d++)c*=a.charCodeAt(d)*<span class="keyword">this</span>.URL_HASH_FACTOR,</span><br><span class="line">c-=<span class="built_in">Math</span>.floor(c);<span class="keyword">return</span> b[<span class="built_in">Math</span>.floor(c*b.length)]&#125;,<span class="attr">getFullRequestString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=b||<span class="keyword">this</span>.url,d=OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>.params),d=OpenLayers.Util.extend(d,a),e=OpenLayers.Util.getParameterString(d);OpenLayers.Util.isArray(c)&amp;&amp;(c=<span class="keyword">this</span>.selectUrl(e,c));<span class="keyword">var</span> e=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c)),f;<span class="keyword">for</span>(f <span class="keyword">in</span> d)f.toUpperCase()<span class="keyword">in</span> e&amp;&amp;<span class="keyword">delete</span> d[f];e=OpenLayers.Util.getParameterString(d);<span class="keyword">return</span> OpenLayers.Util.urlAppend(c,e)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.HTTPRequest"</span>&#125;);OpenLayers.Tile=OpenLayers.Class(&#123;<span class="attr">events</span>:<span class="literal">null</span>,<span class="attr">eventListeners</span>:<span class="literal">null</span>,<span class="attr">id</span>:<span class="literal">null</span>,<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">url</span>:<span class="literal">null</span>,<span class="attr">bounds</span>:<span class="literal">null</span>,<span class="attr">size</span>:<span class="literal">null</span>,<span class="attr">position</span>:<span class="literal">null</span>,<span class="attr">isLoading</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e,f</span>)</span>&#123;<span class="keyword">this</span>.layer=a;<span class="keyword">this</span>.position=b.clone();<span class="keyword">this</span>.setBounds(c);<span class="keyword">this</span>.url=d;e&amp;&amp;(<span class="keyword">this</span>.size=e.clone());<span class="keyword">this</span>.id=OpenLayers.Util.createUniqueID(<span class="string">"Tile_"</span>);OpenLayers.Util.extend(<span class="keyword">this</span>,f);<span class="keyword">this</span>.events=<span class="keyword">new</span> OpenLayers.Events(<span class="keyword">this</span>);<span class="keyword">if</span>(<span class="keyword">this</span>.eventListeners <span class="keyword">instanceof</span> <span class="built_in">Object</span>)<span class="keyword">this</span>.events.on(<span class="keyword">this</span>.eventListeners)&#125;,<span class="attr">unload</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.isLoading&amp;&amp;(<span class="keyword">this</span>.isLoading=</span><br><span class="line">!<span class="number">1</span>,<span class="keyword">this</span>.events.triggerEvent(<span class="string">"unload"</span>))&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.position=<span class="keyword">this</span>.size=<span class="keyword">this</span>.bounds=<span class="keyword">this</span>.layer=<span class="literal">null</span>;<span class="keyword">this</span>.eventListeners&amp;&amp;<span class="keyword">this</span>.events.un(<span class="keyword">this</span>.eventListeners);<span class="keyword">this</span>.events.destroy();<span class="keyword">this</span>.events=<span class="keyword">this</span>.eventListeners=<span class="literal">null</span>&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a||<span class="keyword">this</span>.clear();<span class="keyword">var</span> b=<span class="keyword">this</span>.shouldDraw();b&amp;&amp;(!a&amp;&amp;!<span class="number">1</span>===<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforedraw"</span>))&amp;&amp;(b=<span class="literal">null</span>);<span class="keyword">return</span> b&#125;,<span class="attr">shouldDraw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>,b=<span class="keyword">this</span>.layer.maxExtent;<span class="keyword">if</span>(b)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.layer.map,c=c.baseLayer.wrapDateLine&amp;&amp;c.getMaxExtent();<span class="keyword">this</span>.bounds.intersectsBounds(b,</span><br><span class="line">&#123;<span class="attr">inclusive</span>:!<span class="number">1</span>,<span class="attr">worldBounds</span>:c&#125;)&amp;&amp;(a=!<span class="number">0</span>)&#125;<span class="keyword">return</span> a||<span class="keyword">this</span>.layer.displayOutsideMaxExtent&#125;,<span class="attr">setBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.clone();<span class="keyword">if</span>(<span class="keyword">this</span>.layer.map.baseLayer.wrapDateLine)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.layer.map.getMaxExtent(),c=<span class="keyword">this</span>.layer.map.getResolution();a=a.wrapDateLine(b,&#123;<span class="attr">leftTolerance</span>:c,<span class="attr">rightTolerance</span>:c&#125;)&#125;<span class="keyword">this</span>.bounds=a&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="literal">null</span>==c&amp;&amp;(c=!<span class="number">0</span>);<span class="keyword">this</span>.setBounds(a);<span class="keyword">this</span>.position=b.clone();c&amp;&amp;<span class="keyword">this</span>.draw()&#125;,<span class="attr">clear</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Tile"</span>&#125;);OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,&#123;<span class="attr">url</span>:<span class="literal">null</span>,<span class="attr">imgDiv</span>:<span class="literal">null</span>,<span class="attr">frame</span>:<span class="literal">null</span>,<span class="attr">imageReloadAttempts</span>:<span class="literal">null</span>,<span class="attr">layerAlphaHack</span>:<span class="literal">null</span>,<span class="attr">asyncRequestId</span>:<span class="literal">null</span>,<span class="attr">maxGetUrlLength</span>:<span class="literal">null</span>,<span class="attr">canvasContext</span>:<span class="literal">null</span>,<span class="attr">crossOriginKeyword</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e,f</span>)</span>&#123;OpenLayers.Tile.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.url=d;<span class="keyword">this</span>.layerAlphaHack=<span class="keyword">this</span>.layer.alpha&amp;&amp;OpenLayers.Util.alphaHack();<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.maxGetUrlLength||<span class="keyword">this</span>.layer.gutter||<span class="keyword">this</span>.layerAlphaHack)<span class="keyword">this</span>.frame=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>),<span class="keyword">this</span>.frame.style.position=</span><br><span class="line"><span class="string">"absolute"</span>,<span class="keyword">this</span>.frame.style.overflow=<span class="string">"hidden"</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.maxGetUrlLength&amp;&amp;OpenLayers.Util.extend(<span class="keyword">this</span>,OpenLayers.Tile.Image.IFrame)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.imgDiv&amp;&amp;(<span class="keyword">this</span>.clear(),<span class="keyword">this</span>.frame=<span class="keyword">this</span>.imgDiv=<span class="literal">null</span>);<span class="keyword">this</span>.asyncRequestId=<span class="literal">null</span>;OpenLayers.Tile.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Tile.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);a?(<span class="keyword">this</span>.layer!=<span class="keyword">this</span>.layer.map.baseLayer&amp;&amp;<span class="keyword">this</span>.layer.reproject&amp;&amp;(<span class="keyword">this</span>.bounds=<span class="keyword">this</span>.getBoundsFromBaseLayer(<span class="keyword">this</span>.position)),<span class="keyword">this</span>.isLoading?<span class="keyword">this</span>._loadEvent=</span><br><span class="line"><span class="string">"reload"</span>:(<span class="keyword">this</span>.isLoading=!<span class="number">0</span>,<span class="keyword">this</span>._loadEvent=<span class="string">"loadstart"</span>),<span class="keyword">this</span>.renderTile(),<span class="keyword">this</span>.positionTile()):!<span class="number">1</span>===a&amp;&amp;<span class="keyword">this</span>.unload();<span class="keyword">return</span> a&#125;,<span class="attr">renderTile</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.layer.async)&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.asyncRequestId=(<span class="keyword">this</span>.asyncRequestId||<span class="number">0</span>)+<span class="number">1</span>;<span class="keyword">this</span>.layer.getURLasync(<span class="keyword">this</span>.bounds,<span class="function"><span class="keyword">function</span>(<span class="params">b</span>)</span>&#123;a==<span class="keyword">this</span>.asyncRequestId&amp;&amp;(<span class="keyword">this</span>.url=b,<span class="keyword">this</span>.initImage())&#125;,<span class="keyword">this</span>)&#125;<span class="keyword">else</span> <span class="keyword">this</span>.url=<span class="keyword">this</span>.layer.getURL(<span class="keyword">this</span>.bounds),<span class="keyword">this</span>.initImage()&#125;,<span class="attr">positionTile</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.getTile().style,b=<span class="keyword">this</span>.frame?<span class="keyword">this</span>.size:<span class="keyword">this</span>.layer.getImageSize(<span class="keyword">this</span>.bounds),</span><br><span class="line">c=<span class="number">1</span>;<span class="keyword">this</span>.layer <span class="keyword">instanceof</span> OpenLayers.Layer.Grid&amp;&amp;(c=<span class="keyword">this</span>.layer.getServerResolution()/<span class="keyword">this</span>.layer.map.getResolution());a.left=<span class="keyword">this</span>.position.x+<span class="string">"px"</span>;a.top=<span class="keyword">this</span>.position.y+<span class="string">"px"</span>;a.width=<span class="built_in">Math</span>.round(c*b.w)+<span class="string">"px"</span>;a.height=<span class="built_in">Math</span>.round(c*b.h)+<span class="string">"px"</span>&#125;,<span class="attr">clear</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Tile.prototype.clear.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">var</span> a=<span class="keyword">this</span>.imgDiv;<span class="keyword">if</span>(a)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getTile();b.parentNode===<span class="keyword">this</span>.layer.div&amp;&amp;<span class="keyword">this</span>.layer.div.removeChild(b);<span class="keyword">this</span>.setImgSrc();!<span class="number">0</span>===<span class="keyword">this</span>.layerAlphaHack&amp;&amp;(a.style.filter=<span class="string">""</span>);OpenLayers.Element.removeClass(a,</span><br><span class="line"><span class="string">"olImageLoadError"</span>)&#125;<span class="keyword">this</span>.canvasContext=<span class="literal">null</span>&#125;,<span class="attr">getImage</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.imgDiv)&#123;<span class="keyword">this</span>.imgDiv=OpenLayers.Tile.Image.IMAGE.cloneNode(!<span class="number">1</span>);<span class="keyword">var</span> a=<span class="keyword">this</span>.imgDiv.style;<span class="keyword">if</span>(<span class="keyword">this</span>.frame)&#123;<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="number">0</span>;<span class="keyword">this</span>.layer.gutter&amp;&amp;(b=<span class="number">100</span>*(<span class="keyword">this</span>.layer.gutter/<span class="keyword">this</span>.layer.tileSize.w),c=<span class="number">100</span>*(<span class="keyword">this</span>.layer.gutter/<span class="keyword">this</span>.layer.tileSize.h));a.left=-b+<span class="string">"%"</span>;a.top=-c+<span class="string">"%"</span>;a.width=<span class="number">2</span>*b+<span class="number">100</span>+<span class="string">"%"</span>;a.height=<span class="number">2</span>*c+<span class="number">100</span>+<span class="string">"%"</span>&#125;a.visibility=<span class="string">"hidden"</span>;a.opacity=<span class="number">0</span>;<span class="number">1</span>&gt;<span class="keyword">this</span>.layer.opacity&amp;&amp;(a.filter=<span class="string">"alpha(opacity="</span>+<span class="number">100</span>*<span class="keyword">this</span>.layer.opacity+<span class="string">")"</span>);a.position=<span class="string">"absolute"</span>;</span><br><span class="line"><span class="keyword">this</span>.layerAlphaHack&amp;&amp;(a.paddingTop=a.height,a.height=<span class="string">"0"</span>,a.width=<span class="string">"100%"</span>);<span class="keyword">this</span>.frame&amp;&amp;<span class="keyword">this</span>.frame.appendChild(<span class="keyword">this</span>.imgDiv)&#125;<span class="keyword">return</span> <span class="keyword">this</span>.imgDiv&#125;,<span class="attr">setImage</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.imgDiv=a&#125;,<span class="attr">initImage</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.url||<span class="keyword">this</span>.imgDiv)&#123;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforeload"</span>);<span class="keyword">this</span>.layer.div.appendChild(<span class="keyword">this</span>.getTile());<span class="keyword">this</span>.events.triggerEvent(<span class="keyword">this</span>._loadEvent);<span class="keyword">var</span> a=<span class="keyword">this</span>.getImage(),b=a.getAttribute(<span class="string">"src"</span>)||<span class="string">""</span>;<span class="keyword">this</span>.url&amp;&amp;OpenLayers.Util.isEquivalentUrl(b,<span class="keyword">this</span>.url)?<span class="keyword">this</span>._loadTimeout=<span class="built_in">window</span>.setTimeout(OpenLayers.Function.bind(<span class="keyword">this</span>.onImageLoad,</span><br><span class="line"><span class="keyword">this</span>),<span class="number">0</span>):(<span class="keyword">this</span>.stopLoading(),<span class="keyword">this</span>.crossOriginKeyword&amp;&amp;a.removeAttribute(<span class="string">"crossorigin"</span>),OpenLayers.Event.observe(a,<span class="string">"load"</span>,OpenLayers.Function.bind(<span class="keyword">this</span>.onImageLoad,<span class="keyword">this</span>)),OpenLayers.Event.observe(a,<span class="string">"error"</span>,OpenLayers.Function.bind(<span class="keyword">this</span>.onImageError,<span class="keyword">this</span>)),<span class="keyword">this</span>.imageReloadAttempts=<span class="number">0</span>,<span class="keyword">this</span>.setImgSrc(<span class="keyword">this</span>.url))&#125;<span class="keyword">else</span> <span class="keyword">this</span>.isLoading=!<span class="number">1</span>&#125;,<span class="attr">setImgSrc</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.imgDiv;a?(b.style.visibility=<span class="string">"hidden"</span>,b.style.opacity=<span class="number">0</span>,<span class="keyword">this</span>.crossOriginKeyword&amp;&amp;(<span class="string">"data:"</span>!==a.substr(<span class="number">0</span>,<span class="number">5</span>)?b.setAttribute(<span class="string">"crossorigin"</span>,<span class="keyword">this</span>.crossOriginKeyword):</span><br><span class="line">b.removeAttribute(<span class="string">"crossorigin"</span>)),b.src=a):(<span class="keyword">this</span>.stopLoading(),<span class="keyword">this</span>.imgDiv=<span class="literal">null</span>,b.parentNode&amp;&amp;b.parentNode.removeChild(b))&#125;,<span class="attr">getTile</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.frame?<span class="keyword">this</span>.frame:<span class="keyword">this</span>.getImage()&#125;,<span class="attr">createBackBuffer</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.imgDiv&amp;&amp;!<span class="keyword">this</span>.isLoading)&#123;<span class="keyword">var</span> a;<span class="keyword">this</span>.frame?(a=<span class="keyword">this</span>.frame.cloneNode(!<span class="number">1</span>),a.appendChild(<span class="keyword">this</span>.imgDiv)):a=<span class="keyword">this</span>.imgDiv;<span class="keyword">this</span>.imgDiv=<span class="literal">null</span>;<span class="keyword">return</span> a&#125;&#125;,<span class="attr">onImageLoad</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.imgDiv;<span class="keyword">this</span>.stopLoading();a.style.visibility=<span class="string">"inherit"</span>;a.style.opacity=<span class="keyword">this</span>.layer.opacity;<span class="keyword">this</span>.isLoading=</span><br><span class="line">!<span class="number">1</span>;<span class="keyword">this</span>.canvasContext=<span class="literal">null</span>;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loadend"</span>);!<span class="number">0</span>===<span class="keyword">this</span>.layerAlphaHack&amp;&amp;(a.style.filter=<span class="string">"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"</span>+a.src+<span class="string">"', sizingMethod='scale')"</span>)&#125;,<span class="attr">onImageError</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.imgDiv;<span class="literal">null</span>!=a.src&amp;&amp;(<span class="keyword">this</span>.imageReloadAttempts++,<span class="keyword">this</span>.imageReloadAttempts&lt;=OpenLayers.IMAGE_RELOAD_ATTEMPTS?<span class="keyword">this</span>.setImgSrc(<span class="keyword">this</span>.layer.getURL(<span class="keyword">this</span>.bounds)):(OpenLayers.Element.addClass(a,<span class="string">"olImageLoadError"</span>),a.onerror=errorImage(a),<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loaderror"</span>),<span class="keyword">this</span>.onImageLoad()))&#125;,<span class="attr">stopLoading</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Event.stopObservingElement(<span class="keyword">this</span>.imgDiv);</span><br><span class="line"><span class="built_in">window</span>.clearTimeout(<span class="keyword">this</span>._loadTimeout);<span class="keyword">delete</span> <span class="keyword">this</span>._loadTimeout&#125;,<span class="attr">getCanvasContext</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(OpenLayers.CANVAS_SUPPORTED&amp;&amp;<span class="keyword">this</span>.imgDiv&amp;&amp;!<span class="keyword">this</span>.isLoading)&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.canvasContext)&#123;<span class="keyword">var</span> a=<span class="built_in">document</span>.createElement(<span class="string">"canvas"</span>);a.width=<span class="keyword">this</span>.size.w;a.height=<span class="keyword">this</span>.size.h;<span class="keyword">this</span>.canvasContext=a.getContext(<span class="string">"2d"</span>);<span class="keyword">this</span>.canvasContext.drawImage(<span class="keyword">this</span>.imgDiv,<span class="number">0</span>,<span class="number">0</span>)&#125;<span class="keyword">return</span> <span class="keyword">this</span>.canvasContext&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Tile.Image"</span>&#125;);</span><br><span class="line">OpenLayers.Tile.Image.IMAGE=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">new</span> Image;a.className=<span class="string">"olTileImage"</span>;a.galleryImg=<span class="string">"no"</span>;<span class="keyword">return</span> a&#125;();OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,&#123;<span class="attr">tileSize</span>:<span class="literal">null</span>,<span class="attr">tileOriginCorner</span>:<span class="string">"bl"</span>,<span class="attr">tileOrigin</span>:<span class="literal">null</span>,<span class="attr">tileOptions</span>:<span class="literal">null</span>,<span class="attr">tileClass</span>:OpenLayers.Tile.Image,<span class="attr">grid</span>:<span class="literal">null</span>,<span class="attr">singleTile</span>:!<span class="number">1</span>,<span class="attr">ratio</span>:<span class="number">1.5</span>,<span class="attr">buffer</span>:<span class="number">0</span>,<span class="attr">transitionEffect</span>:<span class="string">"resize"</span>,<span class="attr">numLoadingTiles</span>:<span class="number">0</span>,<span class="attr">serverResolutions</span>:<span class="literal">null</span>,<span class="attr">loading</span>:!<span class="number">1</span>,<span class="attr">backBuffer</span>:<span class="literal">null</span>,<span class="attr">gridResolution</span>:<span class="literal">null</span>,<span class="attr">backBufferResolution</span>:<span class="literal">null</span>,<span class="attr">backBufferLonLat</span>:<span class="literal">null</span>,<span class="attr">backBufferTimerId</span>:<span class="literal">null</span>,<span class="attr">removeBackBufferDelay</span>:<span class="literal">null</span>,<span class="attr">className</span>:<span class="literal">null</span>,<span class="attr">gridLayout</span>:<span class="literal">null</span>,<span class="attr">rowSign</span>:<span class="literal">null</span>,<span class="attr">transitionendEvents</span>:[<span class="string">"transitionend"</span>,</span><br><span class="line"><span class="string">"webkitTransitionEnd"</span>,<span class="string">"otransitionend"</span>,<span class="string">"oTransitionEnd"</span>],<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.grid=[];<span class="keyword">this</span>._removeBackBuffer=OpenLayers.Function.bind(<span class="keyword">this</span>.removeBackBuffer,<span class="keyword">this</span>);<span class="keyword">this</span>.initProperties();<span class="keyword">this</span>.rowSign=<span class="string">"t"</span>===<span class="keyword">this</span>.tileOriginCorner.substr(<span class="number">0</span>,<span class="number">1</span>)?<span class="number">1</span>:<span class="number">-1</span>&#125;,<span class="attr">initProperties</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">void</span> <span class="number">0</span>===<span class="keyword">this</span>.options.removeBackBufferDelay&amp;&amp;(<span class="keyword">this</span>.removeBackBufferDelay=<span class="keyword">this</span>.singleTile?<span class="number">0</span>:<span class="number">2500</span>);<span class="keyword">void</span> <span class="number">0</span>===<span class="keyword">this</span>.options.className&amp;&amp;(<span class="keyword">this</span>.className=<span class="keyword">this</span>.singleTile?</span><br><span class="line"><span class="string">"olLayerGridSingleTile"</span>:<span class="string">"olLayerGrid"</span>)&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Layer.HTTPRequest.prototype.setMap.call(<span class="keyword">this</span>,a);OpenLayers.Element.addClass(<span class="keyword">this</span>.div,<span class="keyword">this</span>.className)&#125;,<span class="attr">removeMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.removeBackBuffer()&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.removeBackBuffer();<span class="keyword">this</span>.clearGrid();<span class="keyword">this</span>.tileSize=<span class="keyword">this</span>.grid=<span class="literal">null</span>;OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">clearGrid</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.grid)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="keyword">this</span>.grid.length;a&lt;b;a++)<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="keyword">this</span>.grid[a],d=<span class="number">0</span>,e=c.length;d&lt;e;d++)<span class="keyword">this</span>.destroyTile(c[d]);</span><br><span class="line"><span class="keyword">this</span>.grid=[];<span class="keyword">this</span>.gridLayout=<span class="keyword">this</span>.gridResolution=<span class="literal">null</span>&#125;&#125;,<span class="attr">addOptions</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">void</span> <span class="number">0</span>!==a.singleTile&amp;&amp;a.singleTile!==<span class="keyword">this</span>.singleTile;OpenLayers.Layer.HTTPRequest.prototype.addOptions.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.map&amp;&amp;c&amp;&amp;(<span class="keyword">this</span>.initProperties(),<span class="keyword">this</span>.clearGrid(),<span class="keyword">this</span>.tileSize=<span class="keyword">this</span>.options.tileSize,<span class="keyword">this</span>.setTileSize(),<span class="keyword">this</span>.moveTo(<span class="literal">null</span>,!<span class="number">0</span>))&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.Grid(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.params,<span class="keyword">this</span>.getOptions()));a=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(<span class="keyword">this</span>,</span><br><span class="line">[a]);<span class="literal">null</span>!=<span class="keyword">this</span>.tileSize&amp;&amp;(a.tileSize=<span class="keyword">this</span>.tileSize.clone());a.grid=[];a.gridResolution=<span class="literal">null</span>;a.backBuffer=<span class="literal">null</span>;a.backBufferTimerId=<span class="literal">null</span>;a.loading=!<span class="number">1</span>;a.numLoadingTiles=<span class="number">0</span>;<span class="keyword">return</span> a&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);a=a||<span class="keyword">this</span>.map.getExtent();<span class="keyword">if</span>(<span class="literal">null</span>!=a)&#123;<span class="keyword">var</span> d=!<span class="keyword">this</span>.grid.length||b,e=<span class="keyword">this</span>.getTilesBounds(),f=<span class="keyword">this</span>.map.getResolution();<span class="keyword">this</span>.getServerResolution(f);<span class="keyword">if</span>(<span class="keyword">this</span>.singleTile)&#123;<span class="keyword">if</span>(d||!c&amp;&amp;!e.containsBounds(a))b&amp;&amp;<span class="string">"resize"</span>!==<span class="keyword">this</span>.transitionEffect&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.removeBackBuffer(),b&amp;&amp;<span class="string">"resize"</span>!==<span class="keyword">this</span>.transitionEffect||<span class="keyword">this</span>.applyBackBuffer(f),<span class="keyword">this</span>.initSingleTile(a)&#125;<span class="keyword">else</span>(d=d||!e.intersectsBounds(a,&#123;<span class="attr">worldBounds</span>:<span class="keyword">this</span>.map.baseLayer.wrapDateLine&amp;&amp;<span class="keyword">this</span>.map.getMaxExtent()&#125;))?(!b||<span class="string">"resize"</span>!==<span class="keyword">this</span>.transitionEffect&amp;&amp;<span class="keyword">this</span>.gridResolution!==f||<span class="keyword">this</span>.applyBackBuffer(f),<span class="keyword">this</span>.initGriddedTiles(a)):<span class="keyword">this</span>.moveGriddedTiles()&#125;&#125;,<span class="attr">getTileData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>,c=a.lon,d=a.lat,e=<span class="keyword">this</span>.grid.length;<span class="keyword">if</span>(<span class="keyword">this</span>.map&amp;&amp;e)&#123;<span class="keyword">var</span> f=<span class="keyword">this</span>.map.getResolution();a=<span class="keyword">this</span>.tileSize.w;<span class="keyword">var</span> g=<span class="keyword">this</span>.tileSize.h,</span><br><span class="line">h=<span class="keyword">this</span>.grid[<span class="number">0</span>][<span class="number">0</span>].bounds,k=h.left,h=h.top;<span class="keyword">if</span>(c&lt;k&amp;&amp;<span class="keyword">this</span>.map.baseLayer.wrapDateLine)<span class="keyword">var</span> l=<span class="keyword">this</span>.map.getMaxExtent().getWidth(),m=<span class="built_in">Math</span>.ceil((k-c)/l),c=c+l*m;c=(c-k)/(f*a);d=(h-d)/(f*g);f=<span class="built_in">Math</span>.floor(c);k=<span class="built_in">Math</span>.floor(d);<span class="number">0</span>&lt;=k&amp;&amp;k&lt;e&amp;&amp;(e=<span class="keyword">this</span>.grid[k][f])&amp;&amp;(b=&#123;<span class="attr">tile</span>:e,<span class="attr">i</span>:<span class="built_in">Math</span>.floor((c-f)*a),<span class="attr">j</span>:<span class="built_in">Math</span>.floor((d-k)*g)&#125;)&#125;<span class="keyword">return</span> b&#125;,<span class="attr">destroyTile</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.removeTileMonitoringHooks(a);a.destroy()&#125;,<span class="attr">getServerResolution</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="built_in">Number</span>.POSITIVE_INFINITY;a=a||<span class="keyword">this</span>.map.getResolution();<span class="keyword">if</span>(<span class="keyword">this</span>.serverResolutions&amp;&amp;</span><br><span class="line"><span class="number">-1</span>===OpenLayers.Util.indexOf(<span class="keyword">this</span>.serverResolutions,a))&#123;<span class="keyword">var</span> c,d,e,f;<span class="keyword">for</span>(c=<span class="keyword">this</span>.serverResolutions.length<span class="number">-1</span>;<span class="number">0</span>&lt;=c;c--)&#123;e=<span class="keyword">this</span>.serverResolutions[c];d=<span class="built_in">Math</span>.abs(e-a);<span class="keyword">if</span>(d&gt;b)<span class="keyword">break</span>;b=d;f=e&#125;a=f&#125;<span class="keyword">return</span> a&#125;,<span class="attr">getServerZoom</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.getServerResolution();<span class="keyword">return</span> <span class="keyword">this</span>.serverResolutions?OpenLayers.Util.indexOf(<span class="keyword">this</span>.serverResolutions,a):<span class="keyword">this</span>.map.getZoomForResolution(a)+(<span class="keyword">this</span>.zoomOffset||<span class="number">0</span>)&#125;,<span class="attr">applyBackBuffer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>!==<span class="keyword">this</span>.backBufferTimerId&amp;&amp;<span class="keyword">this</span>.removeBackBuffer();<span class="keyword">var</span> b=<span class="keyword">this</span>.backBuffer;<span class="keyword">if</span>(!b)&#123;b=</span><br><span class="line"><span class="keyword">this</span>.createBackBuffer();<span class="keyword">if</span>(!b)<span class="keyword">return</span>;a===<span class="keyword">this</span>.gridResolution?<span class="keyword">this</span>.div.insertBefore(b,<span class="keyword">this</span>.div.firstChild):<span class="keyword">this</span>.map.baseLayer.div.parentNode.insertBefore(b,<span class="keyword">this</span>.map.baseLayer.div);<span class="keyword">this</span>.backBuffer=b;<span class="keyword">var</span> c=<span class="keyword">this</span>.grid[<span class="number">0</span>][<span class="number">0</span>].bounds;<span class="keyword">this</span>.backBufferLonLat=&#123;<span class="attr">lon</span>:c.left,<span class="attr">lat</span>:c.top&#125;;<span class="keyword">this</span>.backBufferResolution=<span class="keyword">this</span>.gridResolution&#125;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="keyword">this</span>.backBufferResolution/a,d=b.childNodes,e,f=d.length<span class="number">-1</span>;<span class="number">0</span>&lt;=f;--f)e=d[f],e.style.top=(c*e._i*e._h|<span class="number">0</span>)+<span class="string">"px"</span>,e.style.left=(c*e._j*e._w|<span class="number">0</span>)+<span class="string">"px"</span>,e.style.width=<span class="built_in">Math</span>.round(c*e._w)+</span><br><span class="line"><span class="string">"px"</span>,e.style.height=<span class="built_in">Math</span>.round(c*e._h)+<span class="string">"px"</span>;a=<span class="keyword">this</span>.getViewPortPxFromLonLat(<span class="keyword">this</span>.backBufferLonLat,a);c=<span class="keyword">this</span>.map.layerContainerOriginPx.y;b.style.left=<span class="built_in">Math</span>.round(a.x-<span class="keyword">this</span>.map.layerContainerOriginPx.x)+<span class="string">"px"</span>;b.style.top=<span class="built_in">Math</span>.round(a.y-c)+<span class="string">"px"</span>&#125;,<span class="attr">createBackBuffer</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a;<span class="keyword">if</span>(<span class="number">0</span>&lt;<span class="keyword">this</span>.grid.length)&#123;a=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);a.id=<span class="keyword">this</span>.div.id+<span class="string">"_bb"</span>;a.className=<span class="string">"olBackBuffer"</span>;a.style.position=<span class="string">"absolute"</span>;<span class="keyword">var</span> b=<span class="keyword">this</span>.map;a.style.zIndex=<span class="string">"resize"</span>===<span class="keyword">this</span>.transitionEffect?<span class="keyword">this</span>.getZIndex()<span class="number">-1</span>:b.Z_INDEX_BASE.BaseLayer-</span><br><span class="line">(b.getNumLayers()-b.getLayerIndex(<span class="keyword">this</span>));<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="keyword">this</span>.grid.length;b&lt;c;b++)<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e=<span class="keyword">this</span>.grid[b].length;d&lt;e;d++)&#123;<span class="keyword">var</span> f=<span class="keyword">this</span>.grid[b][d],g=<span class="keyword">this</span>.grid[b][d].createBackBuffer();g&amp;&amp;(g._i=b,g._j=d,g._w=f.size.w,g._h=f.size.h,g.id=f.id+<span class="string">"_bb"</span>,a.appendChild(g))&#125;&#125;<span class="keyword">return</span> a&#125;,<span class="attr">removeBackBuffer</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>._transitionElement)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.transitionendEvents.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;--a)OpenLayers.Event.stopObserving(<span class="keyword">this</span>._transitionElement,<span class="keyword">this</span>.transitionendEvents[a],<span class="keyword">this</span>._removeBackBuffer);<span class="keyword">delete</span> <span class="keyword">this</span>._transitionElement&#125;<span class="keyword">this</span>.backBuffer&amp;&amp;</span><br><span class="line">(<span class="keyword">this</span>.backBuffer.parentNode&amp;&amp;<span class="keyword">this</span>.backBuffer.parentNode.removeChild(<span class="keyword">this</span>.backBuffer),<span class="keyword">this</span>.backBufferResolution=<span class="keyword">this</span>.backBuffer=<span class="literal">null</span>,<span class="literal">null</span>!==<span class="keyword">this</span>.backBufferTimerId&amp;&amp;(<span class="built_in">window</span>.clearTimeout(<span class="keyword">this</span>.backBufferTimerId),<span class="keyword">this</span>.backBufferTimerId=<span class="literal">null</span>))&#125;,<span class="attr">moveByPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.singleTile||<span class="keyword">this</span>.moveGriddedTiles()&#125;,<span class="attr">setTileSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.singleTile&amp;&amp;(a=<span class="keyword">this</span>.map.getSize(),a.h=<span class="built_in">parseInt</span>(a.h*<span class="keyword">this</span>.ratio,<span class="number">10</span>),a.w=<span class="built_in">parseInt</span>(a.w*<span class="keyword">this</span>.ratio,<span class="number">10</span>));OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">getTilesBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=</span><br><span class="line"><span class="literal">null</span>,b=<span class="keyword">this</span>.grid.length;<span class="keyword">if</span>(b)<span class="keyword">var</span> a=<span class="keyword">this</span>.grid[b<span class="number">-1</span>][<span class="number">0</span>].bounds,b=<span class="keyword">this</span>.grid[<span class="number">0</span>].length*a.getWidth(),c=<span class="keyword">this</span>.grid.length*a.getHeight(),a=<span class="keyword">new</span> OpenLayers.Bounds(a.left,a.bottom,a.left+b,a.bottom+c);<span class="keyword">return</span> a&#125;,<span class="attr">initSingleTile</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"retile"</span>);<span class="keyword">var</span> b=a.getCenterLonLat(),c=a.getWidth()*<span class="keyword">this</span>.ratio;a=a.getHeight()*<span class="keyword">this</span>.ratio;b=<span class="keyword">new</span> OpenLayers.Bounds(b.lon-c/<span class="number">2</span>,b.lat-a/<span class="number">2</span>,b.lon+c/<span class="number">2</span>,b.lat+a/<span class="number">2</span>);c=<span class="keyword">this</span>.map.getLayerPxFromLonLat(&#123;<span class="attr">lon</span>:b.left,<span class="attr">lat</span>:b.top&#125;);<span class="keyword">this</span>.grid.length||(<span class="keyword">this</span>.grid[<span class="number">0</span>]=[]);(a=<span class="keyword">this</span>.grid[<span class="number">0</span>][<span class="number">0</span>])?</span><br><span class="line">a.moveTo(b,c):(a=<span class="keyword">this</span>.addTile(b,c),<span class="keyword">this</span>.addTileMonitoringHooks(a),a.draw(),<span class="keyword">this</span>.grid[<span class="number">0</span>][<span class="number">0</span>]=a);<span class="keyword">this</span>.removeExcessTiles(<span class="number">1</span>,<span class="number">1</span>);<span class="keyword">this</span>.gridResolution=<span class="keyword">this</span>.getServerResolution()&#125;,<span class="attr">calculateGridLayout</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=c*<span class="keyword">this</span>.tileSize.w;c*=<span class="keyword">this</span>.tileSize.h;<span class="keyword">var</span> e=<span class="built_in">Math</span>.floor((a.left-b.lon)/d)-<span class="keyword">this</span>.buffer,f=<span class="keyword">this</span>.rowSign;a=<span class="built_in">Math</span>[~f?<span class="string">"floor"</span>:<span class="string">"ceil"</span>](f*(b.lat-a.top+c)/c)-<span class="keyword">this</span>.buffer*f;<span class="keyword">return</span>&#123;<span class="attr">tilelon</span>:d,<span class="attr">tilelat</span>:c,<span class="attr">startcol</span>:e,<span class="attr">startrow</span>:a&#125;&#125;,<span class="attr">getTileOrigin</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.tileOrigin;<span class="keyword">if</span>(!a)<span class="keyword">var</span> a=<span class="keyword">this</span>.getMaxExtent(),</span><br><span class="line">b=&#123;<span class="attr">tl</span>:[<span class="string">"left"</span>,<span class="string">"top"</span>],<span class="attr">tr</span>:[<span class="string">"right"</span>,<span class="string">"top"</span>],<span class="attr">bl</span>:[<span class="string">"left"</span>,<span class="string">"bottom"</span>],<span class="attr">br</span>:[<span class="string">"right"</span>,<span class="string">"bottom"</span>]&#125;[<span class="keyword">this</span>.tileOriginCorner],a=<span class="keyword">new</span> OpenLayers.LonLat(a[b[<span class="number">0</span>]],a[b[<span class="number">1</span>]]);<span class="keyword">return</span> a&#125;,<span class="attr">getTileBoundsForGridIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getTileOrigin(),d=<span class="keyword">this</span>.gridLayout,e=d.tilelon,f=d.tilelat,g=d.startcol,d=d.startrow,h=<span class="keyword">this</span>.rowSign;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Bounds(c.lon+(g+b)*e,c.lat-(d+a*h)*f*h,c.lon+(g+b+<span class="number">1</span>)*e,c.lat-(d+(a<span class="number">-1</span>)*h)*f*h)&#125;,<span class="attr">initGriddedTiles</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"retile"</span>);<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getSize(),c=<span class="keyword">this</span>.getTileOrigin(),</span><br><span class="line">d=<span class="keyword">this</span>.map.getResolution(),e=<span class="keyword">this</span>.getServerResolution(),f=d/e,d=<span class="keyword">this</span>.tileSize.w/f,f=<span class="keyword">this</span>.tileSize.h/f,g=<span class="built_in">Math</span>.ceil(b.h/f)+<span class="number">2</span>*<span class="keyword">this</span>.buffer+<span class="number">1</span>,b=<span class="built_in">Math</span>.ceil(b.w/d)+<span class="number">2</span>*<span class="keyword">this</span>.buffer+<span class="number">1</span>;<span class="keyword">this</span>.gridLayout=e=<span class="keyword">this</span>.calculateGridLayout(a,c,e);<span class="keyword">var</span> c=e.tilelon,h=e.tilelat,e=<span class="keyword">this</span>.map.layerContainerOriginPx.x,k=<span class="keyword">this</span>.map.layerContainerOriginPx.y,l=<span class="keyword">this</span>.getTileBoundsForGridIndex(<span class="number">0</span>,<span class="number">0</span>),m=<span class="keyword">this</span>.map.getViewPortPxFromLonLat(<span class="keyword">new</span> OpenLayers.LonLat(l.left,l.top));m.x=<span class="built_in">Math</span>.round(m.x)-e;m.y=<span class="built_in">Math</span>.round(m.y)-k;<span class="keyword">var</span> e=[],k=<span class="keyword">this</span>.map.getCenter(),</span><br><span class="line">n=<span class="number">0</span>;<span class="keyword">do</span>&#123;<span class="keyword">var</span> p=<span class="keyword">this</span>.grid[n];p||(p=[],<span class="keyword">this</span>.grid.push(p));<span class="keyword">var</span> q=<span class="number">0</span>;<span class="keyword">do</span>&#123;<span class="keyword">var</span> l=<span class="keyword">this</span>.getTileBoundsForGridIndex(n,q),r=m.clone();r.x+=q*<span class="built_in">Math</span>.round(d);r.y+=n*<span class="built_in">Math</span>.round(f);<span class="keyword">var</span> s=p[q];s?s.moveTo(l,r,!<span class="number">1</span>):(s=<span class="keyword">this</span>.addTile(l,r),<span class="keyword">this</span>.addTileMonitoringHooks(s),p.push(s));r=l.getCenterLonLat();e.push(&#123;<span class="attr">tile</span>:s,<span class="attr">distance</span>:<span class="built_in">Math</span>.pow(r.lon-k.lon,<span class="number">2</span>)+<span class="built_in">Math</span>.pow(r.lat-k.lat,<span class="number">2</span>)&#125;);q+=<span class="number">1</span>&#125;<span class="keyword">while</span>(l.right&lt;=a.right+c*<span class="keyword">this</span>.buffer||q&lt;b);n+=<span class="number">1</span>&#125;<span class="keyword">while</span>(l.bottom&gt;=a.bottom-h*<span class="keyword">this</span>.buffer||n&lt;g);<span class="keyword">this</span>.removeExcessTiles(n,q);<span class="keyword">this</span>.gridResolution=d=<span class="keyword">this</span>.getServerResolution();</span><br><span class="line">e.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> a.distance-b.distance&#125;);a=<span class="number">0</span>;<span class="keyword">for</span>(d=e.length;a&lt;d;++a)e[a].tile.draw()&#125;,<span class="attr">getMaxExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.maxExtent&#125;,<span class="attr">addTile</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> <span class="keyword">this</span>.tileClass(<span class="keyword">this</span>,b,a,<span class="literal">null</span>,<span class="keyword">this</span>.tileSize,<span class="keyword">this</span>.tileOptions);<span class="keyword">this</span>.events.triggerEvent(<span class="string">"addtile"</span>,&#123;<span class="attr">tile</span>:c&#125;);<span class="keyword">return</span> c&#125;,<span class="attr">addTileMonitoringHooks</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.onLoadStart=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;!<span class="number">1</span>===<span class="keyword">this</span>.loading&amp;&amp;(<span class="keyword">this</span>.loading=!<span class="number">0</span>,<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loadstart"</span>));<span class="keyword">this</span>.events.triggerEvent(<span class="string">"tileloadstart"</span>,&#123;<span class="attr">tile</span>:a&#125;);<span class="keyword">this</span>.numLoadingTiles++;</span><br><span class="line">!<span class="keyword">this</span>.singleTile&amp;&amp;(<span class="keyword">this</span>.backBuffer&amp;&amp;<span class="keyword">this</span>.gridResolution===<span class="keyword">this</span>.backBufferResolution)&amp;&amp;OpenLayers.Element.addClass(a.getTile(),<span class="string">"olTileReplacing"</span>)&#125;;a.onLoadEnd=<span class="function"><span class="keyword">function</span>(<span class="params">b</span>)</span>&#123;<span class="keyword">this</span>.numLoadingTiles--;b=<span class="string">"unload"</span>===b.type;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"tileloaded"</span>,&#123;<span class="attr">tile</span>:a,<span class="attr">aborted</span>:b&#125;);<span class="keyword">if</span>(!<span class="keyword">this</span>.singleTile&amp;&amp;!b&amp;&amp;<span class="keyword">this</span>.backBuffer&amp;&amp;<span class="keyword">this</span>.gridResolution===<span class="keyword">this</span>.backBufferResolution)&#123;<span class="keyword">var</span> c=a.getTile();<span class="keyword">if</span>(<span class="string">"none"</span>===OpenLayers.Element.getStyle(c,<span class="string">"display"</span>))&#123;<span class="keyword">var</span> d=<span class="built_in">document</span>.getElementById(a.id+<span class="string">"_bb"</span>);d&amp;&amp;d.parentNode.removeChild(d)&#125;OpenLayers.Element.removeClass(c,</span><br><span class="line"><span class="string">"olTileReplacing"</span>)&#125;<span class="keyword">if</span>(<span class="number">0</span>===<span class="keyword">this</span>.numLoadingTiles)&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.backBuffer)<span class="keyword">if</span>(<span class="number">0</span>===<span class="keyword">this</span>.backBuffer.childNodes.length)<span class="keyword">this</span>.removeBackBuffer();<span class="keyword">else</span>&#123;<span class="keyword">this</span>._transitionElement=b?<span class="keyword">this</span>.div.lastChild:a.imgDiv;b=<span class="keyword">this</span>.transitionendEvents;<span class="keyword">for</span>(c=b.length<span class="number">-1</span>;<span class="number">0</span>&lt;=c;--c)OpenLayers.Event.observe(<span class="keyword">this</span>._transitionElement,b[c],<span class="keyword">this</span>._removeBackBuffer);<span class="keyword">this</span>.backBufferTimerId=<span class="built_in">window</span>.setTimeout(<span class="keyword">this</span>._removeBackBuffer,<span class="keyword">this</span>.removeBackBufferDelay)&#125;<span class="keyword">this</span>.loading=!<span class="number">1</span>;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loadend"</span>)&#125;&#125;;a.onLoadError=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"tileerror"</span>,</span><br><span class="line">&#123;<span class="attr">tile</span>:a&#125;)&#125;;a.events.on(&#123;<span class="attr">loadstart</span>:a.onLoadStart,<span class="attr">loadend</span>:a.onLoadEnd,<span class="attr">unload</span>:a.onLoadEnd,<span class="attr">loaderror</span>:a.onLoadError,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">removeTileMonitoringHooks</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.unload();a.events.un(&#123;<span class="attr">loadstart</span>:a.onLoadStart,<span class="attr">loadend</span>:a.onLoadEnd,<span class="attr">unload</span>:a.onLoadEnd,<span class="attr">loaderror</span>:a.onLoadError,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">moveGriddedTiles</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.buffer+<span class="number">1</span>;;)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.grid[<span class="number">0</span>][<span class="number">0</span>],c=b.position.x+<span class="keyword">this</span>.map.layerContainerOriginPx.x,b=b.position.y+<span class="keyword">this</span>.map.layerContainerOriginPx.y,d=<span class="keyword">this</span>.getServerResolution()/<span class="keyword">this</span>.map.getResolution(),</span><br><span class="line">d=&#123;<span class="attr">w</span>:<span class="built_in">Math</span>.round(<span class="keyword">this</span>.tileSize.w*d),<span class="attr">h</span>:<span class="built_in">Math</span>.round(<span class="keyword">this</span>.tileSize.h*d)&#125;;<span class="keyword">if</span>(c&gt;-d.w*(a<span class="number">-1</span>))<span class="keyword">this</span>.shiftColumn(!<span class="number">0</span>,d);<span class="keyword">else</span> <span class="keyword">if</span>(c&lt;-d.w*a)<span class="keyword">this</span>.shiftColumn(!<span class="number">1</span>,d);<span class="keyword">else</span> <span class="keyword">if</span>(b&gt;-d.h*(a<span class="number">-1</span>))<span class="keyword">this</span>.shiftRow(!<span class="number">0</span>,d);<span class="keyword">else</span> <span class="keyword">if</span>(b&lt;-d.h*a)<span class="keyword">this</span>.shiftRow(!<span class="number">1</span>,d);<span class="keyword">else</span> <span class="keyword">break</span>&#125;&#125;,<span class="attr">shiftRow</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.grid,d=a?<span class="number">0</span>:c.length<span class="number">-1</span>,e=a?<span class="number">-1</span>:<span class="number">1</span>;<span class="keyword">this</span>.gridLayout.startrow+=e*<span class="keyword">this</span>.rowSign;<span class="keyword">for</span>(<span class="keyword">var</span> f=c[d],g=c[a?<span class="string">"pop"</span>:<span class="string">"shift"</span>](),h=<span class="number">0</span>,k=g.length;h&lt;k;h++)&#123;<span class="keyword">var</span> l=g[h],m=f[h].position.clone();m.y+=b.h*e;l.moveTo(<span class="keyword">this</span>.getTileBoundsForGridIndex(d,h),m)&#125;c[a?</span><br><span class="line"><span class="string">"unshift"</span>:<span class="string">"push"</span>](g)&#125;,<span class="attr">shiftColumn</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.grid,d=a?<span class="number">0</span>:c[<span class="number">0</span>].length<span class="number">-1</span>,e=a?<span class="number">-1</span>:<span class="number">1</span>;<span class="keyword">this</span>.gridLayout.startcol+=e;<span class="keyword">for</span>(<span class="keyword">var</span> f=<span class="number">0</span>,g=c.length;f&lt;g;f++)&#123;<span class="keyword">var</span> h=c[f],k=h[d].position.clone(),l=h[a?<span class="string">"pop"</span>:<span class="string">"shift"</span>]();k.x+=b.w*e;l.moveTo(<span class="keyword">this</span>.getTileBoundsForGridIndex(f,d),k);h[a?<span class="string">"unshift"</span>:<span class="string">"push"</span>](l)&#125;&#125;,<span class="attr">removeExcessTiles</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c,d;<span class="keyword">this</span>.grid.length&gt;a;)&#123;<span class="keyword">var</span> e=<span class="keyword">this</span>.grid.pop();c=<span class="number">0</span>;<span class="keyword">for</span>(d=e.length;c&lt;d;c++)&#123;<span class="keyword">var</span> f=e[c];<span class="keyword">this</span>.destroyTile(f)&#125;&#125;c=<span class="number">0</span>;<span class="keyword">for</span>(d=<span class="keyword">this</span>.grid.length;c&lt;d;c++)<span class="keyword">for</span>(;<span class="keyword">this</span>.grid[c].length&gt;</span><br><span class="line">b;)e=<span class="keyword">this</span>.grid[c],f=e.pop(),<span class="keyword">this</span>.destroyTile(f)&#125;,<span class="attr">onMapResize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.singleTile&amp;&amp;(<span class="keyword">this</span>.clearGrid(),<span class="keyword">this</span>.setTileSize())&#125;,<span class="attr">getTileBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.maxExtent,c=<span class="keyword">this</span>.getResolution(),d=c*<span class="keyword">this</span>.tileSize.w,c=c*<span class="keyword">this</span>.tileSize.h,e=<span class="keyword">this</span>.getLonLatFromViewPortPx(a);a=b.left+d*<span class="built_in">Math</span>.floor((e.lon-b.left)/d);b=b.bottom+c*<span class="built_in">Math</span>.floor((e.lat-b.bottom)/c);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Bounds(a,b,a+d,b+c)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.Grid"</span>&#125;);OpenLayers.Format.ArcXML=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">fontStyleKeys</span>:<span class="string">"antialiasing blockout font fontcolor fontsize fontstyle glowing interval outline printmode shadow transparency"</span>.split(<span class="string">" "</span>),<span class="attr">request</span>:<span class="literal">null</span>,<span class="attr">response</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.request=<span class="keyword">new</span> OpenLayers.Format.ArcXML.Request;<span class="keyword">this</span>.response=<span class="keyword">new</span> OpenLayers.Format.ArcXML.Response;<span class="keyword">if</span>(a)<span class="keyword">if</span>(<span class="string">"feature"</span>==a.requesttype)&#123;<span class="keyword">this</span>.request.get_image=<span class="literal">null</span>;<span class="keyword">var</span> b=<span class="keyword">this</span>.request.get_feature.query;<span class="keyword">this</span>.addCoordSys(b.featurecoordsys,a.featureCoordSys);</span><br><span class="line"><span class="keyword">this</span>.addCoordSys(b.filtercoordsys,a.filterCoordSys);a.polygon?(b.isspatial=!<span class="number">0</span>,b.spatialfilter.polygon=a.polygon):a.envelope&amp;&amp;(b.isspatial=!<span class="number">0</span>,b.spatialfilter.envelope=&#123;<span class="attr">minx</span>:<span class="number">0</span>,<span class="attr">miny</span>:<span class="number">0</span>,<span class="attr">maxx</span>:<span class="number">0</span>,<span class="attr">maxy</span>:<span class="number">0</span>&#125;,<span class="keyword">this</span>.parseEnvelope(b.spatialfilter.envelope,a.envelope))&#125;<span class="keyword">else</span><span class="string">"image"</span>==a.requesttype?(<span class="keyword">this</span>.request.get_feature=<span class="literal">null</span>,b=<span class="keyword">this</span>.request.get_image.properties,<span class="keyword">this</span>.parseEnvelope(b.envelope,a.envelope),<span class="keyword">this</span>.addLayers(b.layerlist,a.layers),<span class="keyword">this</span>.addImageSize(b.imagesize,a.tileSize),<span class="keyword">this</span>.addCoordSys(b.featurecoordsys,</span><br><span class="line">a.featureCoordSys),<span class="keyword">this</span>.addCoordSys(b.filtercoordsys,a.filterCoordSys)):<span class="keyword">this</span>.request=<span class="literal">null</span>;OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">parseEnvelope</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b&amp;&amp;<span class="number">4</span>==b.length&amp;&amp;(a.minx=b[<span class="number">0</span>],a.miny=b[<span class="number">1</span>],a.maxx=b[<span class="number">2</span>],a.maxy=b[<span class="number">3</span>])&#125;,<span class="attr">addLayers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=b.length;c&lt;d;c++)a.push(b[c])&#125;,<span class="attr">addImageSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="literal">null</span>!==b&amp;&amp;(a.width=b.w,a.height=b.h,a.printwidth=b.w,a.printheight=b.h)&#125;,<span class="attr">addCoordSys</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> b?(a.id=<span class="built_in">parseInt</span>(b),a.string=b):<span class="string">"object"</span>==<span class="keyword">typeof</span> b&amp;&amp;</span><br><span class="line"><span class="literal">null</span>!==b.proj&amp;&amp;(a.id=b.proj.srsProjNumber,a.string=b.proj.srsCode)&#125;,<span class="attr">iserror</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;a?(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]),a=a.documentElement.getElementsByTagName(<span class="string">"ERROR"</span>),b=<span class="literal">null</span>!==a&amp;&amp;<span class="number">0</span>&lt;a.length):b=<span class="string">""</span>!==<span class="keyword">this</span>.response.error;<span class="keyword">return</span> b&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));<span class="keyword">var</span> b=<span class="literal">null</span>;a&amp;&amp;a.documentElement&amp;&amp;(b=<span class="string">"ARCXML"</span>==a.documentElement.nodeName?a.documentElement:a.documentElement.getElementsByTagName(<span class="string">"ARCXML"</span>)[<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">if</span>(!b||<span class="string">"parsererror"</span>===b.firstChild.nodeName)&#123;<span class="keyword">var</span> c,d;<span class="keyword">try</span>&#123;c=a.firstChild.nodeValue,d=a.firstChild.childNodes[<span class="number">1</span>].firstChild.nodeValue&#125;<span class="keyword">catch</span>(e)&#123;&#125;<span class="keyword">throw</span>&#123;<span class="attr">message</span>:<span class="string">"Error parsing the ArcXML request"</span>,<span class="attr">error</span>:c,<span class="attr">source</span>:d&#125;;&#125;<span class="keyword">return</span> <span class="keyword">this</span>.parseResponse(b)&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a||(a=<span class="keyword">this</span>.request);<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"ARCXML"</span>);b.setAttribute(<span class="string">"version"</span>,<span class="string">"1.1"</span>);<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"REQUEST"</span>);<span class="keyword">if</span>(<span class="literal">null</span>!=a.get_image)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"GET_IMAGE"</span>);c.appendChild(d);<span class="keyword">var</span> e=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,</span><br><span class="line"><span class="string">"PROPERTIES"</span>);d.appendChild(e);a=a.get_image.properties;<span class="literal">null</span>!=a.featurecoordsys&amp;&amp;(d=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"FEATURECOORDSYS"</span>),e.appendChild(d),<span class="number">0</span>===a.featurecoordsys.id?d.setAttribute(<span class="string">"string"</span>,a.featurecoordsys.string):d.setAttribute(<span class="string">"id"</span>,a.featurecoordsys.id));<span class="literal">null</span>!=a.filtercoordsys&amp;&amp;(d=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"FILTERCOORDSYS"</span>),e.appendChild(d),<span class="number">0</span>===a.filtercoordsys.id?d.setAttribute(<span class="string">"string"</span>,a.filtercoordsys.string):d.setAttribute(<span class="string">"id"</span>,a.filtercoordsys.id));<span class="literal">null</span>!=a.envelope&amp;&amp;(d=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,</span><br><span class="line"><span class="string">"ENVELOPE"</span>),e.appendChild(d),d.setAttribute(<span class="string">"minx"</span>,a.envelope.minx),d.setAttribute(<span class="string">"miny"</span>,a.envelope.miny),d.setAttribute(<span class="string">"maxx"</span>,a.envelope.maxx),d.setAttribute(<span class="string">"maxy"</span>,a.envelope.maxy));d=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"IMAGESIZE"</span>);e.appendChild(d);d.setAttribute(<span class="string">"height"</span>,a.imagesize.height);d.setAttribute(<span class="string">"width"</span>,a.imagesize.width);<span class="keyword">if</span>(a.imagesize.height!=a.imagesize.printheight||a.imagesize.width!=a.imagesize.printwidth)d.setAttribute(<span class="string">"printheight"</span>,a.imagesize.printheight),d.setArrtibute(<span class="string">"printwidth"</span>,a.imagesize.printwidth);</span><br><span class="line"><span class="literal">null</span>!=a.background&amp;&amp;(d=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"BACKGROUND"</span>),e.appendChild(d),d.setAttribute(<span class="string">"color"</span>,a.background.color.r+<span class="string">","</span>+a.background.color.g+<span class="string">","</span>+a.background.color.b),<span class="literal">null</span>!==a.background.transcolor&amp;&amp;d.setAttribute(<span class="string">"transcolor"</span>,a.background.transcolor.r+<span class="string">","</span>+a.background.transcolor.g+<span class="string">","</span>+a.background.transcolor.b));<span class="keyword">if</span>(<span class="literal">null</span>!=a.layerlist&amp;&amp;<span class="number">0</span>&lt;a.layerlist.length)<span class="keyword">for</span>(d=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"LAYERLIST"</span>),e.appendChild(d),e=<span class="number">0</span>;e&lt;a.layerlist.length;e++)&#123;<span class="keyword">var</span> f=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"LAYERDEF"</span>);d.appendChild(f);</span><br><span class="line">f.setAttribute(<span class="string">"id"</span>,a.layerlist[e].id);f.setAttribute(<span class="string">"visible"</span>,a.layerlist[e].visible);<span class="keyword">if</span>(<span class="string">"object"</span>==<span class="keyword">typeof</span> a.layerlist[e].query)&#123;<span class="keyword">var</span> g=a.layerlist[e].query;<span class="keyword">if</span>(<span class="number">0</span>&gt;g.where.length)<span class="keyword">continue</span>;<span class="keyword">var</span> h=<span class="literal">null</span>,h=<span class="string">"boolean"</span>==<span class="keyword">typeof</span> g.spatialfilter&amp;&amp;g.spatialfilter?<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"SPATIALQUERY"</span>):<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"QUERY"</span>);h.setAttribute(<span class="string">"where"</span>,g.where);<span class="string">"number"</span>==<span class="keyword">typeof</span> g.accuracy&amp;&amp;<span class="number">0</span>&lt;g.accuracy&amp;&amp;h.setAttribute(<span class="string">"accuracy"</span>,g.accuracy);<span class="string">"number"</span>==<span class="keyword">typeof</span> g.featurelimit&amp;&amp;<span class="number">2E3</span>&gt;g.featurelimit&amp;&amp;h.setAttribute(<span class="string">"featurelimit"</span>,</span><br><span class="line">g.featurelimit);<span class="string">"string"</span>==<span class="keyword">typeof</span> g.subfields&amp;&amp;<span class="string">"#ALL#"</span>!=g.subfields&amp;&amp;h.setAttribute(<span class="string">"subfields"</span>,g.subfields);<span class="string">"string"</span>==<span class="keyword">typeof</span> g.joinexpression&amp;&amp;<span class="number">0</span>&lt;g.joinexpression.length&amp;&amp;h.setAttribute(<span class="string">"joinexpression"</span>,g.joinexpression);<span class="string">"string"</span>==<span class="keyword">typeof</span> g.jointables&amp;&amp;<span class="number">0</span>&lt;g.jointables.length&amp;&amp;h.setAttribute(<span class="string">"jointables"</span>,g.jointables);f.appendChild(h)&#125;<span class="string">"object"</span>==<span class="keyword">typeof</span> a.layerlist[e].renderer&amp;&amp;<span class="keyword">this</span>.addRenderer(f,a.layerlist[e].renderer)&#125;&#125;<span class="keyword">else</span> <span class="literal">null</span>!=a.get_feature&amp;&amp;(d=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"GET_FEATURES"</span>),d.setAttribute(<span class="string">"outputmode"</span>,</span><br><span class="line"><span class="string">"newxml"</span>),d.setAttribute(<span class="string">"checkesc"</span>,<span class="string">"true"</span>),a.get_feature.geometry?d.setAttribute(<span class="string">"geometry"</span>,a.get_feature.geometry):d.setAttribute(<span class="string">"geometry"</span>,<span class="string">"false"</span>),a.get_feature.compact&amp;&amp;d.setAttribute(<span class="string">"compact"</span>,a.get_feature.compact),<span class="string">"number"</span>==a.get_feature.featurelimit&amp;&amp;d.setAttribute(<span class="string">"featurelimit"</span>,a.get_feature.featurelimit),d.setAttribute(<span class="string">"globalenvelope"</span>,<span class="string">"true"</span>),c.appendChild(d),<span class="literal">null</span>!=a.get_feature.layer&amp;&amp;<span class="number">0</span>&lt;a.get_feature.layer.length&amp;&amp;(e=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"LAYER"</span>),e.setAttribute(<span class="string">"id"</span>,a.get_feature.layer),</span><br><span class="line">d.appendChild(e)),a=a.get_feature.query,<span class="literal">null</span>!=a&amp;&amp;(e=<span class="literal">null</span>,e=a.isspatial?<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"SPATIALQUERY"</span>):<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"QUERY"</span>),d.appendChild(e),<span class="string">"number"</span>==<span class="keyword">typeof</span> a.accuracy&amp;&amp;e.setAttribute(<span class="string">"accuracy"</span>,a.accuracy),<span class="literal">null</span>!=a.featurecoordsys&amp;&amp;(d=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"FEATURECOORDSYS"</span>),<span class="number">0</span>==a.featurecoordsys.id?d.setAttribute(<span class="string">"string"</span>,a.featurecoordsys.string):d.setAttribute(<span class="string">"id"</span>,a.featurecoordsys.id),e.appendChild(d)),<span class="literal">null</span>!=a.filtercoordsys&amp;&amp;(d=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"FILTERCOORDSYS"</span>),</span><br><span class="line"><span class="number">0</span>===a.filtercoordsys.id?d.setAttribute(<span class="string">"string"</span>,a.filtercoordsys.string):d.setAttribute(<span class="string">"id"</span>,a.filtercoordsys.id),e.appendChild(d)),<span class="number">0</span>&lt;a.buffer&amp;&amp;(d=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"BUFFER"</span>),d.setAttribute(<span class="string">"distance"</span>,a.buffer),e.appendChild(d)),a.isspatial&amp;&amp;(d=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"SPATIALFILTER"</span>),d.setAttribute(<span class="string">"relation"</span>,a.spatialfilter.relation),e.appendChild(d),a.spatialfilter.envelope?(f=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"ENVELOPE"</span>),f.setAttribute(<span class="string">"minx"</span>,a.spatialfilter.envelope.minx),f.setAttribute(<span class="string">"miny"</span>,a.spatialfilter.envelope.miny),</span><br><span class="line">f.setAttribute(<span class="string">"maxx"</span>,a.spatialfilter.envelope.maxx),f.setAttribute(<span class="string">"maxy"</span>,a.spatialfilter.envelope.maxy),d.appendChild(f)):<span class="string">"object"</span>==<span class="keyword">typeof</span> a.spatialfilter.polygon&amp;&amp;d.appendChild(<span class="keyword">this</span>.writePolygonGeometry(a.spatialfilter.polygon))),<span class="literal">null</span>!=a.where&amp;&amp;<span class="number">0</span>&lt;a.where.length&amp;&amp;e.setAttribute(<span class="string">"where"</span>,a.where)));b.appendChild(c);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[b])&#125;,<span class="attr">addGroupRenderer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"GROUPRENDERER"</span>);a.appendChild(c);<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>;d&lt;b.length;d++)<span class="keyword">this</span>.addRenderer(c,</span><br><span class="line">b[d])&#125;,<span class="attr">addRenderer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(OpenLayers.Util.isArray(b))<span class="keyword">this</span>.addGroupRenderer(a,b);<span class="keyword">else</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,b.type.toUpperCase()+<span class="string">"RENDERER"</span>);a.appendChild(c);<span class="string">"VALUEMAPRENDERER"</span>==c.tagName?<span class="keyword">this</span>.addValueMapRenderer(c,b):<span class="string">"VALUEMAPLABELRENDERER"</span>==c.tagName?<span class="keyword">this</span>.addValueMapLabelRenderer(c,b):<span class="string">"SIMPLELABELRENDERER"</span>==c.tagName?<span class="keyword">this</span>.addSimpleLabelRenderer(c,b):<span class="string">"SCALEDEPENDENTRENDERER"</span>==c.tagName&amp;&amp;<span class="keyword">this</span>.addScaleDependentRenderer(c,b)&#125;&#125;,<span class="attr">addScaleDependentRenderer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="string">"string"</span>!=<span class="keyword">typeof</span> b.lower&amp;&amp;</span><br><span class="line"><span class="string">"number"</span>!=<span class="keyword">typeof</span> b.lower||a.setAttribute(<span class="string">"lower"</span>,b.lower);<span class="string">"string"</span>!=<span class="keyword">typeof</span> b.upper&amp;&amp;<span class="string">"number"</span>!=<span class="keyword">typeof</span> b.upper||a.setAttribute(<span class="string">"upper"</span>,b.upper);<span class="keyword">this</span>.addRenderer(a,b.renderer)&#125;,<span class="attr">addValueMapLabelRenderer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.setAttribute(<span class="string">"lookupfield"</span>,b.lookupfield);a.setAttribute(<span class="string">"labelfield"</span>,b.labelfield);<span class="keyword">if</span>(<span class="string">"object"</span>==<span class="keyword">typeof</span> b.exacts)<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=b.exacts.length;c&lt;d;c++)&#123;<span class="keyword">var</span> e=b.exacts[c],f=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"EXACT"</span>);<span class="string">"string"</span>==<span class="keyword">typeof</span> e.value&amp;&amp;f.setAttribute(<span class="string">"value"</span>,e.value);<span class="string">"string"</span>==<span class="keyword">typeof</span> e.label&amp;&amp;</span><br><span class="line">f.setAttribute(<span class="string">"label"</span>,e.label);<span class="string">"string"</span>==<span class="keyword">typeof</span> e.method&amp;&amp;f.setAttribute(<span class="string">"method"</span>,e.method);a.appendChild(f);<span class="keyword">if</span>(<span class="string">"object"</span>==<span class="keyword">typeof</span> e.symbol)&#123;<span class="keyword">var</span> g=<span class="literal">null</span>;<span class="string">"text"</span>==e.symbol.type&amp;&amp;(g=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"TEXTSYMBOL"</span>));<span class="keyword">if</span>(<span class="literal">null</span>!=g)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> h=<span class="keyword">this</span>.fontStyleKeys,k=<span class="number">0</span>,l=h.length;k&lt;l;k++)&#123;<span class="keyword">var</span> m=h[k];e.symbol[m]&amp;&amp;g.setAttribute(m,e.symbol[m])&#125;f.appendChild(g)&#125;&#125;&#125;&#125;,<span class="attr">addValueMapRenderer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.setAttribute(<span class="string">"lookupfield"</span>,b.lookupfield);<span class="keyword">if</span>(<span class="string">"object"</span>==<span class="keyword">typeof</span> b.ranges)<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=b.ranges.length;c&lt;d;c++)&#123;<span class="keyword">var</span> e=</span><br><span class="line">b.ranges[c],f=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"RANGE"</span>);f.setAttribute(<span class="string">"lower"</span>,e.lower);f.setAttribute(<span class="string">"upper"</span>,e.upper);a.appendChild(f);<span class="keyword">if</span>(<span class="string">"object"</span>==<span class="keyword">typeof</span> e.symbol)&#123;<span class="keyword">var</span> g=<span class="literal">null</span>;<span class="string">"simplepolygon"</span>==e.symbol.type&amp;&amp;(g=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"SIMPLEPOLYGONSYMBOL"</span>));<span class="literal">null</span>!=g&amp;&amp;(<span class="string">"string"</span>==<span class="keyword">typeof</span> e.symbol.boundarycolor&amp;&amp;g.setAttribute(<span class="string">"boundarycolor"</span>,e.symbol.boundarycolor),<span class="string">"string"</span>==<span class="keyword">typeof</span> e.symbol.fillcolor&amp;&amp;g.setAttribute(<span class="string">"fillcolor"</span>,e.symbol.fillcolor),<span class="string">"number"</span>==<span class="keyword">typeof</span> e.symbol.filltransparency&amp;&amp;g.setAttribute(<span class="string">"filltransparency"</span>,</span><br><span class="line">e.symbol.filltransparency),f.appendChild(g))&#125;&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"object"</span>==<span class="keyword">typeof</span> b.exacts)<span class="keyword">for</span>(c=<span class="number">0</span>,d=b.exacts.length;c&lt;d;c++)e=b.exacts[c],f=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"EXACT"</span>),<span class="string">"string"</span>==<span class="keyword">typeof</span> e.value&amp;&amp;f.setAttribute(<span class="string">"value"</span>,e.value),<span class="string">"string"</span>==<span class="keyword">typeof</span> e.label&amp;&amp;f.setAttribute(<span class="string">"label"</span>,e.label),<span class="string">"string"</span>==<span class="keyword">typeof</span> e.method&amp;&amp;f.setAttribute(<span class="string">"method"</span>,e.method),a.appendChild(f),<span class="string">"object"</span>==<span class="keyword">typeof</span> e.symbol&amp;&amp;(g=<span class="literal">null</span>,<span class="string">"simplemarker"</span>==e.symbol.type&amp;&amp;(g=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"SIMPLEMARKERSYMBOL"</span>)),<span class="literal">null</span>!=g&amp;&amp;(<span class="string">"string"</span>==<span class="keyword">typeof</span> e.symbol.antialiasing&amp;&amp;</span><br><span class="line">g.setAttribute(<span class="string">"antialiasing"</span>,e.symbol.antialiasing),<span class="string">"string"</span>==<span class="keyword">typeof</span> e.symbol.color&amp;&amp;g.setAttribute(<span class="string">"color"</span>,e.symbol.color),<span class="string">"string"</span>==<span class="keyword">typeof</span> e.symbol.outline&amp;&amp;g.setAttribute(<span class="string">"outline"</span>,e.symbol.outline),<span class="string">"string"</span>==<span class="keyword">typeof</span> e.symbol.overlap&amp;&amp;g.setAttribute(<span class="string">"overlap"</span>,e.symbol.overlap),<span class="string">"string"</span>==<span class="keyword">typeof</span> e.symbol.shadow&amp;&amp;g.setAttribute(<span class="string">"shadow"</span>,e.symbol.shadow),<span class="string">"number"</span>==<span class="keyword">typeof</span> e.symbol.transparency&amp;&amp;g.setAttribute(<span class="string">"transparency"</span>,e.symbol.transparency),<span class="string">"string"</span>==<span class="keyword">typeof</span> e.symbol.usecentroid&amp;&amp;g.setAttribute(<span class="string">"usecentroid"</span>,</span><br><span class="line">e.symbol.usecentroid),<span class="string">"number"</span>==<span class="keyword">typeof</span> e.symbol.width&amp;&amp;g.setAttribute(<span class="string">"width"</span>,e.symbol.width),f.appendChild(g)))&#125;,<span class="attr">addSimpleLabelRenderer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.setAttribute(<span class="string">"field"</span>,b.field);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="string">"featureweight howmanylabels labelbufferratio labelpriorities labelweight linelabelposition rotationalangles"</span>.split(<span class="string">" "</span>),d=<span class="number">0</span>,e=c.length;d&lt;e;d++)&#123;<span class="keyword">var</span> f=c[d];b[f]&amp;&amp;a.setAttribute(f,b[f])&#125;<span class="keyword">if</span>(<span class="string">"text"</span>==b.symbol.type)&#123;<span class="keyword">var</span> g=b.symbol,h=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"TEXTSYMBOL"</span>);a.appendChild(h);c=<span class="keyword">this</span>.fontStyleKeys;d=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(e=c.length;d&lt;e;d++)f=c[d],g[f]&amp;&amp;h.setAttribute(f,b[f])&#125;&#125;,<span class="attr">writePolygonGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!(a <span class="keyword">instanceof</span> OpenLayers.Geometry.Polygon))<span class="keyword">throw</span>&#123;<span class="attr">message</span>:<span class="string">"Cannot write polygon geometry to ArcXML with an "</span>+a.CLASS_NAME+<span class="string">" object."</span>,<span class="attr">geometry</span>:a&#125;;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"POLYGON"</span>),c=<span class="number">0</span>,d=a.components.length;c&lt;d;c++)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> e=a.components[c],f=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"RING"</span>),g=<span class="number">0</span>,h=e.components.length;g&lt;h;g++)&#123;<span class="keyword">var</span> k=e.components[g],l=<span class="keyword">this</span>.createElementNS(<span class="string">""</span>,<span class="string">"POINT"</span>);l.setAttribute(<span class="string">"x"</span>,k.x);l.setAttribute(<span class="string">"y"</span>,</span><br><span class="line">k.y);f.appendChild(l)&#125;b.appendChild(f)&#125;<span class="keyword">return</span> b&#125;,<span class="attr">parseResponse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=(<span class="keyword">new</span> OpenLayers.Format.XML).read(a));<span class="keyword">var</span> b=<span class="keyword">new</span> OpenLayers.Format.ArcXML.Response,c=a.getElementsByTagName(<span class="string">"ERROR"</span>);<span class="keyword">if</span>(<span class="literal">null</span>!=c&amp;&amp;<span class="number">0</span>&lt;c.length)b.error=<span class="keyword">this</span>.getChildValue(c,<span class="string">"Unknown error."</span>);<span class="keyword">else</span>&#123;c=a.getElementsByTagName(<span class="string">"RESPONSE"</span>);<span class="keyword">if</span>(<span class="literal">null</span>==c||<span class="number">0</span>==c.length)<span class="keyword">return</span> b.error=<span class="string">"No RESPONSE tag found in ArcXML response."</span>,b;<span class="keyword">var</span> d=c[<span class="number">0</span>].firstChild.nodeName;<span class="string">"#text"</span>==d&amp;&amp;(d=c[<span class="number">0</span>].firstChild.nextSibling.nodeName);<span class="keyword">if</span>(<span class="string">"IMAGE"</span>==</span><br><span class="line">d)c=a.getElementsByTagName(<span class="string">"ENVELOPE"</span>),a=a.getElementsByTagName(<span class="string">"OUTPUT"</span>),<span class="literal">null</span>==c||<span class="number">0</span>==c.length?b.error=<span class="string">"No ENVELOPE tag found in ArcXML response."</span>:<span class="literal">null</span>==a||<span class="number">0</span>==a.length?b.error=<span class="string">"No OUTPUT tag found in ArcXML response."</span>:(c=<span class="keyword">this</span>.parseAttributes(c[<span class="number">0</span>]),d=<span class="keyword">this</span>.parseAttributes(a[<span class="number">0</span>]),b.image=<span class="string">"string"</span>==<span class="keyword">typeof</span> d.type?&#123;<span class="attr">envelope</span>:c,<span class="attr">output</span>:&#123;<span class="attr">type</span>:d.type,<span class="attr">data</span>:<span class="keyword">this</span>.getChildValue(a[<span class="number">0</span>])&#125;&#125;:&#123;<span class="attr">envelope</span>:c,<span class="attr">output</span>:d&#125;);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"FEATURES"</span>==d)&#123;<span class="keyword">if</span>(a=c[<span class="number">0</span>].getElementsByTagName(<span class="string">"FEATURES"</span>),c=a[<span class="number">0</span>].getElementsByTagName(<span class="string">"FEATURECOUNT"</span>),</span><br><span class="line">b.features.featurecount=c[<span class="number">0</span>].getAttribute(<span class="string">"count"</span>),<span class="number">0</span>&lt;b.features.featurecount)<span class="keyword">for</span>(c=a[<span class="number">0</span>].getElementsByTagName(<span class="string">"ENVELOPE"</span>),b.features.envelope=<span class="keyword">this</span>.parseAttributes(c[<span class="number">0</span>],<span class="string">"number"</span>),a=a[<span class="number">0</span>].getElementsByTagName(<span class="string">"FEATURE"</span>),c=<span class="number">0</span>;c&lt;a.length;c++)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="keyword">new</span> OpenLayers.Feature.Vector,e=a[c].getElementsByTagName(<span class="string">"FIELD"</span>),f=<span class="number">0</span>;f&lt;e.length;f++)&#123;<span class="keyword">var</span> g=e[f].getAttribute(<span class="string">"name"</span>),h=e[f].getAttribute(<span class="string">"value"</span>);d.attributes[g]=h&#125;e=a[c].getElementsByTagName(<span class="string">"POLYGON"</span>);<span class="keyword">if</span>(<span class="number">0</span>&lt;e.length)&#123;e=e[<span class="number">0</span>].getElementsByTagName(<span class="string">"RING"</span>);</span><br><span class="line">f=[];<span class="keyword">for</span>(g=<span class="number">0</span>;g&lt;e.length;g++)&#123;h=[];h.push(<span class="keyword">this</span>.parsePointGeometry(e[g]));<span class="keyword">for</span>(<span class="keyword">var</span> k=e[g].getElementsByTagName(<span class="string">"HOLE"</span>),l=<span class="number">0</span>;l&lt;k.length;l++)h.push(<span class="keyword">this</span>.parsePointGeometry(k[l]));f.push(<span class="keyword">new</span> OpenLayers.Geometry.Polygon(h))&#125;d.geometry=<span class="number">1</span>==f.length?f[<span class="number">0</span>]:<span class="keyword">new</span> OpenLayers.Geometry.MultiPolygon(f)&#125;b.features.feature.push(d)&#125;&#125;<span class="keyword">else</span> b.error=<span class="string">"Unidentified response type."</span>&#125;<span class="keyword">return</span> b&#125;,<span class="attr">parseAttributes</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=&#123;&#125;,d=<span class="number">0</span>;d&lt;a.attributes.length;d++)c[a.attributes[d].nodeName]=<span class="string">"number"</span>==b?<span class="built_in">parseFloat</span>(a.attributes[d].nodeValue):</span><br><span class="line">a.attributes[d].nodeValue;<span class="keyword">return</span> c&#125;,<span class="attr">parsePointGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=[],c=a.getElementsByTagName(<span class="string">"COORDS"</span>);<span class="keyword">if</span>(<span class="number">0</span>&lt;c.length)<span class="keyword">for</span>(a=<span class="keyword">this</span>.getChildValue(c[<span class="number">0</span>]),a=a.split(<span class="regexp">/;/</span>),c=<span class="number">0</span>;c&lt;a.length;c++)&#123;<span class="keyword">var</span> d=a[c].split(<span class="regexp">/ /</span>);b.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(d[<span class="number">0</span>],d[<span class="number">1</span>]))&#125;<span class="keyword">else</span> <span class="keyword">if</span>(a=a.getElementsByTagName(<span class="string">"POINT"</span>),<span class="number">0</span>&lt;a.length)<span class="keyword">for</span>(c=<span class="number">0</span>;c&lt;a.length;c++)b.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="built_in">parseFloat</span>(a[c].getAttribute(<span class="string">"x"</span>)),<span class="built_in">parseFloat</span>(a[c].getAttribute(<span class="string">"y"</span>))));<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.LinearRing(b)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.ArcXML"</span>&#125;);</span><br><span class="line">OpenLayers.Format.ArcXML.Request=OpenLayers.Class(&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Util.extend(<span class="keyword">this</span>,&#123;<span class="attr">get_image</span>:&#123;<span class="attr">properties</span>:&#123;<span class="attr">background</span>:<span class="literal">null</span>,<span class="attr">draw</span>:!<span class="number">0</span>,<span class="attr">envelope</span>:&#123;<span class="attr">minx</span>:<span class="number">0</span>,<span class="attr">miny</span>:<span class="number">0</span>,<span class="attr">maxx</span>:<span class="number">0</span>,<span class="attr">maxy</span>:<span class="number">0</span>&#125;,<span class="attr">featurecoordsys</span>:&#123;<span class="attr">id</span>:<span class="number">0</span>,<span class="attr">string</span>:<span class="string">""</span>,<span class="attr">datumtransformid</span>:<span class="number">0</span>,<span class="attr">datumtransformstring</span>:<span class="string">""</span>&#125;,<span class="attr">filtercoordsys</span>:&#123;<span class="attr">id</span>:<span class="number">0</span>,<span class="attr">string</span>:<span class="string">""</span>,<span class="attr">datumtransformid</span>:<span class="number">0</span>,<span class="attr">datumtransformstring</span>:<span class="string">""</span>&#125;,<span class="attr">imagesize</span>:&#123;<span class="attr">height</span>:<span class="number">0</span>,<span class="attr">width</span>:<span class="number">0</span>,<span class="attr">dpi</span>:<span class="number">96</span>,<span class="attr">printheight</span>:<span class="number">0</span>,<span class="attr">printwidth</span>:<span class="number">0</span>,<span class="attr">scalesymbols</span>:!<span class="number">1</span>&#125;,<span class="attr">layerlist</span>:[],<span class="attr">output</span>:&#123;<span class="attr">baseurl</span>:<span class="string">""</span>,<span class="attr">legendbaseurl</span>:<span class="string">""</span>,<span class="attr">legendname</span>:<span class="string">""</span>,<span class="attr">legendpath</span>:<span class="string">""</span>,</span><br><span class="line">legendurl:<span class="string">""</span>,<span class="attr">name</span>:<span class="string">""</span>,<span class="attr">path</span>:<span class="string">""</span>,<span class="attr">type</span>:<span class="string">"jpg"</span>,<span class="attr">url</span>:<span class="string">""</span>&#125;&#125;&#125;,<span class="attr">get_feature</span>:&#123;<span class="attr">layer</span>:<span class="string">""</span>,<span class="attr">query</span>:&#123;<span class="attr">isspatial</span>:!<span class="number">1</span>,<span class="attr">featurecoordsys</span>:&#123;<span class="attr">id</span>:<span class="number">0</span>,<span class="attr">string</span>:<span class="string">""</span>,<span class="attr">datumtransformid</span>:<span class="number">0</span>,<span class="attr">datumtransformstring</span>:<span class="string">""</span>&#125;,<span class="attr">filtercoordsys</span>:&#123;<span class="attr">id</span>:<span class="number">0</span>,<span class="attr">string</span>:<span class="string">""</span>,<span class="attr">datumtransformid</span>:<span class="number">0</span>,<span class="attr">datumtransformstring</span>:<span class="string">""</span>&#125;,<span class="attr">buffer</span>:<span class="number">0</span>,<span class="attr">where</span>:<span class="string">""</span>,<span class="attr">spatialfilter</span>:&#123;<span class="attr">relation</span>:<span class="string">"envelope_intersection"</span>,<span class="attr">envelope</span>:<span class="literal">null</span>&#125;&#125;&#125;,<span class="attr">environment</span>:&#123;<span class="attr">separators</span>:&#123;<span class="attr">cs</span>:<span class="string">" "</span>,<span class="attr">ts</span>:<span class="string">";"</span>&#125;&#125;,<span class="attr">layer</span>:[],<span class="attr">workspaces</span>:[]&#125;)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.ArcXML.Request"</span>&#125;);</span><br><span class="line">OpenLayers.Format.ArcXML.Response=OpenLayers.Class(&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Util.extend(<span class="keyword">this</span>,&#123;<span class="attr">image</span>:&#123;<span class="attr">envelope</span>:<span class="literal">null</span>,<span class="attr">output</span>:<span class="string">""</span>&#125;,<span class="attr">features</span>:&#123;<span class="attr">featurecount</span>:<span class="number">0</span>,<span class="attr">envelope</span>:<span class="literal">null</span>,<span class="attr">feature</span>:[]&#125;,<span class="attr">error</span>:<span class="string">""</span>&#125;)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.ArcXML.Response"</span>&#125;);(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>._object=f&amp;&amp;!k?<span class="keyword">new</span> f:<span class="keyword">new</span> <span class="built_in">window</span>.ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);<span class="keyword">this</span>._listeners=[]&#125;<span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> a&#125;<span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params">a</span>)</span>&#123;b.onreadystatechange&amp;&amp;b.onreadystatechange.apply(a);a.dispatchEvent(&#123;<span class="attr">type</span>:<span class="string">"readystatechange"</span>,<span class="attr">bubbles</span>:!<span class="number">1</span>,<span class="attr">cancelable</span>:!<span class="number">1</span>,<span class="attr">timeStamp</span>:<span class="keyword">new</span> <span class="built_in">Date</span>+<span class="number">0</span>&#125;)&#125;<span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">try</span>&#123;a.responseText=a._object.responseText&#125;<span class="keyword">catch</span>(b)&#123;&#125;<span class="keyword">try</span>&#123;<span class="keyword">var</span> c;<span class="keyword">var</span> d=a._object,e=d.responseXML,f=d.responseText;h&amp;&amp;(f&amp;&amp;e&amp;&amp;!e.documentElement&amp;&amp;d.getResponseHeader(<span class="string">"Content-Type"</span>).match(<span class="regexp">/[^\/]+\/[^\+]+\+xml/</span>))&amp;&amp;</span><br><span class="line">(e=<span class="keyword">new</span> <span class="built_in">window</span>.ActiveXObject(<span class="string">"Microsoft.XMLDOM"</span>),e.async=!<span class="number">1</span>,e.validateOnParse=!<span class="number">1</span>,e.loadXML(f));c=e&amp;&amp;(h&amp;&amp;<span class="number">0</span>!=e.parseError||!e.documentElement||e.documentElement&amp;&amp;<span class="string">"parsererror"</span>==e.documentElement.tagName)?<span class="literal">null</span>:e;a.responseXML=c&#125;<span class="keyword">catch</span>(g)&#123;&#125;<span class="keyword">try</span>&#123;a.status=a._object.status&#125;<span class="keyword">catch</span>(k)&#123;&#125;<span class="keyword">try</span>&#123;a.statusText=a._object.statusText&#125;<span class="keyword">catch</span>(u)&#123;&#125;&#125;<span class="function"><span class="keyword">function</span> <span class="title">e</span>(<span class="params">a</span>)</span>&#123;a._object.onreadystatechange=<span class="keyword">new</span> <span class="built_in">window</span>.Function&#125;<span class="keyword">var</span> f=<span class="built_in">window</span>.XMLHttpRequest,g=!!<span class="built_in">window</span>.controllers,h=<span class="built_in">window</span>.document.all&amp;&amp;!<span class="built_in">window</span>.opera,k=h&amp;&amp;<span class="built_in">window</span>.navigator.userAgent.match(<span class="regexp">/MSIE 7.0/</span>);</span><br><span class="line">b.prototype=a.prototype;g&amp;&amp;f.wrapped&amp;&amp;(b.wrapped=f.wrapped);b.UNSENT=<span class="number">0</span>;b.OPENED=<span class="number">1</span>;b.HEADERS_RECEIVED=<span class="number">2</span>;b.LOADING=<span class="number">3</span>;b.DONE=<span class="number">4</span>;b.prototype.readyState=b.UNSENT;b.prototype.responseText=<span class="string">""</span>;b.prototype.responseXML=<span class="literal">null</span>;b.prototype.status=<span class="number">0</span>;b.prototype.statusText=<span class="string">""</span>;b.prototype.priority=<span class="string">"NORMAL"</span>;b.prototype.onreadystatechange=<span class="literal">null</span>;b.onreadystatechange=<span class="literal">null</span>;b.onopen=<span class="literal">null</span>;b.onsend=<span class="literal">null</span>;b.onabort=<span class="literal">null</span>;b.prototype.open=<span class="function"><span class="keyword">function</span>(<span class="params">a,f,k,p,q</span>)</span>&#123;<span class="keyword">delete</span> <span class="keyword">this</span>._headers;<span class="number">3</span>&gt;<span class="built_in">arguments</span>.length&amp;&amp;(k=!<span class="number">0</span>);<span class="keyword">this</span>._async=k;<span class="keyword">var</span> r=<span class="keyword">this</span>,</span><br><span class="line">s=<span class="keyword">this</span>.readyState,t;h&amp;&amp;k&amp;&amp;(t=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;s!=b.DONE&amp;&amp;(e(r),r.abort())&#125;,<span class="built_in">window</span>.attachEvent(<span class="string">"onunload"</span>,t));b.onopen&amp;&amp;b.onopen.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="number">4</span>&lt;<span class="built_in">arguments</span>.length?<span class="keyword">this</span>._object.open(a,f,k,p,q):<span class="number">3</span>&lt;<span class="built_in">arguments</span>.length?<span class="keyword">this</span>._object.open(a,f,k,p):<span class="keyword">this</span>._object.open(a,f,k);<span class="keyword">this</span>.readyState=b.OPENED;c(<span class="keyword">this</span>);<span class="keyword">this</span>._object.onreadystatechange=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!g||k)r.readyState=r._object.readyState,d(r),r._aborted?r.readyState=b.UNSENT:(r.readyState==b.DONE&amp;&amp;(<span class="keyword">delete</span> r._data,e(r),h&amp;&amp;k&amp;&amp;<span class="built_in">window</span>.detachEvent(<span class="string">"onunload"</span>,t)),</span><br><span class="line">s!=r.readyState&amp;&amp;c(r),s=r.readyState)&#125;&#125;;b.prototype.send=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;b.onsend&amp;&amp;b.onsend.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="built_in">arguments</span>.length||(a=<span class="literal">null</span>);a&amp;&amp;a.nodeType&amp;&amp;(a=<span class="built_in">window</span>.XMLSerializer?(<span class="keyword">new</span> <span class="built_in">window</span>.XMLSerializer).serializeToString(a):a.xml,<span class="keyword">this</span>._headers[<span class="string">"Content-Type"</span>]||<span class="keyword">this</span>._object.setRequestHeader(<span class="string">"Content-Type"</span>,<span class="string">"application/xml"</span>));<span class="keyword">this</span>._data=a;a:<span class="keyword">if</span>(<span class="keyword">this</span>._object.send(<span class="keyword">this</span>._data),g&amp;&amp;!<span class="keyword">this</span>._async)<span class="keyword">for</span>(<span class="keyword">this</span>.readyState=b.OPENED,d(<span class="keyword">this</span>);<span class="keyword">this</span>.readyState&lt;b.DONE;)<span class="keyword">if</span>(<span class="keyword">this</span>.readyState++,c(<span class="keyword">this</span>),<span class="keyword">this</span>._aborted)<span class="keyword">break</span> a&#125;;</span><br><span class="line">b.prototype.abort=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;b.onabort&amp;&amp;b.onabort.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.readyState&gt;b.UNSENT&amp;&amp;(<span class="keyword">this</span>._aborted=!<span class="number">0</span>);<span class="keyword">this</span>._object.abort();e(<span class="keyword">this</span>);<span class="keyword">this</span>.readyState=b.UNSENT;<span class="keyword">delete</span> <span class="keyword">this</span>._data&#125;;b.prototype.getAllResponseHeaders=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>._object.getAllResponseHeaders()&#125;;b.prototype.getResponseHeader=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>._object.getResponseHeader(a)&#125;;b.prototype.setRequestHeader=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>._headers||(<span class="keyword">this</span>._headers=&#123;&#125;);<span class="keyword">this</span>._headers[a]=b;<span class="keyword">return</span> <span class="keyword">this</span>._object.setRequestHeader(a,b)&#125;;</span><br><span class="line">b.prototype.addEventListener=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e;e=<span class="keyword">this</span>._listeners[d];d++)<span class="keyword">if</span>(e[<span class="number">0</span>]==a&amp;&amp;e[<span class="number">1</span>]==b&amp;&amp;e[<span class="number">2</span>]==c)<span class="keyword">return</span>;<span class="keyword">this</span>._listeners.push([a,b,c])&#125;;b.prototype.removeEventListener=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e;(e=<span class="keyword">this</span>._listeners[d])&amp;&amp;(e[<span class="number">0</span>]!=a||e[<span class="number">1</span>]!=b||e[<span class="number">2</span>]!=c);d++);e&amp;&amp;<span class="keyword">this</span>._listeners.splice(d,<span class="number">1</span>)&#125;;b.prototype.dispatchEvent=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=&#123;<span class="attr">type</span>:a.type,<span class="attr">target</span>:<span class="keyword">this</span>,<span class="attr">currentTarget</span>:<span class="keyword">this</span>,<span class="attr">eventPhase</span>:<span class="number">2</span>,<span class="attr">bubbles</span>:a.bubbles,<span class="attr">cancelable</span>:a.cancelable,<span class="attr">timeStamp</span>:a.timeStamp,<span class="attr">stopPropagation</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">preventDefault</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">initEvent:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;&#125;;<span class="string">"readystatechange"</span>==a.type&amp;&amp;<span class="keyword">this</span>.onreadystatechange&amp;&amp;(<span class="keyword">this</span>.onreadystatechange.handleEvent||<span class="keyword">this</span>.onreadystatechange).apply(<span class="keyword">this</span>,[a]);<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c;c=<span class="keyword">this</span>._listeners[b];b++)c[<span class="number">0</span>]!=a.type||c[<span class="number">2</span>]||(c[<span class="number">1</span>].handleEvent||c[<span class="number">1</span>]).apply(<span class="keyword">this</span>,[a])&#125;;b.prototype.toString=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">"[object XMLHttpRequest]"</span>&#125;;b.toString=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">"[XMLHttpRequest]"</span>&#125;;<span class="built_in">window</span>.Function.prototype.apply||(<span class="built_in">window</span>.Function.prototype.apply=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b||(b=[]);a.__func=<span class="keyword">this</span>;a.__func(b[<span class="number">0</span>],b[<span class="number">1</span>],b[<span class="number">2</span>],b[<span class="number">3</span>],</span><br><span class="line">b[<span class="number">4</span>]);<span class="keyword">delete</span> a.__func&#125;);OpenLayers.Request||(OpenLayers.Request=&#123;&#125;);OpenLayers.Request.XMLHttpRequest=b&#125;)();OpenLayers.ProxyHost=<span class="string">""</span>;OpenLayers.Request||(OpenLayers.Request=&#123;&#125;);</span><br><span class="line">OpenLayers.Util.extend(OpenLayers.Request,&#123;<span class="attr">DEFAULT_CONFIG</span>:&#123;<span class="attr">method</span>:<span class="string">"GET"</span>,<span class="attr">url</span>:<span class="built_in">window</span>.location.href,<span class="attr">async</span>:!<span class="number">0</span>,<span class="attr">user</span>:<span class="keyword">void</span> <span class="number">0</span>,<span class="attr">password</span>:<span class="keyword">void</span> <span class="number">0</span>,<span class="attr">params</span>:<span class="literal">null</span>,<span class="attr">proxy</span>:OpenLayers.ProxyHost,<span class="attr">headers</span>:&#123;&#125;,<span class="attr">data</span>:<span class="literal">null</span>,<span class="attr">callback</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">success</span>:<span class="literal">null</span>,<span class="attr">failure</span>:<span class="literal">null</span>,<span class="attr">scope</span>:<span class="literal">null</span>&#125;,<span class="attr">URL_SPLIT_REGEX</span>:<span class="regexp">/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/</span>,<span class="attr">events</span>:<span class="keyword">new</span> OpenLayers.Events(<span class="keyword">this</span>),<span class="attr">makeSameOrigin</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="number">0</span>!==a.indexOf(<span class="string">"http"</span>),d=!c&amp;&amp;a.match(<span class="keyword">this</span>.URL_SPLIT_REGEX);<span class="keyword">if</span>(d)&#123;<span class="keyword">var</span> e=<span class="built_in">window</span>.location,c=d[<span class="number">1</span>]==e.protocol&amp;&amp;d[<span class="number">3</span>]==</span><br><span class="line">e.hostname,d=d[<span class="number">4</span>],e=e.port;<span class="keyword">if</span>(<span class="number">80</span>!=d&amp;&amp;<span class="string">""</span>!=d||<span class="string">"80"</span>!=e&amp;&amp;<span class="string">""</span>!=e)c=c&amp;&amp;d==e&#125;c||b&amp;&amp;(a=<span class="string">"function"</span>==<span class="keyword">typeof</span> b?b(a):b+<span class="built_in">encodeURIComponent</span>(a));<span class="keyword">return</span> a&#125;,<span class="attr">issue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Util.extend(<span class="keyword">this</span>.DEFAULT_CONFIG,&#123;<span class="attr">proxy</span>:OpenLayers.ProxyHost&#125;);a=a||&#123;&#125;;a.headers=a.headers||&#123;&#125;;a=OpenLayers.Util.applyDefaults(a,b);a.headers=OpenLayers.Util.applyDefaults(a.headers,b.headers);<span class="keyword">var</span> b=!<span class="number">1</span>,c;<span class="keyword">for</span>(c <span class="keyword">in</span> a.headers)a.headers.hasOwnProperty(c)&amp;&amp;<span class="string">"x-requested-with"</span>===c.toLowerCase()&amp;&amp;(b=!<span class="number">0</span>);!<span class="number">1</span>===b&amp;&amp;(a.headers[<span class="string">"X-Requested-With"</span>]=</span><br><span class="line"><span class="string">"XMLHttpRequest"</span>);<span class="keyword">var</span> d=<span class="keyword">new</span> OpenLayers.Request.XMLHttpRequest,e=OpenLayers.Util.urlAppend(a.url,OpenLayers.Util.getParameterString(a.params||&#123;&#125;)),e=OpenLayers.Request.makeSameOrigin(e,a.proxy);d.open(a.method,e,a.async,a.user,a.password);<span class="keyword">for</span>(<span class="keyword">var</span> f <span class="keyword">in</span> a.headers)d.setRequestHeader(f,a.headers[f]);<span class="keyword">var</span> g=<span class="keyword">this</span>.events,h=<span class="keyword">this</span>;d.onreadystatechange=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;d.readyState==OpenLayers.Request.XMLHttpRequest.DONE&amp;&amp;!<span class="number">1</span>!==g.triggerEvent(<span class="string">"complete"</span>,&#123;<span class="attr">request</span>:d,<span class="attr">config</span>:a,<span class="attr">requestUrl</span>:e&#125;)&amp;&amp;h.runCallbacks(&#123;<span class="attr">request</span>:d,<span class="attr">config</span>:a,</span><br><span class="line">requestUrl:e&#125;)&#125;;!<span class="number">1</span>===a.async?d.send(a.data):<span class="built_in">window</span>.setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="number">0</span>!==d.readyState&amp;&amp;d.send(a.data)&#125;,<span class="number">0</span>);<span class="keyword">return</span> d&#125;,<span class="attr">runCallbacks</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.request,c=a.config,d=c.scope?OpenLayers.Function.bind(c.callback,c.scope):c.callback,e;c.success&amp;&amp;(e=c.scope?OpenLayers.Function.bind(c.success,c.scope):c.success);<span class="keyword">var</span> f;c.failure&amp;&amp;(f=c.scope?OpenLayers.Function.bind(c.failure,c.scope):c.failure);<span class="string">"file:"</span>==OpenLayers.Util.createUrlObject(c.url).protocol&amp;&amp;b.responseText&amp;&amp;(b.status=<span class="number">200</span>);d(b);<span class="keyword">if</span>(!b.status||</span><br><span class="line"><span class="number">200</span>&lt;=b.status&amp;&amp;<span class="number">300</span>&gt;b.status)<span class="keyword">this</span>.events.triggerEvent(<span class="string">"success"</span>,a),e&amp;&amp;e(b);b.status&amp;&amp;(<span class="number">200</span>&gt;b.status||<span class="number">300</span>&lt;=b.status)&amp;&amp;(<span class="keyword">this</span>.events.triggerEvent(<span class="string">"failure"</span>,a),f&amp;&amp;f(b))&#125;,<span class="attr">GET</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.extend(a,&#123;<span class="attr">method</span>:<span class="string">"GET"</span>&#125;);<span class="keyword">return</span> OpenLayers.Request.issue(a)&#125;,<span class="attr">POST</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.extend(a,&#123;<span class="attr">method</span>:<span class="string">"POST"</span>&#125;);a.headers=a.headers?a.headers:&#123;&#125;;<span class="string">"CONTENT-TYPE"</span><span class="keyword">in</span> OpenLayers.Util.upperCaseObject(a.headers)||(a.headers[<span class="string">"Content-Type"</span>]=<span class="string">"application/xml"</span>);<span class="keyword">return</span> OpenLayers.Request.issue(a)&#125;,<span class="attr">PUT</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=</span><br><span class="line">OpenLayers.Util.extend(a,&#123;<span class="attr">method</span>:<span class="string">"PUT"</span>&#125;);a.headers=a.headers?a.headers:&#123;&#125;;<span class="string">"CONTENT-TYPE"</span><span class="keyword">in</span> OpenLayers.Util.upperCaseObject(a.headers)||(a.headers[<span class="string">"Content-Type"</span>]=<span class="string">"application/xml"</span>);<span class="keyword">return</span> OpenLayers.Request.issue(a)&#125;,<span class="attr">DELETE</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.extend(a,&#123;<span class="attr">method</span>:<span class="string">"DELETE"</span>&#125;);<span class="keyword">return</span> OpenLayers.Request.issue(a)&#125;,<span class="attr">HEAD</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.extend(a,&#123;<span class="attr">method</span>:<span class="string">"HEAD"</span>&#125;);<span class="keyword">return</span> OpenLayers.Request.issue(a)&#125;,<span class="attr">OPTIONS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.extend(a,&#123;<span class="attr">method</span>:<span class="string">"OPTIONS"</span>&#125;);<span class="keyword">return</span> OpenLayers.Request.issue(a)&#125;&#125;);OpenLayers.Layer.ArcIMS=OpenLayers.Class(OpenLayers.Layer.Grid,&#123;<span class="attr">DEFAULT_PARAMS</span>:&#123;<span class="attr">ClientVersion</span>:<span class="string">"9.2"</span>,<span class="attr">ServiceName</span>:<span class="string">""</span>&#125;,<span class="attr">featureCoordSys</span>:<span class="string">"4326"</span>,<span class="attr">filterCoordSys</span>:<span class="string">"4326"</span>,<span class="attr">layers</span>:<span class="literal">null</span>,<span class="attr">async</span>:!<span class="number">0</span>,<span class="attr">name</span>:<span class="string">"ArcIMS"</span>,<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">DEFAULT_OPTIONS</span>:&#123;<span class="attr">tileSize</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">512</span>,<span class="number">512</span>),<span class="attr">featureCoordSys</span>:<span class="string">"4326"</span>,<span class="attr">filterCoordSys</span>:<span class="string">"4326"</span>,<span class="attr">layers</span>:<span class="literal">null</span>,<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">async</span>:!<span class="number">0</span>,<span class="attr">name</span>:<span class="string">"ArcIMS"</span>&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">this</span>.tileSize=<span class="keyword">new</span> OpenLayers.Size(<span class="number">512</span>,<span class="number">512</span>);<span class="keyword">this</span>.params=OpenLayers.Util.applyDefaults(&#123;<span class="attr">ServiceName</span>:c.serviceName&#125;,</span><br><span class="line"><span class="keyword">this</span>.DEFAULT_PARAMS);<span class="keyword">this</span>.options=OpenLayers.Util.applyDefaults(c,<span class="keyword">this</span>.DEFAULT_OPTIONS);OpenLayers.Layer.Grid.prototype.initialize.apply(<span class="keyword">this</span>,[a,b,<span class="keyword">this</span>.params,c]);<span class="keyword">this</span>.transparent&amp;&amp;(<span class="keyword">this</span>.isBaseLayer||(<span class="keyword">this</span>.isBaseLayer=!<span class="number">1</span>),<span class="string">"image/jpeg"</span>==<span class="keyword">this</span>.format&amp;&amp;(<span class="keyword">this</span>.format=OpenLayers.Util.alphaHack()?<span class="string">"image/gif"</span>:<span class="string">"image/png"</span>));<span class="literal">null</span>===<span class="keyword">this</span>.options.layers&amp;&amp;(<span class="keyword">this</span>.options.layers=[])&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="string">""</span>;a=<span class="keyword">this</span>.adjustBounds(a);a=<span class="keyword">new</span> OpenLayers.Format.ArcXML(OpenLayers.Util.extend(<span class="keyword">this</span>.options,&#123;<span class="attr">requesttype</span>:<span class="string">"image"</span>,</span><br><span class="line">envelope:a.toArray(),<span class="attr">tileSize</span>:<span class="keyword">this</span>.tileSize&#125;));a=<span class="keyword">new</span> OpenLayers.Request.POST(&#123;<span class="attr">url</span>:<span class="keyword">this</span>.getFullRequestString(),<span class="attr">data</span>:a.write(),<span class="attr">async</span>:!<span class="number">1</span>&#125;);<span class="literal">null</span>!=a&amp;&amp;(b=a.responseXML,b&amp;&amp;b.documentElement||(b=a.responseText),b=(<span class="keyword">new</span> OpenLayers.Format.ArcXML).read(b),b=<span class="keyword">this</span>.getUrlOrImage(b.image.output));<span class="keyword">return</span> b&#125;,<span class="attr">getURLasync</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;a=<span class="keyword">this</span>.adjustBounds(a);a=<span class="keyword">new</span> OpenLayers.Format.ArcXML(OpenLayers.Util.extend(<span class="keyword">this</span>.options,&#123;<span class="attr">requesttype</span>:<span class="string">"image"</span>,<span class="attr">envelope</span>:a.toArray(),<span class="attr">tileSize</span>:<span class="keyword">this</span>.tileSize&#125;));OpenLayers.Request.POST(&#123;<span class="attr">url</span>:<span class="keyword">this</span>.getFullRequestString(),</span><br><span class="line"><span class="keyword">async</span>:!<span class="number">0</span>,<span class="attr">data</span>:a.write(),<span class="attr">callback</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> e=a.responseXML;e&amp;&amp;e.documentElement||(e=a.responseText);a=(<span class="keyword">new</span> OpenLayers.Format.ArcXML).read(e);b.call(c,<span class="keyword">this</span>.getUrlOrImage(a.image.output))&#125;,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">getUrlOrImage</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="string">""</span>;a.url?b=a.url:a.data&amp;&amp;(b=<span class="string">"data:image/"</span>+a.type+<span class="string">";base64,"</span>+a.data);<span class="keyword">return</span> b&#125;,<span class="attr">setLayerQuery</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>;c&lt;<span class="keyword">this</span>.options.layers.length;c++)<span class="keyword">if</span>(a==<span class="keyword">this</span>.options.layers[c].id)&#123;<span class="keyword">this</span>.options.layers[c].query=b;<span class="keyword">return</span>&#125;<span class="keyword">this</span>.options.layers.push(&#123;<span class="attr">id</span>:a,<span class="attr">visible</span>:!<span class="number">0</span>,</span><br><span class="line">query:b&#125;)&#125;,<span class="attr">getFeatureInfo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=c.buffer||<span class="number">1</span>,e=c.callback||<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,f=c.scope||<span class="built_in">window</span>,g=&#123;&#125;;OpenLayers.Util.extend(g,<span class="keyword">this</span>.options);g.requesttype=<span class="string">"feature"</span>;a <span class="keyword">instanceof</span> OpenLayers.LonLat?(g.polygon=<span class="literal">null</span>,g.envelope=[a.lon-d,a.lat-d,a.lon+d,a.lat+d]):a <span class="keyword">instanceof</span> OpenLayers.Geometry.Polygon&amp;&amp;(g.envelope=<span class="literal">null</span>,g.polygon=a);<span class="keyword">var</span> h=<span class="keyword">new</span> OpenLayers.Format.ArcXML(g);OpenLayers.Util.extend(h.request.get_feature,c);h.request.get_feature.layer=b.id;<span class="string">"number"</span>==<span class="keyword">typeof</span> b.query.accuracy?h.request.get_feature.query.accuracy=</span><br><span class="line">b.query.accuracy:(a=<span class="keyword">this</span>.map.getCenter(),c=<span class="keyword">this</span>.map.getViewPortPxFromLonLat(a),c.x++,c=<span class="keyword">this</span>.map.getLonLatFromPixel(c),h.request.get_feature.query.accuracy=c.lon-a.lon);h.request.get_feature.query.where=b.query.where;h.request.get_feature.query.spatialfilter.relation=<span class="string">"area_intersection"</span>;OpenLayers.Request.POST(&#123;<span class="attr">url</span>:<span class="keyword">this</span>.getFullRequestString(&#123;<span class="attr">CustomService</span>:<span class="string">"Query"</span>&#125;),<span class="attr">data</span>:h.write(),<span class="attr">callback</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=h.parseResponse(a.responseText);h.iserror()?e.call(f,<span class="literal">null</span>):e.call(f,a.features)&#125;&#125;)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==</span><br><span class="line">a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.ArcIMS(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.getOptions()));<span class="keyword">return</span> a=OpenLayers.Layer.Grid.prototype.clone.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.ArcIMS"</span>&#125;);OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">slideFactor</span>:<span class="number">50</span>,<span class="attr">slideRatio</span>:<span class="literal">null</span>,<span class="attr">buttons</span>:<span class="literal">null</span>,<span class="attr">position</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.position=<span class="keyword">new</span> OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y);OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.unregister(<span class="string">"buttonclick"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onButtonClick);<span class="keyword">this</span>.removeButtons();<span class="keyword">this</span>.position=<span class="keyword">this</span>.buttons=<span class="literal">null</span>;OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,</span><br><span class="line">setMap:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.map.events.register(<span class="string">"buttonclick"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onButtonClick)&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);a=<span class="keyword">this</span>.position;<span class="keyword">this</span>.buttons=[];<span class="keyword">var</span> b=&#123;<span class="attr">w</span>:<span class="number">18</span>,<span class="attr">h</span>:<span class="number">18</span>&#125;,c=<span class="keyword">new</span> OpenLayers.Pixel(a.x+b.w/<span class="number">2</span>,a.y);<span class="keyword">this</span>._addButton(<span class="string">"panup"</span>,<span class="string">"north-mini.png"</span>,c,b);a.y=c.y+b.h;<span class="keyword">this</span>._addButton(<span class="string">"panleft"</span>,<span class="string">"west-mini.png"</span>,a,b);<span class="keyword">this</span>._addButton(<span class="string">"panright"</span>,<span class="string">"east-mini.png"</span>,a.add(b.w,<span class="number">0</span>),b);<span class="keyword">this</span>._addButton(<span class="string">"pandown"</span>,<span class="string">"south-mini.png"</span>,</span><br><span class="line">c.add(<span class="number">0</span>,<span class="number">2</span>*b.h),b);<span class="keyword">this</span>._addButton(<span class="string">"zoomin"</span>,<span class="string">"zoom-plus-mini.png"</span>,c.add(<span class="number">0</span>,<span class="number">3</span>*b.h+<span class="number">5</span>),b);<span class="keyword">this</span>._addButton(<span class="string">"zoomworld"</span>,<span class="string">"zoom-world-mini.png"</span>,c.add(<span class="number">0</span>,<span class="number">4</span>*b.h+<span class="number">5</span>),b);<span class="keyword">this</span>._addButton(<span class="string">"zoomout"</span>,<span class="string">"zoom-minus-mini.png"</span>,c.add(<span class="number">0</span>,<span class="number">5</span>*b.h+<span class="number">5</span>),b);<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">_addButton</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;b=OpenLayers.Util.getImageLocation(b);c=OpenLayers.Util.createAlphaImageDiv(<span class="keyword">this</span>.id+<span class="string">"_"</span>+a,c,d,b,<span class="string">"absolute"</span>);c.style.cursor=<span class="string">"pointer"</span>;<span class="keyword">this</span>.div.appendChild(c);c.action=a;c.className=<span class="string">"olButton"</span>;<span class="keyword">this</span>.buttons.push(c);<span class="keyword">return</span> c&#125;,<span class="attr">_removeButton</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.div.removeChild(a);</span><br><span class="line">OpenLayers.Util.removeItem(<span class="keyword">this</span>.buttons,a)&#125;,<span class="attr">removeButtons</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.buttons.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;--a)<span class="keyword">this</span>._removeButton(<span class="keyword">this</span>.buttons[a])&#125;,<span class="attr">onButtonClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">switch</span>(a.buttonElement.action)&#123;<span class="keyword">case</span> <span class="string">"panup"</span>:<span class="keyword">this</span>.map.pan(<span class="number">0</span>,-<span class="keyword">this</span>.getSlideFactor(<span class="string">"h"</span>));<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"pandown"</span>:<span class="keyword">this</span>.map.pan(<span class="number">0</span>,<span class="keyword">this</span>.getSlideFactor(<span class="string">"h"</span>));<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"panleft"</span>:<span class="keyword">this</span>.map.pan(-<span class="keyword">this</span>.getSlideFactor(<span class="string">"w"</span>),<span class="number">0</span>);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"panright"</span>:<span class="keyword">this</span>.map.pan(<span class="keyword">this</span>.getSlideFactor(<span class="string">"w"</span>),<span class="number">0</span>);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"zoomin"</span>:<span class="keyword">this</span>.map.zoomIn();<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"zoomout"</span>:<span class="keyword">this</span>.map.zoomOut();</span><br><span class="line"><span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"zoomworld"</span>:<span class="keyword">this</span>.map.zoomToMaxExtent()&#125;&#125;,<span class="attr">getSlideFactor</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.slideRatio?<span class="keyword">this</span>.map.getSize()[a]*<span class="keyword">this</span>.slideRatio:<span class="keyword">this</span>.slideFactor&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.PanZoom"</span>&#125;);OpenLayers.Control.PanZoom.X=<span class="number">4</span>;OpenLayers.Control.PanZoom.Y=<span class="number">4</span>;OpenLayers.Control.PanZoomBar=OpenLayers.Class(OpenLayers.Control.PanZoom,&#123;<span class="attr">zoomStopWidth</span>:<span class="number">18</span>,<span class="attr">zoomStopHeight</span>:<span class="number">11</span>,<span class="attr">slider</span>:<span class="literal">null</span>,<span class="attr">sliderEvents</span>:<span class="literal">null</span>,<span class="attr">zoombarDiv</span>:<span class="literal">null</span>,<span class="attr">zoomWorldIcon</span>:!<span class="number">1</span>,<span class="attr">panIcons</span>:!<span class="number">0</span>,<span class="attr">forceFixedZoomLevel</span>:!<span class="number">1</span>,<span class="attr">mouseDragStart</span>:<span class="literal">null</span>,<span class="attr">deltaY</span>:<span class="literal">null</span>,<span class="attr">zoomStart</span>:<span class="literal">null</span>,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>._removeZoomBar();<span class="keyword">this</span>.map.events.un(&#123;<span class="attr">changebaselayer</span>:<span class="keyword">this</span>.redraw,<span class="attr">updatesize</span>:<span class="keyword">this</span>.redraw,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);OpenLayers.Control.PanZoom.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">delete</span> <span class="keyword">this</span>.mouseDragStart;<span class="keyword">delete</span> <span class="keyword">this</span>.zoomStart&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.PanZoom.prototype.setMap.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>);<span class="keyword">this</span>.map.events.on(&#123;<span class="attr">changebaselayer</span>:<span class="keyword">this</span>.redraw,<span class="attr">updatesize</span>:<span class="keyword">this</span>.redraw,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">redraw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="literal">null</span>!=<span class="keyword">this</span>.div&amp;&amp;(<span class="keyword">this</span>.removeButtons(),<span class="keyword">this</span>._removeZoomBar());<span class="keyword">this</span>.draw()&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);a=<span class="keyword">this</span>.position.clone();<span class="keyword">this</span>.buttons=[];<span class="keyword">var</span> b=&#123;<span class="attr">w</span>:<span class="number">18</span>,<span class="attr">h</span>:<span class="number">18</span>&#125;;<span class="keyword">if</span>(<span class="keyword">this</span>.panIcons)&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Pixel(a.x+b.w/<span class="number">2</span>,a.y),d=b.w;<span class="keyword">this</span>.zoomWorldIcon&amp;&amp;(c=<span class="keyword">new</span> OpenLayers.Pixel(a.x+b.w,a.y));<span class="keyword">this</span>._addButton(<span class="string">"panup"</span>,<span class="string">"north-mini.png"</span>,c,b);a.y=c.y+b.h;</span><br><span class="line"><span class="keyword">this</span>._addButton(<span class="string">"panleft"</span>,<span class="string">"west-mini.png"</span>,a,b);<span class="keyword">this</span>.zoomWorldIcon&amp;&amp;(<span class="keyword">this</span>._addButton(<span class="string">"zoomworld"</span>,<span class="string">"zoom-world-mini.png"</span>,a.add(b.w,<span class="number">0</span>),b),d*=<span class="number">2</span>);<span class="keyword">this</span>._addButton(<span class="string">"panright"</span>,<span class="string">"east-mini.png"</span>,a.add(d,<span class="number">0</span>),b);<span class="keyword">this</span>._addButton(<span class="string">"pandown"</span>,<span class="string">"south-mini.png"</span>,c.add(<span class="number">0</span>,<span class="number">2</span>*b.h),b);<span class="keyword">this</span>._addButton(<span class="string">"zoomin"</span>,<span class="string">"zoom-plus-mini.png"</span>,c.add(<span class="number">0</span>,<span class="number">3</span>*b.h+<span class="number">5</span>),b);c=<span class="keyword">this</span>._addZoomBar(c.add(<span class="number">0</span>,<span class="number">4</span>*b.h+<span class="number">5</span>));<span class="keyword">this</span>._addButton(<span class="string">"zoomout"</span>,<span class="string">"zoom-minus-mini.png"</span>,c,b)&#125;<span class="keyword">else</span> <span class="keyword">this</span>._addButton(<span class="string">"zoomin"</span>,<span class="string">"zoom-plus-mini.png"</span>,a,b),c=<span class="keyword">this</span>._addZoomBar(a.add(<span class="number">0</span>,b.h)),</span><br><span class="line"><span class="keyword">this</span>._addButton(<span class="string">"zoomout"</span>,<span class="string">"zoom-minus-mini.png"</span>,c,b),<span class="keyword">this</span>.zoomWorldIcon&amp;&amp;(c=c.add(<span class="number">0</span>,b.h+<span class="number">3</span>),<span class="keyword">this</span>._addButton(<span class="string">"zoomworld"</span>,<span class="string">"zoom-world-mini.png"</span>,c,b));<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">_addZoomBar</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Util.getImageLocation(<span class="string">"slider.png"</span>),c=<span class="keyword">this</span>.id+<span class="string">"_"</span>+<span class="keyword">this</span>.map.id,d=<span class="keyword">this</span>.map.getMinZoom(),e=<span class="keyword">this</span>.map.getNumZoomLevels()<span class="number">-1</span>-<span class="keyword">this</span>.map.getZoom(),e=OpenLayers.Util.createAlphaImageDiv(c,a.add(<span class="number">-1</span>,e*<span class="keyword">this</span>.zoomStopHeight),&#123;<span class="attr">w</span>:<span class="number">20</span>,<span class="attr">h</span>:<span class="number">9</span>&#125;,b,<span class="string">"absolute"</span>);e.style.cursor=<span class="string">"move"</span>;<span class="keyword">this</span>.slider=e;<span class="keyword">this</span>.sliderEvents=<span class="keyword">new</span> OpenLayers.Events(<span class="keyword">this</span>,</span><br><span class="line">e,<span class="literal">null</span>,!<span class="number">0</span>,&#123;<span class="attr">includeXY</span>:!<span class="number">0</span>&#125;);<span class="keyword">this</span>.sliderEvents.on(&#123;<span class="attr">touchstart</span>:<span class="keyword">this</span>.zoomBarDown,<span class="attr">touchmove</span>:<span class="keyword">this</span>.zoomBarDrag,<span class="attr">touchend</span>:<span class="keyword">this</span>.zoomBarUp,<span class="attr">mousedown</span>:<span class="keyword">this</span>.zoomBarDown,<span class="attr">mousemove</span>:<span class="keyword">this</span>.zoomBarDrag,<span class="attr">mouseup</span>:<span class="keyword">this</span>.zoomBarUp&#125;);<span class="keyword">var</span> f=&#123;<span class="attr">w</span>:<span class="keyword">this</span>.zoomStopWidth,<span class="attr">h</span>:<span class="keyword">this</span>.zoomStopHeight*(<span class="keyword">this</span>.map.getNumZoomLevels()-d)&#125;,b=OpenLayers.Util.getImageLocation(<span class="string">"zoombar.png"</span>),c=<span class="literal">null</span>;OpenLayers.Util.alphaHack()?(c=<span class="keyword">this</span>.id+<span class="string">"_"</span>+<span class="keyword">this</span>.map.id,c=OpenLayers.Util.createAlphaImageDiv(c,a,&#123;<span class="attr">w</span>:f.w,<span class="attr">h</span>:<span class="keyword">this</span>.zoomStopHeight&#125;,b,<span class="string">"absolute"</span>,<span class="literal">null</span>,<span class="string">"crop"</span>),c.style.height=</span><br><span class="line">f.h+<span class="string">"px"</span>):c=OpenLayers.Util.createDiv(<span class="string">"OpenLayers_Control_PanZoomBar_Zoombar"</span>+<span class="keyword">this</span>.map.id,a,f,b);c.style.cursor=<span class="string">"pointer"</span>;c.className=<span class="string">"olButton"</span>;<span class="keyword">this</span>.zoombarDiv=c;<span class="keyword">this</span>.div.appendChild(c);<span class="keyword">this</span>.startTop=<span class="built_in">parseInt</span>(c.style.top);<span class="keyword">this</span>.div.appendChild(e);<span class="keyword">this</span>.map.events.register(<span class="string">"zoomend"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.moveZoomBar);<span class="keyword">return</span> a=a.add(<span class="number">0</span>,<span class="keyword">this</span>.zoomStopHeight*(<span class="keyword">this</span>.map.getNumZoomLevels()-d))&#125;,<span class="attr">_removeZoomBar</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.sliderEvents.un(&#123;<span class="attr">touchstart</span>:<span class="keyword">this</span>.zoomBarDown,<span class="attr">touchmove</span>:<span class="keyword">this</span>.zoomBarDrag,<span class="attr">touchend</span>:<span class="keyword">this</span>.zoomBarUp,</span><br><span class="line">mousedown:<span class="keyword">this</span>.zoomBarDown,<span class="attr">mousemove</span>:<span class="keyword">this</span>.zoomBarDrag,<span class="attr">mouseup</span>:<span class="keyword">this</span>.zoomBarUp&#125;);<span class="keyword">this</span>.sliderEvents.destroy();<span class="keyword">this</span>.div.removeChild(<span class="keyword">this</span>.zoombarDiv);<span class="keyword">this</span>.zoombarDiv=<span class="literal">null</span>;<span class="keyword">this</span>.div.removeChild(<span class="keyword">this</span>.slider);<span class="keyword">this</span>.slider=<span class="literal">null</span>;<span class="keyword">this</span>.map.events.unregister(<span class="string">"zoomend"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.moveZoomBar)&#125;,<span class="attr">onButtonClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.PanZoom.prototype.onButtonClick.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">if</span>(a.buttonElement===<span class="keyword">this</span>.zoombarDiv)&#123;<span class="keyword">var</span> b=a.buttonXY.y/<span class="keyword">this</span>.zoomStopHeight;<span class="keyword">if</span>(<span class="keyword">this</span>.forceFixedZoomLevel||!<span class="keyword">this</span>.map.fractionalZoom)b=</span><br><span class="line"><span class="built_in">Math</span>.floor(b);b=<span class="keyword">this</span>.map.getNumZoomLevels()<span class="number">-1</span>-b;b=<span class="built_in">Math</span>.min(<span class="built_in">Math</span>.max(b,<span class="number">0</span>),<span class="keyword">this</span>.map.getNumZoomLevels()<span class="number">-1</span>);<span class="keyword">this</span>.map.zoomTo(b)&#125;&#125;,<span class="attr">passEventToSlider</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.sliderEvents.handleBrowserEvent(a)&#125;,<span class="attr">zoomBarDown</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))<span class="keyword">this</span>.map.events.on(&#123;<span class="attr">touchmove</span>:<span class="keyword">this</span>.passEventToSlider,<span class="attr">mousemove</span>:<span class="keyword">this</span>.passEventToSlider,<span class="attr">mouseup</span>:<span class="keyword">this</span>.passEventToSlider,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;),<span class="keyword">this</span>.mouseDragStart=a.xy.clone(),<span class="keyword">this</span>.zoomStart=a.xy.clone(),<span class="keyword">this</span>.div.style.cursor=</span><br><span class="line"><span class="string">"move"</span>,<span class="keyword">this</span>.zoombarDiv.offsets=<span class="literal">null</span>,OpenLayers.Event.stop(a)&#125;,<span class="attr">zoomBarDrag</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.mouseDragStart)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.mouseDragStart.y-a.xy.y,c=OpenLayers.Util.pagePosition(<span class="keyword">this</span>.zoombarDiv);<span class="number">0</span>&lt;a.clientY-c[<span class="number">1</span>]&amp;&amp;a.clientY-c[<span class="number">1</span>]&lt;<span class="built_in">parseInt</span>(<span class="keyword">this</span>.zoombarDiv.style.height)<span class="number">-2</span>&amp;&amp;(b=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.slider.style.top)-b,<span class="keyword">this</span>.slider.style.top=b+<span class="string">"px"</span>,<span class="keyword">this</span>.mouseDragStart=a.xy.clone());<span class="keyword">this</span>.deltaY=<span class="keyword">this</span>.zoomStart.y-a.xy.y;OpenLayers.Event.stop(a)&#125;&#125;,<span class="attr">zoomBarUp</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>((OpenLayers.Event.isLeftClick(a)||<span class="string">"touchend"</span>===</span><br><span class="line">a.type)&amp;&amp;<span class="keyword">this</span>.mouseDragStart)&#123;<span class="keyword">this</span>.div.style.cursor=<span class="string">""</span>;<span class="keyword">this</span>.map.events.un(&#123;<span class="attr">touchmove</span>:<span class="keyword">this</span>.passEventToSlider,<span class="attr">mouseup</span>:<span class="keyword">this</span>.passEventToSlider,<span class="attr">mousemove</span>:<span class="keyword">this</span>.passEventToSlider,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">var</span> b=<span class="keyword">this</span>.map.zoom;!<span class="keyword">this</span>.forceFixedZoomLevel&amp;&amp;<span class="keyword">this</span>.map.fractionalZoom?(b+=<span class="keyword">this</span>.deltaY/<span class="keyword">this</span>.zoomStopHeight,b=<span class="built_in">Math</span>.min(<span class="built_in">Math</span>.max(b,<span class="number">0</span>),<span class="keyword">this</span>.map.getNumZoomLevels()<span class="number">-1</span>)):(b+=<span class="keyword">this</span>.deltaY/<span class="keyword">this</span>.zoomStopHeight,b=<span class="built_in">Math</span>.max(<span class="built_in">Math</span>.round(b),<span class="number">0</span>));<span class="keyword">this</span>.map.zoomTo(b);<span class="keyword">this</span>.zoomStart=<span class="keyword">this</span>.mouseDragStart=<span class="literal">null</span>;<span class="keyword">this</span>.deltaY=<span class="number">0</span>;OpenLayers.Event.stop(a)&#125;&#125;,</span><br><span class="line">moveZoomBar:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=(<span class="keyword">this</span>.map.getNumZoomLevels()<span class="number">-1</span>-<span class="keyword">this</span>.map.getZoom())*<span class="keyword">this</span>.zoomStopHeight+<span class="keyword">this</span>.startTop+<span class="number">1</span>;<span class="keyword">this</span>.slider.style.top=a+<span class="string">"px"</span>&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.PanZoomBar"</span>&#125;);OpenLayers.Format.WFSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,&#123;<span class="attr">defaultVersion</span>:<span class="string">"1.1.0"</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WFSCapabilities"</span>&#125;);OpenLayers.Format.WFSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">wfs</span>:<span class="string">"http://www.opengis.net/wfs"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>,<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows"</span>&#125;,<span class="attr">errorProperty</span>:<span class="string">"featureTypeList"</span>,<span class="attr">defaultPrefix</span>:<span class="string">"wfs"</span>,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> b=&#123;&#125;;<span class="keyword">this</span>.readNode(a,b);<span class="keyword">return</span> b&#125;,<span class="attr">readers</span>:&#123;<span class="attr">wfs</span>:&#123;<span class="attr">WFS_Capabilities</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">FeatureTypeList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.featureTypeList=&#123;<span class="attr">featureTypes</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.featureTypeList)&#125;,<span class="attr">FeatureType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.featureTypes.push(c)&#125;,<span class="attr">Name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);c&amp;&amp;(c=c.split(<span class="string">":"</span>),b.name=c.pop(),<span class="number">0</span>&lt;c.length&amp;&amp;(b.featureNS=<span class="keyword">this</span>.lookupNamespaceURI(a,c[<span class="number">0</span>])))&#125;,<span class="attr">Title</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);c&amp;&amp;(b.title=c)&#125;,<span class="attr">Abstract</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);c&amp;&amp;(b[<span class="string">"abstract"</span>]=c)&#125;&#125;&#125;,</span><br><span class="line">CLASS_NAME:<span class="string">"OpenLayers.Format.WFSCapabilities.v1"</span>&#125;);OpenLayers.Format.WFSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,&#123;<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">readers</span>:&#123;<span class="attr">wfs</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">DefaultSRS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);c&amp;&amp;(b.srs=c)&#125;&#125;,OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs),<span class="attr">ows</span>:OpenLayers.Format.OWSCommon.v1.prototype.readers.ows&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WFSCapabilities.v1_1_0"</span>&#125;);OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,&#123;<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">url</span>:<span class="literal">null</span>,<span class="attr">extent</span>:<span class="literal">null</span>,<span class="attr">size</span>:<span class="literal">null</span>,<span class="attr">tile</span>:<span class="literal">null</span>,<span class="attr">aspectRatio</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e</span>)</span>&#123;<span class="keyword">this</span>.url=b;<span class="keyword">this</span>.maxExtent=<span class="keyword">this</span>.extent=c;<span class="keyword">this</span>.size=d;OpenLayers.Layer.prototype.initialize.apply(<span class="keyword">this</span>,[a,e]);<span class="keyword">this</span>.aspectRatio=<span class="keyword">this</span>.extent.getHeight()/<span class="keyword">this</span>.size.h/(<span class="keyword">this</span>.extent.getWidth()/<span class="keyword">this</span>.size.w)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.tile&amp;&amp;(<span class="keyword">this</span>.removeTileMonitoringHooks(<span class="keyword">this</span>.tile),<span class="keyword">this</span>.tile.destroy(),<span class="keyword">this</span>.tile=<span class="literal">null</span>);OpenLayers.Layer.prototype.destroy.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.Image(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.extent,<span class="keyword">this</span>.size,<span class="keyword">this</span>.getOptions()));<span class="keyword">return</span> a=OpenLayers.Layer.prototype.clone.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==<span class="keyword">this</span>.options.maxResolution&amp;&amp;(<span class="keyword">this</span>.options.maxResolution=<span class="keyword">this</span>.aspectRatio*<span class="keyword">this</span>.extent.getWidth()/<span class="keyword">this</span>.size.w);OpenLayers.Layer.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Layer.prototype.moveTo.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">var</span> d=<span class="literal">null</span>==<span class="keyword">this</span>.tile;<span class="keyword">if</span>(b||d)&#123;<span class="keyword">this</span>.setTileSize();</span><br><span class="line"><span class="keyword">var</span> e=<span class="keyword">this</span>.map.getLayerPxFromLonLat(&#123;<span class="attr">lon</span>:<span class="keyword">this</span>.extent.left,<span class="attr">lat</span>:<span class="keyword">this</span>.extent.top&#125;);d?(<span class="keyword">this</span>.tile=<span class="keyword">new</span> OpenLayers.Tile.Image(<span class="keyword">this</span>,e,<span class="keyword">this</span>.extent,<span class="literal">null</span>,<span class="keyword">this</span>.tileSize),<span class="keyword">this</span>.addTileMonitoringHooks(<span class="keyword">this</span>.tile)):(<span class="keyword">this</span>.tile.size=<span class="keyword">this</span>.tileSize.clone(),<span class="keyword">this</span>.tile.position=e.clone());<span class="keyword">this</span>.tile.draw()&#125;&#125;,<span class="attr">setTileSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.extent.getWidth()/<span class="keyword">this</span>.map.getResolution(),b=<span class="keyword">this</span>.extent.getHeight()/<span class="keyword">this</span>.map.getResolution();<span class="keyword">this</span>.tileSize=<span class="keyword">new</span> OpenLayers.Size(a,b)&#125;,<span class="attr">addTileMonitoringHooks</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.onLoadStart=</span><br><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loadstart"</span>)&#125;;a.events.register(<span class="string">"loadstart"</span>,<span class="keyword">this</span>,a.onLoadStart);a.onLoadEnd=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loadend"</span>)&#125;;a.events.register(<span class="string">"loadend"</span>,<span class="keyword">this</span>,a.onLoadEnd);a.events.register(<span class="string">"unload"</span>,<span class="keyword">this</span>,a.onLoadEnd)&#125;,<span class="attr">removeTileMonitoringHooks</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.unload();a.events.un(&#123;<span class="attr">loadstart</span>:a.onLoadStart,<span class="attr">loadend</span>:a.onLoadEnd,<span class="attr">unload</span>:a.onLoadEnd,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">setUrl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.url=a;<span class="keyword">this</span>.tile.draw()&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.url&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.Image"</span>&#125;);OpenLayers.Strategy=OpenLayers.Class(&#123;<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">options</span>:<span class="literal">null</span>,<span class="attr">active</span>:<span class="literal">null</span>,<span class="attr">autoActivate</span>:!<span class="number">0</span>,<span class="attr">autoDestroy</span>:!<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,a);<span class="keyword">this</span>.options=a;<span class="keyword">this</span>.active=!<span class="number">1</span>&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.deactivate();<span class="keyword">this</span>.options=<span class="keyword">this</span>.layer=<span class="literal">null</span>&#125;,<span class="attr">setLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.layer=a&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.active?!<span class="number">1</span>:<span class="keyword">this</span>.active=!<span class="number">0</span>&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.active?(<span class="keyword">this</span>.active=!<span class="number">1</span>,!<span class="number">0</span>):!<span class="number">1</span>&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Strategy"</span>&#125;);OpenLayers.Strategy.Save=OpenLayers.Class(OpenLayers.Strategy,&#123;<span class="attr">events</span>:<span class="literal">null</span>,<span class="attr">auto</span>:!<span class="number">1</span>,<span class="attr">timer</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Strategy.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.events=<span class="keyword">new</span> OpenLayers.Events(<span class="keyword">this</span>)&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Strategy.prototype.activate.call(<span class="keyword">this</span>);<span class="keyword">if</span>(a&amp;&amp;<span class="keyword">this</span>.auto)<span class="keyword">if</span>(<span class="string">"number"</span>===<span class="keyword">typeof</span> <span class="keyword">this</span>.auto)<span class="keyword">this</span>.timer=<span class="built_in">window</span>.setInterval(OpenLayers.Function.bind(<span class="keyword">this</span>.save,<span class="keyword">this</span>),<span class="number">1E3</span>*<span class="keyword">this</span>.auto);<span class="keyword">else</span> <span class="keyword">this</span>.layer.events.on(&#123;<span class="attr">featureadded</span>:<span class="keyword">this</span>.triggerSave,<span class="attr">afterfeaturemodified</span>:<span class="keyword">this</span>.triggerSave,</span><br><span class="line">scope:<span class="keyword">this</span>&#125;);<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Strategy.prototype.deactivate.call(<span class="keyword">this</span>);a&amp;&amp;<span class="keyword">this</span>.auto&amp;&amp;(<span class="string">"number"</span>===<span class="keyword">typeof</span> <span class="keyword">this</span>.auto?<span class="built_in">window</span>.clearInterval(<span class="keyword">this</span>.timer):<span class="keyword">this</span>.layer.events.un(&#123;<span class="attr">featureadded</span>:<span class="keyword">this</span>.triggerSave,<span class="attr">afterfeaturemodified</span>:<span class="keyword">this</span>.triggerSave,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;));<span class="keyword">return</span> a&#125;,<span class="attr">triggerSave</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.feature;b.state!==OpenLayers.State.INSERT&amp;&amp;b.state!==OpenLayers.State.UPDATE&amp;&amp;b.state!==OpenLayers.State.DELETE||<span class="keyword">this</span>.save([a.feature])&#125;,<span class="attr">save</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a||(a=<span class="keyword">this</span>.layer.features);</span><br><span class="line"><span class="keyword">this</span>.events.triggerEvent(<span class="string">"start"</span>,&#123;<span class="attr">features</span>:a&#125;);<span class="keyword">var</span> b=<span class="keyword">this</span>.layer.projection,c=<span class="keyword">this</span>.layer.map.getProjectionObject();<span class="keyword">if</span>(!c.equals(b))&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=a.length,e=<span class="built_in">Array</span>(d),f,g,h=<span class="number">0</span>;h&lt;d;++h)f=a[h],g=f.clone(),g.fid=f.fid,g.state=f.state,f.url&amp;&amp;(g.url=f.url),g._original=f,g.geometry.transform(c,b),e[h]=g;a=e&#125;<span class="keyword">this</span>.layer.protocol.commit(a,&#123;<span class="attr">callback</span>:<span class="keyword">this</span>.onCommit,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">onCommit</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;<span class="attr">response</span>:a&#125;;<span class="keyword">if</span>(a.success())&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=a.reqFeatures,d,e=[],f=a.insertIds||[],g=<span class="number">0</span>,h=<span class="number">0</span>,k=c.length;h&lt;k;++h)<span class="keyword">if</span>(d=c[h],</span><br><span class="line">d=d._original||d,a=d.state)a==OpenLayers.State.DELETE?e.push(d):a==OpenLayers.State.INSERT&amp;&amp;(d.fid=f[g],++g),d.state=<span class="literal">null</span>;<span class="number">0</span>&lt;e.length&amp;&amp;<span class="keyword">this</span>.layer.destroyFeatures(e);<span class="keyword">this</span>.events.triggerEvent(<span class="string">"success"</span>,b)&#125;<span class="keyword">else</span> <span class="keyword">this</span>.events.triggerEvent(<span class="string">"fail"</span>,b)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Strategy.Save"</span>&#125;);OpenLayers.Events.featureclick=OpenLayers.Class(&#123;<span class="attr">cache</span>:<span class="literal">null</span>,<span class="attr">map</span>:<span class="literal">null</span>,<span class="attr">provides</span>:[<span class="string">"featureclick"</span>,<span class="string">"nofeatureclick"</span>,<span class="string">"featureover"</span>,<span class="string">"featureout"</span>],<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.target=a;<span class="keyword">if</span>(a.object <span class="keyword">instanceof</span> OpenLayers.Map)<span class="keyword">this</span>.setMap(a.object);<span class="keyword">else</span> <span class="keyword">if</span>(a.object <span class="keyword">instanceof</span> OpenLayers.Layer.Vector)a.object.map?<span class="keyword">this</span>.setMap(a.object.map):a.object.events.register(<span class="string">"added"</span>,<span class="keyword">this</span>,<span class="function"><span class="keyword">function</span>(<span class="params">b</span>)</span>&#123;<span class="keyword">this</span>.setMap(a.object.map)&#125;);<span class="keyword">else</span> <span class="keyword">throw</span><span class="string">"Listeners for '"</span>+<span class="keyword">this</span>.provides.join(<span class="string">"', '"</span>)+<span class="string">"' events can only be registered for OpenLayers.Layer.Vector or OpenLayers.Map instances"</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.provides.length<span class="number">-1</span>;<span class="number">0</span>&lt;=b;--b)a.extensions[<span class="keyword">this</span>.provides[b]]=!<span class="number">0</span>&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.map=a;<span class="keyword">this</span>.cache=&#123;&#125;;a.events.register(<span class="string">"mousedown"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.start,&#123;<span class="attr">extension</span>:!<span class="number">0</span>&#125;);a.events.register(<span class="string">"mouseup"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onClick,&#123;<span class="attr">extension</span>:!<span class="number">0</span>&#125;);a.events.register(<span class="string">"touchstart"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.start,&#123;<span class="attr">extension</span>:!<span class="number">0</span>&#125;);a.events.register(<span class="string">"touchmove"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.cancel,&#123;<span class="attr">extension</span>:!<span class="number">0</span>&#125;);a.events.register(<span class="string">"touchend"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onClick,&#123;<span class="attr">extension</span>:!<span class="number">0</span>&#125;);a.events.register(<span class="string">"mousemove"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onMousemove,&#123;<span class="attr">extension</span>:!<span class="number">0</span>&#125;)&#125;,</span><br><span class="line">start:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.startEvt=a&#125;,<span class="attr">cancel</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">delete</span> <span class="keyword">this</span>.startEvt&#125;,<span class="attr">onClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.startEvt&amp;&amp;(<span class="string">"touchend"</span>===a.type||OpenLayers.Event.isLeftClick(a)))&#123;a=<span class="keyword">this</span>.getFeatures(<span class="keyword">this</span>.startEvt);<span class="keyword">delete</span> <span class="keyword">this</span>.startEvt;<span class="keyword">for</span>(<span class="keyword">var</span> b,c,d=&#123;&#125;,e=<span class="number">0</span>,f=a.length;e&lt;f&amp;&amp;(b=a[e],c=b.layer,d[c.id]=!<span class="number">0</span>,b=<span class="keyword">this</span>.triggerEvent(<span class="string">"featureclick"</span>,&#123;<span class="attr">feature</span>:b&#125;),!<span class="number">1</span>!==b);++e);e=<span class="number">0</span>;<span class="keyword">for</span>(f=<span class="keyword">this</span>.map.layers.length;e&lt;f;++e)c=<span class="keyword">this</span>.map.layers[e],c <span class="keyword">instanceof</span> OpenLayers.Layer.Vector&amp;&amp;!d[c.id]&amp;&amp;<span class="keyword">this</span>.triggerEvent(<span class="string">"nofeatureclick"</span>,&#123;<span class="attr">layer</span>:c&#125;)&#125;&#125;,</span><br><span class="line">onMousemove:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">delete</span> <span class="keyword">this</span>.startEvt;<span class="keyword">var</span> b=<span class="keyword">this</span>.getFeatures(a),c=&#123;&#125;;a=[];<span class="keyword">for</span>(<span class="keyword">var</span> d,e=<span class="number">0</span>,f=b.length;e&lt;f;++e)d=b[e],c[d.id]=d,<span class="keyword">this</span>.cache[d.id]||a.push(d);<span class="keyword">var</span> b=[],g;<span class="keyword">for</span>(g <span class="keyword">in</span> <span class="keyword">this</span>.cache)d=<span class="keyword">this</span>.cache[g],d.layer&amp;&amp;d.layer.map?c[d.id]||b.push(d):<span class="keyword">delete</span> <span class="keyword">this</span>.cache[g];e=<span class="number">0</span>;<span class="keyword">for</span>(f=a.length;e&lt;f&amp;&amp;(d=a[e],<span class="keyword">this</span>.cache[d.id]=d,g=<span class="keyword">this</span>.triggerEvent(<span class="string">"featureover"</span>,&#123;<span class="attr">feature</span>:d&#125;),!<span class="number">1</span>!==g);++e);e=<span class="number">0</span>;<span class="keyword">for</span>(f=b.length;e&lt;f&amp;&amp;(d=b[e],<span class="keyword">delete</span> <span class="keyword">this</span>.cache[d.id],g=<span class="keyword">this</span>.triggerEvent(<span class="string">"featureout"</span>,&#123;<span class="attr">feature</span>:d&#125;),!<span class="number">1</span>!==g);++e);&#125;,<span class="attr">triggerEvent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">var</span> c=b.feature?b.feature.layer:b.layer,d=<span class="keyword">this</span>.target.object;<span class="keyword">if</span>(d <span class="keyword">instanceof</span> OpenLayers.Map||d===c)<span class="keyword">return</span> <span class="keyword">this</span>.target.triggerEvent(a,b)&#125;,<span class="attr">getFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.clientX,c=a.clientY,d=[],e=[],f=[],g,h,k,l;<span class="keyword">for</span>(l=<span class="keyword">this</span>.map.layers.length<span class="number">-1</span>;<span class="number">0</span>&lt;=l;--l)<span class="keyword">if</span>(g=<span class="keyword">this</span>.map.layers[l],<span class="string">"none"</span>!==g.div.style.display)<span class="keyword">if</span>(g.renderer <span class="keyword">instanceof</span> OpenLayers.Renderer.Elements)&#123;<span class="keyword">if</span>(g <span class="keyword">instanceof</span> OpenLayers.Layer.Vector)<span class="keyword">for</span>(h=<span class="built_in">document</span>.elementFromPoint(b,c);h&amp;&amp;h._featureId;)(k=g.getFeatureById(h._featureId))?(d.push(k),</span><br><span class="line">h.style.display=<span class="string">"none"</span>,e.push(h),h=<span class="built_in">document</span>.elementFromPoint(b,c)):h=!<span class="number">1</span>;f.push(g);g.div.style.display=<span class="string">"none"</span>&#125;<span class="keyword">else</span> g.renderer <span class="keyword">instanceof</span> OpenLayers.Renderer.Canvas&amp;&amp;(k=g.renderer.getFeatureIdFromEvent(a))&amp;&amp;(d.push(k),f.push(g));l=<span class="number">0</span>;<span class="keyword">for</span>(a=e.length;l&lt;a;++l)e[l].style.display=<span class="string">""</span>;<span class="keyword">for</span>(l=f.length<span class="number">-1</span>;<span class="number">0</span>&lt;=l;--l)f[l].div.style.display=<span class="string">"block"</span>;<span class="keyword">return</span> d&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.provides.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;--a)<span class="keyword">delete</span> <span class="keyword">this</span>.target.extensions[<span class="keyword">this</span>.provides[a]];<span class="keyword">this</span>.map.events.un(&#123;<span class="attr">mousemove</span>:<span class="keyword">this</span>.onMousemove,<span class="attr">mousedown</span>:<span class="keyword">this</span>.start,</span><br><span class="line">mouseup:<span class="keyword">this</span>.onClick,<span class="attr">touchstart</span>:<span class="keyword">this</span>.start,<span class="attr">touchmove</span>:<span class="keyword">this</span>.cancel,<span class="attr">touchend</span>:<span class="keyword">this</span>.onClick,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">delete</span> <span class="keyword">this</span>.cache;<span class="keyword">delete</span> <span class="keyword">this</span>.map;<span class="keyword">delete</span> <span class="keyword">this</span>.target&#125;&#125;);OpenLayers.Events.nofeatureclick=OpenLayers.Events.featureclick;OpenLayers.Events.featureover=OpenLayers.Events.featureclick;OpenLayers.Events.featureout=OpenLayers.Events.featureclick;OpenLayers.Format.GPX=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">defaultDesc</span>:<span class="string">"No description available"</span>,<span class="attr">extractWaypoints</span>:!<span class="number">0</span>,<span class="attr">extractTracks</span>:!<span class="number">0</span>,<span class="attr">extractRoutes</span>:!<span class="number">0</span>,<span class="attr">extractAttributes</span>:!<span class="number">0</span>,<span class="attr">namespaces</span>:&#123;<span class="attr">gpx</span>:<span class="string">"http://www.topografix.com/GPX/1/1"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&#125;,<span class="attr">schemaLocation</span>:<span class="string">"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd"</span>,<span class="attr">creator</span>:<span class="string">"OpenLayers"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.externalProjection=<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>);OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,</span><br><span class="line">[a])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));<span class="keyword">var</span> b=[];<span class="keyword">if</span>(<span class="keyword">this</span>.extractTracks)<span class="keyword">for</span>(<span class="keyword">var</span> c=a.getElementsByTagName(<span class="string">"trk"</span>),d=<span class="number">0</span>,e=c.length;d&lt;e;d++)&#123;<span class="keyword">var</span> f=&#123;&#125;;<span class="keyword">this</span>.extractAttributes&amp;&amp;(f=<span class="keyword">this</span>.parseAttributes(c[d]));<span class="keyword">for</span>(<span class="keyword">var</span> g=<span class="keyword">this</span>.getElementsByTagNameNS(c[d],c[d].namespaceURI,<span class="string">"trkseg"</span>),h=<span class="number">0</span>,k=g.length;h&lt;k;h++)&#123;<span class="keyword">var</span> l=<span class="keyword">this</span>.extractSegment(g[h],<span class="string">"trkpt"</span>);b.push(<span class="keyword">new</span> OpenLayers.Feature.Vector(l,f))&#125;&#125;<span class="keyword">if</span>(<span class="keyword">this</span>.extractRoutes)<span class="keyword">for</span>(e=a.getElementsByTagName(<span class="string">"rte"</span>),c=<span class="number">0</span>,d=</span><br><span class="line">e.length;c&lt;d;c++)f=&#123;&#125;,<span class="keyword">this</span>.extractAttributes&amp;&amp;(f=<span class="keyword">this</span>.parseAttributes(e[c])),g=<span class="keyword">this</span>.extractSegment(e[c],<span class="string">"rtept"</span>),b.push(<span class="keyword">new</span> OpenLayers.Feature.Vector(g,f));<span class="keyword">if</span>(<span class="keyword">this</span>.extractWaypoints)<span class="keyword">for</span>(a=a.getElementsByTagName(<span class="string">"wpt"</span>),c=<span class="number">0</span>,e=a.length;c&lt;e;c++)f=&#123;&#125;,<span class="keyword">this</span>.extractAttributes&amp;&amp;(f=<span class="keyword">this</span>.parseAttributes(a[c])),d=<span class="keyword">new</span> OpenLayers.Geometry.Point(a[c].getAttribute(<span class="string">"lon"</span>),a[c].getAttribute(<span class="string">"lat"</span>)),b.push(<span class="keyword">new</span> OpenLayers.Feature.Vector(d,f));<span class="keyword">if</span>(<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection)<span class="keyword">for</span>(f=<span class="number">0</span>,a=b.length;f&lt;a;f++)b[f].geometry.transform(<span class="keyword">this</span>.externalProjection,</span><br><span class="line"><span class="keyword">this</span>.internalProjection);<span class="keyword">return</span> b&#125;,<span class="attr">extractSegment</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="keyword">this</span>.getElementsByTagNameNS(a,a.namespaceURI,b),d=[],e=<span class="number">0</span>,f=c.length;e&lt;f;e++)d.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(c[e].getAttribute(<span class="string">"lon"</span>),c[e].getAttribute(<span class="string">"lat"</span>)));<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.LineString(d)&#125;,<span class="attr">parseAttributes</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;&#125;;a=a.firstChild;<span class="keyword">for</span>(<span class="keyword">var</span> c,d;a;)<span class="number">1</span>==a.nodeType&amp;&amp;a.firstChild&amp;&amp;(c=a.firstChild,<span class="number">3</span>==c.nodeType||<span class="number">4</span>==c.nodeType)&amp;&amp;(d=a.prefix?a.nodeName.split(<span class="string">":"</span>)[<span class="number">1</span>]:a.nodeName,<span class="string">"trkseg"</span>!=d&amp;&amp;<span class="string">"rtept"</span>!=d&amp;&amp;</span><br><span class="line">(b[d]=c.nodeValue)),a=a.nextSibling;<span class="keyword">return</span> b&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a=OpenLayers.Util.isArray(a)?a:[a];<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.gpx,<span class="string">"gpx"</span>);c.setAttribute(<span class="string">"version"</span>,<span class="string">"1.1"</span>);c.setAttribute(<span class="string">"creator"</span>,<span class="keyword">this</span>.creator);<span class="keyword">this</span>.setAttributes(c,&#123;<span class="string">"xsi:schemaLocation"</span>:<span class="keyword">this</span>.schemaLocation&#125;);b&amp;&amp;<span class="string">"object"</span>==<span class="keyword">typeof</span> b&amp;&amp;c.appendChild(<span class="keyword">this</span>.buildMetadataNode(b));<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e=a.length;d&lt;e;d++)c.appendChild(<span class="keyword">this</span>.buildFeatureNode(a[d]));<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[c])&#125;,<span class="attr">buildMetadataNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=</span><br><span class="line">[<span class="string">"name"</span>,<span class="string">"desc"</span>,<span class="string">"author"</span>],c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.gpx,<span class="string">"metadata"</span>),d=<span class="number">0</span>;d&lt;b.length;d++)&#123;<span class="keyword">var</span> e=b[d];<span class="keyword">if</span>(a[e])&#123;<span class="keyword">var</span> f=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.gpx,e);f.appendChild(<span class="keyword">this</span>.createTextNode(a[e]));c.appendChild(f)&#125;&#125;<span class="keyword">return</span> c&#125;,<span class="attr">buildFeatureNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.geometry,b=b.clone();<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection&amp;&amp;b.transform(<span class="keyword">this</span>.internalProjection,<span class="keyword">this</span>.externalProjection);<span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.Point"</span>==b.CLASS_NAME)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.buildWptNode(b);<span class="keyword">this</span>.appendAttributesNode(c,</span><br><span class="line">a);<span class="keyword">return</span> c&#125;c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.gpx,<span class="string">"trk"</span>);<span class="keyword">this</span>.appendAttributesNode(c,a);a=<span class="keyword">this</span>.buildTrkSegNode(b);a=OpenLayers.Util.isArray(a)?a:[a];<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,d=a.length;b&lt;d;b++)c.appendChild(a[b]);<span class="keyword">return</span> c&#125;,<span class="attr">buildTrkSegNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c,d,e;<span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.LineString"</span>==a.CLASS_NAME||<span class="string">"OpenLayers.Geometry.LinearRing"</span>==a.CLASS_NAME)&#123;b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.gpx,<span class="string">"trkseg"</span>);c=<span class="number">0</span>;<span class="keyword">for</span>(d=a.components.length;c&lt;d;c++)e=a.components[c],b.appendChild(<span class="keyword">this</span>.buildTrkPtNode(e));</span><br><span class="line"><span class="keyword">return</span> b&#125;b=[];c=<span class="number">0</span>;<span class="keyword">for</span>(d=a.components.length;c&lt;d;c++)b.push(<span class="keyword">this</span>.buildTrkSegNode(a.components[c]));<span class="keyword">return</span> b&#125;,<span class="attr">buildTrkPtNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.gpx,<span class="string">"trkpt"</span>);b.setAttribute(<span class="string">"lon"</span>,a.x);b.setAttribute(<span class="string">"lat"</span>,a.y);<span class="keyword">return</span> b&#125;,<span class="attr">buildWptNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.gpx,<span class="string">"wpt"</span>);b.setAttribute(<span class="string">"lon"</span>,a.x);b.setAttribute(<span class="string">"lat"</span>,a.y);<span class="keyword">return</span> b&#125;,<span class="attr">appendAttributesNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.gpx,<span class="string">"name"</span>);c.appendChild(<span class="keyword">this</span>.createTextNode(b.attributes.name||</span><br><span class="line">b.id));a.appendChild(c);c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.gpx,<span class="string">"desc"</span>);c.appendChild(<span class="keyword">this</span>.createTextNode(b.attributes.description||<span class="keyword">this</span>.defaultDesc));a.appendChild(c)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.GPX"</span>&#125;);OpenLayers.Format.WMSDescribeLayer=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,&#123;<span class="attr">defaultVersion</span>:<span class="string">"1.1.1"</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMSDescribeLayer"</span>&#125;);OpenLayers.Format.WMSDescribeLayer.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSDescribeLayer,&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.WMSDescribeLayer.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));<span class="keyword">for</span>(<span class="keyword">var</span> b=a.documentElement.childNodes,c=&#123;<span class="attr">layerDescriptions</span>:[]&#125;,d,e,f=<span class="number">0</span>;f&lt;b.length;++f)<span class="keyword">if</span>(d=b[f],e=d.nodeName,<span class="string">"LayerDescription"</span>==e)&#123;e=d.getAttribute(<span class="string">"name"</span>);<span class="keyword">var</span> g=<span class="string">""</span>,h=<span class="string">""</span>,k=<span class="string">""</span>;d.getAttribute(<span class="string">"owsType"</span>)?(g=d.getAttribute(<span class="string">"owsType"</span>),</span><br><span class="line">h=d.getAttribute(<span class="string">"owsURL"</span>)):<span class="string">""</span>!=d.getAttribute(<span class="string">"wfs"</span>)?(g=<span class="string">"WFS"</span>,h=d.getAttribute(<span class="string">"wfs"</span>)):<span class="string">""</span>!=d.getAttribute(<span class="string">"wcs"</span>)&amp;&amp;(g=<span class="string">"WCS"</span>,h=d.getAttribute(<span class="string">"wcs"</span>));d=d.getElementsByTagName(<span class="string">"Query"</span>);<span class="number">0</span>&lt;d.length&amp;&amp;((k=d[<span class="number">0</span>].getAttribute(<span class="string">"typeName"</span>))||(k=d[<span class="number">0</span>].getAttribute(<span class="string">"typename"</span>)));d=&#123;<span class="attr">layerName</span>:e,<span class="attr">owsType</span>:g,<span class="attr">owsURL</span>:h,<span class="attr">typeName</span>:k&#125;;c.layerDescriptions.push(d);c.length=c.layerDescriptions.length;c[c.length<span class="number">-1</span>]=d&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"ServiceException"</span>==e)<span class="keyword">return</span>&#123;<span class="attr">error</span>:(<span class="keyword">new</span> OpenLayers.Format.OGCExceptionReport).read(a)&#125;;<span class="keyword">return</span> c&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMSDescribeLayer.v1_1_1"</span>&#125;);</span><br><span class="line">OpenLayers.Format.WMSDescribeLayer.v1_1_0=OpenLayers.Format.WMSDescribeLayer.v1_1_1;OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,&#123;<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">sphericalMercator</span>:!<span class="number">1</span>,<span class="attr">zoomOffset</span>:<span class="number">0</span>,<span class="attr">serverResolutions</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">if</span>(c&amp;&amp;c.sphericalMercator||<span class="keyword">this</span>.sphericalMercator)c=OpenLayers.Util.extend(&#123;<span class="attr">projection</span>:<span class="string">"EPSG:900913"</span>,<span class="attr">numZoomLevels</span>:<span class="number">19</span>&#125;,c);OpenLayers.Layer.Grid.prototype.initialize.apply(<span class="keyword">this</span>,[a||<span class="keyword">this</span>.name,b||<span class="keyword">this</span>.url,&#123;&#125;,c])&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.XYZ(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.getOptions()));<span class="keyword">return</span> a=OpenLayers.Layer.Grid.prototype.clone.apply(<span class="keyword">this</span>,</span><br><span class="line">[a])&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.getXYZ(a);<span class="keyword">var</span> b=<span class="keyword">this</span>.url;OpenLayers.Util.isArray(b)&amp;&amp;(b=<span class="keyword">this</span>.selectUrl(<span class="string">""</span>+a.x+a.y+a.z,b));<span class="keyword">return</span> OpenLayers.String.format(b,a)&#125;,<span class="attr">getXYZ</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getServerResolution(),c=<span class="built_in">Math</span>.round((a.left-<span class="keyword">this</span>.maxExtent.left)/(b*<span class="keyword">this</span>.tileSize.w));a=<span class="built_in">Math</span>.round((<span class="keyword">this</span>.maxExtent.top-a.top)/(b*<span class="keyword">this</span>.tileSize.h));b=<span class="keyword">this</span>.getServerZoom();<span class="keyword">if</span>(<span class="keyword">this</span>.wrapDateLine)<span class="keyword">var</span> d=<span class="built_in">Math</span>.pow(<span class="number">2</span>,b),c=(c%d+d)%d;<span class="keyword">return</span>&#123;<span class="attr">x</span>:c,<span class="attr">y</span>:a,<span class="attr">z</span>:b&#125;&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Layer.Grid.prototype.setMap.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>);<span class="keyword">this</span>.tileOrigin||(<span class="keyword">this</span>.tileOrigin=<span class="keyword">new</span> OpenLayers.LonLat(<span class="keyword">this</span>.maxExtent.left,<span class="keyword">this</span>.maxExtent.bottom))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.XYZ"</span>&#125;);OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,&#123;<span class="attr">name</span>:<span class="string">"OpenStreetMap"</span>,<span class="attr">url</span>:[<span class="string">"http://a.tile.openstreetmap.org/$&#123;z&#125;/$&#123;x&#125;/$&#123;y&#125;.png"</span>,<span class="string">"http://b.tile.openstreetmap.org/$&#123;z&#125;/$&#123;x&#125;/$&#123;y&#125;.png"</span>,<span class="string">"http://c.tile.openstreetmap.org/$&#123;z&#125;/$&#123;x&#125;/$&#123;y&#125;.png"</span>],<span class="attr">attribution</span>:<span class="string">"&amp;copy; &lt;a href='http://www.openstreetmap.org/copyright'&gt;OpenStreetMap&lt;/a&gt; contributors"</span>,<span class="attr">sphericalMercator</span>:!<span class="number">0</span>,<span class="attr">wrapDateLine</span>:!<span class="number">0</span>,<span class="attr">tileOptions</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Layer.XYZ.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.tileOptions=</span><br><span class="line">OpenLayers.Util.extend(&#123;<span class="attr">crossOriginKeyword</span>:<span class="string">"anonymous"</span>&#125;,<span class="keyword">this</span>.options&amp;&amp;<span class="keyword">this</span>.options.tileOptions)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.OSM(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.getOptions()));<span class="keyword">return</span> a=OpenLayers.Layer.XYZ.prototype.clone.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.OSM"</span>&#125;);OpenLayers.Renderer=OpenLayers.Class(&#123;<span class="attr">container</span>:<span class="literal">null</span>,<span class="attr">root</span>:<span class="literal">null</span>,<span class="attr">extent</span>:<span class="literal">null</span>,<span class="attr">locked</span>:!<span class="number">1</span>,<span class="attr">size</span>:<span class="literal">null</span>,<span class="attr">resolution</span>:<span class="literal">null</span>,<span class="attr">map</span>:<span class="literal">null</span>,<span class="attr">featureDx</span>:<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.container=OpenLayers.Util.getElement(a);OpenLayers.Util.extend(<span class="keyword">this</span>,b)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.map=<span class="keyword">this</span>.resolution=<span class="keyword">this</span>.size=<span class="keyword">this</span>.extent=<span class="keyword">this</span>.container=<span class="literal">null</span>&#125;,<span class="attr">supported</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">setExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.extent=a.clone();<span class="keyword">if</span>(<span class="keyword">this</span>.map.baseLayer&amp;&amp;<span class="keyword">this</span>.map.baseLayer.wrapDateLine)&#123;<span class="keyword">var</span> c=a.getWidth()/<span class="keyword">this</span>.map.getExtent().getWidth();</span><br><span class="line">a=a.scale(<span class="number">1</span>/c);<span class="keyword">this</span>.extent=a.wrapDateLine(<span class="keyword">this</span>.map.getMaxExtent()).scale(c)&#125;b&amp;&amp;(<span class="keyword">this</span>.resolution=<span class="literal">null</span>);<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">setSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.size=a.clone();<span class="keyword">this</span>.resolution=<span class="literal">null</span>&#125;,<span class="attr">getResolution</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.resolution=<span class="keyword">this</span>.resolution||<span class="keyword">this</span>.map.getResolution()&#125;,<span class="attr">drawFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="literal">null</span>==b&amp;&amp;(b=a.style);<span class="keyword">if</span>(a.geometry)&#123;<span class="keyword">var</span> c=a.geometry.getBounds();<span class="keyword">if</span>(c)&#123;<span class="keyword">var</span> d;<span class="keyword">this</span>.map.baseLayer&amp;&amp;<span class="keyword">this</span>.map.baseLayer.wrapDateLine&amp;&amp;(d=<span class="keyword">this</span>.map.getMaxExtent());c.intersectsBounds(<span class="keyword">this</span>.extent,&#123;<span class="attr">worldBounds</span>:d&#125;)?<span class="keyword">this</span>.calculateFeatureDx(c,</span><br><span class="line">d):b=&#123;<span class="attr">display</span>:<span class="string">"none"</span>&#125;;c=<span class="keyword">this</span>.drawGeometry(a.geometry,b,a.id);<span class="keyword">if</span>(<span class="string">"none"</span>!=b.display&amp;&amp;b.label&amp;&amp;!<span class="number">1</span>!==c)&#123;d=a.geometry.getCentroid();<span class="keyword">if</span>(b.labelXOffset||b.labelYOffset)&#123;<span class="keyword">var</span> e=<span class="built_in">isNaN</span>(b.labelXOffset)?<span class="number">0</span>:b.labelXOffset,f=<span class="built_in">isNaN</span>(b.labelYOffset)?<span class="number">0</span>:b.labelYOffset,g=<span class="keyword">this</span>.getResolution();d.move(e*g,f*g)&#125;<span class="keyword">this</span>.drawText(a.id,b,d)&#125;<span class="keyword">else</span> <span class="keyword">this</span>.removeText(a.id);<span class="keyword">return</span> c&#125;&#125;&#125;,<span class="attr">calculateFeatureDx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.featureDx=<span class="number">0</span>;<span class="keyword">if</span>(b)&#123;<span class="keyword">var</span> c=b.getWidth();<span class="keyword">this</span>.featureDx=<span class="built_in">Math</span>.round(((a.left+a.right)/<span class="number">2</span>-(<span class="keyword">this</span>.extent.left+<span class="keyword">this</span>.extent.right)/</span><br><span class="line"><span class="number">2</span>)/c)*c&#125;&#125;,<span class="attr">drawGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;&#125;,<span class="attr">drawText</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;&#125;,<span class="attr">removeText</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">clear</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">getFeatureIdFromEvent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">eraseFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.isArray(a)||(a=[a]);<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=a.length;b&lt;c;++b)&#123;<span class="keyword">var</span> d=a[b];<span class="keyword">this</span>.eraseGeometry(d.geometry,d.id);<span class="keyword">this</span>.removeText(d.id)&#125;&#125;,<span class="attr">eraseGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">moveRoot</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">getRenderLayerId</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.container.id&#125;,<span class="attr">applyDefaultSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Util.extend(&#123;&#125;,OpenLayers.Renderer.defaultSymbolizer);</span><br><span class="line">!<span class="number">1</span>===a.stroke&amp;&amp;(<span class="keyword">delete</span> b.strokeWidth,<span class="keyword">delete</span> b.strokeColor);!<span class="number">1</span>===a.fill&amp;&amp;<span class="keyword">delete</span> b.fillColor;OpenLayers.Util.extend(b,a);<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Renderer"</span>&#125;);OpenLayers.Renderer.defaultSymbolizer=&#123;<span class="attr">fillColor</span>:<span class="string">"#000000"</span>,<span class="attr">strokeColor</span>:<span class="string">"#000000"</span>,<span class="attr">strokeWidth</span>:<span class="number">2</span>,<span class="attr">fillOpacity</span>:<span class="number">1</span>,<span class="attr">strokeOpacity</span>:<span class="number">1</span>,<span class="attr">pointRadius</span>:<span class="number">0</span>,<span class="attr">labelAlign</span>:<span class="string">"cm"</span>&#125;;</span><br><span class="line">OpenLayers.Renderer.symbol=&#123;<span class="attr">star</span>:[<span class="number">350</span>,<span class="number">75</span>,<span class="number">379</span>,<span class="number">161</span>,<span class="number">469</span>,<span class="number">161</span>,<span class="number">397</span>,<span class="number">215</span>,<span class="number">423</span>,<span class="number">301</span>,<span class="number">350</span>,<span class="number">250</span>,<span class="number">277</span>,<span class="number">301</span>,<span class="number">303</span>,<span class="number">215</span>,<span class="number">231</span>,<span class="number">161</span>,<span class="number">321</span>,<span class="number">161</span>,<span class="number">350</span>,<span class="number">75</span>],<span class="attr">cross</span>:[<span class="number">4</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">0</span>],<span class="attr">x</span>:[<span class="number">0</span>,<span class="number">0</span>,<span class="number">25</span>,<span class="number">0</span>,<span class="number">50</span>,<span class="number">35</span>,<span class="number">75</span>,<span class="number">0</span>,<span class="number">100</span>,<span class="number">0</span>,<span class="number">65</span>,<span class="number">50</span>,<span class="number">100</span>,<span class="number">100</span>,<span class="number">75</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="number">65</span>,<span class="number">25</span>,<span class="number">100</span>,<span class="number">0</span>,<span class="number">100</span>,<span class="number">35</span>,<span class="number">50</span>,<span class="number">0</span>,<span class="number">0</span>],<span class="attr">square</span>:[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],<span class="attr">triangle</span>:[<span class="number">0</span>,<span class="number">10</span>,<span class="number">10</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">10</span>]&#125;;OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,&#123;<span class="attr">hitDetection</span>:!<span class="number">0</span>,<span class="attr">hitOverflow</span>:<span class="number">0</span>,<span class="attr">canvas</span>:<span class="literal">null</span>,<span class="attr">features</span>:<span class="literal">null</span>,<span class="attr">pendingRedraw</span>:!<span class="number">1</span>,<span class="attr">cachedSymbolBounds</span>:&#123;&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Renderer.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.root=<span class="built_in">document</span>.createElement(<span class="string">"canvas"</span>);<span class="keyword">this</span>.container.appendChild(<span class="keyword">this</span>.root);<span class="keyword">this</span>.canvas=<span class="keyword">this</span>.root.getContext(<span class="string">"2d"</span>);<span class="keyword">this</span>.features=&#123;&#125;;<span class="keyword">this</span>.hitDetection&amp;&amp;(<span class="keyword">this</span>.hitCanvas=<span class="built_in">document</span>.createElement(<span class="string">"canvas"</span>),<span class="keyword">this</span>.hitContext=<span class="keyword">this</span>.hitCanvas.getContext(<span class="string">"2d"</span>))&#125;,</span><br><span class="line">setExtent:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Renderer.prototype.setExtent.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">eraseGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.eraseFeatures(<span class="keyword">this</span>.features[b][<span class="number">0</span>])&#125;,<span class="attr">supported</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.CANVAS_SUPPORTED&#125;,<span class="attr">setSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.size=a.clone();<span class="keyword">var</span> b=<span class="keyword">this</span>.root;b.style.width=a.w+<span class="string">"px"</span>;b.style.height=a.h+<span class="string">"px"</span>;b.width=a.w;b.height=a.h;<span class="keyword">this</span>.resolution=<span class="literal">null</span>;<span class="keyword">this</span>.hitDetection&amp;&amp;(b=<span class="keyword">this</span>.hitCanvas,b.style.width=a.w+<span class="string">"px"</span>,b.style.height=a.h+<span class="string">"px"</span>,b.width=a.w,b.height=a.h)&#125;,<span class="attr">drawFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">var</span> c;<span class="keyword">if</span>(a.geometry)&#123;b=<span class="keyword">this</span>.applyDefaultSymbolizer(b||a.style);c=a.geometry.getBounds();<span class="keyword">var</span> d;<span class="keyword">this</span>.map.baseLayer&amp;&amp;<span class="keyword">this</span>.map.baseLayer.wrapDateLine&amp;&amp;(d=<span class="keyword">this</span>.map.getMaxExtent());d=c&amp;&amp;c.intersectsBounds(<span class="keyword">this</span>.extent,&#123;<span class="attr">worldBounds</span>:d&#125;);(c=<span class="string">"none"</span>!==b.display&amp;&amp;!!c&amp;&amp;d)?<span class="keyword">this</span>.features[a.id]=[a,b]:<span class="keyword">delete</span> <span class="keyword">this</span>.features[a.id];<span class="keyword">this</span>.pendingRedraw=!<span class="number">0</span>&#125;<span class="keyword">this</span>.pendingRedraw&amp;&amp;!<span class="keyword">this</span>.locked&amp;&amp;(<span class="keyword">this</span>.redraw(),<span class="keyword">this</span>.pendingRedraw=!<span class="number">1</span>);<span class="keyword">return</span> c&#125;,<span class="attr">drawGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=a.CLASS_NAME;<span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.Collection"</span>==</span><br><span class="line">d||<span class="string">"OpenLayers.Geometry.MultiPoint"</span>==d||<span class="string">"OpenLayers.Geometry.MultiLineString"</span>==d||<span class="string">"OpenLayers.Geometry.MultiPolygon"</span>==d)<span class="keyword">for</span>(d=<span class="number">0</span>;d&lt;a.components.length;d++)<span class="keyword">this</span>.drawGeometry(a.components[d],b,c);<span class="keyword">else</span> <span class="keyword">switch</span>(a.CLASS_NAME)&#123;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Point"</span>:<span class="keyword">this</span>.drawPoint(a,b,c);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.LineString"</span>:<span class="keyword">this</span>.drawLineString(a,b,c);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.LinearRing"</span>:<span class="keyword">this</span>.drawLinearRing(a,b,c);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Polygon"</span>:<span class="keyword">this</span>.drawPolygon(a,b,c)&#125;&#125;,<span class="attr">drawExternalGraphic</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b,c</span>)</span>&#123;<span class="keyword">var</span> d=<span class="keyword">new</span> Image,e=b.title||b.graphicTitle;e&amp;&amp;(d.title=e);<span class="keyword">var</span> f=b.graphicWidth||b.graphicHeight,g=b.graphicHeight||b.graphicWidth,f=f?f:<span class="number">2</span>*b.pointRadius,g=g?g:<span class="number">2</span>*b.pointRadius,h=<span class="keyword">void</span> <span class="number">0</span>!=b.graphicXOffset?b.graphicXOffset:-(<span class="number">0.5</span>*f),k=<span class="keyword">void</span> <span class="number">0</span>!=b.graphicYOffset?b.graphicYOffset:-(<span class="number">0.5</span>*g),l=b.graphicOpacity||b.fillOpacity;d.onload=OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.features[c])&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getLocalXY(a),e=b[<span class="number">0</span>],b=b[<span class="number">1</span>];<span class="keyword">if</span>(!<span class="built_in">isNaN</span>(e)&amp;&amp;!<span class="built_in">isNaN</span>(b))&#123;<span class="keyword">var</span> e=e+h|<span class="number">0</span>,b=b+k|<span class="number">0</span>,p=<span class="keyword">this</span>.canvas;p.globalAlpha=l;<span class="keyword">var</span> q=</span><br><span class="line">OpenLayers.Renderer.Canvas.drawImageScaleFactor||(OpenLayers.Renderer.Canvas.drawImageScaleFactor=<span class="regexp">/android 2.1/</span>.test(navigator.userAgent.toLowerCase())?<span class="number">320</span>/<span class="built_in">window</span>.screen.width:<span class="number">1</span>);p.drawImage(d,e*q,b*q,f*q,g*q);<span class="keyword">this</span>.hitDetection&amp;&amp;(<span class="keyword">this</span>.setHitContextStyle(<span class="string">"fill"</span>,c),<span class="keyword">this</span>.hitContext.fillRect(e,b,f,g))&#125;&#125;&#125;,<span class="keyword">this</span>);d.src=b.externalGraphic&#125;,<span class="attr">drawNamedSymbol</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d,e,f,g;f=<span class="built_in">Math</span>.PI/<span class="number">180</span>;<span class="keyword">var</span> h=OpenLayers.Renderer.symbol[b.graphicName];<span class="keyword">if</span>(!h)<span class="keyword">throw</span> <span class="built_in">Error</span>(b.graphicName+<span class="string">" is not a valid symbol name"</span>);</span><br><span class="line"><span class="keyword">if</span>(!(!h.length||<span class="number">2</span>&gt;h.length||(a=<span class="keyword">this</span>.getLocalXY(a),e=a[<span class="number">0</span>],g=a[<span class="number">1</span>],<span class="built_in">isNaN</span>(e)||<span class="built_in">isNaN</span>(g))))&#123;<span class="keyword">this</span>.canvas.lineCap=<span class="string">"round"</span>;<span class="keyword">this</span>.canvas.lineJoin=<span class="string">"round"</span>;<span class="keyword">this</span>.hitDetection&amp;&amp;(<span class="keyword">this</span>.hitContext.lineCap=<span class="string">"round"</span>,<span class="keyword">this</span>.hitContext.lineJoin=<span class="string">"round"</span>);<span class="keyword">if</span>(b.graphicName <span class="keyword">in</span> <span class="keyword">this</span>.cachedSymbolBounds)d=<span class="keyword">this</span>.cachedSymbolBounds[b.graphicName];<span class="keyword">else</span>&#123;d=<span class="keyword">new</span> OpenLayers.Bounds;<span class="keyword">for</span>(a=<span class="number">0</span>;a&lt;h.length;a+=<span class="number">2</span>)d.extend(<span class="keyword">new</span> OpenLayers.LonLat(h[a],h[a+<span class="number">1</span>]));<span class="keyword">this</span>.cachedSymbolBounds[b.graphicName]=d&#125;<span class="keyword">this</span>.canvas.save();<span class="keyword">this</span>.hitDetection&amp;&amp;<span class="keyword">this</span>.hitContext.save();</span><br><span class="line"><span class="keyword">this</span>.canvas.translate(e,g);<span class="keyword">this</span>.hitDetection&amp;&amp;<span class="keyword">this</span>.hitContext.translate(e,g);a=f*b.rotation;<span class="built_in">isNaN</span>(a)||(<span class="keyword">this</span>.canvas.rotate(a),<span class="keyword">this</span>.hitDetection&amp;&amp;<span class="keyword">this</span>.hitContext.rotate(a));f=<span class="number">2</span>*b.pointRadius/<span class="built_in">Math</span>.max(d.getWidth(),d.getHeight());<span class="keyword">this</span>.canvas.scale(f,f);<span class="keyword">this</span>.hitDetection&amp;&amp;<span class="keyword">this</span>.hitContext.scale(f,f);a=d.getCenterLonLat().lon;d=d.getCenterLonLat().lat;<span class="keyword">this</span>.canvas.translate(-a,-d);<span class="keyword">this</span>.hitDetection&amp;&amp;<span class="keyword">this</span>.hitContext.translate(-a,-d);g=b.strokeWidth;b.strokeWidth=g/f;<span class="keyword">if</span>(!<span class="number">1</span>!==b.fill)&#123;<span class="keyword">this</span>.setCanvasStyle(<span class="string">"fill"</span>,</span><br><span class="line">b);<span class="keyword">this</span>.canvas.beginPath();<span class="keyword">for</span>(a=<span class="number">0</span>;a&lt;h.length;a+=<span class="number">2</span>)d=h[a],e=h[a+<span class="number">1</span>],<span class="number">0</span>==a&amp;&amp;<span class="keyword">this</span>.canvas.moveTo(d,e),<span class="keyword">this</span>.canvas.lineTo(d,e);<span class="keyword">this</span>.canvas.closePath();<span class="keyword">this</span>.canvas.fill();<span class="keyword">if</span>(<span class="keyword">this</span>.hitDetection)&#123;<span class="keyword">this</span>.setHitContextStyle(<span class="string">"fill"</span>,c,b);<span class="keyword">this</span>.hitContext.beginPath();<span class="keyword">for</span>(a=<span class="number">0</span>;a&lt;h.length;a+=<span class="number">2</span>)d=h[a],e=h[a+<span class="number">1</span>],<span class="number">0</span>==a&amp;&amp;<span class="keyword">this</span>.canvas.moveTo(d,e),<span class="keyword">this</span>.hitContext.lineTo(d,e);<span class="keyword">this</span>.hitContext.closePath();<span class="keyword">this</span>.hitContext.fill()&#125;&#125;<span class="keyword">if</span>(!<span class="number">1</span>!==b.stroke)&#123;<span class="keyword">this</span>.setCanvasStyle(<span class="string">"stroke"</span>,b);<span class="keyword">this</span>.canvas.beginPath();<span class="keyword">for</span>(a=<span class="number">0</span>;a&lt;h.length;a+=<span class="number">2</span>)d=h[a],</span><br><span class="line">e=h[a+<span class="number">1</span>],<span class="number">0</span>==a&amp;&amp;<span class="keyword">this</span>.canvas.moveTo(d,e),<span class="keyword">this</span>.canvas.lineTo(d,e);<span class="keyword">this</span>.canvas.closePath();<span class="keyword">this</span>.canvas.stroke();<span class="keyword">if</span>(<span class="keyword">this</span>.hitDetection)&#123;<span class="keyword">this</span>.setHitContextStyle(<span class="string">"stroke"</span>,c,b,f);<span class="keyword">this</span>.hitContext.beginPath();<span class="keyword">for</span>(a=<span class="number">0</span>;a&lt;h.length;a+=<span class="number">2</span>)d=h[a],e=h[a+<span class="number">1</span>],<span class="number">0</span>==a&amp;&amp;<span class="keyword">this</span>.hitContext.moveTo(d,e),<span class="keyword">this</span>.hitContext.lineTo(d,e);<span class="keyword">this</span>.hitContext.closePath();<span class="keyword">this</span>.hitContext.stroke()&#125;&#125;b.strokeWidth=g;<span class="keyword">this</span>.canvas.restore();<span class="keyword">this</span>.hitDetection&amp;&amp;<span class="keyword">this</span>.hitContext.restore();<span class="keyword">this</span>.setCanvasStyle(<span class="string">"reset"</span>)&#125;&#125;,<span class="attr">setCanvasStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="string">"fill"</span>===</span><br><span class="line">a?(<span class="keyword">this</span>.canvas.globalAlpha=b.fillOpacity,<span class="keyword">this</span>.canvas.fillStyle=b.fillColor):<span class="string">"stroke"</span>===a?(<span class="keyword">this</span>.canvas.globalAlpha=b.strokeOpacity,<span class="keyword">this</span>.canvas.strokeStyle=b.strokeColor,<span class="keyword">this</span>.canvas.lineWidth=b.strokeWidth):(<span class="keyword">this</span>.canvas.globalAlpha=<span class="number">0</span>,<span class="keyword">this</span>.canvas.lineWidth=<span class="number">1</span>)&#125;,<span class="attr">featureIdToHex</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="built_in">Number</span>(a.split(<span class="string">"_"</span>).pop())+<span class="number">1</span>;<span class="number">16777216</span>&lt;=a&amp;&amp;(<span class="keyword">this</span>.hitOverflow=a<span class="number">-16777215</span>,a=a%<span class="number">16777216</span>+<span class="number">1</span>);a=<span class="string">"000000"</span>+a.toString(<span class="number">16</span>);<span class="keyword">var</span> b=a.length;<span class="keyword">return</span> a=<span class="string">"#"</span>+a.substring(b<span class="number">-6</span>,b)&#125;,<span class="attr">setHitContextStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;b=<span class="keyword">this</span>.featureIdToHex(b);</span><br><span class="line"><span class="string">"fill"</span>==a?(<span class="keyword">this</span>.hitContext.globalAlpha=<span class="number">1</span>,<span class="keyword">this</span>.hitContext.fillStyle=b):<span class="string">"stroke"</span>==a?(<span class="keyword">this</span>.hitContext.globalAlpha=<span class="number">1</span>,<span class="keyword">this</span>.hitContext.strokeStyle=b,<span class="string">"undefined"</span>===<span class="keyword">typeof</span> d?<span class="keyword">this</span>.hitContext.lineWidth=c.strokeWidth+<span class="number">2</span>:<span class="built_in">isNaN</span>(d)||(<span class="keyword">this</span>.hitContext.lineWidth=c.strokeWidth+<span class="number">2</span>/d)):(<span class="keyword">this</span>.hitContext.globalAlpha=<span class="number">0</span>,<span class="keyword">this</span>.hitContext.lineWidth=<span class="number">1</span>)&#125;,<span class="attr">drawPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">if</span>(!<span class="number">1</span>!==b.graphic)<span class="keyword">if</span>(b.externalGraphic)<span class="keyword">this</span>.drawExternalGraphic(a,b,c);<span class="keyword">else</span> <span class="keyword">if</span>(b.graphicName&amp;&amp;<span class="string">"circle"</span>!=b.graphicName)<span class="keyword">this</span>.drawNamedSymbol(a,b,c);<span class="keyword">else</span>&#123;<span class="keyword">var</span> d=</span><br><span class="line"><span class="keyword">this</span>.getLocalXY(a);a=d[<span class="number">0</span>];d=d[<span class="number">1</span>];<span class="keyword">if</span>(!<span class="built_in">isNaN</span>(a)&amp;&amp;!<span class="built_in">isNaN</span>(d))&#123;<span class="keyword">var</span> e=<span class="number">2</span>*<span class="built_in">Math</span>.PI,f=b.pointRadius;!<span class="number">1</span>!==b.fill&amp;&amp;(<span class="keyword">this</span>.setCanvasStyle(<span class="string">"fill"</span>,b),<span class="keyword">this</span>.canvas.beginPath(),<span class="keyword">this</span>.canvas.arc(a,d,f,<span class="number">0</span>,e,!<span class="number">0</span>),<span class="keyword">this</span>.canvas.fill(),<span class="keyword">this</span>.hitDetection&amp;&amp;(<span class="keyword">this</span>.setHitContextStyle(<span class="string">"fill"</span>,c,b),<span class="keyword">this</span>.hitContext.beginPath(),<span class="keyword">this</span>.hitContext.arc(a,d,f,<span class="number">0</span>,e,!<span class="number">0</span>),<span class="keyword">this</span>.hitContext.fill()));!<span class="number">1</span>!==b.stroke&amp;&amp;(<span class="keyword">this</span>.setCanvasStyle(<span class="string">"stroke"</span>,b),<span class="keyword">this</span>.canvas.beginPath(),<span class="keyword">this</span>.canvas.arc(a,d,f,<span class="number">0</span>,e,!<span class="number">0</span>),<span class="keyword">this</span>.canvas.stroke(),<span class="keyword">this</span>.hitDetection&amp;&amp;(<span class="keyword">this</span>.setHitContextStyle(<span class="string">"stroke"</span>,</span><br><span class="line">c,b),<span class="keyword">this</span>.hitContext.beginPath(),<span class="keyword">this</span>.hitContext.arc(a,d,f,<span class="number">0</span>,e,!<span class="number">0</span>),<span class="keyword">this</span>.hitContext.stroke()),<span class="keyword">this</span>.setCanvasStyle(<span class="string">"reset"</span>))&#125;&#125;&#125;,<span class="attr">drawLineString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;b=OpenLayers.Util.applyDefaults(&#123;<span class="attr">fill</span>:!<span class="number">1</span>&#125;,b);<span class="keyword">this</span>.drawLinearRing(a,b,c)&#125;,<span class="attr">drawLinearRing</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;!<span class="number">1</span>!==b.fill&amp;&amp;(<span class="keyword">this</span>.setCanvasStyle(<span class="string">"fill"</span>,b),<span class="keyword">this</span>.renderPath(<span class="keyword">this</span>.canvas,a,b,c,<span class="string">"fill"</span>),<span class="keyword">this</span>.hitDetection&amp;&amp;(<span class="keyword">this</span>.setHitContextStyle(<span class="string">"fill"</span>,c,b),<span class="keyword">this</span>.renderPath(<span class="keyword">this</span>.hitContext,a,b,c,<span class="string">"fill"</span>)));!<span class="number">1</span>!==b.stroke&amp;&amp;(<span class="keyword">this</span>.setCanvasStyle(<span class="string">"stroke"</span>,b),<span class="keyword">this</span>.renderPath(<span class="keyword">this</span>.canvas,</span><br><span class="line">a,b,c,<span class="string">"stroke"</span>),<span class="keyword">this</span>.hitDetection&amp;&amp;(<span class="keyword">this</span>.setHitContextStyle(<span class="string">"stroke"</span>,c,b),<span class="keyword">this</span>.renderPath(<span class="keyword">this</span>.hitContext,a,b,c,<span class="string">"stroke"</span>)));<span class="keyword">this</span>.setCanvasStyle(<span class="string">"reset"</span>)&#125;,<span class="attr">renderPath</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e</span>)</span>&#123;b=b.components;c=b.length;a.beginPath();d=<span class="keyword">this</span>.getLocalXY(b[<span class="number">0</span>]);<span class="keyword">var</span> f=d[<span class="number">1</span>];<span class="keyword">if</span>(!<span class="built_in">isNaN</span>(d[<span class="number">0</span>])&amp;&amp;!<span class="built_in">isNaN</span>(f))&#123;a.moveTo(d[<span class="number">0</span>],d[<span class="number">1</span>]);<span class="keyword">for</span>(d=<span class="number">1</span>;d&lt;c;++d)f=<span class="keyword">this</span>.getLocalXY(b[d]),a.lineTo(f[<span class="number">0</span>],f[<span class="number">1</span>]);<span class="string">"fill"</span>===e?a.fill():a.stroke()&#125;&#125;,<span class="attr">drawPolygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;a=a.components;<span class="keyword">var</span> d=a.length;<span class="keyword">this</span>.drawLinearRing(a[<span class="number">0</span>],b,c);<span class="keyword">for</span>(<span class="keyword">var</span> e=<span class="number">1</span>;e&lt;</span><br><span class="line">d;++e)<span class="keyword">this</span>.canvas.globalCompositeOperation=<span class="string">"destination-out"</span>,<span class="keyword">this</span>.hitDetection&amp;&amp;(<span class="keyword">this</span>.hitContext.globalCompositeOperation=<span class="string">"destination-out"</span>),<span class="keyword">this</span>.drawLinearRing(a[e],OpenLayers.Util.applyDefaults(&#123;<span class="attr">stroke</span>:!<span class="number">1</span>,<span class="attr">fillOpacity</span>:<span class="number">1</span>&#125;,b),c),<span class="keyword">this</span>.canvas.globalCompositeOperation=<span class="string">"source-over"</span>,<span class="keyword">this</span>.hitDetection&amp;&amp;(<span class="keyword">this</span>.hitContext.globalCompositeOperation=<span class="string">"source-over"</span>),<span class="keyword">this</span>.drawLinearRing(a[e],OpenLayers.Util.applyDefaults(&#123;<span class="attr">fill</span>:!<span class="number">1</span>&#125;,b),c)&#125;,<span class="attr">drawText</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getLocalXY(a);<span class="keyword">this</span>.setCanvasStyle(<span class="string">"reset"</span>);</span><br><span class="line"><span class="keyword">this</span>.canvas.fillStyle=b.fontColor;<span class="keyword">this</span>.canvas.globalAlpha=b.fontOpacity||<span class="number">1</span>;<span class="keyword">var</span> d=[b.fontStyle?b.fontStyle:<span class="string">"normal"</span>,<span class="string">"normal"</span>,b.fontWeight?b.fontWeight:<span class="string">"normal"</span>,b.fontSize?b.fontSize:<span class="string">"1em"</span>,b.fontFamily?b.fontFamily:<span class="string">"sans-serif"</span>].join(<span class="string">" "</span>),e=b.label.split(<span class="string">"\n"</span>),f=e.length;<span class="keyword">if</span>(<span class="keyword">this</span>.canvas.fillText)&#123;<span class="keyword">this</span>.canvas.font=d;<span class="keyword">this</span>.canvas.textAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[b.labelAlign[<span class="number">0</span>]]||<span class="string">"center"</span>;<span class="keyword">this</span>.canvas.textBaseline=OpenLayers.Renderer.Canvas.LABEL_ALIGN[b.labelAlign[<span class="number">1</span>]]||<span class="string">"middle"</span>;<span class="keyword">var</span> g=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[<span class="number">1</span>]];</span><br><span class="line"><span class="literal">null</span>==g&amp;&amp;(g=<span class="number">-0.5</span>);d=<span class="keyword">this</span>.canvas.measureText(<span class="string">"Mg"</span>).height||<span class="keyword">this</span>.canvas.measureText(<span class="string">"xx"</span>).width;c[<span class="number">1</span>]+=d*g*(f<span class="number">-1</span>);<span class="keyword">for</span>(g=<span class="number">0</span>;g&lt;f;g++)b.labelOutlineWidth&amp;&amp;(<span class="keyword">this</span>.canvas.save(),<span class="keyword">this</span>.canvas.globalAlpha=b.labelOutlineOpacity||b.fontOpacity||<span class="number">1</span>,<span class="keyword">this</span>.canvas.strokeStyle=b.labelOutlineColor,<span class="keyword">this</span>.canvas.lineWidth=b.labelOutlineWidth,<span class="keyword">this</span>.canvas.strokeText(e[g],c[<span class="number">0</span>],c[<span class="number">1</span>]+d*g+<span class="number">1</span>),<span class="keyword">this</span>.canvas.restore()),<span class="keyword">this</span>.canvas.fillText(e[g],c[<span class="number">0</span>],c[<span class="number">1</span>]+d*g)&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.canvas.mozDrawText)&#123;<span class="keyword">this</span>.canvas.mozTextStyle=d;<span class="keyword">var</span> h=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[<span class="number">0</span>]];</span><br><span class="line"><span class="literal">null</span>==h&amp;&amp;(h=<span class="number">-0.5</span>);g=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[<span class="number">1</span>]];<span class="literal">null</span>==g&amp;&amp;(g=<span class="number">-0.5</span>);d=<span class="keyword">this</span>.canvas.mozMeasureText(<span class="string">"xx"</span>);c[<span class="number">1</span>]+=d*(<span class="number">1</span>+g*f);<span class="keyword">for</span>(g=<span class="number">0</span>;g&lt;f;g++)&#123;<span class="keyword">var</span> k=c[<span class="number">0</span>]+h*<span class="keyword">this</span>.canvas.mozMeasureText(e[g]),l=c[<span class="number">1</span>]+g*d;<span class="keyword">this</span>.canvas.translate(k,l);<span class="keyword">this</span>.canvas.mozDrawText(e[g]);<span class="keyword">this</span>.canvas.translate(-k,-l)&#125;&#125;<span class="keyword">this</span>.setCanvasStyle(<span class="string">"reset"</span>)&#125;,<span class="attr">getLocalXY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getResolution(),c=<span class="keyword">this</span>.extent;<span class="keyword">return</span>[(a.x-<span class="keyword">this</span>.featureDx)/b+-c.left/b,c.top/b-a.y/b]&#125;,<span class="attr">clear</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.root.height,b=<span class="keyword">this</span>.root.width;</span><br><span class="line"><span class="keyword">this</span>.canvas.clearRect(<span class="number">0</span>,<span class="number">0</span>,b,a);<span class="keyword">this</span>.features=&#123;&#125;;<span class="keyword">this</span>.hitDetection&amp;&amp;<span class="keyword">this</span>.hitContext.clearRect(<span class="number">0</span>,<span class="number">0</span>,b,a)&#125;,<span class="attr">getFeatureIdFromEvent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;<span class="keyword">if</span>(<span class="keyword">this</span>.hitDetection&amp;&amp;<span class="string">"none"</span>!==<span class="keyword">this</span>.root.style.display&amp;&amp;!<span class="keyword">this</span>.map.dragging&amp;&amp;(a=a.xy,a=<span class="keyword">this</span>.hitContext.getImageData(a.x|<span class="number">0</span>,a.y|<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>).data,<span class="number">255</span>===a[<span class="number">3</span>]&amp;&amp;(a=a[<span class="number">2</span>]+<span class="number">256</span>*(a[<span class="number">1</span>]+<span class="number">256</span>*a[<span class="number">0</span>]))))&#123;a=<span class="string">"OpenLayers_Feature_Vector_"</span>+(a<span class="number">-1</span>+<span class="keyword">this</span>.hitOverflow);<span class="keyword">try</span>&#123;b=<span class="keyword">this</span>.features[a][<span class="number">0</span>]&#125;<span class="keyword">catch</span>(c)&#123;&#125;&#125;<span class="keyword">return</span> b&#125;,<span class="attr">eraseFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.isArray(a)||(a=[a]);<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>;b&lt;a.length;++b)<span class="keyword">delete</span> <span class="keyword">this</span>.features[a[b].id];</span><br><span class="line"><span class="keyword">this</span>.redraw()&#125;,<span class="attr">redraw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.locked)&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.root.height,b=<span class="keyword">this</span>.root.width;<span class="keyword">this</span>.canvas.clearRect(<span class="number">0</span>,<span class="number">0</span>,b,a);<span class="keyword">this</span>.hitDetection&amp;&amp;<span class="keyword">this</span>.hitContext.clearRect(<span class="number">0</span>,<span class="number">0</span>,b,a);<span class="keyword">var</span> a=[],c,d,e=<span class="keyword">this</span>.map.baseLayer&amp;&amp;<span class="keyword">this</span>.map.baseLayer.wrapDateLine&amp;&amp;<span class="keyword">this</span>.map.getMaxExtent(),f;<span class="keyword">for</span>(f <span class="keyword">in</span> <span class="keyword">this</span>.features)<span class="keyword">this</span>.features.hasOwnProperty(f)&amp;&amp;(b=<span class="keyword">this</span>.features[f][<span class="number">0</span>],c=b.geometry,<span class="keyword">this</span>.calculateFeatureDx(c.getBounds(),e),d=<span class="keyword">this</span>.features[f][<span class="number">1</span>],<span class="keyword">this</span>.drawGeometry(c,d,b.id),d.label&amp;&amp;a.push([b,d]));b=<span class="number">0</span>;<span class="keyword">for</span>(c=a.length;b&lt;c;++b)f=</span><br><span class="line">a[b],<span class="keyword">this</span>.drawText(f[<span class="number">0</span>].geometry.getCentroid(),f[<span class="number">1</span>])&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Renderer.Canvas"</span>&#125;);OpenLayers.Renderer.Canvas.LABEL_ALIGN=&#123;<span class="attr">l</span>:<span class="string">"left"</span>,<span class="attr">r</span>:<span class="string">"right"</span>,<span class="attr">t</span>:<span class="string">"top"</span>,<span class="attr">b</span>:<span class="string">"bottom"</span>&#125;;OpenLayers.Renderer.Canvas.LABEL_FACTOR=&#123;<span class="attr">l</span>:<span class="number">0</span>,<span class="attr">r</span>:<span class="number">-1</span>,<span class="attr">t</span>:<span class="number">0</span>,<span class="attr">b</span>:<span class="number">-1</span>&#125;;OpenLayers.Renderer.Canvas.drawImageScaleFactor=<span class="literal">null</span>;OpenLayers.Format.OSM=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">checkTags</span>:!<span class="number">1</span>,<span class="attr">interestingTagsExclude</span>:<span class="literal">null</span>,<span class="attr">areaTags</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;<span class="attr">interestingTagsExclude</span>:<span class="string">"source source_ref source:ref history attribution created_by"</span>.split(<span class="string">" "</span>),<span class="attr">areaTags</span>:<span class="string">"area building leisure tourism ruins historic landuse military natural sport"</span>.split(<span class="string">" "</span>)&#125;,b=OpenLayers.Util.extend(b,a),c=&#123;&#125;;<span class="keyword">for</span>(a=<span class="number">0</span>;a&lt;b.interestingTagsExclude.length;a++)c[b.interestingTagsExclude[a]]=!<span class="number">0</span>;b.interestingTagsExclude=c;c=&#123;&#125;;<span class="keyword">for</span>(a=<span class="number">0</span>;a&lt;b.areaTags.length;a++)c[b.areaTags[a]]=</span><br><span class="line">!<span class="number">0</span>;b.areaTags=c;<span class="keyword">this</span>.externalProjection=<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>);OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[b])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));<span class="keyword">var</span> b=<span class="keyword">this</span>.getNodes(a),c=<span class="keyword">this</span>.getWays(a);a=<span class="built_in">Array</span>(c.length);<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>;d&lt;c.length;d++)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> e=<span class="built_in">Array</span>(c[d].nodes.length),f=<span class="keyword">this</span>.isWayArea(c[d])?<span class="number">1</span>:<span class="number">0</span>,g=<span class="number">0</span>;g&lt;c[d].nodes.length;g++)&#123;<span class="keyword">var</span> h=b[c[d].nodes[g]],k=<span class="keyword">new</span> OpenLayers.Geometry.Point(h.lon,h.lat);k.osm_id=<span class="built_in">parseInt</span>(c[d].nodes[g]);</span><br><span class="line">e[g]=k;h.used=!<span class="number">0</span>&#125;h=<span class="literal">null</span>;h=f?<span class="keyword">new</span> OpenLayers.Geometry.Polygon(<span class="keyword">new</span> OpenLayers.Geometry.LinearRing(e)):<span class="keyword">new</span> OpenLayers.Geometry.LineString(e);<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection&amp;&amp;h.transform(<span class="keyword">this</span>.externalProjection,<span class="keyword">this</span>.internalProjection);e=<span class="keyword">new</span> OpenLayers.Feature.Vector(h,c[d].tags);e.osm_id=<span class="built_in">parseInt</span>(c[d].id);e.fid=<span class="string">"way."</span>+e.osm_id;a[d]=e&#125;<span class="keyword">for</span>(<span class="keyword">var</span> l <span class="keyword">in</span> b)&#123;h=b[l];<span class="keyword">if</span>(!h.used||<span class="keyword">this</span>.checkTags)&#123;c=<span class="literal">null</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.checkTags)&#123;c=<span class="keyword">this</span>.getTags(h.node,!<span class="number">0</span>);<span class="keyword">if</span>(h.used&amp;&amp;!c[<span class="number">1</span>])<span class="keyword">continue</span>;c=c[<span class="number">0</span>]&#125;<span class="keyword">else</span> c=<span class="keyword">this</span>.getTags(h.node);</span><br><span class="line">e=<span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.Point(h.lon,h.lat),c);<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection&amp;&amp;e.geometry.transform(<span class="keyword">this</span>.externalProjection,<span class="keyword">this</span>.internalProjection);e.osm_id=<span class="built_in">parseInt</span>(l);e.fid=<span class="string">"node."</span>+e.osm_id;a.push(e)&#125;h.node=<span class="literal">null</span>&#125;<span class="keyword">return</span> a&#125;,<span class="attr">getNodes</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.getElementsByTagName(<span class="string">"node"</span>);<span class="keyword">for</span>(<span class="keyword">var</span> b=&#123;&#125;,c=<span class="number">0</span>;c&lt;a.length;c++)&#123;<span class="keyword">var</span> d=a[c],e=d.getAttribute(<span class="string">"id"</span>);b[e]=&#123;<span class="attr">lat</span>:d.getAttribute(<span class="string">"lat"</span>),<span class="attr">lon</span>:d.getAttribute(<span class="string">"lon"</span>),<span class="attr">node</span>:d&#125;&#125;<span class="keyword">return</span> b&#125;,<span class="attr">getWays</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.getElementsByTagName(<span class="string">"way"</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>;c&lt;a.length;c++)&#123;<span class="keyword">var</span> d=a[c],e=&#123;<span class="attr">id</span>:d.getAttribute(<span class="string">"id"</span>)&#125;;e.tags=<span class="keyword">this</span>.getTags(d);d=d.getElementsByTagName(<span class="string">"nd"</span>);e.nodes=<span class="built_in">Array</span>(d.length);<span class="keyword">for</span>(<span class="keyword">var</span> f=<span class="number">0</span>;f&lt;d.length;f++)e.nodes[f]=d[f].getAttribute(<span class="string">"ref"</span>);b.push(e)&#125;<span class="keyword">return</span> b&#125;,<span class="attr">getTags</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=a.getElementsByTagName(<span class="string">"tag"</span>),d=&#123;&#125;,e=!<span class="number">1</span>,f=<span class="number">0</span>;f&lt;c.length;f++)&#123;<span class="keyword">var</span> g=c[f].getAttribute(<span class="string">"k"</span>);d[g]=c[f].getAttribute(<span class="string">"v"</span>);b&amp;&amp;(<span class="keyword">this</span>.interestingTagsExclude[g]||(e=!<span class="number">0</span>))&#125;<span class="keyword">return</span> b?[d,e]:d&#125;,<span class="attr">isWayArea</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>,c=!<span class="number">1</span>;a.nodes[<span class="number">0</span>]==a.nodes[a.nodes.length-</span><br><span class="line"><span class="number">1</span>]&amp;&amp;(b=!<span class="number">0</span>);<span class="keyword">if</span>(<span class="keyword">this</span>.checkTags)<span class="keyword">for</span>(<span class="keyword">var</span> d <span class="keyword">in</span> a.tags)<span class="keyword">if</span>(<span class="keyword">this</span>.areaTags[d])&#123;c=!<span class="number">0</span>;<span class="keyword">break</span>&#125;<span class="keyword">return</span> b&amp;&amp;(<span class="keyword">this</span>.checkTags?c:!<span class="number">0</span>)&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.isArray(a)||(a=[a]);<span class="keyword">this</span>.osm_id=<span class="number">1</span>;<span class="keyword">this</span>.created_nodes=&#123;&#125;;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="literal">null</span>,<span class="string">"osm"</span>);b.setAttribute(<span class="string">"version"</span>,<span class="string">"0.5"</span>);b.setAttribute(<span class="string">"generator"</span>,<span class="string">"OpenLayers "</span>+OpenLayers.VERSION_NUMBER);<span class="keyword">for</span>(<span class="keyword">var</span> c=a.length<span class="number">-1</span>;<span class="number">0</span>&lt;=c;c--)<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="keyword">this</span>.createFeatureNodes(a[c]),e=<span class="number">0</span>;e&lt;d.length;e++)b.appendChild(d[e]);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,</span><br><span class="line">[b])&#125;,<span class="attr">createFeatureNodes</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=[],c=a.geometry.CLASS_NAME,c=c.substring(c.lastIndexOf(<span class="string">"."</span>)+<span class="number">1</span>),c=c.toLowerCase();(c=<span class="keyword">this</span>.createXML[c])&amp;&amp;(b=c.apply(<span class="keyword">this</span>,[a]));<span class="keyword">return</span> b&#125;,<span class="attr">createXML</span>:&#123;<span class="attr">point</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>,c=a.geometry?a.geometry:a;<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection&amp;&amp;(c=c.clone(),c.transform(<span class="keyword">this</span>.internalProjection,<span class="keyword">this</span>.externalProjection));<span class="keyword">var</span> d=!<span class="number">1</span>;a.osm_id?(b=a.osm_id,<span class="keyword">this</span>.created_nodes[b]&amp;&amp;(d=!<span class="number">0</span>)):(b=-<span class="keyword">this</span>.osm_id,<span class="keyword">this</span>.osm_id++);<span class="keyword">var</span> e=d?<span class="keyword">this</span>.created_nodes[b]:<span class="keyword">this</span>.createElementNS(<span class="literal">null</span>,</span><br><span class="line"><span class="string">"node"</span>);<span class="keyword">this</span>.created_nodes[b]=e;e.setAttribute(<span class="string">"id"</span>,b);e.setAttribute(<span class="string">"lon"</span>,c.x);e.setAttribute(<span class="string">"lat"</span>,c.y);a.attributes&amp;&amp;<span class="keyword">this</span>.serializeTags(a,e);<span class="keyword">this</span>.setState(a,e);<span class="keyword">return</span> d?[]:[e]&#125;,<span class="attr">linestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c=[],d=a.geometry;a.osm_id?b=a.osm_id:(b=-<span class="keyword">this</span>.osm_id,<span class="keyword">this</span>.osm_id++);<span class="keyword">var</span> e=<span class="keyword">this</span>.createElementNS(<span class="literal">null</span>,<span class="string">"way"</span>);e.setAttribute(<span class="string">"id"</span>,b);<span class="keyword">for</span>(b=<span class="number">0</span>;b&lt;d.components.length;b++)&#123;<span class="keyword">var</span> f=<span class="keyword">this</span>.createXML.point.apply(<span class="keyword">this</span>,[d.components[b]]);<span class="keyword">if</span>(f.length)&#123;<span class="keyword">var</span> f=f[<span class="number">0</span>],g=f.getAttribute(<span class="string">"id"</span>);c.push(f)&#125;<span class="keyword">else</span> g=d.components[b].osm_id,</span><br><span class="line">f=<span class="keyword">this</span>.created_nodes[g];<span class="keyword">this</span>.setState(a,f);f=<span class="keyword">this</span>.createElementNS(<span class="literal">null</span>,<span class="string">"nd"</span>);f.setAttribute(<span class="string">"ref"</span>,g);e.appendChild(f)&#125;<span class="keyword">this</span>.serializeTags(a,e);c.push(e);<span class="keyword">return</span> c&#125;,<span class="attr">polygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Util.extend(&#123;<span class="attr">area</span>:<span class="string">"yes"</span>&#125;,a.attributes),b=<span class="keyword">new</span> OpenLayers.Feature.Vector(a.geometry.components[<span class="number">0</span>],b);b.osm_id=a.osm_id;<span class="keyword">return</span> <span class="keyword">this</span>.createXML.linestring.apply(<span class="keyword">this</span>,[b])&#125;&#125;,<span class="attr">serializeTags</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c <span class="keyword">in</span> a.attributes)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.createElementNS(<span class="literal">null</span>,<span class="string">"tag"</span>);d.setAttribute(<span class="string">"k"</span>,c);d.setAttribute(<span class="string">"v"</span>,</span><br><span class="line">a.attributes[c]);b.appendChild(d)&#125;&#125;,<span class="attr">setState</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(a.state)&#123;<span class="keyword">var</span> c=<span class="literal">null</span>;<span class="keyword">switch</span>(a.state)&#123;<span class="keyword">case</span> OpenLayers.State.UPDATE:<span class="keyword">case</span> OpenLayers.State.DELETE:c=<span class="string">"delete"</span>&#125;c&amp;&amp;b.setAttribute(<span class="string">"action"</span>,c)&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.OSM"</span>&#125;);OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,&#123;<span class="attr">KEY_EVENTS</span>:[<span class="string">"keydown"</span>,<span class="string">"keyup"</span>],<span class="attr">eventListener</span>:<span class="literal">null</span>,<span class="attr">observeElement</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Handler.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.eventListener=OpenLayers.Function.bindAsEventListener(<span class="keyword">this</span>.handleKeyEvent,<span class="keyword">this</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.deactivate();<span class="keyword">this</span>.eventListener=<span class="literal">null</span>;OpenLayers.Handler.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(OpenLayers.Handler.prototype.activate.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>))&#123;<span class="keyword">this</span>.observeElement=<span class="keyword">this</span>.observeElement||<span class="built_in">document</span>;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="keyword">this</span>.KEY_EVENTS.length;a&lt;b;a++)OpenLayers.Event.observe(<span class="keyword">this</span>.observeElement,<span class="keyword">this</span>.KEY_EVENTS[a],<span class="keyword">this</span>.eventListener);<span class="keyword">return</span>!<span class="number">0</span>&#125;<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;<span class="keyword">if</span>(OpenLayers.Handler.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>))&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="keyword">this</span>.KEY_EVENTS.length;a&lt;b;a++)OpenLayers.Event.stopObserving(<span class="keyword">this</span>.observeElement,<span class="keyword">this</span>.KEY_EVENTS[a],<span class="keyword">this</span>.eventListener);a=!<span class="number">0</span>&#125;<span class="keyword">return</span> a&#125;,<span class="attr">handleKeyEvent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.checkModifiers(a)&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.callback(a.type,[a])&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Handler.Keyboard"</span>&#125;);OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">documentDrag</span>:!<span class="number">1</span>,<span class="attr">geometryTypes</span>:<span class="literal">null</span>,<span class="attr">clickout</span>:!<span class="number">0</span>,<span class="attr">toggle</span>:!<span class="number">0</span>,<span class="attr">standalone</span>:!<span class="number">1</span>,<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">feature</span>:<span class="literal">null</span>,<span class="attr">vertex</span>:<span class="literal">null</span>,<span class="attr">vertices</span>:<span class="literal">null</span>,<span class="attr">virtualVertices</span>:<span class="literal">null</span>,<span class="attr">handlers</span>:<span class="literal">null</span>,<span class="attr">deleteCodes</span>:<span class="literal">null</span>,<span class="attr">virtualStyle</span>:<span class="literal">null</span>,<span class="attr">vertexRenderIntent</span>:<span class="literal">null</span>,<span class="attr">mode</span>:<span class="literal">null</span>,<span class="attr">createVertices</span>:!<span class="number">0</span>,<span class="attr">modified</span>:!<span class="number">1</span>,<span class="attr">radiusHandle</span>:<span class="literal">null</span>,<span class="attr">dragHandle</span>:<span class="literal">null</span>,<span class="attr">onModificationStart</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">onModification</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">onModificationEnd</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=b||&#123;&#125;;<span class="keyword">this</span>.layer=a;<span class="keyword">this</span>.vertices=</span><br><span class="line">[];<span class="keyword">this</span>.virtualVertices=[];<span class="keyword">this</span>.virtualStyle=OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>.layer.style||<span class="keyword">this</span>.layer.styleMap.createSymbolizer(<span class="literal">null</span>,b.vertexRenderIntent));<span class="keyword">this</span>.virtualStyle.fillOpacity=<span class="number">0.3</span>;<span class="keyword">this</span>.virtualStyle.strokeOpacity=<span class="number">0.3</span>;<span class="keyword">this</span>.deleteCodes=[<span class="number">46</span>,<span class="number">68</span>];<span class="keyword">this</span>.mode=OpenLayers.Control.ModifyFeature.RESHAPE;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[b]);OpenLayers.Util.isArray(<span class="keyword">this</span>.deleteCodes)||(<span class="keyword">this</span>.deleteCodes=[<span class="keyword">this</span>.deleteCodes]);<span class="keyword">var</span> c=&#123;<span class="attr">documentDrag</span>:<span class="keyword">this</span>.documentDrag,<span class="attr">stopDown</span>:!<span class="number">1</span>&#125;;<span class="keyword">this</span>.handlers=</span><br><span class="line">&#123;<span class="attr">keyboard</span>:<span class="keyword">new</span> OpenLayers.Handler.Keyboard(<span class="keyword">this</span>,&#123;<span class="attr">keydown</span>:<span class="keyword">this</span>.handleKeypress&#125;),<span class="attr">drag</span>:<span class="keyword">new</span> OpenLayers.Handler.Drag(<span class="keyword">this</span>,&#123;<span class="attr">down</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.vertex=<span class="literal">null</span>;(a=<span class="keyword">this</span>.layer.getFeatureFromEvent(<span class="keyword">this</span>.handlers.drag.evt))?<span class="keyword">this</span>.dragStart(a):<span class="keyword">this</span>.clickout&amp;&amp;(<span class="keyword">this</span>._unselect=<span class="keyword">this</span>.feature)&#125;,<span class="attr">move</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">delete</span> <span class="keyword">this</span>._unselect;<span class="keyword">this</span>.vertex&amp;&amp;<span class="keyword">this</span>.dragVertex(<span class="keyword">this</span>.vertex,a)&#125;,<span class="attr">up</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.handlers.drag.stopDown=!<span class="number">1</span>;<span class="keyword">this</span>._unselect&amp;&amp;(<span class="keyword">this</span>.unselectFeature(<span class="keyword">this</span>._unselect),<span class="keyword">delete</span> <span class="keyword">this</span>._unselect)&#125;,<span class="attr">done</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.vertex&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.dragComplete(<span class="keyword">this</span>.vertex)&#125;&#125;,c)&#125;&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.un(&#123;<span class="attr">removelayer</span>:<span class="keyword">this</span>.handleMapEvents,<span class="attr">changelayer</span>:<span class="keyword">this</span>.handleMapEvents,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">this</span>.layer=<span class="literal">null</span>;OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,[])&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.moveLayerToTop();<span class="keyword">this</span>.map.events.on(&#123;<span class="attr">removelayer</span>:<span class="keyword">this</span>.handleMapEvents,<span class="attr">changelayer</span>:<span class="keyword">this</span>.handleMapEvents,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">return</span> <span class="keyword">this</span>.handlers.keyboard.activate()&amp;&amp;<span class="keyword">this</span>.handlers.drag.activate()&amp;&amp;OpenLayers.Control.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,</span><br><span class="line">deactivate:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;OpenLayers.Control.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&amp;&amp;(<span class="keyword">this</span>.moveLayerBack(),<span class="keyword">this</span>.map.events.un(&#123;<span class="attr">removelayer</span>:<span class="keyword">this</span>.handleMapEvents,<span class="attr">changelayer</span>:<span class="keyword">this</span>.handleMapEvents,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;),<span class="keyword">this</span>.layer.removeFeatures(<span class="keyword">this</span>.vertices,&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;),<span class="keyword">this</span>.layer.removeFeatures(<span class="keyword">this</span>.virtualVertices,&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;),<span class="keyword">this</span>.vertices=[],<span class="keyword">this</span>.handlers.drag.deactivate(),<span class="keyword">this</span>.handlers.keyboard.deactivate(),(a=<span class="keyword">this</span>.feature)&amp;&amp;(a.geometry&amp;&amp;a.layer)&amp;&amp;<span class="keyword">this</span>.unselectFeature(a),a=!<span class="number">0</span>);<span class="keyword">return</span> a&#125;,<span class="attr">beforeSelectFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.layer.events.triggerEvent(<span class="string">"beforefeaturemodified"</span>,</span><br><span class="line">&#123;<span class="attr">feature</span>:a&#125;)&#125;,<span class="attr">selectFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!(<span class="keyword">this</span>.feature===a||<span class="keyword">this</span>.geometryTypes&amp;&amp;<span class="number">-1</span>==OpenLayers.Util.indexOf(<span class="keyword">this</span>.geometryTypes,a.geometry.CLASS_NAME)))&#123;!<span class="number">1</span>!==<span class="keyword">this</span>.beforeSelectFeature(a)&amp;&amp;(<span class="keyword">this</span>.feature&amp;&amp;<span class="keyword">this</span>.unselectFeature(<span class="keyword">this</span>.feature),<span class="keyword">this</span>.feature=a,<span class="keyword">this</span>.layer.selectedFeatures.push(a),<span class="keyword">this</span>.layer.drawFeature(a,<span class="string">"select"</span>),<span class="keyword">this</span>.modified=!<span class="number">1</span>,<span class="keyword">this</span>.resetVertices(),<span class="keyword">this</span>.onModificationStart(<span class="keyword">this</span>.feature));<span class="keyword">var</span> b=a.modified;!a.geometry||b&amp;&amp;b.geometry||(<span class="keyword">this</span>._originalGeometry=a.geometry.clone())&#125;&#125;,<span class="attr">unselectFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.layer.removeFeatures(<span class="keyword">this</span>.vertices,</span><br><span class="line">&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;);<span class="keyword">this</span>.vertices=[];<span class="keyword">this</span>.layer.destroyFeatures(<span class="keyword">this</span>.virtualVertices,&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;);<span class="keyword">this</span>.virtualVertices=[];<span class="keyword">this</span>.dragHandle&amp;&amp;(<span class="keyword">this</span>.layer.destroyFeatures([<span class="keyword">this</span>.dragHandle],&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;),<span class="keyword">delete</span> <span class="keyword">this</span>.dragHandle);<span class="keyword">this</span>.radiusHandle&amp;&amp;(<span class="keyword">this</span>.layer.destroyFeatures([<span class="keyword">this</span>.radiusHandle],&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;),<span class="keyword">delete</span> <span class="keyword">this</span>.radiusHandle);<span class="keyword">this</span>.layer.drawFeature(<span class="keyword">this</span>.feature,<span class="string">"default"</span>);<span class="keyword">this</span>.feature=<span class="literal">null</span>;OpenLayers.Util.removeItem(<span class="keyword">this</span>.layer.selectedFeatures,a);<span class="keyword">this</span>.onModificationEnd(a);<span class="keyword">this</span>.layer.events.triggerEvent(<span class="string">"afterfeaturemodified"</span>,</span><br><span class="line">&#123;<span class="attr">feature</span>:a,<span class="attr">modified</span>:<span class="keyword">this</span>.modified&#125;);<span class="keyword">this</span>.modified=!<span class="number">1</span>&#125;,<span class="attr">dragStart</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="string">"OpenLayers.Geometry.Point"</span>==a.geometry.CLASS_NAME;<span class="keyword">this</span>.standalone||(a._sketch||!b)&amp;&amp;a._sketch||(<span class="keyword">this</span>.toggle&amp;&amp;<span class="keyword">this</span>.feature===a&amp;&amp;(<span class="keyword">this</span>._unselect=a),<span class="keyword">this</span>.selectFeature(a));<span class="keyword">if</span>(a._sketch||b)<span class="keyword">this</span>.vertex=a,<span class="keyword">this</span>.handlers.drag.stopDown=!<span class="number">0</span>&#125;,<span class="attr">dragVertex</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.map.getLonLatFromViewPortPx(b),d=a.geometry;d.move(c.lon-d.x,c.lat-d.y);<span class="keyword">this</span>.modified=!<span class="number">0</span>;<span class="string">"OpenLayers.Geometry.Point"</span>==<span class="keyword">this</span>.feature.geometry.CLASS_NAME?</span><br><span class="line"><span class="keyword">this</span>.layer.events.triggerEvent(<span class="string">"vertexmodified"</span>,&#123;<span class="attr">vertex</span>:a.geometry,<span class="attr">feature</span>:<span class="keyword">this</span>.feature,<span class="attr">pixel</span>:b&#125;):(a._index?(a.geometry.parent.addComponent(a.geometry,a._index),<span class="keyword">delete</span> a._index,OpenLayers.Util.removeItem(<span class="keyword">this</span>.virtualVertices,a),<span class="keyword">this</span>.vertices.push(a)):a==<span class="keyword">this</span>.dragHandle?(<span class="keyword">this</span>.layer.removeFeatures(<span class="keyword">this</span>.vertices,&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;),<span class="keyword">this</span>.vertices=[],<span class="keyword">this</span>.radiusHandle&amp;&amp;(<span class="keyword">this</span>.layer.destroyFeatures([<span class="keyword">this</span>.radiusHandle],&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;),<span class="keyword">this</span>.radiusHandle=<span class="literal">null</span>)):a!==<span class="keyword">this</span>.radiusHandle&amp;&amp;<span class="keyword">this</span>.layer.events.triggerEvent(<span class="string">"vertexmodified"</span>,</span><br><span class="line">&#123;<span class="attr">vertex</span>:a.geometry,<span class="attr">feature</span>:<span class="keyword">this</span>.feature,<span class="attr">pixel</span>:b&#125;),<span class="number">0</span>&lt;<span class="keyword">this</span>.virtualVertices.length&amp;&amp;(<span class="keyword">this</span>.layer.destroyFeatures(<span class="keyword">this</span>.virtualVertices,&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;),<span class="keyword">this</span>.virtualVertices=[]),<span class="keyword">this</span>.layer.drawFeature(<span class="keyword">this</span>.feature,<span class="keyword">this</span>.standalone?<span class="keyword">void</span> <span class="number">0</span>:<span class="string">"select"</span>));<span class="keyword">this</span>.layer.drawFeature(a)&#125;,<span class="attr">dragComplete</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.resetVertices();<span class="keyword">this</span>.setFeatureState();<span class="keyword">this</span>.onModification(<span class="keyword">this</span>.feature);<span class="keyword">this</span>.layer.events.triggerEvent(<span class="string">"featuremodified"</span>,&#123;<span class="attr">feature</span>:<span class="keyword">this</span>.feature&#125;)&#125;,<span class="attr">setFeatureState</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.feature.state!=OpenLayers.State.INSERT&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.feature.state!=OpenLayers.State.DELETE&amp;&amp;(<span class="keyword">this</span>.feature.state=OpenLayers.State.UPDATE,<span class="keyword">this</span>.modified&amp;&amp;<span class="keyword">this</span>._originalGeometry))&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.feature;a.modified=OpenLayers.Util.extend(a.modified,&#123;<span class="attr">geometry</span>:<span class="keyword">this</span>._originalGeometry&#125;);<span class="keyword">delete</span> <span class="keyword">this</span>._originalGeometry&#125;&#125;,<span class="attr">resetVertices</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="number">0</span>&lt;<span class="keyword">this</span>.vertices.length&amp;&amp;(<span class="keyword">this</span>.layer.removeFeatures(<span class="keyword">this</span>.vertices,&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;),<span class="keyword">this</span>.vertices=[]);<span class="number">0</span>&lt;<span class="keyword">this</span>.virtualVertices.length&amp;&amp;(<span class="keyword">this</span>.layer.removeFeatures(<span class="keyword">this</span>.virtualVertices,&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;),<span class="keyword">this</span>.virtualVertices=[]);<span class="keyword">this</span>.dragHandle&amp;&amp;</span><br><span class="line">(<span class="keyword">this</span>.layer.destroyFeatures([<span class="keyword">this</span>.dragHandle],&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;),<span class="keyword">this</span>.dragHandle=<span class="literal">null</span>);<span class="keyword">this</span>.radiusHandle&amp;&amp;(<span class="keyword">this</span>.layer.destroyFeatures([<span class="keyword">this</span>.radiusHandle],&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;),<span class="keyword">this</span>.radiusHandle=<span class="literal">null</span>);<span class="keyword">this</span>.feature&amp;&amp;<span class="string">"OpenLayers.Geometry.Point"</span>!=<span class="keyword">this</span>.feature.geometry.CLASS_NAME&amp;&amp;(<span class="keyword">this</span>.mode&amp;OpenLayers.Control.ModifyFeature.DRAG&amp;&amp;<span class="keyword">this</span>.collectDragHandle(),<span class="keyword">this</span>.mode&amp;(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE)&amp;&amp;<span class="keyword">this</span>.collectRadiusHandle(),<span class="keyword">this</span>.mode&amp;OpenLayers.Control.ModifyFeature.RESHAPE&amp;&amp;</span><br><span class="line">(<span class="keyword">this</span>.mode&amp;OpenLayers.Control.ModifyFeature.RESIZE||<span class="keyword">this</span>.collectVertices()))&#125;,<span class="attr">handleKeypress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.keyCode;<span class="keyword">this</span>.feature&amp;&amp;<span class="number">-1</span>!=OpenLayers.Util.indexOf(<span class="keyword">this</span>.deleteCodes,b)&amp;&amp;(b=<span class="keyword">this</span>.layer.getFeatureFromEvent(<span class="keyword">this</span>.handlers.drag.evt))&amp;&amp;(<span class="number">-1</span>!=OpenLayers.Util.indexOf(<span class="keyword">this</span>.vertices,b)&amp;&amp;!<span class="keyword">this</span>.handlers.drag.dragging&amp;&amp;b.geometry.parent)&amp;&amp;(b.geometry.parent.removeComponent(b.geometry),<span class="keyword">this</span>.layer.events.triggerEvent(<span class="string">"vertexremoved"</span>,&#123;<span class="attr">vertex</span>:b.geometry,<span class="attr">feature</span>:<span class="keyword">this</span>.feature,<span class="attr">pixel</span>:a.xy&#125;),<span class="keyword">this</span>.layer.drawFeature(<span class="keyword">this</span>.feature,</span><br><span class="line"><span class="keyword">this</span>.standalone?<span class="keyword">void</span> <span class="number">0</span>:<span class="string">"select"</span>),<span class="keyword">this</span>.modified=!<span class="number">0</span>,<span class="keyword">this</span>.resetVertices(),<span class="keyword">this</span>.setFeatureState(),<span class="keyword">this</span>.onModification(<span class="keyword">this</span>.feature),<span class="keyword">this</span>.layer.events.triggerEvent(<span class="string">"featuremodified"</span>,&#123;<span class="attr">feature</span>:<span class="keyword">this</span>.feature&#125;))&#125;,<span class="attr">collectVertices</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">c</span>)</span>&#123;<span class="keyword">var</span> d,e,f;<span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.Point"</span>==c.CLASS_NAME)e=<span class="keyword">new</span> OpenLayers.Feature.Vector(c),e._sketch=!<span class="number">0</span>,e.renderIntent=b.vertexRenderIntent,b.vertices.push(e);<span class="keyword">else</span>&#123;f=c.components.length;<span class="string">"OpenLayers.Geometry.LinearRing"</span>==c.CLASS_NAME&amp;&amp;(f-=<span class="number">1</span>);<span class="keyword">for</span>(d=<span class="number">0</span>;d&lt;f;++d)e=</span><br><span class="line">c.components[d],<span class="string">"OpenLayers.Geometry.Point"</span>==e.CLASS_NAME?(e=<span class="keyword">new</span> OpenLayers.Feature.Vector(e),e._sketch=!<span class="number">0</span>,e.renderIntent=b.vertexRenderIntent,b.vertices.push(e)):a(e);<span class="keyword">if</span>(b.createVertices&amp;&amp;<span class="string">"OpenLayers.Geometry.MultiPoint"</span>!=c.CLASS_NAME)<span class="keyword">for</span>(d=<span class="number">0</span>,f=c.components.length;d&lt;f<span class="number">-1</span>;++d)&#123;e=c.components[d];<span class="keyword">var</span> g=c.components[d+<span class="number">1</span>];<span class="string">"OpenLayers.Geometry.Point"</span>==e.CLASS_NAME&amp;&amp;<span class="string">"OpenLayers.Geometry.Point"</span>==g.CLASS_NAME&amp;&amp;(e=<span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.Point((e.x+g.x)/<span class="number">2</span>,(e.y+g.y)/<span class="number">2</span>),<span class="literal">null</span>,b.virtualStyle),</span><br><span class="line">e.geometry.parent=c,e._index=d+<span class="number">1</span>,e._sketch=!<span class="number">0</span>,b.virtualVertices.push(e))&#125;&#125;&#125;<span class="keyword">this</span>.vertices=[];<span class="keyword">this</span>.virtualVertices=[];<span class="keyword">var</span> b=<span class="keyword">this</span>;a.call(<span class="keyword">this</span>,<span class="keyword">this</span>.feature.geometry);<span class="keyword">this</span>.layer.addFeatures(<span class="keyword">this</span>.virtualVertices,&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;);<span class="keyword">this</span>.layer.addFeatures(<span class="keyword">this</span>.vertices,&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;)&#125;,<span class="attr">collectDragHandle</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.feature.geometry,b=a.getBounds().getCenterLonLat(),b=<span class="keyword">new</span> OpenLayers.Geometry.Point(b.lon,b.lat),c=<span class="keyword">new</span> OpenLayers.Feature.Vector(b);b.move=<span class="function"><span class="keyword">function</span>(<span class="params">b,c</span>)</span>&#123;OpenLayers.Geometry.Point.prototype.move.call(<span class="keyword">this</span>,</span><br><span class="line">b,c);a.move(b,c)&#125;;c._sketch=!<span class="number">0</span>;<span class="keyword">this</span>.dragHandle=c;<span class="keyword">this</span>.dragHandle.renderIntent=<span class="keyword">this</span>.vertexRenderIntent;<span class="keyword">this</span>.layer.addFeatures([<span class="keyword">this</span>.dragHandle],&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;)&#125;,<span class="attr">collectRadiusHandle</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.feature.geometry,b=a.getBounds(),c=b.getCenterLonLat(),d=<span class="keyword">new</span> OpenLayers.Geometry.Point(c.lon,c.lat),b=<span class="keyword">new</span> OpenLayers.Geometry.Point(b.right,b.bottom),c=<span class="keyword">new</span> OpenLayers.Feature.Vector(b),e=<span class="keyword">this</span>.mode&amp;OpenLayers.Control.ModifyFeature.RESIZE,f=<span class="keyword">this</span>.mode&amp;OpenLayers.Control.ModifyFeature.RESHAPE,g=<span class="keyword">this</span>.mode&amp;</span><br><span class="line">OpenLayers.Control.ModifyFeature.ROTATE;b.move=<span class="function"><span class="keyword">function</span>(<span class="params">b,c</span>)</span>&#123;OpenLayers.Geometry.Point.prototype.move.call(<span class="keyword">this</span>,b,c);<span class="keyword">var</span> l=<span class="keyword">this</span>.x-d.x,m=<span class="keyword">this</span>.y-d.y,n=l-b,p=m-c;<span class="keyword">if</span>(g)&#123;<span class="keyword">var</span> q=<span class="built_in">Math</span>.atan2(p,n),q=<span class="built_in">Math</span>.atan2(m,l)-q,q=q*(<span class="number">180</span>/<span class="built_in">Math</span>.PI);a.rotate(q,d)&#125;<span class="keyword">if</span>(e)&#123;<span class="keyword">var</span> r;f?(m/=p,r=l/n/m):(n=<span class="built_in">Math</span>.sqrt(n*n+p*p),m=<span class="built_in">Math</span>.sqrt(l*l+m*m)/n);a.resize(m,d,r)&#125;&#125;;c._sketch=!<span class="number">0</span>;<span class="keyword">this</span>.radiusHandle=c;<span class="keyword">this</span>.radiusHandle.renderIntent=<span class="keyword">this</span>.vertexRenderIntent;<span class="keyword">this</span>.layer.addFeatures([<span class="keyword">this</span>.radiusHandle],&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;)&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.handlers.drag.setMap(a);</span><br><span class="line">OpenLayers.Control.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">handleMapEvents</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"removelayer"</span>!=a.type&amp;&amp;<span class="string">"order"</span>!=a.property||<span class="keyword">this</span>.moveLayerToTop()&#125;,<span class="attr">moveLayerToTop</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="built_in">Math</span>.max(<span class="keyword">this</span>.map.Z_INDEX_BASE.Feature<span class="number">-1</span>,<span class="keyword">this</span>.layer.getZIndex())+<span class="number">1</span>;<span class="keyword">this</span>.layer.setZIndex(a)&#125;,<span class="attr">moveLayerBack</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.layer.getZIndex()<span class="number">-1</span>;a&gt;=<span class="keyword">this</span>.map.Z_INDEX_BASE.Feature?<span class="keyword">this</span>.layer.setZIndex(a):<span class="keyword">this</span>.map.setLayerZIndex(<span class="keyword">this</span>.layer,<span class="keyword">this</span>.map.getLayerIndex(<span class="keyword">this</span>.layer))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.ModifyFeature"</span>&#125;);</span><br><span class="line">OpenLayers.Control.ModifyFeature.RESHAPE=<span class="number">1</span>;OpenLayers.Control.ModifyFeature.RESIZE=<span class="number">2</span>;OpenLayers.Control.ModifyFeature.ROTATE=<span class="number">4</span>;OpenLayers.Control.ModifyFeature.DRAG=<span class="number">8</span>;OpenLayers.Layer.Bing=OpenLayers.Class(OpenLayers.Layer.XYZ,&#123;<span class="attr">key</span>:<span class="literal">null</span>,<span class="attr">serverResolutions</span>:[<span class="number">156543.03390625</span>,<span class="number">78271.516953125</span>,<span class="number">39135.7584765625</span>,<span class="number">19567.87923828125</span>,<span class="number">9783.939619140625</span>,<span class="number">4891.9698095703125</span>,<span class="number">2445.9849047851562</span>,<span class="number">1222.9924523925781</span>,<span class="number">611.4962261962891</span>,<span class="number">305.74811309814453</span>,<span class="number">152.87405654907226</span>,<span class="number">76.43702827453613</span>,<span class="number">38.218514137268066</span>,<span class="number">19.109257068634033</span>,<span class="number">9.554628534317017</span>,<span class="number">4.777314267158508</span>,<span class="number">2.388657133579254</span>,<span class="number">1.194328566789627</span>,<span class="number">0.5971642833948135</span>,<span class="number">0.29858214169740677</span>,<span class="number">0.14929107084870338</span>,<span class="number">0.07464553542435169</span>],<span class="attr">attributionTemplate</span>:<span class="string">'&lt;span class="olBingAttribution $&#123;type&#125;"&gt;&lt;div&gt;&lt;a target="_blank" href="http://www.bing.com/maps/"&gt;&lt;img src="$&#123;logo&#125;" /&gt;&lt;/a&gt;&lt;/div&gt;$&#123;copyrights&#125;&lt;a style="white-space: nowrap" target="_blank" href="http://www.microsoft.com/maps/product/terms.html"&gt;Terms of Use&lt;/a&gt;&lt;/span&gt;'</span>,</span><br><span class="line">metadata:<span class="literal">null</span>,<span class="attr">protocolRegex</span>:<span class="regexp">/^http:/i</span>,<span class="attr">type</span>:<span class="string">"Road"</span>,<span class="attr">culture</span>:<span class="string">"en-US"</span>,<span class="attr">metadataParams</span>:<span class="literal">null</span>,<span class="attr">tileOptions</span>:<span class="literal">null</span>,<span class="attr">protocol</span>:~<span class="built_in">window</span>.location.href.indexOf(<span class="string">"http"</span>)?<span class="string">""</span>:<span class="string">"http:"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.applyDefaults(&#123;<span class="attr">sphericalMercator</span>:!<span class="number">0</span>&#125;,a);OpenLayers.Layer.XYZ.prototype.initialize.apply(<span class="keyword">this</span>,[a.name||<span class="string">"Bing "</span>+(a.type||<span class="keyword">this</span>.type),<span class="literal">null</span>,a]);<span class="keyword">this</span>.tileOptions=OpenLayers.Util.extend(&#123;<span class="attr">crossOriginKeyword</span>:<span class="string">"anonymous"</span>&#125;,<span class="keyword">this</span>.options.tileOptions);<span class="keyword">this</span>.loadMetadata()&#125;,<span class="attr">loadMetadata</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>._callbackId=</span><br><span class="line"><span class="string">"_callback_"</span>+<span class="keyword">this</span>.id.replace(<span class="regexp">/\./g</span>,<span class="string">"_"</span>);<span class="built_in">window</span>[<span class="keyword">this</span>._callbackId]=OpenLayers.Function.bind(OpenLayers.Layer.Bing.processMetadata,<span class="keyword">this</span>);<span class="keyword">var</span> a=OpenLayers.Util.applyDefaults(&#123;<span class="attr">key</span>:<span class="keyword">this</span>.key,<span class="attr">jsonp</span>:<span class="keyword">this</span>._callbackId,<span class="attr">include</span>:<span class="string">"ImageryProviders"</span>&#125;,<span class="keyword">this</span>.metadataParams),a=<span class="keyword">this</span>.protocol+<span class="string">"//dev.virtualearth.net/REST/v1/Imagery/Metadata/"</span>+<span class="keyword">this</span>.type+<span class="string">"?"</span>+OpenLayers.Util.getParameterString(a),b=<span class="built_in">document</span>.createElement(<span class="string">"script"</span>);b.type=<span class="string">"text/javascript"</span>;b.src=a;b.id=<span class="keyword">this</span>._callbackId;<span class="built_in">document</span>.getElementsByTagName(<span class="string">"head"</span>)[<span class="number">0</span>].appendChild(b)&#125;,</span><br><span class="line">initLayer:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.metadata.resourceSets[<span class="number">0</span>].resources[<span class="number">0</span>],b=a.imageUrl.replace(<span class="string">"&#123;quadkey&#125;"</span>,<span class="string">"$&#123;quadkey&#125;"</span>),b=b.replace(<span class="string">"&#123;culture&#125;"</span>,<span class="keyword">this</span>.culture),b=b.replace(<span class="keyword">this</span>.protocolRegex,<span class="keyword">this</span>.protocol);<span class="keyword">this</span>.url=[];<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>;c&lt;a.imageUrlSubdomains.length;++c)<span class="keyword">this</span>.url.push(b.replace(<span class="string">"&#123;subdomain&#125;"</span>,a.imageUrlSubdomains[c]));<span class="keyword">this</span>.addOptions(&#123;<span class="attr">maxResolution</span>:<span class="built_in">Math</span>.min(<span class="keyword">this</span>.serverResolutions[a.zoomMin],<span class="keyword">this</span>.maxResolution||<span class="built_in">Number</span>.POSITIVE_INFINITY),<span class="attr">numZoomLevels</span>:<span class="built_in">Math</span>.min(a.zoomMax+<span class="number">1</span>-a.zoomMin,<span class="keyword">this</span>.numZoomLevels)&#125;,</span><br><span class="line">!<span class="number">0</span>);<span class="keyword">this</span>.isBaseLayer||<span class="keyword">this</span>.redraw();<span class="keyword">this</span>.updateAttribution()&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.url)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getXYZ(a);a=b.x;<span class="keyword">for</span>(<span class="keyword">var</span> c=b.y,b=b.z,d=[],e=b;<span class="number">0</span>&lt;e;--e)&#123;<span class="keyword">var</span> f=<span class="string">"0"</span>,g=<span class="number">1</span>&lt;&lt;e<span class="number">-1</span>;<span class="number">0</span>!=(a&amp;g)&amp;&amp;f++;<span class="number">0</span>!=(c&amp;g)&amp;&amp;(f++,f++);d.push(f)&#125;d=d.join(<span class="string">""</span>);a=<span class="keyword">this</span>.selectUrl(<span class="string">""</span>+a+c+b,<span class="keyword">this</span>.url);<span class="keyword">return</span> OpenLayers.String.format(a,&#123;<span class="attr">quadkey</span>:d&#125;)&#125;&#125;,<span class="attr">updateAttribution</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.metadata;<span class="keyword">if</span>(a.resourceSets&amp;&amp;<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.center)&#123;<span class="keyword">var</span> b=a.resourceSets[<span class="number">0</span>].resources[<span class="number">0</span>],c=<span class="keyword">this</span>.map.getExtent().transform(<span class="keyword">this</span>.map.getProjectionObject(),</span><br><span class="line"><span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>)),d=b.imageryProviders||[],e=OpenLayers.Util.indexOf(<span class="keyword">this</span>.serverResolutions,<span class="keyword">this</span>.getServerResolution()),b=<span class="string">""</span>,f,g,h,k,l,m,n;g=<span class="number">0</span>;<span class="keyword">for</span>(h=d.length;g&lt;h;++g)<span class="keyword">for</span>(f=d[g],k=<span class="number">0</span>,l=f.coverageAreas.length;k&lt;l;++k)n=f.coverageAreas[k],m=OpenLayers.Bounds.fromArray(n.bbox,!<span class="number">0</span>),c.intersectsBounds(m)&amp;&amp;(e&lt;=n.zoomMax&amp;&amp;e&gt;=n.zoomMin)&amp;&amp;(b+=f.attribution+<span class="string">" "</span>);a=a.brandLogoUri.replace(<span class="keyword">this</span>.protocolRegex,<span class="keyword">this</span>.protocol);<span class="keyword">this</span>.attribution=OpenLayers.String.format(<span class="keyword">this</span>.attributionTemplate,&#123;<span class="attr">type</span>:<span class="keyword">this</span>.type.toLowerCase(),</span><br><span class="line">logo:a,<span class="attr">copyrights</span>:b&#125;);<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.triggerEvent(<span class="string">"changelayer"</span>,&#123;<span class="attr">layer</span>:<span class="keyword">this</span>,<span class="attr">property</span>:<span class="string">"attribution"</span>&#125;)&#125;&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Layer.XYZ.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.map.events.register(<span class="string">"moveend"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.updateAttribution)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.Bing(<span class="keyword">this</span>.options));<span class="keyword">return</span> a=OpenLayers.Layer.XYZ.prototype.clone.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.unregister(<span class="string">"moveend"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.updateAttribution);OpenLayers.Layer.XYZ.prototype.destroy.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.Bing"</span>&#125;);OpenLayers.Layer.Bing.processMetadata=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.metadata=a;<span class="keyword">this</span>.initLayer();a=<span class="built_in">document</span>.getElementById(<span class="keyword">this</span>._callbackId);a.parentNode.removeChild(a);<span class="built_in">window</span>[<span class="keyword">this</span>._callbackId]=<span class="keyword">void</span> <span class="number">0</span>;<span class="keyword">delete</span> <span class="keyword">this</span>._callbackId&#125;;OpenLayers.StyleMap=OpenLayers.Class(&#123;<span class="attr">styles</span>:<span class="literal">null</span>,<span class="attr">extendDefault</span>:!<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.styles=&#123;<span class="string">"default"</span>:<span class="keyword">new</span> OpenLayers.Style(OpenLayers.Feature.Vector.style[<span class="string">"default"</span>]),<span class="attr">select</span>:<span class="keyword">new</span> OpenLayers.Style(OpenLayers.Feature.Vector.style.select),<span class="attr">temporary</span>:<span class="keyword">new</span> OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),<span class="string">"delete"</span>:<span class="keyword">new</span> OpenLayers.Style(OpenLayers.Feature.Vector.style[<span class="string">"delete"</span>])&#125;;<span class="keyword">if</span>(a <span class="keyword">instanceof</span> OpenLayers.Style)<span class="keyword">this</span>.styles[<span class="string">"default"</span>]=a,<span class="keyword">this</span>.styles.select=a,<span class="keyword">this</span>.styles.temporary=a,<span class="keyword">this</span>.styles[<span class="string">"delete"</span>]=</span><br><span class="line">a;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"object"</span>==<span class="keyword">typeof</span> a)<span class="keyword">for</span>(<span class="keyword">var</span> c <span class="keyword">in</span> a)<span class="keyword">if</span>(a[c]<span class="keyword">instanceof</span> OpenLayers.Style)<span class="keyword">this</span>.styles[c]=a[c];<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"object"</span>==<span class="keyword">typeof</span> a[c])<span class="keyword">this</span>.styles[c]=<span class="keyword">new</span> OpenLayers.Style(a[c]);<span class="keyword">else</span>&#123;<span class="keyword">this</span>.styles[<span class="string">"default"</span>]=<span class="keyword">new</span> OpenLayers.Style(a);<span class="keyword">this</span>.styles.select=<span class="keyword">new</span> OpenLayers.Style(a);<span class="keyword">this</span>.styles.temporary=<span class="keyword">new</span> OpenLayers.Style(a);<span class="keyword">this</span>.styles[<span class="string">"delete"</span>]=<span class="keyword">new</span> OpenLayers.Style(a);<span class="keyword">break</span>&#125;OpenLayers.Util.extend(<span class="keyword">this</span>,b)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a <span class="keyword">in</span> <span class="keyword">this</span>.styles)<span class="keyword">this</span>.styles[a].destroy();<span class="keyword">this</span>.styles=<span class="literal">null</span>&#125;,<span class="attr">createSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;a||(a=<span class="keyword">new</span> OpenLayers.Feature.Vector);<span class="keyword">this</span>.styles[b]||(b=<span class="string">"default"</span>);a.renderIntent=b;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.extendDefault&amp;&amp;<span class="string">"default"</span>!=b&amp;&amp;(c=<span class="keyword">this</span>.styles[<span class="string">"default"</span>].createSymbolizer(a));<span class="keyword">return</span> OpenLayers.Util.extend(c,<span class="keyword">this</span>.styles[b].createSymbolizer(a))&#125;,<span class="attr">addUniqueValueRules</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">var</span> e=[],f;<span class="keyword">for</span>(f <span class="keyword">in</span> c)e.push(<span class="keyword">new</span> OpenLayers.Rule(&#123;<span class="attr">symbolizer</span>:c[f],<span class="attr">context</span>:d,<span class="attr">filter</span>:<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">type</span>:OpenLayers.Filter.Comparison.EQUAL_TO,<span class="attr">property</span>:b,<span class="attr">value</span>:f&#125;)&#125;));<span class="keyword">this</span>.styles[a].addRules(e)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.StyleMap"</span>&#125;);OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,&#123;<span class="attr">isBaseLayer</span>:!<span class="number">1</span>,<span class="attr">isFixed</span>:!<span class="number">1</span>,<span class="attr">features</span>:<span class="literal">null</span>,<span class="attr">filter</span>:<span class="literal">null</span>,<span class="attr">selectedFeatures</span>:<span class="literal">null</span>,<span class="attr">unrenderedFeatures</span>:<span class="literal">null</span>,<span class="attr">reportError</span>:!<span class="number">0</span>,<span class="attr">style</span>:<span class="literal">null</span>,<span class="attr">styleMap</span>:<span class="literal">null</span>,<span class="attr">strategies</span>:<span class="literal">null</span>,<span class="attr">protocol</span>:<span class="literal">null</span>,<span class="attr">renderers</span>:[<span class="string">"SVG"</span>,<span class="string">"VML"</span>,<span class="string">"Canvas"</span>],<span class="attr">renderer</span>:<span class="literal">null</span>,<span class="attr">rendererOptions</span>:<span class="literal">null</span>,<span class="attr">geometryType</span>:<span class="literal">null</span>,<span class="attr">drawn</span>:!<span class="number">1</span>,<span class="attr">ratio</span>:<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Layer.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.renderer&amp;&amp;<span class="keyword">this</span>.renderer.supported()||<span class="keyword">this</span>.assignRenderer();<span class="keyword">this</span>.renderer&amp;&amp;<span class="keyword">this</span>.renderer.supported()||</span><br><span class="line">(<span class="keyword">this</span>.renderer=<span class="literal">null</span>,<span class="keyword">this</span>.displayError());<span class="keyword">this</span>.styleMap||(<span class="keyword">this</span>.styleMap=<span class="keyword">new</span> OpenLayers.StyleMap);<span class="keyword">this</span>.features=[];<span class="keyword">this</span>.selectedFeatures=[];<span class="keyword">this</span>.unrenderedFeatures=&#123;&#125;;<span class="keyword">if</span>(<span class="keyword">this</span>.strategies)<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.strategies.length;c&lt;d;c++)<span class="keyword">this</span>.strategies[c].setLayer(<span class="keyword">this</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.strategies)&#123;<span class="keyword">var</span> a,b,c;b=<span class="number">0</span>;<span class="keyword">for</span>(c=<span class="keyword">this</span>.strategies.length;b&lt;c;b++)a=<span class="keyword">this</span>.strategies[b],a.autoDestroy&amp;&amp;a.destroy();<span class="keyword">this</span>.strategies=<span class="literal">null</span>&#125;<span class="keyword">this</span>.protocol&amp;&amp;(<span class="keyword">this</span>.protocol.autoDestroy&amp;&amp;<span class="keyword">this</span>.protocol.destroy(),<span class="keyword">this</span>.protocol=</span><br><span class="line"><span class="literal">null</span>);<span class="keyword">this</span>.destroyFeatures();<span class="keyword">this</span>.unrenderedFeatures=<span class="keyword">this</span>.selectedFeatures=<span class="keyword">this</span>.features=<span class="literal">null</span>;<span class="keyword">this</span>.renderer&amp;&amp;<span class="keyword">this</span>.renderer.destroy();<span class="keyword">this</span>.drawn=<span class="keyword">this</span>.geometryType=<span class="keyword">this</span>.renderer=<span class="literal">null</span>;OpenLayers.Layer.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.Vector(<span class="keyword">this</span>.name,<span class="keyword">this</span>.getOptions()));a=OpenLayers.Layer.prototype.clone.apply(<span class="keyword">this</span>,[a]);<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.features,c=b.length,d=<span class="built_in">Array</span>(c),e=<span class="number">0</span>;e&lt;c;++e)d[e]=b[e].clone();a.features=d;<span class="keyword">return</span> a&#125;,<span class="attr">refresh</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.calculateInRange()&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.visibility&amp;&amp;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"refresh"</span>,a)&#125;,<span class="attr">assignRenderer</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="keyword">this</span>.renderers.length;a&lt;b;a++)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.renderers[a];<span class="keyword">if</span>((c=<span class="string">"function"</span>==<span class="keyword">typeof</span> c?c:OpenLayers.Renderer[c])&amp;&amp;c.prototype.supported())&#123;<span class="keyword">this</span>.renderer=<span class="keyword">new</span> c(<span class="keyword">this</span>.div,<span class="keyword">this</span>.rendererOptions);<span class="keyword">break</span>&#125;&#125;&#125;,<span class="attr">displayError</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.reportError&amp;&amp;OpenLayers.Console.userError(OpenLayers.i18n(<span class="string">"browserNotSupported"</span>,&#123;<span class="attr">renderers</span>:<span class="keyword">this</span>.renderers.join(<span class="string">"\n"</span>)&#125;))&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Layer.prototype.setMap.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>);<span class="keyword">if</span>(<span class="keyword">this</span>.renderer)&#123;<span class="keyword">this</span>.renderer.map=<span class="keyword">this</span>.map;<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getSize();b.w*=<span class="keyword">this</span>.ratio;b.h*=<span class="keyword">this</span>.ratio;<span class="keyword">this</span>.renderer.setSize(b)&#125;<span class="keyword">else</span> <span class="keyword">this</span>.map.removeLayer(<span class="keyword">this</span>)&#125;,<span class="attr">afterAdd</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.strategies)&#123;<span class="keyword">var</span> a,b,c;b=<span class="number">0</span>;<span class="keyword">for</span>(c=<span class="keyword">this</span>.strategies.length;b&lt;c;b++)a=<span class="keyword">this</span>.strategies[b],a.autoActivate&amp;&amp;a.activate()&#125;&#125;,<span class="attr">removeMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.drawn=!<span class="number">1</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.strategies)&#123;<span class="keyword">var</span> b,c;b=<span class="number">0</span>;<span class="keyword">for</span>(c=<span class="keyword">this</span>.strategies.length;b&lt;c;b++)a=<span class="keyword">this</span>.strategies[b],a.autoActivate&amp;&amp;a.deactivate()&#125;&#125;,<span class="attr">onMapResize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Layer.prototype.onMapResize.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>);<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getSize();a.w*=<span class="keyword">this</span>.ratio;a.h*=<span class="keyword">this</span>.ratio;<span class="keyword">this</span>.renderer.setSize(a)&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Layer.prototype.moveTo.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">var</span> d=!<span class="number">0</span>;<span class="keyword">if</span>(!c)&#123;<span class="keyword">this</span>.renderer.root.style.visibility=<span class="string">"hidden"</span>;<span class="keyword">var</span> d=<span class="keyword">this</span>.map.getSize(),e=d.w,d=d.h,e=e/<span class="number">2</span>*<span class="keyword">this</span>.ratio-e/<span class="number">2</span>,d=d/<span class="number">2</span>*<span class="keyword">this</span>.ratio-d/<span class="number">2</span>,e=e+<span class="keyword">this</span>.map.layerContainerOriginPx.x,e=-<span class="built_in">Math</span>.round(e),d=d+<span class="keyword">this</span>.map.layerContainerOriginPx.y,d=-<span class="built_in">Math</span>.round(d);<span class="keyword">this</span>.div.style.left=e+<span class="string">"px"</span>;<span class="keyword">this</span>.div.style.top=d+<span class="string">"px"</span>;e=<span class="keyword">this</span>.map.getExtent().scale(<span class="keyword">this</span>.ratio);</span><br><span class="line">d=<span class="keyword">this</span>.renderer.setExtent(e,b);<span class="keyword">this</span>.renderer.root.style.visibility=<span class="string">"visible"</span>;!<span class="number">0</span>===OpenLayers.IS_GECKO&amp;&amp;(<span class="keyword">this</span>.div.scrollLeft=<span class="keyword">this</span>.div.scrollLeft);<span class="keyword">if</span>(!b&amp;&amp;d)<span class="keyword">for</span>(<span class="keyword">var</span> f <span class="keyword">in</span> <span class="keyword">this</span>.unrenderedFeatures)e=<span class="keyword">this</span>.unrenderedFeatures[f],<span class="keyword">this</span>.drawFeature(e)&#125;<span class="keyword">if</span>(!<span class="keyword">this</span>.drawn||b||!d)<span class="keyword">for</span>(<span class="keyword">this</span>.drawn=!<span class="number">0</span>,f=<span class="number">0</span>,d=<span class="keyword">this</span>.features.length;f&lt;d;f++)<span class="keyword">this</span>.renderer.locked=f!==d<span class="number">-1</span>,e=<span class="keyword">this</span>.features[f],<span class="keyword">this</span>.drawFeature(e)&#125;,<span class="attr">display</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Layer.prototype.display.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">var</span> b=<span class="keyword">this</span>.div.style.display;b!=<span class="keyword">this</span>.renderer.root.style.display&amp;&amp;</span><br><span class="line">(<span class="keyword">this</span>.renderer.root.style.display=b)&#125;,<span class="attr">addFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Util.isArray(a)||(a=[a]);<span class="keyword">var</span> c=!b||!b.silent;<span class="keyword">if</span>(c)&#123;<span class="keyword">var</span> d=&#123;<span class="attr">features</span>:a&#125;;<span class="keyword">if</span>(!<span class="number">1</span>===<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforefeaturesadded"</span>,d))<span class="keyword">return</span>;a=d.features&#125;<span class="keyword">for</span>(<span class="keyword">var</span> d=[],e=<span class="number">0</span>,f=a.length;e&lt;f;e++)&#123;<span class="keyword">this</span>.renderer.locked=e!=a.length<span class="number">-1</span>?!<span class="number">0</span>:!<span class="number">1</span>;<span class="keyword">var</span> g=a[e];<span class="keyword">if</span>(<span class="keyword">this</span>.geometryType&amp;&amp;!(g.geometry <span class="keyword">instanceof</span> <span class="keyword">this</span>.geometryType))<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"addFeatures: component should be an "</span>+<span class="keyword">this</span>.geometryType.prototype.CLASS_NAME);g.layer=<span class="keyword">this</span>;!g.style&amp;&amp;<span class="keyword">this</span>.style&amp;&amp;</span><br><span class="line">(g.style=OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>.style));<span class="keyword">if</span>(c)&#123;<span class="keyword">if</span>(!<span class="number">1</span>===<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforefeatureadded"</span>,&#123;<span class="attr">feature</span>:g&#125;))<span class="keyword">continue</span>;<span class="keyword">this</span>.preFeatureInsert(g)&#125;d.push(g);<span class="keyword">this</span>.features.push(g);<span class="keyword">this</span>.drawFeature(g);c&amp;&amp;(<span class="keyword">this</span>.events.triggerEvent(<span class="string">"featureadded"</span>,&#123;<span class="attr">feature</span>:g&#125;),<span class="keyword">this</span>.onFeatureInsert(g))&#125;c&amp;&amp;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"featuresadded"</span>,&#123;<span class="attr">features</span>:d&#125;)&#125;,<span class="attr">removeFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(a&amp;&amp;<span class="number">0</span>!==a.length)&#123;<span class="keyword">if</span>(a===<span class="keyword">this</span>.features)<span class="keyword">return</span> <span class="keyword">this</span>.removeAllFeatures(b);OpenLayers.Util.isArray(a)||(a=[a]);a===<span class="keyword">this</span>.selectedFeatures&amp;&amp;</span><br><span class="line">(a=a.slice());<span class="keyword">var</span> c=!b||!b.silent;c&amp;&amp;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforefeaturesremoved"</span>,&#123;<span class="attr">features</span>:a&#125;);<span class="keyword">for</span>(<span class="keyword">var</span> d=a.length<span class="number">-1</span>;<span class="number">0</span>&lt;=d;d--)&#123;<span class="keyword">this</span>.renderer.locked=<span class="number">0</span>!=d&amp;&amp;a[d<span class="number">-1</span>].geometry?!<span class="number">0</span>:!<span class="number">1</span>;<span class="keyword">var</span> e=a[d];<span class="keyword">delete</span> <span class="keyword">this</span>.unrenderedFeatures[e.id];c&amp;&amp;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforefeatureremoved"</span>,&#123;<span class="attr">feature</span>:e&#125;);<span class="keyword">this</span>.features=OpenLayers.Util.removeItem(<span class="keyword">this</span>.features,e);e.layer=<span class="literal">null</span>;e.geometry&amp;&amp;<span class="keyword">this</span>.renderer.eraseFeatures(e);<span class="number">-1</span>!=OpenLayers.Util.indexOf(<span class="keyword">this</span>.selectedFeatures,e)&amp;&amp;OpenLayers.Util.removeItem(<span class="keyword">this</span>.selectedFeatures,</span><br><span class="line">e);c&amp;&amp;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"featureremoved"</span>,&#123;<span class="attr">feature</span>:e&#125;)&#125;c&amp;&amp;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"featuresremoved"</span>,&#123;<span class="attr">features</span>:a&#125;)&#125;&#125;,<span class="attr">removeAllFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=!a||!a.silent;<span class="keyword">var</span> b=<span class="keyword">this</span>.features;a&amp;&amp;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforefeaturesremoved"</span>,&#123;<span class="attr">features</span>:b&#125;);<span class="keyword">for</span>(<span class="keyword">var</span> c,d=b.length<span class="number">-1</span>;<span class="number">0</span>&lt;=d;d--)c=b[d],a&amp;&amp;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforefeatureremoved"</span>,&#123;<span class="attr">feature</span>:c&#125;),c.layer=<span class="literal">null</span>,a&amp;&amp;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"featureremoved"</span>,&#123;<span class="attr">feature</span>:c&#125;);<span class="keyword">this</span>.renderer.clear();<span class="keyword">this</span>.features=[];<span class="keyword">this</span>.unrenderedFeatures=&#123;&#125;;<span class="keyword">this</span>.selectedFeatures=</span><br><span class="line">[];a&amp;&amp;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"featuresremoved"</span>,&#123;<span class="attr">features</span>:b&#125;)&#125;,<span class="attr">destroyFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">void</span> <span class="number">0</span>==a&amp;&amp;(a=<span class="keyword">this</span>.features);<span class="keyword">if</span>(a)&#123;<span class="keyword">this</span>.removeFeatures(a,b);<span class="keyword">for</span>(<span class="keyword">var</span> c=a.length<span class="number">-1</span>;<span class="number">0</span>&lt;=c;c--)a[c].destroy()&#125;&#125;,<span class="attr">drawFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.drawn)&#123;<span class="keyword">if</span>(<span class="string">"object"</span>!=<span class="keyword">typeof</span> b)&#123;b||a.state!==OpenLayers.State.DELETE||(b=<span class="string">"delete"</span>);<span class="keyword">var</span> c=b||a.renderIntent;(b=a.style||<span class="keyword">this</span>.style)||(b=<span class="keyword">this</span>.styleMap.createSymbolizer(a,c))&#125;c=<span class="keyword">this</span>.renderer.drawFeature(a,b);!<span class="number">1</span>===c||<span class="literal">null</span>===c?<span class="keyword">this</span>.unrenderedFeatures[a.id]=a:<span class="keyword">delete</span> <span class="keyword">this</span>.unrenderedFeatures[a.id]&#125;&#125;,</span><br><span class="line">eraseFeatures:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.renderer.eraseFeatures(a)&#125;,<span class="attr">getFeatureFromEvent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.renderer)<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it."</span>);<span class="keyword">var</span> b=<span class="literal">null</span>;(a=<span class="keyword">this</span>.renderer.getFeatureIdFromEvent(a))&amp;&amp;(b=<span class="string">"string"</span>===<span class="keyword">typeof</span> a?<span class="keyword">this</span>.getFeatureById(a):a);<span class="keyword">return</span> b&#125;,<span class="attr">getFeatureBy</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="literal">null</span>,d=<span class="number">0</span>,e=<span class="keyword">this</span>.features.length;d&lt;e;++d)<span class="keyword">if</span>(<span class="keyword">this</span>.features[d][a]==b)&#123;c=<span class="keyword">this</span>.features[d];</span><br><span class="line"><span class="keyword">break</span>&#125;<span class="keyword">return</span> c&#125;,<span class="attr">getFeatureById</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.getFeatureBy(<span class="string">"id"</span>,a)&#125;,<span class="attr">getFeatureByFid</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.getFeatureBy(<span class="string">"fid"</span>,a)&#125;,<span class="attr">getFeaturesByAttribute</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c,d,e=<span class="keyword">this</span>.features.length,f=[];<span class="keyword">for</span>(c=<span class="number">0</span>;c&lt;e;c++)(d=<span class="keyword">this</span>.features[c])&amp;&amp;d.attributes&amp;&amp;d.attributes[a]===b&amp;&amp;f.push(d);<span class="keyword">return</span> f&#125;,<span class="attr">onFeatureInsert</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">preFeatureInsert</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">getDataExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="literal">null</span>,b=<span class="keyword">this</span>.features;<span class="keyword">if</span>(b&amp;&amp;<span class="number">0</span>&lt;b.length)<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="literal">null</span>,d=<span class="number">0</span>,e=b.length;d&lt;e;d++)<span class="keyword">if</span>(c=b[d].geometry)<span class="literal">null</span>===a&amp;&amp;</span><br><span class="line">(a=<span class="keyword">new</span> OpenLayers.Bounds),a.extend(c.getBounds());<span class="keyword">return</span> a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.Vector"</span>&#125;);OpenLayers.Layer.PointGrid=OpenLayers.Class(OpenLayers.Layer.Vector,&#123;<span class="attr">dx</span>:<span class="literal">null</span>,<span class="attr">dy</span>:<span class="literal">null</span>,<span class="attr">ratio</span>:<span class="number">1.5</span>,<span class="attr">maxFeatures</span>:<span class="number">250</span>,<span class="attr">rotation</span>:<span class="number">0</span>,<span class="attr">origin</span>:<span class="literal">null</span>,<span class="attr">gridBounds</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||&#123;&#125;;OpenLayers.Layer.Vector.prototype.initialize.apply(<span class="keyword">this</span>,[a.name,a])&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Layer.Vector.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);a.events.register(<span class="string">"moveend"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onMoveEnd)&#125;,<span class="attr">removeMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.events.unregister(<span class="string">"moveend"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onMoveEnd);OpenLayers.Layer.Vector.prototype.removeMap.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>)&#125;,<span class="attr">setRatio</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.ratio=a;<span class="keyword">this</span>.updateGrid(!<span class="number">0</span>)&#125;,<span class="attr">setMaxFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.maxFeatures=a;<span class="keyword">this</span>.updateGrid(!<span class="number">0</span>)&#125;,<span class="attr">setSpacing</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.dx=a;<span class="keyword">this</span>.dy=b||a;<span class="keyword">this</span>.updateGrid(!<span class="number">0</span>)&#125;,<span class="attr">setOrigin</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.origin=a;<span class="keyword">this</span>.updateGrid(!<span class="number">0</span>)&#125;,<span class="attr">getOrigin</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.origin||(<span class="keyword">this</span>.origin=<span class="keyword">this</span>.map.getExtent().getCenterLonLat());<span class="keyword">return</span> <span class="keyword">this</span>.origin&#125;,<span class="attr">setRotation</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.rotation=a;<span class="keyword">this</span>.updateGrid(!<span class="number">0</span>)&#125;,<span class="attr">onMoveEnd</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.updateGrid()&#125;,<span class="attr">getViewBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getExtent();</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">this</span>.rotation)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getOrigin(),b=<span class="keyword">new</span> OpenLayers.Geometry.Point(b.lon,b.lat),a=a.toGeometry();a.rotate(-<span class="keyword">this</span>.rotation,b);a=a.getBounds()&#125;<span class="keyword">return</span> a&#125;,<span class="attr">updateGrid</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a||<span class="keyword">this</span>.invalidBounds())&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getViewBounds(),c=<span class="keyword">this</span>.getOrigin();a=<span class="keyword">new</span> OpenLayers.Geometry.Point(c.lon,c.lat);<span class="keyword">var</span> d=b.getWidth(),e=b.getHeight(),f=d/e,g=<span class="built_in">Math</span>.sqrt(<span class="keyword">this</span>.dx*<span class="keyword">this</span>.dy*<span class="keyword">this</span>.maxFeatures/f),d=<span class="built_in">Math</span>.min(d*<span class="keyword">this</span>.ratio,g*f),e=<span class="built_in">Math</span>.min(e*<span class="keyword">this</span>.ratio,g),b=b.getCenterLonLat();<span class="keyword">this</span>.gridBounds=<span class="keyword">new</span> OpenLayers.Bounds(b.lon-</span><br><span class="line">d/<span class="number">2</span>,b.lat-e/<span class="number">2</span>,b.lon+d/<span class="number">2</span>,b.lat+e/<span class="number">2</span>);<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="built_in">Math</span>.floor(e/<span class="keyword">this</span>.dy),d=<span class="built_in">Math</span>.floor(d/<span class="keyword">this</span>.dx),e=c.lon+<span class="keyword">this</span>.dx*<span class="built_in">Math</span>.ceil((<span class="keyword">this</span>.gridBounds.left-c.lon)/<span class="keyword">this</span>.dx),c=c.lat+<span class="keyword">this</span>.dy*<span class="built_in">Math</span>.ceil((<span class="keyword">this</span>.gridBounds.bottom-c.lat)/<span class="keyword">this</span>.dy),g=<span class="built_in">Array</span>(b*d),h,k=<span class="number">0</span>;k&lt;d;++k)<span class="keyword">for</span>(<span class="keyword">var</span> f=e+k*<span class="keyword">this</span>.dx,l=<span class="number">0</span>;l&lt;b;++l)h=c+l*<span class="keyword">this</span>.dy,h=<span class="keyword">new</span> OpenLayers.Geometry.Point(f,h),<span class="keyword">this</span>.rotation&amp;&amp;h.rotate(<span class="keyword">this</span>.rotation,a),g[k*b+l]=<span class="keyword">new</span> OpenLayers.Feature.Vector(h);<span class="keyword">this</span>.destroyFeatures(<span class="keyword">this</span>.features,&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;);<span class="keyword">this</span>.addFeatures(g,&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;)&#125;&#125;,<span class="attr">invalidBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>!<span class="keyword">this</span>.gridBounds||</span><br><span class="line">!<span class="keyword">this</span>.gridBounds.containsBounds(<span class="keyword">this</span>.getViewBounds())&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.PointGrid"</span>&#125;);OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,&#123;<span class="attr">wheelListener</span>:<span class="literal">null</span>,<span class="attr">interval</span>:<span class="number">0</span>,<span class="attr">maxDelta</span>:<span class="built_in">Number</span>.POSITIVE_INFINITY,<span class="attr">delta</span>:<span class="number">0</span>,<span class="attr">cumulative</span>:!<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Handler.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.wheelListener=OpenLayers.Function.bindAsEventListener(<span class="keyword">this</span>.onWheelEvent,<span class="keyword">this</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Handler.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.wheelListener=<span class="literal">null</span>&#125;,<span class="attr">onWheelEvent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.checkModifiers(a))&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=</span><br><span class="line">!<span class="number">1</span>,c=!<span class="number">1</span>,d=!<span class="number">1</span>,e=OpenLayers.Event.element(a);<span class="literal">null</span>!=e&amp;&amp;!d&amp;&amp;!b;)&#123;<span class="keyword">if</span>(!b)<span class="keyword">try</span>&#123;<span class="keyword">var</span> f,b=(f=e.currentStyle?e.currentStyle.overflow:<span class="built_in">document</span>.defaultView.getComputedStyle(e,<span class="literal">null</span>).getPropertyValue(<span class="string">"overflow"</span>))&amp;&amp;<span class="string">"auto"</span>==f||<span class="string">"scroll"</span>==f&#125;<span class="keyword">catch</span>(g)&#123;&#125;<span class="keyword">if</span>(!c&amp;&amp;(c=OpenLayers.Element.hasClass(e,<span class="string">"olScrollable"</span>),!c))<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,h=<span class="keyword">this</span>.map.layers.length;d&lt;h;d++)&#123;<span class="keyword">var</span> k=<span class="keyword">this</span>.map.layers[d];<span class="keyword">if</span>(e==k.div||e==k.pane)&#123;c=!<span class="number">0</span>;<span class="keyword">break</span>&#125;&#125;d=e==<span class="keyword">this</span>.map.div;e=e.parentNode&#125;<span class="keyword">if</span>(!b&amp;&amp;d)&#123;<span class="keyword">if</span>(c)<span class="keyword">if</span>(b=<span class="number">0</span>,a.wheelDelta?(b=a.wheelDelta,<span class="number">0</span>===b%<span class="number">160</span>&amp;&amp;(b*=<span class="number">0.75</span>),</span><br><span class="line">b/=<span class="number">120</span>):a.detail&amp;&amp;(b=-(a.detail/<span class="built_in">Math</span>.abs(a.detail))),<span class="keyword">this</span>.delta+=b,<span class="built_in">window</span>.clearTimeout(<span class="keyword">this</span>._timeoutId),<span class="keyword">this</span>.interval&amp;&amp;<span class="built_in">Math</span>.abs(<span class="keyword">this</span>.delta)&lt;<span class="keyword">this</span>.maxDelta)&#123;<span class="keyword">var</span> l=OpenLayers.Util.extend(&#123;&#125;,a);<span class="keyword">this</span>._timeoutId=<span class="built_in">window</span>.setTimeout(OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.wheelZoom(l)&#125;,<span class="keyword">this</span>),<span class="keyword">this</span>.interval)&#125;<span class="keyword">else</span> <span class="keyword">this</span>.wheelZoom(a);OpenLayers.Event.stop(a)&#125;&#125;&#125;,<span class="attr">wheelZoom</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.delta;<span class="keyword">this</span>.delta=<span class="number">0</span>;b&amp;&amp;(a.xy=<span class="keyword">this</span>.map.events.getMousePosition(a),<span class="number">0</span>&gt;b?<span class="keyword">this</span>.callback(<span class="string">"down"</span>,[a,<span class="keyword">this</span>.cumulative?<span class="built_in">Math</span>.max(-<span class="keyword">this</span>.maxDelta,</span><br><span class="line">b):<span class="number">-1</span>]):<span class="keyword">this</span>.callback(<span class="string">"up"</span>,[a,<span class="keyword">this</span>.cumulative?<span class="built_in">Math</span>.min(<span class="keyword">this</span>.maxDelta,b):<span class="number">1</span>]))&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(OpenLayers.Handler.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>))&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.wheelListener;OpenLayers.Event.observe(<span class="built_in">window</span>,<span class="string">"DOMMouseScroll"</span>,b);OpenLayers.Event.observe(<span class="built_in">window</span>,<span class="string">"mousewheel"</span>,b);OpenLayers.Event.observe(<span class="built_in">document</span>,<span class="string">"mousewheel"</span>,b);<span class="keyword">return</span>!<span class="number">0</span>&#125;<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(OpenLayers.Handler.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>))&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.wheelListener;OpenLayers.Event.stopObserving(<span class="built_in">window</span>,</span><br><span class="line"><span class="string">"DOMMouseScroll"</span>,b);OpenLayers.Event.stopObserving(<span class="built_in">window</span>,<span class="string">"mousewheel"</span>,b);OpenLayers.Event.stopObserving(<span class="built_in">document</span>,<span class="string">"mousewheel"</span>,b);<span class="keyword">return</span>!<span class="number">0</span>&#125;<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Handler.MouseWheel"</span>&#125;);OpenLayers.Symbolizer=OpenLayers.Class(&#123;<span class="attr">zIndex</span>:<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,a)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> (<span class="built_in">eval</span>(<span class="keyword">this</span>.CLASS_NAME))(OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Symbolizer"</span>&#125;);OpenLayers.Symbolizer.Raster=OpenLayers.Class(OpenLayers.Symbolizer,&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Symbolizer.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Symbolizer.Raster"</span>&#125;);OpenLayers.Rule=OpenLayers.Class(&#123;<span class="attr">id</span>:<span class="literal">null</span>,<span class="attr">name</span>:<span class="literal">null</span>,<span class="attr">title</span>:<span class="literal">null</span>,<span class="attr">description</span>:<span class="literal">null</span>,<span class="attr">context</span>:<span class="literal">null</span>,<span class="attr">filter</span>:<span class="literal">null</span>,<span class="attr">elseFilter</span>:!<span class="number">1</span>,<span class="attr">symbolizer</span>:<span class="literal">null</span>,<span class="attr">symbolizers</span>:<span class="literal">null</span>,<span class="attr">minScaleDenominator</span>:<span class="literal">null</span>,<span class="attr">maxScaleDenominator</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.symbolizer=&#123;&#125;;OpenLayers.Util.extend(<span class="keyword">this</span>,a);<span class="keyword">this</span>.symbolizers&amp;&amp;<span class="keyword">delete</span> <span class="keyword">this</span>.symbolizer;<span class="keyword">this</span>.id=OpenLayers.Util.createUniqueID(<span class="keyword">this</span>.CLASS_NAME+<span class="string">"_"</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a <span class="keyword">in</span> <span class="keyword">this</span>.symbolizer)<span class="keyword">this</span>.symbolizer[a]=<span class="literal">null</span>;<span class="keyword">this</span>.symbolizer=<span class="literal">null</span>;<span class="keyword">delete</span> <span class="keyword">this</span>.symbolizers&#125;,<span class="attr">evaluate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.getContext(a),c=!<span class="number">0</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.minScaleDenominator||<span class="keyword">this</span>.maxScaleDenominator)<span class="keyword">var</span> d=a.layer.map.getScale();<span class="keyword">this</span>.minScaleDenominator&amp;&amp;(c=d&gt;=OpenLayers.Style.createLiteral(<span class="keyword">this</span>.minScaleDenominator,b));c&amp;&amp;<span class="keyword">this</span>.maxScaleDenominator&amp;&amp;(c=d&lt;OpenLayers.Style.createLiteral(<span class="keyword">this</span>.maxScaleDenominator,b));c&amp;&amp;<span class="keyword">this</span>.filter&amp;&amp;(c=<span class="string">"OpenLayers.Filter.FeatureId"</span>==<span class="keyword">this</span>.filter.CLASS_NAME?<span class="keyword">this</span>.filter.evaluate(a):<span class="keyword">this</span>.filter.evaluate(b));<span class="keyword">return</span> c&#125;,<span class="attr">getContext</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.context;b||(b=a.attributes||a.data);<span class="string">"function"</span>==</span><br><span class="line"><span class="keyword">typeof</span> <span class="keyword">this</span>.context&amp;&amp;(b=<span class="keyword">this</span>.context(a));<span class="keyword">return</span> b&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>);<span class="keyword">if</span>(<span class="keyword">this</span>.symbolizers)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.symbolizers.length;a.symbolizers=<span class="built_in">Array</span>(b);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>;c&lt;b;++c)a.symbolizers[c]=<span class="keyword">this</span>.symbolizers[c].clone()&#125;<span class="keyword">else</span>&#123;a.symbolizer=&#123;&#125;;<span class="keyword">for</span>(<span class="keyword">var</span> d <span class="keyword">in</span> <span class="keyword">this</span>.symbolizer)b=<span class="keyword">this</span>.symbolizer[d],c=<span class="keyword">typeof</span> b,<span class="string">"object"</span>===c?a.symbolizer[d]=OpenLayers.Util.extend(&#123;&#125;,b):<span class="string">"string"</span>===c&amp;&amp;(a.symbolizer[d]=b)&#125;a.filter=<span class="keyword">this</span>.filter&amp;&amp;<span class="keyword">this</span>.filter.clone();a.context=<span class="keyword">this</span>.context&amp;&amp;OpenLayers.Util.extend(&#123;&#125;,</span><br><span class="line"><span class="keyword">this</span>.context);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Rule(a)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Rule"</span>&#125;);OpenLayers.Format.SLD=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,&#123;<span class="attr">profile</span>:<span class="literal">null</span>,<span class="attr">defaultVersion</span>:<span class="string">"1.0.0"</span>,<span class="attr">stringifyOutput</span>:!<span class="number">0</span>,<span class="attr">namedLayersAsArray</span>:!<span class="number">1</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.SLD"</span>&#125;);OpenLayers.Symbolizer.Polygon=OpenLayers.Class(OpenLayers.Symbolizer,&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Symbolizer.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Symbolizer.Polygon"</span>&#125;);OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,&#123;<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.GML.Base.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">readers</span>:&#123;<span class="attr">gml</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">outerBoundaryIs</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.outer=c.components[<span class="number">0</span>]&#125;,<span class="attr">innerBoundaryIs</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.inner.push(c.components[<span class="number">0</span>])&#125;,<span class="attr">Box</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=</span><br><span class="line">&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.components||(b.components=[]);<span class="keyword">var</span> d=c.points[<span class="number">0</span>],c=c.points[<span class="number">1</span>];b.components.push(<span class="keyword">new</span> OpenLayers.Bounds(d.x,d.y,c.x,c.y))&#125;&#125;,OpenLayers.Format.GML.Base.prototype.readers.gml),<span class="attr">feature</span>:OpenLayers.Format.GML.Base.prototype.readers.feature,<span class="attr">wfs</span>:OpenLayers.Format.GML.Base.prototype.readers.wfs&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;b=OpenLayers.Util.isArray(a)?<span class="string">"wfs:FeatureCollection"</span>:<span class="string">"gml:featureMember"</span>;a=<span class="keyword">this</span>.writeNode(b,a);<span class="keyword">this</span>.setAttributeNS(a,<span class="keyword">this</span>.namespaces.xsi,<span class="string">"xsi:schemaLocation"</span>,<span class="keyword">this</span>.schemaLocation);</span><br><span class="line"><span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">writers</span>:&#123;<span class="attr">gml</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">Point</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:Point"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"coordinates"</span>,[a],b);<span class="keyword">return</span> b&#125;,<span class="attr">coordinates</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=a.length,c=<span class="built_in">Array</span>(b),d,e=<span class="number">0</span>;e&lt;b;++e)d=a[e],c[e]=<span class="keyword">this</span>.xy?d.x+<span class="string">","</span>+d.y:d.y+<span class="string">","</span>+d.x,<span class="keyword">void</span> <span class="number">0</span>!=d.z&amp;&amp;(c[e]+=<span class="string">","</span>+d.z);<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:coordinates"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">decimal</span>:<span class="string">"."</span>,<span class="attr">cs</span>:<span class="string">","</span>,<span class="attr">ts</span>:<span class="string">" "</span>&#125;,<span class="attr">value</span>:<span class="number">1</span>==b?c[<span class="number">0</span>]:c.join(<span class="string">" "</span>)&#125;)&#125;,<span class="attr">LineString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:LineString"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"coordinates"</span>,a.components,b);<span class="keyword">return</span> b&#125;,<span class="attr">Polygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:Polygon"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"outerBoundaryIs"</span>,a.components[<span class="number">0</span>],b);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">1</span>;c&lt;a.components.length;++c)<span class="keyword">this</span>.writeNode(<span class="string">"innerBoundaryIs"</span>,a.components[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">outerBoundaryIs</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:outerBoundaryIs"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"LinearRing"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">innerBoundaryIs</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:innerBoundaryIs"</span>);</span><br><span class="line"><span class="keyword">this</span>.writeNode(<span class="string">"LinearRing"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">LinearRing</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:LinearRing"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"coordinates"</span>,a.components,b);<span class="keyword">return</span> b&#125;,<span class="attr">Box</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:Box"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"coordinates"</span>,[&#123;<span class="attr">x</span>:a.left,<span class="attr">y</span>:a.bottom&#125;,&#123;<span class="attr">x</span>:a.right,<span class="attr">y</span>:a.top&#125;],b);<span class="keyword">this</span>.srsName&amp;&amp;b.setAttribute(<span class="string">"srsName"</span>,<span class="keyword">this</span>.srsName);<span class="keyword">return</span> b&#125;&#125;,OpenLayers.Format.GML.Base.prototype.writers.gml),<span class="attr">feature</span>:OpenLayers.Format.GML.Base.prototype.writers.feature,<span class="attr">wfs</span>:OpenLayers.Format.GML.Base.prototype.writers.wfs&#125;,</span><br><span class="line">CLASS_NAME:<span class="string">"OpenLayers.Format.GML.v2"</span>&#125;);OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,&#123;<span class="attr">VERSION</span>:<span class="string">"1.0.0"</span>,<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/ogc/filter/1.0.0/filter.xsd"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.GML.v2.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">readers</span>:&#123;<span class="attr">ogc</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">PropertyIsEqualTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">type</span>:OpenLayers.Filter.Comparison.EQUAL_TO&#125;);<span class="keyword">this</span>.readChildNodes(a,c);b.filters.push(c)&#125;,<span class="attr">PropertyIsNotEqualTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">type</span>:OpenLayers.Filter.Comparison.NOT_EQUAL_TO&#125;);<span class="keyword">this</span>.readChildNodes(a,c);b.filters.push(c)&#125;,<span class="attr">PropertyIsLike</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">type</span>:OpenLayers.Filter.Comparison.LIKE&#125;);<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">var</span> d=a.getAttribute(<span class="string">"wildCard"</span>),e=a.getAttribute(<span class="string">"singleChar"</span>),f=a.getAttribute(<span class="string">"escape"</span>);c.value2regex(d,e,f);b.filters.push(c)&#125;&#125;,OpenLayers.Format.Filter.v1.prototype.readers.ogc),<span class="attr">gml</span>:OpenLayers.Format.GML.v2.prototype.readers.gml,</span><br><span class="line">feature:OpenLayers.Format.GML.v2.prototype.readers.feature&#125;,<span class="attr">writers</span>:&#123;<span class="attr">ogc</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">PropertyIsEqualTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyIsEqualTo"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">this</span>.writeOgcExpression(a.value,b);<span class="keyword">return</span> b&#125;,<span class="attr">PropertyIsNotEqualTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyIsNotEqualTo"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">this</span>.writeOgcExpression(a.value,b);<span class="keyword">return</span> b&#125;,<span class="attr">PropertyIsLike</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyIsLike"</span>,</span><br><span class="line">&#123;<span class="attr">attributes</span>:&#123;<span class="attr">wildCard</span>:<span class="string">"*"</span>,<span class="attr">singleChar</span>:<span class="string">"."</span>,<span class="attr">escape</span>:<span class="string">"!"</span>&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">this</span>.writeNode(<span class="string">"Literal"</span>,a.regex2value(),b);<span class="keyword">return</span> b&#125;,<span class="attr">BBOX</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:BBOX"</span>);a.property&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,b);<span class="keyword">var</span> c=<span class="keyword">this</span>.writeNode(<span class="string">"gml:Box"</span>,a.value,b);a.projection&amp;&amp;c.setAttribute(<span class="string">"srsName"</span>,a.projection);<span class="keyword">return</span> b&#125;&#125;,OpenLayers.Format.Filter.v1.prototype.writers.ogc),<span class="attr">gml</span>:OpenLayers.Format.GML.v2.prototype.writers.gml,<span class="attr">feature</span>:OpenLayers.Format.GML.v2.prototype.writers.feature&#125;,</span><br><span class="line">writeSpatial:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:"</span>+b);<span class="keyword">this</span>.writeNode(<span class="string">"PropertyName"</span>,a,c);<span class="keyword">if</span>(a.value <span class="keyword">instanceof</span> OpenLayers.Filter.Function)<span class="keyword">this</span>.writeNode(<span class="string">"Function"</span>,a.value,c);<span class="keyword">else</span>&#123;<span class="keyword">var</span> d;d=a.value <span class="keyword">instanceof</span> OpenLayers.Geometry?<span class="keyword">this</span>.writeNode(<span class="string">"feature:_geometry"</span>,a.value).firstChild:<span class="keyword">this</span>.writeNode(<span class="string">"gml:Box"</span>,a.value);a.projection&amp;&amp;d.setAttribute(<span class="string">"srsName"</span>,a.projection);c.appendChild(d)&#125;<span class="keyword">return</span> c&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.Filter.v1_0_0"</span>&#125;);OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,&#123;<span class="attr">version</span>:<span class="string">"1.0.0"</span>,<span class="attr">srsNameInQuery</span>:!<span class="number">1</span>,<span class="attr">schemaLocations</span>:&#123;<span class="attr">wfs</span>:<span class="string">"http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"</span>&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(<span class="keyword">this</span>,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">readNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Format.GML.v2.prototype.readNode.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">readers</span>:&#123;<span class="attr">wfs</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">WFS_TransactionResponse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.insertIds=[];b.success=!<span class="number">1</span>;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">InsertResult</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">fids</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.insertIds=b.insertIds.concat(c.fids)&#125;,<span class="attr">TransactionResult</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Status</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">SUCCESS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.success=!<span class="number">0</span>&#125;&#125;,OpenLayers.Format.WFST.v1.prototype.readers.wfs),<span class="attr">gml</span>:OpenLayers.Format.GML.v2.prototype.readers.gml,<span class="attr">feature</span>:OpenLayers.Format.GML.v2.prototype.readers.feature,<span class="attr">ogc</span>:OpenLayers.Format.Filter.v1_0_0.prototype.readers.ogc&#125;,</span><br><span class="line">writers:&#123;<span class="attr">wfs</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">Query</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.extend(&#123;<span class="attr">featureNS</span>:<span class="keyword">this</span>.featureNS,<span class="attr">featurePrefix</span>:<span class="keyword">this</span>.featurePrefix,<span class="attr">featureType</span>:<span class="keyword">this</span>.featureType,<span class="attr">srsName</span>:<span class="keyword">this</span>.srsName,<span class="attr">srsNameInQuery</span>:<span class="keyword">this</span>.srsNameInQuery&#125;,a);<span class="keyword">var</span> b=a.featurePrefix,c=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wfs:Query"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">typeName</span>:(b?b+<span class="string">":"</span>:<span class="string">""</span>)+a.featureType&#125;&#125;);a.srsNameInQuery&amp;&amp;a.srsName&amp;&amp;c.setAttribute(<span class="string">"srsName"</span>,a.srsName);a.featureNS&amp;&amp;c.setAttribute(<span class="string">"xmlns:"</span>+b,a.featureNS);<span class="keyword">if</span>(a.propertyNames)<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,d=a.propertyNames.length;b&lt;</span><br><span class="line">d;b++)<span class="keyword">this</span>.writeNode(<span class="string">"ogc:PropertyName"</span>,&#123;<span class="attr">property</span>:a.propertyNames[b]&#125;,c);a.filter&amp;&amp;(<span class="keyword">this</span>.setFilterProperty(a.filter),<span class="keyword">this</span>.writeNode(<span class="string">"ogc:Filter"</span>,a.filter,c));<span class="keyword">return</span> c&#125;&#125;,OpenLayers.Format.WFST.v1.prototype.writers.wfs),<span class="attr">gml</span>:OpenLayers.Format.GML.v2.prototype.writers.gml,<span class="attr">feature</span>:OpenLayers.Format.GML.v2.prototype.writers.feature,<span class="attr">ogc</span>:OpenLayers.Format.Filter.v1_0_0.prototype.writers.ogc&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WFST.v1_0_0"</span>&#125;);OpenLayers.ElementsIndexer=OpenLayers.Class(&#123;<span class="attr">maxZIndex</span>:<span class="literal">null</span>,<span class="attr">order</span>:<span class="literal">null</span>,<span class="attr">indices</span>:<span class="literal">null</span>,<span class="attr">compare</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.compare=a?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;<span class="keyword">this</span>.clear()&#125;,<span class="attr">insert</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.exists(a)&amp;&amp;<span class="keyword">this</span>.remove(a);<span class="keyword">var</span> b=a.id;<span class="keyword">this</span>.determineZIndex(a);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">-1</span>,d=<span class="keyword">this</span>.order.length,e;<span class="number">1</span>&lt;d-c;)e=<span class="built_in">parseInt</span>((c+d)/<span class="number">2</span>),<span class="number">0</span>&lt;<span class="keyword">this</span>.compare(<span class="keyword">this</span>,a,OpenLayers.Util.getElement(<span class="keyword">this</span>.order[e]))?c=e:d=e;<span class="keyword">this</span>.order.splice(d,</span><br><span class="line"><span class="number">0</span>,b);<span class="keyword">this</span>.indices[b]=<span class="keyword">this</span>.getZIndex(a);<span class="keyword">return</span> <span class="keyword">this</span>.getNextElement(d)&#125;,<span class="attr">remove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.id;<span class="keyword">var</span> b=OpenLayers.Util.indexOf(<span class="keyword">this</span>.order,a);<span class="number">0</span>&lt;=b&amp;&amp;(<span class="keyword">this</span>.order.splice(b,<span class="number">1</span>),<span class="keyword">delete</span> <span class="keyword">this</span>.indices[a],<span class="keyword">this</span>.maxZIndex=<span class="number">0</span>&lt;<span class="keyword">this</span>.order.length?<span class="keyword">this</span>.indices[<span class="keyword">this</span>.order[<span class="keyword">this</span>.order.length<span class="number">-1</span>]]:<span class="number">0</span>)&#125;,<span class="attr">clear</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.order=[];<span class="keyword">this</span>.indices=&#123;&#125;;<span class="keyword">this</span>.maxZIndex=<span class="number">0</span>&#125;,<span class="attr">exists</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="literal">null</span>!=<span class="keyword">this</span>.indices[a.id]&#125;,<span class="attr">getZIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a._style.graphicZIndex&#125;,<span class="attr">determineZIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a._style.graphicZIndex;</span><br><span class="line"><span class="literal">null</span>==b?(b=<span class="keyword">this</span>.maxZIndex,a._style.graphicZIndex=b):b&gt;<span class="keyword">this</span>.maxZIndex&amp;&amp;(<span class="keyword">this</span>.maxZIndex=b)&#125;,<span class="attr">getNextElement</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a+=<span class="number">1</span>;<span class="keyword">if</span>(a&lt;<span class="keyword">this</span>.order.length)&#123;<span class="keyword">var</span> b=OpenLayers.Util.getElement(<span class="keyword">this</span>.order[a]);<span class="keyword">void</span> <span class="number">0</span>==b&amp;&amp;(b=<span class="keyword">this</span>.getNextElement(a));<span class="keyword">return</span> b&#125;<span class="keyword">return</span> <span class="literal">null</span>&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.ElementsIndexer"</span>&#125;);</span><br><span class="line">OpenLayers.ElementsIndexer.IndexingMethods=&#123;<span class="attr">Z_ORDER</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;b=a.getZIndex(b);<span class="keyword">var</span> d=<span class="number">0</span>;c&amp;&amp;(a=a.getZIndex(c),d=b-a);<span class="keyword">return</span> d&#125;,<span class="attr">Z_ORDER_DRAWING_ORDER</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;a=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);c&amp;&amp;<span class="number">0</span>==a&amp;&amp;(a=<span class="number">1</span>);<span class="keyword">return</span> a&#125;,<span class="attr">Z_ORDER_Y_ORDER</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;a=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);c&amp;&amp;<span class="number">0</span>===a&amp;&amp;(b=c._boundsBottom-b._boundsBottom,a=<span class="number">0</span>===b?<span class="number">1</span>:b);<span class="keyword">return</span> a&#125;&#125;;</span><br><span class="line">OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,&#123;<span class="attr">rendererRoot</span>:<span class="literal">null</span>,<span class="attr">root</span>:<span class="literal">null</span>,<span class="attr">vectorRoot</span>:<span class="literal">null</span>,<span class="attr">textRoot</span>:<span class="literal">null</span>,<span class="attr">xmlns</span>:<span class="literal">null</span>,<span class="attr">xOffset</span>:<span class="number">0</span>,<span class="attr">indexer</span>:<span class="literal">null</span>,<span class="attr">BACKGROUND_ID_SUFFIX</span>:<span class="string">"_background"</span>,<span class="attr">LABEL_ID_SUFFIX</span>:<span class="string">"_label"</span>,<span class="attr">LABEL_OUTLINE_SUFFIX</span>:<span class="string">"_outline"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Renderer.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.rendererRoot=<span class="keyword">this</span>.createRenderRoot();<span class="keyword">this</span>.root=<span class="keyword">this</span>.createRoot(<span class="string">"_root"</span>);<span class="keyword">this</span>.vectorRoot=<span class="keyword">this</span>.createRoot(<span class="string">"_vroot"</span>);<span class="keyword">this</span>.textRoot=<span class="keyword">this</span>.createRoot(<span class="string">"_troot"</span>);<span class="keyword">this</span>.root.appendChild(<span class="keyword">this</span>.vectorRoot);</span><br><span class="line"><span class="keyword">this</span>.root.appendChild(<span class="keyword">this</span>.textRoot);<span class="keyword">this</span>.rendererRoot.appendChild(<span class="keyword">this</span>.root);<span class="keyword">this</span>.container.appendChild(<span class="keyword">this</span>.rendererRoot);b&amp;&amp;(b.zIndexing||b.yOrdering)&amp;&amp;(<span class="keyword">this</span>.indexer=<span class="keyword">new</span> OpenLayers.ElementsIndexer(b.yOrdering))&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.clear();<span class="keyword">this</span>.xmlns=<span class="keyword">this</span>.root=<span class="keyword">this</span>.rendererRoot=<span class="literal">null</span>;OpenLayers.Renderer.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">clear</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a,b=<span class="keyword">this</span>.vectorRoot;<span class="keyword">if</span>(b)<span class="keyword">for</span>(;a=b.firstChild;)b.removeChild(a);<span class="keyword">if</span>(b=<span class="keyword">this</span>.textRoot)<span class="keyword">for</span>(;a=b.firstChild;)b.removeChild(a);<span class="keyword">this</span>.indexer&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.indexer.clear()&#125;,<span class="attr">setExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Renderer.prototype.setExtent.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>),d=<span class="keyword">this</span>.getResolution();<span class="keyword">if</span>(<span class="keyword">this</span>.map.baseLayer&amp;&amp;<span class="keyword">this</span>.map.baseLayer.wrapDateLine)&#123;<span class="keyword">var</span> e,f=a.getWidth()/<span class="keyword">this</span>.map.getExtent().getWidth();a=a.scale(<span class="number">1</span>/f);f=<span class="keyword">this</span>.map.getMaxExtent();f.right&gt;a.left&amp;&amp;f.right&lt;a.right?e=!<span class="number">0</span>:f.left&gt;a.left&amp;&amp;f.left&lt;a.right&amp;&amp;(e=!<span class="number">1</span>);<span class="keyword">if</span>(e!==<span class="keyword">this</span>.rightOfDateLine||b)c=!<span class="number">1</span>,<span class="keyword">this</span>.xOffset=!<span class="number">0</span>===e?f.getWidth()/d:<span class="number">0</span>;<span class="keyword">this</span>.rightOfDateLine=e&#125;<span class="keyword">return</span> c&#125;,<span class="attr">getNodeType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">drawGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b,c</span>)</span>&#123;<span class="keyword">var</span> d=a.CLASS_NAME,e=!<span class="number">0</span>;<span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.Collection"</span>==d||<span class="string">"OpenLayers.Geometry.MultiPoint"</span>==d||<span class="string">"OpenLayers.Geometry.MultiLineString"</span>==d||<span class="string">"OpenLayers.Geometry.MultiPolygon"</span>==d)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,f=a.components.length;d&lt;f;d++)e=<span class="keyword">this</span>.drawGeometry(a.components[d],b,c)&amp;&amp;e;<span class="keyword">return</span> e&#125;d=e=!<span class="number">1</span>;<span class="string">"none"</span>!=b.display&amp;&amp;(b.backgroundGraphic?<span class="keyword">this</span>.redrawBackgroundNode(a.id,a,b,c):d=!<span class="number">0</span>,e=<span class="keyword">this</span>.redrawNode(a.id,a,b,c));!<span class="number">1</span>==e&amp;&amp;(b=<span class="built_in">document</span>.getElementById(a.id))&amp;&amp;(b._style.backgroundGraphic&amp;&amp;(d=!<span class="number">0</span>),b.parentNode.removeChild(b));</span><br><span class="line">d&amp;&amp;(b=<span class="built_in">document</span>.getElementById(a.id+<span class="keyword">this</span>.BACKGROUND_ID_SUFFIX))&amp;&amp;b.parentNode.removeChild(b);<span class="keyword">return</span> e&#125;,<span class="attr">redrawNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;c=<span class="keyword">this</span>.applyDefaultSymbolizer(c);a=<span class="keyword">this</span>.nodeFactory(a,<span class="keyword">this</span>.getNodeType(b,c));a._featureId=d;a._boundsBottom=b.getBounds().bottom;a._geometryClass=b.CLASS_NAME;a._style=c;b=<span class="keyword">this</span>.drawGeometryNode(a,b,c);<span class="keyword">if</span>(!<span class="number">1</span>===b)<span class="keyword">return</span>!<span class="number">1</span>;a=b.node;<span class="keyword">this</span>.indexer?(c=<span class="keyword">this</span>.indexer.insert(a))?<span class="keyword">this</span>.vectorRoot.insertBefore(a,c):<span class="keyword">this</span>.vectorRoot.appendChild(a):a.parentNode!==<span class="keyword">this</span>.vectorRoot&amp;&amp;<span class="keyword">this</span>.vectorRoot.appendChild(a);</span><br><span class="line"><span class="keyword">this</span>.postDraw(a);<span class="keyword">return</span> b.complete&#125;,<span class="attr">redrawBackgroundNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;c=OpenLayers.Util.extend(&#123;&#125;,c);c.externalGraphic=c.backgroundGraphic;c.graphicXOffset=c.backgroundXOffset;c.graphicYOffset=c.backgroundYOffset;c.graphicZIndex=c.backgroundGraphicZIndex;c.graphicWidth=c.backgroundWidth||c.graphicWidth;c.graphicHeight=c.backgroundHeight||c.graphicHeight;c.backgroundGraphic=<span class="literal">null</span>;c.backgroundXOffset=<span class="literal">null</span>;c.backgroundYOffset=<span class="literal">null</span>;c.backgroundGraphicZIndex=<span class="literal">null</span>;<span class="keyword">return</span> <span class="keyword">this</span>.redrawNode(a+<span class="keyword">this</span>.BACKGROUND_ID_SUFFIX,</span><br><span class="line">b,c,<span class="literal">null</span>)&#125;,<span class="attr">drawGeometryNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;c=c||a._style;<span class="keyword">var</span> d=&#123;<span class="attr">isFilled</span>:<span class="keyword">void</span> <span class="number">0</span>===c.fill?!<span class="number">0</span>:c.fill,<span class="attr">isStroked</span>:<span class="keyword">void</span> <span class="number">0</span>===c.stroke?!!c.strokeWidth:c.stroke&#125;,e;<span class="keyword">switch</span>(b.CLASS_NAME)&#123;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Point"</span>:!<span class="number">1</span>===c.graphic&amp;&amp;(d.isFilled=!<span class="number">1</span>,d.isStroked=!<span class="number">1</span>);e=<span class="keyword">this</span>.drawPoint(a,b);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.LineString"</span>:d.isFilled=!<span class="number">1</span>;e=<span class="keyword">this</span>.drawLineString(a,b);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.LinearRing"</span>:e=<span class="keyword">this</span>.drawLinearRing(a,b);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Polygon"</span>:e=<span class="keyword">this</span>.drawPolygon(a,b);<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Rectangle"</span>:e=<span class="keyword">this</span>.drawRectangle(a,b)&#125;a._options=d;<span class="keyword">return</span>!<span class="number">1</span>!=e?&#123;<span class="attr">node</span>:<span class="keyword">this</span>.setStyle(a,c,d,b),<span class="attr">complete</span>:e&#125;:!<span class="number">1</span>&#125;,<span class="attr">postDraw</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">drawPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">drawLineString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">drawLinearRing</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">drawPolygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">drawRectangle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">drawCircle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">removeText</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="built_in">document</span>.getElementById(a+<span class="keyword">this</span>.LABEL_ID_SUFFIX);b&amp;&amp;<span class="keyword">this</span>.textRoot.removeChild(b);(a=<span class="built_in">document</span>.getElementById(a+<span class="keyword">this</span>.LABEL_OUTLINE_SUFFIX))&amp;&amp;<span class="keyword">this</span>.textRoot.removeChild(a)&#125;,</span><br><span class="line">getFeatureIdFromEvent:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.target,c=b&amp;&amp;b.correspondingUseElement;<span class="keyword">return</span>(c?c:b||a.srcElement)._featureId&#125;,<span class="attr">eraseGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.MultiPoint"</span>==a.CLASS_NAME||<span class="string">"OpenLayers.Geometry.MultiLineString"</span>==a.CLASS_NAME||<span class="string">"OpenLayers.Geometry.MultiPolygon"</span>==a.CLASS_NAME||<span class="string">"OpenLayers.Geometry.Collection"</span>==a.CLASS_NAME)<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.components.length;c&lt;d;c++)<span class="keyword">this</span>.eraseGeometry(a.components[c],b);<span class="keyword">else</span>(c=OpenLayers.Util.getElement(a.id))&amp;&amp;c.parentNode&amp;&amp;(c.geometry&amp;&amp;(c.geometry.destroy(),</span><br><span class="line">c.geometry=<span class="literal">null</span>),c.parentNode.removeChild(c),<span class="keyword">this</span>.indexer&amp;&amp;<span class="keyword">this</span>.indexer.remove(c),c._style.backgroundGraphic&amp;&amp;(c=OpenLayers.Util.getElement(a.id+<span class="keyword">this</span>.BACKGROUND_ID_SUFFIX))&amp;&amp;c.parentNode&amp;&amp;c.parentNode.removeChild(c))&#125;,<span class="attr">nodeFactory</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Util.getElement(a);c?<span class="keyword">this</span>.nodeTypeCompare(c,b)||(c.parentNode.removeChild(c),c=<span class="keyword">this</span>.nodeFactory(a,b)):c=<span class="keyword">this</span>.createNode(b,a);<span class="keyword">return</span> c&#125;,<span class="attr">nodeTypeCompare</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">createNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">moveRoot</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.root;a.root.parentNode==</span><br><span class="line"><span class="keyword">this</span>.rendererRoot&amp;&amp;(b=a.root);b.parentNode.removeChild(b);a.rendererRoot.appendChild(b)&#125;,<span class="attr">getRenderLayerId</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.root.parentNode.parentNode.id&#125;,<span class="attr">isComplexSymbol</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span><span class="string">"circle"</span>!=a&amp;&amp;!!a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Renderer.Elements"</span>&#125;);OpenLayers.Control.ArgParser=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">center</span>:<span class="literal">null</span>,<span class="attr">zoom</span>:<span class="literal">null</span>,<span class="attr">layers</span>:<span class="literal">null</span>,<span class="attr">displayProjection</span>:<span class="literal">null</span>,<span class="attr">getParameters</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||<span class="built_in">window</span>.location.href;<span class="keyword">var</span> b=OpenLayers.Util.getParameters(a),c=a.indexOf(<span class="string">"#"</span>);<span class="number">0</span>&lt;c&amp;&amp;(a=<span class="string">"?"</span>+a.substring(c+<span class="number">1</span>,a.length),OpenLayers.Util.extend(b,OpenLayers.Util.getParameters(a)));<span class="keyword">return</span> b&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="keyword">this</span>.map.controls.length;b&lt;c;b++)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.map.controls[b];<span class="keyword">if</span>(d!=<span class="keyword">this</span>&amp;&amp;</span><br><span class="line"><span class="string">"OpenLayers.Control.ArgParser"</span>==d.CLASS_NAME)&#123;d.displayProjection!=<span class="keyword">this</span>.displayProjection&amp;&amp;(<span class="keyword">this</span>.displayProjection=d.displayProjection);<span class="keyword">break</span>&#125;&#125;b==<span class="keyword">this</span>.map.controls.length&amp;&amp;(b=<span class="keyword">this</span>.getParameters(),b.layers&amp;&amp;(<span class="keyword">this</span>.layers=b.layers,<span class="keyword">this</span>.map.events.register(<span class="string">"addlayer"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.configureLayers),<span class="keyword">this</span>.configureLayers()),b.lat&amp;&amp;b.lon&amp;&amp;(<span class="keyword">this</span>.center=<span class="keyword">new</span> OpenLayers.LonLat(<span class="built_in">parseFloat</span>(b.lon),<span class="built_in">parseFloat</span>(b.lat)),b.zoom&amp;&amp;(<span class="keyword">this</span>.zoom=<span class="built_in">parseFloat</span>(b.zoom)),<span class="keyword">this</span>.map.events.register(<span class="string">"changebaselayer"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.setCenter),</span><br><span class="line"><span class="keyword">this</span>.setCenter()))&#125;,<span class="attr">setCenter</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.map.baseLayer&amp;&amp;(<span class="keyword">this</span>.map.events.unregister(<span class="string">"changebaselayer"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.setCenter),<span class="keyword">this</span>.displayProjection&amp;&amp;<span class="keyword">this</span>.center.transform(<span class="keyword">this</span>.displayProjection,<span class="keyword">this</span>.map.getProjectionObject()),<span class="keyword">this</span>.map.setCenter(<span class="keyword">this</span>.center,<span class="keyword">this</span>.zoom))&#125;,<span class="attr">configureLayers</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.layers.length==<span class="keyword">this</span>.map.layers.length)&#123;<span class="keyword">this</span>.map.events.unregister(<span class="string">"addlayer"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.configureLayers);<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="keyword">this</span>.layers.length;a&lt;b;a++)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.map.layers[a],d=<span class="keyword">this</span>.layers.charAt(a);</span><br><span class="line"><span class="string">"B"</span>==d?<span class="keyword">this</span>.map.setBaseLayer(c):<span class="string">"T"</span>!=d&amp;&amp;<span class="string">"F"</span>!=d||c.setVisibility(<span class="string">"T"</span>==d)&#125;&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.ArgParser"</span>&#125;);OpenLayers.Control.Permalink=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">argParserClass</span>:OpenLayers.Control.ArgParser,<span class="attr">element</span>:<span class="literal">null</span>,<span class="attr">anchor</span>:!<span class="number">1</span>,<span class="attr">base</span>:<span class="string">""</span>,<span class="attr">displayProjection</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="literal">null</span>===a||<span class="string">"object"</span>!=<span class="keyword">typeof</span> a||OpenLayers.Util.isElement(a)?(OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[c]),<span class="keyword">this</span>.element=OpenLayers.Util.getElement(a),<span class="keyword">this</span>.base=b||<span class="built_in">document</span>.location.href):(<span class="keyword">this</span>.base=<span class="built_in">document</span>.location.href,OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[a]),<span class="literal">null</span>!=<span class="keyword">this</span>.element&amp;&amp;(<span class="keyword">this</span>.element=</span><br><span class="line">OpenLayers.Util.getElement(<span class="keyword">this</span>.element)))&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.element&amp;&amp;<span class="keyword">this</span>.element.parentNode==<span class="keyword">this</span>.div&amp;&amp;(<span class="keyword">this</span>.div.removeChild(<span class="keyword">this</span>.element),<span class="keyword">this</span>.element=<span class="literal">null</span>);<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.unregister(<span class="string">"moveend"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.updateLink);OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="keyword">this</span>.map.controls.length;b&lt;c;b++)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.map.controls[b];<span class="keyword">if</span>(d.CLASS_NAME==<span class="keyword">this</span>.argParserClass.CLASS_NAME)&#123;d.displayProjection!=</span><br><span class="line"><span class="keyword">this</span>.displayProjection&amp;&amp;(<span class="keyword">this</span>.displayProjection=d.displayProjection);<span class="keyword">break</span>&#125;&#125;b==<span class="keyword">this</span>.map.controls.length&amp;&amp;<span class="keyword">this</span>.map.addControl(<span class="keyword">new</span> <span class="keyword">this</span>.argParserClass(&#123;<span class="attr">displayProjection</span>:<span class="keyword">this</span>.displayProjection&#125;))&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Control.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.element||<span class="keyword">this</span>.anchor||(<span class="keyword">this</span>.element=<span class="built_in">document</span>.createElement(<span class="string">"a"</span>),<span class="keyword">this</span>.element.innerHTML=OpenLayers.i18n(<span class="string">"Permalink"</span>),<span class="keyword">this</span>.element.href=<span class="string">""</span>,<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.element));<span class="keyword">this</span>.map.events.on(&#123;<span class="attr">moveend</span>:<span class="keyword">this</span>.updateLink,<span class="attr">changelayer</span>:<span class="keyword">this</span>.updateLink,</span><br><span class="line">changebaselayer:<span class="keyword">this</span>.updateLink,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">this</span>.updateLink();<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">updateLink</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.anchor?<span class="string">"#"</span>:<span class="string">"?"</span>,b=<span class="keyword">this</span>.base,c=<span class="literal">null</span>;<span class="number">-1</span>!=b.indexOf(<span class="string">"#"</span>)&amp;&amp;!<span class="number">1</span>==<span class="keyword">this</span>.anchor&amp;&amp;(c=b.substring(b.indexOf(<span class="string">"#"</span>),b.length));<span class="number">-1</span>!=b.indexOf(a)&amp;&amp;(b=b.substring(<span class="number">0</span>,b.indexOf(a)));b=b.split(<span class="string">"#"</span>)[<span class="number">0</span>]+a+OpenLayers.Util.getParameterString(<span class="keyword">this</span>.createParams());c&amp;&amp;(b+=c);<span class="keyword">this</span>.anchor&amp;&amp;!<span class="keyword">this</span>.element?<span class="built_in">window</span>.location.href=b:<span class="keyword">this</span>.element.href=b&#125;,<span class="attr">createParams</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;a=a||<span class="keyword">this</span>.map.getCenter();<span class="keyword">var</span> d=OpenLayers.Util.getParameters(<span class="keyword">this</span>.base);</span><br><span class="line"><span class="keyword">if</span>(a)<span class="keyword">for</span>(d.zoom=b||<span class="keyword">this</span>.map.getZoom(),b=a.lat,a=a.lon,<span class="keyword">this</span>.displayProjection&amp;&amp;(b=OpenLayers.Projection.transform(&#123;<span class="attr">x</span>:a,<span class="attr">y</span>:b&#125;,<span class="keyword">this</span>.map.getProjectionObject(),<span class="keyword">this</span>.displayProjection),a=b.x,b=b.y),d.lat=<span class="built_in">Math</span>.round(<span class="number">1E5</span>*b)/<span class="number">1E5</span>,d.lon=<span class="built_in">Math</span>.round(<span class="number">1E5</span>*a)/<span class="number">1E5</span>,c=c||<span class="keyword">this</span>.map.layers,d.layers=<span class="string">""</span>,a=<span class="number">0</span>,b=c.length;a&lt;b;a++)&#123;<span class="keyword">var</span> e=c[a];d.layers=e.isBaseLayer?d.layers+(e==<span class="keyword">this</span>.map.baseLayer?<span class="string">"B"</span>:<span class="string">"0"</span>):d.layers+(e.getVisibility()?<span class="string">"T"</span>:<span class="string">"F"</span>)&#125;<span class="keyword">return</span> d&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.Permalink"</span>&#125;);OpenLayers.Layer.TMS=OpenLayers.Class(OpenLayers.Layer.Grid,&#123;<span class="attr">serviceVersion</span>:<span class="string">"1.0.0"</span>,<span class="attr">layername</span>:<span class="literal">null</span>,<span class="attr">type</span>:<span class="literal">null</span>,<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">tileOrigin</span>:<span class="literal">null</span>,<span class="attr">serverResolutions</span>:<span class="literal">null</span>,<span class="attr">zoomOffset</span>:<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=[];d.push(a,b,&#123;&#125;,c);OpenLayers.Layer.Grid.prototype.initialize.apply(<span class="keyword">this</span>,d)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.TMS(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.getOptions()));<span class="keyword">return</span> a=OpenLayers.Layer.Grid.prototype.clone.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.adjustBounds(a);<span class="keyword">var</span> b=<span class="keyword">this</span>.getServerResolution(),</span><br><span class="line">c=<span class="built_in">Math</span>.round((a.left-<span class="keyword">this</span>.tileOrigin.lon)/(b*<span class="keyword">this</span>.tileSize.w));a=<span class="built_in">Math</span>.round((a.bottom-<span class="keyword">this</span>.tileOrigin.lat)/(b*<span class="keyword">this</span>.tileSize.h));b=<span class="keyword">this</span>.getServerZoom();c=<span class="keyword">this</span>.serviceVersion+<span class="string">"/"</span>+<span class="keyword">this</span>.layername+<span class="string">"/"</span>+b+<span class="string">"/"</span>+c+<span class="string">"/"</span>+a+<span class="string">"."</span>+<span class="keyword">this</span>.type;a=<span class="keyword">this</span>.url;OpenLayers.Util.isArray(a)&amp;&amp;(a=<span class="keyword">this</span>.selectUrl(c,a));<span class="keyword">return</span> a+c&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Layer.Grid.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.tileOrigin||(<span class="keyword">this</span>.tileOrigin=<span class="keyword">new</span> OpenLayers.LonLat(<span class="keyword">this</span>.map.maxExtent.left,<span class="keyword">this</span>.map.maxExtent.bottom))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.TMS"</span>&#125;);OpenLayers.Format.WCSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,&#123;<span class="attr">defaultVersion</span>:<span class="string">"1.1.0"</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WCSCapabilities"</span>&#125;);OpenLayers.Format.WCSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>&#125;,<span class="attr">defaultPrefix</span>:<span class="string">"wcs"</span>,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> b=&#123;&#125;;<span class="keyword">this</span>.readNode(a,b);<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WCSCapabilities.v1"</span>&#125;);OpenLayers.Format.WCSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WCSCapabilities.v1,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">wcs</span>:<span class="string">"http://www.opengis.net/wcs"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>,<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows"</span>&#125;,<span class="attr">errorProperty</span>:<span class="string">"service"</span>,<span class="attr">readers</span>:&#123;<span class="attr">wcs</span>:&#123;<span class="attr">WCS_Capabilities</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Service</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.service=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.service)&#125;,<span class="attr">name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.name=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">label</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.label=</span><br><span class="line"><span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">keywords</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.keywords=[];<span class="keyword">this</span>.readChildNodes(a,b.keywords)&#125;,<span class="attr">keyword</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.push(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">responsibleParty</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.responsibleParty=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.responsibleParty)&#125;,<span class="attr">individualName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.individualName=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">organisationName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.organisationName=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">positionName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.positionName=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">contactInfo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.contactInfo=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,</span><br><span class="line">b.contactInfo)&#125;,<span class="attr">phone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.phone=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.phone)&#125;,<span class="attr">voice</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.voice=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">facsimile</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.facsimile=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">address</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.address=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.address)&#125;,<span class="attr">deliveryPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.deliveryPoint=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">city</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.city=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">postalCode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.postalCode=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">country</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.country=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">electronicMailAddress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.electronicMailAddress=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">fees</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.fees=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">accessConstraints</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.accessConstraints=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">ContentMetadata</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.contentMetadata=[];<span class="keyword">this</span>.readChildNodes(a,b.contentMetadata)&#125;,<span class="attr">CoverageOfferingBrief</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.push(c)&#125;,<span class="attr">name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.name=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">label</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.label=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">lonLatEnvelope</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getElementsByTagNameNS(a,</span><br><span class="line"><span class="string">"http://www.opengis.net/gml"</span>,<span class="string">"pos"</span>);<span class="keyword">if</span>(<span class="number">2</span>==c.length)&#123;<span class="keyword">var</span> d=&#123;&#125;,e=&#123;&#125;;OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(<span class="keyword">this</span>,[c[<span class="number">0</span>],d]);OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(<span class="keyword">this</span>,[c[<span class="number">1</span>],e]);b.lonLatEnvelope=&#123;&#125;;b.lonLatEnvelope.srsName=a.getAttribute(<span class="string">"srsName"</span>);b.lonLatEnvelope.min=d.points[<span class="number">0</span>];b.lonLatEnvelope.max=e.points[<span class="number">0</span>]&#125;&#125;&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WCSCapabilities.v1_0_0"</span>&#125;);OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,&#123;<span class="attr">preload</span>:!<span class="number">1</span>,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Strategy.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">if</span>(a)<span class="keyword">if</span>(<span class="keyword">this</span>.layer.events.on(&#123;<span class="attr">refresh</span>:<span class="keyword">this</span>.load,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;),!<span class="number">0</span>==<span class="keyword">this</span>.layer.visibility||<span class="keyword">this</span>.preload)<span class="keyword">this</span>.load();<span class="keyword">else</span> <span class="keyword">this</span>.layer.events.on(&#123;<span class="attr">visibilitychanged</span>:<span class="keyword">this</span>.load,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Strategy.prototype.deactivate.call(<span class="keyword">this</span>);a&amp;&amp;<span class="keyword">this</span>.layer.events.un(&#123;<span class="attr">refresh</span>:<span class="keyword">this</span>.load,<span class="attr">visibilitychanged</span>:<span class="keyword">this</span>.load,</span><br><span class="line">scope:<span class="keyword">this</span>&#125;);<span class="keyword">return</span> a&#125;,<span class="attr">load</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.layer;b.events.triggerEvent(<span class="string">"loadstart"</span>,&#123;<span class="attr">filter</span>:b.filter&#125;);b.protocol.read(OpenLayers.Util.applyDefaults(&#123;<span class="attr">callback</span>:<span class="keyword">this</span>.merge,<span class="attr">filter</span>:b.filter,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;,a));b.events.un(&#123;<span class="attr">visibilitychanged</span>:<span class="keyword">this</span>.load,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">merge</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.layer;b.destroyFeatures();<span class="keyword">var</span> c=a.features;<span class="keyword">if</span>(c&amp;&amp;<span class="number">0</span>&lt;c.length)&#123;<span class="keyword">var</span> d=b.projection,e=b.map.getProjectionObject();<span class="keyword">if</span>(!e.equals(d))<span class="keyword">for</span>(<span class="keyword">var</span> f,g=<span class="number">0</span>,h=c.length;g&lt;h;++g)(f=c[g].geometry)&amp;&amp;f.transform(d,e);b.addFeatures(c)&#125;b.events.triggerEvent(<span class="string">"loadend"</span>,</span><br><span class="line">&#123;<span class="attr">response</span>:a&#125;)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Strategy.Fixed"</span>&#125;);OpenLayers.Control.Zoom=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">zoomInText</span>:<span class="string">"+"</span>,<span class="attr">zoomInId</span>:<span class="string">"olZoomInLink"</span>,<span class="attr">zoomOutText</span>:<span class="string">"\u2212"</span>,<span class="attr">zoomOutId</span>:<span class="string">"olZoomOutLink"</span>,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Control.prototype.draw.apply(<span class="keyword">this</span>),b=<span class="keyword">this</span>.getOrCreateLinks(a),c=b.zoomIn,b=b.zoomOut,d=<span class="keyword">this</span>.map.events;b.parentNode!==a&amp;&amp;(d=<span class="keyword">this</span>.events,d.attachToElement(b.parentNode));d.register(<span class="string">"buttonclick"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onZoomClick);<span class="keyword">this</span>.zoomInLink=c;<span class="keyword">this</span>.zoomOutLink=b;<span class="keyword">return</span> a&#125;,<span class="attr">getOrCreateLinks</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="built_in">document</span>.getElementById(<span class="keyword">this</span>.zoomInId),</span><br><span class="line">c=<span class="built_in">document</span>.getElementById(<span class="keyword">this</span>.zoomOutId);b||(b=<span class="built_in">document</span>.createElement(<span class="string">"a"</span>),b.href=<span class="string">"#zoomIn"</span>,b.appendChild(<span class="built_in">document</span>.createTextNode(<span class="keyword">this</span>.zoomInText)),b.className=<span class="string">"olControlZoomIn"</span>,a.appendChild(b));OpenLayers.Element.addClass(b,<span class="string">"olButton"</span>);c||(c=<span class="built_in">document</span>.createElement(<span class="string">"a"</span>),c.href=<span class="string">"#zoomOut"</span>,c.appendChild(<span class="built_in">document</span>.createTextNode(<span class="keyword">this</span>.zoomOutText)),c.className=<span class="string">"olControlZoomOut"</span>,a.appendChild(c));OpenLayers.Element.addClass(c,<span class="string">"olButton"</span>);<span class="keyword">return</span>&#123;<span class="attr">zoomIn</span>:b,<span class="attr">zoomOut</span>:c&#125;&#125;,<span class="attr">onZoomClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.buttonElement;</span><br><span class="line">a===<span class="keyword">this</span>.zoomInLink?<span class="keyword">this</span>.map.zoomIn():a===<span class="keyword">this</span>.zoomOutLink&amp;&amp;<span class="keyword">this</span>.map.zoomOut()&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.unregister(<span class="string">"buttonclick"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onZoomClick);<span class="keyword">delete</span> <span class="keyword">this</span>.zoomInLink;<span class="keyword">delete</span> <span class="keyword">this</span>.zoomOutLink;OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.Zoom"</span>&#125;);OpenLayers.Layer.PointTrack=OpenLayers.Class(OpenLayers.Layer.Vector,&#123;<span class="attr">dataFrom</span>:<span class="literal">null</span>,<span class="attr">styleFrom</span>:<span class="literal">null</span>,<span class="attr">addNodes</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(<span class="number">2</span>&gt;a.length)<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"At least two point features have to be added to create a line from"</span>);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="built_in">Array</span>(a.length<span class="number">-1</span>),d,e,f,g=<span class="number">0</span>,h=a.length;g&lt;h;g++)&#123;d=a[g];f=d.geometry;<span class="keyword">if</span>(!f)f=d.lonlat,f=<span class="keyword">new</span> OpenLayers.Geometry.Point(f.lon,f.lat);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.Point"</span>!=f.CLASS_NAME)<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Only features with point geometries are supported."</span>);<span class="keyword">if</span>(<span class="number">0</span>&lt;g)&#123;d=<span class="literal">null</span>!=<span class="keyword">this</span>.dataFrom?</span><br><span class="line">a[g+<span class="keyword">this</span>.dataFrom].data||a[g+<span class="keyword">this</span>.dataFrom].attributes:<span class="literal">null</span>;<span class="keyword">var</span> k=<span class="literal">null</span>!=<span class="keyword">this</span>.styleFrom?a[g+<span class="keyword">this</span>.styleFrom].style:<span class="literal">null</span>;e=<span class="keyword">new</span> OpenLayers.Geometry.LineString([e,f]);c[g<span class="number">-1</span>]=<span class="keyword">new</span> OpenLayers.Feature.Vector(e,d,k)&#125;e=f&#125;<span class="keyword">this</span>.addFeatures(c,b)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.PointTrack"</span>&#125;);OpenLayers.Layer.PointTrack.SOURCE_NODE=<span class="number">-1</span>;OpenLayers.Layer.PointTrack.TARGET_NODE=<span class="number">0</span>;OpenLayers.Layer.PointTrack.dataFrom=&#123;<span class="attr">SOURCE_NODE</span>:<span class="number">-1</span>,<span class="attr">TARGET_NODE</span>:<span class="number">0</span>&#125;;OpenLayers.Protocol.WFS=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.WFS.DEFAULTS);<span class="keyword">var</span> b=OpenLayers.Protocol.WFS[<span class="string">"v"</span>+a.version.replace(<span class="regexp">/\./g</span>,<span class="string">"_"</span>)];<span class="keyword">if</span>(!b)<span class="keyword">throw</span><span class="string">"Unsupported WFS version: "</span>+a.version;<span class="keyword">return</span> <span class="keyword">new</span> b(a)&#125;;</span><br><span class="line">OpenLayers.Protocol.WFS.fromWMSLayer=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c,d;c=a.params.LAYERS;c=(OpenLayers.Util.isArray(c)?c[<span class="number">0</span>]:c).split(<span class="string">":"</span>);<span class="number">1</span>&lt;c.length&amp;&amp;(d=c[<span class="number">0</span>]);c=c.pop();d=&#123;<span class="attr">url</span>:a.url,<span class="attr">featureType</span>:c,<span class="attr">featurePrefix</span>:d,<span class="attr">srsName</span>:a.projection&amp;&amp;a.projection.getCode()||a.map&amp;&amp;a.map.getProjectionObject().getCode(),<span class="attr">version</span>:<span class="string">"1.1.0"</span>&#125;;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(b,d))&#125;;OpenLayers.Protocol.WFS.DEFAULTS=&#123;<span class="attr">version</span>:<span class="string">"1.0.0"</span>&#125;;OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,&#123;<span class="attr">isBaseLayer</span>:!<span class="number">1</span>,<span class="attr">markers</span>:<span class="literal">null</span>,<span class="attr">drawn</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Layer.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.markers=[]&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.clearMarkers();<span class="keyword">this</span>.markers=<span class="literal">null</span>;OpenLayers.Layer.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">setOpacity</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a!=<span class="keyword">this</span>.opacity)&#123;<span class="keyword">this</span>.opacity=a;a=<span class="number">0</span>;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.markers.length;a&lt;b;a++)<span class="keyword">this</span>.markers[a].setOpacity(<span class="keyword">this</span>.opacity)&#125;&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Layer.prototype.moveTo.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>);<span class="keyword">if</span>(b||!<span class="keyword">this</span>.drawn)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e=<span class="keyword">this</span>.markers.length;d&lt;e;d++)<span class="keyword">this</span>.drawMarker(<span class="keyword">this</span>.markers[d]);<span class="keyword">this</span>.drawn=!<span class="number">0</span>&#125;&#125;,<span class="attr">addMarker</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.markers.push(a);<span class="number">1</span>&gt;<span class="keyword">this</span>.opacity&amp;&amp;a.setOpacity(<span class="keyword">this</span>.opacity);<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.getExtent()&amp;&amp;(a.map=<span class="keyword">this</span>.map,<span class="keyword">this</span>.drawMarker(a))&#125;,<span class="attr">removeMarker</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.markers&amp;&amp;<span class="keyword">this</span>.markers.length&amp;&amp;(OpenLayers.Util.removeItem(<span class="keyword">this</span>.markers,a),a.erase())&#125;,<span class="attr">clearMarkers</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.markers)<span class="keyword">for</span>(;<span class="number">0</span>&lt;<span class="keyword">this</span>.markers.length;)<span class="keyword">this</span>.removeMarker(<span class="keyword">this</span>.markers[<span class="number">0</span>])&#125;,</span><br><span class="line">drawMarker:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getLayerPxFromLonLat(a.lonlat);<span class="literal">null</span>==b?a.display(!<span class="number">1</span>):a.isDrawn()?a.icon&amp;&amp;a.icon.moveTo(b):(a=a.draw(b),<span class="keyword">this</span>.div.appendChild(a))&#125;,<span class="attr">getDataExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="literal">null</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.markers&amp;&amp;<span class="number">0</span>&lt;<span class="keyword">this</span>.markers.length)<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">new</span> OpenLayers.Bounds,b=<span class="number">0</span>,c=<span class="keyword">this</span>.markers.length;b&lt;c;b++)a.extend(<span class="keyword">this</span>.markers[b].lonlat);<span class="keyword">return</span> a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.Markers"</span>&#125;);OpenLayers.Control.Pan=OpenLayers.Class(OpenLayers.Control.Button,&#123;<span class="attr">slideFactor</span>:<span class="number">50</span>,<span class="attr">slideRatio</span>:<span class="literal">null</span>,<span class="attr">direction</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.direction=a;<span class="keyword">this</span>.CLASS_NAME+=<span class="keyword">this</span>.direction;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[b])&#125;,<span class="attr">trigger</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.map)&#123;<span class="keyword">var</span> a=OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.slideRatio?<span class="keyword">this</span>.map.getSize()[a]*<span class="keyword">this</span>.slideRatio:<span class="keyword">this</span>.slideFactor&#125;,<span class="keyword">this</span>);<span class="keyword">switch</span>(<span class="keyword">this</span>.direction)&#123;<span class="keyword">case</span> OpenLayers.Control.Pan.NORTH:<span class="keyword">this</span>.map.pan(<span class="number">0</span>,-a(<span class="string">"h"</span>));<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Control.Pan.SOUTH:<span class="keyword">this</span>.map.pan(<span class="number">0</span>,</span><br><span class="line">a(<span class="string">"h"</span>));<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Control.Pan.WEST:<span class="keyword">this</span>.map.pan(-a(<span class="string">"w"</span>),<span class="number">0</span>);<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Control.Pan.EAST:<span class="keyword">this</span>.map.pan(a(<span class="string">"w"</span>),<span class="number">0</span>)&#125;&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.Pan"</span>&#125;);OpenLayers.Control.Pan.NORTH=<span class="string">"North"</span>;OpenLayers.Control.Pan.SOUTH=<span class="string">"South"</span>;OpenLayers.Control.Pan.EAST=<span class="string">"East"</span>;OpenLayers.Control.Pan.WEST=<span class="string">"West"</span>;OpenLayers.Format.CSWGetDomain=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.CSWGetDomain.DEFAULTS);<span class="keyword">var</span> b=OpenLayers.Format.CSWGetDomain[<span class="string">"v"</span>+a.version.replace(<span class="regexp">/\./g</span>,<span class="string">"_"</span>)];<span class="keyword">if</span>(!b)<span class="keyword">throw</span><span class="string">"Unsupported CSWGetDomain version: "</span>+a.version;<span class="keyword">return</span> <span class="keyword">new</span> b(a)&#125;;OpenLayers.Format.CSWGetDomain.DEFAULTS=&#123;<span class="attr">version</span>:<span class="string">"2.0.2"</span>&#125;;OpenLayers.Format.CSWGetDomain.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>,<span class="attr">csw</span>:<span class="string">"http://www.opengis.net/cat/csw/2.0.2"</span>&#125;,<span class="attr">defaultPrefix</span>:<span class="string">"csw"</span>,<span class="attr">version</span>:<span class="string">"2.0.2"</span>,<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd"</span>,<span class="attr">PropertyName</span>:<span class="literal">null</span>,<span class="attr">ParameterName</span>:<span class="literal">null</span>,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a&amp;&amp;<span class="number">9</span>==</span><br><span class="line">a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> b=&#123;&#125;;<span class="keyword">this</span>.readNode(a,b);<span class="keyword">return</span> b&#125;,<span class="attr">readers</span>:&#123;<span class="attr">csw</span>:&#123;<span class="attr">GetDomainResponse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">DomainValues</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Util.isArray(b.DomainValues)||(b.DomainValues=[]);<span class="keyword">for</span>(<span class="keyword">var</span> c=a.attributes,d=&#123;&#125;,e=<span class="number">0</span>,f=c.length;e&lt;f;++e)d[c[e].name]=c[e].nodeValue;<span class="keyword">this</span>.readChildNodes(a,d);b.DomainValues.push(d)&#125;,<span class="attr">PropertyName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.PropertyName=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">ParameterName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.ParameterName=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">ListOfValues</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;OpenLayers.Util.isArray(b.ListOfValues)||(b.ListOfValues=[]);<span class="keyword">this</span>.readChildNodes(a,b.ListOfValues)&#125;,<span class="attr">Value</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=a.attributes,d=&#123;&#125;,e=<span class="number">0</span>,f=c.length;e&lt;f;++e)d[c[e].name]=c[e].nodeValue;d.value=<span class="keyword">this</span>.getChildValue(a);b.push(&#123;<span class="attr">Value</span>:d&#125;)&#125;,<span class="attr">ConceptualScheme</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.ConceptualScheme=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.ConceptualScheme)&#125;,<span class="attr">Name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.Name=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Document</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.Document=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Authority</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.Authority=<span class="keyword">this</span>.getChildValue(a)&#125;,</span><br><span class="line">RangeOfValues:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.RangeOfValues=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.RangeOfValues)&#125;,<span class="attr">MinValue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=a.attributes,d=&#123;&#125;,e=<span class="number">0</span>,f=c.length;e&lt;f;++e)d[c[e].name]=c[e].nodeValue;d.value=<span class="keyword">this</span>.getChildValue(a);b.MinValue=d&#125;,<span class="attr">MaxValue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=a.attributes,d=&#123;&#125;,e=<span class="number">0</span>,f=c.length;e&lt;f;++e)d[c[e].name]=c[e].nodeValue;d.value=<span class="keyword">this</span>.getChildValue(a);b.MaxValue=d&#125;&#125;&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.writeNode(<span class="string">"csw:GetDomain"</span>,a);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">writers</span>:&#123;<span class="attr">csw</span>:&#123;<span class="attr">GetDomain</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.createElementNSPlus(<span class="string">"csw:GetDomain"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">service</span>:<span class="string">"CSW"</span>,<span class="attr">version</span>:<span class="keyword">this</span>.version&#125;&#125;);a.PropertyName||<span class="keyword">this</span>.PropertyName?<span class="keyword">this</span>.writeNode(<span class="string">"csw:PropertyName"</span>,a.PropertyName||<span class="keyword">this</span>.PropertyName,b):(a.ParameterName||<span class="keyword">this</span>.ParameterName)&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"csw:ParameterName"</span>,a.ParameterName||<span class="keyword">this</span>.ParameterName,b);<span class="keyword">this</span>.readChildNodes(b,a);<span class="keyword">return</span> b&#125;,<span class="attr">PropertyName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"csw:PropertyName"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">ParameterName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"csw:ParameterName"</span>,</span><br><span class="line">&#123;<span class="attr">value</span>:a&#125;)&#125;&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.CSWGetDomain.v2_0_2"</span>&#125;);OpenLayers.Format.ArcXML.Features=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span>(<span class="keyword">new</span> OpenLayers.Format.ArcXML).read(a).features.feature&#125;&#125;);OpenLayers.Control.Snapping=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">DEFAULTS</span>:&#123;<span class="attr">tolerance</span>:<span class="number">10</span>,<span class="attr">node</span>:!<span class="number">0</span>,<span class="attr">edge</span>:!<span class="number">0</span>,<span class="attr">vertex</span>:!<span class="number">0</span>&#125;,<span class="attr">greedy</span>:!<span class="number">0</span>,<span class="attr">precedence</span>:[<span class="string">"node"</span>,<span class="string">"vertex"</span>,<span class="string">"edge"</span>],<span class="attr">resolution</span>:<span class="literal">null</span>,<span class="attr">geoToleranceCache</span>:<span class="literal">null</span>,<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">feature</span>:<span class="literal">null</span>,<span class="attr">point</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.options=a||&#123;&#125;;<span class="keyword">this</span>.options.layer&amp;&amp;<span class="keyword">this</span>.setLayer(<span class="keyword">this</span>.options.layer);a=OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>.options.defaults);<span class="keyword">this</span>.defaults=OpenLayers.Util.applyDefaults(a,<span class="keyword">this</span>.DEFAULTS);<span class="keyword">this</span>.setTargets(<span class="keyword">this</span>.options.targets);</span><br><span class="line"><span class="number">0</span>===<span class="keyword">this</span>.targets.length&amp;&amp;<span class="keyword">this</span>.layer&amp;&amp;<span class="keyword">this</span>.addTargetLayer(<span class="keyword">this</span>.layer);<span class="keyword">this</span>.geoToleranceCache=&#123;&#125;&#125;,<span class="attr">setLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.active?(<span class="keyword">this</span>.deactivate(),<span class="keyword">this</span>.layer=a,<span class="keyword">this</span>.activate()):<span class="keyword">this</span>.layer=a&#125;,<span class="attr">setTargets</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.targets=[];<span class="keyword">if</span>(a&amp;&amp;a.length)<span class="keyword">for</span>(<span class="keyword">var</span> b,c=<span class="number">0</span>,d=a.length;c&lt;d;++c)b=a[c],b <span class="keyword">instanceof</span> OpenLayers.Layer.Vector?<span class="keyword">this</span>.addTargetLayer(b):<span class="keyword">this</span>.addTarget(b)&#125;,<span class="attr">addTargetLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.addTarget(&#123;<span class="attr">layer</span>:a&#125;)&#125;,<span class="attr">addTarget</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.applyDefaults(a,<span class="keyword">this</span>.defaults);a.nodeTolerance=</span><br><span class="line">a.nodeTolerance||a.tolerance;a.vertexTolerance=a.vertexTolerance||a.tolerance;a.edgeTolerance=a.edgeTolerance||a.tolerance;<span class="keyword">this</span>.targets.push(a)&#125;,<span class="attr">removeTargetLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b,c=<span class="keyword">this</span>.targets.length<span class="number">-1</span>;<span class="number">0</span>&lt;=c;--c)b=<span class="keyword">this</span>.targets[c],b.layer===a&amp;&amp;<span class="keyword">this</span>.removeTarget(b)&#125;,<span class="attr">removeTarget</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Util.removeItem(<span class="keyword">this</span>.targets,a)&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Control.prototype.activate.call(<span class="keyword">this</span>);<span class="keyword">if</span>(a&amp;&amp;<span class="keyword">this</span>.layer&amp;&amp;<span class="keyword">this</span>.layer.events)<span class="keyword">this</span>.layer.events.on(&#123;<span class="attr">sketchstarted</span>:<span class="keyword">this</span>.onSketchModified,</span><br><span class="line">sketchmodified:<span class="keyword">this</span>.onSketchModified,<span class="attr">vertexmodified</span>:<span class="keyword">this</span>.onVertexModified,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Control.prototype.deactivate.call(<span class="keyword">this</span>);a&amp;&amp;<span class="keyword">this</span>.layer&amp;&amp;<span class="keyword">this</span>.layer.events&amp;&amp;<span class="keyword">this</span>.layer.events.un(&#123;<span class="attr">sketchstarted</span>:<span class="keyword">this</span>.onSketchModified,<span class="attr">sketchmodified</span>:<span class="keyword">this</span>.onSketchModified,<span class="attr">vertexmodified</span>:<span class="keyword">this</span>.onVertexModified,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">this</span>.point=<span class="keyword">this</span>.feature=<span class="literal">null</span>;<span class="keyword">return</span> a&#125;,<span class="attr">onSketchModified</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.feature=a.feature;<span class="keyword">this</span>.considerSnapping(a.vertex,a.vertex)&#125;,<span class="attr">onVertexModified</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.feature=</span><br><span class="line">a.feature;<span class="keyword">var</span> b=<span class="keyword">this</span>.layer.map.getLonLatFromViewPortPx(a.pixel);<span class="keyword">this</span>.considerSnapping(a.vertex,<span class="keyword">new</span> OpenLayers.Geometry.Point(b.lon,b.lat))&#125;,<span class="attr">considerSnapping</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=&#123;<span class="attr">rank</span>:<span class="built_in">Number</span>.POSITIVE_INFINITY,<span class="attr">dist</span>:<span class="built_in">Number</span>.POSITIVE_INFINITY,<span class="attr">x</span>:<span class="literal">null</span>,<span class="attr">y</span>:<span class="literal">null</span>&#125;,d=!<span class="number">1</span>,e,f,g=<span class="number">0</span>,h=<span class="keyword">this</span>.targets.length;g&lt;h;++g)<span class="keyword">if</span>(f=<span class="keyword">this</span>.targets[g],e=<span class="keyword">this</span>.testTarget(f,b))<span class="keyword">if</span>(<span class="keyword">this</span>.greedy)&#123;c=e;c.target=f;d=!<span class="number">0</span>;<span class="keyword">break</span>&#125;<span class="keyword">else</span> <span class="keyword">if</span>(e.rank&lt;c.rank||e.rank===c.rank&amp;&amp;e.dist&lt;c.dist)c=e,c.target=f,d=!<span class="number">0</span>;d&amp;&amp;(!<span class="number">1</span>!==<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforesnap"</span>,</span><br><span class="line">&#123;<span class="attr">point</span>:a,<span class="attr">x</span>:c.x,<span class="attr">y</span>:c.y,<span class="attr">distance</span>:c.dist,<span class="attr">layer</span>:c.target.layer,<span class="attr">snapType</span>:<span class="keyword">this</span>.precedence[c.rank]&#125;)?(a.x=c.x,a.y=c.y,<span class="keyword">this</span>.point=a,<span class="keyword">this</span>.events.triggerEvent(<span class="string">"snap"</span>,&#123;<span class="attr">point</span>:a,<span class="attr">snapType</span>:<span class="keyword">this</span>.precedence[c.rank],<span class="attr">layer</span>:c.target.layer,<span class="attr">distance</span>:c.dist&#125;)):d=!<span class="number">1</span>);<span class="keyword">this</span>.point&amp;&amp;!d&amp;&amp;(a.x=b.x,a.y=b.y,<span class="keyword">this</span>.point=<span class="literal">null</span>,<span class="keyword">this</span>.events.triggerEvent(<span class="string">"unsnap"</span>,&#123;<span class="attr">point</span>:a&#125;))&#125;,<span class="attr">testTarget</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.layer.map.getResolution();<span class="keyword">if</span>(<span class="string">"minResolution"</span><span class="keyword">in</span> a&amp;&amp;c&lt;a.minResolution||<span class="string">"maxResolution"</span><span class="keyword">in</span> a&amp;&amp;c&gt;=a.maxResolution)<span class="keyword">return</span> <span class="literal">null</span>;<span class="keyword">for</span>(<span class="keyword">var</span> c=</span><br><span class="line">&#123;<span class="attr">node</span>:<span class="keyword">this</span>.getGeoTolerance(a.nodeTolerance,c),<span class="attr">vertex</span>:<span class="keyword">this</span>.getGeoTolerance(a.vertexTolerance,c),<span class="attr">edge</span>:<span class="keyword">this</span>.getGeoTolerance(a.edgeTolerance,c)&#125;,d=<span class="built_in">Math</span>.max(c.node,c.vertex,c.edge),e=&#123;<span class="attr">rank</span>:<span class="built_in">Number</span>.POSITIVE_INFINITY,<span class="attr">dist</span>:<span class="built_in">Number</span>.POSITIVE_INFINITY&#125;,f=!<span class="number">1</span>,g=a.layer.features,h,k,l,m,n,p,q=<span class="keyword">this</span>.precedence.length,r=<span class="keyword">new</span> OpenLayers.LonLat(b.x,b.y),s=<span class="number">0</span>,t=g.length;s&lt;t;++s)<span class="keyword">if</span>(h=g[s],h!==<span class="keyword">this</span>.feature&amp;&amp;(!h._sketch&amp;&amp;h.state!==OpenLayers.State.DELETE&amp;&amp;(!a.filter||a.filter.evaluate(h)))&amp;&amp;h.atPoint(r,d,d))<span class="keyword">for</span>(<span class="keyword">var</span> u=<span class="number">0</span>,v=<span class="built_in">Math</span>.min(e.rank+</span><br><span class="line"><span class="number">1</span>,q);u&lt;v;++u)<span class="keyword">if</span>(k=<span class="keyword">this</span>.precedence[u],a[k])<span class="keyword">if</span>(<span class="string">"edge"</span>===k)&#123;<span class="keyword">if</span>(l=h.geometry.distanceTo(b,&#123;<span class="attr">details</span>:!<span class="number">0</span>&#125;),n=l.distance,n&lt;=c[k]&amp;&amp;n&lt;e.dist)&#123;e=&#123;<span class="attr">rank</span>:u,<span class="attr">dist</span>:n,<span class="attr">x</span>:l.x0,<span class="attr">y</span>:l.y0&#125;;f=!<span class="number">0</span>;<span class="keyword">break</span>&#125;&#125;<span class="keyword">else</span>&#123;l=h.geometry.getVertices(<span class="string">"node"</span>===k);p=!<span class="number">1</span>;<span class="keyword">for</span>(<span class="keyword">var</span> w=<span class="number">0</span>,x=l.length;w&lt;x;++w)m=l[w],n=m.distanceTo(b),n&lt;=c[k]&amp;&amp;(u&lt;e.rank||u===e.rank&amp;&amp;n&lt;e.dist)&amp;&amp;(e=&#123;<span class="attr">rank</span>:u,<span class="attr">dist</span>:n,<span class="attr">x</span>:m.x,<span class="attr">y</span>:m.y&#125;,p=f=!<span class="number">0</span>);<span class="keyword">if</span>(p)<span class="keyword">break</span>&#125;<span class="keyword">return</span> f?e:<span class="literal">null</span>&#125;,<span class="attr">getGeoTolerance</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b!==<span class="keyword">this</span>.resolution&amp;&amp;(<span class="keyword">this</span>.resolution=b,<span class="keyword">this</span>.geoToleranceCache=&#123;&#125;);<span class="keyword">var</span> c=<span class="keyword">this</span>.geoToleranceCache[a];</span><br><span class="line"><span class="keyword">void</span> <span class="number">0</span>===c&amp;&amp;(c=a*b,<span class="keyword">this</span>.geoToleranceCache[a]=c);<span class="keyword">return</span> c&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.active&amp;&amp;<span class="keyword">this</span>.deactivate();<span class="keyword">delete</span> <span class="keyword">this</span>.layer;<span class="keyword">delete</span> <span class="keyword">this</span>.targets;OpenLayers.Control.prototype.destroy.call(<span class="keyword">this</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.Snapping"</span>&#125;);OpenLayers.Format.OWSCommon.v1_1_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows/1.1"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>&#125;,<span class="attr">readers</span>:&#123;<span class="attr">ows</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">ExceptionReport</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.exceptionReport=&#123;<span class="attr">version</span>:a.getAttribute(<span class="string">"version"</span>),<span class="attr">language</span>:a.getAttribute(<span class="string">"xml:lang"</span>),<span class="attr">exceptions</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.exceptionReport)&#125;,<span class="attr">AllowedValues</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.allowedValues=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.allowedValues)&#125;,<span class="attr">AnyValue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.anyValue=</span><br><span class="line">!<span class="number">0</span>&#125;,<span class="attr">DataType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.dataType=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Range</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.range=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.range)&#125;,<span class="attr">MinimumValue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.minValue=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">MaximumValue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.maxValue=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Identifier</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.identifier=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">SupportedCRS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.supportedCRS=<span class="keyword">this</span>.getChildValue(a)&#125;&#125;,OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)&#125;,<span class="attr">writers</span>:&#123;<span class="attr">ows</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">Range</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ows:Range"</span>,</span><br><span class="line">&#123;<span class="attr">attributes</span>:&#123;<span class="string">"ows:rangeClosure"</span>:a.closure&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"ows:MinimumValue"</span>,a.minValue,b);<span class="keyword">this</span>.writeNode(<span class="string">"ows:MaximumValue"</span>,a.maxValue,b);<span class="keyword">return</span> b&#125;,<span class="attr">MinimumValue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ows:MinimumValue"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">MaximumValue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ows:MaximumValue"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">Value</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ows:Value"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;&#125;,OpenLayers.Format.OWSCommon.v1.prototype.writers.ows)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.OWSCommon.v1_1_0"</span>&#125;);OpenLayers.Format.WCSGetCoverage=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows/1.1"</span>,<span class="attr">wcs</span>:<span class="string">"http://www.opengis.net/wcs/1.1"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&#125;,<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">VERSION</span>:<span class="string">"1.1.2"</span>,<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/wcs/1.1 http://schemas.opengis.net/wcs/1.1/wcsGetCoverage.xsd"</span>,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.writeNode(<span class="string">"wcs:GetCoverage"</span>,</span><br><span class="line">a);<span class="keyword">this</span>.setAttributeNS(a,<span class="keyword">this</span>.namespaces.xsi,<span class="string">"xsi:schemaLocation"</span>,<span class="keyword">this</span>.schemaLocation);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">writers</span>:&#123;<span class="attr">wcs</span>:&#123;<span class="attr">GetCoverage</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:GetCoverage"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">version</span>:a.version||<span class="keyword">this</span>.VERSION,<span class="attr">service</span>:<span class="string">"WCS"</span>&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"ows:Identifier"</span>,a.identifier,b);<span class="keyword">this</span>.writeNode(<span class="string">"wcs:DomainSubset"</span>,a.domainSubset,b);<span class="keyword">this</span>.writeNode(<span class="string">"wcs:Output"</span>,a.output,b);<span class="keyword">return</span> b&#125;,<span class="attr">DomainSubset</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:DomainSubset"</span>,</span><br><span class="line">&#123;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"ows:BoundingBox"</span>,a.boundingBox,b);a.temporalSubset&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"wcs:TemporalSubset"</span>,a.temporalSubset,b);<span class="keyword">return</span> b&#125;,<span class="attr">TemporalSubset</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:TemporalSubset"</span>,&#123;&#125;),c=<span class="number">0</span>,d=a.timePeriods.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"wcs:TimePeriod"</span>,a.timePeriods[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">TimePeriod</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:TimePeriod"</span>,&#123;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"wcs:BeginPosition"</span>,a.begin,b);<span class="keyword">this</span>.writeNode(<span class="string">"wcs:EndPosition"</span>,a.end,b);a.resolution&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"wcs:TimeResolution"</span>,</span><br><span class="line">a.resolution,b);<span class="keyword">return</span> b&#125;,<span class="attr">BeginPosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:BeginPosition"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">EndPosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:EndPosition"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">TimeResolution</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:TimeResolution"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">Output</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:Output"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">format</span>:a.format,<span class="attr">store</span>:a.store&#125;&#125;);a.gridCRS&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"wcs:GridCRS"</span>,a.gridCRS,b);<span class="keyword">return</span> b&#125;,<span class="attr">GridCRS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:GridCRS"</span>,</span><br><span class="line">&#123;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"wcs:GridBaseCRS"</span>,a.baseCRS,b);a.type&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"wcs:GridType"</span>,a.type,b);a.origin&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"wcs:GridOrigin"</span>,a.origin,b);<span class="keyword">this</span>.writeNode(<span class="string">"wcs:GridOffsets"</span>,a.offsets,b);a.CS&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"wcs:GridCS"</span>,a.CS,b);<span class="keyword">return</span> b&#125;,<span class="attr">GridBaseCRS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:GridBaseCRS"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">GridOrigin</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:GridOrigin"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">GridType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:GridType"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">GridOffsets</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:GridOffsets"</span>,</span><br><span class="line">&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">GridCS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"wcs:GridCS"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;&#125;,<span class="attr">ows</span>:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WCSGetCoverage"</span>&#125;);OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">kml</span>:<span class="string">"http://www.opengis.net/kml/2.2"</span>,<span class="attr">gx</span>:<span class="string">"http://www.google.com/kml/ext/2.2"</span>&#125;,<span class="attr">kmlns</span>:<span class="string">"http://earth.google.com/kml/2.0"</span>,<span class="attr">placemarksDesc</span>:<span class="string">"No description available"</span>,<span class="attr">foldersName</span>:<span class="string">"OpenLayers export"</span>,<span class="attr">foldersDesc</span>:<span class="string">"Exported on "</span>+<span class="keyword">new</span> <span class="built_in">Date</span>,<span class="attr">extractAttributes</span>:!<span class="number">0</span>,<span class="attr">kvpAttributes</span>:!<span class="number">1</span>,<span class="attr">extractStyles</span>:!<span class="number">1</span>,<span class="attr">extractTracks</span>:!<span class="number">1</span>,<span class="attr">trackAttributes</span>:<span class="literal">null</span>,<span class="attr">internalns</span>:<span class="literal">null</span>,<span class="attr">features</span>:<span class="literal">null</span>,<span class="attr">styles</span>:<span class="literal">null</span>,<span class="attr">styleBaseUrl</span>:<span class="string">""</span>,<span class="attr">fetched</span>:<span class="literal">null</span>,<span class="attr">maxDepth</span>:<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.regExes=</span><br><span class="line">&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>,<span class="attr">kmlColor</span>:<span class="regexp">/(\w&#123;2&#125;)(\w&#123;2&#125;)(\w&#123;2&#125;)(\w&#123;2&#125;)/</span>,<span class="attr">kmlIconPalette</span>:<span class="regexp">/root:\/\/icons\/palette-(\d+)(\.\w+)/</span>,<span class="attr">straightBracket</span>:<span class="regexp">/\$\[(.*?)\]/g</span>&#125;;<span class="keyword">this</span>.externalProjection=<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>);OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.features=[];<span class="keyword">this</span>.styles=&#123;&#125;;<span class="keyword">this</span>.fetched=&#123;&#125;;<span class="keyword">return</span> <span class="keyword">this</span>.parseData(a,&#123;<span class="attr">depth</span>:<span class="number">0</span>,<span class="attr">styleBaseUrl</span>:<span class="keyword">this</span>.styleBaseUrl&#125;)&#125;,<span class="attr">parseData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;</span><br><span class="line">(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));<span class="keyword">for</span>(<span class="keyword">var</span> c=[<span class="string">"Link"</span>,<span class="string">"NetworkLink"</span>,<span class="string">"Style"</span>,<span class="string">"StyleMap"</span>,<span class="string">"Placemark"</span>],d=<span class="number">0</span>,e=c.length;d&lt;e;++d)&#123;<span class="keyword">var</span> f=c[d],g=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="string">"*"</span>,f);<span class="keyword">if</span>(<span class="number">0</span>!=g.length)<span class="keyword">switch</span>(f.toLowerCase())&#123;<span class="keyword">case</span> <span class="string">"link"</span>:<span class="keyword">case</span> <span class="string">"networklink"</span>:<span class="keyword">this</span>.parseLinks(g,b);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"style"</span>:<span class="keyword">this</span>.extractStyles&amp;&amp;<span class="keyword">this</span>.parseStyles(g,b);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"stylemap"</span>:<span class="keyword">this</span>.extractStyles&amp;&amp;<span class="keyword">this</span>.parseStyleMaps(g,b);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"placemark"</span>:<span class="keyword">this</span>.parseFeatures(g,b)&#125;&#125;<span class="keyword">return</span> <span class="keyword">this</span>.features&#125;,<span class="attr">parseLinks</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">if</span>(b.depth&gt;=<span class="keyword">this</span>.maxDepth)<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">var</span> c=OpenLayers.Util.extend(&#123;&#125;,b);c.depth++;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e=a.length;d&lt;e;d++)&#123;<span class="keyword">var</span> f=<span class="keyword">this</span>.parseProperty(a[d],<span class="string">"*"</span>,<span class="string">"href"</span>);f&amp;&amp;!<span class="keyword">this</span>.fetched[f]&amp;&amp;(<span class="keyword">this</span>.fetched[f]=!<span class="number">0</span>,(f=<span class="keyword">this</span>.fetchLink(f))&amp;&amp;<span class="keyword">this</span>.parseData(f,c))&#125;&#125;,<span class="attr">fetchLink</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a=OpenLayers.Request.GET(&#123;<span class="attr">url</span>:a,<span class="attr">async</span>:!<span class="number">1</span>&#125;))<span class="keyword">return</span> a.responseText&#125;,<span class="attr">parseStyles</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;c++)&#123;<span class="keyword">var</span> e=<span class="keyword">this</span>.parseStyle(a[c]);e&amp;&amp;(<span class="keyword">this</span>.styles[(b.styleBaseUrl||<span class="string">""</span>)+<span class="string">"#"</span>+e.id]=e)&#125;&#125;,<span class="attr">parseKmlColor</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="literal">null</span>;a&amp;&amp;(a=a.match(<span class="keyword">this</span>.regExes.kmlColor))&amp;&amp;(b=&#123;<span class="attr">color</span>:<span class="string">"#"</span>+a[<span class="number">4</span>]+a[<span class="number">3</span>]+a[<span class="number">2</span>],<span class="attr">opacity</span>:<span class="built_in">parseInt</span>(a[<span class="number">1</span>],<span class="number">16</span>)/<span class="number">255</span>&#125;);<span class="keyword">return</span> b&#125;,<span class="attr">parseStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=&#123;&#125;,c=[<span class="string">"LineStyle"</span>,<span class="string">"PolyStyle"</span>,<span class="string">"IconStyle"</span>,<span class="string">"BalloonStyle"</span>,<span class="string">"LabelStyle"</span>],d,e,f=<span class="number">0</span>,g=c.length;f&lt;g;++f)<span class="keyword">if</span>(d=c[f],e=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="string">"*"</span>,d)[<span class="number">0</span>])<span class="keyword">switch</span>(d.toLowerCase())&#123;<span class="keyword">case</span> <span class="string">"linestyle"</span>:d=<span class="keyword">this</span>.parseProperty(e,<span class="string">"*"</span>,<span class="string">"color"</span>);<span class="keyword">if</span>(d=<span class="keyword">this</span>.parseKmlColor(d))b.strokeColor=d.color,b.strokeOpacity=d.opacity;(d=<span class="keyword">this</span>.parseProperty(e,<span class="string">"*"</span>,<span class="string">"width"</span>))&amp;&amp;(b.strokeWidth=</span><br><span class="line">d);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"polystyle"</span>:d=<span class="keyword">this</span>.parseProperty(e,<span class="string">"*"</span>,<span class="string">"color"</span>);<span class="keyword">if</span>(d=<span class="keyword">this</span>.parseKmlColor(d))b.fillOpacity=d.opacity,b.fillColor=d.color;<span class="string">"0"</span>==<span class="keyword">this</span>.parseProperty(e,<span class="string">"*"</span>,<span class="string">"fill"</span>)&amp;&amp;(b.fillColor=<span class="string">"none"</span>);<span class="string">"0"</span>==<span class="keyword">this</span>.parseProperty(e,<span class="string">"*"</span>,<span class="string">"outline"</span>)&amp;&amp;(b.strokeWidth=<span class="string">"0"</span>);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"iconstyle"</span>:<span class="keyword">var</span> h=<span class="built_in">parseFloat</span>(<span class="keyword">this</span>.parseProperty(e,<span class="string">"*"</span>,<span class="string">"scale"</span>)||<span class="number">1</span>);d=<span class="number">32</span>*h;<span class="keyword">var</span> k=<span class="number">32</span>*h,l=<span class="keyword">this</span>.getElementsByTagNameNS(e,<span class="string">"*"</span>,<span class="string">"Icon"</span>)[<span class="number">0</span>];<span class="keyword">if</span>(l)&#123;<span class="keyword">var</span> m=<span class="keyword">this</span>.parseProperty(l,<span class="string">"*"</span>,<span class="string">"href"</span>);<span class="keyword">if</span>(m)&#123;<span class="keyword">var</span> n=<span class="keyword">this</span>.parseProperty(l,<span class="string">"*"</span>,<span class="string">"w"</span>),p=<span class="keyword">this</span>.parseProperty(l,</span><br><span class="line"><span class="string">"*"</span>,<span class="string">"h"</span>);!OpenLayers.String.startsWith(m,<span class="string">"http://maps.google.com/mapfiles/kml"</span>)||(n||p)||(p=n=<span class="number">64</span>,h/=<span class="number">2</span>);n=n||p;p=p||n;n&amp;&amp;(d=<span class="built_in">parseInt</span>(n)*h);p&amp;&amp;(k=<span class="built_in">parseInt</span>(p)*h);<span class="keyword">if</span>(p=m.match(<span class="keyword">this</span>.regExes.kmlIconPalette))n=p[<span class="number">1</span>],p=p[<span class="number">2</span>],m=<span class="keyword">this</span>.parseProperty(l,<span class="string">"*"</span>,<span class="string">"x"</span>),l=<span class="keyword">this</span>.parseProperty(l,<span class="string">"*"</span>,<span class="string">"y"</span>),m=<span class="string">"http://maps.google.com/mapfiles/kml/pal"</span>+n+<span class="string">"/icon"</span>+(<span class="number">8</span>*(l?<span class="number">7</span>-l/<span class="number">32</span>:<span class="number">7</span>)+(m?m/<span class="number">32</span>:<span class="number">0</span>))+p;b.graphicOpacity=<span class="number">1</span>;b.externalGraphic=m&#125;&#125;<span class="keyword">if</span>(e=<span class="keyword">this</span>.getElementsByTagNameNS(e,<span class="string">"*"</span>,<span class="string">"hotSpot"</span>)[<span class="number">0</span>])m=<span class="built_in">parseFloat</span>(e.getAttribute(<span class="string">"x"</span>)),l=<span class="built_in">parseFloat</span>(e.getAttribute(<span class="string">"y"</span>)),</span><br><span class="line">n=e.getAttribute(<span class="string">"xunits"</span>),<span class="string">"pixels"</span>==n?b.graphicXOffset=-m*h:<span class="string">"insetPixels"</span>==n?b.graphicXOffset=-d+m*h:<span class="string">"fraction"</span>==n&amp;&amp;(b.graphicXOffset=-d*m),e=e.getAttribute(<span class="string">"yunits"</span>),<span class="string">"pixels"</span>==e?b.graphicYOffset=-k+l*h+<span class="number">1</span>:<span class="string">"insetPixels"</span>==e?b.graphicYOffset=-(l*h)+<span class="number">1</span>:<span class="string">"fraction"</span>==e&amp;&amp;(b.graphicYOffset=-k*(<span class="number">1</span>-l)+<span class="number">1</span>);b.graphicWidth=d;b.graphicHeight=k;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"balloonstyle"</span>:(e=OpenLayers.Util.getXmlNodeValue(e))&amp;&amp;(b.balloonStyle=e.replace(<span class="keyword">this</span>.regExes.straightBracket,<span class="string">"$&#123;$1&#125;"</span>));<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"labelstyle"</span>:<span class="keyword">if</span>(d=<span class="keyword">this</span>.parseProperty(e,</span><br><span class="line"><span class="string">"*"</span>,<span class="string">"color"</span>),d=<span class="keyword">this</span>.parseKmlColor(d))b.fontColor=d.color,b.fontOpacity=d.opacity&#125;!b.strokeColor&amp;&amp;b.fillColor&amp;&amp;(b.strokeColor=b.fillColor);(a=a.getAttribute(<span class="string">"id"</span>))&amp;&amp;b&amp;&amp;(b.id=a);<span class="keyword">return</span> b&#125;,<span class="attr">parseStyleMaps</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;c++)<span class="keyword">for</span>(<span class="keyword">var</span> e=a[c],f=<span class="keyword">this</span>.getElementsByTagNameNS(e,<span class="string">"*"</span>,<span class="string">"Pair"</span>),e=e.getAttribute(<span class="string">"id"</span>),g=<span class="number">0</span>,h=f.length;g&lt;h;g++)&#123;<span class="keyword">var</span> k=f[g],l=<span class="keyword">this</span>.parseProperty(k,<span class="string">"*"</span>,<span class="string">"key"</span>);(k=<span class="keyword">this</span>.parseProperty(k,<span class="string">"*"</span>,<span class="string">"styleUrl"</span>))&amp;&amp;<span class="string">"normal"</span>==l&amp;&amp;(<span class="keyword">this</span>.styles[(b.styleBaseUrl||<span class="string">""</span>)+<span class="string">"#"</span>+e]=<span class="keyword">this</span>.styles[(b.styleBaseUrl||</span><br><span class="line"><span class="string">""</span>)+k])&#125;&#125;,<span class="attr">parseFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=[],d=<span class="number">0</span>,e=a.length;d&lt;e;d++)&#123;<span class="keyword">var</span> f=a[d],g=<span class="keyword">this</span>.parseFeature.apply(<span class="keyword">this</span>,[f]);<span class="keyword">if</span>(g)&#123;<span class="keyword">this</span>.extractStyles&amp;&amp;(g.attributes&amp;&amp;g.attributes.styleUrl)&amp;&amp;(g.style=<span class="keyword">this</span>.getStyle(g.attributes.styleUrl,b));<span class="keyword">if</span>(<span class="keyword">this</span>.extractStyles)&#123;<span class="keyword">var</span> h=<span class="keyword">this</span>.getElementsByTagNameNS(f,<span class="string">"*"</span>,<span class="string">"Style"</span>)[<span class="number">0</span>];h&amp;&amp;(h=<span class="keyword">this</span>.parseStyle(h))&amp;&amp;(g.style=OpenLayers.Util.extend(g.style,h))&#125;<span class="keyword">this</span>.extractTracks?(f=<span class="keyword">this</span>.getElementsByTagNameNS(f,<span class="keyword">this</span>.namespaces.gx,<span class="string">"Track"</span>))&amp;&amp;<span class="number">0</span>&lt;f.length&amp;&amp;(g=&#123;<span class="attr">features</span>:[],<span class="attr">feature</span>:g&#125;,</span><br><span class="line"><span class="keyword">this</span>.readNode(f[<span class="number">0</span>],g),<span class="number">0</span>&lt;g.features.length&amp;&amp;c.push.apply(c,g.features)):c.push(g)&#125;<span class="keyword">else</span> <span class="keyword">throw</span><span class="string">"Bad Placemark: "</span>+d;&#125;<span class="keyword">this</span>.features=<span class="keyword">this</span>.features.concat(c)&#125;,<span class="attr">readers</span>:&#123;<span class="attr">kml</span>:&#123;<span class="attr">when</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.whens.push(OpenLayers.Date.parse(<span class="keyword">this</span>.getChildValue(a)))&#125;,<span class="attr">_trackPointAttribute</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.nodeName.split(<span class="string">":"</span>).pop();b.attributes[c].push(<span class="keyword">this</span>.getChildValue(a))&#125;&#125;,<span class="attr">gx</span>:&#123;<span class="attr">Track</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">whens</span>:[],<span class="attr">points</span>:[],<span class="attr">angles</span>:[]&#125;;<span class="keyword">if</span>(<span class="keyword">this</span>.trackAttributes)&#123;<span class="keyword">var</span> d;c.attributes=&#123;&#125;;<span class="keyword">for</span>(<span class="keyword">var</span> e=<span class="number">0</span>,f=<span class="keyword">this</span>.trackAttributes.length;e&lt;</span><br><span class="line">f;++e)d=<span class="keyword">this</span>.trackAttributes[e],c.attributes[d]=[],d <span class="keyword">in</span> <span class="keyword">this</span>.readers.kml||(<span class="keyword">this</span>.readers.kml[d]=<span class="keyword">this</span>.readers.kml._trackPointAttribute)&#125;<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">if</span>(c.whens.length!==c.points.length)<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"gx:Track with unequal number of when ("</span>+c.whens.length+<span class="string">") and gx:coord ("</span>+c.points.length+<span class="string">") elements."</span>);<span class="keyword">var</span> g=<span class="number">0</span>&lt;c.angles.length;<span class="keyword">if</span>(g&amp;&amp;c.whens.length!==c.angles.length)<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"gx:Track with unequal number of when ("</span>+c.whens.length+<span class="string">") and gx:angles ("</span>+c.angles.length+<span class="string">") elements."</span>);<span class="keyword">for</span>(<span class="keyword">var</span> h,</span><br><span class="line">e=<span class="number">0</span>,f=c.whens.length;e&lt;f;++e)&#123;h=b.feature.clone();h.fid=b.feature.fid||b.feature.id;d=c.points[e];h.geometry=d;<span class="string">"z"</span><span class="keyword">in</span> d&amp;&amp;(h.attributes.altitude=d.z);<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection&amp;&amp;h.geometry.transform(<span class="keyword">this</span>.externalProjection,<span class="keyword">this</span>.internalProjection);<span class="keyword">if</span>(<span class="keyword">this</span>.trackAttributes)<span class="keyword">for</span>(<span class="keyword">var</span> k=<span class="number">0</span>,l=<span class="keyword">this</span>.trackAttributes.length;k&lt;l;++k)d=<span class="keyword">this</span>.trackAttributes[k],h.attributes[d]=c.attributes[d][e];h.attributes.when=c.whens[e];h.attributes.trackId=b.feature.id;g&amp;&amp;(d=c.angles[e],h.attributes.heading=</span><br><span class="line"><span class="built_in">parseFloat</span>(d[<span class="number">0</span>]),h.attributes.tilt=<span class="built_in">parseFloat</span>(d[<span class="number">1</span>]),h.attributes.roll=<span class="built_in">parseFloat</span>(d[<span class="number">2</span>]));b.features.push(h)&#125;&#125;,<span class="attr">coord</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a).replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>).split(<span class="regexp">/\s+/</span>),d=<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">0</span>],c[<span class="number">1</span>]);<span class="number">2</span>&lt;c.length&amp;&amp;(d.z=<span class="built_in">parseFloat</span>(c[<span class="number">2</span>]));b.points.push(d)&#125;,<span class="attr">angles</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a).replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>).split(<span class="regexp">/\s+/</span>);b.angles.push(c)&#125;&#125;&#125;,<span class="attr">parseFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[<span class="string">"MultiGeometry"</span>,<span class="string">"Polygon"</span>,<span class="string">"LineString"</span>,<span class="string">"Point"</span>],</span><br><span class="line">c,d,e,f=<span class="number">0</span>,g=b.length;f&lt;g;++f)<span class="keyword">if</span>(c=b[f],<span class="keyword">this</span>.internalns=a.namespaceURI?a.namespaceURI:<span class="keyword">this</span>.kmlns,d=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.internalns,c),<span class="number">0</span>&lt;d.length)&#123;<span class="keyword">if</span>(b=<span class="keyword">this</span>.parseGeometry[c.toLowerCase()])e=b.apply(<span class="keyword">this</span>,[d[<span class="number">0</span>]]),<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection&amp;&amp;e.transform(<span class="keyword">this</span>.externalProjection,<span class="keyword">this</span>.internalProjection);<span class="keyword">else</span> <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Unsupported geometry type: "</span>+c);<span class="keyword">break</span>&#125;<span class="keyword">var</span> h;<span class="keyword">this</span>.extractAttributes&amp;&amp;(h=<span class="keyword">this</span>.parseAttributes(a));c=<span class="keyword">new</span> OpenLayers.Feature.Vector(e,h);a=a.getAttribute(<span class="string">"id"</span>)||</span><br><span class="line">a.getAttribute(<span class="string">"name"</span>);<span class="literal">null</span>!=a&amp;&amp;(c.fid=a);<span class="keyword">return</span> c&#125;,<span class="attr">getStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Util.removeTail(a),d=OpenLayers.Util.extend(&#123;&#125;,b);d.depth++;d.styleBaseUrl=c;!<span class="keyword">this</span>.styles[a]&amp;&amp;!OpenLayers.String.startsWith(a,<span class="string">"#"</span>)&amp;&amp;d.depth&lt;=<span class="keyword">this</span>.maxDepth&amp;&amp;!<span class="keyword">this</span>.fetched[c]&amp;&amp;(c=<span class="keyword">this</span>.fetchLink(c))&amp;&amp;<span class="keyword">this</span>.parseData(c,d);<span class="keyword">return</span> OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>.styles[a])&#125;,<span class="attr">parseGeometry</span>:&#123;<span class="attr">point</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.internalns,<span class="string">"coordinates"</span>);a=[];<span class="keyword">if</span>(<span class="number">0</span>&lt;b.length)&#123;<span class="keyword">var</span> c=b[<span class="number">0</span>].firstChild.nodeValue,</span><br><span class="line">c=c.replace(<span class="keyword">this</span>.regExes.removeSpace,<span class="string">""</span>);a=c.split(<span class="string">","</span>)&#125;b=<span class="literal">null</span>;<span class="keyword">if</span>(<span class="number">1</span>&lt;a.length)<span class="number">2</span>==a.length&amp;&amp;(a[<span class="number">2</span>]=<span class="literal">null</span>),b=<span class="keyword">new</span> OpenLayers.Geometry.Point(a[<span class="number">0</span>],a[<span class="number">1</span>],a[<span class="number">2</span>]);<span class="keyword">else</span> <span class="keyword">throw</span><span class="string">"Bad coordinate string: "</span>+c;<span class="keyword">return</span> b&#125;,<span class="attr">linestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.internalns,<span class="string">"coordinates"</span>),d=<span class="literal">null</span>;<span class="keyword">if</span>(<span class="number">0</span>&lt;c.length)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(c[<span class="number">0</span>]),c=c.replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>),c=c.replace(<span class="keyword">this</span>.regExes.trimComma,<span class="string">","</span>),d=c.split(<span class="keyword">this</span>.regExes.splitSpace),e=d.length,f=<span class="built_in">Array</span>(e),g,h,k=<span class="number">0</span>;k&lt;e;++k)<span class="keyword">if</span>(g=</span><br><span class="line">d[k].split(<span class="string">","</span>),h=g.length,<span class="number">1</span>&lt;h)<span class="number">2</span>==g.length&amp;&amp;(g[<span class="number">2</span>]=<span class="literal">null</span>),f[k]=<span class="keyword">new</span> OpenLayers.Geometry.Point(g[<span class="number">0</span>],g[<span class="number">1</span>],g[<span class="number">2</span>]);<span class="keyword">else</span> <span class="keyword">throw</span><span class="string">"Bad LineString point coordinates: "</span>+d[k];<span class="keyword">if</span>(e)d=b?<span class="keyword">new</span> OpenLayers.Geometry.LinearRing(f):<span class="keyword">new</span> OpenLayers.Geometry.LineString(f);<span class="keyword">else</span> <span class="keyword">throw</span><span class="string">"Bad LineString coordinates: "</span>+c;&#125;<span class="keyword">return</span> d&#125;,<span class="attr">polygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.internalns,<span class="string">"LinearRing"</span>);<span class="keyword">var</span> b=a.length,c=<span class="built_in">Array</span>(b);<span class="keyword">if</span>(<span class="number">0</span>&lt;b)<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e=a.length;d&lt;e;++d)<span class="keyword">if</span>(b=<span class="keyword">this</span>.parseGeometry.linestring.apply(<span class="keyword">this</span>,[a[d],!<span class="number">0</span>]))c[d]=</span><br><span class="line">b;<span class="keyword">else</span> <span class="keyword">throw</span><span class="string">"Bad LinearRing geometry: "</span>+d;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.Polygon(c)&#125;,<span class="attr">multigeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b,c=[],d=a.childNodes,e=<span class="number">0</span>,f=d.length;e&lt;f;++e)a=d[e],<span class="number">1</span>==a.nodeType&amp;&amp;(b=a.prefix?a.nodeName.split(<span class="string">":"</span>)[<span class="number">1</span>]:a.nodeName,(b=<span class="keyword">this</span>.parseGeometry[b.toLowerCase()])&amp;&amp;c.push(b.apply(<span class="keyword">this</span>,[a])));<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Geometry.Collection(c)&#125;&#125;,<span class="attr">parseAttributes</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;&#125;,c=a.getElementsByTagName(<span class="string">"ExtendedData"</span>);c.length&amp;&amp;(b=<span class="keyword">this</span>.parseExtendedData(c[<span class="number">0</span>]));<span class="keyword">var</span> d,e,f;a=a.childNodes;<span class="keyword">for</span>(<span class="keyword">var</span> c=</span><br><span class="line"><span class="number">0</span>,g=a.length;c&lt;g;++c)<span class="keyword">if</span>(d=a[c],<span class="number">1</span>==d.nodeType&amp;&amp;(e=d.childNodes,<span class="number">1</span>&lt;=e.length&amp;&amp;<span class="number">3</span>&gt;=e.length))&#123;<span class="keyword">switch</span>(e.length)&#123;<span class="keyword">case</span> <span class="number">1</span>:f=e[<span class="number">0</span>];<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">2</span>:f=e[<span class="number">0</span>];e=e[<span class="number">1</span>];f=<span class="number">3</span>==f.nodeType||<span class="number">4</span>==f.nodeType?f:e;<span class="keyword">break</span>;<span class="keyword">default</span>:f=e[<span class="number">1</span>]&#125;<span class="keyword">if</span>(<span class="number">3</span>==f.nodeType||<span class="number">4</span>==f.nodeType)<span class="keyword">if</span>(d=d.prefix?d.nodeName.split(<span class="string">":"</span>)[<span class="number">1</span>]:d.nodeName,f=OpenLayers.Util.getXmlNodeValue(f))f=f.replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>),b[d]=f&#125;<span class="keyword">return</span> b&#125;,<span class="attr">parseExtendedData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;&#125;,c,d,e,f,g=a.getElementsByTagName(<span class="string">"Data"</span>);c=<span class="number">0</span>;<span class="keyword">for</span>(d=g.length;c&lt;d;c++)&#123;e=g[c];f=e.getAttribute(<span class="string">"name"</span>);</span><br><span class="line"><span class="keyword">var</span> h=&#123;&#125;,k=e.getElementsByTagName(<span class="string">"value"</span>);k.length&amp;&amp;(h.value=<span class="keyword">this</span>.getChildValue(k[<span class="number">0</span>]));<span class="keyword">this</span>.kvpAttributes?b[f]=h.value:(e=e.getElementsByTagName(<span class="string">"displayName"</span>),e.length&amp;&amp;(h.displayName=<span class="keyword">this</span>.getChildValue(e[<span class="number">0</span>])),b[f]=h)&#125;a=a.getElementsByTagName(<span class="string">"SimpleData"</span>);c=<span class="number">0</span>;<span class="keyword">for</span>(d=a.length;c&lt;d;c++)h=&#123;&#125;,e=a[c],f=e.getAttribute(<span class="string">"name"</span>),h.value=<span class="keyword">this</span>.getChildValue(e),<span class="keyword">this</span>.kvpAttributes?b[f]=h.value:(h.displayName=f,b[f]=h);<span class="keyword">return</span> b&#125;,<span class="attr">parseProperty</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d;a=<span class="keyword">this</span>.getElementsByTagNameNS(a,b,c);<span class="keyword">try</span>&#123;d=OpenLayers.Util.getXmlNodeValue(a[<span class="number">0</span>])&#125;<span class="keyword">catch</span>(e)&#123;d=</span><br><span class="line"><span class="literal">null</span>&#125;<span class="keyword">return</span> d&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.isArray(a)||(a=[a]);<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"kml"</span>),c=<span class="keyword">this</span>.createFolderXML(),d=<span class="number">0</span>,e=a.length;d&lt;e;++d)c.appendChild(<span class="keyword">this</span>.createPlacemarkXML(a[d]));b.appendChild(c);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[b])&#125;,<span class="attr">createFolderXML</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"Folder"</span>);<span class="keyword">if</span>(<span class="keyword">this</span>.foldersName)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"name"</span>),c=<span class="keyword">this</span>.createTextNode(<span class="keyword">this</span>.foldersName);b.appendChild(c);a.appendChild(b)&#125;<span class="keyword">this</span>.foldersDesc&amp;&amp;</span><br><span class="line">(b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"description"</span>),c=<span class="keyword">this</span>.createTextNode(<span class="keyword">this</span>.foldersDesc),b.appendChild(c),a.appendChild(b));<span class="keyword">return</span> a&#125;,<span class="attr">createPlacemarkXML</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"name"</span>),c=a.style&amp;&amp;a.style.label?a.style.label:a.id;b.appendChild(<span class="keyword">this</span>.createTextNode(a.attributes.name||c));<span class="keyword">var</span> d=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"description"</span>);d.appendChild(<span class="keyword">this</span>.createTextNode(a.attributes.description||<span class="keyword">this</span>.placemarksDesc));c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"Placemark"</span>);<span class="literal">null</span>!=</span><br><span class="line">a.fid&amp;&amp;c.setAttribute(<span class="string">"id"</span>,a.fid);c.appendChild(b);c.appendChild(d);b=<span class="keyword">this</span>.buildGeometryNode(a.geometry);c.appendChild(b);a.attributes&amp;&amp;(a=<span class="keyword">this</span>.buildExtendedData(a.attributes))&amp;&amp;c.appendChild(a);<span class="keyword">return</span> c&#125;,<span class="attr">buildGeometryNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.CLASS_NAME,b=b.substring(b.lastIndexOf(<span class="string">"."</span>)+<span class="number">1</span>),b=<span class="keyword">this</span>.buildGeometry[b.toLowerCase()],c=<span class="literal">null</span>;b&amp;&amp;(c=b.apply(<span class="keyword">this</span>,[a]));<span class="keyword">return</span> c&#125;,<span class="attr">buildGeometry</span>:&#123;<span class="attr">point</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"Point"</span>);b.appendChild(<span class="keyword">this</span>.buildCoordinatesNode(a));<span class="keyword">return</span> b&#125;,</span><br><span class="line">multipoint:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.buildGeometry.collection.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">linestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"LineString"</span>);b.appendChild(<span class="keyword">this</span>.buildCoordinatesNode(a));<span class="keyword">return</span> b&#125;,<span class="attr">multilinestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.buildGeometry.collection.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">linearring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"LinearRing"</span>);b.appendChild(<span class="keyword">this</span>.buildCoordinatesNode(a));<span class="keyword">return</span> b&#125;,<span class="attr">polygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"Polygon"</span>);a=a.components;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> c,d,e=<span class="number">0</span>,f=a.length;e&lt;f;++e)c=<span class="number">0</span>==e?<span class="string">"outerBoundaryIs"</span>:<span class="string">"innerBoundaryIs"</span>,c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,c),d=<span class="keyword">this</span>.buildGeometry.linearring.apply(<span class="keyword">this</span>,[a[e]]),c.appendChild(d),b.appendChild(c);<span class="keyword">return</span> b&#125;,<span class="attr">multipolygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.buildGeometry.collection.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">collection</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"MultiGeometry"</span>),c,d=<span class="number">0</span>,e=a.components.length;d&lt;e;++d)(c=<span class="keyword">this</span>.buildGeometryNode.apply(<span class="keyword">this</span>,[a.components[d]]))&amp;&amp;b.appendChild(c);<span class="keyword">return</span> b&#125;&#125;,<span class="attr">buildCoordinatesNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"coordinates"</span>),c;<span class="keyword">if</span>(c=a.components)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=c.length,e=<span class="built_in">Array</span>(d),f=<span class="number">0</span>;f&lt;d;++f)a=c[f],e[f]=<span class="keyword">this</span>.buildCoordinates(a);c=e.join(<span class="string">" "</span>)&#125;<span class="keyword">else</span> c=<span class="keyword">this</span>.buildCoordinates(a);c=<span class="keyword">this</span>.createTextNode(c);b.appendChild(c);<span class="keyword">return</span> b&#125;,<span class="attr">buildCoordinates</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection&amp;&amp;(a=a.clone(),a.transform(<span class="keyword">this</span>.internalProjection,<span class="keyword">this</span>.externalProjection));<span class="keyword">return</span> a.x+<span class="string">","</span>+a.y&#125;,<span class="attr">buildExtendedData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"ExtendedData"</span>),</span><br><span class="line">c;<span class="keyword">for</span>(c <span class="keyword">in</span> a)<span class="keyword">if</span>(a[c]&amp;&amp;<span class="string">"name"</span>!=c&amp;&amp;<span class="string">"description"</span>!=c&amp;&amp;<span class="string">"styleUrl"</span>!=c)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"Data"</span>);d.setAttribute(<span class="string">"name"</span>,c);<span class="keyword">var</span> e=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"value"</span>);<span class="keyword">if</span>(<span class="string">"object"</span>==<span class="keyword">typeof</span> a[c])&#123;<span class="keyword">if</span>(a[c].value&amp;&amp;e.appendChild(<span class="keyword">this</span>.createTextNode(a[c].value)),a[c].displayName)&#123;<span class="keyword">var</span> f=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.kmlns,<span class="string">"displayName"</span>);f.appendChild(<span class="keyword">this</span>.getXMLDoc().createCDATASection(a[c].displayName));d.appendChild(f)&#125;&#125;<span class="keyword">else</span> e.appendChild(<span class="keyword">this</span>.createTextNode(a[c]));d.appendChild(e);b.appendChild(d)&#125;<span class="keyword">return</span> <span class="keyword">this</span>.isSimpleContent(b)?</span><br><span class="line"><span class="literal">null</span>:b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.KML"</span>&#125;);OpenLayers.Format.WMSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,&#123;<span class="attr">defaultVersion</span>:<span class="string">"1.1.1"</span>,<span class="attr">profile</span>:<span class="literal">null</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMSCapabilities"</span>&#125;);OpenLayers.Format.WMSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">wms</span>:<span class="string">"http://www.opengis.net/wms"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&#125;,<span class="attr">defaultPrefix</span>:<span class="string">"wms"</span>,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));<span class="keyword">var</span> b=a;a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readNode(a,c);<span class="keyword">void</span> <span class="number">0</span>===c.service&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Format.OGCExceptionReport,c.error=a.read(b));<span class="keyword">return</span> c&#125;,<span class="attr">readers</span>:&#123;<span class="attr">wms</span>:&#123;<span class="attr">Service</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.service=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.service)&#125;,<span class="attr">Name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.name=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Title</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.title=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Abstract</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b[<span class="string">"abstract"</span>]=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">BoundingBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;c.bbox=[<span class="built_in">parseFloat</span>(a.getAttribute(<span class="string">"minx"</span>)),<span class="built_in">parseFloat</span>(a.getAttribute(<span class="string">"miny"</span>)),<span class="built_in">parseFloat</span>(a.getAttribute(<span class="string">"maxx"</span>)),<span class="built_in">parseFloat</span>(a.getAttribute(<span class="string">"maxy"</span>))];<span class="keyword">var</span> d=&#123;<span class="attr">x</span>:<span class="built_in">parseFloat</span>(a.getAttribute(<span class="string">"resx"</span>)),<span class="attr">y</span>:<span class="built_in">parseFloat</span>(a.getAttribute(<span class="string">"resy"</span>))&#125;;<span class="built_in">isNaN</span>(d.x)&amp;&amp;<span class="built_in">isNaN</span>(d.y)||(c.res=</span><br><span class="line">d);<span class="keyword">return</span> c&#125;,<span class="attr">OnlineResource</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.href=<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.xlink,<span class="string">"href"</span>)&#125;,<span class="attr">ContactInformation</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.contactInformation=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.contactInformation)&#125;,<span class="attr">ContactPersonPrimary</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.personPrimary=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.personPrimary)&#125;,<span class="attr">ContactPerson</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.person=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">ContactOrganization</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.organization=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">ContactPosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.position=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">ContactAddress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.contactAddress=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.contactAddress)&#125;,<span class="attr">AddressType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.type=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Address</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.address=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">City</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.city=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">StateOrProvince</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.stateOrProvince=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">PostCode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.postcode=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Country</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.country=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">ContactVoiceTelephone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.phone=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">ContactFacsimileTelephone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.fax=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">ContactElectronicMailAddress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.email=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Fees</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);c&amp;&amp;<span class="string">"none"</span>!=c.toLowerCase()&amp;&amp;(b.fees=c)&#125;,<span class="attr">AccessConstraints</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);c&amp;&amp;<span class="string">"none"</span>!=c.toLowerCase()&amp;&amp;(b.accessConstraints=c)&#125;,<span class="attr">Capability</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.capability=&#123;<span class="attr">nestedLayers</span>:[],<span class="attr">layers</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.capability)&#125;,<span class="attr">Request</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.request=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.request)&#125;,<span class="attr">GetCapabilities</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.getcapabilities=&#123;<span class="attr">formats</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.getcapabilities)&#125;,<span class="attr">Format</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Util.isArray(b.formats)?b.formats.push(<span class="keyword">this</span>.getChildValue(a)):b.format=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">DCPType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">HTTP</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Get</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.get=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.get);b.href||(b.href=b.get.href)&#125;,<span class="attr">Post</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.post=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.post);b.href||(b.href=b.get.href)&#125;,<span class="attr">GetMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.getmap=&#123;<span class="attr">formats</span>:[]&#125;;</span><br><span class="line"><span class="keyword">this</span>.readChildNodes(a,b.getmap)&#125;,<span class="attr">GetFeatureInfo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.getfeatureinfo=&#123;<span class="attr">formats</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.getfeatureinfo)&#125;,<span class="attr">Exception</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.exception=&#123;<span class="attr">formats</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.exception)&#125;,<span class="attr">Layer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c,d;b.capability?(d=b.capability,c=b):d=b;<span class="keyword">var</span> e=a.getAttributeNode(<span class="string">"queryable"</span>),f=e&amp;&amp;e.specified?a.getAttribute(<span class="string">"queryable"</span>):<span class="literal">null</span>,g=(e=a.getAttributeNode(<span class="string">"cascaded"</span>))&amp;&amp;e.specified?a.getAttribute(<span class="string">"cascaded"</span>):<span class="literal">null</span>,e=(e=a.getAttributeNode(<span class="string">"opaque"</span>))&amp;&amp;e.specified?</span><br><span class="line">a.getAttribute(<span class="string">"opaque"</span>):<span class="literal">null</span>,h=a.getAttribute(<span class="string">"noSubsets"</span>),k=a.getAttribute(<span class="string">"fixedWidth"</span>),l=a.getAttribute(<span class="string">"fixedHeight"</span>),m=c||&#123;&#125;,n=OpenLayers.Util.extend;c=&#123;<span class="attr">nestedLayers</span>:[],<span class="attr">styles</span>:c?[].concat(c.styles):[],<span class="attr">srs</span>:c?n(&#123;&#125;,m.srs):&#123;&#125;,<span class="attr">metadataURLs</span>:[],<span class="attr">bbox</span>:c?n(&#123;&#125;,m.bbox):&#123;&#125;,<span class="attr">llbbox</span>:m.llbbox,<span class="attr">dimensions</span>:c?n(&#123;&#125;,m.dimensions):&#123;&#125;,<span class="attr">authorityURLs</span>:c?n(&#123;&#125;,m.authorityURLs):&#123;&#125;,<span class="attr">identifiers</span>:&#123;&#125;,<span class="attr">keywords</span>:[],<span class="attr">queryable</span>:f&amp;&amp;<span class="string">""</span>!==f?<span class="string">"1"</span>===f||<span class="string">"true"</span>===f:m.queryable||!<span class="number">1</span>,<span class="attr">cascaded</span>:<span class="literal">null</span>!==g?<span class="built_in">parseInt</span>(g):m.cascaded||<span class="number">0</span>,<span class="attr">opaque</span>:e?<span class="string">"1"</span>===</span><br><span class="line">e||<span class="string">"true"</span>===e:m.opaque||!<span class="number">1</span>,<span class="attr">noSubsets</span>:<span class="literal">null</span>!==h?<span class="string">"1"</span>===h||<span class="string">"true"</span>===h:m.noSubsets||!<span class="number">1</span>,<span class="attr">fixedWidth</span>:<span class="literal">null</span>!=k?<span class="built_in">parseInt</span>(k):m.fixedWidth||<span class="number">0</span>,<span class="attr">fixedHeight</span>:<span class="literal">null</span>!=l?<span class="built_in">parseInt</span>(l):m.fixedHeight||<span class="number">0</span>,<span class="attr">minScale</span>:m.minScale,<span class="attr">maxScale</span>:m.maxScale,<span class="attr">attribution</span>:m.attribution&#125;;b.nestedLayers.push(c);c.capability=d;<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">delete</span> c.capability;c.name&amp;&amp;(f=c.name.split(<span class="string">":"</span>),g=d.request,e=g.getfeatureinfo,<span class="number">0</span>&lt;f.length&amp;&amp;(c.prefix=f[<span class="number">0</span>]),d.layers.push(c),<span class="keyword">void</span> <span class="number">0</span>===c.formats&amp;&amp;(c.formats=g.getmap.formats),<span class="keyword">void</span> <span class="number">0</span>===c.infoFormats&amp;&amp;</span><br><span class="line">e&amp;&amp;(c.infoFormats=e.formats))&#125;,<span class="attr">Attribution</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.attribution=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.attribution)&#125;,<span class="attr">LogoURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.logo=&#123;<span class="attr">width</span>:a.getAttribute(<span class="string">"width"</span>),<span class="attr">height</span>:a.getAttribute(<span class="string">"height"</span>)&#125;;<span class="keyword">this</span>.readChildNodes(a,b.logo)&#125;,<span class="attr">Style</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;b.styles.push(c);<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">LegendURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">width</span>:a.getAttribute(<span class="string">"width"</span>),<span class="attr">height</span>:a.getAttribute(<span class="string">"height"</span>)&#125;;b.legend=c;<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">MetadataURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">type</span>:a.getAttribute(<span class="string">"type"</span>)&#125;;</span><br><span class="line">b.metadataURLs.push(c);<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">DataURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.dataURL=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.dataURL)&#125;,<span class="attr">FeatureListURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.featureListURL=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.featureListURL)&#125;,<span class="attr">AuthorityURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.getAttribute(<span class="string">"name"</span>),d=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,d);b.authorityURLs[c]=d.href&#125;,<span class="attr">Identifier</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.getAttribute(<span class="string">"authority"</span>);b.identifiers[c]=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">KeywordList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">SRS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.srs[<span class="keyword">this</span>.getChildValue(a)]=</span><br><span class="line">!<span class="number">0</span>&#125;&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMSCapabilities.v1"</span>&#125;);OpenLayers.Format.WMSCapabilities.v1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,&#123;<span class="attr">readers</span>:&#123;<span class="attr">wms</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">WMT_MS_Capabilities</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Keyword</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.keywords&amp;&amp;b.keywords.push(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">DescribeLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.describelayer=&#123;<span class="attr">formats</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.describelayer)&#125;,<span class="attr">GetLegendGraphic</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.getlegendgraphic=&#123;<span class="attr">formats</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.getlegendgraphic)&#125;,<span class="attr">GetStyles</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.getstyles=</span><br><span class="line">&#123;<span class="attr">formats</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.getstyles)&#125;,<span class="attr">PutStyles</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.putstyles=&#123;<span class="attr">formats</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.putstyles)&#125;,<span class="attr">UserDefinedSymbolization</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">supportSLD</span>:<span class="number">1</span>==<span class="built_in">parseInt</span>(a.getAttribute(<span class="string">"SupportSLD"</span>)),<span class="attr">userLayer</span>:<span class="number">1</span>==<span class="built_in">parseInt</span>(a.getAttribute(<span class="string">"UserLayer"</span>)),<span class="attr">userStyle</span>:<span class="number">1</span>==<span class="built_in">parseInt</span>(a.getAttribute(<span class="string">"UserStyle"</span>)),<span class="attr">remoteWFS</span>:<span class="number">1</span>==<span class="built_in">parseInt</span>(a.getAttribute(<span class="string">"RemoteWFS"</span>))&#125;;b.userSymbols=c&#125;,<span class="attr">LatLonBoundingBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.llbbox=[<span class="built_in">parseFloat</span>(a.getAttribute(<span class="string">"minx"</span>)),<span class="built_in">parseFloat</span>(a.getAttribute(<span class="string">"miny"</span>)),</span><br><span class="line"><span class="built_in">parseFloat</span>(a.getAttribute(<span class="string">"maxx"</span>)),<span class="built_in">parseFloat</span>(a.getAttribute(<span class="string">"maxy"</span>))]&#125;,<span class="attr">BoundingBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(<span class="keyword">this</span>,[a,b]);c.srs=a.getAttribute(<span class="string">"SRS"</span>);b.bbox[c.srs]=c&#125;,<span class="attr">ScaleHint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.getAttribute(<span class="string">"min"</span>),d=a.getAttribute(<span class="string">"max"</span>),e=<span class="built_in">Math</span>.pow(<span class="number">2</span>,<span class="number">0.5</span>),f=OpenLayers.INCHES_PER_UNIT.m;<span class="number">0</span>!=c&amp;&amp;(b.maxScale=<span class="built_in">parseFloat</span>((c/e*f*OpenLayers.DOTS_PER_INCH).toPrecision(<span class="number">13</span>)));d!=<span class="built_in">Number</span>.POSITIVE_INFINITY&amp;&amp;(b.minScale=<span class="built_in">parseFloat</span>((d/e*f*</span><br><span class="line">OpenLayers.DOTS_PER_INCH).toPrecision(<span class="number">13</span>)))&#125;,<span class="attr">Dimension</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">name</span>:a.getAttribute(<span class="string">"name"</span>).toLowerCase(),<span class="attr">units</span>:a.getAttribute(<span class="string">"units"</span>),<span class="attr">unitsymbol</span>:a.getAttribute(<span class="string">"unitSymbol"</span>)&#125;;b.dimensions[c.name]=c&#125;,<span class="attr">Extent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.getAttribute(<span class="string">"name"</span>).toLowerCase();<span class="keyword">if</span>(c <span class="keyword">in</span> b.dimensions)&#123;c=b.dimensions[c];c.nearestVal=<span class="string">"1"</span>===a.getAttribute(<span class="string">"nearestValue"</span>);c.multipleVal=<span class="string">"1"</span>===a.getAttribute(<span class="string">"multipleValues"</span>);c.current=<span class="string">"1"</span>===a.getAttribute(<span class="string">"current"</span>);c[<span class="string">"default"</span>]=a.getAttribute(<span class="string">"default"</span>)||</span><br><span class="line"><span class="string">""</span>;<span class="keyword">var</span> d=<span class="keyword">this</span>.getChildValue(a);c.values=d.split(<span class="string">","</span>)&#125;&#125;&#125;,OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMSCapabilities.v1_1"</span>&#125;);OpenLayers.Format.WMSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,&#123;<span class="attr">version</span>:<span class="string">"1.1.0"</span>,<span class="attr">readers</span>:&#123;<span class="attr">wms</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">SRS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a).split(<span class="regexp">/ +/</span>),d=<span class="number">0</span>,e=c.length;d&lt;e;d++)b.srs[c[d]]=!<span class="number">0</span>&#125;&#125;,OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMSCapabilities.v1_1_0"</span>&#125;);OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,&#123;<span class="attr">version</span>:<span class="literal">null</span>,<span class="attr">srsName</span>:<span class="string">"EPSG:4326"</span>,<span class="attr">featureType</span>:<span class="literal">null</span>,<span class="attr">featureNS</span>:<span class="literal">null</span>,<span class="attr">geometryName</span>:<span class="string">"the_geom"</span>,<span class="attr">schema</span>:<span class="literal">null</span>,<span class="attr">featurePrefix</span>:<span class="string">"feature"</span>,<span class="attr">formatOptions</span>:<span class="literal">null</span>,<span class="attr">readFormat</span>:<span class="literal">null</span>,<span class="attr">readOptions</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Protocol.prototype.initialize.apply(<span class="keyword">this</span>,[a]);a.format||(<span class="keyword">this</span>.format=OpenLayers.Format.WFST(OpenLayers.Util.extend(&#123;<span class="attr">version</span>:<span class="keyword">this</span>.version,<span class="attr">featureType</span>:<span class="keyword">this</span>.featureType,<span class="attr">featureNS</span>:<span class="keyword">this</span>.featureNS,<span class="attr">featurePrefix</span>:<span class="keyword">this</span>.featurePrefix,<span class="attr">geometryName</span>:<span class="keyword">this</span>.geometryName,</span><br><span class="line">srsName:<span class="keyword">this</span>.srsName,<span class="attr">schema</span>:<span class="keyword">this</span>.schema&#125;,<span class="keyword">this</span>.formatOptions)));!a.geometryName&amp;&amp;<span class="number">1</span>&lt;<span class="built_in">parseFloat</span>(<span class="keyword">this</span>.format.version)&amp;&amp;<span class="keyword">this</span>.setGeometryName(<span class="literal">null</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.options&amp;&amp;!<span class="keyword">this</span>.options.format&amp;&amp;<span class="keyword">this</span>.format.destroy();<span class="keyword">this</span>.format=<span class="literal">null</span>;OpenLayers.Protocol.prototype.destroy.apply(<span class="keyword">this</span>)&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Protocol.prototype.read.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);a=OpenLayers.Util.extend(&#123;&#125;,a);OpenLayers.Util.applyDefaults(a,<span class="keyword">this</span>.options||&#123;&#125;);<span class="keyword">var</span> b=<span class="keyword">new</span> OpenLayers.Protocol.Response(&#123;<span class="attr">requestType</span>:<span class="string">"read"</span>&#125;),</span><br><span class="line">c=OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>.format,[<span class="keyword">this</span>.format.writeNode(<span class="string">"wfs:GetFeature"</span>,a)]);b.priv=OpenLayers.Request.POST(&#123;<span class="attr">url</span>:a.url,<span class="attr">callback</span>:<span class="keyword">this</span>.createCallback(<span class="keyword">this</span>.handleRead,b,a),<span class="attr">params</span>:a.params,<span class="attr">headers</span>:a.headers,<span class="attr">data</span>:c&#125;);<span class="keyword">return</span> b&#125;,<span class="attr">setFeatureType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.featureType=a;<span class="keyword">this</span>.format.featureType=a&#125;,<span class="attr">setGeometryName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.geometryName=a;<span class="keyword">this</span>.format.geometryName=a&#125;,<span class="attr">handleRead</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=OpenLayers.Util.extend(&#123;&#125;,b);OpenLayers.Util.applyDefaults(b,<span class="keyword">this</span>.options);<span class="keyword">if</span>(b.callback)&#123;<span class="keyword">var</span> c=</span><br><span class="line">a.priv;<span class="number">200</span>&lt;=c.status&amp;&amp;<span class="number">300</span>&gt;c.status?(c=<span class="keyword">this</span>.parseResponse(c,b.readOptions))&amp;&amp;!<span class="number">1</span>!==c.success?(b.readOptions&amp;&amp;<span class="string">"object"</span>==b.readOptions.output?OpenLayers.Util.extend(a,c):a.features=c,a.code=OpenLayers.Protocol.Response.SUCCESS):(a.code=OpenLayers.Protocol.Response.FAILURE,a.error=c):a.code=OpenLayers.Protocol.Response.FAILURE;b.callback.call(b.scope,a)&#125;&#125;,<span class="attr">parseResponse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.responseXML;c&amp;&amp;c.documentElement||(c=a.responseText);<span class="keyword">if</span>(!c||<span class="number">0</span>&gt;=c.length)<span class="keyword">return</span> <span class="literal">null</span>;c=<span class="literal">null</span>!==<span class="keyword">this</span>.readFormat?<span class="keyword">this</span>.readFormat.read(c):</span><br><span class="line"><span class="keyword">this</span>.format.read(c,b);<span class="keyword">if</span>(!<span class="keyword">this</span>.featureNS)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.readFormat||<span class="keyword">this</span>.format;<span class="keyword">this</span>.featureNS=d.featureNS;d.autoConfig=!<span class="number">1</span>;<span class="keyword">this</span>.geometryName||<span class="keyword">this</span>.setGeometryName(d.geometryName)&#125;<span class="keyword">return</span> c&#125;,<span class="attr">commit</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=OpenLayers.Util.extend(&#123;&#125;,b);OpenLayers.Util.applyDefaults(b,<span class="keyword">this</span>.options);<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Protocol.Response(&#123;<span class="attr">requestType</span>:<span class="string">"commit"</span>,<span class="attr">reqFeatures</span>:a&#125;);c.priv=OpenLayers.Request.POST(&#123;<span class="attr">url</span>:b.url,<span class="attr">headers</span>:b.headers,<span class="attr">data</span>:<span class="keyword">this</span>.format.write(a,b),<span class="attr">callback</span>:<span class="keyword">this</span>.createCallback(<span class="keyword">this</span>.handleCommit,c,b)&#125;);</span><br><span class="line"><span class="keyword">return</span> c&#125;,<span class="attr">handleCommit</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(b.callback)&#123;<span class="keyword">var</span> c=a.priv,d=c.responseXML;d&amp;&amp;d.documentElement||(d=c.responseText);c=<span class="keyword">this</span>.format.read(d)||&#123;&#125;;a.insertIds=c.insertIds||[];c.success?a.code=OpenLayers.Protocol.Response.SUCCESS:(a.code=OpenLayers.Protocol.Response.FAILURE,a.error=c);b.callback.call(b.scope,a)&#125;&#125;,<span class="attr">filterDelete</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=OpenLayers.Util.extend(&#123;&#125;,b);OpenLayers.Util.applyDefaults(b,<span class="keyword">this</span>.options);<span class="keyword">new</span> OpenLayers.Protocol.Response(&#123;<span class="attr">requestType</span>:<span class="string">"commit"</span>&#125;);<span class="keyword">var</span> c=<span class="keyword">this</span>.format.createElementNSPlus(<span class="string">"wfs:Transaction"</span>,</span><br><span class="line">&#123;<span class="attr">attributes</span>:&#123;<span class="attr">service</span>:<span class="string">"WFS"</span>,<span class="attr">version</span>:<span class="keyword">this</span>.version&#125;&#125;),d=<span class="keyword">this</span>.format.createElementNSPlus(<span class="string">"wfs:Delete"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">typeName</span>:(b.featureNS?<span class="keyword">this</span>.featurePrefix+<span class="string">":"</span>:<span class="string">""</span>)+b.featureType&#125;&#125;);b.featureNS&amp;&amp;d.setAttribute(<span class="string">"xmlns:"</span>+<span class="keyword">this</span>.featurePrefix,b.featureNS);<span class="keyword">var</span> e=<span class="keyword">this</span>.format.writeNode(<span class="string">"ogc:Filter"</span>,a);d.appendChild(e);c.appendChild(d);c=OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>.format,[c]);<span class="keyword">return</span> OpenLayers.Request.POST(&#123;<span class="attr">url</span>:<span class="keyword">this</span>.url,<span class="attr">callback</span>:b.callback||<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">data</span>:c&#125;)&#125;,<span class="attr">abort</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a&amp;&amp;a.priv.abort()&#125;,</span><br><span class="line">CLASS_NAME:<span class="string">"OpenLayers.Protocol.WFS.v1"</span>&#125;);OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,&#123;<span class="attr">EVENTMAP</span>:&#123;<span class="attr">click</span>:&#123;<span class="string">"in"</span>:<span class="string">"click"</span>,<span class="attr">out</span>:<span class="string">"clickout"</span>&#125;,<span class="attr">mousemove</span>:&#123;<span class="string">"in"</span>:<span class="string">"over"</span>,<span class="attr">out</span>:<span class="string">"out"</span>&#125;,<span class="attr">dblclick</span>:&#123;<span class="string">"in"</span>:<span class="string">"dblclick"</span>,<span class="attr">out</span>:<span class="literal">null</span>&#125;,<span class="attr">mousedown</span>:&#123;<span class="string">"in"</span>:<span class="literal">null</span>,<span class="attr">out</span>:<span class="literal">null</span>&#125;,<span class="attr">mouseup</span>:&#123;<span class="string">"in"</span>:<span class="literal">null</span>,<span class="attr">out</span>:<span class="literal">null</span>&#125;,<span class="attr">touchstart</span>:&#123;<span class="string">"in"</span>:<span class="string">"click"</span>,<span class="attr">out</span>:<span class="string">"clickout"</span>&#125;&#125;,<span class="attr">feature</span>:<span class="literal">null</span>,<span class="attr">lastFeature</span>:<span class="literal">null</span>,<span class="attr">down</span>:<span class="literal">null</span>,<span class="attr">up</span>:<span class="literal">null</span>,<span class="attr">clickTolerance</span>:<span class="number">4</span>,<span class="attr">geometryTypes</span>:<span class="literal">null</span>,<span class="attr">stopClick</span>:!<span class="number">0</span>,<span class="attr">stopDown</span>:!<span class="number">0</span>,<span class="attr">stopUp</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;OpenLayers.Handler.prototype.initialize.apply(<span class="keyword">this</span>,[a,c,d]);<span class="keyword">this</span>.layer=</span><br><span class="line">b&#125;,<span class="attr">touchstart</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.startTouch();<span class="keyword">return</span> OpenLayers.Event.isMultiTouch(a)?!<span class="number">0</span>:<span class="keyword">this</span>.mousedown(a)&#125;,<span class="attr">touchmove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Event.preventDefault(a)&#125;,<span class="attr">mousedown</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))<span class="keyword">this</span>.down=a.xy;<span class="keyword">return</span> <span class="keyword">this</span>.handle(a)?!<span class="keyword">this</span>.stopDown:!<span class="number">0</span>&#125;,<span class="attr">mouseup</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.up=a.xy;<span class="keyword">return</span> <span class="keyword">this</span>.handle(a)?!<span class="keyword">this</span>.stopUp:!<span class="number">0</span>&#125;,<span class="attr">click</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.handle(a)?!<span class="keyword">this</span>.stopClick:!<span class="number">0</span>&#125;,<span class="attr">mousemove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.callbacks.over&amp;&amp;!<span class="keyword">this</span>.callbacks.out)<span class="keyword">return</span>!<span class="number">0</span>;</span><br><span class="line"><span class="keyword">this</span>.handle(a);<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">dblclick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span>!<span class="keyword">this</span>.handle(a)&#125;,<span class="attr">geometryTypeMatches</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="literal">null</span>==<span class="keyword">this</span>.geometryTypes||<span class="number">-1</span>&lt;OpenLayers.Util.indexOf(<span class="keyword">this</span>.geometryTypes,a.geometry.CLASS_NAME)&#125;,<span class="attr">handle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.feature&amp;&amp;!<span class="keyword">this</span>.feature.layer&amp;&amp;(<span class="keyword">this</span>.feature=<span class="literal">null</span>);<span class="keyword">var</span> b=a.type,c=!<span class="number">1</span>,d=!!<span class="keyword">this</span>.feature,e=<span class="string">"click"</span>==b||<span class="string">"dblclick"</span>==b||<span class="string">"touchstart"</span>==b;(<span class="keyword">this</span>.feature=<span class="keyword">this</span>.layer.getFeatureFromEvent(a))&amp;&amp;!<span class="keyword">this</span>.feature.layer&amp;&amp;(<span class="keyword">this</span>.feature=<span class="literal">null</span>);<span class="keyword">this</span>.lastFeature&amp;&amp;!<span class="keyword">this</span>.lastFeature.layer&amp;&amp;(<span class="keyword">this</span>.lastFeature=</span><br><span class="line"><span class="literal">null</span>);<span class="keyword">this</span>.feature?(<span class="string">"touchstart"</span>===b&amp;&amp;OpenLayers.Event.preventDefault(a),a=<span class="keyword">this</span>.feature!=<span class="keyword">this</span>.lastFeature,<span class="keyword">this</span>.geometryTypeMatches(<span class="keyword">this</span>.feature)?(d&amp;&amp;a?(<span class="keyword">this</span>.lastFeature&amp;&amp;<span class="keyword">this</span>.triggerCallback(b,<span class="string">"out"</span>,[<span class="keyword">this</span>.lastFeature]),<span class="keyword">this</span>.triggerCallback(b,<span class="string">"in"</span>,[<span class="keyword">this</span>.feature])):d&amp;&amp;!e||<span class="keyword">this</span>.triggerCallback(b,<span class="string">"in"</span>,[<span class="keyword">this</span>.feature]),<span class="keyword">this</span>.lastFeature=<span class="keyword">this</span>.feature,c=!<span class="number">0</span>):(<span class="keyword">this</span>.lastFeature&amp;&amp;(d&amp;&amp;a||e)&amp;&amp;<span class="keyword">this</span>.triggerCallback(b,<span class="string">"out"</span>,[<span class="keyword">this</span>.lastFeature]),<span class="keyword">this</span>.feature=<span class="literal">null</span>)):<span class="keyword">this</span>.lastFeature&amp;&amp;(d||e)&amp;&amp;<span class="keyword">this</span>.triggerCallback(b,<span class="string">"out"</span>,</span><br><span class="line">[<span class="keyword">this</span>.lastFeature]);<span class="keyword">return</span> c&#125;,<span class="attr">triggerCallback</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">if</span>(b=<span class="keyword">this</span>.EVENTMAP[a][b])<span class="string">"click"</span>==a&amp;&amp;<span class="keyword">this</span>.up&amp;&amp;<span class="keyword">this</span>.down?(<span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(<span class="keyword">this</span>.up.x-<span class="keyword">this</span>.down.x,<span class="number">2</span>)+<span class="built_in">Math</span>.pow(<span class="keyword">this</span>.up.y-<span class="keyword">this</span>.down.y,<span class="number">2</span>))&lt;=<span class="keyword">this</span>.clickTolerance&amp;&amp;<span class="keyword">this</span>.callback(b,c),<span class="keyword">this</span>.up=<span class="keyword">this</span>.down=<span class="literal">null</span>):<span class="keyword">this</span>.callback(b,c)&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;OpenLayers.Handler.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&amp;&amp;(<span class="keyword">this</span>.moveLayerToTop(),<span class="keyword">this</span>.map.events.on(&#123;<span class="attr">removelayer</span>:<span class="keyword">this</span>.handleMapEvents,<span class="attr">changelayer</span>:<span class="keyword">this</span>.handleMapEvents,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;),a=!<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;OpenLayers.Handler.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&amp;&amp;(<span class="keyword">this</span>.moveLayerBack(),<span class="keyword">this</span>.up=<span class="keyword">this</span>.down=<span class="keyword">this</span>.lastFeature=<span class="keyword">this</span>.feature=<span class="literal">null</span>,<span class="keyword">this</span>.map.events.un(&#123;<span class="attr">removelayer</span>:<span class="keyword">this</span>.handleMapEvents,<span class="attr">changelayer</span>:<span class="keyword">this</span>.handleMapEvents,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;),a=!<span class="number">0</span>);<span class="keyword">return</span> a&#125;,<span class="attr">handleMapEvents</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"removelayer"</span>!=a.type&amp;&amp;<span class="string">"order"</span>!=a.property||<span class="keyword">this</span>.moveLayerToTop()&#125;,<span class="attr">moveLayerToTop</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="built_in">Math</span>.max(<span class="keyword">this</span>.map.Z_INDEX_BASE.Feature<span class="number">-1</span>,<span class="keyword">this</span>.layer.getZIndex())+<span class="number">1</span>;<span class="keyword">this</span>.layer.setZIndex(a)&#125;,</span><br><span class="line">moveLayerBack:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.layer.getZIndex()<span class="number">-1</span>;a&gt;=<span class="keyword">this</span>.map.Z_INDEX_BASE.Feature?<span class="keyword">this</span>.layer.setZIndex(a):<span class="keyword">this</span>.map.setLayerZIndex(<span class="keyword">this</span>.layer,<span class="keyword">this</span>.map.getLayerIndex(<span class="keyword">this</span>.layer))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Handler.Feature"</span>&#125;);OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,&#123;<span class="attr">displayInLayerSwitcher</span>:!<span class="number">1</span>,<span class="attr">layers</span>:<span class="literal">null</span>,<span class="attr">display</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">getFeatureFromEvent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.layers,c,d=<span class="number">0</span>;d&lt;b.length;d++)<span class="keyword">if</span>(c=b[d].getFeatureFromEvent(a))<span class="keyword">return</span> c&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Layer.Vector.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.collectRoots();a.events.register(<span class="string">"changelayer"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.handleChangeLayer)&#125;,<span class="attr">removeMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.events.unregister(<span class="string">"changelayer"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.handleChangeLayer);</span><br><span class="line"><span class="keyword">this</span>.resetRoots();OpenLayers.Layer.Vector.prototype.removeMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">collectRoots</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a,b=<span class="number">0</span>;b&lt;<span class="keyword">this</span>.map.layers.length;++b)a=<span class="keyword">this</span>.map.layers[b],<span class="number">-1</span>!=OpenLayers.Util.indexOf(<span class="keyword">this</span>.layers,a)&amp;&amp;a.renderer.moveRoot(<span class="keyword">this</span>.renderer)&#125;,<span class="attr">resetRoots</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a,b=<span class="number">0</span>;b&lt;<span class="keyword">this</span>.layers.length;++b)a=<span class="keyword">this</span>.layers[b],<span class="keyword">this</span>.renderer&amp;&amp;a.renderer.getRenderLayerId()==<span class="keyword">this</span>.id&amp;&amp;<span class="keyword">this</span>.renderer.moveRoot(a.renderer)&#125;,<span class="attr">handleChangeLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.layer;<span class="string">"order"</span>==a.property&amp;&amp;<span class="number">-1</span>!=OpenLayers.Util.indexOf(<span class="keyword">this</span>.layers,</span><br><span class="line">b)&amp;&amp;(<span class="keyword">this</span>.resetRoots(),<span class="keyword">this</span>.collectRoots())&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.Vector.RootContainer"</span>&#125;);OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">multipleKey</span>:<span class="literal">null</span>,<span class="attr">toggleKey</span>:<span class="literal">null</span>,<span class="attr">multiple</span>:!<span class="number">1</span>,<span class="attr">clickout</span>:!<span class="number">0</span>,<span class="attr">toggle</span>:!<span class="number">1</span>,<span class="attr">hover</span>:!<span class="number">1</span>,<span class="attr">highlightOnly</span>:!<span class="number">1</span>,<span class="attr">box</span>:!<span class="number">1</span>,<span class="attr">onBeforeSelect</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">onSelect</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">onUnselect</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">scope</span>:<span class="literal">null</span>,<span class="attr">geometryTypes</span>:<span class="literal">null</span>,<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">layers</span>:<span class="literal">null</span>,<span class="attr">callbacks</span>:<span class="literal">null</span>,<span class="attr">selectStyle</span>:<span class="literal">null</span>,<span class="attr">renderIntent</span>:<span class="string">"select"</span>,<span class="attr">handlers</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[b]);<span class="literal">null</span>===<span class="keyword">this</span>.scope&amp;&amp;(<span class="keyword">this</span>.scope=<span class="keyword">this</span>);<span class="keyword">this</span>.initLayer(a);<span class="keyword">var</span> c=</span><br><span class="line">&#123;<span class="attr">click</span>:<span class="keyword">this</span>.clickFeature,<span class="attr">clickout</span>:<span class="keyword">this</span>.clickoutFeature&#125;;<span class="keyword">this</span>.hover&amp;&amp;(c.over=<span class="keyword">this</span>.overFeature,c.out=<span class="keyword">this</span>.outFeature);<span class="keyword">this</span>.callbacks=OpenLayers.Util.extend(c,<span class="keyword">this</span>.callbacks);<span class="keyword">this</span>.handlers=&#123;<span class="attr">feature</span>:<span class="keyword">new</span> OpenLayers.Handler.Feature(<span class="keyword">this</span>,<span class="keyword">this</span>.layer,<span class="keyword">this</span>.callbacks,&#123;<span class="attr">geometryTypes</span>:<span class="keyword">this</span>.geometryTypes&#125;)&#125;;<span class="keyword">this</span>.box&amp;&amp;(<span class="keyword">this</span>.handlers.box=<span class="keyword">new</span> OpenLayers.Handler.Box(<span class="keyword">this</span>,&#123;<span class="attr">done</span>:<span class="keyword">this</span>.selectBox&#125;,&#123;<span class="attr">boxDivClassName</span>:<span class="string">"olHandlerBoxSelectFeature"</span>&#125;))&#125;,<span class="attr">initLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.isArray(a)?(<span class="keyword">this</span>.layers=a,<span class="keyword">this</span>.layer=</span><br><span class="line"><span class="keyword">new</span> OpenLayers.Layer.Vector.RootContainer(<span class="keyword">this</span>.id+<span class="string">"_container"</span>,&#123;<span class="attr">layers</span>:a&#125;)):<span class="keyword">this</span>.layer=a&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.active&amp;&amp;<span class="keyword">this</span>.layers&amp;&amp;<span class="keyword">this</span>.map.removeLayer(<span class="keyword">this</span>.layer);OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.layers&amp;&amp;<span class="keyword">this</span>.layer.destroy()&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.active||(<span class="keyword">this</span>.layers&amp;&amp;<span class="keyword">this</span>.map.addLayer(<span class="keyword">this</span>.layer),<span class="keyword">this</span>.handlers.feature.activate(),<span class="keyword">this</span>.box&amp;&amp;<span class="keyword">this</span>.handlers.box&amp;&amp;<span class="keyword">this</span>.handlers.box.activate());<span class="keyword">return</span> OpenLayers.Control.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.active&amp;&amp;</span><br><span class="line">(<span class="keyword">this</span>.handlers.feature.deactivate(),<span class="keyword">this</span>.handlers.box&amp;&amp;<span class="keyword">this</span>.handlers.box.deactivate(),<span class="keyword">this</span>.layers&amp;&amp;<span class="keyword">this</span>.map.removeLayer(<span class="keyword">this</span>.layer));<span class="keyword">return</span> OpenLayers.Control.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">unselectAll</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.layers||[<span class="keyword">this</span>.layer],c,d,e,f;<span class="keyword">for</span>(e=<span class="number">0</span>;e&lt;b.length;++e)<span class="keyword">if</span>(c=b[e],f=<span class="number">0</span>,<span class="literal">null</span>!=c.selectedFeatures)<span class="keyword">for</span>(;c.selectedFeatures.length&gt;f;)d=c.selectedFeatures[f],a&amp;&amp;a.except==d?++f:<span class="keyword">this</span>.unselect(d)&#125;,<span class="attr">clickFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.hover||(<span class="number">-1</span>&lt;OpenLayers.Util.indexOf(a.layer.selectedFeatures,</span><br><span class="line">a)?<span class="keyword">this</span>.toggleSelect()?<span class="keyword">this</span>.unselect(a):<span class="keyword">this</span>.multipleSelect()||<span class="keyword">this</span>.unselectAll(&#123;<span class="attr">except</span>:a&#125;):(<span class="keyword">this</span>.multipleSelect()||<span class="keyword">this</span>.unselectAll(&#123;<span class="attr">except</span>:a&#125;),<span class="keyword">this</span>.select(a)))&#125;,<span class="attr">multipleSelect</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.multiple||<span class="keyword">this</span>.handlers.feature.evt&amp;&amp;<span class="keyword">this</span>.handlers.feature.evt[<span class="keyword">this</span>.multipleKey]&#125;,<span class="attr">toggleSelect</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.toggle||<span class="keyword">this</span>.handlers.feature.evt&amp;&amp;<span class="keyword">this</span>.handlers.feature.evt[<span class="keyword">this</span>.toggleKey]&#125;,<span class="attr">clickoutFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;!<span class="keyword">this</span>.hover&amp;&amp;<span class="keyword">this</span>.clickout&amp;&amp;<span class="keyword">this</span>.unselectAll()&#125;,<span class="attr">overFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line">a.layer;<span class="keyword">this</span>.hover&amp;&amp;(<span class="keyword">this</span>.highlightOnly?<span class="keyword">this</span>.highlight(a):<span class="number">-1</span>==OpenLayers.Util.indexOf(b.selectedFeatures,a)&amp;&amp;<span class="keyword">this</span>.select(a))&#125;,<span class="attr">outFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.hover)<span class="keyword">if</span>(<span class="keyword">this</span>.highlightOnly)&#123;<span class="keyword">if</span>(a._lastHighlighter==<span class="keyword">this</span>.id)<span class="keyword">if</span>(a._prevHighlighter&amp;&amp;a._prevHighlighter!=<span class="keyword">this</span>.id)&#123;<span class="keyword">delete</span> a._lastHighlighter;<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getControl(a._prevHighlighter);b&amp;&amp;b.highlight(a)&#125;<span class="keyword">else</span> <span class="keyword">this</span>.unhighlight(a)&#125;<span class="keyword">else</span> <span class="keyword">this</span>.unselect(a)&#125;,<span class="attr">highlight</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.layer;!<span class="number">1</span>!==<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforefeaturehighlighted"</span>,&#123;<span class="attr">feature</span>:a&#125;)&amp;&amp;</span><br><span class="line">(a._prevHighlighter=a._lastHighlighter,a._lastHighlighter=<span class="keyword">this</span>.id,b.drawFeature(a,<span class="keyword">this</span>.selectStyle||<span class="keyword">this</span>.renderIntent),<span class="keyword">this</span>.events.triggerEvent(<span class="string">"featurehighlighted"</span>,&#123;<span class="attr">feature</span>:a&#125;))&#125;,<span class="attr">unhighlight</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.layer;<span class="keyword">void</span> <span class="number">0</span>==a._prevHighlighter?<span class="keyword">delete</span> a._lastHighlighter:(a._prevHighlighter!=<span class="keyword">this</span>.id&amp;&amp;(a._lastHighlighter=a._prevHighlighter),<span class="keyword">delete</span> a._prevHighlighter);b.drawFeature(a,a.style||a.layer.style||<span class="string">"default"</span>);<span class="keyword">this</span>.events.triggerEvent(<span class="string">"featureunhighlighted"</span>,&#123;<span class="attr">feature</span>:a&#125;)&#125;,<span class="attr">select</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.onBeforeSelect.call(<span class="keyword">this</span>.scope,a),c=a.layer;!<span class="number">1</span>!==b&amp;&amp;(b=c.events.triggerEvent(<span class="string">"beforefeatureselected"</span>,&#123;<span class="attr">feature</span>:a&#125;),!<span class="number">1</span>!==b&amp;&amp;(c.selectedFeatures.push(a),<span class="keyword">this</span>.highlight(a),<span class="keyword">this</span>.handlers.feature.lastFeature||(<span class="keyword">this</span>.handlers.feature.lastFeature=c.selectedFeatures[<span class="number">0</span>]),c.events.triggerEvent(<span class="string">"featureselected"</span>,&#123;<span class="attr">feature</span>:a&#125;),<span class="keyword">this</span>.onSelect.call(<span class="keyword">this</span>.scope,a)))&#125;,<span class="attr">unselect</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.layer;<span class="keyword">this</span>.unhighlight(a);OpenLayers.Util.removeItem(b.selectedFeatures,a);b.events.triggerEvent(<span class="string">"featureunselected"</span>,</span><br><span class="line">&#123;<span class="attr">feature</span>:a&#125;);<span class="keyword">this</span>.onUnselect.call(<span class="keyword">this</span>.scope,a)&#125;,<span class="attr">selectBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a <span class="keyword">instanceof</span> OpenLayers.Bounds)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getLonLatFromPixel(&#123;<span class="attr">x</span>:a.left,<span class="attr">y</span>:a.bottom&#125;);a=<span class="keyword">this</span>.map.getLonLatFromPixel(&#123;<span class="attr">x</span>:a.right,<span class="attr">y</span>:a.top&#125;);b=<span class="keyword">new</span> OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat);<span class="keyword">this</span>.multipleSelect()||<span class="keyword">this</span>.unselectAll();a=<span class="keyword">this</span>.multiple;<span class="keyword">this</span>.multiple=!<span class="number">0</span>;<span class="keyword">var</span> c=<span class="keyword">this</span>.layers||[<span class="keyword">this</span>.layer];<span class="keyword">this</span>.events.triggerEvent(<span class="string">"boxselectionstart"</span>,&#123;<span class="attr">layers</span>:c&#125;);<span class="keyword">for</span>(<span class="keyword">var</span> d,e=<span class="number">0</span>;e&lt;c.length;++e)&#123;d=c[e];<span class="keyword">for</span>(<span class="keyword">var</span> f=<span class="number">0</span>,g=d.features.length;f&lt;g;++f)&#123;<span class="keyword">var</span> h=</span><br><span class="line">d.features[f];h.getVisibility()&amp;&amp;(<span class="literal">null</span>==<span class="keyword">this</span>.geometryTypes||<span class="number">-1</span>&lt;OpenLayers.Util.indexOf(<span class="keyword">this</span>.geometryTypes,h.geometry.CLASS_NAME))&amp;&amp;b.toGeometry().intersects(h.geometry)&amp;&amp;<span class="number">-1</span>==OpenLayers.Util.indexOf(d.selectedFeatures,h)&amp;&amp;<span class="keyword">this</span>.select(h)&#125;&#125;<span class="keyword">this</span>.multiple=a;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"boxselectionend"</span>,&#123;<span class="attr">layers</span>:c&#125;)&#125;&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.handlers.feature.setMap(a);<span class="keyword">this</span>.box&amp;&amp;<span class="keyword">this</span>.handlers.box.setMap(a);OpenLayers.Control.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">setLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.active;<span class="keyword">this</span>.unselectAll();</span><br><span class="line"><span class="keyword">this</span>.deactivate();<span class="keyword">this</span>.layers&amp;&amp;(<span class="keyword">this</span>.layer.destroy(),<span class="keyword">this</span>.layers=<span class="literal">null</span>);<span class="keyword">this</span>.initLayer(a);<span class="keyword">this</span>.handlers.feature.layer=<span class="keyword">this</span>.layer;b&amp;&amp;<span class="keyword">this</span>.activate()&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.SelectFeature"</span>&#125;);OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,&#123;<span class="attr">point</span>:<span class="literal">null</span>,<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">multi</span>:!<span class="number">1</span>,<span class="attr">citeCompliant</span>:!<span class="number">1</span>,<span class="attr">mouseDown</span>:!<span class="number">1</span>,<span class="attr">stoppedDown</span>:<span class="literal">null</span>,<span class="attr">lastDown</span>:<span class="literal">null</span>,<span class="attr">lastUp</span>:<span class="literal">null</span>,<span class="attr">persist</span>:!<span class="number">1</span>,<span class="attr">stopDown</span>:!<span class="number">1</span>,<span class="attr">stopUp</span>:!<span class="number">1</span>,<span class="attr">layerOptions</span>:<span class="literal">null</span>,<span class="attr">pixelTolerance</span>:<span class="number">5</span>,<span class="attr">lastTouchPx</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;c&amp;&amp;c.layerOptions&amp;&amp;c.layerOptions.styleMap||(<span class="keyword">this</span>.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style[<span class="string">"default"</span>],&#123;&#125;));OpenLayers.Handler.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!OpenLayers.Handler.prototype.activate.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>))<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">var</span> a=OpenLayers.Util.extend(&#123;<span class="attr">displayInLayerSwitcher</span>:!<span class="number">1</span>,<span class="attr">calculateInRange</span>:OpenLayers.Function.True,<span class="attr">wrapDateLine</span>:<span class="keyword">this</span>.citeCompliant&#125;,<span class="keyword">this</span>.layerOptions);<span class="keyword">this</span>.layer=<span class="keyword">new</span> OpenLayers.Layer.Vector(<span class="keyword">this</span>.CLASS_NAME,a);<span class="keyword">this</span>.map.addLayer(<span class="keyword">this</span>.layer);<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">createFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.layer.getLonLatFromViewPortPx(a);a=<span class="keyword">new</span> OpenLayers.Geometry.Point(a.lon,a.lat);<span class="keyword">this</span>.point=<span class="keyword">new</span> OpenLayers.Feature.Vector(a);<span class="keyword">this</span>.callback(<span class="string">"create"</span>,[<span class="keyword">this</span>.point.geometry,<span class="keyword">this</span>.point]);<span class="keyword">this</span>.point.geometry.clearBounds();</span><br><span class="line"><span class="keyword">this</span>.layer.addFeatures([<span class="keyword">this</span>.point],&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;)&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!OpenLayers.Handler.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>))<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">this</span>.cancel();<span class="literal">null</span>!=<span class="keyword">this</span>.layer.map&amp;&amp;(<span class="keyword">this</span>.destroyFeature(!<span class="number">0</span>),<span class="keyword">this</span>.layer.destroy(!<span class="number">1</span>));<span class="keyword">this</span>.layer=<span class="literal">null</span>;<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">destroyFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;!<span class="keyword">this</span>.layer||!a&amp;&amp;<span class="keyword">this</span>.persist||<span class="keyword">this</span>.layer.destroyFeatures();<span class="keyword">this</span>.point=<span class="literal">null</span>&#125;,<span class="attr">destroyPersistedFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.layer;a&amp;&amp;<span class="number">1</span>&lt;a.features.length&amp;&amp;<span class="keyword">this</span>.layer.features[<span class="number">0</span>].destroy()&#125;,<span class="attr">finalize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.mouseDown=</span><br><span class="line">!<span class="number">1</span>;<span class="keyword">this</span>.lastTouchPx=<span class="keyword">this</span>.lastUp=<span class="keyword">this</span>.lastDown=<span class="literal">null</span>;<span class="keyword">this</span>.callback(a?<span class="string">"cancel"</span>:<span class="string">"done"</span>,[<span class="keyword">this</span>.geometryClone()]);<span class="keyword">this</span>.destroyFeature(a)&#125;,<span class="attr">cancel</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.finalize(!<span class="number">0</span>)&#125;,<span class="attr">click</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Event.stop(a);<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">dblclick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Event.stop(a);<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">modifyFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.point||<span class="keyword">this</span>.createFeature(a);a=<span class="keyword">this</span>.layer.getLonLatFromViewPortPx(a);<span class="keyword">this</span>.point.geometry.x=a.lon;<span class="keyword">this</span>.point.geometry.y=a.lat;<span class="keyword">this</span>.callback(<span class="string">"modify"</span>,[<span class="keyword">this</span>.point.geometry,<span class="keyword">this</span>.point,!<span class="number">1</span>]);<span class="keyword">this</span>.point.geometry.clearBounds();</span><br><span class="line"><span class="keyword">this</span>.drawFeature()&#125;,<span class="attr">drawFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.layer.drawFeature(<span class="keyword">this</span>.point,<span class="keyword">this</span>.style)&#125;,<span class="attr">getGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.point&amp;&amp;<span class="keyword">this</span>.point.geometry;a&amp;&amp;<span class="keyword">this</span>.multi&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Geometry.MultiPoint([a]));<span class="keyword">return</span> a&#125;,<span class="attr">geometryClone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.getGeometry();<span class="keyword">return</span> a&amp;&amp;a.clone()&#125;,<span class="attr">mousedown</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.down(a)&#125;,<span class="attr">touchstart</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.startTouch();<span class="keyword">this</span>.lastTouchPx=a.xy;<span class="keyword">return</span> <span class="keyword">this</span>.down(a)&#125;,<span class="attr">mousemove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.move(a)&#125;,<span class="attr">touchmove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.lastTouchPx=a.xy;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.move(a)&#125;,<span class="attr">mouseup</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.up(a)&#125;,<span class="attr">touchend</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.xy=<span class="keyword">this</span>.lastTouchPx;<span class="keyword">return</span> <span class="keyword">this</span>.up(a)&#125;,<span class="attr">down</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.mouseDown=!<span class="number">0</span>;<span class="keyword">this</span>.lastDown=a.xy;<span class="keyword">this</span>.touch||<span class="keyword">this</span>.modifyFeature(a.xy);<span class="keyword">this</span>.stoppedDown=<span class="keyword">this</span>.stopDown;<span class="keyword">return</span>!<span class="keyword">this</span>.stopDown&#125;,<span class="attr">move</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.touch||<span class="keyword">this</span>.mouseDown&amp;&amp;!<span class="keyword">this</span>.stoppedDown||<span class="keyword">this</span>.modifyFeature(a.xy);<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">up</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.mouseDown=!<span class="number">1</span>;<span class="keyword">this</span>.stoppedDown=<span class="keyword">this</span>.stopDown;<span class="keyword">if</span>(!<span class="keyword">this</span>.checkModifiers(a)||<span class="keyword">this</span>.lastUp&amp;&amp;<span class="keyword">this</span>.lastUp.equals(a.xy)||!<span class="keyword">this</span>.lastDown||</span><br><span class="line">!<span class="keyword">this</span>.passesTolerance(<span class="keyword">this</span>.lastDown,a.xy,<span class="keyword">this</span>.pixelTolerance))<span class="keyword">return</span>!<span class="number">0</span>;<span class="keyword">this</span>.touch&amp;&amp;<span class="keyword">this</span>.modifyFeature(a.xy);<span class="keyword">this</span>.persist&amp;&amp;<span class="keyword">this</span>.destroyPersistedFeature();<span class="keyword">this</span>.lastUp=a.xy;<span class="keyword">this</span>.finalize();<span class="keyword">return</span>!<span class="keyword">this</span>.stopUp&#125;,<span class="attr">mouseout</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.mouseLeft(a,<span class="keyword">this</span>.map.viewPortDiv)&amp;&amp;(<span class="keyword">this</span>.stoppedDown=<span class="keyword">this</span>.stopDown,<span class="keyword">this</span>.mouseDown=!<span class="number">1</span>)&#125;,<span class="attr">passesTolerance</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=!<span class="number">0</span>;<span class="literal">null</span>!=c&amp;&amp;a&amp;&amp;b&amp;&amp;a.distanceTo(b)&gt;c&amp;&amp;(d=!<span class="number">1</span>);<span class="keyword">return</span> d&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Handler.Point"</span>&#125;);OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,&#123;<span class="attr">line</span>:<span class="literal">null</span>,<span class="attr">maxVertices</span>:<span class="literal">null</span>,<span class="attr">doubleTouchTolerance</span>:<span class="number">20</span>,<span class="attr">freehand</span>:!<span class="number">1</span>,<span class="attr">freehandToggle</span>:<span class="string">"shiftKey"</span>,<span class="attr">timerId</span>:<span class="literal">null</span>,<span class="attr">redoStack</span>:<span class="literal">null</span>,<span class="attr">createFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.layer.getLonLatFromViewPortPx(a);a=<span class="keyword">new</span> OpenLayers.Geometry.Point(a.lon,a.lat);<span class="keyword">this</span>.point=<span class="keyword">new</span> OpenLayers.Feature.Vector(a);<span class="keyword">this</span>.line=<span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.LineString([<span class="keyword">this</span>.point.geometry]));<span class="keyword">this</span>.callback(<span class="string">"create"</span>,[<span class="keyword">this</span>.point.geometry,<span class="keyword">this</span>.getSketch()]);</span><br><span class="line"><span class="keyword">this</span>.point.geometry.clearBounds();<span class="keyword">this</span>.layer.addFeatures([<span class="keyword">this</span>.line,<span class="keyword">this</span>.point],&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;)&#125;,<span class="attr">destroyFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Handler.Point.prototype.destroyFeature.call(<span class="keyword">this</span>,a);<span class="keyword">this</span>.line=<span class="literal">null</span>&#125;,<span class="attr">destroyPersistedFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.layer;a&amp;&amp;<span class="number">2</span>&lt;a.features.length&amp;&amp;<span class="keyword">this</span>.layer.features[<span class="number">0</span>].destroy()&#125;,<span class="attr">removePoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.point&amp;&amp;<span class="keyword">this</span>.layer.removeFeatures([<span class="keyword">this</span>.point])&#125;,<span class="attr">addPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.layer.removeFeatures([<span class="keyword">this</span>.point]);a=<span class="keyword">this</span>.layer.getLonLatFromViewPortPx(a);<span class="keyword">this</span>.point=<span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.Point(a.lon,</span><br><span class="line">a.lat));<span class="keyword">this</span>.line.geometry.addComponent(<span class="keyword">this</span>.point.geometry,<span class="keyword">this</span>.line.geometry.components.length);<span class="keyword">this</span>.layer.addFeatures([<span class="keyword">this</span>.point]);<span class="keyword">this</span>.callback(<span class="string">"point"</span>,[<span class="keyword">this</span>.point.geometry,<span class="keyword">this</span>.getGeometry()]);<span class="keyword">this</span>.callback(<span class="string">"modify"</span>,[<span class="keyword">this</span>.point.geometry,<span class="keyword">this</span>.getSketch()]);<span class="keyword">this</span>.drawFeature();<span class="keyword">delete</span> <span class="keyword">this</span>.redoStack&#125;,<span class="attr">insertXY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.line.geometry.addComponent(<span class="keyword">new</span> OpenLayers.Geometry.Point(a,b),<span class="keyword">this</span>.getCurrentPointIndex());<span class="keyword">this</span>.drawFeature();<span class="keyword">delete</span> <span class="keyword">this</span>.redoStack&#125;,<span class="attr">insertDeltaXY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getCurrentPointIndex()-</span><br><span class="line"><span class="number">1</span>,c=<span class="keyword">this</span>.line.geometry.components[c];!c||(<span class="built_in">isNaN</span>(c.x)||<span class="built_in">isNaN</span>(c.y))||<span class="keyword">this</span>.insertXY(c.x+a,c.y+b)&#125;,<span class="attr">insertDirectionLength</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a*=<span class="built_in">Math</span>.PI/<span class="number">180</span>;<span class="keyword">var</span> c=b*<span class="built_in">Math</span>.cos(a),d=b*<span class="built_in">Math</span>.sin(a);<span class="keyword">this</span>.insertDeltaXY(c,d)&#125;,<span class="attr">insertDeflectionLength</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getCurrentPointIndex()<span class="number">-1</span>;<span class="keyword">if</span>(<span class="number">0</span>&lt;c)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.line.geometry.components[c],c=<span class="keyword">this</span>.line.geometry.components[c<span class="number">-1</span>],d=<span class="built_in">Math</span>.atan2(d.y-c.y,d.x-c.x);<span class="keyword">this</span>.insertDirectionLength(<span class="number">180</span>*d/<span class="built_in">Math</span>.PI+a,b)&#125;&#125;,<span class="attr">getCurrentPointIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.line.geometry.components.length-</span><br><span class="line"><span class="number">1</span>&#125;,<span class="attr">undo</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.line.geometry,b=a.components,c=<span class="keyword">this</span>.getCurrentPointIndex()<span class="number">-1</span>,d=b[c],e=a.removeComponent(d);e&amp;&amp;(<span class="keyword">this</span>.touch&amp;&amp;<span class="number">0</span>&lt;c&amp;&amp;(b=a.components,a=b[c<span class="number">-1</span>],c=<span class="keyword">this</span>.getCurrentPointIndex(),b=b[c],b.x=a.x,b.y=a.y),<span class="keyword">this</span>.redoStack||(<span class="keyword">this</span>.redoStack=[]),<span class="keyword">this</span>.redoStack.push(d),<span class="keyword">this</span>.drawFeature());<span class="keyword">return</span> e&#125;,<span class="attr">redo</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.redoStack&amp;&amp;<span class="keyword">this</span>.redoStack.pop();a&amp;&amp;(<span class="keyword">this</span>.line.geometry.addComponent(a,<span class="keyword">this</span>.getCurrentPointIndex()),<span class="keyword">this</span>.drawFeature());<span class="keyword">return</span>!!a&#125;,<span class="attr">freehandMode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.freehandToggle&amp;&amp;</span><br><span class="line">a[<span class="keyword">this</span>.freehandToggle]?!<span class="keyword">this</span>.freehand:<span class="keyword">this</span>.freehand&#125;,<span class="attr">modifyFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.line||<span class="keyword">this</span>.createFeature(a);<span class="keyword">var</span> c=<span class="keyword">this</span>.layer.getLonLatFromViewPortPx(a);<span class="keyword">this</span>.point.geometry.x=c.lon;<span class="keyword">this</span>.point.geometry.y=c.lat;<span class="keyword">this</span>.callback(<span class="string">"modify"</span>,[<span class="keyword">this</span>.point.geometry,<span class="keyword">this</span>.getSketch(),b]);<span class="keyword">this</span>.point.geometry.clearBounds();<span class="keyword">this</span>.drawFeature()&#125;,<span class="attr">drawFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.layer.drawFeature(<span class="keyword">this</span>.line,<span class="keyword">this</span>.style);<span class="keyword">this</span>.layer.drawFeature(<span class="keyword">this</span>.point,<span class="keyword">this</span>.style)&#125;,<span class="attr">getSketch</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.line&#125;,<span class="attr">getGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=</span><br><span class="line"><span class="keyword">this</span>.line&amp;&amp;<span class="keyword">this</span>.line.geometry;a&amp;&amp;<span class="keyword">this</span>.multi&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Geometry.MultiLineString([a]));<span class="keyword">return</span> a&#125;,<span class="attr">touchstart</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.timerId&amp;&amp;<span class="keyword">this</span>.passesTolerance(<span class="keyword">this</span>.lastTouchPx,a.xy,<span class="keyword">this</span>.doubleTouchTolerance))<span class="keyword">return</span> <span class="keyword">this</span>.finishGeometry(),<span class="built_in">window</span>.clearTimeout(<span class="keyword">this</span>.timerId),<span class="keyword">this</span>.timerId=<span class="literal">null</span>,!<span class="number">1</span>;<span class="keyword">this</span>.timerId&amp;&amp;(<span class="built_in">window</span>.clearTimeout(<span class="keyword">this</span>.timerId),<span class="keyword">this</span>.timerId=<span class="literal">null</span>);<span class="keyword">this</span>.timerId=<span class="built_in">window</span>.setTimeout(OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.timerId=<span class="literal">null</span>&#125;,<span class="keyword">this</span>),<span class="number">300</span>);<span class="keyword">return</span> OpenLayers.Handler.Point.prototype.touchstart.call(<span class="keyword">this</span>,</span><br><span class="line">a)&#125;,<span class="attr">down</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.stopDown;<span class="keyword">this</span>.freehandMode(a)&amp;&amp;(b=!<span class="number">0</span>,<span class="keyword">this</span>.touch&amp;&amp;(<span class="keyword">this</span>.modifyFeature(a.xy,!!<span class="keyword">this</span>.lastUp),OpenLayers.Event.stop(a)));<span class="keyword">this</span>.touch||<span class="keyword">this</span>.lastDown&amp;&amp;<span class="keyword">this</span>.passesTolerance(<span class="keyword">this</span>.lastDown,a.xy,<span class="keyword">this</span>.pixelTolerance)||<span class="keyword">this</span>.modifyFeature(a.xy,!!<span class="keyword">this</span>.lastUp);<span class="keyword">this</span>.mouseDown=!<span class="number">0</span>;<span class="keyword">this</span>.lastDown=a.xy;<span class="keyword">this</span>.stoppedDown=b;<span class="keyword">return</span>!b&#125;,<span class="attr">move</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.stoppedDown&amp;&amp;<span class="keyword">this</span>.freehandMode(a))<span class="keyword">return</span> <span class="keyword">this</span>.persist&amp;&amp;<span class="keyword">this</span>.destroyPersistedFeature(),<span class="keyword">this</span>.maxVertices&amp;&amp;<span class="keyword">this</span>.line&amp;&amp;<span class="keyword">this</span>.line.geometry.components.length===</span><br><span class="line"><span class="keyword">this</span>.maxVertices?(<span class="keyword">this</span>.removePoint(),<span class="keyword">this</span>.finalize()):<span class="keyword">this</span>.addPoint(a.xy),!<span class="number">1</span>;<span class="keyword">this</span>.touch||<span class="keyword">this</span>.mouseDown&amp;&amp;!<span class="keyword">this</span>.stoppedDown||<span class="keyword">this</span>.modifyFeature(a.xy,!!<span class="keyword">this</span>.lastUp);<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">up</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;!<span class="keyword">this</span>.mouseDown||<span class="keyword">this</span>.lastUp&amp;&amp;<span class="keyword">this</span>.lastUp.equals(a.xy)||(<span class="keyword">this</span>.stoppedDown&amp;&amp;<span class="keyword">this</span>.freehandMode(a)?(<span class="keyword">this</span>.persist&amp;&amp;<span class="keyword">this</span>.destroyPersistedFeature(),<span class="keyword">this</span>.removePoint(),<span class="keyword">this</span>.finalize()):<span class="keyword">this</span>.passesTolerance(<span class="keyword">this</span>.lastDown,a.xy,<span class="keyword">this</span>.pixelTolerance)&amp;&amp;(<span class="keyword">this</span>.touch&amp;&amp;<span class="keyword">this</span>.modifyFeature(a.xy),<span class="literal">null</span>==<span class="keyword">this</span>.lastUp&amp;&amp;<span class="keyword">this</span>.persist&amp;&amp;<span class="keyword">this</span>.destroyPersistedFeature(),</span><br><span class="line"><span class="keyword">this</span>.addPoint(a.xy),<span class="keyword">this</span>.lastUp=a.xy,<span class="keyword">this</span>.line.geometry.components.length===<span class="keyword">this</span>.maxVertices+<span class="number">1</span>&amp;&amp;<span class="keyword">this</span>.finishGeometry()));<span class="keyword">this</span>.stoppedDown=<span class="keyword">this</span>.stopDown;<span class="keyword">this</span>.mouseDown=!<span class="number">1</span>;<span class="keyword">return</span>!<span class="keyword">this</span>.stopUp&#125;,<span class="attr">finishGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.line.geometry.removeComponent(<span class="keyword">this</span>.line.geometry.components[<span class="keyword">this</span>.line.geometry.components.length<span class="number">-1</span>]);<span class="keyword">this</span>.removePoint();<span class="keyword">this</span>.finalize()&#125;,<span class="attr">dblclick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.freehandMode(a)||<span class="keyword">this</span>.finishGeometry();<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Handler.Path"</span>&#125;);OpenLayers.Spherical=OpenLayers.Spherical||&#123;&#125;;OpenLayers.Spherical.DEFAULT_RADIUS=<span class="number">6378137</span>;OpenLayers.Spherical.computeDistanceBetween=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;c=c||OpenLayers.Spherical.DEFAULT_RADIUS;<span class="keyword">var</span> d=<span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI*(b.lon-a.lon)/<span class="number">360</span>),e=<span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI*(b.lat-a.lat)/<span class="number">360</span>);a=e*e+d*d*<span class="built_in">Math</span>.cos(<span class="built_in">Math</span>.PI*a.lat/<span class="number">180</span>)*<span class="built_in">Math</span>.cos(<span class="built_in">Math</span>.PI*b.lat/<span class="number">180</span>);<span class="keyword">return</span> <span class="number">2</span>*c*<span class="built_in">Math</span>.atan2(<span class="built_in">Math</span>.sqrt(a),<span class="built_in">Math</span>.sqrt(<span class="number">1</span>-a))&#125;;</span><br><span class="line">OpenLayers.Spherical.computeHeading=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI*(a.lon-b.lon)/<span class="number">180</span>)*<span class="built_in">Math</span>.cos(<span class="built_in">Math</span>.PI*b.lat/<span class="number">180</span>),d=<span class="built_in">Math</span>.cos(<span class="built_in">Math</span>.PI*a.lat/<span class="number">180</span>)*<span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI*b.lat/<span class="number">180</span>)-<span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI*a.lat/<span class="number">180</span>)*<span class="built_in">Math</span>.cos(<span class="built_in">Math</span>.PI*b.lat/<span class="number">180</span>)*<span class="built_in">Math</span>.cos(<span class="built_in">Math</span>.PI*(a.lon-b.lon)/<span class="number">180</span>);<span class="keyword">return</span> <span class="number">180</span>*<span class="built_in">Math</span>.atan2(c,d)/<span class="built_in">Math</span>.PI&#125;;OpenLayers.Control.CacheWrite=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">layers</span>:<span class="literal">null</span>,<span class="attr">imageFormat</span>:<span class="string">"image/png"</span>,<span class="attr">quotaRegEx</span>:<span class="regexp">/quota/i</span>,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">var</span> b,c=<span class="keyword">this</span>.layers||a.layers;<span class="keyword">for</span>(b=c.length<span class="number">-1</span>;<span class="number">0</span>&lt;=b;--b)<span class="keyword">this</span>.addLayer(&#123;<span class="attr">layer</span>:c[b]&#125;);<span class="keyword">if</span>(!<span class="keyword">this</span>.layers)a.events.on(&#123;<span class="attr">addlayer</span>:<span class="keyword">this</span>.addLayer,<span class="attr">removeLayer</span>:<span class="keyword">this</span>.removeLayer,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">addLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.layer.events.on(&#123;<span class="attr">tileloadstart</span>:<span class="keyword">this</span>.makeSameOrigin,<span class="attr">tileloaded</span>:<span class="keyword">this</span>.onTileLoaded,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">removeLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.layer.events.un(&#123;<span class="attr">tileloadstart</span>:<span class="keyword">this</span>.makeSameOrigin,</span><br><span class="line">tileloaded:<span class="keyword">this</span>.onTileLoaded,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">makeSameOrigin</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.active&amp;&amp;(a=a.tile,a <span class="keyword">instanceof</span> OpenLayers.Tile.Image&amp;&amp;!a.crossOriginKeyword&amp;&amp;<span class="string">"data:"</span>!==a.url.substr(<span class="number">0</span>,<span class="number">5</span>)))&#123;<span class="keyword">var</span> b=OpenLayers.Request.makeSameOrigin(a.url,OpenLayers.ProxyHost);OpenLayers.Control.CacheWrite.urlMap[b]=a.url;a.url=b&#125;&#125;,<span class="attr">onTileLoaded</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.active&amp;&amp;(!a.aborted&amp;&amp;a.tile <span class="keyword">instanceof</span> OpenLayers.Tile.Image&amp;&amp;<span class="string">"data:"</span>!==a.tile.url.substr(<span class="number">0</span>,<span class="number">5</span>))&amp;&amp;(<span class="keyword">this</span>.cache(&#123;<span class="attr">tile</span>:a.tile&#125;),<span class="keyword">delete</span> OpenLayers.Control.CacheWrite.urlMap[a.tile.url])&#125;,</span><br><span class="line">cache:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="built_in">window</span>.localStorage)&#123;a=a.tile;<span class="keyword">try</span>&#123;<span class="keyword">var</span> b=a.getCanvasContext();b&amp;&amp;<span class="built_in">window</span>.localStorage.setItem(<span class="string">"olCache_"</span>+(OpenLayers.Control.CacheWrite.urlMap[a.url]||a.url),b.canvas.toDataURL(<span class="keyword">this</span>.imageFormat))&#125;<span class="keyword">catch</span>(c)&#123;(b=c.name||c.message)&amp;&amp;<span class="keyword">this</span>.quotaRegEx.test(b)?<span class="keyword">this</span>.events.triggerEvent(<span class="string">"cachefull"</span>,&#123;<span class="attr">tile</span>:a&#125;):OpenLayers.Console.error(c.toString())&#125;&#125;&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.layers||<span class="keyword">this</span>.map)&#123;<span class="keyword">var</span> a,b=<span class="keyword">this</span>.layers||<span class="keyword">this</span>.map.layers;<span class="keyword">for</span>(a=b.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;--a)<span class="keyword">this</span>.removeLayer(&#123;<span class="attr">layer</span>:b[a]&#125;)&#125;<span class="keyword">this</span>.map&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.map.events.un(&#123;<span class="attr">addlayer</span>:<span class="keyword">this</span>.addLayer,<span class="attr">removeLayer</span>:<span class="keyword">this</span>.removeLayer,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.CacheWrite"</span>&#125;);OpenLayers.Control.CacheWrite.clearCache=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="built_in">window</span>.localStorage)&#123;<span class="keyword">var</span> a,b;<span class="keyword">for</span>(a=<span class="built_in">window</span>.localStorage.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;--a)b=<span class="built_in">window</span>.localStorage.key(a),<span class="string">"olCache_"</span>===b.substr(<span class="number">0</span>,<span class="number">8</span>)&amp;&amp;<span class="built_in">window</span>.localStorage.removeItem(b)&#125;&#125;;OpenLayers.Control.CacheWrite.urlMap=&#123;&#125;;OpenLayers.Format.Context=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,&#123;<span class="attr">layerOptions</span>:<span class="literal">null</span>,<span class="attr">layerParams</span>:<span class="literal">null</span>,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Format.XML.VersionedOGC.prototype.read.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">if</span>(b&amp;&amp;b.map)<span class="keyword">if</span>(<span class="keyword">this</span>.context=c,b.map <span class="keyword">instanceof</span> OpenLayers.Map)c=<span class="keyword">this</span>.mergeContextToMap(c,b.map);<span class="keyword">else</span>&#123;<span class="keyword">var</span> d=b.map;<span class="keyword">if</span>(OpenLayers.Util.isElement(d)||<span class="string">"string"</span>==<span class="keyword">typeof</span> d)d=&#123;<span class="attr">div</span>:d&#125;;c=<span class="keyword">this</span>.contextToMap(c,d)&#125;<span class="keyword">return</span> c&#125;,<span class="attr">getLayerFromContext</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c,d=&#123;<span class="attr">queryable</span>:a.queryable,<span class="attr">visibility</span>:a.visibility,</span><br><span class="line">maxExtent:a.maxExtent,<span class="attr">metadata</span>:OpenLayers.Util.applyDefaults(a.metadata,&#123;<span class="attr">styles</span>:a.styles,<span class="attr">formats</span>:a.formats,<span class="string">"abstract"</span>:a[<span class="string">"abstract"</span>],<span class="attr">dataURL</span>:a.dataURL&#125;),<span class="attr">numZoomLevels</span>:a.numZoomLevels,<span class="attr">units</span>:a.units,<span class="attr">isBaseLayer</span>:a.isBaseLayer,<span class="attr">opacity</span>:a.opacity,<span class="attr">displayInLayerSwitcher</span>:a.displayInLayerSwitcher,<span class="attr">singleTile</span>:a.singleTile,<span class="attr">tileSize</span>:a.tileSize?<span class="keyword">new</span> OpenLayers.Size(a.tileSize.width,a.tileSize.height):<span class="keyword">void</span> <span class="number">0</span>,<span class="attr">minScale</span>:a.minScale||a.maxScaleDenominator,<span class="attr">maxScale</span>:a.maxScale||a.minScaleDenominator,<span class="attr">srs</span>:a.srs,<span class="attr">dimensions</span>:a.dimensions,</span><br><span class="line">metadataURL:a.metadataURL&#125;;<span class="keyword">this</span>.layerOptions&amp;&amp;OpenLayers.Util.applyDefaults(d,<span class="keyword">this</span>.layerOptions);<span class="keyword">var</span> e=&#123;<span class="attr">layers</span>:a.name,<span class="attr">transparent</span>:a.transparent,<span class="attr">version</span>:a.version&#125;;<span class="keyword">if</span>(a.formats&amp;&amp;<span class="number">0</span>&lt;a.formats.length)<span class="keyword">for</span>(e.format=a.formats[<span class="number">0</span>].value,b=<span class="number">0</span>,c=a.formats.length;b&lt;c;b++)&#123;<span class="keyword">var</span> f=a.formats[b];<span class="keyword">if</span>(!<span class="number">0</span>==f.current)&#123;e.format=f.value;<span class="keyword">break</span>&#125;&#125;<span class="keyword">if</span>(a.styles&amp;&amp;<span class="number">0</span>&lt;a.styles.length)<span class="keyword">for</span>(b=<span class="number">0</span>,c=a.styles.length;b&lt;c;b++)<span class="keyword">if</span>(f=a.styles[b],!<span class="number">0</span>==f.current)&#123;f.href?e.sld=f.href:f.body?e.sld_body=f.body:e.styles=f.name;<span class="keyword">break</span>&#125;<span class="keyword">this</span>.layerParams&amp;&amp;</span><br><span class="line">OpenLayers.Util.applyDefaults(e,<span class="keyword">this</span>.layerParams);b=<span class="literal">null</span>;c=a.service;c==OpenLayers.Format.Context.serviceTypes.WFS?(d.strategies=[<span class="keyword">new</span> OpenLayers.Strategy.BBOX],d.protocol=<span class="keyword">new</span> OpenLayers.Protocol.WFS(&#123;<span class="attr">url</span>:a.url,<span class="attr">featurePrefix</span>:a.name.split(<span class="string">":"</span>)[<span class="number">0</span>],<span class="attr">featureType</span>:a.name.split(<span class="string">":"</span>).pop()&#125;),b=<span class="keyword">new</span> OpenLayers.Layer.Vector(a.title||a.name,d)):c==OpenLayers.Format.Context.serviceTypes.KML?(d.strategies=[<span class="keyword">new</span> OpenLayers.Strategy.Fixed],d.protocol=<span class="keyword">new</span> OpenLayers.Protocol.HTTP(&#123;<span class="attr">url</span>:a.url,<span class="attr">format</span>:<span class="keyword">new</span> OpenLayers.Format.KML&#125;),</span><br><span class="line">b=<span class="keyword">new</span> OpenLayers.Layer.Vector(a.title||a.name,d)):c==OpenLayers.Format.Context.serviceTypes.GML?(d.strategies=[<span class="keyword">new</span> OpenLayers.Strategy.Fixed],d.protocol=<span class="keyword">new</span> OpenLayers.Protocol.HTTP(&#123;<span class="attr">url</span>:a.url,<span class="attr">format</span>:<span class="keyword">new</span> OpenLayers.Format.GML&#125;),b=<span class="keyword">new</span> OpenLayers.Layer.Vector(a.title||a.name,d)):a.features?(b=<span class="keyword">new</span> OpenLayers.Layer.Vector(a.title||a.name,d),b.addFeatures(a.features)):!<span class="number">0</span>!==a.categoryLayer&amp;&amp;(b=<span class="keyword">new</span> OpenLayers.Layer.WMS(a.title||a.name,a.url,e,d));<span class="keyword">return</span> b&#125;,<span class="attr">getLayersFromContext</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=</span><br><span class="line"><span class="number">0</span>,d=a.length;c&lt;d;c++)&#123;<span class="keyword">var</span> e=<span class="keyword">this</span>.getLayerFromContext(a[c]);<span class="literal">null</span>!==e&amp;&amp;b.push(e)&#125;<span class="keyword">return</span> b&#125;,<span class="attr">contextToMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=OpenLayers.Util.applyDefaults(&#123;<span class="attr">maxExtent</span>:a.maxExtent,<span class="attr">projection</span>:a.projection,<span class="attr">units</span>:a.units&#125;,b);b.maxExtent&amp;&amp;(b.maxResolution=b.maxExtent.getWidth()/OpenLayers.Map.TILE_WIDTH);b.metadata=&#123;<span class="attr">contactInformation</span>:a.contactInformation,<span class="string">"abstract"</span>:a[<span class="string">"abstract"</span>],<span class="attr">keywords</span>:a.keywords,<span class="attr">logo</span>:a.logo,<span class="attr">descriptionURL</span>:a.descriptionURL&#125;;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Map(b);c.addLayers(<span class="keyword">this</span>.getLayersFromContext(a.layersContext));</span><br><span class="line">c.setCenter(a.bounds.getCenterLonLat(),c.getZoomForExtent(a.bounds,!<span class="number">0</span>));<span class="keyword">return</span> c&#125;,<span class="attr">mergeContextToMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.addLayers(<span class="keyword">this</span>.getLayersFromContext(a.layersContext));<span class="keyword">return</span> b&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a=<span class="keyword">this</span>.toContext(a);<span class="keyword">return</span> OpenLayers.Format.XML.VersionedOGC.prototype.write.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.Context"</span>&#125;);</span><br><span class="line">OpenLayers.Format.Context.serviceTypes=&#123;<span class="attr">WMS</span>:<span class="string">"urn:ogc:serviceType:WMS"</span>,<span class="attr">WFS</span>:<span class="string">"urn:ogc:serviceType:WFS"</span>,<span class="attr">WCS</span>:<span class="string">"urn:ogc:serviceType:WCS"</span>,<span class="attr">GML</span>:<span class="string">"urn:ogc:serviceType:GML"</span>,<span class="attr">SLD</span>:<span class="string">"urn:ogc:serviceType:SLD"</span>,<span class="attr">FES</span>:<span class="string">"urn:ogc:serviceType:FES"</span>,<span class="attr">KML</span>:<span class="string">"urn:ogc:serviceType:KML"</span>&#125;;OpenLayers.Format.WMC=OpenLayers.Class(OpenLayers.Format.Context,&#123;<span class="attr">defaultVersion</span>:<span class="string">"1.1.0"</span>,<span class="attr">layerToContext</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getParser(),c=&#123;<span class="attr">queryable</span>:a.queryable,<span class="attr">visibility</span>:a.visibility,<span class="attr">name</span>:a.params.LAYERS,<span class="attr">title</span>:a.name,<span class="string">"abstract"</span>:a.metadata[<span class="string">"abstract"</span>],<span class="attr">dataURL</span>:a.metadata.dataURL,<span class="attr">metadataURL</span>:a.metadataURL,<span class="attr">server</span>:&#123;<span class="attr">version</span>:a.params.VERSION,<span class="attr">url</span>:a.url&#125;,<span class="attr">maxExtent</span>:a.maxExtent,<span class="attr">transparent</span>:a.params.TRANSPARENT,<span class="attr">numZoomLevels</span>:a.numZoomLevels,<span class="attr">units</span>:a.units,<span class="attr">isBaseLayer</span>:a.isBaseLayer,<span class="attr">opacity</span>:<span class="number">1</span>==a.opacity?<span class="keyword">void</span> <span class="number">0</span>:</span><br><span class="line">a.opacity,<span class="attr">displayInLayerSwitcher</span>:a.displayInLayerSwitcher,<span class="attr">singleTile</span>:a.singleTile,<span class="attr">tileSize</span>:a.singleTile||!a.tileSize?<span class="keyword">void</span> <span class="number">0</span>:&#123;<span class="attr">width</span>:a.tileSize.w,<span class="attr">height</span>:a.tileSize.h&#125;,<span class="attr">minScale</span>:a.options.resolutions||a.options.scales||a.options.maxResolution||a.options.minScale?a.minScale:<span class="keyword">void</span> <span class="number">0</span>,<span class="attr">maxScale</span>:a.options.resolutions||a.options.scales||a.options.minResolution||a.options.maxScale?a.maxScale:<span class="keyword">void</span> <span class="number">0</span>,<span class="attr">formats</span>:[],<span class="attr">styles</span>:[],<span class="attr">srs</span>:a.srs,<span class="attr">dimensions</span>:a.dimensions&#125;;a.metadata.servertitle&amp;&amp;(c.server.title=a.metadata.servertitle);</span><br><span class="line"><span class="keyword">if</span>(a.metadata.formats&amp;&amp;<span class="number">0</span>&lt;a.metadata.formats.length)<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e=a.metadata.formats.length;d&lt;e;d++)&#123;<span class="keyword">var</span> f=a.metadata.formats[d];c.formats.push(&#123;<span class="attr">value</span>:f.value,<span class="attr">current</span>:f.value==a.params.FORMAT&#125;)&#125;<span class="keyword">else</span> c.formats.push(&#123;<span class="attr">value</span>:a.params.FORMAT,<span class="attr">current</span>:!<span class="number">0</span>&#125;);<span class="keyword">if</span>(a.metadata.styles&amp;&amp;<span class="number">0</span>&lt;a.metadata.styles.length)<span class="keyword">for</span>(d=<span class="number">0</span>,e=a.metadata.styles.length;d&lt;e;d++)b=a.metadata.styles[d],b.current=b.href==a.params.SLD||b.body==a.params.SLD_BODY||b.name==a.params.STYLES?!<span class="number">0</span>:!<span class="number">1</span>,c.styles.push(b);<span class="keyword">else</span> c.styles.push(&#123;<span class="attr">href</span>:a.params.SLD,</span><br><span class="line">body:a.params.SLD_BODY,<span class="attr">name</span>:a.params.STYLES||b.defaultStyleName,<span class="attr">title</span>:b.defaultStyleTitle,<span class="attr">current</span>:!<span class="number">0</span>&#125;);<span class="keyword">return</span> c&#125;,<span class="attr">toContext</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;&#125;,c=a.layers;<span class="keyword">if</span>(<span class="string">"OpenLayers.Map"</span>==a.CLASS_NAME)&#123;<span class="keyword">var</span> d=a.metadata||&#123;&#125;;b.size=a.getSize();b.bounds=a.getExtent();b.projection=a.projection;b.title=a.title;b.keywords=d.keywords;b[<span class="string">"abstract"</span>]=d[<span class="string">"abstract"</span>];b.logo=d.logo;b.descriptionURL=d.descriptionURL;b.contactInformation=d.contactInformation;b.maxExtent=a.maxExtent&#125;<span class="keyword">else</span> OpenLayers.Util.applyDefaults(b,a),<span class="keyword">void</span> <span class="number">0</span>!=</span><br><span class="line">b.layers&amp;&amp;<span class="keyword">delete</span> b.layers;<span class="keyword">void</span> <span class="number">0</span>==b.layersContext&amp;&amp;(b.layersContext=[]);<span class="keyword">if</span>(<span class="keyword">void</span> <span class="number">0</span>!=c&amp;&amp;OpenLayers.Util.isArray(c))<span class="keyword">for</span>(a=<span class="number">0</span>,d=c.length;a&lt;d;a++)&#123;<span class="keyword">var</span> e=c[a];e <span class="keyword">instanceof</span> OpenLayers.Layer.WMS&amp;&amp;b.layersContext.push(<span class="keyword">this</span>.layerToContext(e))&#125;<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMC"</span>&#125;);OpenLayers.Format.WMC.v1=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">ol</span>:<span class="string">"http://openlayers.org/context"</span>,<span class="attr">wmc</span>:<span class="string">"http://www.opengis.net/context"</span>,<span class="attr">sld</span>:<span class="string">"http://www.opengis.net/sld"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&#125;,<span class="attr">schemaLocation</span>:<span class="string">""</span>,<span class="attr">getNamespacePrefix</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="keyword">if</span>(<span class="literal">null</span>==a)b=<span class="keyword">this</span>.namespaces[<span class="keyword">this</span>.defaultPrefix];<span class="keyword">else</span> <span class="keyword">for</span>(b <span class="keyword">in</span> <span class="keyword">this</span>.namespaces)<span class="keyword">if</span>(<span class="keyword">this</span>.namespaces[b]==a)<span class="keyword">break</span>;<span class="keyword">return</span> b&#125;,<span class="attr">defaultPrefix</span>:<span class="string">"wmc"</span>,<span class="attr">rootPrefix</span>:<span class="literal">null</span>,<span class="attr">defaultStyleName</span>:<span class="string">""</span>,</span><br><span class="line">defaultStyleTitle:<span class="string">"Default"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a=a.documentElement;<span class="keyword">this</span>.rootPrefix=a.prefix;<span class="keyword">var</span> b=&#123;<span class="attr">version</span>:a.getAttribute(<span class="string">"version"</span>)&#125;;<span class="keyword">this</span>.runChildNodes(b,a);<span class="keyword">return</span> b&#125;,<span class="attr">runChildNodes</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=b.childNodes,d,e,f,g=<span class="number">0</span>,h=c.length;g&lt;h;++g)d=c[g],<span class="number">1</span>==d.nodeType&amp;&amp;(e=<span class="keyword">this</span>.getNamespacePrefix(d.namespaceURI),f=d.nodeName.split(<span class="string">":"</span>).pop(),</span><br><span class="line">(e=<span class="keyword">this</span>[<span class="string">"read_"</span>+e+<span class="string">"_"</span>+f])&amp;&amp;e.apply(<span class="keyword">this</span>,[a,d]))&#125;,<span class="attr">read_wmc_General</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.runChildNodes(a,b)&#125;,<span class="attr">read_wmc_BoundingBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.projection=b.getAttribute(<span class="string">"SRS"</span>);a.bounds=<span class="keyword">new</span> OpenLayers.Bounds(b.getAttribute(<span class="string">"minx"</span>),b.getAttribute(<span class="string">"miny"</span>),b.getAttribute(<span class="string">"maxx"</span>),b.getAttribute(<span class="string">"maxy"</span>))&#125;,<span class="attr">read_wmc_LayerList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.layersContext=[];<span class="keyword">this</span>.runChildNodes(a,b)&#125;,<span class="attr">read_wmc_Layer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">visibility</span>:<span class="string">"1"</span>!=b.getAttribute(<span class="string">"hidden"</span>),<span class="attr">queryable</span>:<span class="string">"1"</span>==b.getAttribute(<span class="string">"queryable"</span>),<span class="attr">formats</span>:[],</span><br><span class="line">styles:[],<span class="attr">metadata</span>:&#123;&#125;&#125;;<span class="keyword">this</span>.runChildNodes(c,b);a.layersContext.push(c)&#125;,<span class="attr">read_wmc_Extension</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.runChildNodes(a,b)&#125;,<span class="attr">read_ol_units</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.units=<span class="keyword">this</span>.getChildValue(b)&#125;,<span class="attr">read_ol_maxExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Bounds(b.getAttribute(<span class="string">"minx"</span>),b.getAttribute(<span class="string">"miny"</span>),b.getAttribute(<span class="string">"maxx"</span>),b.getAttribute(<span class="string">"maxy"</span>));a.maxExtent=c&#125;,<span class="attr">read_ol_transparent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.transparent=<span class="keyword">this</span>.getChildValue(b)&#125;,<span class="attr">read_ol_numZoomLevels</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.numZoomLevels=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.getChildValue(b))&#125;,</span><br><span class="line">read_ol_opacity:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.opacity=<span class="built_in">parseFloat</span>(<span class="keyword">this</span>.getChildValue(b))&#125;,<span class="attr">read_ol_singleTile</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.singleTile=<span class="string">"true"</span>==<span class="keyword">this</span>.getChildValue(b)&#125;,<span class="attr">read_ol_tileSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">width</span>:b.getAttribute(<span class="string">"width"</span>),<span class="attr">height</span>:b.getAttribute(<span class="string">"height"</span>)&#125;;a.tileSize=c&#125;,<span class="attr">read_ol_isBaseLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.isBaseLayer=<span class="string">"true"</span>==<span class="keyword">this</span>.getChildValue(b)&#125;,<span class="attr">read_ol_displayInLayerSwitcher</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.displayInLayerSwitcher=<span class="string">"true"</span>==<span class="keyword">this</span>.getChildValue(b)&#125;,<span class="attr">read_wmc_Server</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.version=b.getAttribute(<span class="string">"version"</span>);</span><br><span class="line">a.url=<span class="keyword">this</span>.getOnlineResource_href(b);a.metadata.servertitle=b.getAttribute(<span class="string">"title"</span>)&#125;,<span class="attr">read_wmc_FormatList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.runChildNodes(a,b)&#125;,<span class="attr">read_wmc_Format</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">value</span>:<span class="keyword">this</span>.getChildValue(b)&#125;;<span class="string">"1"</span>==b.getAttribute(<span class="string">"current"</span>)&amp;&amp;(c.current=!<span class="number">0</span>);a.formats.push(c)&#125;,<span class="attr">read_wmc_StyleList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.runChildNodes(a,b)&#125;,<span class="attr">read_wmc_Style</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.runChildNodes(c,b);<span class="string">"1"</span>==b.getAttribute(<span class="string">"current"</span>)&amp;&amp;(c.current=!<span class="number">0</span>);a.styles.push(c)&#125;,<span class="attr">read_wmc_SLD</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.runChildNodes(a,</span><br><span class="line">b)&#125;,<span class="attr">read_sld_StyledLayerDescriptor</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[b]);a.body=c&#125;,<span class="attr">read_sld_FeatureTypeStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[b]);a.body=c&#125;,<span class="attr">read_wmc_OnlineResource</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.href=<span class="keyword">this</span>.getAttributeNS(b,<span class="keyword">this</span>.namespaces.xlink,<span class="string">"href"</span>)&#125;,<span class="attr">read_wmc_Name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a.name=c)&#125;,<span class="attr">read_wmc_Title</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a.title=c)&#125;,<span class="attr">read_wmc_MetadataURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;a.metadataURL=<span class="keyword">this</span>.getOnlineResource_href(b)&#125;,<span class="attr">read_wmc_KeywordList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.keywords=[];<span class="keyword">this</span>.runChildNodes(a.keywords,b)&#125;,<span class="attr">read_wmc_Keyword</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.push(<span class="keyword">this</span>.getChildValue(b))&#125;,<span class="attr">read_wmc_Abstract</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a[<span class="string">"abstract"</span>]=c)&#125;,<span class="attr">read_wmc_LogoURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.logo=&#123;<span class="attr">width</span>:b.getAttribute(<span class="string">"width"</span>),<span class="attr">height</span>:b.getAttribute(<span class="string">"height"</span>),<span class="attr">format</span>:b.getAttribute(<span class="string">"format"</span>),<span class="attr">href</span>:<span class="keyword">this</span>.getOnlineResource_href(b)&#125;&#125;,<span class="attr">read_wmc_DescriptionURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.descriptionURL=</span><br><span class="line"><span class="keyword">this</span>.getOnlineResource_href(b)&#125;,<span class="attr">read_wmc_ContactInformation</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.runChildNodes(c,b);a.contactInformation=c&#125;,<span class="attr">read_wmc_ContactPersonPrimary</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.runChildNodes(c,b);a.personPrimary=c&#125;,<span class="attr">read_wmc_ContactPerson</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a.person=c)&#125;,<span class="attr">read_wmc_ContactOrganization</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a.organization=c)&#125;,<span class="attr">read_wmc_ContactPosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a.position=c)&#125;,<span class="attr">read_wmc_ContactAddress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.runChildNodes(c,b);a.contactAddress=c&#125;,<span class="attr">read_wmc_AddressType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a.type=c)&#125;,<span class="attr">read_wmc_Address</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a.address=c)&#125;,<span class="attr">read_wmc_City</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a.city=c)&#125;,<span class="attr">read_wmc_StateOrProvince</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a.stateOrProvince=c)&#125;,<span class="attr">read_wmc_PostCode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a.postcode=c)&#125;,<span class="attr">read_wmc_Country</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);</span><br><span class="line">c&amp;&amp;(a.country=c)&#125;,<span class="attr">read_wmc_ContactVoiceTelephone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a.phone=c)&#125;,<span class="attr">read_wmc_ContactFacsimileTelephone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a.fax=c)&#125;,<span class="attr">read_wmc_ContactElectronicMailAddress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);c&amp;&amp;(a.email=c)&#125;,<span class="attr">read_wmc_DataURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.dataURL=<span class="keyword">this</span>.getOnlineResource_href(b)&#125;,<span class="attr">read_wmc_LegendURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">width</span>:b.getAttribute(<span class="string">"width"</span>),<span class="attr">height</span>:b.getAttribute(<span class="string">"height"</span>),<span class="attr">format</span>:b.getAttribute(<span class="string">"format"</span>),</span><br><span class="line">href:<span class="keyword">this</span>.getOnlineResource_href(b)&#125;;a.legend=c&#125;,<span class="attr">read_wmc_DimensionList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.dimensions=&#123;&#125;;<span class="keyword">this</span>.runChildNodes(a.dimensions,b)&#125;,<span class="attr">read_wmc_Dimension</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">name</span>:b.getAttribute(<span class="string">"name"</span>).toLowerCase(),<span class="attr">units</span>:b.getAttribute(<span class="string">"units"</span>)||<span class="string">""</span>,<span class="attr">unitSymbol</span>:b.getAttribute(<span class="string">"unitSymbol"</span>)||<span class="string">""</span>,<span class="attr">userValue</span>:b.getAttribute(<span class="string">"userValue"</span>)||<span class="string">""</span>,<span class="attr">nearestValue</span>:<span class="string">"1"</span>===b.getAttribute(<span class="string">"nearestValue"</span>),<span class="attr">multipleValues</span>:<span class="string">"1"</span>===b.getAttribute(<span class="string">"multipleValues"</span>),<span class="attr">current</span>:<span class="string">"1"</span>===b.getAttribute(<span class="string">"current"</span>),<span class="string">"default"</span>:b.getAttribute(<span class="string">"default"</span>)||</span><br><span class="line"><span class="string">""</span>&#125;,d=<span class="keyword">this</span>.getChildValue(b);c.values=d.split(<span class="string">","</span>);a[c.name]=c&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"ViewContext"</span>);<span class="keyword">this</span>.setAttributes(c,&#123;<span class="attr">version</span>:<span class="keyword">this</span>.VERSION,<span class="attr">id</span>:b&amp;&amp;<span class="string">"string"</span>==<span class="keyword">typeof</span> b.id?b.id:OpenLayers.Util.createUniqueID(<span class="string">"OpenLayers_Context_"</span>)&#125;);<span class="keyword">this</span>.setAttributeNS(c,<span class="keyword">this</span>.namespaces.xsi,<span class="string">"xsi:schemaLocation"</span>,<span class="keyword">this</span>.schemaLocation);c.appendChild(<span class="keyword">this</span>.write_wmc_General(a));c.appendChild(<span class="keyword">this</span>.write_wmc_LayerList(a));<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[c])&#125;,<span class="attr">createElementDefaultNS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b,c</span>)</span>&#123;a=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces[<span class="keyword">this</span>.defaultPrefix],a);b&amp;&amp;a.appendChild(<span class="keyword">this</span>.createTextNode(b));c&amp;&amp;<span class="keyword">this</span>.setAttributes(a,c);<span class="keyword">return</span> a&#125;,<span class="attr">setAttributes</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c,d;<span class="keyword">for</span>(d <span class="keyword">in</span> b)c=b[d].toString(),c.match(<span class="regexp">/[A-Z]/</span>)?<span class="keyword">this</span>.setAttributeNS(a,<span class="literal">null</span>,d,c):a.setAttribute(d,c)&#125;,<span class="attr">write_wmc_General</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"General"</span>);a.size&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Window"</span>,<span class="literal">null</span>,&#123;<span class="attr">width</span>:a.size.w,<span class="attr">height</span>:a.size.h&#125;));<span class="keyword">var</span> c=a.bounds;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"BoundingBox"</span>,</span><br><span class="line"><span class="literal">null</span>,&#123;<span class="attr">minx</span>:c.left.toPrecision(<span class="number">18</span>),<span class="attr">miny</span>:c.bottom.toPrecision(<span class="number">18</span>),<span class="attr">maxx</span>:c.right.toPrecision(<span class="number">18</span>),<span class="attr">maxy</span>:c.top.toPrecision(<span class="number">18</span>),<span class="attr">SRS</span>:a.projection&#125;));b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Title"</span>,a.title));a.keywords&amp;&amp;b.appendChild(<span class="keyword">this</span>.write_wmc_KeywordList(a.keywords));a[<span class="string">"abstract"</span>]&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Abstract"</span>,a[<span class="string">"abstract"</span>]));a.logo&amp;&amp;b.appendChild(<span class="keyword">this</span>.write_wmc_URLType(<span class="string">"LogoURL"</span>,a.logo.href,a.logo));a.descriptionURL&amp;&amp;b.appendChild(<span class="keyword">this</span>.write_wmc_URLType(<span class="string">"DescriptionURL"</span>,a.descriptionURL));</span><br><span class="line">a.contactInformation&amp;&amp;b.appendChild(<span class="keyword">this</span>.write_wmc_ContactInformation(a.contactInformation));b.appendChild(<span class="keyword">this</span>.write_ol_MapExtension(a));<span class="keyword">return</span> b&#125;,<span class="attr">write_wmc_KeywordList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"KeywordList"</span>),c=<span class="number">0</span>,d=a.length;c&lt;d;c++)b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Keyword"</span>,a[c]));<span class="keyword">return</span> b&#125;,<span class="attr">write_wmc_ContactInformation</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"ContactInformation"</span>);a.personPrimary&amp;&amp;b.appendChild(<span class="keyword">this</span>.write_wmc_ContactPersonPrimary(a.personPrimary));</span><br><span class="line">a.position&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"ContactPosition"</span>,a.position));a.contactAddress&amp;&amp;b.appendChild(<span class="keyword">this</span>.write_wmc_ContactAddress(a.contactAddress));a.phone&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"ContactVoiceTelephone"</span>,a.phone));a.fax&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"ContactFacsimileTelephone"</span>,a.fax));a.email&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"ContactElectronicMailAddress"</span>,a.email));<span class="keyword">return</span> b&#125;,<span class="attr">write_wmc_ContactPersonPrimary</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"ContactPersonPrimary"</span>);</span><br><span class="line">a.person&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"ContactPerson"</span>,a.person));a.organization&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"ContactOrganization"</span>,a.organization));<span class="keyword">return</span> b&#125;,<span class="attr">write_wmc_ContactAddress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"ContactAddress"</span>);a.type&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"AddressType"</span>,a.type));a.address&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Address"</span>,a.address));a.city&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"City"</span>,a.city));a.stateOrProvince&amp;&amp;</span><br><span class="line">b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"StateOrProvince"</span>,a.stateOrProvince));a.postcode&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"PostCode"</span>,a.postcode));a.country&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Country"</span>,a.country));<span class="keyword">return</span> b&#125;,<span class="attr">write_ol_MapExtension</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Extension"</span>);<span class="keyword">if</span>(a=a.maxExtent)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.ol,<span class="string">"ol:maxExtent"</span>);<span class="keyword">this</span>.setAttributes(c,&#123;<span class="attr">minx</span>:a.left.toPrecision(<span class="number">18</span>),<span class="attr">miny</span>:a.bottom.toPrecision(<span class="number">18</span>),<span class="attr">maxx</span>:a.right.toPrecision(<span class="number">18</span>),</span><br><span class="line">maxy:a.top.toPrecision(<span class="number">18</span>)&#125;);b.appendChild(c)&#125;<span class="keyword">return</span> b&#125;,<span class="attr">write_wmc_LayerList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"LayerList"</span>),c=<span class="number">0</span>,d=a.layersContext.length;c&lt;d;++c)b.appendChild(<span class="keyword">this</span>.write_wmc_Layer(a.layersContext[c]));<span class="keyword">return</span> b&#125;,<span class="attr">write_wmc_Layer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Layer"</span>,<span class="literal">null</span>,&#123;<span class="attr">queryable</span>:a.queryable?<span class="string">"1"</span>:<span class="string">"0"</span>,<span class="attr">hidden</span>:a.visibility?<span class="string">"0"</span>:<span class="string">"1"</span>&#125;);b.appendChild(<span class="keyword">this</span>.write_wmc_Server(a));b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Name"</span>,a.name));b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Title"</span>,</span><br><span class="line">a.title));a[<span class="string">"abstract"</span>]&amp;&amp;b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Abstract"</span>,a[<span class="string">"abstract"</span>]));a.dataURL&amp;&amp;b.appendChild(<span class="keyword">this</span>.write_wmc_URLType(<span class="string">"DataURL"</span>,a.dataURL));a.metadataURL&amp;&amp;b.appendChild(<span class="keyword">this</span>.write_wmc_URLType(<span class="string">"MetadataURL"</span>,a.metadataURL));<span class="keyword">return</span> b&#125;,<span class="attr">write_wmc_LayerExtension</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Extension"</span>),c=a.maxExtent,d=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.ol,<span class="string">"ol:maxExtent"</span>);<span class="keyword">this</span>.setAttributes(d,&#123;<span class="attr">minx</span>:c.left.toPrecision(<span class="number">18</span>),<span class="attr">miny</span>:c.bottom.toPrecision(<span class="number">18</span>),<span class="attr">maxx</span>:c.right.toPrecision(<span class="number">18</span>),</span><br><span class="line">maxy:c.top.toPrecision(<span class="number">18</span>)&#125;);b.appendChild(d);a.tileSize&amp;&amp;!a.singleTile&amp;&amp;(c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.ol,<span class="string">"ol:tileSize"</span>),<span class="keyword">this</span>.setAttributes(c,a.tileSize),b.appendChild(c));<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="string">"transparent numZoomLevels units isBaseLayer opacity displayInLayerSwitcher singleTile"</span>.split(<span class="string">" "</span>),e=<span class="number">0</span>,f=c.length;e&lt;f;++e)(d=<span class="keyword">this</span>.createOLPropertyNode(a,c[e]))&amp;&amp;b.appendChild(d);<span class="keyword">return</span> b&#125;,<span class="attr">createOLPropertyNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>;<span class="literal">null</span>!=a[b]&amp;&amp;(c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.ol,<span class="string">"ol:"</span>+b),c.appendChild(<span class="keyword">this</span>.createTextNode(a[b].toString())));</span><br><span class="line"><span class="keyword">return</span> c&#125;,<span class="attr">write_wmc_Server</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.server;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Server"</span>),c=&#123;<span class="attr">service</span>:<span class="string">"OGC:WMS"</span>,<span class="attr">version</span>:a.version&#125;;a.title&amp;&amp;(c.title=a.title);<span class="keyword">this</span>.setAttributes(b,c);b.appendChild(<span class="keyword">this</span>.write_wmc_OnlineResource(a.url));<span class="keyword">return</span> b&#125;,<span class="attr">write_wmc_URLType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;a=<span class="keyword">this</span>.createElementDefaultNS(a);a.appendChild(<span class="keyword">this</span>.write_wmc_OnlineResource(b));<span class="keyword">if</span>(c)&#123;b=[<span class="string">"width"</span>,<span class="string">"height"</span>,<span class="string">"format"</span>];<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>;d&lt;b.length;d++)b[d]<span class="keyword">in</span> c&amp;&amp;a.setAttribute(b[d],c[b[d]])&#125;<span class="keyword">return</span> a&#125;,<span class="attr">write_wmc_DimensionList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.createElementDefaultNS(<span class="string">"DimensionList"</span>),c;<span class="keyword">for</span>(c <span class="keyword">in</span> a.dimensions)&#123;<span class="keyword">var</span> d=&#123;&#125;,e=a.dimensions[c],f;<span class="keyword">for</span>(f <span class="keyword">in</span> e)d[f]=<span class="string">"boolean"</span>==<span class="keyword">typeof</span> e[f]?<span class="built_in">Number</span>(e[f]):e[f];e=<span class="string">""</span>;d.values&amp;&amp;(e=d.values.join(<span class="string">","</span>),<span class="keyword">delete</span> d.values);b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Dimension"</span>,e,d))&#125;<span class="keyword">return</span> b&#125;,<span class="attr">write_wmc_FormatList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"FormatList"</span>),c=<span class="number">0</span>,d=a.formats.length;c&lt;d;c++)&#123;<span class="keyword">var</span> e=a.formats[c];b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Format"</span>,e.value,e.current&amp;&amp;!<span class="number">0</span>==e.current?&#123;<span class="attr">current</span>:<span class="string">"1"</span>&#125;:</span><br><span class="line"><span class="literal">null</span>))&#125;<span class="keyword">return</span> b&#125;,<span class="attr">write_wmc_StyleList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"StyleList"</span>);<span class="keyword">if</span>((a=a.styles)&amp;&amp;OpenLayers.Util.isArray(a))<span class="keyword">for</span>(<span class="keyword">var</span> c,d=<span class="number">0</span>,e=a.length;d&lt;e;d++)&#123;<span class="keyword">var</span> f=a[d],g=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Style"</span>,<span class="literal">null</span>,f.current&amp;&amp;!<span class="number">0</span>==f.current?&#123;<span class="attr">current</span>:<span class="string">"1"</span>&#125;:<span class="literal">null</span>);f.href?(c=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"SLD"</span>),f.name&amp;&amp;c.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Name"</span>,f.name)),f.title&amp;&amp;c.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Title"</span>,f.title)),f.legend&amp;&amp;c.appendChild(<span class="keyword">this</span>.write_wmc_URLType(<span class="string">"LegendURL"</span>,</span><br><span class="line">f.legend.href,f.legend)),f=<span class="keyword">this</span>.write_wmc_OnlineResource(f.href),c.appendChild(f),g.appendChild(c)):f.body?(c=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"SLD"</span>),f.name&amp;&amp;c.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Name"</span>,f.name)),f.title&amp;&amp;c.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Title"</span>,f.title)),f.legend&amp;&amp;c.appendChild(<span class="keyword">this</span>.write_wmc_URLType(<span class="string">"LegendURL"</span>,f.legend.href,f.legend)),f=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[f.body]).documentElement,c.ownerDocument&amp;&amp;c.ownerDocument.importNode&amp;&amp;(f=c.ownerDocument.importNode(f,</span><br><span class="line">!<span class="number">0</span>)),c.appendChild(f),g.appendChild(c)):(g.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Name"</span>,f.name)),g.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Title"</span>,f.title)),f[<span class="string">"abstract"</span>]&amp;&amp;g.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"Abstract"</span>,f[<span class="string">"abstract"</span>])),f.legend&amp;&amp;g.appendChild(<span class="keyword">this</span>.write_wmc_URLType(<span class="string">"LegendURL"</span>,f.legend.href,f.legend)));b.appendChild(g)&#125;<span class="keyword">return</span> b&#125;,<span class="attr">write_wmc_OnlineResource</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"OnlineResource"</span>);<span class="keyword">this</span>.setAttributeNS(b,<span class="keyword">this</span>.namespaces.xlink,<span class="string">"xlink:type"</span>,</span><br><span class="line"><span class="string">"simple"</span>);<span class="keyword">this</span>.setAttributeNS(b,<span class="keyword">this</span>.namespaces.xlink,<span class="string">"xlink:href"</span>,a);<span class="keyword">return</span> b&#125;,<span class="attr">getOnlineResource_href</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;&#125;;a=a.getElementsByTagName(<span class="string">"OnlineResource"</span>);<span class="number">0</span>&lt;a.length&amp;&amp;<span class="keyword">this</span>.read_wmc_OnlineResource(b,a[<span class="number">0</span>]);<span class="keyword">return</span> b.href&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMC.v1"</span>&#125;);OpenLayers.Control.PanPanel=OpenLayers.Class(OpenLayers.Control.Panel,&#123;<span class="attr">slideFactor</span>:<span class="number">50</span>,<span class="attr">slideRatio</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.Panel.prototype.initialize.apply(<span class="keyword">this</span>,[a]);a=&#123;<span class="attr">slideFactor</span>:<span class="keyword">this</span>.slideFactor,<span class="attr">slideRatio</span>:<span class="keyword">this</span>.slideRatio&#125;;<span class="keyword">this</span>.addControls([<span class="keyword">new</span> OpenLayers.Control.Pan(OpenLayers.Control.Pan.NORTH,a),<span class="keyword">new</span> OpenLayers.Control.Pan(OpenLayers.Control.Pan.SOUTH,a),<span class="keyword">new</span> OpenLayers.Control.Pan(OpenLayers.Control.Pan.EAST,a),<span class="keyword">new</span> OpenLayers.Control.Pan(OpenLayers.Control.Pan.WEST,a)])&#125;,</span><br><span class="line">CLASS_NAME:<span class="string">"OpenLayers.Control.PanPanel"</span>&#125;);OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">separator</span>:<span class="string">", "</span>,<span class="attr">template</span>:<span class="string">"$&#123;layers&#125;"</span>,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.map.events.un(&#123;<span class="attr">removelayer</span>:<span class="keyword">this</span>.updateAttribution,<span class="attr">addlayer</span>:<span class="keyword">this</span>.updateAttribution,<span class="attr">changelayer</span>:<span class="keyword">this</span>.updateAttribution,<span class="attr">changebaselayer</span>:<span class="keyword">this</span>.updateAttribution,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Control.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.map.events.on(&#123;<span class="attr">changebaselayer</span>:<span class="keyword">this</span>.updateAttribution,<span class="attr">changelayer</span>:<span class="keyword">this</span>.updateAttribution,</span><br><span class="line">addlayer:<span class="keyword">this</span>.updateAttribution,<span class="attr">removelayer</span>:<span class="keyword">this</span>.updateAttribution,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">this</span>.updateAttribution();<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">updateAttribution</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=[];<span class="keyword">if</span>(<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.layers)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="keyword">this</span>.map.layers.length;b&lt;c;b++)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.map.layers[b];d.attribution&amp;&amp;d.getVisibility()&amp;&amp;<span class="number">-1</span>===OpenLayers.Util.indexOf(a,d.attribution)&amp;&amp;a.push(d.attribution)&#125;<span class="keyword">this</span>.div.innerHTML=OpenLayers.String.format(<span class="keyword">this</span>.template,&#123;<span class="attr">layers</span>:a.join(<span class="keyword">this</span>.separator)&#125;)&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.Attribution"</span>&#125;);OpenLayers.Kinetic=OpenLayers.Class(&#123;<span class="attr">threshold</span>:<span class="number">0</span>,<span class="attr">deceleration</span>:<span class="number">0.0035</span>,<span class="attr">nbPoints</span>:<span class="number">100</span>,<span class="attr">delay</span>:<span class="number">200</span>,<span class="attr">points</span>:<span class="keyword">void</span> <span class="number">0</span>,<span class="attr">timerId</span>:<span class="keyword">void</span> <span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,a)&#125;,<span class="attr">begin</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Animation.stop(<span class="keyword">this</span>.timerId);<span class="keyword">this</span>.timerId=<span class="keyword">void</span> <span class="number">0</span>;<span class="keyword">this</span>.points=[]&#125;,<span class="attr">update</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.points.unshift(&#123;<span class="attr">xy</span>:a,<span class="attr">tick</span>:(<span class="keyword">new</span> <span class="built_in">Date</span>).getTime()&#125;);<span class="keyword">this</span>.points.length&gt;<span class="keyword">this</span>.nbPoints&amp;&amp;<span class="keyword">this</span>.points.pop()&#125;,<span class="attr">end</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b,c=(<span class="keyword">new</span> <span class="built_in">Date</span>).getTime(),d=<span class="number">0</span>,e=<span class="keyword">this</span>.points.length,f;d&lt;e;d++)&#123;f=<span class="keyword">this</span>.points[d];<span class="keyword">if</span>(c-</span><br><span class="line">f.tick&gt;<span class="keyword">this</span>.delay)<span class="keyword">break</span>;b=f&#125;<span class="keyword">if</span>(b&amp;&amp;(d=(<span class="keyword">new</span> <span class="built_in">Date</span>).getTime()-b.tick,c=<span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(a.x-b.xy.x,<span class="number">2</span>)+<span class="built_in">Math</span>.pow(a.y-b.xy.y,<span class="number">2</span>)),d=c/d,!(<span class="number">0</span>==d||d&lt;<span class="keyword">this</span>.threshold)))<span class="keyword">return</span> c=<span class="built_in">Math</span>.asin((a.y-b.xy.y)/c),b.xy.x&lt;=a.x&amp;&amp;(c=<span class="built_in">Math</span>.PI-c),&#123;<span class="attr">speed</span>:d,<span class="attr">theta</span>:c&#125;&#125;,<span class="attr">move</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.speed,d=<span class="built_in">Math</span>.cos(a.theta),e=-<span class="built_in">Math</span>.sin(a.theta),f=(<span class="keyword">new</span> <span class="built_in">Date</span>).getTime(),g=<span class="number">0</span>,h=<span class="number">0</span>;<span class="keyword">this</span>.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.timerId)&#123;<span class="keyword">var</span> a=(<span class="keyword">new</span> <span class="built_in">Date</span>).getTime()-f,l=-<span class="keyword">this</span>.deceleration*<span class="built_in">Math</span>.pow(a,</span><br><span class="line"><span class="number">2</span>)/<span class="number">2</span>+c*a,m=l*d,l=l*e,n,p;n=!<span class="number">1</span>;<span class="number">0</span>&gt;=-<span class="keyword">this</span>.deceleration*a+c&amp;&amp;(OpenLayers.Animation.stop(<span class="keyword">this</span>.timerId),<span class="keyword">this</span>.timerId=<span class="literal">null</span>,n=!<span class="number">0</span>);a=m-g;p=l-h;g=m;h=l;b(a,p,n)&#125;&#125;,<span class="keyword">this</span>))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Kinetic"</span>&#125;);OpenLayers.Format.WPSExecute=OpenLayers.Class(OpenLayers.Format.XML,OpenLayers.Format.Filter.v1_1_0,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows/1.1"</span>,<span class="attr">gml</span>:<span class="string">"http://www.opengis.net/gml"</span>,<span class="attr">wps</span>:<span class="string">"http://www.opengis.net/wps/1.0.0"</span>,<span class="attr">wfs</span>:<span class="string">"http://www.opengis.net/wfs"</span>,<span class="attr">ogc</span>:<span class="string">"http://www.opengis.net/ogc"</span>,<span class="attr">wcs</span>:<span class="string">"http://www.opengis.net/wcs"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&#125;,<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">VERSION</span>:<span class="string">"1.0.0"</span>,</span><br><span class="line">schemaLocation:<span class="string">"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd"</span>,<span class="attr">schemaLocationAttr</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;<span class="built_in">window</span>.ActiveXObject?<span class="keyword">this</span>.xmldom=b=<span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLDOM"</span>):b=<span class="built_in">document</span>.implementation.createDocument(<span class="string">""</span>,<span class="string">""</span>,<span class="literal">null</span>);a=<span class="keyword">this</span>.writeNode(<span class="string">"wps:Execute"</span>,a,b);<span class="keyword">this</span>.setAttributeNS(a,<span class="keyword">this</span>.namespaces.xsi,<span class="string">"xsi:schemaLocation"</span>,<span class="keyword">this</span>.schemaLocation);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=</span><br><span class="line">OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> b=&#123;&#125;;<span class="keyword">this</span>.readNode(a,b);<span class="keyword">return</span> b&#125;,<span class="attr">writers</span>:&#123;<span class="attr">wps</span>:&#123;<span class="attr">Execute</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wps:Execute"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">version</span>:<span class="keyword">this</span>.VERSION,<span class="attr">service</span>:<span class="string">"WPS"</span>&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"ows:Identifier"</span>,a.identifier,b);<span class="keyword">this</span>.writeNode(<span class="string">"wps:DataInputs"</span>,a.dataInputs,b);<span class="keyword">this</span>.writeNode(<span class="string">"wps:ResponseForm"</span>,a.responseForm,b);<span class="keyword">return</span> b&#125;,<span class="attr">ResponseForm</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wps:ResponseForm"</span>,&#123;&#125;);a.rawDataOutput&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.writeNode(<span class="string">"wps:RawDataOutput"</span>,a.rawDataOutput,b);a.responseDocument&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"wps:ResponseDocument"</span>,a.responseDocument,b);<span class="keyword">return</span> b&#125;,<span class="attr">ResponseDocument</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wps:ResponseDocument"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">storeExecuteResponse</span>:a.storeExecuteResponse,<span class="attr">lineage</span>:a.lineage,<span class="attr">status</span>:a.status&#125;&#125;);<span class="keyword">if</span>(a.outputs)<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.outputs.length;c&lt;d;c++)<span class="keyword">this</span>.writeNode(<span class="string">"wps:Output"</span>,a.outputs[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">Output</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wps:Output"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">asReference</span>:a.asReference,</span><br><span class="line">mimeType:a.mimeType,<span class="attr">encoding</span>:a.encoding,<span class="attr">schema</span>:a.schema&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"ows:Identifier"</span>,a.identifier,b);<span class="keyword">this</span>.writeNode(<span class="string">"ows:Title"</span>,a.title,b);<span class="keyword">this</span>.writeNode(<span class="string">"ows:Abstract"</span>,a[<span class="string">"abstract"</span>],b);<span class="keyword">return</span> b&#125;,<span class="attr">RawDataOutput</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wps:RawDataOutput"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">mimeType</span>:a.mimeType,<span class="attr">encoding</span>:a.encoding,<span class="attr">schema</span>:a.schema&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"ows:Identifier"</span>,a.identifier,b);<span class="keyword">return</span> b&#125;,<span class="attr">DataInputs</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wps:DataInputs"</span>,&#123;&#125;),c=<span class="number">0</span>,d=a.length;c&lt;</span><br><span class="line">d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"wps:Input"</span>,a[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">Input</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wps:Input"</span>,&#123;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"ows:Identifier"</span>,a.identifier,b);a.title&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"ows:Title"</span>,a.title,b);a.data&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"wps:Data"</span>,a.data,b);a.reference&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"wps:Reference"</span>,a.reference,b);a.boundingBoxData&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"wps:BoundingBoxData"</span>,a.boundingBoxData,b);<span class="keyword">return</span> b&#125;,<span class="attr">Data</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wps:Data"</span>,&#123;&#125;);a.literalData?<span class="keyword">this</span>.writeNode(<span class="string">"wps:LiteralData"</span>,</span><br><span class="line">a.literalData,b):a.complexData?<span class="keyword">this</span>.writeNode(<span class="string">"wps:ComplexData"</span>,a.complexData,b):a.boundingBoxData&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"ows:BoundingBox"</span>,a.boundingBoxData,b);<span class="keyword">return</span> b&#125;,<span class="attr">LiteralData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"wps:LiteralData"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">uom</span>:a.uom&#125;,<span class="attr">value</span>:a.value&#125;)&#125;,<span class="attr">ComplexData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wps:ComplexData"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">mimeType</span>:a.mimeType,<span class="attr">encoding</span>:a.encoding,<span class="attr">schema</span>:a.schema&#125;&#125;),c=a.value;<span class="string">"string"</span>===<span class="keyword">typeof</span> c?b.appendChild(<span class="keyword">this</span>.getXMLDoc().createCDATASection(a.value)):</span><br><span class="line">b.appendChild(c);<span class="keyword">return</span> b&#125;,<span class="attr">Reference</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wps:Reference"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">mimeType</span>:a.mimeType,<span class="string">"xlink:href"</span>:a.href,<span class="attr">method</span>:a.method,<span class="attr">encoding</span>:a.encoding,<span class="attr">schema</span>:a.schema&#125;&#125;);a.body&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"wps:Body"</span>,a.body,b);<span class="keyword">return</span> b&#125;,<span class="attr">BoundingBoxData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.writers.ows.BoundingBox.apply(<span class="keyword">this</span>,[a,b,<span class="string">"wps:BoundingBoxData"</span>])&#125;,<span class="attr">Body</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"wps:Body"</span>,&#123;&#125;);a.wcs?<span class="keyword">this</span>.writeNode(<span class="string">"wcs:GetCoverage"</span>,a.wcs,b):a.wfs?(<span class="keyword">this</span>.featureType=a.wfs.featureType,</span><br><span class="line"><span class="keyword">this</span>.version=a.wfs.version,<span class="keyword">this</span>.writeNode(<span class="string">"wfs:GetFeature"</span>,a.wfs,b)):<span class="keyword">this</span>.writeNode(<span class="string">"wps:Execute"</span>,a,b);<span class="keyword">return</span> b&#125;&#125;,<span class="attr">wcs</span>:OpenLayers.Format.WCSGetCoverage.prototype.writers.wcs,<span class="attr">wfs</span>:OpenLayers.Format.WFST.v1_1_0.prototype.writers.wfs,<span class="attr">ogc</span>:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc,<span class="attr">ows</span>:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows&#125;,<span class="attr">readers</span>:&#123;<span class="attr">wps</span>:&#123;<span class="attr">ExecuteResponse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.executeResponse=&#123;<span class="attr">lang</span>:a.getAttribute(<span class="string">"lang"</span>),<span class="attr">statusLocation</span>:a.getAttribute(<span class="string">"statusLocation"</span>),<span class="attr">serviceInstance</span>:a.getAttribute(<span class="string">"serviceInstance"</span>),</span><br><span class="line">service:a.getAttribute(<span class="string">"service"</span>)&#125;;<span class="keyword">this</span>.readChildNodes(a,b.executeResponse)&#125;,<span class="attr">Process</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.process=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.process)&#125;,<span class="attr">Status</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.status=&#123;<span class="attr">creationTime</span>:a.getAttribute(<span class="string">"creationTime"</span>)&#125;;<span class="keyword">this</span>.readChildNodes(a,b.status)&#125;,<span class="attr">ProcessSucceeded</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.processSucceeded=!<span class="number">0</span>&#125;,<span class="attr">ProcessOutputs</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.processOutputs=[];<span class="keyword">this</span>.readChildNodes(a,b.processOutputs)&#125;,<span class="attr">Output</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.push(c)&#125;,<span class="attr">Reference</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.reference=</span><br><span class="line">&#123;<span class="attr">href</span>:a.getAttribute(<span class="string">"href"</span>),<span class="attr">mimeType</span>:a.getAttribute(<span class="string">"mimeType"</span>),<span class="attr">encoding</span>:a.getAttribute(<span class="string">"encoding"</span>),<span class="attr">schema</span>:a.getAttribute(<span class="string">"schema"</span>)&#125;&#125;,<span class="attr">Data</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.data=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">LiteralData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.literalData=&#123;<span class="attr">dataType</span>:a.getAttribute(<span class="string">"dataType"</span>),<span class="attr">uom</span>:a.getAttribute(<span class="string">"uom"</span>),<span class="attr">value</span>:<span class="keyword">this</span>.getChildValue(a)&#125;&#125;,<span class="attr">ComplexData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.complexData=&#123;<span class="attr">mimeType</span>:a.getAttribute(<span class="string">"mimeType"</span>),<span class="attr">schema</span>:a.getAttribute(<span class="string">"schema"</span>),<span class="attr">encoding</span>:a.getAttribute(<span class="string">"encoding"</span>),<span class="attr">value</span>:<span class="string">""</span>&#125;;<span class="keyword">if</span>(<span class="keyword">this</span>.isSimpleContent(a))&#123;<span class="keyword">var</span> c;</span><br><span class="line"><span class="keyword">for</span>(c=a.firstChild;c;c=c.nextSibling)<span class="keyword">switch</span>(c.nodeType)&#123;<span class="keyword">case</span> <span class="number">3</span>:<span class="keyword">case</span> <span class="number">4</span>:b.complexData.value+=c.nodeValue&#125;&#125;<span class="keyword">else</span> <span class="keyword">for</span>(c=a.firstChild;c;c=c.nextSibling)<span class="number">1</span>==c.nodeType&amp;&amp;(b.complexData.value=c)&#125;,<span class="attr">BoundingBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.boundingBoxData=&#123;<span class="attr">dimensions</span>:a.getAttribute(<span class="string">"dimensions"</span>),<span class="attr">crs</span>:a.getAttribute(<span class="string">"crs"</span>)&#125;;<span class="keyword">this</span>.readChildNodes(a,b.boundingBoxData)&#125;&#125;,<span class="attr">ows</span>:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WPSExecute"</span>&#125;);OpenLayers.Layer.GeoRSS=OpenLayers.Class(OpenLayers.Layer.Markers,&#123;<span class="attr">location</span>:<span class="literal">null</span>,<span class="attr">features</span>:<span class="literal">null</span>,<span class="attr">formatOptions</span>:<span class="literal">null</span>,<span class="attr">selectedFeature</span>:<span class="literal">null</span>,<span class="attr">icon</span>:<span class="literal">null</span>,<span class="attr">popupSize</span>:<span class="literal">null</span>,<span class="attr">useFeedTitle</span>:!<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Layer.Markers.prototype.initialize.apply(<span class="keyword">this</span>,[a,c]);<span class="keyword">this</span>.location=b;<span class="keyword">this</span>.features=[]&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Layer.Markers.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.clearFeatures();<span class="keyword">this</span>.features=<span class="literal">null</span>&#125;,<span class="attr">loadRSS</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.loaded||(<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loadstart"</span>),OpenLayers.Request.GET(&#123;<span class="attr">url</span>:<span class="keyword">this</span>.location,</span><br><span class="line">success:<span class="keyword">this</span>.parseData,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;),<span class="keyword">this</span>.loaded=!<span class="number">0</span>)&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Layer.Markers.prototype.moveTo.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.visibility&amp;&amp;!<span class="keyword">this</span>.loaded&amp;&amp;<span class="keyword">this</span>.loadRSS()&#125;,<span class="attr">parseData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.responseXML;b&amp;&amp;b.documentElement||(b=OpenLayers.Format.XML.prototype.read(a.responseText));<span class="keyword">if</span>(<span class="keyword">this</span>.useFeedTitle)&#123;a=<span class="literal">null</span>;<span class="keyword">try</span>&#123;a=b.getElementsByTagNameNS(<span class="string">"*"</span>,<span class="string">"title"</span>)[<span class="number">0</span>].firstChild.nodeValue&#125;<span class="keyword">catch</span>(c)&#123;a=b.getElementsByTagName(<span class="string">"title"</span>)[<span class="number">0</span>].firstChild.nodeValue&#125;a&amp;&amp;<span class="keyword">this</span>.setName(a)&#125;a=&#123;&#125;;OpenLayers.Util.extend(a,</span><br><span class="line"><span class="keyword">this</span>.formatOptions);<span class="keyword">this</span>.map&amp;&amp;!<span class="keyword">this</span>.projection.equals(<span class="keyword">this</span>.map.getProjectionObject())&amp;&amp;(a.externalProjection=<span class="keyword">this</span>.projection,a.internalProjection=<span class="keyword">this</span>.map.getProjectionObject());b=(<span class="keyword">new</span> OpenLayers.Format.GeoRSS(a)).read(b);a=<span class="number">0</span>;<span class="keyword">for</span>(<span class="keyword">var</span> d=b.length;a&lt;d;a++)&#123;<span class="keyword">var</span> e=&#123;&#125;,f=b[a];<span class="keyword">if</span>(f.geometry)&#123;<span class="keyword">var</span> g=f.attributes.title?f.attributes.title:<span class="string">"Untitled"</span>,h=f.attributes.description?f.attributes.description:<span class="string">"No description."</span>,k=f.attributes.link?f.attributes.link:<span class="string">""</span>,f=f.geometry.getBounds().getCenterLonLat();e.icon=</span><br><span class="line"><span class="literal">null</span>==<span class="keyword">this</span>.icon?OpenLayers.Marker.defaultIcon():<span class="keyword">this</span>.icon.clone();e.popupSize=<span class="keyword">this</span>.popupSize?<span class="keyword">this</span>.popupSize.clone():<span class="keyword">new</span> OpenLayers.Size(<span class="number">250</span>,<span class="number">120</span>);<span class="keyword">if</span>(g||h)&#123;e.title=g;e.description=h;<span class="keyword">var</span> l=<span class="string">'&lt;div class="olLayerGeoRSSClose"&gt;[x]&lt;/div&gt;'</span>,l=l+<span class="string">'&lt;div class="olLayerGeoRSSTitle"&gt;'</span>;k&amp;&amp;(l+=<span class="string">'&lt;a class="link" href="'</span>+k+<span class="string">'" target="_blank"&gt;'</span>);l+=g;k&amp;&amp;(l+=<span class="string">"&lt;/a&gt;"</span>);l+=<span class="string">"&lt;/div&gt;"</span>;l+=<span class="string">'&lt;div style="" class="olLayerGeoRSSDescription"&gt;'</span>;l+=h;l+=<span class="string">"&lt;/div&gt;"</span>;e.popupContentHTML=l&#125;f=<span class="keyword">new</span> OpenLayers.Feature(<span class="keyword">this</span>,f,e);<span class="keyword">this</span>.features.push(f);</span><br><span class="line">e=f.createMarker();e.events.register(<span class="string">"click"</span>,f,<span class="keyword">this</span>.markerClick);<span class="keyword">this</span>.addMarker(e)&#125;&#125;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loadend"</span>)&#125;,<span class="attr">markerClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>==<span class="keyword">this</span>.layer.selectedFeature;<span class="keyword">this</span>.layer.selectedFeature=b?<span class="literal">null</span>:<span class="keyword">this</span>;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.layer.map.popups.length;c&lt;d;c++)<span class="keyword">this</span>.layer.map.removePopup(<span class="keyword">this</span>.layer.map.popups[c]);b||(b=<span class="keyword">this</span>.createPopup(),OpenLayers.Event.observe(b.div,<span class="string">"click"</span>,OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="keyword">this</span>.layer.map.popups.length;a&lt;b;a++)<span class="keyword">this</span>.layer.map.removePopup(<span class="keyword">this</span>.layer.map.popups[a])&#125;,</span><br><span class="line"><span class="keyword">this</span>)),<span class="keyword">this</span>.layer.map.addPopup(b));OpenLayers.Event.stop(a)&#125;,<span class="attr">clearFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.features)<span class="keyword">for</span>(;<span class="number">0</span>&lt;<span class="keyword">this</span>.features.length;)&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.features[<span class="number">0</span>];OpenLayers.Util.removeItem(<span class="keyword">this</span>.features,a);a.destroy()&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.GeoRSS"</span>&#125;);OpenLayers.Symbolizer.Point=OpenLayers.Class(OpenLayers.Symbolizer,&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Symbolizer.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Symbolizer.Point"</span>&#125;);OpenLayers.Symbolizer.Line=OpenLayers.Class(OpenLayers.Symbolizer,&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Symbolizer.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Symbolizer.Line"</span>&#125;);OpenLayers.Symbolizer.Text=OpenLayers.Class(OpenLayers.Symbolizer,&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Symbolizer.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Symbolizer.Text"</span>&#125;);OpenLayers.Format.SLD.v1=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">sld</span>:<span class="string">"http://www.opengis.net/sld"</span>,<span class="attr">ogc</span>:<span class="string">"http://www.opengis.net/ogc"</span>,<span class="attr">gml</span>:<span class="string">"http://www.opengis.net/gml"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&#125;,<span class="attr">defaultPrefix</span>:<span class="string">"sld"</span>,<span class="attr">schemaLocation</span>:<span class="literal">null</span>,<span class="attr">multipleSymbolizers</span>:!<span class="number">1</span>,<span class="attr">featureTypeCounter</span>:<span class="literal">null</span>,<span class="attr">defaultSymbolizer</span>:&#123;<span class="attr">fillColor</span>:<span class="string">"#808080"</span>,<span class="attr">fillOpacity</span>:<span class="number">1</span>,<span class="attr">strokeColor</span>:<span class="string">"#000000"</span>,<span class="attr">strokeOpacity</span>:<span class="number">1</span>,<span class="attr">strokeWidth</span>:<span class="number">1</span>,<span class="attr">strokeDashstyle</span>:<span class="string">"solid"</span>,<span class="attr">pointRadius</span>:<span class="number">3</span>,</span><br><span class="line">graphicName:<span class="string">"square"</span>&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=OpenLayers.Util.applyDefaults(b,<span class="keyword">this</span>.options);<span class="keyword">var</span> c=&#123;<span class="attr">namedLayers</span>:!<span class="number">0</span>===b.namedLayersAsArray?[]:&#123;&#125;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">return</span> c&#125;,<span class="attr">readers</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">sld</span>:&#123;<span class="attr">StyledLayerDescriptor</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.version=a.getAttribute(<span class="string">"version"</span>);<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.name=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Title</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.title=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Abstract</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.description=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">NamedLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=</span><br><span class="line">&#123;<span class="attr">userStyles</span>:[],<span class="attr">namedStyles</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e=c.userStyles.length;d&lt;e;++d)c.userStyles[d].layerName=c.name;OpenLayers.Util.isArray(b.namedLayers)?b.namedLayers.push(c):b.namedLayers[c.name]=c&#125;,<span class="attr">NamedStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.namedStyles.push(<span class="keyword">this</span>.getChildName(a.firstChild))&#125;,<span class="attr">UserStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">defaultsPerSymbolizer</span>:!<span class="number">0</span>,<span class="attr">rules</span>:[]&#125;;<span class="keyword">this</span>.featureTypeCounter=<span class="number">-1</span>;<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">this</span>.multipleSymbolizers?(<span class="keyword">delete</span> c.defaultsPerSymbolizer,c=<span class="keyword">new</span> OpenLayers.Style2(c)):c=<span class="keyword">new</span> OpenLayers.Style(<span class="keyword">this</span>.defaultSymbolizer,</span><br><span class="line">c);b.userStyles.push(c)&#125;,<span class="attr">IsDefault</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="string">"1"</span>==<span class="keyword">this</span>.getChildValue(a)&amp;&amp;(b.isDefault=!<span class="number">0</span>)&#125;,<span class="attr">FeatureTypeStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;++<span class="keyword">this</span>.featureTypeCounter;<span class="keyword">var</span> c=&#123;<span class="attr">rules</span>:<span class="keyword">this</span>.multipleSymbolizers?b.rules:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">this</span>.multipleSymbolizers||(b.rules=c.rules)&#125;,<span class="attr">Rule</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c;<span class="keyword">this</span>.multipleSymbolizers&amp;&amp;(c=&#123;<span class="attr">symbolizers</span>:[]&#125;);c=<span class="keyword">new</span> OpenLayers.Rule(c);<span class="keyword">this</span>.readChildNodes(a,c);b.rules.push(c)&#125;,<span class="attr">ElseFilter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.elseFilter=!<span class="number">0</span>&#125;,<span class="attr">MinScaleDenominator</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.minScaleDenominator=</span><br><span class="line"><span class="built_in">parseFloat</span>(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">MaxScaleDenominator</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.maxScaleDenominator=<span class="built_in">parseFloat</span>(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">TextSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">this</span>.multipleSymbolizers?(c.zIndex=<span class="keyword">this</span>.featureTypeCounter,b.symbolizers.push(<span class="keyword">new</span> OpenLayers.Symbolizer.Text(c))):b.symbolizer.Text=OpenLayers.Util.applyDefaults(c,b.symbolizer.Text)&#125;,<span class="attr">LabelPlacement</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">PointPlacement</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);c.labelRotation=</span><br><span class="line">c.rotation;<span class="keyword">delete</span> c.rotation;<span class="keyword">var</span> d,e=b.labelAnchorPointX,f=b.labelAnchorPointY;e&lt;=<span class="number">1</span>/<span class="number">3</span>?d=<span class="string">"l"</span>:e&gt;<span class="number">1</span>/<span class="number">3</span>&amp;&amp;e&lt;<span class="number">2</span>/<span class="number">3</span>?d=<span class="string">"c"</span>:e&gt;=<span class="number">2</span>/<span class="number">3</span>&amp;&amp;(d=<span class="string">"r"</span>);f&lt;=<span class="number">1</span>/<span class="number">3</span>?d+=<span class="string">"b"</span>:f&gt;<span class="number">1</span>/<span class="number">3</span>&amp;&amp;f&lt;<span class="number">2</span>/<span class="number">3</span>?d+=<span class="string">"m"</span>:f&gt;=<span class="number">2</span>/<span class="number">3</span>&amp;&amp;(d+=<span class="string">"t"</span>);c.labelAlign=d;OpenLayers.Util.applyDefaults(b,c)&#125;,<span class="attr">AnchorPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">AnchorPointX</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,a);c&amp;&amp;(b.labelAnchorPointX=c)&#125;,<span class="attr">AnchorPointY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,a);c&amp;&amp;(b.labelAnchorPointY=c)&#125;,<span class="attr">Displacement</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">DisplacementX</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,a);c&amp;&amp;(b.labelXOffset=c)&#125;,<span class="attr">DisplacementY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,a);c&amp;&amp;(b.labelYOffset=c)&#125;,<span class="attr">LinePlacement</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">PerpendicularOffset</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,a);c&amp;&amp;(b.labelPerpendicularOffset=c)&#125;,<span class="attr">Label</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,a);c&amp;&amp;(b.label=c)&#125;,<span class="attr">Font</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,</span><br><span class="line">b)&#125;,<span class="attr">Halo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.haloRadius=c.haloRadius;b.haloColor=c.fillColor;b.haloOpacity=c.fillOpacity&#125;,<span class="attr">Radius</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,a);<span class="literal">null</span>!=c&amp;&amp;(b.haloRadius=c)&#125;,<span class="attr">RasterSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">this</span>.multipleSymbolizers?(c.zIndex=<span class="keyword">this</span>.featureTypeCounter,b.symbolizers.push(<span class="keyword">new</span> OpenLayers.Symbolizer.Raster(c))):b.symbolizer.Raster=OpenLayers.Util.applyDefaults(c,b.symbolizer.Raster)&#125;,<span class="attr">Geometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.geometry=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.geometry)&#125;,<span class="attr">ColorMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.colorMap=[];<span class="keyword">this</span>.readChildNodes(a,b.colorMap)&#125;,<span class="attr">ColorMapEntry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.getAttribute(<span class="string">"quantity"</span>),d=a.getAttribute(<span class="string">"opacity"</span>);b.push(&#123;<span class="attr">color</span>:a.getAttribute(<span class="string">"color"</span>),<span class="attr">quantity</span>:<span class="literal">null</span>!==c?<span class="built_in">parseFloat</span>(c):<span class="keyword">void</span> <span class="number">0</span>,<span class="attr">label</span>:a.getAttribute(<span class="string">"label"</span>)||<span class="keyword">void</span> <span class="number">0</span>,<span class="attr">opacity</span>:<span class="literal">null</span>!==d?<span class="built_in">parseFloat</span>(d):<span class="keyword">void</span> <span class="number">0</span>&#125;)&#125;,<span class="attr">LineSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">this</span>.multipleSymbolizers?(c.zIndex=<span class="keyword">this</span>.featureTypeCounter,b.symbolizers.push(<span class="keyword">new</span> OpenLayers.Symbolizer.Line(c))):</span><br><span class="line">b.symbolizer.Line=OpenLayers.Util.applyDefaults(c,b.symbolizer.Line)&#125;,<span class="attr">PolygonSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">fill</span>:!<span class="number">1</span>,<span class="attr">stroke</span>:!<span class="number">1</span>&#125;;<span class="keyword">this</span>.multipleSymbolizers||(c=b.symbolizer.Polygon||c);<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">this</span>.multipleSymbolizers?(c.zIndex=<span class="keyword">this</span>.featureTypeCounter,b.symbolizers.push(<span class="keyword">new</span> OpenLayers.Symbolizer.Polygon(c))):b.symbolizer.Polygon=c&#125;,<span class="attr">PointSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">fill</span>:!<span class="number">1</span>,<span class="attr">stroke</span>:!<span class="number">1</span>,<span class="attr">graphic</span>:!<span class="number">1</span>&#125;;<span class="keyword">this</span>.multipleSymbolizers||(c=b.symbolizer.Point||c);<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">this</span>.multipleSymbolizers?</span><br><span class="line">(c.zIndex=<span class="keyword">this</span>.featureTypeCounter,b.symbolizers.push(<span class="keyword">new</span> OpenLayers.Symbolizer.Point(c))):b.symbolizer.Point=c&#125;,<span class="attr">Stroke</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.stroke=!<span class="number">0</span>;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Fill</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.fill=!<span class="number">0</span>;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">CssParameter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.getAttribute(<span class="string">"name"</span>),d=<span class="keyword">this</span>.cssMap[c];b.label&amp;&amp;(<span class="string">"fill"</span>===c?d=<span class="string">"fontColor"</span>:<span class="string">"fill-opacity"</span>===c&amp;&amp;(d=<span class="string">"fontOpacity"</span>));d&amp;&amp;(c=<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,a))&amp;&amp;(b[d]=c)&#125;,<span class="attr">Graphic</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.graphic=!<span class="number">0</span>;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="string">"stroke strokeColor strokeWidth strokeOpacity strokeLinecap fill fillColor fillOpacity graphicName rotation graphicFormat"</span>.split(<span class="string">" "</span>),e,f,g=<span class="number">0</span>,h=d.length;g&lt;h;++g)e=d[g],f=c[e],<span class="keyword">void</span> <span class="number">0</span>!=f&amp;&amp;(b[e]=f);<span class="keyword">void</span> <span class="number">0</span>!=c.opacity&amp;&amp;(b.graphicOpacity=c.opacity);<span class="keyword">void</span> <span class="number">0</span>!=c.size&amp;&amp;(<span class="built_in">isNaN</span>(c.size/<span class="number">2</span>)?b.graphicWidth=c.size:b.pointRadius=c.size/<span class="number">2</span>);<span class="keyword">void</span> <span class="number">0</span>!=c.href&amp;&amp;(b.externalGraphic=c.href);<span class="keyword">void</span> <span class="number">0</span>!=c.rotation&amp;&amp;(b.rotation=c.rotation)&#125;,<span class="attr">ExternalGraphic</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Mark</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,</span><br><span class="line">b)&#125;,<span class="attr">WellKnownName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.graphicName=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Opacity</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,a);c&amp;&amp;(b.opacity=c)&#125;,<span class="attr">Size</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,a);c&amp;&amp;(b.size=c)&#125;,<span class="attr">Rotation</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,a);c&amp;&amp;(b.rotation=c)&#125;,<span class="attr">OnlineResource</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.href=<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.xlink,<span class="string">"href"</span>)&#125;,<span class="attr">Format</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.graphicFormat=<span class="keyword">this</span>.getChildValue(a)&#125;&#125;&#125;,OpenLayers.Format.Filter.v1_0_0.prototype.readers),</span><br><span class="line">cssMap:&#123;<span class="attr">stroke</span>:<span class="string">"strokeColor"</span>,<span class="string">"stroke-opacity"</span>:<span class="string">"strokeOpacity"</span>,<span class="string">"stroke-width"</span>:<span class="string">"strokeWidth"</span>,<span class="string">"stroke-linecap"</span>:<span class="string">"strokeLinecap"</span>,<span class="string">"stroke-dasharray"</span>:<span class="string">"strokeDashstyle"</span>,<span class="attr">fill</span>:<span class="string">"fillColor"</span>,<span class="string">"fill-opacity"</span>:<span class="string">"fillOpacity"</span>,<span class="string">"font-family"</span>:<span class="string">"fontFamily"</span>,<span class="string">"font-size"</span>:<span class="string">"fontSize"</span>,<span class="string">"font-weight"</span>:<span class="string">"fontWeight"</span>,<span class="string">"font-style"</span>:<span class="string">"fontStyle"</span>&#125;,<span class="attr">getCssProperty</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>,c;<span class="keyword">for</span>(c <span class="keyword">in</span> <span class="keyword">this</span>.cssMap)<span class="keyword">if</span>(<span class="keyword">this</span>.cssMap[c]==a)&#123;b=c;<span class="keyword">break</span>&#125;<span class="keyword">return</span> b&#125;,<span class="attr">getGraphicFormat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c;<span class="keyword">for</span>(c <span class="keyword">in</span> <span class="keyword">this</span>.graphicFormats)<span class="keyword">if</span>(<span class="keyword">this</span>.graphicFormats[c].test(a))&#123;b=</span><br><span class="line">c;<span class="keyword">break</span>&#125;<span class="keyword">return</span> b||<span class="keyword">this</span>.defaultGraphicFormat&#125;,<span class="attr">defaultGraphicFormat</span>:<span class="string">"image/png"</span>,<span class="attr">graphicFormats</span>:&#123;<span class="string">"image/jpeg"</span>:<span class="regexp">/\.jpe?g$/i</span>,<span class="string">"image/gif"</span>:<span class="regexp">/\.gif$/i</span>,<span class="string">"image/png"</span>:<span class="regexp">/\.png$/i</span>&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.writers.sld.StyledLayerDescriptor.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">writers</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">sld</span>:&#123;<span class="attr">_OGCExpression</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementNSPlus(a),d=<span class="string">"string"</span>==<span class="keyword">typeof</span> b?b.split(<span class="string">"$&#123;"</span>):[b];c.appendChild(<span class="keyword">this</span>.createTextNode(d[<span class="number">0</span>]));<span class="keyword">for</span>(<span class="keyword">var</span> e,f,g=<span class="number">1</span>,h=d.length;g&lt;h;g++)e=d[g],f=e.indexOf(<span class="string">"&#125;"</span>),<span class="number">0</span>&lt;f?(<span class="keyword">this</span>.writeNode(<span class="string">"ogc:PropertyName"</span>,</span><br><span class="line">&#123;<span class="attr">property</span>:e.substring(<span class="number">0</span>,f)&#125;,c),c.appendChild(<span class="keyword">this</span>.createTextNode(e.substring(++f)))):c.appendChild(<span class="keyword">this</span>.createTextNode(<span class="string">"$&#123;"</span>+e));<span class="keyword">return</span> c&#125;,<span class="attr">StyledLayerDescriptor</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:StyledLayerDescriptor"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">version</span>:<span class="keyword">this</span>.VERSION,<span class="string">"xsi:schemaLocation"</span>:<span class="keyword">this</span>.schemaLocation&#125;&#125;);b.setAttribute(<span class="string">"xmlns:ogc"</span>,<span class="keyword">this</span>.namespaces.ogc);b.setAttribute(<span class="string">"xmlns:gml"</span>,<span class="keyword">this</span>.namespaces.gml);a.name&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Name"</span>,a.name,b);a.title&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Title"</span>,a.title,b);a.description&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.writeNode(<span class="string">"Abstract"</span>,a.description,b);<span class="keyword">if</span>(OpenLayers.Util.isArray(a.namedLayers))<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.namedLayers.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"NamedLayer"</span>,a.namedLayers[c],b);<span class="keyword">else</span> <span class="keyword">for</span>(c <span class="keyword">in</span> a.namedLayers)<span class="keyword">this</span>.writeNode(<span class="string">"NamedLayer"</span>,a.namedLayers[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">Name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Name"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">Title</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Title"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">Abstract</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Abstract"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">NamedLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:NamedLayer"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"Name"</span>,a.name,b);<span class="keyword">if</span>(a.namedStyles)<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.namedStyles.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"NamedStyle"</span>,a.namedStyles[c],b);<span class="keyword">if</span>(a.userStyles)<span class="keyword">for</span>(c=<span class="number">0</span>,d=a.userStyles.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"UserStyle"</span>,a.userStyles[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">NamedStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:NamedStyle"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"Name"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">UserStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:UserStyle"</span>);a.name&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Name"</span>,</span><br><span class="line">a.name,b);a.title&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Title"</span>,a.title,b);a.description&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Abstract"</span>,a.description,b);a.isDefault&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"IsDefault"</span>,a.isDefault,b);<span class="keyword">if</span>(<span class="keyword">this</span>.multipleSymbolizers&amp;&amp;a.rules)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=&#123;<span class="number">0</span>:[]&#125;,d=[<span class="number">0</span>],e,f,g,h,k,l=<span class="number">0</span>,m=a.rules.length;l&lt;m;++l)<span class="keyword">if</span>(e=a.rules[l],e.symbolizers)&#123;f=&#123;&#125;;<span class="keyword">for</span>(<span class="keyword">var</span> n=<span class="number">0</span>,p=e.symbolizers.length;n&lt;p;++n)g=e.symbolizers[n],h=g.zIndex,h <span class="keyword">in</span> f||(k=e.clone(),k.symbolizers=[],f[h]=k),f[h].symbolizers.push(g.clone());<span class="keyword">for</span>(h <span class="keyword">in</span> f)h <span class="keyword">in</span> c||(d.push(h),c[h]=[]),c[h].push(f[h])&#125;<span class="keyword">else</span> c[<span class="number">0</span>].push(e.clone());</span><br><span class="line">d.sort();l=<span class="number">0</span>;<span class="keyword">for</span>(m=d.length;l&lt;m;++l)e=c[d[l]],<span class="number">0</span>&lt;e.length&amp;&amp;(k=a.clone(),k.rules=c[d[l]],<span class="keyword">this</span>.writeNode(<span class="string">"FeatureTypeStyle"</span>,k,b))&#125;<span class="keyword">else</span> <span class="keyword">this</span>.writeNode(<span class="string">"FeatureTypeStyle"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">IsDefault</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:IsDefault"</span>,&#123;<span class="attr">value</span>:a?<span class="string">"1"</span>:<span class="string">"0"</span>&#125;)&#125;,<span class="attr">FeatureTypeStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:FeatureTypeStyle"</span>),c=<span class="number">0</span>,d=a.rules.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"Rule"</span>,a.rules[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">Rule</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Rule"</span>);a.name&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.writeNode(<span class="string">"Name"</span>,a.name,b);a.title&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Title"</span>,a.title,b);a.description&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Abstract"</span>,a.description,b);a.elseFilter?<span class="keyword">this</span>.writeNode(<span class="string">"ElseFilter"</span>,<span class="literal">null</span>,b):a.filter&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"ogc:Filter"</span>,a.filter,b);<span class="keyword">void</span> <span class="number">0</span>!=a.minScaleDenominator&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"MinScaleDenominator"</span>,a.minScaleDenominator,b);<span class="keyword">void</span> <span class="number">0</span>!=a.maxScaleDenominator&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"MaxScaleDenominator"</span>,a.maxScaleDenominator,b);<span class="keyword">var</span> c,d;<span class="keyword">if</span>(<span class="keyword">this</span>.multipleSymbolizers&amp;&amp;a.symbolizers)<span class="keyword">for</span>(<span class="keyword">var</span> e=<span class="number">0</span>,f=a.symbolizers.length;e&lt;</span><br><span class="line">f;++e)d=a.symbolizers[e],c=d.CLASS_NAME.split(<span class="string">"."</span>).pop(),<span class="keyword">this</span>.writeNode(c+<span class="string">"Symbolizer"</span>,d,b);<span class="keyword">else</span> <span class="keyword">for</span>(<span class="keyword">var</span> f=OpenLayers.Style.SYMBOLIZER_PREFIXES,e=<span class="number">0</span>,g=f.length;e&lt;g;++e)c=f[e],(d=a.symbolizer[c])&amp;&amp;<span class="keyword">this</span>.writeNode(c+<span class="string">"Symbolizer"</span>,d,b);<span class="keyword">return</span> b&#125;,<span class="attr">ElseFilter</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:ElseFilter"</span>)&#125;,<span class="attr">MinScaleDenominator</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:MinScaleDenominator"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">MaxScaleDenominator</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:MaxScaleDenominator"</span>,</span><br><span class="line">&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">LineSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:LineSymbolizer"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"Stroke"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">Stroke</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Stroke"</span>);<span class="keyword">void</span> <span class="number">0</span>!=a.strokeColor&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"CssParameter"</span>,&#123;<span class="attr">symbolizer</span>:a,<span class="attr">key</span>:<span class="string">"strokeColor"</span>&#125;,b);<span class="keyword">void</span> <span class="number">0</span>!=a.strokeOpacity&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"CssParameter"</span>,&#123;<span class="attr">symbolizer</span>:a,<span class="attr">key</span>:<span class="string">"strokeOpacity"</span>&#125;,b);<span class="keyword">void</span> <span class="number">0</span>!=a.strokeWidth&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"CssParameter"</span>,&#123;<span class="attr">symbolizer</span>:a,<span class="attr">key</span>:<span class="string">"strokeWidth"</span>&#125;,b);<span class="keyword">void</span> <span class="number">0</span>!=a.strokeDashstyle&amp;&amp;<span class="string">"solid"</span>!==</span><br><span class="line">a.strokeDashstyle&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"CssParameter"</span>,&#123;<span class="attr">symbolizer</span>:a,<span class="attr">key</span>:<span class="string">"strokeDashstyle"</span>&#125;,b);<span class="keyword">void</span> <span class="number">0</span>!=a.strokeLinecap&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"CssParameter"</span>,&#123;<span class="attr">symbolizer</span>:a,<span class="attr">key</span>:<span class="string">"strokeLinecap"</span>&#125;,b);<span class="keyword">return</span> b&#125;,<span class="attr">CssParameter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:CssParameter"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">name</span>:<span class="keyword">this</span>.getCssProperty(a.key)&#125;,<span class="attr">value</span>:a.symbolizer[a.key]&#125;)&#125;,<span class="attr">TextSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:TextSymbolizer"</span>);<span class="literal">null</span>!=a.label&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Label"</span>,a.label,b);<span class="literal">null</span>==a.fontFamily&amp;&amp;<span class="literal">null</span>==a.fontSize&amp;&amp;</span><br><span class="line"><span class="literal">null</span>==a.fontWeight&amp;&amp;<span class="literal">null</span>==a.fontStyle||<span class="keyword">this</span>.writeNode(<span class="string">"Font"</span>,a,b);<span class="literal">null</span>==a.labelAnchorPointX&amp;&amp;<span class="literal">null</span>==a.labelAnchorPointY&amp;&amp;<span class="literal">null</span>==a.labelAlign&amp;&amp;<span class="literal">null</span>==a.labelXOffset&amp;&amp;<span class="literal">null</span>==a.labelYOffset&amp;&amp;<span class="literal">null</span>==a.labelRotation&amp;&amp;<span class="literal">null</span>==a.labelPerpendicularOffset||<span class="keyword">this</span>.writeNode(<span class="string">"LabelPlacement"</span>,a,b);<span class="literal">null</span>==a.haloRadius&amp;&amp;<span class="literal">null</span>==a.haloColor&amp;&amp;<span class="literal">null</span>==a.haloOpacity||<span class="keyword">this</span>.writeNode(<span class="string">"Halo"</span>,a,b);<span class="literal">null</span>==a.fontColor&amp;&amp;<span class="literal">null</span>==a.fontOpacity||<span class="keyword">this</span>.writeNode(<span class="string">"Fill"</span>,&#123;<span class="attr">fillColor</span>:a.fontColor,<span class="attr">fillOpacity</span>:a.fontOpacity&#125;,b);<span class="keyword">return</span> b&#125;,<span class="attr">LabelPlacement</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:LabelPlacement"</span>);<span class="literal">null</span>==a.labelAnchorPointX&amp;&amp;<span class="literal">null</span>==a.labelAnchorPointY&amp;&amp;<span class="literal">null</span>==a.labelAlign&amp;&amp;<span class="literal">null</span>==a.labelXOffset&amp;&amp;<span class="literal">null</span>==a.labelYOffset&amp;&amp;<span class="literal">null</span>==a.labelRotation||<span class="literal">null</span>!=a.labelPerpendicularOffset||<span class="keyword">this</span>.writeNode(<span class="string">"PointPlacement"</span>,a,b);<span class="literal">null</span>!=a.labelPerpendicularOffset&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"LinePlacement"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">LinePlacement</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:LinePlacement"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"PerpendicularOffset"</span>,a.labelPerpendicularOffset,b);<span class="keyword">return</span> b&#125;,<span class="attr">PerpendicularOffset</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:PerpendicularOffset"</span>,</span><br><span class="line">&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">PointPlacement</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:PointPlacement"</span>);<span class="literal">null</span>==a.labelAnchorPointX&amp;&amp;<span class="literal">null</span>==a.labelAnchorPointY&amp;&amp;<span class="literal">null</span>==a.labelAlign||<span class="keyword">this</span>.writeNode(<span class="string">"AnchorPoint"</span>,a,b);<span class="literal">null</span>==a.labelXOffset&amp;&amp;<span class="literal">null</span>==a.labelYOffset||<span class="keyword">this</span>.writeNode(<span class="string">"Displacement"</span>,a,b);<span class="literal">null</span>!=a.labelRotation&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Rotation"</span>,a.labelRotation,b);<span class="keyword">return</span> b&#125;,<span class="attr">AnchorPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:AnchorPoint"</span>),c=a.labelAnchorPointX,d=a.labelAnchorPointY;<span class="literal">null</span>!=c&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"AnchorPointX"</span>,</span><br><span class="line">c,b);<span class="literal">null</span>!=d&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"AnchorPointY"</span>,d,b);<span class="keyword">if</span>(<span class="literal">null</span>==c&amp;&amp;<span class="literal">null</span>==d)&#123;<span class="keyword">var</span> e=a.labelAlign.substr(<span class="number">0</span>,<span class="number">1</span>);a=a.labelAlign.substr(<span class="number">1</span>,<span class="number">1</span>);<span class="string">"l"</span>===e?c=<span class="number">0</span>:<span class="string">"c"</span>===e?c=<span class="number">0.5</span>:<span class="string">"r"</span>===e&amp;&amp;(c=<span class="number">1</span>);<span class="string">"b"</span>===a?d=<span class="number">0</span>:<span class="string">"m"</span>===a?d=<span class="number">0.5</span>:<span class="string">"t"</span>===a&amp;&amp;(d=<span class="number">1</span>);<span class="keyword">this</span>.writeNode(<span class="string">"AnchorPointX"</span>,c,b);<span class="keyword">this</span>.writeNode(<span class="string">"AnchorPointY"</span>,d,b)&#125;<span class="keyword">return</span> b&#125;,<span class="attr">AnchorPointX</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:AnchorPointX"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">AnchorPointY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:AnchorPointY"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">Displacement</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Displacement"</span>);</span><br><span class="line"><span class="literal">null</span>!=a.labelXOffset&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"DisplacementX"</span>,a.labelXOffset,b);<span class="literal">null</span>!=a.labelYOffset&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"DisplacementY"</span>,a.labelYOffset,b);<span class="keyword">return</span> b&#125;,<span class="attr">DisplacementX</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:DisplacementX"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">DisplacementY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:DisplacementY"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">Font</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Font"</span>);a.fontFamily&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"CssParameter"</span>,&#123;<span class="attr">symbolizer</span>:a,<span class="attr">key</span>:<span class="string">"fontFamily"</span>&#125;,b);a.fontSize&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"CssParameter"</span>,</span><br><span class="line">&#123;<span class="attr">symbolizer</span>:a,<span class="attr">key</span>:<span class="string">"fontSize"</span>&#125;,b);a.fontWeight&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"CssParameter"</span>,&#123;<span class="attr">symbolizer</span>:a,<span class="attr">key</span>:<span class="string">"fontWeight"</span>&#125;,b);a.fontStyle&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"CssParameter"</span>,&#123;<span class="attr">symbolizer</span>:a,<span class="attr">key</span>:<span class="string">"fontStyle"</span>&#125;,b);<span class="keyword">return</span> b&#125;,<span class="attr">Label</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.writers.sld._OGCExpression.call(<span class="keyword">this</span>,<span class="string">"sld:Label"</span>,a)&#125;,<span class="attr">Halo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Halo"</span>);a.haloRadius&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Radius"</span>,a.haloRadius,b);(a.haloColor||a.haloOpacity)&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Fill"</span>,&#123;<span class="attr">fillColor</span>:a.haloColor,<span class="attr">fillOpacity</span>:a.haloOpacity&#125;,b);</span><br><span class="line"><span class="keyword">return</span> b&#125;,<span class="attr">Radius</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Radius"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">RasterSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:RasterSymbolizer"</span>);a.geometry&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Geometry"</span>,a.geometry,b);a.opacity&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Opacity"</span>,a.opacity,b);a.colorMap&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"ColorMap"</span>,a.colorMap,b);<span class="keyword">return</span> b&#125;,<span class="attr">Geometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Geometry"</span>);a.property&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"ogc:PropertyName"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">ColorMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:ColorMap"</span>),</span><br><span class="line">c=<span class="number">0</span>,d=a.length;c&lt;d;++c)<span class="keyword">this</span>.writeNode(<span class="string">"ColorMapEntry"</span>,a[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">ColorMapEntry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:ColorMapEntry"</span>);b.setAttribute(<span class="string">"color"</span>,a.color);<span class="keyword">void</span> <span class="number">0</span>!==a.opacity&amp;&amp;b.setAttribute(<span class="string">"opacity"</span>,<span class="built_in">parseFloat</span>(a.opacity));<span class="keyword">void</span> <span class="number">0</span>!==a.quantity&amp;&amp;b.setAttribute(<span class="string">"quantity"</span>,<span class="built_in">parseFloat</span>(a.quantity));<span class="keyword">void</span> <span class="number">0</span>!==a.label&amp;&amp;b.setAttribute(<span class="string">"label"</span>,a.label);<span class="keyword">return</span> b&#125;,<span class="attr">PolygonSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:PolygonSymbolizer"</span>);!<span class="number">1</span>!==a.fill&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Fill"</span>,</span><br><span class="line">a,b);!<span class="number">1</span>!==a.stroke&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Stroke"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">Fill</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Fill"</span>);a.fillColor&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"CssParameter"</span>,&#123;<span class="attr">symbolizer</span>:a,<span class="attr">key</span>:<span class="string">"fillColor"</span>&#125;,b);<span class="literal">null</span>!=a.fillOpacity&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"CssParameter"</span>,&#123;<span class="attr">symbolizer</span>:a,<span class="attr">key</span>:<span class="string">"fillOpacity"</span>&#125;,b);<span class="keyword">return</span> b&#125;,<span class="attr">PointSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:PointSymbolizer"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"Graphic"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">Graphic</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Graphic"</span>);<span class="keyword">void</span> <span class="number">0</span>!=a.externalGraphic?</span><br><span class="line"><span class="keyword">this</span>.writeNode(<span class="string">"ExternalGraphic"</span>,a,b):<span class="keyword">this</span>.writeNode(<span class="string">"Mark"</span>,a,b);<span class="keyword">void</span> <span class="number">0</span>!=a.graphicOpacity&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Opacity"</span>,a.graphicOpacity,b);<span class="keyword">void</span> <span class="number">0</span>!=a.pointRadius?<span class="keyword">this</span>.writeNode(<span class="string">"Size"</span>,<span class="number">2</span>*a.pointRadius,b):<span class="keyword">void</span> <span class="number">0</span>!=a.graphicWidth&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Size"</span>,a.graphicWidth,b);<span class="keyword">void</span> <span class="number">0</span>!=a.rotation&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Rotation"</span>,a.rotation,b);<span class="keyword">return</span> b&#125;,<span class="attr">ExternalGraphic</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:ExternalGraphic"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"OnlineResource"</span>,a.externalGraphic,b);a=a.graphicFormat||<span class="keyword">this</span>.getGraphicFormat(a.externalGraphic);</span><br><span class="line"><span class="keyword">this</span>.writeNode(<span class="string">"Format"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">Mark</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Mark"</span>);a.graphicName&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"WellKnownName"</span>,a.graphicName,b);!<span class="number">1</span>!==a.fill&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Fill"</span>,a,b);!<span class="number">1</span>!==a.stroke&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Stroke"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">WellKnownName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:WellKnownName"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">Opacity</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Opacity"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">Size</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.writers.sld._OGCExpression.call(<span class="keyword">this</span>,<span class="string">"sld:Size"</span>,</span><br><span class="line">a)&#125;,<span class="attr">Rotation</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Rotation"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">OnlineResource</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:OnlineResource"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="string">"xlink:type"</span>:<span class="string">"simple"</span>,<span class="string">"xlink:href"</span>:a&#125;&#125;)&#125;,<span class="attr">Format</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:Format"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;&#125;&#125;,OpenLayers.Format.Filter.v1_0_0.prototype.writers),<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.SLD.v1"</span>&#125;);OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,&#123;<span class="attr">DEFAULT_PARAMS</span>:&#123;<span class="attr">service</span>:<span class="string">"WMS"</span>,<span class="attr">version</span>:<span class="string">"1.1.1"</span>,<span class="attr">request</span>:<span class="string">"GetMap"</span>,<span class="attr">styles</span>:<span class="string">""</span>,<span class="attr">format</span>:<span class="string">"image/jpeg"</span>&#125;,<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">encodeBBOX</span>:!<span class="number">1</span>,<span class="attr">noMagic</span>:!<span class="number">1</span>,<span class="attr">yx</span>:&#123;&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">var</span> e=[];c=OpenLayers.Util.upperCaseObject(c);<span class="number">1.3</span>&lt;=<span class="built_in">parseFloat</span>(c.VERSION)&amp;&amp;!c.EXCEPTIONS&amp;&amp;(c.EXCEPTIONS=<span class="string">"INIMAGE"</span>);e.push(a,b,c,d);OpenLayers.Layer.Grid.prototype.initialize.apply(<span class="keyword">this</span>,e);OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.params,OpenLayers.Util.upperCaseObject(<span class="keyword">this</span>.DEFAULT_PARAMS));</span><br><span class="line">!<span class="keyword">this</span>.noMagic&amp;&amp;(<span class="keyword">this</span>.params.TRANSPARENT&amp;&amp;<span class="string">"true"</span>==<span class="keyword">this</span>.params.TRANSPARENT.toString().toLowerCase())&amp;&amp;(<span class="literal">null</span>!=d&amp;&amp;d.isBaseLayer||(<span class="keyword">this</span>.isBaseLayer=!<span class="number">1</span>),<span class="string">"image/jpeg"</span>==<span class="keyword">this</span>.params.FORMAT&amp;&amp;(<span class="keyword">this</span>.params.FORMAT=OpenLayers.Util.alphaHack()?<span class="string">"image/gif"</span>:<span class="string">"image/png"</span>))&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.WMS(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.params,<span class="keyword">this</span>.getOptions()));<span class="keyword">return</span> a=OpenLayers.Layer.Grid.prototype.clone.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">reverseAxisOrder</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.projection.getCode();<span class="keyword">return</span> <span class="number">1.3</span>&lt;=<span class="built_in">parseFloat</span>(<span class="keyword">this</span>.params.VERSION)&amp;&amp;</span><br><span class="line">!!(<span class="keyword">this</span>.yx[a]||OpenLayers.Projection.defaults[a]&amp;&amp;OpenLayers.Projection.defaults[a].yx)&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.adjustBounds(a);<span class="keyword">var</span> b=<span class="keyword">this</span>.getImageSize(),c=&#123;&#125;,d=<span class="keyword">this</span>.reverseAxisOrder();c.BBOX=<span class="keyword">this</span>.encodeBBOX?a.toBBOX(<span class="literal">null</span>,d):a.toArray(d);c.WIDTH=b.w;c.HEIGHT=b.h;<span class="keyword">return</span> <span class="keyword">this</span>.getFullRequestString(c)&#125;,<span class="attr">mergeNewParams</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=[OpenLayers.Util.upperCaseObject(a)];<span class="keyword">return</span> OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(<span class="keyword">this</span>,a)&#125;,<span class="attr">getFullRequestString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.map.getProjectionObject(),</span><br><span class="line">c=<span class="keyword">this</span>.projection&amp;&amp;<span class="keyword">this</span>.projection.equals(c)?<span class="keyword">this</span>.projection.getCode():c.getCode(),c=<span class="string">"none"</span>==c?<span class="literal">null</span>:c;<span class="number">1.3</span>&lt;=<span class="built_in">parseFloat</span>(<span class="keyword">this</span>.params.VERSION)?<span class="keyword">this</span>.params.CRS=c:<span class="keyword">this</span>.params.SRS=c;<span class="string">"boolean"</span>==<span class="keyword">typeof</span> <span class="keyword">this</span>.params.TRANSPARENT&amp;&amp;(a.TRANSPARENT=<span class="keyword">this</span>.params.TRANSPARENT?<span class="string">"TRUE"</span>:<span class="string">"FALSE"</span>);<span class="keyword">return</span> OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.WMS"</span>&#125;);OpenLayers.Layer.KaMap=OpenLayers.Class(OpenLayers.Layer.Grid,&#123;<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">DEFAULT_PARAMS</span>:&#123;<span class="attr">i</span>:<span class="string">"jpeg"</span>,<span class="attr">map</span>:<span class="string">""</span>&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;OpenLayers.Layer.Grid.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.params=OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.params,<span class="keyword">this</span>.DEFAULT_PARAMS)&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.adjustBounds(a);<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getResolution(),c=<span class="built_in">Math</span>.round(<span class="number">1E4</span>*<span class="keyword">this</span>.map.getScale())/<span class="number">1E4</span>,d=<span class="built_in">Math</span>.round(a.left/b);a=-<span class="built_in">Math</span>.round(a.top/b);<span class="keyword">return</span> <span class="keyword">this</span>.getFullRequestString(&#123;<span class="attr">t</span>:a,<span class="attr">l</span>:d,<span class="attr">s</span>:c&#125;)&#125;,<span class="attr">calculateGridLayout</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b,c</span>)</span>&#123;b=c*<span class="keyword">this</span>.tileSize.w;c*=<span class="keyword">this</span>.tileSize.h;<span class="keyword">return</span>&#123;<span class="attr">tilelon</span>:b,<span class="attr">tilelat</span>:c,<span class="attr">startcol</span>:<span class="built_in">Math</span>.floor(a.left/b)-<span class="keyword">this</span>.buffer,<span class="attr">startrow</span>:<span class="built_in">Math</span>.floor(a.top/c)+<span class="keyword">this</span>.buffer&#125;&#125;,<span class="attr">getTileBoundsForGridIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.getTileOrigin();<span class="keyword">var</span> c=<span class="keyword">this</span>.gridLayout,d=c.tilelon,e=c.tilelat,f=(c.startcol+b)*d,c=(c.startrow-a)*e;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Bounds(f,c,f+d,c+e)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.KaMap(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.params,<span class="keyword">this</span>.getOptions()));a=OpenLayers.Layer.Grid.prototype.clone.apply(<span class="keyword">this</span>,</span><br><span class="line">[a]);<span class="literal">null</span>!=<span class="keyword">this</span>.tileSize&amp;&amp;(a.tileSize=<span class="keyword">this</span>.tileSize.clone());a.grid=[];<span class="keyword">return</span> a&#125;,<span class="attr">getTileBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getResolution(),c=b*<span class="keyword">this</span>.tileSize.w,b=b*<span class="keyword">this</span>.tileSize.h,d=<span class="keyword">this</span>.getLonLatFromViewPortPx(a);a=c*<span class="built_in">Math</span>.floor(d.lon/c);d=b*<span class="built_in">Math</span>.floor(d.lat/b);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Bounds(a,d,a+c,d+b)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.KaMap"</span>&#125;);OpenLayers.Format.WMC.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,&#123;<span class="attr">VERSION</span>:<span class="string">"1.1.0"</span>,<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.WMC.v1.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">read_sld_MinScaleDenominator</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="built_in">parseFloat</span>(<span class="keyword">this</span>.getChildValue(b));<span class="number">0</span>&lt;c&amp;&amp;(a.maxScale=c)&#125;,<span class="attr">read_sld_MaxScaleDenominator</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.minScale=<span class="built_in">parseFloat</span>(<span class="keyword">this</span>.getChildValue(b))&#125;,<span class="attr">read_wmc_SRS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="string">"srs"</span><span class="keyword">in</span></span><br><span class="line">a||(a.srs=&#123;&#125;);a.srs[<span class="keyword">this</span>.getChildValue(b)]=!<span class="number">0</span>&#125;,<span class="attr">write_wmc_Layer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(<span class="keyword">this</span>,[a]);<span class="keyword">if</span>(a.maxScale)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.sld,<span class="string">"sld:MinScaleDenominator"</span>);c.appendChild(<span class="keyword">this</span>.createTextNode(a.maxScale.toPrecision(<span class="number">16</span>)));b.appendChild(c)&#125;a.minScale&amp;&amp;(c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.namespaces.sld,<span class="string">"sld:MaxScaleDenominator"</span>),c.appendChild(<span class="keyword">this</span>.createTextNode(a.minScale.toPrecision(<span class="number">16</span>))),b.appendChild(c));<span class="keyword">if</span>(a.srs)<span class="keyword">for</span>(<span class="keyword">var</span> d <span class="keyword">in</span> a.srs)b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"SRS"</span>,</span><br><span class="line">d));b.appendChild(<span class="keyword">this</span>.write_wmc_FormatList(a));b.appendChild(<span class="keyword">this</span>.write_wmc_StyleList(a));a.dimensions&amp;&amp;b.appendChild(<span class="keyword">this</span>.write_wmc_DimensionList(a));b.appendChild(<span class="keyword">this</span>.write_wmc_LayerExtension(a));<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMC.v1_1_0"</span>&#125;);OpenLayers.Format.XLS=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,&#123;<span class="attr">defaultVersion</span>:<span class="string">"1.1.0"</span>,<span class="attr">stringifyOutput</span>:!<span class="number">0</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.XLS"</span>&#125;);OpenLayers.Format.XLS.v1=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">xls</span>:<span class="string">"http://www.opengis.net/xls"</span>,<span class="attr">gml</span>:<span class="string">"http://www.opengis.net/gml"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&#125;,<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">xy</span>:!<span class="number">0</span>,<span class="attr">defaultPrefix</span>:<span class="string">"xls"</span>,<span class="attr">schemaLocation</span>:<span class="literal">null</span>,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Util.applyDefaults(b,<span class="keyword">this</span>.options);<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">return</span> c&#125;,<span class="attr">readers</span>:&#123;<span class="attr">xls</span>:&#123;<span class="attr">XLS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.version=a.getAttribute(<span class="string">"version"</span>);</span><br><span class="line"><span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Response</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">GeocodeResponse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.responseLists=[];<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">GeocodeResponseList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">features</span>:[],<span class="attr">numberOfGeocodedAddresses</span>:<span class="built_in">parseInt</span>(a.getAttribute(<span class="string">"numberOfGeocodedAddresses"</span>))&#125;;b.responseLists.push(c);<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">GeocodedAddress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Feature.Vector;b.features.push(c);<span class="keyword">this</span>.readChildNodes(a,c);c.geometry=c.components[<span class="number">0</span>]&#125;,<span class="attr">GeocodeMatchCode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.attributes.matchCode=</span><br><span class="line">&#123;<span class="attr">accuracy</span>:<span class="built_in">parseFloat</span>(a.getAttribute(<span class="string">"accuracy"</span>)),<span class="attr">matchType</span>:a.getAttribute(<span class="string">"matchType"</span>)&#125;&#125;,<span class="attr">Address</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">countryCode</span>:a.getAttribute(<span class="string">"countryCode"</span>),<span class="attr">addressee</span>:a.getAttribute(<span class="string">"addressee"</span>),<span class="attr">street</span>:[],<span class="attr">place</span>:[]&#125;;b.attributes.address=c;<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">freeFormAddress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.freeFormAddress=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">StreetAddress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Building</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.building=&#123;<span class="attr">number</span>:a.getAttribute(<span class="string">"number"</span>),<span class="attr">subdivision</span>:a.getAttribute(<span class="string">"subdivision"</span>),</span><br><span class="line">buildingName:a.getAttribute(<span class="string">"buildingName"</span>)&#125;&#125;,<span class="attr">Street</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.street.push(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">Place</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.place[a.getAttribute(<span class="string">"type"</span>)]=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">PostalCode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.postalCode=<span class="keyword">this</span>.getChildValue(a)&#125;&#125;,<span class="attr">gml</span>:OpenLayers.Format.GML.v3.prototype.readers.gml&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.writers.xls.XLS.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">writers</span>:&#123;<span class="attr">xls</span>:&#123;<span class="attr">XLS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"xls:XLS"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">version</span>:<span class="keyword">this</span>.VERSION,<span class="string">"xsi:schemaLocation"</span>:<span class="keyword">this</span>.schemaLocation&#125;&#125;);</span><br><span class="line"><span class="keyword">this</span>.writeNode(<span class="string">"RequestHeader"</span>,a.header,b);<span class="keyword">this</span>.writeNode(<span class="string">"Request"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">RequestHeader</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"xls:RequestHeader"</span>)&#125;,<span class="attr">Request</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"xls:Request"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">methodName</span>:<span class="string">"GeocodeRequest"</span>,<span class="attr">requestID</span>:a.requestID||<span class="string">""</span>,<span class="attr">version</span>:<span class="keyword">this</span>.VERSION&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"GeocodeRequest"</span>,a.addresses,b);<span class="keyword">return</span> b&#125;,<span class="attr">GeocodeRequest</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"xls:GeocodeRequest"</span>),c=<span class="number">0</span>,d=a.length;c&lt;d;c++)<span class="keyword">this</span>.writeNode(<span class="string">"Address"</span>,</span><br><span class="line">a[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">Address</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"xls:Address"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">countryCode</span>:a.countryCode&#125;&#125;);a.freeFormAddress?<span class="keyword">this</span>.writeNode(<span class="string">"freeFormAddress"</span>,a.freeFormAddress,b):(a.street&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"StreetAddress"</span>,a,b),a.municipality&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Municipality"</span>,a.municipality,b),a.countrySubdivision&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"CountrySubdivision"</span>,a.countrySubdivision,b),a.postalCode&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"PostalCode"</span>,a.postalCode,b));<span class="keyword">return</span> b&#125;,<span class="attr">freeFormAddress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"freeFormAddress"</span>,</span><br><span class="line">&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">StreetAddress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"xls:StreetAddress"</span>);a.building&amp;&amp;<span class="keyword">this</span>.writeNode(b,<span class="string">"Building"</span>,a.building);a=a.street;OpenLayers.Util.isArray(a)||(a=[a]);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;c++)<span class="keyword">this</span>.writeNode(<span class="string">"Street"</span>,a[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">Building</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"xls:Building"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">number</span>:a.number,<span class="attr">subdivision</span>:a.subdivision,<span class="attr">buildingName</span>:a.buildingName&#125;&#125;)&#125;,<span class="attr">Street</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"xls:Street"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">Municipality</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"xls:Place"</span>,</span><br><span class="line">&#123;<span class="attr">attributes</span>:&#123;<span class="attr">type</span>:<span class="string">"Municipality"</span>&#125;,<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">CountrySubdivision</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"xls:Place"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">type</span>:<span class="string">"CountrySubdivision"</span>&#125;,<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">PostalCode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"xls:PostalCode"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.XLS.v1"</span>&#125;);OpenLayers.Format.XLS.v1_1_0=OpenLayers.Class(OpenLayers.Format.XLS.v1,&#123;<span class="attr">VERSION</span>:<span class="string">"1.1"</span>,<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.1.0/LocationUtilityService.xsd"</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.XLS.v1_1_0"</span>&#125;);OpenLayers.Format.XLS.v1_1=OpenLayers.Format.XLS.v1_1_0;OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,&#123;<span class="attr">xmlns</span>:<span class="string">"http://www.w3.org/2000/svg"</span>,<span class="attr">xlinkns</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">MAX_PIXEL</span>:<span class="number">15E3</span>,<span class="attr">translationParameters</span>:<span class="literal">null</span>,<span class="attr">symbolMetrics</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.supported()&amp;&amp;(OpenLayers.Renderer.Elements.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>),<span class="keyword">this</span>.translationParameters=&#123;<span class="attr">x</span>:<span class="number">0</span>,<span class="attr">y</span>:<span class="number">0</span>&#125;,<span class="keyword">this</span>.symbolMetrics=&#123;&#125;)&#125;,<span class="attr">supported</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">document</span>.implementation&amp;&amp;(<span class="built_in">document</span>.implementation.hasFeature(<span class="string">"org.w3c.svg"</span>,<span class="string">"1.0"</span>)||<span class="built_in">document</span>.implementation.hasFeature(<span class="string">"http://www.w3.org/TR/SVG11/feature#SVG"</span>,</span><br><span class="line"><span class="string">"1.1"</span>)||<span class="built_in">document</span>.implementation.hasFeature(<span class="string">"http://www.w3.org/TR/SVG11/feature#BasicStructure"</span>,<span class="string">"1.1"</span>))&#125;,<span class="attr">inValidRange</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;a+=c?<span class="number">0</span>:<span class="keyword">this</span>.translationParameters.x;b+=c?<span class="number">0</span>:<span class="keyword">this</span>.translationParameters.y;<span class="keyword">return</span> a&gt;=-<span class="keyword">this</span>.MAX_PIXEL&amp;&amp;a&lt;=<span class="keyword">this</span>.MAX_PIXEL&amp;&amp;b&gt;=-<span class="keyword">this</span>.MAX_PIXEL&amp;&amp;b&lt;=<span class="keyword">this</span>.MAX_PIXEL&#125;,<span class="attr">setExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Renderer.Elements.prototype.setExtent.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>),d=<span class="keyword">this</span>.getResolution(),e=-a.left/d,d=a.top/d;<span class="keyword">if</span>(b)<span class="keyword">return</span> <span class="keyword">this</span>.left=e,<span class="keyword">this</span>.top=d,<span class="keyword">this</span>.rendererRoot.setAttributeNS(<span class="literal">null</span>,</span><br><span class="line"><span class="string">"viewBox"</span>,<span class="string">"0 0 "</span>+<span class="keyword">this</span>.size.w+<span class="string">" "</span>+<span class="keyword">this</span>.size.h),<span class="keyword">this</span>.translate(<span class="keyword">this</span>.xOffset,<span class="number">0</span>),!<span class="number">0</span>;(e=<span class="keyword">this</span>.translate(e-<span class="keyword">this</span>.left+<span class="keyword">this</span>.xOffset,d-<span class="keyword">this</span>.top))||<span class="keyword">this</span>.setExtent(a,!<span class="number">0</span>);<span class="keyword">return</span> c&amp;&amp;e&#125;,<span class="attr">translate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.inValidRange(a,b,!<span class="number">0</span>))&#123;<span class="keyword">var</span> c=<span class="string">""</span>;<span class="keyword">if</span>(a||b)c=<span class="string">"translate("</span>+a+<span class="string">","</span>+b+<span class="string">")"</span>;<span class="keyword">this</span>.root.setAttributeNS(<span class="literal">null</span>,<span class="string">"transform"</span>,c);<span class="keyword">this</span>.translationParameters=&#123;<span class="attr">x</span>:a,<span class="attr">y</span>:b&#125;;<span class="keyword">return</span>!<span class="number">0</span>&#125;<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">setSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Renderer.prototype.setSize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.rendererRoot.setAttributeNS(<span class="literal">null</span>,<span class="string">"width"</span>,<span class="keyword">this</span>.size.w);</span><br><span class="line"><span class="keyword">this</span>.rendererRoot.setAttributeNS(<span class="literal">null</span>,<span class="string">"height"</span>,<span class="keyword">this</span>.size.h)&#125;,<span class="attr">getNodeType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>;<span class="keyword">switch</span>(a.CLASS_NAME)&#123;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Point"</span>:c=b.externalGraphic?<span class="string">"image"</span>:<span class="keyword">this</span>.isComplexSymbol(b.graphicName)?<span class="string">"svg"</span>:<span class="string">"circle"</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Rectangle"</span>:c=<span class="string">"rect"</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.LineString"</span>:c=<span class="string">"polyline"</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.LinearRing"</span>:c=<span class="string">"polygon"</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Polygon"</span>:<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Curve"</span>:c=<span class="string">"path"</span>&#125;<span class="keyword">return</span> c&#125;,<span class="attr">setStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b,c</span>)</span>&#123;b=b||a._style;c=c||a._options;<span class="keyword">var</span> d=b.title||b.graphicTitle;<span class="keyword">if</span>(d)&#123;a.setAttributeNS(<span class="literal">null</span>,<span class="string">"title"</span>,d);<span class="keyword">var</span> e=a.getElementsByTagName(<span class="string">"title"</span>);<span class="number">0</span>&lt;e.length?e[<span class="number">0</span>].firstChild.textContent=d:(e=<span class="keyword">this</span>.nodeFactory(<span class="literal">null</span>,<span class="string">"title"</span>),e.textContent=d,a.appendChild(e))&#125;<span class="keyword">var</span> e=<span class="built_in">parseFloat</span>(a.getAttributeNS(<span class="literal">null</span>,<span class="string">"r"</span>)),d=<span class="number">1</span>,f;<span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.Point"</span>==a._geometryClass&amp;&amp;e)&#123;a.style.visibility=<span class="string">""</span>;<span class="keyword">if</span>(!<span class="number">1</span>===b.graphic)a.style.visibility=<span class="string">"hidden"</span>;<span class="keyword">else</span> <span class="keyword">if</span>(b.externalGraphic)&#123;f=<span class="keyword">this</span>.getPosition(a);b.graphicWidth&amp;&amp;b.graphicHeight&amp;&amp;</span><br><span class="line">a.setAttributeNS(<span class="literal">null</span>,<span class="string">"preserveAspectRatio"</span>,<span class="string">"none"</span>);<span class="keyword">var</span> e=b.graphicWidth||b.graphicHeight,g=b.graphicHeight||b.graphicWidth,e=e?e:<span class="number">2</span>*b.pointRadius,g=g?g:<span class="number">2</span>*b.pointRadius,h=<span class="keyword">void</span> <span class="number">0</span>!=b.graphicYOffset?b.graphicYOffset:-(<span class="number">0.5</span>*g),k=b.graphicOpacity||b.fillOpacity;a.setAttributeNS(<span class="literal">null</span>,<span class="string">"x"</span>,(f.x+(<span class="keyword">void</span> <span class="number">0</span>!=b.graphicXOffset?b.graphicXOffset:-(<span class="number">0.5</span>*e))).toFixed());a.setAttributeNS(<span class="literal">null</span>,<span class="string">"y"</span>,(f.y+h).toFixed());a.setAttributeNS(<span class="literal">null</span>,<span class="string">"width"</span>,e);a.setAttributeNS(<span class="literal">null</span>,<span class="string">"height"</span>,g);a.setAttributeNS(<span class="keyword">this</span>.xlinkns,<span class="string">"xlink:href"</span>,</span><br><span class="line">b.externalGraphic);a.setAttributeNS(<span class="literal">null</span>,<span class="string">"style"</span>,<span class="string">"opacity: "</span>+k);a.onclick=OpenLayers.Event.preventDefault&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.isComplexSymbol(b.graphicName))&#123;<span class="keyword">var</span> e=<span class="number">3</span>*b.pointRadius,g=<span class="number">2</span>*e,l=<span class="keyword">this</span>.importSymbol(b.graphicName);f=<span class="keyword">this</span>.getPosition(a);d=<span class="number">3</span>*<span class="keyword">this</span>.symbolMetrics[l.id][<span class="number">0</span>]/g;h=a.parentNode;k=a.nextSibling;h&amp;&amp;h.removeChild(a);a.firstChild&amp;&amp;a.removeChild(a.firstChild);a.appendChild(l.firstChild.cloneNode(!<span class="number">0</span>));a.setAttributeNS(<span class="literal">null</span>,<span class="string">"viewBox"</span>,l.getAttributeNS(<span class="literal">null</span>,<span class="string">"viewBox"</span>));a.setAttributeNS(<span class="literal">null</span>,<span class="string">"width"</span>,</span><br><span class="line">g);a.setAttributeNS(<span class="literal">null</span>,<span class="string">"height"</span>,g);a.setAttributeNS(<span class="literal">null</span>,<span class="string">"x"</span>,f.x-e);a.setAttributeNS(<span class="literal">null</span>,<span class="string">"y"</span>,f.y-e);k?h.insertBefore(a,k):h&amp;&amp;h.appendChild(a)&#125;<span class="keyword">else</span> a.setAttributeNS(<span class="literal">null</span>,<span class="string">"r"</span>,b.pointRadius);e=b.rotation;<span class="keyword">void</span> <span class="number">0</span>===e&amp;&amp;<span class="keyword">void</span> <span class="number">0</span>===a._rotation||!f||(a._rotation=e,e|=<span class="number">0</span>,<span class="string">"svg"</span>!==a.nodeName?a.setAttributeNS(<span class="literal">null</span>,<span class="string">"transform"</span>,<span class="string">"rotate("</span>+e+<span class="string">" "</span>+f.x+<span class="string">" "</span>+f.y+<span class="string">")"</span>):(f=<span class="keyword">this</span>.symbolMetrics[l.id],a.firstChild.setAttributeNS(<span class="literal">null</span>,<span class="string">"transform"</span>,<span class="string">"rotate("</span>+e+<span class="string">" "</span>+f[<span class="number">1</span>]+<span class="string">" "</span>+f[<span class="number">2</span>]+<span class="string">")"</span>)))&#125;c.isFilled?(a.setAttributeNS(<span class="literal">null</span>,<span class="string">"fill"</span>,b.fillColor),</span><br><span class="line">a.setAttributeNS(<span class="literal">null</span>,<span class="string">"fill-opacity"</span>,b.fillOpacity)):a.setAttributeNS(<span class="literal">null</span>,<span class="string">"fill"</span>,<span class="string">"none"</span>);c.isStroked?(a.setAttributeNS(<span class="literal">null</span>,<span class="string">"stroke"</span>,b.strokeColor),a.setAttributeNS(<span class="literal">null</span>,<span class="string">"stroke-opacity"</span>,b.strokeOpacity),a.setAttributeNS(<span class="literal">null</span>,<span class="string">"stroke-width"</span>,b.strokeWidth*d),a.setAttributeNS(<span class="literal">null</span>,<span class="string">"stroke-linecap"</span>,b.strokeLinecap||<span class="string">"round"</span>),a.setAttributeNS(<span class="literal">null</span>,<span class="string">"stroke-linejoin"</span>,<span class="string">"round"</span>),b.strokeDashstyle&amp;&amp;a.setAttributeNS(<span class="literal">null</span>,<span class="string">"stroke-dasharray"</span>,<span class="keyword">this</span>.dashStyle(b,d))):a.setAttributeNS(<span class="literal">null</span>,<span class="string">"stroke"</span>,<span class="string">"none"</span>);b.pointerEvents&amp;&amp;</span><br><span class="line">a.setAttributeNS(<span class="literal">null</span>,<span class="string">"pointer-events"</span>,b.pointerEvents);<span class="literal">null</span>!=b.cursor&amp;&amp;a.setAttributeNS(<span class="literal">null</span>,<span class="string">"cursor"</span>,b.cursor);<span class="keyword">return</span> a&#125;,<span class="attr">dashStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.strokeWidth*b,d=a.strokeDashstyle;<span class="keyword">switch</span>(d)&#123;<span class="keyword">case</span> <span class="string">"solid"</span>:<span class="keyword">return</span><span class="string">"none"</span>;<span class="keyword">case</span> <span class="string">"dot"</span>:<span class="keyword">return</span>[<span class="number">1</span>,<span class="number">4</span>*c].join();<span class="keyword">case</span> <span class="string">"dash"</span>:<span class="keyword">return</span>[<span class="number">4</span>*c,<span class="number">4</span>*c].join();<span class="keyword">case</span> <span class="string">"dashdot"</span>:<span class="keyword">return</span>[<span class="number">4</span>*c,<span class="number">4</span>*c,<span class="number">1</span>,<span class="number">4</span>*c].join();<span class="keyword">case</span> <span class="string">"longdash"</span>:<span class="keyword">return</span>[<span class="number">8</span>*c,<span class="number">4</span>*c].join();<span class="keyword">case</span> <span class="string">"longdashdot"</span>:<span class="keyword">return</span>[<span class="number">8</span>*c,<span class="number">4</span>*c,<span class="number">1</span>,<span class="number">4</span>*c].join();<span class="keyword">default</span>:<span class="keyword">return</span> OpenLayers.String.trim(d).replace(<span class="regexp">/\s+/g</span>,<span class="string">","</span>)&#125;&#125;,<span class="attr">createNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="built_in">document</span>.createElementNS(<span class="keyword">this</span>.xmlns,a);b&amp;&amp;c.setAttributeNS(<span class="literal">null</span>,<span class="string">"id"</span>,b);<span class="keyword">return</span> c&#125;,<span class="attr">nodeTypeCompare</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> b==a.nodeName&#125;,<span class="attr">createRenderRoot</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.nodeFactory(<span class="keyword">this</span>.container.id+<span class="string">"_svgRoot"</span>,<span class="string">"svg"</span>);a.style.display=<span class="string">"block"</span>;<span class="keyword">return</span> a&#125;,<span class="attr">createRoot</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.nodeFactory(<span class="keyword">this</span>.container.id+a,<span class="string">"g"</span>)&#125;,<span class="attr">createDefs</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.nodeFactory(<span class="keyword">this</span>.container.id+<span class="string">"_defs"</span>,<span class="string">"defs"</span>);<span class="keyword">this</span>.rendererRoot.appendChild(a);<span class="keyword">return</span> a&#125;,<span class="attr">drawPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.drawCircle(a,</span><br><span class="line">b,<span class="number">1</span>)&#125;,<span class="attr">drawCircle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.getResolution(),e=(b.x-<span class="keyword">this</span>.featureDx)/d+<span class="keyword">this</span>.left;b=<span class="keyword">this</span>.top-b.y/d;<span class="keyword">return</span> <span class="keyword">this</span>.inValidRange(e,b)?(a.setAttributeNS(<span class="literal">null</span>,<span class="string">"cx"</span>,e),a.setAttributeNS(<span class="literal">null</span>,<span class="string">"cy"</span>,b),a.setAttributeNS(<span class="literal">null</span>,<span class="string">"r"</span>,c),a):!<span class="number">1</span>&#125;,<span class="attr">drawLineString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getComponentsString(b.components);<span class="keyword">return</span> c.path?(a.setAttributeNS(<span class="literal">null</span>,<span class="string">"points"</span>,c.path),c.complete?a:<span class="literal">null</span>):!<span class="number">1</span>&#125;,<span class="attr">drawLinearRing</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getComponentsString(b.components);<span class="keyword">return</span> c.path?(a.setAttributeNS(<span class="literal">null</span>,</span><br><span class="line"><span class="string">"points"</span>,c.path),c.complete?a:<span class="literal">null</span>):!<span class="number">1</span>&#125;,<span class="attr">drawPolygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="string">""</span>,d=!<span class="number">0</span>,e=!<span class="number">0</span>,f,g,h=<span class="number">0</span>,k=b.components.length;h&lt;k;h++)c+=<span class="string">" M"</span>,f=<span class="keyword">this</span>.getComponentsString(b.components[h].components,<span class="string">" "</span>),(g=f.path)?(c+=<span class="string">" "</span>+g,e=f.complete&amp;&amp;e):d=!<span class="number">1</span>;<span class="keyword">return</span> d?(a.setAttributeNS(<span class="literal">null</span>,<span class="string">"d"</span>,c+<span class="string">" z"</span>),a.setAttributeNS(<span class="literal">null</span>,<span class="string">"fill-rule"</span>,<span class="string">"evenodd"</span>),e?a:<span class="literal">null</span>):!<span class="number">1</span>&#125;,<span class="attr">drawRectangle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getResolution(),d=(b.x-<span class="keyword">this</span>.featureDx)/c+<span class="keyword">this</span>.left,e=<span class="keyword">this</span>.top-b.y/c;<span class="keyword">return</span> <span class="keyword">this</span>.inValidRange(d,e)?(a.setAttributeNS(<span class="literal">null</span>,<span class="string">"x"</span>,</span><br><span class="line">d),a.setAttributeNS(<span class="literal">null</span>,<span class="string">"y"</span>,e),a.setAttributeNS(<span class="literal">null</span>,<span class="string">"width"</span>,b.width/c),a.setAttributeNS(<span class="literal">null</span>,<span class="string">"height"</span>,b.height/c),a):!<span class="number">1</span>&#125;,<span class="attr">drawText</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=!!b.labelOutlineWidth;<span class="keyword">if</span>(d)&#123;<span class="keyword">var</span> e=OpenLayers.Util.extend(&#123;&#125;,b);e.fontColor=e.labelOutlineColor;e.fontStrokeColor=e.labelOutlineColor;e.fontStrokeWidth=b.labelOutlineWidth;b.labelOutlineOpacity&amp;&amp;(e.fontOpacity=b.labelOutlineOpacity);<span class="keyword">delete</span> e.labelOutlineWidth;<span class="keyword">this</span>.drawText(a,e,c)&#125;<span class="keyword">var</span> f=<span class="keyword">this</span>.getResolution(),e=(c.x-<span class="keyword">this</span>.featureDx)/f+<span class="keyword">this</span>.left,g=c.y/</span><br><span class="line">f-<span class="keyword">this</span>.top,d=d?<span class="keyword">this</span>.LABEL_OUTLINE_SUFFIX:<span class="keyword">this</span>.LABEL_ID_SUFFIX,f=<span class="keyword">this</span>.nodeFactory(a+d,<span class="string">"text"</span>);f.setAttributeNS(<span class="literal">null</span>,<span class="string">"x"</span>,e);f.setAttributeNS(<span class="literal">null</span>,<span class="string">"y"</span>,-g);b.fontColor&amp;&amp;f.setAttributeNS(<span class="literal">null</span>,<span class="string">"fill"</span>,b.fontColor);b.fontStrokeColor&amp;&amp;f.setAttributeNS(<span class="literal">null</span>,<span class="string">"stroke"</span>,b.fontStrokeColor);b.fontStrokeWidth&amp;&amp;f.setAttributeNS(<span class="literal">null</span>,<span class="string">"stroke-width"</span>,b.fontStrokeWidth);b.fontOpacity&amp;&amp;f.setAttributeNS(<span class="literal">null</span>,<span class="string">"opacity"</span>,b.fontOpacity);b.fontFamily&amp;&amp;f.setAttributeNS(<span class="literal">null</span>,<span class="string">"font-family"</span>,b.fontFamily);b.fontSize&amp;&amp;f.setAttributeNS(<span class="literal">null</span>,</span><br><span class="line"><span class="string">"font-size"</span>,b.fontSize);b.fontWeight&amp;&amp;f.setAttributeNS(<span class="literal">null</span>,<span class="string">"font-weight"</span>,b.fontWeight);b.fontStyle&amp;&amp;f.setAttributeNS(<span class="literal">null</span>,<span class="string">"font-style"</span>,b.fontStyle);!<span class="number">0</span>===b.labelSelect?(f.setAttributeNS(<span class="literal">null</span>,<span class="string">"pointer-events"</span>,<span class="string">"visible"</span>),f._featureId=a):f.setAttributeNS(<span class="literal">null</span>,<span class="string">"pointer-events"</span>,<span class="string">"none"</span>);g=b.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;f.setAttributeNS(<span class="literal">null</span>,<span class="string">"text-anchor"</span>,OpenLayers.Renderer.SVG.LABEL_ALIGN[g[<span class="number">0</span>]]||<span class="string">"middle"</span>);!<span class="number">0</span>===OpenLayers.IS_GECKO&amp;&amp;f.setAttributeNS(<span class="literal">null</span>,<span class="string">"dominant-baseline"</span>,</span><br><span class="line">OpenLayers.Renderer.SVG.LABEL_ALIGN[g[<span class="number">1</span>]]||<span class="string">"central"</span>);<span class="keyword">for</span>(<span class="keyword">var</span> h=b.label.split(<span class="string">"\n"</span>),k=h.length;f.childNodes.length&gt;k;)f.removeChild(f.lastChild);<span class="keyword">for</span>(<span class="keyword">var</span> l=<span class="number">0</span>;l&lt;k;l++)&#123;<span class="keyword">var</span> m=<span class="keyword">this</span>.nodeFactory(a+d+<span class="string">"_tspan_"</span>+l,<span class="string">"tspan"</span>);!<span class="number">0</span>===b.labelSelect&amp;&amp;(m._featureId=a,m._geometry=c,m._geometryClass=c.CLASS_NAME);!<span class="number">1</span>===OpenLayers.IS_GECKO&amp;&amp;m.setAttributeNS(<span class="literal">null</span>,<span class="string">"baseline-shift"</span>,OpenLayers.Renderer.SVG.LABEL_VSHIFT[g[<span class="number">1</span>]]||<span class="string">"-35%"</span>);m.setAttribute(<span class="string">"x"</span>,e);<span class="keyword">if</span>(<span class="number">0</span>==l)&#123;<span class="keyword">var</span> n=OpenLayers.Renderer.SVG.LABEL_VFACTOR[g[<span class="number">1</span>]];<span class="literal">null</span>==n&amp;&amp;</span><br><span class="line">(n=<span class="number">-0.5</span>);m.setAttribute(<span class="string">"dy"</span>,n*(k<span class="number">-1</span>)+<span class="string">"em"</span>)&#125;<span class="keyword">else</span> m.setAttribute(<span class="string">"dy"</span>,<span class="string">"1em"</span>);m.textContent=<span class="string">""</span>===h[l]?<span class="string">" "</span>:h[l];m.parentNode||f.appendChild(m)&#125;f.parentNode||<span class="keyword">this</span>.textRoot.appendChild(f)&#125;,<span class="attr">getComponentsString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=[],d=!<span class="number">0</span>,e=a.length,f=[],g,h=<span class="number">0</span>;h&lt;e;h++)g=a[h],c.push(g),(g=<span class="keyword">this</span>.getShortString(g))?f.push(g):(<span class="number">0</span>&lt;h&amp;&amp;<span class="keyword">this</span>.getShortString(a[h<span class="number">-1</span>])&amp;&amp;f.push(<span class="keyword">this</span>.clipLine(a[h],a[h<span class="number">-1</span>])),h&lt;e<span class="number">-1</span>&amp;&amp;<span class="keyword">this</span>.getShortString(a[h+<span class="number">1</span>])&amp;&amp;f.push(<span class="keyword">this</span>.clipLine(a[h],a[h+<span class="number">1</span>])),d=!<span class="number">1</span>);<span class="keyword">return</span>&#123;<span class="attr">path</span>:f.join(b||<span class="string">","</span>),<span class="attr">complete</span>:d&#125;&#125;,</span><br><span class="line">clipLine:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(b.equals(a))<span class="keyword">return</span><span class="string">""</span>;<span class="keyword">var</span> c=<span class="keyword">this</span>.getResolution(),d=<span class="keyword">this</span>.MAX_PIXEL-<span class="keyword">this</span>.translationParameters.x,e=<span class="keyword">this</span>.MAX_PIXEL-<span class="keyword">this</span>.translationParameters.y,f=(b.x-<span class="keyword">this</span>.featureDx)/c+<span class="keyword">this</span>.left,g=<span class="keyword">this</span>.top-b.y/c,h=(a.x-<span class="keyword">this</span>.featureDx)/c+<span class="keyword">this</span>.left,c=<span class="keyword">this</span>.top-a.y/c,k;<span class="keyword">if</span>(h&lt;-d||h&gt;d)k=(c-g)/(h-f),h=<span class="number">0</span>&gt;h?-d:d,c=g+(h-f)*k;<span class="keyword">if</span>(c&lt;-e||c&gt;e)k=(h-f)/(c-g),c=<span class="number">0</span>&gt;c?-e:e,h=f+(c-g)*k;<span class="keyword">return</span> h+<span class="string">","</span>+c&#125;,<span class="attr">getShortString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getResolution(),c=(a.x-<span class="keyword">this</span>.featureDx)/b+<span class="keyword">this</span>.left;a=<span class="keyword">this</span>.top-a.y/b;<span class="keyword">return</span> <span class="keyword">this</span>.inValidRange(c,</span><br><span class="line">a)?c+<span class="string">","</span>+a:!<span class="number">1</span>&#125;,<span class="attr">getPosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span>&#123;<span class="attr">x</span>:<span class="built_in">parseFloat</span>(a.getAttributeNS(<span class="literal">null</span>,<span class="string">"cx"</span>)),<span class="attr">y</span>:<span class="built_in">parseFloat</span>(a.getAttributeNS(<span class="literal">null</span>,<span class="string">"cy"</span>))&#125;&#125;,<span class="attr">importSymbol</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.defs||(<span class="keyword">this</span>.defs=<span class="keyword">this</span>.createDefs());<span class="keyword">var</span> b=<span class="keyword">this</span>.container.id+<span class="string">"-"</span>+a,c=<span class="built_in">document</span>.getElementById(b);<span class="keyword">if</span>(<span class="literal">null</span>!=c)<span class="keyword">return</span> c;<span class="keyword">var</span> d=OpenLayers.Renderer.symbol[a];<span class="keyword">if</span>(!d)<span class="keyword">throw</span> <span class="built_in">Error</span>(a+<span class="string">" is not a valid symbol name"</span>);a=<span class="keyword">this</span>.nodeFactory(b,<span class="string">"symbol"</span>);<span class="keyword">var</span> e=<span class="keyword">this</span>.nodeFactory(<span class="literal">null</span>,<span class="string">"polygon"</span>);a.appendChild(e);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Bounds(<span class="built_in">Number</span>.MAX_VALUE,<span class="built_in">Number</span>.MAX_VALUE,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>),f=[],g,h,k=<span class="number">0</span>;k&lt;d.length;k+=<span class="number">2</span>)g=d[k],h=d[k+<span class="number">1</span>],c.left=<span class="built_in">Math</span>.min(c.left,g),c.bottom=<span class="built_in">Math</span>.min(c.bottom,h),c.right=<span class="built_in">Math</span>.max(c.right,g),c.top=<span class="built_in">Math</span>.max(c.top,h),f.push(g,<span class="string">","</span>,h);e.setAttributeNS(<span class="literal">null</span>,<span class="string">"points"</span>,f.join(<span class="string">" "</span>));d=c.getWidth();e=c.getHeight();a.setAttributeNS(<span class="literal">null</span>,<span class="string">"viewBox"</span>,[c.left-d,c.bottom-e,<span class="number">3</span>*d,<span class="number">3</span>*e].join(<span class="string">" "</span>));<span class="keyword">this</span>.symbolMetrics[b]=[<span class="built_in">Math</span>.max(d,e),c.getCenterLonLat().lon,c.getCenterLonLat().lat];<span class="keyword">this</span>.defs.appendChild(a);<span class="keyword">return</span> a&#125;,<span class="attr">getFeatureIdFromEvent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>);b||(b=a.target,b=b.parentNode&amp;&amp;b!=<span class="keyword">this</span>.rendererRoot?b.parentNode._featureId:<span class="keyword">void</span> <span class="number">0</span>);<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Renderer.SVG"</span>&#125;);OpenLayers.Renderer.SVG.LABEL_ALIGN=&#123;<span class="attr">l</span>:<span class="string">"start"</span>,<span class="attr">r</span>:<span class="string">"end"</span>,<span class="attr">b</span>:<span class="string">"bottom"</span>,<span class="attr">t</span>:<span class="string">"hanging"</span>&#125;;OpenLayers.Renderer.SVG.LABEL_VSHIFT=&#123;<span class="attr">t</span>:<span class="string">"-70%"</span>,<span class="attr">b</span>:<span class="string">"0"</span>&#125;;OpenLayers.Renderer.SVG.LABEL_VFACTOR=&#123;<span class="attr">t</span>:<span class="number">0</span>,<span class="attr">b</span>:<span class="number">-1</span>&#125;;OpenLayers.Renderer.SVG.preventDefault=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Event.preventDefault(a)&#125;;OpenLayers.Format.SLD.v1_0_0=OpenLayers.Class(OpenLayers.Format.SLD.v1,&#123;<span class="attr">VERSION</span>:<span class="string">"1.0.0"</span>,<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd"</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.SLD.v1_0_0"</span>&#125;);OpenLayers.Format.OWSContext=OpenLayers.Class(OpenLayers.Format.Context,&#123;<span class="attr">defaultVersion</span>:<span class="string">"0.3.1"</span>,<span class="attr">getVersion</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Format.XML.VersionedOGC.prototype.getVersion.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="string">"0.3.0"</span>===c&amp;&amp;(c=<span class="keyword">this</span>.defaultVersion);<span class="keyword">return</span> c&#125;,<span class="attr">toContext</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;&#125;;<span class="string">"OpenLayers.Map"</span>==a.CLASS_NAME&amp;&amp;(b.bounds=a.getExtent(),b.maxExtent=a.maxExtent,b.projection=a.projection,b.size=a.getSize(),b.layers=a.layers);<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.OWSContext"</span>&#125;);OpenLayers.Format.OWSContext.v0_3_1=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">owc</span>:<span class="string">"http://www.opengis.net/ows-context"</span>,<span class="attr">gml</span>:<span class="string">"http://www.opengis.net/gml"</span>,<span class="attr">kml</span>:<span class="string">"http://www.opengis.net/kml/2.2"</span>,<span class="attr">ogc</span>:<span class="string">"http://www.opengis.net/ogc"</span>,<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows"</span>,<span class="attr">sld</span>:<span class="string">"http://www.opengis.net/sld"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&#125;,<span class="attr">VERSION</span>:<span class="string">"0.3.1"</span>,<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/ows-context http://www.ogcnetwork.net/schemas/owc/0.3.1/owsContext.xsd"</span>,</span><br><span class="line">defaultPrefix:<span class="string">"owc"</span>,<span class="attr">extractAttributes</span>:!<span class="number">0</span>,<span class="attr">xy</span>:!<span class="number">0</span>,<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">featureNS</span>:<span class="string">"http://mapserver.gis.umn.edu/mapserver"</span>,<span class="attr">featureType</span>:<span class="string">"vector"</span>,<span class="attr">geometryName</span>:<span class="string">"geometry"</span>,<span class="attr">nestingLayerLookup</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[a]);OpenLayers.Format.GML.v2.prototype.setGeometryTypes.call(<span class="keyword">this</span>)&#125;,<span class="attr">setNestingPath</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a.layersContext)<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=a.layersContext.length;b&lt;c;b++)&#123;<span class="keyword">var</span> d=</span><br><span class="line">a.layersContext[b],e=[],f=a.title||<span class="string">""</span>;a.metadata&amp;&amp;a.metadata.nestingPath&amp;&amp;(e=a.metadata.nestingPath.slice());<span class="string">""</span>!=f&amp;&amp;e.push(f);d.metadata.nestingPath=e;d.layersContext&amp;&amp;<span class="keyword">this</span>.setNestingPath(d)&#125;&#125;,<span class="attr">decomposeNestingPath</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=[];<span class="keyword">if</span>(OpenLayers.Util.isArray(a))&#123;<span class="keyword">for</span>(a=a.slice();<span class="number">0</span>&lt;a.length;)b.push(a.slice()),a.pop();b.reverse()&#125;<span class="keyword">return</span> b&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> b=&#123;&#125;;<span class="keyword">this</span>.readNode(a,</span><br><span class="line">b);<span class="keyword">this</span>.setNestingPath(&#123;<span class="attr">layersContext</span>:b.layersContext&#125;);a=[];<span class="keyword">this</span>.processLayer(a,b);<span class="keyword">delete</span> b.layersContext;b.layersContext=a;<span class="keyword">return</span> b&#125;,<span class="attr">processLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(b.layersContext)<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=b.layersContext.length;c&lt;d;c++)&#123;<span class="keyword">var</span> e=b.layersContext[c];a.push(e);e.layersContext&amp;&amp;<span class="keyword">this</span>.processLayer(a,e)&#125;&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.nestingLayerLookup=&#123;&#125;;b=b||&#123;&#125;;OpenLayers.Util.applyDefaults(b,a);<span class="keyword">var</span> c=<span class="keyword">this</span>.writeNode(<span class="string">"OWSContext"</span>,b);<span class="keyword">this</span>.nestingLayerLookup=<span class="literal">null</span>;<span class="keyword">this</span>.setAttributeNS(c,<span class="keyword">this</span>.namespaces.xsi,</span><br><span class="line"><span class="string">"xsi:schemaLocation"</span>,<span class="keyword">this</span>.schemaLocation);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[c])&#125;,<span class="attr">readers</span>:&#123;<span class="attr">kml</span>:&#123;<span class="attr">Document</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.features=(<span class="keyword">new</span> OpenLayers.Format.KML(&#123;<span class="attr">kmlns</span>:<span class="keyword">this</span>.namespaces.kml,<span class="attr">extractStyles</span>:!<span class="number">0</span>&#125;)).read(a)&#125;&#125;,<span class="attr">owc</span>:&#123;<span class="attr">OWSContext</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">General</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">ResourceList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Layer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">metadata</span>:&#123;&#125;,<span class="attr">visibility</span>:<span class="string">"1"</span>!=a.getAttribute(<span class="string">"hidden"</span>),<span class="attr">queryable</span>:<span class="string">"1"</span>==a.getAttribute(<span class="string">"queryable"</span>),</span><br><span class="line">opacity:<span class="literal">null</span>!=a.getAttribute(<span class="string">"opacity"</span>)?<span class="built_in">parseFloat</span>(a.getAttribute(<span class="string">"opacity"</span>)):<span class="literal">null</span>,<span class="attr">name</span>:a.getAttribute(<span class="string">"name"</span>),<span class="attr">categoryLayer</span>:<span class="literal">null</span>==a.getAttribute(<span class="string">"name"</span>),<span class="attr">formats</span>:[],<span class="attr">styles</span>:[]&#125;;b.layersContext||(b.layersContext=[]);b.layersContext.push(c);<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">InlineGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.features=[];<span class="keyword">var</span> c=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.namespaces.gml,<span class="string">"featureMember"</span>),d;<span class="number">1</span>&lt;=c.length&amp;&amp;(d=c[<span class="number">0</span>]);d&amp;&amp;d.firstChild&amp;&amp;(c=d.firstChild.nextSibling?d.firstChild.nextSibling:d.firstChild,<span class="keyword">this</span>.setNamespace(<span class="string">"feature"</span>,</span><br><span class="line">c.namespaceURI),<span class="keyword">this</span>.featureType=c.localName||c.nodeName.split(<span class="string">":"</span>).pop(),<span class="keyword">this</span>.readChildNodes(a,b))&#125;,<span class="attr">Server</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(!b.service&amp;&amp;!b.version||b.service!=OpenLayers.Format.Context.serviceTypes.WMS)b.service=a.getAttribute(<span class="string">"service"</span>),b.version=a.getAttribute(<span class="string">"version"</span>),<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.name=<span class="keyword">this</span>.getChildValue(a);<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Title</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.title=<span class="keyword">this</span>.getChildValue(a);<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">StyleList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b.styles)&#125;,</span><br><span class="line">Style:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;b.push(c);<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">LegendURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;b.legend=c;<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">OnlineResource</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.url=<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.xlink,<span class="string">"href"</span>);<span class="keyword">this</span>.readChildNodes(a,b)&#125;&#125;,<span class="attr">ows</span>:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows,<span class="attr">gml</span>:OpenLayers.Format.GML.v2.prototype.readers.gml,<span class="attr">sld</span>:OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld,<span class="attr">feature</span>:OpenLayers.Format.GML.v2.prototype.readers.feature&#125;,<span class="attr">writers</span>:&#123;<span class="attr">owc</span>:&#123;<span class="attr">OWSContext</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.createElementNSPlus(<span class="string">"OWSContext"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">version</span>:<span class="keyword">this</span>.VERSION,<span class="attr">id</span>:a.id||OpenLayers.Util.createUniqueID(<span class="string">"OpenLayers_OWSContext_"</span>)&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"General"</span>,a,b);<span class="keyword">this</span>.writeNode(<span class="string">"ResourceList"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">General</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"General"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"ows:BoundingBox"</span>,a,b);<span class="keyword">this</span>.writeNode(<span class="string">"ows:Title"</span>,a.title||<span class="string">"OpenLayers OWSContext"</span>,b);<span class="keyword">return</span> b&#125;,<span class="attr">ResourceList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ResourceList"</span>),c=<span class="number">0</span>,d=a.layers.length;c&lt;d;c++)&#123;<span class="keyword">var</span> e=</span><br><span class="line">a.layers[c],f=<span class="keyword">this</span>.decomposeNestingPath(e.metadata.nestingPath);<span class="keyword">this</span>.writeNode(<span class="string">"_Layer"</span>,&#123;<span class="attr">layer</span>:e,<span class="attr">subPaths</span>:f&#125;,b)&#125;<span class="keyword">return</span> b&#125;,<span class="attr">Server</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"Server"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">version</span>:a.version,<span class="attr">service</span>:a.service&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"OnlineResource"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">OnlineResource</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"OnlineResource"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="string">"xlink:href"</span>:a.url&#125;&#125;)&#125;,<span class="attr">InlineGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"InlineGeometry"</span>),c=a.getDataExtent();<span class="literal">null</span>!==c&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"gml:boundedBy"</span>,</span><br><span class="line">c,b);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.features.length;c&lt;d;c++)<span class="keyword">this</span>.writeNode(<span class="string">"gml:featureMember"</span>,a.features[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">StyleList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"StyleList"</span>),c=<span class="number">0</span>,d=a.length;c&lt;d;c++)<span class="keyword">this</span>.writeNode(<span class="string">"Style"</span>,a[c],b);<span class="keyword">return</span> b&#125;,<span class="attr">Style</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"Style"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"Name"</span>,a,b);<span class="keyword">this</span>.writeNode(<span class="string">"Title"</span>,a,b);a.legend&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"LegendURL"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">Name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"Name"</span>,&#123;<span class="attr">value</span>:a.name&#125;)&#125;,<span class="attr">Title</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"Title"</span>,</span><br><span class="line">&#123;<span class="attr">value</span>:a.title&#125;)&#125;,<span class="attr">LegendURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"LegendURL"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"OnlineResource"</span>,a.legend,b);<span class="keyword">return</span> b&#125;,<span class="attr">_WMS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"Layer"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">name</span>:a.params.LAYERS,<span class="attr">queryable</span>:a.queryable?<span class="string">"1"</span>:<span class="string">"0"</span>,<span class="attr">hidden</span>:a.visibility?<span class="string">"0"</span>:<span class="string">"1"</span>,<span class="attr">opacity</span>:a.hasOwnProperty(<span class="string">"opacity"</span>)?a.opacity:<span class="literal">null</span>&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"ows:Title"</span>,a.name,b);<span class="keyword">this</span>.writeNode(<span class="string">"ows:OutputFormat"</span>,a.params.FORMAT,b);<span class="keyword">this</span>.writeNode(<span class="string">"Server"</span>,&#123;<span class="attr">service</span>:OpenLayers.Format.Context.serviceTypes.WMS,</span><br><span class="line">version:a.params.VERSION,<span class="attr">url</span>:a.url&#125;,b);a.metadata.styles&amp;&amp;<span class="number">0</span>&lt;a.metadata.styles.length&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"StyleList"</span>,a.metadata.styles,b);<span class="keyword">return</span> b&#125;,<span class="attr">_Layer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c,d;b=a.layer;c=a.subPaths;d=<span class="literal">null</span>;<span class="number">0</span>&lt;c.length?(b=c[<span class="number">0</span>].join(<span class="string">"/"</span>),c=b.lastIndexOf(<span class="string">"/"</span>),d=<span class="keyword">this</span>.nestingLayerLookup[b],c=<span class="number">0</span>&lt;c?b.substring(c+<span class="number">1</span>,b.length):b,d||(d=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"Layer"</span>),<span class="keyword">this</span>.writeNode(<span class="string">"ows:Title"</span>,c,d),<span class="keyword">this</span>.nestingLayerLookup[b]=d),a.subPaths.shift(),<span class="keyword">this</span>.writeNode(<span class="string">"_Layer"</span>,a,d)):(b <span class="keyword">instanceof</span> OpenLayers.Layer.WMS?</span><br><span class="line">d=<span class="keyword">this</span>.writeNode(<span class="string">"_WMS"</span>,b):b <span class="keyword">instanceof</span> OpenLayers.Layer.Vector&amp;&amp;(b.protocol <span class="keyword">instanceof</span> OpenLayers.Protocol.WFS.v1?d=<span class="keyword">this</span>.writeNode(<span class="string">"_WFS"</span>,b):b.protocol <span class="keyword">instanceof</span> OpenLayers.Protocol.HTTP?b.protocol.format <span class="keyword">instanceof</span> OpenLayers.Format.GML?(b.protocol.format.version=<span class="string">"2.1.2"</span>,d=<span class="keyword">this</span>.writeNode(<span class="string">"_GML"</span>,b)):b.protocol.format <span class="keyword">instanceof</span> OpenLayers.Format.KML&amp;&amp;(b.protocol.format.version=<span class="string">"2.2"</span>,d=<span class="keyword">this</span>.writeNode(<span class="string">"_KML"</span>,b)):(<span class="keyword">this</span>.setNamespace(<span class="string">"feature"</span>,<span class="keyword">this</span>.featureNS),d=<span class="keyword">this</span>.writeNode(<span class="string">"_InlineGeometry"</span>,b))),</span><br><span class="line">b.options.maxScale&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"sld:MinScaleDenominator"</span>,b.options.maxScale,d),b.options.minScale&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"sld:MaxScaleDenominator"</span>,b.options.minScale,d),<span class="keyword">this</span>.nestingLayerLookup[b.name]=d);<span class="keyword">return</span> d&#125;,<span class="attr">_WFS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"Layer"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">name</span>:a.protocol.featurePrefix+<span class="string">":"</span>+a.protocol.featureType,<span class="attr">hidden</span>:a.visibility?<span class="string">"0"</span>:<span class="string">"1"</span>&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"ows:Title"</span>,a.name,b);<span class="keyword">this</span>.writeNode(<span class="string">"Server"</span>,&#123;<span class="attr">service</span>:OpenLayers.Format.Context.serviceTypes.WFS,<span class="attr">version</span>:a.protocol.version,</span><br><span class="line">url:a.protocol.url&#125;,b);<span class="keyword">return</span> b&#125;,<span class="attr">_InlineGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"Layer"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">name</span>:<span class="keyword">this</span>.featureType,<span class="attr">hidden</span>:a.visibility?<span class="string">"0"</span>:<span class="string">"1"</span>&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"ows:Title"</span>,a.name,b);<span class="keyword">this</span>.writeNode(<span class="string">"InlineGeometry"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">_GML</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"Layer"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"ows:Title"</span>,a.name,b);<span class="keyword">this</span>.writeNode(<span class="string">"Server"</span>,&#123;<span class="attr">service</span>:OpenLayers.Format.Context.serviceTypes.GML,<span class="attr">url</span>:a.protocol.url,<span class="attr">version</span>:a.protocol.format.version&#125;,b);<span class="keyword">return</span> b&#125;,<span class="attr">_KML</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.createElementNSPlus(<span class="string">"Layer"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"ows:Title"</span>,a.name,b);<span class="keyword">this</span>.writeNode(<span class="string">"Server"</span>,&#123;<span class="attr">service</span>:OpenLayers.Format.Context.serviceTypes.KML,<span class="attr">version</span>:a.protocol.format.version,<span class="attr">url</span>:a.protocol.url&#125;,b);<span class="keyword">return</span> b&#125;&#125;,<span class="attr">gml</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">boundedBy</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:boundedBy"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"gml:Box"</span>,a,b);<span class="keyword">return</span> b&#125;&#125;,OpenLayers.Format.GML.v2.prototype.writers.gml),<span class="attr">ows</span>:OpenLayers.Format.OWSCommon.v1_0_0.prototype.writers.ows,<span class="attr">sld</span>:OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld,</span><br><span class="line">feature:OpenLayers.Format.GML.v2.prototype.writers.feature&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.OWSContext.v0_3_1"</span>&#125;);OpenLayers.Popup=OpenLayers.Class(&#123;<span class="attr">events</span>:<span class="literal">null</span>,<span class="attr">id</span>:<span class="string">""</span>,<span class="attr">lonlat</span>:<span class="literal">null</span>,<span class="attr">div</span>:<span class="literal">null</span>,<span class="attr">contentSize</span>:<span class="literal">null</span>,<span class="attr">size</span>:<span class="literal">null</span>,<span class="attr">contentHTML</span>:<span class="literal">null</span>,<span class="attr">backgroundColor</span>:<span class="string">""</span>,<span class="attr">opacity</span>:<span class="string">""</span>,<span class="attr">border</span>:<span class="string">""</span>,<span class="attr">contentDiv</span>:<span class="literal">null</span>,<span class="attr">groupDiv</span>:<span class="literal">null</span>,<span class="attr">closeDiv</span>:<span class="literal">null</span>,<span class="attr">autoSize</span>:!<span class="number">1</span>,<span class="attr">minSize</span>:<span class="literal">null</span>,<span class="attr">maxSize</span>:<span class="literal">null</span>,<span class="attr">displayClass</span>:<span class="string">"olPopup"</span>,<span class="attr">contentDisplayClass</span>:<span class="string">"olPopupContent"</span>,<span class="attr">padding</span>:<span class="number">0</span>,<span class="attr">disableFirefoxOverflowHack</span>:!<span class="number">1</span>,<span class="attr">fixPadding</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="string">"number"</span>==<span class="keyword">typeof</span> <span class="keyword">this</span>.padding&amp;&amp;(<span class="keyword">this</span>.padding=<span class="keyword">new</span> OpenLayers.Bounds(<span class="keyword">this</span>.padding,<span class="keyword">this</span>.padding,<span class="keyword">this</span>.padding,<span class="keyword">this</span>.padding))&#125;,<span class="attr">panMapIfOutOfView</span>:!<span class="number">1</span>,</span><br><span class="line">keepInMap:!<span class="number">1</span>,<span class="attr">closeOnMove</span>:!<span class="number">1</span>,<span class="attr">map</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e,f</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=OpenLayers.Util.createUniqueID(<span class="keyword">this</span>.CLASS_NAME+<span class="string">"_"</span>));<span class="keyword">this</span>.id=a;<span class="keyword">this</span>.lonlat=b;<span class="keyword">this</span>.contentSize=<span class="literal">null</span>!=c?c:<span class="keyword">new</span> OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT);<span class="literal">null</span>!=d&amp;&amp;(<span class="keyword">this</span>.contentHTML=d);<span class="keyword">this</span>.backgroundColor=OpenLayers.Popup.COLOR;<span class="keyword">this</span>.opacity=OpenLayers.Popup.OPACITY;<span class="keyword">this</span>.border=OpenLayers.Popup.BORDER;<span class="keyword">this</span>.div=OpenLayers.Util.createDiv(<span class="keyword">this</span>.id,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="string">"hidden"</span>);<span class="keyword">this</span>.div.className=<span class="keyword">this</span>.displayClass;</span><br><span class="line"><span class="keyword">this</span>.groupDiv=OpenLayers.Util.createDiv(<span class="keyword">this</span>.id+<span class="string">"_GroupDiv"</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="string">"relative"</span>,<span class="literal">null</span>,<span class="string">"hidden"</span>);a=<span class="keyword">this</span>.div.id+<span class="string">"_contentDiv"</span>;<span class="keyword">this</span>.contentDiv=OpenLayers.Util.createDiv(a,<span class="literal">null</span>,<span class="keyword">this</span>.contentSize.clone(),<span class="literal">null</span>,<span class="string">"relative"</span>);<span class="keyword">this</span>.contentDiv.className=<span class="keyword">this</span>.contentDisplayClass;<span class="keyword">this</span>.groupDiv.appendChild(<span class="keyword">this</span>.contentDiv);<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.groupDiv);e&amp;&amp;<span class="keyword">this</span>.addCloseBox(f);<span class="keyword">this</span>.registerEvents()&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.border=<span class="keyword">this</span>.opacity=<span class="keyword">this</span>.backgroundColor=<span class="keyword">this</span>.contentHTML=<span class="keyword">this</span>.size=<span class="keyword">this</span>.lonlat=<span class="keyword">this</span>.id=</span><br><span class="line"><span class="literal">null</span>;<span class="keyword">this</span>.closeOnMove&amp;&amp;<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.events.unregister(<span class="string">"movestart"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.hide);<span class="keyword">this</span>.events.destroy();<span class="keyword">this</span>.events=<span class="literal">null</span>;<span class="keyword">this</span>.closeDiv&amp;&amp;(OpenLayers.Event.stopObservingElement(<span class="keyword">this</span>.closeDiv),<span class="keyword">this</span>.groupDiv.removeChild(<span class="keyword">this</span>.closeDiv));<span class="keyword">this</span>.closeDiv=<span class="literal">null</span>;<span class="keyword">this</span>.div.removeChild(<span class="keyword">this</span>.groupDiv);<span class="keyword">this</span>.groupDiv=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.removePopup(<span class="keyword">this</span>);<span class="keyword">this</span>.panMapIfOutOfView=<span class="keyword">this</span>.padding=<span class="keyword">this</span>.maxSize=<span class="keyword">this</span>.minSize=<span class="keyword">this</span>.autoSize=<span class="keyword">this</span>.div=<span class="keyword">this</span>.map=<span class="literal">null</span>&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.lonlat&amp;&amp;<span class="literal">null</span>!=</span><br><span class="line"><span class="keyword">this</span>.map&amp;&amp;(a=<span class="keyword">this</span>.map.getLayerPxFromLonLat(<span class="keyword">this</span>.lonlat));<span class="keyword">this</span>.closeOnMove&amp;&amp;<span class="keyword">this</span>.map.events.register(<span class="string">"movestart"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.hide);<span class="keyword">this</span>.disableFirefoxOverflowHack||<span class="string">"firefox"</span>!=OpenLayers.BROWSER_NAME||(<span class="keyword">this</span>.map.events.register(<span class="string">"movestart"</span>,<span class="keyword">this</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="built_in">document</span>.defaultView.getComputedStyle(<span class="keyword">this</span>.contentDiv,<span class="literal">null</span>).getPropertyValue(<span class="string">"overflow"</span>);<span class="string">"hidden"</span>!=a&amp;&amp;(<span class="keyword">this</span>.contentDiv._oldOverflow=a,<span class="keyword">this</span>.contentDiv.style.overflow=<span class="string">"hidden"</span>)&#125;),<span class="keyword">this</span>.map.events.register(<span class="string">"moveend"</span>,<span class="keyword">this</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.contentDiv._oldOverflow;</span><br><span class="line">a&amp;&amp;(<span class="keyword">this</span>.contentDiv.style.overflow=a,<span class="keyword">this</span>.contentDiv._oldOverflow=<span class="literal">null</span>)&#125;));<span class="keyword">this</span>.moveTo(a);<span class="keyword">this</span>.autoSize||<span class="keyword">this</span>.size||<span class="keyword">this</span>.setSize(<span class="keyword">this</span>.contentSize);<span class="keyword">this</span>.setBackgroundColor();<span class="keyword">this</span>.setOpacity();<span class="keyword">this</span>.setBorder();<span class="keyword">this</span>.setContentHTML();<span class="keyword">this</span>.panMapIfOutOfView&amp;&amp;<span class="keyword">this</span>.panIntoView();<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">updatePosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.lonlat&amp;&amp;<span class="keyword">this</span>.map)&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getLayerPxFromLonLat(<span class="keyword">this</span>.lonlat);a&amp;&amp;<span class="keyword">this</span>.moveTo(a)&#125;&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>!=a&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.div&amp;&amp;(<span class="keyword">this</span>.div.style.left=a.x+<span class="string">"px"</span>,<span class="keyword">this</span>.div.style.top=</span><br><span class="line">a.y+<span class="string">"px"</span>)&#125;,<span class="attr">visible</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Element.visible(<span class="keyword">this</span>.div)&#125;,<span class="attr">toggle</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.visible()?<span class="keyword">this</span>.hide():<span class="keyword">this</span>.show()&#125;,<span class="attr">show</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.div.style.display=<span class="string">""</span>;<span class="keyword">this</span>.panMapIfOutOfView&amp;&amp;<span class="keyword">this</span>.panIntoView()&#125;,<span class="attr">hide</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.div.style.display=<span class="string">"none"</span>&#125;,<span class="attr">setSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.size=a.clone();<span class="keyword">var</span> b=<span class="keyword">this</span>.getContentDivPadding(),c=b.left+b.right,d=b.top+b.bottom;<span class="keyword">this</span>.fixPadding();c+=<span class="keyword">this</span>.padding.left+<span class="keyword">this</span>.padding.right;d+=<span class="keyword">this</span>.padding.top+<span class="keyword">this</span>.padding.bottom;<span class="keyword">if</span>(<span class="keyword">this</span>.closeDiv)<span class="keyword">var</span> e=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.closeDiv.style.width),</span><br><span class="line">c=c+(e+b.right);<span class="keyword">this</span>.size.w+=c;<span class="keyword">this</span>.size.h+=d;<span class="string">"msie"</span>==OpenLayers.BROWSER_NAME&amp;&amp;(<span class="keyword">this</span>.contentSize.w+=b.left+b.right,<span class="keyword">this</span>.contentSize.h+=b.bottom+b.top);<span class="literal">null</span>!=<span class="keyword">this</span>.div&amp;&amp;(<span class="keyword">this</span>.div.style.width=<span class="keyword">this</span>.size.w+<span class="string">"px"</span>,<span class="keyword">this</span>.div.style.height=<span class="keyword">this</span>.size.h+<span class="string">"px"</span>);<span class="literal">null</span>!=<span class="keyword">this</span>.contentDiv&amp;&amp;(<span class="keyword">this</span>.contentDiv.style.width=a.w+<span class="string">"px"</span>,<span class="keyword">this</span>.contentDiv.style.height=a.h+<span class="string">"px"</span>)&#125;,<span class="attr">updateSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="string">"&lt;div class='"</span>+<span class="keyword">this</span>.contentDisplayClass+<span class="string">"'&gt;"</span>+<span class="keyword">this</span>.contentDiv.innerHTML+<span class="string">"&lt;/div&gt;"</span>,b=<span class="keyword">this</span>.map?<span class="keyword">this</span>.map.div:<span class="built_in">document</span>.body,c=OpenLayers.Util.getRenderedDimensions(a,</span><br><span class="line"><span class="literal">null</span>,&#123;<span class="attr">displayClass</span>:<span class="keyword">this</span>.displayClass,<span class="attr">containerElement</span>:b&#125;),d=<span class="keyword">this</span>.getSafeContentSize(c),e=<span class="literal">null</span>;d.equals(c)?e=c:(c=&#123;<span class="attr">w</span>:d.w&lt;c.w?d.w:<span class="literal">null</span>,<span class="attr">h</span>:d.h&lt;c.h?d.h:<span class="literal">null</span>&#125;,c.w&amp;&amp;c.h?e=d:(a=OpenLayers.Util.getRenderedDimensions(a,c,&#123;<span class="attr">displayClass</span>:<span class="keyword">this</span>.contentDisplayClass,<span class="attr">containerElement</span>:b&#125;),<span class="string">"hidden"</span>!=OpenLayers.Element.getStyle(<span class="keyword">this</span>.contentDiv,<span class="string">"overflow"</span>)&amp;&amp;a.equals(d)&amp;&amp;(d=OpenLayers.Util.getScrollbarWidth(),c.w?a.h+=d:a.w+=d),e=<span class="keyword">this</span>.getSafeContentSize(a)));<span class="keyword">this</span>.setSize(e)&#125;,<span class="attr">setBackgroundColor</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">void</span> <span class="number">0</span>!=a&amp;&amp;(<span class="keyword">this</span>.backgroundColor=</span><br><span class="line">a);<span class="literal">null</span>!=<span class="keyword">this</span>.div&amp;&amp;(<span class="keyword">this</span>.div.style.backgroundColor=<span class="keyword">this</span>.backgroundColor)&#125;,<span class="attr">setOpacity</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">void</span> <span class="number">0</span>!=a&amp;&amp;(<span class="keyword">this</span>.opacity=a);<span class="literal">null</span>!=<span class="keyword">this</span>.div&amp;&amp;(<span class="keyword">this</span>.div.style.opacity=<span class="keyword">this</span>.opacity,<span class="keyword">this</span>.div.style.filter=<span class="string">"alpha(opacity="</span>+<span class="number">100</span>*<span class="keyword">this</span>.opacity+<span class="string">")"</span>)&#125;,<span class="attr">setBorder</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">void</span> <span class="number">0</span>!=a&amp;&amp;(<span class="keyword">this</span>.border=a);<span class="literal">null</span>!=<span class="keyword">this</span>.div&amp;&amp;(<span class="keyword">this</span>.div.style.border=<span class="keyword">this</span>.border)&#125;,<span class="attr">setContentHTML</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>!=a&amp;&amp;(<span class="keyword">this</span>.contentHTML=a);<span class="literal">null</span>!=<span class="keyword">this</span>.contentDiv&amp;&amp;(<span class="literal">null</span>!=<span class="keyword">this</span>.contentHTML&amp;&amp;<span class="keyword">this</span>.contentHTML!=<span class="keyword">this</span>.contentDiv.innerHTML)&amp;&amp;(<span class="keyword">this</span>.contentDiv.innerHTML=</span><br><span class="line"><span class="keyword">this</span>.contentHTML,<span class="keyword">this</span>.autoSize&amp;&amp;(<span class="keyword">this</span>.registerImageListeners(),<span class="keyword">this</span>.updateSize()))&#125;,<span class="attr">registerImageListeners</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="literal">null</span>!==<span class="keyword">this</span>.popup.id&amp;&amp;(<span class="keyword">this</span>.popup.updateSize(),<span class="keyword">this</span>.popup.visible()&amp;&amp;<span class="keyword">this</span>.popup.panMapIfOutOfView&amp;&amp;<span class="keyword">this</span>.popup.panIntoView(),OpenLayers.Event.stopObserving(<span class="keyword">this</span>.img,<span class="string">"load"</span>,<span class="keyword">this</span>.img._onImgLoad))&#125;,b=<span class="keyword">this</span>.contentDiv.getElementsByTagName(<span class="string">"img"</span>),c=<span class="number">0</span>,d=b.length;c&lt;d;c++)&#123;<span class="keyword">var</span> e=b[c];<span class="keyword">if</span>(<span class="number">0</span>==e.width||<span class="number">0</span>==e.height)e._onImgLoad=OpenLayers.Function.bind(a,&#123;<span class="attr">popup</span>:<span class="keyword">this</span>,<span class="attr">img</span>:e&#125;),</span><br><span class="line">OpenLayers.Event.observe(e,<span class="string">"load"</span>,e._onImgLoad)&#125;&#125;,<span class="attr">getSafeContentSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.clone();<span class="keyword">var</span> b=<span class="keyword">this</span>.getContentDivPadding(),c=b.left+b.right,d=b.top+b.bottom;<span class="keyword">this</span>.fixPadding();c+=<span class="keyword">this</span>.padding.left+<span class="keyword">this</span>.padding.right;d+=<span class="keyword">this</span>.padding.top+<span class="keyword">this</span>.padding.bottom;<span class="keyword">if</span>(<span class="keyword">this</span>.closeDiv)<span class="keyword">var</span> e=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.closeDiv.style.width),c=c+(e+b.right);<span class="keyword">this</span>.minSize&amp;&amp;(a.w=<span class="built_in">Math</span>.max(a.w,<span class="keyword">this</span>.minSize.w-c),a.h=<span class="built_in">Math</span>.max(a.h,<span class="keyword">this</span>.minSize.h-d));<span class="keyword">this</span>.maxSize&amp;&amp;(a.w=<span class="built_in">Math</span>.min(a.w,<span class="keyword">this</span>.maxSize.w-c),a.h=<span class="built_in">Math</span>.min(a.h,<span class="keyword">this</span>.maxSize.h-</span><br><span class="line">d));<span class="keyword">if</span>(<span class="keyword">this</span>.map&amp;&amp;<span class="keyword">this</span>.map.size)&#123;e=b=<span class="number">0</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.keepInMap&amp;&amp;!<span class="keyword">this</span>.panMapIfOutOfView)<span class="keyword">switch</span>(e=<span class="keyword">this</span>.map.getPixelFromLonLat(<span class="keyword">this</span>.lonlat),<span class="keyword">this</span>.relativePosition)&#123;<span class="keyword">case</span> <span class="string">"tr"</span>:b=e.x;e=<span class="keyword">this</span>.map.size.h-e.y;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"tl"</span>:b=<span class="keyword">this</span>.map.size.w-e.x;e=<span class="keyword">this</span>.map.size.h-e.y;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"bl"</span>:b=<span class="keyword">this</span>.map.size.w-e.x;e=e.y;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"br"</span>:b=e.x;e=e.y;<span class="keyword">break</span>;<span class="keyword">default</span>:b=e.x,e=<span class="keyword">this</span>.map.size.h-e.y&#125;d=<span class="keyword">this</span>.map.size.h-<span class="keyword">this</span>.map.paddingForPopups.top-<span class="keyword">this</span>.map.paddingForPopups.bottom-d-e;a.w=<span class="built_in">Math</span>.min(a.w,<span class="keyword">this</span>.map.size.w-<span class="keyword">this</span>.map.paddingForPopups.left-</span><br><span class="line"><span class="keyword">this</span>.map.paddingForPopups.right-c-b);a.h=<span class="built_in">Math</span>.min(a.h,d)&#125;<span class="keyword">return</span> a&#125;,<span class="attr">getContentDivPadding</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>._contentDivPadding;a||(<span class="literal">null</span>==<span class="keyword">this</span>.div.parentNode&amp;&amp;(<span class="keyword">this</span>.div.style.display=<span class="string">"none"</span>,<span class="built_in">document</span>.body.appendChild(<span class="keyword">this</span>.div)),<span class="keyword">this</span>._contentDivPadding=a=<span class="keyword">new</span> OpenLayers.Bounds(OpenLayers.Element.getStyle(<span class="keyword">this</span>.contentDiv,<span class="string">"padding-left"</span>),OpenLayers.Element.getStyle(<span class="keyword">this</span>.contentDiv,<span class="string">"padding-bottom"</span>),OpenLayers.Element.getStyle(<span class="keyword">this</span>.contentDiv,<span class="string">"padding-right"</span>),OpenLayers.Element.getStyle(<span class="keyword">this</span>.contentDiv,</span><br><span class="line"><span class="string">"padding-top"</span>)),<span class="keyword">this</span>.div.parentNode==<span class="built_in">document</span>.body&amp;&amp;(<span class="built_in">document</span>.body.removeChild(<span class="keyword">this</span>.div),<span class="keyword">this</span>.div.style.display=<span class="string">""</span>));<span class="keyword">return</span> a&#125;,<span class="attr">addCloseBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.closeDiv=OpenLayers.Util.createDiv(<span class="keyword">this</span>.id+<span class="string">"_close"</span>,<span class="literal">null</span>,&#123;<span class="attr">w</span>:<span class="number">17</span>,<span class="attr">h</span>:<span class="number">17</span>&#125;);<span class="keyword">this</span>.closeDiv.className=<span class="string">"olPopupCloseBox"</span>;<span class="keyword">var</span> b=<span class="keyword">this</span>.getContentDivPadding();<span class="keyword">this</span>.closeDiv.style.right=b.right+<span class="string">"px"</span>;<span class="keyword">this</span>.closeDiv.style.top=b.top+<span class="string">"px"</span>;<span class="keyword">this</span>.groupDiv.appendChild(<span class="keyword">this</span>.closeDiv);a=a||<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.hide();OpenLayers.Event.stop(a)&#125;;OpenLayers.Event.observe(<span class="keyword">this</span>.closeDiv,</span><br><span class="line"><span class="string">"touchend"</span>,OpenLayers.Function.bindAsEventListener(a,<span class="keyword">this</span>));OpenLayers.Event.observe(<span class="keyword">this</span>.closeDiv,<span class="string">"click"</span>,OpenLayers.Function.bindAsEventListener(a,<span class="keyword">this</span>))&#125;,<span class="attr">panIntoView</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getSize(),b=<span class="keyword">this</span>.map.getViewPortPxFromLayerPx(<span class="keyword">new</span> OpenLayers.Pixel(<span class="built_in">parseInt</span>(<span class="keyword">this</span>.div.style.left),<span class="built_in">parseInt</span>(<span class="keyword">this</span>.div.style.top))),c=b.clone();b.x&lt;<span class="keyword">this</span>.map.paddingForPopups.left?c.x=<span class="keyword">this</span>.map.paddingForPopups.left:b.x+<span class="keyword">this</span>.size.w&gt;a.w-<span class="keyword">this</span>.map.paddingForPopups.right&amp;&amp;(c.x=a.w-<span class="keyword">this</span>.map.paddingForPopups.right-<span class="keyword">this</span>.size.w);</span><br><span class="line">b.y&lt;<span class="keyword">this</span>.map.paddingForPopups.top?c.y=<span class="keyword">this</span>.map.paddingForPopups.top:b.y+<span class="keyword">this</span>.size.h&gt;a.h-<span class="keyword">this</span>.map.paddingForPopups.bottom&amp;&amp;(c.y=a.h-<span class="keyword">this</span>.map.paddingForPopups.bottom-<span class="keyword">this</span>.size.h);<span class="keyword">this</span>.map.pan(b.x-c.x,b.y-c.y)&#125;,<span class="attr">registerEvents</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.events=<span class="keyword">new</span> OpenLayers.Events(<span class="keyword">this</span>,<span class="keyword">this</span>.div,<span class="literal">null</span>,!<span class="number">0</span>);<span class="keyword">this</span>.events.on(&#123;<span class="attr">mousedown</span>:<span class="keyword">this</span>.onmousedown,<span class="attr">mousemove</span>:<span class="keyword">this</span>.onmousemove,<span class="attr">mouseup</span>:<span class="keyword">this</span>.onmouseup,<span class="attr">click</span>:<span class="keyword">this</span>.onclick,<span class="attr">mouseout</span>:<span class="keyword">this</span>.onmouseout,<span class="attr">dblclick</span>:<span class="keyword">this</span>.ondblclick,<span class="attr">touchstart</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Event.stop(a,!<span class="number">0</span>)&#125;,</span><br><span class="line">scope:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">onmousedown</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.mousedown=!<span class="number">0</span>;OpenLayers.Event.stop(a,!<span class="number">0</span>)&#125;,<span class="attr">onmousemove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.mousedown&amp;&amp;OpenLayers.Event.stop(a,!<span class="number">0</span>)&#125;,<span class="attr">onmouseup</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.mousedown&amp;&amp;(<span class="keyword">this</span>.mousedown=!<span class="number">1</span>,OpenLayers.Event.stop(a,!<span class="number">0</span>))&#125;,<span class="attr">onclick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Event.stop(a,!<span class="number">0</span>)&#125;,<span class="attr">onmouseout</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.mousedown=!<span class="number">1</span>&#125;,<span class="attr">ondblclick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Event.stop(a,!<span class="number">0</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Popup"</span>&#125;);OpenLayers.Popup.WIDTH=<span class="number">200</span>;OpenLayers.Popup.HEIGHT=<span class="number">200</span>;OpenLayers.Popup.COLOR=<span class="string">"white"</span>;</span><br><span class="line">OpenLayers.Popup.OPACITY=<span class="number">1</span>;OpenLayers.Popup.BORDER=<span class="string">"0px"</span>;OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">maxWidth</span>:<span class="number">100</span>,<span class="attr">topOutUnits</span>:<span class="string">"km"</span>,<span class="attr">topInUnits</span>:<span class="string">"m"</span>,<span class="attr">bottomOutUnits</span>:<span class="string">"mi"</span>,<span class="attr">bottomInUnits</span>:<span class="string">"ft"</span>,<span class="attr">eTop</span>:<span class="literal">null</span>,<span class="attr">eBottom</span>:<span class="literal">null</span>,<span class="attr">geodesic</span>:!<span class="number">1</span>,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Control.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.eTop||(<span class="keyword">this</span>.eTop=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>),<span class="keyword">this</span>.eTop.className=<span class="keyword">this</span>.displayClass+<span class="string">"Top"</span>,<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.eTop),<span class="keyword">this</span>.eTop.style.visibility=<span class="string">""</span>==<span class="keyword">this</span>.topOutUnits||<span class="string">""</span>==<span class="keyword">this</span>.topInUnits?<span class="string">"hidden"</span>:<span class="string">"visible"</span>,<span class="keyword">this</span>.eBottom=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>),</span><br><span class="line"><span class="keyword">this</span>.eBottom.className=<span class="keyword">this</span>.displayClass+<span class="string">"Bottom"</span>,<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.eBottom),<span class="keyword">this</span>.eBottom.style.visibility=<span class="string">""</span>==<span class="keyword">this</span>.bottomOutUnits||<span class="string">""</span>==<span class="keyword">this</span>.bottomInUnits?<span class="string">"hidden"</span>:<span class="string">"visible"</span>);<span class="keyword">this</span>.map.events.register(<span class="string">"moveend"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.update);<span class="keyword">this</span>.update();<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">getBarLen</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="built_in">parseInt</span>(<span class="built_in">Math</span>.log(a)/<span class="built_in">Math</span>.log(<span class="number">10</span>)),b=<span class="built_in">Math</span>.pow(<span class="number">10</span>,b);a=<span class="built_in">parseInt</span>(a/b);<span class="keyword">return</span>(<span class="number">5</span>&lt;a?<span class="number">5</span>:<span class="number">2</span>&lt;a?<span class="number">2</span>:<span class="number">1</span>)*b&#125;,<span class="attr">update</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getResolution();<span class="keyword">if</span>(a)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getUnits(),c=OpenLayers.INCHES_PER_UNIT,d=<span class="keyword">this</span>.maxWidth*</span><br><span class="line">a*c[b],e=<span class="number">1</span>;!<span class="number">0</span>===<span class="keyword">this</span>.geodesic&amp;&amp;(e=(<span class="keyword">this</span>.map.getGeodesicPixelSize().w||<span class="number">1E-6</span>)*<span class="keyword">this</span>.maxWidth/(d/c.km),d*=e);<span class="keyword">var</span> f,g;<span class="number">1E5</span>&lt;d?(f=<span class="keyword">this</span>.topOutUnits,g=<span class="keyword">this</span>.bottomOutUnits):(f=<span class="keyword">this</span>.topInUnits,g=<span class="keyword">this</span>.bottomInUnits);<span class="keyword">var</span> h=d/c[f],k=d/c[g],d=<span class="keyword">this</span>.getBarLen(h),l=<span class="keyword">this</span>.getBarLen(k),h=d/c[b]*c[f],k=l/c[b]*c[g],b=h/a/e,a=k/a/e;<span class="string">"visible"</span>==<span class="keyword">this</span>.eBottom.style.visibility&amp;&amp;(<span class="keyword">this</span>.eBottom.style.width=<span class="built_in">Math</span>.round(a)+<span class="string">"px"</span>,<span class="keyword">this</span>.eBottom.innerHTML=l+<span class="string">" "</span>+g);<span class="string">"visible"</span>==<span class="keyword">this</span>.eTop.style.visibility&amp;&amp;(<span class="keyword">this</span>.eTop.style.width=<span class="built_in">Math</span>.round(b)+</span><br><span class="line"><span class="string">"px"</span>,<span class="keyword">this</span>.eTop.innerHTML=d+<span class="string">" "</span>+f)&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.ScaleLine"</span>&#125;);OpenLayers.Icon=OpenLayers.Class(&#123;<span class="attr">url</span>:<span class="literal">null</span>,<span class="attr">size</span>:<span class="literal">null</span>,<span class="attr">offset</span>:<span class="literal">null</span>,<span class="attr">calculateOffset</span>:<span class="literal">null</span>,<span class="attr">imageDiv</span>:<span class="literal">null</span>,<span class="attr">px</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">this</span>.url=a;<span class="keyword">this</span>.size=b||&#123;<span class="attr">w</span>:<span class="number">20</span>,<span class="attr">h</span>:<span class="number">20</span>&#125;;<span class="keyword">this</span>.offset=c||&#123;<span class="attr">x</span>:-(<span class="keyword">this</span>.size.w/<span class="number">2</span>),<span class="attr">y</span>:-(<span class="keyword">this</span>.size.h/<span class="number">2</span>)&#125;;<span class="keyword">this</span>.calculateOffset=d;a=OpenLayers.Util.createUniqueID(<span class="string">"OL_Icon_"</span>);<span class="keyword">this</span>.imageDiv=OpenLayers.Util.createAlphaImageDiv(a)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.erase();OpenLayers.Event.stopObservingElement(<span class="keyword">this</span>.imageDiv.firstChild);<span class="keyword">this</span>.imageDiv.innerHTML=<span class="string">""</span>;<span class="keyword">this</span>.imageDiv=<span class="literal">null</span>&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Icon(<span class="keyword">this</span>.url,</span><br><span class="line"><span class="keyword">this</span>.size,<span class="keyword">this</span>.offset,<span class="keyword">this</span>.calculateOffset)&#125;,<span class="attr">setSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>!=a&amp;&amp;(<span class="keyword">this</span>.size=a);<span class="keyword">this</span>.draw()&#125;,<span class="attr">setUrl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>!=a&amp;&amp;(<span class="keyword">this</span>.url=a);<span class="keyword">this</span>.draw()&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.modifyAlphaImageDiv(<span class="keyword">this</span>.imageDiv,<span class="literal">null</span>,<span class="literal">null</span>,<span class="keyword">this</span>.size,<span class="keyword">this</span>.url,<span class="string">"absolute"</span>);<span class="keyword">this</span>.moveTo(a);<span class="keyword">return</span> <span class="keyword">this</span>.imageDiv&#125;,<span class="attr">erase</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="literal">null</span>!=<span class="keyword">this</span>.imageDiv&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.imageDiv.parentNode&amp;&amp;OpenLayers.Element.remove(<span class="keyword">this</span>.imageDiv)&#125;,<span class="attr">setOpacity</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.modifyAlphaImageDiv(<span class="keyword">this</span>.imageDiv,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,</span><br><span class="line"><span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,a)&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>!=a&amp;&amp;(<span class="keyword">this</span>.px=a);<span class="literal">null</span>!=<span class="keyword">this</span>.imageDiv&amp;&amp;(<span class="literal">null</span>==<span class="keyword">this</span>.px?<span class="keyword">this</span>.display(!<span class="number">1</span>):(<span class="keyword">this</span>.calculateOffset&amp;&amp;(<span class="keyword">this</span>.offset=<span class="keyword">this</span>.calculateOffset(<span class="keyword">this</span>.size)),OpenLayers.Util.modifyAlphaImageDiv(<span class="keyword">this</span>.imageDiv,<span class="literal">null</span>,&#123;<span class="attr">x</span>:<span class="keyword">this</span>.px.x+<span class="keyword">this</span>.offset.x,<span class="attr">y</span>:<span class="keyword">this</span>.px.y+<span class="keyword">this</span>.offset.y&#125;)))&#125;,<span class="attr">display</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.imageDiv.style.display=a?<span class="string">""</span>:<span class="string">"none"</span>&#125;,<span class="attr">isDrawn</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.imageDiv&amp;&amp;<span class="keyword">this</span>.imageDiv.parentNode&amp;&amp;<span class="number">11</span>!=<span class="keyword">this</span>.imageDiv.parentNode.nodeType&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Icon"</span>&#125;);OpenLayers.Marker=OpenLayers.Class(&#123;<span class="attr">icon</span>:<span class="literal">null</span>,<span class="attr">lonlat</span>:<span class="literal">null</span>,<span class="attr">events</span>:<span class="literal">null</span>,<span class="attr">map</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.lonlat=a;<span class="keyword">var</span> c=b?b:OpenLayers.Marker.defaultIcon();<span class="literal">null</span>==<span class="keyword">this</span>.icon?<span class="keyword">this</span>.icon=c:(<span class="keyword">this</span>.icon.url=c.url,<span class="keyword">this</span>.icon.size=c.size,<span class="keyword">this</span>.icon.offset=c.offset,<span class="keyword">this</span>.icon.calculateOffset=c.calculateOffset);<span class="keyword">this</span>.events=<span class="keyword">new</span> OpenLayers.Events(<span class="keyword">this</span>,<span class="keyword">this</span>.icon.imageDiv)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.erase();<span class="keyword">this</span>.map=<span class="literal">null</span>;<span class="keyword">this</span>.events.destroy();<span class="keyword">this</span>.events=<span class="literal">null</span>;<span class="literal">null</span>!=<span class="keyword">this</span>.icon&amp;&amp;(<span class="keyword">this</span>.icon.destroy(),<span class="keyword">this</span>.icon=<span class="literal">null</span>)&#125;,</span><br><span class="line">draw:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.icon.draw(a)&#125;,<span class="attr">erase</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="literal">null</span>!=<span class="keyword">this</span>.icon&amp;&amp;<span class="keyword">this</span>.icon.erase()&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>!=a&amp;&amp;<span class="literal">null</span>!=<span class="keyword">this</span>.icon&amp;&amp;<span class="keyword">this</span>.icon.moveTo(a);<span class="keyword">this</span>.lonlat=<span class="keyword">this</span>.map.getLonLatFromLayerPx(a)&#125;,<span class="attr">isDrawn</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.icon&amp;&amp;<span class="keyword">this</span>.icon.isDrawn()&#125;,<span class="attr">onScreen</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;<span class="keyword">this</span>.map&amp;&amp;(a=<span class="keyword">this</span>.map.getExtent().containsLonLat(<span class="keyword">this</span>.lonlat));<span class="keyword">return</span> a&#125;,<span class="attr">inflate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.icon&amp;&amp;<span class="keyword">this</span>.icon.setSize(&#123;<span class="attr">w</span>:<span class="keyword">this</span>.icon.size.w*a,<span class="attr">h</span>:<span class="keyword">this</span>.icon.size.h*a&#125;)&#125;,<span class="attr">setOpacity</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.icon.setOpacity(a)&#125;,</span><br><span class="line">setUrl:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.icon.setUrl(a)&#125;,<span class="attr">display</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.icon.display(a)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Marker"</span>&#125;);OpenLayers.Marker.defaultIcon=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Icon(OpenLayers.Util.getImageLocation(<span class="string">"marker.png"</span>),&#123;<span class="attr">w</span>:<span class="number">21</span>,<span class="attr">h</span>:<span class="number">25</span>&#125;,&#123;<span class="attr">x</span>:<span class="number">-10.5</span>,<span class="attr">y</span>:<span class="number">-25</span>&#125;)&#125;;OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,&#123;<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">format</span>:<span class="string">"image/png"</span>,<span class="attr">serverResolutions</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">this</span>.layername=c;OpenLayers.Layer.Grid.prototype.initialize.apply(<span class="keyword">this</span>,[a,b,&#123;&#125;,d]);<span class="keyword">this</span>.extension=<span class="keyword">this</span>.format.split(<span class="string">"/"</span>)[<span class="number">1</span>].toLowerCase();<span class="keyword">this</span>.extension=<span class="string">"jpg"</span>==<span class="keyword">this</span>.extension?<span class="string">"jpeg"</span>:<span class="keyword">this</span>.extension&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.TileCache(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.layername,<span class="keyword">this</span>.getOptions()));<span class="keyword">return</span> a=OpenLayers.Layer.Grid.prototype.clone.apply(<span class="keyword">this</span>,</span><br><span class="line">[a])&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getServerResolution(),c=<span class="keyword">this</span>.maxExtent,d=<span class="keyword">this</span>.tileSize,e=<span class="built_in">Math</span>.round((a.left-c.left)/(b*d.w));a=<span class="built_in">Math</span>.round((a.bottom-c.bottom)/(b*d.h));b=<span class="literal">null</span>!=<span class="keyword">this</span>.serverResolutions?OpenLayers.Util.indexOf(<span class="keyword">this</span>.serverResolutions,b):<span class="keyword">this</span>.map.getZoom();e=[<span class="keyword">this</span>.layername,OpenLayers.Number.zeroPad(b,<span class="number">2</span>),OpenLayers.Number.zeroPad(<span class="built_in">parseInt</span>(e/<span class="number">1E6</span>),<span class="number">3</span>),OpenLayers.Number.zeroPad(<span class="built_in">parseInt</span>(e/<span class="number">1E3</span>)%<span class="number">1E3</span>,<span class="number">3</span>),OpenLayers.Number.zeroPad(<span class="built_in">parseInt</span>(e)%<span class="number">1E3</span>,<span class="number">3</span>),OpenLayers.Number.zeroPad(<span class="built_in">parseInt</span>(a/<span class="number">1E6</span>),</span><br><span class="line"><span class="number">3</span>),OpenLayers.Number.zeroPad(<span class="built_in">parseInt</span>(a/<span class="number">1E3</span>)%<span class="number">1E3</span>,<span class="number">3</span>),OpenLayers.Number.zeroPad(<span class="built_in">parseInt</span>(a)%<span class="number">1E3</span>,<span class="number">3</span>)+<span class="string">"."</span>+<span class="keyword">this</span>.extension].join(<span class="string">"/"</span>);b=<span class="keyword">this</span>.url;OpenLayers.Util.isArray(b)&amp;&amp;(b=<span class="keyword">this</span>.selectUrl(e,b));b=<span class="string">"/"</span>==b.charAt(b.length<span class="number">-1</span>)?b:b+<span class="string">"/"</span>;<span class="keyword">return</span> b+e&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.TileCache"</span>&#125;);OpenLayers.Strategy.Paging=OpenLayers.Class(OpenLayers.Strategy,&#123;<span class="attr">features</span>:<span class="literal">null</span>,<span class="attr">length</span>:<span class="number">10</span>,<span class="attr">num</span>:<span class="literal">null</span>,<span class="attr">paging</span>:!<span class="number">1</span>,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Strategy.prototype.activate.call(<span class="keyword">this</span>);<span class="keyword">if</span>(a)<span class="keyword">this</span>.layer.events.on(&#123;<span class="attr">beforefeaturesadded</span>:<span class="keyword">this</span>.cacheFeatures,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Strategy.prototype.deactivate.call(<span class="keyword">this</span>);a&amp;&amp;(<span class="keyword">this</span>.clearCache(),<span class="keyword">this</span>.layer.events.un(&#123;<span class="attr">beforefeaturesadded</span>:<span class="keyword">this</span>.cacheFeatures,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;));<span class="keyword">return</span> a&#125;,<span class="attr">cacheFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.paging||(<span class="keyword">this</span>.clearCache(),</span><br><span class="line"><span class="keyword">this</span>.features=a.features,<span class="keyword">this</span>.pageNext(a))&#125;,<span class="attr">clearCache</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.features)<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>;a&lt;<span class="keyword">this</span>.features.length;++a)<span class="keyword">this</span>.features[a].destroy();<span class="keyword">this</span>.num=<span class="keyword">this</span>.features=<span class="literal">null</span>&#125;,<span class="attr">pageCount</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">Math</span>.ceil((<span class="keyword">this</span>.features?<span class="keyword">this</span>.features.length:<span class="number">0</span>)/<span class="keyword">this</span>.length)&#125;,<span class="attr">pageNum</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.num&#125;,<span class="attr">pageLength</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a&amp;&amp;<span class="number">0</span>&lt;a&amp;&amp;(<span class="keyword">this</span>.length=a);<span class="keyword">return</span> <span class="keyword">this</span>.length&#125;,<span class="attr">pageNext</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;<span class="keyword">this</span>.features&amp;&amp;(<span class="literal">null</span>===<span class="keyword">this</span>.num&amp;&amp;(<span class="keyword">this</span>.num=<span class="number">-1</span>),b=<span class="keyword">this</span>.page((<span class="keyword">this</span>.num+<span class="number">1</span>)*<span class="keyword">this</span>.length,a));<span class="keyword">return</span> b&#125;,<span class="attr">pagePrevious</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=</span><br><span class="line">!<span class="number">1</span>;<span class="keyword">this</span>.features&amp;&amp;(<span class="literal">null</span>===<span class="keyword">this</span>.num&amp;&amp;(<span class="keyword">this</span>.num=<span class="keyword">this</span>.pageCount()),a=<span class="keyword">this</span>.page((<span class="keyword">this</span>.num<span class="number">-1</span>)*<span class="keyword">this</span>.length));<span class="keyword">return</span> a&#125;,<span class="attr">page</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=!<span class="number">1</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.features&amp;&amp;<span class="number">0</span>&lt;=a&amp;&amp;a&lt;<span class="keyword">this</span>.features.length)&#123;<span class="keyword">var</span> d=<span class="built_in">Math</span>.floor(a/<span class="keyword">this</span>.length);d!=<span class="keyword">this</span>.num&amp;&amp;(<span class="keyword">this</span>.paging=!<span class="number">0</span>,c=<span class="keyword">this</span>.features.slice(a,a+<span class="keyword">this</span>.length),<span class="keyword">this</span>.layer.removeFeatures(<span class="keyword">this</span>.layer.features),<span class="keyword">this</span>.num=d,b&amp;&amp;b.features?b.features=c:<span class="keyword">this</span>.layer.addFeatures(c),<span class="keyword">this</span>.paging=!<span class="number">1</span>,c=!<span class="number">0</span>)&#125;<span class="keyword">return</span> c&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Strategy.Paging"</span>&#125;);OpenLayers.Control.DragFeature=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">geometryTypes</span>:<span class="literal">null</span>,<span class="attr">onStart</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">onDrag</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">onComplete</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;&#125;,<span class="attr">onEnter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">onLeave</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">documentDrag</span>:!<span class="number">1</span>,<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">feature</span>:<span class="literal">null</span>,<span class="attr">dragCallbacks</span>:&#123;&#125;,<span class="attr">featureCallbacks</span>:&#123;&#125;,<span class="attr">lastPixel</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[b]);<span class="keyword">this</span>.layer=a;<span class="keyword">this</span>.handlers=&#123;<span class="attr">drag</span>:<span class="keyword">new</span> OpenLayers.Handler.Drag(<span class="keyword">this</span>,OpenLayers.Util.extend(&#123;<span class="attr">down</span>:<span class="keyword">this</span>.downFeature,<span class="attr">move</span>:<span class="keyword">this</span>.moveFeature,</span><br><span class="line">up:<span class="keyword">this</span>.upFeature,<span class="attr">out</span>:<span class="keyword">this</span>.cancel,<span class="attr">done</span>:<span class="keyword">this</span>.doneDragging&#125;,<span class="keyword">this</span>.dragCallbacks),&#123;<span class="attr">documentDrag</span>:<span class="keyword">this</span>.documentDrag&#125;),<span class="attr">feature</span>:<span class="keyword">new</span> OpenLayers.Handler.Feature(<span class="keyword">this</span>,<span class="keyword">this</span>.layer,OpenLayers.Util.extend(&#123;<span class="attr">click</span>:<span class="keyword">this</span>.clickFeature,<span class="attr">clickout</span>:<span class="keyword">this</span>.clickoutFeature,<span class="attr">over</span>:<span class="keyword">this</span>.overFeature,<span class="attr">out</span>:<span class="keyword">this</span>.outFeature&#125;,<span class="keyword">this</span>.featureCallbacks),&#123;<span class="attr">geometryTypes</span>:<span class="keyword">this</span>.geometryTypes&#125;)&#125;&#125;,<span class="attr">clickFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.handlers.feature.touch&amp;&amp;(!<span class="keyword">this</span>.over&amp;&amp;<span class="keyword">this</span>.overFeature(a))&amp;&amp;(<span class="keyword">this</span>.handlers.drag.dragstart(<span class="keyword">this</span>.handlers.feature.evt),<span class="keyword">this</span>.handlers.drag.stopDown=</span><br><span class="line">!<span class="number">1</span>)&#125;,<span class="attr">clickoutFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.handlers.feature.touch&amp;&amp;<span class="keyword">this</span>.over&amp;&amp;(<span class="keyword">this</span>.outFeature(a),<span class="keyword">this</span>.handlers.drag.stopDown=!<span class="number">0</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.layer=<span class="literal">null</span>;OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,[])&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.handlers.feature.activate()&amp;&amp;OpenLayers.Control.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.handlers.drag.deactivate();<span class="keyword">this</span>.handlers.feature.deactivate();<span class="keyword">this</span>.feature=<span class="literal">null</span>;<span class="keyword">this</span>.dragging=!<span class="number">1</span>;<span class="keyword">this</span>.lastPixel=<span class="literal">null</span>;OpenLayers.Element.removeClass(<span class="keyword">this</span>.map.viewPortDiv,</span><br><span class="line"><span class="keyword">this</span>.displayClass+<span class="string">"Over"</span>);<span class="keyword">return</span> OpenLayers.Control.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">overFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>;<span class="keyword">this</span>.handlers.drag.dragging?<span class="keyword">this</span>.over=<span class="keyword">this</span>.feature.id==a.id?!<span class="number">0</span>:!<span class="number">1</span>:(<span class="keyword">this</span>.feature=a,<span class="keyword">this</span>.handlers.drag.activate(),<span class="keyword">this</span>.over=b=!<span class="number">0</span>,OpenLayers.Element.addClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="keyword">this</span>.displayClass+<span class="string">"Over"</span>),<span class="keyword">this</span>.onEnter(a));<span class="keyword">return</span> b&#125;,<span class="attr">downFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.lastPixel=a;<span class="keyword">this</span>.onStart(<span class="keyword">this</span>.feature,a)&#125;,<span class="attr">moveFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getResolution();<span class="keyword">this</span>.feature.geometry.move(b*</span><br><span class="line">(a.x-<span class="keyword">this</span>.lastPixel.x),b*(<span class="keyword">this</span>.lastPixel.y-a.y));<span class="keyword">this</span>.layer.drawFeature(<span class="keyword">this</span>.feature);<span class="keyword">this</span>.lastPixel=a;<span class="keyword">this</span>.onDrag(<span class="keyword">this</span>.feature,a)&#125;,<span class="attr">upFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.over||<span class="keyword">this</span>.handlers.drag.deactivate()&#125;,<span class="attr">doneDragging</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.onComplete(<span class="keyword">this</span>.feature,a)&#125;,<span class="attr">outFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.handlers.drag.dragging?<span class="keyword">this</span>.feature.id==a.id&amp;&amp;(<span class="keyword">this</span>.over=!<span class="number">1</span>):(<span class="keyword">this</span>.over=!<span class="number">1</span>,<span class="keyword">this</span>.handlers.drag.deactivate(),OpenLayers.Element.removeClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="keyword">this</span>.displayClass+<span class="string">"Over"</span>),<span class="keyword">this</span>.onLeave(a),<span class="keyword">this</span>.feature=<span class="literal">null</span>)&#125;,</span><br><span class="line">cancel:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.handlers.drag.deactivate();<span class="keyword">this</span>.over=!<span class="number">1</span>&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.handlers.drag.setMap(a);<span class="keyword">this</span>.handlers.feature.setMap(a);OpenLayers.Control.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.DragFeature"</span>&#125;);OpenLayers.Control.TransformFeature=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">geometryTypes</span>:<span class="literal">null</span>,<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">preserveAspectRatio</span>:!<span class="number">1</span>,<span class="attr">rotate</span>:!<span class="number">0</span>,<span class="attr">feature</span>:<span class="literal">null</span>,<span class="attr">renderIntent</span>:<span class="string">"temporary"</span>,<span class="attr">rotationHandleSymbolizer</span>:<span class="literal">null</span>,<span class="attr">box</span>:<span class="literal">null</span>,<span class="attr">center</span>:<span class="literal">null</span>,<span class="attr">scale</span>:<span class="number">1</span>,<span class="attr">ratio</span>:<span class="number">1</span>,<span class="attr">rotation</span>:<span class="number">0</span>,<span class="attr">handles</span>:<span class="literal">null</span>,<span class="attr">rotationHandles</span>:<span class="literal">null</span>,<span class="attr">dragControl</span>:<span class="literal">null</span>,<span class="attr">irregular</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[b]);<span class="keyword">this</span>.layer=a;<span class="keyword">this</span>.rotationHandleSymbolizer||(<span class="keyword">this</span>.rotationHandleSymbolizer=&#123;<span class="attr">stroke</span>:!<span class="number">1</span>,<span class="attr">pointRadius</span>:<span class="number">10</span>,<span class="attr">fillOpacity</span>:<span class="number">0</span>,</span><br><span class="line">cursor:<span class="string">"pointer"</span>&#125;);<span class="keyword">this</span>.createBox();<span class="keyword">this</span>.createControl()&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;OpenLayers.Control.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&amp;&amp;(<span class="keyword">this</span>.dragControl.activate(),<span class="keyword">this</span>.layer.addFeatures([<span class="keyword">this</span>.box]),<span class="keyword">this</span>.rotate&amp;&amp;<span class="keyword">this</span>.layer.addFeatures(<span class="keyword">this</span>.rotationHandles),<span class="keyword">this</span>.layer.addFeatures(<span class="keyword">this</span>.handles),a=!<span class="number">0</span>);<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;OpenLayers.Control.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&amp;&amp;(<span class="keyword">this</span>.layer.removeFeatures(<span class="keyword">this</span>.handles),<span class="keyword">this</span>.rotate&amp;&amp;<span class="keyword">this</span>.layer.removeFeatures(<span class="keyword">this</span>.rotationHandles),</span><br><span class="line"><span class="keyword">this</span>.layer.removeFeatures([<span class="keyword">this</span>.box]),<span class="keyword">this</span>.dragControl.deactivate(),a=!<span class="number">0</span>);<span class="keyword">return</span> a&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.dragControl.setMap(a);OpenLayers.Control.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">setFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=OpenLayers.Util.applyDefaults(b,&#123;<span class="attr">rotation</span>:<span class="number">0</span>,<span class="attr">scale</span>:<span class="number">1</span>,<span class="attr">ratio</span>:<span class="number">1</span>&#125;);<span class="keyword">var</span> c=<span class="keyword">this</span>.rotation,d=<span class="keyword">this</span>.center;OpenLayers.Util.extend(<span class="keyword">this</span>,b);<span class="keyword">if</span>(!<span class="number">1</span>!==<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforesetfeature"</span>,&#123;<span class="attr">feature</span>:a&#125;))&#123;<span class="keyword">this</span>.feature=a;<span class="keyword">this</span>.activate();<span class="keyword">this</span>._setfeature=!<span class="number">0</span>;<span class="keyword">var</span> e=<span class="keyword">this</span>.feature.geometry.getBounds();<span class="keyword">this</span>.box.move(e.getCenterLonLat());</span><br><span class="line"><span class="keyword">this</span>.box.geometry.rotate(-c,d);<span class="keyword">this</span>._angle=<span class="number">0</span>;<span class="keyword">this</span>.rotation?(c=a.geometry.clone(),c.rotate(-<span class="keyword">this</span>.rotation,<span class="keyword">this</span>.center),c=<span class="keyword">new</span> OpenLayers.Feature.Vector(c.getBounds().toGeometry()),c.geometry.rotate(<span class="keyword">this</span>.rotation,<span class="keyword">this</span>.center),<span class="keyword">this</span>.box.geometry.rotate(<span class="keyword">this</span>.rotation,<span class="keyword">this</span>.center),<span class="keyword">this</span>.box.move(c.geometry.getBounds().getCenterLonLat()),c=c.geometry.components[<span class="number">0</span>].components[<span class="number">0</span>].getBounds().getCenterLonLat()):c=<span class="keyword">new</span> OpenLayers.LonLat(e.left,e.bottom);<span class="keyword">this</span>.handles[<span class="number">0</span>].move(c);<span class="keyword">delete</span> <span class="keyword">this</span>._setfeature;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"setfeature"</span>,</span><br><span class="line">&#123;<span class="attr">feature</span>:a&#125;)&#125;&#125;,<span class="attr">unsetFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.active?<span class="keyword">this</span>.deactivate():(<span class="keyword">this</span>.feature=<span class="literal">null</span>,<span class="keyword">this</span>.rotation=<span class="number">0</span>,<span class="keyword">this</span>.ratio=<span class="keyword">this</span>.scale=<span class="number">1</span>)&#125;,<span class="attr">createBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>;<span class="keyword">this</span>.center=<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="number">0</span>,<span class="number">0</span>);<span class="keyword">this</span>.box=<span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.LineString([<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="number">-1</span>,<span class="number">-1</span>),<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="number">0</span>,<span class="number">-1</span>),<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="number">1</span>,<span class="number">-1</span>),<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="number">1</span>,<span class="number">0</span>),<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="number">1</span>,<span class="number">1</span>),<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="number">0</span>,<span class="number">1</span>),<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="number">-1</span>,</span><br><span class="line"><span class="number">1</span>),<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="number">-1</span>,<span class="number">0</span>),<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="number">-1</span>,<span class="number">-1</span>)]),<span class="literal">null</span>,<span class="string">"string"</span>==<span class="keyword">typeof</span> <span class="keyword">this</span>.renderIntent?<span class="literal">null</span>:<span class="keyword">this</span>.renderIntent);<span class="keyword">this</span>.box.geometry.move=<span class="function"><span class="keyword">function</span>(<span class="params">b,c</span>)</span>&#123;a._moving=!<span class="number">0</span>;OpenLayers.Geometry.LineString.prototype.move.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);a.center.move(b,c);<span class="keyword">delete</span> a._moving&#125;;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Geometry.Point.prototype.move.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>._rotationHandle&amp;&amp;<span class="keyword">this</span>._rotationHandle.geometry.move(a,b);<span class="keyword">this</span>._handle.geometry.move(a,b)&#125;,c=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Geometry.Point.prototype.resize.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>);<span class="keyword">this</span>._rotationHandle&amp;&amp;<span class="keyword">this</span>._rotationHandle.geometry.resize(a,b,c);<span class="keyword">this</span>._handle.geometry.resize(a,b,c)&#125;,d=<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Geometry.Point.prototype.rotate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>._rotationHandle&amp;&amp;<span class="keyword">this</span>._rotationHandle.geometry.rotate(a,b);<span class="keyword">this</span>._handle.geometry.rotate(a,b)&#125;,e=<span class="function"><span class="keyword">function</span>(<span class="params">b,c</span>)</span>&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.x,e=<span class="keyword">this</span>.y;OpenLayers.Geometry.Point.prototype.move.call(<span class="keyword">this</span>,b,c);<span class="keyword">if</span>(!a._moving)&#123;<span class="keyword">var</span> f=a.dragControl.handlers.drag.evt,g=!(!a._setfeature&amp;&amp;a.preserveAspectRatio)&amp;&amp;!(f&amp;&amp;f.shiftKey),</span><br><span class="line">h=<span class="keyword">new</span> OpenLayers.Geometry.Point(d,e),f=a.center;<span class="keyword">this</span>.rotate(-a.rotation,f);h.rotate(-a.rotation,f);<span class="keyword">var</span> k=<span class="keyword">this</span>.x-f.x,l=<span class="keyword">this</span>.y-f.y,m=k-(<span class="keyword">this</span>.x-h.x),n=l-(<span class="keyword">this</span>.y-h.y);a.irregular&amp;&amp;!a._setfeature&amp;&amp;(k-=(<span class="keyword">this</span>.x-h.x)/<span class="number">2</span>,l-=(<span class="keyword">this</span>.y-h.y)/<span class="number">2</span>);<span class="keyword">this</span>.x=d;<span class="keyword">this</span>.y=e;h=<span class="number">1</span>;g?(l=<span class="number">1E-5</span>&gt;<span class="built_in">Math</span>.abs(n)?<span class="number">1</span>:l/n,h=(<span class="number">1E-5</span>&gt;<span class="built_in">Math</span>.abs(m)?<span class="number">1</span>:k/m)/l):(m=<span class="built_in">Math</span>.sqrt(m*m+n*n),l=<span class="built_in">Math</span>.sqrt(k*k+l*l)/m);a._moving=!<span class="number">0</span>;a.box.geometry.rotate(-a.rotation,f);<span class="keyword">delete</span> a._moving;a.box.geometry.resize(l,f,h);a.box.geometry.rotate(a.rotation,f);a.transformFeature(&#123;<span class="attr">scale</span>:l,</span><br><span class="line">ratio:h&#125;);a.irregular&amp;&amp;!a._setfeature&amp;&amp;(k=f.clone(),k.x+=<span class="number">1E-5</span>&gt;<span class="built_in">Math</span>.abs(d-f.x)?<span class="number">0</span>:<span class="keyword">this</span>.x-d,k.y+=<span class="number">1E-5</span>&gt;<span class="built_in">Math</span>.abs(e-f.y)?<span class="number">0</span>:<span class="keyword">this</span>.y-e,a.box.geometry.move(<span class="keyword">this</span>.x-d,<span class="keyword">this</span>.y-e),a.transformFeature(&#123;<span class="attr">center</span>:k&#125;))&#125;&#125;,f=<span class="function"><span class="keyword">function</span>(<span class="params">b,c</span>)</span>&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.x,e=<span class="keyword">this</span>.y;OpenLayers.Geometry.Point.prototype.move.call(<span class="keyword">this</span>,b,c);<span class="keyword">if</span>(!a._moving)&#123;<span class="keyword">var</span> f=a.dragControl.handlers.drag.evt,f=f&amp;&amp;f.shiftKey?<span class="number">45</span>:<span class="number">1</span>,g=a.center,h=<span class="keyword">this</span>.x-g.x,k=<span class="keyword">this</span>.y-g.y;<span class="keyword">this</span>.x=d;<span class="keyword">this</span>.y=e;d=<span class="built_in">Math</span>.atan2(k-c,h-b);d=<span class="built_in">Math</span>.atan2(k,h)-d;d*=<span class="number">180</span>/<span class="built_in">Math</span>.PI;a._angle=(a._angle+d)%</span><br><span class="line"><span class="number">360</span>;d=a.rotation%f;<span class="keyword">if</span>(<span class="built_in">Math</span>.abs(a._angle)&gt;=f||<span class="number">0</span>!==d)d=<span class="built_in">Math</span>.round(a._angle/f)*f-d,a._angle=<span class="number">0</span>,a.box.geometry.rotate(d,g),a.transformFeature(&#123;<span class="attr">rotation</span>:d&#125;)&#125;&#125;,g=<span class="built_in">Array</span>(<span class="number">8</span>),h=<span class="built_in">Array</span>(<span class="number">4</span>),k,l,m,n=<span class="string">"sw s se e ne n nw w"</span>.split(<span class="string">" "</span>),p=<span class="number">0</span>;<span class="number">8</span>&gt;p;++p)k=<span class="keyword">this</span>.box.geometry.components[p],l=<span class="keyword">new</span> OpenLayers.Feature.Vector(k.clone(),&#123;<span class="attr">role</span>:n[p]+<span class="string">"-resize"</span>&#125;,<span class="string">"string"</span>==<span class="keyword">typeof</span> <span class="keyword">this</span>.renderIntent?<span class="literal">null</span>:<span class="keyword">this</span>.renderIntent),<span class="number">0</span>==p%<span class="number">2</span>&amp;&amp;(m=<span class="keyword">new</span> OpenLayers.Feature.Vector(k.clone(),&#123;<span class="attr">role</span>:n[p]+<span class="string">"-rotate"</span>&#125;,<span class="string">"string"</span>==<span class="keyword">typeof</span> <span class="keyword">this</span>.rotationHandleSymbolizer?</span><br><span class="line"><span class="literal">null</span>:<span class="keyword">this</span>.rotationHandleSymbolizer),m.geometry.move=f,k._rotationHandle=m,h[p/<span class="number">2</span>]=m),k.move=b,k.resize=c,k.rotate=d,l.geometry.move=e,k._handle=l,g[p]=l;<span class="keyword">this</span>.rotationHandles=h;<span class="keyword">this</span>.handles=g&#125;,<span class="attr">createControl</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>;<span class="keyword">this</span>.dragControl=<span class="keyword">new</span> OpenLayers.Control.DragFeature(<span class="keyword">this</span>.layer,&#123;<span class="attr">documentDrag</span>:!<span class="number">0</span>,<span class="attr">moveFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">b</span>)</span>&#123;<span class="keyword">this</span>.feature===a.feature&amp;&amp;(<span class="keyword">this</span>.feature=a.box);OpenLayers.Control.DragFeature.prototype.moveFeature.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">onDrag</span>:<span class="function"><span class="keyword">function</span>(<span class="params">b,c</span>)</span>&#123;b===a.box&amp;&amp;a.transformFeature(&#123;<span class="attr">center</span>:a.center&#125;)&#125;,</span><br><span class="line">onStart:<span class="function"><span class="keyword">function</span>(<span class="params">b,c</span>)</span>&#123;<span class="keyword">var</span> d=!a.geometryTypes||<span class="number">-1</span>!==OpenLayers.Util.indexOf(a.geometryTypes,b.geometry.CLASS_NAME),e=OpenLayers.Util.indexOf(a.handles,b),e=e+OpenLayers.Util.indexOf(a.rotationHandles,b);b!==a.feature&amp;&amp;(b!==a.box&amp;&amp;<span class="number">-2</span>==e&amp;&amp;d)&amp;&amp;a.setFeature(b)&#125;,<span class="attr">onComplete</span>:<span class="function"><span class="keyword">function</span>(<span class="params">b,c</span>)</span>&#123;a.events.triggerEvent(<span class="string">"transformcomplete"</span>,&#123;<span class="attr">feature</span>:a.feature&#125;)&#125;&#125;)&#125;,<span class="attr">drawHandles</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.layer,b=<span class="number">0</span>;<span class="number">8</span>&gt;b;++b)<span class="keyword">this</span>.rotate&amp;&amp;<span class="number">0</span>===b%<span class="number">2</span>&amp;&amp;a.drawFeature(<span class="keyword">this</span>.rotationHandles[b/<span class="number">2</span>],<span class="keyword">this</span>.rotationHandleSymbolizer),a.drawFeature(<span class="keyword">this</span>.handles[b],</span><br><span class="line"><span class="keyword">this</span>.renderIntent)&#125;,<span class="attr">transformFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>._setfeature)&#123;<span class="keyword">this</span>.scale*=a.scale||<span class="number">1</span>;<span class="keyword">this</span>.ratio*=a.ratio||<span class="number">1</span>;<span class="keyword">var</span> b=<span class="keyword">this</span>.rotation;<span class="keyword">this</span>.rotation=(<span class="keyword">this</span>.rotation+(a.rotation||<span class="number">0</span>))%<span class="number">360</span>;<span class="keyword">if</span>(!<span class="number">1</span>!==<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforetransform"</span>,a))&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.feature,d=c.geometry,e=<span class="keyword">this</span>.center;d.rotate(-b,e);a.scale||a.ratio?d.resize(a.scale,e,a.ratio):a.center&amp;&amp;c.move(a.center.getBounds().getCenterLonLat());d.rotate(<span class="keyword">this</span>.rotation,e);<span class="keyword">this</span>.layer.drawFeature(c);c.toState(OpenLayers.State.UPDATE);<span class="keyword">this</span>.events.triggerEvent(<span class="string">"transform"</span>,</span><br><span class="line">a)&#125;&#125;<span class="keyword">this</span>.layer.drawFeature(<span class="keyword">this</span>.box,<span class="keyword">this</span>.renderIntent);<span class="keyword">this</span>.drawHandles()&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a,b=<span class="number">0</span>;<span class="number">8</span>&gt;b;++b)a=<span class="keyword">this</span>.box.geometry.components[b],a._handle.destroy(),a._handle=<span class="literal">null</span>,a._rotationHandle&amp;&amp;a._rotationHandle.destroy(),a._rotationHandle=<span class="literal">null</span>;<span class="keyword">this</span>.rotationHandles=<span class="keyword">this</span>.rotationHandleSymbolizer=<span class="keyword">this</span>.handles=<span class="keyword">this</span>.feature=<span class="keyword">this</span>.center=<span class="literal">null</span>;<span class="keyword">this</span>.box.destroy();<span class="keyword">this</span>.layer=<span class="keyword">this</span>.box=<span class="literal">null</span>;<span class="keyword">this</span>.dragControl.destroy();<span class="keyword">this</span>.dragControl=<span class="literal">null</span>;OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,</span><br><span class="line">CLASS_NAME:<span class="string">"OpenLayers.Control.TransformFeature"</span>&#125;);OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,&#123;<span class="attr">dragHandler</span>:<span class="literal">null</span>,<span class="attr">boxDivClassName</span>:<span class="string">"olHandlerBoxZoomBox"</span>,<span class="attr">boxOffsets</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Handler.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.dragHandler=<span class="keyword">new</span> OpenLayers.Handler.Drag(<span class="keyword">this</span>,&#123;<span class="attr">down</span>:<span class="keyword">this</span>.startBox,<span class="attr">move</span>:<span class="keyword">this</span>.moveBox,<span class="attr">out</span>:<span class="keyword">this</span>.removeBox,<span class="attr">up</span>:<span class="keyword">this</span>.endBox&#125;,&#123;<span class="attr">keyMask</span>:<span class="keyword">this</span>.keyMask&#125;)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Handler.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.dragHandler&amp;&amp;(<span class="keyword">this</span>.dragHandler.destroy(),<span class="keyword">this</span>.dragHandler=</span><br><span class="line"><span class="literal">null</span>)&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Handler.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.dragHandler&amp;&amp;<span class="keyword">this</span>.dragHandler.setMap(a)&#125;,<span class="attr">startBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.callback(<span class="string">"start"</span>,[]);<span class="keyword">this</span>.zoomBox=OpenLayers.Util.createDiv(<span class="string">"zoomBox"</span>,&#123;<span class="attr">x</span>:<span class="number">-9999</span>,<span class="attr">y</span>:<span class="number">-9999</span>&#125;);<span class="keyword">this</span>.zoomBox.className=<span class="keyword">this</span>.boxDivClassName;<span class="keyword">this</span>.zoomBox.style.zIndex=<span class="keyword">this</span>.map.Z_INDEX_BASE.Popup<span class="number">-1</span>;<span class="keyword">this</span>.map.viewPortDiv.appendChild(<span class="keyword">this</span>.zoomBox);OpenLayers.Element.addClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olDrawBox"</span>)&#125;,<span class="attr">moveBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.dragHandler.start.x,</span><br><span class="line">c=<span class="keyword">this</span>.dragHandler.start.y,d=<span class="built_in">Math</span>.abs(b-a.x),e=<span class="built_in">Math</span>.abs(c-a.y),f=<span class="keyword">this</span>.getBoxOffsets();<span class="keyword">this</span>.zoomBox.style.width=d+f.width+<span class="number">1</span>+<span class="string">"px"</span>;<span class="keyword">this</span>.zoomBox.style.height=e+f.height+<span class="number">1</span>+<span class="string">"px"</span>;<span class="keyword">this</span>.zoomBox.style.left=(a.x&lt;b?b-d-f.left:b-f.left)+<span class="string">"px"</span>;<span class="keyword">this</span>.zoomBox.style.top=(a.y&lt;c?c-e-f.top:c-f.top)+<span class="string">"px"</span>&#125;,<span class="attr">endBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;<span class="keyword">if</span>(<span class="number">5</span>&lt;<span class="built_in">Math</span>.abs(<span class="keyword">this</span>.dragHandler.start.x-a.x)||<span class="number">5</span>&lt;<span class="built_in">Math</span>.abs(<span class="keyword">this</span>.dragHandler.start.y-a.y))&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.dragHandler.start;b=<span class="built_in">Math</span>.min(c.y,a.y);<span class="keyword">var</span> d=<span class="built_in">Math</span>.max(c.y,a.y),e=<span class="built_in">Math</span>.min(c.x,a.x);a=<span class="built_in">Math</span>.max(c.x,</span><br><span class="line">a.x);b=<span class="keyword">new</span> OpenLayers.Bounds(e,d,a,b)&#125;<span class="keyword">else</span> b=<span class="keyword">this</span>.dragHandler.start.clone();<span class="keyword">this</span>.removeBox();<span class="keyword">this</span>.callback(<span class="string">"done"</span>,[b])&#125;,<span class="attr">removeBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.map.viewPortDiv.removeChild(<span class="keyword">this</span>.zoomBox);<span class="keyword">this</span>.boxOffsets=<span class="keyword">this</span>.zoomBox=<span class="literal">null</span>;OpenLayers.Element.removeClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olDrawBox"</span>)&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Handler.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)?(<span class="keyword">this</span>.dragHandler.activate(),!<span class="number">0</span>):!<span class="number">1</span>&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Handler.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)?</span><br><span class="line">(<span class="keyword">this</span>.dragHandler.deactivate()&amp;&amp;<span class="keyword">this</span>.zoomBox&amp;&amp;<span class="keyword">this</span>.removeBox(),!<span class="number">0</span>):!<span class="number">1</span>&#125;,<span class="attr">getBoxOffsets</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.boxOffsets)&#123;<span class="keyword">var</span> a=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);a.style.position=<span class="string">"absolute"</span>;a.style.border=<span class="string">"1px solid black"</span>;a.style.width=<span class="string">"3px"</span>;<span class="built_in">document</span>.body.appendChild(a);<span class="keyword">var</span> b=<span class="number">3</span>==a.clientWidth;<span class="built_in">document</span>.body.removeChild(a);<span class="keyword">var</span> a=<span class="built_in">parseInt</span>(OpenLayers.Element.getStyle(<span class="keyword">this</span>.zoomBox,<span class="string">"border-left-width"</span>)),c=<span class="built_in">parseInt</span>(OpenLayers.Element.getStyle(<span class="keyword">this</span>.zoomBox,<span class="string">"border-right-width"</span>)),d=<span class="built_in">parseInt</span>(OpenLayers.Element.getStyle(<span class="keyword">this</span>.zoomBox,</span><br><span class="line"><span class="string">"border-top-width"</span>)),e=<span class="built_in">parseInt</span>(OpenLayers.Element.getStyle(<span class="keyword">this</span>.zoomBox,<span class="string">"border-bottom-width"</span>));<span class="keyword">this</span>.boxOffsets=&#123;<span class="attr">left</span>:a,<span class="attr">right</span>:c,<span class="attr">top</span>:d,<span class="attr">bottom</span>:e,<span class="attr">width</span>:!<span class="number">1</span>===b?a+c:<span class="number">0</span>,<span class="attr">height</span>:!<span class="number">1</span>===b?d+e:<span class="number">0</span>&#125;&#125;<span class="keyword">return</span> <span class="keyword">this</span>.boxOffsets&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Handler.Box"</span>&#125;);OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">type</span>:OpenLayers.Control.TYPE_TOOL,<span class="attr">out</span>:!<span class="number">1</span>,<span class="attr">keyMask</span>:<span class="literal">null</span>,<span class="attr">alwaysZoom</span>:!<span class="number">1</span>,<span class="attr">zoomOnClick</span>:!<span class="number">0</span>,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.handler=<span class="keyword">new</span> OpenLayers.Handler.Box(<span class="keyword">this</span>,&#123;<span class="attr">done</span>:<span class="keyword">this</span>.zoomBox&#125;,&#123;<span class="attr">keyMask</span>:<span class="keyword">this</span>.keyMask&#125;)&#125;,<span class="attr">zoomBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a <span class="keyword">instanceof</span> OpenLayers.Bounds)&#123;<span class="keyword">var</span> b,c=a.getCenterPixel();<span class="keyword">if</span>(<span class="keyword">this</span>.out)&#123;b=<span class="built_in">Math</span>.min(<span class="keyword">this</span>.map.size.h/(a.bottom-a.top),<span class="keyword">this</span>.map.size.w/(a.right-a.left));<span class="keyword">var</span> d=<span class="keyword">this</span>.map.getExtent(),e=<span class="keyword">this</span>.map.getLonLatFromPixel(c),f=e.lon-d.getWidth()/</span><br><span class="line"><span class="number">2</span>*b;a=e.lon+d.getWidth()/<span class="number">2</span>*b;<span class="keyword">var</span> g=e.lat-d.getHeight()/<span class="number">2</span>*b;b=e.lat+d.getHeight()/<span class="number">2</span>*b;b=<span class="keyword">new</span> OpenLayers.Bounds(f,g,a,b)&#125;<span class="keyword">else</span> f=<span class="keyword">this</span>.map.getLonLatFromPixel(&#123;<span class="attr">x</span>:a.left,<span class="attr">y</span>:a.bottom&#125;),a=<span class="keyword">this</span>.map.getLonLatFromPixel(&#123;<span class="attr">x</span>:a.right,<span class="attr">y</span>:a.top&#125;),b=<span class="keyword">new</span> OpenLayers.Bounds(f.lon,f.lat,a.lon,a.lat);f=<span class="keyword">this</span>.map.getZoom();g=<span class="keyword">this</span>.map.getSize();a=g.w/<span class="number">2</span>;g=g.h/<span class="number">2</span>;b=<span class="keyword">this</span>.map.getZoomForExtent(b);d=<span class="keyword">this</span>.map.getResolution();e=<span class="keyword">this</span>.map.getResolutionForZoom(b);d==e?<span class="keyword">this</span>.map.setCenter(<span class="keyword">this</span>.map.getLonLatFromPixel(c)):<span class="keyword">this</span>.map.zoomTo(b,</span><br><span class="line">&#123;<span class="attr">x</span>:(d*c.x-e*a)/(d-e),<span class="attr">y</span>:(d*c.y-e*g)/(d-e)&#125;);f==<span class="keyword">this</span>.map.getZoom()&amp;&amp;!<span class="number">0</span>==<span class="keyword">this</span>.alwaysZoom&amp;&amp;<span class="keyword">this</span>.map.zoomTo(f+(<span class="keyword">this</span>.out?<span class="number">-1</span>:<span class="number">1</span>))&#125;<span class="keyword">else</span> <span class="keyword">this</span>.zoomOnClick&amp;&amp;(<span class="keyword">this</span>.out?<span class="keyword">this</span>.map.zoomTo(<span class="keyword">this</span>.map.getZoom()<span class="number">-1</span>,a):<span class="keyword">this</span>.map.zoomTo(<span class="keyword">this</span>.map.getZoom()+<span class="number">1</span>,a))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.ZoomBox"</span>&#125;);OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">type</span>:OpenLayers.Control.TYPE_TOOL,<span class="attr">panned</span>:!<span class="number">1</span>,<span class="attr">interval</span>:<span class="number">0</span>,<span class="attr">documentDrag</span>:!<span class="number">1</span>,<span class="attr">kinetic</span>:<span class="literal">null</span>,<span class="attr">enableKinetic</span>:!<span class="number">0</span>,<span class="attr">kineticInterval</span>:<span class="number">10</span>,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.enableKinetic&amp;&amp;OpenLayers.Kinetic)&#123;<span class="keyword">var</span> a=&#123;<span class="attr">interval</span>:<span class="keyword">this</span>.kineticInterval&#125;;<span class="string">"object"</span>===<span class="keyword">typeof</span> <span class="keyword">this</span>.enableKinetic&amp;&amp;(a=OpenLayers.Util.extend(a,<span class="keyword">this</span>.enableKinetic));<span class="keyword">this</span>.kinetic=<span class="keyword">new</span> OpenLayers.Kinetic(a)&#125;<span class="keyword">this</span>.handler=<span class="keyword">new</span> OpenLayers.Handler.Drag(<span class="keyword">this</span>,&#123;<span class="attr">move</span>:<span class="keyword">this</span>.panMap,<span class="attr">done</span>:<span class="keyword">this</span>.panMapDone,<span class="attr">down</span>:<span class="keyword">this</span>.panMapStart&#125;,</span><br><span class="line">&#123;<span class="attr">interval</span>:<span class="keyword">this</span>.interval,<span class="attr">documentDrag</span>:<span class="keyword">this</span>.documentDrag&#125;)&#125;,<span class="attr">panMapStart</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.kinetic&amp;&amp;<span class="keyword">this</span>.kinetic.begin()&#125;,<span class="attr">panMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.kinetic&amp;&amp;<span class="keyword">this</span>.kinetic.update(a);<span class="keyword">this</span>.panned=!<span class="number">0</span>;<span class="keyword">this</span>.map.pan(<span class="keyword">this</span>.handler.last.x-a.x,<span class="keyword">this</span>.handler.last.y-a.y,&#123;<span class="attr">dragging</span>:!<span class="number">0</span>,<span class="attr">animate</span>:!<span class="number">1</span>&#125;)&#125;,<span class="attr">panMapDone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.panned)&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="keyword">this</span>.kinetic&amp;&amp;(b=<span class="keyword">this</span>.kinetic.end(a));<span class="keyword">this</span>.map.pan(<span class="keyword">this</span>.handler.last.x-a.x,<span class="keyword">this</span>.handler.last.y-a.y,&#123;<span class="attr">dragging</span>:!!b,<span class="attr">animate</span>:!<span class="number">1</span>&#125;);<span class="keyword">if</span>(b)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>;<span class="keyword">this</span>.kinetic.move(b,<span class="function"><span class="keyword">function</span>(<span class="params">a,b,</span></span></span><br><span class="line"><span class="function"><span class="params">f</span>)</span>&#123;c.map.pan(a,b,&#123;<span class="attr">dragging</span>:!f,<span class="attr">animate</span>:!<span class="number">1</span>&#125;)&#125;)&#125;<span class="keyword">this</span>.panned=!<span class="number">1</span>&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.DragPan"</span>&#125;);OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">dragPan</span>:<span class="literal">null</span>,<span class="attr">dragPanOptions</span>:<span class="literal">null</span>,<span class="attr">pinchZoom</span>:<span class="literal">null</span>,<span class="attr">pinchZoomOptions</span>:<span class="literal">null</span>,<span class="attr">documentDrag</span>:!<span class="number">1</span>,<span class="attr">zoomBox</span>:<span class="literal">null</span>,<span class="attr">zoomBoxEnabled</span>:!<span class="number">0</span>,<span class="attr">zoomWheelEnabled</span>:!<span class="number">0</span>,<span class="attr">mouseWheelOptions</span>:<span class="literal">null</span>,<span class="attr">handleRightClicks</span>:!<span class="number">1</span>,<span class="attr">zoomBoxKeyMask</span>:OpenLayers.Handler.MOD_SHIFT,<span class="attr">autoActivate</span>:!<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.handlers=&#123;&#125;;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.deactivate();<span class="keyword">this</span>.dragPan&amp;&amp;<span class="keyword">this</span>.dragPan.destroy();<span class="keyword">this</span>.dragPan=<span class="literal">null</span>;</span><br><span class="line"><span class="keyword">this</span>.zoomBox&amp;&amp;<span class="keyword">this</span>.zoomBox.destroy();<span class="keyword">this</span>.zoomBox=<span class="literal">null</span>;<span class="keyword">this</span>.pinchZoom&amp;&amp;<span class="keyword">this</span>.pinchZoom.destroy();<span class="keyword">this</span>.pinchZoom=<span class="literal">null</span>;OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.dragPan.activate();<span class="keyword">this</span>.zoomWheelEnabled&amp;&amp;<span class="keyword">this</span>.handlers.wheel.activate();<span class="keyword">this</span>.handlers.click.activate();<span class="keyword">this</span>.zoomBoxEnabled&amp;&amp;<span class="keyword">this</span>.zoomBox.activate();<span class="keyword">this</span>.pinchZoom&amp;&amp;<span class="keyword">this</span>.pinchZoom.activate();<span class="keyword">return</span> OpenLayers.Control.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.pinchZoom&amp;&amp;<span class="keyword">this</span>.pinchZoom.deactivate();</span><br><span class="line"><span class="keyword">this</span>.zoomBox.deactivate();<span class="keyword">this</span>.dragPan.deactivate();<span class="keyword">this</span>.handlers.click.deactivate();<span class="keyword">this</span>.handlers.wheel.deactivate();<span class="keyword">return</span> OpenLayers.Control.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.handleRightClicks&amp;&amp;(<span class="keyword">this</span>.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False);<span class="keyword">this</span>.handlers.click=<span class="keyword">new</span> OpenLayers.Handler.Click(<span class="keyword">this</span>,&#123;<span class="attr">click</span>:<span class="keyword">this</span>.defaultClick,<span class="attr">dblclick</span>:<span class="keyword">this</span>.defaultDblClick,<span class="attr">dblrightclick</span>:<span class="keyword">this</span>.defaultDblRightClick&#125;,&#123;<span class="string">"double"</span>:!<span class="number">0</span>,<span class="attr">stopDouble</span>:!<span class="number">0</span>&#125;);<span class="keyword">this</span>.dragPan=<span class="keyword">new</span> OpenLayers.Control.DragPan(OpenLayers.Util.extend(&#123;<span class="attr">map</span>:<span class="keyword">this</span>.map,</span><br><span class="line">documentDrag:<span class="keyword">this</span>.documentDrag&#125;,<span class="keyword">this</span>.dragPanOptions));<span class="keyword">this</span>.zoomBox=<span class="keyword">new</span> OpenLayers.Control.ZoomBox(&#123;<span class="attr">map</span>:<span class="keyword">this</span>.map,<span class="attr">keyMask</span>:<span class="keyword">this</span>.zoomBoxKeyMask&#125;);<span class="keyword">this</span>.dragPan.draw();<span class="keyword">this</span>.zoomBox.draw();<span class="keyword">this</span>.handlers.wheel=<span class="keyword">new</span> OpenLayers.Handler.MouseWheel(<span class="keyword">this</span>,&#123;<span class="attr">up</span>:<span class="keyword">this</span>.wheelUp,<span class="attr">down</span>:<span class="keyword">this</span>.wheelDown&#125;,OpenLayers.Util.extend(<span class="keyword">this</span>.map.fractionalZoom?&#123;&#125;:&#123;<span class="attr">cumulative</span>:!<span class="number">1</span>,<span class="attr">interval</span>:<span class="number">50</span>,<span class="attr">maxDelta</span>:<span class="number">6</span>&#125;,<span class="keyword">this</span>.mouseWheelOptions));OpenLayers.Control.PinchZoom&amp;&amp;(<span class="keyword">this</span>.pinchZoom=<span class="keyword">new</span> OpenLayers.Control.PinchZoom(OpenLayers.Util.extend(&#123;<span class="attr">map</span>:<span class="keyword">this</span>.map&#125;,</span><br><span class="line"><span class="keyword">this</span>.pinchZoomOptions)))&#125;,<span class="attr">defaultClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.lastTouches&amp;&amp;<span class="number">2</span>==a.lastTouches.length&amp;&amp;<span class="keyword">this</span>.map.zoomOut()&#125;,<span class="attr">defaultDblClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.map.zoomTo(<span class="keyword">this</span>.map.zoom+<span class="number">1</span>,a.xy)&#125;,<span class="attr">defaultDblRightClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.map.zoomTo(<span class="keyword">this</span>.map.zoom<span class="number">-1</span>,a.xy)&#125;,<span class="attr">wheelChange</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.map.fractionalZoom||(b=<span class="built_in">Math</span>.round(b));<span class="keyword">var</span> c=<span class="keyword">this</span>.map.getZoom(),d;d=<span class="built_in">Math</span>.max(c+b,<span class="number">0</span>);d=<span class="built_in">Math</span>.min(d,<span class="keyword">this</span>.map.getNumZoomLevels());d!==c&amp;&amp;<span class="keyword">this</span>.map.zoomTo(d,a.xy)&#125;,<span class="attr">wheelUp</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.wheelChange(a,b||<span class="number">1</span>)&#125;,<span class="attr">wheelDown</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">this</span>.wheelChange(a,b||<span class="number">-1</span>)&#125;,<span class="attr">disableZoomBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.zoomBoxEnabled=!<span class="number">1</span>;<span class="keyword">this</span>.zoomBox.deactivate()&#125;,<span class="attr">enableZoomBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.zoomBoxEnabled=!<span class="number">0</span>;<span class="keyword">this</span>.active&amp;&amp;<span class="keyword">this</span>.zoomBox.activate()&#125;,<span class="attr">disableZoomWheel</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.zoomWheelEnabled=!<span class="number">1</span>;<span class="keyword">this</span>.handlers.wheel.deactivate()&#125;,<span class="attr">enableZoomWheel</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.zoomWheelEnabled=!<span class="number">0</span>;<span class="keyword">this</span>.active&amp;&amp;<span class="keyword">this</span>.handlers.wheel.activate()&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.Navigation"</span>&#125;);OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">callbacks</span>:<span class="literal">null</span>,<span class="attr">multi</span>:!<span class="number">1</span>,<span class="attr">featureAdded</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[c]);<span class="keyword">this</span>.callbacks=OpenLayers.Util.extend(&#123;<span class="attr">done</span>:<span class="keyword">this</span>.drawFeature,<span class="attr">modify</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.layer.events.triggerEvent(<span class="string">"sketchmodified"</span>,&#123;<span class="attr">vertex</span>:a,<span class="attr">feature</span>:b&#125;)&#125;,<span class="attr">create</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.layer.events.triggerEvent(<span class="string">"sketchstarted"</span>,&#123;<span class="attr">vertex</span>:a,<span class="attr">feature</span>:b&#125;)&#125;&#125;,<span class="keyword">this</span>.callbacks);<span class="keyword">this</span>.layer=a;<span class="keyword">this</span>.handlerOptions=</span><br><span class="line"><span class="keyword">this</span>.handlerOptions||&#123;&#125;;<span class="keyword">this</span>.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.handlerOptions.layerOptions,&#123;<span class="attr">renderers</span>:a.renderers,<span class="attr">rendererOptions</span>:a.rendererOptions&#125;);<span class="string">"multi"</span><span class="keyword">in</span> <span class="keyword">this</span>.handlerOptions||(<span class="keyword">this</span>.handlerOptions.multi=<span class="keyword">this</span>.multi);<span class="keyword">if</span>(a=<span class="keyword">this</span>.layer.styleMap&amp;&amp;<span class="keyword">this</span>.layer.styleMap.styles.temporary)<span class="keyword">this</span>.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.handlerOptions.layerOptions,&#123;<span class="attr">styleMap</span>:<span class="keyword">new</span> OpenLayers.StyleMap(&#123;<span class="string">"default"</span>:a&#125;)&#125;);<span class="keyword">this</span>.handler=<span class="keyword">new</span> b(<span class="keyword">this</span>,<span class="keyword">this</span>.callbacks,<span class="keyword">this</span>.handlerOptions)&#125;,</span><br><span class="line">drawFeature:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">new</span> OpenLayers.Feature.Vector(a);!<span class="number">1</span>!==<span class="keyword">this</span>.layer.events.triggerEvent(<span class="string">"sketchcomplete"</span>,&#123;<span class="attr">feature</span>:a&#125;)&amp;&amp;(a.state=OpenLayers.State.INSERT,<span class="keyword">this</span>.layer.addFeatures([a]),<span class="keyword">this</span>.featureAdded(a),<span class="keyword">this</span>.events.triggerEvent(<span class="string">"featureadded"</span>,&#123;<span class="attr">feature</span>:a&#125;))&#125;,<span class="attr">insertXY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.handler&amp;&amp;<span class="keyword">this</span>.handler.line&amp;&amp;<span class="keyword">this</span>.handler.insertXY(a,b)&#125;,<span class="attr">insertDeltaXY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.handler&amp;&amp;<span class="keyword">this</span>.handler.line&amp;&amp;<span class="keyword">this</span>.handler.insertDeltaXY(a,b)&#125;,<span class="attr">insertDirectionLength</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.handler&amp;&amp;<span class="keyword">this</span>.handler.line&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.handler.insertDirectionLength(a,b)&#125;,<span class="attr">insertDeflectionLength</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.handler&amp;&amp;<span class="keyword">this</span>.handler.line&amp;&amp;<span class="keyword">this</span>.handler.insertDeflectionLength(a,b)&#125;,<span class="attr">undo</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.handler.undo&amp;&amp;<span class="keyword">this</span>.handler.undo()&#125;,<span class="attr">redo</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.handler.redo&amp;&amp;<span class="keyword">this</span>.handler.redo()&#125;,<span class="attr">finishSketch</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.handler.finishGeometry()&#125;,<span class="attr">cancel</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.handler.cancel()&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.DrawFeature"</span>&#125;);OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,&#123;<span class="attr">holeModifier</span>:<span class="literal">null</span>,<span class="attr">drawingHole</span>:!<span class="number">1</span>,<span class="attr">polygon</span>:<span class="literal">null</span>,<span class="attr">createFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.layer.getLonLatFromViewPortPx(a);a=<span class="keyword">new</span> OpenLayers.Geometry.Point(a.lon,a.lat);<span class="keyword">this</span>.point=<span class="keyword">new</span> OpenLayers.Feature.Vector(a);<span class="keyword">this</span>.line=<span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.LinearRing([<span class="keyword">this</span>.point.geometry]));<span class="keyword">this</span>.polygon=<span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.Polygon([<span class="keyword">this</span>.line.geometry]));<span class="keyword">this</span>.callback(<span class="string">"create"</span>,[<span class="keyword">this</span>.point.geometry,</span><br><span class="line"><span class="keyword">this</span>.getSketch()]);<span class="keyword">this</span>.point.geometry.clearBounds();<span class="keyword">this</span>.layer.addFeatures([<span class="keyword">this</span>.polygon,<span class="keyword">this</span>.point],&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;)&#125;,<span class="attr">addPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.drawingHole&amp;&amp;<span class="keyword">this</span>.holeModifier&amp;&amp;<span class="keyword">this</span>.evt&amp;&amp;<span class="keyword">this</span>.evt[<span class="keyword">this</span>.holeModifier])<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.point.geometry,c=<span class="keyword">this</span>.control.layer.features,d,e=c.length<span class="number">-1</span>;<span class="number">0</span>&lt;=e;--e)<span class="keyword">if</span>(d=c[e].geometry,(d <span class="keyword">instanceof</span> OpenLayers.Geometry.Polygon||d <span class="keyword">instanceof</span> OpenLayers.Geometry.MultiPolygon)&amp;&amp;d.intersects(b))&#123;b=c[e];<span class="keyword">this</span>.control.layer.removeFeatures([b],&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;);<span class="keyword">this</span>.control.layer.events.registerPriority(<span class="string">"sketchcomplete"</span>,</span><br><span class="line"><span class="keyword">this</span>,<span class="keyword">this</span>.finalizeInteriorRing);<span class="keyword">this</span>.control.layer.events.registerPriority(<span class="string">"sketchmodified"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.enforceTopology);b.geometry.addComponent(<span class="keyword">this</span>.line.geometry);<span class="keyword">this</span>.polygon=b;<span class="keyword">this</span>.drawingHole=!<span class="number">0</span>;<span class="keyword">break</span>&#125;OpenLayers.Handler.Path.prototype.addPoint.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">getCurrentPointIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.line.geometry.components.length<span class="number">-2</span>&#125;,<span class="attr">enforceTopology</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.vertex;<span class="keyword">var</span> b=<span class="keyword">this</span>.line.geometry.components;<span class="keyword">this</span>.polygon.geometry.intersects(a)||(b=b[b.length<span class="number">-3</span>],a.x=b.x,a.y=b.y)&#125;,<span class="attr">finishGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.line.geometry.removeComponent(<span class="keyword">this</span>.line.geometry.components[<span class="keyword">this</span>.line.geometry.components.length-</span><br><span class="line"><span class="number">2</span>]);<span class="keyword">this</span>.removePoint();<span class="keyword">this</span>.finalize()&#125;,<span class="attr">finalizeInteriorRing</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.line.geometry,b=<span class="number">0</span>!==a.getArea();<span class="keyword">if</span>(b)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="keyword">this</span>.polygon.geometry.components,d=c.length<span class="number">-2</span>;<span class="number">0</span>&lt;=d;--d)<span class="keyword">if</span>(a.intersects(c[d]))&#123;b=!<span class="number">1</span>;<span class="keyword">break</span>&#125;<span class="keyword">if</span>(b)a:<span class="keyword">for</span>(d=c.length<span class="number">-2</span>;<span class="number">0</span>&lt;d;--d)<span class="keyword">for</span>(<span class="keyword">var</span> e=c[d].components,f=<span class="number">0</span>,g=e.length;f&lt;g;++f)<span class="keyword">if</span>(a.containsPoint(e[f]))&#123;b=!<span class="number">1</span>;<span class="keyword">break</span> a&#125;&#125;b?<span class="keyword">this</span>.polygon.state!==OpenLayers.State.INSERT&amp;&amp;(<span class="keyword">this</span>.polygon.state=OpenLayers.State.UPDATE):<span class="keyword">this</span>.polygon.geometry.removeComponent(a);<span class="keyword">this</span>.restoreFeature();<span class="keyword">return</span>!<span class="number">1</span>&#125;,</span><br><span class="line">cancel:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.drawingHole&amp;&amp;(<span class="keyword">this</span>.polygon.geometry.removeComponent(<span class="keyword">this</span>.line.geometry),<span class="keyword">this</span>.restoreFeature(!<span class="number">0</span>));<span class="keyword">return</span> OpenLayers.Handler.Path.prototype.cancel.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">restoreFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.control.layer.events.unregister(<span class="string">"sketchcomplete"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.finalizeInteriorRing);<span class="keyword">this</span>.control.layer.events.unregister(<span class="string">"sketchmodified"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.enforceTopology);<span class="keyword">this</span>.layer.removeFeatures([<span class="keyword">this</span>.polygon],&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;);<span class="keyword">this</span>.control.layer.addFeatures([<span class="keyword">this</span>.polygon],&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;);<span class="keyword">this</span>.drawingHole=</span><br><span class="line">!<span class="number">1</span>;a||<span class="keyword">this</span>.control.layer.events.triggerEvent(<span class="string">"sketchcomplete"</span>,&#123;<span class="attr">feature</span>:<span class="keyword">this</span>.polygon&#125;)&#125;,<span class="attr">destroyFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Handler.Path.prototype.destroyFeature.call(<span class="keyword">this</span>,a);<span class="keyword">this</span>.polygon=<span class="literal">null</span>&#125;,<span class="attr">drawFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.layer.drawFeature(<span class="keyword">this</span>.polygon,<span class="keyword">this</span>.style);<span class="keyword">this</span>.layer.drawFeature(<span class="keyword">this</span>.point,<span class="keyword">this</span>.style)&#125;,<span class="attr">getSketch</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.polygon&#125;,<span class="attr">getGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.polygon&amp;&amp;<span class="keyword">this</span>.polygon.geometry;a&amp;&amp;<span class="keyword">this</span>.multi&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Geometry.MultiPolygon([a]));<span class="keyword">return</span> a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Handler.Polygon"</span>&#125;);OpenLayers.Control.EditingToolbar=OpenLayers.Class(OpenLayers.Control.Panel,&#123;<span class="attr">citeCompliant</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Control.Panel.prototype.initialize.apply(<span class="keyword">this</span>,[b]);<span class="keyword">this</span>.addControls([<span class="keyword">new</span> OpenLayers.Control.Navigation]);<span class="keyword">var</span> c=[<span class="keyword">new</span> OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Point,&#123;<span class="attr">displayClass</span>:<span class="string">"olControlDrawFeaturePoint"</span>,<span class="attr">handlerOptions</span>:&#123;<span class="attr">citeCompliant</span>:<span class="keyword">this</span>.citeCompliant&#125;&#125;),<span class="keyword">new</span> OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Path,&#123;<span class="attr">displayClass</span>:<span class="string">"olControlDrawFeaturePath"</span>,<span class="attr">handlerOptions</span>:&#123;<span class="attr">citeCompliant</span>:<span class="keyword">this</span>.citeCompliant&#125;&#125;),</span><br><span class="line"><span class="keyword">new</span> OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Polygon,&#123;<span class="attr">displayClass</span>:<span class="string">"olControlDrawFeaturePolygon"</span>,<span class="attr">handlerOptions</span>:&#123;<span class="attr">citeCompliant</span>:<span class="keyword">this</span>.citeCompliant&#125;&#125;)];<span class="keyword">this</span>.addControls(c)&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Control.Panel.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="literal">null</span>===<span class="keyword">this</span>.defaultControl&amp;&amp;(<span class="keyword">this</span>.defaultControl=<span class="keyword">this</span>.controls[<span class="number">0</span>]);<span class="keyword">return</span> a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.EditingToolbar"</span>&#125;);OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,&#123;<span class="attr">bounds</span>:<span class="literal">null</span>,<span class="attr">resolution</span>:<span class="literal">null</span>,<span class="attr">ratio</span>:<span class="number">2</span>,<span class="attr">resFactor</span>:<span class="literal">null</span>,<span class="attr">response</span>:<span class="literal">null</span>,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Strategy.prototype.activate.call(<span class="keyword">this</span>);a&amp;&amp;(<span class="keyword">this</span>.layer.events.on(&#123;<span class="attr">moveend</span>:<span class="keyword">this</span>.update,<span class="attr">refresh</span>:<span class="keyword">this</span>.update,<span class="attr">visibilitychanged</span>:<span class="keyword">this</span>.update,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;),<span class="keyword">this</span>.update());<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Strategy.prototype.deactivate.call(<span class="keyword">this</span>);a&amp;&amp;<span class="keyword">this</span>.layer.events.un(&#123;<span class="attr">moveend</span>:<span class="keyword">this</span>.update,<span class="attr">refresh</span>:<span class="keyword">this</span>.update,<span class="attr">visibilitychanged</span>:<span class="keyword">this</span>.update,</span><br><span class="line">scope:<span class="keyword">this</span>&#125;);<span class="keyword">return</span> a&#125;,<span class="attr">update</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getMapBounds();<span class="literal">null</span>!==b&amp;&amp;(a&amp;&amp;a.force||<span class="keyword">this</span>.layer.visibility&amp;&amp;<span class="keyword">this</span>.layer.calculateInRange()&amp;&amp;<span class="keyword">this</span>.invalidBounds(b))&amp;&amp;(<span class="keyword">this</span>.calculateBounds(b),<span class="keyword">this</span>.resolution=<span class="keyword">this</span>.layer.map.getResolution(),<span class="keyword">this</span>.triggerRead(a))&#125;,<span class="attr">getMapBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>===<span class="keyword">this</span>.layer.map)<span class="keyword">return</span> <span class="literal">null</span>;<span class="keyword">var</span> a=<span class="keyword">this</span>.layer.map.getExtent();a&amp;&amp;!<span class="keyword">this</span>.layer.projection.equals(<span class="keyword">this</span>.layer.map.getProjectionObject())&amp;&amp;(a=a.clone().transform(<span class="keyword">this</span>.layer.map.getProjectionObject(),<span class="keyword">this</span>.layer.projection));</span><br><span class="line"><span class="keyword">return</span> a&#125;,<span class="attr">invalidBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a||(a=<span class="keyword">this</span>.getMapBounds());a=!<span class="keyword">this</span>.bounds||!<span class="keyword">this</span>.bounds.containsBounds(a);!a&amp;&amp;<span class="keyword">this</span>.resFactor&amp;&amp;(a=<span class="keyword">this</span>.resolution/<span class="keyword">this</span>.layer.map.getResolution(),a=a&gt;=<span class="keyword">this</span>.resFactor||a&lt;=<span class="number">1</span>/<span class="keyword">this</span>.resFactor);<span class="keyword">return</span> a&#125;,<span class="attr">calculateBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a||(a=<span class="keyword">this</span>.getMapBounds());<span class="keyword">var</span> b=a.getCenterLonLat(),c=a.getWidth()*<span class="keyword">this</span>.ratio;a=a.getHeight()*<span class="keyword">this</span>.ratio;<span class="keyword">this</span>.bounds=<span class="keyword">new</span> OpenLayers.Bounds(b.lon-c/<span class="number">2</span>,b.lat-a/<span class="number">2</span>,b.lon+c/<span class="number">2</span>,b.lat+a/<span class="number">2</span>)&#125;,<span class="attr">triggerRead</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;!<span class="keyword">this</span>.response||a&amp;&amp;!<span class="number">0</span>===a.noAbort||</span><br><span class="line">(<span class="keyword">this</span>.layer.protocol.abort(<span class="keyword">this</span>.response),<span class="keyword">this</span>.layer.events.triggerEvent(<span class="string">"loadend"</span>));<span class="keyword">var</span> b=&#123;<span class="attr">filter</span>:<span class="keyword">this</span>.createFilter()&#125;;<span class="keyword">this</span>.layer.events.triggerEvent(<span class="string">"loadstart"</span>,b);<span class="keyword">this</span>.response=<span class="keyword">this</span>.layer.protocol.read(OpenLayers.Util.applyDefaults(&#123;<span class="attr">filter</span>:b.filter,<span class="attr">callback</span>:<span class="keyword">this</span>.merge,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;,a))&#125;,<span class="attr">createFilter</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:OpenLayers.Filter.Spatial.BBOX,<span class="attr">value</span>:<span class="keyword">this</span>.bounds,<span class="attr">projection</span>:<span class="keyword">this</span>.layer.projection&#125;);<span class="keyword">this</span>.layer.filter&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Filter.Logical(&#123;<span class="attr">type</span>:OpenLayers.Filter.Logical.AND,</span><br><span class="line">filters:[<span class="keyword">this</span>.layer.filter,a]&#125;));<span class="keyword">return</span> a&#125;,<span class="attr">merge</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.layer.destroyFeatures();<span class="keyword">if</span>(a.success())&#123;<span class="keyword">var</span> b=a.features;<span class="keyword">if</span>(b&amp;&amp;<span class="number">0</span>&lt;b.length)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.layer.projection,d=<span class="keyword">this</span>.layer.map.getProjectionObject();<span class="keyword">if</span>(!d.equals(c))<span class="keyword">for</span>(<span class="keyword">var</span> e,f=<span class="number">0</span>,g=b.length;f&lt;g;++f)(e=b[f].geometry)&amp;&amp;e.transform(c,d);<span class="keyword">this</span>.layer.addFeatures(b)&#125;&#125;<span class="keyword">else</span> <span class="keyword">this</span>.bounds=<span class="literal">null</span>;<span class="keyword">this</span>.response=<span class="literal">null</span>;<span class="keyword">this</span>.layer.events.triggerEvent(<span class="string">"loadend"</span>,&#123;<span class="attr">response</span>:a&#125;)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Strategy.BBOX"</span>&#125;);OpenLayers.Layer.WorldWind=OpenLayers.Class(OpenLayers.Layer.Grid,&#123;<span class="attr">DEFAULT_PARAMS</span>:&#123;&#125;,<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">lzd</span>:<span class="literal">null</span>,<span class="attr">zoomLevels</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e,f</span>)</span>&#123;<span class="keyword">this</span>.lzd=c;<span class="keyword">this</span>.zoomLevels=d;c=[];c.push(a,b,e,f);OpenLayers.Layer.Grid.prototype.initialize.apply(<span class="keyword">this</span>,c);<span class="keyword">this</span>.params=OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.params,<span class="keyword">this</span>.DEFAULT_PARAMS)&#125;,<span class="attr">getZoom</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getZoom();<span class="keyword">this</span>.map.getMaxExtent();<span class="keyword">return</span> a-=<span class="built_in">Math</span>.log(<span class="keyword">this</span>.maxResolution/(<span class="keyword">this</span>.lzd/<span class="number">512</span>))/<span class="built_in">Math</span>.log(<span class="number">2</span>)&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.adjustBounds(a);</span><br><span class="line"><span class="keyword">var</span> b=<span class="keyword">this</span>.getZoom(),c=<span class="keyword">this</span>.map.getMaxExtent(),d=<span class="keyword">this</span>.lzd/<span class="built_in">Math</span>.pow(<span class="number">2</span>,<span class="keyword">this</span>.getZoom()),e=<span class="built_in">Math</span>.floor((a.left-c.left)/d);a=<span class="built_in">Math</span>.floor((a.bottom-c.bottom)/d);<span class="keyword">return</span> <span class="keyword">this</span>.map.getResolution()&lt;=<span class="keyword">this</span>.lzd/<span class="number">512</span>&amp;&amp;<span class="keyword">this</span>.getZoom()&lt;=<span class="keyword">this</span>.zoomLevels?<span class="keyword">this</span>.getFullRequestString(&#123;<span class="attr">L</span>:b,<span class="attr">X</span>:e,<span class="attr">Y</span>:a&#125;):OpenLayers.Util.getImageLocation(<span class="string">"blank.gif"</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.WorldWind"</span>&#125;);OpenLayers.Protocol.CSW=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.CSW.DEFAULTS);<span class="keyword">var</span> b=OpenLayers.Protocol.CSW[<span class="string">"v"</span>+a.version.replace(<span class="regexp">/\./g</span>,<span class="string">"_"</span>)];<span class="keyword">if</span>(!b)<span class="keyword">throw</span><span class="string">"Unsupported CSW version: "</span>+a.version;<span class="keyword">return</span> <span class="keyword">new</span> b(a)&#125;;OpenLayers.Protocol.CSW.DEFAULTS=&#123;<span class="attr">version</span>:<span class="string">"2.0.2"</span>&#125;;OpenLayers.Format.WMTSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,&#123;<span class="attr">defaultVersion</span>:<span class="string">"1.0.0"</span>,<span class="attr">yx</span>:&#123;<span class="string">"urn:ogc:def:crs:EPSG::4326"</span>:!<span class="number">0</span>&#125;,<span class="attr">createLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(!(<span class="string">"layer"</span><span class="keyword">in</span> b))<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"Missing property 'layer' in configuration."</span>);<span class="keyword">for</span>(<span class="keyword">var</span> c=a.contents,d,e=<span class="number">0</span>,f=c.layers.length;e&lt;f;++e)<span class="keyword">if</span>(c.layers[e].identifier===b.layer)&#123;d=c.layers[e];<span class="keyword">break</span>&#125;<span class="keyword">if</span>(!d)<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"Layer not found"</span>);<span class="keyword">var</span> g=b.format;!g&amp;&amp;(d.formats&amp;&amp;d.formats.length)&amp;&amp;(g=d.formats[<span class="number">0</span>]);<span class="keyword">var</span> h;b.matrixSet?h=c.tileMatrixSets[b.matrixSet]:</span><br><span class="line"><span class="number">1</span>&lt;=d.tileMatrixSetLinks.length&amp;&amp;(h=c.tileMatrixSets[d.tileMatrixSetLinks[<span class="number">0</span>].tileMatrixSet]);<span class="keyword">if</span>(!h)<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"matrixSet not found"</span>);<span class="keyword">for</span>(<span class="keyword">var</span> k,e=<span class="number">0</span>,f=d.styles.length;e&lt;f&amp;&amp;(k=d.styles[e],!k.isDefault);++e);c=b.requestEncoding;<span class="keyword">if</span>(!c&amp;&amp;(c=<span class="string">"KVP"</span>,a.operationsMetadata.GetTile.dcp.http))&#123;<span class="keyword">var</span> l=a.operationsMetadata.GetTile.dcp.http;l.get[<span class="number">0</span>].constraints&amp;&amp;(l=l.get[<span class="number">0</span>].constraints.GetEncoding.allowedValues,l.KVP||!l.REST&amp;&amp;!l.RESTful||(c=<span class="string">"REST"</span>))&#125;<span class="keyword">var</span> l=[],m=b.params||&#123;&#125;;<span class="keyword">delete</span> b.params;<span class="keyword">for</span>(<span class="keyword">var</span> n=<span class="number">0</span>,p=d.dimensions.length;n&lt;</span><br><span class="line">p;n++)&#123;<span class="keyword">var</span> q=d.dimensions[n];l.push(q.identifier);m.hasOwnProperty(q.identifier)||(m[q.identifier]=q[<span class="string">"default"</span>])&#125;<span class="keyword">var</span> n=b.projection||h.supportedCRS.replace(<span class="regexp">/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/</span>,<span class="string">"$1:$3"</span>),p=b.units||(<span class="string">"EPSG:4326"</span>===n?<span class="string">"degrees"</span>:<span class="string">"m"</span>),q=[],r;<span class="keyword">for</span>(r <span class="keyword">in</span> h.matrixIds)h.matrixIds.hasOwnProperty(r)&amp;&amp;q.push(<span class="number">2.8E-4</span>*h.matrixIds[r].scaleDenominator/OpenLayers.METERS_PER_INCH/OpenLayers.INCHES_PER_UNIT[p]);<span class="keyword">if</span>(<span class="string">"REST"</span>===c&amp;&amp;d.resourceUrls)&#123;r=[];<span class="keyword">for</span>(<span class="keyword">var</span> f=<span class="number">0</span>,s=d.resourceUrls.length;f&lt;s;++f)e=d.resourceUrls[f],</span><br><span class="line">e.format===g&amp;&amp;<span class="string">"tile"</span>===e.resourceType&amp;&amp;r.push(e.template)&#125;<span class="keyword">else</span>&#123;s=a.operationsMetadata.GetTile.dcp.http.get;r=[];<span class="keyword">for</span>(<span class="keyword">var</span> t,e=<span class="number">0</span>,f=s.length;e&lt;f;e++)t=s[e].constraints,(!t||t&amp;&amp;t.GetEncoding.allowedValues[c])&amp;&amp;r.push(s[e].url)&#125;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Layer.WMTS(OpenLayers.Util.applyDefaults(b,&#123;<span class="attr">url</span>:r,<span class="attr">requestEncoding</span>:c,<span class="attr">name</span>:d.title,<span class="attr">style</span>:k.identifier,<span class="attr">format</span>:g,<span class="attr">matrixIds</span>:h.matrixIds,<span class="attr">matrixSet</span>:h.identifier,<span class="attr">projection</span>:n,<span class="attr">units</span>:p,<span class="attr">resolutions</span>:!<span class="number">1</span>===b.isBaseLayer?<span class="keyword">void</span> <span class="number">0</span>:q,<span class="attr">serverResolutions</span>:q,<span class="attr">tileFullExtent</span>:h.bounds,</span><br><span class="line">dimensions:l,<span class="attr">params</span>:m&#125;))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMTSCapabilities"</span>&#125;);OpenLayers.Layer.Google.v3=&#123;<span class="attr">DEFAULTS</span>:&#123;<span class="attr">sphericalMercator</span>:!<span class="number">0</span>,<span class="attr">projection</span>:<span class="string">"EPSG:900913"</span>&#125;,<span class="attr">animationEnabled</span>:!<span class="number">0</span>,<span class="attr">loadMapObject</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.type||(<span class="keyword">this</span>.type=google.maps.MapTypeId.ROADMAP);<span class="keyword">var</span> a,b=OpenLayers.Layer.Google.cache[<span class="keyword">this</span>.map.id];b?(a=b.mapObject,++b.count):(a=<span class="keyword">this</span>.map.getCenter(),b=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>),b.className=<span class="string">"olForeignContainer"</span>,b.style.width=<span class="string">"100%"</span>,b.style.height=<span class="string">"100%"</span>,a=<span class="keyword">new</span> google.maps.Map(b,&#123;<span class="attr">center</span>:a?<span class="keyword">new</span> google.maps.LatLng(a.lat,a.lon):<span class="keyword">new</span> google.maps.LatLng(<span class="number">0</span>,<span class="number">0</span>),<span class="attr">zoom</span>:<span class="keyword">this</span>.map.getZoom()||</span><br><span class="line"><span class="number">0</span>,<span class="attr">mapTypeId</span>:<span class="keyword">this</span>.type,<span class="attr">disableDefaultUI</span>:!<span class="number">0</span>,<span class="attr">keyboardShortcuts</span>:!<span class="number">1</span>,<span class="attr">draggable</span>:!<span class="number">1</span>,<span class="attr">disableDoubleClickZoom</span>:!<span class="number">0</span>,<span class="attr">scrollwheel</span>:!<span class="number">1</span>,<span class="attr">streetViewControl</span>:!<span class="number">1</span>&#125;),b=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>),b.style.width=<span class="string">"100%"</span>,b.style.height=<span class="string">"100%"</span>,a.controls[google.maps.ControlPosition.TOP_LEFT].push(b),b=&#123;<span class="attr">googleControl</span>:b,<span class="attr">mapObject</span>:a,<span class="attr">count</span>:<span class="number">1</span>&#125;,OpenLayers.Layer.Google.cache[<span class="keyword">this</span>.map.id]=b);<span class="keyword">this</span>.mapObject=a;<span class="keyword">this</span>.setGMapVisibility(<span class="keyword">this</span>.visibility)&#125;,<span class="attr">onMapResize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.visibility&amp;&amp;google.maps.event.trigger(<span class="keyword">this</span>.mapObject,<span class="string">"resize"</span>)&#125;,</span><br><span class="line">setGMapVisibility:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Layer.Google.cache[<span class="keyword">this</span>.map.id],c=<span class="keyword">this</span>.map;<span class="keyword">if</span>(b)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="keyword">this</span>.type,e=c.layers,f,g=e.length<span class="number">-1</span>;<span class="number">0</span>&lt;=g;--g)<span class="keyword">if</span>(f=e[g],f <span class="keyword">instanceof</span> OpenLayers.Layer.Google&amp;&amp;!<span class="number">0</span>===f.visibility&amp;&amp;!<span class="number">0</span>===f.inRange)&#123;d=f.type;a=!<span class="number">0</span>;<span class="keyword">break</span>&#125;e=<span class="keyword">this</span>.mapObject.getDiv();<span class="keyword">if</span>(!<span class="number">0</span>===a)&#123;<span class="keyword">if</span>(e.parentNode!==c.div)<span class="keyword">if</span>(b.rendered)c.div.appendChild(e),b.googleControl.appendChild(c.viewPortDiv),google.maps.event.trigger(<span class="keyword">this</span>.mapObject,<span class="string">"resize"</span>);<span class="keyword">else</span>&#123;<span class="keyword">var</span> h=<span class="keyword">this</span>;google.maps.event.addListenerOnce(<span class="keyword">this</span>.mapObject,</span><br><span class="line"><span class="string">"tilesloaded"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;b.rendered=!<span class="number">0</span>;h.setGMapVisibility(h.getVisibility());h.moveTo(h.map.getCenter())&#125;)&#125;<span class="keyword">this</span>.mapObject.setMapTypeId(d)&#125;<span class="keyword">else</span> b.googleControl.hasChildNodes()&amp;&amp;(c.div.appendChild(c.viewPortDiv),c.div.removeChild(e))&#125;&#125;,<span class="attr">getMapContainer</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.mapObject.getDiv()&#125;,<span class="attr">getMapObjectBoundsFromOLBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;<span class="literal">null</span>!=a&amp;&amp;(b=<span class="keyword">this</span>.sphericalMercator?<span class="keyword">this</span>.inverseMercator(a.bottom,a.left):<span class="keyword">new</span> OpenLayers.LonLat(a.bottom,a.left),a=<span class="keyword">this</span>.sphericalMercator?<span class="keyword">this</span>.inverseMercator(a.top,</span><br><span class="line">a.right):<span class="keyword">new</span> OpenLayers.LonLat(a.top,a.right),b=<span class="keyword">new</span> google.maps.LatLngBounds(<span class="keyword">new</span> google.maps.LatLng(b.lat,b.lon),<span class="keyword">new</span> google.maps.LatLng(a.lat,a.lon)));<span class="keyword">return</span> b&#125;,<span class="attr">getMapObjectLonLatFromMapObjectPixel</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getSize(),c=<span class="keyword">this</span>.getLongitudeFromMapObjectLonLat(<span class="keyword">this</span>.mapObject.center),d=<span class="keyword">this</span>.getLatitudeFromMapObjectLonLat(<span class="keyword">this</span>.mapObject.center),e=<span class="keyword">this</span>.map.getResolution();a=<span class="keyword">new</span> OpenLayers.LonLat(c+(a.x-b.w/<span class="number">2</span>)*e,d-(a.y-b.h/<span class="number">2</span>)*e);<span class="keyword">this</span>.wrapDateLine&amp;&amp;(a=a.wrapDateLine(<span class="keyword">this</span>.maxExtent));<span class="keyword">return</span> <span class="keyword">this</span>.getMapObjectLonLatFromLonLat(a.lon,</span><br><span class="line">a.lat)&#125;,<span class="attr">getMapObjectPixelFromMapObjectLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getLongitudeFromMapObjectLonLat(a);a=<span class="keyword">this</span>.getLatitudeFromMapObjectLonLat(a);<span class="keyword">var</span> c=<span class="keyword">this</span>.map.getResolution(),d=<span class="keyword">this</span>.map.getExtent();<span class="keyword">return</span> <span class="keyword">this</span>.getMapObjectPixelFromXY(<span class="number">1</span>/c*(b-d.left),<span class="number">1</span>/c*(d.top-a))&#125;,<span class="attr">setMapObjectCenter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(!<span class="number">1</span>===<span class="keyword">this</span>.animationEnabled&amp;&amp;b!=<span class="keyword">this</span>.mapObject.zoom)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getMapContainer();google.maps.event.addListenerOnce(<span class="keyword">this</span>.mapObject,<span class="string">"idle"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;c.style.visibility=<span class="string">""</span>&#125;);c.style.visibility=<span class="string">"hidden"</span>&#125;<span class="keyword">this</span>.mapObject.setOptions(&#123;<span class="attr">center</span>:a,</span><br><span class="line">zoom:b&#125;)&#125;,<span class="attr">getMapObjectZoomFromMapObjectBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.mapObject.getBoundsZoomLevel(a)&#125;,<span class="attr">getMapObjectLonLatFromLonLat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c;<span class="keyword">this</span>.sphericalMercator?(c=<span class="keyword">this</span>.inverseMercator(a,b),c=<span class="keyword">new</span> google.maps.LatLng(c.lat,c.lon)):c=<span class="keyword">new</span> google.maps.LatLng(b,a);<span class="keyword">return</span> c&#125;,<span class="attr">getMapObjectPixelFromXY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> google.maps.Point(a,b)&#125;&#125;;OpenLayers.Format.WPSDescribeProcess=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">VERSION</span>:<span class="string">"1.0.0"</span>,<span class="attr">namespaces</span>:&#123;<span class="attr">wps</span>:<span class="string">"http://www.opengis.net/wps/1.0.0"</span>,<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows/1.1"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&#125;,<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd"</span>,<span class="attr">defaultPrefix</span>:<span class="string">"wps"</span>,<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,</span><br><span class="line">[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> b=&#123;&#125;;<span class="keyword">this</span>.readNode(a,b);<span class="keyword">return</span> b&#125;,<span class="attr">readers</span>:&#123;<span class="attr">wps</span>:&#123;<span class="attr">ProcessDescriptions</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.processDescriptions=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.processDescriptions)&#125;,<span class="attr">ProcessDescription</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">processVersion</span>:<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.wps,<span class="string">"processVersion"</span>),<span class="attr">statusSupported</span>:<span class="string">"true"</span>===a.getAttribute(<span class="string">"statusSupported"</span>),<span class="attr">storeSupported</span>:<span class="string">"true"</span>===a.getAttribute(<span class="string">"storeSupported"</span>)&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b[c.identifier]=c&#125;,<span class="attr">DataInputs</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.dataInputs=[];<span class="keyword">this</span>.readChildNodes(a,b.dataInputs)&#125;,<span class="attr">ProcessOutputs</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.processOutputs=[];<span class="keyword">this</span>.readChildNodes(a,b.processOutputs)&#125;,<span class="attr">Output</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.push(c)&#125;,<span class="attr">ComplexOutput</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.complexOutput=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.complexOutput)&#125;,<span class="attr">LiteralOutput</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.literalOutput=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.literalOutput)&#125;,<span class="attr">Input</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">maxOccurs</span>:<span class="built_in">parseInt</span>(a.getAttribute(<span class="string">"maxOccurs"</span>)),<span class="attr">minOccurs</span>:<span class="built_in">parseInt</span>(a.getAttribute(<span class="string">"minOccurs"</span>))&#125;;</span><br><span class="line"><span class="keyword">this</span>.readChildNodes(a,c);b.push(c)&#125;,<span class="attr">BoundingBoxData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.boundingBoxData=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.boundingBoxData)&#125;,<span class="attr">CRS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.CRSs||(b.CRSs=&#123;&#125;);b.CRSs[<span class="keyword">this</span>.getChildValue(a)]=!<span class="number">0</span>&#125;,<span class="attr">LiteralData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.literalData=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.literalData)&#125;,<span class="attr">ComplexData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.complexData=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.complexData)&#125;,<span class="attr">Default</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b[<span class="string">"default"</span>]=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b[<span class="string">"default"</span>])&#125;,<span class="attr">Supported</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.supported=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.supported)&#125;,</span><br><span class="line">Format:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.formats||(b.formats=&#123;&#125;);b.formats[c.mimeType]=!<span class="number">0</span>&#125;,<span class="attr">MimeType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.mimeType=<span class="keyword">this</span>.getChildValue(a)&#125;&#125;,<span class="attr">ows</span>:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WPSDescribeProcess"</span>&#125;);OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.regExes=&#123;<span class="attr">typeStr</span>:<span class="regexp">/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/</span>,<span class="attr">spaces</span>:<span class="regexp">/\s+/</span>,<span class="attr">parenComma</span>:<span class="regexp">/\)\s*,\s*\(/</span>,<span class="attr">doubleParenComma</span>:<span class="regexp">/\)\s*\)\s*,\s*\(\s*\(/</span>,<span class="attr">trimParens</span>:<span class="regexp">/^\s*\(?(.*?)\)?\s*$/</span>&#125;;OpenLayers.Format.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c;a=a.replace(<span class="regexp">/[\n\r]/g</span>,<span class="string">" "</span>);<span class="keyword">if</span>(c=<span class="keyword">this</span>.regExes.typeStr.exec(a))<span class="keyword">if</span>(a=c[<span class="number">1</span>].toLowerCase(),c=c[<span class="number">2</span>],<span class="keyword">this</span>.parse[a]&amp;&amp;(b=<span class="keyword">this</span>.parse[a].apply(<span class="keyword">this</span>,[c])),<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection)<span class="keyword">if</span>(b&amp;&amp;</span><br><span class="line"><span class="string">"OpenLayers.Feature.Vector"</span>==b.CLASS_NAME)b.geometry.transform(<span class="keyword">this</span>.externalProjection,<span class="keyword">this</span>.internalProjection);<span class="keyword">else</span> <span class="keyword">if</span>(b&amp;&amp;<span class="string">"geometrycollection"</span>!=a&amp;&amp;<span class="string">"object"</span>==<span class="keyword">typeof</span> b)<span class="keyword">for</span>(a=<span class="number">0</span>,c=b.length;a&lt;c;a++)b[a].geometry.transform(<span class="keyword">this</span>.externalProjection,<span class="keyword">this</span>.internalProjection);<span class="keyword">return</span> b&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c;a.constructor==<span class="built_in">Array</span>?c=!<span class="number">0</span>:(a=[a],c=!<span class="number">1</span>);<span class="keyword">var</span> d=[];c&amp;&amp;d.push(<span class="string">"GEOMETRYCOLLECTION("</span>);<span class="keyword">for</span>(<span class="keyword">var</span> e=<span class="number">0</span>,f=a.length;e&lt;f;++e)c&amp;&amp;<span class="number">0</span>&lt;e&amp;&amp;d.push(<span class="string">","</span>),b=a[e].geometry,d.push(<span class="keyword">this</span>.extractGeometry(b));c&amp;&amp;d.push(<span class="string">")"</span>);<span class="keyword">return</span> d.join(<span class="string">""</span>)&#125;,</span><br><span class="line">extractGeometry:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.CLASS_NAME.split(<span class="string">"."</span>)[<span class="number">2</span>].toLowerCase();<span class="keyword">if</span>(!<span class="keyword">this</span>.extract[b])<span class="keyword">return</span> <span class="literal">null</span>;<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection&amp;&amp;(a=a.clone(),a.transform(<span class="keyword">this</span>.internalProjection,<span class="keyword">this</span>.externalProjection));<span class="keyword">return</span>(<span class="string">"collection"</span>==b?<span class="string">"GEOMETRYCOLLECTION"</span>:b.toUpperCase())+<span class="string">"("</span>+<span class="keyword">this</span>.extract[b].apply(<span class="keyword">this</span>,[a])+<span class="string">")"</span>&#125;,<span class="attr">extract</span>:&#123;<span class="attr">point</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a.x+<span class="string">" "</span>+a.y&#125;,<span class="attr">multipoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>,d=a.components.length;c&lt;d;++c)b.push(<span class="string">"("</span>+<span class="keyword">this</span>.extract.point.apply(<span class="keyword">this</span>,[a.components[c]])+</span><br><span class="line"><span class="string">")"</span>);<span class="keyword">return</span> b.join(<span class="string">","</span>)&#125;,<span class="attr">linestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>,d=a.components.length;c&lt;d;++c)b.push(<span class="keyword">this</span>.extract.point.apply(<span class="keyword">this</span>,[a.components[c]]));<span class="keyword">return</span> b.join(<span class="string">","</span>)&#125;,<span class="attr">multilinestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>,d=a.components.length;c&lt;d;++c)b.push(<span class="string">"("</span>+<span class="keyword">this</span>.extract.linestring.apply(<span class="keyword">this</span>,[a.components[c]])+<span class="string">")"</span>);<span class="keyword">return</span> b.join(<span class="string">","</span>)&#125;,<span class="attr">polygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>,d=a.components.length;c&lt;d;++c)b.push(<span class="string">"("</span>+<span class="keyword">this</span>.extract.linestring.apply(<span class="keyword">this</span>,[a.components[c]])+<span class="string">")"</span>);<span class="keyword">return</span> b.join(<span class="string">","</span>)&#125;,<span class="attr">multipolygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=</span><br><span class="line">[],c=<span class="number">0</span>,d=a.components.length;c&lt;d;++c)b.push(<span class="string">"("</span>+<span class="keyword">this</span>.extract.polygon.apply(<span class="keyword">this</span>,[a.components[c]])+<span class="string">")"</span>);<span class="keyword">return</span> b.join(<span class="string">","</span>)&#125;,<span class="attr">collection</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>,d=a.components.length;c&lt;d;++c)b.push(<span class="keyword">this</span>.extractGeometry.apply(<span class="keyword">this</span>,[a.components[c]]));<span class="keyword">return</span> b.join(<span class="string">","</span>)&#125;&#125;,<span class="attr">parse</span>:&#123;<span class="attr">point</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.String.trim(a).split(<span class="keyword">this</span>.regExes.spaces);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.Point(a[<span class="number">0</span>],a[<span class="number">1</span>]))&#125;,<span class="attr">multipoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=OpenLayers.String.trim(a).split(<span class="string">","</span>),</span><br><span class="line">c=[],d=<span class="number">0</span>,e=b.length;d&lt;e;++d)a=b[d].replace(<span class="keyword">this</span>.regExes.trimParens,<span class="string">"$1"</span>),c.push(<span class="keyword">this</span>.parse.point.apply(<span class="keyword">this</span>,[a]).geometry);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.MultiPoint(c))&#125;,<span class="attr">linestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.String.trim(a).split(<span class="string">","</span>);<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>,d=a.length;c&lt;d;++c)b.push(<span class="keyword">this</span>.parse.point.apply(<span class="keyword">this</span>,[a[c]]).geometry);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.LineString(b))&#125;,<span class="attr">multilinestring</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=OpenLayers.String.trim(a).split(<span class="keyword">this</span>.regExes.parenComma),</span><br><span class="line">c=[],d=<span class="number">0</span>,e=b.length;d&lt;e;++d)a=b[d].replace(<span class="keyword">this</span>.regExes.trimParens,<span class="string">"$1"</span>),c.push(<span class="keyword">this</span>.parse.linestring.apply(<span class="keyword">this</span>,[a]).geometry);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.MultiLineString(c))&#125;,<span class="attr">polygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;a=OpenLayers.String.trim(a).split(<span class="keyword">this</span>.regExes.parenComma);<span class="keyword">for</span>(<span class="keyword">var</span> c=[],d=<span class="number">0</span>,e=a.length;d&lt;e;++d)b=a[d].replace(<span class="keyword">this</span>.regExes.trimParens,<span class="string">"$1"</span>),b=<span class="keyword">this</span>.parse.linestring.apply(<span class="keyword">this</span>,[b]).geometry,b=<span class="keyword">new</span> OpenLayers.Geometry.LinearRing(b.components),c.push(b);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.Polygon(c))&#125;,</span><br><span class="line">multipolygon:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=OpenLayers.String.trim(a).split(<span class="keyword">this</span>.regExes.doubleParenComma),c=[],d=<span class="number">0</span>,e=b.length;d&lt;e;++d)a=b[d].replace(<span class="keyword">this</span>.regExes.trimParens,<span class="string">"$1"</span>),c.push(<span class="keyword">this</span>.parse.polygon.apply(<span class="keyword">this</span>,[a]).geometry);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.MultiPolygon(c))&#125;,<span class="attr">geometrycollection</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.replace(<span class="regexp">/,\s*([A-Za-z])/g</span>,<span class="string">"|$1"</span>);a=OpenLayers.String.trim(a).split(<span class="string">"|"</span>);<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="number">0</span>,d=a.length;c&lt;d;++c)b.push(OpenLayers.Format.WKT.prototype.read.apply(<span class="keyword">this</span>,[a[c]]));</span><br><span class="line"><span class="keyword">return</span> b&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WKT"</span>&#125;);OpenLayers.WPSProcess=OpenLayers.Class(&#123;<span class="attr">client</span>:<span class="literal">null</span>,<span class="attr">server</span>:<span class="literal">null</span>,<span class="attr">identifier</span>:<span class="literal">null</span>,<span class="attr">description</span>:<span class="literal">null</span>,<span class="attr">localWPS</span>:<span class="string">"http://geoserver/wps"</span>,<span class="attr">formats</span>:<span class="literal">null</span>,<span class="attr">chained</span>:<span class="number">0</span>,<span class="attr">executeCallbacks</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,a);<span class="keyword">this</span>.executeCallbacks=[];<span class="keyword">this</span>.formats=&#123;<span class="string">"application/wkt"</span>:<span class="keyword">new</span> OpenLayers.Format.WKT,<span class="string">"application/json"</span>:<span class="keyword">new</span> OpenLayers.Format.GeoJSON&#125;&#125;,<span class="attr">describe</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||&#123;&#125;;<span class="keyword">if</span>(!<span class="keyword">this</span>.description)<span class="keyword">this</span>.client.describeProcess(<span class="keyword">this</span>.server,<span class="keyword">this</span>.identifier,<span class="function"><span class="keyword">function</span>(<span class="params">b</span>)</span>&#123;<span class="keyword">this</span>.description||<span class="keyword">this</span>.parseDescription(b);</span><br><span class="line">a.callback&amp;&amp;a.callback.call(a.scope,<span class="keyword">this</span>.description)&#125;,<span class="keyword">this</span>);<span class="keyword">else</span> <span class="keyword">if</span>(a.callback)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.description;<span class="built_in">window</span>.setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;a.callback.call(a.scope,b)&#125;,<span class="number">0</span>)&#125;&#125;,<span class="attr">configure</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.describe(&#123;<span class="attr">callback</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.description,c=a.inputs,d,e,f;e=<span class="number">0</span>;<span class="keyword">for</span>(f=b.dataInputs.length;e&lt;f;++e)d=b.dataInputs[e],<span class="keyword">this</span>.setInputData(d,c[d.identifier]);a.callback&amp;&amp;a.callback.call(a.scope)&#125;,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">return</span> <span class="keyword">this</span>&#125;,<span class="attr">execute</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.configure(&#123;<span class="attr">inputs</span>:a.inputs,<span class="attr">callback</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>,</span><br><span class="line">c=<span class="keyword">this</span>.getOutputIndex(b.description.processOutputs,a.output);b.setResponseForm(&#123;<span class="attr">outputIndex</span>:c&#125;);(<span class="function"><span class="keyword">function</span> <span class="title">e</span>(<span class="params"></span>)</span>&#123;OpenLayers.Util.removeItem(b.executeCallbacks,e);<span class="number">0</span>!==b.chained?b.executeCallbacks.push(e):OpenLayers.Request.POST(&#123;<span class="attr">url</span>:b.client.servers[b.server].url,<span class="attr">data</span>:(<span class="keyword">new</span> OpenLayers.Format.WPSExecute).write(b.description),<span class="attr">success</span>:<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">var</span> g=b.findMimeType(b.description.processOutputs[c].complexOutput.supported.formats);e=b.formats[g].read(e.responseText);e <span class="keyword">instanceof</span> OpenLayers.Feature.Vector&amp;&amp;</span><br><span class="line">(e=[e]);a.success&amp;&amp;(g=&#123;&#125;,g[a.output||<span class="string">"result"</span>]=e,a.success.call(a.scope,g))&#125;,<span class="attr">scope</span>:b&#125;)&#125;)()&#125;,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">output</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.WPSProcess.ChainLink(&#123;<span class="attr">process</span>:<span class="keyword">this</span>,<span class="attr">output</span>:a&#125;)&#125;,<span class="attr">parseDescription</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.client.servers[<span class="keyword">this</span>.server];<span class="keyword">this</span>.description=(<span class="keyword">new</span> OpenLayers.Format.WPSDescribeProcess).read(a.processDescription[<span class="keyword">this</span>.identifier]).processDescriptions[<span class="keyword">this</span>.identifier]&#125;,<span class="attr">setInputData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">delete</span> a.data;<span class="keyword">delete</span> a.reference;<span class="keyword">if</span>(b <span class="keyword">instanceof</span> OpenLayers.WPSProcess.ChainLink)++<span class="keyword">this</span>.chained,</span><br><span class="line">a.reference=&#123;<span class="attr">method</span>:<span class="string">"POST"</span>,<span class="attr">href</span>:b.process.server===<span class="keyword">this</span>.server?<span class="keyword">this</span>.localWPS:<span class="keyword">this</span>.client.servers[b.process.server].url&#125;,b.process.describe(&#123;<span class="attr">callback</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;--<span class="keyword">this</span>.chained;<span class="keyword">this</span>.chainProcess(a,b)&#125;,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">else</span>&#123;a.data=&#123;&#125;;<span class="keyword">var</span> c=a.complexData;c?(c=<span class="keyword">this</span>.findMimeType(c.supported.formats),a.data.complexData=&#123;<span class="attr">mimeType</span>:c,<span class="attr">value</span>:<span class="keyword">this</span>.formats[c].write(<span class="keyword">this</span>.toFeatures(b))&#125;):a.data.literalData=&#123;<span class="attr">value</span>:b&#125;&#125;&#125;,<span class="attr">setResponseForm</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||&#123;&#125;;<span class="keyword">var</span> b=<span class="keyword">this</span>.description.processOutputs[a.outputIndex||<span class="number">0</span>];<span class="keyword">this</span>.description.responseForm=</span><br><span class="line">&#123;<span class="attr">rawDataOutput</span>:&#123;<span class="attr">identifier</span>:b.identifier,<span class="attr">mimeType</span>:<span class="keyword">this</span>.findMimeType(b.complexOutput.supported.formats,a.supportedFormats)&#125;&#125;&#125;,<span class="attr">getOutputIndex</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c;<span class="keyword">if</span>(b)<span class="keyword">for</span>(<span class="keyword">var</span> d=a.length<span class="number">-1</span>;<span class="number">0</span>&lt;=d;--d)&#123;<span class="keyword">if</span>(a[d].identifier===b)&#123;c=d;<span class="keyword">break</span>&#125;&#125;<span class="keyword">else</span> c=<span class="number">0</span>;<span class="keyword">return</span> c&#125;,<span class="attr">chainProcess</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getOutputIndex(b.process.description.processOutputs,b.output);a.reference.mimeType=<span class="keyword">this</span>.findMimeType(a.complexData.supported.formats,b.process.description.processOutputs[c].complexOutput.supported.formats);<span class="keyword">var</span> d=&#123;&#125;;</span><br><span class="line">d[a.reference.mimeType]=!<span class="number">0</span>;b.process.setResponseForm(&#123;<span class="attr">outputIndex</span>:c,<span class="attr">supportedFormats</span>:d&#125;);<span class="keyword">for</span>(a.reference.body=b.process.description;<span class="number">0</span>&lt;<span class="keyword">this</span>.executeCallbacks.length;)<span class="keyword">this</span>.executeCallbacks[<span class="number">0</span>]()&#125;,<span class="attr">toFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Util.isArray(a);b||(a=[a]);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="built_in">Array</span>(a.length),d,e=<span class="number">0</span>,f=a.length;e&lt;f;++e)d=a[e],c[e]=d <span class="keyword">instanceof</span> OpenLayers.Feature.Vector?d:<span class="keyword">new</span> OpenLayers.Feature.Vector(d);<span class="keyword">return</span> b?c:c[<span class="number">0</span>]&#125;,<span class="attr">findMimeType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=b||<span class="keyword">this</span>.formats;<span class="keyword">for</span>(<span class="keyword">var</span> c <span class="keyword">in</span> a)<span class="keyword">if</span>(c <span class="keyword">in</span> b)<span class="keyword">return</span> c&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.WPSProcess"</span>&#125;);</span><br><span class="line">OpenLayers.WPSProcess.ChainLink=OpenLayers.Class(&#123;<span class="attr">process</span>:<span class="literal">null</span>,<span class="attr">output</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,a)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.WPSProcess.ChainLink"</span>&#125;);OpenLayers.WPSClient=OpenLayers.Class(&#123;<span class="attr">servers</span>:<span class="literal">null</span>,<span class="attr">version</span>:<span class="string">"1.0.0"</span>,<span class="attr">lazy</span>:!<span class="number">1</span>,<span class="attr">events</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,a);<span class="keyword">this</span>.events=<span class="keyword">new</span> OpenLayers.Events(<span class="keyword">this</span>);<span class="keyword">this</span>.servers=&#123;&#125;;<span class="keyword">for</span>(<span class="keyword">var</span> b <span class="keyword">in</span> a.servers)<span class="keyword">this</span>.servers[b]=<span class="string">"string"</span>==<span class="keyword">typeof</span> a.servers[b]?&#123;<span class="attr">url</span>:a.servers[b],<span class="attr">version</span>:<span class="keyword">this</span>.version,<span class="attr">processDescription</span>:&#123;&#125;&#125;:a.servers[b]&#125;,<span class="attr">execute</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.getProcess(a.server,a.process).execute(&#123;<span class="attr">inputs</span>:a.inputs,<span class="attr">success</span>:a.success,<span class="attr">scope</span>:a.scope&#125;)&#125;,<span class="attr">getProcess</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.WPSProcess(&#123;<span class="attr">client</span>:<span class="keyword">this</span>,</span><br><span class="line">server:a,<span class="attr">identifier</span>:b&#125;);<span class="keyword">this</span>.lazy||c.describe();<span class="keyword">return</span> c&#125;,<span class="attr">describeProcess</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">var</span> e=<span class="keyword">this</span>.servers[a];e.processDescription[b]?<span class="built_in">window</span>.setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;c.call(d,e.processDescription[b])&#125;,<span class="number">0</span>):b <span class="keyword">in</span> e.processDescription?<span class="keyword">this</span>.events.register(<span class="string">"describeprocess"</span>,<span class="keyword">this</span>,<span class="function"><span class="keyword">function</span> <span class="title">g</span>(<span class="params">a</span>)</span>&#123;a.identifier===b&amp;&amp;(<span class="keyword">this</span>.events.unregister(<span class="string">"describeprocess"</span>,<span class="keyword">this</span>,g),c.call(d,a.raw))&#125;):(e.processDescription[b]=<span class="literal">null</span>,OpenLayers.Request.GET(&#123;<span class="attr">url</span>:e.url,<span class="attr">params</span>:&#123;<span class="attr">SERVICE</span>:<span class="string">"WPS"</span>,<span class="attr">VERSION</span>:e.version,<span class="attr">REQUEST</span>:<span class="string">"DescribeProcess"</span>,</span><br><span class="line">IDENTIFIER:b&#125;,<span class="attr">success</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;e.processDescription[b]=a.responseText;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"describeprocess"</span>,&#123;<span class="attr">identifier</span>:b,<span class="attr">raw</span>:a.responseText&#125;)&#125;,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;))&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.events.destroy();<span class="keyword">this</span>.servers=<span class="keyword">this</span>.events=<span class="literal">null</span>&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.WPSClient"</span>&#125;);OpenLayers.Format.CSWGetRecords.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">csw</span>:<span class="string">"http://www.opengis.net/cat/csw/2.0.2"</span>,<span class="attr">dc</span>:<span class="string">"http://purl.org/dc/elements/1.1/"</span>,<span class="attr">dct</span>:<span class="string">"http://purl.org/dc/terms/"</span>,<span class="attr">gmd</span>:<span class="string">"http://www.isotc211.org/2005/gmd"</span>,<span class="attr">geonet</span>:<span class="string">"http://www.fao.org/geonetwork"</span>,<span class="attr">ogc</span>:<span class="string">"http://www.opengis.net/ogc"</span>,<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&#125;,<span class="attr">defaultPrefix</span>:<span class="string">"csw"</span>,<span class="attr">version</span>:<span class="string">"2.0.2"</span>,<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd"</span>,</span><br><span class="line">requestId:<span class="literal">null</span>,<span class="attr">resultType</span>:<span class="literal">null</span>,<span class="attr">outputFormat</span>:<span class="literal">null</span>,<span class="attr">outputSchema</span>:<span class="literal">null</span>,<span class="attr">startPosition</span>:<span class="literal">null</span>,<span class="attr">maxRecords</span>:<span class="literal">null</span>,<span class="attr">DistributedSearch</span>:<span class="literal">null</span>,<span class="attr">ResponseHandler</span>:<span class="literal">null</span>,<span class="attr">Query</span>:<span class="literal">null</span>,<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> b=&#123;&#125;;<span class="keyword">this</span>.readNode(a,b);<span class="keyword">return</span> b&#125;,</span><br><span class="line">readers:&#123;<span class="attr">csw</span>:&#123;<span class="attr">GetRecordsResponse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.records=[];<span class="keyword">this</span>.readChildNodes(a,b);<span class="keyword">var</span> c=<span class="keyword">this</span>.getAttributeNS(a,<span class="string">""</span>,<span class="string">"version"</span>);<span class="string">""</span>!=c&amp;&amp;(b.version=c)&#125;,<span class="attr">RequestId</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.RequestId=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">SearchStatus</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.SearchStatus=&#123;&#125;;<span class="keyword">var</span> c=<span class="keyword">this</span>.getAttributeNS(a,<span class="string">""</span>,<span class="string">"timestamp"</span>);<span class="string">""</span>!=c&amp;&amp;(b.SearchStatus.timestamp=c)&#125;,<span class="attr">SearchResults</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b);<span class="keyword">for</span>(<span class="keyword">var</span> c=a.attributes,d=&#123;&#125;,e=<span class="number">0</span>,f=c.length;e&lt;f;++e)d[c[e].name]=<span class="string">"numberOfRecordsMatched"</span>==c[e].name||<span class="string">"numberOfRecordsReturned"</span>==</span><br><span class="line">c[e].name||<span class="string">"nextRecord"</span>==c[e].name?<span class="built_in">parseInt</span>(c[e].nodeValue):c[e].nodeValue;b.SearchResults=d&#125;,<span class="attr">SummaryRecord</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">type</span>:<span class="string">"SummaryRecord"</span>&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.records.push(c)&#125;,<span class="attr">BriefRecord</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">type</span>:<span class="string">"BriefRecord"</span>&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.records.push(c)&#125;,<span class="attr">DCMIRecord</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">type</span>:<span class="string">"DCMIRecord"</span>&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.records.push(c)&#125;,<span class="attr">Record</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">type</span>:<span class="string">"Record"</span>&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.records.push(c)&#125;,<span class="string">"*"</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.localName||</span><br><span class="line">a.nodeName.split(<span class="string">":"</span>).pop();b[c]=<span class="keyword">this</span>.getChildValue(a)&#125;&#125;,<span class="attr">geonet</span>:&#123;<span class="attr">info</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.gninfo=c&#125;&#125;,<span class="attr">dc</span>:&#123;<span class="string">"*"</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.localName||a.nodeName.split(<span class="string">":"</span>).pop();OpenLayers.Util.isArray(b[c])||(b[c]=[]);<span class="keyword">for</span>(<span class="keyword">var</span> d=&#123;&#125;,e=a.attributes,f=<span class="number">0</span>,g=e.length;f&lt;g;++f)d[e[f].name]=e[f].nodeValue;d.value=<span class="keyword">this</span>.getChildValue(a);<span class="string">""</span>!=d.value&amp;&amp;b[c].push(d)&#125;&#125;,<span class="attr">dct</span>:&#123;<span class="string">"*"</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.localName||a.nodeName.split(<span class="string">":"</span>).pop();OpenLayers.Util.isArray(b[c])||(b[c]=[]);b[c].push(<span class="keyword">this</span>.getChildValue(a))&#125;&#125;,</span><br><span class="line">ows:OpenLayers.Util.applyDefaults(&#123;<span class="attr">BoundingBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.bounds&amp;&amp;(b.BoundingBox=[&#123;<span class="attr">crs</span>:b.projection,<span class="attr">value</span>:[b.bounds.left,b.bounds.bottom,b.bounds.right,b.bounds.top]&#125;],<span class="keyword">delete</span> b.projection,<span class="keyword">delete</span> b.bounds);OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows.BoundingBox.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;&#125;,OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows)&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.writeNode(<span class="string">"csw:GetRecords"</span>,a);a.setAttribute(<span class="string">"xmlns:gmd"</span>,<span class="keyword">this</span>.namespaces.gmd);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,</span><br><span class="line">[a])&#125;,<span class="attr">writers</span>:&#123;<span class="attr">csw</span>:&#123;<span class="attr">GetRecords</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a||(a=&#123;&#125;);<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"csw:GetRecords"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">service</span>:<span class="string">"CSW"</span>,<span class="attr">version</span>:<span class="keyword">this</span>.version,<span class="attr">requestId</span>:a.requestId||<span class="keyword">this</span>.requestId,<span class="attr">resultType</span>:a.resultType||<span class="keyword">this</span>.resultType,<span class="attr">outputFormat</span>:a.outputFormat||<span class="keyword">this</span>.outputFormat,<span class="attr">outputSchema</span>:a.outputSchema||<span class="keyword">this</span>.outputSchema,<span class="attr">startPosition</span>:a.startPosition||<span class="keyword">this</span>.startPosition,<span class="attr">maxRecords</span>:a.maxRecords||<span class="keyword">this</span>.maxRecords&#125;&#125;);(a.DistributedSearch||<span class="keyword">this</span>.DistributedSearch)&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"csw:DistributedSearch"</span>,</span><br><span class="line">a.DistributedSearch||<span class="keyword">this</span>.DistributedSearch,b);<span class="keyword">var</span> c=a.ResponseHandler||<span class="keyword">this</span>.ResponseHandler;<span class="keyword">if</span>(OpenLayers.Util.isArray(c)&amp;&amp;<span class="number">0</span>&lt;c.length)<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e=c.length;d&lt;e;d++)<span class="keyword">this</span>.writeNode(<span class="string">"csw:ResponseHandler"</span>,c[d],b);<span class="keyword">this</span>.writeNode(<span class="string">"Query"</span>,a.Query||<span class="keyword">this</span>.Query,b);<span class="keyword">return</span> b&#125;,<span class="attr">DistributedSearch</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"csw:DistributedSearch"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">hopCount</span>:a.hopCount&#125;&#125;)&#125;,<span class="attr">ResponseHandler</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"csw:ResponseHandler"</span>,&#123;<span class="attr">value</span>:a.value&#125;)&#125;,<span class="attr">Query</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a||</span><br><span class="line">(a=&#123;&#125;);<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"csw:Query"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">typeNames</span>:a.typeNames||<span class="string">"csw:Record"</span>&#125;&#125;),c=a.ElementName;<span class="keyword">if</span>(OpenLayers.Util.isArray(c)&amp;&amp;<span class="number">0</span>&lt;c.length)<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>,e=c.length;d&lt;e;d++)<span class="keyword">this</span>.writeNode(<span class="string">"csw:ElementName"</span>,c[d],b);<span class="keyword">else</span> <span class="keyword">this</span>.writeNode(<span class="string">"csw:ElementSetName"</span>,a.ElementSetName||&#123;<span class="attr">value</span>:<span class="string">"summary"</span>&#125;,b);a.Constraint&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"csw:Constraint"</span>,a.Constraint,b);a.SortBy&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"ogc:SortBy"</span>,a.SortBy,b);<span class="keyword">return</span> b&#125;,<span class="attr">ElementName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"csw:ElementName"</span>,</span><br><span class="line">&#123;<span class="attr">value</span>:a.value&#125;)&#125;,<span class="attr">ElementSetName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"csw:ElementSetName"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">typeNames</span>:a.typeNames&#125;,<span class="attr">value</span>:a.value&#125;)&#125;,<span class="attr">Constraint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"csw:Constraint"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">version</span>:a.version&#125;&#125;);<span class="keyword">if</span>(a.Filter)&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Format.Filter(&#123;<span class="attr">version</span>:a.version&#125;);b.appendChild(c.write(a.Filter))&#125;<span class="keyword">else</span> a.CqlText&amp;&amp;(a=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"CqlText"</span>,&#123;<span class="attr">value</span>:a.CqlText.value&#125;),b.appendChild(a));<span class="keyword">return</span> b&#125;&#125;,<span class="attr">ogc</span>:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc&#125;,</span><br><span class="line">CLASS_NAME:<span class="string">"OpenLayers.Format.CSWGetRecords.v2_0_2"</span>&#125;);<span class="comment">/*</span></span><br><span class="line"><span class="comment"> Apache 2 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Contains portions of Rico &lt;http://openrico.org/&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Copyright 2005 Sabre Airline Solutions  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Licensed under the Apache License, Version 2.0 (the "License"); you</span></span><br><span class="line"><span class="comment"> may not use this file except in compliance with the License. You</span></span><br><span class="line"><span class="comment"> may obtain a copy of the License at</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">     http://www.apache.org/licenses/LICENSE-2.0  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment"> distributed under the License is distributed on an "AS IS" BASIS,</span></span><br><span class="line"><span class="comment"> WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or</span></span><br><span class="line"><span class="comment"> implied. See the License for the specific language governing</span></span><br><span class="line"><span class="comment"> permissions and limitations under the License. </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">OpenLayers.Marker.Box=OpenLayers.Class(OpenLayers.Marker,&#123;<span class="attr">bounds</span>:<span class="literal">null</span>,<span class="attr">div</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">this</span>.bounds=a;<span class="keyword">this</span>.div=OpenLayers.Util.createDiv();<span class="keyword">this</span>.div.style.overflow=<span class="string">"hidden"</span>;<span class="keyword">this</span>.events=<span class="keyword">new</span> OpenLayers.Events(<span class="keyword">this</span>,<span class="keyword">this</span>.div);<span class="keyword">this</span>.setBorder(b,c)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.div=<span class="keyword">this</span>.bounds=<span class="literal">null</span>;OpenLayers.Marker.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">setBorder</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a||(a=<span class="string">"red"</span>);b||(b=<span class="number">2</span>);<span class="keyword">this</span>.div.style.border=b+<span class="string">"px solid "</span>+a&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Util.modifyDOMElement(<span class="keyword">this</span>.div,</span><br><span class="line"><span class="literal">null</span>,a,b);<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">onScreen</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;<span class="keyword">this</span>.map&amp;&amp;(a=<span class="keyword">this</span>.map.getExtent().containsBounds(<span class="keyword">this</span>.bounds,!<span class="number">0</span>,!<span class="number">0</span>));<span class="keyword">return</span> a&#125;,<span class="attr">display</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.div.style.display=a?<span class="string">""</span>:<span class="string">"none"</span>&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Marker.Box"</span>&#125;);OpenLayers.Format.Text=OpenLayers.Class(OpenLayers.Format,&#123;<span class="attr">defaultStyle</span>:<span class="literal">null</span>,<span class="attr">extractStyles</span>:!<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||&#123;&#125;;!<span class="number">1</span>!==a.extractStyles&amp;&amp;(a.defaultStyle=&#123;<span class="attr">externalGraphic</span>:OpenLayers.Util.getImageLocation(<span class="string">"marker.png"</span>),<span class="attr">graphicWidth</span>:<span class="number">21</span>,<span class="attr">graphicHeight</span>:<span class="number">25</span>,<span class="attr">graphicXOffset</span>:<span class="number">-10.5</span>,<span class="attr">graphicYOffset</span>:<span class="number">-12.5</span>&#125;);OpenLayers.Format.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.split(<span class="string">"\n"</span>);<span class="keyword">for</span>(<span class="keyword">var</span> b,c=[],d=<span class="number">0</span>;d&lt;a.length<span class="number">-1</span>;d++)&#123;<span class="keyword">var</span> e=a[d].replace(<span class="regexp">/^\s*/</span>,<span class="string">""</span>).replace(<span class="regexp">/\s*$/</span>,<span class="string">""</span>);<span class="keyword">if</span>(<span class="string">"#"</span>!=e.charAt(<span class="number">0</span>))<span class="keyword">if</span>(b)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> e=</span><br><span class="line">e.split(<span class="string">"\t"</span>),f=<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="number">0</span>,<span class="number">0</span>),g=&#123;&#125;,h=<span class="keyword">this</span>.defaultStyle?OpenLayers.Util.applyDefaults(&#123;&#125;,<span class="keyword">this</span>.defaultStyle):<span class="literal">null</span>,k=!<span class="number">1</span>,l=<span class="number">0</span>;l&lt;e.length;l++)<span class="keyword">if</span>(e[l])<span class="keyword">if</span>(<span class="string">"point"</span>==b[l])k=e[l].split(<span class="string">","</span>),f.y=<span class="built_in">parseFloat</span>(k[<span class="number">0</span>]),f.x=<span class="built_in">parseFloat</span>(k[<span class="number">1</span>]),k=!<span class="number">0</span>;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"lat"</span>==b[l])f.y=<span class="built_in">parseFloat</span>(e[l]),k=!<span class="number">0</span>;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"lon"</span>==b[l])f.x=<span class="built_in">parseFloat</span>(e[l]),k=!<span class="number">0</span>;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"title"</span>==b[l])g.title=e[l];<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"image"</span>==b[l]||<span class="string">"icon"</span>==b[l]&amp;&amp;h)h.externalGraphic=e[l];<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"iconSize"</span>==b[l]&amp;&amp;h)&#123;<span class="keyword">var</span> m=e[l].split(<span class="string">","</span>);h.graphicWidth=</span><br><span class="line"><span class="built_in">parseFloat</span>(m[<span class="number">0</span>]);h.graphicHeight=<span class="built_in">parseFloat</span>(m[<span class="number">1</span>])&#125;<span class="keyword">else</span><span class="string">"iconOffset"</span>==b[l]&amp;&amp;h?(m=e[l].split(<span class="string">","</span>),h.graphicXOffset=<span class="built_in">parseFloat</span>(m[<span class="number">0</span>]),h.graphicYOffset=<span class="built_in">parseFloat</span>(m[<span class="number">1</span>])):<span class="string">"description"</span>==b[l]?g.description=e[l]:<span class="string">"overflow"</span>==b[l]?g.overflow=e[l]:g[b[l]]=e[l];k&amp;&amp;(<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection&amp;&amp;f.transform(<span class="keyword">this</span>.externalProjection,<span class="keyword">this</span>.internalProjection),e=<span class="keyword">new</span> OpenLayers.Feature.Vector(f,g,h),c.push(e))&#125;<span class="keyword">else</span> b=e.split(<span class="string">"\t"</span>)&#125;<span class="keyword">return</span> c&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.Text"</span>&#125;);OpenLayers.Layer.Text=OpenLayers.Class(OpenLayers.Layer.Markers,&#123;<span class="attr">location</span>:<span class="literal">null</span>,<span class="attr">features</span>:<span class="literal">null</span>,<span class="attr">formatOptions</span>:<span class="literal">null</span>,<span class="attr">selectedFeature</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Layer.Markers.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.features=[]&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Layer.Markers.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.clearFeatures();<span class="keyword">this</span>.features=<span class="literal">null</span>&#125;,<span class="attr">loadText</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.loaded||<span class="literal">null</span>==<span class="keyword">this</span>.location||(<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loadstart"</span>),OpenLayers.Request.GET(&#123;<span class="attr">url</span>:<span class="keyword">this</span>.location,</span><br><span class="line">success:<span class="keyword">this</span>.parseData,<span class="attr">failure</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loadend"</span>)&#125;,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;),<span class="keyword">this</span>.loaded=!<span class="number">0</span>)&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Layer.Markers.prototype.moveTo.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.visibility&amp;&amp;!<span class="keyword">this</span>.loaded&amp;&amp;<span class="keyword">this</span>.loadText()&#125;,<span class="attr">parseData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.responseText;<span class="keyword">var</span> b=&#123;&#125;;OpenLayers.Util.extend(b,<span class="keyword">this</span>.formatOptions);<span class="keyword">this</span>.map&amp;&amp;!<span class="keyword">this</span>.projection.equals(<span class="keyword">this</span>.map.getProjectionObject())&amp;&amp;(b.externalProjection=<span class="keyword">this</span>.projection,b.internalProjection=<span class="keyword">this</span>.map.getProjectionObject());a=(<span class="keyword">new</span> OpenLayers.Format.Text(b)).read(a);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=a.length;b&lt;c;b++)&#123;<span class="keyword">var</span> d=&#123;&#125;,e=a[b],f,g,h;f=<span class="keyword">new</span> OpenLayers.LonLat(e.geometry.x,e.geometry.y);e.style.graphicWidth&amp;&amp;e.style.graphicHeight&amp;&amp;(g=<span class="keyword">new</span> OpenLayers.Size(e.style.graphicWidth,e.style.graphicHeight));<span class="keyword">void</span> <span class="number">0</span>!==e.style.graphicXOffset&amp;&amp;<span class="keyword">void</span> <span class="number">0</span>!==e.style.graphicYOffset&amp;&amp;(h=<span class="keyword">new</span> OpenLayers.Pixel(e.style.graphicXOffset,e.style.graphicYOffset));<span class="literal">null</span>!=e.style.externalGraphic?d.icon=<span class="keyword">new</span> OpenLayers.Icon(e.style.externalGraphic,g,h):(d.icon=OpenLayers.Marker.defaultIcon(),<span class="literal">null</span>!=g&amp;&amp;d.icon.setSize(g));</span><br><span class="line"><span class="literal">null</span>!=e.attributes.title&amp;&amp;<span class="literal">null</span>!=e.attributes.description&amp;&amp;(d.popupContentHTML=<span class="string">"&lt;h2&gt;"</span>+e.attributes.title+<span class="string">"&lt;/h2&gt;&lt;p&gt;"</span>+e.attributes.description+<span class="string">"&lt;/p&gt;"</span>);d.overflow=e.attributes.overflow||<span class="string">"auto"</span>;d=<span class="keyword">new</span> OpenLayers.Feature(<span class="keyword">this</span>,f,d);<span class="keyword">this</span>.features.push(d);f=d.createMarker();<span class="literal">null</span>!=e.attributes.title&amp;&amp;<span class="literal">null</span>!=e.attributes.description&amp;&amp;f.events.register(<span class="string">"click"</span>,d,<span class="keyword">this</span>.markerClick);<span class="keyword">this</span>.addMarker(f)&#125;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loadend"</span>)&#125;,<span class="attr">markerClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>==<span class="keyword">this</span>.layer.selectedFeature;<span class="keyword">this</span>.layer.selectedFeature=</span><br><span class="line">b?<span class="literal">null</span>:<span class="keyword">this</span>;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.layer.map.popups.length;c&lt;d;c++)<span class="keyword">this</span>.layer.map.removePopup(<span class="keyword">this</span>.layer.map.popups[c]);b||<span class="keyword">this</span>.layer.map.addPopup(<span class="keyword">this</span>.createPopup());OpenLayers.Event.stop(a)&#125;,<span class="attr">clearFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>!=<span class="keyword">this</span>.features)<span class="keyword">for</span>(;<span class="number">0</span>&lt;<span class="keyword">this</span>.features.length;)&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.features[<span class="number">0</span>];OpenLayers.Util.removeItem(<span class="keyword">this</span>.features,a);a.destroy()&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.Text"</span>&#125;);OpenLayers.Handler.RegularPolygon=OpenLayers.Class(OpenLayers.Handler.Drag,&#123;<span class="attr">sides</span>:<span class="number">4</span>,<span class="attr">radius</span>:<span class="literal">null</span>,<span class="attr">snapAngle</span>:<span class="literal">null</span>,<span class="attr">snapToggle</span>:<span class="string">"shiftKey"</span>,<span class="attr">layerOptions</span>:<span class="literal">null</span>,<span class="attr">persist</span>:!<span class="number">1</span>,<span class="attr">irregular</span>:!<span class="number">1</span>,<span class="attr">citeCompliant</span>:!<span class="number">1</span>,<span class="attr">angle</span>:<span class="literal">null</span>,<span class="attr">fixedRadius</span>:!<span class="number">1</span>,<span class="attr">feature</span>:<span class="literal">null</span>,<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">origin</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;c&amp;&amp;c.layerOptions&amp;&amp;c.layerOptions.styleMap||(<span class="keyword">this</span>.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style[<span class="string">"default"</span>],&#123;&#125;));OpenLayers.Handler.Drag.prototype.initialize.apply(<span class="keyword">this</span>,[a,b,c]);<span class="keyword">this</span>.options=c?c:&#123;&#125;&#125;,<span class="attr">setOptions</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>.options,</span><br><span class="line">a);OpenLayers.Util.extend(<span class="keyword">this</span>,a)&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;OpenLayers.Handler.Drag.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&amp;&amp;(a=OpenLayers.Util.extend(&#123;<span class="attr">displayInLayerSwitcher</span>:!<span class="number">1</span>,<span class="attr">calculateInRange</span>:OpenLayers.Function.True,<span class="attr">wrapDateLine</span>:<span class="keyword">this</span>.citeCompliant&#125;,<span class="keyword">this</span>.layerOptions),<span class="keyword">this</span>.layer=<span class="keyword">new</span> OpenLayers.Layer.Vector(<span class="keyword">this</span>.CLASS_NAME,a),<span class="keyword">this</span>.map.addLayer(<span class="keyword">this</span>.layer),a=!<span class="number">0</span>);<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;OpenLayers.Handler.Drag.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&amp;&amp;(<span class="keyword">this</span>.dragging&amp;&amp;<span class="keyword">this</span>.cancel(),</span><br><span class="line"><span class="literal">null</span>!=<span class="keyword">this</span>.layer.map&amp;&amp;(<span class="keyword">this</span>.layer.destroy(!<span class="number">1</span>),<span class="keyword">this</span>.feature&amp;&amp;<span class="keyword">this</span>.feature.destroy()),<span class="keyword">this</span>.feature=<span class="keyword">this</span>.layer=<span class="literal">null</span>,a=!<span class="number">0</span>);<span class="keyword">return</span> a&#125;,<span class="attr">down</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.fixedRadius=!!<span class="keyword">this</span>.radius;a=<span class="keyword">this</span>.layer.getLonLatFromViewPortPx(a.xy);<span class="keyword">this</span>.origin=<span class="keyword">new</span> OpenLayers.Geometry.Point(a.lon,a.lat);<span class="keyword">if</span>(!<span class="keyword">this</span>.fixedRadius||<span class="keyword">this</span>.irregular)<span class="keyword">this</span>.radius=<span class="keyword">this</span>.map.getResolution();<span class="keyword">this</span>.persist&amp;&amp;<span class="keyword">this</span>.clear();<span class="keyword">this</span>.feature=<span class="keyword">new</span> OpenLayers.Feature.Vector;<span class="keyword">this</span>.createGeometry();<span class="keyword">this</span>.callback(<span class="string">"create"</span>,[<span class="keyword">this</span>.origin,<span class="keyword">this</span>.feature]);<span class="keyword">this</span>.layer.addFeatures([<span class="keyword">this</span>.feature],</span><br><span class="line">&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;);<span class="keyword">this</span>.layer.drawFeature(<span class="keyword">this</span>.feature,<span class="keyword">this</span>.style)&#125;,<span class="attr">move</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.layer.getLonLatFromViewPortPx(a.xy),b=<span class="keyword">new</span> OpenLayers.Geometry.Point(b.lon,b.lat);<span class="keyword">this</span>.irregular?(a=<span class="built_in">Math</span>.sqrt(<span class="number">2</span>)*<span class="built_in">Math</span>.abs(b.y-<span class="keyword">this</span>.origin.y)/<span class="number">2</span>,<span class="keyword">this</span>.radius=<span class="built_in">Math</span>.max(<span class="keyword">this</span>.map.getResolution()/<span class="number">2</span>,a)):<span class="keyword">this</span>.fixedRadius?<span class="keyword">this</span>.origin=b:(<span class="keyword">this</span>.calculateAngle(b,a),<span class="keyword">this</span>.radius=<span class="built_in">Math</span>.max(<span class="keyword">this</span>.map.getResolution()/<span class="number">2</span>,b.distanceTo(<span class="keyword">this</span>.origin)));<span class="keyword">this</span>.modifyGeometry();<span class="keyword">if</span>(<span class="keyword">this</span>.irregular)&#123;a=b.x-<span class="keyword">this</span>.origin.x;<span class="keyword">var</span> b=b.y-<span class="keyword">this</span>.origin.y,</span><br><span class="line">c;c=<span class="number">0</span>==b?a/(<span class="keyword">this</span>.radius*<span class="built_in">Math</span>.sqrt(<span class="number">2</span>)):a/b;<span class="keyword">this</span>.feature.geometry.resize(<span class="number">1</span>,<span class="keyword">this</span>.origin,c);<span class="keyword">this</span>.feature.geometry.move(a/<span class="number">2</span>,b/<span class="number">2</span>)&#125;<span class="keyword">this</span>.layer.drawFeature(<span class="keyword">this</span>.feature,<span class="keyword">this</span>.style)&#125;,<span class="attr">up</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.finalize();<span class="keyword">this</span>.start==<span class="keyword">this</span>.last&amp;&amp;<span class="keyword">this</span>.callback(<span class="string">"done"</span>,[a.xy])&#125;,<span class="attr">out</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.finalize()&#125;,<span class="attr">createGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.angle=<span class="built_in">Math</span>.PI*(<span class="number">1</span>/<span class="keyword">this</span>.sides<span class="number">-0.5</span>);<span class="keyword">this</span>.snapAngle&amp;&amp;(<span class="keyword">this</span>.angle+=<span class="keyword">this</span>.snapAngle*(<span class="built_in">Math</span>.PI/<span class="number">180</span>));<span class="keyword">this</span>.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(<span class="keyword">this</span>.origin,<span class="keyword">this</span>.radius,</span><br><span class="line"><span class="keyword">this</span>.sides,<span class="keyword">this</span>.snapAngle)&#125;,<span class="attr">modifyGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a,b,c=<span class="keyword">this</span>.feature.geometry.components[<span class="number">0</span>];c.components.length!=<span class="keyword">this</span>.sides+<span class="number">1</span>&amp;&amp;(<span class="keyword">this</span>.createGeometry(),c=<span class="keyword">this</span>.feature.geometry.components[<span class="number">0</span>]);<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>;d&lt;<span class="keyword">this</span>.sides;++d)b=c.components[d],a=<span class="keyword">this</span>.angle+<span class="number">2</span>*d*<span class="built_in">Math</span>.PI/<span class="keyword">this</span>.sides,b.x=<span class="keyword">this</span>.origin.x+<span class="keyword">this</span>.radius*<span class="built_in">Math</span>.cos(a),b.y=<span class="keyword">this</span>.origin.y+<span class="keyword">this</span>.radius*<span class="built_in">Math</span>.sin(a),b.clearBounds()&#125;,<span class="attr">calculateAngle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="built_in">Math</span>.atan2(a.y-<span class="keyword">this</span>.origin.y,a.x-<span class="keyword">this</span>.origin.x);<span class="keyword">if</span>(<span class="keyword">this</span>.snapAngle&amp;&amp;<span class="keyword">this</span>.snapToggle&amp;&amp;!b[<span class="keyword">this</span>.snapToggle])&#123;<span class="keyword">var</span> d=</span><br><span class="line"><span class="built_in">Math</span>.PI/<span class="number">180</span>*<span class="keyword">this</span>.snapAngle;<span class="keyword">this</span>.angle=<span class="built_in">Math</span>.round(c/d)*d&#125;<span class="keyword">else</span> <span class="keyword">this</span>.angle=c&#125;,<span class="attr">cancel</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.callback(<span class="string">"cancel"</span>,<span class="literal">null</span>);<span class="keyword">this</span>.finalize()&#125;,<span class="attr">finalize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.origin=<span class="literal">null</span>;<span class="keyword">this</span>.radius=<span class="keyword">this</span>.options.radius&#125;,<span class="attr">clear</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.layer&amp;&amp;(<span class="keyword">this</span>.layer.renderer.clear(),<span class="keyword">this</span>.layer.destroyFeatures())&#125;,<span class="attr">callback</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.callbacks[a]&amp;&amp;<span class="keyword">this</span>.callbacks[a].apply(<span class="keyword">this</span>.control,[<span class="keyword">this</span>.feature.geometry.clone()]);<span class="keyword">this</span>.persist||<span class="string">"done"</span>!=a&amp;&amp;<span class="string">"cancel"</span>!=a||<span class="keyword">this</span>.clear()&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Handler.RegularPolygon"</span>&#125;);OpenLayers.Control.SLDSelect=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">clearOnDeactivate</span>:!<span class="number">1</span>,<span class="attr">layers</span>:<span class="literal">null</span>,<span class="attr">callbacks</span>:<span class="literal">null</span>,<span class="attr">selectionSymbolizer</span>:&#123;<span class="attr">Polygon</span>:&#123;<span class="attr">fillColor</span>:<span class="string">"#FF0000"</span>,<span class="attr">stroke</span>:!<span class="number">1</span>&#125;,<span class="attr">Line</span>:&#123;<span class="attr">strokeColor</span>:<span class="string">"#FF0000"</span>,<span class="attr">strokeWidth</span>:<span class="number">2</span>&#125;,<span class="attr">Point</span>:&#123;<span class="attr">graphicName</span>:<span class="string">"square"</span>,<span class="attr">fillColor</span>:<span class="string">"#FF0000"</span>,<span class="attr">pointRadius</span>:<span class="number">5</span>&#125;&#125;,<span class="attr">layerOptions</span>:<span class="literal">null</span>,<span class="attr">sketchStyle</span>:<span class="literal">null</span>,<span class="attr">wfsCache</span>:&#123;&#125;,<span class="attr">layerCache</span>:&#123;&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[b]);<span class="keyword">this</span>.callbacks=OpenLayers.Util.extend(&#123;<span class="attr">done</span>:<span class="keyword">this</span>.select,<span class="attr">click</span>:<span class="keyword">this</span>.select&#125;,<span class="keyword">this</span>.callbacks);</span><br><span class="line"><span class="keyword">this</span>.handlerOptions=<span class="keyword">this</span>.handlerOptions||&#123;&#125;;<span class="keyword">this</span>.layerOptions=OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.layerOptions,&#123;<span class="attr">displayInLayerSwitcher</span>:!<span class="number">1</span>,<span class="attr">tileOptions</span>:&#123;<span class="attr">maxGetUrlLength</span>:<span class="number">2048</span>&#125;&#125;);<span class="keyword">this</span>.sketchStyle&amp;&amp;(<span class="keyword">this</span>.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.handlerOptions.layerOptions,&#123;<span class="attr">styleMap</span>:<span class="keyword">new</span> OpenLayers.StyleMap(&#123;<span class="string">"default"</span>:<span class="keyword">this</span>.sketchStyle&#125;)&#125;));<span class="keyword">this</span>.handler=<span class="keyword">new</span> a(<span class="keyword">this</span>,<span class="keyword">this</span>.callbacks,<span class="keyword">this</span>.handlerOptions)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a <span class="keyword">in</span> <span class="keyword">this</span>.layerCache)<span class="keyword">delete</span> <span class="keyword">this</span>.layerCache[a];<span class="keyword">for</span>(a <span class="keyword">in</span> <span class="keyword">this</span>.wfsCache)<span class="keyword">delete</span> <span class="keyword">this</span>.wfsCache[a];</span><br><span class="line">OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">coupleLayerVisiblity</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.setVisibility(a.object.getVisibility())&#125;,<span class="attr">createSelectionLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;<span class="keyword">if</span>(<span class="keyword">this</span>.layerCache[a.id])b=<span class="keyword">this</span>.layerCache[a.id];<span class="keyword">else</span>&#123;b=<span class="keyword">new</span> OpenLayers.Layer.WMS(a.name,a.url,a.params,OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.layerOptions,a.getOptions()));<span class="keyword">this</span>.layerCache[a.id]=b;<span class="keyword">if</span>(!<span class="number">1</span>===<span class="keyword">this</span>.layerOptions.displayInLayerSwitcher)a.events.on(&#123;<span class="attr">visibilitychanged</span>:<span class="keyword">this</span>.coupleLayerVisiblity,<span class="attr">scope</span>:b&#125;);<span class="keyword">this</span>.map.addLayer(b)&#125;<span class="keyword">return</span> b&#125;,</span><br><span class="line">createSLD:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=&#123;<span class="attr">version</span>:<span class="string">"1.0.0"</span>,<span class="attr">namedLayers</span>:&#123;&#125;&#125;,e=(<span class="string">""</span>+a.params.LAYERS).split(<span class="string">","</span>),f=<span class="number">0</span>,g=e.length;f&lt;g;f++)&#123;<span class="keyword">var</span> h=e[f];d.namedLayers[h]=&#123;<span class="attr">name</span>:h,<span class="attr">userStyles</span>:[]&#125;;<span class="keyword">var</span> k=<span class="keyword">this</span>.selectionSymbolizer,l=c[f];<span class="number">0</span>&lt;=l.type.indexOf(<span class="string">"Polygon"</span>)?k=&#123;<span class="attr">Polygon</span>:<span class="keyword">this</span>.selectionSymbolizer.Polygon&#125;:<span class="number">0</span>&lt;=l.type.indexOf(<span class="string">"LineString"</span>)?k=&#123;<span class="attr">Line</span>:<span class="keyword">this</span>.selectionSymbolizer.Line&#125;:<span class="number">0</span>&lt;=l.type.indexOf(<span class="string">"Point"</span>)&amp;&amp;(k=&#123;<span class="attr">Point</span>:<span class="keyword">this</span>.selectionSymbolizer.Point&#125;);d.namedLayers[h].userStyles.push(&#123;<span class="attr">name</span>:<span class="string">"default"</span>,<span class="attr">rules</span>:[<span class="keyword">new</span> OpenLayers.Rule(&#123;<span class="attr">symbolizer</span>:k,</span><br><span class="line">filter:b[f],<span class="attr">maxScaleDenominator</span>:a.options.minScale&#125;)]&#125;)&#125;<span class="keyword">return</span>(<span class="keyword">new</span> OpenLayers.Format.SLD(&#123;<span class="attr">srsName</span>:<span class="keyword">this</span>.map.getProjection()&#125;)).write(d)&#125;,<span class="attr">parseDescribeLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">new</span> OpenLayers.Format.WMSDescribeLayer,c=a.responseXML;c&amp;&amp;c.documentElement||(c=a.responseText);a=b.read(c);<span class="keyword">for</span>(<span class="keyword">var</span> b=[],c=<span class="literal">null</span>,d=<span class="number">0</span>,e=a.length;d&lt;e;d++)<span class="string">"WFS"</span>==a[d].owsType&amp;&amp;(b.push(a[d].typeName),c=a[d].owsURL);OpenLayers.Request.GET(&#123;<span class="attr">url</span>:c,<span class="attr">params</span>:&#123;<span class="attr">SERVICE</span>:<span class="string">"WFS"</span>,<span class="attr">TYPENAME</span>:b.toString(),<span class="attr">REQUEST</span>:<span class="string">"DescribeFeatureType"</span>,<span class="attr">VERSION</span>:<span class="string">"1.0.0"</span>&#125;,</span><br><span class="line">callback:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">new</span> OpenLayers.Format.WFSDescribeFeatureType,c=a.responseXML;c&amp;&amp;c.documentElement||(c=a.responseText);a=b.read(c);<span class="keyword">this</span>.control.wfsCache[<span class="keyword">this</span>.layer.id]=a;<span class="keyword">this</span>.control._queue&amp;&amp;<span class="keyword">this</span>.control.applySelection()&#125;,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">getGeometryAttributes</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=[];a=<span class="keyword">this</span>.wfsCache[a.id];<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.featureTypes.length;c&lt;d;c++)<span class="keyword">for</span>(<span class="keyword">var</span> e=a.featureTypes[c].properties,f=<span class="number">0</span>,g=e.length;f&lt;g;f++)&#123;<span class="keyword">var</span> h=e[f],k=h.type;(<span class="number">0</span>&lt;=k.indexOf(<span class="string">"LineString"</span>)||<span class="number">0</span>&lt;=k.indexOf(<span class="string">"GeometryAssociationType"</span>)||</span><br><span class="line"><span class="number">0</span>&lt;=k.indexOf(<span class="string">"GeometryPropertyType"</span>)||<span class="number">0</span>&lt;=k.indexOf(<span class="string">"Point"</span>)||<span class="number">0</span>&lt;=k.indexOf(<span class="string">"Polygon"</span>))&amp;&amp;b.push(h)&#125;<span class="keyword">return</span> b&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Control.prototype.activate.call(<span class="keyword">this</span>);<span class="keyword">if</span>(a)<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="keyword">this</span>.layers.length;b&lt;c;b++)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.layers[b];d&amp;&amp;!<span class="keyword">this</span>.wfsCache[d.id]&amp;&amp;OpenLayers.Request.GET(&#123;<span class="attr">url</span>:d.url,<span class="attr">params</span>:&#123;<span class="attr">SERVICE</span>:<span class="string">"WMS"</span>,<span class="attr">VERSION</span>:d.params.VERSION,<span class="attr">LAYERS</span>:d.params.LAYERS,<span class="attr">REQUEST</span>:<span class="string">"DescribeLayer"</span>&#125;,<span class="attr">callback</span>:<span class="keyword">this</span>.parseDescribeLayer,<span class="attr">scope</span>:&#123;<span class="attr">layer</span>:d,<span class="attr">control</span>:<span class="keyword">this</span>&#125;&#125;)&#125;<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=</span><br><span class="line">OpenLayers.Control.prototype.deactivate.call(<span class="keyword">this</span>);<span class="keyword">if</span>(a)<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="keyword">this</span>.layers.length;b&lt;c;b++)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.layers[b];<span class="keyword">if</span>(d&amp;&amp;!<span class="number">0</span>===<span class="keyword">this</span>.clearOnDeactivate)&#123;<span class="keyword">var</span> e=<span class="keyword">this</span>.layerCache,f=e[d.id];f&amp;&amp;(d.events.un(&#123;<span class="attr">visibilitychanged</span>:<span class="keyword">this</span>.coupleLayerVisiblity,<span class="attr">scope</span>:f&#125;),f.destroy(),<span class="keyword">delete</span> e[d.id])&#125;&#125;<span class="keyword">return</span> a&#125;,<span class="attr">setLayers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.active?(<span class="keyword">this</span>.deactivate(),<span class="keyword">this</span>.layers=a,<span class="keyword">this</span>.activate()):<span class="keyword">this</span>.layers=a&#125;,<span class="attr">createFilter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>;<span class="keyword">this</span>.handler <span class="keyword">instanceof</span> OpenLayers.Handler.RegularPolygon?c=!<span class="number">0</span>===<span class="keyword">this</span>.handler.irregular?</span><br><span class="line"><span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:OpenLayers.Filter.Spatial.BBOX,<span class="attr">property</span>:a.name,<span class="attr">value</span>:b.getBounds()&#125;):<span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:OpenLayers.Filter.Spatial.INTERSECTS,<span class="attr">property</span>:a.name,<span class="attr">value</span>:b&#125;):<span class="keyword">this</span>.handler <span class="keyword">instanceof</span> OpenLayers.Handler.Polygon?c=<span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:OpenLayers.Filter.Spatial.INTERSECTS,<span class="attr">property</span>:a.name,<span class="attr">value</span>:b&#125;):<span class="keyword">this</span>.handler <span class="keyword">instanceof</span> OpenLayers.Handler.Path?c=<span class="number">0</span>&lt;=a.type.indexOf(<span class="string">"Point"</span>)?<span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:OpenLayers.Filter.Spatial.DWITHIN,</span><br><span class="line">property:a.name,<span class="attr">distance</span>:<span class="number">0.01</span>*<span class="keyword">this</span>.map.getExtent().getWidth(),<span class="attr">distanceUnits</span>:<span class="keyword">this</span>.map.getUnits(),<span class="attr">value</span>:b&#125;):<span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:OpenLayers.Filter.Spatial.INTERSECTS,<span class="attr">property</span>:a.name,<span class="attr">value</span>:b&#125;):<span class="keyword">this</span>.handler <span class="keyword">instanceof</span> OpenLayers.Handler.Click&amp;&amp;(c=<span class="number">0</span>&lt;=a.type.indexOf(<span class="string">"Polygon"</span>)?<span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:OpenLayers.Filter.Spatial.INTERSECTS,<span class="attr">property</span>:a.name,<span class="attr">value</span>:b&#125;):<span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:OpenLayers.Filter.Spatial.DWITHIN,<span class="attr">property</span>:a.name,<span class="attr">distance</span>:<span class="number">0.01</span>*<span class="keyword">this</span>.map.getExtent().getWidth(),</span><br><span class="line">distanceUnits:<span class="keyword">this</span>.map.getUnits(),<span class="attr">value</span>:b&#125;));<span class="keyword">return</span> c&#125;,<span class="attr">select</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>._queue=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="keyword">this</span>.layers.length;b&lt;c;b++)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="keyword">this</span>.layers[b],e=<span class="keyword">this</span>.getGeometryAttributes(d),f=[],g=<span class="number">0</span>,h=e.length;g&lt;h;g++)&#123;<span class="keyword">var</span> k=e[g];<span class="keyword">if</span>(<span class="literal">null</span>!==k)&#123;<span class="keyword">if</span>(!(a <span class="keyword">instanceof</span> OpenLayers.Geometry))&#123;<span class="keyword">var</span> l=<span class="keyword">this</span>.map.getLonLatFromPixel(a.xy);a=<span class="keyword">new</span> OpenLayers.Geometry.Point(l.lon,l.lat)&#125;k=<span class="keyword">this</span>.createFilter(k,a);<span class="literal">null</span>!==k&amp;&amp;f.push(k)&#125;&#125;g=<span class="keyword">this</span>.createSelectionLayer(d);<span class="keyword">this</span>.events.triggerEvent(<span class="string">"selected"</span>,&#123;<span class="attr">layer</span>:d,<span class="attr">filters</span>:f&#125;);</span><br><span class="line">d=<span class="keyword">this</span>.createSLD(d,f,e);g.mergeNewParams(&#123;<span class="attr">SLD_BODY</span>:d&#125;);<span class="keyword">delete</span> <span class="keyword">this</span>._queue&#125;&#125;;<span class="keyword">this</span>.applySelection()&#125;,<span class="attr">applySelection</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=!<span class="number">0</span>,b=<span class="number">0</span>,c=<span class="keyword">this</span>.layers.length;b&lt;c;b++)<span class="keyword">if</span>(!<span class="keyword">this</span>.wfsCache[<span class="keyword">this</span>.layers[b].id])&#123;a=!<span class="number">1</span>;<span class="keyword">break</span>&#125;a&amp;&amp;<span class="keyword">this</span>._queue.call(<span class="keyword">this</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.SLDSelect"</span>&#125;);OpenLayers.Control.Scale=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">element</span>:<span class="literal">null</span>,<span class="attr">geodesic</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[b]);<span class="keyword">this</span>.element=OpenLayers.Util.getElement(a)&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Control.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.element||(<span class="keyword">this</span>.element=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>),<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.element));<span class="keyword">this</span>.map.events.register(<span class="string">"moveend"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.updateScale);<span class="keyword">this</span>.updateScale();<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">updateScale</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a;</span><br><span class="line"><span class="keyword">if</span>(!<span class="number">0</span>===<span class="keyword">this</span>.geodesic)&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.map.getUnits())<span class="keyword">return</span>;a=OpenLayers.INCHES_PER_UNIT;a=(<span class="keyword">this</span>.map.getGeodesicPixelSize().w||<span class="number">1E-6</span>)*a.km*OpenLayers.DOTS_PER_INCH&#125;<span class="keyword">else</span> a=<span class="keyword">this</span>.map.getScale();a&amp;&amp;(a=<span class="number">9500</span>&lt;=a&amp;&amp;<span class="number">95E4</span>&gt;=a?<span class="built_in">Math</span>.round(a/<span class="number">1E3</span>)+<span class="string">"K"</span>:<span class="number">95E4</span>&lt;=a?<span class="built_in">Math</span>.round(a/<span class="number">1E6</span>)+<span class="string">"M"</span>:<span class="built_in">Math</span>.round(a),<span class="keyword">this</span>.element.innerHTML=OpenLayers.i18n(<span class="string">"Scale = 1 : $&#123;scaleDenom&#125;"</span>,&#123;<span class="attr">scaleDenom</span>:a&#125;))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.Scale"</span>&#125;);OpenLayers.Layer.MapGuide=OpenLayers.Class(OpenLayers.Layer.Grid,&#123;<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">useHttpTile</span>:!<span class="number">1</span>,<span class="attr">singleTile</span>:!<span class="number">1</span>,<span class="attr">useOverlay</span>:!<span class="number">1</span>,<span class="attr">useAsyncOverlay</span>:!<span class="number">0</span>,<span class="attr">TILE_PARAMS</span>:&#123;<span class="attr">operation</span>:<span class="string">"GETTILEIMAGE"</span>,<span class="attr">version</span>:<span class="string">"1.2.0"</span>&#125;,<span class="attr">SINGLE_TILE_PARAMS</span>:&#123;<span class="attr">operation</span>:<span class="string">"GETMAPIMAGE"</span>,<span class="attr">format</span>:<span class="string">"PNG"</span>,<span class="attr">locale</span>:<span class="string">"en"</span>,<span class="attr">clip</span>:<span class="string">"1"</span>,<span class="attr">version</span>:<span class="string">"1.0.0"</span>&#125;,<span class="attr">OVERLAY_PARAMS</span>:&#123;<span class="attr">operation</span>:<span class="string">"GETDYNAMICMAPOVERLAYIMAGE"</span>,<span class="attr">format</span>:<span class="string">"PNG"</span>,<span class="attr">locale</span>:<span class="string">"en"</span>,<span class="attr">clip</span>:<span class="string">"1"</span>,<span class="attr">version</span>:<span class="string">"2.0.0"</span>&#125;,<span class="attr">FOLDER_PARAMS</span>:&#123;<span class="attr">tileColumnsPerFolder</span>:<span class="number">30</span>,<span class="attr">tileRowsPerFolder</span>:<span class="number">30</span>,<span class="attr">format</span>:<span class="string">"png"</span>,<span class="attr">querystring</span>:<span class="literal">null</span>&#125;,<span class="attr">defaultSize</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">300</span>,</span><br><span class="line"><span class="number">300</span>),<span class="attr">tileOriginCorner</span>:<span class="string">"tl"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;OpenLayers.Layer.Grid.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">if</span>(<span class="literal">null</span>==d||<span class="literal">null</span>==d.isBaseLayer)<span class="keyword">this</span>.isBaseLayer=<span class="string">"true"</span>!=<span class="keyword">this</span>.transparent&amp;&amp;!<span class="number">0</span>!=<span class="keyword">this</span>.transparent;d&amp;&amp;<span class="literal">null</span>!=d.useOverlay&amp;&amp;(<span class="keyword">this</span>.useOverlay=d.useOverlay);<span class="keyword">this</span>.singleTile?<span class="keyword">this</span>.useOverlay?(OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.params,<span class="keyword">this</span>.OVERLAY_PARAMS),<span class="keyword">this</span>.useAsyncOverlay||(<span class="keyword">this</span>.params.version=<span class="string">"1.0.0"</span>)):OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.params,<span class="keyword">this</span>.SINGLE_TILE_PARAMS):(<span class="keyword">this</span>.useHttpTile?</span><br><span class="line">OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.params,<span class="keyword">this</span>.FOLDER_PARAMS):OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.params,<span class="keyword">this</span>.TILE_PARAMS),<span class="keyword">this</span>.setTileSize(<span class="keyword">this</span>.defaultSize))&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.MapGuide(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.params,<span class="keyword">this</span>.getOptions()));<span class="keyword">return</span> a=OpenLayers.Layer.Grid.prototype.clone.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;b=a.getCenterLonLat();<span class="keyword">var</span> c=<span class="keyword">this</span>.map.getSize();<span class="keyword">this</span>.singleTile?(a=&#123;<span class="attr">setdisplaydpi</span>:OpenLayers.DOTS_PER_INCH,<span class="attr">setdisplayheight</span>:c.h*<span class="keyword">this</span>.ratio,<span class="attr">setdisplaywidth</span>:c.w*</span><br><span class="line"><span class="keyword">this</span>.ratio,<span class="attr">setviewcenterx</span>:b.lon,<span class="attr">setviewcentery</span>:b.lat,<span class="attr">setviewscale</span>:<span class="keyword">this</span>.map.getScale()&#125;,<span class="keyword">this</span>.useOverlay&amp;&amp;!<span class="keyword">this</span>.useAsyncOverlay&amp;&amp;(b=&#123;&#125;,b=OpenLayers.Util.extend(b,a),b.operation=<span class="string">"GETVISIBLEMAPEXTENT"</span>,b.version=<span class="string">"1.0.0"</span>,b.session=<span class="keyword">this</span>.params.session,b.mapName=<span class="keyword">this</span>.params.mapName,b.format=<span class="string">"text/xml"</span>,b=<span class="keyword">this</span>.getFullRequestString(b),OpenLayers.Request.GET(&#123;<span class="attr">url</span>:b,<span class="attr">async</span>:!<span class="number">1</span>&#125;)),b=<span class="keyword">this</span>.getFullRequestString(a)):(c=<span class="keyword">this</span>.map.getResolution(),b=<span class="built_in">Math</span>.floor((a.left-<span class="keyword">this</span>.maxExtent.left)/c),b=<span class="built_in">Math</span>.round(b/<span class="keyword">this</span>.tileSize.w),</span><br><span class="line">a=<span class="built_in">Math</span>.floor((<span class="keyword">this</span>.maxExtent.top-a.top)/c),a=<span class="built_in">Math</span>.round(a/<span class="keyword">this</span>.tileSize.h),b=<span class="keyword">this</span>.useHttpTile?<span class="keyword">this</span>.getImageFilePath(&#123;<span class="attr">tilecol</span>:b,<span class="attr">tilerow</span>:a,<span class="attr">scaleindex</span>:<span class="keyword">this</span>.resolutions.length-<span class="keyword">this</span>.map.zoom<span class="number">-1</span>&#125;):<span class="keyword">this</span>.getFullRequestString(&#123;<span class="attr">tilecol</span>:b,<span class="attr">tilerow</span>:a,<span class="attr">scaleindex</span>:<span class="keyword">this</span>.resolutions.length-<span class="keyword">this</span>.map.zoom<span class="number">-1</span>&#125;));<span class="keyword">return</span> b&#125;,<span class="attr">getFullRequestString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>==b?<span class="keyword">this</span>.url:b;<span class="string">"object"</span>==<span class="keyword">typeof</span> c&amp;&amp;(c=c[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*c.length)]);<span class="keyword">var</span> d=c,e=OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>.params),e=OpenLayers.Util.extend(e,a),</span><br><span class="line">f=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c)),g;<span class="keyword">for</span>(g <span class="keyword">in</span> e)g.toUpperCase()<span class="keyword">in</span> f&amp;&amp;<span class="keyword">delete</span> e[g];e=OpenLayers.Util.getParameterString(e);e=e.replace(<span class="regexp">/,/g</span>,<span class="string">"+"</span>);<span class="string">""</span>!=e&amp;&amp;(f=c.charAt(c.length<span class="number">-1</span>),d=<span class="string">"&amp;"</span>==f||<span class="string">"?"</span>==f?d+e:<span class="number">-1</span>==c.indexOf(<span class="string">"?"</span>)?d+(<span class="string">"?"</span>+e):d+(<span class="string">"&amp;"</span>+e));<span class="keyword">return</span> d&#125;,<span class="attr">getImageFilePath</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>==b?<span class="keyword">this</span>.url:b;<span class="string">"object"</span>==<span class="keyword">typeof</span> c&amp;&amp;(c=c[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*c.length)]);<span class="keyword">var</span> d=<span class="string">""</span>,e=<span class="string">""</span>;<span class="number">0</span>&gt;a.tilerow&amp;&amp;(d=<span class="string">"-"</span>);d=<span class="number">0</span>==a.tilerow?d+<span class="string">"0"</span>:d+<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.abs(a.tilerow/<span class="keyword">this</span>.params.tileRowsPerFolder))*</span><br><span class="line"><span class="keyword">this</span>.params.tileRowsPerFolder;<span class="number">0</span>&gt;a.tilecol&amp;&amp;(e=<span class="string">"-"</span>);e=<span class="number">0</span>==a.tilecol?e+<span class="string">"0"</span>:e+<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.abs(a.tilecol/<span class="keyword">this</span>.params.tileColumnsPerFolder))*<span class="keyword">this</span>.params.tileColumnsPerFolder;d=<span class="string">"/S"</span>+<span class="built_in">Math</span>.floor(a.scaleindex)+<span class="string">"/"</span>+<span class="keyword">this</span>.params.basemaplayergroupname+<span class="string">"/R"</span>+d+<span class="string">"/C"</span>+e+<span class="string">"/"</span>+a.tilerow%<span class="keyword">this</span>.params.tileRowsPerFolder+<span class="string">"_"</span>+a.tilecol%<span class="keyword">this</span>.params.tileColumnsPerFolder+<span class="string">"."</span>+<span class="keyword">this</span>.params.format;<span class="keyword">this</span>.params.querystring&amp;&amp;(d+=<span class="string">"?"</span>+<span class="keyword">this</span>.params.querystring);<span class="keyword">return</span> c+d&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.MapGuide"</span>&#125;);OpenLayers.Control.Measure=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">callbacks</span>:<span class="literal">null</span>,<span class="attr">displaySystem</span>:<span class="string">"metric"</span>,<span class="attr">geodesic</span>:!<span class="number">1</span>,<span class="attr">displaySystemUnits</span>:&#123;<span class="attr">geographic</span>:[<span class="string">"dd"</span>],<span class="attr">english</span>:[<span class="string">"mi"</span>,<span class="string">"ft"</span>,<span class="string">"in"</span>],<span class="attr">metric</span>:[<span class="string">"km"</span>,<span class="string">"m"</span>]&#125;,<span class="attr">partialDelay</span>:<span class="number">300</span>,<span class="attr">delayedTrigger</span>:<span class="literal">null</span>,<span class="attr">persist</span>:!<span class="number">1</span>,<span class="attr">immediate</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[b]);<span class="keyword">var</span> c=&#123;<span class="attr">done</span>:<span class="keyword">this</span>.measureComplete,<span class="attr">point</span>:<span class="keyword">this</span>.measurePartial&#125;;<span class="keyword">this</span>.immediate&amp;&amp;(c.modify=<span class="keyword">this</span>.measureImmediate);<span class="keyword">this</span>.callbacks=OpenLayers.Util.extend(c,<span class="keyword">this</span>.callbacks);</span><br><span class="line"><span class="keyword">this</span>.handlerOptions=OpenLayers.Util.extend(&#123;<span class="attr">persist</span>:<span class="keyword">this</span>.persist&#125;,<span class="keyword">this</span>.handlerOptions);<span class="keyword">this</span>.handler=<span class="keyword">new</span> a(<span class="keyword">this</span>,<span class="keyword">this</span>.callbacks,<span class="keyword">this</span>.handlerOptions)&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.cancelDelay();<span class="keyword">return</span> OpenLayers.Control.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">cancel</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.cancelDelay();<span class="keyword">this</span>.handler.cancel()&#125;,<span class="attr">setImmediate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;(<span class="keyword">this</span>.immediate=a)?<span class="keyword">this</span>.callbacks.modify=<span class="keyword">this</span>.measureImmediate:<span class="keyword">delete</span> <span class="keyword">this</span>.callbacks.modify&#125;,<span class="attr">updateHandler</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.active;c&amp;&amp;<span class="keyword">this</span>.deactivate();</span><br><span class="line"><span class="keyword">this</span>.handler=<span class="keyword">new</span> a(<span class="keyword">this</span>,<span class="keyword">this</span>.callbacks,b);c&amp;&amp;<span class="keyword">this</span>.activate()&#125;,<span class="attr">measureComplete</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.cancelDelay();<span class="keyword">this</span>.measure(a,<span class="string">"measure"</span>)&#125;,<span class="attr">measurePartial</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.cancelDelay();b=b.clone();<span class="keyword">this</span>.handler.freehandMode(<span class="keyword">this</span>.handler.evt)?<span class="keyword">this</span>.measure(b,<span class="string">"measurepartial"</span>):<span class="keyword">this</span>.delayedTrigger=<span class="built_in">window</span>.setTimeout(OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.delayedTrigger=<span class="literal">null</span>;<span class="keyword">this</span>.measure(b,<span class="string">"measurepartial"</span>)&#125;,<span class="keyword">this</span>),<span class="keyword">this</span>.partialDelay)&#125;,<span class="attr">measureImmediate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;c&amp;&amp;!<span class="keyword">this</span>.handler.freehandMode(<span class="keyword">this</span>.handler.evt)&amp;&amp;</span><br><span class="line">(<span class="keyword">this</span>.cancelDelay(),<span class="keyword">this</span>.measure(b.geometry,<span class="string">"measurepartial"</span>))&#125;,<span class="attr">cancelDelay</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="literal">null</span>!==<span class="keyword">this</span>.delayedTrigger&amp;&amp;(<span class="built_in">window</span>.clearTimeout(<span class="keyword">this</span>.delayedTrigger),<span class="keyword">this</span>.delayedTrigger=<span class="literal">null</span>)&#125;,<span class="attr">measure</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c,d;<span class="number">-1</span>&lt;a.CLASS_NAME.indexOf(<span class="string">"LineString"</span>)?(c=<span class="keyword">this</span>.getBestLength(a),d=<span class="number">1</span>):(c=<span class="keyword">this</span>.getBestArea(a),d=<span class="number">2</span>);<span class="keyword">this</span>.events.triggerEvent(b,&#123;<span class="attr">measure</span>:c[<span class="number">0</span>],<span class="attr">units</span>:c[<span class="number">1</span>],<span class="attr">order</span>:d,<span class="attr">geometry</span>:a&#125;)&#125;,<span class="attr">getBestArea</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.displaySystemUnits[<span class="keyword">this</span>.displaySystem],c,d,e=<span class="number">0</span>,f=b.length;e&lt;f&amp;&amp;!(c=b[e],d=<span class="keyword">this</span>.getArea(a,</span><br><span class="line">c),<span class="number">1</span>&lt;d);++e);<span class="keyword">return</span>[d,c]&#125;,<span class="attr">getArea</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c,d;<span class="keyword">this</span>.geodesic?(c=a.getGeodesicArea(<span class="keyword">this</span>.map.getProjectionObject()),d=<span class="string">"m"</span>):(c=a.getArea(),d=<span class="keyword">this</span>.map.getUnits());<span class="keyword">var</span> e=OpenLayers.INCHES_PER_UNIT[b];e&amp;&amp;(c*=<span class="built_in">Math</span>.pow(OpenLayers.INCHES_PER_UNIT[d]/e,<span class="number">2</span>));<span class="keyword">return</span> c&#125;,<span class="attr">getBestLength</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.displaySystemUnits[<span class="keyword">this</span>.displaySystem],c,d,e=<span class="number">0</span>,f=b.length;e&lt;f&amp;&amp;!(c=b[e],d=<span class="keyword">this</span>.getLength(a,c),<span class="number">1</span>&lt;d);++e);<span class="keyword">return</span>[d,c]&#125;,<span class="attr">getLength</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c,d;<span class="keyword">this</span>.geodesic?(c=a.getGeodesicLength(<span class="keyword">this</span>.map.getProjectionObject()),</span><br><span class="line">d=<span class="string">"m"</span>):(c=a.getLength(),d=<span class="keyword">this</span>.map.getUnits());<span class="keyword">var</span> e=OpenLayers.INCHES_PER_UNIT[b];e&amp;&amp;(c*=OpenLayers.INCHES_PER_UNIT[d]/e);<span class="keyword">return</span> c&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.Measure"</span>&#125;);OpenLayers.Format.WMC.v1_0_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,&#123;<span class="attr">VERSION</span>:<span class="string">"1.0.0"</span>,<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/context http://schemas.opengis.net/context/1.0.0/context.xsd"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.WMC.v1.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">read_wmc_SRS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(b);<span class="string">"object"</span>!=<span class="keyword">typeof</span> a.projections&amp;&amp;(a.projections=&#123;&#125;);<span class="keyword">for</span>(<span class="keyword">var</span> c=c.split(<span class="regexp">/ +/</span>),d=<span class="number">0</span>,e=c.length;d&lt;e;d++)a.projections[c[d]]=!<span class="number">0</span>&#125;,<span class="attr">write_wmc_Layer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(<span class="keyword">this</span>,</span><br><span class="line">[a]);<span class="keyword">if</span>(a.srs)&#123;<span class="keyword">var</span> c=[],d;<span class="keyword">for</span>(d <span class="keyword">in</span> a.srs)c.push(d);b.appendChild(<span class="keyword">this</span>.createElementDefaultNS(<span class="string">"SRS"</span>,c.join(<span class="string">" "</span>)))&#125;b.appendChild(<span class="keyword">this</span>.write_wmc_FormatList(a));b.appendChild(<span class="keyword">this</span>.write_wmc_StyleList(a));a.dimensions&amp;&amp;b.appendChild(<span class="keyword">this</span>.write_wmc_DimensionList(a));b.appendChild(<span class="keyword">this</span>.write_wmc_LayerExtension(a))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMC.v1_0_0"</span>&#125;);OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,&#123;<span class="attr">relativePosition</span>:<span class="literal">null</span>,<span class="attr">keepInMap</span>:!<span class="number">0</span>,<span class="attr">anchor</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e,f,g</span>)</span>&#123;OpenLayers.Popup.prototype.initialize.apply(<span class="keyword">this</span>,[a,b,c,d,f,g]);<span class="keyword">this</span>.anchor=<span class="literal">null</span>!=e?e:&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">0</span>,<span class="number">0</span>),<span class="attr">offset</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">0</span>,<span class="number">0</span>)&#125;&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.relativePosition=<span class="keyword">this</span>.anchor=<span class="literal">null</span>;OpenLayers.Popup.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">show</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.updatePosition();OpenLayers.Popup.prototype.show.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,</span><br><span class="line">moveTo:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.relativePosition;<span class="keyword">this</span>.relativePosition=<span class="keyword">this</span>.calculateRelativePosition(a);OpenLayers.Popup.prototype.moveTo.call(<span class="keyword">this</span>,<span class="keyword">this</span>.calculateNewPx(a));<span class="keyword">this</span>.relativePosition!=b&amp;&amp;<span class="keyword">this</span>.updateRelativePosition()&#125;,<span class="attr">setSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Popup.prototype.setSize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">if</span>(<span class="keyword">this</span>.lonlat&amp;&amp;<span class="keyword">this</span>.map)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getLayerPxFromLonLat(<span class="keyword">this</span>.lonlat);<span class="keyword">this</span>.moveTo(b)&#125;&#125;,<span class="attr">calculateRelativePosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.map.getLonLatFromLayerPx(a);a=<span class="keyword">this</span>.map.getExtent().determineQuadrant(a);</span><br><span class="line"><span class="keyword">return</span> OpenLayers.Bounds.oppositeQuadrant(a)&#125;,<span class="attr">updateRelativePosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">calculateNewPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.offset(<span class="keyword">this</span>.anchor.offset);<span class="keyword">var</span> b=<span class="keyword">this</span>.size||<span class="keyword">this</span>.contentSize,c=<span class="string">"t"</span>==<span class="keyword">this</span>.relativePosition.charAt(<span class="number">0</span>);a.y+=c?-b.h:<span class="keyword">this</span>.anchor.size.h;c=<span class="string">"l"</span>==<span class="keyword">this</span>.relativePosition.charAt(<span class="number">1</span>);a.x+=c?-b.w:<span class="keyword">this</span>.anchor.size.w;<span class="keyword">return</span> a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Popup.Anchored"</span>&#125;);OpenLayers.Popup.Framed=OpenLayers.Class(OpenLayers.Popup.Anchored,&#123;<span class="attr">imageSrc</span>:<span class="literal">null</span>,<span class="attr">imageSize</span>:<span class="literal">null</span>,<span class="attr">isAlphaImage</span>:!<span class="number">1</span>,<span class="attr">positionBlocks</span>:<span class="literal">null</span>,<span class="attr">blocks</span>:<span class="literal">null</span>,<span class="attr">fixedRelativePosition</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e,f,g</span>)</span>&#123;OpenLayers.Popup.Anchored.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.fixedRelativePosition&amp;&amp;(<span class="keyword">this</span>.updateRelativePosition(),<span class="keyword">this</span>.calculateRelativePosition=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.relativePosition&#125;);<span class="keyword">this</span>.contentDiv.style.position=<span class="string">"absolute"</span>;<span class="keyword">this</span>.contentDiv.style.zIndex=<span class="number">1</span>;f&amp;&amp;(<span class="keyword">this</span>.closeDiv.style.zIndex=</span><br><span class="line"><span class="number">1</span>);<span class="keyword">this</span>.groupDiv.style.position=<span class="string">"absolute"</span>;<span class="keyword">this</span>.groupDiv.style.top=<span class="string">"0px"</span>;<span class="keyword">this</span>.groupDiv.style.left=<span class="string">"0px"</span>;<span class="keyword">this</span>.groupDiv.style.height=<span class="string">"100%"</span>;<span class="keyword">this</span>.groupDiv.style.width=<span class="string">"100%"</span>&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.isAlphaImage=<span class="keyword">this</span>.imageSize=<span class="keyword">this</span>.imageSrc=<span class="literal">null</span>;<span class="keyword">this</span>.fixedRelativePosition=!<span class="number">1</span>;<span class="keyword">this</span>.positionBlocks=<span class="literal">null</span>;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>;a&lt;<span class="keyword">this</span>.blocks.length;a++)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.blocks[a];b.image&amp;&amp;b.div.removeChild(b.image);b.image=<span class="literal">null</span>;b.div&amp;&amp;<span class="keyword">this</span>.groupDiv.removeChild(b.div);b.div=<span class="literal">null</span>&#125;<span class="keyword">this</span>.blocks=<span class="literal">null</span>;OpenLayers.Popup.Anchored.prototype.destroy.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>)&#125;,<span class="attr">setBackgroundColor</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">setBorder</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">setOpacity</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">setSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Popup.Anchored.prototype.setSize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.updateBlocks()&#125;,<span class="attr">updateRelativePosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.padding=<span class="keyword">this</span>.positionBlocks[<span class="keyword">this</span>.relativePosition].padding;<span class="keyword">if</span>(<span class="keyword">this</span>.closeDiv)&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.getContentDivPadding();<span class="keyword">this</span>.closeDiv.style.right=a.right+<span class="keyword">this</span>.padding.right+<span class="string">"px"</span>;<span class="keyword">this</span>.closeDiv.style.top=a.top+<span class="keyword">this</span>.padding.top+<span class="string">"px"</span>&#125;<span class="keyword">this</span>.updateBlocks()&#125;,<span class="attr">calculateNewPx</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line">OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">return</span> b=b.offset(<span class="keyword">this</span>.positionBlocks[<span class="keyword">this</span>.relativePosition].offset)&#125;,<span class="attr">createBlocks</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.blocks=[];<span class="keyword">var</span> a=<span class="literal">null</span>,b;<span class="keyword">for</span>(b <span class="keyword">in</span> <span class="keyword">this</span>.positionBlocks)&#123;a=b;<span class="keyword">break</span>&#125;a=<span class="keyword">this</span>.positionBlocks[a];<span class="keyword">for</span>(b=<span class="number">0</span>;b&lt;a.blocks.length;b++)&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.blocks.push(c);c.div=OpenLayers.Util.createDiv(<span class="keyword">this</span>.id+<span class="string">"_FrameDecorationDiv_"</span>+b,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="string">"absolute"</span>,<span class="literal">null</span>,<span class="string">"hidden"</span>,<span class="literal">null</span>);c.image=(<span class="keyword">this</span>.isAlphaImage?OpenLayers.Util.createAlphaImageDiv:OpenLayers.Util.createImage)(<span class="keyword">this</span>.id+</span><br><span class="line"><span class="string">"_FrameDecorationImg_"</span>+b,<span class="literal">null</span>,<span class="keyword">this</span>.imageSize,<span class="keyword">this</span>.imageSrc,<span class="string">"absolute"</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>);c.div.appendChild(c.image);<span class="keyword">this</span>.groupDiv.appendChild(c.div)&#125;&#125;,<span class="attr">updateBlocks</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.blocks||<span class="keyword">this</span>.createBlocks();<span class="keyword">if</span>(<span class="keyword">this</span>.size&amp;&amp;<span class="keyword">this</span>.relativePosition)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.positionBlocks[<span class="keyword">this</span>.relativePosition],b=<span class="number">0</span>;b&lt;a.blocks.length;b++)&#123;<span class="keyword">var</span> c=a.blocks[b],d=<span class="keyword">this</span>.blocks[b],e=c.anchor.left,f=c.anchor.bottom,g=c.anchor.right,h=c.anchor.top,k=<span class="built_in">isNaN</span>(c.size.w)?<span class="keyword">this</span>.size.w-(g+e):c.size.w,l=<span class="built_in">isNaN</span>(c.size.h)?<span class="keyword">this</span>.size.h-(f+</span><br><span class="line">h):c.size.h;d.div.style.width=(<span class="number">0</span>&gt;k?<span class="number">0</span>:k)+<span class="string">"px"</span>;d.div.style.height=(<span class="number">0</span>&gt;l?<span class="number">0</span>:l)+<span class="string">"px"</span>;d.div.style.left=<span class="literal">null</span>!=e?e+<span class="string">"px"</span>:<span class="string">""</span>;d.div.style.bottom=<span class="literal">null</span>!=f?f+<span class="string">"px"</span>:<span class="string">""</span>;d.div.style.right=<span class="literal">null</span>!=g?g+<span class="string">"px"</span>:<span class="string">""</span>;d.div.style.top=<span class="literal">null</span>!=h?h+<span class="string">"px"</span>:<span class="string">""</span>;d.image.style.left=c.position.x+<span class="string">"px"</span>;d.image.style.top=c.position.y+<span class="string">"px"</span>&#125;<span class="keyword">this</span>.contentDiv.style.left=<span class="keyword">this</span>.padding.left+<span class="string">"px"</span>;<span class="keyword">this</span>.contentDiv.style.top=<span class="keyword">this</span>.padding.top+<span class="string">"px"</span>&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Popup.Framed"</span>&#125;);OpenLayers.Popup.FramedCloud=OpenLayers.Class(OpenLayers.Popup.Framed,&#123;<span class="attr">contentDisplayClass</span>:<span class="string">"olFramedCloudPopupContent"</span>,<span class="attr">autoSize</span>:!<span class="number">0</span>,<span class="attr">panMapIfOutOfView</span>:!<span class="number">0</span>,<span class="attr">imageSize</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">1276</span>,<span class="number">736</span>),<span class="attr">isAlphaImage</span>:!<span class="number">1</span>,<span class="attr">fixedRelativePosition</span>:!<span class="number">1</span>,<span class="attr">positionBlocks</span>:&#123;<span class="attr">tl</span>:&#123;<span class="attr">offset</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">44</span>,<span class="number">0</span>),<span class="attr">padding</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">8</span>,<span class="number">40</span>,<span class="number">8</span>,<span class="number">9</span>),<span class="attr">blocks</span>:[&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="string">"auto"</span>,<span class="string">"auto"</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">0</span>,<span class="number">51</span>,<span class="number">22</span>,<span class="number">0</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">0</span>,<span class="number">0</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">22</span>,<span class="string">"auto"</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="literal">null</span>,</span><br><span class="line"><span class="number">50</span>,<span class="number">0</span>,<span class="number">0</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">-1238</span>,<span class="number">0</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="string">"auto"</span>,<span class="number">19</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">0</span>,<span class="number">32</span>,<span class="number">22</span>,<span class="literal">null</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">0</span>,<span class="number">-631</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">22</span>,<span class="number">18</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="literal">null</span>,<span class="number">32</span>,<span class="number">0</span>,<span class="literal">null</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">-1238</span>,<span class="number">-632</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">81</span>,<span class="number">35</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="literal">null</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="literal">null</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">0</span>,<span class="number">-688</span>)&#125;]&#125;,<span class="attr">tr</span>:&#123;<span class="attr">offset</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">-45</span>,<span class="number">0</span>),<span class="attr">padding</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">8</span>,<span class="number">40</span>,<span class="number">8</span>,<span class="number">9</span>),<span class="attr">blocks</span>:[&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="string">"auto"</span>,</span><br><span class="line"><span class="string">"auto"</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">0</span>,<span class="number">51</span>,<span class="number">22</span>,<span class="number">0</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">0</span>,<span class="number">0</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">22</span>,<span class="string">"auto"</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="literal">null</span>,<span class="number">50</span>,<span class="number">0</span>,<span class="number">0</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">-1238</span>,<span class="number">0</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="string">"auto"</span>,<span class="number">19</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">0</span>,<span class="number">32</span>,<span class="number">22</span>,<span class="literal">null</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">0</span>,<span class="number">-631</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">22</span>,<span class="number">19</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="literal">null</span>,<span class="number">32</span>,<span class="number">0</span>,<span class="literal">null</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">-1238</span>,<span class="number">-631</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">81</span>,<span class="number">35</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="literal">null</span>,<span class="literal">null</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">-215</span>,<span class="number">-687</span>)&#125;]&#125;,<span class="attr">bl</span>:&#123;<span class="attr">offset</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">45</span>,<span class="number">0</span>),<span class="attr">padding</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">8</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">40</span>),<span class="attr">blocks</span>:[&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="string">"auto"</span>,<span class="string">"auto"</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">0</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">32</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">0</span>,<span class="number">0</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">22</span>,<span class="string">"auto"</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="literal">null</span>,<span class="number">21</span>,<span class="number">0</span>,<span class="number">32</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">-1238</span>,<span class="number">0</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="string">"auto"</span>,<span class="number">21</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">0</span>,<span class="number">0</span>,<span class="number">22</span>,<span class="literal">null</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">0</span>,<span class="number">-629</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">22</span>,</span><br><span class="line"><span class="number">21</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="literal">null</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="literal">null</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">-1238</span>,<span class="number">-629</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">81</span>,<span class="number">33</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="literal">null</span>,<span class="literal">null</span>,<span class="number">0</span>,<span class="number">0</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">-101</span>,<span class="number">-674</span>)&#125;]&#125;,<span class="attr">br</span>:&#123;<span class="attr">offset</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">-44</span>,<span class="number">0</span>),<span class="attr">padding</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">8</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">40</span>),<span class="attr">blocks</span>:[&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="string">"auto"</span>,<span class="string">"auto"</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">0</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">32</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">0</span>,<span class="number">0</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">22</span>,<span class="string">"auto"</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="literal">null</span>,<span class="number">21</span>,<span class="number">0</span>,<span class="number">32</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">-1238</span>,</span><br><span class="line"><span class="number">0</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="string">"auto"</span>,<span class="number">21</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">0</span>,<span class="number">0</span>,<span class="number">22</span>,<span class="literal">null</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">0</span>,<span class="number">-629</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">22</span>,<span class="number">21</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="literal">null</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="literal">null</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">-1238</span>,<span class="number">-629</span>)&#125;,&#123;<span class="attr">size</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">81</span>,<span class="number">33</span>),<span class="attr">anchor</span>:<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">0</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="number">0</span>),<span class="attr">position</span>:<span class="keyword">new</span> OpenLayers.Pixel(<span class="number">-311</span>,<span class="number">-674</span>)&#125;]&#125;&#125;,<span class="attr">minSize</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">105</span>,<span class="number">10</span>),<span class="attr">maxSize</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">1200</span>,<span class="number">660</span>),<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d,e,f,g</span>)</span>&#123;<span class="keyword">this</span>.imageSrc=OpenLayers.Util.getImageLocation(<span class="string">"cloud-popup-relative.png"</span>);</span><br><span class="line">OpenLayers.Popup.Framed.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.contentDiv.className=<span class="keyword">this</span>.contentDisplayClass&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Popup.FramedCloud"</span>&#125;);OpenLayers.Tile.Image.IFrame=&#123;<span class="attr">useIFrame</span>:<span class="literal">null</span>,<span class="attr">blankImageUrl</span>:<span class="string">"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7"</span>,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(OpenLayers.Tile.Image.prototype.shouldDraw.call(<span class="keyword">this</span>))&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.layer.getURL(<span class="keyword">this</span>.bounds),b=<span class="keyword">this</span>.useIFrame;<span class="keyword">this</span>.useIFrame=<span class="literal">null</span>!==<span class="keyword">this</span>.maxGetUrlLength&amp;&amp;!<span class="keyword">this</span>.layer.async&amp;&amp;a.length&gt;<span class="keyword">this</span>.maxGetUrlLength;a=b&amp;&amp;!<span class="keyword">this</span>.useIFrame;b=!b&amp;&amp;<span class="keyword">this</span>.useIFrame;<span class="keyword">if</span>(a||b)<span class="keyword">this</span>.imgDiv&amp;&amp;<span class="keyword">this</span>.imgDiv.parentNode===<span class="keyword">this</span>.frame&amp;&amp;<span class="keyword">this</span>.frame.removeChild(<span class="keyword">this</span>.imgDiv),<span class="keyword">this</span>.imgDiv=</span><br><span class="line"><span class="literal">null</span>,a&amp;&amp;<span class="keyword">this</span>.frame.removeChild(<span class="keyword">this</span>.frame.firstChild)&#125;<span class="keyword">return</span> OpenLayers.Tile.Image.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">getImage</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!<span class="number">0</span>===<span class="keyword">this</span>.useIFrame)&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.frame.childNodes.length)&#123;<span class="keyword">var</span> a=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>),b=a.style;b.position=<span class="string">"absolute"</span>;b.width=<span class="string">"100%"</span>;b.height=<span class="string">"100%"</span>;b.zIndex=<span class="number">1</span>;b.backgroundImage=<span class="string">"url("</span>+<span class="keyword">this</span>.blankImageUrl+<span class="string">")"</span>;<span class="keyword">this</span>.frame.appendChild(a)&#125;a=<span class="keyword">this</span>.id+<span class="string">"_iFrame"</span>;<span class="number">9</span>&gt;<span class="built_in">parseFloat</span>(navigator.appVersion.split(<span class="string">"MSIE"</span>)[<span class="number">1</span>])?(b=<span class="built_in">document</span>.createElement(<span class="string">'&lt;iframe name="'</span>+a+<span class="string">'"&gt;'</span>),</span><br><span class="line">b.style.backgroundColor=<span class="string">"#FFFFFF"</span>,b.style.filter=<span class="string">"chroma(color=#FFFFFF)"</span>):(b=<span class="built_in">document</span>.createElement(<span class="string">"iframe"</span>),b.style.backgroundColor=<span class="string">"transparent"</span>,b.name=a);b.scrolling=<span class="string">"no"</span>;b.marginWidth=<span class="string">"0px"</span>;b.marginHeight=<span class="string">"0px"</span>;b.frameBorder=<span class="string">"0"</span>;b.style.position=<span class="string">"absolute"</span>;b.style.width=<span class="string">"100%"</span>;b.style.height=<span class="string">"100%"</span>;<span class="number">1</span>&gt;<span class="keyword">this</span>.layer.opacity&amp;&amp;OpenLayers.Util.modifyDOMElement(b,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="keyword">this</span>.layer.opacity);<span class="keyword">this</span>.frame.appendChild(b);<span class="keyword">return</span> <span class="keyword">this</span>.imgDiv=b&#125;<span class="keyword">return</span> OpenLayers.Tile.Image.prototype.getImage.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>)&#125;,<span class="attr">createRequestForm</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="built_in">document</span>.createElement(<span class="string">"form"</span>);a.method=<span class="string">"POST"</span>;<span class="keyword">var</span> b=<span class="keyword">this</span>.layer.params._OLSALT,b=(b?b+<span class="string">"_"</span>:<span class="string">""</span>)+<span class="keyword">this</span>.bounds.toBBOX();a.action=OpenLayers.Util.urlAppend(<span class="keyword">this</span>.layer.url,b);a.target=<span class="keyword">this</span>.id+<span class="string">"_iFrame"</span>;<span class="keyword">this</span>.layer.getImageSize();<span class="keyword">var</span> b=OpenLayers.Util.getParameters(<span class="keyword">this</span>.url),c,d;<span class="keyword">for</span>(d <span class="keyword">in</span> b)c=<span class="built_in">document</span>.createElement(<span class="string">"input"</span>),c.type=<span class="string">"hidden"</span>,c.name=d,c.value=b[d],a.appendChild(c);<span class="keyword">return</span> a&#125;,<span class="attr">setImgSrc</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!<span class="number">0</span>===<span class="keyword">this</span>.useIFrame)<span class="keyword">if</span>(a)&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createRequestForm();</span><br><span class="line"><span class="keyword">this</span>.frame.appendChild(b);b.submit();<span class="keyword">this</span>.frame.removeChild(b)&#125;<span class="keyword">else</span> <span class="keyword">this</span>.imgDiv.parentNode===<span class="keyword">this</span>.frame&amp;&amp;(<span class="keyword">this</span>.frame.removeChild(<span class="keyword">this</span>.imgDiv),<span class="keyword">this</span>.imgDiv=<span class="literal">null</span>);<span class="keyword">else</span> OpenLayers.Tile.Image.prototype.setImgSrc.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">onImageLoad</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Tile.Image.prototype.onImageLoad.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);!<span class="number">0</span>===<span class="keyword">this</span>.useIFrame&amp;&amp;(<span class="keyword">this</span>.imgDiv.style.opacity=<span class="number">1</span>,<span class="keyword">this</span>.frame.style.opacity=<span class="keyword">this</span>.layer.opacity)&#125;,<span class="attr">createBackBuffer</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a;!<span class="number">1</span>===<span class="keyword">this</span>.useIFrame&amp;&amp;(a=OpenLayers.Tile.Image.prototype.createBackBuffer.call(<span class="keyword">this</span>));</span><br><span class="line"><span class="keyword">return</span> a&#125;&#125;;OpenLayers.Format.SOSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,&#123;<span class="attr">defaultVersion</span>:<span class="string">"1.0.0"</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.SOSCapabilities"</span>&#125;);OpenLayers.Format.SOSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.SOSCapabilities,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows/1.1"</span>,<span class="attr">sos</span>:<span class="string">"http://www.opengis.net/sos/1.0"</span>,<span class="attr">gml</span>:<span class="string">"http://www.opengis.net/gml"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>&#125;,<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.options=a&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,</span><br><span class="line">[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> b=&#123;&#125;;<span class="keyword">this</span>.readNode(a,b);<span class="keyword">return</span> b&#125;,<span class="attr">readers</span>:&#123;<span class="attr">gml</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.name=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">TimePeriod</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.timePeriod=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.timePeriod)&#125;,<span class="attr">beginPosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.beginPosition=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">endPosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.endPosition=<span class="keyword">this</span>.getChildValue(a)&#125;&#125;,OpenLayers.Format.GML.v3.prototype.readers.gml),<span class="attr">sos</span>:&#123;<span class="attr">Capabilities</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Contents</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.contents=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.contents)&#125;,<span class="attr">ObservationOfferingList</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.offeringList=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.offeringList)&#125;,<span class="attr">ObservationOffering</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.gml,<span class="string">"id"</span>);b[c]=&#123;<span class="attr">procedures</span>:[],<span class="attr">observedProperties</span>:[],<span class="attr">featureOfInterestIds</span>:[],<span class="attr">responseFormats</span>:[],<span class="attr">resultModels</span>:[],<span class="attr">responseModes</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b[c])&#125;,<span class="attr">time</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.time=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.time)&#125;,<span class="attr">procedure</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.procedures.push(<span class="keyword">this</span>.getAttributeNS(a,</span><br><span class="line"><span class="keyword">this</span>.namespaces.xlink,<span class="string">"href"</span>))&#125;,<span class="attr">observedProperty</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.observedProperties.push(<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.xlink,<span class="string">"href"</span>))&#125;,<span class="attr">featureOfInterest</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.featureOfInterestIds.push(<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.xlink,<span class="string">"href"</span>))&#125;,<span class="attr">responseFormat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.responseFormats.push(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">resultModel</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.resultModels.push(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">responseMode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.responseModes.push(<span class="keyword">this</span>.getChildValue(a))&#125;&#125;,<span class="attr">ows</span>:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows&#125;,</span><br><span class="line">CLASS_NAME:<span class="string">"OpenLayers.Format.SOSCapabilities.v1_0_0"</span>&#125;);OpenLayers.Handler.Pinch=OpenLayers.Class(OpenLayers.Handler,&#123;<span class="attr">started</span>:!<span class="number">1</span>,<span class="attr">stopDown</span>:!<span class="number">1</span>,<span class="attr">pinching</span>:!<span class="number">1</span>,<span class="attr">last</span>:<span class="literal">null</span>,<span class="attr">start</span>:<span class="literal">null</span>,<span class="attr">touchstart</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">0</span>;<span class="keyword">this</span>.pinching=!<span class="number">1</span>;<span class="keyword">if</span>(OpenLayers.Event.isMultiTouch(a))<span class="keyword">this</span>.started=!<span class="number">0</span>,<span class="keyword">this</span>.last=<span class="keyword">this</span>.start=&#123;<span class="attr">distance</span>:<span class="keyword">this</span>.getDistance(a.touches),<span class="attr">delta</span>:<span class="number">0</span>,<span class="attr">scale</span>:<span class="number">1</span>&#125;,<span class="keyword">this</span>.callback(<span class="string">"start"</span>,[a,<span class="keyword">this</span>.start]),b=!<span class="keyword">this</span>.stopDown;<span class="keyword">else</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.started)<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">this</span>.started=!<span class="number">1</span>;<span class="keyword">this</span>.last=<span class="keyword">this</span>.start=<span class="literal">null</span>&#125;OpenLayers.Event.preventDefault(a);<span class="keyword">return</span> b&#125;,<span class="attr">touchmove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.started&amp;&amp;</span><br><span class="line">OpenLayers.Event.isMultiTouch(a))&#123;<span class="keyword">this</span>.pinching=!<span class="number">0</span>;<span class="keyword">var</span> b=<span class="keyword">this</span>.getPinchData(a);<span class="keyword">this</span>.callback(<span class="string">"move"</span>,[a,b]);<span class="keyword">this</span>.last=b;OpenLayers.Event.stop(a)&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.started)<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">touchend</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.started&amp;&amp;!OpenLayers.Event.isMultiTouch(a)?(<span class="keyword">this</span>.pinching=<span class="keyword">this</span>.started=!<span class="number">1</span>,<span class="keyword">this</span>.callback(<span class="string">"done"</span>,[a,<span class="keyword">this</span>.start,<span class="keyword">this</span>.last]),<span class="keyword">this</span>.last=<span class="keyword">this</span>.start=<span class="literal">null</span>,!<span class="number">1</span>):!<span class="number">0</span>&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;OpenLayers.Handler.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&amp;&amp;(<span class="keyword">this</span>.pinching=!<span class="number">1</span>,a=!<span class="number">0</span>);<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=</span><br><span class="line">!<span class="number">1</span>;OpenLayers.Handler.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&amp;&amp;(<span class="keyword">this</span>.pinching=<span class="keyword">this</span>.started=!<span class="number">1</span>,<span class="keyword">this</span>.last=<span class="keyword">this</span>.start=<span class="literal">null</span>,a=!<span class="number">0</span>);<span class="keyword">return</span> a&#125;,<span class="attr">getDistance</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a[<span class="number">0</span>];a=a[<span class="number">1</span>];<span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(b.olClientX-a.olClientX,<span class="number">2</span>)+<span class="built_in">Math</span>.pow(b.olClientY-a.olClientY,<span class="number">2</span>))&#125;,<span class="attr">getPinchData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.getDistance(a.touches);<span class="keyword">return</span>&#123;<span class="attr">distance</span>:a,<span class="attr">delta</span>:<span class="keyword">this</span>.last.distance-a,<span class="attr">scale</span>:a/<span class="keyword">this</span>.start.distance&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Handler.Pinch"</span>&#125;);OpenLayers.Control.NavToolbar=OpenLayers.Class(OpenLayers.Control.Panel,&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.Panel.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.addControls([<span class="keyword">new</span> OpenLayers.Control.Navigation,<span class="keyword">new</span> OpenLayers.Control.ZoomBox])&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Control.Panel.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="literal">null</span>===<span class="keyword">this</span>.defaultControl&amp;&amp;(<span class="keyword">this</span>.defaultControl=<span class="keyword">this</span>.controls[<span class="number">0</span>]);<span class="keyword">return</span> a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.NavToolbar"</span>&#125;);OpenLayers.Strategy.Refresh=OpenLayers.Class(OpenLayers.Strategy,&#123;<span class="attr">force</span>:!<span class="number">1</span>,<span class="attr">interval</span>:<span class="number">0</span>,<span class="attr">timer</span>:<span class="literal">null</span>,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Strategy.prototype.activate.call(<span class="keyword">this</span>);a&amp;&amp;(!<span class="number">0</span>===<span class="keyword">this</span>.layer.visibility&amp;&amp;<span class="keyword">this</span>.start(),<span class="keyword">this</span>.layer.events.on(&#123;<span class="attr">visibilitychanged</span>:<span class="keyword">this</span>.reset,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;));<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Strategy.prototype.deactivate.call(<span class="keyword">this</span>);a&amp;&amp;(<span class="keyword">this</span>.stop(),<span class="keyword">this</span>.layer.events.un(&#123;<span class="attr">visibilitychanged</span>:<span class="keyword">this</span>.reset,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;));<span class="keyword">return</span> a&#125;,<span class="attr">reset</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;!<span class="number">0</span>===<span class="keyword">this</span>.layer.visibility?</span><br><span class="line"><span class="keyword">this</span>.start():<span class="keyword">this</span>.stop()&#125;,<span class="attr">start</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.interval&amp;&amp;(<span class="string">"number"</span>===<span class="keyword">typeof</span> <span class="keyword">this</span>.interval&amp;&amp;<span class="number">0</span>&lt;<span class="keyword">this</span>.interval)&amp;&amp;(<span class="keyword">this</span>.timer=<span class="built_in">window</span>.setInterval(OpenLayers.Function.bind(<span class="keyword">this</span>.refresh,<span class="keyword">this</span>),<span class="keyword">this</span>.interval))&#125;,<span class="attr">refresh</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.layer&amp;&amp;(<span class="keyword">this</span>.layer.refresh&amp;&amp;<span class="string">"function"</span>==<span class="keyword">typeof</span> <span class="keyword">this</span>.layer.refresh)&amp;&amp;<span class="keyword">this</span>.layer.refresh(&#123;<span class="attr">force</span>:<span class="keyword">this</span>.force&#125;)&#125;,<span class="attr">stop</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="literal">null</span>!==<span class="keyword">this</span>.timer&amp;&amp;(<span class="built_in">window</span>.clearInterval(<span class="keyword">this</span>.timer),<span class="keyword">this</span>.timer=<span class="literal">null</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Strategy.Refresh"</span>&#125;);OpenLayers.Layer.ArcGIS93Rest=OpenLayers.Class(OpenLayers.Layer.Grid,&#123;<span class="attr">DEFAULT_PARAMS</span>:&#123;<span class="attr">format</span>:<span class="string">"png"</span>&#125;,<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">var</span> e=[];c=OpenLayers.Util.upperCaseObject(c);e.push(a,b,c,d);OpenLayers.Layer.Grid.prototype.initialize.apply(<span class="keyword">this</span>,e);OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.params,OpenLayers.Util.upperCaseObject(<span class="keyword">this</span>.DEFAULT_PARAMS));<span class="keyword">this</span>.params.TRANSPARENT&amp;&amp;<span class="string">"true"</span>==<span class="keyword">this</span>.params.TRANSPARENT.toString().toLowerCase()&amp;&amp;(<span class="literal">null</span>!=d&amp;&amp;d.isBaseLayer||(<span class="keyword">this</span>.isBaseLayer=!<span class="number">1</span>),<span class="string">"jpg"</span>==<span class="keyword">this</span>.params.FORMAT&amp;&amp;</span><br><span class="line">(<span class="keyword">this</span>.params.FORMAT=OpenLayers.Util.alphaHack()?<span class="string">"gif"</span>:<span class="string">"png"</span>))&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.ArcGIS93Rest(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.params,<span class="keyword">this</span>.getOptions()));<span class="keyword">return</span> a=OpenLayers.Layer.Grid.prototype.clone.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.adjustBounds(a);<span class="keyword">var</span> b=<span class="keyword">this</span>.projection.getCode().split(<span class="string">":"</span>),b=b[b.length<span class="number">-1</span>],c=<span class="keyword">this</span>.getImageSize();a=&#123;<span class="attr">BBOX</span>:a.toBBOX(),<span class="attr">SIZE</span>:c.w+<span class="string">","</span>+c.h,<span class="attr">F</span>:<span class="string">"image"</span>,<span class="attr">BBOXSR</span>:b,<span class="attr">IMAGESR</span>:b&#125;;<span class="keyword">if</span>(<span class="keyword">this</span>.layerDefs)&#123;<span class="keyword">var</span> b=[],d;<span class="keyword">for</span>(d <span class="keyword">in</span> <span class="keyword">this</span>.layerDefs)<span class="keyword">this</span>.layerDefs.hasOwnProperty(d)&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.layerDefs[d]&amp;&amp;(b.push(d),b.push(<span class="string">":"</span>),b.push(<span class="keyword">this</span>.layerDefs[d]),b.push(<span class="string">";"</span>));<span class="number">0</span>&lt;b.length&amp;&amp;(a.LAYERDEFS=b.join(<span class="string">""</span>))&#125;<span class="keyword">return</span> <span class="keyword">this</span>.getFullRequestString(a)&#125;,<span class="attr">setLayerFilter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.layerDefs||(<span class="keyword">this</span>.layerDefs=&#123;&#125;);b?<span class="keyword">this</span>.layerDefs[a]=b:<span class="keyword">delete</span> <span class="keyword">this</span>.layerDefs[a]&#125;,<span class="attr">clearLayerFilter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a?<span class="keyword">delete</span> <span class="keyword">this</span>.layerDefs[a]:<span class="keyword">delete</span> <span class="keyword">this</span>.layerDefs&#125;,<span class="attr">mergeNewParams</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=[OpenLayers.Util.upperCaseObject(a)];<span class="keyword">return</span> OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(<span class="keyword">this</span>,a)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.ArcGIS93Rest"</span>&#125;);OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,&#123;<span class="attr">delay</span>:<span class="number">500</span>,<span class="attr">pixelTolerance</span>:<span class="literal">null</span>,<span class="attr">stopMove</span>:!<span class="number">1</span>,<span class="attr">px</span>:<span class="literal">null</span>,<span class="attr">timerId</span>:<span class="literal">null</span>,<span class="attr">mousemove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.passesTolerance(a.xy)&amp;&amp;(<span class="keyword">this</span>.clearTimer(),<span class="keyword">this</span>.callback(<span class="string">"move"</span>,[a]),<span class="keyword">this</span>.px=a.xy,a=OpenLayers.Util.extend(&#123;&#125;,a),<span class="keyword">this</span>.timerId=<span class="built_in">window</span>.setTimeout(OpenLayers.Function.bind(<span class="keyword">this</span>.delayedCall,<span class="keyword">this</span>,a),<span class="keyword">this</span>.delay));<span class="keyword">return</span>!<span class="keyword">this</span>.stopMove&#125;,<span class="attr">mouseout</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.mouseLeft(a,<span class="keyword">this</span>.map.viewPortDiv)&amp;&amp;(<span class="keyword">this</span>.clearTimer(),<span class="keyword">this</span>.callback(<span class="string">"move"</span>,[a]));<span class="keyword">return</span>!<span class="number">0</span>&#125;,</span><br><span class="line">passesTolerance:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">0</span>;<span class="keyword">this</span>.pixelTolerance&amp;&amp;<span class="keyword">this</span>.px&amp;&amp;<span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(<span class="keyword">this</span>.px.x-a.x,<span class="number">2</span>)+<span class="built_in">Math</span>.pow(<span class="keyword">this</span>.px.y-a.y,<span class="number">2</span>))&lt;<span class="keyword">this</span>.pixelTolerance&amp;&amp;(b=!<span class="number">1</span>);<span class="keyword">return</span> b&#125;,<span class="attr">clearTimer</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="literal">null</span>!=<span class="keyword">this</span>.timerId&amp;&amp;(<span class="built_in">window</span>.clearTimeout(<span class="keyword">this</span>.timerId),<span class="keyword">this</span>.timerId=<span class="literal">null</span>)&#125;,<span class="attr">delayedCall</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.callback(<span class="string">"pause"</span>,[a])&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;OpenLayers.Handler.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&amp;&amp;(<span class="keyword">this</span>.clearTimer(),a=!<span class="number">0</span>);<span class="keyword">return</span> a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Handler.Hover"</span>&#125;);OpenLayers.Control.GetFeature=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">protocol</span>:<span class="literal">null</span>,<span class="attr">multipleKey</span>:<span class="literal">null</span>,<span class="attr">toggleKey</span>:<span class="literal">null</span>,<span class="attr">modifiers</span>:<span class="literal">null</span>,<span class="attr">multiple</span>:!<span class="number">1</span>,<span class="attr">click</span>:!<span class="number">0</span>,<span class="attr">single</span>:!<span class="number">0</span>,<span class="attr">clickout</span>:!<span class="number">0</span>,<span class="attr">toggle</span>:!<span class="number">1</span>,<span class="attr">clickTolerance</span>:<span class="number">5</span>,<span class="attr">hover</span>:!<span class="number">1</span>,<span class="attr">box</span>:!<span class="number">1</span>,<span class="attr">maxFeatures</span>:<span class="number">10</span>,<span class="attr">features</span>:<span class="literal">null</span>,<span class="attr">hoverFeature</span>:<span class="literal">null</span>,<span class="attr">handlers</span>:<span class="literal">null</span>,<span class="attr">hoverResponse</span>:<span class="literal">null</span>,<span class="attr">filterType</span>:OpenLayers.Filter.Spatial.BBOX,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.handlerOptions=a.handlerOptions||&#123;&#125;;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.features=&#123;&#125;;<span class="keyword">this</span>.handlers=&#123;&#125;;<span class="keyword">this</span>.click&amp;&amp;(<span class="keyword">this</span>.handlers.click=</span><br><span class="line"><span class="keyword">new</span> OpenLayers.Handler.Click(<span class="keyword">this</span>,&#123;<span class="attr">click</span>:<span class="keyword">this</span>.selectClick&#125;,<span class="keyword">this</span>.handlerOptions.click||&#123;&#125;));<span class="keyword">this</span>.box&amp;&amp;(<span class="keyword">this</span>.handlers.box=<span class="keyword">new</span> OpenLayers.Handler.Box(<span class="keyword">this</span>,&#123;<span class="attr">done</span>:<span class="keyword">this</span>.selectBox&#125;,OpenLayers.Util.extend(<span class="keyword">this</span>.handlerOptions.box,&#123;<span class="attr">boxDivClassName</span>:<span class="string">"olHandlerBoxSelectFeature"</span>&#125;)));<span class="keyword">this</span>.hover&amp;&amp;(<span class="keyword">this</span>.handlers.hover=<span class="keyword">new</span> OpenLayers.Handler.Hover(<span class="keyword">this</span>,&#123;<span class="attr">move</span>:<span class="keyword">this</span>.cancelHover,<span class="attr">pause</span>:<span class="keyword">this</span>.selectHover&#125;,OpenLayers.Util.extend(<span class="keyword">this</span>.handlerOptions.hover,&#123;<span class="attr">delay</span>:<span class="number">250</span>,<span class="attr">pixelTolerance</span>:<span class="number">2</span>&#125;)))&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.active)<span class="keyword">for</span>(<span class="keyword">var</span> a <span class="keyword">in</span> <span class="keyword">this</span>.handlers)<span class="keyword">this</span>.handlers[a].activate();</span><br><span class="line"><span class="keyword">return</span> OpenLayers.Control.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.active)<span class="keyword">for</span>(<span class="keyword">var</span> a <span class="keyword">in</span> <span class="keyword">this</span>.handlers)<span class="keyword">this</span>.handlers[a].deactivate();<span class="keyword">return</span> OpenLayers.Control.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">selectClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.pixelToBounds(a.xy);<span class="keyword">this</span>.setModifiers(a);<span class="keyword">this</span>.request(b,&#123;<span class="attr">single</span>:<span class="keyword">this</span>.single&#125;)&#125;,<span class="attr">selectBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;<span class="keyword">if</span>(a <span class="keyword">instanceof</span> OpenLayers.Bounds)b=<span class="keyword">this</span>.map.getLonLatFromPixel(&#123;<span class="attr">x</span>:a.left,<span class="attr">y</span>:a.bottom&#125;),a=<span class="keyword">this</span>.map.getLonLatFromPixel(&#123;<span class="attr">x</span>:a.right,</span><br><span class="line">y:a.top&#125;),b=<span class="keyword">new</span> OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat);<span class="keyword">else</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.click)<span class="keyword">return</span>;b=<span class="keyword">this</span>.pixelToBounds(a)&#125;<span class="keyword">this</span>.setModifiers(<span class="keyword">this</span>.handlers.box.dragHandler.evt);<span class="keyword">this</span>.request(b)&#125;,<span class="attr">selectHover</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.pixelToBounds(a.xy);<span class="keyword">this</span>.request(a,&#123;<span class="attr">single</span>:!<span class="number">0</span>,<span class="attr">hover</span>:!<span class="number">0</span>&#125;)&#125;,<span class="attr">cancelHover</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.hoverResponse&amp;&amp;(<span class="keyword">this</span>.protocol.abort(<span class="keyword">this</span>.hoverResponse),<span class="keyword">this</span>.hoverResponse=<span class="literal">null</span>,OpenLayers.Element.removeClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olCursorWait"</span>))&#125;,<span class="attr">request</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=b||&#123;&#125;;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:<span class="keyword">this</span>.filterType,</span><br><span class="line">value:a&#125;);OpenLayers.Element.addClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olCursorWait"</span>);c=<span class="keyword">this</span>.protocol.read(&#123;<span class="attr">maxFeatures</span>:!<span class="number">0</span>==b.single?<span class="keyword">this</span>.maxFeatures:<span class="keyword">void</span> <span class="number">0</span>,<span class="attr">filter</span>:c,<span class="attr">callback</span>:<span class="function"><span class="keyword">function</span>(<span class="params">c</span>)</span>&#123;c.success()&amp;&amp;(c.features.length?!<span class="number">0</span>==b.single?<span class="keyword">this</span>.selectBestFeature(c.features,a.getCenterLonLat(),b):<span class="keyword">this</span>.select(c.features):b.hover?<span class="keyword">this</span>.hoverSelect():(<span class="keyword">this</span>.events.triggerEvent(<span class="string">"clickout"</span>),<span class="keyword">this</span>.clickout&amp;&amp;<span class="keyword">this</span>.unselectAll()));OpenLayers.Element.removeClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olCursorWait"</span>)&#125;,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);!<span class="number">0</span>==b.hover&amp;&amp;(<span class="keyword">this</span>.hoverResponse=</span><br><span class="line">c)&#125;,<span class="attr">selectBestFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;c=c||&#123;&#125;;<span class="keyword">if</span>(a.length)&#123;b=<span class="keyword">new</span> OpenLayers.Geometry.Point(b.lon,b.lat);<span class="keyword">for</span>(<span class="keyword">var</span> d,e,f,g=<span class="built_in">Number</span>.MAX_VALUE,h=<span class="number">0</span>;h&lt;a.length&amp;&amp;!(d=a[h],d.geometry&amp;&amp;(f=b.distanceTo(d.geometry,&#123;<span class="attr">edge</span>:!<span class="number">1</span>&#125;),f&lt;g&amp;&amp;(g=f,e=d,<span class="number">0</span>==g)));++h);!<span class="number">0</span>==c.hover?<span class="keyword">this</span>.hoverSelect(e):<span class="keyword">this</span>.select(e||a)&#125;&#125;,<span class="attr">setModifiers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.modifiers=&#123;<span class="attr">multiple</span>:<span class="keyword">this</span>.multiple||<span class="keyword">this</span>.multipleKey&amp;&amp;a[<span class="keyword">this</span>.multipleKey],<span class="attr">toggle</span>:<span class="keyword">this</span>.toggle||<span class="keyword">this</span>.toggleKey&amp;&amp;a[<span class="keyword">this</span>.toggleKey]&#125;&#125;,<span class="attr">select</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.modifiers.multiple||<span class="keyword">this</span>.modifiers.toggle||</span><br><span class="line"><span class="keyword">this</span>.unselectAll();OpenLayers.Util.isArray(a)||(a=[a]);<span class="keyword">var</span> b=<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforefeaturesselected"</span>,&#123;<span class="attr">features</span>:a&#125;);<span class="keyword">if</span>(!<span class="number">1</span>!==b)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=[],d,e=<span class="number">0</span>,f=a.length;e&lt;f;++e)d=a[e],<span class="keyword">this</span>.features[d.fid||d.id]?<span class="keyword">this</span>.modifiers.toggle&amp;&amp;<span class="keyword">this</span>.unselect(<span class="keyword">this</span>.features[d.fid||d.id]):(b=<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforefeatureselected"</span>,&#123;<span class="attr">feature</span>:d&#125;),!<span class="number">1</span>!==b&amp;&amp;(<span class="keyword">this</span>.features[d.fid||d.id]=d,c.push(d),<span class="keyword">this</span>.events.triggerEvent(<span class="string">"featureselected"</span>,&#123;<span class="attr">feature</span>:d&#125;)));<span class="keyword">this</span>.events.triggerEvent(<span class="string">"featuresselected"</span>,&#123;<span class="attr">features</span>:c&#125;)&#125;&#125;,</span><br><span class="line">hoverSelect:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a?a.fid||a.id:<span class="literal">null</span>,c=<span class="keyword">this</span>.hoverFeature?<span class="keyword">this</span>.hoverFeature.fid||<span class="keyword">this</span>.hoverFeature.id:<span class="literal">null</span>;c&amp;&amp;c!=b&amp;&amp;(<span class="keyword">this</span>.events.triggerEvent(<span class="string">"outfeature"</span>,&#123;<span class="attr">feature</span>:<span class="keyword">this</span>.hoverFeature&#125;),<span class="keyword">this</span>.hoverFeature=<span class="literal">null</span>);b&amp;&amp;b!=c&amp;&amp;(<span class="keyword">this</span>.events.triggerEvent(<span class="string">"hoverfeature"</span>,&#123;<span class="attr">feature</span>:a&#125;),<span class="keyword">this</span>.hoverFeature=a)&#125;,<span class="attr">unselect</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">delete</span> <span class="keyword">this</span>.features[a.fid||a.id];<span class="keyword">this</span>.events.triggerEvent(<span class="string">"featureunselected"</span>,&#123;<span class="attr">feature</span>:a&#125;)&#125;,<span class="attr">unselectAll</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a <span class="keyword">in</span> <span class="keyword">this</span>.features)<span class="keyword">this</span>.unselect(<span class="keyword">this</span>.features[a])&#125;,</span><br><span class="line">setMap:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b <span class="keyword">in</span> <span class="keyword">this</span>.handlers)<span class="keyword">this</span>.handlers[b].setMap(a);OpenLayers.Control.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">pixelToBounds</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.add(-<span class="keyword">this</span>.clickTolerance/<span class="number">2</span>,<span class="keyword">this</span>.clickTolerance/<span class="number">2</span>);a=a.add(<span class="keyword">this</span>.clickTolerance/<span class="number">2</span>,-<span class="keyword">this</span>.clickTolerance/<span class="number">2</span>);b=<span class="keyword">this</span>.map.getLonLatFromPixel(b);a=<span class="keyword">this</span>.map.getLonLatFromPixel(a);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.GetFeature"</span>&#125;);OpenLayers.Format.QueryStringFilter=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">a</span>)</span>&#123;a=a.replace(<span class="regexp">/%/g</span>,<span class="string">"\\%"</span>);a=a.replace(<span class="regexp">/\\\\\.(\*)?/g</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> b?a:<span class="string">"\\\\_"</span>&#125;);a=a.replace(<span class="regexp">/\\\\\.\*/g</span>,<span class="string">"\\\\%"</span>);a=a.replace(<span class="regexp">/(\\)?\.(\*)?/g</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">return</span> b||c?a:<span class="string">"_"</span>&#125;);a=a.replace(<span class="regexp">/(\\)?\.\*/g</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> b?a:<span class="string">"%"</span>&#125;);a=a.replace(<span class="regexp">/\\\./g</span>,<span class="string">"."</span>);<span class="keyword">return</span> a=a.replace(<span class="regexp">/(\\)?\\\*/g</span>,<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> b?a:<span class="string">"*"</span>&#125;)&#125;<span class="keyword">var</span> b=&#123;&#125;;b[OpenLayers.Filter.Comparison.EQUAL_TO]=<span class="string">"eq"</span>;b[OpenLayers.Filter.Comparison.NOT_EQUAL_TO]=<span class="string">"ne"</span>;b[OpenLayers.Filter.Comparison.LESS_THAN]=</span><br><span class="line"><span class="string">"lt"</span>;b[OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO]=<span class="string">"lte"</span>;b[OpenLayers.Filter.Comparison.GREATER_THAN]=<span class="string">"gt"</span>;b[OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO]=<span class="string">"gte"</span>;b[OpenLayers.Filter.Comparison.LIKE]=<span class="string">"ilike"</span>;<span class="keyword">return</span> OpenLayers.Class(OpenLayers.Format,&#123;<span class="attr">wildcarded</span>:!<span class="number">1</span>,<span class="attr">srsInBBOX</span>:!<span class="number">1</span>,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">c,d</span>)</span>&#123;d=d||&#123;&#125;;<span class="keyword">var</span> e=c.CLASS_NAME,e=e.substring(e.lastIndexOf(<span class="string">"."</span>)+<span class="number">1</span>);<span class="keyword">switch</span>(e)&#123;<span class="keyword">case</span> <span class="string">"Spatial"</span>:<span class="keyword">switch</span>(c.type)&#123;<span class="keyword">case</span> OpenLayers.Filter.Spatial.BBOX:d.bbox=c.value.toArray();<span class="keyword">this</span>.srsInBBOX&amp;&amp;c.projection&amp;&amp;</span><br><span class="line">d.bbox.push(c.projection.getCode());<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Filter.Spatial.DWITHIN:d.tolerance=c.distance;<span class="keyword">case</span> OpenLayers.Filter.Spatial.WITHIN:d.lon=c.value.x;d.lat=c.value.y;<span class="keyword">break</span>;<span class="keyword">default</span>:OpenLayers.Console.warn(<span class="string">"Unknown spatial filter type "</span>+c.type)&#125;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"Comparison"</span>:e=b[c.type];<span class="keyword">if</span>(<span class="keyword">void</span> <span class="number">0</span>!==e)&#123;<span class="keyword">var</span> f=c.value;c.type==OpenLayers.Filter.Comparison.LIKE&amp;&amp;(f=a(f),<span class="keyword">this</span>.wildcarded&amp;&amp;(f=<span class="string">"%"</span>+f+<span class="string">"%"</span>));d[c.property+<span class="string">"__"</span>+e]=f;d.queryable=d.queryable||[];d.queryable.push(c.property)&#125;<span class="keyword">else</span> OpenLayers.Console.warn(<span class="string">"Unknown comparison filter type "</span>+</span><br><span class="line">c.type);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"Logical"</span>:<span class="keyword">if</span>(c.type===OpenLayers.Filter.Logical.AND)<span class="keyword">for</span>(e=<span class="number">0</span>,f=c.filters.length;e&lt;f;e++)d=<span class="keyword">this</span>.write(c.filters[e],d);<span class="keyword">else</span> OpenLayers.Console.warn(<span class="string">"Unsupported logical filter type "</span>+c.type);<span class="keyword">break</span>;<span class="keyword">default</span>:OpenLayers.Console.warn(<span class="string">"Unknown filter type "</span>+e)&#125;<span class="keyword">return</span> d&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.QueryStringFilter"</span>&#125;)&#125;();OpenLayers.Control.MousePosition=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">autoActivate</span>:!<span class="number">0</span>,<span class="attr">element</span>:<span class="literal">null</span>,<span class="attr">prefix</span>:<span class="string">""</span>,<span class="attr">separator</span>:<span class="string">", "</span>,<span class="attr">suffix</span>:<span class="string">""</span>,<span class="attr">numDigits</span>:<span class="number">5</span>,<span class="attr">granularity</span>:<span class="number">10</span>,<span class="attr">emptyString</span>:<span class="literal">null</span>,<span class="attr">lastXy</span>:<span class="literal">null</span>,<span class="attr">displayProjection</span>:<span class="literal">null</span>,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.deactivate();OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Control.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)?(<span class="keyword">this</span>.map.events.register(<span class="string">"mousemove"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.redraw),<span class="keyword">this</span>.map.events.register(<span class="string">"mouseout"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.reset),</span><br><span class="line"><span class="keyword">this</span>.redraw(),!<span class="number">0</span>):!<span class="number">1</span>&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Control.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)?(<span class="keyword">this</span>.map.events.unregister(<span class="string">"mousemove"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.redraw),<span class="keyword">this</span>.map.events.unregister(<span class="string">"mouseout"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.reset),<span class="keyword">this</span>.element.innerHTML=<span class="string">""</span>,!<span class="number">0</span>):!<span class="number">1</span>&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Control.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.element||(<span class="keyword">this</span>.div.left=<span class="string">""</span>,<span class="keyword">this</span>.div.top=<span class="string">""</span>,<span class="keyword">this</span>.element=<span class="keyword">this</span>.div);<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">redraw</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;<span class="keyword">if</span>(<span class="literal">null</span>==a)<span class="keyword">this</span>.reset();<span class="keyword">else</span> <span class="keyword">if</span>(<span class="literal">null</span>==<span class="keyword">this</span>.lastXy||<span class="built_in">Math</span>.abs(a.xy.x-</span><br><span class="line"><span class="keyword">this</span>.lastXy.x)&gt;<span class="keyword">this</span>.granularity||<span class="built_in">Math</span>.abs(a.xy.y-<span class="keyword">this</span>.lastXy.y)&gt;<span class="keyword">this</span>.granularity)<span class="keyword">this</span>.lastXy=a.xy;<span class="keyword">else</span> <span class="keyword">if</span>(b=<span class="keyword">this</span>.map.getLonLatFromPixel(a.xy))<span class="keyword">this</span>.displayProjection&amp;&amp;b.transform(<span class="keyword">this</span>.map.getProjectionObject(),<span class="keyword">this</span>.displayProjection),<span class="keyword">this</span>.lastXy=a.xy,a=<span class="keyword">this</span>.formatOutput(b),a!=<span class="keyword">this</span>.element.innerHTML&amp;&amp;(<span class="keyword">this</span>.element.innerHTML=a)&#125;,<span class="attr">reset</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>!=<span class="keyword">this</span>.emptyString&amp;&amp;(<span class="keyword">this</span>.element.innerHTML=<span class="keyword">this</span>.emptyString)&#125;,<span class="attr">formatOutput</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.numDigits);<span class="keyword">return</span> <span class="keyword">this</span>.prefix+a.lon.toFixed(b)+</span><br><span class="line"><span class="keyword">this</span>.separator+a.lat.toFixed(b)+<span class="keyword">this</span>.suffix&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.MousePosition"</span>&#125;);OpenLayers.Control.Geolocate=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">geolocation</span>:<span class="literal">null</span>,<span class="attr">available</span>:<span class="string">"geolocation"</span><span class="keyword">in</span> navigator,<span class="attr">bind</span>:!<span class="number">0</span>,<span class="attr">watch</span>:!<span class="number">1</span>,<span class="attr">geolocationOptions</span>:<span class="literal">null</span>,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.deactivate();OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.available&amp;&amp;!<span class="keyword">this</span>.geolocation&amp;&amp;(<span class="keyword">this</span>.geolocation=navigator.geolocation);<span class="keyword">return</span> <span class="keyword">this</span>.geolocation?OpenLayers.Control.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)?(<span class="keyword">this</span>.watch?<span class="keyword">this</span>.watchId=<span class="keyword">this</span>.geolocation.watchPosition(OpenLayers.Function.bind(<span class="keyword">this</span>.geolocate,</span><br><span class="line"><span class="keyword">this</span>),OpenLayers.Function.bind(<span class="keyword">this</span>.failure,<span class="keyword">this</span>),<span class="keyword">this</span>.geolocationOptions):<span class="keyword">this</span>.getCurrentLocation(),!<span class="number">0</span>):!<span class="number">1</span>:(<span class="keyword">this</span>.events.triggerEvent(<span class="string">"locationuncapable"</span>),!<span class="number">1</span>)&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.active&amp;&amp;<span class="literal">null</span>!==<span class="keyword">this</span>.watchId&amp;&amp;<span class="keyword">this</span>.geolocation.clearWatch(<span class="keyword">this</span>.watchId);<span class="keyword">return</span> OpenLayers.Control.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">geolocate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=(<span class="keyword">new</span> OpenLayers.LonLat(a.coords.longitude,a.coords.latitude)).transform(<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>),<span class="keyword">this</span>.map.getProjectionObject());<span class="keyword">this</span>.bind&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.map.setCenter(b);<span class="keyword">this</span>.events.triggerEvent(<span class="string">"locationupdated"</span>,&#123;<span class="attr">position</span>:a,<span class="attr">point</span>:<span class="keyword">new</span> OpenLayers.Geometry.Point(b.lon,b.lat)&#125;)&#125;,<span class="attr">getCurrentLocation</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.active||<span class="keyword">this</span>.watch)<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">this</span>.geolocation.getCurrentPosition(OpenLayers.Function.bind(<span class="keyword">this</span>.geolocate,<span class="keyword">this</span>),OpenLayers.Function.bind(<span class="keyword">this</span>.failure,<span class="keyword">this</span>),<span class="keyword">this</span>.geolocationOptions);<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="attr">failure</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"locationfailed"</span>,&#123;<span class="attr">error</span>:a&#125;)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.Geolocate"</span>&#125;);OpenLayers.Tile.UTFGrid=OpenLayers.Class(OpenLayers.Tile,&#123;<span class="attr">url</span>:<span class="literal">null</span>,<span class="attr">utfgridResolution</span>:<span class="number">2</span>,<span class="attr">json</span>:<span class="literal">null</span>,<span class="attr">format</span>:<span class="literal">null</span>,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.clear();OpenLayers.Tile.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Tile.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">if</span>(a)<span class="keyword">if</span>(<span class="keyword">this</span>.isLoading?(<span class="keyword">this</span>.abortLoading(),<span class="keyword">this</span>.events.triggerEvent(<span class="string">"reload"</span>)):(<span class="keyword">this</span>.isLoading=!<span class="number">0</span>,<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loadstart"</span>)),<span class="keyword">this</span>.url=<span class="keyword">this</span>.layer.getURL(<span class="keyword">this</span>.bounds),<span class="keyword">this</span>.layer.useJSONP)&#123;<span class="keyword">var</span> b=<span class="keyword">new</span> OpenLayers.Protocol.Script(&#123;<span class="attr">url</span>:<span class="keyword">this</span>.url,</span><br><span class="line">callback:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.isLoading=!<span class="number">1</span>;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loadend"</span>);<span class="keyword">this</span>.json=a.data&#125;,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);b.read();<span class="keyword">this</span>.request=b&#125;<span class="keyword">else</span> <span class="keyword">this</span>.request=OpenLayers.Request.GET(&#123;<span class="attr">url</span>:<span class="keyword">this</span>.url,<span class="attr">callback</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.isLoading=!<span class="number">1</span>;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"loadend"</span>);<span class="number">200</span>===a.status&amp;&amp;<span class="keyword">this</span>.parseData(a.responseText)&#125;,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">else</span> <span class="keyword">this</span>.unload();<span class="keyword">return</span> a&#125;,<span class="attr">abortLoading</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.request&amp;&amp;(<span class="keyword">this</span>.request.abort(),<span class="keyword">delete</span> <span class="keyword">this</span>.request);<span class="keyword">this</span>.isLoading=!<span class="number">1</span>&#125;,<span class="attr">getFeatureInfo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.json)&#123;<span class="keyword">var</span> d=</span><br><span class="line"><span class="keyword">this</span>.getFeatureId(a,b);<span class="literal">null</span>!==d&amp;&amp;(c=&#123;<span class="attr">id</span>:d,<span class="attr">data</span>:<span class="keyword">this</span>.json.data[d]&#125;)&#125;<span class="keyword">return</span> c&#125;,<span class="attr">getFeatureId</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.json)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.utfgridResolution,d=<span class="keyword">this</span>.json.grid[<span class="built_in">Math</span>.floor(b/d)].charCodeAt(<span class="built_in">Math</span>.floor(a/d)),d=<span class="keyword">this</span>.indexFromCharCode(d),e=<span class="keyword">this</span>.json.keys;!<span class="built_in">isNaN</span>(d)&amp;&amp;d <span class="keyword">in</span> e&amp;&amp;(c=e[d])&#125;<span class="keyword">return</span> c&#125;,<span class="attr">indexFromCharCode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="number">93</span>&lt;=a&amp;&amp;a--;<span class="number">35</span>&lt;=a&amp;&amp;a--;<span class="keyword">return</span> a<span class="number">-32</span>&#125;,<span class="attr">parseData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.format||(<span class="keyword">this</span>.format=<span class="keyword">new</span> OpenLayers.Format.JSON);<span class="keyword">this</span>.json=<span class="keyword">this</span>.format.read(a)&#125;,<span class="attr">clear</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.json=</span><br><span class="line"><span class="literal">null</span>&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Tile.UTFGrid"</span>&#125;);OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,&#123;<span class="attr">url</span>:<span class="literal">null</span>,<span class="attr">headers</span>:<span class="literal">null</span>,<span class="attr">params</span>:<span class="literal">null</span>,<span class="attr">callback</span>:<span class="literal">null</span>,<span class="attr">scope</span>:<span class="literal">null</span>,<span class="attr">readWithPOST</span>:!<span class="number">1</span>,<span class="attr">updateWithPOST</span>:!<span class="number">1</span>,<span class="attr">deleteWithPOST</span>:!<span class="number">1</span>,<span class="attr">wildcarded</span>:!<span class="number">1</span>,<span class="attr">srsInBBOX</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||&#123;&#125;;<span class="keyword">this</span>.params=&#123;&#125;;<span class="keyword">this</span>.headers=&#123;&#125;;OpenLayers.Protocol.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">if</span>(!<span class="keyword">this</span>.filterToParams&amp;&amp;OpenLayers.Format.QueryStringFilter)&#123;<span class="keyword">var</span> b=<span class="keyword">new</span> OpenLayers.Format.QueryStringFilter(&#123;<span class="attr">wildcarded</span>:<span class="keyword">this</span>.wildcarded,<span class="attr">srsInBBOX</span>:<span class="keyword">this</span>.srsInBBOX&#125;);<span class="keyword">this</span>.filterToParams=</span><br><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params">a,d</span>)</span>&#123;<span class="keyword">return</span> b.write(a,d)&#125;&#125;&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.headers=<span class="keyword">this</span>.params=<span class="literal">null</span>;OpenLayers.Protocol.prototype.destroy.apply(<span class="keyword">this</span>)&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Protocol.prototype.read.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);a=a||&#123;&#125;;a.params=OpenLayers.Util.applyDefaults(a.params,<span class="keyword">this</span>.options.params);a=OpenLayers.Util.applyDefaults(a,<span class="keyword">this</span>.options);a.filter&amp;&amp;<span class="keyword">this</span>.filterToParams&amp;&amp;(a.params=<span class="keyword">this</span>.filterToParams(a.filter,a.params));<span class="keyword">var</span> b=<span class="keyword">void</span> <span class="number">0</span>!==a.readWithPOST?a.readWithPOST:<span class="keyword">this</span>.readWithPOST,c=<span class="keyword">new</span> OpenLayers.Protocol.Response(&#123;<span class="attr">requestType</span>:<span class="string">"read"</span>&#125;);</span><br><span class="line">b?(b=a.headers||&#123;&#125;,b[<span class="string">"Content-Type"</span>]=<span class="string">"application/x-www-form-urlencoded"</span>,c.priv=OpenLayers.Request.POST(&#123;<span class="attr">url</span>:a.url,<span class="attr">callback</span>:<span class="keyword">this</span>.createCallback(<span class="keyword">this</span>.handleRead,c,a),<span class="attr">data</span>:OpenLayers.Util.getParameterString(a.params),<span class="attr">headers</span>:b&#125;)):c.priv=OpenLayers.Request.GET(&#123;<span class="attr">url</span>:a.url,<span class="attr">callback</span>:<span class="keyword">this</span>.createCallback(<span class="keyword">this</span>.handleRead,c,a),<span class="attr">params</span>:a.params,<span class="attr">headers</span>:a.headers&#125;);<span class="keyword">return</span> c&#125;,<span class="attr">handleRead</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.handleResponse(a,b)&#125;,<span class="attr">create</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=OpenLayers.Util.applyDefaults(b,<span class="keyword">this</span>.options);<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Protocol.Response(&#123;<span class="attr">reqFeatures</span>:a,</span><br><span class="line">requestType:<span class="string">"create"</span>&#125;);c.priv=OpenLayers.Request.POST(&#123;<span class="attr">url</span>:b.url,<span class="attr">callback</span>:<span class="keyword">this</span>.createCallback(<span class="keyword">this</span>.handleCreate,c,b),<span class="attr">headers</span>:b.headers,<span class="attr">data</span>:<span class="keyword">this</span>.format.write(a)&#125;);<span class="keyword">return</span> c&#125;,<span class="attr">handleCreate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.handleResponse(a,b)&#125;,<span class="attr">update</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=b||&#123;&#125;;<span class="keyword">var</span> c=b.url||a.url||<span class="keyword">this</span>.options.url+<span class="string">"/"</span>+a.fid;b=OpenLayers.Util.applyDefaults(b,<span class="keyword">this</span>.options);<span class="keyword">var</span> d=<span class="keyword">new</span> OpenLayers.Protocol.Response(&#123;<span class="attr">reqFeatures</span>:a,<span class="attr">requestType</span>:<span class="string">"update"</span>&#125;);d.priv=OpenLayers.Request[<span class="keyword">this</span>.updateWithPOST?<span class="string">"POST"</span>:<span class="string">"PUT"</span>](&#123;<span class="attr">url</span>:c,<span class="attr">callback</span>:<span class="keyword">this</span>.createCallback(<span class="keyword">this</span>.handleUpdate,</span><br><span class="line">d,b),<span class="attr">headers</span>:b.headers,<span class="attr">data</span>:<span class="keyword">this</span>.format.write(a)&#125;);<span class="keyword">return</span> d&#125;,<span class="attr">handleUpdate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.handleResponse(a,b)&#125;,<span class="string">"delete"</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=b||&#123;&#125;;<span class="keyword">var</span> c=b.url||a.url||<span class="keyword">this</span>.options.url+<span class="string">"/"</span>+a.fid;b=OpenLayers.Util.applyDefaults(b,<span class="keyword">this</span>.options);<span class="keyword">var</span> d=<span class="keyword">new</span> OpenLayers.Protocol.Response(&#123;<span class="attr">reqFeatures</span>:a,<span class="attr">requestType</span>:<span class="string">"delete"</span>&#125;),e=<span class="keyword">this</span>.deleteWithPOST?<span class="string">"POST"</span>:<span class="string">"DELETE"</span>,c=&#123;<span class="attr">url</span>:c,<span class="attr">callback</span>:<span class="keyword">this</span>.createCallback(<span class="keyword">this</span>.handleDelete,d,b),<span class="attr">headers</span>:b.headers&#125;;<span class="keyword">this</span>.deleteWithPOST&amp;&amp;(c.data=<span class="keyword">this</span>.format.write(a));d.priv=OpenLayers.Request[e](c);</span><br><span class="line"><span class="keyword">return</span> d&#125;,<span class="attr">handleDelete</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.handleResponse(a,b)&#125;,<span class="attr">handleResponse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.priv;b.callback&amp;&amp;(<span class="number">200</span>&lt;=c.status&amp;&amp;<span class="number">300</span>&gt;c.status?(<span class="string">"delete"</span>!=a.requestType&amp;&amp;(a.features=<span class="keyword">this</span>.parseFeatures(c)),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE,b.callback.call(b.scope,a))&#125;,<span class="attr">parseFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.responseXML;b&amp;&amp;b.documentElement||(b=a.responseText);<span class="keyword">return</span>!b||<span class="number">0</span>&gt;=b.length?<span class="literal">null</span>:<span class="keyword">this</span>.format.read(b)&#125;,<span class="attr">commit</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=</span><br><span class="line">a.features?a.features.length:<span class="number">0</span>,c=<span class="built_in">Array</span>(b),e=<span class="number">0</span>;e&lt;b;++e)c[e]=a.features[e].fid;r.insertIds=c;d.apply(<span class="keyword">this</span>,[a])&#125;<span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.callUserCallback(a,b);q=q&amp;&amp;a.success();f++;f&gt;=p&amp;&amp;b.callback&amp;&amp;(r.code=q?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE,b.callback.apply(b.scope,[r]))&#125;b=OpenLayers.Util.applyDefaults(b,<span class="keyword">this</span>.options);<span class="keyword">var</span> e=[],f=<span class="number">0</span>,g=&#123;&#125;;g[OpenLayers.State.INSERT]=[];g[OpenLayers.State.UPDATE]=[];g[OpenLayers.State.DELETE]=[];<span class="keyword">for</span>(<span class="keyword">var</span> h,k,l=[],m=<span class="number">0</span>,n=a.length;m&lt;n;++m)<span class="keyword">if</span>(h=</span><br><span class="line">a[m],k=g[h.state])k.push(h),l.push(h);<span class="keyword">var</span> p=(<span class="number">0</span>&lt;g[OpenLayers.State.INSERT].length?<span class="number">1</span>:<span class="number">0</span>)+g[OpenLayers.State.UPDATE].length+g[OpenLayers.State.DELETE].length,q=!<span class="number">0</span>,r=<span class="keyword">new</span> OpenLayers.Protocol.Response(&#123;<span class="attr">reqFeatures</span>:l&#125;);h=g[OpenLayers.State.INSERT];<span class="number">0</span>&lt;h.length&amp;&amp;e.push(<span class="keyword">this</span>.create(h,OpenLayers.Util.applyDefaults(&#123;<span class="attr">callback</span>:c,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;,b.create)));h=g[OpenLayers.State.UPDATE];<span class="keyword">for</span>(m=h.length<span class="number">-1</span>;<span class="number">0</span>&lt;=m;--m)e.push(<span class="keyword">this</span>.update(h[m],OpenLayers.Util.applyDefaults(&#123;<span class="attr">callback</span>:d,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;,b.update)));h=g[OpenLayers.State.DELETE];</span><br><span class="line"><span class="keyword">for</span>(m=h.length<span class="number">-1</span>;<span class="number">0</span>&lt;=m;--m)e.push(<span class="keyword">this</span>[<span class="string">"delete"</span>](h[m],OpenLayers.Util.applyDefaults(&#123;<span class="attr">callback</span>:d,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;,b[<span class="string">"delete"</span>])));<span class="keyword">return</span> e&#125;,<span class="attr">abort</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a&amp;&amp;a.priv.abort()&#125;,<span class="attr">callUserCallback</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=b[a.requestType];c&amp;&amp;c.callback&amp;&amp;c.callback.call(c.scope,a)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Protocol.HTTP"</span>&#125;);OpenLayers.Strategy.Cluster=OpenLayers.Class(OpenLayers.Strategy,&#123;<span class="attr">distance</span>:<span class="number">20</span>,<span class="attr">threshold</span>:<span class="literal">null</span>,<span class="attr">features</span>:<span class="literal">null</span>,<span class="attr">clusters</span>:<span class="literal">null</span>,<span class="attr">clustering</span>:!<span class="number">1</span>,<span class="attr">resolution</span>:<span class="literal">null</span>,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Strategy.prototype.activate.call(<span class="keyword">this</span>);<span class="keyword">if</span>(a)<span class="keyword">this</span>.layer.events.on(&#123;<span class="attr">beforefeaturesadded</span>:<span class="keyword">this</span>.cacheFeatures,<span class="attr">featuresremoved</span>:<span class="keyword">this</span>.clearCache,<span class="attr">moveend</span>:<span class="keyword">this</span>.cluster,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Strategy.prototype.deactivate.call(<span class="keyword">this</span>);a&amp;&amp;(<span class="keyword">this</span>.clearCache(),<span class="keyword">this</span>.layer.events.un(&#123;<span class="attr">beforefeaturesadded</span>:<span class="keyword">this</span>.cacheFeatures,</span><br><span class="line">featuresremoved:<span class="keyword">this</span>.clearCache,<span class="attr">moveend</span>:<span class="keyword">this</span>.cluster,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;));<span class="keyword">return</span> a&#125;,<span class="attr">cacheFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">0</span>;<span class="keyword">this</span>.clustering||(<span class="keyword">this</span>.clearCache(),<span class="keyword">this</span>.features=a.features,<span class="keyword">this</span>.cluster(),b=!<span class="number">1</span>);<span class="keyword">return</span> b&#125;,<span class="attr">clearCache</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.clustering||(<span class="keyword">this</span>.features=<span class="literal">null</span>)&#125;,<span class="attr">cluster</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>((!a||a.zoomChanged)&amp;&amp;<span class="keyword">this</span>.features&amp;&amp;(a=<span class="keyword">this</span>.layer.map.getResolution(),a!=<span class="keyword">this</span>.resolution||!<span class="keyword">this</span>.clustersExist()))&#123;<span class="keyword">this</span>.resolution=a;a=[];<span class="keyword">for</span>(<span class="keyword">var</span> b,c,d,e=<span class="number">0</span>;e&lt;<span class="keyword">this</span>.features.length;++e)<span class="keyword">if</span>(b=<span class="keyword">this</span>.features[e],b.geometry)&#123;c=</span><br><span class="line">!<span class="number">1</span>;<span class="keyword">for</span>(<span class="keyword">var</span> f=a.length<span class="number">-1</span>;<span class="number">0</span>&lt;=f;--f)<span class="keyword">if</span>(d=a[f],<span class="keyword">this</span>.shouldCluster(d,b))&#123;<span class="keyword">this</span>.addToCluster(d,b);c=!<span class="number">0</span>;<span class="keyword">break</span>&#125;c||a.push(<span class="keyword">this</span>.createCluster(<span class="keyword">this</span>.features[e]))&#125;<span class="keyword">this</span>.clustering=!<span class="number">0</span>;<span class="keyword">this</span>.layer.removeAllFeatures();<span class="keyword">this</span>.clustering=!<span class="number">1</span>;<span class="keyword">if</span>(<span class="number">0</span>&lt;a.length)&#123;<span class="keyword">if</span>(<span class="number">1</span>&lt;<span class="keyword">this</span>.threshold)<span class="keyword">for</span>(b=a.slice(),a=[],e=<span class="number">0</span>,d=b.length;e&lt;d;++e)c=b[e],c.attributes.count&lt;<span class="keyword">this</span>.threshold?<span class="built_in">Array</span>.prototype.push.apply(a,c.cluster):a.push(c);<span class="keyword">this</span>.clustering=!<span class="number">0</span>;<span class="keyword">this</span>.layer.addFeatures(a);<span class="keyword">this</span>.clustering=!<span class="number">1</span>&#125;<span class="keyword">this</span>.clusters=a&#125;&#125;,<span class="attr">clustersExist</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=</span><br><span class="line">!<span class="number">1</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.clusters&amp;&amp;<span class="number">0</span>&lt;<span class="keyword">this</span>.clusters.length&amp;&amp;<span class="keyword">this</span>.clusters.length==<span class="keyword">this</span>.layer.features.length)<span class="keyword">for</span>(<span class="keyword">var</span> a=!<span class="number">0</span>,b=<span class="number">0</span>;b&lt;<span class="keyword">this</span>.clusters.length;++b)<span class="keyword">if</span>(<span class="keyword">this</span>.clusters[b]!=<span class="keyword">this</span>.layer.features[b])&#123;a=!<span class="number">1</span>;<span class="keyword">break</span>&#125;<span class="keyword">return</span> a&#125;,<span class="attr">shouldCluster</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.geometry.getBounds().getCenterLonLat(),d=b.geometry.getBounds().getCenterLonLat();<span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(c.lon-d.lon,<span class="number">2</span>)+<span class="built_in">Math</span>.pow(c.lat-d.lat,<span class="number">2</span>))/<span class="keyword">this</span>.resolution&lt;=<span class="keyword">this</span>.distance&#125;,<span class="attr">addToCluster</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.cluster.push(b);a.attributes.count+=<span class="number">1</span>&#125;,<span class="attr">createCluster</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line">a.geometry.getBounds().getCenterLonLat(),b=<span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="keyword">new</span> OpenLayers.Geometry.Point(b.lon,b.lat),&#123;<span class="attr">count</span>:<span class="number">1</span>&#125;);b.cluster=[a];<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Strategy.Cluster"</span>&#125;);OpenLayers.Strategy.Filter=OpenLayers.Class(OpenLayers.Strategy,&#123;<span class="attr">filter</span>:<span class="literal">null</span>,<span class="attr">cache</span>:<span class="literal">null</span>,<span class="attr">caching</span>:!<span class="number">1</span>,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Strategy.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);a&amp;&amp;(<span class="keyword">this</span>.cache=[],<span class="keyword">this</span>.layer.events.on(&#123;<span class="attr">beforefeaturesadded</span>:<span class="keyword">this</span>.handleAdd,<span class="attr">beforefeaturesremoved</span>:<span class="keyword">this</span>.handleRemove,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;));<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.cache=<span class="literal">null</span>;<span class="keyword">this</span>.layer&amp;&amp;<span class="keyword">this</span>.layer.events&amp;&amp;<span class="keyword">this</span>.layer.events.un(&#123;<span class="attr">beforefeaturesadded</span>:<span class="keyword">this</span>.handleAdd,<span class="attr">beforefeaturesremoved</span>:<span class="keyword">this</span>.handleRemove,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);</span><br><span class="line"><span class="keyword">return</span> OpenLayers.Strategy.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">handleAdd</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.caching&amp;&amp;<span class="keyword">this</span>.filter)&#123;<span class="keyword">var</span> b=a.features;a.features=[];<span class="keyword">for</span>(<span class="keyword">var</span> c,d=<span class="number">0</span>,e=b.length;d&lt;e;++d)c=b[d],<span class="keyword">this</span>.filter.evaluate(c)?a.features.push(c):<span class="keyword">this</span>.cache.push(c)&#125;&#125;,<span class="attr">handleRemove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.caching||(<span class="keyword">this</span>.cache=[])&#125;,<span class="attr">setFilter</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.filter=a;a=<span class="keyword">this</span>.cache;<span class="keyword">this</span>.cache=[];<span class="keyword">this</span>.handleAdd(&#123;<span class="attr">features</span>:<span class="keyword">this</span>.layer.features&#125;);<span class="number">0</span>&lt;<span class="keyword">this</span>.cache.length&amp;&amp;(<span class="keyword">this</span>.caching=!<span class="number">0</span>,<span class="keyword">this</span>.layer.removeFeatures(<span class="keyword">this</span>.cache.slice()),</span><br><span class="line"><span class="keyword">this</span>.caching=!<span class="number">1</span>);<span class="number">0</span>&lt;a.length&amp;&amp;(a=&#123;<span class="attr">features</span>:a&#125;,<span class="keyword">this</span>.handleAdd(a),<span class="number">0</span>&lt;a.features.length&amp;&amp;(<span class="keyword">this</span>.caching=!<span class="number">0</span>,<span class="keyword">this</span>.layer.addFeatures(a.features),<span class="keyword">this</span>.caching=!<span class="number">1</span>))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Strategy.Filter"</span>&#125;);OpenLayers.Protocol.SOS=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.SOS.DEFAULTS);<span class="keyword">var</span> b=OpenLayers.Protocol.SOS[<span class="string">"v"</span>+a.version.replace(<span class="regexp">/\./g</span>,<span class="string">"_"</span>)];<span class="keyword">if</span>(!b)<span class="keyword">throw</span><span class="string">"Unsupported SOS version: "</span>+a.version;<span class="keyword">return</span> <span class="keyword">new</span> b(a)&#125;;OpenLayers.Protocol.SOS.DEFAULTS=&#123;<span class="attr">version</span>:<span class="string">"1.0.0"</span>&#125;;OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>&#125;,<span class="attr">namespaces</span>:&#123;<span class="attr">xsd</span>:<span class="string">"http://www.w3.org/2001/XMLSchema"</span>&#125;,<span class="attr">readers</span>:&#123;<span class="attr">xsd</span>:&#123;<span class="attr">schema</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=[],d=&#123;&#125;,e,f;<span class="keyword">this</span>.readChildNodes(a,&#123;<span class="attr">complexTypes</span>:c,<span class="attr">customTypes</span>:d&#125;);<span class="keyword">var</span> g=a.attributes,h,k;e=<span class="number">0</span>;<span class="keyword">for</span>(f=g.length;e&lt;f;++e)h=g[e],k=h.name,<span class="number">0</span>===k.indexOf(<span class="string">"xmlns"</span>)?<span class="keyword">this</span>.setNamespace(k.split(<span class="string">":"</span>)[<span class="number">1</span>]||<span class="string">""</span>,h.value):b[k]=h.value;b.featureTypes=c;b.targetPrefix=<span class="keyword">this</span>.namespaceAlias[b.targetNamespace];e=<span class="number">0</span>;<span class="keyword">for</span>(f=</span><br><span class="line">c.length;e&lt;f;++e)g=c[e],h=d[g.typeName],d[g.typeName]&amp;&amp;(g.typeName=h.name)&#125;,<span class="attr">complexType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">typeName</span>:a.getAttribute(<span class="string">"name"</span>)&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.complexTypes.push(c)&#125;,<span class="attr">complexContent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">extension</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">sequence</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">elements</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.properties=c.elements&#125;,<span class="attr">element</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c;<span class="keyword">if</span>(b.elements)&#123;<span class="keyword">var</span> d=&#123;&#125;;c=a.attributes;<span class="keyword">for</span>(<span class="keyword">var</span> e,f=<span class="number">0</span>,g=c.length;f&lt;g;++f)e=c[f],d[e.name]=</span><br><span class="line">e.value;c=d.type;c||(c=&#123;&#125;,<span class="keyword">this</span>.readChildNodes(a,c),d.restriction=c,d.type=c.base);d.localType=(c.base||c).split(<span class="string">":"</span>).pop();b.elements.push(d);<span class="keyword">this</span>.readChildNodes(a,d)&#125;b.complexTypes&amp;&amp;(c=a.getAttribute(<span class="string">"type"</span>),d=c.split(<span class="string">":"</span>).pop(),b.customTypes[d]=&#123;<span class="attr">name</span>:a.getAttribute(<span class="string">"name"</span>),<span class="attr">type</span>:c&#125;)&#125;,<span class="attr">annotation</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.annotation=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.annotation)&#125;,<span class="attr">appinfo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.appinfo||(b.appinfo=[]);b.appinfo.push(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">documentation</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.documentation||(b.documentation=</span><br><span class="line">[]);<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);b.documentation.push(&#123;<span class="attr">lang</span>:a.getAttribute(<span class="string">"xml:lang"</span>),<span class="attr">textContent</span>:c.replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>)&#125;)&#125;,<span class="attr">simpleType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">restriction</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.base=a.getAttribute(<span class="string">"base"</span>);<span class="keyword">this</span>.readRestriction(a,b)&#125;&#125;&#125;,<span class="attr">readRestriction</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=a.childNodes,d,e,f=<span class="number">0</span>,g=c.length;f&lt;g;++f)d=c[f],<span class="number">1</span>==d.nodeType&amp;&amp;(e=d.nodeName.split(<span class="string">":"</span>).pop(),d=d.getAttribute(<span class="string">"value"</span>),b[e]?(<span class="string">"string"</span>==<span class="keyword">typeof</span> b[e]&amp;&amp;(b[e]=[b[e]]),b[e].push(d)):b[e]=d)&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==</span><br><span class="line"><span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> b=&#123;&#125;;<span class="keyword">if</span>(<span class="string">"ExceptionReport"</span>===a.nodeName.split(<span class="string">":"</span>).pop())&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Format.OGCExceptionReport;b.error=c.read(a)&#125;<span class="keyword">else</span> <span class="keyword">this</span>.readNode(a,b);<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WFSDescribeFeatureType"</span>&#125;);OpenLayers.Format.GeoRSS=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">rssns</span>:<span class="string">"http://backend.userland.com/rss2"</span>,<span class="attr">featureNS</span>:<span class="string">"http://mapserver.gis.umn.edu/mapserver"</span>,<span class="attr">georssns</span>:<span class="string">"http://www.georss.org/georss"</span>,<span class="attr">geons</span>:<span class="string">"http://www.w3.org/2003/01/geo/wgs84_pos#"</span>,<span class="attr">featureTitle</span>:<span class="string">"Untitled"</span>,<span class="attr">featureDescription</span>:<span class="string">"No Description"</span>,<span class="attr">gmlParser</span>:<span class="literal">null</span>,<span class="attr">xy</span>:!<span class="number">1</span>,<span class="attr">createGeometryFromItem</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.georssns,<span class="string">"point"</span>),c=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.geons,<span class="string">"lat"</span>),d=<span class="keyword">this</span>.getElementsByTagNameNS(a,</span><br><span class="line"><span class="keyword">this</span>.geons,<span class="string">"long"</span>),e=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.georssns,<span class="string">"line"</span>),f=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.georssns,<span class="string">"polygon"</span>),g=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.georssns,<span class="string">"where"</span>);a=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.georssns,<span class="string">"box"</span>);<span class="keyword">if</span>(<span class="number">0</span>&lt;b.length||<span class="number">0</span>&lt;c.length&amp;&amp;<span class="number">0</span>&lt;d.length)&#123;<span class="number">0</span>&lt;b.length?(c=OpenLayers.String.trim(b[<span class="number">0</span>].firstChild.nodeValue).split(<span class="regexp">/\s+/</span>),<span class="number">2</span>!=c.length&amp;&amp;(c=OpenLayers.String.trim(b[<span class="number">0</span>].firstChild.nodeValue).split(<span class="regexp">/\s*,\s*/</span>))):c=[<span class="built_in">parseFloat</span>(c[<span class="number">0</span>].firstChild.nodeValue),<span class="built_in">parseFloat</span>(d[<span class="number">0</span>].firstChild.nodeValue)];</span><br><span class="line"><span class="keyword">var</span> h=<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">1</span>],c[<span class="number">0</span>])&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="number">0</span>&lt;e.length)&#123;c=OpenLayers.String.trim(<span class="keyword">this</span>.getChildValue(e[<span class="number">0</span>])).split(<span class="regexp">/\s+/</span>);d=[];e=<span class="number">0</span>;<span class="keyword">for</span>(f=c.length;e&lt;f;e+=<span class="number">2</span>)b=<span class="keyword">new</span> OpenLayers.Geometry.Point(c[e+<span class="number">1</span>],c[e]),d.push(b);h=<span class="keyword">new</span> OpenLayers.Geometry.LineString(d)&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="number">0</span>&lt;f.length)&#123;c=OpenLayers.String.trim(<span class="keyword">this</span>.getChildValue(f[<span class="number">0</span>])).split(<span class="regexp">/\s+/</span>);d=[];e=<span class="number">0</span>;<span class="keyword">for</span>(f=c.length;e&lt;f;e+=<span class="number">2</span>)b=<span class="keyword">new</span> OpenLayers.Geometry.Point(c[e+<span class="number">1</span>],c[e]),d.push(b);h=<span class="keyword">new</span> OpenLayers.Geometry.Polygon([<span class="keyword">new</span> OpenLayers.Geometry.LinearRing(d)])&#125;<span class="keyword">else</span> <span class="number">0</span>&lt;</span><br><span class="line">g.length?(<span class="keyword">this</span>.gmlParser||(<span class="keyword">this</span>.gmlParser=<span class="keyword">new</span> OpenLayers.Format.GML(&#123;<span class="attr">xy</span>:<span class="keyword">this</span>.xy&#125;)),h=<span class="keyword">this</span>.gmlParser.parseFeature(g[<span class="number">0</span>]).geometry):<span class="number">0</span>&lt;a.length&amp;&amp;(c=OpenLayers.String.trim(a[<span class="number">0</span>].firstChild.nodeValue).split(<span class="regexp">/\s+/</span>),d=[],<span class="number">3</span>&lt;c.length&amp;&amp;(b=<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">1</span>],c[<span class="number">0</span>]),d.push(b),b=<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">1</span>],c[<span class="number">2</span>]),d.push(b),b=<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">3</span>],c[<span class="number">2</span>]),d.push(b),b=<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">3</span>],c[<span class="number">0</span>]),d.push(b),b=<span class="keyword">new</span> OpenLayers.Geometry.Point(c[<span class="number">1</span>],c[<span class="number">0</span>]),d.push(b)),h=<span class="keyword">new</span> OpenLayers.Geometry.Polygon([<span class="keyword">new</span> OpenLayers.Geometry.LinearRing(d)]));</span><br><span class="line">h&amp;&amp;(<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection)&amp;&amp;h.transform(<span class="keyword">this</span>.externalProjection,<span class="keyword">this</span>.internalProjection);<span class="keyword">return</span> h&#125;,<span class="attr">createFeatureFromItem</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createGeometryFromItem(a),c=<span class="keyword">this</span>._getChildValue(a,<span class="string">"*"</span>,<span class="string">"title"</span>,<span class="keyword">this</span>.featureTitle),d=<span class="keyword">this</span>._getChildValue(a,<span class="string">"*"</span>,<span class="string">"description"</span>,<span class="keyword">this</span>._getChildValue(a,<span class="string">"*"</span>,<span class="string">"content"</span>,<span class="keyword">this</span>._getChildValue(a,<span class="string">"*"</span>,<span class="string">"summary"</span>,<span class="keyword">this</span>.featureDescription))),e=<span class="keyword">this</span>._getChildValue(a,<span class="string">"*"</span>,<span class="string">"link"</span>);<span class="keyword">if</span>(!e)<span class="keyword">try</span>&#123;e=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="string">"*"</span>,<span class="string">"link"</span>)[<span class="number">0</span>].getAttribute(<span class="string">"href"</span>)&#125;<span class="keyword">catch</span>(f)&#123;e=</span><br><span class="line"><span class="literal">null</span>&#125;a=<span class="keyword">this</span>._getChildValue(a,<span class="string">"*"</span>,<span class="string">"id"</span>,<span class="literal">null</span>);b=<span class="keyword">new</span> OpenLayers.Feature.Vector(b,&#123;<span class="attr">title</span>:c,<span class="attr">description</span>:d,<span class="attr">link</span>:e&#125;);b.fid=a;<span class="keyword">return</span> b&#125;,<span class="attr">_getChildValue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">return</span>(a=<span class="keyword">this</span>.getElementsByTagNameNS(a,b,c))&amp;&amp;a[<span class="number">0</span>]&amp;&amp;a[<span class="number">0</span>].firstChild&amp;&amp;a[<span class="number">0</span>].firstChild.nodeValue?<span class="keyword">this</span>.getChildValue(a[<span class="number">0</span>]):<span class="keyword">void</span> <span class="number">0</span>==d?<span class="string">""</span>:d&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));<span class="keyword">var</span> b=<span class="literal">null</span>,b=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="string">"*"</span>,<span class="string">"item"</span>);<span class="number">0</span>==b.length&amp;&amp;(b=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="string">"*"</span>,<span class="string">"entry"</span>));</span><br><span class="line">a=b.length;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="built_in">Array</span>(a),d=<span class="number">0</span>;d&lt;a;d++)c[d]=<span class="keyword">this</span>.createFeatureFromItem(b[d]);<span class="keyword">return</span> c&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;<span class="keyword">if</span>(OpenLayers.Util.isArray(a))&#123;b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.rssns,<span class="string">"rss"</span>);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;c++)b.appendChild(<span class="keyword">this</span>.createFeatureXML(a[c]))&#125;<span class="keyword">else</span> b=<span class="keyword">this</span>.createFeatureXML(a);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[b])&#125;,<span class="attr">createFeatureXML</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.buildGeometryNode(a.geometry),c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.rssns,<span class="string">"item"</span>),d=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.rssns,<span class="string">"title"</span>);</span><br><span class="line">d.appendChild(<span class="keyword">this</span>.createTextNode(a.attributes.title?a.attributes.title:<span class="string">""</span>));<span class="keyword">var</span> e=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.rssns,<span class="string">"description"</span>);e.appendChild(<span class="keyword">this</span>.createTextNode(a.attributes.description?a.attributes.description:<span class="string">""</span>));c.appendChild(d);c.appendChild(e);a.attributes.link&amp;&amp;(d=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.rssns,<span class="string">"link"</span>),d.appendChild(<span class="keyword">this</span>.createTextNode(a.attributes.link)),c.appendChild(d));<span class="keyword">for</span>(<span class="keyword">var</span> f <span class="keyword">in</span> a.attributes)<span class="string">"link"</span>!=f&amp;&amp;(<span class="string">"title"</span>!=f&amp;&amp;<span class="string">"description"</span>!=f)&amp;&amp;(d=<span class="keyword">this</span>.createTextNode(a.attributes[f]),e=f,<span class="number">-1</span>!=</span><br><span class="line">f.search(<span class="string">":"</span>)&amp;&amp;(e=f.split(<span class="string">":"</span>)[<span class="number">1</span>]),e=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.featureNS,<span class="string">"feature:"</span>+e),e.appendChild(d),c.appendChild(e));c.appendChild(b);<span class="keyword">return</span> c&#125;,<span class="attr">buildGeometryNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection&amp;&amp;(a=a.clone(),a.transform(<span class="keyword">this</span>.internalProjection,<span class="keyword">this</span>.externalProjection));<span class="keyword">var</span> b;<span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.Polygon"</span>==a.CLASS_NAME)b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.georssns,<span class="string">"georss:polygon"</span>),b.appendChild(<span class="keyword">this</span>.buildCoordinatesNode(a.components[<span class="number">0</span>]));<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.LineString"</span>==</span><br><span class="line">a.CLASS_NAME)b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.georssns,<span class="string">"georss:line"</span>),b.appendChild(<span class="keyword">this</span>.buildCoordinatesNode(a));<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.Point"</span>==a.CLASS_NAME)b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.georssns,<span class="string">"georss:point"</span>),b.appendChild(<span class="keyword">this</span>.buildCoordinatesNode(a));<span class="keyword">else</span> <span class="keyword">throw</span><span class="string">"Couldn't parse "</span>+a.CLASS_NAME;<span class="keyword">return</span> b&#125;,<span class="attr">buildCoordinatesNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;a.components&amp;&amp;(b=a.components);<span class="keyword">if</span>(b)&#123;a=b.length;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="built_in">Array</span>(a),d=<span class="number">0</span>;d&lt;a;d++)c[d]=b[d].y+<span class="string">" "</span>+b[d].x;b=c.join(<span class="string">" "</span>)&#125;<span class="keyword">else</span> b=a.y+<span class="string">" "</span>+a.x;<span class="keyword">return</span> <span class="keyword">this</span>.createTextNode(b)&#125;,</span><br><span class="line">CLASS_NAME:<span class="string">"OpenLayers.Format.GeoRSS"</span>&#125;);OpenLayers.Format.WPSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,&#123;<span class="attr">defaultVersion</span>:<span class="string">"1.0.0"</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WPSCapabilities"</span>&#125;);OpenLayers.Format.WPSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows/1.1"</span>,<span class="attr">wps</span>:<span class="string">"http://www.opengis.net/wps/1.0.0"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>&#125;,<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);</span><br><span class="line"><span class="keyword">var</span> b=&#123;&#125;;<span class="keyword">this</span>.readNode(a,b);<span class="keyword">return</span> b&#125;,<span class="attr">readers</span>:&#123;<span class="attr">wps</span>:&#123;<span class="attr">Capabilities</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">ProcessOfferings</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.processOfferings=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.processOfferings)&#125;,<span class="attr">Process</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">processVersion</span>:<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.wps,<span class="string">"processVersion"</span>)&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b[c.identifier]=c&#125;,<span class="attr">Languages</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.languages=[];<span class="keyword">this</span>.readChildNodes(a,b.languages)&#125;,<span class="attr">Default</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">isDefault</span>:!<span class="number">0</span>&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.push(c)&#125;,</span><br><span class="line">Supported:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.push(c)&#125;&#125;,<span class="attr">ows</span>:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WPSCapabilities.v1_0_0"</span>&#125;);OpenLayers.Control.PinchZoom=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">type</span>:OpenLayers.Control.TYPE_TOOL,<span class="attr">pinchOrigin</span>:<span class="literal">null</span>,<span class="attr">currentCenter</span>:<span class="literal">null</span>,<span class="attr">autoActivate</span>:!<span class="number">0</span>,<span class="attr">preserveCenter</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.handler=<span class="keyword">new</span> OpenLayers.Handler.Pinch(<span class="keyword">this</span>,&#123;<span class="attr">start</span>:<span class="keyword">this</span>.pinchStart,<span class="attr">move</span>:<span class="keyword">this</span>.pinchMove,<span class="attr">done</span>:<span class="keyword">this</span>.pinchDone&#125;,<span class="keyword">this</span>.handlerOptions)&#125;,<span class="attr">pinchStart</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.preserveCenter?<span class="keyword">this</span>.map.getPixelFromLonLat(<span class="keyword">this</span>.map.getCenter()):a.xy;<span class="keyword">this</span>.currentCenter=</span><br><span class="line"><span class="keyword">this</span>.pinchOrigin=c&#125;,<span class="attr">pinchMove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=b.scale,d=<span class="keyword">this</span>.map.layerContainerOriginPx,e=<span class="keyword">this</span>.pinchOrigin,f=<span class="keyword">this</span>.preserveCenter?<span class="keyword">this</span>.map.getPixelFromLonLat(<span class="keyword">this</span>.map.getCenter()):a.xy,g=<span class="built_in">Math</span>.round(d.x+f.x-e.x+(c<span class="number">-1</span>)*(d.x-e.x)),d=<span class="built_in">Math</span>.round(d.y+f.y-e.y+(c<span class="number">-1</span>)*(d.y-e.y));<span class="keyword">this</span>.map.applyTransform(g,d,c);<span class="keyword">this</span>.currentCenter=f&#125;,<span class="attr">pinchDone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">this</span>.map.applyTransform();a=<span class="keyword">this</span>.map.getZoomForResolution(<span class="keyword">this</span>.map.getResolution()/c.scale,!<span class="number">0</span>);<span class="keyword">if</span>(a!==<span class="keyword">this</span>.map.getZoom()||!<span class="keyword">this</span>.currentCenter.equals(<span class="keyword">this</span>.pinchOrigin))&#123;b=</span><br><span class="line"><span class="keyword">this</span>.map.getResolutionForZoom(a);c=<span class="keyword">this</span>.map.getLonLatFromPixel(<span class="keyword">this</span>.pinchOrigin);<span class="keyword">var</span> d=<span class="keyword">this</span>.currentCenter,e=<span class="keyword">this</span>.map.getSize();c.lon+=b*(e.w/<span class="number">2</span>-d.x);c.lat-=b*(e.h/<span class="number">2</span>-d.y);<span class="keyword">this</span>.map.div.clientWidth=<span class="keyword">this</span>.map.div.clientWidth;<span class="keyword">this</span>.map.setCenter(c,a)&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.PinchZoom"</span>&#125;);OpenLayers.Control.TouchNavigation=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">dragPan</span>:<span class="literal">null</span>,<span class="attr">dragPanOptions</span>:<span class="literal">null</span>,<span class="attr">pinchZoom</span>:<span class="literal">null</span>,<span class="attr">pinchZoomOptions</span>:<span class="literal">null</span>,<span class="attr">clickHandlerOptions</span>:<span class="literal">null</span>,<span class="attr">documentDrag</span>:!<span class="number">1</span>,<span class="attr">autoActivate</span>:!<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.handlers=&#123;&#125;;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.deactivate();<span class="keyword">this</span>.dragPan&amp;&amp;<span class="keyword">this</span>.dragPan.destroy();<span class="keyword">this</span>.dragPan=<span class="literal">null</span>;<span class="keyword">this</span>.pinchZoom&amp;&amp;(<span class="keyword">this</span>.pinchZoom.destroy(),<span class="keyword">delete</span> <span class="keyword">this</span>.pinchZoom);OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>)&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Control.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)?(<span class="keyword">this</span>.dragPan.activate(),<span class="keyword">this</span>.handlers.click.activate(),<span class="keyword">this</span>.pinchZoom.activate(),!<span class="number">0</span>):!<span class="number">1</span>&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Control.prototype.deactivate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)?(<span class="keyword">this</span>.dragPan.deactivate(),<span class="keyword">this</span>.handlers.click.deactivate(),<span class="keyword">this</span>.pinchZoom.deactivate(),!<span class="number">0</span>):!<span class="number">1</span>&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=&#123;<span class="attr">click</span>:<span class="keyword">this</span>.defaultClick,<span class="attr">dblclick</span>:<span class="keyword">this</span>.defaultDblClick&#125;,b=OpenLayers.Util.extend(&#123;<span class="string">"double"</span>:!<span class="number">0</span>,<span class="attr">stopDouble</span>:!<span class="number">0</span>,</span><br><span class="line">pixelTolerance:<span class="number">2</span>&#125;,<span class="keyword">this</span>.clickHandlerOptions);<span class="keyword">this</span>.handlers.click=<span class="keyword">new</span> OpenLayers.Handler.Click(<span class="keyword">this</span>,a,b);<span class="keyword">this</span>.dragPan=<span class="keyword">new</span> OpenLayers.Control.DragPan(OpenLayers.Util.extend(&#123;<span class="attr">map</span>:<span class="keyword">this</span>.map,<span class="attr">documentDrag</span>:<span class="keyword">this</span>.documentDrag&#125;,<span class="keyword">this</span>.dragPanOptions));<span class="keyword">this</span>.dragPan.draw();<span class="keyword">this</span>.pinchZoom=<span class="keyword">new</span> OpenLayers.Control.PinchZoom(OpenLayers.Util.extend(&#123;<span class="attr">map</span>:<span class="keyword">this</span>.map&#125;,<span class="keyword">this</span>.pinchZoomOptions))&#125;,<span class="attr">defaultClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.lastTouches&amp;&amp;<span class="number">2</span>==a.lastTouches.length&amp;&amp;<span class="keyword">this</span>.map.zoomOut()&#125;,<span class="attr">defaultDblClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.map.zoomTo(<span class="keyword">this</span>.map.zoom+</span><br><span class="line"><span class="number">1</span>,a.xy)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.TouchNavigation"</span>&#125;);OpenLayers.Console.warn(<span class="string">"OpenLayers.Rico is deprecated"</span>);OpenLayers.Rico=OpenLayers.Rico||&#123;&#125;;</span><br><span class="line">OpenLayers.Rico.Color=OpenLayers.Class(&#123;<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">this</span>.rgb=&#123;<span class="attr">r</span>:a,<span class="attr">g</span>:b,<span class="attr">b</span>:c&#125;&#125;,<span class="attr">setRed</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.rgb.r=a&#125;,<span class="attr">setGreen</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.rgb.g=a&#125;,<span class="attr">setBlue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.rgb.b=a&#125;,<span class="attr">setHue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.asHSB();b.h=a;<span class="keyword">this</span>.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)&#125;,<span class="attr">setSaturation</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.asHSB();b.s=a;<span class="keyword">this</span>.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)&#125;,<span class="attr">setBrightness</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.asHSB();b.b=a;<span class="keyword">this</span>.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)&#125;,</span><br><span class="line">darken:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.asHSB();<span class="keyword">this</span>.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,<span class="built_in">Math</span>.max(b.b-a,<span class="number">0</span>))&#125;,<span class="attr">brighten</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.asHSB();<span class="keyword">this</span>.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,<span class="built_in">Math</span>.min(b.b+a,<span class="number">1</span>))&#125;,<span class="attr">blend</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.rgb.r=<span class="built_in">Math</span>.floor((<span class="keyword">this</span>.rgb.r+a.rgb.r)/<span class="number">2</span>);<span class="keyword">this</span>.rgb.g=<span class="built_in">Math</span>.floor((<span class="keyword">this</span>.rgb.g+a.rgb.g)/<span class="number">2</span>);<span class="keyword">this</span>.rgb.b=<span class="built_in">Math</span>.floor((<span class="keyword">this</span>.rgb.b+a.rgb.b)/<span class="number">2</span>)&#125;,<span class="attr">isBright</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.asHSB();<span class="keyword">return</span> <span class="number">0.5</span>&lt;<span class="keyword">this</span>.asHSB().b&#125;,<span class="attr">isDark</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>!<span class="keyword">this</span>.isBright()&#125;,<span class="attr">asRGB</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">"rgb("</span>+</span><br><span class="line"><span class="keyword">this</span>.rgb.r+<span class="string">","</span>+<span class="keyword">this</span>.rgb.g+<span class="string">","</span>+<span class="keyword">this</span>.rgb.b+<span class="string">")"</span>&#125;,<span class="attr">asHex</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">"#"</span>+<span class="keyword">this</span>.rgb.r.toColorPart()+<span class="keyword">this</span>.rgb.g.toColorPart()+<span class="keyword">this</span>.rgb.b.toColorPart()&#125;,<span class="attr">asHSB</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Rico.Color.RGBtoHSB(<span class="keyword">this</span>.rgb.r,<span class="keyword">this</span>.rgb.g,<span class="keyword">this</span>.rgb.b)&#125;,<span class="attr">toString</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.asHex()&#125;&#125;);</span><br><span class="line">OpenLayers.Rico.Color.createFromHex=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="number">4</span>==a.length)&#123;<span class="keyword">var</span> b=a;a=<span class="string">"#"</span>;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">1</span>;<span class="number">4</span>&gt;c;c++)a+=b.charAt(c)+b.charAt(c)&#125;<span class="number">0</span>==a.indexOf(<span class="string">"#"</span>)&amp;&amp;(a=a.substring(<span class="number">1</span>));b=a.substring(<span class="number">0</span>,<span class="number">2</span>);c=a.substring(<span class="number">2</span>,<span class="number">4</span>);a=a.substring(<span class="number">4</span>,<span class="number">6</span>);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Rico.Color(<span class="built_in">parseInt</span>(b,<span class="number">16</span>),<span class="built_in">parseInt</span>(c,<span class="number">16</span>),<span class="built_in">parseInt</span>(a,<span class="number">16</span>))&#125;;</span><br><span class="line">OpenLayers.Rico.Color.createColorFromBackground=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Element.getStyle(OpenLayers.Util.getElement(a),<span class="string">"backgroundColor"</span>);<span class="keyword">return</span><span class="string">"transparent"</span>==b&amp;&amp;a.parentNode?OpenLayers.Rico.Color.createColorFromBackground(a.parentNode):<span class="literal">null</span>==b?<span class="keyword">new</span> OpenLayers.Rico.Color(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>):<span class="number">0</span>==b.indexOf(<span class="string">"rgb("</span>)?(a=b.substring(<span class="number">4</span>,b.length<span class="number">-1</span>).split(<span class="string">","</span>),<span class="keyword">new</span> OpenLayers.Rico.Color(<span class="built_in">parseInt</span>(a[<span class="number">0</span>]),<span class="built_in">parseInt</span>(a[<span class="number">1</span>]),<span class="built_in">parseInt</span>(a[<span class="number">2</span>]))):<span class="number">0</span>==b.indexOf(<span class="string">"#"</span>)?OpenLayers.Rico.Color.createFromHex(b):<span class="keyword">new</span> OpenLayers.Rico.Color(<span class="number">255</span>,</span><br><span class="line"><span class="number">255</span>,<span class="number">255</span>)&#125;;</span><br><span class="line">OpenLayers.Rico.Color.HSBtoRGB=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=<span class="number">0</span>,e=<span class="number">0</span>,f=<span class="number">0</span>;<span class="keyword">if</span>(<span class="number">0</span>==b)f=e=d=<span class="built_in">parseInt</span>(<span class="number">255</span>*c+<span class="number">0.5</span>);<span class="keyword">else</span>&#123;a=<span class="number">6</span>*(a-<span class="built_in">Math</span>.floor(a));<span class="keyword">var</span> g=a-<span class="built_in">Math</span>.floor(a),h=c*(<span class="number">1</span>-b),k=c*(<span class="number">1</span>-b*g);b=c*(<span class="number">1</span>-b*(<span class="number">1</span>-g));<span class="keyword">switch</span>(<span class="built_in">parseInt</span>(a))&#123;<span class="keyword">case</span> <span class="number">0</span>:d=<span class="number">255</span>*c+<span class="number">0.5</span>;e=<span class="number">255</span>*b+<span class="number">0.5</span>;f=<span class="number">255</span>*h+<span class="number">0.5</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">1</span>:d=<span class="number">255</span>*k+<span class="number">0.5</span>;e=<span class="number">255</span>*c+<span class="number">0.5</span>;f=<span class="number">255</span>*h+<span class="number">0.5</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">2</span>:d=<span class="number">255</span>*h+<span class="number">0.5</span>;e=<span class="number">255</span>*c+<span class="number">0.5</span>;f=<span class="number">255</span>*b+<span class="number">0.5</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">3</span>:d=<span class="number">255</span>*h+<span class="number">0.5</span>;e=<span class="number">255</span>*k+<span class="number">0.5</span>;f=<span class="number">255</span>*c+<span class="number">0.5</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">4</span>:d=<span class="number">255</span>*b+<span class="number">0.5</span>;e=<span class="number">255</span>*h+<span class="number">0.5</span>;f=<span class="number">255</span>*c+<span class="number">0.5</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">5</span>:d=<span class="number">255</span>*c+<span class="number">0.5</span>,e=<span class="number">255</span>*h+<span class="number">0.5</span>,f=<span class="number">255</span>*k+<span class="number">0.5</span>&#125;&#125;<span class="keyword">return</span>&#123;<span class="attr">r</span>:<span class="built_in">parseInt</span>(d),<span class="attr">g</span>:<span class="built_in">parseInt</span>(e),</span><br><span class="line">b:<span class="built_in">parseInt</span>(f)&#125;&#125;;OpenLayers.Rico.Color.RGBtoHSB=<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d,e=a&gt;b?a:b;c&gt;e&amp;&amp;(e=c);<span class="keyword">var</span> f=a&lt;b?a:b;c&lt;f&amp;&amp;(f=c);d=<span class="number">0</span>!=e?(e-f)/e:<span class="number">0</span>;<span class="keyword">if</span>(<span class="number">0</span>==d)a=<span class="number">0</span>;<span class="keyword">else</span>&#123;<span class="keyword">var</span> g=(e-a)/(e-f),h=(e-b)/(e-f);c=(e-c)/(e-f);a=(a==e?c-h:b==e?<span class="number">2</span>+g-c:<span class="number">4</span>+h-g)/<span class="number">6</span>;<span class="number">0</span>&gt;a&amp;&amp;(a+=<span class="number">1</span>)&#125;<span class="keyword">return</span>&#123;<span class="attr">h</span>:a,<span class="attr">s</span>:d,<span class="attr">b</span>:e/<span class="number">255</span>&#125;&#125;;OpenLayers.Style2=OpenLayers.Class(&#123;<span class="attr">id</span>:<span class="literal">null</span>,<span class="attr">name</span>:<span class="literal">null</span>,<span class="attr">title</span>:<span class="literal">null</span>,<span class="attr">description</span>:<span class="literal">null</span>,<span class="attr">layerName</span>:<span class="literal">null</span>,<span class="attr">isDefault</span>:!<span class="number">1</span>,<span class="attr">rules</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,a);<span class="keyword">this</span>.id=OpenLayers.Util.createUniqueID(<span class="keyword">this</span>.CLASS_NAME+<span class="string">"_"</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="keyword">this</span>.rules.length;a&lt;b;a++)<span class="keyword">this</span>.rules[a].destroy();<span class="keyword">delete</span> <span class="keyword">this</span>.rules&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>);<span class="keyword">if</span>(<span class="keyword">this</span>.rules)&#123;a.rules=[];<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=<span class="keyword">this</span>.rules.length;b&lt;c;++b)a.rules.push(<span class="keyword">this</span>.rules[b].clone())&#125;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Style2(a)&#125;,</span><br><span class="line">CLASS_NAME:<span class="string">"OpenLayers.Style2"</span>&#125;);OpenLayers.Format.WFS=OpenLayers.Class(OpenLayers.Format.GML,&#123;<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">wfsns</span>:<span class="string">"http://www.opengis.net/wfs"</span>,<span class="attr">ogcns</span>:<span class="string">"http://www.opengis.net/ogc"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Format.GML.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.layer=b;<span class="keyword">this</span>.layer.featureNS&amp;&amp;(<span class="keyword">this</span>.featureNS=<span class="keyword">this</span>.layer.featureNS);<span class="keyword">this</span>.layer.options.geometry_column&amp;&amp;(<span class="keyword">this</span>.geometryName=<span class="keyword">this</span>.layer.options.geometry_column);<span class="keyword">this</span>.layer.options.typename&amp;&amp;(<span class="keyword">this</span>.featureName=<span class="keyword">this</span>.layer.options.typename)&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.wfsns,</span><br><span class="line"><span class="string">"wfs:Transaction"</span>);b.setAttribute(<span class="string">"version"</span>,<span class="string">"1.0.0"</span>);b.setAttribute(<span class="string">"service"</span>,<span class="string">"WFS"</span>);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>;c&lt;a.length;c++)<span class="keyword">switch</span>(a[c].state)&#123;<span class="keyword">case</span> OpenLayers.State.INSERT:b.appendChild(<span class="keyword">this</span>.insert(a[c]));<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.State.UPDATE:b.appendChild(<span class="keyword">this</span>.update(a[c]));<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.State.DELETE:b.appendChild(<span class="keyword">this</span>.remove(a[c]))&#125;<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[b])&#125;,<span class="attr">createFeatureXML</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.buildGeometryNode(a.geometry),c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.featureNS,<span class="string">"feature:"</span>+</span><br><span class="line"><span class="keyword">this</span>.geometryName);c.appendChild(b);b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.featureNS,<span class="string">"feature:"</span>+<span class="keyword">this</span>.featureName);b.appendChild(c);<span class="keyword">for</span>(<span class="keyword">var</span> d <span class="keyword">in</span> a.attributes)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.createTextNode(a.attributes[d]),e=d;<span class="number">-1</span>!=d.search(<span class="string">":"</span>)&amp;&amp;(e=d.split(<span class="string">":"</span>)[<span class="number">1</span>]);e=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.featureNS,<span class="string">"feature:"</span>+e);e.appendChild(c);b.appendChild(e)&#125;<span class="keyword">return</span> b&#125;,<span class="attr">insert</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.wfsns,<span class="string">"wfs:Insert"</span>);b.appendChild(<span class="keyword">this</span>.createFeatureXML(a));<span class="keyword">return</span> b&#125;,<span class="attr">update</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.fid||OpenLayers.Console.userError(OpenLayers.i18n(<span class="string">"noFID"</span>));</span><br><span class="line"><span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.wfsns,<span class="string">"wfs:Update"</span>);b.setAttribute(<span class="string">"typeName"</span>,<span class="keyword">this</span>.featurePrefix+<span class="string">":"</span>+<span class="keyword">this</span>.featureName);b.setAttribute(<span class="string">"xmlns:"</span>+<span class="keyword">this</span>.featurePrefix,<span class="keyword">this</span>.featureNS);<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.wfsns,<span class="string">"wfs:Property"</span>),d=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.wfsns,<span class="string">"wfs:Name"</span>),e=<span class="keyword">this</span>.createTextNode(<span class="keyword">this</span>.geometryName);d.appendChild(e);c.appendChild(d);d=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.wfsns,<span class="string">"wfs:Value"</span>);e=<span class="keyword">this</span>.buildGeometryNode(a.geometry);a.layer&amp;&amp;e.setAttribute(<span class="string">"srsName"</span>,a.layer.projection.getCode());</span><br><span class="line">d.appendChild(e);c.appendChild(d);b.appendChild(c);<span class="keyword">for</span>(<span class="keyword">var</span> f <span class="keyword">in</span> a.attributes)c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.wfsns,<span class="string">"wfs:Property"</span>),d=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.wfsns,<span class="string">"wfs:Name"</span>),d.appendChild(<span class="keyword">this</span>.createTextNode(f)),c.appendChild(d),d=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.wfsns,<span class="string">"wfs:Value"</span>),d.appendChild(<span class="keyword">this</span>.createTextNode(a.attributes[f])),c.appendChild(d),b.appendChild(c);c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.ogcns,<span class="string">"ogc:Filter"</span>);f=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.ogcns,<span class="string">"ogc:FeatureId"</span>);f.setAttribute(<span class="string">"fid"</span>,a.fid);c.appendChild(f);</span><br><span class="line">b.appendChild(c);<span class="keyword">return</span> b&#125;,<span class="attr">remove</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!a.fid)<span class="keyword">return</span> OpenLayers.Console.userError(OpenLayers.i18n(<span class="string">"noFID"</span>)),!<span class="number">1</span>;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.wfsns,<span class="string">"wfs:Delete"</span>);b.setAttribute(<span class="string">"typeName"</span>,<span class="keyword">this</span>.featurePrefix+<span class="string">":"</span>+<span class="keyword">this</span>.featureName);b.setAttribute(<span class="string">"xmlns:"</span>+<span class="keyword">this</span>.featurePrefix,<span class="keyword">this</span>.featureNS);<span class="keyword">var</span> c=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.ogcns,<span class="string">"ogc:Filter"</span>),d=<span class="keyword">this</span>.createElementNS(<span class="keyword">this</span>.ogcns,<span class="string">"ogc:FeatureId"</span>);d.setAttribute(<span class="string">"fid"</span>,a.fid);c.appendChild(d);b.appendChild(c);<span class="keyword">return</span> b&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.layer=</span><br><span class="line"><span class="literal">null</span>&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WFS"</span>&#125;);OpenLayers.Format.SLD.v1_0_0_GeoServer=OpenLayers.Class(OpenLayers.Format.SLD.v1_0_0,&#123;<span class="attr">version</span>:<span class="string">"1.0.0"</span>,<span class="attr">profile</span>:<span class="string">"GeoServer"</span>,<span class="attr">readers</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">sld</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">Priority</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.readers.ogc._expression.call(<span class="keyword">this</span>,a);c&amp;&amp;(b.priority=c)&#125;,<span class="attr">VendorOption</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.vendorOptions||(b.vendorOptions=&#123;&#125;);b.vendorOptions[a.getAttribute(<span class="string">"name"</span>)]=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">TextSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld.TextSymbolizer.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>);<span class="keyword">var</span> c=<span class="keyword">this</span>.multipleSymbolizers?b.symbolizers[b.symbolizers.length<span class="number">-1</span>]:b.symbolizer.Text;<span class="keyword">void</span> <span class="number">0</span>===c.graphic&amp;&amp;(c.graphic=!<span class="number">1</span>)&#125;&#125;,OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld)&#125;,OpenLayers.Format.SLD.v1_0_0.prototype.readers),<span class="attr">writers</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">sld</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">Priority</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.writers.sld._OGCExpression.call(<span class="keyword">this</span>,<span class="string">"sld:Priority"</span>,a)&#125;,<span class="attr">VendorOption</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"sld:VendorOption"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">name</span>:a.name&#125;,</span><br><span class="line">value:a.value&#125;)&#125;,<span class="attr">TextSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.TextSymbolizer.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);!<span class="number">1</span>!==a.graphic&amp;&amp;(a.externalGraphic||a.graphicName)&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Graphic"</span>,a,b);<span class="string">"priority"</span><span class="keyword">in</span> a&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"Priority"</span>,a.priority,b);<span class="keyword">return</span> <span class="keyword">this</span>.addVendorOptions(b,a)&#125;,<span class="attr">PointSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.PointSymbolizer.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">return</span> <span class="keyword">this</span>.addVendorOptions(b,a)&#125;,<span class="attr">LineSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line">OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.LineSymbolizer.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">return</span> <span class="keyword">this</span>.addVendorOptions(b,a)&#125;,<span class="attr">PolygonSymbolizer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.PolygonSymbolizer.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">return</span> <span class="keyword">this</span>.addVendorOptions(b,a)&#125;&#125;,OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld)&#125;,OpenLayers.Format.SLD.v1_0_0.prototype.writers),<span class="attr">addVendorOptions</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(b.vendorOptions)<span class="keyword">for</span>(<span class="keyword">var</span> c <span class="keyword">in</span> b.vendorOptions)<span class="keyword">this</span>.writeNode(<span class="string">"VendorOption"</span>,&#123;<span class="attr">name</span>:c,</span><br><span class="line">value:b.vendorOptions[c]&#125;,a);<span class="keyword">return</span> a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.SLD.v1_0_0_GeoServer"</span>&#125;);OpenLayers.Layer.Boxes=OpenLayers.Class(OpenLayers.Layer.Markers,&#123;<span class="attr">drawMarker</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getLayerPxFromLonLat(&#123;<span class="attr">lon</span>:a.bounds.left,<span class="attr">lat</span>:a.bounds.top&#125;),c=<span class="keyword">this</span>.map.getLayerPxFromLonLat(&#123;<span class="attr">lon</span>:a.bounds.right,<span class="attr">lat</span>:a.bounds.bottom&#125;);<span class="literal">null</span>==c||<span class="literal">null</span>==b?a.display(!<span class="number">1</span>):(b=a.draw(b,&#123;<span class="attr">w</span>:<span class="built_in">Math</span>.max(<span class="number">1</span>,c.x-b.x),<span class="attr">h</span>:<span class="built_in">Math</span>.max(<span class="number">1</span>,c.y-b.y)&#125;),a.drawn||(<span class="keyword">this</span>.div.appendChild(b),a.drawn=!<span class="number">0</span>))&#125;,<span class="attr">removeMarker</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.removeItem(<span class="keyword">this</span>.markers,a);<span class="literal">null</span>!=a.div&amp;&amp;a.div.parentNode==<span class="keyword">this</span>.div&amp;&amp;<span class="keyword">this</span>.div.removeChild(a.div)&#125;,</span><br><span class="line">CLASS_NAME:<span class="string">"OpenLayers.Layer.Boxes"</span>&#125;);OpenLayers.Format.WFSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,&#123;<span class="attr">readers</span>:&#123;<span class="attr">wfs</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">Service</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.service=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.service)&#125;,<span class="attr">Fees</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);c&amp;&amp;<span class="string">"none"</span>!=c.toLowerCase()&amp;&amp;(b.fees=c)&#125;,<span class="attr">AccessConstraints</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);c&amp;&amp;<span class="string">"none"</span>!=c.toLowerCase()&amp;&amp;(b.accessConstraints=c)&#125;,<span class="attr">OnlineResource</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);c&amp;&amp;<span class="string">"none"</span>!=c.toLowerCase()&amp;&amp;(b.onlineResource=</span><br><span class="line">c)&#125;,<span class="attr">Keywords</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);c&amp;&amp;<span class="string">"none"</span>!=c.toLowerCase()&amp;&amp;(b.keywords=c.split(<span class="string">", "</span>))&#125;,<span class="attr">Capability</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.capability=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.capability)&#125;,<span class="attr">Request</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.request=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.request)&#125;,<span class="attr">GetFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.getfeature=&#123;<span class="attr">href</span>:&#123;&#125;,<span class="attr">formats</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.getfeature)&#125;,<span class="attr">ResultFormat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=a.childNodes,d,e=<span class="number">0</span>;e&lt;c.length;e++)d=c[e],<span class="number">1</span>==d.nodeType&amp;&amp;b.formats.push(d.nodeName)&#125;,<span class="attr">DCPType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,</span><br><span class="line">b)&#125;,<span class="attr">HTTP</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b.href)&#125;,<span class="attr">Get</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.get=a.getAttribute(<span class="string">"onlineResource"</span>)&#125;,<span class="attr">Post</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.post=a.getAttribute(<span class="string">"onlineResource"</span>)&#125;,<span class="attr">SRS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);c&amp;&amp;(b.srs=c)&#125;&#125;,OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WFSCapabilities.v1_0_0"</span>&#125;);OpenLayers.Format.WMSCapabilities.v1_3=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,&#123;<span class="attr">readers</span>:&#123;<span class="attr">wms</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">WMS_Capabilities</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">LayerLimit</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.layerLimit=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">MaxWidth</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.maxWidth=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">MaxHeight</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.maxHeight=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">BoundingBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(<span class="keyword">this</span>,</span><br><span class="line">[a,b]);c.srs=a.getAttribute(<span class="string">"CRS"</span>);b.bbox[c.srs]=c&#125;,<span class="attr">CRS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readers.wms.SRS.apply(<span class="keyword">this</span>,[a,b])&#125;,<span class="attr">EX_GeographicBoundingBox</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.llbbox=[];<span class="keyword">this</span>.readChildNodes(a,b.llbbox)&#125;,<span class="attr">westBoundLongitude</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b[<span class="number">0</span>]=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">eastBoundLongitude</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b[<span class="number">2</span>]=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">southBoundLatitude</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b[<span class="number">1</span>]=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">northBoundLatitude</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b[<span class="number">3</span>]=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">MinScaleDenominator</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.maxScale=<span class="built_in">parseFloat</span>(<span class="keyword">this</span>.getChildValue(a)).toPrecision(<span class="number">16</span>)&#125;,</span><br><span class="line">MaxScaleDenominator:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.minScale=<span class="built_in">parseFloat</span>(<span class="keyword">this</span>.getChildValue(a)).toPrecision(<span class="number">16</span>)&#125;,<span class="attr">Dimension</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">name</span>:a.getAttribute(<span class="string">"name"</span>).toLowerCase(),<span class="attr">units</span>:a.getAttribute(<span class="string">"units"</span>),<span class="attr">unitsymbol</span>:a.getAttribute(<span class="string">"unitSymbol"</span>),<span class="attr">nearestVal</span>:<span class="string">"1"</span>===a.getAttribute(<span class="string">"nearestValue"</span>),<span class="attr">multipleVal</span>:<span class="string">"1"</span>===a.getAttribute(<span class="string">"multipleValues"</span>),<span class="string">"default"</span>:a.getAttribute(<span class="string">"default"</span>)||<span class="string">""</span>,<span class="attr">current</span>:<span class="string">"1"</span>===a.getAttribute(<span class="string">"current"</span>),<span class="attr">values</span>:<span class="keyword">this</span>.getChildValue(a).split(<span class="string">","</span>)&#125;;b.dimensions[c.name]=c&#125;,<span class="attr">Keyword</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">value</span>:<span class="keyword">this</span>.getChildValue(a),<span class="attr">vocabulary</span>:a.getAttribute(<span class="string">"vocabulary"</span>)&#125;;b.keywords&amp;&amp;b.keywords.push(c)&#125;&#125;,OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms),<span class="attr">sld</span>:&#123;<span class="attr">UserDefinedSymbolization</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readers.wms.UserDefinedSymbolization.apply(<span class="keyword">this</span>,[a,b]);b.userSymbols.inlineFeature=<span class="number">1</span>==<span class="built_in">parseInt</span>(a.getAttribute(<span class="string">"InlineFeature"</span>));b.userSymbols.remoteWCS=<span class="number">1</span>==<span class="built_in">parseInt</span>(a.getAttribute(<span class="string">"RemoteWCS"</span>))&#125;,<span class="attr">DescribeLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readers.wms.DescribeLayer.apply(<span class="keyword">this</span>,[a,b])&#125;,<span class="attr">GetLegendGraphic</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">this</span>.readers.wms.GetLegendGraphic.apply(<span class="keyword">this</span>,[a,b])&#125;&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMSCapabilities.v1_3"</span>&#125;);OpenLayers.Layer.Zoomify=OpenLayers.Class(OpenLayers.Layer.Grid,&#123;<span class="attr">size</span>:<span class="literal">null</span>,<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">standardTileSize</span>:<span class="number">256</span>,<span class="attr">tileOriginCorner</span>:<span class="string">"tl"</span>,<span class="attr">numberOfTiers</span>:<span class="number">0</span>,<span class="attr">tileCountUpToTier</span>:<span class="literal">null</span>,<span class="attr">tierSizeInTiles</span>:<span class="literal">null</span>,<span class="attr">tierImageSize</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">this</span>.initializeZoomify(c);OpenLayers.Layer.Grid.prototype.initialize.apply(<span class="keyword">this</span>,[a,b,c,&#123;&#125;,d])&#125;,<span class="attr">initializeZoomify</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.clone();<span class="keyword">this</span>.size=a.clone();a=<span class="keyword">new</span> OpenLayers.Size(<span class="built_in">Math</span>.ceil(b.w/<span class="keyword">this</span>.standardTileSize),<span class="built_in">Math</span>.ceil(b.h/<span class="keyword">this</span>.standardTileSize));<span class="keyword">this</span>.tierSizeInTiles=</span><br><span class="line">[a];<span class="keyword">for</span>(<span class="keyword">this</span>.tierImageSize=[b];b.w&gt;<span class="keyword">this</span>.standardTileSize||b.h&gt;<span class="keyword">this</span>.standardTileSize;)b=<span class="keyword">new</span> OpenLayers.Size(<span class="built_in">Math</span>.floor(b.w/<span class="number">2</span>),<span class="built_in">Math</span>.floor(b.h/<span class="number">2</span>)),a=<span class="keyword">new</span> OpenLayers.Size(<span class="built_in">Math</span>.ceil(b.w/<span class="keyword">this</span>.standardTileSize),<span class="built_in">Math</span>.ceil(b.h/<span class="keyword">this</span>.standardTileSize)),<span class="keyword">this</span>.tierSizeInTiles.push(a),<span class="keyword">this</span>.tierImageSize.push(b);<span class="keyword">this</span>.tierSizeInTiles.reverse();<span class="keyword">this</span>.tierImageSize.reverse();<span class="keyword">this</span>.numberOfTiers=<span class="keyword">this</span>.tierSizeInTiles.length;b=[<span class="number">1</span>];<span class="keyword">this</span>.tileCountUpToTier=[<span class="number">0</span>];<span class="keyword">for</span>(a=<span class="number">1</span>;a&lt;<span class="keyword">this</span>.numberOfTiers;a++)b.unshift(<span class="built_in">Math</span>.pow(<span class="number">2</span>,a)),<span class="keyword">this</span>.tileCountUpToTier.push(<span class="keyword">this</span>.tierSizeInTiles[a-</span><br><span class="line"><span class="number">1</span>].w*<span class="keyword">this</span>.tierSizeInTiles[a<span class="number">-1</span>].h+<span class="keyword">this</span>.tileCountUpToTier[a<span class="number">-1</span>]);<span class="keyword">this</span>.serverResolutions||(<span class="keyword">this</span>.serverResolutions=b)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Layer.Grid.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.tileCountUpToTier.length=<span class="number">0</span>;<span class="keyword">this</span>.tierSizeInTiles.length=<span class="number">0</span>;<span class="keyword">this</span>.tierImageSize.length=<span class="number">0</span>&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.Zoomify(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.size,<span class="keyword">this</span>.options));<span class="keyword">return</span> a=OpenLayers.Layer.Grid.prototype.clone.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.adjustBounds(a);<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.getServerResolution(),c=<span class="built_in">Math</span>.round((a.left-<span class="keyword">this</span>.tileOrigin.lon)/(b*<span class="keyword">this</span>.tileSize.w));a=<span class="built_in">Math</span>.round((<span class="keyword">this</span>.tileOrigin.lat-a.top)/(b*<span class="keyword">this</span>.tileSize.h));b=<span class="keyword">this</span>.getZoomForResolution(b);c=<span class="string">"TileGroup"</span>+<span class="built_in">Math</span>.floor((c+a*<span class="keyword">this</span>.tierSizeInTiles[b].w+<span class="keyword">this</span>.tileCountUpToTier[b])/<span class="number">256</span>)+<span class="string">"/"</span>+b+<span class="string">"-"</span>+c+<span class="string">"-"</span>+a+<span class="string">".jpg"</span>;b=<span class="keyword">this</span>.url;OpenLayers.Util.isArray(b)&amp;&amp;(b=<span class="keyword">this</span>.selectUrl(c,b));<span class="keyword">return</span> b+c&#125;,<span class="attr">getImageSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="number">0</span>&lt;<span class="built_in">arguments</span>.length)&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.adjustBounds(<span class="built_in">arguments</span>[<span class="number">0</span>]),b=<span class="keyword">this</span>.getServerResolution(),c=<span class="built_in">Math</span>.round((a.left-</span><br><span class="line"><span class="keyword">this</span>.tileOrigin.lon)/(b*<span class="keyword">this</span>.tileSize.w)),a=<span class="built_in">Math</span>.round((<span class="keyword">this</span>.tileOrigin.lat-a.top)/(b*<span class="keyword">this</span>.tileSize.h)),b=<span class="keyword">this</span>.getZoomForResolution(b),d=<span class="keyword">this</span>.standardTileSize,e=<span class="keyword">this</span>.standardTileSize;c==<span class="keyword">this</span>.tierSizeInTiles[b].w<span class="number">-1</span>&amp;&amp;(d=<span class="keyword">this</span>.tierImageSize[b].w%<span class="keyword">this</span>.standardTileSize);a==<span class="keyword">this</span>.tierSizeInTiles[b].h<span class="number">-1</span>&amp;&amp;(e=<span class="keyword">this</span>.tierImageSize[b].h%<span class="keyword">this</span>.standardTileSize);<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Size(d,e)&#125;<span class="keyword">return</span> <span class="keyword">this</span>.tileSize&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Layer.Grid.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.tileOrigin=<span class="keyword">new</span> OpenLayers.LonLat(<span class="keyword">this</span>.map.maxExtent.left,</span><br><span class="line"><span class="keyword">this</span>.map.maxExtent.top)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.Zoomify"</span>&#125;);OpenLayers.Layer.MapServer=OpenLayers.Class(OpenLayers.Layer.Grid,&#123;<span class="attr">DEFAULT_PARAMS</span>:&#123;<span class="attr">mode</span>:<span class="string">"map"</span>,<span class="attr">map_imagetype</span>:<span class="string">"png"</span>&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;OpenLayers.Layer.Grid.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.params=OpenLayers.Util.applyDefaults(<span class="keyword">this</span>.params,<span class="keyword">this</span>.DEFAULT_PARAMS);<span class="keyword">if</span>(<span class="literal">null</span>==d||<span class="literal">null</span>==d.isBaseLayer)<span class="keyword">this</span>.isBaseLayer=<span class="string">"true"</span>!=<span class="keyword">this</span>.params.transparent&amp;&amp;!<span class="number">0</span>!=<span class="keyword">this</span>.params.transparent&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.MapServer(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.params,<span class="keyword">this</span>.getOptions()));</span><br><span class="line"><span class="keyword">return</span> a=OpenLayers.Layer.Grid.prototype.clone.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.adjustBounds(a);a=[a.left,a.bottom,a.right,a.top];<span class="keyword">var</span> b=<span class="keyword">this</span>.getImageSize();<span class="keyword">return</span> <span class="keyword">this</span>.getFullRequestString(&#123;<span class="attr">mapext</span>:a,<span class="attr">imgext</span>:a,<span class="attr">map_size</span>:[b.w,b.h],<span class="attr">imgx</span>:b.w/<span class="number">2</span>,<span class="attr">imgy</span>:b.h/<span class="number">2</span>,<span class="attr">imgxy</span>:[b.w,b.h]&#125;)&#125;,<span class="attr">getFullRequestString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>==b?<span class="keyword">this</span>.url:b,d=OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>.params),d=OpenLayers.Util.extend(d,a),e=OpenLayers.Util.getParameterString(d);OpenLayers.Util.isArray(c)&amp;&amp;(c=<span class="keyword">this</span>.selectUrl(e,c));</span><br><span class="line"><span class="keyword">var</span> e=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c)),f;<span class="keyword">for</span>(f <span class="keyword">in</span> d)f.toUpperCase()<span class="keyword">in</span> e&amp;&amp;<span class="keyword">delete</span> d[f];e=OpenLayers.Util.getParameterString(d);d=c;e=e.replace(<span class="regexp">/,/g</span>,<span class="string">"+"</span>);<span class="string">""</span>!=e&amp;&amp;(f=c.charAt(c.length<span class="number">-1</span>),d=<span class="string">"&amp;"</span>==f||<span class="string">"?"</span>==f?d+e:<span class="number">-1</span>==c.indexOf(<span class="string">"?"</span>)?d+(<span class="string">"?"</span>+e):d+(<span class="string">"&amp;"</span>+e));<span class="keyword">return</span> d&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.MapServer"</span>&#125;);OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,&#123;<span class="attr">xmlns</span>:<span class="string">"urn:schemas-microsoft-com:vml"</span>,<span class="attr">symbolCache</span>:&#123;&#125;,<span class="attr">offset</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.supported())&#123;<span class="keyword">if</span>(!<span class="built_in">document</span>.namespaces.olv)&#123;<span class="built_in">document</span>.namespaces.add(<span class="string">"olv"</span>,<span class="keyword">this</span>.xmlns);<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="built_in">document</span>.createStyleSheet(),c=<span class="string">"shape rect oval fill stroke imagedata group textbox"</span>.split(<span class="string">" "</span>),d=<span class="number">0</span>,e=c.length;d&lt;e;d++)b.addRule(<span class="string">"olv\\:"</span>+c[d],<span class="string">"behavior: url(#default#VML); position: absolute; display: inline-block;"</span>)&#125;OpenLayers.Renderer.Elements.prototype.initialize.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>)&#125;&#125;,<span class="attr">supported</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>!!<span class="built_in">document</span>.namespaces&#125;,<span class="attr">setExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Renderer.Elements.prototype.setExtent.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>),d=<span class="keyword">this</span>.getResolution(),e=a.left/d|<span class="number">0</span>,d=a.top/d-<span class="keyword">this</span>.size.h|<span class="number">0</span>;b||!<span class="keyword">this</span>.offset?(<span class="keyword">this</span>.offset=&#123;<span class="attr">x</span>:e,<span class="attr">y</span>:d&#125;,d=e=<span class="number">0</span>):(e-=<span class="keyword">this</span>.offset.x,d-=<span class="keyword">this</span>.offset.y);<span class="keyword">this</span>.root.coordorigin=e-<span class="keyword">this</span>.xOffset+<span class="string">" "</span>+d;<span class="keyword">for</span>(<span class="keyword">var</span> e=[<span class="keyword">this</span>.root,<span class="keyword">this</span>.vectorRoot,<span class="keyword">this</span>.textRoot],f=<span class="number">0</span>,g=e.length;f&lt;g;++f)d=e[f],d.coordsize=<span class="keyword">this</span>.size.w+<span class="string">" "</span>+<span class="keyword">this</span>.size.h;<span class="keyword">this</span>.root.style.flip=<span class="string">"y"</span>;<span class="keyword">return</span> c&#125;,</span><br><span class="line">setSize:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Renderer.prototype.setSize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">for</span>(<span class="keyword">var</span> b=[<span class="keyword">this</span>.rendererRoot,<span class="keyword">this</span>.root,<span class="keyword">this</span>.vectorRoot,<span class="keyword">this</span>.textRoot],c=<span class="keyword">this</span>.size.w+<span class="string">"px"</span>,d=<span class="keyword">this</span>.size.h+<span class="string">"px"</span>,e,f=<span class="number">0</span>,g=b.length;f&lt;g;++f)e=b[f],e.style.width=c,e.style.height=d&#125;,<span class="attr">getNodeType</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="literal">null</span>;<span class="keyword">switch</span>(a.CLASS_NAME)&#123;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Point"</span>:c=b.externalGraphic?<span class="string">"olv:rect"</span>:<span class="keyword">this</span>.isComplexSymbol(b.graphicName)?<span class="string">"olv:shape"</span>:<span class="string">"olv:oval"</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Rectangle"</span>:c=<span class="string">"olv:rect"</span>;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.LineString"</span>:<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.LinearRing"</span>:<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Polygon"</span>:<span class="keyword">case</span> <span class="string">"OpenLayers.Geometry.Curve"</span>:c=</span><br><span class="line"><span class="string">"olv:shape"</span>&#125;<span class="keyword">return</span> c&#125;,<span class="attr">setStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;b=b||a._style;c=c||a._options;<span class="keyword">var</span> e=b.fillColor,f=b.title||b.graphicTitle;f&amp;&amp;(a.title=f);<span class="keyword">if</span>(<span class="string">"OpenLayers.Geometry.Point"</span>===a._geometryClass)<span class="keyword">if</span>(b.externalGraphic)&#123;c.isFilled=!<span class="number">0</span>;<span class="keyword">var</span> e=b.graphicWidth||b.graphicHeight,f=b.graphicHeight||b.graphicWidth,e=e?e:<span class="number">2</span>*b.pointRadius,f=f?f:<span class="number">2</span>*b.pointRadius,g=<span class="keyword">this</span>.getResolution(),h=<span class="keyword">void</span> <span class="number">0</span>!=b.graphicXOffset?b.graphicXOffset:-(<span class="number">0.5</span>*e),k=<span class="keyword">void</span> <span class="number">0</span>!=b.graphicYOffset?b.graphicYOffset:-(<span class="number">0.5</span>*f);a.style.left=((d.x-<span class="keyword">this</span>.featureDx)/</span><br><span class="line">g-<span class="keyword">this</span>.offset.x+h|<span class="number">0</span>)+<span class="string">"px"</span>;a.style.top=(d.y/g-<span class="keyword">this</span>.offset.y-(k+f)|<span class="number">0</span>)+<span class="string">"px"</span>;a.style.width=e+<span class="string">"px"</span>;a.style.height=f+<span class="string">"px"</span>;a.style.flip=<span class="string">"y"</span>;e=<span class="string">"none"</span>;c.isStroked=!<span class="number">1</span>&#125;<span class="keyword">else</span> <span class="keyword">this</span>.isComplexSymbol(b.graphicName)?(f=<span class="keyword">this</span>.importSymbol(b.graphicName),a.path=f.path,a.coordorigin=f.left+<span class="string">","</span>+f.bottom,f=f.size,a.coordsize=f+<span class="string">","</span>+f,<span class="keyword">this</span>.drawCircle(a,d,b.pointRadius),a.style.flip=<span class="string">"y"</span>):<span class="keyword">this</span>.drawCircle(a,d,b.pointRadius);c.isFilled?a.fillcolor=e:a.filled=<span class="string">"false"</span>;d=a.getElementsByTagName(<span class="string">"fill"</span>);d=<span class="number">0</span>==d.length?<span class="literal">null</span>:d[<span class="number">0</span>];c.isFilled?</span><br><span class="line">(d||(d=<span class="keyword">this</span>.createNode(<span class="string">"olv:fill"</span>,a.id+<span class="string">"_fill"</span>)),d.opacity=b.fillOpacity,<span class="string">"OpenLayers.Geometry.Point"</span>===a._geometryClass&amp;&amp;b.externalGraphic&amp;&amp;(b.graphicOpacity&amp;&amp;(d.opacity=b.graphicOpacity),d.src=b.externalGraphic,d.type=<span class="string">"frame"</span>,b.graphicWidth&amp;&amp;b.graphicHeight||(d.aspect=<span class="string">"atmost"</span>)),d.parentNode!=a&amp;&amp;a.appendChild(d)):d&amp;&amp;a.removeChild(d);e=b.rotation;<span class="keyword">if</span>(<span class="keyword">void</span> <span class="number">0</span>!==e||<span class="keyword">void</span> <span class="number">0</span>!==a._rotation)a._rotation=e,b.externalGraphic?(<span class="keyword">this</span>.graphicRotate(a,h,k,b),d.opacity=<span class="number">0</span>):<span class="string">"OpenLayers.Geometry.Point"</span>===a._geometryClass&amp;&amp;</span><br><span class="line">(a.style.rotation=e||<span class="number">0</span>);h=a.getElementsByTagName(<span class="string">"stroke"</span>);h=<span class="number">0</span>==h.length?<span class="literal">null</span>:h[<span class="number">0</span>];c.isStroked?(h||(h=<span class="keyword">this</span>.createNode(<span class="string">"olv:stroke"</span>,a.id+<span class="string">"_stroke"</span>),a.appendChild(h)),h.on=!<span class="number">0</span>,h.color=b.strokeColor,h.weight=b.strokeWidth+<span class="string">"px"</span>,h.opacity=b.strokeOpacity,h.endcap=<span class="string">"butt"</span>==b.strokeLinecap?<span class="string">"flat"</span>:b.strokeLinecap||<span class="string">"round"</span>,b.strokeDashstyle&amp;&amp;(h.dashstyle=<span class="keyword">this</span>.dashStyle(b))):(a.stroked=!<span class="number">1</span>,h&amp;&amp;(h.on=!<span class="number">1</span>));<span class="string">"inherit"</span>!=b.cursor&amp;&amp;<span class="literal">null</span>!=b.cursor&amp;&amp;(a.style.cursor=b.cursor);<span class="keyword">return</span> a&#125;,<span class="attr">graphicRotate</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;d=</span><br><span class="line">d||a._style;<span class="keyword">var</span> e=d.rotation||<span class="number">0</span>,f,g;<span class="keyword">if</span>(d.graphicWidth&amp;&amp;d.graphicHeight)&#123;g=<span class="built_in">Math</span>.max(d.graphicWidth,d.graphicHeight);f=d.graphicWidth/d.graphicHeight;<span class="keyword">var</span> h=<span class="built_in">Math</span>.round(d.graphicWidth||g*f),k=<span class="built_in">Math</span>.round(d.graphicHeight||g);a.style.width=h+<span class="string">"px"</span>;a.style.height=k+<span class="string">"px"</span>;<span class="keyword">var</span> l=<span class="built_in">document</span>.getElementById(a.id+<span class="string">"_image"</span>);l||(l=<span class="keyword">this</span>.createNode(<span class="string">"olv:imagedata"</span>,a.id+<span class="string">"_image"</span>),a.appendChild(l));l.style.width=h+<span class="string">"px"</span>;l.style.height=k+<span class="string">"px"</span>;l.src=d.externalGraphic;l.style.filter=<span class="string">"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')"</span>;</span><br><span class="line">l=e*<span class="built_in">Math</span>.PI/<span class="number">180</span>;e=<span class="built_in">Math</span>.sin(l);l=<span class="built_in">Math</span>.cos(l);e=<span class="string">"progid:DXImageTransform.Microsoft.Matrix(M11="</span>+l+<span class="string">",M12="</span>+-e+<span class="string">",M21="</span>+e+<span class="string">",M22="</span>+l+<span class="string">",SizingMethod='auto expand')\n"</span>;(l=d.graphicOpacity||d.fillOpacity)&amp;&amp;<span class="number">1</span>!=l&amp;&amp;(e+=<span class="string">"progid:DXImageTransform.Microsoft.BasicImage(opacity="</span>+l+<span class="string">")\n"</span>);a.style.filter=e;e=<span class="keyword">new</span> OpenLayers.Geometry.Point(-b,-c);h=(<span class="keyword">new</span> OpenLayers.Bounds(<span class="number">0</span>,<span class="number">0</span>,h,k)).toGeometry();h.rotate(d.rotation,e);h=h.getBounds();a.style.left=<span class="built_in">Math</span>.round(<span class="built_in">parseInt</span>(a.style.left)+h.left)+<span class="string">"px"</span>;a.style.top=<span class="built_in">Math</span>.round(<span class="built_in">parseInt</span>(a.style.top)-</span><br><span class="line">h.bottom)+<span class="string">"px"</span>&#125;<span class="keyword">else</span>&#123;<span class="keyword">var</span> m=<span class="keyword">new</span> Image;m.onreadystatechange=OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="string">"complete"</span>==m.readyState||<span class="string">"interactive"</span>==m.readyState)f=m.width/m.height,g=<span class="built_in">Math</span>.max(<span class="number">2</span>*d.pointRadius,d.graphicWidth||<span class="number">0</span>,d.graphicHeight||<span class="number">0</span>),b*=f,d.graphicWidth=g*f,d.graphicHeight=g,<span class="keyword">this</span>.graphicRotate(a,b,c,d)&#125;,<span class="keyword">this</span>);m.src=d.externalGraphic&#125;&#125;,<span class="attr">postDraw</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.style.visibility=<span class="string">"visible"</span>;<span class="keyword">var</span> b=a._style.fillColor,c=a._style.strokeColor;<span class="string">"none"</span>==b&amp;&amp;a.fillcolor!=b&amp;&amp;(a.fillcolor=b);<span class="string">"none"</span>==c&amp;&amp;a.strokecolor!=</span><br><span class="line">c&amp;&amp;(a.strokecolor=c)&#125;,<span class="attr">setNodeDimension</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=b.getBounds();<span class="keyword">if</span>(c)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.getResolution(),c=<span class="keyword">new</span> OpenLayers.Bounds((c.left-<span class="keyword">this</span>.featureDx)/d-<span class="keyword">this</span>.offset.x|<span class="number">0</span>,c.bottom/d-<span class="keyword">this</span>.offset.y|<span class="number">0</span>,(c.right-<span class="keyword">this</span>.featureDx)/d-<span class="keyword">this</span>.offset.x|<span class="number">0</span>,c.top/d-<span class="keyword">this</span>.offset.y|<span class="number">0</span>);a.style.left=c.left+<span class="string">"px"</span>;a.style.top=c.top+<span class="string">"px"</span>;a.style.width=c.getWidth()+<span class="string">"px"</span>;a.style.height=c.getHeight()+<span class="string">"px"</span>;a.coordorigin=c.left+<span class="string">" "</span>+c.top;a.coordsize=c.getWidth()+<span class="string">" "</span>+c.getHeight()&#125;&#125;,<span class="attr">dashStyle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.strokeDashstyle;<span class="keyword">switch</span>(a)&#123;<span class="keyword">case</span> <span class="string">"solid"</span>:<span class="keyword">case</span> <span class="string">"dot"</span>:<span class="keyword">case</span> <span class="string">"dash"</span>:<span class="keyword">case</span> <span class="string">"dashdot"</span>:<span class="keyword">case</span> <span class="string">"longdash"</span>:<span class="keyword">case</span> <span class="string">"longdashdot"</span>:<span class="keyword">return</span> a;</span><br><span class="line"><span class="keyword">default</span>:<span class="keyword">return</span> a=a.split(<span class="regexp">/[ ,]/</span>),<span class="number">2</span>==a.length?<span class="number">1</span>*a[<span class="number">0</span>]&gt;=<span class="number">2</span>*a[<span class="number">1</span>]?<span class="string">"longdash"</span>:<span class="number">1</span>==a[<span class="number">0</span>]||<span class="number">1</span>==a[<span class="number">1</span>]?<span class="string">"dot"</span>:<span class="string">"dash"</span>:<span class="number">4</span>==a.length?<span class="number">1</span>*a[<span class="number">0</span>]&gt;=<span class="number">2</span>*a[<span class="number">1</span>]?<span class="string">"longdashdot"</span>:<span class="string">"dashdot"</span>:<span class="string">"solid"</span>&#125;&#125;,<span class="attr">createNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="built_in">document</span>.createElement(a);b&amp;&amp;(c.id=b);c.unselectable=<span class="string">"on"</span>;c.onselectstart=OpenLayers.Function.False;<span class="keyword">return</span> c&#125;,<span class="attr">nodeTypeCompare</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=b,d=c.indexOf(<span class="string">":"</span>);<span class="number">-1</span>!=d&amp;&amp;(c=c.substr(d+<span class="number">1</span>));<span class="keyword">var</span> e=a.nodeName,d=e.indexOf(<span class="string">":"</span>);<span class="number">-1</span>!=d&amp;&amp;(e=e.substr(d+<span class="number">1</span>));<span class="keyword">return</span> c==e&#125;,<span class="attr">createRenderRoot</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.nodeFactory(<span class="keyword">this</span>.container.id+</span><br><span class="line"><span class="string">"_vmlRoot"</span>,<span class="string">"div"</span>)&#125;,<span class="attr">createRoot</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.nodeFactory(<span class="keyword">this</span>.container.id+a,<span class="string">"olv:group"</span>)&#125;,<span class="attr">drawPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.drawCircle(a,b,<span class="number">1</span>)&#125;,<span class="attr">drawCircle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">if</span>(!<span class="built_in">isNaN</span>(b.x)&amp;&amp;!<span class="built_in">isNaN</span>(b.y))&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.getResolution();a.style.left=((b.x-<span class="keyword">this</span>.featureDx)/d-<span class="keyword">this</span>.offset.x|<span class="number">0</span>)-c+<span class="string">"px"</span>;a.style.top=(b.y/d-<span class="keyword">this</span>.offset.y|<span class="number">0</span>)-c+<span class="string">"px"</span>;b=<span class="number">2</span>*c;a.style.width=b+<span class="string">"px"</span>;a.style.height=b+<span class="string">"px"</span>;<span class="keyword">return</span> a&#125;<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">drawLineString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.drawLine(a,b,!<span class="number">1</span>)&#125;,<span class="attr">drawLinearRing</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.drawLine(a,</span><br><span class="line">b,!<span class="number">0</span>)&#125;,<span class="attr">drawLine</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">this</span>.setNodeDimension(a,b);<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="keyword">this</span>.getResolution(),e=b.components.length,f=<span class="built_in">Array</span>(e),g,h,k=<span class="number">0</span>;k&lt;e;k++)g=b.components[k],h=(g.x-<span class="keyword">this</span>.featureDx)/d-<span class="keyword">this</span>.offset.x|<span class="number">0</span>,g=g.y/d-<span class="keyword">this</span>.offset.y|<span class="number">0</span>,f[k]=<span class="string">" "</span>+h+<span class="string">","</span>+g+<span class="string">" l "</span>;b=c?<span class="string">" x e"</span>:<span class="string">" e"</span>;a.path=<span class="string">"m"</span>+f.join(<span class="string">""</span>)+b;<span class="keyword">return</span> a&#125;,<span class="attr">drawPolygon</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.setNodeDimension(a,b);<span class="keyword">var</span> c=<span class="keyword">this</span>.getResolution(),d=[],e,f,g,h,k,l,m,n,p,q;e=<span class="number">0</span>;<span class="keyword">for</span>(f=b.components.length;e&lt;f;e++)&#123;d.push(<span class="string">"m"</span>);g=b.components[e].components;h=<span class="number">0</span>===e;l=k=<span class="literal">null</span>;m=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(n=g.length;m&lt;n;m++)p=g[m],q=(p.x-<span class="keyword">this</span>.featureDx)/c-<span class="keyword">this</span>.offset.x|<span class="number">0</span>,p=p.y/c-<span class="keyword">this</span>.offset.y|<span class="number">0</span>,q=<span class="string">" "</span>+q+<span class="string">","</span>+p,d.push(q),<span class="number">0</span>==m&amp;&amp;d.push(<span class="string">" l"</span>),h||(k?k!=q&amp;&amp;(l?l!=q&amp;&amp;(h=!<span class="number">0</span>):l=q):k=q);d.push(h?<span class="string">" x "</span>:<span class="string">" "</span>)&#125;d.push(<span class="string">"e"</span>);a.path=d.join(<span class="string">""</span>);<span class="keyword">return</span> a&#125;,<span class="attr">drawRectangle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getResolution();a.style.left=((b.x-<span class="keyword">this</span>.featureDx)/c-<span class="keyword">this</span>.offset.x|<span class="number">0</span>)+<span class="string">"px"</span>;a.style.top=(b.y/c-<span class="keyword">this</span>.offset.y|<span class="number">0</span>)+<span class="string">"px"</span>;a.style.width=(b.width/c|<span class="number">0</span>)+<span class="string">"px"</span>;a.style.height=(b.height/c|<span class="number">0</span>)+<span class="string">"px"</span>;<span class="keyword">return</span> a&#125;,<span class="attr">drawText</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.nodeFactory(a+</span><br><span class="line"><span class="keyword">this</span>.LABEL_ID_SUFFIX,<span class="string">"olv:rect"</span>),e=<span class="keyword">this</span>.nodeFactory(a+<span class="keyword">this</span>.LABEL_ID_SUFFIX+<span class="string">"_textbox"</span>,<span class="string">"olv:textbox"</span>),f=<span class="keyword">this</span>.getResolution();d.style.left=((c.x-<span class="keyword">this</span>.featureDx)/f-<span class="keyword">this</span>.offset.x|<span class="number">0</span>)+<span class="string">"px"</span>;d.style.top=(c.y/f-<span class="keyword">this</span>.offset.y|<span class="number">0</span>)+<span class="string">"px"</span>;d.style.flip=<span class="string">"y"</span>;e.innerText=b.label;<span class="string">"inherit"</span>!=b.cursor&amp;&amp;<span class="literal">null</span>!=b.cursor&amp;&amp;(e.style.cursor=b.cursor);b.fontColor&amp;&amp;(e.style.color=b.fontColor);b.fontOpacity&amp;&amp;(e.style.filter=<span class="string">"alpha(opacity="</span>+<span class="number">100</span>*b.fontOpacity+<span class="string">")"</span>);b.fontFamily&amp;&amp;(e.style.fontFamily=b.fontFamily);b.fontSize&amp;&amp;(e.style.fontSize=</span><br><span class="line">b.fontSize);b.fontWeight&amp;&amp;(e.style.fontWeight=b.fontWeight);b.fontStyle&amp;&amp;(e.style.fontStyle=b.fontStyle);!<span class="number">0</span>===b.labelSelect&amp;&amp;(d._featureId=a,e._featureId=a,e._geometry=c,e._geometryClass=c.CLASS_NAME);e.style.whiteSpace=<span class="string">"nowrap"</span>;e.inset=<span class="string">"1px,0px,0px,0px"</span>;d.parentNode||(d.appendChild(e),<span class="keyword">this</span>.textRoot.appendChild(d));b=b.labelAlign||<span class="string">"cm"</span>;<span class="number">1</span>==b.length&amp;&amp;(b+=<span class="string">"m"</span>);a=e.clientWidth*OpenLayers.Renderer.VML.LABEL_SHIFT[b.substr(<span class="number">0</span>,<span class="number">1</span>)];e=e.clientHeight*OpenLayers.Renderer.VML.LABEL_SHIFT[b.substr(<span class="number">1</span>,<span class="number">1</span>)];d.style.left=</span><br><span class="line"><span class="built_in">parseInt</span>(d.style.left)-a<span class="number">-1</span>+<span class="string">"px"</span>;d.style.top=<span class="built_in">parseInt</span>(d.style.top)+e+<span class="string">"px"</span>&#125;,<span class="attr">moveRoot</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getLayer(a.container.id);b <span class="keyword">instanceof</span> OpenLayers.Layer.Vector.RootContainer&amp;&amp;(b=<span class="keyword">this</span>.map.getLayer(<span class="keyword">this</span>.container.id));b&amp;&amp;b.renderer.clear();OpenLayers.Renderer.Elements.prototype.moveRoot.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);b&amp;&amp;b.redraw()&#125;,<span class="attr">importSymbol</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.container.id+<span class="string">"-"</span>+a,c=<span class="keyword">this</span>.symbolCache[b];<span class="keyword">if</span>(c)<span class="keyword">return</span> c;c=OpenLayers.Renderer.symbol[a];<span class="keyword">if</span>(!c)<span class="keyword">throw</span> <span class="built_in">Error</span>(a+<span class="string">" is not a valid symbol name"</span>);</span><br><span class="line">a=<span class="keyword">new</span> OpenLayers.Bounds(<span class="built_in">Number</span>.MAX_VALUE,<span class="built_in">Number</span>.MAX_VALUE,<span class="number">0</span>,<span class="number">0</span>);<span class="keyword">for</span>(<span class="keyword">var</span> d=[<span class="string">"m"</span>],e=<span class="number">0</span>;e&lt;c.length;e+=<span class="number">2</span>)&#123;<span class="keyword">var</span> f=c[e],g=c[e+<span class="number">1</span>];a.left=<span class="built_in">Math</span>.min(a.left,f);a.bottom=<span class="built_in">Math</span>.min(a.bottom,g);a.right=<span class="built_in">Math</span>.max(a.right,f);a.top=<span class="built_in">Math</span>.max(a.top,g);d.push(f);d.push(g);<span class="number">0</span>==e&amp;&amp;d.push(<span class="string">"l"</span>)&#125;d.push(<span class="string">"x e"</span>);c=d.join(<span class="string">" "</span>);d=(a.getWidth()-a.getHeight())/<span class="number">2</span>;<span class="number">0</span>&lt;d?(a.bottom-=d,a.top+=d):(a.left+=d,a.right-=d);c=&#123;<span class="attr">path</span>:c,<span class="attr">size</span>:a.getWidth(),<span class="attr">left</span>:a.left,<span class="attr">bottom</span>:a.bottom&#125;;<span class="keyword">return</span> <span class="keyword">this</span>.symbolCache[b]=c&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Renderer.VML"</span>&#125;);</span><br><span class="line">OpenLayers.Renderer.VML.LABEL_SHIFT=&#123;<span class="attr">l</span>:<span class="number">0</span>,<span class="attr">c</span>:<span class="number">0.5</span>,<span class="attr">r</span>:<span class="number">1</span>,<span class="attr">t</span>:<span class="number">0</span>,<span class="attr">m</span>:<span class="number">0.5</span>,<span class="attr">b</span>:<span class="number">1</span>&#125;;OpenLayers.Control.CacheRead=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">fetchEvent</span>:<span class="string">"tileloadstart"</span>,<span class="attr">layers</span>:<span class="literal">null</span>,<span class="attr">autoActivate</span>:!<span class="number">0</span>,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">var</span> b,c=<span class="keyword">this</span>.layers||a.layers;<span class="keyword">for</span>(b=c.length<span class="number">-1</span>;<span class="number">0</span>&lt;=b;--b)<span class="keyword">this</span>.addLayer(&#123;<span class="attr">layer</span>:c[b]&#125;);<span class="keyword">if</span>(!<span class="keyword">this</span>.layers)a.events.on(&#123;<span class="attr">addlayer</span>:<span class="keyword">this</span>.addLayer,<span class="attr">removeLayer</span>:<span class="keyword">this</span>.removeLayer,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;,<span class="attr">addLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.layer.events.register(<span class="keyword">this</span>.fetchEvent,<span class="keyword">this</span>,<span class="keyword">this</span>.fetch)&#125;,<span class="attr">removeLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.layer.events.unregister(<span class="keyword">this</span>.fetchEvent,</span><br><span class="line"><span class="keyword">this</span>,<span class="keyword">this</span>.fetch)&#125;,<span class="attr">fetch</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.active&amp;&amp;<span class="built_in">window</span>.localStorage&amp;&amp;a.tile <span class="keyword">instanceof</span> OpenLayers.Tile.Image)&#123;<span class="keyword">var</span> b=a.tile,c=b.url;!b.layer.crossOriginKeyword&amp;&amp;(OpenLayers.ProxyHost&amp;&amp;<span class="number">0</span>===c.indexOf(OpenLayers.ProxyHost))&amp;&amp;(c=OpenLayers.Control.CacheWrite.urlMap[c]);<span class="keyword">if</span>(c=<span class="built_in">window</span>.localStorage.getItem(<span class="string">"olCache_"</span>+c))b.url=c,<span class="string">"tileerror"</span>===a.type&amp;&amp;b.setImgSrc(c)&#125;&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.layers||<span class="keyword">this</span>.map)&#123;<span class="keyword">var</span> a,b=<span class="keyword">this</span>.layers||<span class="keyword">this</span>.map.layers;<span class="keyword">for</span>(a=b.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;--a)<span class="keyword">this</span>.removeLayer(&#123;<span class="attr">layer</span>:b[a]&#125;)&#125;<span class="keyword">this</span>.map&amp;&amp;</span><br><span class="line"><span class="keyword">this</span>.map.events.un(&#123;<span class="attr">addlayer</span>:<span class="keyword">this</span>.addLayer,<span class="attr">removeLayer</span>:<span class="keyword">this</span>.removeLayer,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.CacheRead"</span>&#125;);OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,&#123;<span class="attr">version</span>:<span class="string">"1.0.0"</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Protocol.WFS.v1_0_0"</span>&#125;);OpenLayers.Format.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">layerIdentifier</span>:<span class="string">"_layer"</span>,<span class="attr">featureIdentifier</span>:<span class="string">"_feature"</span>,<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">gmlFormat</span>:<span class="literal">null</span>,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));<span class="keyword">var</span> b=a.documentElement;<span class="keyword">if</span>(b)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>[<span class="string">"read_"</span>+b.nodeName];a=c?c.call(<span class="keyword">this</span>,b):(<span class="keyword">new</span> OpenLayers.Format.GML(<span class="keyword">this</span>.options?<span class="keyword">this</span>.options:&#123;&#125;)).read(a)&#125;<span class="keyword">return</span> a&#125;,<span class="attr">read_msGMLOutput</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line">[];<span class="keyword">if</span>(a=<span class="keyword">this</span>.getSiblingNodesByTagCriteria(a,<span class="keyword">this</span>.layerIdentifier))<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;++c)&#123;<span class="keyword">var</span> e=a[c],f=e.nodeName;e.prefix&amp;&amp;(f=f.split(<span class="string">":"</span>)[<span class="number">1</span>]);f=f.replace(<span class="keyword">this</span>.layerIdentifier,<span class="string">""</span>);<span class="keyword">if</span>(e=<span class="keyword">this</span>.getSiblingNodesByTagCriteria(e,<span class="keyword">this</span>.featureIdentifier))<span class="keyword">for</span>(<span class="keyword">var</span> g=<span class="number">0</span>;g&lt;e.length;g++)&#123;<span class="keyword">var</span> h=e[g],k=<span class="keyword">this</span>.parseGeometry(h),h=<span class="keyword">this</span>.parseAttributes(h),h=<span class="keyword">new</span> OpenLayers.Feature.Vector(k.geometry,h,<span class="literal">null</span>);h.bounds=k.bounds;h.type=f;b.push(h)&#125;&#125;<span class="keyword">return</span> b&#125;,<span class="attr">read_FeatureInfoResponse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=[];a=<span class="keyword">this</span>.getElementsByTagNameNS(a,</span><br><span class="line"><span class="string">"*"</span>,<span class="string">"FIELDS"</span>);<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;c++)&#123;<span class="keyword">var</span> e=a[c],f=&#123;&#125;,g,h=e.attributes.length;<span class="keyword">if</span>(<span class="number">0</span>&lt;h)<span class="keyword">for</span>(g=<span class="number">0</span>;g&lt;h;g++)&#123;<span class="keyword">var</span> k=e.attributes[g];f[k.nodeName]=k.nodeValue&#125;<span class="keyword">else</span> <span class="keyword">for</span>(e=e.childNodes,g=<span class="number">0</span>,h=e.length;g&lt;h;++g)k=e[g],<span class="number">3</span>!=k.nodeType&amp;&amp;(f[k.getAttribute(<span class="string">"name"</span>)]=k.getAttribute(<span class="string">"value"</span>));b.push(<span class="keyword">new</span> OpenLayers.Feature.Vector(<span class="literal">null</span>,f,<span class="literal">null</span>))&#125;<span class="keyword">return</span> b&#125;,<span class="attr">getSiblingNodesByTagCriteria</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=[],d,e,f,g;<span class="keyword">if</span>(a&amp;&amp;a.hasChildNodes())&#123;d=a.childNodes;f=d.length;<span class="keyword">for</span>(<span class="keyword">var</span> h=<span class="number">0</span>;h&lt;f;h++)&#123;<span class="keyword">for</span>(g=d[h];g&amp;&amp;<span class="number">1</span>!=g.nodeType;)g=</span><br><span class="line">g.nextSibling,h++;e=g?g.nodeName:<span class="string">""</span>;<span class="number">0</span>&lt;e.length&amp;&amp;<span class="number">-1</span>&lt;e.indexOf(b)?c.push(g):(e=<span class="keyword">this</span>.getSiblingNodesByTagCriteria(g,b),<span class="number">0</span>&lt;e.length&amp;&amp;(<span class="number">0</span>==c.length?c=e:c.push(e)))&#125;&#125;<span class="keyword">return</span> c&#125;,<span class="attr">parseAttributes</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;&#125;;<span class="keyword">if</span>(<span class="number">1</span>==a.nodeType)&#123;a=a.childNodes;<span class="keyword">for</span>(<span class="keyword">var</span> c=a.length,d=<span class="number">0</span>;d&lt;c;++d)&#123;<span class="keyword">var</span> e=a[d];<span class="keyword">if</span>(<span class="number">1</span>==e.nodeType)&#123;<span class="keyword">var</span> f=e.childNodes,e=e.prefix?e.nodeName.split(<span class="string">":"</span>)[<span class="number">1</span>]:e.nodeName;<span class="number">0</span>==f.length?b[e]=<span class="literal">null</span>:<span class="number">1</span>==f.length&amp;&amp;(f=f[<span class="number">0</span>],<span class="number">3</span>==f.nodeType||<span class="number">4</span>==f.nodeType)&amp;&amp;(f=f.nodeValue.replace(<span class="keyword">this</span>.regExes.trimSpace,<span class="string">""</span>),b[e]=f)&#125;&#125;&#125;<span class="keyword">return</span> b&#125;,</span><br><span class="line">parseGeometry:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.gmlFormat||(<span class="keyword">this</span>.gmlFormat=<span class="keyword">new</span> OpenLayers.Format.GML);a=<span class="keyword">this</span>.gmlFormat.parseFeature(a);<span class="keyword">var</span> b,c=<span class="literal">null</span>;a&amp;&amp;(b=a.geometry&amp;&amp;a.geometry.clone(),c=a.bounds&amp;&amp;a.bounds.clone(),a.destroy());<span class="keyword">return</span>&#123;<span class="attr">geometry</span>:b,<span class="attr">bounds</span>:c&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMSGetFeatureInfo"</span>&#125;);OpenLayers.Control.WMTSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">hover</span>:!<span class="number">1</span>,<span class="attr">requestEncoding</span>:<span class="string">"KVP"</span>,<span class="attr">drillDown</span>:!<span class="number">1</span>,<span class="attr">maxFeatures</span>:<span class="number">10</span>,<span class="attr">clickCallback</span>:<span class="string">"click"</span>,<span class="attr">layers</span>:<span class="literal">null</span>,<span class="attr">queryVisible</span>:!<span class="number">0</span>,<span class="attr">infoFormat</span>:<span class="string">"text/html"</span>,<span class="attr">vendorParams</span>:&#123;&#125;,<span class="attr">format</span>:<span class="literal">null</span>,<span class="attr">formatOptions</span>:<span class="literal">null</span>,<span class="attr">handler</span>:<span class="literal">null</span>,<span class="attr">hoverRequest</span>:<span class="literal">null</span>,<span class="attr">pending</span>:<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||&#123;&#125;;a.handlerOptions=a.handlerOptions||&#123;&#125;;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.format||(<span class="keyword">this</span>.format=<span class="keyword">new</span> OpenLayers.Format.WMSGetFeatureInfo(a.formatOptions));</span><br><span class="line">!<span class="number">0</span>===<span class="keyword">this</span>.drillDown&amp;&amp;(<span class="keyword">this</span>.hover=!<span class="number">1</span>);<span class="keyword">this</span>.hover?<span class="keyword">this</span>.handler=<span class="keyword">new</span> OpenLayers.Handler.Hover(<span class="keyword">this</span>,&#123;<span class="attr">move</span>:<span class="keyword">this</span>.cancelHover,<span class="attr">pause</span>:<span class="keyword">this</span>.getInfoForHover&#125;,OpenLayers.Util.extend(<span class="keyword">this</span>.handlerOptions.hover||&#123;&#125;,&#123;<span class="attr">delay</span>:<span class="number">250</span>&#125;)):(a=&#123;&#125;,a[<span class="keyword">this</span>.clickCallback]=<span class="keyword">this</span>.getInfoForClick,<span class="keyword">this</span>.handler=<span class="keyword">new</span> OpenLayers.Handler.Click(<span class="keyword">this</span>,a,<span class="keyword">this</span>.handlerOptions.click||&#123;&#125;))&#125;,<span class="attr">getInfoForClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.request(a.xy,&#123;&#125;)&#125;,<span class="attr">getInfoForHover</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.request(a.xy,&#123;<span class="attr">hover</span>:!<span class="number">0</span>&#125;)&#125;,<span class="attr">cancelHover</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.hoverRequest&amp;&amp;(--<span class="keyword">this</span>.pending,</span><br><span class="line"><span class="number">0</span>&gt;=<span class="keyword">this</span>.pending&amp;&amp;(OpenLayers.Element.removeClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olCursorWait"</span>),<span class="keyword">this</span>.pending=<span class="number">0</span>),<span class="keyword">this</span>.hoverRequest.abort(),<span class="keyword">this</span>.hoverRequest=<span class="literal">null</span>)&#125;,<span class="attr">findLayers</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.layers||<span class="keyword">this</span>.map.layers,b=[],c,d=a.length<span class="number">-1</span>;<span class="number">0</span>&lt;=d&amp;&amp;(c=a[d],!(c <span class="keyword">instanceof</span> OpenLayers.Layer.WMTS)||(c.requestEncoding!==<span class="keyword">this</span>.requestEncoding||<span class="keyword">this</span>.queryVisible&amp;&amp;!c.getVisibility())||(b.push(c),<span class="keyword">this</span>.drillDown&amp;&amp;!<span class="keyword">this</span>.hover));--d);<span class="keyword">return</span> b&#125;,<span class="attr">buildRequestOptions</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.map.getLonLatFromPixel(b),d=a.getURL(<span class="keyword">new</span> OpenLayers.Bounds(c.lon,</span><br><span class="line">c.lat,c.lon,c.lat)),d=OpenLayers.Util.getParameters(d),c=a.getTileInfo(c);OpenLayers.Util.extend(d,&#123;<span class="attr">service</span>:<span class="string">"WMTS"</span>,<span class="attr">version</span>:a.version,<span class="attr">request</span>:<span class="string">"GetFeatureInfo"</span>,<span class="attr">infoFormat</span>:<span class="keyword">this</span>.infoFormat,<span class="attr">i</span>:c.i,<span class="attr">j</span>:c.j&#125;);OpenLayers.Util.applyDefaults(d,<span class="keyword">this</span>.vendorParams);<span class="keyword">return</span>&#123;<span class="attr">url</span>:OpenLayers.Util.isArray(a.url)?a.url[<span class="number">0</span>]:a.url,<span class="attr">params</span>:OpenLayers.Util.upperCaseObject(d),<span class="attr">callback</span>:<span class="function"><span class="keyword">function</span>(<span class="params">c</span>)</span>&#123;<span class="keyword">this</span>.handleResponse(b,c,a)&#125;,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;&#125;,<span class="attr">request</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b=b||&#123;&#125;;<span class="keyword">var</span> c=<span class="keyword">this</span>.findLayers();<span class="keyword">if</span>(<span class="number">0</span>&lt;c.length)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d,e,f=<span class="number">0</span>,g=c.length;f&lt;</span><br><span class="line">g;f++)e=c[f],d=<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforegetfeatureinfo"</span>,&#123;<span class="attr">xy</span>:a,<span class="attr">layer</span>:e&#125;),!<span class="number">1</span>!==d&amp;&amp;(++<span class="keyword">this</span>.pending,d=<span class="keyword">this</span>.buildRequestOptions(e,a),d=OpenLayers.Request.GET(d),!<span class="number">0</span>===b.hover&amp;&amp;(<span class="keyword">this</span>.hoverRequest=d));<span class="number">0</span>&lt;<span class="keyword">this</span>.pending&amp;&amp;OpenLayers.Element.addClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olCursorWait"</span>)&#125;&#125;,<span class="attr">handleResponse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;--<span class="keyword">this</span>.pending;<span class="number">0</span>&gt;=<span class="keyword">this</span>.pending&amp;&amp;(OpenLayers.Element.removeClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olCursorWait"</span>),<span class="keyword">this</span>.pending=<span class="number">0</span>);<span class="keyword">if</span>(b.status&amp;&amp;(<span class="number">200</span>&gt;b.status||<span class="number">300</span>&lt;=b.status))<span class="keyword">this</span>.events.triggerEvent(<span class="string">"exception"</span>,</span><br><span class="line">&#123;<span class="attr">xy</span>:a,<span class="attr">request</span>:b,<span class="attr">layer</span>:c&#125;);<span class="keyword">else</span>&#123;<span class="keyword">var</span> d=b.responseXML;d&amp;&amp;d.documentElement||(d=b.responseText);<span class="keyword">var</span> e,f;<span class="keyword">try</span>&#123;e=<span class="keyword">this</span>.format.read(d)&#125;<span class="keyword">catch</span>(g)&#123;f=!<span class="number">0</span>,<span class="keyword">this</span>.events.triggerEvent(<span class="string">"exception"</span>,&#123;<span class="attr">xy</span>:a,<span class="attr">request</span>:b,<span class="attr">error</span>:g,<span class="attr">layer</span>:c&#125;)&#125;f||<span class="keyword">this</span>.events.triggerEvent(<span class="string">"getfeatureinfo"</span>,&#123;<span class="attr">text</span>:b.responseText,<span class="attr">features</span>:e,<span class="attr">request</span>:b,<span class="attr">xy</span>:a,<span class="attr">layer</span>:c&#125;)&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.WMTSGetFeatureInfo"</span>&#125;);OpenLayers.Protocol.CSW.v2_0_2=OpenLayers.Class(OpenLayers.Protocol,&#123;<span class="attr">formatOptions</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Protocol.prototype.initialize.apply(<span class="keyword">this</span>,[a]);a.format||(<span class="keyword">this</span>.format=<span class="keyword">new</span> OpenLayers.Format.CSWGetRecords.v2_0_2(OpenLayers.Util.extend(&#123;&#125;,<span class="keyword">this</span>.formatOptions)))&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.options&amp;&amp;!<span class="keyword">this</span>.options.format&amp;&amp;<span class="keyword">this</span>.format.destroy();<span class="keyword">this</span>.format=<span class="literal">null</span>;OpenLayers.Protocol.prototype.destroy.apply(<span class="keyword">this</span>)&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.extend(&#123;&#125;,a);OpenLayers.Util.applyDefaults(a,</span><br><span class="line"><span class="keyword">this</span>.options||&#123;&#125;);<span class="keyword">var</span> b=<span class="keyword">new</span> OpenLayers.Protocol.Response(&#123;<span class="attr">requestType</span>:<span class="string">"read"</span>&#125;),c=<span class="keyword">this</span>.format.write(a.params||a);b.priv=OpenLayers.Request.POST(&#123;<span class="attr">url</span>:a.url,<span class="attr">callback</span>:<span class="keyword">this</span>.createCallback(<span class="keyword">this</span>.handleRead,b,a),<span class="attr">params</span>:a.params,<span class="attr">headers</span>:a.headers,<span class="attr">data</span>:c&#125;);<span class="keyword">return</span> b&#125;,<span class="attr">handleRead</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(b.callback)&#123;<span class="keyword">var</span> c=a.priv;<span class="number">200</span>&lt;=c.status&amp;&amp;<span class="number">300</span>&gt;c.status?(a.data=<span class="keyword">this</span>.parseData(c),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE;b.callback.call(b.scope,a)&#125;&#125;,<span class="attr">parseData</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line">a.responseXML;b&amp;&amp;b.documentElement||(b=a.responseText);<span class="keyword">return</span>!b||<span class="number">0</span>&gt;=b.length?<span class="literal">null</span>:<span class="keyword">this</span>.format.read(b)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Protocol.CSW.v2_0_2"</span>&#125;);OpenLayers.Format.WCSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WCSCapabilities.v1,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">wcs</span>:<span class="string">"http://www.opengis.net/wcs/1.1"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>,<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows/1.1"</span>&#125;,<span class="attr">errorProperty</span>:<span class="string">"operationsMetadata"</span>,<span class="attr">readers</span>:&#123;<span class="attr">wcs</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">Capabilities</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Contents</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.contentMetadata=[];<span class="keyword">this</span>.readChildNodes(a,b.contentMetadata)&#125;,<span class="attr">CoverageSummary</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.push(c)&#125;,<span class="attr">Identifier</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.identifier=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Title</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.title=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Abstract</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b[<span class="string">"abstract"</span>]=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">SupportedCRS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);c&amp;&amp;(b.supportedCRS||(b.supportedCRS=[]),b.supportedCRS.push(c))&#125;,<span class="attr">SupportedFormat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a);c&amp;&amp;(b.supportedFormat||(b.supportedFormat=[]),b.supportedFormat.push(c))&#125;&#125;,OpenLayers.Format.WCSCapabilities.v1.prototype.readers.wcs),</span><br><span class="line">ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WCSCapabilities.v1_1_0"</span>&#125;);OpenLayers.Control.Graticule=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">autoActivate</span>:!<span class="number">0</span>,<span class="attr">intervals</span>:[<span class="number">45</span>,<span class="number">30</span>,<span class="number">20</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0.5</span>,<span class="number">0.2</span>,<span class="number">0.1</span>,<span class="number">0.05</span>,<span class="number">0.01</span>,<span class="number">0.005</span>,<span class="number">0.002</span>,<span class="number">0.001</span>],<span class="attr">displayInLayerSwitcher</span>:!<span class="number">0</span>,<span class="attr">visible</span>:!<span class="number">0</span>,<span class="attr">numPoints</span>:<span class="number">50</span>,<span class="attr">targetSize</span>:<span class="number">200</span>,<span class="attr">layerName</span>:<span class="literal">null</span>,<span class="attr">labelled</span>:!<span class="number">0</span>,<span class="attr">labelFormat</span>:<span class="string">"dm"</span>,<span class="attr">lineSymbolizer</span>:&#123;<span class="attr">strokeColor</span>:<span class="string">"#333"</span>,<span class="attr">strokeWidth</span>:<span class="number">1</span>,<span class="attr">strokeOpacity</span>:<span class="number">0.5</span>&#125;,<span class="attr">labelSymbolizer</span>:&#123;&#125;,<span class="attr">gratLayer</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||&#123;&#125;;a.layerName=a.layerName||OpenLayers.i18n(<span class="string">"Graticule"</span>);OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[a]);</span><br><span class="line"><span class="keyword">this</span>.labelSymbolizer.stroke=!<span class="number">1</span>;<span class="keyword">this</span>.labelSymbolizer.fill=!<span class="number">1</span>;<span class="keyword">this</span>.labelSymbolizer.label=<span class="string">"$&#123;label&#125;"</span>;<span class="keyword">this</span>.labelSymbolizer.labelAlign=<span class="string">"$&#123;labelAlign&#125;"</span>;<span class="keyword">this</span>.labelSymbolizer.labelXOffset=<span class="string">"$&#123;xOffset&#125;"</span>;<span class="keyword">this</span>.labelSymbolizer.labelYOffset=<span class="string">"$&#123;yOffset&#125;"</span>&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.deactivate();OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.gratLayer&amp;&amp;(<span class="keyword">this</span>.gratLayer.destroy(),<span class="keyword">this</span>.gratLayer=<span class="literal">null</span>)&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Control.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">if</span>(!<span class="keyword">this</span>.gratLayer)&#123;<span class="keyword">var</span> a=<span class="keyword">new</span> OpenLayers.Style(&#123;&#125;,</span><br><span class="line">&#123;<span class="attr">rules</span>:[<span class="keyword">new</span> OpenLayers.Rule(&#123;<span class="attr">symbolizer</span>:&#123;<span class="attr">Point</span>:<span class="keyword">this</span>.labelSymbolizer,<span class="attr">Line</span>:<span class="keyword">this</span>.lineSymbolizer&#125;&#125;)]&#125;);<span class="keyword">this</span>.gratLayer=<span class="keyword">new</span> OpenLayers.Layer.Vector(<span class="keyword">this</span>.layerName,&#123;<span class="attr">styleMap</span>:<span class="keyword">new</span> OpenLayers.StyleMap(&#123;<span class="string">"default"</span>:a&#125;),<span class="attr">visibility</span>:<span class="keyword">this</span>.visible,<span class="attr">displayInLayerSwitcher</span>:<span class="keyword">this</span>.displayInLayerSwitcher&#125;)&#125;<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Control.prototype.activate.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)?(<span class="keyword">this</span>.map.addLayer(<span class="keyword">this</span>.gratLayer),<span class="keyword">this</span>.map.events.register(<span class="string">"moveend"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.update),<span class="keyword">this</span>.update(),!<span class="number">0</span>):!<span class="number">1</span>&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> OpenLayers.Control.prototype.deactivate.apply(<span class="keyword">this</span>,</span><br><span class="line"><span class="built_in">arguments</span>)?(<span class="keyword">this</span>.map.events.unregister(<span class="string">"moveend"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.update),<span class="keyword">this</span>.map.removeLayer(<span class="keyword">this</span>.gratLayer),!<span class="number">0</span>):!<span class="number">1</span>&#125;,<span class="attr">update</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getExtent();<span class="keyword">if</span>(a)&#123;<span class="keyword">this</span>.gratLayer.destroyFeatures();<span class="keyword">var</span> b=<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:4326"</span>),c=<span class="keyword">this</span>.map.getProjectionObject(),d=<span class="keyword">this</span>.map.getResolution();c.proj&amp;&amp;<span class="string">"longlat"</span>==c.proj.projName&amp;&amp;(<span class="keyword">this</span>.numPoints=<span class="number">1</span>);<span class="keyword">var</span> e=<span class="keyword">this</span>.map.getCenter(),f=<span class="keyword">new</span> OpenLayers.Pixel(e.lon,e.lat);OpenLayers.Projection.transform(f,c,b);<span class="keyword">for</span>(<span class="keyword">var</span> e=<span class="keyword">this</span>.targetSize*d,e=e*e,g,d=<span class="number">0</span>;d&lt;<span class="keyword">this</span>.intervals.length;++d)&#123;g=</span><br><span class="line"><span class="keyword">this</span>.intervals[d];<span class="keyword">var</span> h=g/<span class="number">2</span>,k=f.offset(&#123;<span class="attr">x</span>:-h,<span class="attr">y</span>:-h&#125;),h=f.offset(&#123;<span class="attr">x</span>:h,<span class="attr">y</span>:h&#125;);OpenLayers.Projection.transform(k,b,c);OpenLayers.Projection.transform(h,b,c);<span class="keyword">if</span>((k.x-h.x)*(k.x-h.x)+(k.y-h.y)*(k.y-h.y)&lt;=e)<span class="keyword">break</span>&#125;f.x=<span class="built_in">Math</span>.floor(f.x/g)*g;f.y=<span class="built_in">Math</span>.floor(f.y/g)*g;<span class="keyword">var</span> d=<span class="number">0</span>,e=[f.clone()],h=f.clone(),l;<span class="keyword">do</span> h=h.offset(&#123;<span class="attr">x</span>:<span class="number">0</span>,<span class="attr">y</span>:g&#125;),l=OpenLayers.Projection.transform(h.clone(),b,c),e.unshift(h);<span class="keyword">while</span>(a.containsPixel(l)&amp;&amp;<span class="number">1E3</span>&gt;++d);h=f.clone();<span class="keyword">do</span> h=h.offset(&#123;<span class="attr">x</span>:<span class="number">0</span>,<span class="attr">y</span>:-g&#125;),l=OpenLayers.Projection.transform(h.clone(),b,c),e.push(h);</span><br><span class="line"><span class="keyword">while</span>(a.containsPixel(l)&amp;&amp;<span class="number">1E3</span>&gt;++d);d=<span class="number">0</span>;k=[f.clone()];h=f.clone();<span class="keyword">do</span> h=h.offset(&#123;<span class="attr">x</span>:-g,<span class="attr">y</span>:<span class="number">0</span>&#125;),l=OpenLayers.Projection.transform(h.clone(),b,c),k.unshift(h);<span class="keyword">while</span>(a.containsPixel(l)&amp;&amp;<span class="number">1E3</span>&gt;++d);h=f.clone();<span class="keyword">do</span> h=h.offset(&#123;<span class="attr">x</span>:g,<span class="attr">y</span>:<span class="number">0</span>&#125;),l=OpenLayers.Projection.transform(h.clone(),b,c),k.push(h);<span class="keyword">while</span>(a.containsPixel(l)&amp;&amp;<span class="number">1E3</span>&gt;++d);g=[];<span class="keyword">for</span>(d=<span class="number">0</span>;d&lt;k.length;++d)&#123;l=k[d].x;<span class="keyword">for</span>(<span class="keyword">var</span> f=[],m=<span class="literal">null</span>,n=<span class="built_in">Math</span>.min(e[<span class="number">0</span>].y,<span class="number">90</span>),h=<span class="built_in">Math</span>.max(e[e.length<span class="number">-1</span>].y,<span class="number">-90</span>),p=(n-h)/<span class="keyword">this</span>.numPoints,n=h,h=<span class="number">0</span>;h&lt;=<span class="keyword">this</span>.numPoints;++h)&#123;<span class="keyword">var</span> q=<span class="keyword">new</span> OpenLayers.Geometry.Point(l,</span><br><span class="line">n);q.transform(b,c);f.push(q);n+=p;q.y&gt;=a.bottom&amp;&amp;!m&amp;&amp;(m=q)&#125;<span class="keyword">this</span>.labelled&amp;&amp;(m=<span class="keyword">new</span> OpenLayers.Geometry.Point(m.x,a.bottom),l=&#123;<span class="attr">value</span>:l,<span class="attr">label</span>:<span class="keyword">this</span>.labelled?OpenLayers.Util.getFormattedLonLat(l,<span class="string">"lon"</span>,<span class="keyword">this</span>.labelFormat):<span class="string">""</span>,<span class="attr">labelAlign</span>:<span class="string">"cb"</span>,<span class="attr">xOffset</span>:<span class="number">0</span>,<span class="attr">yOffset</span>:<span class="number">2</span>&#125;,<span class="keyword">this</span>.gratLayer.addFeatures(<span class="keyword">new</span> OpenLayers.Feature.Vector(m,l)));f=<span class="keyword">new</span> OpenLayers.Geometry.LineString(f);g.push(<span class="keyword">new</span> OpenLayers.Feature.Vector(f))&#125;<span class="keyword">for</span>(h=<span class="number">0</span>;h&lt;e.length;++h)<span class="keyword">if</span>(n=e[h].y,!(<span class="number">-90</span>&gt;n||<span class="number">90</span>&lt;n))&#123;f=[];d=k[<span class="number">0</span>].x;p=(k[k.length<span class="number">-1</span>].x-d)/<span class="keyword">this</span>.numPoints;</span><br><span class="line">l=d;m=<span class="literal">null</span>;<span class="keyword">for</span>(d=<span class="number">0</span>;d&lt;=<span class="keyword">this</span>.numPoints;++d)q=<span class="keyword">new</span> OpenLayers.Geometry.Point(l,n),q.transform(b,c),f.push(q),l+=p,q.x&lt;a.right&amp;&amp;(m=q);<span class="keyword">this</span>.labelled&amp;&amp;(m=<span class="keyword">new</span> OpenLayers.Geometry.Point(a.right,m.y),l=&#123;<span class="attr">value</span>:n,<span class="attr">label</span>:<span class="keyword">this</span>.labelled?OpenLayers.Util.getFormattedLonLat(n,<span class="string">"lat"</span>,<span class="keyword">this</span>.labelFormat):<span class="string">""</span>,<span class="attr">labelAlign</span>:<span class="string">"rb"</span>,<span class="attr">xOffset</span>:<span class="number">-2</span>,<span class="attr">yOffset</span>:<span class="number">2</span>&#125;,<span class="keyword">this</span>.gratLayer.addFeatures(<span class="keyword">new</span> OpenLayers.Feature.Vector(m,l)));f=<span class="keyword">new</span> OpenLayers.Geometry.LineString(f);g.push(<span class="keyword">new</span> OpenLayers.Feature.Vector(f))&#125;<span class="keyword">this</span>.gratLayer.addFeatures(g)&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.Graticule"</span>&#125;);OpenLayers.Console.warn(<span class="string">"OpenLayers.Rico is deprecated"</span>);OpenLayers.Rico=OpenLayers.Rico||&#123;&#125;;</span><br><span class="line">OpenLayers.Rico.Corner=&#123;<span class="attr">round</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a=OpenLayers.Util.getElement(a);<span class="keyword">this</span>._setOptions(b);<span class="keyword">var</span> c=<span class="keyword">this</span>.options.color;<span class="string">"fromElement"</span>==<span class="keyword">this</span>.options.color&amp;&amp;(c=<span class="keyword">this</span>._background(a));<span class="keyword">var</span> d=<span class="keyword">this</span>.options.bgColor;<span class="string">"fromParent"</span>==<span class="keyword">this</span>.options.bgColor&amp;&amp;(d=<span class="keyword">this</span>._background(a.offsetParent));<span class="keyword">this</span>._roundCornersImpl(a,c,d)&#125;,<span class="attr">changeColor</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a.style.backgroundColor=b;<span class="keyword">for</span>(<span class="keyword">var</span> c=a.parentNode.getElementsByTagName(<span class="string">"span"</span>),d=<span class="number">0</span>;d&lt;c.length;d++)c[d].style.backgroundColor=b&#125;,<span class="attr">changeOpacity</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="string">"alpha(opacity="</span>+</span><br><span class="line"><span class="number">100</span>*b+<span class="string">")"</span>;a.style.opacity=b;a.style.filter=c;<span class="keyword">for</span>(<span class="keyword">var</span> d=a.parentNode.getElementsByTagName(<span class="string">"span"</span>),e=<span class="number">0</span>;e&lt;d.length;e++)d[e].style.opacity=b,d[e].style.filter=c&#125;,<span class="attr">reRound</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.parentNode.childNodes[<span class="number">2</span>];a.parentNode.removeChild(a.parentNode.childNodes[<span class="number">0</span>]);a.parentNode.removeChild(c);<span class="keyword">this</span>.round(a.parentNode,b)&#125;,<span class="attr">_roundCornersImpl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">this</span>.options.border&amp;&amp;<span class="keyword">this</span>._renderBorder(a,c);<span class="keyword">this</span>._isTopRounded()&amp;&amp;<span class="keyword">this</span>._roundTopCorners(a,b,c);<span class="keyword">this</span>._isBottomRounded()&amp;&amp;<span class="keyword">this</span>._roundBottomCorners(a,</span><br><span class="line">b,c)&#125;,<span class="attr">_renderBorder</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="string">"1px solid "</span>+<span class="keyword">this</span>._borderColor(b);a.innerHTML=<span class="string">"&lt;div "</span>+(<span class="string">"style='border-left: "</span>+c+<span class="string">";"</span>+(<span class="string">"border-right: "</span>+c)+<span class="string">"'"</span>)+<span class="string">"&gt;"</span>+a.innerHTML+<span class="string">"&lt;/div&gt;"</span>&#125;,<span class="attr">_roundTopCorners</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="keyword">this</span>._createCorner(c),e=<span class="number">0</span>;e&lt;<span class="keyword">this</span>.options.numSlices;e++)d.appendChild(<span class="keyword">this</span>._createCornerSlice(b,c,e,<span class="string">"top"</span>));a.style.paddingTop=<span class="number">0</span>;a.insertBefore(d,a.firstChild)&#125;,<span class="attr">_roundBottomCorners</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="keyword">this</span>._createCorner(c),e=<span class="keyword">this</span>.options.numSlices<span class="number">-1</span>;<span class="number">0</span>&lt;=e;e--)d.appendChild(<span class="keyword">this</span>._createCornerSlice(b,</span><br><span class="line">c,e,<span class="string">"bottom"</span>));a.style.paddingBottom=<span class="number">0</span>;a.appendChild(d)&#125;,<span class="attr">_createCorner</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);b.style.backgroundColor=<span class="keyword">this</span>._isTransparent()?<span class="string">"transparent"</span>:a;<span class="keyword">return</span> b&#125;,<span class="attr">_createCornerSlice</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">var</span> e=<span class="built_in">document</span>.createElement(<span class="string">"span"</span>),f=e.style;f.backgroundColor=a;f.display=<span class="string">"block"</span>;f.height=<span class="string">"1px"</span>;f.overflow=<span class="string">"hidden"</span>;f.fontSize=<span class="string">"1px"</span>;a=<span class="keyword">this</span>._borderColor(a,b);<span class="keyword">this</span>.options.border&amp;&amp;<span class="number">0</span>==c?(f.borderTopStyle=<span class="string">"solid"</span>,f.borderTopWidth=<span class="string">"1px"</span>,f.borderLeftWidth=<span class="string">"0px"</span>,f.borderRightWidth=</span><br><span class="line"><span class="string">"0px"</span>,f.borderBottomWidth=<span class="string">"0px"</span>,f.height=<span class="string">"0px"</span>,f.borderColor=a):a&amp;&amp;(f.borderColor=a,f.borderStyle=<span class="string">"solid"</span>,f.borderWidth=<span class="string">"0px 1px"</span>);<span class="keyword">this</span>.options.compact||c!=<span class="keyword">this</span>.options.numSlices<span class="number">-1</span>||(f.height=<span class="string">"2px"</span>);<span class="keyword">this</span>._setMargin(e,c,d);<span class="keyword">this</span>._setBorder(e,c,d);<span class="keyword">return</span> e&#125;,<span class="attr">_setOptions</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.options=&#123;<span class="attr">corners</span>:<span class="string">"all"</span>,<span class="attr">color</span>:<span class="string">"fromElement"</span>,<span class="attr">bgColor</span>:<span class="string">"fromParent"</span>,<span class="attr">blend</span>:!<span class="number">0</span>,<span class="attr">border</span>:!<span class="number">1</span>,<span class="attr">compact</span>:!<span class="number">1</span>&#125;;OpenLayers.Util.extend(<span class="keyword">this</span>.options,a||&#123;&#125;);<span class="keyword">this</span>.options.numSlices=<span class="keyword">this</span>.options.compact?<span class="number">2</span>:<span class="number">4</span>;<span class="keyword">this</span>._isTransparent()&amp;&amp;(<span class="keyword">this</span>.options.blend=</span><br><span class="line">!<span class="number">1</span>)&#125;,<span class="attr">_whichSideTop</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>._hasString(<span class="keyword">this</span>.options.corners,<span class="string">"all"</span>,<span class="string">"top"</span>)||<span class="number">0</span>&lt;=<span class="keyword">this</span>.options.corners.indexOf(<span class="string">"tl"</span>)&amp;&amp;<span class="number">0</span>&lt;=<span class="keyword">this</span>.options.corners.indexOf(<span class="string">"tr"</span>)?<span class="string">""</span>:<span class="number">0</span>&lt;=<span class="keyword">this</span>.options.corners.indexOf(<span class="string">"tl"</span>)?<span class="string">"left"</span>:<span class="number">0</span>&lt;=<span class="keyword">this</span>.options.corners.indexOf(<span class="string">"tr"</span>)?<span class="string">"right"</span>:<span class="string">""</span>&#125;,<span class="attr">_whichSideBottom</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>._hasString(<span class="keyword">this</span>.options.corners,<span class="string">"all"</span>,<span class="string">"bottom"</span>)||<span class="number">0</span>&lt;=<span class="keyword">this</span>.options.corners.indexOf(<span class="string">"bl"</span>)&amp;&amp;<span class="number">0</span>&lt;=<span class="keyword">this</span>.options.corners.indexOf(<span class="string">"br"</span>)?<span class="string">""</span>:<span class="number">0</span>&lt;=<span class="keyword">this</span>.options.corners.indexOf(<span class="string">"bl"</span>)?<span class="string">"left"</span>:<span class="number">0</span>&lt;=<span class="keyword">this</span>.options.corners.indexOf(<span class="string">"br"</span>)?</span><br><span class="line"><span class="string">"right"</span>:<span class="string">""</span>&#125;,<span class="attr">_borderColor</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span><span class="string">"transparent"</span>==a?b:<span class="keyword">this</span>.options.border?<span class="keyword">this</span>.options.border:<span class="keyword">this</span>.options.blend?<span class="keyword">this</span>._blend(b,a):<span class="string">""</span>&#125;,<span class="attr">_setMargin</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;b=<span class="keyword">this</span>._marginSize(b);c=<span class="string">"top"</span>==c?<span class="keyword">this</span>._whichSideTop():<span class="keyword">this</span>._whichSideBottom();<span class="string">"left"</span>==c?(a.style.marginLeft=b+<span class="string">"px"</span>,a.style.marginRight=<span class="string">"0px"</span>):<span class="string">"right"</span>==c?(a.style.marginRight=b+<span class="string">"px"</span>,a.style.marginLeft=<span class="string">"0px"</span>):(a.style.marginLeft=b+<span class="string">"px"</span>,a.style.marginRight=b+<span class="string">"px"</span>)&#125;,<span class="attr">_setBorder</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;b=<span class="keyword">this</span>._borderSize(b);c=<span class="string">"top"</span>==c?<span class="keyword">this</span>._whichSideTop():</span><br><span class="line"><span class="keyword">this</span>._whichSideBottom();<span class="string">"left"</span>==c?(a.style.borderLeftWidth=b+<span class="string">"px"</span>,a.style.borderRightWidth=<span class="string">"0px"</span>):<span class="string">"right"</span>==c?(a.style.borderRightWidth=b+<span class="string">"px"</span>,a.style.borderLeftWidth=<span class="string">"0px"</span>):(a.style.borderLeftWidth=b+<span class="string">"px"</span>,a.style.borderRightWidth=b+<span class="string">"px"</span>);!<span class="number">1</span>!=<span class="keyword">this</span>.options.border&amp;&amp;(a.style.borderLeftWidth=b+<span class="string">"px"</span>,a.style.borderRightWidth=b+<span class="string">"px"</span>)&#125;,<span class="attr">_marginSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>._isTransparent())<span class="keyword">return</span> <span class="number">0</span>;<span class="keyword">var</span> b=[<span class="number">5</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>],c=[<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>],d=[<span class="number">2</span>,<span class="number">1</span>],e=[<span class="number">1</span>,<span class="number">0</span>];<span class="keyword">return</span> <span class="keyword">this</span>.options.compact&amp;&amp;<span class="keyword">this</span>.options.blend?e[a]:<span class="keyword">this</span>.options.compact?</span><br><span class="line">d[a]:<span class="keyword">this</span>.options.blend?c[a]:b[a]&#125;,<span class="attr">_borderSize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=[<span class="number">5</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>],c=[<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],d=[<span class="number">1</span>,<span class="number">0</span>],e=[<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>];<span class="keyword">return</span> <span class="keyword">this</span>.options.compact&amp;&amp;(<span class="keyword">this</span>.options.blend||<span class="keyword">this</span>._isTransparent())?<span class="number">1</span>:<span class="keyword">this</span>.options.compact?d[a]:<span class="keyword">this</span>.options.blend?c[a]:<span class="keyword">this</span>.options.border?e[a]:<span class="keyword">this</span>._isTransparent()?b[a]:<span class="number">0</span>&#125;,<span class="attr">_hasString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">1</span>;b&lt;<span class="built_in">arguments</span>.length;b++)<span class="keyword">if</span>(<span class="number">0</span>&lt;=a.indexOf(<span class="built_in">arguments</span>[b]))<span class="keyword">return</span>!<span class="number">0</span>;<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">_blend</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=OpenLayers.Rico.Color.createFromHex(a);c.blend(OpenLayers.Rico.Color.createFromHex(b));</span><br><span class="line"><span class="keyword">return</span> c&#125;,<span class="attr">_background</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">try</span>&#123;<span class="keyword">return</span> OpenLayers.Rico.Color.createColorFromBackground(a).asHex()&#125;<span class="keyword">catch</span>(b)&#123;<span class="keyword">return</span><span class="string">"#ffffff"</span>&#125;&#125;,<span class="attr">_isTransparent</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">"transparent"</span>==<span class="keyword">this</span>.options.color&#125;,<span class="attr">_isTopRounded</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>._hasString(<span class="keyword">this</span>.options.corners,<span class="string">"all"</span>,<span class="string">"top"</span>,<span class="string">"tl"</span>,<span class="string">"tr"</span>)&#125;,<span class="attr">_isBottomRounded</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>._hasString(<span class="keyword">this</span>.options.corners,<span class="string">"all"</span>,<span class="string">"bottom"</span>,<span class="string">"bl"</span>,<span class="string">"br"</span>)&#125;,<span class="attr">_hasSingleTextChild</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="number">1</span>==a.childNodes.length&amp;&amp;<span class="number">3</span>==a.childNodes[<span class="number">0</span>].nodeType&#125;&#125;;OpenLayers.Control.NavigationHistory=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">type</span>:OpenLayers.Control.TYPE_TOGGLE,<span class="attr">previous</span>:<span class="literal">null</span>,<span class="attr">previousOptions</span>:<span class="literal">null</span>,<span class="attr">next</span>:<span class="literal">null</span>,<span class="attr">nextOptions</span>:<span class="literal">null</span>,<span class="attr">limit</span>:<span class="number">50</span>,<span class="attr">autoActivate</span>:!<span class="number">0</span>,<span class="attr">clearOnDeactivate</span>:!<span class="number">1</span>,<span class="attr">registry</span>:<span class="literal">null</span>,<span class="attr">nextStack</span>:<span class="literal">null</span>,<span class="attr">previousStack</span>:<span class="literal">null</span>,<span class="attr">listeners</span>:<span class="literal">null</span>,<span class="attr">restoring</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.registry=OpenLayers.Util.extend(&#123;<span class="attr">moveend</span>:<span class="keyword">this</span>.getState&#125;,<span class="keyword">this</span>.registry);a=&#123;<span class="attr">trigger</span>:OpenLayers.Function.bind(<span class="keyword">this</span>.previousTrigger,</span><br><span class="line"><span class="keyword">this</span>),<span class="attr">displayClass</span>:<span class="keyword">this</span>.displayClass+<span class="string">" "</span>+<span class="keyword">this</span>.displayClass+<span class="string">"Previous"</span>&#125;;OpenLayers.Util.extend(a,<span class="keyword">this</span>.previousOptions);<span class="keyword">this</span>.previous=<span class="keyword">new</span> OpenLayers.Control.Button(a);a=&#123;<span class="attr">trigger</span>:OpenLayers.Function.bind(<span class="keyword">this</span>.nextTrigger,<span class="keyword">this</span>),<span class="attr">displayClass</span>:<span class="keyword">this</span>.displayClass+<span class="string">" "</span>+<span class="keyword">this</span>.displayClass+<span class="string">"Next"</span>&#125;;OpenLayers.Util.extend(a,<span class="keyword">this</span>.nextOptions);<span class="keyword">this</span>.next=<span class="keyword">new</span> OpenLayers.Control.Button(a);<span class="keyword">this</span>.clear()&#125;,<span class="attr">onPreviousChange</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a&amp;&amp;!<span class="keyword">this</span>.previous.active?<span class="keyword">this</span>.previous.activate():!a&amp;&amp;<span class="keyword">this</span>.previous.active&amp;&amp;<span class="keyword">this</span>.previous.deactivate()&#125;,</span><br><span class="line">onNextChange:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;a&amp;&amp;!<span class="keyword">this</span>.next.active?<span class="keyword">this</span>.next.activate():!a&amp;&amp;<span class="keyword">this</span>.next.active&amp;&amp;<span class="keyword">this</span>.next.deactivate()&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>);<span class="keyword">this</span>.previous.destroy();<span class="keyword">this</span>.next.destroy();<span class="keyword">this</span>.deactivate();<span class="keyword">for</span>(<span class="keyword">var</span> a <span class="keyword">in</span> <span class="keyword">this</span>)<span class="keyword">this</span>[a]=<span class="literal">null</span>&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.map=a;<span class="keyword">this</span>.next.setMap(a);<span class="keyword">this</span>.previous.setMap(a)&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Control.prototype.draw.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.next.draw();<span class="keyword">this</span>.previous.draw()&#125;,<span class="attr">previousTrigger</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.previousStack.shift(),</span><br><span class="line">b=<span class="keyword">this</span>.previousStack.shift();<span class="keyword">void</span> <span class="number">0</span>!=b?(<span class="keyword">this</span>.nextStack.unshift(a),<span class="keyword">this</span>.previousStack.unshift(b),<span class="keyword">this</span>.restoring=!<span class="number">0</span>,<span class="keyword">this</span>.restore(b),<span class="keyword">this</span>.restoring=!<span class="number">1</span>,<span class="keyword">this</span>.onNextChange(<span class="keyword">this</span>.nextStack[<span class="number">0</span>],<span class="keyword">this</span>.nextStack.length),<span class="keyword">this</span>.onPreviousChange(<span class="keyword">this</span>.previousStack[<span class="number">1</span>],<span class="keyword">this</span>.previousStack.length<span class="number">-1</span>)):<span class="keyword">this</span>.previousStack.unshift(a);<span class="keyword">return</span> b&#125;,<span class="attr">nextTrigger</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.nextStack.shift();<span class="keyword">void</span> <span class="number">0</span>!=a&amp;&amp;(<span class="keyword">this</span>.previousStack.unshift(a),<span class="keyword">this</span>.restoring=!<span class="number">0</span>,<span class="keyword">this</span>.restore(a),<span class="keyword">this</span>.restoring=!<span class="number">1</span>,<span class="keyword">this</span>.onNextChange(<span class="keyword">this</span>.nextStack[<span class="number">0</span>],</span><br><span class="line"><span class="keyword">this</span>.nextStack.length),<span class="keyword">this</span>.onPreviousChange(<span class="keyword">this</span>.previousStack[<span class="number">1</span>],<span class="keyword">this</span>.previousStack.length<span class="number">-1</span>));<span class="keyword">return</span> a&#125;,<span class="attr">clear</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.previousStack=[];<span class="keyword">this</span>.previous.deactivate();<span class="keyword">this</span>.nextStack=[];<span class="keyword">this</span>.next.deactivate()&#125;,<span class="attr">getState</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>&#123;<span class="attr">center</span>:<span class="keyword">this</span>.map.getCenter(),<span class="attr">resolution</span>:<span class="keyword">this</span>.map.getResolution(),<span class="attr">projection</span>:<span class="keyword">this</span>.map.getProjectionObject(),<span class="attr">units</span>:<span class="keyword">this</span>.map.getProjectionObject().getUnits()||<span class="keyword">this</span>.map.units||<span class="keyword">this</span>.map.baseLayer.units&#125;&#125;,<span class="attr">restore</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c;<span class="keyword">if</span>(<span class="keyword">this</span>.map.getProjectionObject()==</span><br><span class="line">a.projection)c=<span class="keyword">this</span>.map.getZoomForResolution(a.resolution),b=a.center;<span class="keyword">else</span>&#123;b=a.center.clone();b.transform(a.projection,<span class="keyword">this</span>.map.getProjectionObject());c=a.units;<span class="keyword">var</span> d=<span class="keyword">this</span>.map.getProjectionObject().getUnits()||<span class="keyword">this</span>.map.units||<span class="keyword">this</span>.map.baseLayer.units;c=<span class="keyword">this</span>.map.getZoomForResolution((c&amp;&amp;d?OpenLayers.INCHES_PER_UNIT[c]/OpenLayers.INCHES_PER_UNIT[d]:<span class="number">1</span>)*a.resolution)&#125;<span class="keyword">this</span>.map.setCenter(b,c)&#125;,<span class="attr">setListeners</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.listeners=&#123;&#125;;<span class="keyword">for</span>(<span class="keyword">var</span> a <span class="keyword">in</span> <span class="keyword">this</span>.registry)<span class="keyword">this</span>.listeners[a]=OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.restoring)&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.registry[a].apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.previousStack.unshift(b);<span class="keyword">if</span>(<span class="number">1</span>&lt;<span class="keyword">this</span>.previousStack.length)<span class="keyword">this</span>.onPreviousChange(<span class="keyword">this</span>.previousStack[<span class="number">1</span>],<span class="keyword">this</span>.previousStack.length<span class="number">-1</span>);<span class="keyword">this</span>.previousStack.length&gt;<span class="keyword">this</span>.limit+<span class="number">1</span>&amp;&amp;<span class="keyword">this</span>.previousStack.pop();<span class="number">0</span>&lt;<span class="keyword">this</span>.nextStack.length&amp;&amp;(<span class="keyword">this</span>.nextStack=[],<span class="keyword">this</span>.onNextChange(<span class="literal">null</span>,<span class="number">0</span>))&#125;<span class="keyword">return</span>!<span class="number">0</span>&#125;,<span class="keyword">this</span>)&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.map&amp;&amp;OpenLayers.Control.prototype.activate.apply(<span class="keyword">this</span>))&#123;<span class="literal">null</span>==<span class="keyword">this</span>.listeners&amp;&amp;<span class="keyword">this</span>.setListeners();<span class="keyword">for</span>(<span class="keyword">var</span> b <span class="keyword">in</span> <span class="keyword">this</span>.listeners)<span class="keyword">this</span>.map.events.register(b,</span><br><span class="line"><span class="keyword">this</span>,<span class="keyword">this</span>.listeners[b]);a=!<span class="number">0</span>;<span class="number">0</span>==<span class="keyword">this</span>.previousStack.length&amp;&amp;<span class="keyword">this</span>.initStack()&#125;<span class="keyword">return</span> a&#125;,<span class="attr">initStack</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.map.getCenter()&amp;&amp;<span class="keyword">this</span>.listeners.moveend()&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=!<span class="number">1</span>;<span class="keyword">if</span>(<span class="keyword">this</span>.map&amp;&amp;OpenLayers.Control.prototype.deactivate.apply(<span class="keyword">this</span>))&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b <span class="keyword">in</span> <span class="keyword">this</span>.listeners)<span class="keyword">this</span>.map.events.unregister(b,<span class="keyword">this</span>,<span class="keyword">this</span>.listeners[b]);<span class="keyword">this</span>.clearOnDeactivate&amp;&amp;<span class="keyword">this</span>.clear();a=!<span class="number">0</span>&#125;<span class="keyword">return</span> a&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.NavigationHistory"</span>&#125;);OpenLayers.Layer.UTFGrid=OpenLayers.Class(OpenLayers.Layer.XYZ,&#123;<span class="attr">isBaseLayer</span>:!<span class="number">1</span>,<span class="attr">projection</span>:<span class="keyword">new</span> OpenLayers.Projection(<span class="string">"EPSG:900913"</span>),<span class="attr">useJSONP</span>:!<span class="number">1</span>,<span class="attr">tileClass</span>:OpenLayers.Tile.UTFGrid,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Layer.Grid.prototype.initialize.apply(<span class="keyword">this</span>,[a.name,a.url,&#123;&#125;,a]);<span class="keyword">this</span>.tileOptions=OpenLayers.Util.extend(&#123;<span class="attr">utfgridResolution</span>:<span class="keyword">this</span>.utfgridResolution&#125;,<span class="keyword">this</span>.tileOptions)&#125;,<span class="attr">createBackBuffer</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.UTFGrid(<span class="keyword">this</span>.getOptions()));<span class="keyword">return</span> a=OpenLayers.Layer.Grid.prototype.clone.apply(<span class="keyword">this</span>,</span><br><span class="line">[a])&#125;,<span class="attr">getFeatureInfo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;(a=<span class="keyword">this</span>.getTileData(a))&amp;&amp;a.tile&amp;&amp;(b=a.tile.getFeatureInfo(a.i,a.j));<span class="keyword">return</span> b&#125;,<span class="attr">getFeatureId</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="literal">null</span>;a=<span class="keyword">this</span>.getTileData(a);a.tile&amp;&amp;(b=a.tile.getFeatureId(a.i,a.j));<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.UTFGrid"</span>&#125;);OpenLayers.TileManager=OpenLayers.Class(&#123;<span class="attr">cacheSize</span>:<span class="number">256</span>,<span class="attr">tilesPerFrame</span>:<span class="number">2</span>,<span class="attr">frameDelay</span>:<span class="number">16</span>,<span class="attr">moveDelay</span>:<span class="number">100</span>,<span class="attr">zoomDelay</span>:<span class="number">200</span>,<span class="attr">maps</span>:<span class="literal">null</span>,<span class="attr">tileQueueId</span>:<span class="literal">null</span>,<span class="attr">tileQueue</span>:<span class="literal">null</span>,<span class="attr">tileCache</span>:<span class="literal">null</span>,<span class="attr">tileCacheIndex</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Util.extend(<span class="keyword">this</span>,a);<span class="keyword">this</span>.maps=[];<span class="keyword">this</span>.tileQueueId=&#123;&#125;;<span class="keyword">this</span>.tileQueue=&#123;&#125;;<span class="keyword">this</span>.tileCache=&#123;&#125;;<span class="keyword">this</span>.tileCacheIndex=[]&#125;,<span class="attr">addMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>._destroyed&amp;&amp;OpenLayers.Layer.Grid)&#123;<span class="keyword">this</span>.maps.push(a);<span class="keyword">this</span>.tileQueue[a.id]=[];<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=a.layers.length;b&lt;c;++b)<span class="keyword">this</span>.addLayer(&#123;<span class="attr">layer</span>:a.layers[b]&#125;);</span><br><span class="line">a.events.on(&#123;<span class="attr">move</span>:<span class="keyword">this</span>.move,<span class="attr">zoomend</span>:<span class="keyword">this</span>.zoomEnd,<span class="attr">changelayer</span>:<span class="keyword">this</span>.changeLayer,<span class="attr">addlayer</span>:<span class="keyword">this</span>.addLayer,<span class="attr">preremovelayer</span>:<span class="keyword">this</span>.removeLayer,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;)&#125;&#125;,<span class="attr">removeMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>._destroyed&amp;&amp;OpenLayers.Layer.Grid)&#123;<span class="built_in">window</span>.clearTimeout(<span class="keyword">this</span>.tileQueueId[a.id]);<span class="keyword">if</span>(a.layers)<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>,c=a.layers.length;b&lt;c;++b)<span class="keyword">this</span>.removeLayer(&#123;<span class="attr">layer</span>:a.layers[b]&#125;);a.events&amp;&amp;a.events.un(&#123;<span class="attr">move</span>:<span class="keyword">this</span>.move,<span class="attr">zoomend</span>:<span class="keyword">this</span>.zoomEnd,<span class="attr">changelayer</span>:<span class="keyword">this</span>.changeLayer,<span class="attr">addlayer</span>:<span class="keyword">this</span>.addLayer,<span class="attr">preremovelayer</span>:<span class="keyword">this</span>.removeLayer,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">this</span>.tileQueue[a.id];<span class="keyword">delete</span> <span class="keyword">this</span>.tileQueueId[a.id];OpenLayers.Util.removeItem(<span class="keyword">this</span>.maps,a)&#125;&#125;,<span class="attr">move</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.updateTimeout(a.object,<span class="keyword">this</span>.moveDelay,!<span class="number">0</span>)&#125;,<span class="attr">zoomEnd</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.updateTimeout(a.object,<span class="keyword">this</span>.zoomDelay)&#125;,<span class="attr">changeLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"visibility"</span>!==a.property&amp;&amp;<span class="string">"params"</span>!==a.property||<span class="keyword">this</span>.updateTimeout(a.object,<span class="number">0</span>)&#125;,<span class="attr">addLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.layer;<span class="keyword">if</span>(a <span class="keyword">instanceof</span> OpenLayers.Layer.Grid)&#123;a.events.on(&#123;<span class="attr">addtile</span>:<span class="keyword">this</span>.addTile,<span class="attr">retile</span>:<span class="keyword">this</span>.clearTileQueue,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">var</span> b,c,d;<span class="keyword">for</span>(b=a.grid.length-</span><br><span class="line"><span class="number">1</span>;<span class="number">0</span>&lt;=b;--b)<span class="keyword">for</span>(c=a.grid[b].length<span class="number">-1</span>;<span class="number">0</span>&lt;=c;--c)d=a.grid[b][c],<span class="keyword">this</span>.addTile(&#123;<span class="attr">tile</span>:d&#125;),d.url&amp;&amp;!d.imgDiv&amp;&amp;<span class="keyword">this</span>.manageTileCache(&#123;<span class="attr">object</span>:d&#125;)&#125;&#125;,<span class="attr">removeLayer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.layer;<span class="keyword">if</span>(a <span class="keyword">instanceof</span> OpenLayers.Layer.Grid&amp;&amp;(<span class="keyword">this</span>.clearTileQueue(&#123;<span class="attr">object</span>:a&#125;),a.events&amp;&amp;a.events.un(&#123;<span class="attr">addtile</span>:<span class="keyword">this</span>.addTile,<span class="attr">retile</span>:<span class="keyword">this</span>.clearTileQueue,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;),a.grid))&#123;<span class="keyword">var</span> b,c,d;<span class="keyword">for</span>(b=a.grid.length<span class="number">-1</span>;<span class="number">0</span>&lt;=b;--b)<span class="keyword">for</span>(c=a.grid[b].length<span class="number">-1</span>;<span class="number">0</span>&lt;=c;--c)d=a.grid[b][c],<span class="keyword">this</span>.unloadTile(&#123;<span class="attr">object</span>:d&#125;)&#125;&#125;,<span class="attr">updateTimeout</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="built_in">window</span>.clearTimeout(<span class="keyword">this</span>.tileQueueId[a.id]);</span><br><span class="line"><span class="keyword">var</span> d=<span class="keyword">this</span>.tileQueue[a.id];<span class="keyword">if</span>(!c||d.length)<span class="keyword">this</span>.tileQueueId[a.id]=<span class="built_in">window</span>.setTimeout(OpenLayers.Function.bind(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.drawTilesFromQueue(a);d.length&amp;&amp;<span class="keyword">this</span>.updateTimeout(a,<span class="keyword">this</span>.frameDelay)&#125;,<span class="keyword">this</span>),b)&#125;,<span class="attr">addTile</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a.tile <span class="keyword">instanceof</span> OpenLayers.Tile.Image)a.tile.events.on(&#123;<span class="attr">beforedraw</span>:<span class="keyword">this</span>.queueTileDraw,<span class="attr">beforeload</span>:<span class="keyword">this</span>.manageTileCache,<span class="attr">loadend</span>:<span class="keyword">this</span>.addToCache,<span class="attr">unload</span>:<span class="keyword">this</span>.unloadTile,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">else</span> <span class="keyword">this</span>.removeLayer(&#123;<span class="attr">layer</span>:a.tile.layer&#125;)&#125;,<span class="attr">unloadTile</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.object;a.events.un(&#123;<span class="attr">beforedraw</span>:<span class="keyword">this</span>.queueTileDraw,</span><br><span class="line">beforeload:<span class="keyword">this</span>.manageTileCache,<span class="attr">loadend</span>:<span class="keyword">this</span>.addToCache,<span class="attr">unload</span>:<span class="keyword">this</span>.unloadTile,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);OpenLayers.Util.removeItem(<span class="keyword">this</span>.tileQueue[a.layer.map.id],a)&#125;,<span class="attr">queueTileDraw</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.object;<span class="keyword">var</span> b=!<span class="number">1</span>,c=a.layer,d=c.getURL(a.bounds),e=<span class="keyword">this</span>.tileCache[d];e&amp;&amp;<span class="string">"olTileImage"</span>!==e.className&amp;&amp;(<span class="keyword">delete</span> <span class="keyword">this</span>.tileCache[d],OpenLayers.Util.removeItem(<span class="keyword">this</span>.tileCacheIndex,d),e=<span class="literal">null</span>);!c.url||!c.async&amp;&amp;e||(b=<span class="keyword">this</span>.tileQueue[c.map.id],~OpenLayers.Util.indexOf(b,a)||b.push(a),b=!<span class="number">0</span>);<span class="keyword">return</span>!b&#125;,<span class="attr">drawTilesFromQueue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line"><span class="keyword">this</span>.tileQueue[a.id],c=<span class="keyword">this</span>.tilesPerFrame;<span class="keyword">for</span>(a=a.zoomTween&amp;&amp;a.zoomTween.playing;!a&amp;&amp;b.length&amp;&amp;c;)b.shift().draw(!<span class="number">0</span>),--c&#125;,<span class="attr">manageTileCache</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.object;<span class="keyword">var</span> b=<span class="keyword">this</span>.tileCache[a.url];b&amp;&amp;(b.parentNode&amp;&amp;OpenLayers.Element.hasClass(b.parentNode,<span class="string">"olBackBuffer"</span>)&amp;&amp;(b.parentNode.removeChild(b),b.id=<span class="literal">null</span>),b.parentNode||(b.style.visibility=<span class="string">"hidden"</span>,b.style.opacity=<span class="number">0</span>,a.setImage(b),OpenLayers.Util.removeItem(<span class="keyword">this</span>.tileCacheIndex,a.url),<span class="keyword">this</span>.tileCacheIndex.push(a.url)))&#125;,<span class="attr">addToCache</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.object;</span><br><span class="line"><span class="keyword">this</span>.tileCache[a.url]||OpenLayers.Element.hasClass(a.imgDiv,<span class="string">"olImageLoadError"</span>)||(<span class="keyword">this</span>.tileCacheIndex.length&gt;=<span class="keyword">this</span>.cacheSize&amp;&amp;(<span class="keyword">delete</span> <span class="keyword">this</span>.tileCache[<span class="keyword">this</span>.tileCacheIndex[<span class="number">0</span>]],<span class="keyword">this</span>.tileCacheIndex.shift()),<span class="keyword">this</span>.tileCache[a.url]=a.imgDiv,<span class="keyword">this</span>.tileCacheIndex.push(a.url))&#125;,<span class="attr">clearTileQueue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.object;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.tileQueue[a.map.id],c=b.length<span class="number">-1</span>;<span class="number">0</span>&lt;=c;--c)b[c].layer===a&amp;&amp;b.splice(c,<span class="number">1</span>)&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.maps.length<span class="number">-1</span>;<span class="number">0</span>&lt;=a;--a)<span class="keyword">this</span>.removeMap(<span class="keyword">this</span>.maps[a]);<span class="keyword">this</span>.tileCacheIndex=<span class="keyword">this</span>.tileCache=</span><br><span class="line"><span class="keyword">this</span>.tileQueueId=<span class="keyword">this</span>.tileQueue=<span class="keyword">this</span>.maps=<span class="literal">null</span>;<span class="keyword">this</span>._destroyed=!<span class="number">0</span>&#125;&#125;);OpenLayers.Layer.ArcGISCache=OpenLayers.Class(OpenLayers.Layer.XYZ,&#123;<span class="attr">url</span>:<span class="literal">null</span>,<span class="attr">tileOrigin</span>:<span class="literal">null</span>,<span class="attr">tileSize</span>:<span class="keyword">new</span> OpenLayers.Size(<span class="number">256</span>,<span class="number">256</span>),<span class="attr">useArcGISServer</span>:!<span class="number">0</span>,<span class="attr">type</span>:<span class="string">"png"</span>,<span class="attr">useScales</span>:!<span class="number">1</span>,<span class="attr">overrideDPI</span>:!<span class="number">1</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;OpenLayers.Layer.XYZ.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.resolutions&amp;&amp;(<span class="keyword">this</span>.serverResolutions=<span class="keyword">this</span>.resolutions,<span class="keyword">this</span>.maxExtent=<span class="keyword">this</span>.getMaxExtentForResolution(<span class="keyword">this</span>.resolutions[<span class="number">0</span>]));<span class="keyword">if</span>(<span class="keyword">this</span>.layerInfo)&#123;<span class="keyword">var</span> d=<span class="keyword">this</span>.layerInfo,e=<span class="keyword">new</span> OpenLayers.Bounds(d.fullExtent.xmin,d.fullExtent.ymin,</span><br><span class="line">d.fullExtent.xmax,d.fullExtent.ymax);<span class="keyword">this</span>.projection=<span class="string">"EPSG:"</span>+d.spatialReference.wkid;<span class="keyword">this</span>.sphericalMercator=<span class="number">102100</span>==d.spatialReference.wkid;<span class="keyword">this</span>.units=<span class="string">"esriFeet"</span>==d.units?<span class="string">"ft"</span>:<span class="string">"m"</span>;<span class="keyword">if</span>(d.tileInfo)&#123;<span class="keyword">this</span>.tileSize=<span class="keyword">new</span> OpenLayers.Size(d.tileInfo.width||d.tileInfo.cols,d.tileInfo.height||d.tileInfo.rows);<span class="keyword">this</span>.tileOrigin=<span class="keyword">new</span> OpenLayers.LonLat(d.tileInfo.origin.x,d.tileInfo.origin.y);<span class="keyword">var</span> f=<span class="keyword">new</span> OpenLayers.Geometry.Point(e.left,e.top),e=<span class="keyword">new</span> OpenLayers.Geometry.Point(e.right,e.bottom);<span class="keyword">this</span>.useScales?<span class="keyword">this</span>.scales=</span><br><span class="line">[]:<span class="keyword">this</span>.resolutions=[];<span class="keyword">this</span>.lods=[];<span class="keyword">for</span>(<span class="keyword">var</span> g <span class="keyword">in</span> d.tileInfo.lods)<span class="keyword">if</span>(d.tileInfo.lods.hasOwnProperty(g))&#123;<span class="keyword">var</span> h=d.tileInfo.lods[g];<span class="keyword">this</span>.useScales?<span class="keyword">this</span>.scales.push(h.scale):<span class="keyword">this</span>.resolutions.push(h.resolution);<span class="keyword">var</span> k=<span class="keyword">this</span>.getContainingTileCoords(f,h.resolution);h.startTileCol=k.x;h.startTileRow=k.y;k=<span class="keyword">this</span>.getContainingTileCoords(e,h.resolution);h.endTileCol=k.x;h.endTileRow=k.y;<span class="keyword">this</span>.lods.push(h)&#125;<span class="keyword">this</span>.maxExtent=<span class="keyword">this</span>.calculateMaxExtentWithLOD(<span class="keyword">this</span>.lods[<span class="number">0</span>]);<span class="keyword">this</span>.serverResolutions=<span class="keyword">this</span>.resolutions;<span class="keyword">this</span>.overrideDPI&amp;&amp;</span><br><span class="line">d.tileInfo.dpi&amp;&amp;(OpenLayers.DOTS_PER_INCH=d.tileInfo.dpi)&#125;&#125;&#125;,<span class="attr">getContainingTileCoords</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Pixel(<span class="built_in">Math</span>.max(<span class="built_in">Math</span>.floor((a.x-<span class="keyword">this</span>.tileOrigin.lon)/(<span class="keyword">this</span>.tileSize.w*b)),<span class="number">0</span>),<span class="built_in">Math</span>.max(<span class="built_in">Math</span>.floor((<span class="keyword">this</span>.tileOrigin.lat-a.y)/(<span class="keyword">this</span>.tileSize.h*b)),<span class="number">0</span>))&#125;,<span class="attr">calculateMaxExtentWithLOD</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.tileOrigin.lon+a.startTileCol*<span class="keyword">this</span>.tileSize.w*a.resolution,c=<span class="keyword">this</span>.tileOrigin.lat-a.startTileRow*<span class="keyword">this</span>.tileSize.h*a.resolution;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Bounds(b,c-(a.endTileRow-a.startTileRow+</span><br><span class="line"><span class="number">1</span>)*<span class="keyword">this</span>.tileSize.h*a.resolution,b+(a.endTileCol-a.startTileCol+<span class="number">1</span>)*<span class="keyword">this</span>.tileSize.w*a.resolution,c)&#125;,<span class="attr">calculateMaxExtentWithExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">new</span> OpenLayers.Geometry.Point(a.left,a.top),d=<span class="keyword">new</span> OpenLayers.Geometry.Point(a.right,a.bottom),c=<span class="keyword">this</span>.getContainingTileCoords(c,b),d=<span class="keyword">this</span>.getContainingTileCoords(d,b);<span class="keyword">return</span> <span class="keyword">this</span>.calculateMaxExtentWithLOD(&#123;<span class="attr">resolution</span>:b,<span class="attr">startTileCol</span>:c.x,<span class="attr">startTileRow</span>:c.y,<span class="attr">endTileCol</span>:d.x,<span class="attr">endTileRow</span>:d.y&#125;)&#125;,<span class="attr">getUpperLeftTileCoord</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="keyword">this</span>.maxExtent.left,</span><br><span class="line"><span class="keyword">this</span>.maxExtent.top);<span class="keyword">return</span> <span class="keyword">this</span>.getContainingTileCoords(b,a)&#125;,<span class="attr">getLowerRightTileCoord</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">new</span> OpenLayers.Geometry.Point(<span class="keyword">this</span>.maxExtent.right,<span class="keyword">this</span>.maxExtent.bottom);<span class="keyword">return</span> <span class="keyword">this</span>.getContainingTileCoords(b,a)&#125;,<span class="attr">getMaxExtentForResolution</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getUpperLeftTileCoord(a),c=<span class="keyword">this</span>.getLowerRightTileCoord(a),d=<span class="keyword">this</span>.tileOrigin.lon+b.x*<span class="keyword">this</span>.tileSize.w*a,e=<span class="keyword">this</span>.tileOrigin.lat-b.y*<span class="keyword">this</span>.tileSize.h*a;<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Bounds(d,e-(c.y-b.y+<span class="number">1</span>)*<span class="keyword">this</span>.tileSize.h*a,d+(c.x-b.x+<span class="number">1</span>)*<span class="keyword">this</span>.tileSize.w*</span><br><span class="line">a,e)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.ArcGISCache(<span class="keyword">this</span>.name,<span class="keyword">this</span>.url,<span class="keyword">this</span>.options));<span class="keyword">return</span> OpenLayers.Layer.XYZ.prototype.clone.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">initGriddedTiles</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">delete</span> <span class="keyword">this</span>._tileOrigin;OpenLayers.Layer.XYZ.prototype.initGriddedTiles.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">getMaxExtent</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.map.getResolution();<span class="keyword">return</span> <span class="keyword">this</span>.maxExtent=<span class="keyword">this</span>.getMaxExtentForResolution(a)&#125;,<span class="attr">getTileOrigin</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>._tileOrigin)&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.getMaxExtent();<span class="keyword">this</span>._tileOrigin=<span class="keyword">new</span> OpenLayers.LonLat(a.left,</span><br><span class="line">a.bottom)&#125;<span class="keyword">return</span> <span class="keyword">this</span>._tileOrigin&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getResolution(),c=<span class="keyword">this</span>.tileOrigin.lon+b*<span class="keyword">this</span>.tileSize.w/<span class="number">2</span>,d=<span class="keyword">this</span>.tileOrigin.lat-b*<span class="keyword">this</span>.tileSize.h/<span class="number">2</span>;a=a.getCenterLonLat();c=<span class="built_in">Math</span>.round(<span class="built_in">Math</span>.abs((a.lon-c)/(b*<span class="keyword">this</span>.tileSize.w)));d=<span class="built_in">Math</span>.round(<span class="built_in">Math</span>.abs((d-a.lat)/(b*<span class="keyword">this</span>.tileSize.h)));a=<span class="keyword">this</span>.map.getZoom();<span class="keyword">if</span>(<span class="keyword">this</span>.lods)&#123;<span class="keyword">if</span>(b=<span class="keyword">this</span>.lods[<span class="keyword">this</span>.map.getZoom()],c&lt;b.startTileCol||c&gt;b.endTileCol||d&lt;b.startTileRow||d&gt;b.endTileRow)<span class="keyword">return</span> <span class="literal">null</span>&#125;<span class="keyword">else</span>&#123;<span class="keyword">var</span> e=<span class="keyword">this</span>.getUpperLeftTileCoord(b),b=<span class="keyword">this</span>.getLowerRightTileCoord(b);</span><br><span class="line"><span class="keyword">if</span>(c&lt;e.x||c&gt;=b.x||d&lt;e.y||d&gt;=b.y)<span class="keyword">return</span> <span class="literal">null</span>&#125;b=<span class="keyword">this</span>.url;e=<span class="string">""</span>+c+d+a;OpenLayers.Util.isArray(b)&amp;&amp;(b=<span class="keyword">this</span>.selectUrl(e,b));<span class="keyword">this</span>.useArcGISServer?b+=<span class="string">"/tile/$&#123;z&#125;/$&#123;y&#125;/$&#123;x&#125;"</span>:(c=<span class="string">"C"</span>+OpenLayers.Number.zeroPad(c,<span class="number">8</span>,<span class="number">16</span>),d=<span class="string">"R"</span>+OpenLayers.Number.zeroPad(d,<span class="number">8</span>,<span class="number">16</span>),a=<span class="string">"L"</span>+OpenLayers.Number.zeroPad(a,<span class="number">2</span>,<span class="number">10</span>),b=b+<span class="string">"/$&#123;z&#125;/$&#123;y&#125;/$&#123;x&#125;."</span>+<span class="keyword">this</span>.type);b=OpenLayers.String.format(b,&#123;<span class="attr">x</span>:c,<span class="attr">y</span>:d,<span class="attr">z</span>:a&#125;);<span class="keyword">return</span> OpenLayers.Util.urlAppend(b,OpenLayers.Util.getParameterString(<span class="keyword">this</span>.params))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.ArcGISCache"</span>&#125;);OpenLayers.Control.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">hover</span>:!<span class="number">1</span>,<span class="attr">drillDown</span>:!<span class="number">1</span>,<span class="attr">maxFeatures</span>:<span class="number">10</span>,<span class="attr">clickCallback</span>:<span class="string">"click"</span>,<span class="attr">output</span>:<span class="string">"features"</span>,<span class="attr">layers</span>:<span class="literal">null</span>,<span class="attr">queryVisible</span>:!<span class="number">1</span>,<span class="attr">url</span>:<span class="literal">null</span>,<span class="attr">layerUrls</span>:<span class="literal">null</span>,<span class="attr">infoFormat</span>:<span class="string">"text/html"</span>,<span class="attr">vendorParams</span>:&#123;&#125;,<span class="attr">format</span>:<span class="literal">null</span>,<span class="attr">formatOptions</span>:<span class="literal">null</span>,<span class="attr">handler</span>:<span class="literal">null</span>,<span class="attr">hoverRequest</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||&#123;&#125;;a.handlerOptions=a.handlerOptions||&#123;&#125;;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.format||(<span class="keyword">this</span>.format=<span class="keyword">new</span> OpenLayers.Format.WMSGetFeatureInfo(a.formatOptions));</span><br><span class="line">!<span class="number">0</span>===<span class="keyword">this</span>.drillDown&amp;&amp;(<span class="keyword">this</span>.hover=!<span class="number">1</span>);<span class="keyword">this</span>.hover?<span class="keyword">this</span>.handler=<span class="keyword">new</span> OpenLayers.Handler.Hover(<span class="keyword">this</span>,&#123;<span class="attr">move</span>:<span class="keyword">this</span>.cancelHover,<span class="attr">pause</span>:<span class="keyword">this</span>.getInfoForHover&#125;,OpenLayers.Util.extend(<span class="keyword">this</span>.handlerOptions.hover||&#123;&#125;,&#123;<span class="attr">delay</span>:<span class="number">250</span>&#125;)):(a=&#123;&#125;,a[<span class="keyword">this</span>.clickCallback]=<span class="keyword">this</span>.getInfoForClick,<span class="keyword">this</span>.handler=<span class="keyword">new</span> OpenLayers.Handler.Click(<span class="keyword">this</span>,a,<span class="keyword">this</span>.handlerOptions.click||&#123;&#125;))&#125;,<span class="attr">getInfoForClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforegetfeatureinfo"</span>,&#123;<span class="attr">xy</span>:a.xy&#125;);OpenLayers.Element.addClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olCursorWait"</span>);<span class="keyword">this</span>.request(a.xy,</span><br><span class="line">&#123;&#125;)&#125;,<span class="attr">getInfoForHover</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforegetfeatureinfo"</span>,&#123;<span class="attr">xy</span>:a.xy&#125;);<span class="keyword">this</span>.request(a.xy,&#123;<span class="attr">hover</span>:!<span class="number">0</span>&#125;)&#125;,<span class="attr">cancelHover</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.hoverRequest&amp;&amp;(<span class="keyword">this</span>.hoverRequest.abort(),<span class="keyword">this</span>.hoverRequest=<span class="literal">null</span>)&#125;,<span class="attr">findLayers</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.layers||<span class="keyword">this</span>.map.layers,b=[],c,d,e=a.length<span class="number">-1</span>;<span class="number">0</span>&lt;=e;--e)c=a[e],c <span class="keyword">instanceof</span> OpenLayers.Layer.WMS&amp;&amp;(!<span class="keyword">this</span>.queryVisible||c.getVisibility())&amp;&amp;(d=OpenLayers.Util.isArray(c.url)?c.url[<span class="number">0</span>]:c.url,!<span class="number">1</span>!==<span class="keyword">this</span>.drillDown||<span class="keyword">this</span>.url||(<span class="keyword">this</span>.url=d),(!<span class="number">0</span>===<span class="keyword">this</span>.drillDown||</span><br><span class="line"><span class="keyword">this</span>.urlMatches(d))&amp;&amp;b.push(c));<span class="keyword">return</span> b&#125;,<span class="attr">urlMatches</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=OpenLayers.Util.isEquivalentUrl(<span class="keyword">this</span>.url,a);<span class="keyword">if</span>(!b&amp;&amp;<span class="keyword">this</span>.layerUrls)<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=<span class="keyword">this</span>.layerUrls.length;c&lt;d;++c)<span class="keyword">if</span>(OpenLayers.Util.isEquivalentUrl(<span class="keyword">this</span>.layerUrls[c],a))&#123;b=!<span class="number">0</span>;<span class="keyword">break</span>&#125;<span class="keyword">return</span> b&#125;,<span class="attr">buildWMSOptions</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> e=[],f=[],g=<span class="number">0</span>,h=b.length;g&lt;h;g++)<span class="literal">null</span>!=b[g].params.LAYERS&amp;&amp;(e=e.concat(b[g].params.LAYERS),f=f.concat(<span class="keyword">this</span>.getStyleNames(b[g])));b=b[<span class="number">0</span>];g=<span class="keyword">this</span>.map.getProjection();(h=b.projection)&amp;&amp;h.equals(<span class="keyword">this</span>.map.getProjectionObject())&amp;&amp;</span><br><span class="line">(g=h.getCode());d=OpenLayers.Util.extend(&#123;<span class="attr">service</span>:<span class="string">"WMS"</span>,<span class="attr">version</span>:b.params.VERSION,<span class="attr">request</span>:<span class="string">"GetFeatureInfo"</span>,<span class="attr">exceptions</span>:b.params.EXCEPTIONS,<span class="attr">bbox</span>:<span class="keyword">this</span>.map.getExtent().toBBOX(<span class="literal">null</span>,b.reverseAxisOrder()),<span class="attr">feature_count</span>:<span class="keyword">this</span>.maxFeatures,<span class="attr">height</span>:<span class="keyword">this</span>.map.getSize().h,<span class="attr">width</span>:<span class="keyword">this</span>.map.getSize().w,<span class="attr">format</span>:d,<span class="attr">info_format</span>:b.params.INFO_FORMAT||<span class="keyword">this</span>.infoFormat&#125;,<span class="number">1.3</span>&lt;=<span class="built_in">parseFloat</span>(b.params.VERSION)?&#123;<span class="attr">crs</span>:g,<span class="attr">i</span>:<span class="built_in">parseInt</span>(c.x),<span class="attr">j</span>:<span class="built_in">parseInt</span>(c.y)&#125;:&#123;<span class="attr">srs</span>:g,<span class="attr">x</span>:<span class="built_in">parseInt</span>(c.x),<span class="attr">y</span>:<span class="built_in">parseInt</span>(c.y)&#125;);<span class="number">0</span>!=e.length&amp;&amp;(d=OpenLayers.Util.extend(&#123;<span class="attr">layers</span>:e,</span><br><span class="line">query_layers:e,<span class="attr">styles</span>:f&#125;,d));OpenLayers.Util.applyDefaults(d,<span class="keyword">this</span>.vendorParams);<span class="keyword">return</span>&#123;<span class="attr">url</span>:a,<span class="attr">params</span>:OpenLayers.Util.upperCaseObject(d),<span class="attr">callback</span>:<span class="function"><span class="keyword">function</span>(<span class="params">b</span>)</span>&#123;<span class="keyword">this</span>.handleResponse(c,b,a)&#125;,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;&#125;,<span class="attr">getStyleNames</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a.params.STYLES?a.params.STYLES:OpenLayers.Util.isArray(a.params.LAYERS)?<span class="built_in">Array</span>(a.params.LAYERS.length):a.params.LAYERS.replace(<span class="regexp">/[^,]/g</span>,<span class="string">""</span>)&#125;,<span class="attr">request</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.findLayers();<span class="keyword">if</span>(<span class="number">0</span>==c.length)<span class="keyword">this</span>.events.triggerEvent(<span class="string">"nogetfeatureinfo"</span>),OpenLayers.Element.removeClass(<span class="keyword">this</span>.map.viewPortDiv,</span><br><span class="line"><span class="string">"olCursorWait"</span>);<span class="keyword">else</span> <span class="keyword">if</span>(b=b||&#123;&#125;,!<span class="number">1</span>===<span class="keyword">this</span>.drillDown)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.buildWMSOptions(<span class="keyword">this</span>.url,c,a,c[<span class="number">0</span>].params.FORMAT),d=OpenLayers.Request.GET(c);!<span class="number">0</span>===b.hover&amp;&amp;(<span class="keyword">this</span>.hoverRequest=d)&#125;<span class="keyword">else</span>&#123;<span class="keyword">this</span>._numRequests=<span class="keyword">this</span>._requestCount=<span class="number">0</span>;<span class="keyword">this</span>.features=[];<span class="keyword">for</span>(<span class="keyword">var</span> d=&#123;&#125;,e,f=<span class="number">0</span>,g=c.length;f&lt;g;f++)&#123;<span class="keyword">var</span> h=c[f];e=OpenLayers.Util.isArray(h.url)?h.url[<span class="number">0</span>]:h.url;e <span class="keyword">in</span> d?d[e].push(h):(<span class="keyword">this</span>._numRequests++,d[e]=[h])&#125;<span class="keyword">for</span>(e <span class="keyword">in</span> d)c=d[e],c=<span class="keyword">this</span>.buildWMSOptions(e,c,a,c[<span class="number">0</span>].params.FORMAT),OpenLayers.Request.GET(c)&#125;&#125;,<span class="attr">triggerGetFeatureInfo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b,c</span>)</span>&#123;<span class="keyword">this</span>.events.triggerEvent(<span class="string">"getfeatureinfo"</span>,&#123;<span class="attr">text</span>:a.responseText,<span class="attr">features</span>:c,<span class="attr">request</span>:a,<span class="attr">xy</span>:b&#125;);OpenLayers.Element.removeClass(<span class="keyword">this</span>.map.viewPortDiv,<span class="string">"olCursorWait"</span>)&#125;,<span class="attr">handleResponse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=b.responseXML;d&amp;&amp;d.documentElement||(d=b.responseText);d=<span class="keyword">this</span>.format.read(d);!<span class="number">1</span>===<span class="keyword">this</span>.drillDown?<span class="keyword">this</span>.triggerGetFeatureInfo(b,a,d):(<span class="keyword">this</span>._requestCount++,<span class="keyword">this</span>._features=<span class="string">"object"</span>===<span class="keyword">this</span>.output?(<span class="keyword">this</span>._features||[]).concat(&#123;<span class="attr">url</span>:c,<span class="attr">features</span>:d&#125;):(<span class="keyword">this</span>._features||[]).concat(d),<span class="keyword">this</span>._requestCount===<span class="keyword">this</span>._numRequests&amp;&amp;</span><br><span class="line">(<span class="keyword">this</span>.triggerGetFeatureInfo(b,a,<span class="keyword">this</span>._features.concat()),<span class="keyword">delete</span> <span class="keyword">this</span>._features,<span class="keyword">delete</span> <span class="keyword">this</span>._requestCount,<span class="keyword">delete</span> <span class="keyword">this</span>._numRequests))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.WMSGetFeatureInfo"</span>&#125;);OpenLayers.Format.WMSCapabilities.v1_3_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_3,&#123;<span class="attr">version</span>:<span class="string">"1.3.0"</span>,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMSCapabilities.v1_3_0"</span>&#125;);OpenLayers.Format.SOSGetFeatureOfInterest=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">VERSION</span>:<span class="string">"1.0.0"</span>,<span class="attr">namespaces</span>:&#123;<span class="attr">sos</span>:<span class="string">"http://www.opengis.net/sos/1.0"</span>,<span class="attr">gml</span>:<span class="string">"http://www.opengis.net/gml"</span>,<span class="attr">sa</span>:<span class="string">"http://www.opengis.net/sampling/1.0"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&#125;,<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosAll.xsd"</span>,<span class="attr">defaultPrefix</span>:<span class="string">"sos"</span>,<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==</span><br><span class="line"><span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> b=&#123;<span class="attr">features</span>:[]&#125;;<span class="keyword">this</span>.readNode(a,b);a=[];<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=b.features.length;c&lt;d;c++)&#123;<span class="keyword">var</span> e=b.features[c];<span class="keyword">this</span>.internalProjection&amp;&amp;(<span class="keyword">this</span>.externalProjection&amp;&amp;e.components[<span class="number">0</span>])&amp;&amp;e.components[<span class="number">0</span>].transform(<span class="keyword">this</span>.externalProjection,<span class="keyword">this</span>.internalProjection);e=<span class="keyword">new</span> OpenLayers.Feature.Vector(e.components[<span class="number">0</span>],e.attributes);a.push(e)&#125;<span class="keyword">return</span> a&#125;,<span class="attr">readers</span>:&#123;<span class="attr">sa</span>:&#123;<span class="attr">SamplingPoint</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(!b.attributes)&#123;<span class="keyword">var</span> c=</span><br><span class="line">&#123;<span class="attr">attributes</span>:&#123;&#125;&#125;;b.features.push(c);b=c&#125;b.attributes.id=<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.gml,<span class="string">"id"</span>);<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">position</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;&#125;,<span class="attr">gml</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">FeatureCollection</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">featureMember</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">attributes</span>:&#123;&#125;&#125;;b.features.push(c);<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">name</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.attributes.name=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">pos</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.externalProjection||(<span class="keyword">this</span>.externalProjection=<span class="keyword">new</span> OpenLayers.Projection(a.getAttribute(<span class="string">"srsName"</span>)));</span><br><span class="line">OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(<span class="keyword">this</span>,[a,b])&#125;&#125;,OpenLayers.Format.GML.v3.prototype.readers.gml)&#125;,<span class="attr">writers</span>:&#123;<span class="attr">sos</span>:&#123;<span class="attr">GetFeatureOfInterest</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"GetFeatureOfInterest"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">version</span>:<span class="keyword">this</span>.VERSION,<span class="attr">service</span>:<span class="string">"SOS"</span>,<span class="string">"xsi:schemaLocation"</span>:<span class="keyword">this</span>.schemaLocation&#125;&#125;),c=<span class="number">0</span>,d=a.fois.length;c&lt;d;c++)<span class="keyword">this</span>.writeNode(<span class="string">"FeatureOfInterestId"</span>,&#123;<span class="attr">foi</span>:a.fois[c]&#125;,b);<span class="keyword">return</span> b&#125;,<span class="attr">FeatureOfInterestId</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"FeatureOfInterestId"</span>,&#123;<span class="attr">value</span>:a.foi&#125;)&#125;&#125;&#125;,</span><br><span class="line">CLASS_NAME:<span class="string">"OpenLayers.Format.SOSGetFeatureOfInterest"</span>&#125;);OpenLayers.Format.SOSGetObservation=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows"</span>,<span class="attr">gml</span>:<span class="string">"http://www.opengis.net/gml"</span>,<span class="attr">sos</span>:<span class="string">"http://www.opengis.net/sos/1.0"</span>,<span class="attr">ogc</span>:<span class="string">"http://www.opengis.net/ogc"</span>,<span class="attr">om</span>:<span class="string">"http://www.opengis.net/om/1.0"</span>,<span class="attr">sa</span>:<span class="string">"http://www.opengis.net/sampling/1.0"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>,<span class="attr">xsi</span>:<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&#125;,<span class="attr">regExes</span>:&#123;<span class="attr">trimSpace</span>:<span class="regexp">/^\s*|\s*$/g</span>,<span class="attr">removeSpace</span>:<span class="regexp">/\s*/g</span>,<span class="attr">splitSpace</span>:<span class="regexp">/\s+/</span>,<span class="attr">trimComma</span>:<span class="regexp">/\s*,\s*/g</span>&#125;,<span class="attr">VERSION</span>:<span class="string">"1.0.0"</span>,<span class="attr">schemaLocation</span>:<span class="string">"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosGetObservation.xsd"</span>,</span><br><span class="line">defaultPrefix:<span class="string">"sos"</span>,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> b=&#123;<span class="attr">measurements</span>:[],<span class="attr">observations</span>:[]&#125;;<span class="keyword">this</span>.readNode(a,b);<span class="keyword">return</span> b&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.writeNode(<span class="string">"sos:GetObservation"</span>,a);a.setAttribute(<span class="string">"xmlns:om"</span>,<span class="keyword">this</span>.namespaces.om);a.setAttribute(<span class="string">"xmlns:ogc"</span>,<span class="keyword">this</span>.namespaces.ogc);<span class="keyword">this</span>.setAttributeNS(a,<span class="keyword">this</span>.namespaces.xsi,<span class="string">"xsi:schemaLocation"</span>,<span class="keyword">this</span>.schemaLocation);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,</span><br><span class="line">[a])&#125;,<span class="attr">readers</span>:&#123;<span class="attr">om</span>:&#123;<span class="attr">ObservationCollection</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.id=<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.gml,<span class="string">"id"</span>);<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">member</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Measurement</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;b.measurements.push(c);<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">Observation</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;b.observations.push(c);<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">samplingTime</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;b.samplingTime=c;<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">observedProperty</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.observedProperty=<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.xlink,</span><br><span class="line"><span class="string">"href"</span>);<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">procedure</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.procedure=<span class="keyword">this</span>.getAttributeNS(a,<span class="keyword">this</span>.namespaces.xlink,<span class="string">"href"</span>);<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">featureOfInterest</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">features</span>:[]&#125;;b.fois=[];b.fois.push(c);<span class="keyword">this</span>.readChildNodes(a,c);<span class="keyword">for</span>(<span class="keyword">var</span> d=[],e=<span class="number">0</span>,f=c.features.length;e&lt;f;e++)&#123;<span class="keyword">var</span> g=c.features[e];d.push(<span class="keyword">new</span> OpenLayers.Feature.Vector(g.components[<span class="number">0</span>],g.attributes))&#125;c.features=d&#125;,<span class="attr">result</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;b.result=c;<span class="string">""</span>!==<span class="keyword">this</span>.getChildValue(a)?(c.value=<span class="keyword">this</span>.getChildValue(a),c.uom=</span><br><span class="line">a.getAttribute(<span class="string">"uom"</span>)):<span class="keyword">this</span>.readChildNodes(a,c)&#125;&#125;,<span class="attr">sa</span>:OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.sa,<span class="attr">gml</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">TimeInstant</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;b.timeInstant=c;<span class="keyword">this</span>.readChildNodes(a,c)&#125;,<span class="attr">timePosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.timePosition=<span class="keyword">this</span>.getChildValue(a)&#125;&#125;,OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.gml)&#125;,<span class="attr">writers</span>:&#123;<span class="attr">sos</span>:&#123;<span class="attr">GetObservation</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"GetObservation"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">version</span>:<span class="keyword">this</span>.VERSION,<span class="attr">service</span>:<span class="string">"SOS"</span>&#125;&#125;);<span class="keyword">this</span>.writeNode(<span class="string">"offering"</span>,</span><br><span class="line">a,b);a.eventTime&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"eventTime"</span>,a,b);<span class="keyword">for</span>(<span class="keyword">var</span> c <span class="keyword">in</span> a.procedures)<span class="keyword">this</span>.writeNode(<span class="string">"procedure"</span>,a.procedures[c],b);<span class="keyword">for</span>(<span class="keyword">var</span> d <span class="keyword">in</span> a.observedProperties)<span class="keyword">this</span>.writeNode(<span class="string">"observedProperty"</span>,a.observedProperties[d],b);a.foi&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"featureOfInterest"</span>,a.foi,b);<span class="keyword">this</span>.writeNode(<span class="string">"responseFormat"</span>,a,b);a.resultModel&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"resultModel"</span>,a,b);a.responseMode&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"responseMode"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">featureOfInterest</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"featureOfInterest"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"ObjectID"</span>,</span><br><span class="line">a.objectId,b);<span class="keyword">return</span> b&#125;,<span class="attr">ObjectID</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ObjectID"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">responseFormat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"responseFormat"</span>,&#123;<span class="attr">value</span>:a.responseFormat&#125;)&#125;,<span class="attr">procedure</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"procedure"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">offering</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"offering"</span>,&#123;<span class="attr">value</span>:a.offering&#125;)&#125;,<span class="attr">observedProperty</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"observedProperty"</span>,&#123;<span class="attr">value</span>:a&#125;)&#125;,<span class="attr">eventTime</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"eventTime"</span>);</span><br><span class="line"><span class="string">"latest"</span>===a.eventTime&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"ogc:TM_Equals"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">resultModel</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"resultModel"</span>,&#123;<span class="attr">value</span>:a.resultModel&#125;)&#125;,<span class="attr">responseMode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"responseMode"</span>,&#123;<span class="attr">value</span>:a.responseMode&#125;)&#125;&#125;,<span class="attr">ogc</span>:&#123;<span class="attr">TM_Equals</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:TM_Equals"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"ogc:PropertyName"</span>,&#123;<span class="attr">property</span>:<span class="string">"urn:ogc:data:time:iso8601"</span>&#125;,b);<span class="string">"latest"</span>===a.eventTime&amp;&amp;<span class="keyword">this</span>.writeNode(<span class="string">"gml:TimeInstant"</span>,&#123;<span class="attr">value</span>:<span class="string">"latest"</span>&#125;,b);<span class="keyword">return</span> b&#125;,<span class="attr">PropertyName</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"ogc:PropertyName"</span>,</span><br><span class="line">&#123;<span class="attr">value</span>:a.property&#125;)&#125;&#125;,<span class="attr">gml</span>:&#123;<span class="attr">TimeInstant</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:TimeInstant"</span>);<span class="keyword">this</span>.writeNode(<span class="string">"gml:timePosition"</span>,a,b);<span class="keyword">return</span> b&#125;,<span class="attr">timePosition</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.createElementNSPlus(<span class="string">"gml:timePosition"</span>,&#123;<span class="attr">value</span>:a.value&#125;)&#125;&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.SOSGetObservation"</span>&#125;);OpenLayers.Control.UTFGrid=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">autoActivate</span>:!<span class="number">0</span>,<span class="attr">layers</span>:<span class="literal">null</span>,<span class="attr">defaultHandlerOptions</span>:&#123;<span class="attr">delay</span>:<span class="number">300</span>,<span class="attr">pixelTolerance</span>:<span class="number">4</span>,<span class="attr">stopMove</span>:!<span class="number">1</span>,<span class="attr">single</span>:!<span class="number">0</span>,<span class="string">"double"</span>:!<span class="number">1</span>,<span class="attr">stopSingle</span>:!<span class="number">1</span>,<span class="attr">stopDouble</span>:!<span class="number">1</span>&#125;,<span class="attr">handlerMode</span>:<span class="string">"click"</span>,<span class="attr">setHandler</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.handlerMode=a;<span class="keyword">this</span>.resetHandler()&#125;,<span class="attr">resetHandler</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.handler&amp;&amp;(<span class="keyword">this</span>.handler.deactivate(),<span class="keyword">this</span>.handler.destroy(),<span class="keyword">this</span>.handler=<span class="literal">null</span>);<span class="string">"hover"</span>==<span class="keyword">this</span>.handlerMode?<span class="keyword">this</span>.handler=<span class="keyword">new</span> OpenLayers.Handler.Hover(<span class="keyword">this</span>,&#123;<span class="attr">pause</span>:<span class="keyword">this</span>.handleEvent,<span class="attr">move</span>:<span class="keyword">this</span>.reset&#125;,</span><br><span class="line"><span class="keyword">this</span>.handlerOptions):<span class="string">"click"</span>==<span class="keyword">this</span>.handlerMode?<span class="keyword">this</span>.handler=<span class="keyword">new</span> OpenLayers.Handler.Click(<span class="keyword">this</span>,&#123;<span class="attr">click</span>:<span class="keyword">this</span>.handleEvent&#125;,<span class="keyword">this</span>.handlerOptions):<span class="string">"move"</span>==<span class="keyword">this</span>.handlerMode&amp;&amp;(<span class="keyword">this</span>.handler=<span class="keyword">new</span> OpenLayers.Handler.Hover(<span class="keyword">this</span>,&#123;<span class="attr">pause</span>:<span class="keyword">this</span>.handleEvent,<span class="attr">move</span>:<span class="keyword">this</span>.handleEvent&#125;,<span class="keyword">this</span>.handlerOptions));<span class="keyword">return</span> <span class="keyword">this</span>.handler?!<span class="number">0</span>:!<span class="number">1</span>&#125;,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a||&#123;&#125;;a.handlerOptions=a.handlerOptions||<span class="keyword">this</span>.defaultHandlerOptions;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.resetHandler()&#125;,<span class="attr">handleEvent</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="literal">null</span>==</span><br><span class="line">a)<span class="keyword">this</span>.reset();<span class="keyword">else</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getLonLatFromPixel(a.xy);<span class="keyword">if</span>(b)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.findLayers();<span class="keyword">if</span>(<span class="number">0</span>&lt;c.length)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=&#123;&#125;,e,f,g=<span class="number">0</span>,h=c.length;g&lt;h;g++)e=c[g],f=OpenLayers.Util.indexOf(<span class="keyword">this</span>.map.layers,e),d[f]=e.getFeatureInfo(b);<span class="keyword">this</span>.callback(d,b,a.xy)&#125;&#125;&#125;&#125;,<span class="attr">callback</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;&#125;,<span class="attr">reset</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.callback(<span class="literal">null</span>)&#125;,<span class="attr">findLayers</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="keyword">this</span>.layers||<span class="keyword">this</span>.map.layers,b=[],c,d=a.length<span class="number">-1</span>;<span class="number">0</span>&lt;=d;--d)c=a[d],c <span class="keyword">instanceof</span> OpenLayers.Layer.UTFGrid&amp;&amp;b.push(c);<span class="keyword">return</span> b&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.UTFGrid"</span>&#125;);OpenLayers.Format.CQL=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">a</span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=e.pop();<span class="keyword">switch</span>(a.type)&#123;<span class="keyword">case</span> <span class="string">"LOGICAL"</span>:<span class="keyword">var</span> c=b(),g=b();<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Filter.Logical(&#123;<span class="attr">filters</span>:[g,c],<span class="attr">type</span>:f[a.text.toUpperCase()]&#125;);<span class="keyword">case</span> <span class="string">"NOT"</span>:<span class="keyword">return</span> a=b(),<span class="keyword">new</span> OpenLayers.Filter.Logical(&#123;<span class="attr">filters</span>:[a],<span class="attr">type</span>:OpenLayers.Filter.Logical.NOT&#125;);<span class="keyword">case</span> <span class="string">"BETWEEN"</span>:<span class="keyword">return</span> e.pop(),g=b(),a=b(),c=b(),<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">property</span>:c,<span class="attr">lowerBoundary</span>:a,<span class="attr">upperBoundary</span>:g,<span class="attr">type</span>:OpenLayers.Filter.Comparison.BETWEEN&#125;);<span class="keyword">case</span> <span class="string">"COMPARISON"</span>:<span class="keyword">return</span> g=</span><br><span class="line">b(),c=b(),<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">property</span>:c,<span class="attr">value</span>:g,<span class="attr">type</span>:d[a.text.toUpperCase()]&#125;);<span class="keyword">case</span> <span class="string">"IS_NULL"</span>:<span class="keyword">return</span> c=b(),<span class="keyword">new</span> OpenLayers.Filter.Comparison(&#123;<span class="attr">property</span>:c,<span class="attr">type</span>:d[a.text.toUpperCase()]&#125;);<span class="keyword">case</span> <span class="string">"VALUE"</span>:<span class="keyword">return</span>(c=a.text.match(<span class="regexp">/^'(.*)'$/</span>))?c[<span class="number">1</span>].replace(<span class="regexp">/''/g</span>,<span class="string">"'"</span>):<span class="built_in">Number</span>(a.text);<span class="keyword">case</span> <span class="string">"SPATIAL"</span>:<span class="keyword">switch</span>(a.text.toUpperCase())&#123;<span class="keyword">case</span> <span class="string">"BBOX"</span>:<span class="keyword">var</span> a=b(),c=b(),g=b(),h=b(),k=b();<span class="keyword">return</span> <span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:OpenLayers.Filter.Spatial.BBOX,<span class="attr">property</span>:k,<span class="attr">value</span>:OpenLayers.Bounds.fromArray([h,g,c,</span><br><span class="line">a])&#125;);<span class="keyword">case</span> <span class="string">"INTERSECTS"</span>:<span class="keyword">return</span> g=b(),c=b(),<span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:OpenLayers.Filter.Spatial.INTERSECTS,<span class="attr">property</span>:c,<span class="attr">value</span>:g&#125;);<span class="keyword">case</span> <span class="string">"WITHIN"</span>:<span class="keyword">return</span> g=b(),c=b(),<span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:OpenLayers.Filter.Spatial.WITHIN,<span class="attr">property</span>:c,<span class="attr">value</span>:g&#125;);<span class="keyword">case</span> <span class="string">"CONTAINS"</span>:<span class="keyword">return</span> g=b(),c=b(),<span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:OpenLayers.Filter.Spatial.CONTAINS,<span class="attr">property</span>:c,<span class="attr">value</span>:g&#125;);<span class="keyword">case</span> <span class="string">"DWITHIN"</span>:<span class="keyword">return</span> a=b(),g=b(),c=b(),<span class="keyword">new</span> OpenLayers.Filter.Spatial(&#123;<span class="attr">type</span>:OpenLayers.Filter.Spatial.DWITHIN,<span class="attr">value</span>:g,</span><br><span class="line">property:c,<span class="attr">distance</span>:<span class="built_in">Number</span>(a)&#125;)&#125;<span class="keyword">case</span> <span class="string">"GEOMETRY"</span>:<span class="keyword">return</span> OpenLayers.Geometry.fromWKT(a.text);<span class="keyword">default</span>:<span class="keyword">return</span> a.text&#125;&#125;<span class="keyword">for</span>(<span class="keyword">var</span> c=[],e=[];a.length;)&#123;<span class="keyword">var</span> g=a.shift();<span class="keyword">switch</span>(g.type)&#123;<span class="keyword">case</span> <span class="string">"PROPERTY"</span>:<span class="keyword">case</span> <span class="string">"GEOMETRY"</span>:<span class="keyword">case</span> <span class="string">"VALUE"</span>:e.push(g);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"COMPARISON"</span>:<span class="keyword">case</span> <span class="string">"BETWEEN"</span>:<span class="keyword">case</span> <span class="string">"IS_NULL"</span>:<span class="keyword">case</span> <span class="string">"LOGICAL"</span>:<span class="keyword">for</span>(<span class="keyword">var</span> k=h[g.type];<span class="number">0</span>&lt;c.length&amp;&amp;h[c[c.length<span class="number">-1</span>].type]&lt;=k;)e.push(c.pop());c.push(g);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"SPATIAL"</span>:<span class="keyword">case</span> <span class="string">"NOT"</span>:<span class="keyword">case</span> <span class="string">"LPAREN"</span>:c.push(g);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">"RPAREN"</span>:<span class="keyword">for</span>(;<span class="number">0</span>&lt;c.length&amp;&amp;<span class="string">"LPAREN"</span>!=c[c.length<span class="number">-1</span>].type;)e.push(c.pop());</span><br><span class="line">c.pop();<span class="number">0</span>&lt;c.length&amp;&amp;<span class="string">"SPATIAL"</span>==c[c.length<span class="number">-1</span>].type&amp;&amp;e.push(c.pop());<span class="keyword">case</span> <span class="string">"COMMA"</span>:<span class="keyword">case</span> <span class="string">"END"</span>:<span class="keyword">break</span>;<span class="keyword">default</span>:<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"Unknown token type "</span>+g.type);&#125;&#125;<span class="keyword">for</span>(;<span class="number">0</span>&lt;c.length;)e.push(c.pop());a=b();<span class="keyword">if</span>(<span class="number">0</span>&lt;e.length)&#123;a=<span class="string">"Remaining tokens after building AST: \n"</span>;<span class="keyword">for</span>(c=e.length<span class="number">-1</span>;<span class="number">0</span>&lt;=c;c--)a+=e[c].type+<span class="string">": "</span>+e[c].text+<span class="string">"\n"</span>;<span class="keyword">throw</span> <span class="built_in">Error</span>(a);&#125;<span class="keyword">return</span> a&#125;<span class="keyword">var</span> b=&#123;<span class="attr">PROPERTY</span>:<span class="regexp">/^[_a-zA-Z]\w*/</span>,<span class="attr">COMPARISON</span>:<span class="regexp">/^(=|&lt;&gt;|&lt;=|&lt;|&gt;=|&gt;|LIKE)/i</span>,<span class="attr">IS_NULL</span>:<span class="regexp">/^IS NULL/i</span>,<span class="attr">COMMA</span>:<span class="regexp">/^,/</span>,<span class="attr">LOGICAL</span>:<span class="regexp">/^(AND|OR)/i</span>,<span class="attr">VALUE</span>:<span class="regexp">/^('([^']|'')*'|\d+(\.\d*)?|\.\d+)/</span>,<span class="attr">LPAREN</span>:<span class="regexp">/^\(/</span>,</span><br><span class="line">RPAREN:<span class="regexp">/^\)/</span>,<span class="attr">SPATIAL</span>:<span class="regexp">/^(BBOX|INTERSECTS|DWITHIN|WITHIN|CONTAINS)/i</span>,<span class="attr">NOT</span>:<span class="regexp">/^NOT/i</span>,<span class="attr">BETWEEN</span>:<span class="regexp">/^BETWEEN/i</span>,<span class="attr">GEOMETRY</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="regexp">/^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON|GEOMETRYCOLLECTION)/</span>.exec(a);<span class="keyword">if</span>(b)&#123;<span class="keyword">var</span> c=a.length,b=a.indexOf(<span class="string">"("</span>,b[<span class="number">0</span>].length);<span class="keyword">if</span>(<span class="number">-1</span>&lt;b)<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">1</span>;b&lt;c&amp;&amp;<span class="number">0</span>&lt;d;)<span class="keyword">switch</span>(b++,a.charAt(b))&#123;<span class="keyword">case</span> <span class="string">"("</span>:d++;<span class="keyword">break</span>;<span class="keyword">case</span> <span class="string">")"</span>:d--&#125;<span class="keyword">return</span>[a.substr(<span class="number">0</span>,b+<span class="number">1</span>)]&#125;&#125;,<span class="attr">END</span>:<span class="regexp">/^$/</span>&#125;,c=&#123;<span class="attr">LPAREN</span>:[<span class="string">"GEOMETRY"</span>,<span class="string">"SPATIAL"</span>,<span class="string">"PROPERTY"</span>,<span class="string">"VALUE"</span>,<span class="string">"LPAREN"</span>],<span class="attr">RPAREN</span>:[<span class="string">"NOT"</span>,<span class="string">"LOGICAL"</span>,<span class="string">"END"</span>,<span class="string">"RPAREN"</span>],<span class="attr">PROPERTY</span>:[<span class="string">"COMPARISON"</span>,</span><br><span class="line"><span class="string">"BETWEEN"</span>,<span class="string">"COMMA"</span>,<span class="string">"IS_NULL"</span>],<span class="attr">BETWEEN</span>:[<span class="string">"VALUE"</span>],<span class="attr">IS_NULL</span>:[<span class="string">"END"</span>],<span class="attr">COMPARISON</span>:[<span class="string">"VALUE"</span>],<span class="attr">COMMA</span>:[<span class="string">"GEOMETRY"</span>,<span class="string">"VALUE"</span>,<span class="string">"PROPERTY"</span>],<span class="attr">VALUE</span>:[<span class="string">"LOGICAL"</span>,<span class="string">"COMMA"</span>,<span class="string">"RPAREN"</span>,<span class="string">"END"</span>],<span class="attr">SPATIAL</span>:[<span class="string">"LPAREN"</span>],<span class="attr">LOGICAL</span>:[<span class="string">"NOT"</span>,<span class="string">"VALUE"</span>,<span class="string">"SPATIAL"</span>,<span class="string">"PROPERTY"</span>,<span class="string">"LPAREN"</span>],<span class="attr">NOT</span>:[<span class="string">"PROPERTY"</span>,<span class="string">"LPAREN"</span>],<span class="attr">GEOMETRY</span>:[<span class="string">"COMMA"</span>,<span class="string">"RPAREN"</span>]&#125;,d=&#123;<span class="string">"="</span>:OpenLayers.Filter.Comparison.EQUAL_TO,<span class="string">"&lt;&gt;"</span>:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,<span class="string">"&lt;"</span>:OpenLayers.Filter.Comparison.LESS_THAN,<span class="string">"&lt;="</span>:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO,<span class="string">"&gt;"</span>:OpenLayers.Filter.Comparison.GREATER_THAN,</span><br><span class="line"><span class="string">"&gt;="</span>:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO,<span class="attr">LIKE</span>:OpenLayers.Filter.Comparison.LIKE,<span class="attr">BETWEEN</span>:OpenLayers.Filter.Comparison.BETWEEN,<span class="string">"IS NULL"</span>:OpenLayers.Filter.Comparison.IS_NULL&#125;,e=&#123;&#125;,f=&#123;<span class="attr">AND</span>:OpenLayers.Filter.Logical.AND,<span class="attr">OR</span>:OpenLayers.Filter.Logical.OR&#125;,g=&#123;&#125;,h=&#123;<span class="attr">RPAREN</span>:<span class="number">3</span>,<span class="attr">LOGICAL</span>:<span class="number">2</span>,<span class="attr">COMPARISON</span>:<span class="number">1</span>&#125;,k;<span class="keyword">for</span>(k <span class="keyword">in</span> d)d.hasOwnProperty(k)&amp;&amp;(e[d[k]]=k);<span class="keyword">for</span>(k <span class="keyword">in</span> f)f.hasOwnProperty(k)&amp;&amp;(g[f[k]]=k);<span class="keyword">return</span> OpenLayers.Class(OpenLayers.Format,&#123;<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;<span class="keyword">var</span> e=d;d=[];<span class="keyword">var</span> f,g=[<span class="string">"NOT"</span>,<span class="string">"GEOMETRY"</span>,<span class="string">"SPATIAL"</span>,</span><br><span class="line"><span class="string">"PROPERTY"</span>,<span class="string">"LPAREN"</span>];<span class="keyword">do</span>&#123;<span class="attr">a</span>:&#123;f=g;<span class="keyword">for</span>(<span class="keyword">var</span> h=<span class="keyword">void</span> <span class="number">0</span>,g=<span class="keyword">void</span> <span class="number">0</span>,k=f.length,h=<span class="number">0</span>;h&lt;k;h++)&#123;<span class="keyword">var</span> g=f[h],s=b[g]<span class="keyword">instanceof</span> <span class="built_in">RegExp</span>?b[g].exec(e):(<span class="number">0</span>,b[g])(e);<span class="keyword">if</span>(s)&#123;f=s[<span class="number">0</span>];e=e.substr(f.length).replace(<span class="regexp">/^\s*/</span>,<span class="string">""</span>);f=&#123;<span class="attr">type</span>:g,<span class="attr">text</span>:f,<span class="attr">remainder</span>:e&#125;;<span class="keyword">break</span> a&#125;&#125;d=<span class="string">"ERROR: In parsing: ["</span>+e+<span class="string">"], expected one of: "</span>;<span class="keyword">for</span>(h=<span class="number">0</span>;h&lt;k;h++)g=f[h],d+=<span class="string">"\n    "</span>+g+<span class="string">": "</span>+b[g];<span class="keyword">throw</span> <span class="built_in">Error</span>(d);&#125;e=f.remainder;g=c[f.type];<span class="keyword">if</span>(<span class="string">"END"</span>!=f.type&amp;&amp;!g)<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"No follows list for "</span>+f.type);d.push(f)&#125;<span class="keyword">while</span>(<span class="string">"END"</span>!=f.type);d=a(d);<span class="keyword">this</span>.keepData&amp;&amp;(<span class="keyword">this</span>.data=d);</span><br><span class="line"><span class="keyword">return</span> d&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(a <span class="keyword">instanceof</span> OpenLayers.Geometry)<span class="keyword">return</span> a.toString();<span class="keyword">switch</span>(a.CLASS_NAME)&#123;<span class="keyword">case</span> <span class="string">"OpenLayers.Filter.Spatial"</span>:<span class="keyword">switch</span>(a.type)&#123;<span class="keyword">case</span> OpenLayers.Filter.Spatial.BBOX:<span class="keyword">return</span><span class="string">"BBOX("</span>+a.property+<span class="string">","</span>+a.value.toBBOX()+<span class="string">")"</span>;<span class="keyword">case</span> OpenLayers.Filter.Spatial.DWITHIN:<span class="keyword">return</span><span class="string">"DWITHIN("</span>+a.property+<span class="string">", "</span>+<span class="keyword">this</span>.write(a.value)+<span class="string">", "</span>+a.distance+<span class="string">")"</span>;<span class="keyword">case</span> OpenLayers.Filter.Spatial.WITHIN:<span class="keyword">return</span><span class="string">"WITHIN("</span>+a.property+<span class="string">", "</span>+<span class="keyword">this</span>.write(a.value)+<span class="string">")"</span>;<span class="keyword">case</span> OpenLayers.Filter.Spatial.INTERSECTS:<span class="keyword">return</span><span class="string">"INTERSECTS("</span>+</span><br><span class="line">a.property+<span class="string">", "</span>+<span class="keyword">this</span>.write(a.value)+<span class="string">")"</span>;<span class="keyword">case</span> OpenLayers.Filter.Spatial.CONTAINS:<span class="keyword">return</span><span class="string">"CONTAINS("</span>+a.property+<span class="string">", "</span>+<span class="keyword">this</span>.write(a.value)+<span class="string">")"</span>;<span class="keyword">default</span>:<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"Unknown spatial filter type: "</span>+a.type);&#125;<span class="keyword">case</span> <span class="string">"OpenLayers.Filter.Logical"</span>:<span class="keyword">if</span>(a.type==OpenLayers.Filter.Logical.NOT)<span class="keyword">return</span><span class="string">"NOT ("</span>+<span class="keyword">this</span>.write(a.filters[<span class="number">0</span>])+<span class="string">")"</span>;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="string">"("</span>,c=!<span class="number">0</span>,d=<span class="number">0</span>;d&lt;a.filters.length;d++)c?c=!<span class="number">1</span>:b+=<span class="string">") "</span>+g[a.type]+<span class="string">" ("</span>,b+=<span class="keyword">this</span>.write(a.filters[d]);<span class="keyword">return</span> b+<span class="string">")"</span>;<span class="keyword">case</span> <span class="string">"OpenLayers.Filter.Comparison"</span>:<span class="keyword">return</span> a.type==OpenLayers.Filter.Comparison.BETWEEN?</span><br><span class="line">a.property+<span class="string">" BETWEEN "</span>+<span class="keyword">this</span>.write(a.lowerBoundary)+<span class="string">" AND "</span>+<span class="keyword">this</span>.write(a.upperBoundary):<span class="literal">null</span>!==a.value?a.property+<span class="string">" "</span>+e[a.type]+<span class="string">" "</span>+<span class="keyword">this</span>.write(a.value):a.property+<span class="string">" "</span>+e[a.type];<span class="keyword">case</span> <span class="keyword">void</span> <span class="number">0</span>:<span class="keyword">if</span>(<span class="string">"string"</span>===<span class="keyword">typeof</span> a)<span class="keyword">return</span><span class="string">"'"</span>+a.replace(<span class="regexp">/'/g</span>,<span class="string">"''"</span>)+<span class="string">"'"</span>;<span class="keyword">if</span>(<span class="string">"number"</span>===<span class="keyword">typeof</span> a)<span class="keyword">return</span> <span class="built_in">String</span>(a);<span class="keyword">default</span>:<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"Can't encode: "</span>+a.CLASS_NAME+<span class="string">" "</span>+a);&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.CQL"</span>&#125;)&#125;();OpenLayers.Control.Split=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">source</span>:<span class="literal">null</span>,<span class="attr">sourceOptions</span>:<span class="literal">null</span>,<span class="attr">tolerance</span>:<span class="literal">null</span>,<span class="attr">edge</span>:!<span class="number">0</span>,<span class="attr">deferDelete</span>:!<span class="number">1</span>,<span class="attr">mutual</span>:!<span class="number">0</span>,<span class="attr">targetFilter</span>:<span class="literal">null</span>,<span class="attr">sourceFilter</span>:<span class="literal">null</span>,<span class="attr">handler</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.options=a||&#123;&#125;;<span class="keyword">this</span>.options.source&amp;&amp;<span class="keyword">this</span>.setSource(<span class="keyword">this</span>.options.source)&#125;,<span class="attr">setSource</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.active?(<span class="keyword">this</span>.deactivate(),<span class="keyword">this</span>.handler&amp;&amp;(<span class="keyword">this</span>.handler.destroy(),<span class="keyword">delete</span> <span class="keyword">this</span>.handler),<span class="keyword">this</span>.source=a,<span class="keyword">this</span>.activate()):<span class="keyword">this</span>.source=</span><br><span class="line">a&#125;,<span class="attr">activate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Control.prototype.activate.call(<span class="keyword">this</span>);<span class="keyword">if</span>(a)<span class="keyword">if</span>(!<span class="keyword">this</span>.source)<span class="keyword">this</span>.handler||(<span class="keyword">this</span>.handler=<span class="keyword">new</span> OpenLayers.Handler.Path(<span class="keyword">this</span>,&#123;<span class="attr">done</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.onSketchComplete(&#123;<span class="attr">feature</span>:<span class="keyword">new</span> OpenLayers.Feature.Vector(a)&#125;)&#125;&#125;,&#123;<span class="attr">layerOptions</span>:<span class="keyword">this</span>.sourceOptions&#125;)),<span class="keyword">this</span>.handler.activate();<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.source.events)<span class="keyword">this</span>.source.events.on(&#123;<span class="attr">sketchcomplete</span>:<span class="keyword">this</span>.onSketchComplete,<span class="attr">afterfeaturemodified</span>:<span class="keyword">this</span>.afterFeatureModified,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">return</span> a&#125;,<span class="attr">deactivate</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=OpenLayers.Control.prototype.deactivate.call(<span class="keyword">this</span>);</span><br><span class="line">a&amp;&amp;<span class="keyword">this</span>.source&amp;&amp;<span class="keyword">this</span>.source.events&amp;&amp;<span class="keyword">this</span>.source.events.un(&#123;<span class="attr">sketchcomplete</span>:<span class="keyword">this</span>.onSketchComplete,<span class="attr">afterfeaturemodified</span>:<span class="keyword">this</span>.afterFeatureModified,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">return</span> a&#125;,<span class="attr">onSketchComplete</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.feature=<span class="literal">null</span>;<span class="keyword">return</span>!<span class="keyword">this</span>.considerSplit(a.feature)&#125;,<span class="attr">afterFeatureModified</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a.modified&amp;&amp;<span class="string">"function"</span>===<span class="keyword">typeof</span> a.feature.geometry.split&amp;&amp;(<span class="keyword">this</span>.feature=a.feature,<span class="keyword">this</span>.considerSplit(a.feature))&#125;,<span class="attr">removeByGeometry</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;++c)<span class="keyword">if</span>(a[c].geometry===b)&#123;a.splice(c,<span class="number">1</span>);<span class="keyword">break</span>&#125;&#125;,</span><br><span class="line">isEligible:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a.geometry?a.state!==OpenLayers.State.DELETE&amp;&amp;<span class="string">"function"</span>===<span class="keyword">typeof</span> a.geometry.split&amp;&amp;<span class="keyword">this</span>.feature!==a&amp;&amp;(!<span class="keyword">this</span>.targetFilter||<span class="keyword">this</span>.targetFilter.evaluate(a.attributes)):!<span class="number">1</span>&#125;,<span class="attr">considerSplit</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=!<span class="number">1</span>,c=!<span class="number">1</span>;<span class="keyword">if</span>(!<span class="keyword">this</span>.sourceFilter||<span class="keyword">this</span>.sourceFilter.evaluate(a.attributes))&#123;<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="keyword">this</span>.layer&amp;&amp;<span class="keyword">this</span>.layer.features||[],e,f,g=[],h=[],k=<span class="keyword">this</span>.layer===<span class="keyword">this</span>.source&amp;&amp;<span class="keyword">this</span>.mutual,l=&#123;<span class="attr">edge</span>:<span class="keyword">this</span>.edge,<span class="attr">tolerance</span>:<span class="keyword">this</span>.tolerance,<span class="attr">mutual</span>:k&#125;,m=[a.geometry],n,p,q,r=<span class="number">0</span>,s=d.length;r&lt;s;++r)<span class="keyword">if</span>(n=</span><br><span class="line">d[r],<span class="keyword">this</span>.isEligible(n))&#123;p=[n.geometry];<span class="keyword">for</span>(<span class="keyword">var</span> t=<span class="number">0</span>;t&lt;m.length;++t)&#123;q=m[t];<span class="keyword">for</span>(<span class="keyword">var</span> u=<span class="number">0</span>;u&lt;p.length;++u)<span class="keyword">if</span>(e=p[u],q.getBounds().intersectsBounds(e.getBounds())&amp;&amp;(e=q.split(e,l)))f=<span class="keyword">this</span>.events.triggerEvent(<span class="string">"beforesplit"</span>,&#123;<span class="attr">source</span>:a,<span class="attr">target</span>:n&#125;),!<span class="number">1</span>!==f&amp;&amp;(k&amp;&amp;(f=e[<span class="number">0</span>],<span class="number">1</span>&lt;f.length&amp;&amp;(f.unshift(t,<span class="number">1</span>),<span class="built_in">Array</span>.prototype.splice.apply(m,f),t+=f.length<span class="number">-3</span>),e=e[<span class="number">1</span>]),<span class="number">1</span>&lt;e.length&amp;&amp;(e.unshift(u,<span class="number">1</span>),<span class="built_in">Array</span>.prototype.splice.apply(p,e),u+=e.length<span class="number">-3</span>))&#125;p&amp;&amp;<span class="number">1</span>&lt;p.length&amp;&amp;(<span class="keyword">this</span>.geomsToFeatures(n,p),<span class="keyword">this</span>.events.triggerEvent(<span class="string">"split"</span>,&#123;<span class="attr">original</span>:n,</span><br><span class="line">features:p&#125;),<span class="built_in">Array</span>.prototype.push.apply(g,p),h.push(n),c=!<span class="number">0</span>)&#125;m&amp;&amp;<span class="number">1</span>&lt;m.length&amp;&amp;(<span class="keyword">this</span>.geomsToFeatures(a,m),<span class="keyword">this</span>.events.triggerEvent(<span class="string">"split"</span>,&#123;<span class="attr">original</span>:a,<span class="attr">features</span>:m&#125;),<span class="built_in">Array</span>.prototype.push.apply(g,m),h.push(a),b=!<span class="number">0</span>);<span class="keyword">if</span>(b||c)&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.deferDelete)&#123;d=[];r=<span class="number">0</span>;<span class="keyword">for</span>(s=h.length;r&lt;s;++r)c=h[r],c.state===OpenLayers.State.INSERT?d.push(c):(c.state=OpenLayers.State.DELETE,<span class="keyword">this</span>.layer.drawFeature(c));<span class="keyword">this</span>.layer.destroyFeatures(d,&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;);r=<span class="number">0</span>;<span class="keyword">for</span>(s=g.length;r&lt;s;++r)g[r].state=OpenLayers.State.INSERT&#125;<span class="keyword">else</span> <span class="keyword">this</span>.layer.destroyFeatures(h,</span><br><span class="line">&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;);<span class="keyword">this</span>.layer.addFeatures(g,&#123;<span class="attr">silent</span>:!<span class="number">0</span>&#125;);<span class="keyword">this</span>.events.triggerEvent(<span class="string">"aftersplit"</span>,&#123;<span class="attr">source</span>:a,<span class="attr">features</span>:g&#125;)&#125;&#125;<span class="keyword">return</span> b&#125;,<span class="attr">geomsToFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=a.clone();<span class="keyword">delete</span> c.geometry;<span class="keyword">for</span>(<span class="keyword">var</span> d,e=<span class="number">0</span>,f=b.length;e&lt;f;++e)d=c.clone(),d.geometry=b[e],d.state=OpenLayers.State.INSERT,b[e]=d&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.active&amp;&amp;<span class="keyword">this</span>.deactivate();OpenLayers.Control.prototype.destroy.call(<span class="keyword">this</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.Split"</span>&#125;);OpenLayers.Layer.WMTS=OpenLayers.Class(OpenLayers.Layer.Grid,&#123;<span class="attr">isBaseLayer</span>:!<span class="number">0</span>,<span class="attr">version</span>:<span class="string">"1.0.0"</span>,<span class="attr">requestEncoding</span>:<span class="string">"KVP"</span>,<span class="attr">url</span>:<span class="literal">null</span>,<span class="attr">layer</span>:<span class="literal">null</span>,<span class="attr">matrixSet</span>:<span class="literal">null</span>,<span class="attr">style</span>:<span class="literal">null</span>,<span class="attr">format</span>:<span class="string">"image/jpeg"</span>,<span class="attr">tileOrigin</span>:<span class="literal">null</span>,<span class="attr">tileFullExtent</span>:<span class="literal">null</span>,<span class="attr">formatSuffix</span>:<span class="literal">null</span>,<span class="attr">matrixIds</span>:<span class="literal">null</span>,<span class="attr">dimensions</span>:<span class="literal">null</span>,<span class="attr">params</span>:<span class="literal">null</span>,<span class="attr">zoomOffset</span>:<span class="number">0</span>,<span class="attr">serverResolutions</span>:<span class="literal">null</span>,<span class="attr">formatSuffixMap</span>:&#123;<span class="string">"image/png"</span>:<span class="string">"png"</span>,<span class="string">"image/png8"</span>:<span class="string">"png"</span>,<span class="string">"image/png24"</span>:<span class="string">"png"</span>,<span class="string">"image/png32"</span>:<span class="string">"png"</span>,<span class="attr">png</span>:<span class="string">"png"</span>,<span class="string">"image/jpeg"</span>:<span class="string">"jpg"</span>,<span class="string">"image/jpg"</span>:<span class="string">"jpg"</span>,<span class="attr">jpeg</span>:<span class="string">"jpg"</span>,<span class="attr">jpg</span>:<span class="string">"jpg"</span>&#125;,<span class="attr">matrix</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=</span><br><span class="line">&#123;<span class="attr">url</span>:!<span class="number">0</span>,<span class="attr">layer</span>:!<span class="number">0</span>,<span class="attr">style</span>:!<span class="number">0</span>,<span class="attr">matrixSet</span>:!<span class="number">0</span>&#125;,c;<span class="keyword">for</span>(c <span class="keyword">in</span> b)<span class="keyword">if</span>(!(c <span class="keyword">in</span> a))<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"Missing property '"</span>+c+<span class="string">"' in layer configuration."</span>);a.params=OpenLayers.Util.upperCaseObject(a.params);OpenLayers.Layer.Grid.prototype.initialize.apply(<span class="keyword">this</span>,[a.name,a.url,a.params,a]);<span class="keyword">this</span>.formatSuffix||(<span class="keyword">this</span>.formatSuffix=<span class="keyword">this</span>.formatSuffixMap[<span class="keyword">this</span>.format]||<span class="keyword">this</span>.format.split(<span class="string">"/"</span>).pop());<span class="keyword">if</span>(<span class="keyword">this</span>.matrixIds&amp;&amp;(a=<span class="keyword">this</span>.matrixIds.length)&amp;&amp;<span class="string">"string"</span>===<span class="keyword">typeof</span> <span class="keyword">this</span>.matrixIds[<span class="number">0</span>])<span class="keyword">for</span>(b=<span class="keyword">this</span>.matrixIds,<span class="keyword">this</span>.matrixIds=<span class="built_in">Array</span>(a),c=<span class="number">0</span>;c&lt;a;++c)<span class="keyword">this</span>.matrixIds[c]=</span><br><span class="line">&#123;<span class="attr">identifier</span>:b[c]&#125;&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Layer.Grid.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">updateMatrixProperties</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(<span class="keyword">this</span>.matrix=<span class="keyword">this</span>.getMatrix())<span class="keyword">this</span>.matrix.topLeftCorner&amp;&amp;(<span class="keyword">this</span>.tileOrigin=<span class="keyword">this</span>.matrix.topLeftCorner),<span class="keyword">this</span>.matrix.tileWidth&amp;&amp;<span class="keyword">this</span>.matrix.tileHeight&amp;&amp;(<span class="keyword">this</span>.tileSize=<span class="keyword">new</span> OpenLayers.Size(<span class="keyword">this</span>.matrix.tileWidth,<span class="keyword">this</span>.matrix.tileHeight)),<span class="keyword">this</span>.tileOrigin||(<span class="keyword">this</span>.tileOrigin=<span class="keyword">new</span> OpenLayers.LonLat(<span class="keyword">this</span>.maxExtent.left,<span class="keyword">this</span>.maxExtent.top)),<span class="keyword">this</span>.tileFullExtent||(<span class="keyword">this</span>.tileFullExtent=</span><br><span class="line"><span class="keyword">this</span>.maxExtent)&#125;,<span class="attr">moveTo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;!b&amp;&amp;<span class="keyword">this</span>.matrix||<span class="keyword">this</span>.updateMatrixProperties();<span class="keyword">return</span> OpenLayers.Layer.Grid.prototype.moveTo.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="literal">null</span>==a&amp;&amp;(a=<span class="keyword">new</span> OpenLayers.Layer.WMTS(<span class="keyword">this</span>.options));<span class="keyword">return</span> a=OpenLayers.Layer.Grid.prototype.clone.apply(<span class="keyword">this</span>,[a])&#125;,<span class="attr">getIdentifier</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.getServerZoom()&#125;,<span class="attr">getMatrix</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a;<span class="keyword">if</span>(<span class="keyword">this</span>.matrixIds&amp;&amp;<span class="number">0</span>!==<span class="keyword">this</span>.matrixIds.length)<span class="keyword">if</span>(<span class="string">"scaleDenominator"</span><span class="keyword">in</span> <span class="keyword">this</span>.matrixIds[<span class="number">0</span>])<span class="keyword">for</span>(<span class="keyword">var</span> b=OpenLayers.METERS_PER_INCH*OpenLayers.INCHES_PER_UNIT[<span class="keyword">this</span>.units]*</span><br><span class="line"><span class="keyword">this</span>.getServerResolution()/<span class="number">2.8E-4</span>,c=<span class="built_in">Number</span>.POSITIVE_INFINITY,d,e=<span class="number">0</span>,f=<span class="keyword">this</span>.matrixIds.length;e&lt;f;++e)d=<span class="built_in">Math</span>.abs(<span class="number">1</span>-<span class="keyword">this</span>.matrixIds[e].scaleDenominator/b),d&lt;c&amp;&amp;(c=d,a=<span class="keyword">this</span>.matrixIds[e]);<span class="keyword">else</span> a=<span class="keyword">this</span>.matrixIds[<span class="keyword">this</span>.getIdentifier()];<span class="keyword">else</span> a=&#123;<span class="attr">identifier</span>:<span class="keyword">this</span>.getIdentifier()&#125;;<span class="keyword">return</span> a&#125;,<span class="attr">getTileInfo</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.getServerResolution(),c=(a.lon-<span class="keyword">this</span>.tileOrigin.lon)/(b*<span class="keyword">this</span>.tileSize.w);a=(<span class="keyword">this</span>.tileOrigin.lat-a.lat)/(b*<span class="keyword">this</span>.tileSize.h);<span class="keyword">var</span> b=<span class="built_in">Math</span>.floor(c),d=<span class="built_in">Math</span>.floor(a);<span class="keyword">return</span>&#123;<span class="attr">col</span>:b,<span class="attr">row</span>:d,<span class="attr">i</span>:<span class="built_in">Math</span>.floor((c-</span><br><span class="line">b)*<span class="keyword">this</span>.tileSize.w),<span class="attr">j</span>:<span class="built_in">Math</span>.floor((a-d)*<span class="keyword">this</span>.tileSize.h)&#125;&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.adjustBounds(a);<span class="keyword">var</span> b=<span class="string">""</span>;<span class="keyword">if</span>(!<span class="keyword">this</span>.tileFullExtent||<span class="keyword">this</span>.tileFullExtent.intersectsBounds(a))&#123;a=a.getCenterLonLat();<span class="keyword">var</span> c=<span class="keyword">this</span>.getTileInfo(a);a=<span class="keyword">this</span>.dimensions;<span class="keyword">var</span> d,b=OpenLayers.Util.isArray(<span class="keyword">this</span>.url)?<span class="keyword">this</span>.selectUrl([<span class="keyword">this</span>.version,<span class="keyword">this</span>.style,<span class="keyword">this</span>.matrixSet,<span class="keyword">this</span>.matrix.identifier,c.row,c.col].join(),<span class="keyword">this</span>.url):<span class="keyword">this</span>.url;<span class="keyword">if</span>(<span class="string">"REST"</span>===<span class="keyword">this</span>.requestEncoding.toUpperCase())<span class="keyword">if</span>(d=<span class="keyword">this</span>.params,<span class="number">-1</span>!==b.indexOf(<span class="string">"&#123;"</span>))&#123;b=b.replace(<span class="regexp">/\&#123;/g</span>,</span><br><span class="line"><span class="string">"$&#123;"</span>);c=&#123;<span class="attr">style</span>:<span class="keyword">this</span>.style,<span class="attr">Style</span>:<span class="keyword">this</span>.style,<span class="attr">TileMatrixSet</span>:<span class="keyword">this</span>.matrixSet,<span class="attr">TileMatrix</span>:<span class="keyword">this</span>.matrix.identifier,<span class="attr">TileRow</span>:c.row,<span class="attr">TileCol</span>:c.col&#125;;<span class="keyword">if</span>(a)&#123;<span class="keyword">var</span> e,f;<span class="keyword">for</span>(f=a.length<span class="number">-1</span>;<span class="number">0</span>&lt;=f;--f)e=a[f],c[e]=d[e.toUpperCase()]&#125;b=OpenLayers.String.format(b,c)&#125;<span class="keyword">else</span>&#123;e=<span class="keyword">this</span>.version+<span class="string">"/"</span>+<span class="keyword">this</span>.layer+<span class="string">"/"</span>+<span class="keyword">this</span>.style+<span class="string">"/"</span>;<span class="keyword">if</span>(a)<span class="keyword">for</span>(f=<span class="number">0</span>;f&lt;a.length;f++)d[a[f]]&amp;&amp;(e=e+d[a[f]]+<span class="string">"/"</span>);e=e+<span class="keyword">this</span>.matrixSet+<span class="string">"/"</span>+<span class="keyword">this</span>.matrix.identifier+<span class="string">"/"</span>+c.row+<span class="string">"/"</span>+c.col+<span class="string">"."</span>+<span class="keyword">this</span>.formatSuffix;b.match(<span class="regexp">/\/$/</span>)||(b+=<span class="string">"/"</span>);b+=e&#125;<span class="keyword">else</span><span class="string">"KVP"</span>===<span class="keyword">this</span>.requestEncoding.toUpperCase()&amp;&amp;</span><br><span class="line">(d=&#123;<span class="attr">SERVICE</span>:<span class="string">"WMTS"</span>,<span class="attr">REQUEST</span>:<span class="string">"GetTile"</span>,<span class="attr">VERSION</span>:<span class="keyword">this</span>.version,<span class="attr">LAYER</span>:<span class="keyword">this</span>.layer,<span class="attr">STYLE</span>:<span class="keyword">this</span>.style,<span class="attr">TILEMATRIXSET</span>:<span class="keyword">this</span>.matrixSet,<span class="attr">TILEMATRIX</span>:<span class="keyword">this</span>.matrix.identifier,<span class="attr">TILEROW</span>:c.row,<span class="attr">TILECOL</span>:c.col,<span class="attr">FORMAT</span>:<span class="keyword">this</span>.format&#125;,b=OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(<span class="keyword">this</span>,[d]))&#125;<span class="keyword">return</span> b&#125;,<span class="attr">mergeNewParams</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">if</span>(<span class="string">"KVP"</span>===<span class="keyword">this</span>.requestEncoding.toUpperCase())<span class="keyword">return</span> OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(<span class="keyword">this</span>,[OpenLayers.Util.upperCaseObject(a)])&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.WMTS"</span>&#125;);OpenLayers.Protocol.SOS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol,&#123;<span class="attr">fois</span>:<span class="literal">null</span>,<span class="attr">formatOptions</span>:<span class="literal">null</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Protocol.prototype.initialize.apply(<span class="keyword">this</span>,[a]);a.format||(<span class="keyword">this</span>.format=<span class="keyword">new</span> OpenLayers.Format.SOSGetFeatureOfInterest(<span class="keyword">this</span>.formatOptions))&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.options&amp;&amp;!<span class="keyword">this</span>.options.format&amp;&amp;<span class="keyword">this</span>.format.destroy();<span class="keyword">this</span>.format=<span class="literal">null</span>;OpenLayers.Protocol.prototype.destroy.apply(<span class="keyword">this</span>)&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=OpenLayers.Util.extend(&#123;&#125;,a);OpenLayers.Util.applyDefaults(a,<span class="keyword">this</span>.options||</span><br><span class="line">&#123;&#125;);<span class="keyword">var</span> b=<span class="keyword">new</span> OpenLayers.Protocol.Response(&#123;<span class="attr">requestType</span>:<span class="string">"read"</span>&#125;),c=<span class="keyword">this</span>.format,c=OpenLayers.Format.XML.prototype.write.apply(c,[c.writeNode(<span class="string">"sos:GetFeatureOfInterest"</span>,&#123;<span class="attr">fois</span>:<span class="keyword">this</span>.fois&#125;)]);b.priv=OpenLayers.Request.POST(&#123;<span class="attr">url</span>:a.url,<span class="attr">callback</span>:<span class="keyword">this</span>.createCallback(<span class="keyword">this</span>.handleRead,b,a),<span class="attr">data</span>:c&#125;);<span class="keyword">return</span> b&#125;,<span class="attr">handleRead</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(b.callback)&#123;<span class="keyword">var</span> c=a.priv;<span class="number">200</span>&lt;=c.status&amp;&amp;<span class="number">300</span>&gt;c.status?(a.features=<span class="keyword">this</span>.parseFeatures(c),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE;</span><br><span class="line">b.callback.call(b.scope,a)&#125;&#125;,<span class="attr">parseFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.responseXML;b&amp;&amp;b.documentElement||(b=a.responseText);<span class="keyword">return</span>!b||<span class="number">0</span>&gt;=b.length?<span class="literal">null</span>:<span class="keyword">this</span>.format.read(b)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Protocol.SOS.v1_0_0"</span>&#125;);OpenLayers.Layer.KaMapCache=OpenLayers.Class(OpenLayers.Layer.KaMap,&#123;<span class="attr">IMAGE_EXTENSIONS</span>:&#123;<span class="attr">jpeg</span>:<span class="string">"jpg"</span>,<span class="attr">gif</span>:<span class="string">"gif"</span>,<span class="attr">png</span>:<span class="string">"png"</span>,<span class="attr">png8</span>:<span class="string">"png"</span>,<span class="attr">png24</span>:<span class="string">"png"</span>,<span class="attr">dithered</span>:<span class="string">"png"</span>&#125;,<span class="attr">DEFAULT_FORMAT</span>:<span class="string">"jpeg"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;OpenLayers.Layer.KaMap.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.extension=<span class="keyword">this</span>.IMAGE_EXTENSIONS[<span class="keyword">this</span>.params.i.toLowerCase()||<span class="keyword">this</span>.DEFAULT_FORMAT]&#125;,<span class="attr">getURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=<span class="keyword">this</span>.adjustBounds(a);<span class="keyword">var</span> b=<span class="keyword">this</span>.map.getResolution(),c=<span class="built_in">Math</span>.round(<span class="number">1E4</span>*<span class="keyword">this</span>.map.getScale())/<span class="number">1E4</span>,d=<span class="built_in">Math</span>.round(a.left/b);a=</span><br><span class="line">-<span class="built_in">Math</span>.round(a.top/b);<span class="keyword">var</span> b=<span class="built_in">Math</span>.floor(d/<span class="keyword">this</span>.tileSize.w/<span class="keyword">this</span>.params.metaTileSize.w)*<span class="keyword">this</span>.tileSize.w*<span class="keyword">this</span>.params.metaTileSize.w,e=<span class="built_in">Math</span>.floor(a/<span class="keyword">this</span>.tileSize.h/<span class="keyword">this</span>.params.metaTileSize.h)*<span class="keyword">this</span>.tileSize.h*<span class="keyword">this</span>.params.metaTileSize.h,c=[<span class="string">"/"</span>,<span class="keyword">this</span>.params.map,<span class="string">"/"</span>,c,<span class="string">"/"</span>,<span class="keyword">this</span>.params.g.replace(<span class="regexp">/\s/g</span>,<span class="string">"_"</span>),<span class="string">"/def/t"</span>,e,<span class="string">"/l"</span>,b,<span class="string">"/t"</span>,a,<span class="string">"l"</span>,d,<span class="string">"."</span>,<span class="keyword">this</span>.extension],d=<span class="keyword">this</span>.url;OpenLayers.Util.isArray(d)&amp;&amp;(d=<span class="keyword">this</span>.selectUrl(c.join(<span class="string">""</span>),d));<span class="keyword">return</span> d+c.join(<span class="string">""</span>)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Layer.KaMapCache"</span>&#125;);OpenLayers.Protocol.WFS.v1_1_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,&#123;<span class="attr">version</span>:<span class="string">"1.1.0"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Protocol.WFS.v1.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.outputFormat&amp;&amp;!<span class="keyword">this</span>.readFormat&amp;&amp;(<span class="string">"gml2"</span>==<span class="keyword">this</span>.outputFormat.toLowerCase()?<span class="keyword">this</span>.readFormat=<span class="keyword">new</span> OpenLayers.Format.GML.v2(&#123;<span class="attr">featureType</span>:<span class="keyword">this</span>.featureType,<span class="attr">featureNS</span>:<span class="keyword">this</span>.featureNS,<span class="attr">geometryName</span>:<span class="keyword">this</span>.geometryName&#125;):<span class="string">"json"</span>==<span class="keyword">this</span>.outputFormat.toLowerCase()&amp;&amp;(<span class="keyword">this</span>.readFormat=<span class="keyword">new</span> OpenLayers.Format.GeoJSON))&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Protocol.WFS.v1_1_0"</span>&#125;);OpenLayers.Format.WMSCapabilities.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,&#123;<span class="attr">version</span>:<span class="string">"1.1.1"</span>,<span class="attr">readers</span>:&#123;<span class="attr">wms</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">SRS</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.srs[<span class="keyword">this</span>.getChildValue(a)]=!<span class="number">0</span>&#125;&#125;,OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMSCapabilities.v1_1_1"</span>&#125;);OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1_1,&#123;<span class="attr">version</span>:<span class="string">"1.1.1"</span>,<span class="attr">profile</span>:<span class="string">"WMSC"</span>,<span class="attr">readers</span>:&#123;<span class="attr">wms</span>:OpenLayers.Util.applyDefaults(&#123;<span class="attr">VendorSpecificCapabilities</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.vendorSpecific=&#123;<span class="attr">tileSets</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,b.vendorSpecific)&#125;,<span class="attr">TileSet</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">srs</span>:&#123;&#125;,<span class="attr">bbox</span>:&#123;&#125;,<span class="attr">resolutions</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.tileSets.push(c)&#125;,<span class="attr">Resolutions</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a).split(<span class="string">" "</span>),d=<span class="number">0</span>,e=c.length;d&lt;e;d++)<span class="string">""</span>!=c[d]&amp;&amp;b.resolutions.push(<span class="built_in">parseFloat</span>(c[d]))&#125;,</span><br><span class="line">Width:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.width=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">Height</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.height=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">Layers</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.layers=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Styles</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.styles=<span class="keyword">this</span>.getChildValue(a)&#125;&#125;,OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.readers.wms)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC"</span>&#125;);OpenLayers.Control.LayerSwitcher=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">layerStates</span>:<span class="literal">null</span>,<span class="attr">layersDiv</span>:<span class="literal">null</span>,<span class="attr">baseLayersDiv</span>:<span class="literal">null</span>,<span class="attr">baseLayers</span>:<span class="literal">null</span>,<span class="attr">dataLbl</span>:<span class="literal">null</span>,<span class="attr">dataLayersDiv</span>:<span class="literal">null</span>,<span class="attr">dataLayers</span>:<span class="literal">null</span>,<span class="attr">minimizeDiv</span>:<span class="literal">null</span>,<span class="attr">maximizeDiv</span>:<span class="literal">null</span>,<span class="attr">ascending</span>:!<span class="number">0</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.initialize.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.layerStates=[]&#125;,<span class="attr">destroy</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.clearLayersArray(<span class="string">"base"</span>);<span class="keyword">this</span>.clearLayersArray(<span class="string">"data"</span>);<span class="keyword">this</span>.map.events.un(&#123;<span class="attr">buttonclick</span>:<span class="keyword">this</span>.onButtonClick,<span class="attr">addlayer</span>:<span class="keyword">this</span>.redraw,<span class="attr">changelayer</span>:<span class="keyword">this</span>.redraw,</span><br><span class="line">removelayer:<span class="keyword">this</span>.redraw,<span class="attr">changebaselayer</span>:<span class="keyword">this</span>.redraw,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">this</span>.events.unregister(<span class="string">"buttonclick"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onButtonClick);OpenLayers.Control.prototype.destroy.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;,<span class="attr">setMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Control.prototype.setMap.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);<span class="keyword">this</span>.map.events.on(&#123;<span class="attr">addlayer</span>:<span class="keyword">this</span>.redraw,<span class="attr">changelayer</span>:<span class="keyword">this</span>.redraw,<span class="attr">removelayer</span>:<span class="keyword">this</span>.redraw,<span class="attr">changebaselayer</span>:<span class="keyword">this</span>.redraw,<span class="attr">scope</span>:<span class="keyword">this</span>&#125;);<span class="keyword">this</span>.outsideViewport?(<span class="keyword">this</span>.events.attachToElement(<span class="keyword">this</span>.div),<span class="keyword">this</span>.events.register(<span class="string">"buttonclick"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onButtonClick)):</span><br><span class="line"><span class="keyword">this</span>.map.events.register(<span class="string">"buttonclick"</span>,<span class="keyword">this</span>,<span class="keyword">this</span>.onButtonClick)&#125;,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;OpenLayers.Control.prototype.draw.apply(<span class="keyword">this</span>);<span class="keyword">this</span>.loadContents();<span class="keyword">this</span>.outsideViewport||<span class="keyword">this</span>.minimizeControl();<span class="keyword">this</span>.redraw();<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">onButtonClick</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a=a.buttonElement;a===<span class="keyword">this</span>.minimizeDiv?<span class="keyword">this</span>.minimizeControl():a===<span class="keyword">this</span>.maximizeDiv?<span class="keyword">this</span>.maximizeControl():a._layerSwitcher===<span class="keyword">this</span>.id&amp;&amp;(a[<span class="string">"for"</span>]&amp;&amp;(a=<span class="built_in">document</span>.getElementById(a[<span class="string">"for"</span>])),a.disabled||(<span class="string">"radio"</span>==a.type?(a.checked=!<span class="number">0</span>,<span class="keyword">this</span>.map.setBaseLayer(<span class="keyword">this</span>.map.getLayer(a._layer))):</span><br><span class="line">(a.checked=!a.checked,<span class="keyword">this</span>.updateMap())))&#125;,<span class="attr">clearLayersArray</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>[a+<span class="string">"LayersDiv"</span>].innerHTML=<span class="string">""</span>;<span class="keyword">this</span>[a+<span class="string">"Layers"</span>]=[]&#125;,<span class="attr">checkRedraw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.layerStates.length||<span class="keyword">this</span>.map.layers.length!=<span class="keyword">this</span>.layerStates.length)<span class="keyword">return</span>!<span class="number">0</span>;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="keyword">this</span>.layerStates.length;a&lt;b;a++)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.layerStates[a],d=<span class="keyword">this</span>.map.layers[a];<span class="keyword">if</span>(c.name!=d.name||c.inRange!=d.inRange||c.id!=d.id||c.visibility!=d.visibility)<span class="keyword">return</span>!<span class="number">0</span>&#125;<span class="keyword">return</span>!<span class="number">1</span>&#125;,<span class="attr">redraw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">if</span>(!<span class="keyword">this</span>.checkRedraw())<span class="keyword">return</span> <span class="keyword">this</span>.div;<span class="keyword">this</span>.clearLayersArray(<span class="string">"base"</span>);</span><br><span class="line"><span class="keyword">this</span>.clearLayersArray(<span class="string">"data"</span>);<span class="keyword">var</span> a=!<span class="number">1</span>,b=!<span class="number">1</span>,c=<span class="keyword">this</span>.map.layers.length;<span class="keyword">this</span>.layerStates=<span class="built_in">Array</span>(c);<span class="keyword">for</span>(<span class="keyword">var</span> d=<span class="number">0</span>;d&lt;c;d++)&#123;<span class="keyword">var</span> e=<span class="keyword">this</span>.map.layers[d];<span class="keyword">this</span>.layerStates[d]=&#123;<span class="attr">name</span>:e.name,<span class="attr">visibility</span>:e.visibility,<span class="attr">inRange</span>:e.inRange,<span class="attr">id</span>:e.id&#125;&#125;<span class="keyword">var</span> f=<span class="keyword">this</span>.map.layers.slice();<span class="keyword">this</span>.ascending||f.reverse();d=<span class="number">0</span>;<span class="keyword">for</span>(c=f.length;d&lt;c;d++)&#123;<span class="keyword">var</span> e=f[d],g=e.isBaseLayer;<span class="keyword">if</span>(e.displayInLayerSwitcher)&#123;g?b=!<span class="number">0</span>:a=!<span class="number">0</span>;<span class="keyword">var</span> h=g?e==<span class="keyword">this</span>.map.baseLayer:e.getVisibility(),k=<span class="built_in">document</span>.createElement(<span class="string">"input"</span>),l=OpenLayers.Util.createUniqueID(<span class="keyword">this</span>.id+</span><br><span class="line"><span class="string">"_input_"</span>);k.id=l;k.name=g?<span class="keyword">this</span>.id+<span class="string">"_baseLayers"</span>:e.name;k.type=g?<span class="string">"radio"</span>:<span class="string">"checkbox"</span>;k.value=e.name;k.checked=h;k.defaultChecked=h;k.className=<span class="string">"olButton"</span>;k._layer=e.id;k._layerSwitcher=<span class="keyword">this</span>.id;g||e.inRange||(k.disabled=!<span class="number">0</span>);h=<span class="built_in">document</span>.createElement(<span class="string">"label"</span>);h[<span class="string">"for"</span>]=k.id;OpenLayers.Element.addClass(h,<span class="string">"labelSpan olButton"</span>);h._layer=e.id;h._layerSwitcher=<span class="keyword">this</span>.id;g||e.inRange||(h.style.color=<span class="string">"gray"</span>);h.innerHTML=e.name;h.style.verticalAlign=g?<span class="string">"bottom"</span>:<span class="string">"baseline"</span>;l=<span class="built_in">document</span>.createElement(<span class="string">"br"</span>);(g?<span class="keyword">this</span>.baseLayers:</span><br><span class="line"><span class="keyword">this</span>.dataLayers).push(&#123;<span class="attr">layer</span>:e,<span class="attr">inputElem</span>:k,<span class="attr">labelSpan</span>:h&#125;);e=g?<span class="keyword">this</span>.baseLayersDiv:<span class="keyword">this</span>.dataLayersDiv;e.appendChild(k);e.appendChild(h);e.appendChild(l)&#125;&#125;<span class="keyword">this</span>.dataLbl.style.display=a?<span class="string">""</span>:<span class="string">"none"</span>;<span class="keyword">this</span>.baseLbl.style.display=b?<span class="string">""</span>:<span class="string">"none"</span>;<span class="keyword">return</span> <span class="keyword">this</span>.div&#125;,<span class="attr">updateMap</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="number">0</span>,b=<span class="keyword">this</span>.baseLayers.length;a&lt;b;a++)&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.baseLayers[a];c.inputElem.checked&amp;&amp;<span class="keyword">this</span>.map.setBaseLayer(c.layer,!<span class="number">1</span>)&#125;a=<span class="number">0</span>;<span class="keyword">for</span>(b=<span class="keyword">this</span>.dataLayers.length;a&lt;b;a++)c=<span class="keyword">this</span>.dataLayers[a],c.layer.setVisibility(c.inputElem.checked)&#125;,<span class="attr">maximizeControl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.div.style.width=</span><br><span class="line"><span class="string">""</span>;<span class="keyword">this</span>.div.style.height=<span class="string">""</span>;<span class="keyword">this</span>.showControls(!<span class="number">1</span>);<span class="literal">null</span>!=a&amp;&amp;OpenLayers.Event.stop(a)&#125;,<span class="attr">minimizeControl</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.div.style.width=<span class="string">"0px"</span>;<span class="keyword">this</span>.div.style.height=<span class="string">"0px"</span>;<span class="keyword">this</span>.showControls(!<span class="number">0</span>);<span class="literal">null</span>!=a&amp;&amp;OpenLayers.Event.stop(a)&#125;,<span class="attr">showControls</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.maximizeDiv.style.display=a?<span class="string">""</span>:<span class="string">"none"</span>;<span class="keyword">this</span>.minimizeDiv.style.display=a?<span class="string">"none"</span>:<span class="string">""</span>;<span class="keyword">this</span>.layersDiv.style.display=a?<span class="string">"none"</span>:<span class="string">""</span>&#125;,<span class="attr">loadContents</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.layersDiv=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);<span class="keyword">this</span>.layersDiv.id=<span class="keyword">this</span>.id+<span class="string">"_layersDiv"</span>;OpenLayers.Element.addClass(<span class="keyword">this</span>.layersDiv,</span><br><span class="line"><span class="string">"layersDiv"</span>);<span class="keyword">this</span>.baseLbl=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);<span class="keyword">this</span>.baseLbl.innerHTML=OpenLayers.i18n(<span class="string">"Base Layer"</span>);OpenLayers.Element.addClass(<span class="keyword">this</span>.baseLbl,<span class="string">"baseLbl"</span>);<span class="keyword">this</span>.baseLayersDiv=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);OpenLayers.Element.addClass(<span class="keyword">this</span>.baseLayersDiv,<span class="string">"baseLayersDiv"</span>);<span class="keyword">this</span>.dataLbl=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);<span class="keyword">this</span>.dataLbl.innerHTML=OpenLayers.i18n(<span class="string">"Overlays"</span>);OpenLayers.Element.addClass(<span class="keyword">this</span>.dataLbl,<span class="string">"dataLbl"</span>);<span class="keyword">this</span>.dataLayersDiv=<span class="built_in">document</span>.createElement(<span class="string">"div"</span>);OpenLayers.Element.addClass(<span class="keyword">this</span>.dataLayersDiv,</span><br><span class="line"><span class="string">"dataLayersDiv"</span>);<span class="keyword">this</span>.ascending?(<span class="keyword">this</span>.layersDiv.appendChild(<span class="keyword">this</span>.baseLbl),<span class="keyword">this</span>.layersDiv.appendChild(<span class="keyword">this</span>.baseLayersDiv),<span class="keyword">this</span>.layersDiv.appendChild(<span class="keyword">this</span>.dataLbl),<span class="keyword">this</span>.layersDiv.appendChild(<span class="keyword">this</span>.dataLayersDiv)):(<span class="keyword">this</span>.layersDiv.appendChild(<span class="keyword">this</span>.dataLbl),<span class="keyword">this</span>.layersDiv.appendChild(<span class="keyword">this</span>.dataLayersDiv),<span class="keyword">this</span>.layersDiv.appendChild(<span class="keyword">this</span>.baseLbl),<span class="keyword">this</span>.layersDiv.appendChild(<span class="keyword">this</span>.baseLayersDiv));<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.layersDiv);<span class="keyword">var</span> a=OpenLayers.Util.getImageLocation(<span class="string">"layer-switcher-maximize.png"</span>);<span class="keyword">this</span>.maximizeDiv=</span><br><span class="line">OpenLayers.Util.createAlphaImageDiv(<span class="string">"OpenLayers_Control_MaximizeDiv"</span>,<span class="literal">null</span>,<span class="literal">null</span>,a,<span class="string">"absolute"</span>);OpenLayers.Element.addClass(<span class="keyword">this</span>.maximizeDiv,<span class="string">"maximizeDiv olButton"</span>);<span class="keyword">this</span>.maximizeDiv.style.display=<span class="string">"none"</span>;<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.maximizeDiv);a=OpenLayers.Util.getImageLocation(<span class="string">"layer-switcher-minimize.png"</span>);<span class="keyword">this</span>.minimizeDiv=OpenLayers.Util.createAlphaImageDiv(<span class="string">"OpenLayers_Control_MinimizeDiv"</span>,<span class="literal">null</span>,<span class="literal">null</span>,a,<span class="string">"absolute"</span>);OpenLayers.Element.addClass(<span class="keyword">this</span>.minimizeDiv,<span class="string">"minimizeDiv olButton"</span>);<span class="keyword">this</span>.minimizeDiv.style.display=</span><br><span class="line"><span class="string">"none"</span>;<span class="keyword">this</span>.div.appendChild(<span class="keyword">this</span>.minimizeDiv)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.LayerSwitcher"</span>&#125;);OpenLayers.Format.Atom=OpenLayers.Class(OpenLayers.Format.XML,&#123;<span class="attr">namespaces</span>:&#123;<span class="attr">atom</span>:<span class="string">"http://www.w3.org/2005/Atom"</span>,<span class="attr">georss</span>:<span class="string">"http://www.georss.org/georss"</span>&#125;,<span class="attr">feedTitle</span>:<span class="string">"untitled"</span>,<span class="attr">defaultEntryTitle</span>:<span class="string">"untitled"</span>,<span class="attr">gmlParser</span>:<span class="literal">null</span>,<span class="attr">xy</span>:!<span class="number">1</span>,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));<span class="keyword">return</span> <span class="keyword">this</span>.parseFeatures(a)&#125;,<span class="attr">write</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b;<span class="keyword">if</span>(OpenLayers.Util.isArray(a))&#123;b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:feed"</span>);b.appendChild(<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:title"</span>,&#123;<span class="attr">value</span>:<span class="keyword">this</span>.feedTitle&#125;));</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> c=<span class="number">0</span>,d=a.length;c&lt;d;c++)b.appendChild(<span class="keyword">this</span>.buildEntryNode(a[c]))&#125;<span class="keyword">else</span> b=<span class="keyword">this</span>.buildEntryNode(a);<span class="keyword">return</span> OpenLayers.Format.XML.prototype.write.apply(<span class="keyword">this</span>,[b])&#125;,<span class="attr">buildContentNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:content"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">type</span>:a.type||<span class="literal">null</span>&#125;&#125;);<span class="keyword">if</span>(a.src)b.setAttribute(<span class="string">"src"</span>,a.src);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"text"</span>==a.type||<span class="literal">null</span>==a.type)b.appendChild(<span class="keyword">this</span>.createTextNode(a.value));<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"html"</span>==a.type)&#123;<span class="keyword">if</span>(<span class="string">"string"</span>!=<span class="keyword">typeof</span> a.value)<span class="keyword">throw</span><span class="string">"HTML content must be in form of an escaped string"</span>;b.appendChild(<span class="keyword">this</span>.createTextNode(a.value))&#125;<span class="keyword">else</span><span class="string">"xhtml"</span>==</span><br><span class="line">a.type?b.appendChild(a.value):<span class="string">"xhtml"</span>==a.type||a.type.match(<span class="regexp">/(\+|\/)xml$/</span>)?b.appendChild(a.value):b.appendChild(<span class="keyword">this</span>.createTextNode(a.value));<span class="keyword">return</span> b&#125;,<span class="attr">buildEntryNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=a.attributes,c=b.atom||&#123;&#125;,d=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:entry"</span>);<span class="keyword">if</span>(c.authors)<span class="keyword">for</span>(<span class="keyword">var</span> e=OpenLayers.Util.isArray(c.authors)?c.authors:[c.authors],f=<span class="number">0</span>,g=e.length;f&lt;g;f++)d.appendChild(<span class="keyword">this</span>.buildPersonConstructNode(<span class="string">"author"</span>,e[f]));<span class="keyword">if</span>(c.categories)<span class="keyword">for</span>(<span class="keyword">var</span> e=OpenLayers.Util.isArray(c.categories)?c.categories:[c.categories],</span><br><span class="line">h,f=<span class="number">0</span>,g=e.length;f&lt;g;f++)h=e[f],d.appendChild(<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:category"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">term</span>:h.term,<span class="attr">scheme</span>:h.scheme||<span class="literal">null</span>,<span class="attr">label</span>:h.label||<span class="literal">null</span>&#125;&#125;));c.content&amp;&amp;d.appendChild(<span class="keyword">this</span>.buildContentNode(c.content));<span class="keyword">if</span>(c.contributors)<span class="keyword">for</span>(e=OpenLayers.Util.isArray(c.contributors)?c.contributors:[c.contributors],f=<span class="number">0</span>,g=e.length;f&lt;g;f++)d.appendChild(<span class="keyword">this</span>.buildPersonConstructNode(<span class="string">"contributor"</span>,e[f]));a.fid&amp;&amp;d.appendChild(<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:id"</span>,&#123;<span class="attr">value</span>:a.fid&#125;));<span class="keyword">if</span>(c.links)<span class="keyword">for</span>(e=OpenLayers.Util.isArray(c.links)?</span><br><span class="line">c.links:[c.links],f=<span class="number">0</span>,g=e.length;f&lt;g;f++)h=e[f],d.appendChild(<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:link"</span>,&#123;<span class="attr">attributes</span>:&#123;<span class="attr">href</span>:h.href,<span class="attr">rel</span>:h.rel||<span class="literal">null</span>,<span class="attr">type</span>:h.type||<span class="literal">null</span>,<span class="attr">hreflang</span>:h.hreflang||<span class="literal">null</span>,<span class="attr">title</span>:h.title||<span class="literal">null</span>,<span class="attr">length</span>:h.length||<span class="literal">null</span>&#125;&#125;));c.published&amp;&amp;d.appendChild(<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:published"</span>,&#123;<span class="attr">value</span>:c.published&#125;));c.rights&amp;&amp;d.appendChild(<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:rights"</span>,&#123;<span class="attr">value</span>:c.rights&#125;));(c.summary||b.description)&amp;&amp;d.appendChild(<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:summary"</span>,&#123;<span class="attr">value</span>:c.summary||</span><br><span class="line">b.description&#125;));d.appendChild(<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:title"</span>,&#123;<span class="attr">value</span>:c.title||b.title||<span class="keyword">this</span>.defaultEntryTitle&#125;));c.updated&amp;&amp;d.appendChild(<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:updated"</span>,&#123;<span class="attr">value</span>:c.updated&#125;));a.geometry&amp;&amp;(b=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"georss:where"</span>),b.appendChild(<span class="keyword">this</span>.buildGeometryNode(a.geometry)),d.appendChild(b));<span class="keyword">return</span> d&#125;,<span class="attr">initGmlParser</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.gmlParser=<span class="keyword">new</span> OpenLayers.Format.GML.v3(&#123;<span class="attr">xy</span>:<span class="keyword">this</span>.xy,<span class="attr">featureNS</span>:<span class="string">"http://example.com#feature"</span>,<span class="attr">internalProjection</span>:<span class="keyword">this</span>.internalProjection,</span><br><span class="line">externalProjection:<span class="keyword">this</span>.externalProjection&#125;)&#125;,<span class="attr">buildGeometryNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.gmlParser||<span class="keyword">this</span>.initGmlParser();<span class="keyword">return</span> <span class="keyword">this</span>.gmlParser.writeNode(<span class="string">"feature:_geometry"</span>,a).firstChild&#125;,<span class="attr">buildPersonConstructNode</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=[<span class="string">"uri"</span>,<span class="string">"email"</span>],d=<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:"</span>+a);d.appendChild(<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:name"</span>,&#123;<span class="attr">value</span>:b.name&#125;));<span class="keyword">for</span>(<span class="keyword">var</span> e=<span class="number">0</span>,f=c.length;e&lt;f;e++)b[c[e]]&amp;&amp;d.appendChild(<span class="keyword">this</span>.createElementNSPlus(<span class="string">"atom:"</span>+c[e],&#123;<span class="attr">value</span>:b[c[e]]&#125;));<span class="keyword">return</span> d&#125;,<span class="attr">getFirstChildValue</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,</span></span></span><br><span class="line"><span class="function"><span class="params">d</span>)</span>&#123;<span class="keyword">return</span>(a=<span class="keyword">this</span>.getElementsByTagNameNS(a,b,c))&amp;&amp;<span class="number">0</span>&lt;a.length?<span class="keyword">this</span>.getChildValue(a[<span class="number">0</span>],d):d&#125;,<span class="attr">parseFeature</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=&#123;&#125;,c=<span class="literal">null</span>,d=<span class="literal">null</span>,e=<span class="literal">null</span>,f=<span class="keyword">this</span>.namespaces.atom;<span class="keyword">this</span>.parsePersonConstructs(a,<span class="string">"author"</span>,b);d=<span class="keyword">this</span>.getElementsByTagNameNS(a,f,<span class="string">"category"</span>);<span class="number">0</span>&lt;d.length&amp;&amp;(b.categories=[]);<span class="keyword">for</span>(<span class="keyword">var</span> g=<span class="number">0</span>,h=d.length;g&lt;h;g++)&#123;c=&#123;&#125;;c.term=d[g].getAttribute(<span class="string">"term"</span>);<span class="keyword">if</span>(e=d[g].getAttribute(<span class="string">"scheme"</span>))c.scheme=e;<span class="keyword">if</span>(e=d[g].getAttribute(<span class="string">"label"</span>))c.label=e;b.categories.push(c)&#125;d=<span class="keyword">this</span>.getElementsByTagNameNS(a,f,<span class="string">"content"</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>&lt;d.length)&#123;c=&#123;&#125;;<span class="keyword">if</span>(e=d[<span class="number">0</span>].getAttribute(<span class="string">"type"</span>))c.type=e;(e=d[<span class="number">0</span>].getAttribute(<span class="string">"src"</span>))?c.src=e:(<span class="string">"text"</span>==c.type||<span class="string">"html"</span>==c.type||<span class="literal">null</span>==c.type?c.value=<span class="keyword">this</span>.getFirstChildValue(a,f,<span class="string">"content"</span>,<span class="literal">null</span>):<span class="string">"xhtml"</span>==c.type||c.type.match(<span class="regexp">/(\+|\/)xml$/</span>)?c.value=<span class="keyword">this</span>.getChildEl(d[<span class="number">0</span>]):c.value=<span class="keyword">this</span>.getFirstChildValue(a,f,<span class="string">"content"</span>,<span class="literal">null</span>),b.content=c)&#125;<span class="keyword">this</span>.parsePersonConstructs(a,<span class="string">"contributor"</span>,b);b.id=<span class="keyword">this</span>.getFirstChildValue(a,f,<span class="string">"id"</span>,<span class="literal">null</span>);d=<span class="keyword">this</span>.getElementsByTagNameNS(a,f,<span class="string">"link"</span>);<span class="number">0</span>&lt;d.length&amp;&amp;(b.links=<span class="built_in">Array</span>(d.length));</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> k=[<span class="string">"rel"</span>,<span class="string">"type"</span>,<span class="string">"hreflang"</span>,<span class="string">"title"</span>,<span class="string">"length"</span>],g=<span class="number">0</span>,h=d.length;g&lt;h;g++)&#123;c=&#123;&#125;;c.href=d[g].getAttribute(<span class="string">"href"</span>);<span class="keyword">for</span>(<span class="keyword">var</span> l=<span class="number">0</span>,m=k.length;l&lt;m;l++)(e=d[g].getAttribute(k[l]))&amp;&amp;(c[k[l]]=e);b.links[g]=c&#125;<span class="keyword">if</span>(c=<span class="keyword">this</span>.getFirstChildValue(a,f,<span class="string">"published"</span>,<span class="literal">null</span>))b.published=c;<span class="keyword">if</span>(c=<span class="keyword">this</span>.getFirstChildValue(a,f,<span class="string">"rights"</span>,<span class="literal">null</span>))b.rights=c;<span class="keyword">if</span>(c=<span class="keyword">this</span>.getFirstChildValue(a,f,<span class="string">"summary"</span>,<span class="literal">null</span>))b.summary=c;b.title=<span class="keyword">this</span>.getFirstChildValue(a,f,<span class="string">"title"</span>,<span class="literal">null</span>);b.updated=<span class="keyword">this</span>.getFirstChildValue(a,f,<span class="string">"updated"</span>,<span class="literal">null</span>);c=&#123;<span class="attr">title</span>:b.title,</span><br><span class="line">description:b.summary,<span class="attr">atom</span>:b&#125;;a=<span class="keyword">this</span>.parseLocations(a)[<span class="number">0</span>];a=<span class="keyword">new</span> OpenLayers.Feature.Vector(a,c);a.fid=b.id;<span class="keyword">return</span> a&#125;,<span class="attr">parseFeatures</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=[],c=<span class="keyword">this</span>.getElementsByTagNameNS(a,<span class="keyword">this</span>.namespaces.atom,<span class="string">"entry"</span>);<span class="number">0</span>==c.length&amp;&amp;(c=[a]);a=<span class="number">0</span>;<span class="keyword">for</span>(<span class="keyword">var</span> d=c.length;a&lt;d;a++)b.push(<span class="keyword">this</span>.parseFeature(c[a]));<span class="keyword">return</span> b&#125;,<span class="attr">parseLocations</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b=<span class="keyword">this</span>.namespaces.georss,c=&#123;<span class="attr">components</span>:[]&#125;,d=<span class="keyword">this</span>.getElementsByTagNameNS(a,b,<span class="string">"where"</span>);<span class="keyword">if</span>(d&amp;&amp;<span class="number">0</span>&lt;d.length)&#123;<span class="keyword">this</span>.gmlParser||<span class="keyword">this</span>.initGmlParser();<span class="keyword">for</span>(<span class="keyword">var</span> e=<span class="number">0</span>,f=d.length;e&lt;</span><br><span class="line">f;e++)<span class="keyword">this</span>.gmlParser.readChildNodes(d[e],c)&#125;c=c.components;<span class="keyword">if</span>((d=<span class="keyword">this</span>.getElementsByTagNameNS(a,b,<span class="string">"point"</span>))&amp;&amp;<span class="number">0</span>&lt;d.length)<span class="keyword">for</span>(e=<span class="number">0</span>,f=d.length;e&lt;f;e++)&#123;<span class="keyword">var</span> g=OpenLayers.String.trim(d[e].firstChild.nodeValue).split(<span class="regexp">/\s+/</span>);<span class="number">2</span>!=g.length&amp;&amp;(g=OpenLayers.String.trim(d[e].firstChild.nodeValue).split(<span class="regexp">/\s*,\s*/</span>));c.push(<span class="keyword">new</span> OpenLayers.Geometry.Point(g[<span class="number">1</span>],g[<span class="number">0</span>]))&#125;<span class="keyword">var</span> h=<span class="keyword">this</span>.getElementsByTagNameNS(a,b,<span class="string">"line"</span>);<span class="keyword">if</span>(h&amp;&amp;<span class="number">0</span>&lt;h.length)<span class="keyword">for</span>(<span class="keyword">var</span> k,e=<span class="number">0</span>,f=h.length;e&lt;f;e++)&#123;d=OpenLayers.String.trim(h[e].firstChild.nodeValue).split(<span class="regexp">/\s+/</span>);</span><br><span class="line">k=[];<span class="keyword">for</span>(<span class="keyword">var</span> l=<span class="number">0</span>,m=d.length;l&lt;m;l+=<span class="number">2</span>)g=<span class="keyword">new</span> OpenLayers.Geometry.Point(d[l+<span class="number">1</span>],d[l]),k.push(g);c.push(<span class="keyword">new</span> OpenLayers.Geometry.LineString(k))&#125;<span class="keyword">if</span>((a=<span class="keyword">this</span>.getElementsByTagNameNS(a,b,<span class="string">"polygon"</span>))&amp;&amp;<span class="number">0</span>&lt;a.length)<span class="keyword">for</span>(e=<span class="number">0</span>,f=a.length;e&lt;f;e++)&#123;d=OpenLayers.String.trim(a[e].firstChild.nodeValue).split(<span class="regexp">/\s+/</span>);k=[];l=<span class="number">0</span>;<span class="keyword">for</span>(m=d.length;l&lt;m;l+=<span class="number">2</span>)g=<span class="keyword">new</span> OpenLayers.Geometry.Point(d[l+<span class="number">1</span>],d[l]),k.push(g);c.push(<span class="keyword">new</span> OpenLayers.Geometry.Polygon([<span class="keyword">new</span> OpenLayers.Geometry.LinearRing(k)]))&#125;<span class="keyword">if</span>(<span class="keyword">this</span>.internalProjection&amp;&amp;<span class="keyword">this</span>.externalProjection)<span class="keyword">for</span>(e=</span><br><span class="line"><span class="number">0</span>,f=c.length;e&lt;f;e++)c[e]&amp;&amp;c[e].transform(<span class="keyword">this</span>.externalProjection,<span class="keyword">this</span>.internalProjection);<span class="keyword">return</span> c&#125;,<span class="attr">parsePersonConstructs</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c</span>)</span>&#123;<span class="keyword">var</span> d=[],e=<span class="keyword">this</span>.namespaces.atom;a=<span class="keyword">this</span>.getElementsByTagNameNS(a,e,b);<span class="keyword">for</span>(<span class="keyword">var</span> f=[<span class="string">"uri"</span>,<span class="string">"email"</span>],g=<span class="number">0</span>,h=a.length;g&lt;h;g++)&#123;<span class="keyword">var</span> k=&#123;&#125;;k.name=<span class="keyword">this</span>.getFirstChildValue(a[g],e,<span class="string">"name"</span>,<span class="literal">null</span>);<span class="keyword">for</span>(<span class="keyword">var</span> l=<span class="number">0</span>,m=f.length;l&lt;m;l++)&#123;<span class="keyword">var</span> n=<span class="keyword">this</span>.getFirstChildValue(a[g],e,f[l],<span class="literal">null</span>);n&amp;&amp;(k[f[l]]=n)&#125;d.push(k)&#125;<span class="number">0</span>&lt;d.length&amp;&amp;(c[b+<span class="string">"s"</span>]=d)&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.Atom"</span>&#125;);OpenLayers.Control.KeyboardDefaults=OpenLayers.Class(OpenLayers.Control,&#123;<span class="attr">autoActivate</span>:!<span class="number">0</span>,<span class="attr">slideFactor</span>:<span class="number">75</span>,<span class="attr">observeElement</span>:<span class="literal">null</span>,<span class="attr">draw</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>.handler=<span class="keyword">new</span> OpenLayers.Handler.Keyboard(<span class="keyword">this</span>,&#123;<span class="attr">keydown</span>:<span class="keyword">this</span>.defaultKeyPress&#125;,&#123;<span class="attr">observeElement</span>:<span class="keyword">this</span>.observeElement||<span class="built_in">document</span>&#125;)&#125;,<span class="attr">defaultKeyPress</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> b,c=!<span class="number">0</span>;b=OpenLayers.Event.element(a);<span class="keyword">if</span>(!b||<span class="string">"INPUT"</span>!=b.tagName&amp;&amp;<span class="string">"TEXTAREA"</span>!=b.tagName&amp;&amp;<span class="string">"SELECT"</span>!=b.tagName)&#123;<span class="keyword">switch</span>(a.keyCode)&#123;<span class="keyword">case</span> OpenLayers.Event.KEY_LEFT:<span class="keyword">this</span>.map.pan(-<span class="keyword">this</span>.slideFactor,<span class="number">0</span>);<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Event.KEY_RIGHT:<span class="keyword">this</span>.map.pan(<span class="keyword">this</span>.slideFactor,</span><br><span class="line"><span class="number">0</span>);<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Event.KEY_UP:<span class="keyword">this</span>.map.pan(<span class="number">0</span>,-<span class="keyword">this</span>.slideFactor);<span class="keyword">break</span>;<span class="keyword">case</span> OpenLayers.Event.KEY_DOWN:<span class="keyword">this</span>.map.pan(<span class="number">0</span>,<span class="keyword">this</span>.slideFactor);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">33</span>:b=<span class="keyword">this</span>.map.getSize();<span class="keyword">this</span>.map.pan(<span class="number">0</span>,<span class="number">-0.75</span>*b.h);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">34</span>:b=<span class="keyword">this</span>.map.getSize();<span class="keyword">this</span>.map.pan(<span class="number">0</span>,<span class="number">0.75</span>*b.h);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">35</span>:b=<span class="keyword">this</span>.map.getSize();<span class="keyword">this</span>.map.pan(<span class="number">0.75</span>*b.w,<span class="number">0</span>);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">36</span>:b=<span class="keyword">this</span>.map.getSize();<span class="keyword">this</span>.map.pan(<span class="number">-0.75</span>*b.w,<span class="number">0</span>);<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">43</span>:<span class="keyword">case</span> <span class="number">61</span>:<span class="keyword">case</span> <span class="number">187</span>:<span class="keyword">case</span> <span class="number">107</span>:<span class="keyword">this</span>.map.zoomIn();<span class="keyword">break</span>;<span class="keyword">case</span> <span class="number">45</span>:<span class="keyword">case</span> <span class="number">109</span>:<span class="keyword">case</span> <span class="number">189</span>:<span class="keyword">case</span> <span class="number">95</span>:<span class="keyword">this</span>.map.zoomOut();</span><br><span class="line"><span class="keyword">break</span>;<span class="keyword">default</span>:c=!<span class="number">1</span>&#125;c&amp;&amp;OpenLayers.Event.stop(a)&#125;&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Control.KeyboardDefaults"</span>&#125;);OpenLayers.Format.WMTSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1_1_0,&#123;<span class="attr">version</span>:<span class="string">"1.0.0"</span>,<span class="attr">namespaces</span>:&#123;<span class="attr">ows</span>:<span class="string">"http://www.opengis.net/ows/1.1"</span>,<span class="attr">wmts</span>:<span class="string">"http://www.opengis.net/wmts/1.0"</span>,<span class="attr">xlink</span>:<span class="string">"http://www.w3.org/1999/xlink"</span>&#125;,<span class="attr">yx</span>:<span class="literal">null</span>,<span class="attr">defaultPrefix</span>:<span class="string">"wmts"</span>,<span class="attr">initialize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;OpenLayers.Format.XML.prototype.initialize.apply(<span class="keyword">this</span>,[a]);<span class="keyword">this</span>.options=a;a=OpenLayers.Util.extend(&#123;&#125;,OpenLayers.Format.WMTSCapabilities.prototype.yx);<span class="keyword">this</span>.yx=OpenLayers.Util.extend(a,<span class="keyword">this</span>.yx)&#125;,<span class="attr">read</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==</span><br><span class="line"><span class="keyword">typeof</span> a&amp;&amp;(a=OpenLayers.Format.XML.prototype.read.apply(<span class="keyword">this</span>,[a]));a&amp;&amp;<span class="number">9</span>==a.nodeType&amp;&amp;(a=a.documentElement);<span class="keyword">var</span> b=&#123;&#125;;<span class="keyword">this</span>.readNode(a,b);b.version=<span class="keyword">this</span>.version;<span class="keyword">return</span> b&#125;,<span class="attr">readers</span>:&#123;<span class="attr">wmts</span>:&#123;<span class="attr">Capabilities</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">this</span>.readChildNodes(a,b)&#125;,<span class="attr">Contents</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.contents=&#123;&#125;;b.contents.layers=[];b.contents.tileMatrixSets=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,b.contents)&#125;,<span class="attr">Layer</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">styles</span>:[],<span class="attr">formats</span>:[],<span class="attr">dimensions</span>:[],<span class="attr">tileMatrixSetLinks</span>:[],<span class="attr">layers</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.layers.push(c)&#125;,<span class="attr">Style</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;c.isDefault=<span class="string">"true"</span>===a.getAttribute(<span class="string">"isDefault"</span>);<span class="keyword">this</span>.readChildNodes(a,c);b.styles.push(c)&#125;,<span class="attr">Format</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.formats.push(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">TileMatrixSetLink</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.tileMatrixSetLinks.push(c)&#125;,<span class="attr">TileMatrixSet</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">if</span>(b.layers)&#123;<span class="keyword">var</span> c=&#123;<span class="attr">matrixIds</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.tileMatrixSets[c.identifier]=c&#125;<span class="keyword">else</span> b.tileMatrixSet=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">TileMatrix</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">supportedCRS</span>:b.supportedCRS&#125;;<span class="keyword">this</span>.readChildNodes(a,</span><br><span class="line">c);b.matrixIds.push(c)&#125;,<span class="attr">ScaleDenominator</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.scaleDenominator=<span class="built_in">parseFloat</span>(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">TopLeftCorner</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.getChildValue(a).split(<span class="string">" "</span>),d;b.supportedCRS&amp;&amp;(d=b.supportedCRS.replace(<span class="regexp">/urn:ogc:def:crs:(\w+):.+:(\w+)$/</span>,<span class="string">"urn:ogc:def:crs:$1::$2"</span>),d=!!<span class="keyword">this</span>.yx[d]);b.topLeftCorner=d?<span class="keyword">new</span> OpenLayers.LonLat(c[<span class="number">1</span>],c[<span class="number">0</span>]):<span class="keyword">new</span> OpenLayers.LonLat(c[<span class="number">0</span>],c[<span class="number">1</span>])&#125;,<span class="attr">TileWidth</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.tileWidth=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">TileHeight</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.tileHeight=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.getChildValue(a))&#125;,</span><br><span class="line">MatrixWidth:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.matrixWidth=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">MatrixHeight</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.matrixHeight=<span class="built_in">parseInt</span>(<span class="keyword">this</span>.getChildValue(a))&#125;,<span class="attr">ResourceURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.resourceUrl=b.resourceUrl||&#123;&#125;;<span class="keyword">var</span> c=a.getAttribute(<span class="string">"resourceType"</span>);b.resourceUrls||(b.resourceUrls=[]);c=b.resourceUrl[c]=&#123;<span class="attr">format</span>:a.getAttribute(<span class="string">"format"</span>),<span class="attr">template</span>:a.getAttribute(<span class="string">"template"</span>),<span class="attr">resourceType</span>:c&#125;;b.resourceUrls.push(c)&#125;,<span class="attr">WSDL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.wsdl=&#123;&#125;;b.wsdl.href=a.getAttribute(<span class="string">"xlink:href"</span>)&#125;,<span class="attr">ServiceMetadataURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,</span></span></span><br><span class="line"><span class="function"><span class="params">b</span>)</span>&#123;b.serviceMetadataUrl=&#123;&#125;;b.serviceMetadataUrl.href=a.getAttribute(<span class="string">"xlink:href"</span>)&#125;,<span class="attr">LegendURL</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.legend=&#123;&#125;;b.legend.href=a.getAttribute(<span class="string">"xlink:href"</span>);b.legend.format=a.getAttribute(<span class="string">"format"</span>)&#125;,<span class="attr">Dimension</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;<span class="keyword">var</span> c=&#123;<span class="attr">values</span>:[]&#125;;<span class="keyword">this</span>.readChildNodes(a,c);b.dimensions.push(c)&#125;,<span class="attr">Default</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b[<span class="string">"default"</span>]=<span class="keyword">this</span>.getChildValue(a)&#125;,<span class="attr">Value</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;b.values.push(<span class="keyword">this</span>.getChildValue(a))&#125;&#125;,<span class="attr">ows</span>:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows&#125;,<span class="attr">CLASS_NAME</span>:<span class="string">"OpenLayers.Format.WMTSCapabilities.v1_0_0"</span>&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>style.css</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span><span class="selector-class">.olMap</span> &#123;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">   <span class="comment">/*margin: 0 !important;*/</span></span><br><span class="line">    <span class="attribute">cursor</span>: default;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.olMapViewport</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: left;</span><br><span class="line">    <span class="attribute">-ms-touch-action</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.olLayerDiv</span> &#123;</span><br><span class="line">   <span class="attribute">-moz-user-select</span>: none;</span><br><span class="line">   <span class="attribute">-khtml-user-select</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olLayerGoogleCopyright</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">2px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olLayerGoogleV3</span><span class="selector-class">.olLayerGoogleCopyright</span> &#123;</span><br><span class="line">    <span class="attribute">right</span>: auto <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olLayerGooglePoweredBy</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olLayerGoogleV3</span><span class="selector-class">.olLayerGooglePoweredBy</span> &#123;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">15px</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* GMaps should not set styles on its container */</span></span><br><span class="line"><span class="selector-class">.olForeignContainer</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlAttribution</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: smaller;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">4.5em</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlScale</span> &#123;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">3em</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">font-size</span>: smaller;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlScaleLine</span> &#123;</span><br><span class="line">   <span class="attribute">display</span>: block;</span><br><span class="line">   <span class="attribute">position</span>: absolute;</span><br><span class="line">   <span class="attribute">left</span>: <span class="number">10px</span>;</span><br><span class="line">   <span class="attribute">bottom</span>: <span class="number">15px</span>;</span><br><span class="line">   <span class="attribute">font-size</span>: xx-small;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlScaleLineBottom</span> &#123;</span><br><span class="line">   <span class="attribute">border</span>: solid <span class="number">2px</span> black;</span><br><span class="line">   <span class="attribute">border-bottom</span>: none;</span><br><span class="line">   <span class="attribute">margin-top</span>:-<span class="number">2px</span>;</span><br><span class="line">   <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlScaleLineTop</span> &#123;</span><br><span class="line">   <span class="attribute">border</span>: solid <span class="number">2px</span> black;</span><br><span class="line">   <span class="attribute">border-top</span>: none;</span><br><span class="line">   <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlPermalink</span> &#123;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">1.5em</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">font-size</span>: smaller;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.olControlMousePosition</span> &#123;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">font-family</span>: Arial;</span><br><span class="line">    <span class="attribute">font-size</span>: smaller;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlOverviewMapContainer</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlOverviewMapElement</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">18px</span> <span class="number">10px</span> <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#00008B</span>;</span><br><span class="line">    <span class="attribute">-moz-border-radius</span>: <span class="number">1em</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlOverviewMapMinimizeButton</span>,</span><br><span class="line"><span class="selector-class">.olControlOverviewMapMaximizeButton</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">80px</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlOverviewMapExtentRectangle</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">"img/blank.gif"</span>);</span><br><span class="line">    <span class="attribute">cursor</span>: move;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> dotted red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlOverviewMapRectReplacement</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">cursor</span>: move;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">"img/overview_replacement.gif"</span>);</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">background-position</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olLayerGeoRSSDescription</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>:left;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">overflow</span>:auto;</span><br><span class="line">    <span class="attribute">font-size</span>:<span class="number">1.0em</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olLayerGeoRSSClose</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>:right;</span><br><span class="line">    <span class="attribute">color</span>:gray;</span><br><span class="line">    <span class="attribute">font-size</span>:<span class="number">1.2em</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>:<span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">font-family</span>:sans-serif;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olLayerGeoRSSTitle</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>:left;<span class="attribute">font-size</span>:<span class="number">1.2em</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olPopupContent</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>:<span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlNavigationHistory</span> &#123;</span><br><span class="line">   <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">"img/navigation_history.png"</span>);</span><br><span class="line">   <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">   <span class="attribute">width</span>:  <span class="number">24px</span>;</span><br><span class="line">   <span class="attribute">height</span>: <span class="number">24px</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlNavigationHistoryPreviousItemActive</span> &#123;</span><br><span class="line">  <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlNavigationHistoryPreviousItemInactive</span> &#123;</span><br><span class="line">   <span class="attribute">background-position</span>: <span class="number">0</span> -<span class="number">24px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlNavigationHistoryNextItemActive</span> &#123;</span><br><span class="line">   <span class="attribute">background-position</span>: -<span class="number">24px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlNavigationHistoryNextItemInactive</span> &#123;</span><br><span class="line">   <span class="attribute">background-position</span>: -<span class="number">24px</span> -<span class="number">24px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.olControlSaveFeaturesItemActive</span> &#123;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(img/save_features_on.png);</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.olControlSaveFeaturesItemInactive</span> &#123;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(img/save_features_off.png);</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olHandlerBoxZoomBox</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> solid red;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">background-color</span>: white;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0.50</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1px</span>;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=50);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olHandlerBoxSelectFeature</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> solid blue;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">background-color</span>: white;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0.50</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1px</span>;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=50);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlPanPanel</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlPanPanel</span> <span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(img/pan-panel.png);</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlPanPanel</span> <span class="selector-class">.olControlPanNorthItemInactive</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">9px</span>;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlPanPanel</span> <span class="selector-class">.olControlPanSouthItemInactive</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">36px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">9px</span>;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">18px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlPanPanel</span> <span class="selector-class">.olControlPanWestItemInactive</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlPanPanel</span> <span class="selector-class">.olControlPanEastItemInactive</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">18px</span> <span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlZoomPanel</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">71px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">14px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlZoomPanel</span> <span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(img/zoom-panel.png);</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlZoomPanel</span> <span class="selector-class">.olControlZoomInItemInactive</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlZoomPanel</span> <span class="selector-class">.olControlZoomToMaxExtentItemInactive</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0</span> -<span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlZoomPanel</span> <span class="selector-class">.olControlZoomOutItemInactive</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">36px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * When a potential text is bigger than the image it move the image</span></span><br><span class="line"><span class="comment"> * with some headers (closes #3154)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="selector-class">.olControlPanZoomBar</span> <span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olPopupCloseBox</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">"img/close.gif"</span>) no-repeat;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olFramedCloudPopupContent</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlNoSelect</span> &#123;</span><br><span class="line"> <span class="attribute">-moz-user-select</span>: none;</span><br><span class="line"> <span class="attribute">-khtml-user-select</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olImageLoadError</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Cursor styles</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olCursorWait</span> &#123;</span><br><span class="line">    <span class="attribute">cursor</span>: wait;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olDragDown</span> &#123;</span><br><span class="line">    <span class="attribute">cursor</span>: move;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olDrawBox</span> &#123;</span><br><span class="line">    <span class="attribute">cursor</span>: crosshair;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlDragFeatureOver</span> &#123;</span><br><span class="line">    <span class="attribute">cursor</span>: move;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlDragFeatureActive</span><span class="selector-class">.olControlDragFeatureOver</span><span class="selector-class">.olDragDown</span> &#123;</span><br><span class="line">    <span class="attribute">cursor</span>: -moz-grabbing;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Layer switcher</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="selector-class">.olControlLayerSwitcher</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">20em</span>;</span><br><span class="line">    <span class="attribute">font-family</span>: sans-serif;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: smaller;</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">    <span class="attribute">background-color</span>: transparent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlLayerSwitcher</span> <span class="selector-class">.layersDiv</span> &#123;</span><br><span class="line">    <span class="attribute">padding-top</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">padding-right</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: darkblue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlLayerSwitcher</span> <span class="selector-class">.layersDiv</span> <span class="selector-class">.baseLbl</span>,</span><br><span class="line"><span class="selector-class">.olControlLayerSwitcher</span> <span class="selector-class">.layersDiv</span> <span class="selector-class">.dataLbl</span> &#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">3px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlLayerSwitcher</span> <span class="selector-class">.layersDiv</span> <span class="selector-class">.baseLayersDiv</span>,</span><br><span class="line"><span class="selector-class">.olControlLayerSwitcher</span> <span class="selector-class">.layersDiv</span> <span class="selector-class">.dataLayersDiv</span> &#123;</span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olControlLayerSwitcher</span> <span class="selector-class">.maximizeDiv</span>,</span><br><span class="line"><span class="selector-class">.olControlLayerSwitcher</span> <span class="selector-class">.minimizeDiv</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olBingAttribution</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#DDD</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olBingAttribution</span><span class="selector-class">.road</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olGoogleAttribution</span><span class="selector-class">.hybrid</span>, <span class="selector-class">.olGoogleAttribution</span><span class="selector-class">.satellite</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#EEE</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olGoogleAttribution</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-class">.olGoogleAttribution</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#77C</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-class">.olGoogleAttribution</span><span class="selector-class">.hybrid</span> <span class="selector-tag">a</span>, <span class="selector-tag">span</span><span class="selector-class">.olGoogleAttribution</span><span class="selector-class">.satellite</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#EEE</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Editing and navigation icons.</span></span><br><span class="line"><span class="comment"> * (using the editing_tool_bar.png sprint image)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="selector-class">.olControlNavToolbar</span> ,</span><br><span class="line"><span class="selector-class">.olControlEditingToolbar</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">5px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlNavToolbar</span> <span class="selector-tag">div</span>,</span><br><span class="line"><span class="selector-class">.olControlEditingToolbar</span> <span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">"img/editing_tool_bar.png"</span>);</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">24px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">22px</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* positions */</span></span><br><span class="line"><span class="selector-class">.olControlEditingToolbar</span> &#123;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlNavToolbar</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">295px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">9px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* layouts */</span></span><br><span class="line"><span class="selector-class">.olControlEditingToolbar</span> <span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* individual controls */</span></span><br><span class="line"><span class="selector-class">.olControlNavToolbar</span> <span class="selector-class">.olControlNavigationItemInactive</span>,</span><br><span class="line"><span class="selector-class">.olControlEditingToolbar</span> <span class="selector-class">.olControlNavigationItemInactive</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: -<span class="number">103px</span> -<span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlNavToolbar</span> <span class="selector-class">.olControlNavigationItemActive</span> ,</span><br><span class="line"><span class="selector-class">.olControlEditingToolbar</span> <span class="selector-class">.olControlNavigationItemActive</span>  &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: -<span class="number">103px</span> -<span class="number">24px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlNavToolbar</span> <span class="selector-class">.olControlZoomBoxItemInactive</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: -<span class="number">128px</span> -<span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlNavToolbar</span> <span class="selector-class">.olControlZoomBoxItemActive</span>  &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: -<span class="number">128px</span> -<span class="number">24px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlEditingToolbar</span> <span class="selector-class">.olControlDrawFeaturePointItemInactive</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: -<span class="number">77px</span> -<span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlEditingToolbar</span> <span class="selector-class">.olControlDrawFeaturePointItemActive</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: -<span class="number">77px</span> -<span class="number">24px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlEditingToolbar</span> <span class="selector-class">.olControlDrawFeaturePathItemInactive</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: -<span class="number">51px</span> -<span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlEditingToolbar</span> <span class="selector-class">.olControlDrawFeaturePathItemActive</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: -<span class="number">51px</span> -<span class="number">24px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlEditingToolbar</span> <span class="selector-class">.olControlDrawFeaturePolygonItemInactive</span>&#123;</span><br><span class="line">    <span class="attribute">background-position</span>: -<span class="number">26px</span> -<span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.olControlEditingToolbar</span> <span class="selector-class">.olControlDrawFeaturePolygonItemActive</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: -<span class="number">26px</span> -<span class="number">24px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.olControlZoom</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(255,255,255,0.4);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">2px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.olControlZoom</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">1px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">font-family</span>: <span class="string">'Lucida Grande'</span>, Verdana, Geneva, Lucida, Arial, Helvetica, sans-serif;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">22px</span>;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">22px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">19px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#130085</span>; <span class="comment">/* fallback for IE - IE6 requires background shorthand*/</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(0, 60, 136, 0.5);</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=80);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.olControlZoom</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#130085</span>; <span class="comment">/* fallback for IE */</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(0, 60, 136, 0.7);</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=100);</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">media</span> only screen and (max-width: <span class="number">600px</span>) &#123;</span><br><span class="line">    <span class="selector-tag">div</span><span class="selector-class">.olControlZoom</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">rgba</span>(0, 60, 136, 0.5);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-class">.olControlZoomIn</span> &#123;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">4px</span> <span class="number">4px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-class">.olControlZoomOut</span> &#123;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">4px</span> <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Animations</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.olLayerGrid</span> <span class="selector-class">.olTileImage</span> &#123;</span><br><span class="line">    <span class="attribute">-webkit-transition</span>: opacity <span class="number">0.2s</span> linear;</span><br><span class="line">    <span class="attribute">-moz-transition</span>: opacity <span class="number">0.2s</span> linear;</span><br><span class="line">    <span class="attribute">-o-transition</span>: opacity <span class="number">0.2s</span> linear;</span><br><span class="line">    <span class="attribute">transition</span>: opacity <span class="number">0.2s</span> linear;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Turn on GPU support where available */</span></span><br><span class="line"><span class="selector-class">.olTileImage</span> &#123;</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">translateZ</span>(0);</span><br><span class="line">    <span class="attribute">-moz-transform</span>: <span class="built_in">translateZ</span>(0);</span><br><span class="line">    <span class="attribute">-o-transform</span>: <span class="built_in">translateZ</span>(0);</span><br><span class="line">    <span class="attribute">-ms-transform</span>: <span class="built_in">translateZ</span>(0);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateZ</span>(0);</span><br><span class="line">    <span class="attribute">-webkit-backface-visibility</span>: hidden;</span><br><span class="line">    <span class="attribute">-moz-backface-visibility</span>: hidden;</span><br><span class="line">    <span class="attribute">-ms-backface-visibility</span>: hidden;</span><br><span class="line">    <span class="attribute">backface-visibility</span>: hidden;</span><br><span class="line">    <span class="attribute">-webkit-perspective</span>: <span class="number">1000</span>;</span><br><span class="line">    <span class="attribute">-moz-perspective</span>: <span class="number">1000</span>;</span><br><span class="line">    <span class="attribute">-ms-perspective</span>: <span class="number">1000</span>;</span><br><span class="line">    <span class="attribute">perspective</span>: <span class="number">1000</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* when replacing tiles, do not show tile and backbuffer at the same time */</span></span><br><span class="line"><span class="selector-class">.olTileReplacing</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* override any max-width image settings (e.g. bootstrap.css) */</span></span><br><span class="line"><span class="selector-tag">img</span><span class="selector-class">.olTileImage</span> &#123;</span><br><span class="line">    <span class="attribute">max-width</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">css</span></span><br></pre></td></tr></table></figure>
<p>标注的图标文件：</p>
<p><a href="http://pqpog12fm.bkt.clouddn.com/pins.png" target="_blank" rel="noopener">http://pqpog12fm.bkt.clouddn.com/pins.png</a></p>
<p><a href="http://pqpog12fm.bkt.clouddn.com/pinsback.png" target="_blank" rel="noopener">http://pqpog12fm.bkt.clouddn.com/pinsback.png</a></p>
<p>项目文件：</p>
<p><a href="http://pqpog12fm.bkt.clouddn.com/ol2%E8%81%9A%E5%90%88%E5%9B%BE.zip" target="_blank" rel="noopener">http://pqpog12fm.bkt.clouddn.com/ol2%E8%81%9A%E5%90%88%E5%9B%BE.zip</a></p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>如果你觉得这篇文章还满意的话，请我喝杯咖啡喝吧^_^</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="浮生 微信支付">
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="浮生 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    浮生
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://www.xpshuai.cn/ol2实现地图效果/" title="ol2实现地图聚合功能">http://www.xpshuai.cn/ol2实现地图效果/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/GIS/" rel="tag"> <i class="fa fa-tag"></i> GIS</a>
          
            <a href="/tags/openlayer/" rel="tag"> <i class="fa fa-tag"></i> openlayer</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/用户身份与文件权限/" rel="next" title="Linux用户身份与文件权限">
                <i class="fa fa-chevron-left"></i> Linux用户身份与文件权限
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/地图缩放到指定经纬度/" rel="prev" title="弹出地图并缩放到指定经纬度">
                弹出地图并缩放到指定经纬度 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        
  <div class="bdsharebuttonbox">
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
    <a href="#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a>
    <a href="#" class="bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a>
    <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
    <a href="#" class="bds_tieba" data-cmd="tieba" title="分享到百度贴吧"></a>
    <a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a>
    <a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
    <a href="#" class="bds_more" data-cmd="more"></a>
    <a class="bds_count" data-cmd="count"></a>
  </div>
  <script>
    window._bd_share_config = {
      "common": {
        "bdText": "",
        "bdMini": "2",
        "bdMiniList": false,
        "bdPic": ""
      },
      "share": {
        "bdSize": "16",
        "bdStyle": "0"
      },
      "image": {
        "viewList": ["tsina", "douban", "sqq", "qzone", "weixin", "twi", "fbook"],
        "viewText": "分享到：",
        "viewSize": "16"
      }
    }
  </script>

<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/tx.jpg" alt="浮生">
            
              <p class="site-author-name" itemprop="name">浮生</p>
              <p class="site-description motion-element" itemprop="description">侠之大者，为国为民</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">89</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">73</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          



          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/shuai06" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://blog.csdn.net/qq_37622608" target="_blank" title="CSDN">
                      
                        <i class="fa fa-fw fa-copyright"></i>CSDN</a>
                  </span>
                
            </div>
          

          
          

          <div id="music163player">
              <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="298" height="52" src="//music.163.com/outchain/player?type=2&id=247172&auto=0&height=32"></iframe>
          </div>

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://muyuuuu.github.io/" title="兰铃" target="_blank">兰铃</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.aigisss.com/" title="aigisss" target="_blank">aigisss</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.blts.xyz/" title="帅气小学弟" target="_blank">帅气小学弟</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://zlh.giserhub.com" title="GIS大神阿昊哥" target="_blank">GIS大神阿昊哥</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.xbeichen.cn/" title="X北辰北" target="_blank">X北辰北</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.farmsec.cn/" title="农夫安全博客" target="_blank">农夫安全博客</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.xiaodi8.com/" title="小迪渗透吧" target="_blank">小迪渗透吧</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">  <i class="fa fa-heart"></i>   </span>
  <span class="author" itemprop="copyrightHolder">浮生</span> |

  <div class="powered-by">
    由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
  </div>

</div>



<script language="javascript">
  function siteTime(){
    window.setTimeout("siteTime()", 1000);
    var seconds = 1000;
    var minutes = seconds * 60;
    var hours = minutes * 60;
    var days = hours * 24;
    var years = days * 365;
    var today = new Date();
    var todayYear = today.getFullYear();
    var todayMonth = today.getMonth()+1;
    var todayDate = today.getDate();
    var todayHour = today.getHours();
    var todayMinute = today.getMinutes();
    var todaySecond = today.getSeconds();
    /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
    year - 作为date对象的年份，为4位年份值
    month - 0-11之间的整数，做为date对象的月份
    day - 1-31之间的整数，做为date对象的天数
    hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
    minutes - 0-59之间的整数，做为date对象的分钟数
    seconds - 0-59之间的整数，做为date对象的秒数
    microseconds - 0-999之间的整数，做为date对象的毫秒数 */
    var t1 = Date.UTC(2019,04,20,15,00,00); //北京时间2018-2-13 00:00:00
    var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
    var diff = t2-t1;
    var diffYears = Math.floor(diff/years);
    var diffDays = Math.floor((diff/days)-diffYears*365);
    var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
    var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
    var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
    document.getElementById("sitetime").innerHTML=" 博客已健康运行"+ diffYears+" 年 "+ diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
  }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
  siteTime();
</script>

<span id="sitetime"></span>

<div class="BbeiAn-info">
    冀ICP备 -
    <a target="_blank" href="http://www.miitbeian.gov.cn/" style="color:#f0d784" rel="nofollow">18027796-1</a> <!--a标签中增加nofollow属性，避免爬虫出站。-->
</div>


        
<div class="busuanzi-count">
  <script async src https: busuanzi.ibruce.info busuanzi 2.3 busuanzi.pure.mini.js""></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> 访客数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    

    
      <div id="needsharebutton-float">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'zlxLDm8dLo0s1Vz10PEvfuNh-gzGzoHsz',
        appKey: 'UAKrQBSOGPavRUKC9ztdFBLK',
        placeholder: '欢迎发表意见',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
      flOptions = {};
      
          flOptions.iconStyle = "box";
      
          flOptions.boxForm = "horizontal";
      
          flOptions.position = "middleRight";
      
          flOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-float', flOptions);
    
  </script>

  

  

  

  


  <!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>

<!-- canvas曲线 -->

<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>



<!-- 代码块复制功能 -->
<script type="text/javascript" src="/js/src/clipboard.min.js"></script>  
<script type="text/javascript" src="/js/src/clipboard-use.js"></script>

</body>
</html>
